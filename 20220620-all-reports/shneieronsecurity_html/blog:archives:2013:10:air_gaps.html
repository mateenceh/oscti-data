<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Air Gaps - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Air Gaps Comments Feed" href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5050" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5050' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F10%2Fair_gaps.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F10%2Fair_gaps.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5050 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5050" class="post-5050 post type-post status-publish format-standard hentry category-uncategorized tag-airgaps tag-computer-security tag-edward-snowden tag-essays tag-pgp tag-truecrypt">

	<div class="article">

		<h2 class="entry">Air Gaps</h2>
		<p>Since I started working with Snowden&#8217;s documents, I have been using a number of tools to try to stay secure from the NSA. The advice I <a href="https://www.schneier.com/essay-450.html">shared</a> included using Tor, preferring certain cryptography over others, and using public-domain encryption wherever possible.</p>
<p>I also recommended using an <a href="https://en.wikipedia.org/wiki/Air_gap_(networking)">air gap</a>, which physically isolates a computer or local network of computers from the Internet. (The name comes from the literal gap of air between the computer and the Internet; the word predates wireless networks.)</p>
<p>But this is more complicated than it sounds, and requires explanation.</p>
<p>Since we know that computers connected to the Internet are vulnerable to outside hacking, an air gap should protect against those attacks. There are a lot of systems that use &#8212; or should use &#8212; air gaps: classified military networks, nuclear power plant controls, medical equipment, avionics, and so on.</p>
<p>Osama Bin Laden <a href="https://www.schneier.com/blog/archives/2011/05/bin_laden_maint.html">used</a> one. I hope human rights organizations in repressive countries are doing the same.</p>
<p>Air gaps might be conceptually simple, but they&#8217;re hard to maintain in practice. The truth is that nobody wants a computer that never receives files from the Internet and never sends files out into the Internet. What they want is a computer that&#8217;s not directly connected to the Internet, albeit with some secure way of moving files on and off.</p>
<p>But every time a file moves back or forth, there&#8217;s the potential for attack.</p>
<p>And air gaps<em> have</em> been breached. Stuxnet was a US and Israeli military-grade piece of malware that attacked the Natanz nuclear plant in Iran. It successfully jumped the air gap and penetrated the Natanz network. Another piece of malware named <a href="http://www.washingtonpost.com/national/national-security/cyber-intruder-sparks-response-debate/2011/12/06/gIQAxLuFgO_story.html">agent.btz</a>, probably Chinese in origin, successfully jumped the air gap protecting US military networks.</p>
<p>These attacks work by exploiting security vulnerabilities in the removable media used to transfer files on and off the air-gapped computers.</p>
<p>Since working with Snowden&#8217;s NSA files, I have tried to maintain a single air-gapped computer. It turned out to be harder than I expected, and I have ten rules for anyone trying to do the same:</p>
<ol>
<li>When you set up your computer, connect it to the Internet as little as possible. It&#8217;s impossible to completely avoid connecting the computer to the Internet, but try to configure it all at once and as anonymously as possible. I purchased my computer off-the-shelf in a big box store, then went to a friend&#8217;s network and downloaded everything I needed in a single session. (The ultra-paranoid way to do this is to buy two identical computers, configure one using the above method, upload the results to a cloud-based anti-virus checker, and transfer the results of <i>that</i> to the air gap machine using a one-way process.)</p>
</li>
<li>
<p>Install the minimum software set you need to do your job, and disable all operating system services that you won&#8217;t need. The less software you install, the less an attacker has available to exploit. I downloaded and installed OpenOffice, a PDF reader, a text editor, <a href="http://www.truecrypt.org/">TrueCrypt</a>, and <a href="http://bleachbit.sourceforge.net/">BleachBit</a>. That&#8217;s all. (No, I don&#8217;t have any inside knowledge about TrueCrypt, and there&#8217;s a lot about it that makes me suspicious. But for Windows full-disk encryption it&#8217;s that, Microsoft&#8217;s BitLocker, or Symantec&#8217;s PGPDisk &#8212; and I am more worried about large US corporations being pressured by the NSA than I am about TrueCrypt.)</p>
</li>
<li>
<p>Once you have your computer configured, never directly connect it to the Internet again. Consider physically disabling the wireless capability, so it doesn&#8217;t get turned on by accident.</p>
</li>
<li>
<p>If you need to install new software, download it anonymously from a random network, put it on some removable media, and then manually transfer it to the air-gapped computer. This is by no means perfect, but it&#8217;s an attempt to make it harder for the attacker to target your computer.</p>
</li>
<li>
<p>Turn off all autorun features. This should be standard practice for all the computers you own, but it&#8217;s especially important for an air-gapped computer. Agent.btz used autorun to infect US military computers.</p>
</li>
<li>
<p>Minimize the amount of executable code you move onto the air-gapped computer. Text files are best. Microsoft Office files and PDFs are more dangerous, since they might have embedded macros. Turn off all macro capabilities you can on the air-gapped computer. Don&#8217;t worry too much about patching your system; in general, the risk of the executable code is worse than the risk of not having your patches up to date. You&#8217;re not on the Internet, after all.</p>
</li>
<li>
<p>Only use trusted media to move files on and off air-gapped computers. A USB stick you purchase from a store is safer than one given to you by someone you don&#8217;t know &#8212; or one you <a href="https://www.schneier.com/blog/archives/2012/07/dropped_usb_sti.html">find</a> in a parking lot.</p>
</li>
<li>
<p>For file transfer, a writable optical disk (CD or DVD) is safer than a USB stick. Malware can silently write data to a USB stick, but it can&#8217;t spin the CD-R up to 1000 rpm without your noticing. This means that the malware can only write to the disk when you write to the disk. You can also verify how much data has been written to the CD by physically checking the back of it. If you&#8217;ve only written one file, but it looks like three-quarters of the CD was burned, you have a problem. Note: the first company to market a USB stick with a light that indicates a write operation &#8212; not read <em>or</em> write; I&#8217;ve got one of those &#8212; wins a prize.</p>
</li>
<li>
<p>When moving files on and off your air-gapped computer, use the absolute smallest storage device you can. And fill up the entire device with random files. If an air-gapped computer is compromised, the malware is going to try to sneak data off it using that media. While malware can easily hide stolen files from you, it can&#8217;t break the laws of physics. So if you use a tiny transfer device, it can only steal a very small amount of data at a time. If you use a large device, it can take that much more. Business-card-sized <a href="https://en.wikipedia.org/wiki/Mini_CD">mini-CDs</a> can have capacity as low as 30 MB. I still see 1-GB USB sticks for sale.</p>
</li>
<li>
<p>Consider encrypting everything you move on and off the air-gapped computer. Sometimes you&#8217;ll be moving public files and it won&#8217;t matter, but sometimes you won&#8217;t be, and it will. And if you&#8217;re using optical media, those disks will be impossible to erase. Strong encryption solves these problems. And don&#8217;t forget to encrypt the computer as well; whole-disk encryption is the best.</p>
</li>
</ol>
<p>One thing I didn&#8217;t do, although it&#8217;s worth considering, is use a stateless operating system like <a href="https://tails.boum.org/">Tails</a>. You can configure Tails with a persistent volume to save your data, but no operating system changes are ever saved. Booting Tails from a read-only DVD &#8212; you can keep your data on an encrypted USB stick &#8212; is even more secure. Of course, this is not foolproof, but it greatly reduces the potential avenues for attack.</p>
<p>Yes, all this is advice for the paranoid. And it&#8217;s probably impossible to enforce for any network more complicated than a single computer with a single user. But if you&#8217;re thinking about setting up an air-gapped computer, you already believe that some very powerful attackers are after you personally. If you&#8217;re going to use an air gap, use it properly.</p>
<p>Of course you can take things further. I have met people who have physically removed the camera, microphone, and wireless capability altogether. But that&#8217;s too much paranoia for me right now.</p>
<p><i>This essay <a href="http://www.wired.com/opinion/2013/10/149481/">previously appeared</a> on Wired.com.</i></p>
<p>EDITED TO ADD:  Yes, I am ignoring <a href="https://en.wikipedia.org/wiki/Tempest_%28codename%29">TEMPEST</a> attacks.  I am also ignoring black bag attacks against my home.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/airgaps/" rel="tag">airgaps</a>, <a href="https://www.schneier.com/tag/computer-security/" rel="tag">computer security</a>, <a href="https://www.schneier.com/tag/edward-snowden/" rel="tag">Edward Snowden</a>, <a href="https://www.schneier.com/tag/essays/" rel="tag">essays</a>, <a href="https://www.schneier.com/tag/pgp/" rel="tag">PGP</a>, <a href="https://www.schneier.com/tag/truecrypt/" rel="tag">TrueCrypt</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html" rel="bookmark">Posted on October 11, 2013 at 6:45 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html#comments">244 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2013/10/air_gaps.html" data-title="Air Gaps" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-206846">

			<div class="comment by-kbart ">

				<p class="commentcredit">

					<span class="commenter">KBart</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206846">
						October 11, 2013 7:24 AM					</a>

				</p>

				<p>Hm, you actually can install everything you need without connecting to Internet ever. Most of Linux distributions have offline installations made specially for this purpose. They include most of drives/packages available. And if that&#8217;s not enough, you can easily add missing drivers/packages/software yourself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206847">

			<div class="comment by-jim-andrakakis ">

				<p class="commentcredit">

					<span class="commenter">Jim Andrakakis</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206847">
						October 11, 2013 7:27 AM					</a>

				</p>

				<p>Obligatory reference : <a href="http://xkcd.com/538/" rel="nofollow ugc">http://xkcd.com/538/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206848">

			<div class="comment by-henrik ">

				<p class="commentcredit">

					<span class="commenter">Henrik</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206848">
						October 11, 2013 7:35 AM					</a>

				</p>

				<p>Great ideas, you could use SD cards which often have a physical write protect tab &#8211; to ensure writes to not occur.</p>
<p>also I would definitely use multiple user IDs on this computer, one for reading PDF, but not having access to other stuff. Yes, IF the exploit ALSO includes an operating system root exploit, then you are toast, but still it makes it harder to have multiple compartmented user IDs I think.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206849">

			<div class="comment by-phil-hudson ">

				<p class="commentcredit">

					<span class="commenter">Phil Hudson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206849">
						October 11, 2013 7:36 AM					</a>

				</p>

				<p>I hope I misread this. It <em>looks</em> as if you are suggesting that MS Windows is an appropriate choice of OS for a secure system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206850">

			<div class="comment by-ramriot ">

				<p class="commentcredit">

					<span class="commenter">ramriot</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206850">
						October 11, 2013 7:42 AM					</a>

				</p>

				<p>In answer to Henrik&#8217;s comment, SD cards do have a write protect tab but it is not able to stop writing to the card.</p>
<p>I use this feature to boot load custom firmware into my Canon digital camera. i.e with tab in write card works as normal, with tab in no-write the normal camera firmware checks for a specific disk image on the card and then boots from that image after which the camera works fine and is still able to write to the card.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206851">

			<div class="comment by-gix ">

				<p class="commentcredit">

					<span class="commenter">Gix</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206851">
						October 11, 2013 7:46 AM					</a>

				</p>

				<p>Why not building yourself a LiveCD distribution and using that ?<br />
Puppy Linux also fits the bill.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206852">

			<div class="comment by-nickp ">

				<p class="commentcredit">

					<span class="commenter">NickP</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206852">
						October 11, 2013 7:52 AM					</a>

				</p>

				<p>@ Bruce Schneier</p>
<p>Excellent breakdown!</p>
<p>&#8220;Yes, I am ignoring TEMPEST attacks.&#8221;</p>
<p>We all do for PC&#8217;s. It&#8217;s forgivable. 😉</p>
<p>@ All</p>
<p>Technical solutions and analysis of air-gapped, file transfer methods I posted in the past:</p>
<p><a href="https://www.schneier.com/blog/archives/2013/09/how_to_remain_s.html#c1742081" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/how_to_remain_s.html#c1742081</a></p>
<p><b>I strongly recommend Bruce&#8217;s tip about using low risk formats such as text files. I&#8217;ve been doing that and promoting it for years. It will also save you disk space. 😉 Terry Ritter also promoted Puppy Linux LiveDVD for security-critical apps b/c (1) it&#8217;s a RAM disk and (2) as Bruce said, disk activity makes a noise you can actually hear. Nice concept.</b></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206853">

			<div class="comment by-konst ">

				<p class="commentcredit">

					<span class="commenter">konst</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206853">
						October 11, 2013 7:54 AM					</a>

				</p>

				<p>I was wondering the same thing. Are you actually using Windows as your operating system? Seeing the close ties that Microsoft has with many government agencies I think Windows is compromised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206854">

			<div class="comment by-kronos ">

				<p class="commentcredit">

					<span class="commenter">kronos</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206854">
						October 11, 2013 7:55 AM					</a>

				</p>

				<p>I have one PC at home running Windows XP that connects to the internet maybe 2-3 times per year. It&#8217;s over eight years old and other than one harddrive failure is about as trouble-free as anything running Microsoft can be. Friends don&#8217;t understand why I never use it for web surfing but from a security and up-time standpoint the benefits far outweigh the problems with an air gap.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206855">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206855">
						October 11, 2013 8:02 AM					</a>

				</p>

				<p>@Phil</p>
<p>Yes, maybe something like QubesOS. It provides mechanisms for addressing Bruce&#8217;s problem with how to safely handle PDF, DOC, and other complex files. See:<br />
<a href="http://theinvisiblethings.blogspot.com/2013/02/converting-untrusted-pdfs-into-trusted.html" rel="nofollow ugc">http://theinvisiblethings.blogspot.com/2013/02/converting-untrusted-pdfs-into-trusted.html</a></p>
<p>More here:<br />
<a href="http://theinvisiblethings.blogspot.com/2012/09/how-is-qubes-os-different-from.html" rel="nofollow ugc">http://theinvisiblethings.blogspot.com/2012/09/how-is-qubes-os-different-from.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206856">

			<div class="comment by-konst ">

				<p class="commentcredit">

					<span class="commenter">konst</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206856">
						October 11, 2013 8:03 AM					</a>

				</p>

				<p>@Bruce I&#8217;m sure you know a hell of a lot more than me about cryptography and probably securing systems but may I make some suggestions.</p>
<ol>
<li>Use Gentoo hardened with the grsecurity patched kernel. This kernel+patches protects against many exploits even those unforseen. Link: <a href="http://wiki.gentoo.org/wiki/Hardened_Gentoo" rel="nofollow ugc">http://wiki.gentoo.org/wiki/Hardened_Gentoo</a></li>
</ol>
<p>Some of it&#8217;s features:<br />
* Enabling specific options in the toolchain (compiler, linker &#8230;) such as forcing position-independent executables (PIE), stack smashing protection and compile-time buffer checks.</p>
<ul>
<li>Enabling PaX extensions in the Linux kernel, which offer additional protection measures like address space layout randomization and non-executable memory.</li>
<li>Enabling grSecurity extensions in the Linux kernel, including additional chroot restrictions, additional auditing, process restrictions, etc..</li>
</ul>
<p>Don&#8217;t choose the SE-Linux options.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206857">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206857">
						October 11, 2013 8:05 AM					</a>

				</p>

				<p>&#8220;One thing I didn&#8217;t do, although it&#8217;s worth considering, is use a stateless operating system like Tails.&#8221;</p>
<p>While Tails looks good, it doesn&#8217;t seem to be built with an air-gap in mind.  Using something like Knoppix seems more appropriate, or even better use a customized one that removes most of the features.  Note that some of the smaller linux distributions allow loading into memory.  This can allow users to use a single optical drive for both loading the OS and writing to the drive without having any hard drive necessary (it sounds like a notebook was used in the example).  An extra benefit of loading the entire system into memory means that the loaded OS image never is in the machine after it is touched by any suspicious media.  Any malware that is on media passed to this computer must then corrupt the system each time.</p>
<p>&#8220;Yes, I am ignoring TEMPEST attacks. I am also ignoring black bag attacks against my home.&#8221;</p>
<p>And as Jim Andrakakis mentions, rubber hose cryptography.  Only in this case I&#8217;d expect it in the form of an NSL.  One of the big problems in cryptography is how well Alice and Bob treat their plaintext.   Once you set yourself up as a high profile receiver of NSA leaks, I&#8217;d simply assume that you have received an NSL and that everything you send is being sent to the NSA on pain of indefinite solitary confinement.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206858">

			<div class="comment by-wm ">

				<p class="commentcredit">

					<span class="commenter">Wm</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206858">
						October 11, 2013 8:06 AM					</a>

				</p>

				<p>I am not paranoid, but I am disappointed that Bruce didn&#8217;t also suggest that you should keep your computer in a Faraday box.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206860">

			<div class="comment by-dave-m ">

				<p class="commentcredit">

					<span class="commenter">Dave M</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206860">
						October 11, 2013 8:10 AM					</a>

				</p>

				<p>I believe that a microwave oven will make optical media quite unreadable before disposal.  Try 10 seconds.  I&#8217;m not sure if the microwave is safe for food use after you destroy a boatload of DVD&#8217;s, though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206861">

			<div class="comment by-bil ">

				<p class="commentcredit">

					<span class="commenter">bil</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206861">
						October 11, 2013 8:10 AM					</a>

				</p>

				<p>Bruce,<br />
Given the software you&#8217;re using, I&#8217;d suggest using linux as the OS. I also like using encfs to encrypt folders with sensitive data&#8211;that way, it&#8217;s locked down when you&#8217;re not actually using the files. With full disk encryption, everything&#8217;s open while you&#8217;re logged in. And if you&#8217;re paranoid, I&#8217;d suggest converting the PDFs to another format prior to transfer, and running hashes on your static files so you can detect changes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206862">

			<div class="comment by-konst ">

				<p class="commentcredit">

					<span class="commenter">konst</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206862">
						October 11, 2013 8:12 AM					</a>

				</p>

				<p>To add to my suggestions. A Linux distro based on Gentoo with grsecurity extension is Tin Hat Linux.  Link: <a href="http://opensource.dyc.edu/tinhat" rel="nofollow ugc">http://opensource.dyc.edu/tinhat</a></p>
<p>From the description: &#8220;Tin Hat was conceived as a challenge to the old mantra that physical access to a system means full access to the data. This is certainly true in the case of unencrypted file systems, and at least potentially true in the case of encrypted. Rather, Tin Hat aims towards the ideal of guaranteeing zero information loss should the attacker physically acquire the box &#8212; either the adversary is faced with no file system to even begin cracking, or if any non-ephemeral memory is found, the adversary should not be able to tell if he is looking at encrypted data or random noise.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206863">

			<div class="comment by-axon ">

				<p class="commentcredit">

					<span class="commenter">Axon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206863">
						October 11, 2013 8:12 AM					</a>

				</p>

				<p>You&#8217;re trying to reinvent the wheel here, Bruce, and I&#8217;m afraid you&#8217;re not doing a very good job of it. You really should read about <a href="http://www.qubes-os.org" rel="nofollow ugc">Qubes</a> and consider using it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206864">

			<div class="comment by-jeff ">

				<p class="commentcredit">

					<span class="commenter">jeff</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206864">
						October 11, 2013 8:14 AM					</a>

				</p>

				<p>I&#8217;d second the motion to avoid Windows and get a small, secure Linux/OpenBSD image burned on a liveCD.  Once you&#8217;ve created that, boot only from the CD, completely wipe and then encrypt the hard disk and use it only for data files.  You can even set up the mount parameters of the hard disk and removable media to prevent execution of binaries.  Wouldn&#8217;t be foolproof, but should help.</p>
<p>Jeff</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206865">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206865">
						October 11, 2013 8:15 AM					</a>

				</p>

				<p>Another link to a post from Joanna Rutkowska (QubesOS) on protecting against USB attacks on air-gapped and other systems:<br />
<a href="http://theinvisiblethings.blogspot.com/2011/06/usb-security-challenges.html" rel="nofollow ugc">http://theinvisiblethings.blogspot.com/2011/06/usb-security-challenges.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206866">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206866">
						October 11, 2013 8:20 AM					</a>

				</p>

				<p>Some remarks:</p>
<ul>
<li>1. It is quite possible avoiding to connect the computer to the Internet at all. First, wipe the disk using a Knoppix CD or the like. Then install from CD/DVD only, said Knoppix or a set of Debian DVDs is a good choice. Of course, if you are stuck in the MS island of incompatibility, it may indeed be impossible, but there is no real reason to go there.</li>
<li>2. Does not apply if you avoid the Internet completely.</li>
<li>3. Completely agree. Remove wireless card to be sure. Make sure it can be removed when buying the computer.
</li>
<li> 4. Using a source that has a good approximation to being feature-complete, like said Knoppix, or Debian, you may be able to avoid installing anything from the Internet. If not, your approach is good advice. You may also want to download from several different sources over several different channels and compare checksums.</li>
<li> 5. &#8220;Autorun&#8221;? What is that? (Sorry&#8230;.) </li>
<li> 6. Most things can be converted to RTF, which cannot really transport malware (it can but getting it to execute is basically impossible). Of course, if possible, use plain ASCII. Even Unicode is a risk.</li>
<li> 7,8. Use blank media, and use each only for <b>one</b> direction. Destroy after one use. </li>
<li> 8. You can get USB sticks with a physical write-protect switch from PQI, even in USB3.0. (PQI seems to have understood that there is a market segement for these.) Not quite the same thing as a write-detector, but also useful.
</li>
<li> 9. Using random data to fill is a risk, unless you can verify its integrity (in which case it is not random). Far better to use a pattern and verify that on the target or an intermediate &#8220;checker station&#8221;.</li>
<li> 10. Encryption also helps by providing integrity checks, especially if you do an integrity verification in between. Unless the checking machine is compromised in exactly the same way, the checks will fail.
</li>
<li> 11. Tails is not really a good choice here. It is too limited and intended for Internet connectivity. For stateless use something like a Knoppix DVD that has a good set of features.
</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206867">

			<div class="comment by-alan ">

				<p class="commentcredit">

					<span class="commenter">Alan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206867">
						October 11, 2013 8:22 AM					</a>

				</p>

				<p>A conventional (gas or electric) oven is also a good way to securely &#8220;dispose&#8221; of optical and magnetic media. 450F for 15-30 minutes usually does it. I use a foil-lined cookie tray to preserve the tray&#8230; And do this when nobody is home for a few hours afterward so the &#8220;fumes&#8221; have time to disperse.</p>
<p>For flash memory, a hammer works pretty well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206868">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206868">
						October 11, 2013 8:25 AM					</a>

				</p>

				<p>Linux has many of the same security issues as Windows. See:<br />
<a href="http://theinvisiblethings.blogspot.com/2012/09/how-is-qubes-os-different-from.html" rel="nofollow ugc">http://theinvisiblethings.blogspot.com/2012/09/how-is-qubes-os-different-from.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206869">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206869">
						October 11, 2013 8:37 AM					</a>

				</p>

				<p>I&#8217;ve always wondered about making a one-way ethernet cable.</p>
<p>You could chop the incoming data line and then use UDP or similar to dump stuff off the &#8220;offline&#8221; machine without any risk of incoming transmission.</p>
<p>If you positioned your connection&#8217;s byte counter somewhere visible, you&#8217;d have the same warning that your computer was compromised that listening out for the CD drive gives you.</p>
<p>Would be more convenient than CD and safer than a USB stick.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206870">

			<div class="comment by-irony ">

				<p class="commentcredit">

					<span class="commenter">Irony</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206870">
						October 11, 2013 8:38 AM					</a>

				</p>

				<p>So I guess using NSA Linux for your airgap machine would be a bad idea?</p>
<p><a href="http://www.salon.com/2013/09/19/linux_creator_admits_nsa_demanded_backdoor/" rel="nofollow ugc">http://www.salon.com/2013/09/19/linux_creator_admits_nsa_demanded_backdoor/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206871">

			<div class="comment by-juice ">

				<p class="commentcredit">

					<span class="commenter">Juice</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206871">
						October 11, 2013 8:50 AM					</a>

				</p>

				<p>If you can&#8217;t find a small thumbdrive, would creating a truecrypt volume that filled all available space give you the same advantage?  Or would malware just see the mounted volume as another drive?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206872">

			<div class="comment by-secret-police ">

				<p class="commentcredit">

					<span class="commenter">Secret Police</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206872">
						October 11, 2013 8:55 AM					</a>

				</p>

				<p>A live operating system DVD/CD would be best because no attempts to  bridge the air gap would last past a reboot. Tails has Truecrypt built in but you have to activate it in the boot options. Dee.su Liberte Linux is a much better distro with grsec and hardened gentoo but it hasnt been maintained</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206873">

			<div class="comment by-cowbert ">

				<p class="commentcredit">

					<span class="commenter">cowbert</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206873">
						October 11, 2013 9:01 AM					</a>

				</p>

				<p>It&#8217;s easy to disable a builtin camera (especially if you&#8217;re not using it at all): cover the camera with a piece of duct tape. It&#8217;s slightly harder to destroy a builtin mic, but most of them don&#8217;t require too much effort with a paperclip or tack to destroy the diaphragm.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206874">

			<div class="comment by-openbsd ">

				<p class="commentcredit">

					<span class="commenter">OpenBSD</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206874">
						October 11, 2013 9:02 AM					</a>

				</p>

				<p>Bruce&#8217;s howto is also useful to companies: NSA may well have been an intermediate between Pretrobras and some unknown israel company <a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html</a></p>
<p>@AlanS, one post about Qubes was enough; three posts look like advertisment.</p>
<p>NSA should be able to activate some backdoor in XEN (remember that Intel VT-x and AMD-V should have been backdoored by NSA) even in Qubes.<br />
Hence it is better not to transfer any PDF on an air-gapped computer, but only text files. With Qubes, one may be tempted to transfer the original PDF (or even to put the computer on a network) because of a relative sense of security.</p>
<p>Bruce will do less mistakes with a networkless Windows installation than with a networkless Linux or OpenBSD or Qubes or <a href="http://www.scs.stanford.edu/histar" rel="nofollow ugc">http://www.scs.stanford.edu/histar</a> installation if he is not used to these OS.</p>
<p>Each mistake may be an improper encryption. At some point, when he will have spent time to learn some other OS on a normal computer, he will then want to use the same computer on his airgapped laptop.</p>
<p>Bruce should nonetheless physically take out the wifi, and the bluetooth. And the microphone, if we assume that the sound card may listen and interpret morse code or another sound code.</p>
<p>Note to Bruce: Don&#8217;t share the keyboard (or mices) between secure and internet computers: a keyboard may hide an USB key that the NSA can activate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206875">

			<div class="comment by-layer_8 ">

				<p class="commentcredit">

					<span class="commenter">Layer_8</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206875">
						October 11, 2013 9:07 AM					</a>

				</p>

				<p>@ Bruce</p>
<p>Years ago my favorite way to stay secure (enough for my private needs) was to use a second harddrive in an exchange frame and with a hardened operating system with no network driver installed.</p>
<p>The second hardddrive was fix built-in configured as normal system that was able to surf and work.</p>
<p>Beside a small partition on the internal harddrive, any partition was full encrypted to be sure, that none of the operating systems was able to see the other and do anything unwanted.</p>
<p>This worked fine for me, because the information I wanted to protect were always offline when I could go online. Exchange was realized with the small partition that was FAT32 formatted (also to prevent <a href="http://en.wikipedia.org/wiki/Fork_(file_system)" rel="nofollow ugc">ADS</a>).</p>
<p><i>(The ultra-paranoid way to do this is to buy two identical computers, configure one using the above method, upload the results to a cloud-based anti-virus checker, and transfer the results of that to the air gap machine using a one-way process.)</i></p>
<p>I think the <b>ultra-paranoid</b> way would also avoid:</p>
<ul>
<li>connecting the system to the wall socket to prevent any manipulation of the <a href="http://www.nearfieldcommunication.org/nfc-security-risks.html" rel="nofollow ugc">power</a> supply or any traces by <a href="http://www.networkworld.com/community/blog/hacking-privacy-2-days-amateur-hacker-hack-smart-meter-fake-readings" rel="nofollow ugc">consumption</a> of electricity </li>
<li>use shielding <a href="http://emfclothing.com/en/21-emf-shielding-wallpaper" rel="nofollow ugc">wallpaper</a> in an empty basement room with no windows</li>
<li>under no circumstances use one system to work worth protecting data with and something else (like I did)</li>
<li>live in a house older than 1950 (only to be sure that no electronic bugs were built-in with the <a href="http://kurier.at/politik/ausland/nsa-installierte-wanzen-in-botschaftsbueros/17.420.686" rel="nofollow ugc">cement</a>)</li>
</ul>
<p>I am sure you would have much more examples what could used to identify someone as &#8220;ultra-paranoid&#8221; 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206876">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206876">
						October 11, 2013 9:10 AM					</a>

				</p>

				<p>@Bob: Forget about that Ethernet cable. Ethernet does handshaking on connection establishment today, i.e. your cable would not work at all.</p>
<p>What you could do is a classical RS232 and use a microcontroller to monitor what goes into the undesirable direction and optionally block it. Or use hardware handshake lines, then you can actually cut one direction.</p>
<p>Side note: RS232 goes up to about 2Mbit/sec today (with special cards that are still 16550 compatible otherwise). I looked at the possibility to have anomaly detection on such a link using a very simple protocol on top for connecting a high-security system a while ago.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206877">

			<div class="comment by-gabe ">

				<p class="commentcredit">

					<span class="commenter">Gabe</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206877">
						October 11, 2013 9:11 AM					</a>

				</p>

				<p>Even if you buy a computer &#8220;off-the-shelf in a big box store&#8221;, you have no way of knowing how many times it has connected to the internet before you purchased it (during assembly, etc). Also, you have very little way of knowing what&#8217;s embedded in the bios.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206878">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206878">
						October 11, 2013 9:13 AM					</a>

				</p>

				<p>@AlanS: For the purpose at hand, Linux does not have the one main vulnerability of Windows, namely that it needs an Internet connection during installation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206879">

			<div class="comment by-california-bob ">

				<p class="commentcredit">

					<span class="commenter">California Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206879">
						October 11, 2013 9:16 AM					</a>

				</p>

				<p>Wikipedia has an article on Linux distros that run in RAM only.</p>
<p>Puppy Linux is the most popular as listed on DistroWatch.  It loads completely into RAM from 3 files amounting to less than 200MB on a USB flash.  Latest  versions are Slacko-5.6 and Precise-5.7.   You can use any Ubuntu, Debian, or Slackware package, or compile from source to be on the safe side.</p>
<p>For the net, just plug in a USB wifi dongle, connect, get the stuff, and then unplug.  Remember, everything in RAM dissapears when you unplug the PC, so no traces are left.  You must explicitly save anything you want to keep on a device outside the RAM filesystem, e.g., a folder named &#8216;/downloads&#8217; on the same USB flash drive.</p>
<p>Hope this helps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206880">

			<div class="comment by-scott ">

				<p class="commentcredit">

					<span class="commenter">Scott</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206880">
						October 11, 2013 9:21 AM					</a>

				</p>

				<p>LiveCDs are a great idea, but I would also suggest using read only virtual machines if those aren&#8217;t practical. It&#8217;s fairly trivial to eliminate all connectivity via software and it provides another level of encryption through the host software itself.</p>
<p>As Bruce mentioned larger companies like Microsoft, Oracle, and VMWare can and have been pressured into providing backdoors, so use an open source hypervisor instead.</p>
<p>P.S. If you&#8217;re interested in alternatives to traditional ethernet physical layers, try Firewire or HDMI. They&#8217;re much faster than RS232 and the cables for the latter are cheap, as in disposably cheap.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206881">

			<div class="comment by-ben ">

				<p class="commentcredit">

					<span class="commenter">Ben</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206881">
						October 11, 2013 9:23 AM					</a>

				</p>

				<p>What do you think about connecting the PC to another PC using a serial port and then using software like zmodem to up and download files manually on demand?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206882">

			<div class="comment by-maninatux ">

				<p class="commentcredit">

					<span class="commenter">ManInATux</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206882">
						October 11, 2013 9:25 AM					</a>

				</p>

				<p>I&#8217;m a Linux programmer and systems administrator.  I also dabble in Microsoft Windows because of the demands of my occupation.  Many of you will likely hate on me for stating this, but for the purposes and corresponding methods described I don&#8217;t think a Linux distribution will be any more &#8220;secure&#8221; than using Microsoft Windows.</p>
<p>Yes, I can freely examine the code and build it myself on Linux, OpenBSD, etc., but it would take me years to do it right.  I can even do that with Windows through a NDA, but again I&#8217;d never get anything else done.  I might as well build Multics on an Itanium system.  If Bruce were doing all that, he&#8217;d never have time to deliver any more speeches, or write any more books, articles, or blog entries.</p>
<p>If you use Windows every day, then use Windows and figure out how to secure it as best as possible.  Same with any other OS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206883">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206883">
						October 11, 2013 9:25 AM					</a>

				</p>

				<p>You guys are forgetting forensic hardware write blockers. Those things could be used to read data off a usb stick without risk of data being written to it. That assuming you trust the company that made them. Or just use the medium once and destroy it.</p>
<p>As for extracting data from the air gapped machine, the true paranoid would encode a text file (or base64 encoded any file) in a series of high capacity 2d barcodes (such as a PDF417), print and scan them back.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206884">

			<div class="comment by-salach ">

				<p class="commentcredit">

					<span class="commenter">Salach</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206884">
						October 11, 2013 9:25 AM					</a>

				</p>

				<p>What do you think about a one-way connection like <a href="http://www.waterfall-security.com" rel="nofollow ugc">http://www.waterfall-security.com</a> or <a href="http://www.vadosecurity.com/" rel="nofollow ugc">http://www.vadosecurity.com/</a> ?</p>
<p>one advantage of the one-shot CD or DVD is the lower bandwidth but it seems that a data diode like those is also a possibility</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206885">

			<div class="comment by-kronos ">

				<p class="commentcredit">

					<span class="commenter">kronos</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206885">
						October 11, 2013 9:26 AM					</a>

				</p>

				<p>@ Alan  &#8220;For flash memory, a hammer works pretty well.&#8221;</p>
<p>A hammer would also work well to destroy CDs and DVDs. If one were truly paranoid, they would distribute pieces of the broken media into multiple bags and dispose of said bags in widely separated parts of town. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206886">

			<div class="comment by-eligius ">

				<p class="commentcredit">

					<span class="commenter">Eligius</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206886">
						October 11, 2013 9:27 AM					</a>

				</p>

				<p>Have you considered personal virtualisation?</p>
<p>If you&#8217;re unconfortable with any OS other than Microsoft&#8217;s, you could install a Debian using full-disk encryption, a tiny window manager (not Gnome nor KDE) and VirtualBox on it, do a secured Windows installation (trusted media, trusted programs, etc) and then turn the image immutable. For added security you could wipe the Linux free space from time to time, as VBox&#8217;s method to track usage when running is writing a file with the differences between the initial status and the currently running. Extra points if you configure the Windows-inside-Virtualbox without any networking interface and mount external drives on Linux passing the data using the Shared Folders functionality to mitigate autorun vulnerabilities, enabling read-write only when necessary.</p>
<p>In a much less paranoid fashion, that&#8217;s what I&#8217;m using as a programmer who has to do tests from Windows environments from time to time. As maintaining a Windows OS is time consuming and it eventually rots to the point of require a reinstall, I have a well-known-working configuration in an immutable state so I can run any tests whatosever on the virtualised OS without worrying about the consequences: as soon as I turn it off, the next time I start it it&#8217;s back in a fresh state.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206887">

			<div class="comment by-ben ">

				<p class="commentcredit">

					<span class="commenter">Ben</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206887">
						October 11, 2013 9:27 AM					</a>

				</p>

				<p>Addendum: You could unplug the serial port whenever you don&#8217;t need it for better protection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206888">

			<div class="comment by-mike-acker ">

				<p class="commentcredit">

					<span class="commenter">Mike Acker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206888">
						October 11, 2013 9:30 AM					</a>

				</p>

				<p>I second the motion on Linux.   I&#8217;m using Linux/MINT these days and find it fills my needs for the stuff I do</p>
<p>I wouldn&#8217;t buy a &#8216;puter &#8220;off the shelf&#8221; &#8212; ever again &#8212; after having built my first one.    I recommend <em>Building the Perfect PC</em> (O&#8217;Reilly).    You can get it from Amazon.   The book will explain how to match all the product codes &#8212; so that you get a set of parts that work together.   I had a lot of fun doing my first one.  I used an Antec ATX case and power supply; ASUS mother board (M5A88M), Wireless card and CD/DVD drive,  AMD CPU, and Seagate SATA 1TB hard drives.   check carefully what all you want to connect to your &#8216;puter as you select your mother board.</p>
<p>if you want to build an INTEL base system for LINUX I&#8217;d stay away from boards using Intel EFI or UEFI at least until they are keyed for Linux.   even so this stuff may require the computer to &#8220;call home&#8221; &#8212; i.e. connect to the net &#8212; before it can complete its boot-up .    stick with AMD/ATI graphics &#8212; avoid NVIDIA if you are building a Linux box.</p>
<p>be sure to visit the Ubuntu/MINT support forums when you need to .</p>
<p>Linux &#8212; either Ubuntu or MINT &#8212; will include Firefox, LibreOffice, Thunderbird via the install; there is a program library where you can get extra stuff&#8211; like the Chromium Browser &#8212; which is the Open Source version of Chrome.</p>
<p>GnuPG is also included with the Linux install.</p>
<p>All that you need to do is activate Thunderbird and activate your e/mail accounts.   I use CoreComm &#8212; which is a non-free service &#8212; which says they do not monitor activity.</p>
<p>Next, add the ENIGMAIL plug-in to Thunderbird.    In Ubuntu all I had to do was search plug-ins for ENIGMAIL and click install.   On MINT I had to download the package in install it .</p>
<p>Once you have that done you can generate your key pair.   Once you have that done you can exchange PGP mail with others who have the same capability.   This is NOT like a &#8220;hush mail&#8221; or &#8220;secure mail&#8221; service: your provider doesn&#8217;t decrypt you mail&#8230; nor does he have the keys to do so&#8230;</p>
<p>ToR</p>
<p>ToR still seems to be the best way to avoid Traffic Analysis although I wouldn&#8217;t use it: NSA like to try and figure out what you are up to.    Playing with PGP is just a fun hobby.   it really is pretty cool stuff.</p>
<p>later we&#8217;ll get into Trust Levels as they apply to the keys people send you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206889">

			<div class="comment by-scott ">

				<p class="commentcredit">

					<span class="commenter">Scott</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206889">
						October 11, 2013 9:32 AM					</a>

				</p>

				<p>Oops, I wish I could edit my posts.</p>
<p>One last suggestion- use OpenBSD, or if it doesn&#8217;t work for your circumstances, some other flavor of BSD Unix workalike instead of Linux. It&#8217;s my completely unfounded and unsubstantiated belief that BSD&#8217;s architecture and conservative approach to release and testing make it more secure than Linux, especially when it comes to zero-day exploits.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206890">

			<div class="comment by-g ">

				<p class="commentcredit">

					<span class="commenter">G</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206890">
						October 11, 2013 9:36 AM					</a>

				</p>

				<p>Building your solution on top of Windows is the equivalent of building a house on a foundation of quicksand.  You are compromised out of the box.</p>
<p>I would suggest exploring Liberte Linux, which is hardened Gentoo but more minimal than Tails.  Ask @ioerror his opinion on Liberte.  These live systems are fast now off media and you should be able to accomplish everything you need with greater confidence.  I would load it (with no persistence) on an air gapped computer with no OS loaded on its hard drive and updated bios.  That&#8217;s it. Files on separate encrypted media.  I would physically remove speakers and camera.  I would only use the virtual keyboard, not a real keyboard.  But only wired peripherals, if necessary.   And if I needed an internet connection, I would use a different version of Liberte Linux on different media on a different computer.  That should increase your air gapped and your internet connected OS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206891">

			<div class="comment by-tinker ">

				<p class="commentcredit">

					<span class="commenter">Tinker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206891">
						October 11, 2013 9:36 AM					</a>

				</p>

				<p>Bruce!  You stated, &#8220;I have met people who have physically removed the camera, microphone, and wireless capability altogether. But that&#8217;s too much paranoia for me right now.&#8221;</p>
<p>Now they know your habits and can establish a proven attack vector!  I mean, if it can be done to Miss Teen USA, it can be done on anyone.</p>
<p>I believe the best solution has been stated: Electrical Tape over the Camera Lens and a thumb tac through the mic hole.</p>
<p>(Why am I making fun of the paranoid, when I am one of the paranoid&#8230;?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206892">

			<div class="comment by-michele-moore-happy1 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ReportingWrongdoing.com' rel='external nofollow ugc' class='url'>Michele Moore - Happy1</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206892">
						October 11, 2013 9:45 AM					</a>

				</p>

				<p>GREAT suggestions Bruce, many thanks!  A few thoughts&#8230;</p>
<p>Detach Your Wireless Card &#8211; Don&#8217;t trust your operating system to do it for you.  I had horrible problems with data integrity on a laptop which stopped abruptly as soon as I physically detached my wifi card.</p>
<p>Beware of Encryption &#8211; If a keylogger is on your device, you can be locked out of your own data.  Adversaries can pull your password and change it on your encrypted files which leaves them with your data and you out in the cold.  This has happened to me.</p>
<p>Use Micro SD Cards for Data Storage, NOT USB Sticks &#8211; Micro SD cards are small and easily hidden. Just don&#8217;t forget where you put them.</p>
<p>Assume Keyloggers And Compromised Software Are Omnipresent &#8211; And then figure out how you can evade them.</p>
<p>Strict 7 x 24 Physical Security for Key Devices &#8211; This means sleeping with them under your pillow and keeping them in view at all times, like when you shower and exercise.</p>
<p>Many, MANY THANKS for all you do!</p>
<p>Michele Moore &#8211; Happy1 (U of R &#8217;71)<br />
<a href="http://ReportingWrongdoing.com" rel="nofollow ugc">http://ReportingWrongdoing.com</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206893">

			<div class="comment by-konst ">

				<p class="commentcredit">

					<span class="commenter">konst</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206893">
						October 11, 2013 9:47 AM					</a>

				</p>

				<p>After looking up the suggestions to use Liberte Linux it looks pretty good. Could be useful for journalists and human rights activists, etc. It&#8217;s probably better than Tin Hat Linux so Liberte Linux looks like the Linux I will recommend from now on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206894">

			<div class="comment by-jeremy ">

				<p class="commentcredit">

					<span class="commenter">Jeremy</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206894">
						October 11, 2013 10:00 AM					</a>

				</p>

				<p>I&#8217;ve often thought that for the truly paranoid, there needs to be an OS/Device that is So minimal as to make personal auditing feasible.<br />
Linux is 5-15 MLOC, Firefox is 10MLOC.. Do you need all that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206895">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206895">
						October 11, 2013 10:04 AM					</a>

				</p>

				<p>Ah, the fallacies of the air-gapped computer with the sneakernet of the (floppy|USB|other) drive!<br />
#1: Don&#8217;t do that.  That&#8217;s how viruses hop from computer to computer.  If you absolutely <i>must</i> do that, use the media <i>once</i> to go from the &#8220;dirty&#8221; machine to the &#8220;clean&#8221; machine, and then <i>throw it away</i>.<br />
#2: Use a null-modem serial cable with an LED breakout box and UUCP, or two terminal emulator programs for transferring files.  This transfers file by file, and you can see the lights flicker on the breakout box as the transfer happens.<br />
#3: <a href="http://distrowatch.com/" rel="nofollow ugc">http://distrowatch.com/</a> is your friend for Linux distros.  There are <i>lots</i> of choices for live CDs.<br />
#4: Use different architectures.  You can have your networked computer be an ARM or SPARC, and your isolated computer be Intel, or something like that.  There&#8217;s lots of choices for non-Intel architectures these days.  The virus that works on Intel won&#8217;t work on ARM, etc.  At home I have a PA-RISC workstation, but that&#8217;s only used for working with HP-UX.  I also have some non-IA boxes, mainly because I like mucking with them, not for security.<br />
#5: Learn to use a network sniffer.  Wireshark is your friend!  You can get a low-cost smart switch that can mirror ports, so port 1 can monitor port 2, etc.<br />
#6: Learn to write firewall rules and use browser helpers that limit what your browser does.  A lot of these exploits rely on Java or JavaScript to function.</p>
<p>Yes, the same binary chunk can contain exploits for more than one architecture.  However, something like that is mainly a downloader for the actual malware, not the complete package itself.  And yes, there are exploits for all virus scanners.  After all, 99% coverage means 1% missed viruses that are <i>known</i> to the researchers.</p>
<p>Honestly, if I wanted to compromise an air-gapped Windows box, I would write a virus that uses RFI to send a signal.  A one-way channel is better than no channel.  (And I&#8217;d have a friend buy a TEMPEST laptop for me, then run a Linux distro on it.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206896">

			<div class="comment by-michele-moore-happy1 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ReportingWrongdoing.com' rel='external nofollow ugc' class='url'>Michele Moore - Happy1</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206896">
						October 11, 2013 10:07 AM					</a>

				</p>

				<p><b>TOR doesn&#8217;t help you if your browser has been compromised or if a keylogger is on your device! </b> Commenters, remind people about this, please&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206897">

			<div class="comment by-engineer ">

				<p class="commentcredit">

					<span class="commenter">Engineer</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206897">
						October 11, 2013 10:15 AM					</a>

				</p>

				<p>Frankly, I think it&#8217;s kinda astounding that you&#8217;re using windows.  Given the completely lax security of Microsoft over the past decades you&#8217;re trying to plug up a machine that is full of holes.</p>
<p>Why not use OS X, from a company that takes security seriously, and that updates its software regularly and automatically?</p>
<p>Or Linux or OpenBSD &#8211; the latter being both open source and focused on security?</p>
<p>Seems this should be recommendation number one for an air gapped machine&#8230; then you don&#8217;t have to worry about &#8220;auto run&#8221; and the other built in bad practices.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206898">

			<div class="comment by-avee ">

				<p class="commentcredit">

					<span class="commenter">AVee</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206898">
						October 11, 2013 10:23 AM					</a>

				</p>

				<p>Frankly, I don&#8217;t get the fuzz about the choice of OS for the airgapped system. You use the airgap because you assume the OS isn&#8217;t secure enough in the first place. Once the airgap is in place (and maintained properly, which is the hard part!) it shouldn&#8217;t matter what&#8217;s running on it. It might be full of keyloggers, trojans and be totally vulnerable, the point of the airgap is to make sure this doesn&#8217;t matter because stuff can&#8217;t escape the system. If you think it does matter you&#8217;ve got the airgap wrong.<br />
Having said that, physical access might still be a problem. If you think you will be raided or someone might be willing to break into your home and bug your PC with hidden transmitters you need to take more measures. But if that&#8217;s the case it&#8217;s also wrong to rely on the security of the OS as somebody might simple be streaming from your monitor to the outside world seeing everything you see. I&#8217;d say in that case you might be best of with a pure read-only system for the sensitive stuff and old fashioned typing to transfer stuff which you intend to publish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206900">

			<div class="comment by-jan ">

				<p class="commentcredit">

					<span class="commenter">Jan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206900">
						October 11, 2013 10:33 AM					</a>

				</p>

				<p>There is currently a VERY interesting series of tweets about BIOS malware being posted by Dragos Ruiu (@dragosr). See for example this tweet <a href="https://twitter.com/dragosr/status/388512915742937089" rel="nofollow ugc">https://twitter.com/dragosr/status/388512915742937089</a> mentioning SDR capabilities for airgap bypassing. That sounds pretty scary.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206901">

			<div class="comment by-marc-andre-heroux ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.herouxgroup.org' rel='external nofollow ugc' class='url'>Marc-Andre Heroux</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206901">
						October 11, 2013 10:33 AM					</a>

				</p>

				<p>@Bruce,</p>
<p>For a MS-Windows connected to the Internet, I suggest you to have a look at: Comodo Firewall, <a href="http://goo.gl/8b5k1V" rel="nofollow ugc">http://goo.gl/8b5k1V</a></p>
<p>I have been able to define very granular rules/logging/etc. against applications and processes.</p>
<p>I agree, it takes little optimization time and research to apply some restrictions (like passive/active FTP), but you can control incoming/outgoing traffic per application and not only on packet.</p>
<p>Have a good one!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206902">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206902">
						October 11, 2013 10:36 AM					</a>

				</p>

				<p>And don&#8217;t take candy from strangers. Especially old creepy dudes with trench coats standing next to a dark van.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206903">

			<div class="comment by-mark-six ">

				<p class="commentcredit">

					<span class="commenter">Mark Six</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206903">
						October 11, 2013 10:50 AM					</a>

				</p>

				<p>Hi Bruce,</p>
<p>I would say that stop using Windows and be vigilant about phishing attacks is adequate to protect the average person. Of course, for somebody like you, additional measures is needed.</p>
<p>But, here is an additional question for you consideration. Are your would be attackers more interested in stealing your information or simply destroying it? Because encryption is useless in the latter case. You need something else.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206904">

			<div class="comment by-zactral ">

				<p class="commentcredit">

					<span class="commenter">zactral</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206904">
						October 11, 2013 10:51 AM					</a>

				</p>

				<p><a href="http://en.wikipedia.org/wiki/Intel_vPro" rel="nofollow ugc">http://en.wikipedia.org/wiki/Intel_vPro</a></p>
<p>I believe that alone requires in addition a Faraday cage around the airgapped machine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206905">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206905">
						October 11, 2013 10:53 AM					</a>

				</p>

				<p><strong>WARNING</strong><br />
Do not click on Rob Legend&#8217;s name, Mod you may even want to remove.  I knew it was suspicious and found out the hard way.</p>
<p>Like Michele Moore &#8211; Happy1 said: <i>This means sleeping with them under your pillow and keeping them in view at all times, like when you shower and exercise.</i><br />
&#8211;I would say bury a trusted device too; but could be found.</p>
<p>A concern of mine, is if the &#8220;secure solution&#8221; is a liveCD of linux of bsd, won&#8217;t that become a target?</p>
<p>Bruce<br />
&#8211;I&#8217;d at least just keep an extra eye out, if they do enter your home you won&#8217;t really notice it. Not comforting advice, and since you&#8217;re on the road a lot, that may be an empty house and easy target&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206906">

			<div class="comment by-vw ">

				<p class="commentcredit">

					<span class="commenter">vw</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206906">
						October 11, 2013 11:00 AM					</a>

				</p>

				<p>As an employee of a US DoD contractor, we maintain several air gapped systems (standalone and isolated networks) and many of the policies we implement are similar to your suggestions. I can also suggest:</p>
<p>Don&#8217;t use use thumbdrives. There have been cases (I don&#8217;t recall if they were proven or suspected&#8230;google if you&#8217;re interested) of thumbdrives from foreign manufacturers containing malware in the drive&#8217;s firmware. WORM media is the best (cd, dvd, etc.). After verifying and virus scanning the media, try to write to it again on both sides of the gap to ensure it doesn&#8217;t have an open write session.</p>
<p>Virus scan everything on both sides of the gap in general.</p>
<p>We don&#8217;t allow downgrading (isolated to internet transfer) of many file types including MS Office files because of the &#8220;hidden&#8221; metadata&#8230;it&#8217;s tough to scrub. So we do text files mostly. A safe option for shorter documents is to print them on the isolated system and scan them on the internet system. If you need to edit again, use an OCR package.</p>
<p>Make a known-good copy of your system install and restore frequently. (this is related to your suggestion of Tails)</p>
<p>Enable all the audit logs you can and review them frequently.</p>
<p>We don&#8217;t physically remove webcams but we try to buy hardware without them. If it&#8217;s unavoidable (it&#8217;s tough to get a laptop without one these days) we put duct tape over the lens.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206908">

			<div class="comment by-steven-hoober ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://4ourth.com' rel='external nofollow ugc' class='url'>Steven Hoober</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206908">
						October 11, 2013 11:03 AM					</a>

				</p>

				<p>Too many comments, so maybe someone already did this but:<br />
The Air Gap: SCADA&#8217;s Enduring Security Myth</p>
<p>Unusually for ACM articles, full text is available:<br />
<a href="http://cacm.acm.org/magazines/2013/8/166309-the-air-gap/fulltext" rel="nofollow ugc">http://cacm.acm.org/magazines/2013/8/166309-the-air-gap/fulltext</a></p>
<blockquote><p>&#8220;&#8230;Before I go any further, I must clarify what I mean when I use the term &#8220;air gap&#8221;: What I am referring to in this column is the philosophy that says we can truly isolate our critical systems from the outside world. And this is where the myth—and the danger—lies. To begin, I do not believe true air gaps actually exist in the ICS and SCADA world. Moreover, many SCADA security experts have even stronger opinions than me on the subject—for example, see Craig Wright&#8217;s blog.a However, I do acknowledge (albeit reluctantly) that not everyone agrees with me on this&#8230;&#8221;</p></blockquote>
<p>Fairly involved CSish discussion of why it&#8217;s not generally applicable. Bruce&#8217;s info seems good for special purposes, but promulgating air gaps as a day-to-day working environment for machine control equipment, etc. he argues is pointless.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206909">

			<div class="comment by-dv ">

				<p class="commentcredit">

					<span class="commenter">Dv</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206909">
						October 11, 2013 11:13 AM					</a>

				</p>

				<p>Back in the 90s, as broadband trials were first starting to roll out, I needed a NAT box to share my internet connection amongst all my computers.  This is back before you could walk into Walmart and walk out with a little router box.  Back when folks would refuse to install broadband for you unless you ran Windows.</p>
<p>So I hooked up a 25Mhz (Yes, 0.025Ghz) 486 running Linux.  (That was a &#8220;fun&#8221; conversation with the installer who wanted Windows.  I told him go ahead.  We can put Win95 on that.  But I&#8217;m going to wipe it as soon as he leaves.  Having Win95 on floppy, like 25 or 30 disks, helped persuade him to a more reasonable course of installation.)</p>
<p>That tiny box didn&#8217;t have enough disk space, so most of the Linux OS was offloaded onto a custom burned CDROM.  Syslog was configured to dump all messages to the console, which was displayed on a $10 monitor off in the corner.</p>
<p>Whole thing was slower than molasses in January.  But for a network router it worked just fine.</p>
<p>There were occasional break in attempts.  Having everthing under the sun shutdown, and ssh configured for local access only with passwords disabled helped.</p>
<p>It was interesting to watch folks try to break in in real time.  In the end, everyone gave up.  I think they thought I had tarpitted the server slowing down their breaking attempts.  Nope.  The server itself really was that slow.  Security through, well, I don&#8217;t know what you call it&#8230;  Obsolete technology?</p>
<p>But it worked&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206910">

			<div class="comment by-john-campbell ">

				<p class="commentcredit">

					<span class="commenter">John Campbell</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206910">
						October 11, 2013 11:34 AM					</a>

				</p>

				<p>I think one other bit of useful advice:</p>
<p>DO NOT USE A WIRELESS KEYBOARD AND/OR MOUSE.</p>
<p>While this seems obvious, there are those who might go through all of the advised steps and completely ignore their rodent and keyboard setup.</p>
<p>Also, hopefully your laptop doesn&#8217;t have a 3G, 4G or LTE (&#8220;Let&#8217;s Track Everybody&#8221;) interface to the cellular telephone network(s).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206911">

			<div class="comment by-bauke-jan-douma ">

				<p class="commentcredit">

					<span class="commenter">Bauke Jan Douma</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206911">
						October 11, 2013 11:37 AM					</a>

				</p>

				<p>Oh &#8211;  the hassle!  Luckily there&#8217;s SeLinux.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206912">

			<div class="comment by-bauke-jan-douma ">

				<p class="commentcredit">

					<span class="commenter">Bauke Jan Douma</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206912">
						October 11, 2013 11:54 AM					</a>

				</p>

				<p>Isn&#8217;t it true that for a CDROM there is no discrete &#8216;writing only&#8217; operation, that<br />
it&#8217;s always write-AND-read (error correction)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206913">

			<div class="comment by-peter-a ">

				<p class="commentcredit">

					<span class="commenter">Peter A.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206913">
						October 11, 2013 11:56 AM					</a>

				</p>

				<p>Guys, all of your advice really boils down to xkcd 538.</p>
<p>All these hardening and air-gapping tricks are fine to ward off indiscriminately, widely, automatically deployed attacks and surveillance as well as (possibly) protect against some booby-trapped &#8220;top secret&#8221;  files. These techniques will greatly help to fly under the radar of the surveillance agencies. They may even be able to stop remote covert targeted attacks if any part of alphabetic soup gets to know that you&#8217;re up to messing in their business.</p>
<p>But if you really piss them off, they have any possible variety of the $5 wrench in their shops. They have all the power and impunity to get anything they want from you &#8211; and more &#8211; unless you&#8217;re going to get a protection of their competition, and it is a risky business anyway.</p>
<p>Bruce is basically relying on a fact that it would be a very bad PR move to harass him now, and that the milk has been spilt already. He&#8217;s only trying not to leave obvious traces and open cracks for some overzealous lowly FBI agent or someone like that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206914">

			<div class="comment by-brian-reiter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://Http://brianreiter.org' rel='external nofollow ugc' class='url'>Brian Reiter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206914">
						October 11, 2013 11:56 AM					</a>

				</p>

				<p>Am I the only one that is thinking of the &#8220;Van Eyk phreaking&#8221; from Cryptonomicon?</p>
<p>More seriously, the most surprising part of this for me was discovering that Brice Schneier  uses Windows primarily and in extreme high security scenarios. I would have guessed OpenBSD.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206915">

			<div class="comment by-don-martin ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.securityfirstcorp.com' rel='external nofollow ugc' class='url'>Don Martin</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206915">
						October 11, 2013 11:58 AM					</a>

				</p>

				<p>Bruce, the problem with crypto is that it is subject to brute force attack, either at rest or capture and playback.  You are welcome to use my technology that randomizes the encrypted data and disperses forensically non-discernible data to multiple Cloud storage providers.  Even the file names and directories have Suite A security so that no file name can be mined or ads placed based upon content.</p>
<p>Also, you are welcome to use the World&#8217;s Most Secure File Transfer.  Here is my personal invite:  <a href="http://tinyurl.com/SFC-CTO" rel="nofollow ugc">http://tinyurl.com/SFC-CTO</a></p>
<p>Once you install this you have the option to create a defense strength key of 15380 bits.  The 1.5 minute video at that link will explain the concept.  Provably secure&#8230;<br />
Don</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206917">

			<div class="comment by-impossibly-stupid ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.impossiblystupid.com/' rel='external nofollow ugc' class='url'>Impossibly Stupid</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206917">
						October 11, 2013 12:08 PM					</a>

				</p>

				<p>&#8220;I have met people who have physically removed the camera, microphone, and wireless capability altogether. But that&#8217;s too much paranoia for me right now.&#8221;</p>
<p>Given the increasing popularity of Raspberry Pi and other similar minimalist computers, it might just make good sense to set up a cheap air gap system without those features in the first place.  No paranoia necessary.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206918">

			<div class="comment by-aaron-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://redsymbol.net' rel='external nofollow ugc' class='url'>Aaron Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206918">
						October 11, 2013 12:22 PM					</a>

				</p>

				<p>Regarding this: <em>Note: the first company to market a USB stick with a light that indicates a write operation &#8212; not read or write; I&#8217;ve got one of those &#8212; wins a prize.</em></p>
<p>&#8230; It would be wonderful for such a write indicator to be able to signal (a) whether a write is currently taking place, AND (b) whether a write has taken place <b>at all</b> since the stick has been plugged in. Could be done with the same light; darkened when first plugged in, blinking while a write operation is happening, and lit up (maybe at half intensity) if it was blinking at any point while your attention was elsewhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206919">

			<div class="comment by-lucas-luitjes ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.betabuffer.com' rel='external nofollow ugc' class='url'>Lucas Luitjes</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206919">
						October 11, 2013 12:27 PM					</a>

				</p>

				<p>I strongly recommend Ubuntu Privacy Remix for airgapped machines with these requirements. They&#8217;ve gone to extreme lengths without sacrificing too much usability:</p>
<p>All network support (LAN, wifi, bluetooth, etc) has been removed. Local harddrives can&#8217;t be accessed, as support has been removed at kernel level. Removable media and TrueCrypt volumes are mounted using noexec, so nothing from external storage can be executed. It also has a custom user-friendly GnuPG frontend, and all the crypto software you might need.</p>
<p><a href="https://www.privacy-cd.org/en" rel="nofollow ugc">https://www.privacy-cd.org/en</a></p>
<p>It contains most of the basic office software. To be honest I&#8217;m surprised it&#8217;s not more well-known in these circles.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206920">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206920">
						October 11, 2013 12:32 PM					</a>

				</p>

				<p>The simple solution is this: once media has touched the clean system, it must be destroyed. The only way to get information off of the clean system is to print it out. They can compromise the system, but the worst they can do is wipe your info out.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206921">

			<div class="comment by-eric ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://brownhatsecurity.com' rel='external nofollow ugc' class='url'>Eric</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206921">
						October 11, 2013 12:39 PM					</a>

				</p>

				<p>I see a mention of a &#8220;one-way ethernet cable&#8221; in the comments above; those are a little complex to implement properly, but I have in the past used the serial equivalent&#8211;I was involved with a project that required unidirectional data communication, and the infrastructure of choice for one of the connections was a 25-pin serial cable with half the data pins physically disabled.  Another method used three UTP -&gt; optical fiber converters, set up so the xmit on one sent to the recv on the other; the third was used as a keepalive for the transmitter.</p>
<p>One particular aspect that is absolutely essential in all these methodologies, though, is that your security may be technically perfect, but you only have to slip up once&#8211;mess up reconnecting your media converter, mess up disposing of used media, mess up by being slightly too predictable in where you go to download your information&#8211;and you&#8217;ll give up the whole game.</p>
<p>It&#8217;s sort of the dark side of the &#8220;Data wants to be free&#8221; philosophy, if you look at it; even the data that you want to stay private will end up free unless you take special measures to prevent its&#8217; dissemination.  Consider that most of the various leaks that we&#8217;ve heard about recently were intended to be kept secret by agencies who are, definitionally, all about the business of keeping and finding secrets&#8211;if you want to ensure your data is safe from illicit surveillance, you will have to take measures at least as effective.</p>
<p>The one advantage that persons in the private sector have over government agencies is that there&#8217;s a lot more private persons than there are government workers; there&#8217;s only so much, even with technical considerations, that government workers can surveil in a day.</p>
<p>However, on the down side, if you come to the agencies&#8217; attention specifically&#8211;if you become a person of interest&#8211;then that slim advantage of numbers goes away.  The more interest you generate, the more resources will be brought to bear on you, and the less effective your attempted countermeasures will be.</p>
<p>It may be worthwhile for persons engaged in active work of a nature that might generate surveillance to take a leaf from special operations methodologies, and to adopt different pseudonyms for individual operations and activities, even to the point of avoiding the development of a reputation in the field&#8211;it&#8217;s much more difficult to track a throwaway nom-de-guerre than it is to track the identity of a reputed individual.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206922">

			<div class="comment by-czerno ">

				<p class="commentcredit">

					<span class="commenter">Czerno</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206922">
						October 11, 2013 1:14 PM					</a>

				</p>

				<p>Regarding the notion of a &#8220;physical&#8221; write protect switch :<br />
you&#8217;d want to check with the vendor and/or by inspection and reading specifications (if available) that&#8230;</p>
<p>&#8230;the &#8220;physical&#8221; switch /does/  prevent writes absolutely, IOW, I would be concerned that a switch, while advertised as a write protection, in fact might /just/ set a bit telling the device (firmware) : dear device, do not write to the medium please !</p>
<p>Lest of course, subverted firmware &#8211; possibly even from factory &#8211; will be able to write to the medium unbeknownst.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206923">

			<div class="comment by-secret-police ">

				<p class="commentcredit">

					<span class="commenter">Secret Police</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206923">
						October 11, 2013 1:25 PM					</a>

				</p>

				<p>HiStar mini o/s is good for text files, but I dont think they ever finished it as it became a commercial VM product. You can at least manually verify the code yourself as it isnt gigantic.  OpenBSD is still the best coded, and best maintained system available  Anybody interested in it should buy Absolute OpenBSD 2 that just came out which is written for the latest/current BSD release. The very cautious way they introduce new software and features is what I like best, no ramming into the kernel of blobs then hoping for the best. Can also run a live cd in secure level 2 so no NSA docs can attack the system. Ciphertite has an encrypted backup scheme for OBSD too</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206924">

			<div class="comment by-test ">

				<p class="commentcredit">

					<span class="commenter">test</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206924">
						October 11, 2013 1:28 PM					</a>

				</p>

				<p>You can easily and securely erase optical media in a microwave oven. Just set it on top of a half-full mug of water and nuke it until the sparks stop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206925">

			<div class="comment by-secret-policia ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://my_url.itali.ca.com' rel='external nofollow ugc' class='url'>Secret Policia</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206925">
						October 11, 2013 1:36 PM					</a>

				</p>

				<p>RE: #1. The ultra-paranoid approach does not protect you from malware shipped from the factory which is likely to be found on most super-bloated OEM Windoze boxes (as you might find in &#8216;big box stores&#8217;).</p>
<p>Also, why not just flash the firmwares of the same machine before re-downloading the virus-checked cloud store (rather than buy two identical machines)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206926">

			<div class="comment by-arfnarf ">

				<p class="commentcredit">

					<span class="commenter">Arfnarf</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206926">
						October 11, 2013 1:41 PM					</a>

				</p>

				<p>Bruce<br />
What are you actually using your air-gapped computer for?</p>
<p>With the only the software you listed all you can do is a) read stuff that originated on a non-air-gapped computer and b) write stuff that will be sent to a non-air-gapped computer.</p>
<p>Either way, what does the air-gap buy you? What am I missing?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206927">

			<div class="comment by-secret-police ">

				<p class="commentcredit">

					<span class="commenter">Secret Police</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206927">
						October 11, 2013 1:44 PM					</a>

				</p>

				<p>Derr, I forgot the best reason for using *BSD. Yarrow and other carefully tested and proven robust PRNGs. The linux /dev/random is crippled now unfortunately unless you build your own extractor or use TRNG entropy keys. Considering nation states put considerable resources into sabotaging and researching existing PRNGs should probably make it a priority for any air gapped system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206928">

			<div class="comment by-cdmiller ">

				<p class="commentcredit">

					<span class="commenter">cdmiller</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206928">
						October 11, 2013 2:27 PM					</a>

				</p>

				<p>From my armchair&#8230;</p>
<p>Airgap + wireless hardware in the system != air gap.</p>
<p>Second all the calls for a linux or BSD based OS install, live CD or read only flash OS medium, encrypted directories or partitions on removable storage.</p>
<p>Really like the idea mentioned of a small low powered Raspberry Pi type system built from the ground up, especially in light of the minimal workload (primarily word processing).  This format also makes it easier to move or hide the whole system and multiple systems are cheap to set up.  The smaller it is the easier it is to wrap it in tin foil or shield it from EMP&#8217;s 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206929">

			<div class="comment by-mike-nomad ">

				<p class="commentcredit">

					<span class="commenter">Mike Nomad</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206929">
						October 11, 2013 2:39 PM					</a>

				</p>

				<p>Done the AirGapped thing for years: Wired peripherals, OpenBSD (command line only), SneakerNet (SD cards), Text Files, and BURP for good measure.</p>
<p>I think Bruce is just pulling everybody&#8217;s leg about that Big Box Windows rig&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206930">

			<div class="comment by-gonzo ">

				<p class="commentcredit">

					<span class="commenter">gonzo</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206930">
						October 11, 2013 2:46 PM					</a>

				</p>

				<p>A number of my friends and I have put together air-gapped machines.   None of us have any need for them, but it was sort of a have a few beers and ask ourselves &#8220;what would we need to do if we were in circumstances requiring us to REALLY do it right.&#8221;</p>
<p>Here&#8217;s how we&#8217;ve handled it:</p>
<p>We used Gateway Solo 5300 laptop machines.  Part of it was because we found a lot of six on a local craigslist sale for $100, but there was actually some thought that went into this choice:</p>
<ol>
<li>Its a machine designed and released before 9/11 and before the Microsoft DOJ settlement.    Our view is that these events were the &#8220;sea change&#8221; that lead to the virtually unfettered cooperation by  hardware  / software/ bios vendors who wanted neither to be accused of &#8220;helping the terrorists&#8221; nor ground into gristle by the DOJ.</li>
<li>They&#8217;re plentiful and cheap.   You can find them all day long on eBay for $10 to $30.</li>
<li>They run Windows XP well with unnecessary services turned off.   (Yes, we use Windows XP &#8212; more on that below).</li>
<li>The case design is easy to access and easy to modify for appropriately paranoid air-gapped machine purposes.</li>
<li>
<p>Internal wireless card easily removed.</p>
</li>
<li>
<p>Readily available 3.5 floppy drive and internal CD drives available.</p>
</li>
</ol>
<p>Here&#8217;s the set up:</p>
<ul>
<li>Wireless card is removed.</li>
<li>Case is opened up and external connectors for ALL ports except for RS232 are desoldered and/ otherwise removed from the motherboard.  (a couple guys left USB, I did not).  Those that cannot be removed have data pins snipped.  Ethernet connector is removed. </li>
<li>The battery is &#8220;hollowed out&#8221; &#8212; which is to say the cells and circuitry are removed so that the thing that snaps in place is just a hollow shell.  </li>
<li>A normally open pin switch is installed through the bottom of the case coming out of one of the feet.  This switch is wired to a simple &#8220;power on time delay&#8221; circuit powering a relay coil that controls the connection between the main external power lead and the mother board.   If the machine is lifted up, the switch opens and power is discontinued.  The power on delay timer is such that the pin switch has to be depressed for about a minute or more before the relay is energized to supply power.   Thus the power <em>wants</em> to be off.   A quick interruption of contact with the machine from the desk kills power and it cannot be re-established without a delay.    </li>
<li>Hard drive is wiped and a fresh install of Windows XP is put on.   ALL unnecessary services are turned to DISABLED.   Yes, we&#8217;re using Windows.  But this machine will never ever be connected to the internet or, directly, to any other net-connected computer.  Autorun is disabled.  There are no USB ports, no firewire, no PCMCIA, all this stuff is physically disabled, turned off in BIOS and disabled in Windows (including by the absence of driver files)</li>
<li>Once Windows is set up and running, hard drive is full system encrypted with Truecrypt or Diskcryptor.</li>
<li>Virtualbox is set up with a working DOS 6.22 VM that can talk to the serial port if you left that connected.  </li>
<li>Once everything is up and running, a vigorous memory testing software is run.</li>
<li>If all is well, the machine is opened up.   The system memory is encased in circuit board potting epoxy, the PCMCIA port is filled with potting epoxy, the hard drive connector is epoxied to the main board, the screw for the hard drive caddy is super glued in place, the floppy disk (or CD/DVD RW, if you need to shuffle bigger files) is epoxied in place,  and the machine is closed up and sealed with &#8220;tamper evident&#8221; tape.</li>
<li>Administrator password added to BIOS. </li>
</ul>
<p>Overkill, yeah&#8230; and there are still some potential issues.  But it is both air gapped and hardened against most evil maid attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-206931">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206931">
						October 11, 2013 2:46 PM					</a>

				</p>

				<p>&#8220;Hm, you actually can install everything you need without connecting to Internet ever. Most of Linux distributions have offline installations made specially for this purpose. They include most of drives/packages available. And if that&#8217;s not enough, you can easily add missing drivers/packages/software yourself.&#8221;</p>
<p>Yes, probably.</p>
<p>I&#8217;m not bothering.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-206932">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206932">
						October 11, 2013 2:49 PM					</a>

				</p>

				<p>&#8220;I hope I misread this. It <em>looks</em> as if you are suggesting that MS Windows is an appropriate choice of OS for a secure system.&#8221;</p>
<p>Lots of people have suggested using Linux instead.  Of course they&#8217;re right; it would be more secure. But for a computer not connected to the Internet, I&#8217;m not too bothered about the incremental loss of security that comes from using Windows.  And it&#8217;s what I&#8217;m used to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-206933">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206933">
						October 11, 2013 2:51 PM					</a>

				</p>

				<p>&#8220;I am not paranoid, but I am disappointed that Bruce didn&#8217;t also suggest that you should keep your computer in a Faraday box.&#8221;</p>
<p>Seems excessive to me.</p>
<p>But, yes, we can play this more-secure-than-you game pretty much forever.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-206934">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206934">
						October 11, 2013 2:53 PM					</a>

				</p>

				<p>&#8220;You&#8217;re trying to reinvent the wheel here, Bruce, and I&#8217;m afraid you&#8217;re not doing a very good job of it.&#8221;</p>
<p>Perhaps.  I&#8217;m pretty happy with my setup.  It balances security and usability in a way I am satisfied with.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-206935">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206935">
						October 11, 2013 2:55 PM					</a>

				</p>

				<p>&#8220;Note to Bruce: Don&#8217;t share the keyboard (or mices) between secure and internet computers: a keyboard may hide an USB key that the NSA can activate.&#8221;</p>
<p>Good point.</p>
<p>I&#8217;m using a laptop, so that didn&#8217;t occur to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-206936">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206936">
						October 11, 2013 2:56 PM					</a>

				</p>

				<p>&#8220;Even if you buy a computer &#8216;off-the-shelf in a big box store&#8217;, you have no way of knowing how many times it has connected to the internet before you purchased it (during assembly, etc). Also, you have very little way of knowing what&#8217;s embedded in the bios.&#8221;</p>
<p>Of course.</p>
<p>Seems like a reasonable risk to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-206937">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206937">
						October 11, 2013 2:59 PM					</a>

				</p>

				<p>&#8220;But, here is an additional question for you consideration. Are your would be attackers more interested in stealing your information or simply destroying it? Because encryption is useless in the latter case. You need something else.&#8221;</p>
<p>Stealing.</p>
<p>There are sufficient backups of the information around the world.  I don&#8217;t think it is possible for any power to execute a simultaneous attack and delete everything.  And the risks of a massive data dump if the attack fails are too great.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-206938">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206938">
						October 11, 2013 3:00 PM					</a>

				</p>

				<p>&#8220;Bruce is basically relying on a fact that it would be a very bad PR move to harass him now, and that the milk has been spilt already. He&#8217;s only trying not to leave obvious traces and open cracks for some overzealous lowly FBI agent or someone like that.&#8221;</p>
<p>Yes.  That definitely figures into my threat model.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-206939">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206939">
						October 11, 2013 3:02 PM					</a>

				</p>

				<p>&#8220;What are you actually using your air-gapped computer for?  With the only the software you listed all you can do is a) read stuff that originated on a non-air-gapped computer and b) write stuff that will be sent to a non-air-gapped computer.  Either way, what does the air-gap buy you? What am I missing?&#8221;</p>
<p>I am using it for your (a): to decrypt and read existing files.  And is is buying me the ability to do that securely.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206940">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206940">
						October 11, 2013 3:07 PM					</a>

				</p>

				<p>It would be more interesting if Bruce expanded on how security can be scaled in real world applications such as utility company trying to protect its SCADA system where the average employee can&#8217;t be expected to look at the back of a DVD to see what percent had been written or a gov/mil network where you have to worry about the next manning/snowden insider using those usb and dvd to steal data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206941">

			<div class="comment by-greg ">

				<p class="commentcredit">

					<span class="commenter">Greg</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206941">
						October 11, 2013 3:47 PM					</a>

				</p>

				<p>I haven&#8217;t ready every comment and apologies if these two points are already covered, but I would also disabled auto-mount which I consider completely separate from auto-run functionality.</p>
<p>I would also make sure your air gap system does not have a Firewire interface at all.  No FW interface, not a disabled FW interface &#8211; this is really important.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206942">

			<div class="comment by-chrisb ">

				<p class="commentcredit">

					<span class="commenter">chrisb</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206942">
						October 11, 2013 3:51 PM					</a>

				</p>

				<p>I am baffled by this post, frankly.</p>
<p>Rather than the NSA, don&#8217;t you need to watch out for the <em>bad</em> guys who are very much beyond the law, who would like to seize those documents?  How many million or billion dollars of 0day exploits are you air-gapping?  Have some of the exploits already leaked?  Did bad guys buy some Booz Allen 0days before Snowden&#8217;s actions?</p>
<p>If you are concerned about the NSA, shouldn&#8217;t you get good lawyers and a legal fund, rather than worry about air-gapping and encryption?  The stolen files are the property of the NSA!</p>
<p>NSA are the good guys and everyone can see that as the US and European legal systems begin to react.</p>
<p>Thanks for everything that you are doing to get us back to security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206943">

			<div class="comment by-mike-nomad ">

				<p class="commentcredit">

					<span class="commenter">Mike Nomad</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206943">
						October 11, 2013 3:56 PM					</a>

				</p>

				<p>Bruce,</p>
<p>Would you give us some sort of list/explanation of your hierarchy regarding risks, acceptable risks, and what your threat model looks like that lead to your 10 Rules For The Paranoid?</p>
<p>Things like, &#8220;I&#8217;m not too bothered about the incremental loss of security that comes from using Windows. And it&#8217;s what I&#8217;m used to.&#8221; certainly point to some sort of calculus being done. I think I&#8217;m not the only one that would like to see what bits (sorry) are being weighed, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206944">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206944">
						October 11, 2013 4:53 PM					</a>

				</p>

				<p>Not wishing to make people totally paranoid but if you go to all these lengths to air-gap a system you also need to remove the possibility of communications over the power-supply back onto the 110AC (or 220AC) depending on where you are. In the US it is typical to have 5 or 6 houses on a given phase after the local transformer. In Europe it is not uncommon to have 100 or more houses connected to a given 220V phase.</p>
<p>All computers these days use switched mode power supplies (SMPS) these are small/lite ferrite core transformers switched typically at about 150Khz.  This switching noise is easily seen anywhere on the same AC feed from the main transformer by simply connecting any oscilliscope or spectrum analyzer.  So if your adversary has access to the same AC phase feed as you they easily can tell if there is an appliance with a SMPS connected to the AC power.</p>
<p>If your adversary is only interested in low bit rate return channels (say less than 100 bits per sec) then they can modulate the bursts of power that the PC takes ( this is done simply controlling the run time of some bogus process that does lots of computations = lots of power when this process is running), this in turn means increased SMPS noise amplitude. Since the 140Khz SMPS noise is visible anywhere on the same AC phase, it follows that the modulation is also visible anywhere.  Hence we have a return channel.</p>
<p>Solution: Always use the laptop running off the battery while disconnected from the AC power. AND always recharge the battery either outside the computer OR while the laptop is switched off. For desktops use UPS (uninterruptable power supply) and the same procedure.</p>
<p>P.s. with the UPS approach remove that nasty beeper noise thingy that goes off when the AC power is not present its not a return channel but it&#8217;ll give you a heck of a head ache.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206945">

			<div class="comment by-eric ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://brownhatsecurity.com' rel='external nofollow ugc' class='url'>Eric</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206945">
						October 11, 2013 5:25 PM					</a>

				</p>

				<p>RobertT: A low-pass filter on the circuit for your secured system&#8217;s power supply will allow the 60Hz power to go through while blocking any higher frequency noise.  You may also want to consider separating the electrical ground for your secured equipment.</p>
<p>Low-pass filters are pretty easy to construct; it can be done by wrapping the power cable around a ferrite core.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206946">

			<div class="comment by-alain-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">Alain from Switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206946">
						October 11, 2013 5:29 PM					</a>

				</p>

				<p>(slightly off-topic)</p>
<p>I had one computer off the internet for about two weeks, i.e. with an air gap. Did not use it for anything&#8230; Even though I write software for a living, or maybe also because of that, like for most people today for me a computer has effectively become a device to communicate. Without that option it is pretty much moot, except maybe when I make my tax declaration and so &#8211; but how can I know these days that the administration where I submit my tax declaration will remain protected.</p>
<p>A killer app for me (besides email) is Facebook, because unlike most other stuff on the internet is is not just (mainly male) geeks or otherwise just a few people, it is lots of people who otherwise have nothing much to do with computers (except email and ordering things online). Just re-uploaded holiday pictures and so to Facebook, but avoided mostly photos with people I know on them.</p>
<p>Other that that, I guess I just gave in and now trust in advance and hope that somehow the &#8220;verify&#8221; part will also happen in the USA and in the world&#8230;</p>
<p>I guess also the NSA has to adapt that the fact that they face billions of people with sophisticated (but at the moment very insecure) communciation devices and that most of them &#8211; in or out of the USA, US citizens or not &#8211; are no danger, rather the contrary, represent what they should protect.</p>
<p>Still, a bit spooky to think that likely all that people will do online in the coming decade or so will be recorded and kept. At least this might make historians happy in a 100 years or so&#8230; (and I am not even sarcastic about that part)</p>
<p>Thanks for reading 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206947">

			<div class="comment by-alain-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">Alain from Switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206947">
						October 11, 2013 5:32 PM					</a>

				</p>

				<p>PS: For reading Snowden documents or writing about them, of course, an air gap makes sense 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206948">

			<div class="comment by-scott ">

				<p class="commentcredit">

					<span class="commenter">Scott</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206948">
						October 11, 2013 5:37 PM					</a>

				</p>

				<p>Reading the comments here, I think you reach a point where you are so concerned about securing your system that you forget about having anything sensitive enough to warrant anyone trying to hack it in the first place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206949">

			<div class="comment by-spacetruck ">

				<p class="commentcredit">

					<span class="commenter">SpaceTruck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206949">
						October 11, 2013 6:00 PM					</a>

				</p>

				<p>Sound might be an easy way to defeat an air gap. Many speakers and microphones could probably use frequencies above human hearing. If there is any networked computer or cell phone within the room, its microphone and speakers could be compromised to become a relay. Of course the air gapped computer would have to get infected first.</p>
<p>Almost any computer without hurricane shielding could probably be manipulated to transmit radio waves in various ways, such as by oscillating the voltage on a usb, audio, or video cable. Redundant modulation schemes can extract extremely faint signals from far below the noise floor.</p>
<p>Nearby wifi access points, computers with wifi, cell phones, and maybe smart electric meters, could be compromised to make convenient receivers. Alternatively, a high gain antenna anywhere within a few miles could probably pick up the signals. I wouldn&#8217;t be surprised if the FBI already has such TEMPEST antennas spread around major cities.</p>
<p>A data diode could be useful to keep data flow one way. They&#8217;re traditionally electronic, but the security of an electronic one might be hard to audit if you don&#8217;t have a deep understanding of electronics. A mechanical version would be a little slow, but could be more obviously one way, and more easily constructed at home. It might consist of something like a solenoid rapidly flipping a switch, or mirror tape stuck to a speaker cone deflecting a light beam across a photo resistor. A third computer could monitor the switch flips and have no other function but to display all data passed through the data diode.</p>
<p>Paper printout and OCR might make a good data diode. But beware the side channel already implemented in color printers, whereby a pattern of light yellow dots encoding the printer serial number is printed out on every page to facilitate tracking of counterfeit money printing.</p>
<p>It might help to have two air gapped computers. One that only receives data through a diode, like encrypted emails to be read, and another that only sends out data through a diode, like emails to be sent or articles to be published. That way, the sending computer will be hard to infect, and if the receiving computer is infected, it will be harder to exfiltrate the secret keys, passwords, etc. You may even want a third computer for those occasions where you must send and receive on the same computer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206950">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206950">
						October 11, 2013 6:05 PM					</a>

				</p>

				<p>BTW dont under estimate the possibility that a sneak&#8217;n&#8217;peak team will be sent in, its much more common than I originally thought, although I travel to lots of unfriendly places so that might be part of the problem. You also need to take steps to physically secure the laptop while you&#8217;re not using it. I recommend you learn the phrase &#8220;Thermite is fun&#8221;, print it in big letters on the safe that secures the laptop, anyone that has EVER seen a thermite charge go off wouldn&#8217;t risk touching the safe. Trouble is its a little difficult to get thermite through Airport security, personally when on the road I use a combination of Steel-wool with a suitable oxidizer and a mercury switch coupled to  disposable battery to activate. Its not Thermite but you&#8217;ll definitely know if someone has touched the laptop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206951">

			<div class="comment by-mike-acker ">

				<p class="commentcredit">

					<span class="commenter">Mike Acker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206951">
						October 11, 2013 6:34 PM					</a>

				</p>

				<p>@Scott &#8220;Reading the comments here, I think you reach a point where you are so concerned about securing your system that you forget about having anything sensitive enough to warrant anyone trying to hack it in the first place.&#8221;</p>
<p>the fundamentals of security is simply to make the cost of breaking in greater than the anticipated value of the target</p>
<p>I&#8217;m an ORF* now so anything I do is basically hobby/curiosity type stuff.</p>
<p>one item that really has my attention is this &#8220;Apparmor&#8221; product.  Originally from Novell (if memory serves)</p>
<p>the interesting thing about Apparmor is that it seems to be a very significant extension to security operations: With Apparmor we are concerned not only with who you are &#8212; but what program are you using &#8212; and what are you trying to do with it.</p>
<p>For example I should be able to limit Firefox to access only the /documents area, excluding my /correspondence sub-directory.</p>
<p>I have played with this a bit already but I need to do more.</p>
<p>If you think about the concept &#8212; the implications for securing a system are pretty interesting.   Put LibreOffice into an Apparmor profile and you should be able to stop any macros or scripts from accessing areas that should be off limits &#8212; but are not &#8212; because when you sign on &#8212; you then have access to everything that you &#8220;Own&#8221; &#8230; using any program &#8230;</p>
<p>I need to learn more about this concept.<br />
~~~<br />
* &#8220;ORF&#8221; : Old, Retired, FELLOW.    don&#8217;t ask my wife to re-state this acronym ( tee hee ) .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206952">

			<div class="comment by-evilminionsinc ">

				<p class="commentcredit">

					<span class="commenter">EvilMinionsInc</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206952">
						October 11, 2013 7:18 PM					</a>

				</p>

				<p>Good news everyone! There&#8217;s a faster and more efficient technique.</p>
<p>Step 1. Setup airgap.<br />
Step 2. IF arrival of &#8216;inspection team&#8217; THEN Follow them to HQ. ELSE Step 5.<br />
Step 3. Orchestrate operation LASER SHARK<br />
Step 4. DO Step 1 &#8211; 4 UNTIL BREAK<br />
Step 5. Setup the real airgap.</p>
<p>You thought the management of SPECTRE were crazy for living in volcanoes, moon hotels, and underwater bases. Who&#8217;s laughing now!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206953">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206953">
						October 11, 2013 7:40 PM					</a>

				</p>

				<p>@Eric,<br />
You can definitely add a Low pass Filter to the power supply but you need to understand how by many db the Conducted RFI emissions must be suppressed before the signal is undetectable by the adversary. I&#8217;d usually want the signal (140Khz) to be at least 40 db below the background noise of the system. So you need to use a Spectrum analyser to see just how much system noise exists before you know how good a filter to build.</p>
<p>On a more technical note: it is reasonably easy to build a good differential mode AC line filter (filters Active/Netural) unfortunately it is VERY difficult to build a good Common-Mode Line Filter.</p>
<p>So I&#8217;ll stick with the advice just use a battery to power the system.</p>
<p>PPS: I should also mention that return channel Power Supply comms is also easily achieved by modulating the power usage in bursts synchronous with the AC line frequency (50 or 60 hz). What this does is to create a phase modulation on the moment of SMPS &#8220;in-rush-current&#8221;, this point will move about in time because the main storage cap in the power supply sees its voltage amplitude modulated by the AC synchronous high power software task.</p>
<p>IF the storage cap voltage is lower, THAN the delay after the AC zero cross point (where the AC line signal (50Hz) forward biases the bridge diodes) is decreased (or phase modulated in comms speak) so the Amplitude modulation of the storage cap is turned into a phase modulation of the AC Current.  This return channel can only transfer about 10bps BUT it can be observed on the MV (typically 11KV) side the AC transformer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206954">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206954">
						October 11, 2013 7:41 PM					</a>

				</p>

				<p>Secret Police: agreed with your call re Linux PRNG!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206955">

			<div class="comment by-not-saying ">

				<p class="commentcredit">

					<span class="commenter">Not saying...</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206955">
						October 11, 2013 7:43 PM					</a>

				</p>

				<p>Best bet: post the ten things you are doing. Then make sure you are doing something completely different.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206956">

			<div class="comment by-spacetruck ">

				<p class="commentcredit">

					<span class="commenter">SpaceTruck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206956">
						October 11, 2013 8:08 PM					</a>

				</p>

				<p>Another air gap data exfiltration trick is the LED, which almost every computer has. Late at night you might notice that an LED lights up a whole room. They can just point a telescope at your curtains and probably get a fairly decent data rate, possibly even in the daytime. With a flashing frequency above about 60Hz, the LED would appear to be lit steady, even if you look right at it.</p>
<p>If 1GB flash chips are bigger than you need, you could try serial EEPROM chips. They come in sizes down to just a few KB or less. You could use a USB to SPI or I2C converter and ZIF socket to load/read the chip. An EEPROM chip would have the additional advantage of being less likely to expose vulnerabilities of your operating system that a USB drive might exploit.</p>
<p>If you are going to use a USB drive, you might want to connect a USB protocol analyzer to capture all data loaded to the USB drive. If they do attack your USB drive, it would be interesting to analyze their method. If you announce you&#8217;re using a USB protocol analyzer, it may make it less likely they&#8217;ll attack that way and risk exposing their highly valuable air gap breach methods.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206957">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206957">
						October 11, 2013 8:38 PM					</a>

				</p>

				<p>@ AlanS</p>
<p>Qubes is a nice project. It tries to air gap computers virtually. Physical air gaps are <em>much</em> better for security, though. With Qubes, they have hardware to try to share in secure ways through various layers of software and they must try to do this without vulnerabilities. With a real air gap solution, there are two separate pieces of hardware that do controlled sharing along one interface. Hint: security analysis of one of these is <em>much</em> easier than the other.</p>
<p>&#8220;Linux has many of the same security issues as Windows. See:&#8221;</p>
<p>And since a Xen-based solution has Linux in its TCB it means Qubes might have issues because it depends on it. (Unless they somehow removed all influence on secure operation the Linux and Xen code might have. Somehow.) There&#8217;s also very few Dom0 host platforms, thereforce easier for a major adversary like NSA to target. With a physical solution, you can use a vast array of systems for the trusted PC whose chronology goes way back and the main untrusted system has quite the variety itself. Such a flexible setup can also take advantage of latest vulnerability mitigation technologies which often isn&#8217;t possible if you stick with a complex, GPL, platform.</p>
<p>So far, even MILS solutions with tiny (sub-10Kloc) kernels designed for separation and user-mode stacks designed for partitioning have unconvincing assurance arguments for desktop use and people have found potential covert channels. One team of major SKPP promoters recently downgraded their security claims for this reason. So, what does that mean for solutions based on complex VM platforms with Linux in their TCB and not designed for security at every level? Logically, they will fare worse when highly sophisticated attackers target them. Right now, they have the Mac-like advantage of not being targetted by anyone with skill, money and motivation.</p>
<p>@ OpenBSD</p>
<p>&#8220;@AlanS, one post about Qubes was enough; three posts look like advertisment.&#8221;</p>
<p>That was my thought. But, hey, some people get excited about certain tech. I used to promote separation kernel architecture a lot b/c it was low TCB, composable &amp; had commercial support. I was a bit too excited about it, though. Can happen to anyone. 😉</p>
<p>&#8220;Note to Bruce: Don&#8217;t share the keyboard (or mices) between secure and internet computers: a keyboard may hide an USB key that the NSA can activate&#8221;</p>
<p>It&#8217;s a bit paranoid. A good, cheap, foreign made KVM switch will probably be fine. Has worked for many for years, actually. Overall, though, as total physical separation as possible is a good thing. Anyone with extra paranoia or precaution is justified these days.</p>
<p>@ Brian M.</p>
<p>Re using serial ports, different processor architectures</p>
<p>Good stuff. 🙂</p>
<p>@ AVee</p>
<p>This one is worth highlighting:</p>
<p><b>&#8220;Frankly, I don&#8217;t get the fuzz about the choice of OS for the airgapped system. You use the airgap because you assume the OS isn&#8217;t secure enough in the first place.&#8221;</b></p>
<p>Excatly! The separation, input validation and sharing mechanisms are where the real effort should go. All those non-Intel architectures I mentioned come with OS&#8217;s that probably have plenty residual flaws. It doesn&#8217;t matter, though, because the whole point of using them is that the enemy doesn&#8217;t know what you&#8217;re using due to variety &amp; that you never live connect them. If the transfers are careful (esp one way) &amp; you regularly clean slate the trusted machine, there&#8217;s little to nothing their fire-and-forget attacks will accomplish. Even if it&#8217;s Windows 95.</p>
<p>@ Mike Nomad</p>
<p>&#8220;Done the AirGapped thing for years: Wired peripherals, OpenBSD (command line only), SneakerNet (SD cards), Text Files, and BURP for good measure.&#8221;</p>
<p>Sounds good cept the SD cards. They&#8217;re probably OK but easier to subvert than CD&#8217;s and such. The more complicated tiny electronics the worse for subversion is one of my rules of thumb.</p>
<p>&#8220;I think Bruce is just pulling everybody&#8217;s leg about that Big Box Windows rig&#8230;&#8221;</p>
<p>I doubt it. There&#8217;s nothing wrong with a Windows box in the right air gap setup. There&#8217;s <em>better</em> options but most of the security is from denying the enemy knowledge of and access to system operation, esp. persistent long-term attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206958">

			<div class="comment by-mike-nomad ">

				<p class="commentcredit">

					<span class="commenter">Mike Nomad</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206958">
						October 11, 2013 9:05 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>&#8220;Done the AirGapped thing for years: Wired peripherals, OpenBSD (command line only), SneakerNet (SD cards), Text Files, and BURP for good measure.&#8221;</p>
<p>Sounds good cept the SD cards. They&#8217;re probably OK but easier to subvert than CD&#8217;s and such. The more complicated tiny electronics the worse for subversion is one of my rules of thumb.</p>
<p>Your observation is correct, and situation dependent. Yes, they are easily subverted. If I have one on my person, and it is subverted, I have much more immediate problems to deal with&#8230; Which is why I like SD cards: I can destroy them very easily, and the little write tab seems to work.</p>
<p>@ The discussion regarding power supplies, etc. I have an old AC inverter that I was thinking about using for a next step: Take out the standard power supply in the computer, and have it rewired for DC input (since it&#8217;s all DC on the mo-board anyway), and have the DC output from the old inverter regulated and fed in. Thoughts?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206959">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206959">
						October 11, 2013 9:40 PM					</a>

				</p>

				<p>Since you posted this, BleachBit has already updated their website to quote you saying that you use their product.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206960">

			<div class="comment by-gibbon1 ">

				<p class="commentcredit">

					<span class="commenter">Gibbon1</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206960">
						October 11, 2013 11:15 PM					</a>

				</p>

				<p>&#8220;&#8221;one for reading PDF, but not having access to other stuff.&#8221;&#8221;</p>
<p>Off hand thought, an air gap, transfer files by, displaying them on one computer and then using a camera and OCR.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206961">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206961">
						October 11, 2013 11:24 PM					</a>

				</p>

				<p>gonzo<br />
&#8211;I like it.  I have a spare copy of XP, but I&#8217;d prefer to learn linux/bsd better.  It&#8217;s not overly paranoid either; these insane scenarios are no longer really funny, it&#8217;s the truth and there are people out there dealing w/ and experiencing it everyday.</p>
<p>Dv<br />
&#8211;I actually really like that strategy.  Basically, attackers won&#8217;t find your system of much use (while still being a lot of fun and of interest to you, b/c I like to think about the gates and I want to be able to trace all the activity by hand); and now maybe they will find out about counterattacks, one of my all-time favorite strategies against all attackers.</p>
<p>Bruce<br />
&#8211;Seriously, this is not going to be good for your health.  But I think this is your calling.  They&#8217;re going to study your lifestyle and basically all your nightmares will come to life.  I would trash your iPhone too, but that something that sounds like you&#8217;re not going to do.  I&#8217;ve managed to put up a fight by taking this fight to the extremes very few here would ever do, I know this for sure.  Funny enough, the agents are pretty similar to me, just slightly different situations led to me being bullied and I&#8217;ve had enough of that and will fight it to extreme levels.</p>
<p>But, Bruce, you&#8217;ve really gained a lot of respect and trust in doing this; b/c you&#8217;re putting yourself at risk.  And the derp train would just keep rolling if something drastic doesn&#8217;t happen.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206962">

			<div class="comment by-michael-moser ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mosermichael.github.io/cstuff/' rel='external nofollow ugc' class='url'>Michael Moser</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206962">
						October 12, 2013 12:13 AM					</a>

				</p>

				<p>I would use restricted account on air gap machine for reading PDF documents; also use Mozilla with PDF.js &#8211; it is an pdf viewer implemented in javascript; it should be a bit harder to exploit than regular pdf viewers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206963">

			<div class="comment by-axon ">

				<p class="commentcredit">

					<span class="commenter">Axon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206963">
						October 12, 2013 12:44 AM					</a>

				</p>

				<p>@ Nick P, @ AVee</p>
<blockquote><p>Qubes is a nice project. It tries to air gap computers virtually. Physical air gaps are *much* better for security, though.</p></blockquote>
<p>Actually, that depends on how you use the physically air-gapped machine. If the machine is <em>permnanetly</em> air-gapped, in the sense that it <em>never</em> sends or receives data to other computers (not even via sneakernet), then of course that&#8217;s true. But the behavior Bruce describes actually makes a physical air gap <em>riskier</em> in some ways. One example is the use of USB sticks. Even if you disable all the autorun mechanisms, the OS will always still have to attempt to parse the partition table on the removable storage device, at the very least to create devices (device files) symbolizing each partition or volume (e.g. /dev/sdbX). This means that malware can write a malformed partition table onto a perfectly legitimate USB stick. Suppose, then, that you have two physically air-gapped machines, belonging to two different security domains, and you want to transfer files from one to the other. You insert the USB stick into the first machine, copy some files, and then insert it into the second machine. If the first machine was compromised, it could have altered the partition table on the USB stick. Now, when the stick is inserted into the second machine, its malformed partition table might exploit a buffer overflow in the code used by the second OS to parse the stick&#8217;s partition information. And now your physically air-gapped machine has been compromised. (Incidentally, Qubes completely bypasses this attack vector by using a special inter-domain file copy mechanism that doesn&#8217;t require any metadata parsing.)[<a href="http://theinvisiblethings.blogspot.de/2011/06/usb-security-challenges.html" rel="nofollow ugc">source</a>]</p>
<blockquote><p>And since a Xen-based solution has Linux in its TCB it means Qubes might have issues because it depends on it. (Unless they somehow removed all influence on secure operation the Linux and Xen code might have. Somehow.)</p></blockquote>
<p>No offense, but this comment suggests that you don&#8217;t really understand what <a href="https://en.wikipedia.org/wiki/Xen" rel="nofollow ugc">Xen</a> and Qubes are or how they work. Xen is a <a href="https://en.wikipedia.org/wiki/Hypervisor#Classification" rel="nofollow ugc">bare-metal hypervisor</a>, which means that it runs in a more privileged CPU state than any other software on the machine. (So it literally doesn&#8217;t make sense to suggest that the &#8220;influence&#8221; of the Xen code might somehow be &#8220;removed.&#8221;) The most privileged VM is called dom0 (sometimes called the &#8220;host domain&#8221; or the &#8220;control domain&#8221;), and although this is <em>often</em> a version of Linux, it need not be (see below). (So, no, Xen doesn&#8217;t necessarily have Linux in its TCB.)</p>
<blockquote><p>There&#8217;s also very few Dom0 host platforms, thereforce easier for a major adversary like NSA to target.</p></blockquote>
<p>This, of course, depends on what number you consider to be &#8220;very few.&#8221; Linux, BSD, and OpenSolaris can all be used for dom0. (That seems like quite a variety of choice to me, personally.)</p>
<blockquote><p>This one is worth highlighting [@ AVee]: &#8220;Frankly, I don&#8217;t get the fuzz about the choice of OS for the airgapped system. You use the airgap because you assume the OS isn&#8217;t secure enough in the first place.&#8221; Excatly! The separation, input validation and sharing mechanisms are where the real effort should go. All those non-Intel architectures I mentioned come with OS&#8217;s that probably have plenty residual flaws. It doesn&#8217;t matter, though, because the whole point of using them is that the enemy doesn&#8217;t know what you&#8217;re using due to variety &amp; that you never live connect them. If the transfers are careful (esp one way) &amp; you regularly clean slate the trusted machine, there&#8217;s little to nothing their fire-and-forget attacks will accomplish. Even if it&#8217;s Windows 95.</p></blockquote>
<p>This <em>would</em> be true if the physically air-gapped machine were <em>permanently</em> air-gapped. It doesn&#8217;t take any special technical knowledge to understand this. If a computer <em>never</em> comes into contact with the outside world, then it doesn&#8217;t matter what&#8217;s going on inside of it, since no adversary is ever allowed to interact with it. The problem is that what Bruce and almost everyone who wants to set up an air-gapped system are doing <em>isn&#8217;t</em> setting up a <em>permanently</em> air-gapped machine. They still do things like transfer files to and from the &#8220;air-gapped&#8221; machine using USB sticks. But this means that the &#8220;air-gapped&#8221; machine isn&#8217;t isolated from the outside world. It&#8217;s still in contact with the outside world; it&#8217;s just that its method of communication with the oustide world is a lot slower than usual. An adversary is still able to interact with such an &#8220;air-gapped&#8221; system, as Stuxnet, agent.btz, and the example above all show.</p>
<p>If you have the discipline to set up and maintain a <em>permanently</em> air-gapped machine, that&#8217;s fine. But such a machine will be <em>severely</em> limited in its functionality, which is why almost no one has a use for one. A pseudo-air-gapped machine (by which I mean a sneakernet-connected machine like the one Bruce describes), on the other hand, is often <em>worse</em> for security because it&#8217;s almost never set up correctly, <em>and</em> it gives the user a false sense of security. (&#8220;This computer isn&#8217;t connected to the Internet. Therefore, it&#8217;s safe from people who try to attack me through the Internet.&#8221; Well, no, because you essentially <em>bring the threats of the Internet to that machine</em> every time you plug a USB stick into it which was previously plugged into an Internet-connected machine.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206964">

			<div class="comment by-axon ">

				<p class="commentcredit">

					<span class="commenter">Axon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206964">
						October 12, 2013 12:45 AM					</a>

				</p>

				<p>As an example of what I mean when I say such systems are almost never set up correctly, consider what Bruce said in point 1:</p>
<blockquote><p>The ultra-paranoid way to do this is to buy two identical computers, configure one using the above method, upload the results to a cloud-based anti-virus checker, and transfer the results of that to the air gap machine using a one-way process.</p></blockquote>
<p>We&#8217;re talking about a world-famous computer security expert here, who thinks that this procedure is for the &#8220;ultra-paranoid,&#8221; and yet it <b><em>doesn&#8217;t even fit his threat model</em></b>. Bruce states that his goal is &#8220;to try to stay secure from the NSA.&#8221; But as we all now know, and as Bruce himself was instrumental in showing, the NSA works to create and stockpile <em>zero-day</em> malware, which is <em>by definition</em> incapable of being detected by anti-virus software (until it is later discovered, which we should assume to be <em>after</em> it has been used against a relatively valuable target like Bruce). In other words, what Bruce <em>thinks</em> is an &#8220;ultra-paranoid&#8221; (and presumably therefore ultra-secure) security measure is in fact <em>entirely useless</em> given his threat model, in much the same way that his advice about using an &#8220;air-gapped&#8221; machine negates most of the benefits of the physical separation (and in many cases creates new vulnerabilities to be exploited).</p>
<p>I could go on all day, but I&#8217;m going to stop myself here. Bruce: I like your blog, and I like you. But frankly, this is just bad.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206965">

			<div class="comment by-patricia ">

				<p class="commentcredit">

					<span class="commenter">patricia</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206965">
						October 12, 2013 12:59 AM					</a>

				</p>

				<p>The properties of my airgap system:</p>
<ol>
<li>It is inexpensive.</li>
<li>It is not require much technical know how (not reverse engineering your BIOS to verify its integrity or trying to debug rootkits).</li>
<li>The overhead involved is scalable to the amount of security required.  That is, many shortcuts can be taken without weakening the overall system.</li>
<li>It is an unambiguous set of steps that don&#8217;t require judgment to be performed.</li>
<li>It is fault tolerant (many components can get pwned, and it still is very secure).</li>
<li>It is effective against a variety of threat models, up to and including a nation-state which has full knowledge of your setup, a team of hackers working to pwn you individually, and a black bag team that can enter your home without your knowledge.</li>
</ol>
<p>Let&#8217;s call our adversary Eve.  I believe unless Eve can bring to bear the resources described in item 6, your setup is perfectly secure.  Any feedback on the protocol I describe would be appreciated.</p>
<p>The threat models we will consider:</p>
<ol>
<li>A targeted attack in which the Eve has perfect knowledge of your setup and unlimited resources to craft an attack over the internet.</li>
<li>Same as 1, but they will attack using malware which infects your hardware (BIOS, NIC, etc.) before you purchase it (the supply chain attack).</li>
<li>Side channel attacks</li>
<li>Black bag/ physical access to your home and computers.</li>
<li>
<p>Untargeted attacks</p>
</li>
</ol>
<p>I assume the reader can acquired uninfected software.  One method for doing this is documented on the TOR website.  The basic idea is to download from multiple sources, from multiple internet connects, compare the hashes, and verify downloads with PGP signatures.</p>
<p>Here&#8217;s the setup:</p>
<p>The first computer (which I&#8217;ll call CannonFodder) connects to the internet via TOR, ideally with PORTAL between the computer and the internet.  PORTAL is the grugq&#8217;s open source project which installs on Raspberry Pi and acts like a proxy forwarding all your traffic to TOR.  Recently a hidden service was discovered on TOR which hacks the browser and phones home through the user&#8217;s non-TOR internet connection the actual IP address and MAC address of the user.  PORTAL prevents this attack by only allowing traffic to route through TOR, and blocking any other traffic.</p>
<p>The purpose of CannonFodder is to receive PGP encrypted messages and send PGP encrypted messages.  It&#8217;s what connects to the internet so the rest of the equipment doesn&#8217;t have to.  While it will be assumed to be hacked into and rootkit&#8217;ed, it is not going to be an easy target.</p>
<p>On CannonFodder install whatever personal security products you can get your hands on.  Anti-virus, anti-persistence software, software that whitelists good processes and blacklists bad processes, EMIT&#8230; anything and everything possible.  Make sure the OS and all software on it is patched regularly.  What OS runs on the host is up to you.  The host will run a VM and nothing else.  What virtualization software you use is up to you, but the OS you run in the VM should be different from the host.  So if the host is windows, the VM should be some flavor of linux or BSD.</p>
<p>The VM is going to run another VM.  That VM will be a third OS, different from the other two.  It&#8217;s only job is to run a browser that can connect to TOR.  Whether that means the TOR browser bundle, or Chrome connecting through PORTAL, it is up to you.  Chrome is a good choice, since it auto-updates itself, making patching mindless.  Once the VMs are set up, snapshot them.  After every use, revert to the most recent snapshot.  When new patches become available, revert the VMs, apply the patches, and take a new snapshot.</p>
<p>Make sure the browser has NoScript installed (meaning no javascript).  Do not whitelist any websites in NoScript.  Make sure the browser has no plugins installed besides NoScript.  That means no Java, no silverlight, and certainly no flash.</p>
<p>The idea of all of this is if someone tries to exploit your browser, they might not get a rootkit on your host, because Eve may not have realized you are in a VM, and therefore might not be prepared to escape your VM.  She may not even have a VM escape.  If she does, she will still need to have a variety of exploits and be willing to use them against you.  She may be unwilling because you are not a noob, a complicated setup like your&#8217;s could trip up her exploits, and maybe expose them in a way that you can steal them.  Think about it: Eve needs VM escapes for two different pieces of software, code that can run in all flavors of  Linux, Windows, and BSD, possibly privilege escalations for each of those OS&#8217;s, and most likely the ability to navigate PORTAL before phoning home.  You are a complicated target relative to most people on the internet.  Patched software ensures Eve must throw 0day at you.  Personal security products can trip up her exploits or mean she&#8217;ll have to invest even more individual attention in crafting exploits that sidestep your protections.</p>
<p>If CannonFodder is running on Sparc or MIPS or ARM, even more bonus points, because now even fewer people have the expertise required exploit and rootkit you.</p>
<p>CannonFodder is only used for visiting email, saving email, sending email, and burning CDs.  No other browsing is allowed.  A different email account is used for every different pen pal.    In between logging into each email account, a new TOR identity is generated&#8211; in the TOR browser bundle just click the generate new identity, using PORTAL it is a little more complicated.  Messages should move from public email addresses tied to real identities to burner email accounts as quickly as possible.  You should register a new email address for each new pen pal you correspond with.  The email address should have no information that ties your real identity or your pen pal&#8217;s real identity to the address.</p>
<p>CannonFodder can either be a laptop (which has had the camera removed, the mic destroyed, etc.) or a desktop.  A laptop has the advantage that you can take it to different restaurants and connect to a different wifi access points every time CannonFodder connects to the internet.  A desktop has the advantage of convenience (driving to a new access point every time you want to send an email eats up a lot of time).  The downside to the laptop is other users of the wifi access point can attack your laptop.  The downside to the desktop is your IP address is easy to obtain from your internet company, and with your IP address it is not far fetched that Eve can hack your router, and then your desktop.</p>
<p>Every day (or every other day, or every week) check the email accounts.  Each email account gets its own CD.  Any messages received from Alice are burned to CD A, any messages received from Bob are burned to a separate CD B, and so on.</p>
<p>By using TOR, not browsing the internet, and using random email accounts the hope is that you will be harder identify as someone to target and harder to locate once you are targeted.  The VMs and other mitigations will ideally tip you off once you are targeted since your unusual setup could cause their attack to fail in a loud way.  Even if it doesn&#8217;t tip you off, it may be effective in preventing your computer from being rootkit&#8217;ed indefinitely, since Eve may not have the techniques readily available to breakout of your VMs.</p>
<p>Even given all these precautions, we will always assume CannonFodder is owned and has a rootkit which is recording every keystroke, the MAC addresses of all wifi access points in proximity, and whatever other information your computer might be privy to.</p>
<p>Now for the airgap.  The second computer, which I&#8217;ll call IvoryTower, is air gapped.  If the only secrets you are trying to hide are your private PGP keys, the cleartext of your messages, and the cleartext of your pen pals&#8221; messages, IvoryTower should be a raspberry Pi with a USB CD (read-write) drive.  If you also want to read PDFs, I&#8217;m unsure if a raspberry pi can handle this, so you might have to use a desktop.  The raspberry pi has several advantages when it comes to side channel attacks and black bag attacks.  We&#8217;ll discuss these later.  It also has the advantage of being ARM architecture instead of x86 and x64.  The architecture matters because in depth knowledge of x86 and x64 are much more abundant than knowledge of ARM.  You increase the cost of attacking you by using a more unusual architecture.</p>
<p>IvoryTower is our most privileged machine, because private keys are used to decrypt messages on it.  If we can prevent it from being rootkit&#8217;ed, our secrets are safe (except from black bags, more on this later).  However, we should always assume IvoryTower is pwned and take steps to guarantee none of the secrets it protects leak onto CannonFodder and from there onto the internet.</p>
<p>Backing up for a moment, IvoryTower is where the PGP keys you use to correspond with your pen pals&#8217; are generated.  The first day IvoryTower is set up, when it has the lowest likelihood of being rootkit&#8217;ed, generate a ton of PGP key pairs and burn them to CDs.  If you are very security conscious, IvoryTower should be shutdown in between each key you generate.  This is to clear the RAM of the device (always use an OS which overwrites RAM at shutdown).  Many rootkits can&#8217;t survive a reboot.  A shutdown could clean the machine.  If a rootkit does infect the computer, and private key material from other pen pals is  still in memory, the malware can compromise more of your private keys than it would have been able to otherwise.</p>
<p>If IvoryTower is a desktop, it should have no hard drive, and it should boot from a live CD in a CD-ROM (no write) drive.  The CD containing the new messages from Alice can be put in a separate CD drive.  When the encrypted messages are copied to the desktop, they will be put in RAM on the device.  Insert the CD containing the private key corresponding to the public key you gave to Alice, and decrypt the messages.  Read then, then reboot.  Write a new message to Alice, encrypt it with her public key.  You can retrieve her public key either from the same CD that holds the private key you use to communicate with her, or by requesting she append it to the messages she sends.  Burn your encrypted message to a new CD, and destroy the CD that transfered Alice&#8217;s messages from CannonFodder to IvoryTower.</p>
<p>Part of Alice&#8217;s message should be a new email address she created just to receive your next message.  Similarly, your new message to her should contain the email address you&#8217;ve registered to receive her next reply.  In the message you are sending should be an email address that they can send their next message to.  This protocol, of always sending to a new email address, means Eve has fewer selectors to key in on when she taps the internet backbone, and she can&#8217;t use your old email address as a selector to serve an exploit to you when you visit the old email account.  If she gets your key, the messages are not all aggregated in one place for her to decrypt.  Since the next email address is encrypted in each  message, she will not know the next place a message is being sent.</p>
<p>Now for a trick.  Write down the exact size (in bytes) of the encrypted message that is destined for Alice.  Open the encrypted message in a hex editor (still on IvoryTower).  Write down the first 5 bytes of the file.  Write down the last 5 bytes.  Pick a random offset (or 2 or 10) and write down 5 bytes there along with the offset.  Reboot.</p>
<p>Repeat the procedure on IvoryTower for every correspondence that sent you a new message.</p>
<p>Now another trick.  Using a public-key/private-key pair you&#8217;ve kept reserved for testing purposes, encrypt a fake message.  If can say anything, just make sure you&#8217;ll recognize your fake message when you decrypt it (more about this later).</p>
<p>You have destroyed the CDs with the messages your pen pals&#8217; sent you, you have a bunch of CDs with messages you&#8217;d like to send on CannonFodder, and you recorded some metadata about each of the encrypted messages (i.e., filesize, the first five bytes).</p>
<p>We have now reached the most dangerous part of the process, because if IvoryTower is rootkit&#8217;ed, any of the CDs could contain information about your secret key, information about the cleartext of your message or your pen pals&#8221; messages.  For example, if GPG on IvoryTower has been subverted by malware, the malware could have used the Eve&#8217;s key to encrypt your message instead of Alice&#8217;s public key.  Then, when you transfer the message to CannonFodder, malware on that system could use Eve&#8217;s private key to decrypt the message, send it to Eve, and re-encrypt the message with Alice&#8217;s public key.  You would have not idea you were compromised, because from your perspective Alice got the message OK.</p>
<p>To guard against this, we have a third computer, which I&#8217;ll call DoubtingThomas.  This is the one computer who&#8217;s integrity is important.  Luckily, it too can get rootkit&#8217;ed, as long as it is rootkit&#8217;ed by an untargeted attack.  If Eve and her minions target yo and get on DoubtingThomas, you&#8217;re in trouble.</p>
<p>DoubtingThomas is a raspberry pi.  This is a nice choice because it can be physically hidden, making physical tampering by a black bag team more difficult.  It also uses much less power than a desktop, meaning many side channel attacks don&#8217;t apply.  Also, electronic devices (bugs) that could be hidden on a desktop computer&#8217;s motherboard or PCI peripherals stand out much more on a raspberry pi.</p>
<p>The most important thing about DoubtingThomas is simplicity.  We want very little surface area on DoubtingThomas.  IvoryTower runs a full fledged OS with lots of code and lots of surface area, making it easier to own.  DoubtingThomas, however, just needs to have a hex editor, GPG, and the ability to read from a CD.  Ideally the CD has filesystem, since a filesystem is more surface area for an exploit, so a raw filesystem that can be read with  would work well, especially if that meant &#8216;dd /dev/[cdrom]&#8217; would have identical output to the encrypted blob IvoryTower produced.</p>
<p>DT has a CD-ROM (no write) drive connected by usb so it needs a USB driver as well.  The OS on DoubtingThomas would be custom coded to be minimal and only have what is needed for this task.  On DT we open the encrypted messages from IT in a hex editor so you can visually inspect the file is unchanged since being on IT.  It is important also verify that the file size is the same, and that the rest of the disk is empty.</p>
<p>What does this buy you?  If the hex editor on DoubtingThomas shows the same values as the hex editor on IvoryTower, you know you can trust IvoryTower&#8217;s hex editor and burner.  However, you cannot know for sure what key actually encrypted the message.  Eve could easily have encrypted the payload if she was on IT and subverted GPG.  Basically, you can trust the burning software and the hex editor, but you still don&#8217;t know if you can trust the install of GPG on IT.</p>
<p>This is where the message you encrypted with a public key for which you have the private key comes in.  Decrypt it on IvoryTower, and if it decrypts correctly, you know you can trust GPG on IvoryTower.  Why?  Because if malware has subverted GPG on IvoryTower the fake message won&#8217;t decrypt correctly.  If your message is encrypted with the Eve&#8217;s key, there&#8217;s no way to tell just by looking at the encrypted file.</p>
<p>After the test on DoubtingThomas, you know you can safely put the CDs in CannonFodder, and email your messages to your pen pals&#8217;.</p>
<p>That&#8217;s the procedure, now how does it stand up to our threats, and are there any other things we can do to make it even more secure?</p>
<p>1) Attack from the internet.</p>
<pre><code>If CannonFodder is pwned, when you burn a CD of messages addressed to you, an filesystem exploit or an exploit that targets any of the other code that is required to read from a CD could be burned to the CD too.  This is the only way IvoryTower can be rootkit'ed if Eve limits herself to attacking over the internet.  If IvoryTower is rootkit'ed, you can't trust the output of any of the software on that system.  IvoryTower could:

a) encrypt with the Eve's public key when it says it's encrypting with Alice's public key (they get cleartext of your message to Alice)
b) append your private key, encrypt with the Eve's public key (they get your private key for corresponding with Alice, and your message to Alice).
c) Write your private key and any cleartext left in RAM to slack space on the CD.
</code></pre>
<p>DoubtingThomas verifies the work of IvoryTower as described earlier.  However, there are ways malware could get around this.  The first that comes to mind is maintaining a whitelist of keys that it will subvert and your fake key is not on the list.  But that would be so targeted, and require such perfect knowledge it&#8217;s not believable.</p>
<p>Make sure to generate plenty of private keys as soon as you get IvoryTower setup.  Once it&#8217;s subverted it could be generating weak keys.  Also register lots of email accounts on CannonFodder.</p>
<p>2 and 3) Your equipment was pre-pwned with BIOS malware before you bought it and side channel attacks</p>
<pre><code>This would have to be general purpose malware that didn't target you specifically (because you were careful enough to buy hardware in person from a big store and not online with your credit card, where it could be messed with in a targeted way).  There are a couple threats here.  The first is that IvoryTower's key generation is weakened.  This is a serious flaw that I don't know a good way around.  The second is the computer is modified to transmit data through side channels.  So, for example, it flickers the screen at a frequency imperceptible to the human eye, and it just scans through RAM constantly doing this, so that a sensor picking up the flickers would have a dump of RAM.  Or it scans through RAM and modifies the power unit to transmit data (using the power cord to create an antenna, or to communicate with another device on the same power circuit, perhaps CannonFodder).  Or it blinks an LED faster than humanly perceptible.  Or it uses the wire that wraps around the perimeter of the monitor that connects to the LED and forms an antenna to ex-filtrate data.  Or it produces auditory signals by the making the processor hum.  It can control the frequency of the hum with the type of operation it has it do.  Or Eve uses Van Eck Phreaking to reconstruct your monitor display by the radiation it gives off.
</code></pre>
<p>Side channel attacks are real.  They are very hard to defend against.  On the positive side, I assume they are expensive to deploy.  But since our assumption is we must be resistant to expensive attacks, we must consider side channel attacks.</p>
<p>First I&#8217;ll point out that the only computer in our setup that must be resistant to a side channel attack is IvoryTower.  If IvoryTower is a raspberry pi, it draws such little power that the power cord attack is not feasible.  Any form of radiation attack (the antennas, Van Eck phreaking) can be mitigated by only running IvoryTower in a local restaurant&#8217;s walk-in freezer (the poor man&#8217;s faraday cage).  A Raspberry Pi is portable enough to take to a walking freezer.  For Eve to pull off the visual and auditory based attacks she presumably requires a black bag team to place sensors in your workspace (more on this in a minute), but a raspberry pi based system could be set up in a different location every time you use it (meaning it&#8217;s much harder to &#8216;bug&#8217; in this way).</p>
<p>Note that the cords for keyboards and mice should have shielded cabling.  Every cord in your setup for IvoryTower should.  Peripherals should never be shared amongst computers since they could be infected with malware.</p>
<p>All LEDs should be disabled in all your computers/ monitors/ peripherals by digging out the LED.</p>
<p>4) Blackbag team visits your house while you aren&#8217;t there</p>
<p>You are going to have to have a good place to stash the CDs containing your private keys as well are your raspberry pi(s).  They are the prize you are trying to defend.</p>
<p>One threat is Eve&#8217;s henchmen break into your house and replace your keyboard with a duplicate that has a key logger, or that infects your device with malware when you plug it in.  For this reason, put distinctive scratches into all your peripherals, take a photo, and regularly check that the scratches are identical to the photo.  This is how weapons inspectors ensure the seals protecting weapons caches have not been tampered with.  The seals are scratched in a distinctive way that can&#8217;t be forged, then check periodically.  Use tamper evident tape on your devices to slow down a burglar that wants to plant a keylogger in your keyboard.</p>
<p>If IvoryTower is infected in its BIOS and it is capable of stashing private keys (in the BIOS or in the firmware of PCI peripherals on the system), then a black bag team could get your keys this way.  This is another argument for IvoryTower being a raspberry pi and being stashed somewhere.  If IvoryTower is hidden and the burglar can&#8217;t find it, they can pull the private keys from the BIOS.  On a desktop, the fewer PCI peripherals, the less space the malware has to stash keys if it is in fact using this strategy.  So make sure you have no PCI peripherals.  If you have a desktop, put super glue in all the USB interfaces so they aren&#8217;t functional.  Do the same to any interface on the mother boards that could attach removable media.  Try to make the case impossible to open (bonus points for encasing it in cement except for the fan, CD tray, cables for keyboard/mouse, power cable and power button).  Your attack surface for a burglar becomes what they can modify with a liveCD and maybe the drivers that handle input from your monitor (minimal).</p>
<p>5) Other threats<br />
Most other threats won&#8217;t get past your browser, because it&#8217;s fully patched, and it they do, they&#8217;ll be destroyed by reverting your VM.</p>
<p>Questions:</p>
<p>Is it easier to verify raspberry pi&#8217;s embedded code than a desktop&#8217;s BIOS?</p>
<p>What if IvoryTower is pwned before you buy it and produces weak PGP keys?</p>
<p>What to put for full name, email address in PGP key?</p>
<p>How long should keys stay valid for?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206966">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206966">
						October 12, 2013 1:56 AM					</a>

				</p>

				<p>FWIW all this talk of being careful with updates and such &#8211; which to my mind is <i>the</i> weak link in any trustworthy system &#8211; brings to mind something. Has anyone considered hiving off &#8220;sensitive&#8221; data to a Plan-9 system?</p>
<p>Besides being able to use the fossil archival filesystem (which is pretty neat) plan9 is completely open-source and, for what it is, the source isn&#8217;t that big or complex. The system is surprisingly simple, easy to set up and efficient.</p>
<p>People here can judge its security for themselves but because of its simplicity battening down the hatches on plan9 is more like setting-fast a dinky sailboat than the ocean-liner that is Linux or Windows (ptui).</p>
<p>Most of it runs as servers so although it&#8217;s not technically a microkernel it can be understood as one. Also, the plan9 community is very smart and helpful and the full source is provided.</p>
<p>I recommend a look for those adventurous souls who seek alternatives to update-driven bleeding-edge &#8220;what&#8217;s this update gonna break this time&#8221; stuff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206967">

			<div class="comment by-mcjtom ">

				<p class="commentcredit">

					<span class="commenter">mcjtom</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206967">
						October 12, 2013 2:08 AM					</a>

				</p>

				<p>Would having 2 air-gaped computers be practical: one for reading, one for writing?</p>
<p>The information flows only one way for each: from internet to the reading one and from the writing one to internet.  2 different sets of fresh USBs are used.</p>
<p>The operator decrypting and reading on one, then writing and encrypting on the other breaks the circuit: even if the reading computer is infected by maleware contracted from the internet, stolen keys or actual files will have hard time to move back to internet if the one-way USB transfer is reasonably hygienic (though I&#8217;m not sure what such hygiene would have to entail: certainly not mixing the two streams, but new USB every time? nuking the USB after each use, but on which computers?).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206968">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206968">
						October 12, 2013 2:10 AM					</a>

				</p>

				<p>&#8230; whoops, hasty on the post button.</p>
<p>Good starting points: <a href="http://swtch.com/~rsc/" rel="nofollow ugc">Russ Cox&#8217;s page</a> and the <a href="http://plan9.bell-labs.com/plan9/" rel="nofollow ugc">Plan 9</a> page.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206969">

			<div class="comment by-avrg-joe ">

				<p class="commentcredit">

					<span class="commenter">Avrg Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206969">
						October 12, 2013 4:14 AM					</a>

				</p>

				<p>DVD live system might be a good and pretty safe thing even for everyday&#8217;s use but it is terribly slow. How about creating a live system on a write protected (external or internal) hard disk (using hardware  jumper settings)?? However the existing live systems that are tailored for DVD or USB stick use probably will need some changes so that they work on write protected hard disks. Does anyone know if such systems exist already or how this can be done?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206970">

			<div class="comment by-goldry-bluszco ">

				<p class="commentcredit">

					<span class="commenter">Goldry Bluszco</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206970">
						October 12, 2013 4:50 AM					</a>

				</p>

				<p>Well, I&#8217;m surprised no one&#8217;s mentioned paper tape for data interchange. It&#8217;s still around &#8211; though the last I heard of it was in relation to CNC mills. Then one could always link the Internet box via serial to one of those 8-bit Amstrads or the like, save ASCII to tape, then take to another Amstrad serial-linked to the non-Internet box, and read it from there. Amstrad tapes aren&#8217;t big; you can&#8217;t fit your average 20-100MB PDF on it. But wonderful for ASCII text files.</p>
<p>As far as THEM listening to the radiation overflow of the PC set-up, what&#8217;s wrong with mutilating a perfectly good superheterodyne valve/tube receiver &#8211; you can still find the circuitry diagrams around the place &#8211; so that it superheterodynes in a particularly superheterodynish manner. If THEY&#8217;re listening in, give THEM a head-ache and ringing ears for THEIR trouble.</p>
<p>And as for listening in via the power system &#8211; it&#8217;s hard being green, as one singing Frog will tell you, but better that than being caught by an OpSec that didn&#8217;t quite work out. Get yourself set up with solar and wind power, and cut the links to the grid. Let THEM listen to the sound of THEIR own farts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206971">

			<div class="comment by-petar-maymounkov ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://maymounkov.org' rel='external nofollow ugc' class='url'>Petar Maymounkov</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206971">
						October 12, 2013 6:04 AM					</a>

				</p>

				<p>Hi Bruce. You say you use Tor.</p>
<p>As a security analyst, you are surely aware that Tor provides absolutely no provable anonymizing properties and is a system that is largely based on &#8220;security by obscurity&#8221;. To be precise, I am referring to the well-known fact that Tor is vulnerable to the Sybil Attack and furthermore that this has been demonstrated in practice, multiple times by now, as well as in papers, multiple times by now.</p>
<p>With this in mind, I wonder: Why are you using Tor?</p>
<p>Thanks<br />
Petar</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206972">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206972">
						October 12, 2013 7:37 AM					</a>

				</p>

				<p>It&#8217;s funny reading this page as most of the suggestions here have been said befor by RobertT, Nick P and myself and one or two others some of whom nolonger post to this blog.</p>
<p>As I&#8217;ve said in the past always consider my meme of &#8220;Paper, Paper, NEVER data&#8221; it&#8217;s about the easiest way to redact hidden metadata. Failing that old Computers and single chip microcontrolers are one way to limit your risk of transfering malware across an air gap. Likewise building them into safes solves other problems and eases the use of more spectacular protection of the sort used by the NSA et al (As RobertT notes above &#8220;THERMITE is fun&#8221; as are &#8220;flashbangs&#8221; and sub-sound and ultra-sound that play havoc with human sense and nerve systems 😉</p>
<p>But fun though this sort of thing is it&#8217;s &#8220;Putting the cart before the horse&#8221; big style. It belongs a long long way down the list of things you need to do to have a secure system for data and communications.</p>
<p><b>The First step is the &#8220;WTF am I doing it for?&#8221; question</b><br />
At the very least doing the technical side of ICTsec of this sort of security anywhere close to properly throws you back to user functionality levels of ed/sed on the command line on a Glass teletype&#8230;</p>
<p>So not even the niceties of VT100 or other screen addressable VDUs and luxury editors like vi&#8230; Whilst I&#8217;m sufficiently &#8220;old school&#8221; not to be phased by this it&#8217;s not a plesant experiance for those &#8220;born to windows&#8221; and WYSIWYG presentation tools. However the upside of old school is controling both visable and hidden metadata that might conceal nasties.</p>
<p>But as they say &#8220;no pain, no gain&#8221;, and speaking of pain it comes in many forms physical emotional and psychological and most adversaries will use any and all of them against you directly or indirectly through your family, friends, work colleagues and governmental agencies&#8230;</p>
<p>So first you need to consider what it is you are actualy trying to protect and from who and importantly why and are you prepared for the pain for what might be very little gain in the great scheme of things?</p>
<p>Political and emotional affiliations and sentiments and the related soul searching asside &#8211;but which you will if you are sensible revisit over and over through the process as your life and others may well depend on it&#8211; you need a methodology to work by.</p>
<p>A simple start point to get your thoughts in gear is an &#8220;asset dependancy list&#8221; and a matrix of the &#8220;CIA&#8221; triad aginst the &#8220;adversary levels&#8221; first sugested by Ross J. Anderson for each and every asset known or identified (such &#8220;method models&#8221; exist in most ICTsec ROI risk analysis books etc).</p>
<p>Thus you first have to know what the assets are which in many cases is not at all obvious due to issues with primary assets and associated assets and their life cycles and types.</p>
<p>If you take a 20,000ft view at what Bruce is trying to do the primary asset is a large collection of documents which he is going to view, interpret and publish results.</p>
<p>However these documents are (I assume) encrypted in one or more archives and in various formats frequently graphical in nature, which gives rise to a secondary dependancies of the crypto software and keys, the software to display the documents and various other sub dependancies (OS to support software, Hardware to support software etc) all to enable just the viewing of the primary asset. Similar dependancies ocure for the interpretation and publication steps.</p>
<p>The main threat against the primary asset Bruce should be actually woried about with a level III adversary is not loss of confidentiality or destruction but actualy &#8220;modification&#8221;. Because if the NSA can modify the data on which he bases his comments and articles it&#8217;s his reputation that gets a hit and in turn &#8220;poisons the well&#8221; of Ed Snowdens revelations, thus discrediting all involved in the public eye, which in effect stops future publications of further &#8220;secrets&#8221;.</p>
<p>However the next level of threat from Level III adversaries is non technical and from Bruce&#8217;s point of view  is a lot more serious and it&#8217;s &#8220;personal liberty and safety&#8221; of him, his family etc etc. To some extent Bruce is lucky in that the &#8220;Bruce Persona&#8221; acts as a limiting factor which the majority of us just don&#8217;t have. If Bruce had an accident or disappeared it would be very quickly noticed and news would get out and conspiracy theories asside this would bring the public eye back on the Ed Snowden revelations and activly encorage further revelations. As was quite well illustrated by the stupidity of the UK Home Office on detaining Mr Greenwald&#8217;s partner at London Heathrow Airport, this &#8220;human level refocus&#8221; and gets front page position, which is not what the politico&#8217;s want as it keeps the cauldron heating up beneth them&#8230;</p>
<p>Any personal/physical attacks on those involved are in effect a &#8220;political suicide pact&#8221; for any politician, directly or indirectly in a line of authority to those carrying out the attacks. Which is probably why Barrack &#8216;the control freak&#8217; Obama and the rest of the Whitehouse have very much distanced themselves from the NSA and DNI. But leaving the intel community as some journalists have said feeling like &#8220;they&#8217;ve been hung out to dry&#8221; or worse &#8220;feeling they are now the enemy&#8221; which prompted the open Alexander letter to all NSA staffers which turned into another long runing PR gaff (as was once said &#8220;Don&#8217;t try to defend the indefensible promote it&#8221;).</p>
<p>My view is the NSA staff chose to take the Government schilling, they were not forced or coerced. Thus they should have read the contract and worked out the downside liabilities and not cry about the consiquences. Military personel who enlist know that &#8220;death&#8221; is part of the T&amp;Cs, it&#8217;s the same for spooks. The analysts and those related to them even though they may be REMFs, are ethicaly and moraly just as liable as are the self serving politicos. Engineers had this debate out in the &#8220;cold war&#8221; and quite a few refused to work on even tangentaly related to the military projects.</p>
<p>Thinking about the downsides is very important as most of the readers of this Blog don&#8217;t have the sort of &#8220;Public Persona&#8221; that would give us protection of our personal safety and liberty so we should take serious consideration to the non ICTsec asspects as a first real step.</p>
<p>Just to remind you why you should think about over and above the ethics and morals,</p>
<p><b>Personal Safety First</b><br />
We know from the likes of Gerald Bull of &#8220;super gun&#8221; fame and M.Vanunu who wistleblew on the Israeli nukes, and more recent events, the likes of Mossad and Russia will quite happily send out &#8220;hit squads&#8221; to perform assasinations and &#8220;snatch squads&#8221; to take people away and torture them.</p>
<p>We also know the US operated snatch squads for rendition so that quite often innocent people would be tourtured and pressumably in some cases &#8220;disappeared&#8221;. Others as we know face an indefinate future of wearing orange jump suits and being &#8220;force fed&#8221;, &#8220;force face wshed&#8221; and otherwise tourtured at Gitmo on a daily basis.</p>
<p>And some people still don&#8217;t get why Julian Assange is apparently half mad and holed up in an Embassy in London with the UK Home Office spending millions of pounds each year keeping him bottled up there&#8230;</p>
<p>Putting it simply &#8220;S41ting on a Gov doorstep&#8221; carries a lifelong world of hurt or early death for those who don&#8217;t take sufficient personal security seriously, such is the power of level III adversaries.</p>
<p>But the same applies to level II &amp; I adversaries, we know that &#8220;SWATing&#8221; and seting up with drugs and other socialy abhorant materials has happened to journalists like Brian Krebbs just for investigating cyber-criminals. And if stories about the Silk Road founder and operator are true (and I&#8217;m slightly skeptical) aranging &#8220;Hit men&#8221; to permanently remove threats likewise happens.</p>
<p>So only once you have given serious thought and preperation and protection to your personal safety and that of your loved ones you can get back to the ICTsec issues&#8230;</p>
<p><b>Stage two identify assets life cycle and types</b><br />
Whilst you might think you know what the ICT assets are you are trying to protect you also need to identify what their life cycle is and what protections are needed at each stage as their types change.</p>
<p>If you don&#8217;t know this for the entire life cycle of an asset then you are in all probability wasting your time and other resources. As well as deluding yourself about the protection you&#8217;ve implemented. We&#8217;ve seen and laughed at &#8220;encrypted backups with the key postit noted to the tape&#8221;.</p>
<p>You also need to consider not just the primary assets but the assets that get applied to them such as Key Material (KeyMat) life cycles and storage life cycles all from generation through to destruction and waste disposal and the attendant managment and auditing required and thus the sanitation and protection of those processes as they in turn become assets.</p>
<p>Put simpley if it&#8217;s data or communications or both you are trying to protect, you need to know what they have touched and been touched by and the entire life cycle of all these associated assets and thus assess what sort of attacks an adversarry might deploy and to what effect, duplication, disclosure, modification, destruction etc and importantly how&#8230;</p>
<p>This also harks back in part to personal safety, put simply if I know you have the only copy of something that incriminates me, burning your house down to destroy it might be the simplest attack vector for me to use and I might not care if you or anyone else is at home at the time&#8230; As we know the French Government were more than happy to send out a &#8220;hit squad&#8221; to very publicaly blow up a ship in a foreign harbour and commit murder in the process just to avoid having anoying environmental protesters around. Russia has just done something similer to the same environmental protest organisation but used a &#8220;snatch squad&#8221; and are now levying false charges of Piracy on the high seas against the protestors and journalists&#8230;</p>
<p>But from the technical side you need to remember that data frequently changes it&#8217;s type during it&#8217;s life cycle apart from starting or ending in tangable human usable form such as notes or print outs data files have formats, with metadata and the files themselves have metadata in the file systems. Often however the metadata and file formats themselves are not in human readable form and are often a good aproximation to obscure binary representations of pictures or graphics.</p>
<p>That said most software products, even MS Office and other similar proprietry software products, will produce files and output in &#8220;human readable&#8221; form. Word Procs tend to support Rich Text Format (RTL), spread sheets and DBs support &#8220;comma seperated lists&#8221; (CSV) and most graphics or similar software supports &#8220;PostScript&#8221; (PS).</p>
<p>Many OSs also support &#8220;Print to file&#8221; where the file is saved in PostScript format. And whilst I don&#8217;t recomend you learn PostScripts inbuilt programing language there are various utilities like ps2txt and other similar tools to strip out the text from the &#8220;code&#8221;. It&#8217;s worth investing in doing this along with an appropriate software developers repository such as Git or earlier to save documents in post script format and ps2txt then into an inverted database format to build your own fully searchable eFileCabinate.</p>
<p>But why put everything in these human readable &#8220;text formats&#8221; well as I&#8217;ve indicated in the past one way to bridge an &#8220;air gap&#8221; is via a serial link (RS232C over V24) and put the equivalent of &#8220;data diode&#8221; or &#8220;data pump&#8221; into a microcontroler to do &#8220;sentry duty&#8221; over the serial data. If you use &#8220;V24 signaling&#8221; as opposed to RS232C data flow control the &#8220;control codes&#8221; in use are minimal and any others should raise a RED flag in the diode/pump. You can make the pump considerably more sophisticated I&#8217;ve one that actually uses a spell checker on files that also RED flags on certain formats such as &#8220;encoded binary&#8221; of various forms.</p>
<p>One &#8220;filter&#8221; I&#8217;ve written takes RTL format files and strips out various undesirable codes and puts in safe data where &#8220;embedded&#8221; data that might contain &#8220;hidden data&#8221; as a replacment. To do this yourself you need to get various forensic and redacting documentation. However this task is considerably simplified if you convert propriatry formats into Open / Standard formats first.</p>
<p>Unfortunatly many productivity tools such as MS Office and their ilk have support for programing by embedded interpreters. You need to watch out for this as you don&#8217;t want a WP file actually being malware.</p>
<p>If push comes to shove remember my frequently given advice of &#8220;Paper, Paper, NEVER data&#8221;, print off documents look at them walk them across the air gap scan them in and then use suitable destruction techniques on the paper print out [1]. This process is very effective at destroying hidden metadata as well as some &#8220;canery traps&#8221;. It also works well to stop data leakage even if your air gapped machine does get &#8220;owned&#8221; by malware at some point. However it&#8217;s not a practicaly system once the transfer rate exceads a certain volume.</p>
<p>I could go on about the technical details in depth including KeyMan, TEMPET/EmSec, secure destruction and anti-personnel systems, however two point arise, firstly I&#8217;m not writing a book here and secondly I&#8217;ve said much of it before on this blog.</p>
<p>[1] Solid fuel stoves if used properly work well, the trick is not to have them burn to vigerously other wise burning scraps may go up the flue into the great outdoors, also don&#8217;t overload the fire or the paper won&#8217;t burn fully. I&#8217;ve recently been looking at mixing paper with other dry fuels such as wood chips and &#8220;stable sweapings&#8221; including the animal muck and putting into a &#8220;gasifier&#8221; the output of which drives a generator. The residual ash when mixed with other animal muck makes reasonably good fertilizer for growing food crops.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206973">

			<div class="comment by-tony ">

				<p class="commentcredit">

					<span class="commenter">Tony</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206973">
						October 12, 2013 8:51 AM					</a>

				</p>

				<p>For anyone recommending a POSIX-compliant OS, and you aren&#8217;t running it from read-only media, create a minimal read-only root partition to boot from.  Union mount a RAM disk overtop partitions like /var, /tmp, etc.  If you need to make temporary config changes, union mount another RAM disk over the root partition or /etc.  (And use some software to scrub the RAM clean before and after using the machine).</p>
<p>If you must connect to the Internet for initial configuration or software update, stick your machine behind a firewall with extremely paranoid ingress/egress filters.  Block outgoing access for DNS lookups and hard-code known-good hostname to IP mapping in the /etc/hosts or equivalent file (yes, even Windows has one).  You may even be able to change your MAC address from the hard-coded value to something random when connected to avoid leaking information about the hardware &#8211; though the firewall&#8217;s MAC address would be seen from the outside world instead of the to-be-air-gapped machine&#8217;s.</p>
<p>For non-plain text files, consider converting them into HTML or loading them into a web browser and use an automated tool to take a set of screen shots of the content.  Then scrub any meta-data or unneeded info in the image files and/or run other cleanup/compression tools on them.</p>
<p>For any files being transferred, run their known-good(-and-safe) contents through an HMAC with a strong key.  Use the output of the HMAC to rename the file.  Before accessing the contents on the air-gapped machine, run the same HMAC on the file contents and compare the result to the filename.  If they don&#8217;t match, don&#8217;t access the file.</p>
<p>And in case nobody already mentioned it, fill any unused ethernet, USB, firewire or other ports with superglue.</p>
<p>There has been research about reading key-strokes via the sounds each key makes.  So at minimum run a white-noise generator nearby and find a laptop with the quietest possible keyboard.  Use an on-screen keyboard program and click each key to enter passwords instead of using the keyboard.  Open a text editor and type random gibberish every once in a while.  Hunt-and-peck, slowly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206974">

			<div class="comment by-njw ">

				<p class="commentcredit">

					<span class="commenter">NJW</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206974">
						October 12, 2013 10:18 AM					</a>

				</p>

				<p>I don&#8217;t know if this has been said, there are now too many comments for me to read in the 10 mins that I have, but wouldn&#8217;t it just be easier to buy a new usb stick from a store, buy a new PC from a store with no OS installed, download and burn a Linux live CD (Ubuntu et al.).</p>
<p>Only ever use the new PC booting from the live CD and never connect a wireless/networking device to it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206975">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206975">
						October 12, 2013 10:54 AM					</a>

				</p>

				<p>Personally I would use very old hardware (80386) and the simplest OS which will fulfill the tasks required (this would probably be some variant of DOS, which can successfully run PGP). The only &#8216;required equipment&#8217; is your encryption/decryption program and a text editor. Why old hardware? We have to assume that modern hardware is &#8216;born compromised&#8217; in some shape and form.</p>
<p>Now, as it&#8217;s airgapped we can rule out remotely exploitable issues (i.e. a satanic packet that will cause the ethernet card to do something crazy, a BMC that does who knows what when commanded to do so, etc.) but there are still things that a L3+ adversary could do like maximizing compromising emanations without making it patently obvious that this is deliberate.</p>
<p>It wouldn&#8217;t be too difficult to make a faraday style cage to encase a laptop. A glass screen with a metal mesh on the inside would certainly minimize the emanations from the only area that needs at least some exposure (taking a leaf out of the &#8216;honeycomb&#8217; vents they have in commercial chambers for HVAC).</p>
<p>But Bruce knows as well as we do that they aren&#8217;t <em>that</em> interested in him. The material has been archived all around the world on bittorrent as insurance files and they have no way of knowing who the sleepers are that possess the decryption keys. Perhaps one group holds one half of the keypair and another the other part to avoid a single person leaking for an unwarranted reason. I imagine that only a subset of documents have been released to Schneier so the information they&#8217;d glean (presumably they&#8217;d want to determine how much data Snowden has actually stolen) isn&#8217;t complete or particularly illuminating.</p>
<p>That said, it&#8217;s safe to say that an online attack would be the most likely vector. It isn&#8217;t unreasonable to think that they could, for example use WSUS to push a &#8216;special&#8217; update to only computers phoning from Schenier&#8217;s netblock that gives them a remote shell. Ditto on his cellular phone (I disabled Android Market/PlayStore on my phone for this reason. Yes &#8211; no confirmation is given if they don&#8217;t want to ask for it &#8211; e.g. the update that caused the apperance of the &#8220;Google Settings&#8221; menu about six months ago.)</p>
<p>So airgapping  will (hopefully) mitigate that scenario provided that the media that goes between his red and green zones doesn&#8217;t somehow contaminate it. Even though he&#8217;s disabled AutoRun with Windows being what it is &#8211; and &#8216;sploits in PDF,PS,DOC,etc. existing in the past and being conceivable in the future despite NX and other technologies supposedly being implemented in later Windows releases I would be wary of anything that could be a vector for such a threat.</p>
<p>Personally I wouldn&#8217;t have used Windoze. You can&#8217;t even start to fix something with such a wide attack surface. Linux is better &#8211; depending on distribution and default configuration but still not ideal. OpenBSD would be great if there wasn&#8217;t a big cloud hanging over De Raadt and what his dealings have been with three letter agencies (I&#8217;d at least compile it from source).</p>
<p>Personally I think Aspie&#8217;s suggestion of plan9 is a good one. It&#8217;s security by obscurity, sure &#8211; but it&#8217;s security nonetheless. FreeBSD is a viable option &#8211; compile out linux binary compatibility though.</p>
<p>I personally use a Sun SPARCSTATION running NetBSD as my &#8216;super secret&#8217; station. I used to have a VAX also running NetBSD but it was just too expensive to run 24/7 when a raspberry pi could do its job 😉</p>
<p>Strange OS, strange architecture (and don&#8217;t reveal it) means that their custom crafted spolits for win32 or linux x64 will likely fail.</p>
<p>But &#8211; realistically if they wanted your data they&#8217;d break in and hit you with a lead pipe until you gave it to them or dropped dead.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206976">

			<div class="comment by-bruce-perrry ">

				<p class="commentcredit">

					<span class="commenter">Bruce Perrry</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206976">
						October 12, 2013 10:57 AM					</a>

				</p>

				<p>air gaps aren&#8217;t possible in the newest computers.  I saw it. I was able to surf freely without being connected to my ISP through either wireless or electric wire (remember they were going to serve internet through power lines a few years back).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206977">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206977">
						October 12, 2013 11:01 AM					</a>

				</p>

				<p>You guys must have some pretty wicked secrets to protect! Going to such extreme measures!!!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206978">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206978">
						October 12, 2013 11:05 AM					</a>

				</p>

				<p>Wael: reminds me of an old friend whose apartment door had about six different locks and a large plate glass window right next to it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206980">

			<div class="comment by-theo ">

				<p class="commentcredit">

					<span class="commenter">Theo</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206980">
						October 12, 2013 11:08 AM					</a>

				</p>

				<p>as alot of people commented before: you are making a BIG mistake using windows in the air gap computer.<br />
you can well assume that windows contains NSA backdoors that WILL ATTEMPT to leak any information you have on your airgap computer by any means possible.<br />
i would strongly recommend you use a security focused 64 bit OS (ASLR is alot more effective on 64 bit systems) such as OpenBSD or hardened gentoo.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206981">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206981">
						October 12, 2013 11:10 AM					</a>

				</p>

				<p>@ Mike the goat,</p>
<p>Good analogy, but missing one thing! There is also a SWAT team determined to go through the door!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206982">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206982">
						October 12, 2013 11:18 AM					</a>

				</p>

				<p>Wael: indeed. When I visited the home of an individual who is now very famous in the IT world after being persecuted by authorities in the early 2000s he pointed at the door and asked, &#8220;notice anything about it?&#8221;. I didn&#8217;t. He pulled up the carpet and showed me two small wires running into a hole in the floorboard and insinuated that it was a degaussing coil which would destroy any magnetic media that went through the door. I commented that it may be true but what would happen if they just took the entire PC&#8230; The HDDs would almost certainly be shielded.</p>
<p>such is the nature of humans. They think that they have covered all the bases. Just because you can&#8217;t work out a way to break it doesn&#8217;t mean someone else won&#8217;t be able to do just that. A bit like how authors say to never edit your own work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206983">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206983">
						October 12, 2013 11:38 AM					</a>

				</p>

				<p>@ Mike the goat</p>
<p>These degaussing wires would not work either. How do I know? His credit cards never stopped working, have they? 😉 you need a huge EM field to degauss media at that distance with a fraction of a second exposure. Best advice? Avoid being a target. If you are targeted, you will lose. Data can also be planted and one can be framed&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206984">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206984">
						October 12, 2013 11:39 AM					</a>

				</p>

				<p>@Mike the goat: &#8220;OpenBSD would be great if there wasn&#8217;t a big cloud hanging over De Raadt and what his dealings have been with three letter agencies (I&#8217;d at least compile it from source)&#8221;</p>
<p>Openbsd, Debian and Gentoo have had this type of dealings: <a href="https://www.schneier.com/blog/archives/2013/09/google_knows_ev.html#c1770312" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/google_knows_ev.html#c1770312</a></p>
<p>On that point of view, I would trust OpenbSD more than Gentoo Hardened.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206985">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206985">
						October 12, 2013 11:41 AM					</a>

				</p>

				<p>@ Moderator</p>
<p>Please remove the link in my previous post!<br />
I wonder why you enable links anyways?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206986">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206986">
						October 12, 2013 12:02 PM					</a>

				</p>

				<p>Wael: of course I knew the chance of it working was remote. The wires were about 1/8&#8243; thick and two in number. Even if you consider that it&#8217;s possible then what about the power consumption and heat generation of such a thing running constantly? I would assume it wasn&#8217;t a coil covering the entire area as there was no coil going under the carpeted area so we have to assume there were small coils placed on either side of the thoroughfare at the height you&#8217;d approximate a person to carry media at. Even if it did work &#8211; optical media was already quite popular back then, and it would have not affected that. Re credit cards &#8211; he didn&#8217;t carry them. In fact he was responsible for one of the biggest CC thefts in that era so I guess he didn&#8217;t trust them. If this was a secure forum I would tell you who it was I am speaking of. The fact he is a diagnosed skitzophrenic explains his behavior. This phreaker went on to do something that was an international controversy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206987">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206987">
						October 12, 2013 12:20 PM					</a>

				</p>

				<p>GentooAndroid: if I cared about security enough I would not be using a distribution at all but compiling everything from scratch and administering everything like we did in the late 80s &#8211; by careful change logging after each make install. Of course you can argue that by delaying updates you are trading one risk for another but I think if you just keep your eyes on the CVE database, bugtraq and the vuln disclosure lists you could roll out your own fixes pretty quick.</p>
<p>Personally I use FreeBSD on my &#8216;low security&#8217; machine, compiled from source and with a custom kernel. I am very careful about what ports I install and have just one service that is partially exposed (to my cell company&#8217;s netblock by necessity) &#8211; ssh with key auth, keyboard interactive and password with are disabled in sshd.conf. On top of public key I require an OTP for all remote logons.</p>
<p>My &#8216;high security&#8217; machine is SPARC/NetBSD. It is not on my local ethernet but I do have a RS232 connection between the two boxes. I used an ATMega and two RS232 shields I made a sort of &#8216;hardware firewall&#8217;. It strips high ASCII characters and acts as an intermediary between the two hosts. I have a toggle which controls it &#8211; ingress,egress,bidirectional and a second off/on which powers down the microcontroller. If I have to transfer a binary I uuencode. Not foolproof but pretty good. Problems? Data transfer is slowish as the microcontroller isn&#8217;t exactly fast.</p>
<p>I often leave it in ingress and have my syslog piped into it in the hope that if someone hacks one of my boxes I can get some intelligence from the logs.</p>
<p>I used to keep my PGP key on a smart card (using the pkcs gpg module) but since moving to 4096 I don&#8217;t have a card that big.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206988">

			<div class="comment by-uberparanoiac ">

				<p class="commentcredit">

					<span class="commenter">Uberparanoiac</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206988">
						October 12, 2013 12:37 PM					</a>

				</p>

				<p>Bruce:</p>
<p>With due respect, wasn&#8217;t there something about all the latest Intel chips in the i5 &#8211; i7 family being manufactured with a 3G chip, so that the computer could be activated and the disk read even if you thought you had powered off and/or disconnected from the Net?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206989">

			<div class="comment by-rsaunders ">

				<p class="commentcredit">

					<span class="commenter">RSaunders</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206989">
						October 12, 2013 12:44 PM					</a>

				</p>

				<p>I&#8217;m a little old-school.  I&#8217;m a big fan of USB floppy drives.  For &lt;$20, you get only 1MB of storage and a hardware write lock.  The disks cost about $1 and break in your hands down to a plastic disc that shredders love. (Don&#8217;t try to shred the metal bits.) The perfect device for high =&gt; low air gap transfers.  For low =&gt; high you might need to use CDs as a lot of bloatware is too big to fit on a stiffy disk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206990">

			<div class="comment by-rsaunders ">

				<p class="commentcredit">

					<span class="commenter">RSaunders</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206990">
						October 12, 2013 12:50 PM					</a>

				</p>

				<p>OK, my bad, I promise to use preview even with quick posts.  Let&#8217;s try again without angle-brackets that can be confused as HTML tags.</p>
<p>I&#8217;m a little old-school.  I&#8217;m a big fan of USB floppy drives.  For less than $20 you get a device with 1MB of storage and a hardware write-lock. Disks are less than $1, and break up in your hands to a plastic disc that your shredder would love.  (Don&#8217;t try to shred the metal bits). Perfect for high-to-low air gap transfers. For low-to-high you might need to use CDs as a lot of bloatware is too big to fit on a stiffy disk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206991">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206991">
						October 12, 2013 1:06 PM					</a>

				</p>

				<p>Gweihir: you totally stole my idea. I have been using an Arduino with two RS232 shields to do just that for the last few years!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206992">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206992">
						October 12, 2013 1:13 PM					</a>

				</p>

				<p>Gweihir: I got the inspiration for my setup after seeing <a href="http://https://www.cs.uiowa.edu/~jones/" rel="nofollow ugc">this guy&#8217;s</a> paper &#8220;RS232 Data Diode&#8221; from 2006. Originally I figured I would just turn flow control off and bridge CTS/RTS but there are problems with this approach. I didn&#8217;t go the full Monty (one of his designs uses optoisolators IIRC) but just made a little proxy that enforces directional control when the toggle is set. It does significantly degrade connection speed and adds a touch of latency but it works as advertised. I didn&#8217;t use the Arduino b/s IDE and just wrote it in machine code. Very simple logic really.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206993">

			<div class="comment by-anony ">

				<p class="commentcredit">

					<span class="commenter">Anony</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206993">
						October 12, 2013 1:29 PM					</a>

				</p>

				<p>What&#8217;s suspicious about truecrypt?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206994">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206994">
						October 12, 2013 1:47 PM					</a>

				</p>

				<p>Anony: everything. It is published by a shadowy group called &#8220;The TrueCrypt Foundation&#8221; and there are rumors that the weblogs of truecrypt.org are a honeypot providing TPTB with Intel on &#8220;who&#8217;s got secrets&#8221;. I dunno about it. I would trust it for, say using on a wondoze laptop that might get stolen when you are travelling (you&#8217;ll need to make sure it is powered off and not just sleeping) as well you are trusting a commercial OS created by a company which is known to be in the pocket of the alphabet soup agencies. But I wouldn&#8217;t trust it with actual secrets. And if I were to trust it I wouldn&#8217;t download the binary version.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206995">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206995">
						October 12, 2013 3:36 PM					</a>

				</p>

				<p>@ Axon</p>
<p>&#8220;Actually, that depends on how you use the physically air-gapped machine. If the machine is permnanetly air-gapped, in the sense that it never sends or receives data to other computers (not even via sneakernet), then of course that&#8217;s true. But the behavior Bruce describes actually makes a physical air gap riskier in some ways.&#8221;<br />
(Goes on to describe USB stick attack vector)</p>
<p>Yes, it can be risky in some ways. Yet, your evidence/example is a strawman to my posts as I don&#8217;t advocate using USB sticks. Matter of fact, I specically criticized memory sticks in my last comments. USB sticks have the extra problem of issues with handling at PCI level. Then there&#8217;s executable subversion possibilities. Invisible Things Lab even wrote a nice blog post on USB issues, with a partial solution to problems.</p>
<p>My proposed air gap methods were:</p>
<p>(1) simple, non-DMA hardware links with drivers easy to custom implement on many OS&#8217;s/microkernels (eg serial, IDE);<br />
(2) one-way hardware;<br />
(3) a highly robust guard;<br />
(4) read-only storage like floppies or CD-ROM&#8217;s where malware might be detected;<br />
(5) a dedicated high assurance transfer device a la&#8217; NSA key fill machines.</p>
<p>(1-5) Very, very strong security on the Untrusted Transport machine to further reduce risks. OpenBSD, Linux with MAC, a CMW, a virtualized offering like Qubes, etc. are all nice here. Just some extra difficulty for the attacker is all I&#8217;m saying here.</p>
<p>Each of 1-5 is designed for different situations and different tradeoffs, but all minimize risk. My original link to the recommendations did [briefly] mention HD&#8217;s and USB sticks with a physical write protect switch for people who are going to use those devices despite my recommendations against them. Might make it a <em>little</em> safer for them.</p>
<p>&#8220;Xen is a bare-metal hypervisor, which means that it runs in a more privileged CPU state than any other software on the machine. (So it literally doesn&#8217;t make sense to suggest that the &#8220;influence&#8221; of the Xen code might somehow be &#8220;removed.&#8221;) The most privileged VM is called dom0 (sometimes called the &#8220;host domain&#8221; or the &#8220;control domain&#8221;), and although this is often a version of Linux, it need not be (see below). (So, no, Xen doesn&#8217;t necessarily have Linux in its TCB.)&#8221;</p>
<p>I think you&#8217;re misunderstanding the concept of a TCB and how systems are attacked. The TCB is anything that can compromise the security policy. I know my concern about Xen&#8217;s TCB is valid because even <a href="http://pdub.net/proj/usenix08boston/xen_drive/resources/xensummit/slides/XenSecurity_SHand.pdf" rel="nofollow ugc">XenSource</a> says so. Think of it like an equation: Hardware + Xen + Dom0 + any extra middleware supporting guest interactions = huge, complex TCB. There are many groups of bright security researchers working on this problem (e.g. XenSE). That alone says there is a problem. 😉</p>
<p>Note: the &#8220;remove Xen from TCB&#8221; was a sarcastic reference to the fact that it and a Dom0 combo are always in the TCB of any Xen solution. I can see how <em>that</em> might have made you say &#8220;huh?&#8221;</p>
<p>&#8220;permanently air gapped&#8230; complete air gaps&#8230; plug USB sticks in&#8230; Stuxnet&#8221;</p>
<p>More on USB attack vectors. Then a &#8220;trusted stranger plugged in trusted USB stick into insecure Windows PC led to its compromise&#8221; story. Already addressed USB. Then a new strawman called &#8220;permanently air gapped&#8221;. I&#8217;ve never mentioned a system where data never moves in or out b/c that would be useless for our discussion so why is 1/3 of your comment dedicated to them?</p>
<p>My air gap architecture does the following:</p>
<ol>
<li>Keep the system&#8217;s state, running software, etc. obscured from enemy.</li>
<li>Remove continual, direct access by keeping it disconnected 99%+ of the time.</li>
<li>Greatly reduce risk during connection points at hardware, driver, and software levels with tradeoffs allowed.</li>
</ol>
<p>As for the trusted machine itself, there are two options:</p>
<ol>
<li>A strongly, highly assured OS with POLA and stuff using state of the art chips for their hardware features. Untrusted machine would likewise be highly assured with dedicated hardware like a Network Pump or Data Diode for transfers. Might protect against almost every threat vector except NSA and such.
</li>
<li>
<p>Use of a diverse array of hardware and OS&#8217;s for trusted machine to [probably] prevent NSA type subversion, although w/out strongest resistance to other types of attacks.<br />
(Note: Xen Dom0 you said can be 3 OS&#8217;s right now. Option 2 allows for any hardware and OS combination ever invented with proper preprocessing on untrusted node. That&#8217;s why I call a Xen-based solution one with few options for Dom0.)</p>
</li>
</ol>
<p>If user chooses 1, this air gap solution can be made provably stronger than any virtualization solution. If the user chooses 2, then they can stop the subversion that might happen for users running on Intel hardware stateside (incl Xen solutions). They get to choose the threat model, then my architecture reduces their risk from there.  The final configuration can be anywhere from standard to high security depending on user&#8217;s preferences.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206996">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter">Craig</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206996">
						October 12, 2013 3:45 PM					</a>

				</p>

				<p>@ManInATux,</p>
<p>The point isn&#8217;t that you do it yourself.</p>
<p>Linux uses a hierarchical development model, where a given set of patches will be reviewed and signed off by at least 2-3 people before it even reaches the sub-tree maintainer (&#8220;Lieutenant&#8221; in LKML-speak). How do you propose to get a nasty patch past that kind of decentralised scrutiny? Then, if you do, how do you make sure that no other reviewer/auditor finds it before a merge or at some later date? Most Lieutenants and major contributors meet at conferences and sign each others public keys (in-person), to form a strong network of trust. Real world identities are mostly verifiable (at least the people reviewing and signing the commits, if not the author) and each and every change is recorded in history (via git).</p>
<p>Sure, it&#8217;s still possible to subvert this kind of system, but if you think Windows can even hold a candle to it in terms of security, transparency or auditability, you&#8217;re either an amateur or being completely disingenuous. I know you introduced yourself with a litany of credentials, but the Dunning-Kruger effect is a very real thing.</p>
<p>tl;dr Windows is an appalling operating system and no one should even humour it for security-critical uses. I&#8217;m shocked and somewhat disappointed that Bruce does.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206997">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206997">
						October 12, 2013 4:08 PM					</a>

				</p>

				<p>@ Mike the Goat</p>
<p>Excellent design. I&#8217;ve noticed its very similar to mine and quite old school in its simplicity. 😉 NetBSD is a nice choice due to its portability, obscurity relative to Linux, and its internals are easy to modify compared to most Unices. Helpful community and runs Linux apps too.</p>
<p>@ RSaunders</p>
<p>+1 to floppies. I mentioned them in my original air gap link esp as they have write protect (IIRC), there&#8217;s <em>tons</em> of OS software/hardware combos with floppies, and you can hear them if anything tries to write to them. And they&#8217;re extremely cheap like you said.</p>
<p>There&#8217;s also the possibility of using the &#8220;super floppy&#8221; formats or other obscure media to throw the attackers off. If there&#8217;s a guard between trusted and Internet PC, the guard&#8217;s higher security might even prevent attacker from figuring out what media is being used. Harder to subvert that way. What you think?</p>
<p>@ Craig</p>
<p>Nice assurance argument for Linux&#8217;s superiority to Windows in subversion detection. 🙂</p>
<p>@ Goldry Bluszco</p>
<p>&#8220;Well, I&#8217;m surprised no one&#8217;s mentioned paper tape for data interchange. &#8221;</p>
<p>I brought that up maybe a month ago here. I looked at old paper punch tape, high capacity barcodes, and the possibility of encoding info as a high-res pic printed on paper. Essentially, the safest ones have <em>horrible</em> capacity and those with better capacity take complicated hardware + software expanding risk. CD-ROM&#8217;s, floppies, serial ports, IDE, and restricted Ethernet are those with simplicity + usable capacity + many suppliers (reduce subversion).</p>
<p>So, I just ditched paper as a storage medium unless I&#8217;m storing text (aka printing). 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206998">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206998">
						October 12, 2013 8:08 PM					</a>

				</p>

				<p>I have not completely read all the comments but I&#8217;ve noticed one big difference with my typical file transfer flow between the airgapped and internet computer.</p>
<p>Always fill ALL available space on the transfer medium.</p>
<p>If I use a floppy  for file transfer than I create a file of pseudorandom data known to both host and target computer where the size of the file is trimmed to EXACTLY match the available space on the target medium.  I then XOR the target file with the pseudo-random file and write the resultant file to the floppy.</p>
<p>Since XOR with random is random it acts like OTP encryption. I  dont need to be so paranoid about safe disposal of the used floppy AND I know it is impossible for any compression applied at the Internet side to squeeze some space to make room for a virus load to tag along.</p>
<p>Small point I realize but in these matters I find good  Opsec is usually more important than perfect theoretical security.</p>
<p>Personally I don&#8217;t use modern USB sticks because they often contain lots of hidden space and extra so called &#8220;wear leveling&#8221; space, you just cant ever really know what you&#8217;ve got. Some modern sticks even incorporate read/write hardware to support Multibit-per-cell (3 or even 4 bits of information per Flash bit cell), you just cant know the real size of the device.</p>
<p>I&#8217;ve also played around with wired /wireless fie transfer where the transfer period is strictly controlled and AGWN is added to the link until a transfer is just possible using the most complex modulation possible  and suitable Forward error correction. This is basically a form of file transfer at the Shannon limit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206999">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-206999">
						October 12, 2013 10:21 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>What you&#8217;re describing is similar to my recommendation for mitigating covert channels for link encryption. I say use fixed sized chunks, fixed transfer rate. For efficiency, the channel is usually maxed out because who wants to use a slow rate, eh? So, both what&#8217;s on the line and what the CPU is doing always looks similar to the eavesdropper. Your proposal might have a similar effect compared to normal transfer methods.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207000">

			<div class="comment by-goldry-bluszco ">

				<p class="commentcredit">

					<span class="commenter">Goldry Bluszco</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207000">
						October 13, 2013 1:39 AM					</a>

				</p>

				<p>I just had the weirdest OT thought about the &#8220;celebrated&#8221; behavior of border guards in the States and the UK taking travelers&#8217; USB sticks.</p>
<p>Given a suitably capable stealth programmer and the state of knowledge of Microsoft Windows vulnerabilities and the market penetration of Microsoft products, border guards constitute an attack vector.</p>
<p>Maybe the border control that stopped David Miranda are even more stupid than they imagine. Just imagine: a USB stick with stuff hidden in the interstices. Border guard inserts stick; ET builds phone, phones home; much bigger &#8216;sploit (probly NSA-certified rootkit) visits to stay; infects network; PROFIT!</p>
<p>USB sticks of the required capacity are hardly expensive; suitably NSA-certified rootkits are probably available, though the NSA is probly not saying much about that. And NSA-certified &#8216;sploits aka backdoors are embedded into the fabric of &#8216;Net.</p>
<p>Having had that thought I think it&#8217;s so obvious that it&#8217;s likely to have happened already.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207001">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207001">
						October 13, 2013 2:16 AM					</a>

				</p>

				<p>Goldry: also off topic but I purchased a brand new USB stick, mounted it and found a few files on it. Okay so it was a manual PDF, a RECYCLER/ directory (hidden) and an autorun.inf. I got curious and rather than newfsing the disk immediately looked at the autorun which ran explorer.exe from the recycler directory.</p>
<p>Yup. Virustotal confirmed it. A new shrink wrapped packaged USB stick had a Trojan on it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207002">

			<div class="comment by-iwre0 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/iwre0' rel='external nofollow ugc' class='url'>iwre0</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207002">
						October 13, 2013 3:13 AM					</a>

				</p>

				<p>You guys, how much time do you spend to read one email?<br />
Once you read it, how much time to deliver the answer to the sender?</p>
<p>then, after send it,&#8230;.beep, another email, and begin again&#8230;</p>
<p>i think you get tired..don&#8217;t you?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207003">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207003">
						October 13, 2013 3:17 AM					</a>

				</p>

				<p>Nick: I had to use the ATMega164P as it has two UARTs. You&#8217;ll need two MAX232 to convert the levels too. Not too difficult a project. Unfortunately I can&#8217;t do any faster than 9600 bps reliably.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207004">

			<div class="comment by-poed-again ">

				<p class="commentcredit">

					<span class="commenter">Poed Again</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207004">
						October 13, 2013 6:09 AM					</a>

				</p>

				<p>@ Don Martin</p>
<p>LOL&#8230; just LOL&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207005">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207005">
						October 13, 2013 6:27 AM					</a>

				</p>

				<p>I see a lot of people talking about using Arduino and its ilk for serial communication. Why not program a Teensy 3.0 board with an SD card adapter (<a href="http://www.pjrc.com/store/sd_adaptor.html" rel="nofollow ugc">http://www.pjrc.com/store/sd_adaptor.html</a>) to present the file system on the SD card in various ways depending on the state of some extra jumpers.</p>
<p>Depending on the state of the jumpers it could (just some examples):<br />
* Only display filenames of files on the SD card but pretend they are empty<br />
* Replace contents of files with hashes<br />
* Display partially garbled filenames (kind of like 8.3 on Windows)<br />
* Refuse to present files with blacklisted names<br />
* Present the SD files but as an EncFS filesystem with a preprogrammed key<br />
* Just present the SD files in regular form</p>
<p>Assuming your attacker doesn&#8217;t know which setting you will use to defend yourself via inspection of the SD card before use, he runs a considerable risk that his exploit will be caught &#8212; something which we know is to the NSA like garlic is to vampires&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207006">

			<div class="comment by-mike-acker ">

				<p class="commentcredit">

					<span class="commenter">Mike Acker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207006">
						October 13, 2013 8:08 AM					</a>

				</p>

				<p>the intensity and ferocity of the attack on our communications is interesting in and of itself.</p>
<p>the one thing that works against the attackers though is the great number of people working in the business.  it is not possible to keep close and reliable tabs on all the help all the time and as a result I have at least some hope that the evil secrets will be exposed</p>
<p>nastyness baked into our chips is a considerable concern.   those of us who have been interested in and following open source software have put our faith in the idea that to keep anything honest the best plan is to get everything out in the open where everyone can look at it.    this seems to have gained a lot of steam with the early releases of PGP.</p>
<p>this seems to to have extended to open source O/S systems, particularly Linux.</p>
<p>I&#8217;ve been using Linux &#8212; first Ubuntu, now MINT &#8212; for the last year.   When I get my Linux system &#8212; I don&#8217;t get root access.  (I know how to get it &#8212; but &#8212; having read the Security Notes on Linux &#8212; I know that this is not necessary and definitely not what I want to do ) .</p>
<p>this is important: Initially when I power up my Linux box and log on I am the ONLY user on the system.  <strong> However when I open a web browser &#8212; either Firefox or Chromium &#8212; I am no longer the sole user of the system:  when I read a Web Page &#8212; the Web Author joins me at the chair&#8230;   </strong></p>
<p>The Web Author can&#8217;t update the Linux O/S: you have to use sudo and have the admin password to do that.   to get a key logger into the system that could transfer the admin password from one application to another requires root access and the Web Author can&#8217;t do it.  so It&#8217;s unlikely that the web author is going to compromise the Linux system itself.</p>
<p>there&#8217;s other mischief available though,&#8211; the web browser has pretty much un-restricted access to the assets owned by the logged on user.  as do most other app programs.    this is not a Good Thing.    I need to do more work with APPARMOR&#8211; learning to restrict what an app program can do.   this wouldn&#8217;t apply to every app program &#8212; just those having net access.  it might be well to create an app armor profile for every program &#8212; and &#8212; if general access is allowed &#8212; then restrict net access to nothing.    example Nemo, or Nautilus (known as file manager to windows users) .   such programs should not have net access.   OTH a file transfer program &#8212; such as FileZilla for Linux &#8212; needs net access and thus should have access to directories other than the local copy of the remote directory restricted.</p>
<p>an air-gap can probably help but if a windows system is used as an air-gap the it is critical to disable auto-run. i find it incredible that auto run was used as recently as the STUXNET incident to infect computers.   autorun is a total beginners&#8217; mistake dating back to the floppy disk and such treasures as the Pakistani Brain, STONED, Falling Letters, and the like&#8230;    Win7 leaves it disabled by default.</p>
<p>On net, I think air gap is  most likely un-necessary for a Linux system particularly if AppArmor is used.   Remember as you think about this: as soon as you harden your PC/Workstation &#8212; the attacker will put other resources into play.  Particularly Traffic Analysis.    ToR can help make traffic analysis more difficult, but it is also true that using ToR &#8212; is going to be a flag in and of itself.    which would lead to the next elements: physical security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207007">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207007">
						October 13, 2013 8:09 AM					</a>

				</p>

				<p>RonK: RS232 is good because the protocol is simple, well documented and universally supported. I think people like to avoid flash based media for a variety of reasons, some of them unrelated to the ubiquitous presentation of these devices via the USB mass storage like for example extreme difficulty in confirming erasure as a result of wear levelling. Using, say a CDRW would give you the ability to visually confirm erasure, for example.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207008">

			<div class="comment by-vas ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://vas.tomsk.ru' rel='external nofollow ugc' class='url'>vas</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207008">
						October 13, 2013 8:19 AM					</a>

				</p>

				<p>Dear Mr. Schneier,</p>
<p>For over a decade, we have been using UUCP over modem for transferring files to and from isolated FreeBSD (Taylor UUCP) and Windows NT (Kendra UUCP) hosts. Do you think UUCP makes a good airgap?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207009">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207009">
						October 13, 2013 8:22 AM					</a>

				</p>

				<p>vas: I use uuencode to move files from my workstation to my secure machine via a serial link as my data diode setup enforces 7bit ASCII. Of course it adds overhead on an already slow link but for the amount of data I actually transfer it is more than suitable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207010">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207010">
						October 13, 2013 8:49 AM					</a>

				</p>

				<p>@ Mike the Goat, Nick P,</p>
<p>I&#8217;ve been doing the serial port &#8220;data diode&#8221; and &#8220;security pump&#8221; since way before they were called data diodes. It was back when I was working for a Far East FMCE / telco manufacturer, many moons ago.</p>
<p>The problem they had was communicating to HQ from world wide offices, they used fax machines that would burn dial-up phone charging units at an extrodinarly painful rate. The HQ engineering dept also had a 75/1200 baud BBS used for dishing out errata and change orders and I got permission from the MD to try an experiment in that we would dial-in and download text files instead of faxes from them for our office, and they would then dial back and get text files from us (hence the download was always on the 1200 baud channel).</p>
<p>The MD was impressed with the initial cost savings (aprox 95%) and gave the go ahead for a better system. Unfortunatly he was not so impressed with later much lower saving, untill we pointed out just how much traffic increase there had been and that some people were sending rastor as oposed to vector graphic engineering files. What he did like a lot was it was all electronic and thus software and hardware fixes were way faster.</p>
<p>However on examing just what was being sent he became a little alarmed about dial-in security so I thought up a way of making it more secure. It used two Unix boxes at each end and the inside one was used as the collector of files from the office PC&#8217;s via a serial print switch and Kermit. A cron job then &#8220;printed&#8221; the files via serial cable to the second box which then used traditional Unix comms software to deliver them on.</p>
<p>The reason to go this way was Demon had just started offering what we would now consider &#8220;normal&#8221; Internet conectivity and we migrated over to it (yup it was that long ago when 33MHz 486SX&#8217;s were the hot thing to have).</p>
<p>I briefly described the &#8220;old equipment&#8221; setup I use several days ago on a thread in this blog, and I mentioned I used serial air-gap crossing and PIC microcontroler diodes / pumps / sluices to filter and check traffic as well as displaying it up analyser style (which one or more posters appear to have latched onto).</p>
<p>If you look at the Miicrochip PIC controlers the PIC24 series offer parts that easily rival those early PC&#8217;s and Unix boxes in terms of memory and IO, the real problem with them is a lack of &#8220;software interupt&#8221; but there is a simple trick to get around it. I&#8217;ve built tiny micro kernals for them and given them command line interfaces and ported chunks of Unix code across (less any complex file system support which you can fake-up inmost cases). And Microchip have the rather handy Explorer16 prototyping board along with extender cards for memory cards etc. They also now offer gratis USB and IP stacks along with FAT16 file systems so it&#8217;s relativly easy using their available code and a couple of books to hack a quite powerfull little system together.</p>
<p>One PIC24 related book I would recomend is by Lucio Di Jasio called &#8220;Programing 16bit Microcontrlers in C : Learning to fly the PIC24&#8221; from Newnes. And for those wanting to cut their own RTOS there is Jean J. Labrosse&#8217;s &#8220;MicroC/OS-II : The real time kernel&#8221; to give a head start. And a quick trundel around the Internet will give several hobby RTOSs etc for the PIC family. But why bother for the PIC24/dsPIC/PIC32 there is FreeRTOS which is available under GPL or commercial and there is a commercial &#8220;safty&#8221; version available with some of the hardest to get safety ratings ( <a href="http://www.highintegritysystems.com/safertos/" rel="nofollow ugc">http://www.highintegritysystems.com/safertos/</a> ).</p>
<p>There are also PIC32 chips that have replaced the internal traditional GI-Programable Interface Controler CPU core with a MIPS-M4K based one and in the process decoupled the core from Flash mem and IO hardware speed constraints. It also has a &#8220;poor mans&#8221; MMU which is a real advantage when doing your own OS. It will likewise run in an Explora16 board and has the tradition IO rich Microchip PIC IO structure that makes porting earlier PIC code fairly painless. As far as raw performance goes it will give the likes of 486&#8217;s a run for their money and probably quit a bit of legacy Digital hardware as well (when I&#8217;ve time I might try porting an early version of PDP Unix just to see if it can be done 😉</p>
<p>There is of course a cheaper way to get Linux on a Chip these days and thats the Rassberry Pi. However we know the Broadcom chip it uses has one heck of a sight more bits than is publicaly known. I suspect most are harmless but the chip was designed for smartphone usage which might raise a few eyebrows.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207011">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207011">
						October 13, 2013 9:04 AM					</a>

				</p>

				<p>Clive: yeah I considered using an embedded PC like a pc104 or a raspberry pi like device but figured it was a dumb idea as I was basically introducing more untrusted hardware into the mix. Hence using an 8-bit AVR. The code is pretty damn simple. Check the state of the gpio pins for my toggles on startup (if I want to change settings I restart rather than implementing code to change it on the fly.. Just for simplicity). 1,0=ingress 1,1=egress 0,1=bidirectional 0,0=disabled. In bidirectional mode it just acts like a synchronous proxy. In ingress/egress modes it will just silently drop any data that is going in the &#8216;wrong&#8217; direction (that is &#8211; not pass it on to the other UART). Given the speed of the microcontroller I find that 9600 bits/sec. is the maximum baud rate I can sustain reliably. This may not be a limitation of the AVR &#8211; maybe just be my crummy overly simplistic coding.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207012">

			<div class="comment by-matthew ">

				<p class="commentcredit">

					<span class="commenter">Matthew</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207012">
						October 13, 2013 9:16 AM					</a>

				</p>

				<p>The problem with using non Microsoft file formats and no macros is that the files on Bruce&#8217;s air gapped machine are Microsoft PowerPoint files that originated inside the NSA.</p>
<p>How do you export a PowerPoint File to plaintext?<br />
What do you do if the source files have macros necessary for them to properly show you the data you want to read?<br />
What if the NSA starts embedding malware macros in their own files, on the chance that those files leak?</p>
<p>Remember: Bruce has binary data that originated with his potential attacker&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207013">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207013">
						October 13, 2013 3:16 PM					</a>

				</p>

				<p>@ Matthew</p>
<p>You&#8217;re going to laugh but there&#8217;s an easy answer for this: bitmap images. You can export each slide as a picture, convert each pic to a bitmap, and put them in a zip file. Have any idea how many different setups can view that and with little complexity? Many. Almost every step can be automated using tools from open source code, too.</p>
<p>(Note: any speaker text or other sections can go in separate files, text files or otherwise, as necessary. They just need to reference the slide&#8217;s image filename in them so you know what they applied to.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207014">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207014">
						October 13, 2013 3:49 PM					</a>

				</p>

				<p>@ Mathew,</p>
<ul><i>How do you export a PowerPoint File to plaintext? What do you do if the source files have macros necessary for them to properly show you the data you want to read? What if the NSA starts embedding malware macros in their own files&#8230;</i></ul>
<p>As I&#8217;ve said above and many times before &#8220;Paper, Paper NEVER data&#8221;.</p>
<p>If you either print it out to paper or print to file in Postscript format you can rip out what you need. For paper you can scan the printout back in on the other side of the air-gap or data wise use a utlility like PS2TXT or equivalent.</p>
<p>The down sides are the length of time the vastly increased storage and most importantly securely destroying any print outs. All of which I&#8217;ve covered above.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207016">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207016">
						October 13, 2013 8:53 PM					</a>

				</p>

				<p>Out of Ubuntu, Red Hat, SUSE, and Debian, which is the most secure OS and why?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207017">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter">Craig</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207017">
						October 13, 2013 9:41 PM					</a>

				</p>

				<p>I won&#8217;t go into detail, but you&#8217;ll have to dig deeper than that list if you need real paranoid security. The first 3 of those 4 are tightly controlled by companies with either a very poor track records of integrity, very close relations to the U.S., or both. Novell have a very suspicious relationship with Microsoft, Mark Shuttleworth is one of the most slimy, double-dealing jerks in the business and Red Hat are very much in bed with the NSA.</p>
<p>Debian are more independent but have a pretty awful history when it comes to security. Their SSH key generator had a critical security vulnerability for over 2 YEARS and in my experience, owing to their lax standards, Debian packagers are, on average, quite inept.</p>
<p>The best you can do would be to use something like Arch or Gentoo, where frivolous patching is kept to a minimum, most dependencies are optional and over-engineering is met with scorn. These kinds of distros are far from straight forward to set up though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207018">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207018">
						October 13, 2013 10:08 PM					</a>

				</p>

				<p>Craig: this is why I like FreeBSD. You can look at the ports collection and see what patches are applied. But yes, I like the idea  of gentoo &#8211; I believe they have a ports like thing called portage.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207019">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207019">
						October 13, 2013 10:09 PM					</a>

				</p>

				<p>@Craig</p>
<p>I need the system to run some COTS engineering design tools, and there&#8217;s really not much on the market designed for outside those four distributions.  &#8220;IP theft&#8221; is as big or bigger than the NSA in my threat model.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207020">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207020">
						October 13, 2013 10:28 PM					</a>

				</p>

				<p>Anon: despite the key debacle if you were forcing me to choose out of those four I would choose Debian.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207021">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207021">
						October 13, 2013 10:52 PM					</a>

				</p>

				<p>@ Anon 10:09<br />
 The first question you need to answer is:<br />
Do I need more than one physical site to have access to a secure database at any one time?</p>
<p>If real-time access is required from all parts of the world all the time, then you have a very difficult problem to solve.</p>
<p>If there is only one air-gapped system with no comms required between different air-gapped entities then he problem is manageable.</p>
<p>We might have to talk about this offline if you have real commercial interest because I have real world experience with exactly the problems you&#8217;ll likely face.</p>
<p>BTW one of the biggest issues is likely to be the license server for the software tools authorization. You might want to make a small stand-alone setup first and see if it can even run the desired tools in airgapped mode i.e. without &#8220;phone-home&#8221; authorization.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207022">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207022">
						October 13, 2013 10:54 PM					</a>

				</p>

				<p>@ Anon</p>
<p>The trick to locating a decent Linux distro is a selection process (for the sake of brevity I&#8217;d skip some of the &#8220;features&#8221; distros.</p>
<ol>
<li>Evaluate distribution network (if all the mirrors are listed as were.sneaky.bastards.nsa.gov, odni.mil, disa.mil, or *.ch all bets are off)</li>
<li>Properly enumerated iso images with check sums</li>
<li>Non-GIT source iso availability, not likely to find hash values for them except the ISO images themselves </li>
<li>Strength of the developers community and its record for diligence (fedora, redhat share core for example, SuSE is followed by many ex Novell types&#8211;the own it, Ubuntu I believe was purchased by a chinese firm). </li>
<li>The comfort level with the platform (for me Slackware fits the bill for light weight. I still run a 486 with it on 16 Megs and can safely run motif). </li>
<li>Points for any campus that hosts a mirror that is close to you, walk over to there academic department and explain your situation. Someone will probably be interested in your quest. </li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207023">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207023">
						October 14, 2013 2:59 AM					</a>

				</p>

				<p>@ Mike the goat</p>
<blockquote><p>
  RS232 is good because the protocol is simple,<br />
  well documented and universally supported.
</p></blockquote>
<p>&#8220;Universally supported&#8221;? I&#8217;d say exactly the opposite, nowadays &#8212; it&#8217;s been a long time since I&#8217;ve seen serial ports on off-the-shelf consumer-oriented hardware, especially portable hardware.</p>
<blockquote><p>
  I think people like to avoid flash based media for<br />
  a variety of reasons, some of them unrelated &#8230;
</p></blockquote>
<p>If you are using my idea to transport encrypted files only (which is anyway the only reason you could justify the OPSEC overhead), none of the reasons you list is applicable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207024">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207024">
						October 14, 2013 3:06 AM					</a>

				</p>

				<p>@Mike Acker: &#8220;On net, I think air gap is most likely un-necessary for a Linux system particularly if AppArmor is used.&#8221;</p>
<p>This is a very bad idea, when NSA is after you (e.g. if you are Snowden, Petrobras, or any other company), even if you are used to AppArmor. All the applications are running on the same back-doored processor, including the suspect ones.</p>
<p>The problem with the suggestions below is that if these files are encrypted and you don&#8217;t want NSA to be able decrypt them. The obvious solution is, after transfering them, to send back to the one who built the document, that you prefer a tar archive with images, or output of ps2txt/pdftotext.</p>
<p>@Clive Robinson: &#8220;If you either print it out to paper or print to file in Postscript format you can rip out what you need. For paper you can scan the printout back in on the other side of the air-gap or data wise use a utlility like PS2TXT or equivalent.&#8221;</p>
<p>pdftotext will give better results that ps2ascii ; I did not have tested ts2txt.</p>
<p>@Nick P: &#8220;You&#8217;re going to laugh but there&#8217;s an easy answer for this: bitmap images. You can export each slide as a picture, convert each pic to a bitmap, and put them in a zip file.&#8221;</p>
<p>The zip format may have been backdoored. Prefer tar format.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207025">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207025">
						October 14, 2013 3:08 AM					</a>

				</p>

				<p>Typo in above post: replace &#8220;who built the document&#8221; by &#8220;who encrypted the document&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207026">

			<div class="comment by-q ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://wuala.com/FreemoveQuantumExchange' rel='external nofollow ugc' class='url'>Q</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207026">
						October 14, 2013 3:08 AM					</a>

				</p>

				<p>The same concepts are already operational since 2007 in the Freemove Quantum Exchange System, using datadiodes. Examples can be eg. found on wuala.com/FreemoveQuantumExchange/Aspects/Security/Programs/ChannelCodingExamples</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207027">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207027">
						October 14, 2013 3:15 AM					</a>

				</p>

				<p>@Craig: &#8220;The best you can do would be to use something like Arch or Gentoo, where frivolous patching is kept to a minimum, most dependencies are optional and over-engineering is met with scorn. These kinds of distros are far from straight forward to set up though.&#8221;</p>
<p>You need an update on Gentoo: it is easier than before, use the LiveDVD. And if you need a Gentoo installer even closer to Ubuntu, you may use Sabayon; after installation, stop using Sabayon packaging system, and use the Gentoo packaging system installed by Sabayon; use <code>emerge world</code> to automatically get a vanilla Gentoo.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207028">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207028">
						October 14, 2013 3:37 AM					</a>

				</p>

				<p>RonK: my comment re universal support was directed at the fact that all kinds of platforms have RS232 support. Given that those who are ultra paranoid will be using old hardware for their super secure machine then this becomes important. An old VAX or an old SPARCStation, an acorn RISC PC, etc&#8230; All of them have serial ports. You may as well use a deprecated architecture as they&#8217;ll likely be targeting Intel.</p>
<p>The good thing about RS232 is that I don&#8217;t need to run a CD or a USB stick backwards and forwards. I just tar up the files I want to move, uuencode it and then pump it into /dev/cuad0 after first pushing my toggle switch into the &#8220;ingress&#8221; position and turning on my data diode (and running a cat /dev/cuad0|uudecode|tar -zxv on the other side). The cool thing about uuencode is it will work when going from systems of different endianness too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207029">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207029">
						October 14, 2013 5:14 AM					</a>

				</p>

				<p>@ Mike the goat</p>
<p>It&#8217;s pretty clear that the discussion here is &#8220;all over the place&#8221;, so I accept your explanation about &#8220;universal support&#8221;. My proposal was more designed to help someone like Bruce, whose use case, it seems, doesn&#8217;t fit into the &#8220;ultra-paranoid&#8221; thread which the RS232 stuff fits into.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207030">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207030">
						October 14, 2013 5:33 AM					</a>

				</p>

				<p>RonK: yeah, it diverged from discussions way back about how the only hardware that could be truly trusted is about twenty years old. Someone remarked that 80386 was the last Intel chip that could be audited with standard electronic shop tools as it exposed everything and didn&#8217;t cache etc &#8220;inside the black box&#8221;. That wasn&#8217;t quite my point &#8211; more I was suggesting that pre-9/11 hardware would be more trustworthy from a political point of view, and I guess if you go a bit further back then the chip construction was such that a &#8220;backdoor&#8221; wouldn&#8217;t even be feasible to implement (not to mention that the dies were &#8216;big&#8217; enough to inspect with a light microscope). Even if subversion was possible you wouldn&#8217;t expect, say an 80486 was made well prior to ubiquitous TCP/IP networking &#8211; chances are it (some kind of remotely exploitable hardware based &#8216;bug&#8217;) wouldn&#8217;t have even be considered. If you go back further &#8211; example being a DEC VAX &#8211; which are still quite usable today then I think it is safe to assume that you don&#8217;t need to worry too much about your hardware.</p>
<p>That said my RS232 solution isn&#8217;t /that/ secure. Clive&#8217;s suggestion of paper is much nicer. I guess another option would be a telecine style setup where the secure machine has a camera attached trained on a small display. Of course even an ultra paranoid person has to stop somewhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207031">

			<div class="comment by-gonogo ">

				<p class="commentcredit">

					<span class="commenter">gonogo</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207031">
						October 14, 2013 6:50 AM					</a>

				</p>

				<p>Well, now that you have all secured your off-line PC to the point that there is no way to hack it from the outside, you are a prime target for a &#8220;TEMPEST&#8221; or rather a black bag operation.<br />
And you may no like the idea because the safety of your relatives and yours may be at stake.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207032">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207032">
						October 14, 2013 7:07 AM					</a>

				</p>

				<p>@ gonogo,</p>
<ul><i>&#8230; you are a prime target for a&#8221;TEMPEST&#8221; or rather a black bag operation And you may no like the idea because the safety of your relatives and yours may be at stake</i></ul>
<p>I mentioned these aspects on my first comment on this thread. And if you search this blog agains my name and Nick P you will find I&#8217;ve said a lot about TEMPEST and in more general EmSec, including not just the usual passive attacks, but active attacks including &#8220;fault injection on EM carrier&#8221;.</p>
<p>But as I said at the end of my first post on this thread,</p>
<ul>I could go on about the technical details in depth including KeyMan TEMPET/EmSec, secure destruction and anti-personnel systems, however two point arise, firstly I&#8217;m not writing a book here and secondly I&#8217;ve said much of it before on this blog</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207033">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207033">
						October 14, 2013 7:27 AM					</a>

				</p>

				<p>@ Mike the Goat,</p>
<p>Nice as thee &#8220;Paper Paper&#8221; idea is it has some downsides. One of which is &#8220;how much paper&#8221; it&#8217;s said that the Ed Snowden trove has 58,000 GCHQ documents in it (see UK authority section nine witness statments over Mr Greenwald&#8217;s partners detention and confiscation of electronics).</p>
<p>Assuming that is true you are probably looking at three to five times that number of documents which all have multiple pages, so we could easily be looking 2-3million pages&#8230;</p>
<p>Now at a rough gestimate that&#8217;s aroom high (8ft) stack for each 10,000 pages or upto 300 stacks&#8230; Which at the very least is a big bonfire by any bodies standards&#8230;</p>
<p>I tried a small experiment the other day to scan an standard PC type LCD display, and it did not come out well, however an electronic &#8220;paper white&#8221; display found in many eReaders did&#8230; What I don&#8217;t have is one of those combined LCD screen / Overhead projector units to see how well they perform.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207034">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207034">
						October 14, 2013 7:31 AM					</a>

				</p>

				<p>Clive: yes, I was thinking along the lines of a telecine &#8211; a camera coupled to a VDU, taking snapshots and if necessary running it through OCR on the other end.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207035">

			<div class="comment by-mike-acker ">

				<p class="commentcredit">

					<span class="commenter">mike acker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207035">
						October 14, 2013 8:39 AM					</a>

				</p>

				<p>@GentooAndroid</p>
<p>This is a very bad idea [] even if you are used to AppArmor. All the applications are running on the same back-doored processor, including the suspect ones.<br />
~~<br />
if the machine is rooted &#8212; you are toast.     with a Linux system that&#8217;s a bit tougher than it is on others: the attacker probably needs to have had physical access to your box.</p>
<p>once you switch to Linux, and particularly if you implement apparmor, you have probably hardened you system to the point when you need to focus on the other aspects of security,&#8211; laywers, courts, &#8230;.and goons.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207036">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207036">
						October 14, 2013 9:52 AM					</a>

				</p>

				<p>@ GentooAndroid</p>
<p>@Nick P: &#8220;You&#8217;re going to laugh but there&#8217;s an easy answer for this: bitmap images. You can export each slide as a picture, convert each pic to a bitmap, and put them in a zip file.&#8221;</p>
<p>&#8220;The zip format may have been backdoored. Prefer tar format.&#8221;</p>
<p>That&#8230; doesn&#8217;t make any sense. Zip&#8217;s a file archive format. It can&#8217;t be backdoored. The programs working with it can be backdoored or attacked via poor handling of zip files. The same is true for tar format, though. Either can be used for air gaps. I mentioned zip because more people are familiar with it and it can compress. Compression is very important if you&#8217;re using non-DMA, slower than average transport. I see most tar users agree, though, as their files typically have a .z at the end. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207037">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207037">
						October 14, 2013 11:08 AM					</a>

				</p>

				<p>&#8220;I see most tar users agree, though, as their files typically have a .z at the end. ;)&#8221;</p>
<p>Or even a 2!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207038">

			<div class="comment by-christian ">

				<p class="commentcredit">

					<span class="commenter">Christian</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207038">
						October 14, 2013 12:28 PM					</a>

				</p>

				<p>My thoughts are less about the technical and more about the human aspect.</p>
<p>Bruce is an expert in cryptography, and disciplined enough to run a reasonably secure air gap system. But going against the NSA, the odds are still heavily against him. There are attacks that he can&#8217;t defend against (physical security seems to be the obvious one), the agency has vastly more experience and resources, it can afford to make mistakes, and its agents go home at the end of the day (or their shift) with impunity. The conservative conclusion can only be that they will get what they want.</p>
<p>They also have the power to affect his life and the life of loved ones (as discussed by Clive) in subtle and not so subtle ways, directly and via other agencies of the state. His status might protect him from drastic measures, but not from softer ones. And the harassment can go on long after the Snowden revelations come to an end.</p>
<p>Given that the NSA can get what they want, and do what they want, what kind of process led to your decision to take part in the Snowden revelations anyway? Do you nevertheless think that you can successfully defend the documents and your personal security? Was it a fully informed decision, taking into account even worst case consequences, but &#8220;doing the right thing&#8221; outweighed them all? Or was it at some point an impulsive decision, which stopped further deliberation?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207039">

			<div class="comment by-bj ">

				<p class="commentcredit">

					<span class="commenter">BJ</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207039">
						October 14, 2013 5:48 PM					</a>

				</p>

				<p>Even a Windows computer NEVER needs to be connected to the internet.</p>
<p>I recently setup a Win8.1 (MSDN) system, and I didn&#8217;t want it to &#8216;activate&#8217; the OS key and Office key, etc. until I was sure I was happy with it, so I did not plug it in to a network.</p>
<p>I downloaded all the needed drivers from the hardware manufacturer with another computer, and if needed, I could have downloaded MS patches from MS.</p>
<p>If I didn&#8217;t ever want to plug it in, activation can be done over the phone with MS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207040">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207040">
						October 14, 2013 6:13 PM					</a>

				</p>

				<p>Bruce should put a tinfoil hat on it and post a plicture.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207041">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207041">
						October 14, 2013 7:14 PM					</a>

				</p>

				<p>@ Patricia</p>
<p>(Is this you, Valerie ?)</p>
<p>I like your concept a lot and appreciate the time you have taken to describe it in so much detail. The one thing I don&#8217;t like about it is the rather cumbersome moving back and forth of messages between systems using a CD/DVD. So I was wondering:</p>
<ol>
<li>Is this a real setup you are doing yourself, and &#8211; if so &#8211; are you using Raspberry Pi&#8217;s for both the IvoryTower and DoubtingThomas machines ? And possibly another one as your <a href="https://github.com/grugq/PORTALofPi" rel="nofollow ugc">Tor portal</a> (FYI: the network config is pre netctl and needs to be updated).</li>
<li>If yes to 1., are you running Raspbian on them or something else ? On IvoryTower, it could be interesting to consult/manipulate documents from a CD/DVD because it has xpdf and you can also put Libre Office on it.</li>
<li>Have you looked at integrating serial communication between CanonFodder and IvoryTower ? It&#8217;s <a href="https://www.youtube.com/watch?v=cY59EJu7py8" rel="nofollow ugc">definitely possible</a> (Broadcom UART appears as /dev/ttyAMA0 under Linux). Some added security using a data diode as described by other commentors would of course be even more interesting.</li>
</ol>
<p>Although I have some old 486&#8217;s and even a Sparc workstation left, I find the Raspberry Pi solution a tad more elegant and practical. That is of course assuming that it hasn&#8217;t been backdoored, but I don&#8217;t think anyone so far has gone through that trouble since mosts analysts initially thought of it as a completely unsellable product.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207042">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">andy</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207042">
						October 14, 2013 8:19 PM					</a>

				</p>

				<p>@patricia:</p>
<p>Unfortunately your advice to use RPi is quite risky. The BCM2835 CPU/SoC used on RPi has a large binary blob and proprietary GPU, which have complete control over the ARM running Linux. It&#8217;s quite likely that there are bugs and/or backdoors in the GPU or its software.</p>
<p>Additionally, the ARM Linux kernel has some shortcomings compared to the x86 kernel. For example, some ARM systems are missing a high-resolution timer (I believe the RPi is one of these), which means that entropy problems in /dev/urandom are much more severe than on modern x86 systems (which have RDTSC). Some devestating RNG attacks are enabled when you don&#8217;t have any entropy to feedback into the pool; a highres timer provides significant entropy.</p>
<p>Broadcom SoCs have a history of security issues inside the chips, as well.  If you can find a leaked copy of the BCM4704 errata list you&#8217;ll see some really amazing ones, and I don&#8217;t know any particular reason to believe they&#8217;ve gotten significantly better over time. Their design goal is to get a super-low-cost chip to market in the minimum time possible; security against a determined attacker is not part of their threat model.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207043">

			<div class="comment by-axon ">

				<p class="commentcredit">

					<span class="commenter">Axon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207043">
						October 15, 2013 1:20 AM					</a>

				</p>

				<p>@ Nick P (October 12, 2013 3:36 PM)</p>
<blockquote><p>Yes, it can be risky in some ways. Yet, your evidence/example is a strawman to my posts as I don&#8217;t advocate using USB sticks. Matter of fact, I specically criticized memory sticks in my last comments. USB sticks have the extra problem of issues with handling at PCI level. Then there&#8217;s executable subversion possibilities. Invisible Things Lab even wrote a nice blog post on USB issues, with a partial solution to problems. [Explanation of air gap proposal.]</p></blockquote>
<p>You&#8217;re confused. I didn&#8217;t commit a straw man fallcy because I wasn&#8217;t purporting to be arguing against your air gap proposal. I was arguing against your general claim that &#8220;Physical air gaps are <em>much</em> better for security.&#8221; As a matter of fact, I never said anything about your particular air gap proposal. I also never suggested that you advocated using USB sticks, and I never objected to your criticisms of memory sticks. In this case, you&#8217;re guilty of misreading (or failing to carefully read) my post. Look at the last sentence of mine which you quoted. I said, &#8220;But the behavior Bruce describes actually makes a physical air gap riskier in some ways.&#8221; I then went on to give an example of this. I was talking about <b>the behavior Bruce describes</b> in his original post as a basis for my example, which was a counterexample to your general claim that &#8220;Physical air gaps are <em>much</em> better for security.&#8221; (As my example shows, they&#8217;re not always better, let alone &#8220;much&#8221; better, for security. In some cases, they&#8217;re worse!)</p>
<blockquote><p>I think you&#8217;re misunderstanding the concept of a TCB and how systems are attacked. The TCB is anything that can compromise the security policy. I know my concern about Xen&#8217;s TCB is valid because even <a href="http://pdub.net/proj/usenix08boston/xen_drive/resources/xensummit/slides/XenSecurity_SHand.pdf" rel="nofollow ugc">XenSource</a> says so. Think of it like an equation: Hardware + Xen + Dom0 + any extra middleware supporting guest interactions = huge, complex TCB. There are many groups of bright security researchers working on this problem (e.g. XenSE). That alone says there is a problem. 😉</p></blockquote>
<p>No. You&#8217;re still the one who&#8217;s misunderstanding things here.</p>
<p>OK, let&#8217;s go through it step by step. You wrote:</p>
<blockquote><p>And since a Xen-based solution has Linux in its TCB it means Qubes might have issues because it depends on it. (Unless they somehow removed all influence on secure operation the Linux and Xen code might have. Somehow.)</p></blockquote>
<p>I quoted this and responded:</p>
<blockquote><p>No offense, but this comment suggests that you don&#8217;t really understand what Xen and Qubes are or how they work. Xen is a bare-metal hypervisor, which means that it runs in a more privileged CPU state than any other software on the machine. (So it literally doesn&#8217;t make sense to suggest that the &#8220;influence&#8221; of the Xen code might somehow be &#8220;removed.&#8221;) The most privileged VM is called dom0 (sometimes called the &#8220;host domain&#8221; or the &#8220;control domain&#8221;), and although this is often a version of Linux, it need not be (see below). (<b>So, no, Xen doesn&#8217;t necessarily have Linux in its TCB.</b>)</p></blockquote>
<p>So, let&#8217;s be clear: I was objecting to your claim that Xen has Linux in its TCB. And I was right to do so, because this claim of yours is false. The presentation you linked <b>in no way</b> supports it. It does <b>not</b> say or suggest in any way that Xen has Linux in its TCB. In fact, it doesn&#8217;t even <em>mention</em> Linux, so I <em>really</em> wonder why you think that it constitutes evidence in your favor.</p>
<blockquote><p>More on USB attack vectors. Then a &#8220;trusted stranger plugged in trusted USB stick into insecure Windows PC led to its compromise&#8221; story. Already addressed USB. Then a new strawman called &#8220;permanently air gapped&#8221;. I&#8217;ve never mentioned a system where data never moves in or out b/c that would be useless for our discussion so why is 1/3 of your comment dedicated to them?</p></blockquote>
<p>You don&#8217;t understand what the straw man fallacy is. This may come as a surprise to you, but <b>you&#8217;re the one who&#8217;s committing it</b>. You&#8217;re representing my argument as an argument against your proposed system when it&#8217;s not. I never even <em>mentioned</em> your proposed system, let alone argued against it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207044">

			<div class="comment by-don-martin ">

				<p class="commentcredit">

					<span class="commenter">Don Martin</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207044">
						October 15, 2013 7:16 AM					</a>

				</p>

				<p>Bruce,</p>
<p>You don&#8217;t need air gap.  Try getting to <a href="http://spxdemo.com" rel="nofollow ugc">http://spxdemo.com</a> &#8211; someones Red Team tried for 3 months and failed.  Once you are connected, the data is encrypted and bit randomized across 3 tunnels (three ports).  We use three x.509 certificates and for the severely paranoid, a certificate on the client side for the server to validate.  Any compromised certificate gives the adversary a channel of noise.  This means no man-in-the-middle, no playback, no DNS redirect and no need for VPN.  It  is ready for iOS and Android too.  There is a Sharepoint server sitting behind this URL.</p>
<p>This is another technology that resulted from the World&#8217;s Most Secure File Transfer I mentioned above.  Please look at this 1.5 minute video:</p>
<p><a href="http://www.youtube.com/watch?v=vUCLo-f5UNY" rel="nofollow ugc">http://www.youtube.com/watch?v=vUCLo-f5UNY</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207045">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207045">
						October 15, 2013 10:09 AM					</a>

				</p>

				<p>@ Andy</p>
<p><i>Some devestating RNG attacks are enabled when you don&#8217;t have any entropy to feedback into the pool; a highres timer provides significant entropy.</i></p>
<p>Hence my question in the more recent <a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html#c1909645" rel="nofollow ugc">Insecurities in Linux /dev/random</a> thread. It would seem that at least Raspbian can be tweaked to use the Raspberry pi&#8217;s 1Mb/s on-board HWRNG.</p>
<p><i>It&#8217;s quite likely that there are bugs and/or backdoors in the GPU or its software.</i></p>
<p>I can live with the BCM2835&#8217;s odd bug and even security issue given its intended use as a dirt cheap air-gapped system with a minimal attack surface. Low power signature, no Intel/AMD inside, no remote &#8220;anti-theft&#8221; technology (TPM et al), no soldering off bluetooth/wifi/microphone/camera, no Microsoft/Apple stuff and no legacy hardware required.</p>
<p>Although it cannot be precluded that Broadcom is in bed with the NSA too, I haven&#8217;t seen or heard anything tangible to that effect just yet, although &#8211; as pointed out by @ Clive &#8211; it was initially designed for smart phones, which is not reassuring. Note that the <a href="https://github.com/hermanhermitage/videocoreiv" rel="nofollow ugc">VideoCore IV firmware can be reverse engineered</a> and examined. This may not satisfy the ultra-paranoid, but IMHO still is a reasonable trade-off, especially for those who lack the resources and/or technical skills to pull off some of the more secure but also more complex setups as detailed by @ Nick P and others.</p>
<p>An additional advantage is its portability and a better protection against black bag attacks. Replacing a seized pi is far cheaper than buying (yet) another laptop/macbook, and hiding/destroying the SD containing your OS, software and working documents a lot easier than swallowing a DVD or hard disk (remember Saul Berenson in Homeland Season 2). I imagine your place getting raided and your systems seized being even more dramatic for those among us using legacy hardware such as 386&#8217;s, Vaxes, or Sparcs for their ultra-secret machine.</p>
<p>All in all, I believe a Raspberry pi solution to be a better trade-off between security and usability than the one @ Bruce is using right now. Raspbian has xpdf, you can install <a href="http://store.raspberrypi.com/projects/libreoffice" rel="nofollow ugc">Libre Office</a> onto it and even <a href="https://www.carrier-lost.org/blog/raspberry-pi-truecrypt-on-raspbian" rel="nofollow ugc">compile Truecrypt from source</a>. It&#8217;s low tech, easy to set up, dirt cheap, portable and has a much smaller attack surface than a traditional laptop/macbook while also offering better black bag protection.</p>
<p>@ Patricia (and others interested)</p>
<p>I just came across an alternative to thegrugq&#8217;s Raspberry pi PORTAL solution. Adafruit has something similar called <a href="http://learn.adafruit.com/onion-pi/overview" rel="nofollow ugc">Onion Pi</a>. Looks totally neat and they also have a great step-by-step guide to set it up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207046">

			<div class="comment by-jose ">

				<p class="commentcredit">

					<span class="commenter">Jose</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207046">
						October 15, 2013 11:29 AM					</a>

				</p>

				<p>Use two computers, one with internet conection the second with no conection to the web&#8230; second transfer data only with DVD/RW in and from the isolated computer, obviously use OTP encryption&#8230; Ahhhh oh yes take the blue pill&#8230;. and continue your life, remember you are in the matrix&#8230;. LOL</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207047">

			<div class="comment by-to-moderator ">

				<p class="commentcredit">

					<span class="commenter">To Moderator</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207047">
						October 15, 2013 11:58 AM					</a>

				</p>

				<p>@Windows Repairs juste copied the first sentence of Bruce&#8217;s blog post.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207048">

			<div class="comment by-bj ">

				<p class="commentcredit">

					<span class="commenter">BJ</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207048">
						October 15, 2013 1:41 PM					</a>

				</p>

				<p>re Windows Repairs&#8230;</p>
<p>And he/it (bot) probably filled in the URL with a link to a business.<br />
But it&#8217;s not shown here, so it&#8217;s wasting time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207049">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207049">
						October 15, 2013 7:34 PM					</a>

				</p>

				<p>@ Axon</p>
<p>I think the wording of my original comment may have caused much of this argument. So, I&#8217;m going to work on the phrasing in this one and get to the actual issue I have with Qubes for this. Remember that our threat model here is TLA&#8217;s, mainly the NSA.</p>
<p>My claim about Qubes is that they purport to be built on Xen to inherit its maturity, features, security level and hardware support at their foundation.  Xen platform&#8217;s Dom0 has privileged access to protection domains (guest VM&#8217;s) so it must be trusted not to violate the security policy. That makes it a potential attack vector and therefore part of the TCB. The presentation mentions the Xen TCB problem on p7 and Dom0 issues specifically on p8.</p>
<p>So, if Dom0 is in a Xen solution&#8217;s TCB and Dom0 is Linux, then Linux code is in the solution&#8217;s TCB. That simple. If Dom0 is something else (X), then &#8220;X&#8221; is in the solution&#8217;s TCB.</p>
<p>Using this magic formula, then QubesOS&#8217;s TCB consists of the Qubes team&#8217;s trusted software additions (if any), the Xen hypervisor, and whatever is in their Dom0. Maybe they use something other than Linux in their Dom0. Whatever it is, it&#8217;s trusted software that can be used to break isolation and therefore part of TCB.</p>
<p>I did include this qualifier in orginal comment:</p>
<p>&#8220;Unless they somehow removed all influence on secure operation the Linux and Xen code might have. Somehow.&#8221;</p>
<p>That means that, lacking the specific inside details of Qubes, one of my claims about Xen-based solutions might be wrong about Qubes. Maybe they fixed the Dom0 problem I was talking about. They&#8217;re good problem solvers. Here&#8217;s a few possibilities.</p>
<ol>
<li>They have no Dom0 at all. Pure microkernel type system on top of the Xen hypervisor. Somehow.</li>
<li>They put OpenBSD in Dom0 and stripped all unneeded functionality from it user and kernel mode.</li>
<li>They at least stripped the Linux code to the minimum in every part of it and rewrote any complicated part that was hard to analyse.</li>
<li>They used cutting edge techniques to enforce memory, control flow, and info flow protection on all code that is in Dom0 and Xen.</li>
</ol>
<p>They might have done something like that. If they did and its robust against TLA adversaries, then my overall claim about Qubes is false. If it&#8217;s built on Xen and Dom0 with mainstream OS code in it, then that OS code is in the TCB attack surface. It&#8217;s 0-days waiting to happen if our opponent is a TLA. NSA reportedly has a large stockpile. They might be sitting on one right now for systems built on Xen as that stack is quite popular.</p>
<p>(Note: All this resource sharing also creates covert channel problems. I&#8217;ve read at least one paper using them against Xen.)</p>
<p>My original solution was to use physical separation, a very hard to subvert transport, older/foreign components for trusted machine, a very strong LiveCD system for untrusted Internet machine, and optionally protection on transmission like a one-way link or guard node. This kind of situation has both low backdoor likelihood and strong air gap properties. My solution can also provably prevent or allow detection of covert storage and timing channels.</p>
<p>Altogether, it&#8217;s a superior alternative to Qubes against the adversary in our threat model who can probably subvert a Xen-based solution at will due to its TCB issues. Qubes is quite suited to dealing with the threat of vanilla malware, but it&#8217;s not as appropriate against a TLA backdooring and hacking all kinds of popular software/hardware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207050">

			<div class="comment by-peter-t ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://petersec.com' rel='external nofollow ugc' class='url'>Peter T</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207050">
						October 16, 2013 12:00 AM					</a>

				</p>

				<p>&#8220;Note: the first company to market a USB stick with a light that indicates a write operation &#8212; not read or write; I&#8217;ve got one of those &#8212; wins a prize.&#8221;</p>
<p>the early USB flash drives used to have a hardware write protection switch on their sides to make them read only.<br />
however I haven&#8217;t seen such a stick in many years, I guess the manufacturers have dropped this feature because it would cost them an additional 10 cents per piece. with some luck, on ebay we might find a few good old 32 MB flash drive with read-only switch</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207051">

			<div class="comment by-john-hasler ">

				<p class="commentcredit">

					<span class="commenter">John Hasler</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207051">
						October 16, 2013 10:52 AM					</a>

				</p>

				<p>It most certainly is possible to install an operating system on an isolated computer without connecting it to the Internet.  You can easily download and burn (or purchase) a set of Debian DVDs and use them to install Debian on an isolated machine.  I can easily believe that this is not possible with Windows, but I find it puzzling that anyone would go to the trouble of setting up an air-gap protected machine and then install Windows on it anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207052">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207052">
						October 16, 2013 12:02 PM					</a>

				</p>

				<p>@ Peter T</p>
<p>I&#8217;ve heard there&#8217;s a few vendors doing write protect switches. This is the only one I know of, though.</p>
<p><a href="http://www.kanguru.com/" rel="nofollow ugc">http://www.kanguru.com/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207053">

			<div class="comment by-gecko ">

				<p class="commentcredit">

					<span class="commenter">Gecko</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207053">
						October 17, 2013 9:21 AM					</a>

				</p>

				<p>Bruce underestimates tempest. You can switch on bluetooth from a huge distance for example, see blue sniper rifle. So you really have to destroy all antennas &#8211; and hope that there or no additional secret ones.</p>
<p>Bruce underestimates widows. The NSA owns windows. This means they can read from RAM, manipulate all kryptographic functionality, write data into file systems and so on. Even the best exploit for open source Linux should not provide the same rootkit power, at least not without being fully undetectable.</p>
<p>Bruce underestimates siphoning out. 1 GB on a USB stick is really a lot. Can&#8217;t you write a radom file of complementary size to a virgin write-once disk on a third computer (not the one with the secrets, not the internet computer) and then write your encrypted secret on the remaining space &#8211; this way absolutely minimizing the chance of additional data being written to that disk?</p>
<p>&#8230;I just have the feeling that bruce is not really concerned. I understand this as the leaks are in the semi-public domain. But if a secret service from a DIFFERENT country is getting the data then this still might affect national security?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207054">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter">Craig</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207054">
						October 17, 2013 4:41 PM					</a>

				</p>

				<p>@Steve</p>
<p>Sure, it&#8217;s easy to mock and ridicule when you yourself are of no consequence or interest to the establishment.</p>
<p>This is what can happen when you make yourself interesting:</p>
<p><a href="http://en.wikipedia.org/wiki/Death_of_Gareth_Williams" rel="nofollow ugc">http://en.wikipedia.org/wiki/Death_of_Gareth_Williams</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207055">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter">Craig</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207055">
						October 17, 2013 5:53 PM					</a>

				</p>

				<p>&#8220;You need an update on Gentoo: it is easier than before, use the LiveDVD. And if you need a Gentoo installer even closer to Ubuntu, you may use Sabayon&#8221;</p>
<p>@GentooAndroid</p>
<p>I have no interest in using Gentoo, nor in installers &#8220;closer to Ubuntu&#8221;. My needs are already satisfied. My comment was just an aside, as a &#8220;reader beware&#8221;. There are many Windows users out there who are beginning to understand the benefits of using Linux &#8212; not all of them can stomach an arduous installation process as a first taste.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207056">

			<div class="comment by-pj ">

				<p class="commentcredit">

					<span class="commenter">PJ</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207056">
						October 17, 2013 9:03 PM					</a>

				</p>

				<p>If you&#8217;re running linux and using full disk encryption, use this method to protect your unencrypted boot partition:</p>
<p><a href="https://wiki.archlinux.org/index.php/Dm-crypt_with_LUKS#Securing_the_unencrypted_boot_partition" rel="nofollow ugc">https://wiki.archlinux.org/index.php/Dm-crypt_with_LUKS#Securing_the_unencrypted_boot_partition</a></p>
<p>It works great!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207057">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207057">
						October 19, 2013 11:18 AM					</a>

				</p>

				<p>Hi, Bruce.</p>
<p>I&#8217;m wonder that you walk away Tempest attack.</p>
<p>You can watch an example of the government security container <a href="http://www.ets-lindgren.com/TIPS" rel="nofollow ugc">http://www.ets-lindgren.com/TIPS</a>  Tempest Shielded Enclosure.</p>
<p>You really should have one for your air-gapped network.</p>
<p>About Snowden&#8217;s documents. Could you share full list of titles of files that you have?</p>
<p>I&#8217;m read this article:</p>
<p><a href="http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security" rel="nofollow ugc">http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security</a></p>
<p><cite><br />
Without attention, the 2010 GCHQ document warned, the UK&#8217;s &#8220;Sigint utility will degrade as information flows changes, new applications are developed (and deployed) at pace and widespread encryption becomes more commonplace.&#8221; Documents show that Edgehill&#8217;s initial aim was to decode the encrypted traffic certified by three major (unnamed) internet companies and 30 types of Virtual Private Network (VPN) – used by businesses to provide secure remote access to their systems. By 2015, GCHQ hoped to have cracked the codes used by 15 major internet companies, and 300 VPNs.<br />
</cite></p>
<p>I can&#8217;t realize why reporters do that. They say: &#8220;30 types of VPN&#8221;, but there are no names, what kind of VPNs compromised?</p>
<p>What really NSA can do with VPN A or with VPN B. For whom does reporters submit such great leak, I don&#8217;t know. Could you share real names of broken software/hardware?</p>
<p>Cheers!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207058">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207058">
						October 21, 2013 8:49 AM					</a>

				</p>

				<p>Thanks for the tips. You guys are HARD CORE, you know that, right?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207059">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207059">
						October 25, 2013 7:05 AM					</a>

				</p>

				<p>By the way, are anybody know where to get cheap ATX case with embedded Faraday Cage or any other EMI shields against TEMPEST?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207060">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207060">
						October 25, 2013 9:34 AM					</a>

				</p>

				<p>@ Anonymous,</p>
<p>You don&#8217;t say where in the world you are so suggesting most suppliers of &#8220;built systems&#8221; is not going to help you.</p>
<p>However building your own is actually not that difficult the hardest part is probably getting access to perfed mild steel plate that has been zinc or equivalent coated, and the tools that will give a proffessional look to your finished system.</p>
<p>You can get all the other bits such as EMI / EMC filters from the likes of Digi-Key, and construction notes and ideas from either ARRL or RSGB published home constructors guides for Ham / Amature Radio operators.</p>
<p>One hard to source item is &#8220;RF Gasget&#8221; and it&#8217;s not cheap. However what you do is &#8220;make your own&#8221; by stripping out the woven braid from RF Coax like RG58 and use that instead. Or if you can find it &#8220;de-soldering braid&#8221; but this is usually covered in rossine (pine) flux that will need cleaning off. If you need to have a &#8220;spongy inner&#8221; then have a look at TV antenna down feed coax.</p>
<p>I&#8217;ve had built a number of &#8220;cages&#8221; like this at quite modest cost where the side pannels were solid sheet steal, I told the company making then they were to stop desktops being stolen and they didn&#8217;t look surprised.</p>
<p>If you are going to encase the screen (and you should do) this is where your problems are going to be. The solution is cloth woven from very very fine wire sometimes called &#8220;RF Cloth&#8221; it&#8217;s not easy to find. alternatives that are nowhere near as good are types of &#8220;chicken wire&#8221; fencing material. I got lucky in that I managed to find some anti-glare screens that had a metal coating on the glass that much to my surprise gave around 30db lossthrough HF / VHF / UHF bands. Not surprisingly microwave oven doors provide reasonable shielding but are generaly crap to look through.</p>
<p>Keyboard shielding can be done if you know what you are doing, the hard part is finding a keyboard where you cn get the keycaps off and put a thin metal sheet across with holes for the key sprues the caps go back on. I made a template using &#8220;baco-foil&#8221; and some foam. Basicaly put the foam down on a flat surface and lay a sheey of foil across it. Having removed all the key caps turn the keyboard sprue side down and press gently and evenly so all the sprues leave a mark on the foil. Lift the foil of lay on a pice of card or a cutting mat and then using a 5mm leather punch (or fired .22 cartridge)  cut out the sprue marks. Gently drop the foil template back on the keypad sprues to check it. If it&#8217;s OK use this template to punch out thin brass plate model makers use. Then build this into the keyboard case the details of doing this are very keyboard type selective so your out on your own there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207061">

			<div class="comment by-openmoko ">

				<p class="commentcredit">

					<span class="commenter">Openmoko</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207061">
						October 26, 2013 8:14 AM					</a>

				</p>

				<p>@Dirk Praet: &#8220;386&#8217;s, Vaxes, or Sparcs&#8221;; @Mike the goat:</p>
<p>To this list you may add this smartphone: <a href="http://fr.wikipedia.org/wiki/Neo_FreeRunner" rel="nofollow ugc">http://fr.wikipedia.org/wiki/Neo_FreeRunner</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207062">

			<div class="comment by-openmoko ">

				<p class="commentcredit">

					<span class="commenter">Openmoko</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207062">
						October 26, 2013 8:53 AM					</a>

				</p>

				<p>Oops, posted french link. Here is english link: <a href="http://en.wikipedia.org/wiki/Neo_FreeRunner" rel="nofollow ugc">http://en.wikipedia.org/wiki/Neo_FreeRunner</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207063">

			<div class="comment by-suspected ">

				<p class="commentcredit">

					<span class="commenter">suspected</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207063">
						October 27, 2013 7:18 PM					</a>

				</p>

				<p>2Openmoko, could you provide with a secret of all this open smartphones, why peoples called it &#8220;Open&#8221;?</p>
<p>According to wikipedia article: CPU     Samsung S3C2442 SoC @ 400 MHz</p>
<p><a href="http://www.samsung.com/global/business/semiconductor/product/application/detail?productId=7119&#038;iaId=836" rel="nofollow ugc">http://www.samsung.com/global/business/semiconductor/product/application/detail?productId=7119&#038;iaId=836</a></p>
<p>&#8220;Thus, an SoC designed for a mobile handset would include front-end GSM RF functionalities on-chip, which would be absent in an SoC designed for deployment in a digital still camera.&#8221;</p>
<p>&#8220;For more details about product specifications or technical files, please inquire through &#8216;Contact us&#8217; Some information may be limited to the authorized person or company.&#8221;</p>
<p>I&#8217;m not sure, but looks like this GSM may be enabled actually in digital cameras with this CPU.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207064">

			<div class="comment by-openmoko ">

				<p class="commentcredit">

					<span class="commenter">Openmoko</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207064">
						October 28, 2013 5:33 AM					</a>

				</p>

				<p>@suspected: &#8220;I&#8217;m not sure, but looks like this GSM may be enabled actually in digital cameras with this CPU.&#8221;</p>
<p>I don&#8217;t know.</p>
<p>They pretend that there is no proprietary driver for GSM. Only for Wifi+Bluetooth, and 3D acceleration; both are optional to me (ethernet over USB is a good replacment).<br />
<a href="http://lists.goldelico.com/pipermail/gta04-owner/2012-February/001532.html" rel="nofollow ugc">http://lists.goldelico.com/pipermail/gta04-owner/2012-February/001532.html</a></p>
<p>This page pretends to compile a GSM driver: <a href="http://bb.osmocom.org/trac/wiki/OpenMoko" rel="nofollow ugc">http://bb.osmocom.org/trac/wiki/OpenMoko</a></p>
<p>There a bugs <a href="http://projects.goldelico.com/p/gta04-kernel/issues/" rel="nofollow ugc">http://projects.goldelico.com/p/gta04-kernel/issues/</a> but you can fix them!</p>
<p>Various howto: <a href="http://projects.goldelico.com/p/gta04-kernel/doc/" rel="nofollow ugc">http://projects.goldelico.com/p/gta04-kernel/doc/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207065">

			<div class="comment by-openmoko ">

				<p class="commentcredit">

					<span class="commenter">Openmoko</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207065">
						October 28, 2013 9:58 AM					</a>

				</p>

				<p>@suspected, The documentation about the processor seems to be available (see below).</p>
<p><a href="http://www.ti.com/lit/ds/symlink/dm3730.pdf" rel="nofollow ugc">http://www.ti.com/lit/ds/symlink/dm3730.pdf</a></p>
<p>I understand that the processor may be backdoored, so it should not have been directly connected to antennas 🙁</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207066">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">peter</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207066">
						November 1, 2013 4:29 PM					</a>

				</p>

				<p>Also remember that the newer intel chips have built in 3g transmitters</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207067">

			<div class="comment by-aaron ">

				<p class="commentcredit">

					<span class="commenter">Aaron</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207067">
						November 22, 2013 10:03 PM					</a>

				</p>

				<p>To mitigate TEMPEST, use a laptop with a metal chassis for one, two, no RF at all going on, three, power from a full sine continuous UPS, four, run an old CRT tv in the room. Another good one is a brushed motor fan. Consider metal bearing paint under the latex on the wall if you can stand being in a cell dead spot while working. Prolly best to leave the cell phone out of the room anyhow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207068">

			<div class="comment by-mzet ">

				<p class="commentcredit">

					<span class="commenter">mzet</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207068">
						November 23, 2013 9:39 AM					</a>

				</p>

				<p>Here&#8217;s how I&#8217;ve set up Linux-based air gapped machine: <a href="http://softwareflaws.blogspot.com/2013/11/threat-update-10-setting-up-air-gapped_9346.html" rel="nofollow ugc">http://softwareflaws.blogspot.com/2013/11/threat-update-10-setting-up-air-gapped_9346.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207069">

			<div class="comment by-gary-barnes ">

				<p class="commentcredit">

					<span class="commenter">gary barnes</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207069">
						November 27, 2013 9:46 AM					</a>

				</p>

				<p>The length of time a person has been using an airgap is an indicator of their &#8220;cryptosavvy,&#8221; where cryptosavvy is a measure of mathematical crypto ability and common sense. Anyone who did not use an airgap prior to Snowden-2013 is clearly a cryptoidiot.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207070">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207070">
						December 2, 2013 1:07 PM					</a>

				</p>

				<p>Air gap is a start, but unless you remove wifi card from offline computer you are doing yourself no good against a serious adversary.  (That button you push to turn it off?  that is merely a <em>suggestion</em> to an operating system).<br />
I air gap the data collected on the offline computer as well:</p>
<p>If you research a variety of actors, you may want to remove hard drive from offline computer and keep data air-gapped from each other on plugin storages instead.</p>
<p>I boot from immutable CD, use external hard drives, and transfer data to/from the web using one-shot dvds.</p>
<p>even if they get me, they only get the research on themselves.  They don&#8217;t get my family photos, associated metadata, and other pii, like who I am, who I love, where I live.  Anyone can be gotten to.  Aks me how i knowz.</p>
<p>oh &#8212; and do NOT use an HP, unless you have some special knowledge for how to flash the graphics card.  Lulz can infect you here, and so could other bad guys, but ones you might never know about, ie, ones who don&#8217;t spit raspberries at you like Lulz tends to do.    I have multiple systems infected like this, and they&#8217;ve never been picked up by any anti-evil vendor out there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207071">

			<div class="comment by-iwre0 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/iwre0' rel='external nofollow ugc' class='url'>iwre0</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207071">
						December 2, 2013 1:31 PM					</a>

				</p>

				<p>Dave, what kind of computer do you use?<br />
and what is your main use for it?</p>
<p>thanks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207072">

			<div class="comment by-antitheist ">

				<p class="commentcredit">

					<span class="commenter">Antitheist</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207072">
						December 6, 2013 2:14 AM					</a>

				</p>

				<p>researchers at frauenhofer institute overcome the &#8216;air gap&#8217;.</p>
<p><a href="http://www.gulli.com/news/22888-prototyp-malware-ueberwindet-erfolgreich-air-gap-2013-12-04" rel="nofollow ugc">http://www.gulli.com/news/22888-prototyp-malware-ueberwindet-erfolgreich-air-gap-2013-12-04</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207073">

			<div class="comment by-doc ">

				<p class="commentcredit">

					<span class="commenter">Doc</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207073">
						December 19, 2013 10:35 AM					</a>

				</p>

				<p>Better alternatives to USB/CD transfers: <a href="http://spinellis.gr/blog/20131021/index.html" rel="nofollow ugc">http://spinellis.gr/blog/20131021/index.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207074">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207074">
						December 19, 2013 2:22 PM					</a>

				</p>

				<p>@ Doc,</p>
<p>Tthe page you link to says rather less than in the comments above. Forinstance have a look at,</p>
<ul>Ben • October 11, 2013 9:23 AM</ul>
<p>He proposes the same &#8220;serial&#8221; solution (only using Xmodem not Ymodem). Looking down from there you will find many comments about using RS232 serial data diodes pumps and sluices.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207075">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">mike</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207075">
						December 31, 2013 4:11 AM					</a>

				</p>

				<p>You can also use a text scanning software(OCR &#8211; optical character recognition)  so the only way your computer receives data is from printed and then scanned into the computer.  You could even do that with pieces of code and then compile them as well.  I would even go as far as removing any wifi chips, removing USB or filling the ports with glue, remove microphone/speaker.  There is also very crazy ways for a monitor and even a keyboard to emit a frequency that could possibly be picked up as well, not sure how to protect against that, but I am sure there are methods if you wanted to get to that level of paranoia.<br />
If you went that far, and your data was wanted bad enough, you would probably be stuck in Guantanamo and be tortured worse than any documented classified cases have shown  ;o</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207077">

			<div class="comment by-af ">

				<p class="commentcredit">

					<span class="commenter">af</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207077">
						January 5, 2014 4:23 AM					</a>

				</p>

				<p>I installed bleachbit to examine it, but my windows 8 never gets updates after that!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207078">

			<div class="comment by-black-panther ">

				<p class="commentcredit">

					<span class="commenter">Black Panther</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207078">
						January 9, 2014 10:22 PM					</a>

				</p>

				<p>A commenter above suggested not buying &#8220;off the shelf&#8221; but building a computer. They completely missed the security implications of ordering specific parts for a custom build vs. buying off-the-shelf where you can pick-up in store right that minute.</p>
<p>In a nutshell: if you order parts (online inevitably), the NSA have the chance to intercept the package and compromise it, knowing exactly who ordered it. If you buy very common off-the-shelf hardware (a complete computer system) from a major store where they have the computer ready for immediate collection, there is an extremely low to zero chance that the hardware was compromised before collection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207079">

			<div class="comment by-an-older-user ">

				<p class="commentcredit">

					<span class="commenter">An older user</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207079">
						March 3, 2014 8:52 AM					</a>

				</p>

				<p>Excuse my potentially stupid question, but I seem to have missed something. How would it be possible to have external access on my pc if the pc has no device to send out data, i.e. no wireless lan et cetera? Asked differently, why is not enough to simply ensure that the pc can&#8217;t connect anywhere? What I mean is: even if I got some spy ware on my pc, what does it matter when the gathered information cannot be sent to the interested parties anyway?<br />
I assume no-one will walk in my house and manipulate my pc&#8230;<br />
I would be very grateful for an answer</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207080">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207080">
						March 3, 2014 9:46 PM					</a>

				</p>

				<p>@ An older user</p>
<p>The essence of security is controlling the flow of information. You have to keep your sensitive information from getting to the enemy. You have to keep their malicious information from getting to you. The information itself is just electrical signals moving through various devices in your box. So, when building an &#8220;air gap,&#8221; what could go wrong?</p>
<ol>
<li>The attacker might get physical access to your system on site (popular with spies) or by intercepting it in transit (popular with NSA/FBI). With physical access, they can bypass the security, backdoor it, and implant tiny hardware that has built-in communications.</li>
<li>Your machine might have connectivity built-in that you didn&#8217;t know about. Typical examples are chips with built-in WiFi, bluetooth, or 3G. Vendors often re-use existing chips or intellectual property without telling you. If they spent millions to build an integrated smartphone chip that costs $50, why not use it in as many devices as possible to recover costs?</li>
<li>The method you use to move data to or from the air gapped machine naturally bypasses the protection. Enemy might use that method against you. Canonical example: using USB sticks to move files means they just got to infect your USB drive. Some also air gapped their machines with very expensive firewalls. With firewalls weakest link, the opponents just developed bypasses for that firewall. And so on.</li>
<li>There&#8217;s things in your machine that you might not think of as communication devices. A recent, exotic attack allowed air gapped machines to communicate over the sounds the speaker made in a range that human ear couldn&#8217;t hear.</li>
<li>
<p>Every machine emanates electromagnetic radiation all around it for a certain distance. With right equipment, a person nearby can capture that and possibly piece together the original information. That field of security is called EMSEC. The equipment that prevents leaks of such signals is &#8220;TEMPEST certified&#8221; in US. This equipment is ugly, often bulky, expensive, and restricted in availability by government.</p>
</li>
</ol>
<p>(I stated on this blog years ago that the US govt might keep us from having TEMPEST defenses so they have a sneaky way of spying on us. Leaked NSA catalog shows they use passive and active emanation attacks that TEMPEST might stop. Sneaky, sneaky.)</p>
<p>So, there&#8217;s quite a few ways an air gap can be made to connect or leak information. Dealing with these a step at a time, you must first determine who you don&#8217;t want spying on you and who you don&#8217;t mind. Buy the security critical tech or hardware at least from those you don&#8217;t mind. Use embedded boards as you can choose which features they have (eg wireless support). Many can run an open source firmware or Linux. That&#8217;s part of your problem solved right there.</p>
<p>The next step is how you connect things to it. The US govt uses &#8220;guards&#8221; that sit between networks, inspecting and controlling whatever flows between them. Your best bet is to use a simple embedded device, Linux or OpenBSD maybe, connected to trusted and untrusted systems with a serial port on each side. Serial ports are simple, easy to program, widely available internationally, and have less hardware attack surface. The guy I know who uses one says it&#8217;s about the slowest way you can move a file. Have fun with that. 🙂</p>
<p>(Note: floppy drives are also potentially useful because floppies are cheap and have a physical switch to prevent writing the disk. Potential attack I see, though, is the floppy firmware or driver has a bug that they exploit. Idk the odds which is why I gave serial port as main option.)</p>
<p>You also must protect the hardware in whole lifecycle. If you are being targeted, you will have to get someone else to buy the hardware for you. Inspect it on arrival looking for anything that&#8217;s not in the picture of the board. Embedded boards are nice again as they only have so many chips and the board&#8217;s picture is often on the web site. When you have it, you must physically secure it 24/7 from modifications. For emanations, no wireless devices, weird looking antenna, or people in suits with no evidence of personality should be in a 100-200 yd radius of the machine.</p>
<p>So, there&#8217;s a few steps on your journey down the rabbit hole that is information security. Enjoy the trip and try not to loose your mind to paranoia. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207081">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207081">
						March 3, 2014 11:59 PM					</a>

				</p>

				<p>Nick P RE: older user&#8217;s question<br />
&#8211;Good post; the blog&#8217;s been lacking from a real &#8220;Nick P&#8221; post for a while now&#8230;Just have a couple nit-picks which I know you love&#8230;</p>
<p>Barring a highly militarized environment, physical security can be compromised by a janitor (no disrespect, never elevate myself, just stating a fact; in fact I was able to test some &#8220;access violations&#8221; in a landscaping job).  The rarity of it also means that an attacker will have mostly smooth-sailing&#8230;</p>
<p>There are now beginning to be <em>a lot</em> of tools which people of low ability (again, not elevating myself.  In fact I can&#8217;t be 100% sure in radio b/c it&#8217;s so &#8220;jiggly&#8221; and sporadic) can begin setting up SDR&#8217;s to a dedicated computer (which can still be compromised yes, but for $35 you got a Pi, which you still need to flash a smart card on a computer that may be infected)  which will capture wide bands.</p>
<p>USB is nice and easy, and I&#8217;ve got an infected USB which I continue to use to spread infections so eventually the malware will be found; but regarding a &#8220;serial connection&#8221;, what needs to be clarified more is what code is analyzing the data.  If the peripheral controller is hacked, then you still will have potentially &#8220;goodies&#8221; being slipped in and you won&#8217;t see it.  Or if you&#8217;re physically approving each byte, that&#8217;s just highly impractical, only for crypto keys is that doable for the most people possible.</p>
<p>Hopefully soon, I&#8217;m going to get an OpenBSD box set up, but so far all the computers in my house so far that I&#8217;ve looked thru are infected w/ the same infection.  This laptop&#8230;it&#8217;s so infected I don&#8217;t know how it still functions&#8230;Seriously what can someone do at this point?</p>
<p>Protecting hardware thru the whole lifecycle <em>is</em> impossible and you know that.  Someone would need a lot of cash and a year following their computer from the metal-mining to the all the fabs&#8230;even watching someone work they could be installing an &#8220;ASM&#8221; virus or even worse malicious circuits to be noisy or route information to a hidden chip tucked away in a &#8220;benign component&#8221;, that is disgraceful engineering.</p>
<p>People that want to solve these problems&#8230;they will succumb to paranoia or just accept some malicious code stealing your CPU or blurting out to bluetooth receivers.  Check out Kali linux w/ all the bluetooth attack tools; wireless attacks are extremely trivial now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207082">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207082">
						March 4, 2014 12:27 AM					</a>

				</p>

				<p>An older user<br />
&#8211;To answer you&#8217;re question, no one really knows.  The security field has really been torn open lately where there&#8217;s literally nothing you can trust anymore.  This is a problem b/c now a wise assumption is basically all software is can be compromised on the internet.  Want to get a copy in the mail?  Interdiction.  NSL&#8217;s force people to lie to your face or they go to jail.  It&#8217;s such a clusterf*** that <em>the</em> NSA, this supposed superior group of eagle-eyed machines&#8230;they got socially-engineered and even worse they wouldn&#8217;t have noticed massive amounts of data leaking from their network.  So we&#8217;re stuck in this stupid loop and we need to cut the &#8220;features&#8221;, kill a lot of functionality and get back to the core of computing whereby even if you do get hacked the attacker[s] won&#8217;t be getting jack in return.</p>
<p>That&#8217;s my ultimate lesson, making sure the attacker won&#8217;t get jack, in fact s/he may get a little lesson that they can get owned just like the rest of us.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207083">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207083">
						March 4, 2014 10:18 AM					</a>

				</p>

				<p>@ figureitout</p>
<p>&#8220;physical security can be compromised by a janitor&#8221;</p>
<p>If you let them into your house, which I assumed was his use case. Maintenance men, support techs, &#8220;that guy from the utility company,&#8221; etc. are classic ways that both black hats and red teams get access. I mentioned physical security as a requirement. It&#8217;s hard enough that I didn&#8217;t care to give a guide on it.</p>
<p>&#8221; but for $35 you got a Pi&#8221;</p>
<p>That&#8217;s a common myth. A Pi is <em>not</em> $35. It&#8217;s so batteries not included that one must buy extra stuff to get it usable. End cost is usually closer to $70. A used laptop can be had for $80-100 so I don&#8217;t find Pi&#8217;s total cost of ownership to be so great. Great for hobbyists for other reasons, though.</p>
<p>At least until the $99 Parallela is available. 🙂</p>
<p>&#8220;Or if you&#8217;re physically approving each byte, that&#8217;s just highly impractical, only for crypto keys is that doable for the most people possible.&#8221;</p>
<p>The better route is to use memory and IO protection to designate a specific area for it. Then, the processor pulls from network/storage into that area using PIO. Then, a carefully written program checks it for input sanity or a hash if you have one. If it passes the checks, it&#8217;s moved into the next stage by yet another program. Any attempts to escape that area or otherwise do weird crap get caught by basic memory protection. This can be done on many simple and old processors as it was main way they operated before complex virtual memory became the norm.</p>
<p>And segmentation, much hated by mainstream, kicks the crap out of paging for building stuff like this. Good thing that the CHERI processor has a simple instruction set, open code, and a segmentation engine.</p>
<p>&#8220;Protecting hardware thru the whole lifecycle <em>is</em> impossible and you know that. &#8221;</p>
<p>Depends on what protecting means. There&#8217;s always a cutoff point. Many people don&#8217;t think they control the fabs and have made good arguments for that. Many, myself included, think they only backdoored things that are modern and widely used. Obscure or old stuff just has the typical problems. And interdiction is a targeted attack whereas most people aren&#8217;t targeted that way. So, one can get pretty far on hardware assurance without fabbing something.</p>
<p>&#8220;Hopefully soon, I&#8217;m going to get an OpenBSD box set up, but so far all the computers in my house so far that I&#8217;ve looked thru are infected w/ the same infection. This laptop&#8230;it&#8217;s so infected I don&#8217;t know how it still functions&#8230;Seriously what can someone do at this point?&#8221;</p>
<p>An OpenBSD box is nice. If your attacked by a sophisticated threat, you are unlikely to escape it by choice of OS. I&#8217;ve been operating under the assumption that my stuff is someone else&#8217;s property. Truly private stuff has to be done in person with trusted people in relatively random meeting places. Until the new architectures are designed and fabbed, there&#8217;s no way to build secure mainstream PC&#8217;s. Even my designs for that which I used in the past cost ludicrous amounts of money and have high maintenance. That I&#8217;ve recently been looking into NUMA and MPP machines hints at that cost.</p>
<p>Your situation will be easier if you decide on a use case first. You wanting to do video, web, crypto, programming, etc on same machine? Unlikely. You&#8217;re better off getting an old, obscure, air gapped machine for your secret stuff with one of the transfer schemes I mentioned. Anything truly not critical just assume it&#8217;s hacked and make backups onto write-once media that you check before storing.</p>
<p>For your fresh start, which you <em>will</em> need, go buy a new system. You might be better off buying several netbooks or desktops instead of a laptop. This is because you need physically separate machines plus lower cost (laptops ain&#8217;t cheap). A KVM switch is good if you get desktops. You need to go physically buy the systems from someplace with cash as enemies can&#8217;t interdict that. Get an open firmware for them, esp with trusted boot, that you check on another machine. If no changes (rootkit sign), install the firmware on the new machines. Disable wireless and anything you don&#8217;t need in firmware. Then, install a Linux or BSD on them. Follow hardening guides.</p>
<p>It&#8217;s a start. Of course, it&#8217;s so much trouble and one mistake will get you hacked. At least your PC&#8217;s will be more reliable, though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207084">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207084">
						March 5, 2014 9:19 AM					</a>

				</p>

				<p>Nick P<br />
<i>That&#8217;s a common myth.</i><br />
&#8211;True, the peripherals add a real and security cost; and if you use 2 usb devices you need a usb-hub to have an external usb.</p>
<p><i>you <em>will</em> need, go buy a new system</i><br />
&#8211;I really don&#8217;t want windows 8 preinstalled into roms I can&#8217;t kill w/o physical destruction and all the bloatware that makes me want to&#8230;burn this mother down.</p>
<p>I&#8217;m having a hard time imagining code sufficient to analyze all incoming serial data.  I would guarantee malware slipping by.</p>
<p>An older user<br />
&#8211;Please, it&#8217;s a blogpost not an actual useable product.  Just need simplified tutorial which no one can give b/c they don&#8217;t follow one and thus holes galore.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207085">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207085">
						March 11, 2014 4:20 PM					</a>

				</p>

				<p>I have found some Faraday Cages:</p>
<p>1) 28 Cu Ft Portable Faraday Cage Screen Room double copper mesh<br />
$995.00<br />
<a href="http://cavlon.com/zcstore/index.php?main_page=product_info&#038;products_id=10705" rel="nofollow ugc">http://cavlon.com/zcstore/index.php?main_page=product_info&#038;products_id=10705</a></p>
<p>2) Small portable Faraday Cage Screen Room double copper mesh<br />
$1,995.00<br />
<a href="http://cavlon.com/zcstore/index.php?main_page=product_info&#038;products_id=10704" rel="nofollow ugc">http://cavlon.com/zcstore/index.php?main_page=product_info&#038;products_id=10704</a></p>
<p>1-2k$</p>
<p>I&#8217;m also discovery EM Tents:</p>
<p>1) Cost effective instant Faraday tent:<br />
<a href="http://www.hollandshielding.com/158-Shielded_tents-en.htm" rel="nofollow ugc">http://www.hollandshielding.com/158-Shielded_tents-en.htm</a></p>
<p>strong and highly conductive textile</p>
<p>2) Ultra-Lightweight and Portable RF Shielded Tents:<br />
<a href="http://cryptome.org/bema-se.htm" rel="nofollow ugc">http://cryptome.org/bema-se.htm</a></p>
<p>Monsanto&#8217;s Flectron metallized material</p>
<p>I don&#8217;t know how to buy it.</p>
<p>And governments enclosures:<br />
1) The Raymond EMC QuietStation:<br />
<a href="http://www.raymondemc.ca/products/products1a.htm" rel="nofollow ugc">http://www.raymondemc.ca/products/products1a.htm</a></p>
<p>2) DEI Enclosures for Government:<br />
<a href="http://www.ets-lindgren.com/DEI-Screen" rel="nofollow ugc">http://www.ets-lindgren.com/DEI-Screen</a></p>
<p>Exterior Shield: Copper Screen</p>
<p>I don&#8217;t know, are a mere mortal can get one?</p>
<p>Could you folks describe me, what is the best?</p>
<p>I&#8217;m looking for the <s>cheapest</s> <u>comfortable</u> way to build <code>TEMPEST std</code> Air Gap.</p>
<p>For example, I can&#8217;t realize how Computer can be situated inside the Faraday Cage. I&#8217;m afraid to bring even a magnet to the HDD.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207086">

			<div class="comment by-tux ">

				<p class="commentcredit">

					<span class="commenter">Tux</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207086">
						April 20, 2014 10:02 PM					</a>

				</p>

				<p>Isn&#8217;t it open office/libre office&#8217;s dependency is java?  I hear a lot of bad words when it comes to java.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207087">

			<div class="comment by-tphilly ">

				<p class="commentcredit">

					<span class="commenter">TPhilly</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207087">
						May 1, 2014 12:12 PM					</a>

				</p>

				<p>AirGap by spikes security gave us an air gap with web access!!!  Thanks Spikes:)  No malware&#8230; full anonymity&#8230; what more could you ask for&#8230; and its reasonably priced.  I have been recommending it to my colleges as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207088">

			<div class="comment by-dpb ">

				<p class="commentcredit">

					<span class="commenter">DPB</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207088">
						May 30, 2014 9:26 AM					</a>

				</p>

				<p>To make sure you have full security disconnect any audio devices, too.</p>
<p><a href="http://thehackernews.com/2013/12/Malware-Inaudible-Audio-signals-badbios-virus.html" rel="nofollow ugc">http://thehackernews.com/2013/12/Malware-Inaudible-Audio-signals-badbios-virus.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207089">

			<div class="comment by-moti ">

				<p class="commentcredit">

					<span class="commenter">Moti</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207089">
						November 3, 2014 9:11 AM					</a>

				</p>

				<p>AirHopper is a new way to bridge the air gap:<br />
<a href="http://cyber.bgu.ac.il/content/how-leak-sensitive-data-isolated-computer-air-gap-near-mobile-phone-airhopper" rel="nofollow ugc">http://cyber.bgu.ac.il/content/how-leak-sensitive-data-isolated-computer-air-gap-near-mobile-phone-airhopper</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207091">

			<div class="comment by-ade ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://royalecraig.com' rel='external nofollow ugc' class='url'>Ade</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207091">
						June 1, 2015 8:37 AM					</a>

				</p>

				<p>there&#8217;s a very small linux distribution of about 50M called Damn Small Linux.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207092">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">joe</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207092">
						June 22, 2015 3:32 PM					</a>

				</p>

				<p>My advice, just ask Hillary Clinton, as she has done it all!   =]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207093">

			<div class="comment by-yoshi2 ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://soundcloud.com' rel='external nofollow ugc' class='url'>&quot;Yoshi2&quot;</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207093">
						March 17, 2016 5:45 PM					</a>

				</p>

				<p>The NSA and/or FBI is not necessarily the type of organization(s) to guard against.<br />
It&#8217;s other types of traversers that might be more worrisome.</p>
<p>Also, there are other reasons to keep a system offline besides just security issues.<br />
Some types of preferred computer configurations are possibly more efficient without unneeded software, firmware, and hardware installed or enabled.</p>
<p>Your toaster oven doesn&#8217;t need a wifi connection.  It&#8217;s just supposed to be a toaster oven.  And you might not even want to own a toaster oven if you&#8217;re cooking all the nutrients out of your own bread.  And why even have bread if you&#8217;re gluten intolerant.</p>
<p>This is why the &#8220;Internet of Things&#8221; movement is a nightmare.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207094">

			<div class="comment by-sonya ">

				<p class="commentcredit">

					<span class="commenter">Sonya</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207094">
						April 1, 2017 11:46 PM					</a>

				</p>

				<p>Okay, so I&#8217;m reaching out here hoping that someone here can help me air gap a windows 10 pc. I have disabled everything I can possibly think of&#8230; I have no connection to it in fact disabled all the internet services. It still sends out bytes, these are not loop back or bounce back and appear to be &#8220;datagrams.&#8221;</p>
<p>I am a designer, and I&#8217;d like to be able to have the option to keep my designs on my own device, no cloud services &#8211; in fact do not even use my Microsoft account.</p>
<p>I am constantly killing remote services that I have already disabled, I am constantly killing telephony (another service I have disabled). I have to end kill the processes for the background apps that I have gone out of my way to turn off.</p>
<p>I just did yet another clean install of windows trying to solve the issues but nothing works not one of their updates allows me to feel as though I have control over my own pc.</p>
<p>I have one program installed other than the graphics card driver&#8230; But these issues start before I even installed those.</p>
<p>I just want to be able to stop everything from going out, I do not want to see any thing displayed in &#8220;Network Other&#8221; in process explorer anymore. No one else has been able to help me so hopefully someone here might have some more solutions?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207095">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207095">
						April 2, 2017 8:00 AM					</a>

				</p>

				<p>@ Sonya,</p>
<blockquote><p> hoping that someone here can help me air gap a windows 10 pc. I have disabled everything I can possibly think of&#8230; I have no connection to it in fact disabled all the internet services. It still sends out bytes, these are not loop back or bounce back and appear to be &#8220;datagrams.&#8221;</p></blockquote>
<p>What are you trying to &#8220;air gap&#8221; the actual PC or a network it is connected to?</p>
<p>Because what you are describing sounds more like &#8220;hardening&#8221; your PC than &#8220;air gapping&#8221; it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-207096">

			<div class="comment by-banana ">

				<p class="commentcredit">

					<span class="commenter">Banana</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207096">
						November 30, 2018 10:31 AM					</a>

				</p>

				<p>Great post! However, maybe a better term thab paranoia can be used to describe a common motivator?paranoid adjective</p>
<p>para·​noid | \ˈper-ə-ˌnȯid, ˌpa-rə-\<br />
variants: or less commonly paranoidal \ ˌper-​ə-​ˈnȯi-​dᵊl , ˌpa-​rə-​ \<br />
Definition of paranoid</p>
<p>1 : characterized by or resembling paranoia or paranoid schizophrenia a paranoid psychiatric patient</p>
<p>2 : characterized by suspiciousness, persecutory trends, or megalomania behaving in a paranoid manner with accusations of persecutions</p>
<p>3 : extremely fearful was so paranoid that he was afraid to walk the streets</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-207097">

			<div class="comment by-j ">

				<p class="commentcredit">

					<span class="commenter">J</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/#comment-207097">
						January 13, 2020 8:19 PM					</a>

				</p>

				<p>TAILS has come quite the way since your article was posted, and continues to lead the way for privacy minded users.</p>
<p>Came across your article via Robert Fisk&#8217;s post &#8211; <a href="https://globotron.nz/blogs/news/needs-more-blinky" rel="nofollow ugc">https://globotron.nz/blogs/news/needs-more-blinky</a> &#8211; who also saw it upon himself to accept your challenge and create a USB storage device with a write LED.</p>
<p>Hope he&#8217;s scored himself a sweet prize. Lol</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2013/10/air_gaps.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2013/10/air_gaps.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F10%2Fair_gaps.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2013/10/air_gaps.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5050' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2013/10/build_your_own_1.html" rel="prev">← Build Your Own Enigma</a>		<a href="https://www.schneier.com/blog/archives/2013/10/new_low_in_elec.html" rel="next">New Low in Election Fraud →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
