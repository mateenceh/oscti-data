<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Insecurities in the Linux /dev/random - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Insecurities in the Linux /dev/random Comments Feed" href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5045" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5045' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F10%2Finsecurities_in.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F10%2Finsecurities_in.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5045 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5045" class="post-5045 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-cryptography tag-linux tag-random-numbers">

	<div class="article">

		<h2 class="entry">Insecurities in the Linux /dev/random</h2>
		<p>New <a href="http://eprint.iacr.org/2013/338.pdf">paper</a>: &#8220;Security Analysis of Pseudo-Random Number Generators with Input: /dev/random is not Robust, by Yevgeniy Dodis, David Pointcheval, Sylvain Ruhault, Damien Vergnaud, and Daniel Wichs.</p>
<blockquote><p><b>Abstract</b>: A pseudo-random number generator (PRNG) is a deterministic algorithm that produces numbers whose distribution is indistinguishable from uniform. A formal security model for PRNGs with input was proposed in 2005 by Barak and Halevi (BH). This model involves an internal state that is refreshed with a (potentially biased) external random source, and a cryptographic function that outputs random numbers from the continually internal state. In this work we extend the BH model to also include a new security property capturing how it should accumulate the entropy of the input data into the internal state after state compromise. This property states that a good PRNG should be able to eventually recover from compromise even if the entropy is injected into the system at a very slow pace, and expresses the real-life expected behavior of existing PRNG designs. Unfortunately, we show that neither the model nor the specific PRNG construction proposed by Barak and Halevi meet this new property, despite meeting a weaker robustness notion introduced by BH. From a practical side, we also give a precise assessment of the security of the two Linux PRNGs, /dev/random and /dev/urandom. In particular, we show several attacks proving that these PRNGs are not robust according to our definition, and do not accumulate entropy properly. These attacks are due to the vulnerabilities of the entropy estimator and the internal mixing function of the Linux PRNGs. These attacks against the Linux PRNG show that it does not satisfy the &#8220;robustness&#8221; notion of security, but it remains unclear if these attacks lead to actual exploitable vulnerabilities in practice. Finally, we propose a simple and very efficient PRNG construction that is provably robust in our new and stronger adversarial model. We present benchmarks between this construction and the Linux PRNG that show that this construction is on average more efficient when recovering from a compromised internal state and when generating cryptographic keys. We therefore recommend to use this construction whenever a PRNG with input is used for cryptography.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/linux/" rel="tag">Linux</a>, <a href="https://www.schneier.com/tag/random-numbers/" rel="tag">random numbers</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html" rel="bookmark">Posted on October 14, 2013 at 1:06 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html#comments">121 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html" data-title="Insecurities in the Linux /dev/random" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-206541">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206541">
						October 14, 2013 1:44 PM					</a>

				</p>

				<p>So why havent they subbmitted a patch to the kernel dev team?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206542">

			<div class="comment by-adrian-ratnapala ">

				<p class="commentcredit">

					<span class="commenter">Adrian Ratnapala</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206542">
						October 14, 2013 1:47 PM					</a>

				</p>

				<p>If there is a vulnerability (especially an academic sounding one like this) then I am not surprised it comes via the entropy estimation.  Ted Tso claims (and I believe) that it&#8217;s just a *cking hard thing to do.</p>
<p>So the question is, how can we do better?  Since I doubt entropy estimation is going to get much less unreliable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206543">

			<div class="comment by-samuel-alexik ">

				<p class="commentcredit">

					<span class="commenter">Samuel Alexik</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206543">
						October 14, 2013 1:52 PM					</a>

				</p>

				<p>It is good that someone do an analysis.<br />
What if this new construction of PRNG will insert an hidden insecurities into GNU Linux kernel PRNG ?<br />
The current situation plays with us but also plays against. We might be now more open, to fast fixing insecurities than ever. Same claim can be applied to this post, because new construction is better than actual one:-) , etc&#8230;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206544">

			<div class="comment by-jarrod-frates ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://llamasinmynetwork.com' rel='external nofollow ugc' class='url'>Jarrod Frates</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206544">
						October 14, 2013 2:12 PM					</a>

				</p>

				<p>Adrian: Implementing a solution that provides true randomness would be the best way to handle it.  VIA&#8217;s C7 processors had this by measuring electrical noise in the CPU, but they&#8217;re increasingly hard to find.  Given that a complete CPU/motherboard combo could be had for less than the cost of an Intel CPU, I don&#8217;t think it would cost much to add it to new CPU architectures, even if VIA got patent royalties.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206545">

			<div class="comment by-maxcohen ">

				<p class="commentcredit">

					<span class="commenter">maxCohen</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206545">
						October 14, 2013 2:18 PM					</a>

				</p>

				<p>I think Bruce gets his blog ideas from xkcd&#8230;<br />
<a href="http://imgs.xkcd.com/comics/ayn_random.png" rel="nofollow ugc">http://imgs.xkcd.com/comics/ayn_random.png</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206546">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206546">
						October 14, 2013 2:27 PM					</a>

				</p>

				<p>If you are concerned about random numbers in your computer, then you need a hardware random number generator.  Do a Google search for hardware random number generators.  Some are on USB, some are PCI, and there&#8217;s one that plugs into a serial port.  If you are cheap, then you could point a camera at a lava lamp or a plasma globe.  Maybe the scene outside of your window is enough for random number seeds.</p>
<p>Take a look at <a href="http://spectrum.ieee.org/computing/hardware/behind-intels-new-randomnumber-generator" rel="nofollow ugc">Behind Intel’s New Random-Number Generator</a> to see what Intel did for their processors.</p>
<p>The point of the paper is that /dev/random can be attacked, and done so successfully.  Intel has been putting a random number generator in chips since at least 2004 (<a href="http://www.ncbi.nlm.nih.gov/pubmed/15447877" rel="nofollow ugc">Intel random number generator-based true random number generator</a>, Intel 815 chipset &amp; ISD) with no detectable problems.  I&#8217;ve found references to AMD HRNG back to 2002.</p>
<p>Honestly, I have no idea why anybody&#8217;s kernel would ignore any available hardware random number generator.  It&#8217;s a complete no-brainer to use it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206547">

			<div class="comment by-jockular ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://none' rel='external nofollow ugc' class='url'>Jockular</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206547">
						October 14, 2013 2:37 PM					</a>

				</p>

				<p>Translation? that the random number generator in Linux has been weakened? does not perform robust encryption? &#8211; thnx in advance!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206548">

			<div class="comment by-bystander ">

				<p class="commentcredit">

					<span class="commenter">Bystander</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206548">
						October 14, 2013 2:37 PM					</a>

				</p>

				<p>@Jarrod</p>
<p>Electrical noise within the CPU is partially deterministic. It depends on the code executed and the quality of the supply and changes with the age of e.g. electrolytic capacitors, so and the random generator would not pass the NIST test.</p>
<p>Thermal noise, radioactive decay are considered safe.<br />
If you design a hardware random generator on a motherboard, you must be extremely careful supply-wise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206549">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206549">
						October 14, 2013 2:42 PM					</a>

				</p>

				<p>@Brian M:<br />
How do we know we can rely on Intel&#8217;s HRNG? How do we know they don&#8217;t reduce entropy or do some other fancy things? With open source software (Linux Kernel) we know what we do, even if it is not perfect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206550">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206550">
						October 14, 2013 2:52 PM					</a>

				</p>

				<p><b>Rant:</b></p>
<p>It bugs me to see headlines like, &#8220;Researchers can backdoor hardware chips,&#8221; etc.  It&#8217;s like reading, &#8220;Researchers can cause Boeing 747 crash by replacing jet engines with engines from a 1971 Ford Pinto in mid-flight!&#8221;  No, really???</p>
<p>While the paper looks like a good paper, there&#8217;s some things that really point to a &#8220;well, duh, people!&#8221; response.  &#8220;If I rootkit your machine, I can screw with your random number generator.&#8221;  Well, duh!  &#8220;There&#8217;s a bug in OpenSSL!&#8221;  Well, duh!  &#8220;We ignored the available HRNG in favor of our cool algorithm, and there&#8217;s a problem with the entropy.&#8221;  Well, duh!</p>
<p>Installations are <i>supposed</i> to optimize themselves for the available resources.  So why is it that the HRNG on the motherboard is ignored when it&#8217;s available?  <i>That</i> is the question that should be asked!!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206551">

			<div class="comment by-michael-moser ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mosermichael.github.io/cstuff/' rel='external nofollow ugc' class='url'>Michael Moser</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206551">
						October 14, 2013 2:59 PM					</a>

				</p>

				<p>If I understand correctly then /dev/urandom is only pseudo random; Using /dev/random directly is impractical, because you usually do not have enough entropy at a given moment in time; reading from /dev/random can block for some time;</p>
<p>I guess the right way is using /dev/random in order to seed something like SHA1PRNG (repeatedly computing SHA1 of the seed)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206552">

			<div class="comment by-adf ">

				<p class="commentcredit">

					<span class="commenter">adf</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206552">
						October 14, 2013 3:09 PM					</a>

				</p>

				<p>@brian: do you read Bruce&#8217;s blog?</p>
<p>This came up some weeks ago.</p>
<p><a href="https://plus.google.com/117091380454742934025/posts/SDcoemc9V3J" rel="nofollow ugc">https://plus.google.com/117091380454742934025/posts/SDcoemc9V3J</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206553">

			<div class="comment by-alex-s ">

				<p class="commentcredit">

					<span class="commenter">Alex S</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206553">
						October 14, 2013 3:18 PM					</a>

				</p>

				<p>This seemed like a great hardware answer, but they don&#8217;t seem to be able to ship them:</p>
<p><a href="http://www.entropykey.co.uk/" rel="nofollow ugc">http://www.entropykey.co.uk/</a></p>
<p>It&#8217;s hard to justify something expensive if you don&#8217;t have a specific use case, but I&#8217;d definitely buy a cheap hardware RNG if it were available.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206554">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206554">
						October 14, 2013 3:21 PM					</a>

				</p>

				<p>@Chris:<br />
<i>How do we know we can rely on Intel&#8217;s HRNG?</i></p>
<p>How many tests over the years have shown that Intel&#8217;s HRNG chips are good?  The hits for that are on the first page of a Google search, going back to 2004.  Nine years of tests!  Also, read up on what Intel and AMD have done to produce good HRNG chips for your use.  If you have, or anybody else has, a link to a paper that shows an AMD or Intel HRNG being faulty, please post it!</p>
<p>Let me put it another way:  if you don&#8217;t have the math to test the numbers, and you don&#8217;t trust anybody, what are you going to do??  You are screwed.</p>
<p>AFAIK, none of the HRNG manufacturers list the conditioning code for their systems, so all of them are closed source.  That means that the only thing that can be done is statistical analysis, like Diehard and DieHarder.  Check the <a href="http://en.wikipedia.org/wiki/Statistical_randomness" rel="nofollow ugc">Wikipedia page</a> for pointers to get started.</p>
<p>Really, some of this stuff starts sounding like, &#8220;The NSA has sabotaged quantum physics!&#8221;  Sheesh.</p>
<p>@adf:<br />
Random numbers are <i>testable</i>.  Point me to a paper that says, &#8220;This [Intel | AMD | Via | blah blah] HRNG is worse than my kid sister&#8217;s 8-bit cyclic XOR.&#8221;  A backdoor is like the one on the DLink routers.  <i>That</i> is a real backdoor!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206555">

			<div class="comment by-tim ">

				<p class="commentcredit">

					<span class="commenter">Tim</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206555">
						October 14, 2013 3:26 PM					</a>

				</p>

				<p>@ maxCohen</p>
<p>That cartoon confuses two different theories of value. Intrinsic values would be Plato, not Ayn Rand.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206556">

			<div class="comment by-insecuritant ">

				<p class="commentcredit">

					<span class="commenter">InsecuritanT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206556">
						October 14, 2013 3:28 PM					</a>

				</p>

				<p>If I remember correctly, /dev/urandom doesn&#8217;t know if it has sufficient entropy to hand out pseudo random numbers but if called it hands out what it has anyways. So if you were running a server install with no physical interaction and were to use it as a source you could have serious RN problems.</p>
<p>The cloudflare blog recently talked about the problems they found with /dev/random and how they are mitigating it with hardware TRNG.</p>
<p>I don&#8217;t understand why Linux just doesn&#8217;t copy the *BSD yarrow model. The paper says they are not sure of a practical attack but they aren&#8217;t the NSA, who probably figured out /dev/[u]random was crippled long ago.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206557">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206557">
						October 14, 2013 4:07 PM					</a>

				</p>

				<p>@ Brian M</p>
<p>&#8220;How many tests over the years have shown that Intel&#8217;s HRNG chips are good? The hits for that are on the first page of a Google search, going back to 2004. Nine years of tests! Also, read up on what Intel and AMD have done to produce good HRNG chips for your use. If you have, or anybody else has, a link to a paper that shows an AMD or Intel HRNG being faulty, please post it!&#8221;</p>
<p>I could come up with a way to subvert that where black box tests think it&#8217;s random and I&#8217;m neither a cryptographer nor a hardware expert. Seeing as NSA has been subverting US entropy sources, then they could quite easily do something to the processing where they could break it and others couldn&#8217;t. A black box test wouldn&#8217;t prove anything in that case.</p>
<p>&#8220;Let me put it another way: if you don&#8217;t have the math to test the numbers, and you don&#8217;t trust anybody, what are you going to do?? You are screwed.&#8221;</p>
<p>That&#8217;s not the situation. We don&#8217;t trust companies with a high likelihood of working with the NSA or who are using unjustifiably poor crypto. Intel seems to be in one boat, Linux /dev/random apparently in the other. That leaves plenty of sources for hardware and software to generate good random numbers. Just can&#8217;t use these few.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206558">

			<div class="comment by-laura-hamilton ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.lauradhamilton.com' rel='external nofollow ugc' class='url'>Laura Hamilton</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206558">
						October 14, 2013 4:19 PM					</a>

				</p>

				<p>Interesting. So is this exploitable?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206559">

			<div class="comment by-jack-bates ">

				<p class="commentcredit">

					<span class="commenter">Jack Bates</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206559">
						October 14, 2013 4:19 PM					</a>

				</p>

				<p>@Jarrod :</p>
<p>I&#8217;ve use the VIA C7 before.</p>
<p>It is not well-known, but the Raspberry Pi has a 1Mb/s HWRNG on-board.</p>
<p>The circuitry is not open-source, however.</p>
<p>CHEERS</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206560">

			<div class="comment by-jack-bates ">

				<p class="commentcredit">

					<span class="commenter">Jack Bates</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206560">
						October 14, 2013 4:22 PM					</a>

				</p>

				<p>@Brian :</p>
<p>The noise on an unsaturated ICCD (web chip) is generally a pretty good source of entropy.  Compressing this noise with a cryptographic hash function yields very good entropy with several $5 webcams that I&#8217;ve tried this with.</p>
<p>CHEERS</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206561">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206561">
						October 14, 2013 4:25 PM					</a>

				</p>

				<p>Jack: or you can tape an americum-241 source to the sensor of your CCD&#8230;. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206562">

			<div class="comment by-jakub-narebski ">

				<p class="commentcredit">

					<span class="commenter">Jakub Narebski</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206562">
						October 14, 2013 4:46 PM					</a>

				</p>

				<p>Errr&#8230; doesn&#8217;t Linux kernel use hardware random generator (the RAND instruction in Intel chips, though supposedly NSA-weakened) as <em>one of</em> sources of entropy?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206563">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206563">
						October 14, 2013 5:02 PM					</a>

				</p>

				<p>Jakub: yup&#8230; xor&#8217;s it in.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206564">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206564">
						October 14, 2013 5:11 PM					</a>

				</p>

				<p>@ Adrian Ratnapala,</p>
<ul><i>If there is a vulnerability (especially an academic sounding one like this) then I am not surprised it comes via the entropy estimation. Ted Tso claims(and I believe) that it&#8217;s just a *cking hard thing to do</i></ul>
<p>Actualy it&#8217;s a bit more than &#8220;*cking hard thing to do&#8221; it can easily be shown to be in effect impossible to do by any resource limited entity, irrespective of what statistical tests you come up with (both diehard and dieharder are a bit of a joke these days as many fully determanistic systems pass them with little difficulty).</p>
<p>Basicaly if you take any old garbage generator such as say a plain integer counter, you can then &#8220;whiten it&#8221; with a basic crypto function such as a block cipher or hash algorithm. The result will pass any of the &#8220;usual suspect&#8221; &#8220;not random&#8221; witness tests and thus appear to be sufficiently random for &#8220;crypto use&#8221;.</p>
<p>And as has been mentioned on this blog before hardware engineers that fail to meet &#8220;Diehard&#8221; with their basic TRNG source can make it meet diehard by simply whitening it with AES etc which may also be built into the chip (as is the case with Intel).</p>
<p>Unless the chip manufacture provides you with access to the output of the raw source generator so you can test it, then to be honest I would not trust it as I would not be able to verify it functioning correctly. Intel have consistantly failed to provide access to the raw source therefore I for one am not going to bet my life on their generator nor would I bet the lives of my loved ones or others I know.</p>
<p>The reason why &#8220;entropy estimation&#8221; is so hard is in part due to the definition of &#8220;random&#8221; and in part because we know no way to measure what qualifies as a &#8220;random sequence&#8221;. Thus you could say the output of any entropy generator is the sum (or in some cases the product) of,</p>
<p>1, Real Entropy.<br />
2, Faux Entropy.<br />
3, Detectable determanism.<br />
4, Detectable bias.</p>
<p>What you are after is (1) the real entropy in your physical source left after you have removed (3) the determanism and (4) bias that you have been able to detect and remove. Unfortunatly that leaves a lot of (2) faux entropy which you cannot detect and remove for a very large number of reasons.</p>
<p>Faux entropy consists of many things including the outputs of complex processes and chaotic processes inherant as side effects of the design process. One example of which is to have two free running oscillators one running at high speed into the D input of a D-type latch and the slower one going into the clock input of the D-type. Close in observation of the Q output of the latch shows both metastability and what appeares as random behaviour. However observation at a slower time base shows &#8220;bunching&#8221; patterns that corespond on the timebase to the lowest frequency difference of the two oscilators. And in fact if driven into a suitable counter circuit will produce a sinusoudal output count&#8230; Taking what is in effect an FFT of the random source output will show up this determanistic wave, only if it is within the FFT Window range&#8230;</p>
<p>Thus great care should be practiced on estimating what part of such a signal is real or faux entropy.</p>
<p>Which brings me onto your question of,</p>
<ul><i>So the question is, how can we do better? Since I doubt entropy estimation is going to get much less unreliable</i></ul>
<p>The simple answere is &#8220;nothing&#8221; unless we are prepared to use increasing levels of computation to run more &#8220;witness to non randomnes tests&#8221;.</p>
<p>What we can do on the practical side is run more &#8220;faux generators&#8221; against our &#8220;entropy pool&#8221; in a way that would make any determanistic process hidden by an adversary next to impossible to see. One such way is to take the output of the OS RNG through what is in effect a blind encryption algorithm.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206565">

			<div class="comment by-cdmiller ">

				<p class="commentcredit">

					<span class="commenter">cdmiller</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206565">
						October 14, 2013 5:19 PM					</a>

				</p>

				<p>Here is a nice article on the sources of entropy used by the Linux RNG:</p>
<p><a href="http://hal.inria.fr/hal-00738638/PDF/rr8060.pdf" rel="nofollow ugc">http://hal.inria.fr/hal-00738638/PDF/rr8060.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206566">

			<div class="comment by-flup ">

				<p class="commentcredit">

					<span class="commenter">Flup</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206566">
						October 14, 2013 5:27 PM					</a>

				</p>

				<p>If you have a laptop (not sure about desktops) that has TPM, you can make use of the pRNG in it. See <a href="http://domsch.com/blog/?p=107" rel="nofollow ugc">http://domsch.com/blog/?p=107</a></p>
<p>You could probably also use those SDR dongles you can get on Ebay for 10 bucks or so as another source of entropy.  Use a GNUradio program to look at the entire radio spectrum from 100MHz to 850MHz or so. That should be random enough for anybody.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206568">

			<div class="comment by-freebsd-user ">

				<p class="commentcredit">

					<span class="commenter">FreeBSD user</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206568">
						October 14, 2013 5:42 PM					</a>

				</p>

				<p>Linux /dev/random has came up a few times here, but I haven&#8217;t seen much discusstion of the *BSD model.  Does it seem that *BSD /dev/random is &#8220;robust&#8221;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206569">

			<div class="comment by-toni ">

				<p class="commentcredit">

					<span class="commenter">Toni</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206569">
						October 14, 2013 5:48 PM					</a>

				</p>

				<p>@Jack Bates ~</p>
<p>&#8220;It is not well-known, but the Raspberry Pi has a 1Mb/s HWRNG on-board.&#8221;</p>
<p>Well thank you for that, sir.  Hmm &#8211; 1Mb/sec is quite a bit faster than the Simtec Entropy Key, and a whole RPi is actually cheaper than the Simtec (which you can&#8217;t get anyway right now), too.</p>
<p>I have an RPi on my network &#8211; I&#8217;m going to have a whack at installing the tools and trying to use the RPi HWRNG across my network for my other Linux boxes.  Fun little project.  Oughtta work&#8230;</p>
<p>Toni</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206570">

			<div class="comment by-theodore-tso ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://thunk.org/tytso' rel='external nofollow ugc' class='url'>Theodore Ts&#039;o</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206570">
						October 14, 2013 6:08 PM					</a>

				</p>

				<p>So I&#8217;m the maintainer for Linux&#8217;s /dev/random driver.  I&#8217;ve only had a chance to look at the paper very quickly, and I will at it more closely when I have more time, but what the authors of this paper seem to be worried about is not even close to the top of my list in terms of things I&#8217;m worried about.</p>
<p>First of all, the paper is incorrect in some minor details; the most significant error is its (untrue) claim that we stop gathering entropy when the entropy estimate for a given entropy pool is &#8220;full&#8221;.  Before July 2012, we went into a trickle mode where we only took in 1 in 096 values.  Since then, the main way that we gather entropy, which is via add_interrupt_randomness(), has no such limit.  This means that we will continue to collect entropy even if the input pool is apparently &#8220;full&#8221;.</p>
<p>This is critical, because <em>secondly</em> their hypothetical attacks presume certain input distributions which have an incorrect entropy estimate &#8212; that is, either zero actual entropy but a high entropy estimate, or a high entropy, but a low entropy estimate.  There has been no attempt by the paper&#8217;s authors to determine whether the entropy gathered by Linux meets either of their hypothetical models, and in fact in the &#8220;Linux Pseudorandom Number Generator Revisited&#8221;[1], the analysis showed that our entropy estimator was actually pretty good, given the real-life inputs that we are able to obtain from an actual running Linux system.</p>
<p>[1] <a href="http://eprint.iacr.org/2012/251.pdf" rel="nofollow ugc">http://eprint.iacr.org/2012/251.pdf</a></p>
<p>The main thing which I am much more worried about is that on various embedded systems, which do not have a fine-grained clock, and which is reading from flash which has a much more deterministic timing for their operations, is that when userspace tries to generate long-term public keys immediately after the machine is taken out of the box and plugged in, that there isn&#8217;t a sufficient amount of entropy, and since most userspace applications use /dev/urandom since they don&#8217;t want to block, that they end up with keys that aren&#8217;t very random.  We had some really serious problems with this, which was written up in the &#8220;Mining Your Ps and Qs: Detection of Widespread Weak Keys in Network Devices&#8221;[2] paper, and the changes made in July 2012 were specifically designed to address these worries.</p>
<p>[2] <a href="https://www.factorable.net/paper.html" rel="nofollow ugc">https://www.factorable.net/paper.html</a></p>
<p>However, it may be that on certain systems, in particular ARM and MIPS based systems, where a long-term public key is generated very shortly after the first power-on, that there&#8217;s enough randomness that the techniques used in [2] would not find any problems, but that might be not enough randomness to prevent our friends in Fort Meade from being able to brute force guess the possible public-private key pairs.</p>
<p>Speaking more generally, I&#8217;m a bit dubious about academic analysis which are primarily worried about recovering from the exposure of the state of the random pool.  In practice, if the bad guy can grab the state of random pool, they probably have enough privileged access that they can do many more entertaining things, such as grabbing the user&#8217;s passphrase or their long-term private key.  Trying to preserve the amount of entropy in the pool, and making sure that we can extract as much uncertainty from the system as possible, are much higher priority things to worry about.</p>
<p>That&#8217;s not to say that I might not make changes to /dev/random in reaction to academic analysis; I&#8217;ve made changes in reaction to [2], and I have changes queued for the next major kernel release up to make some changes to address concerns raised in [1].  However, protection against artificially constructed attacks is not the only thing which I am worried about.  Things like making sure we have adequate entropy collection on all platforms, especially embedded ones, and adding some conservatism just in case SHA isn&#8217;t a perfect random function are some of the other things which I am trying to balance as we make changes to /dev/random.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206571">

			<div class="comment by-nick-sullivan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.cloudflare.com' rel='external nofollow ugc' class='url'>Nick Sullivan</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206571">
						October 14, 2013 6:33 PM					</a>

				</p>

				<p>I posted a description of how the Linux /dev/random device works the other week: <a href="https://blog.cloudflare.com/ensuring-randomness-with-linuxs-random-number-generator" rel="nofollow ugc">Ensuring Randomness with Linux&#8217;s Random Number Generator</a>.  This is a high level description of what&#8217;s going on when reading from /dev/random.</p>
<p>This paper indicates that /dev/random is not good at recovering when entropy is low and is replenished slowly.  Avoid this by making sure the entropy count is always high.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206572">

			<div class="comment by-theodore-tso ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://thunk.org/tytso' rel='external nofollow ugc' class='url'>Theodore Ts&#039;o</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206572">
						October 14, 2013 6:35 PM					</a>

				</p>

				<p>A few more comments.  First of all, I wasn&#8217;t aware of the Inria paper mentioned above &#8212; thanks for mentioning it.  The Inria paper, although published in September 2012, is analyzing a kernel which dates before the changes made in July 2012.   As I mentioned above, these changes were inspired by the &#8220;Mining your P&#8217;s and Q&#8217;s&#8221; paper, for which the authors very kindly supplied me with a pre-print before they published it in the 2012 Usenix Security conference.  We now collect entropy using the fine-grained CPU counter on against every single interrupt, and collect that in a &#8220;fast mix&#8221; pool, and then periodically mix from that down into the input pool.  This was done for speed reasons, but it also provides a Yarrow-like &#8220;catastrophic reseed&#8221; effect.[1]   We are extremely conservative, assuming only a single bit of entropy for every 64 interrupts (where we sample the CPU counter, the jiffies counter, and the IP of the interrupt and mix all of the above into the fast pool).</p>
<p>[1]  Note that even before the July 2012 changes, we have had a Yarrow-like catastrophic reseeding in our design between the Input pool and the output pools.    I take good ideas where I can find them.  🙂</p>
<p>There have been some other changes made to enable better randomness on those platforms which do not have CPU counters which  just hit mainline for the next 3.12 release, and I&#8217;m working with the MIPS maintainer and some of the other non-x86 arch maintainers on that front.</p>
<p>We also do mix in the RDRAND if it is available, on the theory that even if it has been trojan&#8217;ed by the NSA, it doesn&#8217;t hurt to mix it in, and it might help.   So the use of RDRAND versus /dev/random or /dev/urandom is not an either-or proposition.   These days I&#8217;m actually much more worried about non-x86 platforms which do not have either RDRAND or a CPU cycle counter register, and where you are often booting off of flash and where the userspace often tries generating a long-term public key pair very shortly after the machine is first taken out of the box and plugged in.</p>
<p>Finally, I have made a number of changes over the years, either in reaction to comments made by academic papers, or when I see good ideas I can steal/borrow to make /dev/random better.   So when people point at papers, please remember that most of these analysis are done at a particular point in time, and that I do make changes in response to these analysis, at least if someone has called them to my attention.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206573">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206573">
						October 14, 2013 7:06 PM					</a>

				</p>

				<p>@ Theodore</p>
<p>I appreciate you responding with plenty of useful detail. Good to hear the state of the Linux RNG&#8217;s from the guy maintaining them. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206574">

			<div class="comment by-peter-barnhart ">

				<p class="commentcredit">

					<span class="commenter">Peter Barnhart</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206574">
						October 14, 2013 7:16 PM					</a>

				</p>

				<p>Thanks for pointing out this important paper.<br />
Couple of comments:<br />
1) If you&#8217;re looking for true randomness, consider almost any photo posted on apod.nasa.gov.  Convert to bitmap, use any bogus PRNG to select bytes from the image.<br />
The result will be plenty random, will not be uniform but that can be fixed.<br />
2) It seems to me that entropy is more a function of the adversary&#8217;s knowledge than<br />
any internal state info.  If you have a megabyte of truely random bits, its entropy is 10^6 bits, but if the bad guy knows what they are, you have zero entropy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206575">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206575">
						October 14, 2013 7:44 PM					</a>

				</p>

				<p>@ Theodore</p>
<p>Thanks for gracing this blog with your enlightening comments.</p>
<p><i>These days I&#8217;m actually much more worried about non-x86 platforms which do not have either RDRAND or a CPU cycle counter register &#8230;</i></p>
<p>To the best of your knowledge, are any of the available linuces for the ARM-based Raspberry Pi (Arch, Pidora, Raspbian) using its on-board HWRNG ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206576">

			<div class="comment by-toni ">

				<p class="commentcredit">

					<span class="commenter">Toni</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206576">
						October 14, 2013 7:51 PM					</a>

				</p>

				<p>@Dirk Praet</p>
<p>&#8220;To the best of your knowledge, are any of the available linuces for the ARM-based Raspberry Pi (Arch, Pidora, Raspbian) using its on-board HWRNG ?&#8221;</p>
<p>This should work with Raspian&#8230;</p>
<p><a href="http://vk5tu.livejournal.com/43059.html" rel="nofollow ugc">http://vk5tu.livejournal.com/43059.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206577">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206577">
						October 14, 2013 8:24 PM					</a>

				</p>

				<p>@ Toni</p>
<p><i>This should work with Raspian&#8230;</i></p>
<p>Thanks for that link, good Sir.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206578">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206578">
						October 14, 2013 8:57 PM					</a>

				</p>

				<p>I doubt the implementers of /dev/random and /dev/urandom are cryptographers like the authors of these papers and thus of course those PRNGs are not crypto-suitable at all. I really doubt the creators of /dev/random and /dev/urandom had the intention of having their PRNGs robust enough for cryptography. Maybe they just want a workable PRNG and that&#8217;s all they want.</p>
<p>Isn&#8217;t it so obvious that if you want a crypto-strength PRNG, you should be looking into using something proven and made for crypto use (e.g. Yarrow and Fortuna by Schneier) rather than just taking the default PRNG as it&#8217;s common knowledge that the normal PRNGs bundled with programming SDKs and built into OSes are not good enough.</p>
<p>The authors of the paper may want to contribute their PRNGs to the *Nix community if they think the defaults are bad choices by approaching the kernel mailing list.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206579">

			<div class="comment by-theodore-tso ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://thunk.org/tytso' rel='external nofollow ugc' class='url'>Theodore Ts&#039;o</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206579">
						October 14, 2013 9:38 PM					</a>

				</p>

				<p>@thoth,</p>
<p>I&#8217;m the original implementor of the /dev/random driver, and it was indeed meant for cryptographic uses.   I collaborated with Colin Plumb, who designed the random number generator in the original PGP code base.   The /dev/random driver was first implemented in 1994 (predating the Yarrow design by five years), and I created it because back in 1994, no operating system had anything like it, and programs like PGP had to sample keyboard stroke timing in user space, and only while it was running.</p>
<p>So Linux&#8217;s /dev/random driver was the first in-kernel CSPRNG that continuously sampled entropy from the hardware in an entropy pool.   It was implemented with my having looked at many other user-space random number generator, and as I said, I recruited help from people like Colin.   Over the years, I have also made changes based on comments and criticism from academic papers, and other sources.  For example, when Bruce published Yarrow, I did take a look at it and take the idea of catastrophic reseeding and integrated it into Linux&#8217;s /dev/random.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206580">

			<div class="comment by-marsh-ray ">

				<p class="commentcredit">

					<span class="commenter">Marsh Ray</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206580">
						October 14, 2013 11:03 PM					</a>

				</p>

				<p>@Theodore Mad props to you for giving and taking with the comments here.</p>
<p>Now if only I could convince you guys to block /dev/urandom until it&#8217;s seeded and then make /dev/random a link to urandom. AIUI, that&#8217;s the design decision made by several BSDs and I think it&#8217;s a good one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206581">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206581">
						October 14, 2013 11:06 PM					</a>

				</p>

				<p>Pretty much unreadable. My publishing experience is mostly with conferences that have a 6 or 8 page limit and force you to get to the point. These authors here seem to believe the more difficult to read the paper is the better.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206582">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206582">
						October 14, 2013 11:34 PM					</a>

				</p>

				<p>Ah.. it&#8217;s good to know much research was put into the /dev/random for cryptographic functions. Thanks for the many clarifications you have made on this post.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206583">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206583">
						October 15, 2013 12:06 AM					</a>

				</p>

				<p>Theodore: is it true that you designed the CSPRNG to use SHA to avoid the crypto export issues of the 90s?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206584">

			<div class="comment by-bhima ">

				<p class="commentcredit">

					<span class="commenter">Bhima</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206584">
						October 15, 2013 12:42 AM					</a>

				</p>

				<p>@ Toni &#8211; I have been using Entropy Broker to pool, mix, and redistribute entropy from multiple sources on my network, including a Raspberry Pi.</p>
<p>Honestly it mostly works but it&#8217;s a bit brittle and I&#8217;ve run across enough bugs that I&#8217;m not completely confident with it. Unfortunately the author is too busy to really maintain the project and it&#8217;s a bit beyond my skills to fix the things that I&#8217;ve found wrong or suboptimal with it.</p>
<p>If anyone knows of alternative tools which do similar things, I&#8217;d love to hear about them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206585">

			<div class="comment by-pauli ">

				<p class="commentcredit">

					<span class="commenter">Pauli</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206585">
						October 15, 2013 12:42 AM					</a>

				</p>

				<p>In a previous life making embedded routers, we were concerned about the lack of entropy for exactly the reasons Theodore Ts&#8217;o mentions above.  My solution was to add a stage to fulfilment that created a dump of some pseudo random data (from the fulfilment machine&#8217;s /dev/urandom from memory) which was stored on the device and used to seed the kernel RNG on boot.  This random dump was written on shutdown with new randomness from the kernel.  The end result is some entropy would distinguish different units.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206586">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206586">
						October 15, 2013 12:54 AM					</a>

				</p>

				<p>@Adrian Ratnapala:</p>
<p>Look up the Fortuna PRNG scheme devised by Bruce and his colleague Niels Ferguson.</p>
<p>One of its premises, is that realistic entropy estimation is impractical.  Accordingly, Fortuna is designed to utilize various inputs without any estimation of their absolute or relative degrees of entropy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206587">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206587">
						October 15, 2013 2:33 AM					</a>

				</p>

				<p>@ Pauli,</p>
<ul><i>My solution was to add a stage to fulfilment that created a dump of some pseudo random data&#8230; which was stored on the device and used to seed the kernel RNG on boot.</i></ul>
<p>In FMCE production adding entropy to the product at the &#8220;end of line&#8221; is realisticaly the only way to do it. Especialy when the need for some products to have large amounts of entropy is a requirment it needs to be sourced from a reliable source (which can be a difficult ask in many FMCE Production environments)</p>
<p>I first had to fight the battle back last century when designing cordless phones the Korean side developers were convinced they could do it using a determanistic algorithm and the &#8220;cold start&#8221; entropy of an 8bit microcontroler&#8230; They went ahead over my objections and surprise surprise rather than get atleast 20bits of entropy required by the customer they only got around 6bits maximum. On being tasked by the MD of the company to find out what was going wrong I identified that the &#8220;oh so clever algorithm&#8221; could only give a maximum of 8bits of entropy no matter what the &#8220;cold start&#8221; entropy was.</p>
<p>Unfortunatly due to restrictions (PCBs etc had been manufactured) I was very limited in my options so went for a compromise of making the production line person press a button wait for a LED to illuminate and press another button and loop through a couple of times and generate some entropy from the fast counter in the CPU (no it did not give the 20bits but it was close enough to get through both the customers goods inwards test and not to cause returns issues).</p>
<p>I coined a phrase back then of &#8220;If you don&#8217;t have time for entropy then you don&#8217;t&#8230;&#8221; loosly based on the old RF engineering maxim &#8220;Amplifiers do and oscillators don&#8217;t&#8230;&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206588">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206588">
						October 15, 2013 3:01 AM					</a>

				</p>

				<p>@Theodore Ts&#8217;o: &#8220;Over the years, I have also made changes based on comments and criticism from academic papers, and other sources.&#8221;</p>
<p>Thank you very much for taking time to comment here.</p>
<p>Could you comment on the choice of XOR, cryptographically weak, as pointed out by @Mike the goat: &#8220;the Linux PRNG (see <a href="http://lxr.free-electrons.com/source/drivers/char/random.c" rel="nofollow ugc">http://lxr.free-electrons.com/source/drivers/char/random.c</a> &#8230;) when running on supported hardware &#8211; simply XOR&#8217;s the RdRAND output with its output stream&#8221; <a href="https://www.schneier.com/blog/archives/2013/10/friday_squid_bl_394.html#c1835591" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/10/friday_squid_bl_394.html#c1835591</a></p>
<p>Could you optionnaly answer to @ddr: &#8220;RdRand is used exclusively for memory address randomization in the Linux kernel, so technically an adversary could defeat ASLR and know exactly what the memory layout is.&#8221; <a href="https://www.schneier.com/blog/archives/2013/09/my_new_gpgpgp_a.html#c1713647" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/my_new_gpgpgp_a.html#c1713647</a> ? That page also lists other places were rdrand was the only source of randomness.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206589">

			<div class="comment by-curious-about-xoring-rdrand-at-the-end ">

				<p class="commentcredit">

					<span class="commenter">Curious about XORing RDRAND at the end</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206589">
						October 15, 2013 3:35 AM					</a>

				</p>

				<p>Theodore, thanks very much for your comments shedding more light on the kernel&#8217;s RNG.</p>
<p>I&#8217;m also interested in whether you&#8217;ve considered using the entropy from a hardware RNG like RDRAND as input to the entropy (just like all the other gathered entropy input), instead of treating it specially as a final XOR on the result. The latter (current) approach seems obviously risky if one assumes the CPU has been compromised.</p>
<p>Even if one supposes that it&#8217;s ridiculously unlikely that the CPU might evilly notice that it&#8217;s XORing the RDRAND result with something and intentionally &amp; indetectibly give a specific result in certain circumstances instead of honestly XORing an honest RDRAND result, wouldn&#8217;t it make more sense (and make the algorithm simpler &amp; more uniform) to treat ALL the gathered entropy in a more uniform way, instead of treating the CPU&#8217;s RDRAND in a different special way where this XOR/RDRAND is the very last thing to influence the output?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206590">

			<div class="comment by-wesley-parish ">

				<p class="commentcredit">

					<span class="commenter">Wesley Parish</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206590">
						October 15, 2013 4:37 AM					</a>

				</p>

				<p>@Peter Barnhart</p>
<p>So you&#8217;ve read Stanislaw Lem&#8217;s <em>His Master&#8217;s Voice</em> too? Small world!</p>
<p>I&#8217;d like to get my random numbers from the Big Bang microwave background; 360 degrees per second of arc by 360 degrees per second of arc, assigning values of 1 or 0 to each second&#8217;s value depending on whether or not its value was above or below a random value that would change pseudo-randomly. Direction of sampling also assigned pseudo-randomly.</p>
<p>It&#8217;s not practical at this point in time, unfortunately. Your idea is practical.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206591">

			<div class="comment by-speedie ">

				<p class="commentcredit">

					<span class="commenter">speedie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206591">
						October 15, 2013 5:01 AM					</a>

				</p>

				<p>@Theodore</p>
<p>It&#8217;s good to see you really follow up with everything that concerns your baby 🙂<br />
I feel reassured when I see the level of your dedication to your ( very important ) work on /dev/random .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206592">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206592">
						October 15, 2013 5:47 AM					</a>

				</p>

				<p>Low-budget, easy to build, perhaps a moderately good<br />
&lt;a href=&#8221;http://web.jfet.org/hw-rng.html&gt;source.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206593">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206593">
						October 15, 2013 5:50 AM					</a>

				</p>

				<p>sorry &#8230; my link was zapped (using lynx can be a pain sometimes)<br />
<a href="http://web.jfet.org/hw-rng.html" rel="nofollow ugc">http://web.jfet.org/hw-rng.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206594">

			<div class="comment by-speedie ">

				<p class="commentcredit">

					<span class="commenter">speedie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206594">
						October 15, 2013 5:53 AM					</a>

				</p>

				<p>@aspie<br />
please , please , tell me you&#8217;re using lynx on a phone 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206595">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206595">
						October 15, 2013 5:56 AM					</a>

				</p>

				<p>@speedie: &#8220;please , please , tell me you&#8217;re using lynx on a phone :)&#8221;</p>
<p>I actually did, and will do that again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206596">

			<div class="comment by-speedie ">

				<p class="commentcredit">

					<span class="commenter">speedie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206596">
						October 15, 2013 6:03 AM					</a>

				</p>

				<p>I know , I do it .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206597">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206597">
						October 15, 2013 6:12 AM					</a>

				</p>

				<p>@speedie<br />
Nope, it&#8217;s <i>far</i> worse than that. I&#8217;m too busy (read lazy/disinterested) to get X11 working on my netbook. (Where I <i>do</i> have X11 working I prefer dillo.)</p>
<p>I find lynx browsing slows me down enough to <i>read</i> everything and follow links judiciously. Plus it&#8217;s quickly apparent if a site is 99.999% hype/ads and 0.001% content.</p>
<p>Ahhh, I remember PRESTEL &#8230; and the machine-gun teletype on the RSTS/E system &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206598">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206598">
						October 15, 2013 6:17 AM					</a>

				</p>

				<p>@Aspie<br />
&#8220;(Where I do have X11 working I prefer dillo.)&#8221;</p>
<p>Where can I find dillo nowadays? I liked it a lot but now cannot find it anymore.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206599">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206599">
						October 15, 2013 6:20 AM					</a>

				</p>

				<p>@Winter<br />
<a href="http://www.dillo.org/" rel="nofollow ugc">http://www.dillo.org/</a> &#8211; of all places. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206600">

			<div class="comment by-czerno ">

				<p class="commentcredit">

					<span class="commenter">Czerno</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206600">
						October 15, 2013 6:42 AM					</a>

				</p>

				<p>@Mr Ts&#8217;o : kudo&#8217;s for your work and dedication.<br />
A question, please : many X86 platform chipsets have provided<br />
a HW random number generator for years. Does /dev/random use them, in particular (being a user of less-well known SiS products) does Linux use the HWRNG included in SiS PCI chipsets, similar to but programmatically different from intel ones?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206601">

			<div class="comment by-peter-knoppers ">

				<p class="commentcredit">

					<span class="commenter">Peter Knoppers</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206601">
						October 15, 2013 6:46 AM					</a>

				</p>

				<p>The <a href="https://www.youtube.com/watch?v=7n8LNxGbZbs" rel="nofollow ugc">Dice-O-Matic</a> machine looks like a great source of entropy&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206602">

			<div class="comment by-rdseed ">

				<p class="commentcredit">

					<span class="commenter">RDSEED</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206602">
						October 15, 2013 7:36 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>&lt;</p>
<p>blockquote&gt;Intel have consistantly failed to provide access to the raw source therefore I for one am not going to bet my life on their generator nor would I bet the lives of my loved ones or others I know.</p>
<p>&lt;</p>
<p>blockquote&gt;</p>
<p>The forthcoming RDSEED instruction might address that:<br />
<a href="http://software.intel.com/en-us/blogs/2012/11/17/the-difference-between-rdrand-and-rdseed" rel="nofollow ugc">http://software.intel.com/en-us/blogs/2012/11/17/the-difference-between-rdrand-and-rdseed</a><br />
<a href="http://en.wikipedia.org/wiki/Broadwell_%28microarchitecture%29" rel="nofollow ugc">http://en.wikipedia.org/wiki/Broadwell_%28microarchitecture%29</a></p>
<p>It is intended to be compliant with NIST SP800-90B and SP800-90C</p>
<p>&#8220;The numbers returned by RDSEED are referred to as &#8220;seed-grade entropy&#8221; and are the output of a true random number generator (TRNG)&#8221;</p>
<p>This looks to be the same TRNG source that seeds RDRAND.</p>
<p>Backdoor theories aside, it could be used as one of the sources for entropy, mixing or XOR-ing it in with entropy from other non-US-based hardware RNGs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206603">

			<div class="comment by-johny ">

				<p class="commentcredit">

					<span class="commenter">johny</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206603">
						October 15, 2013 8:17 AM					</a>

				</p>

				<p>@Curious about XORing RDRAND at the end</p>
<p>you have wrong assumption that it is a problem to XOR random value and RDRAND &#8220;maybe not so random&#8221; value. It is not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206604">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206604">
						October 15, 2013 8:34 AM					</a>

				</p>

				<p>@ johny</p>
<blockquote><p>
  you have wrong assumption that it is a problem &#8230;
</p></blockquote>
<p>He explicitly states that the concern is with a compromised CPU, from which I infer he means a CPU whose microcode has been subverted to look for the particular instruction sequence RDRAND followed by XOR, and do something entirely different.</p>
<p>If that is his assumption he&#8217;s probably correct but the vulnerability is easily overcome.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206605">

			<div class="comment by-theodore-tso ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://thunk.org/tytso' rel='external nofollow ugc' class='url'>Theodore Ts&#039;o</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206605">
						October 15, 2013 8:50 AM					</a>

				</p>

				<p>@Luck:</p>
<blockquote><p>
Could you comment on the choice of XOR, cryptographically weak, as pointed out by @Mike the goat: &#8220;the Linux PRNG (see <a href="http://lxr.free-electrons.com/source/drivers/" rel="nofollow ugc">http://lxr.free-electrons.com/source/drivers/</a>&#8230; &#8230;) when running on supported hardware &#8211; simply XOR&#8217;s the RdRAND output with its output stream&#8221;
</p></blockquote>
<p>First, this is changing in the set of changes being queued for upstream.  <a href="http://git.kernel.org/cgit/linux/kernel/git/tytso/random.git/commit/?h=dev" rel="nofollow ugc">http://git.kernel.org/cgit/linux/kernel/git/tytso/random.git/commit/?h=dev</a></p>
<p>Secondly, the the primary reason for this change was not to indulge the paranoid fanatasies of those who are concerned that the Intel CPU might be able to detect the XOR in the instruction pipeline, and then use that to gimmick the value placed into the registers.   If you are think that level of gimmickry might be in the Intel CPU, then you should find another CPU.  What if the AESNI instructure is hiding the key someplace where it can leaked out by moduling packet transmission delays using the onboard ethernet interface?   Ultimately, the theory that RDRAND might have gotten gimmicked depends on the fact that it is a standalone unit that might be easily modified in such a way that it might not be caught by Intel&#8217;s internal auditing &#8212; especially since RDRAND is documented as using AES as the final whitening step.  But if the adversary is corrupting the instructure decode and execution pipeline handling, (a) it&#8217;s much more likely that this might trigger falsely, and cause user-visible program misbehaviour/crashes, and (b) it&#8217;s much more likely someone who wasn&#8217;t (hypothetically) suborned by the NSA would notice the tampering.</p>
<p>The main reason for making this change was so that RDRAND output would get mixed into pool as part of the extract entropy&#8217;s feedback step.  This imrpoves /dev/random against theoretical forward security attacks, and also happens to place the RDRAND xor step before the final SHA transform, which helps to mollify the tin foil hat crowd.</p>
<blockquote><p>
Could you optionnaly answer to @ddr: &#8220;RdRand is used exclusively for memory address randomization in the Linux kernel, so technically an adversary could defeat ASLR and know exactly what the memory layout is.&#8221;
</p></blockquote>
<p>There are multiple API&#8217;s which create random numbers in the kernel, which trade off different levels of cryptographic strength with speed.   This ranges everywhere from a completely non-cryptographic PRNG, to something to interfaces that try to return the closest approximation we have to &#8220;true randomness&#8221;.   In the case of ASLR, yes, this is an interface which is designed to return randomness with very low overhead.  And that&#8217;s because the cryptographic strength requirements of ASLR is quite different from that required for generating a session key, which in turn is quite different from that required for generating a long-term public key.</p>
<p>Consider that an attack that tries to subvert ASLR means that you&#8217;re already have code running on the target computer.  Given that the NSA is purchasing zero-day exploits from Grey Hat and Black Hat vendors, there are plenty of other ways someone who has already managed to exploit a buffer overrun attack can carry out a privilege escalation attack.  Also consider that if there is a hypothetical way that RDRAND can be subverted, putting it in a payload for a Stuxnet-like viral attack is extremely dangerous, since it&#8217;s much more likely an anti-virus company might capture the payload, analyze it, and discover some strange algorithm that apparently is trying to anticipate RDRAND output and use that to subvert ASLR&#8230;</p>
<p>Another example of these sorts of tradeoffs is the fact that we use a very weak (but fast) crypto hash as part of the TCP sequence number generation.   We can&#8217;t use a full-on random number generator because of some of the requirements of how the TCP sequence number works &#8212; see the discussion in RFC 1948 for more details.  But if we rekey every five minutes, we don&#8217;t need a very strong crypto algorithm, since the randomness is not being used for data encryption, but only to protect against TCP hijacking attacks by someone who is off the network path between the communicating parties.  (To protect against a man-in-the-middle attack by someone on the network path, you need full on crypto, done in the userspace, which is another reason why we can afford to scrimp on the crypto used for TCP sequence number generation.)</p>
<p>The bottom line is that there are a huge number of engineering tradeoffs that need to be made here.  It&#8217;s not just a matter of saying you want the mostest amount of crypto.   Consider that way back when, the US Government spec&#8217;ed multiple levels of OS security in the &#8220;Orange Book&#8221; specification, from A1 security, to B2 security (Multics), B3 security (VMS), to C2 security (Unix with security extensions that were ultimately a complete commercial failure :-).   There was maybe one OS that attempted to hit the A1 security parameters, but its performance was so Gawd-awful that it didn&#8217;t get much traction at all.   And the &#8220;C2 by &#8217;92&#8221; effort to add sufficient amounts of security features to Unix, including completely destroying the concept of setuid root programs, was a complete and total commercial failure.</p>
<p>@Czerno</p>
<blockquote><p>
A question, please : many X86 platform chipsets have provided<br />
a HW random number generator for years. Does /dev/random use them, in particular (being a user of less-well known SiS products) does Linux use the HWRNG included in SiS PCI chipsets, similar to but programmatically different from intel ones?
</p></blockquote>
<p>I&#8217;m not certain of the SiS chipset per se, but the architecture used in Linux is that for these PCI-bus accessible random number generators, they are supposed to be exported to userspace via /dev/hwrandom, and then we use a userspace rngd whic his supposed to do quality control checks, and set policy such as estimating how much entropy might be contained in N bytes of data read in from /dev/hwrandom, and then feed that into /dev/random.   You can either do this via a non-privileged write into /dev/random, which does not bump the entropy estimation, or there is a privileged ioctl which can be used that atomically will transfer N bytes of randomness into the entropy pools and at the same time bump the entropy estimation counter by M bytes (where M &lt;= N).</p>
<p>In theory you could also write a userspace program that accesses the TPM chip (which may require access to TPM PIN&#8217;s before you are able to access it, which is another reason why this really needs to be done in userspace), and then use the on-board HWRNG in the TPM to feed entropy into /dev/random.  No one has done this, but it&#8217;s certainly something you can do.</p>
<p>Yet another thing you can do is to take some randomness, or some secret, and just cat it into /dev/random.  Here you need to be a bit careful, since if the kernel has been trojan&#8217;ed, or if /dev/random has been replaced by a named pipe by some bad guy, feeding your long-term public key into /dev/random might not be the safest thing in the world to do.  But the point remains that as a non-privileged user, if you want to be extra paranoid before generating a GPG key, you can always roll a number of dice, and cat those numbers into /dev/random, and that will be mixed into the entropy pool.  It can&#8217;t hurt, and against certain attacks, it could certainly help.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206606">

			<div class="comment by-joe-landman ">

				<p class="commentcredit">

					<span class="commenter">Joe Landman</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206606">
						October 15, 2013 9:17 AM					</a>

				</p>

				<p>I found the &#8220;radioactive decay considered safe&#8221; interesting.  If we subject the decaying atoms to a steady stream of some relevant ionizing radiation, depending upon the decay pathway, we could easily catalyze faster or slower emission.  Hence effectively &#8220;hacking&#8221; the underlying physics to bias the radioactive decay based entropy source as we wish.   This sort of attack would provide secondary signatures, not the least of which is that a flux of radiation capable of doing that should be detectable.  But it&#8217;s not impossible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206607">

			<div class="comment by-william-edwards ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://htttp://williamedwardscoder.tumblr.com' rel='external nofollow ugc' class='url'>William Edwards</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206607">
						October 15, 2013 9:48 AM					</a>

				</p>

				<p>@Theodore thanks for your patience with those not thinking nor reading 😉</p>
<p>I hope Bruce weighs in on the original article he linked to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206608">

			<div class="comment by-bitmonger ">

				<p class="commentcredit">

					<span class="commenter">bitmonger</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206608">
						October 15, 2013 10:07 AM					</a>

				</p>

				<p>@joe Landon</p>
<p>I think influencing actual decay is not a problem, but in a real system there is a detector.  Compromising that is an issue of course.  Nearly any real detector can be compromised is you have access to it.</p>
<p>The issue is: is there deterministic process that might have less entropy that we think leading to something that looks more random than it is that might be remotely attackable.  All things being equal this is a very important question.</p>
<p>A real security trade off I see is: a) black box, but theoretically good sources vs b) open but theoretically less good sources.</p>
<p>Most hardware rngs  have whitening builtin so you don&#8217;t know if<br />
they are &#8216;cooked&#8217; (or plain broken), but they are usually based on<br />
good physics.</p>
<p>Personally, I am not as concerned about the physics used for entropy as I am the auditablity of the whole system.</p>
<p>If I was concerned.  I probably still rather sample shot noise from a diode or two racing oscillators and have it unbiased and used to seed /dev/random than have a device that collects quantum noise, but operates as a black box.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206609">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206609">
						October 15, 2013 10:16 AM					</a>

				</p>

				<p>@Theodore Ts&#8217;o: &#8220;First, this is changing in the set of changes being queued for upstream. <a href="http://git.kernel.org/cgit/linux/kernel/git/tytso/random.git/commit/?h=dev" rel="nofollow ugc">http://git.kernel.org/cgit/linux/kernel/git/tytso/random.git/commit/?h=dev</a>&#8221;</p>
<p>The exact patch is available at<br />
<a href="http://git.kernel.org/cgit/linux/kernel/git/tytso/random.git/commit/?h=dev&#038;id=85a1f77716cf546d9b9c42e2848b5712f51ba1ee" rel="nofollow ugc">http://git.kernel.org/cgit/linux/kernel/git/tytso/random.git/commit/?h=dev&#038;id=85a1f77716cf546d9b9c42e2848b5712f51ba1ee</a></p>
<p>I indeed see that XOR will now happen earlier.</p>
<p>@Theodore Ts&#8217;o: &#8220;Secondly, the the primary reason for this change was not to indulge the paranoid fanatasies of those who are concerned that the Intel CPU might be able to detect the XOR in the instruction pipeline&#8221;</p>
<p>In our case, NSA does not need to wrap XOR (with subsequent user-visible program misbehaviour/crashes), it is enough to patch the instruction called by arch_get_random_long:</p>
<p>The Intel instruction called by arch_get_random_long, before giving its potentially weakened RDRAND, might XOR it with hash.l (that might be available in a predictable register). So that the subsequent XOR with hash.l, done by random.c, nullifies all random sources but RDRAND. Unfortunately, this patch leaves this precise weakness intact 🙁</p>
<p>@Theodore Ts&#8217;o: &#8220;Also consider that if there is a hypothetical way that RDRAND can be subverted, putting it in a payload for a Stuxnet-like viral attack is extremely dangerous&#8221;</p>
<p>Schneier documented how NSA is cautious with its exploits: &#8220;If the target is a high-value one, FOXACID might run a rare zero-day exploit that it developed or purchased. If the target is technically sophisticated, FOXACID might decide that there&#8217;s too much chance for discovery, and keeping the zero-day exploit a secret is more important&#8221;, quoted from <a href="https://www.schneier.com/blog/archives/2013/10/the_nsas_new_ri.html" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/10/the_nsas_new_ri.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206610">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206610">
						October 15, 2013 10:20 AM					</a>

				</p>

				<p>@Aspie: &#8220;I find lynx browsing slows me down enough to read everything and follow links judiciously.&#8221;</p>
<p>My lynx is fast (and faster than any graphical browser) because cat .lynx.cfg shows:<br />
NFOSECS:0.1<br />
MESSAGESECS:0.1<br />
ALERTSECS:0.1<br />
DELAYSECS:0.1<br />
REPLAYSECS:0.1<br />
Use this file with: export LYNX_CFG=.lynx.cfg</p>
<p>To look at error messages, try Control-H then select top link.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206611">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206611">
						October 15, 2013 10:22 AM					</a>

				</p>

				<p>Thank you very much, Theodore Ts&#8217;o, for you patient answers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206612">

			<div class="comment by-jt ">

				<p class="commentcredit">

					<span class="commenter">JT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206612">
						October 15, 2013 10:41 AM					</a>

				</p>

				<p>@ Toni</p>
<p>what technique were you considering for getting the computers on the network to be able to take advantage of the RPi&#8217;s HWRNG?<br />
just have them ssh into it and grep output or did you have another idea?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206613">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206613">
						October 15, 2013 10:47 AM					</a>

				</p>

				<p>@GentooAndroid<br />
That&#8217;s neat.</p>
<p>With squid also blocking outbound requests to any site not explicitly enabled with:</p>
<p><i>acl safe dstdomain <b>somedom</b></i></p>
<p>pages in lynx and dillo are equally fast and devoid of fluff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206614">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206614">
						October 15, 2013 11:15 AM					</a>

				</p>

				<p>My addition to the discussion?</p>
<p>I use lynx to stream the source &#8220;lynx -source [site] &gt; site.dat.html&#8221;<br />
My usually behavoir is to then pass it through a filter if I feel that it needs to be sanitized, or, if I want to do a quick read I use &#8220;w3m -T text/html site.dat.html&#8221;</p>
<p>If I am paranoid I use a stream editor to render the output to one of any number of pagers or use vi/vim if I want to inspect anything that might be of question.</p>
<p>Okay, I know&#8211;bragging rights are for braggers. I am just explaining something I do just to minimize my risks on-line. I have separate systems for graphical browser (firefox explicitly removed image content filter&#8211;that sucks). Many have commented on the difficulty of using &#8220;any&#8221; application to touch networks that considered &#8220;public&#8221;.</p>
<p>I don&#8217;t considering accessing my host service as a public service, though the law apparently treats it as such. So it doesn&#8217;t matter what I access my services with when what is compromised is the confidence in the accuracy and propriety of e-mail or electronic documents that are stored in the cloud. Even though I use GPG/PGP and only infrequently use application level password protection. I pretty much have the operative environment as Bruce but have some deviations and variations to enhance the level of confidence that can be maintained by my own network and devices.</p>
<p>In summary, EAL-6/7 is not an option given budgets and procurement requirements&#8211;I could do a roll your own version but that won&#8217;t serve any certification of the process&#8211;maybe I can produce my own. Having done a good bit of DO-178B work on various micro-kernels and RTC OS&#8217;s, I could do a &#8220;simulated&#8221; IEC/ISO/NIST/ISCA certification but what purpose does that serve given the insistence that the NSA &#8220;must have access&#8221; to &#8220;any&#8221; system seems counterproductive at this point.</p>
<p>My TIG welder is at the ready to fuse the boards, and several boxes to mail them to the NSA when I have them truly secured.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206615">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206615">
						October 15, 2013 12:15 PM					</a>

				</p>

				<p>@Theodore Ts&#8217;o:<br />
<i>In theory you could also write a userspace program that accesses the TPM chip (which may require access to TPM PIN&#8217;s before you are able to access it, which is another reason why this really needs to be done in userspace), and then use the on-board HWRNG in the TPM to feed entropy into /dev/random. No one has done this, but it&#8217;s certainly something you can do.</i></p>
<p>I did this last night on my Toshiba Portege R200 running Ubuntu 12.04.  The packages for it are already available.  I had looked at /dev, and didn&#8217;t see hwrnd!  Oh my, what to do?</p>
<p>First, I downloaded the rnd-tools package (sudo apt-get install rng-tools).  This also installs TrouSerS.  It temporarily created a /dev/hwrnd, but that didn&#8217;t last beyond reboot, so something was wrong.  I looked up the chipset in the notebook, and the chipset doesn&#8217;t have a HRNG.</p>
<p>Next, I got the TPM tools (sudo apt-get install tpm-tools) and verified that the Infineon chip was discovered.  After a bit of futzing, I found <a href="http://www.outflux.net/blog/archives/2010/02/08/rng-tools-with-tpm/" rel="nofollow ugc">this blog post</a> and configured rng-tools and restarted its daemon process.  I checked the logs, and it seems to be functioning!  I left a test running overnight, and I didn&#8217;t check it when I left for work.  The stats say it&#8217;s producing numbers at about 7Kb/sec.</p>
<p>So rnd-tools interfaces with tpm-tools to feed the output from the TPM chip into /dev/random.  Yay!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206616">

			<div class="comment by-jakub-narebski ">

				<p class="commentcredit">

					<span class="commenter">Jakub Narebski</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206616">
						October 15, 2013 12:15 PM					</a>

				</p>

				<p>Long, long time ago I have heard of Ulam (I think) algorithm to make better PRNG (with longer period) out of two worse PRNG by using one (worse) PRNG to select bucket and another PRNG to write into bucket. So getting one pseudo-random number would consist of using PRNG 1 to get bucket number (table index), get data from there as result, and replace it with PRNG 2.</p>
<p>I wonder if something like that could be used to mix different sources of entropy&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206617">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206617">
						October 15, 2013 12:36 PM					</a>

				</p>

				<p>First, apologies to other less interested folks for heading off into the woods on this thread. It&#8217;s still about security &#8230;</p>
<p>@name.withheld.for.obvious.reasons<br />
It&#8217;s all a matter of degree, of course, and with faith in your lynx it sounds like you have nothing to fear at the HTML level. (Protocol attacks coming back from the site notwithstanding).</p>
<p>I used to use Amaya for page viewing but it lagged behind the curve and was so buggy that it would have been difficult to ascertain whether it crashed due to an attempted exploit or a misplaced comma in the source code.</p>
<p>I downloaded chrome recently and put it in jail before I ran it. It seemed to want root access (as if!). Even if I misread it, it got binned immediately. (It occurs to me that just as countries without Democracy usually have the word Democratic in their names, so &#8220;Don&#8217;t be Evil&#8221; fulfills the same inverse relevance to Google. A line from <i>Yes, Minister</i> put this succinctly: &#8220;Always dispose of the difficult words in the title of the bill. They do less harm there than in the text.&#8221; Another: &#8220;The less you intend to do about something the more you need to talk about it.&#8221; Popular modern examples in the US might be <i>Department of Homeland Security</i> and <i>Patriot ACT</i>.)</p>
<p>Years ago, still drunk on VMS, I hacked a rudimentary form of privileges into the hatchling that Linux then was. (It was a <i>lot</i> easier then but the code is long gone and would have required a lot of patching anyway.) Yet I still think the VMS security model was one of the strongest the industry has seen and with some tweaks could restrain &#8211; and monitor &#8211; suspect apps very precisely.</p>
<p>Some other people here may agree with Rob Pike&#8217;s assertion that UNIX died some time ago but it won&#8217;t stop twitching. (Probably even Ken and Dennis would agree). Plan9 was designed to succeed it but for whatever reason(s) never really made it out of the hatchery. Now, if Torvalds had taken Plan9 and run with it &#8230;</p>
<p>OpenVMS is still copyrighted but the basic premise is still strong. A fusion of the two (PlanVMS, say) with some strictly enforced standards about attached hardware (for example, reliable HRNGs) could also fill the Palladium dream without the abominable kow-towing to the DRM and closed-source it was really invented to implement and protect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206618">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206618">
						October 15, 2013 12:42 PM					</a>

				</p>

				<p>@Clive Robinson:<br />
<i>Intel have consistantly failed to provide access to the raw source&#8230;</i></p>
<p>Consider this:  What source is there if the &#8220;raw source&#8221; is a digital circuit?  What are you expecting to receive from Intel, and what are you expecting to verify?</p>
<p>Many years ago, when I was in college and the 80286 was hot stuff, I implemented a PRNG in hardware.  It danced through its states, and then repeated its sequence.  Now imagine for a moment if I had added an unstable bit source, and a shift register to produce an N-bit value to be occasionally XORed into the PRNG circuit.</p>
<p>Now, let&#8217;s say I burned all of that into an ASIC and handed it to you.  The chip is programmed such that you can&#8217;t read its fuse states.  It is a black box.  I also give you what I claim is the source file for the ASIC.</p>
<p>What will you do?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206619">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206619">
						October 15, 2013 1:09 PM					</a>

				</p>

				<p>@ Brian M,</p>
<p>By source I don&#8217;t mean the VHDL/Verilog or down stream netlists. What I mean is the bit stream output from the actual source of the TRNG befor debias or whitening.</p>
<p>And by using the right tools on it I expect it to tell me quite a bit.</p>
<p>As I and others have said I don&#8217;t actually expect it to meet Diehard or any of the subsiquent tests or others of my own devising, because the way it fails tells me what else to look for to check and see if they are actually being honest in what they claim.</p>
<p>As for your hardware PRNG if you gave it to me and gave an honest description of it then yes I would be able to verify it. Also if the occasional XORed input was from a physical source or another PRNG providing it did not XOR in two frequently then yes there are ways to detect it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206620">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206620">
						October 15, 2013 1:42 PM					</a>

				</p>

				<p>@Clive Robinson:<br />
<i>What I mean is the bit stream output from the actual source of the TRNG befor debias or whitening.</i></p>
<p>And how would you suggest that Intel would open that up to scrutiny?</p>
<p>The <a href="http://software.intel.com/en-us/articles/intel-digital-random-number-generator-drng-software-implementation-guide" rel="nofollow ugc">Intel Secure-Key</a> generates a 256-bit entropy sample, running &#8220;asynchronously on a self-timed circuit and uses thermal noise within the silicon to output a random stream of bits at the rate of 3 GHz.&#8221;</p>
<p>The &#8220;easiest&#8221; way for them to do that would be to give you a bare chip, sans any packaging, and let you hook it all up yourself.  Seriously, that&#8217;s it.  Put the ever-so-tiny logic analyzer probes on the right parts in the chip, and on and on.  Really, in the development process, that&#8217;s exactly what <i>they</i> do themselves.  Even if that output was sitting on a pin on the chip package, how would you know that they weren&#8217;t lying to you, if they had been compromised by the NSA?  That rabbit hole is a Moebius loop in a maze of shifting mirrors.</p>
<p>Seriously, consider what your request entails from the manufacturer&#8217;s perspective, and how you would actually go about verifying the the whole package.  At the end of it, a high-performance chip can&#8217;t be produced that can also be verified by a third party.  I have worked in the manufacturing end of things, and even just implementing a chip design like that on a motherboard is extremely non-trivial.</p>
<p>The only CPU that I worked with that could come close to independent verification was the NCR 32032, which allowed microcode to be uploaded.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206621">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206621">
						October 15, 2013 2:58 PM					</a>

				</p>

				<p>@Brian M: &#8220;And how would you suggest that Intel would open that up to scrutiny?&#8221;</p>
<p>Read/write JTAG access on RDRAND before debias, hashing or whitening.</p>
<p>See details in <a href="https://www.schneier.com/blog/archives/2013/09/surreptitiously.html#c1742410" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/surreptitiously.html#c1742410</a> by @Nicholas Weaver.</p>
<p>@Brian M: Why do your comments appear in reverse video in lynx ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206622">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206622">
						October 15, 2013 4:16 PM					</a>

				</p>

				<p>@ Brian M,</p>
<p>First think about what you have said and quoted,</p>
<ul><i>running &#8220;asynchronously on a self-timed circuit and uses thermal noise within the silicon to output a random stream of bits at the rate of 3 GHz.&#8221;</i></ul>
<p>Then run it by your sanity filters with first the simple question of, &#8220;What are the implications of self timed logic at  3GHz)&#8221;.</p>
<p>As for &#8220;how do you know they wern&#8217;t lying to you&#8221; how about more simply &#8220;lying to themselves&#8221; or just &#8220;kidding themselves&#8221;.</p>
<p>If they cannot reliably test it on chip in an externaly verifiable way then they are &#8220;kidding themselves&#8221; that it&#8217;s functioning as anything other than a fully determanistic circuit like for arguments sake a counter&#8230;</p>
<p>Because once it&#8217;s past de-bias and whitening it will pass any statistical measure you care to throw at it irespective of if it&#8217;s fully determanistic or compleatly unpredictable.</p>
<p>Your argument boils down to &#8220;Trust them because even they cann&#8217;t verify it&#8221; which is the same argument any snake oil salesman uses to flog you rotting fish oil ie &#8220;it smells bad so it must be good for you&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206623">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206623">
						October 15, 2013 4:45 PM					</a>

				</p>

				<p>Theodore: thanks for linking to your commit. I appreciate your work and more importantly transparency in this field. I suspect many others would be happy enough &#8211; if RDRAND is detected to just pump RDRAND derived data straight into random and do away with the whole need of having a urandom as /dev/random would never block in normal use given the speed of the hwrng stream, and I appreciate that it is somewhat conspiratorial to suggest that the Intel hwrng is somehow evil.</p>
<p>Unfortunately when dealing with something as fundamental (for crypto anyway) as the kernel RNG you just can&#8217;t trust anyone.</p>
<p>I think your patch is excellent as it moves the RDRAND mixing back to where it should be. I didn&#8217;t have a big problem with it but I did comment it would have made more sense pre-hash.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206624">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206624">
						October 15, 2013 5:02 PM					</a>

				</p>

				<p>@Clive Robinson:<br />
<i>&#8220;What are the implications of self timed logic at 3GHz)&#8221;</i></p>
<p>I think they <i>can</i> reliably test it on the chip.  The key factor here is &#8220;Intel can,&#8221; not everybody else, and many people do want to test it.</p>
<p>I think that their design decision was actually to place a completely separate random number generating processor inside the die.  From reading their literature, the logic behind &#8220;rdrand&#8221; is really sophisticated.  The most effective way firewall that processor is to completely isolate it from the CPU&#8217;s bus, and allow it to be accessed only through a read-only register.  Therefore, it has its own self-test.  That seems the most secure way to do it, since if it&#8217;s completely isolated, then no hanky-panky in the CPU can touch it.</p>
<p>And that&#8217;s what everybody is concerned about, isn&#8217;t it?  That the HRNG is isolated from the CPU, and is safe behind its firewall.  <i>And no suspect operands can magically change values,</i> like<br />
in  ax, rightfoot<br />
out rightfoot, ax<br />
sh ax, rightfoot<br />
mov cx, nsa<br />
rdrand cx</p>
<p>It still comes down to the question of trust.  What external tests are used to verify the HRNG in TPM chips?  How about the HRNGs in various external chipsets?</p>
<p>From reading the programming manual, RDRAND behaves like /dev/random, which blocks when entropy is exhausted.  From 7.3.17 of the manual:</p>
<blockquote><p>RDRAND returns random numbers that are supplied by a cryptographically secure, deterministic random bit generator DRBG. The DRBG is designed to meet the NIST SP 800-90A standard. The DRBG is re-seeded frequently from a on-chip non-deterministic entropy source to guarantee data returned by RDRAND is statistically uniform, nonperiodic and non-deterministic.</p>
<p>In order for the hardware design to meet its security goals, the random number generator continuously tests itself and the random data it is generating. Runtime failures in the random number generator circuitry or statistically anomalous data occurring by chance will be detected by the self test hardware and flag the resulting data as being bad. In such extremely rare cases, the RDRAND instruction will return no data instead of bad data.</p>
<p>Under heavy load, with multiple cores executing RDRAND in parallel, it is possible, though unlikely, for the demand of random numbers by software processes/threads to exceed the rate at which the random number generator hardware can supply them. This will lead to the RDRAND instruction returning no data transitorily. The RDRAND instruction indicates the occurrence of this rare situation by clearing the CF flag.</p></blockquote>
<p>So it all comes down to how much you trust Intel to incorporate a HRNG inside their chip, and nothing more than that.</p>
<p>@GentooAndroid:</p>
<p>(I have no idea why my comments are in reverse video on your version of Lynx.  Maybe it&#8217;s out of date.  I just downloaded 2.8.7, it it looks fine.  They must have picked up my change for &lt;brainupdate force=true subliminal=true iamalwaysright=true /&gt; tag change correctly.  I&#8217;ll talk to the guys in black (ninjas) and get them to rootkit, er, update your machine the next time you go for the fridge.)</p>
<p>See above for my theory on why it&#8217;s outside of JTAG.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206625">

			<div class="comment by-dave-taht ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.bufferbloat.net' rel='external nofollow ugc' class='url'>Dave Täht</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206625">
						October 15, 2013 5:42 PM					</a>

				</p>

				<p>@Brian M: What that total level of isolation from the rest of the chip ALSO means that it is possible to fiddle with the doping mask on the hwrng in an undetectable fashion.</p>
<p><a href="http://people.umass.edu/gbecker/BeckerChes13.pdf" rel="nofollow ugc">http://people.umass.edu/gbecker/BeckerChes13.pdf</a></p>
<p>(I think the above paper was also discussed on ts&#8217;o&#8217;s g+ )</p>
<p>I love it that hwrngs are becoming more widely available. They are desparately needed for the huge number of things requiring good cryptography, not least of which is wireless.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206626">

			<div class="comment by-andre-demarre ">

				<p class="commentcredit">

					<span class="commenter">Andre DeMarre</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206626">
						October 15, 2013 9:05 PM					</a>

				</p>

				<p>@Jack Bates @Toni @Dirk Praet</p>
<p>Even lesser known than that the Raspberry Pi&#8217;s ($40) BCM2835 SoC has a true hardware RNG, is that the BeagleBone Black&#8217;s ($45) AM335x has one as well&#8230;</p>
<p><a href="http://processors.wiki.ti.com/index.php/Cryptography_Users_Guide#Using_the_TRNG_Hardware_Accelerator" rel="nofollow ugc">http://processors.wiki.ti.com/index.php/Cryptography_Users_Guide#Using_the_TRNG_Hardware_Accelerator</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206627">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206627">
						October 15, 2013 9:15 PM					</a>

				</p>

				<p>@Dave Täht:<br />
<i>What that total level of isolation from the rest of the chip ALSO means that it is possible to fiddle with the doping mask on the hwrng in an undetectable fashion.</i></p>
<p>Aaaaand we go right back to the manual for that one.</p>
<blockquote><p>&#8230; the random number generator continuously tests itself and the random data it is generating.</p></blockquote>
<p>Theory, schmeory, let&#8217;s see some actual tests.  Go ahead and fiddle with the mask, and see if it passes the chip&#8217;s self-test.  Fiddle with the output, and see what the NIST and DieHarder2 tests reveal.  Seriously, I want modified chips and code.  Some of the &#8220;attacks&#8221; are pretty esoteric, and some are laughable.</p>
<p>Remember, if a Boeing 747&#8217;s engines are changed in mid-flight with 1971 Ford Pinto engines, it will crash.  Any aeronautical engineer will back me up on that, 100%.  It&#8217;s a valid theoretic vulnerability!  It is!</p>
<p>I just ran rngtest on my Ubuntu box.  21180 successes, and 16 failures.  Monobit: 1, Poker: 3, Runs: 6, Long Run: 6, and Continuous Run: 0.  That&#8217;s with an Infineon TPM chip.  So it has a 0.0008% failure rate.</p>
<p>Here&#8217;s a source of entropy:  YouTube videos!  Now you have a good, valid reason to have lots of stupid videos loading on your computer.  Yes, it&#8217;s all done for the sake of good random numbers! Sure, sure!  That&#8217;s the ticket! Yeah!</p>
<p>@GentooAndroid:<br />
I took a look on my Ubuntu box.  Yeah, I see it.  Dangit, I&#8217;m going to have to change that again.  It&#8217;s supposed to be invisible!  With subliminal holophonic noise output on the sound channel, too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206628">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206628">
						October 15, 2013 10:34 PM					</a>

				</p>

				<p>Andre DeMarre<br />
&#8211;Yeah, don&#8217;t really hear about beaglebone&#8217;s much; wonder why.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206629">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206629">
						October 15, 2013 10:41 PM					</a>

				</p>

				<p>@ name.withheld.for.obvious.reasons</p>
<p>&#8220;In summary, EAL-6/7 is not an option given budgets and procurement requirements&#8211;I could do a roll your own version but that won&#8217;t serve any certification of the process&#8211;maybe I can produce my own. Having done a good bit of DO-178B work on various micro-kernels and RTC OS&#8217;s, I could do a &#8220;simulated&#8221; IEC/ISO/NIST/ISCA certification but what purpose does that serve given the insistence that the NSA &#8220;must have access&#8221; to &#8220;any&#8221; system seems counterproductive at this point. &#8221;</p>
<p>Funny thing that I thought you were someone replying to one of my old comments when I first saw EAL6/7 and DO-178B. I&#8217;m practically the only one here that promotes such development standards, although not the formal evaluations. I&#8217;ve previously promoted GEMSOS, LOCK, the SKPP kernels, etc. I also say &#8220;EAL6/EAL7&#8221; so that was odd. Rubbing off on you or are have you been independently interested into all that yourself? 😉</p>
<p>You say you worked on DO-178B evaluations of microkernels. I&#8217;m very interested in an insider&#8217;s view on the process and these products as I&#8217;ve previously promoted them as foundations for at least medium assurance devices. I have a tad different focus now but they&#8217;re still useful tools.</p>
<ol>
<li>Do the DO-178B standards really increase quality of OS code, device drivers, and such to the levels they claim? Or is it handwaiving?</li>
<li>What&#8217;s your opinion on INTEGRITY-178B, LynxOS-178B/LynxSecure, VxWorks MILS, and PikeOS? I know safety != security but these are all targeting both markets. You think they live up to their claims about low chance of exploitable defects? And just how useful are they really in their evaluated configuration for the wide range of stuff these companies are promoting?</li>
</ol>
<p>(Seems to me that significant changes are made in the evaluated configuration that makes the evaluation worth a bit less as evidence of assurance.)</p>
<ol>
<li>I&#8217;ve often praised DO-178B for its supposed requirements of source to object code correspondence and traceability between artifacts (e.g. design to code). Do you guys really verify even C and C++ programs down to the object code? Is a line drawn somewhere? Aside from CompCert, I can&#8217;t even see how you could easily do the tracing. Any insight on this would be appreciated as I think such traceability is key to defeating subversion by malicious developers.
</li>
<li>
<p>It seems that INTEGRITY-178B&#8217;s EAL6 evaluations and maybe some DO-178B evaluations showed evidence of highly robust software development, but run on low assurance developed processors like PowerPC. (I like PPC don&#8217;t get me wrong but it sure ain&#8217;t EAL6.) I know some Orange Book products used custom firmware and/or microcode. Is the hardware/firmware really as much a weak link on these RTOS&#8217;s as I think or is anything done to mitigate this stuff?</p>
</li>
<li>
<p>One proposal I had long ago was to build a medium assurance, minimalist OS out of DO-178B components. I noticed there&#8217;s kernels, networking, filesystems, graphics and I think even audio components out there. Integrating them into a system with a robust kernel and using state-of-the-art information flow techniques might be an easy way to develop an extremely low defect, more-secure-than-average system without the millions of dollars and hundreds of man-(hours/months/years) it would take to build a high assurance product from scratch. Be a nice interim solution I thought in area&#8217;s like security appliances, thin clients, authorization systems and so on. Your thoughts?</p>
</li>
<li>
<p>Another proposal I had (and discussed with a Common Criteria insider) was refining the evaluation. I think the evaluations are too heavy and slow. One trick might be to have qualified labs evaluate the product and the process, focusing on most high payoff techniques. And I think this should happen at onset with developers and independent evaluators regularly bouncing deliverables back and forth to make the process smooth. Naturally, these labs probably wouldn&#8217;t be Cygnacom, SAIC, etc. and you wouldn&#8217;t get a CC certificate. Instead, you&#8217;d get a review posted on their website detailing the security claims, what was confirmed, proper usage recommendations, and a signature. It would be a quality improving review, a form of due diligence, and a third party endorsement all at once.</p>
</li>
</ol>
<p>(For non-proprietary or secretive projects, I&#8217;d also advice the process&#8217;s artifacts be posted online in an easy to review manner so wide peer review can happen. My main design didn&#8217;t mention this at the outset b/c the commercial entities producing software, esp security software, probably don&#8217;t want all their I.P. posted on the internet. Gotta be practical.)</p>
<p>Sorry if it seems a bit much. These are things that have been bouncing around in my head for a few years. Take all the time you want to respond or don&#8217;t respond. I&#8217;m good either way. I just figure people following my posts and press releases on these DO-178B products/processes might enjoy a rare opinion from an insider, esp if semi-anonymity allows them to be a bit more honest. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206630">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206630">
						October 15, 2013 11:43 PM					</a>

				</p>

				<p>@ Brian M,</p>
<ul><i>So it all comes down to how much you trust Intel to incorporate a HRNG inside their chip, and nothing more than that.</i></ul>
<p>Err no far from it.</p>
<p>For instance you forgot two important words from your statment the ommission of which makes it worthless [1].</p>
<p>As has been pointed out on this blog many times and well before this current NSA-NIST bashing in the world press Intel have an erata sheet on their CPU&#8217;s that is quite large. If your memory stretches back a while you will remember that Intel came in for their own share of bashing in the world press due to the &#8220;pentium bug&#8221; where they got a constant wrong.</p>
<p>Further Intel in the past felt these hardware/firmware failings were such a significant issue that they put in a whole load of otherwise redundant hardware into their CPU&#8217;s to alow the microcode firmware in the CPU to be updated remotly without the user having control. And thus have now opened themselves to the speculation that this is in it&#8217;s self a NSA inspired back door&#8230; Which even if it&#8217;s not true still makes a rather jucicy malware target for those who have the ability to exploit it and to be fair the NSA along with GCHQ et al would come high on any list of those with the ability [2]. And I for one was pointing out the failings in &#8220;code signing&#8221; long prior to Stuxnet making them obvious, again via the worlds press.</p>
<p>I&#8217;ve also been pointing out the dangers around RNGs back into the last century and certainly prior to the little NetScape problem if you remember that. And I&#8217;ve a long history of designing and building RNGs of various qualities for a long time.</p>
<p>Which is why I&#8217;ve repeatedly in the past called Intel out for their RNG designs and coined the expression &#8220;magic pixie dust thinking&#8221; because they hid poorly designed entropy generators behind crypto primatives to hide the design failings. And in this opinion I&#8217;m very far from alone.</p>
<p>Rather than quote meaningless blurb from Intel&#8217;s manuals actualy do what I suggested and,</p>
<ul>What are the implications of self timed logic at 3GHz</ul>
<p>Rather than rather embarisingly say,</p>
<ul><i>Aaaaand we go right back to the manual for that one&#8230;</i></ul>
<p>Before quoting what is a fine piece of markiting droid speach dressed up as technical prose,</p>
<ul><i> the random number generator continuously tests itself and the random data it is generating</i></ul>
<p>I urge you to please think carefully on the implications of this before making a reply, because so far it&#8217;s fairly apparent you have not, which is not a good idea.</p>
<p>[1] Prior to HRNG the two words &#8220;correctly working&#8221; should be added preferably with the words &#8220;verifiably tested by independant test house&#8221; as has been done by other manufactures of CPUs with HRNG&#8217;s in (the fact that one independent test house dropped the ball is neither hear nor there because reading their report showed they had done so).</p>
<p>[2] As I&#8217;ve said on this blog and a number of other places several times in the past much predating the CarrierIQ debacle, &#8220;test hooks&#8221; are custom made to hang a malware hat on unless you take steps to prevent it. That is any test system if not properly designed can be used to harm the system or the users of the system.</p>
<p>[]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206631">

			<div class="comment by-bhima ">

				<p class="commentcredit">

					<span class="commenter">Bhima</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206631">
						October 16, 2013 12:31 AM					</a>

				</p>

				<p>@ JT I&#8217;m not toni but the only software package I&#8217;ve found to send entropy from one source to other clients on a network is called &#8220;Entropy Broker&#8221;: <a href="http://www.vanheusden.com/entropybroker/" rel="nofollow ugc">http://www.vanheusden.com/entropybroker/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206632">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206632">
						October 16, 2013 3:23 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<blockquote><p>Which is why I&#8217;ve repeatedly in the past called Intel out for their RNG designs and coined the expression &#8220;magic pixie dust thinking&#8221; because they hid poorly designed entropy generators behind crypto primatives to hide the design failings.</p></blockquote>
<p>Well said Clive, this is such a reoccurring theme in tech. Designers leave JTAG&#8217;s on the board for the &#8220;just in case&#8221; and then wonder why the hardware gets jail-broken&#8230;and that&#8217;s the simple case. The variation and plurality of design and production tradeoffs give one an endless stream of fun.</p>
<p>Currently I am fighting an RTL synthesis issue and timing convergence for a mixed signal application (parallel array of sensors)&#8211;MSO&#8217;s are great for debugging but in the runs that include signals (Verilog/VHDL) and some analog transients (wide-band app without FIR) at the sensor seems to be analogous (slightly).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206633">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206633">
						October 16, 2013 6:46 AM					</a>

				</p>

				<p>Brian M.: &#8220;@GentooAndroid: I took a look on my Ubuntu box. Yeah, I see it. Dangit, I&#8217;m going to have to change that again. It&#8217;s supposed to be invisible! With subliminal holophonic noise output on the sound channel, too.&#8221;</p>
<p>Lynx 2.8.6rel.4 (15 Nov 2006) and 2.8.8dev.15 both react to this example:</p>
<p>text in normal colors.</p>
<div class="commentbody by-brian-m">text in reverse video.
</div>
<p>The case is not significant here. And this showed nothing:<br />
ldd /usr/bin/lynx | grep &#8216;=&gt;&#8217; | sed -e &#8216;s:.<em>=&gt; ::&#8217; -e &#8216;s: .</em>::&#8217; | LANG= xargs grep -i &#8216;brian&#8217;</p>
<p>A curious easter egg 🙁</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206634">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206634">
						October 16, 2013 6:50 AM					</a>

				</p>

				<p>The</p>
<blockquote><p>
  GREATER<br />
  sign and the<br />
  LESS<br />
  sign are forbidden in comments here 🙁
</p></blockquote>
<p>Here is the real example, where I replaced them by the strings LESS and GREATER:</p>
<p>LESS html GREATER  LESS body GREATER text in normal colors.<br />
 LESS div class=&#8221;commentbody by-brian-m&#8221; GREATER text in reverse video.<br />
 LESS /div GREATER  LESS /body GREATER  LESS /html GREATER</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206636">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206636">
						October 16, 2013 7:33 AM					</a>

				</p>

				<p>@GentooAndroid<br />
Try &amp; gt and &amp; lt (without the space between the ampersand).<br />
e.g.<br />
if (a &amp;lt b) or (b &amp;gt a)</p>
<p>&amp;ltblockquote&amp;gt doesn&#8217;t appear to work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206637">

			<div class="comment by-jt ">

				<p class="commentcredit">

					<span class="commenter">JT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206637">
						October 16, 2013 7:41 AM					</a>

				</p>

				<p>@ Bhima</p>
<p>thanks for that.  i was thinking of something like this on the client side</p>
<p>mkfifo /dev/randomserver<br />
ssh [IP] cat /dev/hwrng &gt; /dev/randomserver</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206639">

			<div class="comment by-gentooandroid ">

				<p class="commentcredit">

					<span class="commenter">GentooAndroid</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206639">
						October 16, 2013 8:04 AM					</a>

				</p>

				<p>@JT, @Bhima:</p>
<p>Thank you, we now have an excellent reason to continuously transport amounts of random data on internet.</p>
<p>@Aspie: &#8220;Try &amp; gt and &amp; lt (without the space between the ampersand).&#8221;</p>
<p>Thank you. The easter egg seems to be:</p>
<p>&amp;lt html&amp;gt&amp;lt body&amp;gt text in normal colors.<br />
&amp;lt div class=&#8221;commentbody by-brian-m&#8221;&amp;gt text in reverse video.<br />
&amp;lt/div&amp;gt&amp;lt/body&amp;gt&amp;lt/html&amp;gt</p>
<p>The case-insensitive text between quotes is important, I tried various changes and all of them broke the easter egg.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206640">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206640">
						October 16, 2013 8:24 AM					</a>

				</p>

				<p>JT: you&#8217;re probably better off using the hwrng on the other machine to seed /dev/random periodically or even better use an entropy sharing daemon (someone suggested entropy-broker but there are others) as you are potentially creating an issue if your other machine (with the hwrng) goes offline or crashes. If you&#8217;ve compiled your software to use only your fifo for random and it blocks, well, your web server etc&#8230; is going to break.</p>
<p>Given how integral the /dev/random device is in Linux (used for TCP sequence numbers etc) it needs to be trustworthy &#8211; and I believe it is. Even if you don&#8217;t trust Intel&#8217;s RDRAND it is xor&#8217;d into the random stream and thus it can&#8217;t make the existing entropy any worse. Okay, bad English but I hope you understand what I am getting at.</p>
<p>If you are dead set against using any RDRAND derived data use nordrand as one of your kernel args on bootup or just edit random.c and ensure it isn&#8217;t called.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206641">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206641">
						October 16, 2013 8:47 AM					</a>

				</p>

				<p>@Mike the goat: &#8220;Even if you don&#8217;t trust Intel&#8217;s RDRAND it is xor&#8217;d into the random stream and thus it can&#8217;t make the existing entropy any worse.&#8221;</p>
<p>Except if NSA^W^H RDRAND knows about that.</p>
<p>If RDRAND is XOR(sha1(++nsakey+processorID),existing entropy), then XOR(RDRAND,existing entropy) is sha1(++nsakey+processorID).</p>
<p>(The existing entropy is conveniently loaded in a predictible registry; XOR only works for independent sources)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206642">

			<div class="comment by-theodore-tso ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://thunk.org/tytso' rel='external nofollow ugc' class='url'>Theodore Ts&#039;o</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206642">
						October 16, 2013 10:08 AM					</a>

				</p>

				<p>@Luck:<br />
<i><br />
Except if NSA^W^H RDRAND knows about that.</i></p>
<p><i>If RDRAND is XOR(sha1(++nsakey+processorID),existing entropy), then XOR(RDRAND,existing entropy) is sha1(++nsakey+processorID).</i></p>
<p><i>(The existing entropy is conveniently loaded in a predictible registry; XOR only works for independent sources)</i></p>
<p>You keep saying that, but it&#8217;s not true.  Let&#8217;s take a look at the relevant assembly code in question, shall we?</p>
<pre>
        leal    -164(%ebp), %eax
.LVL889:
        call    arch_get_random_long
.LVL890:
        testl   %eax, %eax
        je      .L406
        .loc 3 1042 0
        movl    -164(%ebp), %eax
        xorl    %eax, (%esi)
        addl    $4, %esi
        jmp     .L405
</pre>
<p>The arch_get_random_long function is what actually calls RDRAND.  It&#8217;s in a separate function since we have to test to see whether or not the CPU supports RDRAND, and even if it does support RDRAND, it can return an error at which point we have to retry the RDRAND (actually, on this generation of x86 chips, it&#8217;s highly unlikely that RDRAND will fail due to lack of entropy, since it would basically require all the cores and all the hyperthreads to be calling RDRAND at the same time, and even then the hwrng might be fast enough to keep up; the story will be different with RDSEED, and it&#8217;s a really good idea to do error checking even if most of the time the call or instruction doesn&#8217;t fail&#8230;).</p>
<p>You&#8217;ll also see that the XOR is to a location in memory, in extract_buf(), which calls arch_get_random_long().   So I will repeat what I said.  If you think the NSA could have really trojanned the the x86 execution pipeline to the extent that it could track that a register contains RDRAND output, across a function call return, just so it can then access a memory buffer to find the location of the gimmick the value of the register containing the putative RDRAND output[1] and you really think the NSA could suborn enough Intel employees so that no one would notice and/or pull a Snowden, then I suggest you start creating your own CPU&#8217;s using 74XX TTL chips.  (I&#8217;ll also note that this assumes that the NSA&#8217;s gimmicking on the x86 execution pipeline was general enough that it could support code generation on multiple different compilers &#8212; different versions of gcc and clang.)</p>
<p>[1]  Alternatively you could posit that the corrupted x86 execution pipeline could track the register containing the RDRAND output, and convert the XOR to memory into a STORE into memory, but that could be noticed by someone who was testing for that theory.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206643">

			<div class="comment by-south ">

				<p class="commentcredit">

					<span class="commenter">south</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206643">
						October 16, 2013 10:41 AM					</a>

				</p>

				<p>Not to be overly paranoid, but in addition to the possibility of our own government&#8217;s interference, has anyone given thought as to where many of Intel&#8217;s CPUs are manufactured? Just a simple tech here, but have always considered the remote possibility of additional (hidden) instructions being embedded at some of the foreign manufacturing plants, particularly China. And with transistor counts in the billions for a modern CPU, who knows what else could be buried inside.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206644">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206644">
						October 16, 2013 11:07 AM					</a>

				</p>

				<p>@Clive Robinson:</p>
<p>How do you, personally, go about testing the HRNG in various TPM chips, the Via Nehemiah C3 CPU, and the AMD-760MP or AMD-8000 series chipsets?  I really want to know.  No hand waving, please.</p>
<p>Also, have you looked at what the NIST tests for monobit, poker, and runs entail?  Not much.  Those are easy to implement in hardware, <i>especially when the you have leading hardware designers on the job</i>.  (Once upon a time I worked for an OEM, and my boss was one of the guys who designed the 80386.  The salespeople for the chipset we were using asked us, &#8220;You used those two, why not the third?&#8221;  My boss replied, &#8220;Well, I realized that I could implement it in three PALs, so that&#8217;s what I did.&#8221;  Everybody laughed.)</p>
<p>Yes, I do remember Intel&#8217;s bugs.  AMD&#8217;s bugs, too.  Intel could have run an available math regression suite on their chip, but they didn&#8217;t do that.</p>
<p>AFAIC, any time a HRNG is implemented as a black box, there will be &#8220;problems&#8221; with verification.  And it really does come down to the question of trust.  Like the <a href="http://www.random.org/analysis/" rel="nofollow ugc">Dilbert cartoon</a> points out, &#8220;That&#8217;s the problem with randomness: you can never be sure.&#8221;  So if the generator passes the public tests, and there&#8217;s no major repetition, then I&#8217;m calling it good and using it.  Everybody has a limit to the time they can spend on a problem, and at some point I have to solve other things.</p>
<p>@GentooAndroid:<br />
Maybe it&#8217;s a Linux-only thing.  It&#8217;s very curious, to put it mildly.  Be sure to file a bug!  I wonder if it may do it on the Mac build.  (When I was in high school, I was writing code part-time on a Sperry-Univac TIP 90/40 mainframe.  While attempting to figure out what control codes might do on the terminal, I accidentally found out I could take down the mainframe with seven characters.  Oops!)</p>
<p>@south:<br />
The problem is not one of hidden instructions, it&#8217;s one of meeting performance criteria.  There have been reported instances of &#8220;mislabeled&#8221; chips being sold by vendors to contractors producing military hardware.  I.e., selling a non-MILSPEC part, or one that&#8217;s rated for a different frequency range, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206645">

			<div class="comment by-jt ">

				<p class="commentcredit">

					<span class="commenter">JT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206645">
						October 16, 2013 11:30 AM					</a>

				</p>

				<p>@gentooandroid @mike the goat</p>
<p>i was following Toni&#8217;s original line of thinking about taking a local RPi and turning it into a dedicated HWRG on a local network only.  on a local gbit ln, the amount of traffic it would use should be trival. (I think the RPI HWRNG max output is only 1m/s)<br />
Having not used mkfifo in that capacity before, would it continously stream or only stream when the machine actually tries to pull from the /dev/randomserver pipe?</p>
<p>thinking about it though it would be gleefully enjoyable if we filled up NSA datacenters with encrypted randomness for them to analize. 😛</p>
<p>Ive never used entropy broker, but ill look into it.  you mentioned there were others, do you happen to know any names i can look for?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206646">

			<div class="comment by-acorn ">

				<p class="commentcredit">

					<span class="commenter">ACORN</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206646">
						October 16, 2013 1:08 PM					</a>

				</p>

				<p>—Donald Knuth. Any one who considers arithmetical methods of producing random digits is, of course, in a state of sin</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206647">

			<div class="comment by-john-von-neumann-not-donald-knuth ">

				<p class="commentcredit">

					<span class="commenter">John von Neumann, not Donald Knuth</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206647">
						October 16, 2013 1:51 PM					</a>

				</p>

				<p>ACORN, you mis-attributed that famous quote. It&#8217;s from von Neumann. Knuth quoted him in his book. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206648">

			<div class="comment by-bhima ">

				<p class="commentcredit">

					<span class="commenter">Bhima</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206648">
						October 17, 2013 2:19 AM					</a>

				</p>

				<p>@ JT: Looking at what entropy broker does with entropy data, I think there&#8217;s probably more to sharing entropy data (skillfully) than just &#8220;ssh [IP] cat /dev/hwrng &gt; /dev/randomserver&#8221;</p>
<p>@ Mike the goat: What other entropy sharing daemons are there?  I&#8217;d like to try them.  Thanks!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206649">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206649">
						October 17, 2013 5:58 AM					</a>

				</p>

				<p>Bhima: I recall there was one called rngd several years back but a Google search turned up nothing (there&#8217;s another product called rngd but is not an entropy sharing daemon). Looks like you are stick using either entropy-broker or rolling your own.</p>
<p>I would write a few lines to pump, say 10kb of noise from the hardware RNG to stdout. Make an unprivileged user and set its shell to that little program you&#8217;ve created and then generate an ssh keypair and disable password authentication. On the other side you can just put an entry in your cron to ssh into the said host and direct the output into /dev/random to seed it.</p>
<p>This would improve the amount of entropy available whilst also ensuring that you don&#8217;t accidentally create a DoS opportunity by somehow interrupting communication between the two hosts (if you were doing your fifo idea and using it directly, say for openssl in apache, if the connection failed and blocked you&#8217;d effectively stop https working).</p>
<p>You can adjust the frequency of the polling, e.g. if it is a busy server and you get delays due to blocking of /dev/random run it hourly rather than daily. You could also use a much larger chunk size and instead cache it &#8211; i.e. get your little program to pump 1MB instead of a few kB and write a daemon that monitors entropy_avail and injects a kB or so at a time whenever it starts getting low. Make a second thread that keeps an eye on your cache (in memory ideally) of the chunk of random data and when it gets low, open your connection again and get some more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206650">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206650">
						October 17, 2013 9:47 AM					</a>

				</p>

				<p>@ Nick P</p>
<p>Sorry, didn&#8217;t notice your post on EAL and DO-178B. I will quickly respond by saying I have probably touched most InfoSEC process and qualification standards. I will need to draft a proper response to the set of questions you asked. I can say that all your questions are relevant and I share your experience in the RTOS and hardware experiences with some slight variations. I know I can give you some significant feedback. Don&#8217;t want to put too much on the table. Maybe orgs like LLNL or some contractors to government don&#8217;t  appreciate comments about tech. Hopefully today, have some stuff on my plate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206651">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206651">
						October 17, 2013 10:53 AM					</a>

				</p>

				<p>@ name.withheld</p>
<p>I appreciate it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206652">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206652">
						October 17, 2013 11:13 AM					</a>

				</p>

				<p>@Bhima:</p>
<p>There is the rngd that&#8217;s part of the rng-tools package.  It injects entropy from a source into the kernel, and it can be used with an arbitrary input stream.  <a href="http://www.outflux.net/blog/archives/2013/08/13/tpm-providing-devhwrng/" rel="nofollow ugc">This blog has some hints</a> about sharing entropy sources over a network.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206653">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206653">
						October 17, 2013 1:20 PM					</a>

				</p>

				<p>@ Brian M,</p>
<ul><i>How do you, personally, go about testing the HRNG in various&#8230; chips&#8230;? I really want to know. No hand waving, please.</i></ul>
<p>I won&#8217;t handwave but the answer will be long.</p>
<p>Back ground first.<br />
When it comes to any security hardware be it built from passive components through to chips I can not see inside I follow a process to decide if it&#8217;s acceptable for use or not and at what levels.</p>
<p>If it is acceptable I determin at what level both in use and for use, that is it has a quantified level of &#8220;trust&#8221; as a device and it might be used in applications that require more or less &#8220;trust&#8221; than the device has. If more trust than the device has then it will need to be built into a system using other devices to achive the desired level of trust.</p>
<p>The process is in effect &#8220;verify then trust, but with constantly verify in use&#8221;. Which places the emphasis on verification to the required level which basicaly boils down to formal design methods and controls in manufacture, through detailed testing, and on to continual in use testing. Outside of testing much of it appears as an auditing process which I shall simply gloss over here by saying that knowing the formal methods helps decide the testing methods.</p>
<p>At each stage the idea is to charecterise the device into one of the following</p>
<p>1, Do not use.<br />
2, Mittigate in use.<br />
3, Trust to some level/area of use.</p>
<p>It&#8217;s important to note that the &#8220;do not use&#8221; and &#8220;mittigate&#8221; groups might well contain devices that would without non &#8220;trust&#8221; related issues be in the &#8220;trust&#8221; groups. The major cause of this is the limitations in resources for verification both in initial clasiffication and during use. Thus it is first important to know the limitations of the verification resources and processes.</p>
<p>As I&#8217;ve indicated before certain determanistic processes will pass all the standard &#8220;witness&#8221; tests and will make a simple fully determanistic counter look random. This is the major reason why you need to conduct tests as close to the entrapy source as possible and certainly befor any debias or whitening circuits.</p>
<p>Importantly this close to the entropy source testing is essential not just in initial testing but also in runtime testsing used to detect failure or influance of the source in use. For instance a D-type latchs can and do fail and become in effect transparent to either the D or CLK inputs which would fairly quickly be seen on the output of a wide band spectrum analyser trace connected to the Q or /Q outputs but not after de-bias or whitening.</p>
<p>Often the failure can be one of metastability which occures in all latches in about 1 in 10E+9 operations without external EM influance. Metastability issues may or may not cause a soft latchup in subsiquent circuits which could remain for short, long or indefinate periods, but will clear on the powersupply being cycled.</p>
<p>If the internal operations of the device are running at 3x10E+9 opperations per sec then without preventative action metastability events will occure around three times a second with only some fraction of them being more than a few cycles long, but the probability of a full soft latchup obviously increases with the internal operating speed. Whilst some latchups will be caught by the internal chip tests not all will and some of the test circuits themselves will be prone to latchups. Detecting latchups externaly is possible by examining the raw sorce of entropy and the downstream output after debias and whitening (where the methods are sufficiently detailed).</p>
<p>Another metastability issue is it is influanced by temprature and supply voltage as well as by EM energy either by conduction or radiation. In fact with a bit of care you can use metastability as a random source in it&#8217;s own right (self biasing latch) and it appears that many designers don&#8217;t actually know much about it and it&#8217;s not that well documented in academic or design documentation (it&#8217;s often considered a &#8220;black art&#8221; that&#8217;s supposadly designed out&#8230;).</p>
<p>The issue of metastability alone gives rise to the question of &#8220;why so fast?&#8221; For on chip TRNGs. Because few if any OSs or applications need TRNGs that run that fast, mathmatical simulations for instance might require high rates of random numbers that are well distributed but they don&#8217;t need the same aspects that security does so usually PRNGs suffice. The generation of many security functions such as nonces are actually better done by PRNG&#8217;s using Crypto Functions where the uniqunes of a nonce can be guarenteed simply by using a CTR-RNG. Thus the TRNG can be quite slow as it is only needed to generate &#8220;seed/start&#8221; values for CS-PRNGs.</p>
<p>The other real security problem with the speed is it&#8217;s just not possible to run anytthing other than barely minimal witness tests for bias let alone any other failing. Tests such as those based on or involving FFT and FWT are impracticle at those speeds even with the best of test equipment so high speed TRNG&#8217;s get marked down as &#8220;not verifiable in use&#8221; for some security applications.</p>
<p>Above basic bias issues what you are looking for are in essence &#8220;signals in noise&#8221;, if a witness test finds a signal then the generator is failed unless the signal can be mitigated in some way. The faster the generator runs the more difficult both detection and mittigation become.</p>
<p>Simple &#8220;down sampling&#8221; of the high speed TRNG won&#8217;t make life much easier some signals will still be present but in a less recognisable form after down conversion by down sampling.</p>
<p>Now if &#8211;as some people are&#8211; you are arguing about some NSA backdoor then you have the further problem of what signals to look for and where.</p>
<p>The NSA have in the past &#8220;cornered the market&#8221; in &#8220;brains&#8221; for signals analysis and I suspect they are well ahead of the game still. The closest the open crypto community has come to this is &#8220;digital watermarking&#8221; back at the turn of the century, and to be honest they were not that good at it and basicaly gave up on it after quite a short time.</p>
<p>What the NSA would be looking for is synchronisation signals that make themselves visable after noise signal transformation by debias and whitening. The obvious way is to add the signal at the output, the less obvious is to inject it upstream of whitening or debias. To inject a signal upstream of the output they need to do this by either designing a signal that exploits weaknesses in the debias and whitening used, or weaken the debias and whitening in some way to pass a signal. There are three ways to find such signals the first and easiest is by finding where it is being injected into the entropy noise signal, the second and much harder is by cross corelating the input with the ouput, the third and well nigh impossible is by examination of the output alone.</p>
<p>So for ease of verifying with complex tests access to the output of the entropy source is required, and at one point was a standard and expected &#8220;test port&#8221; on stand alone TRNGs. Obviously the faster such a system runs the more difficult it is to test and the greater the potential for &#8220;smoke and mirrors&#8221; to hide behind (however the reality is very much OS/App related).</p>
<p>It is this lack of verification information and ability to test the raw entropy that makes me cautious and I see those on chip TRNGs with these problems not as verifiable systems in a &#8220;trust&#8221; group but as either &#8220;aditional seasoning&#8221; to a &#8220;trusted&#8221; TRNG where the on chips failure won&#8217;t detract from the &#8220;trusted&#8221; TRNG or as something that has to be mittigated against by the addition of additional entropy and whitening. Either way I don&#8217;t trust them sufficiently for security critical work, hence my comments about not betting my life or the lives of others on them.</p>
<p>And I guess one of the problems with on chip TRNGs is they feel like they have been designed by a commity of &#8220;ideas men&#8221; and the result is a &#8220;jack of all trades&#8221; soloution that does not fit well for any of the tasks you might reasonably expect to do.</p>
<p>I might be treating some on chip TRNG&#8217;s unfairly but at the end off the day if I cannot verify I won&#8217;t trust for security critical systems. And there is also a limited amount of expenditure I&#8217;m prepared to expend on verification thus I will drop a suitable DSP chip in to run various signal detecting algorithms on a slow TRNG entropy source output because my need for high quality &#8220;seed/start&#8221; values is comparitvly modest in a given design. But there is no economic justification for me putting testing systems in place for chip manufactures that want to make life difficult.</p>
<p>As you noted with your &#8220;three PALs&#8221; story I can do it my own way more economicaly&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206654">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206654">
						October 17, 2013 4:17 PM					</a>

				</p>

				<p>In my current kernel (3.2.0-55-generic #85-Ubuntu SMP Wed Oct 2 12:29:27 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux) the call to arch_get_random_long seems to be inlined</p>
<p>L1:mov    %esi,%ecx<br />
   mov    $0x0,%ecx<br />
   data32 xchg %ax,%ax (0x666690)<br />
   xchg   %ax,%ax &#8211; (0x6690)<br />
   test   %ecx,%ecx<br />
   je     .L2<br />
   xor    %rax,-0x90(%rbp,%rdx,1)<br />
   add    $0x8,%rdx<br />
   cmp    $0x10,%rdx<br />
   jne    .L1<br />
L2</p>
<p>But I am not confident enough to understand what data32 xchg %ax,%ax does exactly. If it was rdrand, then an evil CPU might insert xor -0x90(%rbp,%rdx,1),%rax immediately after occurence of data32 xchg %ax,%ax.</p>
<p>(how I got that assembly code: LANG= sed &#8216;s:\x1f\x8b\x08\x00:GZIPHEADER:&#8217; &lt; /boot/vmlinuz-3.2.0-55-generic | LANG= grep -aA20000000 GZIPHEADER | LANG= sed &#8216;s:^.*GZIPHEADER:\x1f\x8b\x08\x00:&#8217; | gunzip -c &gt; /tmp/vmlinux; objdump -d /tmp/vmlinux &gt; /tmp/dump; grep -A1 extract_buf /boot/System.map-3.2.0-55-generic; vim dump ; edit out everything but the last for() loop of extract_buf)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206655">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206655">
						October 17, 2013 4:21 PM					</a>

				</p>

				<p>LANG= sed &#8216;s:\x1f\x8b\x08\x00:GZIPHEADER:&#8217; %lt /boot/vmlinuz-3.2.0-55-generic | LANG= grep -aA20000000 GZIPHEADER | LANG= sed &#8216;s:^.*GZIPHEADER:\x1f\x8b\x08\x00:&#8217; | gunzip -c %gt /tmp/vmlinux; objdump -d /tmp/vmlinux %gt /tmp/dump; grep -A1 extract_buf /boot/System.map-3.2.0-55-generic; vim dump ; edit out everything but the last for() loop of extract_buf</p>
<p>Sorry for the missing %lt and %gt in previous message.</p>
<p>I understand that I do not have the technical level to continue discussing here my assuptions or fears. Let&#8217;s say @Theodore Ts&#8217;o is right.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206656">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206656">
						October 17, 2013 4:58 PM					</a>

				</p>

				<p>Please replace &#8220;,%rax immediately after occurence&#8221; by &#8221; immediately and blindly after every occurence&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206658">

			<div class="comment by-luck ">

				<p class="commentcredit">

					<span class="commenter">Luck</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206658">
						October 17, 2013 4:59 PM					</a>

				</p>

				<p>Please replace &#8220;,%rax immediately after occurence&#8221; by &#8220;%lt internal register of RDRAND%gt immediately and blindly after every occurence&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206659">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206659">
						October 17, 2013 5:28 PM					</a>

				</p>

				<p>@Clive Robinson:<br />
<i>I will drop a suitable DSP chip in to run various signal detecting algorithms on a slow TRNG entropy source output because my need for high quality &#8220;seed/start&#8221; values is comparitvly modest in a given design.</i></p>
<p>OK, so it seems that you use your own chips.  Fair enough.  If you need total validation, I agree, that&#8217;s the only way to do it.</p>
<p>The Intel page I linked above (Section 3.3, Figure 4) shows that the entropy source undergoes comparison to a test source.  The result of that comparison is fed to the conditioner.  According to their documentation, at that point the number generation would be completely shut down until the entropy tests pass.</p>
<p>Which actually does follow your own methodology.</p>
<p>The possible attacks you outlined seem rather esoteric to me, given that the NSA would have to be running a <i>load of code</i> on the machine in order to possibly influence the RNG process.  Like Theodore Ts&#8217;o commented, at that point you have larger problems than random numbers.</p>
<p>As for trusting my life to random numbers, well, it&#8217;s not on my risk calculation.  I do a lot of walking, and pedestrian fatalities are far higher than fatalities from random numbers.</p>
<p><a href="http://http.developer.nvidia.com/GPUGems3/gpugems3_ch37.html" rel="nofollow ugc">NVIDIA boasts</a> that &#8220;we find that a single GeForce 8 GPU generates Gaussian random numbers 26 times faster than a Quad Opteron 2.2 GHz CPU&#8230;&#8221; so I&#8217;m sure that full RNG verification will continue to remain problematic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206660">

			<div class="comment by-peter-barnhart ">

				<p class="commentcredit">

					<span class="commenter">Peter Barnhart</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206660">
						October 17, 2013 7:34 PM					</a>

				</p>

				<p>@Wesley Parish<br />
Thanks for your comment &#8211;<br />
actually, I hadn&#8217;t heard of the book &#8211; I&#8217;ve read very little Sci-Fi in the past 30 years, but it sounds like a fun read.<br />
I think you would probably find the cosmic microwave background has lots of non-random components.  The trick is to sample an obviously random natural source pseudorandomly, the idea being that the two would be uncorrelated.<br />
Question is if apod can supply entropy fast  enough for whatever the application is.  I&#8217;m assuming a relatively light demand rate.  The hardware sources described by most of the posters are far faster.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206661">

			<div class="comment by-bhima ">

				<p class="commentcredit">

					<span class="commenter">Bhima</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206661">
						October 18, 2013 5:37 AM					</a>

				</p>

				<p>@ Brian M. &amp; Mike the goat:  Thanks for the tips but it appears, to me at least, that Entropy Broker is a better option&#8230; despite its flaws and fading support.</p>
<p>Also, how do we report this spam?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206662">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206662">
						October 18, 2013 7:01 AM					</a>

				</p>

				<p>Hello Nick P,</p>
<p>Your comments about the Emperor&#8217;s new clothes (my paraphrasing of your post) is apropos but it would be nice if there was some humor mixed in&#8230;</p>
<p>Let me first respond by describing some of my work habits. As a classic engineer (old school NASA type) I keep a notebook journal at the ready, ticking every 15 minutes in my log book. I find it very useful to have work sketched out and useful for drawings, layout, or circuit design. I have worked in nearly every major sector in a multitude of capacities&#8230;I&#8217;ve learned to wear many hats and I can wear them all at the same time.</p>
<p>
I believe that interdisciplinary and multi-disciplinary skills will be necessary for the engineers of the future&#8230;material, structural, electronic, mechanical, software, documentation, standards, quality control, information assurance, project management, and a half dozen others.</p>
<p>I attempted at one time to work with a graduate school to engage the faculty (they said they supported it, but could not deliver) and developed a cirriculm that also sefved as a training program for an aerospace company. The GM of the company and the director of the institute at the graduate school where both on-board but unable to follow through.</p>
<p>
The above describes one of the most problematic issues I deal with on a regular basis, ignorance allows one to avoid responsibility (I see inaction as ignorant). I am employing my experience to set a framework and answer a few of your questions in a general way&#8230;and&#8230;I would prefer to take some of this offline as your statement about development and management are quite timely&#8211;I&#8217;m drafting a framework that is an answer to compartmentalized 1950&#8217;s management practices. I revisited QA/QC practices, my concern for process and procedure was given a kick last year&#8230;there is some extreme irony of late.</p>
<p>
Maybe we can exchange keys, I am willing to post a pseudo account to contact me but in order to make that work we might need to encode a sequence (I need to re-read some of your posts to develop a &#8220;second order&#8221; contextual reference that can be used to act as a one-time shared key. &#8220;How do you know she&#8217;s a witch?&#8221;, and &#8220;I have a cunning&#8230;&#8221; She&#8217;s dressed like one&#8211;plan.</p>
<p>Gotta go now&#8230;will return with some feedback you can use.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206663">

			<div class="comment by-peter-barnhart ">

				<p class="commentcredit">

					<span class="commenter">Peter Barnhart</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206663">
						October 19, 2013 8:28 PM					</a>

				</p>

				<p>@ Joe Landman and bitmonger</p>
<p>Note that some radioactive beta decay rates show an annual periodicity, in the case of radon about +/- 5%.  See work of Ephraim Fischbach and Jere Jenkins and many colleagues,  eg. ArXive 1207.5783v1<br />
Guessing is an influence of solar neutrinos modified by the Earth&#8217;s orbit eccentricity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-206664">

			<div class="comment by-james ">

				<p class="commentcredit">

					<span class="commenter">JAMES</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206664">
						February 22, 2014 12:29 PM					</a>

				</p>

				<p>HIJACK AUDIO TO STREAM A KNOWN AUDIO SEQUENCE TO RANDOM SEED GENERATOR LONG ENOUGH TO CAUSE A KNOWN SEED AND THEN ATTACK SYSTEM.  REFERENCE IS MADE TO THE UNKNOWN AUDIO OUTPUTS ON SOMEONES APPLE COMPUTERS.  THE SOUND OUTPUTS ARE A POSSIBLE SYMPTOM OF HIJACKED AUDIO. MAYBE THE OTHER RANDOM SEED INPUTS ARE BLOCKED OR ALSO HIJACKED.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-206666">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/#comment-206666">
						February 29, 2016 12:14 AM					</a>

				</p>

				<p>This entire debate is purely academic.  Most things which need good entropy, like generation for private keys, doesn&#8217;t use your random source at all &#8211; they are hardcoded to create their own PRNG sequences from predicable starting seeds.  (throw a few printf()&#8217;s into the set_seed() call if you&#8217;re not yet convinced).  Looks random.  Isn&#8217;t.  Prime numbers are so much fun.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2013/10/insecurities_in.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2013/10/insecurities_in.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F10%2Finsecurities_in.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2013/10/insecurities_in.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5045' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2013/10/fingerprinting_5.html" rel="prev">← Fingerprinting Burner Phones</a>		<a href="https://www.schneier.com/blog/archives/2013/10/massive_mimo_cr.html" rel="next">Massive MIMO Cryptosystem →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
