<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>BadBIOS - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; badBIOS Comments Feed" href="https://www.schneier.com/blog/archives/2013/11/badbios.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5082" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2013/11/badbios.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5082' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F11%2Fbadbios.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F11%2Fbadbios.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5082 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5082" class="post-5082 post type-post status-publish format-standard hentry category-uncategorized tag-airgaps tag-bios tag-computer-security tag-malware tag-rootkits">

	<div class="article">

		<h2 class="entry">badBIOS</h2>
		<p><a href="http://arstechnica.com/security/2013/10/meet-badbios-the-mysterious-mac-and-pc-malware-that-jumps-airgaps/">Good story</a> of badBIOS, a really nasty piece of malware.  The weirdest part is how it uses ultrasonic sound to jump air gaps.</p>
<blockquote><p>Ruiu said he arrived at the theory about badBIOS&#8217;s high-frequency networking capability after observing encrypted data packets being sent to and from an infected machine that had no obvious network connection with &#8212; but was in close proximity to &#8212; another badBIOS-infected computer. The packets were transmitted even when one of the machines had its Wi-Fi and Bluetooth cards removed. Ruiu also disconnected the machine&#8217;s power cord to rule out the possibility it was receiving signals over the electrical connection. Even then, forensic tools showed the packets continued to flow over the airgapped machine. Then, when Ruiu removed internal speaker and microphone connected to the airgapped machine, the packets suddenly stopped.</p>
<p>With the speakers and mic intact, Ruiu said, the isolated computer seemed to be using the high-frequency connection to maintain the integrity of the badBIOS infection as he worked to dismantle software components the malware relied on.</p>
<p>&#8220;The airgapped machine is acting like it&#8217;s connected to the Internet,&#8221; he said. &#8220;Most of the problems we were having is we were slightly disabling bits of the components of the system. It would not let us disable some things. Things kept getting fixed automatically as soon as we tried to break them. It was weird.&#8221;</p></blockquote>
<p>I&#8217;m not sure what to make of this.  When I first read it, I thought it was a hoax.  But enough others are taking it seriously that I think it&#8217;s a real story.  I don&#8217;t know whether the facts are real, and I haven&#8217;t seen anything about what this malware actually does.</p>
<p><a href="http://boingboing.net/2013/10/31/badbios-airgap-jumping-malwar.html">Other</a> <a href="http://www.reddit.com/r/netsec/comments/1pm66y/meet_badbios_the_mysterious_mac_and_pc_malware/">discussions</a>.</p>
<p>EDITED TO ADD:  <a href="https://news.ycombinator.com/item?id=6654663">More</a> <a href="http://.erratasec.com/2013/10/badbios-features-explained.html">discussions</a>.</p>
<p>EDITED TO ADD (11/14):  A claimed <a href="http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/">debunking</a></p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/airgaps/" rel="tag">airgaps</a>, <a href="https://www.schneier.com/tag/bios/" rel="tag">BIOS</a>, <a href="https://www.schneier.com/tag/computer-security/" rel="tag">computer security</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/rootkits/" rel="tag">rootkits</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html" rel="bookmark">Posted on November 4, 2013 at 6:15 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html#comments">220 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2013/11/badbios.html" data-title="badBIOS" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-209011">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209011">
						November 4, 2013 6:32 AM					</a>

				</p>

				<p>If for real (BIG IF), this smacks of an effort to make PCs/laptops behave much the same as SmartPhones&#8230;that is, tracking devices and data recorders for the massive business &amp; government programs to know everything (Total Information Awareness reprised).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209012">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209012">
						November 4, 2013 6:43 AM					</a>

				</p>

				<p>It&#8217;s unnerving but these days who needs a machine with a loudspeaker?</p>
<p>Would this technique be able to us the upper register from quality earphones to do the same thing?</p>
<p>The day I got my netbook I covered over the inbuilt camera (gimmicky waste of electronics anyway) and bunged the mic-hole up with blu-tack. I&#8217;ve since removed the wireless module (it never worked very well and had a nasty habit of switching itself on under debian even when it was supposedly disabled and my wi-fi hub was off) and use wired links only.</p>
<p>Now with gentoo-hardened on it the memory usage has dropped by 80% and the thing runs like the devil. It was hard work to install and strip down and rebuild the kernel though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209013">

			<div class="comment by-isc ">

				<p class="commentcredit">

					<span class="commenter">ISC</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209013">
						November 4, 2013 6:52 AM					</a>

				</p>

				<p>@kashmarek &#8220;If for real (BIG IF)&#8221;</p>
<p>This IF is no more so big:</p>
<p>an archive with some suspicious files is available, see <a href="https://isc.sans.edu/forums/diary/Happy+Halloween+The+Ghost+Really+May+Be+In+The+Machine/16934" rel="nofollow ugc">https://isc.sans.edu/forums/diary/Happy+Halloween+The+Ghost+Really+May+Be+In+The+Machine/16934</a> :<br />
&#8220;I&#8217;ve uploaded one set of data <em>deleted</em> from a burned forensic cd image here <a href="http://goo.gl/3pQbeZ" rel="nofollow ugc">http://goo.gl/3pQbeZ</a> ; md5 checksum of kit.tgz 7a64f35c2db85cc1f5cc1f5eefebb924e081b &#8211; thanks in advance for any analysis shared back &#8211; filelen 949437030&#8243;<br />
<a href="http://goo.gl/3pQbeZ" rel="nofollow ugc">http://goo.gl/3pQbeZ</a> is <a href="https://mega.co.nz/#!5Rpn3JyC!SEb5vB_KofcMl-vBKMS_j3RBdFlj0ROmFmKt8huNdNk" rel="nofollow ugc">https://mega.co.nz/#!5Rpn3JyC!SEb5vB_KofcMl-vBKMS_j3RBdFlj0ROmFmKt8huNdNk</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209014">

			<div class="comment by-l ">

				<p class="commentcredit">

					<span class="commenter">L</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209014">
						November 4, 2013 7:03 AM					</a>

				</p>

				<p>I don&#8217;t know, sound card drivers are pretty complex, I really can&#8217;t imagine a bios malware that can support many audio cards, and sound transmission is very low bandwidth and highly error prone&#8230;</p>
<p>I still think it&#8217;s a hoax&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209015">

			<div class="comment by-kilian ">

				<p class="commentcredit">

					<span class="commenter">kilian</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209015">
						November 4, 2013 7:06 AM					</a>

				</p>

				<p>Serious IF nonetheless: <a href="http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/" rel="nofollow ugc">http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209016">

			<div class="comment by-eric ">

				<p class="commentcredit">

					<span class="commenter">Eric</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209016">
						November 4, 2013 7:09 AM					</a>

				</p>

				<p>&#8220;It&#8217;s also possible to use high-frequency sounds broadcast over speakers to send network packets. &#8220;.  Highly doubtful as a standard audio speaker, especially a 50 cent PC speaker, has an frequency role off around 10-15Khz.  At and above these frequencies the DB level drops like a rock, so these things are not sending (human) inaudible high frequencies that a 50 cent PC mic could pick up.  To send at a DB level high enough for a cheap PC mic to pick up, it would be in the audible frequency range and one would hear it.  More likely some source has been infected (CD, USB, etc.). What MIT might do with ultrasonic and highly specialized transducers is not the same thing as what a 50 cent consumer PC speaker and 1/4 watt PC amplifier can do.  Period.  A $10 mic, a PC sound card and shareware audio analyzer software is all that is need to prove this one way or another.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209017">

			<div class="comment by-peter-galbavy ">

				<p class="commentcredit">

					<span class="commenter">Peter Galbavy</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209017">
						November 4, 2013 7:12 AM					</a>

				</p>

				<p>How much of a research grant is riding on this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209018">

			<div class="comment by-steinar-h-gunderson ">

				<p class="commentcredit">

					<span class="commenter">Steinar H. Gunderson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209018">
						November 4, 2013 7:20 AM					</a>

				</p>

				<p>Based on my <a href="http://blog.sesse.net/blog/tech/2013-11-02-13-25_badbios_and_ultrasound" rel="nofollow ugc">own practical testing</a> (and, well, a master&#8217;s degree in DSP 🙂 ), I find the ultrasonic claims a bit hard to believe. It <em>is</em> possible, but if so, it&#8217;s a very, very limited channel. Think kilobits/second, probably less in practice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209019">

			<div class="comment by-isc ">

				<p class="commentcredit">

					<span class="commenter">ISC</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209019">
						November 4, 2013 7:22 AM					</a>

				</p>

				<p>@L: &#8220;I really can&#8217;t imagine a bios malware that can support many audio cards&#8221;</p>
<p>The bios malware may just have been used to hide specific files on the USB key, containing the real malware.</p>
<p>@L: &#8220;sound transmission is very low bandwidth and highly error prone&#8230;&#8221;</p>
<p>You seems to have missed previous comment on this blog about it:<br />
<a href="https://www.schneier.com/blog/archives/2013/11/friday_squid_bl_398.html#c2151406" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/11/friday_squid_bl_398.html#c2151406</a><br />
<a href="https://www.schneier.com/blog/archives/2013/11/friday_squid_bl_398.html#c2147603" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/11/friday_squid_bl_398.html#c2147603</a></p>
<p>In short: there is a program transmitting at 500 baud with a simple protocol which is audible.</p>
<p>Hence 50 baud shoud be easy to do in audible frequency but at the level of fan noise of the computer, with better spread-spectrum protocols, for NSA with big money.</p>
<p>@Steinar H. Gunderson: &#8220;Think kilobits/second, probably less in practice.&#8221;</p>
<p>It basically means you can transfer one megabyte in one or two hours.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209020">

			<div class="comment by-carl-sai-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Carl &#039;SAI&#039; Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209020">
						November 4, 2013 7:28 AM					</a>

				</p>

				<p>Really, to me I don&#8217;t think the sound thing is likely. For one, normal laptop audio components don&#8217;t work at any significant volume in the ultrasonic. The -3dB cutoff frequency for most laptop speakers is 18-20kHz, and for most mics is somewhere in the 10-15kHz range. So he should test with the laptops on opposite sides of the room, since the inverse square law would ensure any output from one would be undetectable by the other.<br />
For another, he has no data, just speculation. It&#8217;s not that hard to get an ultrasonic mic and an oscilloscope to check. A used analog scope would be fine, those can be found for under $50, and the mics aren&#8217;t that much either.</p>
<p>I&#8217;d bet it&#8217;s something infecting a disk controller. He seems to be using Apple gear, there aren&#8217;t that many drives used by Apple laptops. The disk controllers often have rather good computing capability of their own.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209021">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter">Andrew Wallace</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209021">
						November 4, 2013 7:50 AM					</a>

				</p>

				<p>Even if a hoax it is technically possible to achieve and the idea is now &#8216;out there&#8217; for people to copy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209022">

			<div class="comment by-flatpepsi ">

				<p class="commentcredit">

					<span class="commenter">FlatPepsi</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209022">
						November 4, 2013 8:01 AM					</a>

				</p>

				<p>If I&#8217;m reading the article right, he&#8217;s claiming an uninfected laptop can be infected via sound, when it&#8217;s air-gapped.</p>
<p>If that&#8217;s what he&#8217;s claiming, then I call shenanigans.</p>
<p>More likely he&#8217;s run into a rather well written root-kit- and his wipe &amp; rebuild process isn&#8217;t clearing the original infection.</p>
<p>Now, can 2 laptop communicate via sound? Sure, most of us old timers call that dial-up access.  Can a typical laptop speaker put out enough volume just off the edge of hearing range to be useful? Possibly. Desktops would have a better shot.</p>
<p>Does sound like something NSA would look into.  Without the mal-ware &#8220;drivers&#8221; to receive the sounds, it&#8217;s just noise to uninfected computers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209023">

			<div class="comment by-uhu ">

				<p class="commentcredit">

					<span class="commenter">Uhu</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209023">
						November 4, 2013 8:04 AM					</a>

				</p>

				<p>From what I read so far I have to assume it is a hoax. In particular, I don&#8217;t like how he simply states that he has seen data transmission without explaining how he has seen that. Does the OS report a network device in spite of him removing all network devices? If so, what kind of network device is shown? If not, how would he see that data is exchanged? Simply saying that &#8220;I removed all network devices and it sill transmits data&#8221; is lacking too much technical details. We also need an independent review (somebody who is able to reproduce the problems).</p>
<p>Here are the key points as I see them:</p>
<ul>
<li>
<p>Ultrasound communication:<br />
Seem to be theoretically possible but probably extremely low bandwidth, could be done in audible sound hidden as noise. Nobody claims the infection happens through sound, only that infected machines can communicate. It is unclear how he saw data being exchanged. Wouldn&#8217;t he need to see some network device? And if so, what kind of network device was shown? Or how else does he know data was exchanged? What is the observed bandwidth?</p>
</li>
<li>
<p>BIOS reflashed<br />
The BIOS will check hardware extensions (e.g. PCI cards) for additional drivers to load. So it&#8217;s possible the malware hides in other places and still gets loaded on system start-up.</p>
</li>
<li>
<p>Drivers for diverse hardware<br />
The malware could download custom modules for a specific infected machine. So while the module installed in the BIOS (or some BIOS extension) might not have enough space to hold a multitude of different soundcard drivers, it is possible that the malware downloads a specific module for the given infected system.</p>
</li>
<li>
<p>404 from infected machines on web sites discussion reflashing of flash disk controllers<br />
If this is indeed the case, it should be possible to compare the exact request sent by the infected machine and compare it to a similar but clean machine to see the differences to find out how the server could identify infected machines (would be extremely useful). Or is it the infected OS that intercepts access to these sites? And if so, how does it identify hosts to censor?</p>
</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209024">

			<div class="comment by-steve-szmidt ">

				<p class="commentcredit">

					<span class="commenter">Steve Szmidt</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209024">
						November 4, 2013 8:09 AM					</a>

				</p>

				<p>Here&#8217;s why I don&#8217;t buy into it. It&#8217;s one thing to make a piezo element be a speaker and a microphone. Pretty much as to as normal speaker drivers don&#8217;t do too well exceeding the audible range of our hearing.</p>
<p>It is a completely different story to have a computer that actually does anything hearing it. In other words what computer do you know of which is modified to pick up on not just ultra sound, but any sound, and do something based on what it hears? (True, some of our cell phones are able to listen to certain instructions and perform exact actions based on it. But that is not even what these multiple computers with different O/S&#8217;s have.)</p>
<p>Then not only doing something but actually taking action following arbitrary instruction that is the makeup of a computer program.</p>
<p>On top of that it is also supposed to work across different manufacturers hardware, BIOS and finally different O/S&#8217;s.</p>
<p>Not a chance, not one iota.</p>
<p>Sure, one could create the condition where one computer listens to sound and then not only do predetermined actions but actually be programmable meaning knowing a language, however crude&#8230; How far off base are we by now? With that I mean what general use computers can do any of that?</p>
<p>Sorry but as far as I&#8217;m concerned this is simply another &#8220;chain mail&#8221; that apparently some are buying into.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209025">

			<div class="comment by-mario-vilas ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://breakingcode.wordpress.com/' rel='external nofollow ugc' class='url'>Mario Vilas</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209025">
						November 4, 2013 8:12 AM					</a>

				</p>

				<p>&#8220;If I&#8217;m reading the article right, he&#8217;s claiming an uninfected laptop can be infected via sound, when it&#8217;s air-gapped.&#8221;</p>
<p>I don&#8217;t see where that claim is made&#8230; what I read was that two infected machines were connected to each other even when airgapped, while the infection occurs via a USB key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209026">

			<div class="comment by-mario-vilas ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://breakingcode.wordpress.com/' rel='external nofollow ugc' class='url'>Mario Vilas</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209026">
						November 4, 2013 8:19 AM					</a>

				</p>

				<p>&#8220;In other words what computer do you know of which is modified to pick up on not just ultra sound, but any sound, and do something based on what it hears?&#8221;</p>
<p>A colleague (capi_x) and I tried transmitting ultrasound between two Apple notebook computers as a proof of concept and it worked &#8211; the speakers were able to send ultrasounds and the mic was able to receive it.</p>
<p>However in our tests the actual frequency range we could use was rather limited (the speakers could emit sound in higher frequencies than the mic was able to hear), and for some reason when we tried it on Windows the sound card kept giving us some weird audible clicks (same hardware &#8211; seemed to be an issue with the Windows sound system).</p>
<p>Note that we didn&#8217;t implement a protocol on top of that, we just tested sound emission and reception. I&#8217;ve no idea how much bandwidth you&#8217;d get. But given the huge amount of radio and modem protocols out there, it may just be a matter of being clever enough&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209027">

			<div class="comment by-g0n ">

				<p class="commentcredit">

					<span class="commenter">g0n</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209027">
						November 4, 2013 8:26 AM					</a>

				</p>

				<p>To reiterate the last poster (I think his most crucial point gets lost):</p>
<p>&#8220;Ruiu said he arrived at the theory about badBIOS&#8217;s high-frequency networking capability after observing encrypted data packets being sent to and from an infected laptop that had no obvious network connection with—but was in close proximity to—another badBIOS-infected computer.&#8221;</p>
<p>Observed where? If there&#8217;s an interface to monitor packets on, you&#8217;ve pretty much figured out what&#8217;s going on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209028">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209028">
						November 4, 2013 8:28 AM					</a>

				</p>

				<p>@Steinar H. Gunderson: &#8220;Think kilobits/second, probably less in practice.&#8221;</p>
<p>There are only a few reasons to build  an air-gapped system, and less reasons to specifically attack them (stuxnet leaps to mind).  One issue is that the virus is unlikely to determine which data is &#8220;the good stuff&#8221;.  My guess is that it could very well be designed to simply steal key data and nothing else: this goes deep into the issue of just how bad audio communications over PCs can be (ignoring the obvious fact that many new computers are laptops with built-in microphones.  Badbios may be banking on this).  Key theft could reasonably use .01bps rates and still do its job (and grabbing the ciphertext is typically assumed to be a piece of cake).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209029">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter">Andrew Wallace</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209029">
						November 4, 2013 8:32 AM					</a>

				</p>

				<p>FlatPepsi,</p>
<p>The ultrasonic high-frequency is a covert command and control channel after infection has taken place via USB.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209030">

			<div class="comment by-erik-v-olson ">

				<p class="commentcredit">

					<span class="commenter">Erik V. Olson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209030">
						November 4, 2013 8:46 AM					</a>

				</p>

				<p>&#8220;Highly doubtful as a standard audio speaker, especially a 50 cent PC speaker, has an frequency role off around 10-15Khz.&#8221;</p>
<p>Modern day laptops have much better speakers and mics. Most people can&#8217;t hear much above 12Khz, and a really smart implementation would listen, wait for a very quite period, then transmit. Heck, rattle the hard drive hard at the same time, or spin up the fans to add some background noise. You could probably use 15Khz up to cutoff without very many people noticing anything. Of course, if there&#8217;s an old-school CRT in the room, that&#8217;ll wipe that out, you&#8217;ll have to shift to above the flyback transformer&#8217;s frequency.</p>
<p>I&#8217;ll bet this is a lot easier on Apple gear. Since Apple gear is so popular with musicians, there&#8217;s been a lot of encouragement from the user base for clean audio through the system. Plus, you have fewer hardware/OS combinations to worry about. But I&#8217;d think any modern (say, 3 years or newer) laptop or desktop would have good enough speakers and microphones built in. The all-in-ones would be better, because the speakers-mics would be up on the desk.</p>
<p>Of course, anybody doing video chats who has better speakers and mics installed has made things easier for this.</p>
<p>I don&#8217;t think you&#8217;d get fast &#8212; but if you could maintain, say, a 300-1200 baud link, you could move sensitive info in/out, if you could get to the 19200bps level, using phase shift keying, then you have a workable link for TCP.</p>
<p>An ideal implementation would have some means of exploring the audio space, much like modems do, to find what part of the band a give pair of speakers/mics can use, and just how clever a modulation scheme you can get away with. But having seen some of the stuff that amateur radio has come up with in the slow signal through noise* and signal through extremely constrained bandwidth**, there&#8217;s no doubt in my mind that it&#8217;s theoretical possibly.</p>
<p>The practical implementation issues are legion, though.</p>
<p>Part of me wonders, though, if a better implementation would be a burst mode &#8212; listen for very quiet, then burst data, listen, repeat until background comes up. Risky, but higher bandwidth. The story here implies that isn&#8217;t the case here &#8212; they were actively present, seeing data move.</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/WSJT_(Amateur_radio_software)" rel="nofollow ugc">http://en.wikipedia.org/wiki/WSJT_(Amateur_radio_software)</a>, esp JT65</li>
</ul>
<p>** <a href="http://en.wikipedia.org/wiki/PSK31" rel="nofollow ugc">http://en.wikipedia.org/wiki/PSK31</a>, 31 baud in 31.5hz bandwidth, with good frequency control, you can carry out 20 conversations in 2.5Khz, easy. There are variations that move more data more bandwidth, but something like Q15X25, which uses 15 QPSK carriers at 125Hz bandwidth, each giving 83.32Hz, and the system testing to see how many carriers it can support, is probably the fastest way to implement packets over a system like this.</p>
<p><a href="http://en.wikipedia.org/wiki/Q15X25" rel="nofollow ugc">http://en.wikipedia.org/wiki/Q15X25</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209031">

			<div class="comment by-vinzent ">

				<p class="commentcredit">

					<span class="commenter">Vinzent</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209031">
						November 4, 2013 8:49 AM					</a>

				</p>

				<p>Each one of the claims made are <em>theoretically</em> possible, yes. If it came from any other guy I&#8217;d call bullshit, but he&#8217;s a well-known researcher in the field, not just some crackpot who tries to get a name for himself, so honestly &#8212; I don&#8217;t know what to make of it.</p>
<p>Currently, I still don&#8217;t buy it. Then again, maybe my personal paranoia level is just not high enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209032">

			<div class="comment by-jay ">

				<p class="commentcredit">

					<span class="commenter">jay</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209032">
						November 4, 2013 8:52 AM					</a>

				</p>

				<p>No one seems to have commented that this article is dated October 31, 2013. &#8230;</p>
<p>Fascinating but extremely unlikely as a general attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209033">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209033">
						November 4, 2013 8:52 AM					</a>

				</p>

				<p>Repost from the air gap discussion, seems relevant to this article:</p>
<p>patricia • October 12, 2013 12:59 AM</p>
<p>The properties of my airgap system:</p>
<ol>
<li>It is inexpensive.</li>
<li>It is not require much technical know how (not reverse engineering your BIOS to verify its integrity or trying to debug rootkits).</li>
<li>The overhead involved is scalable to the amount of security required. That is, many shortcuts can be taken without weakening the overall system.</li>
<li>It is an unambiguous set of steps that don&#8217;t require judgment to be performed.</li>
<li>It is fault tolerant (many components can get pwned, and it still is very secure).</li>
<li>It is effective against a variety of threat models, up to and including a nation-state which has full knowledge of your setup, a team of hackers working to pwn you individually, and a black bag team that can enter your home without your knowledge.</li>
</ol>
<p>Let&#8217;s call our adversary Eve. I believe unless Eve can bring to bear the resources described in item 6, your setup is perfectly secure. Any feedback on the protocol I describe would be appreciated.</p>
<p>The threat models we will consider:</p>
<ol>
<li>A targeted attack in which the Eve has perfect knowledge of your setup and unlimited resources to craft an attack over the internet.</li>
<li>Same as 1, but they will attack using malware which infects your hardware (BIOS, NIC, etc.) before you purchase it (the supply chain attack).</li>
<li>Side channel attacks</li>
<li>Black bag/ physical access to your home and computers.</li>
<li>
<p>Untargeted attacks</p>
</li>
</ol>
<p>I assume the reader can acquired uninfected software. One method for doing this is documented on the TOR website. The basic idea is to download from multiple sources, from multiple internet connects, compare the hashes, and verify downloads with PGP signatures.</p>
<p>Here&#8217;s the setup:</p>
<p>The first computer (which I&#8217;ll call CannonFodder) connects to the internet via TOR, ideally with PORTAL between the computer and the internet. PORTAL is the grugq&#8217;s open source project which installs on Raspberry Pi and acts like a proxy forwarding all your traffic to TOR. Recently a hidden service was discovered on TOR which hacks the browser and phones home through the user&#8217;s non-TOR internet connection the actual IP address and MAC address of the user. PORTAL prevents this attack by only allowing traffic to route through TOR, and blocking any other traffic.</p>
<p>The purpose of CannonFodder is to receive PGP encrypted messages and send PGP encrypted messages. It&#8217;s what connects to the internet so the rest of the equipment doesn&#8217;t have to. While it will be assumed to be hacked into and rootkit&#8217;ed, it is not going to be an easy target.</p>
<p>On CannonFodder install whatever personal security products you can get your hands on. Anti-virus, anti-persistence software, software that whitelists good processes and blacklists bad processes, EMIT&#8230; anything and everything possible. Make sure the OS and all software on it is patched regularly. What OS runs on the host is up to you. The host will run a VM and nothing else. What virtualization software you use is up to you, but the OS you run in the VM should be different from the host. So if the host is windows, the VM should be some flavor of linux or BSD.</p>
<p>The VM is going to run another VM. That VM will be a third OS, different from the other two. It&#8217;s only job is to run a browser that can connect to TOR. Whether that means the TOR browser bundle, or Chrome connecting through PORTAL, it is up to you. Chrome is a good choice, since it auto-updates itself, making patching mindless. Once the VMs are set up, snapshot them. After every use, revert to the most recent snapshot. When new patches become available, revert the VMs, apply the patches, and take a new snapshot.</p>
<p>Make sure the browser has NoScript installed (meaning no javascript). Do not whitelist any websites in NoScript. Make sure the browser has no plugins installed besides NoScript. That means no Java, no silverlight, and certainly no flash.</p>
<p>The idea of all of this is if someone tries to exploit your browser, they might not get a rootkit on your host, because Eve may not have realized you are in a VM, and therefore might not be prepared to escape your VM. She may not even have a VM escape. If she does, she will still need to have a variety of exploits and be willing to use them against you. She may be unwilling because you are not a noob, a complicated setup like your&#8217;s could trip up her exploits, and maybe expose them in a way that you can steal them. Think about it: Eve needs VM escapes for two different pieces of software, code that can run in all flavors of Linux, Windows, and BSD, possibly privilege escalations for each of those OS&#8217;s, and most likely the ability to navigate PORTAL before phoning home. You are a complicated target relative to most people on the internet. Patched software ensures Eve must throw 0day at you. Personal security products can trip up her exploits or mean she&#8217;ll have to invest even more individual attention in crafting exploits that sidestep your protections.</p>
<p>If CannonFodder is running on Sparc or MIPS or ARM, even more bonus points, because now even fewer people have the expertise required exploit and rootkit you.</p>
<p>CannonFodder is only used for visiting email, saving email, sending email, and burning CDs. No other browsing is allowed. A different email account is used for every different pen pal. In between logging into each email account, a new TOR identity is generated&#8211; in the TOR browser bundle just click the generate new identity, using PORTAL it is a little more complicated. Messages should move from public email addresses tied to real identities to burner email accounts as quickly as possible. You should register a new email address for each new pen pal you correspond with. The email address should have no information that ties your real identity or your pen pal&#8217;s real identity to the address.</p>
<p>CannonFodder can either be a laptop (which has had the camera removed, the mic destroyed, etc.) or a desktop. A laptop has the advantage that you can take it to different restaurants and connect to a different wifi access points every time CannonFodder connects to the internet. A desktop has the advantage of convenience (driving to a new access point every time you want to send an email eats up a lot of time). The downside to the laptop is other users of the wifi access point can attack your laptop. The downside to the desktop is your IP address is easy to obtain from your internet company, and with your IP address it is not far fetched that Eve can hack your router, and then your desktop.</p>
<p>Every day (or every other day, or every week) check the email accounts. Each email account gets its own CD. Any messages received from Alice are burned to CD A, any messages received from Bob are burned to a separate CD B, and so on.</p>
<p>By using TOR, not browsing the internet, and using random email accounts the hope is that you will be harder identify as someone to target and harder to locate once you are targeted. The VMs and other mitigations will ideally tip you off once you are targeted since your unusual setup could cause their attack to fail in a loud way. Even if it doesn&#8217;t tip you off, it may be effective in preventing your computer from being rootkit&#8217;ed indefinitely, since Eve may not have the techniques readily available to breakout of your VMs.</p>
<p>Even given all these precautions, we will always assume CannonFodder is owned and has a rootkit which is recording every keystroke, the MAC addresses of all wifi access points in proximity, and whatever other information your computer might be privy to.</p>
<p>Now for the airgap. The second computer, which I&#8217;ll call IvoryTower, is air gapped. If the only secrets you are trying to hide are your private PGP keys, the cleartext of your messages, and the cleartext of your pen pals&#8221; messages, IvoryTower should be a raspberry Pi with a USB CD (read-write) drive. If you also want to read PDFs, I&#8217;m unsure if a raspberry pi can handle this, so you might have to use a desktop. The raspberry pi has several advantages when it comes to side channel attacks and black bag attacks. We&#8217;ll discuss these later. It also has the advantage of being ARM architecture instead of x86 and x64. The architecture matters because in depth knowledge of x86 and x64 are much more abundant than knowledge of ARM. You increase the cost of attacking you by using a more unusual architecture.</p>
<p>IvoryTower is our most privileged machine, because private keys are used to decrypt messages on it. If we can prevent it from being rootkit&#8217;ed, our secrets are safe (except from black bags, more on this later). However, we should always assume IvoryTower is pwned and take steps to guarantee none of the secrets it protects leak onto CannonFodder and from there onto the internet.</p>
<p>Backing up for a moment, IvoryTower is where the PGP keys you use to correspond with your pen pals&#8217; are generated. The first day IvoryTower is set up, when it has the lowest likelihood of being rootkit&#8217;ed, generate a ton of PGP key pairs and burn them to CDs. If you are very security conscious, IvoryTower should be shutdown in between each key you generate. This is to clear the RAM of the device (always use an OS which overwrites RAM at shutdown). Many rootkits can&#8217;t survive a reboot. A shutdown could clean the machine. If a rootkit does infect the computer, and private key material from other pen pals is still in memory, the malware can compromise more of your private keys than it would have been able to otherwise.</p>
<p>If IvoryTower is a desktop, it should have no hard drive, and it should boot from a live CD in a CD-ROM (no write) drive. The CD containing the new messages from Alice can be put in a separate CD drive. When the encrypted messages are copied to the desktop, they will be put in RAM on the device. Insert the CD containing the private key corresponding to the public key you gave to Alice, and decrypt the messages. Read then, then reboot. Write a new message to Alice, encrypt it with her public key. You can retrieve her public key either from the same CD that holds the private key you use to communicate with her, or by requesting she append it to the messages she sends. Burn your encrypted message to a new CD, and destroy the CD that transfered Alice&#8217;s messages from CannonFodder to IvoryTower.</p>
<p>Part of Alice&#8217;s message should be a new email address she created just to receive your next message. Similarly, your new message to her should contain the email address you&#8217;ve registered to receive her next reply. In the message you are sending should be an email address that they can send their next message to. This protocol, of always sending to a new email address, means Eve has fewer selectors to key in on when she taps the internet backbone, and she can&#8217;t use your old email address as a selector to serve an exploit to you when you visit the old email account. If she gets your key, the messages are not all aggregated in one place for her to decrypt. Since the next email address is encrypted in each message, she will not know the next place a message is being sent.</p>
<p>Now for a trick. Write down the exact size (in bytes) of the encrypted message that is destined for Alice. Open the encrypted message in a hex editor (still on IvoryTower). Write down the first 5 bytes of the file. Write down the last 5 bytes. Pick a random offset (or 2 or 10) and write down 5 bytes there along with the offset. Reboot.</p>
<p>Repeat the procedure on IvoryTower for every correspondence that sent you a new message.</p>
<p>Now another trick. Using a public-key/private-key pair you&#8217;ve kept reserved for testing purposes, encrypt a fake message. If can say anything, just make sure you&#8217;ll recognize your fake message when you decrypt it (more about this later).</p>
<p>You have destroyed the CDs with the messages your pen pals&#8217; sent you, you have a bunch of CDs with messages you&#8217;d like to send on CannonFodder, and you recorded some metadata about each of the encrypted messages (i.e., filesize, the first five bytes).</p>
<p>We have now reached the most dangerous part of the process, because if IvoryTower is rootkit&#8217;ed, any of the CDs could contain information about your secret key, information about the cleartext of your message or your pen pals&#8221; messages. For example, if GPG on IvoryTower has been subverted by malware, the malware could have used the Eve&#8217;s key to encrypt your message instead of Alice&#8217;s public key. Then, when you transfer the message to CannonFodder, malware on that system could use Eve&#8217;s private key to decrypt the message, send it to Eve, and re-encrypt the message with Alice&#8217;s public key. You would have not idea you were compromised, because from your perspective Alice got the message OK.</p>
<p>To guard against this, we have a third computer, which I&#8217;ll call DoubtingThomas. This is the one computer who&#8217;s integrity is important. Luckily, it too can get rootkit&#8217;ed, as long as it is rootkit&#8217;ed by an untargeted attack. If Eve and her minions target yo and get on DoubtingThomas, you&#8217;re in trouble.</p>
<p>DoubtingThomas is a raspberry pi. This is a nice choice because it can be physically hidden, making physical tampering by a black bag team more difficult. It also uses much less power than a desktop, meaning many side channel attacks don&#8217;t apply. Also, electronic devices (bugs) that could be hidden on a desktop computer&#8217;s motherboard or PCI peripherals stand out much more on a raspberry pi.</p>
<p>The most important thing about DoubtingThomas is simplicity. We want very little surface area on DoubtingThomas. IvoryTower runs a full fledged OS with lots of code and lots of surface area, making it easier to own. DoubtingThomas, however, just needs to have a hex editor, GPG, and the ability to read from a CD. Ideally the CD has filesystem, since a filesystem is more surface area for an exploit, so a raw filesystem that can be read with would work well, especially if that meant &#8216;dd /dev/[cdrom]&#8217; would have identical output to the encrypted blob IvoryTower produced.</p>
<p>DT has a CD-ROM (no write) drive connected by usb so it needs a USB driver as well. The OS on DoubtingThomas would be custom coded to be minimal and only have what is needed for this task. On DT we open the encrypted messages from IT in a hex editor so you can visually inspect the file is unchanged since being on IT. It is important also verify that the file size is the same, and that the rest of the disk is empty.</p>
<p>What does this buy you? If the hex editor on DoubtingThomas shows the same values as the hex editor on IvoryTower, you know you can trust IvoryTower&#8217;s hex editor and burner. However, you cannot know for sure what key actually encrypted the message. Eve could easily have encrypted the payload if she was on IT and subverted GPG. Basically, you can trust the burning software and the hex editor, but you still don&#8217;t know if you can trust the install of GPG on IT.</p>
<p>This is where the message you encrypted with a public key for which you have the private key comes in. Decrypt it on IvoryTower, and if it decrypts correctly, you know you can trust GPG on IvoryTower. Why? Because if malware has subverted GPG on IvoryTower the fake message won&#8217;t decrypt correctly. If your message is encrypted with the Eve&#8217;s key, there&#8217;s no way to tell just by looking at the encrypted file.</p>
<p>After the test on DoubtingThomas, you know you can safely put the CDs in CannonFodder, and email your messages to your pen pals&#8217;.</p>
<p>That&#8217;s the procedure, now how does it stand up to our threats, and are there any other things we can do to make it even more secure?</p>
<p>1) Attack from the internet.</p>
<p>If CannonFodder is pwned, when you burn a CD of messages addressed to you, an filesystem exploit or an exploit that targets any of the other code that is required to read from a CD could be burned to the CD too. This is the only way IvoryTower can be rootkit&#8217;ed if Eve limits herself to attacking over the internet. If IvoryTower is rootkit&#8217;ed, you can&#8217;t trust the output of any of the software on that system. IvoryTower could:</p>
<p>a) encrypt with the Eve&#8217;s public key when it says it&#8217;s encrypting with Alice&#8217;s public key (they get cleartext of your message to Alice)<br />
b) append your private key, encrypt with the Eve&#8217;s public key (they get your private key for corresponding with Alice, and your message to Alice).<br />
c) Write your private key and any cleartext left in RAM to slack space on the CD.</p>
<p>DoubtingThomas verifies the work of IvoryTower as described earlier. However, there are ways malware could get around this. The first that comes to mind is maintaining a whitelist of keys that it will subvert and your fake key is not on the list. But that would be so targeted, and require such perfect knowledge it&#8217;s not believable.</p>
<p>Make sure to generate plenty of private keys as soon as you get IvoryTower setup. Once it&#8217;s subverted it could be generating weak keys. Also register lots of email accounts on CannonFodder.</p>
<p>2 and 3) Your equipment was pre-pwned with BIOS malware before you bought it and side channel attacks</p>
<p>This would have to be general purpose malware that didn&#8217;t target you specifically (because you were careful enough to buy hardware in person from a big store and not online with your credit card, where it could be messed with in a targeted way). There are a couple threats here. The first is that IvoryTower&#8217;s key generation is weakened. This is a serious flaw that I don&#8217;t know a good way around. The second is the computer is modified to transmit data through side channels. So, for example, it flickers the screen at a frequency imperceptible to the human eye, and it just scans through RAM constantly doing this, so that a sensor picking up the flickers would have a dump of RAM. Or it scans through RAM and modifies the power unit to transmit data (using the power cord to create an antenna, or to communicate with another device on the same power circuit, perhaps CannonFodder). Or it blinks an LED faster than humanly perceptible. Or it uses the wire that wraps around the perimeter of the monitor that connects to the LED and forms an antenna to ex-filtrate data. Or it produces auditory signals by the making the processor hum. It can control the frequency of the hum with the type of operation it has it do. Or Eve uses Van Eck Phreaking to reconstruct your monitor display by the radiation it gives off.</p>
<p>Side channel attacks are real. They are very hard to defend against. On the positive side, I assume they are expensive to deploy. But since our assumption is we must be resistant to expensive attacks, we must consider side channel attacks.</p>
<p>First I&#8217;ll point out that the only computer in our setup that must be resistant to a side channel attack is IvoryTower. If IvoryTower is a raspberry pi, it draws such little power that the power cord attack is not feasible. Any form of radiation attack (the antennas, Van Eck phreaking) can be mitigated by only running IvoryTower in a local restaurant&#8217;s walk-in freezer (the poor man&#8217;s faraday cage). A Raspberry Pi is portable enough to take to a walking freezer. For Eve to pull off the visual and auditory based attacks she presumably requires a black bag team to place sensors in your workspace (more on this in a minute), but a raspberry pi based system could be set up in a different location every time you use it (meaning it&#8217;s much harder to &#8216;bug&#8217; in this way).</p>
<p>Note that the cords for keyboards and mice should have shielded cabling. Every cord in your setup for IvoryTower should. Peripherals should never be shared amongst computers since they could be infected with malware.</p>
<p>All LEDs should be disabled in all your computers/ monitors/ peripherals by digging out the LED.</p>
<p>4) Blackbag team visits your house while you aren&#8217;t there</p>
<p>You are going to have to have a good place to stash the CDs containing your private keys as well are your raspberry pi(s). They are the prize you are trying to defend.</p>
<p>One threat is Eve&#8217;s henchmen break into your house and replace your keyboard with a duplicate that has a key logger, or that infects your device with malware when you plug it in. For this reason, put distinctive scratches into all your peripherals, take a photo, and regularly check that the scratches are identical to the photo. This is how weapons inspectors ensure the seals protecting weapons caches have not been tampered with. The seals are scratched in a distinctive way that can&#8217;t be forged, then check periodically. Use tamper evident tape on your devices to slow down a burglar that wants to plant a keylogger in your keyboard.</p>
<p>If IvoryTower is infected in its BIOS and it is capable of stashing private keys (in the BIOS or in the firmware of PCI peripherals on the system), then a black bag team could get your keys this way. This is another argument for IvoryTower being a raspberry pi and being stashed somewhere. If IvoryTower is hidden and the burglar can&#8217;t find it, they can pull the private keys from the BIOS. On a desktop, the fewer PCI peripherals, the less space the malware has to stash keys if it is in fact using this strategy. So make sure you have no PCI peripherals. If you have a desktop, put super glue in all the USB interfaces so they aren&#8217;t functional. Do the same to any interface on the mother boards that could attach removable media. Try to make the case impossible to open (bonus points for encasing it in cement except for the fan, CD tray, cables for keyboard/mouse, power cable and power button). Your attack surface for a burglar becomes what they can modify with a liveCD and maybe the drivers that handle input from your monitor (minimal).</p>
<p>5) Other threats<br />
Most other threats won&#8217;t get past your browser, because it&#8217;s fully patched, and it they do, they&#8217;ll be destroyed by reverting your VM.</p>
<p>Questions:</p>
<p>Is it easier to verify raspberry pi&#8217;s embedded code than a desktop&#8217;s BIOS?</p>
<p>What if IvoryTower is pwned before you buy it and produces weak PGP keys?</p>
<p>What to put for full name, email address in PGP key?</p>
<p>How long should keys stay valid for?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209034">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209034">
						November 4, 2013 8:54 AM					</a>

				</p>

				<p>For the people messing around with recreating this method of communication, the ham radio guys have developed software that implements low bandwidth modulation schemes specifically optimized for work with for very weak signals (link -&gt; <a href="http://en.wikipedia.org/wiki/WSJT_%28Amateur_radio_software%29" rel="nofollow ugc">WSJT</a>)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209035">

			<div class="comment by-ts ">

				<p class="commentcredit">

					<span class="commenter">TS</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209035">
						November 4, 2013 8:55 AM					</a>

				</p>

				<p>I&#8217;d presume the hack is driving the hardware directly, not going through the OS. Thus there might not be any tell with Windows audio.</p>
<p>The audio doesn&#8217;t need to be reliable enough to send data&#8230; the presence of the audio itself could be the data, ie Morse Code. Low bandwidth for sure, but if the malware is sitting for weeks without being detected, it could still be transmitting a lot of data.</p>
<p>As for &#8220;diverse hardware&#8221;, yeah, you&#8217;ll have problems trying to infect the US public, with dozens of hardware vendors. On the other hand, the devices used in the places this malware was (most likely) written to infect (Iranian nuclear facilities?) are limited and probably well known to the authors and thus you wouldn&#8217;t need a huge library of driver hacks.</p>
<p>I&#8217;d guess accidental release, maybe a programmer made a mistake and ended up carrying the malware out on a USB stick.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209036">

			<div class="comment by-muddy-road ">

				<p class="commentcredit">

					<span class="commenter">Muddy Road</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209036">
						November 4, 2013 8:57 AM					</a>

				</p>

				<p>Sounds like a plot from a Halloween movie. Put the &#8216;puter in the freezer. Freezing cold  does in quite a few zombies.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209037">

			<div class="comment by-jackson ">

				<p class="commentcredit">

					<span class="commenter">jackson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209037">
						November 4, 2013 9:11 AM					</a>

				</p>

				<p>“Outrageous,” is how Google’s Executive Chairman and former CEO Eric Schmidt described allegations about NSA spying on its data centers.</p>
<p>HA HA HA &#8211; Hey, if you&#8217;re doing something you need to hide it&#8217;s probably illegal. Right???</p>
<p>IT&#8217;S A HOAX! You can&#8217;t use the speaker and mic on a computer as a side-channel! I took some classes at the SANS Institute and they never told me about this so it can&#8217;t be true. And all this nonsense about the Earth spinning in space is ludicrous. Everyone knows this is impossible. People and things would just go flying off into space, and the wind would be so terrific you couldn&#8217;t even stand up. What a preposterous idea.</p>
<p>Oh, wait &#8230; they said this was impossible, too&#8230; until it wasn&#8217;t.<br />
<a href="http://www.cs.berkeley.edu/~tygar/papers/Keyboard_Acoustic_Emanations_Revisited/tiss.preprint.pdf" rel="nofollow ugc">http://www.cs.berkeley.edu/~tygar/papers/Keyboard_Acoustic_Emanations_Revisited/tiss.preprint.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209038">

			<div class="comment by-alan ">

				<p class="commentcredit">

					<span class="commenter">Alan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209038">
						November 4, 2013 9:16 AM					</a>

				</p>

				<p>Maybe badBIOS installs something so that two INFECTED computers are able to communicate via their sound cards.  I would be very surprised if an uninfected computer could be infected only via its sound card, but stranger things have happened.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209039">

			<div class="comment by-jones ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://telesio.wordpress.com' rel='external nofollow ugc' class='url'>jones</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209039">
						November 4, 2013 9:17 AM					</a>

				</p>

				<p>56k modems worked over a landline with a bandwidth of about 4 khz.</p>
<p>High frequency sound transmitted over a computer speaker may not be ultrasonic, but with the much wider bandwidth a soundcard provides (relative to a phone line),  I imagine a decent throughput could be achieved through intermittent (and thus, less noticeable) transmissions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209040">

			<div class="comment by-jones ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://telesio.wordpress.com' rel='external nofollow ugc' class='url'>jones</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209040">
						November 4, 2013 9:22 AM					</a>

				</p>

				<p>P.S.</p>
<p>Assuming a computer speaker can reproduce CD-quality sound, that gives a bandwidth of 22 khz (for a CD&#8217;s Nyquist frequency of 44.1 khz) &#8212; quite a lot compared to the 4 khz channel of a landline.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209041">

			<div class="comment by-jones ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://telesio.wordpress.com' rel='external nofollow ugc' class='url'>jones</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209041">
						November 4, 2013 9:24 AM					</a>

				</p>

				<p>P.P.S.</p>
<p>Sorry, that should be &#8220;sampling rate&#8221; not &#8220;nyquist frequency&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209042">

			<div class="comment by-mirar ">

				<p class="commentcredit">

					<span class="commenter">Mirar</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209042">
						November 4, 2013 9:33 AM					</a>

				</p>

				<p>Isn&#8217;t it written: There is much going on that we don&#8217;t know about.</p>
<p>I find the techniques visited plausible, but some of the sign implausible. It might be possible to use hardware with it&#8217;s own flashrom for firmware to hide the malware, for instance audio- or network cards. (I don&#8217;t know.) It might be possible to control the audio circuits from another hardware/firmware on the PCI bus than the CPU. (I don&#8217;t know.) Out-of-band audio at 20kHz might not be filtered enough and still be useful to send and receive. (Implausible, but maybe not impossible.)</p>
<p>But:</p>
<p>Why would you disable &#8220;search&#8221; in &#8220;regedit&#8221; rather than just hiding things?</p>
<p>Why would data transmitted over audio go into the normal network stack and be visible?</p>
<p>I find this malware both too visible and too invisible at the same time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209043">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209043">
						November 4, 2013 9:37 AM					</a>

				</p>

				<p>@Nicholas Weaver<br />
A black bag team will install cameras and microphones. That will handle the secret hiding places.</p>
<p>I suspect that if you really are targeted by a big-budget antagonist, you are borked. You will have to model limitations for your opponents.</p>
<p>FYI, there was story by Isaac Asimov, in his a rather lame &#8220;Tales of the Black Widowers&#8221; series, where exactly such a situation was brought up in a pre-network situation.</p>
<p>The target in question was under the most heavy surveillance but still able to communicate across borders with steganography. He used broken off matches in matchbooks corresponding with matchbook collectors. Very low bandwidth, but still.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209045">

			<div class="comment by-zerocool ">

				<p class="commentcredit">

					<span class="commenter">ZeroCool</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209045">
						November 4, 2013 9:43 AM					</a>

				</p>

				<p>My biggest nagging problems with this guy&#8217;s research:</p>
<p>He sat on this for 3years. No word if he has tried custom FOSS BIOS. Unclear if this affects multiple hardware models because zero details.</p>
<p>He should be contacting Kaspersky</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209046">

			<div class="comment by-joenotcharles ">

				<p class="commentcredit">

					<span class="commenter">JoeNotCharles</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209046">
						November 4, 2013 9:54 AM					</a>

				</p>

				<p>At every place I&#8217;ve ever seen this story posted, somebody has posted to say that the computers are being INFECTED by sound, rather than two ALREADY INFECTED computers communicating by sound.</p>
<p>I&#8217;d suggest that Bruce (and anyone who re-posts this) add a big disclaimer along with the excerpt clarifying that. Apparently it&#8217;s incredibly easy to misinterpret.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209047">

			<div class="comment by-some_guy_in_a_diner ">

				<p class="commentcredit">

					<span class="commenter">Some_Guy_In_A_Diner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209047">
						November 4, 2013 9:54 AM					</a>

				</p>

				<p>Need the data.  If we do not have a full analysis and data dump of this exploit we have no proof that it exists.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209048">

			<div class="comment by-noe ">

				<p class="commentcredit">

					<span class="commenter">Noë</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209048">
						November 4, 2013 9:55 AM					</a>

				</p>

				<p><a href="http://www.smus.com/ultrasonic-networking/" rel="nofollow ugc">An instructive blogpost on ultrasonic networking</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209049">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209049">
						November 4, 2013 9:56 AM					</a>

				</p>

				<p>From the Ars Technica article:</p>
<blockquote><p><i><b>Three years ago</b></i>, security consultant Dragos Ruiu was in his lab when he noticed something highly unusual: his MacBook Air, on which he had just installed a fresh copy of OS X, spontaneously updated the firmware that helps it boot.</p></blockquote>
<p>(emphasis added) Yeah, Mr. Ruiu has been at this one for <i>three years</i>.  And in that time, he hasn&#8217;t shared any data with anyone else.  According to the Ars Technica article, this infects OS-X, Windows, and Linux.  It <i>communicates</i>, not infects, over an audio channel.</p>
<ul>
<li>It&#8217;s absolutely possible that there is a rootkit that can communicate via an audio network.
</li>
<li>It&#8217;s absolutely possible that a rootkit can hide in the various writable spots of flash memory in a system.
</li>
<li>It&#8217;s absolutely possible that a rootkit can infect USB drives.
</li>
<li>It&#8217;s absolutely possible that a malware payload can have code to infect multiple OS targets.
</li>
</ul>
<p>This rootkit is supposed to be <i>three years old</i>, and only Mr. Ruiu has seen it.  He claims that he has been analyzing it all this time, and this is only as far as he&#8217;s gotten with it.</p>
<p>Why hasn&#8217;t Mr. Ruiu shared any data before this?  Why hasn&#8217;t he sent copies to various antivirus vendors?</p>
<p>Here&#8217;s where I don&#8217;t buy the story:<br />
#1, remember the Chernobyl virus?  It overwrote BIOS memory, corrupting it.  It&#8217;s possible to infect <i>one version</i> of a BIOS, but not multiple versions, and certainly not versions from different companies, i.e., Apple, Award, Phoenix, AMI, etc.  When new versions are compiled, everything in the BIOS changes.  The positions of the jump tables, etc.  The flash chip is packed, and there isn&#8217;t any room for a rootkit to just jump in and hide.</p>
<p>#2, As I, and others have noted, how is Mr. Ruiu tracing the communications of this rootkit?  Did it load its own virtual NIC driver?</p>
<p>#3, How can a security researcher be clueless that a rootkit is infecting via USB/sneakernet?  That&#8217;s the oldest form of infection, and should be a #1 suspicion.</p>
<p>#4, Again, <i>three years???</i>  This thing has been on his systems for <i>three years</i> and all he has to show for it is that he&#8217;s infected?  This guy only has x86 systems, and if he&#8217;s dealing with stuff that is <i>that</i> &#8220;dangerous&#8221; why doesn&#8217;t he have something that isn&#8217;t an x86-type processor and OS to take a look at what could be on that stick?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209050">

			<div class="comment by-ich ">

				<p class="commentcredit">

					<span class="commenter">ICH</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209050">
						November 4, 2013 9:57 AM					</a>

				</p>

				<p>So there are definitely a lot of details missing from the original article.  But lets assume a couple of things.</p>
<ol>
<li>This is not a propagation mechanism. Both computers are already infected.</li>
<li>Airgapped networks with good OpSec can be infected.</li>
<li>Getting data out of airgapped networks is a lot harder to do undetected than getting data in.</li>
<li>Many operators of airgapped systems need network access to do their jobs, i.e. there is likely going to be a network connected computer next to a non networked computer.</li>
</ol>
<p>This seems like a fairly novel attack designed to retrieve data from airgapped networks.  Nobody seems to argue that this can&#8217;t be done in theory.  Complaints seem to say this is unlikely because of the following.<br />
A. Transmission frequencies.<br />
B.  Distance between computers.<br />
C.  Sound would likely be audible by people nearby.</p>
<p>Why do we continue to think of virus writers as script kiddies targeting as many computers as possible?  If the target were valuable enough this might be an effective attack, you could rewrite the basic code for the type of computers you are attacking.  Many comments have used the language of unlikely.  I think this demonstrates the assumptions that are made, because we don&#8217;t know much about the networks. I suspect that if this article were talking about how the NSA stole Iranian nuclear secrets, we would be talking about the Gee Whiz factor of the novel attack, instead of calling it unlikely.</p>
<p>What if I told you that you had two computers ten feet apart in a room, you needed to get data off the airgapped computer to the non airgapped computer.  There was intensive virus scanning on both machines, both machines were tightly controlled, i.e. don&#8217;t have many apps on them, are at least hardened by disabling unnecessary services.</p>
<p>How many organizations put the effort into keeping an airgapped computer on the latest patches.  disabling unnecessary network services on a computer that doesn&#8217;t have network cards?</p>
<p>This seems like a very novel attack for specific environments.  this isn&#8217;t a large scale type of virus attack.  Seems like the sort of thing a government might keep in their bag of tricks.  In fact I think it is a statement that the private security community spends so much time worried about checking off boxes for PCI and SOX, that we have lost site, of data value.  Were busy patching things on computers that don&#8217;t have much real data, because the threat we are worried about isn&#8217;t a compromise of the most sensitive data, but increased rates on our credit card transactions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209051">

			<div class="comment by-alice ">

				<p class="commentcredit">

					<span class="commenter">Alice</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209051">
						November 4, 2013 10:00 AM					</a>

				</p>

				<p>I call shenanigans.  The data rate over an airspace connection eking out the highest frequencies from a sound card (presumably to remain undetected audibly) would run you around 300 baud.  High-frequency signal input in audio cards is stupidly noisy and usually physically restricted to a sane, and audible range of sensitivity.</p>
<p>Even if you go for DVD-quality audio (48kHz sampling rate) the highest frequency you can reproduce just from the DAC (digital to analog converter) of the sound card would be 24kHz &#8212; and a lot of people can hear that high.  Then there are the physical limitations and distortions introduced by the speakers; most speakers can&#8217;t come close to producing a full-frequency square wave of any power; and hideously low sensitivity (and high noise floor) of the average cheap computer microphone.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209052">

			<div class="comment by-frank ">

				<p class="commentcredit">

					<span class="commenter">Frank</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209052">
						November 4, 2013 10:10 AM					</a>

				</p>

				<p>Look, I’m not known for pulling punches and I’m not about to start now. The fact is that everything I have read about #badBIOS is completely and utterly wrong; from the supposed “escaping air gap” to well.. everything. And I should know. I’ve dealt with malicious BIOS and firmware loads in the past&#8230;</p>
<p><a href="http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/" rel="nofollow ugc">http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209053">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209053">
						November 4, 2013 10:23 AM					</a>

				</p>

				<p>@ICH</p>
<blockquote><p><i>How many organizations put the effort into keeping an airgapped computer on the latest patches. disabling unnecessary network services on a computer that doesn&#8217;t have network cards?</i></p></blockquote>
<p>Wouldn&#8217;t that depend upon why the organization in question had an airgap in the first place?</p>
<p>The patches may be an issue. I&#8217;d expect a LOT more testing and evaluation before deciding which patches must be deployed on an airgapped machine.</p>
<p>But cutting off all other means of communication (wifi, bluetooth, etc) and shutting down non-essential services should be part of basic security at that point. Along with auditing the machine(s) on a regular schedule.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209054">

			<div class="comment by-uncle_al ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://lrntec.com' rel='external nofollow ugc' class='url'>Uncle_Al</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209054">
						November 4, 2013 10:35 AM					</a>

				</p>

				<p>Mr. Schneirer, if this is factual, computer efficiency begins at the wall socket.  Hardware issues of this nature occur before software. I have experienced several similar issues since about 1986, when beginning computer repairing for real. If it was a desktop, I would suggest the individual should look at the internal power supply. In this event, since it has not been excluded by fact, I suspect something similar. The power connections for notebooks are notorious for failure because engineers do not design them, they accept what is available for a price.  UNC</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209055">

			<div class="comment by-phred14 ">

				<p class="commentcredit">

					<span class="commenter">phred14</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209055">
						November 4, 2013 10:42 AM					</a>

				</p>

				<p>After perusing the topic, I&#8217;ll have to agree that audio as a secret communications channel may be theoretically possible, but I&#8217;d guess that in practical terms it&#8217;s awfully rough.  To get decent modulation you&#8217;re now talking not just frequency response, but phase response as well.  (That&#8217;s part of how you cram those 56kb over a phone line, the other part is eliminating one A/D conversion at the far (ISP) end.)</p>
<p>In practice, it make me think more of &#8220;Press Enter&#8221;, by John Varley.  (science fiction)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209056">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209056">
						November 4, 2013 10:51 AM					</a>

				</p>

				<p>@Mario Vilas</p>
<blockquote><p><i>I don&#8217;t see where that claim is made&#8230; what I read was that two infected machines were connected to each other even when airgapped, while the infection occurs via a USB key.</i></p></blockquote>
<p>I also had the understanding that an airgapped machine was infected via speaker/microphone.</p>
<p>This is the statement that suggested that:</p>
<blockquote><p>&#8220;We had an air-gapped computer that just had its [firmware] BIOS reflashed, a fresh disk drive installed, and zero data on it, installed from a Windows system CD,&#8221; Ruiu said. &#8220;At one point, we were editing some of the components and our registry editor got disabled. It was like: wait a minute, how can that happen? How can the machine react and attack the software that we&#8217;re using to attack it? This is an air-gapped machine and all of a sudden the search function in the registry editor stopped working when we were using it to search for their keys.&#8221;</p></blockquote>
<p>It is possible that that machine had been infected before. But that wasn&#8217;t really stated.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209057">

			<div class="comment by-nastyhacker ">

				<p class="commentcredit">

					<span class="commenter">NastyHacker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209057">
						November 4, 2013 10:56 AM					</a>

				</p>

				<p>IF the audio card thing is real, then I am sure we do not witness data being transmitted over air gaps by audio but then we found the clipper chip which then is present in all audio cards thanks to some nice letters written by the FISA-NSA-FBI-CIA complex to audio card manufacturers&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209058">

			<div class="comment by-rick-auricchio ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cfcl.com/rick' rel='external nofollow ugc' class='url'>Rick Auricchio</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209058">
						November 4, 2013 10:58 AM					</a>

				</p>

				<p>Slightly off-topic, but it just occurred to me. What if Symantec or a similar company was simply an NSA project&#8212;and not a for-profit software company?</p>
<p>Increasing paranoia would encourage users to freely install more and newer anti-malware software&#8212;just what the doctor ordered for the spy network.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209059">

			<div class="comment by-nastyhacker ">

				<p class="commentcredit">

					<span class="commenter">NastyHacker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209059">
						November 4, 2013 11:01 AM					</a>

				</p>

				<p>IF computers actually communicate via audio cards, then I am sure, we do not see them talking to each other by sound but then we found a wifi clipper chip which then is implanted into every audio card since the NSA-CIA-FBI-FISA crew wrote a nice letter to audio card manufacturers&#8230; Question: How many percent of audio cards are made in the USA? OK, maybe I am wrong&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209060">

			<div class="comment by-david-henderson ">

				<p class="commentcredit">

					<span class="commenter">David Henderson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209060">
						November 4, 2013 11:12 AM					</a>

				</p>

				<p>Ham radio operators experiment with HF packet radio with (relatively) low bit rates. One way to do this is with a packet radio interface using sound by actually using radio mic to PC speaker and radio speaker to PC mic interfaces across the air gap. It doesnt work very fast or very well, but it does illustrate the principle. Once tried, people quickly learn to use a copper wire interface rather than the air gap.</p>
<p>It took a lot of software to enable this communications mode. Its robust enough to tolerate very noisy channels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209061">

			<div class="comment by-spark ">

				<p class="commentcredit">

					<span class="commenter">Spark</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209061">
						November 4, 2013 11:19 AM					</a>

				</p>

				<p>Extraordinary claims require extraordinary evidence. Or at least some evidence at all. In three years time, it never occurred to him to connect an oscilloscope to the PC speaker?</p>
<p>If this extraordinary worm got into the BIOS EEPROM, it should be fairly easy to isolate; as far as I know, most mainboards still have a separate chip for the EEPROM, although they are SMD devices now, instead of the socketed DIP devices they used many years ago. There isn&#8217;t a lot of space on one of these things, and (most of) the original code should still be there.</p>
<p>Larger EEPROMs are more expensive than smaller ones, and manufacturers don&#8217;t use devices much larger than the space they need for the code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209062">

			<div class="comment by-mike-anthis ">

				<p class="commentcredit">

					<span class="commenter">Mike Anthis</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209062">
						November 4, 2013 11:41 AM					</a>

				</p>

				<p>&#8220;Non-sequitur, your facts do not coordinate.&#8221;</p>
<p>Yes, you can spin this fantastic story into a plausible scenario, IFF you add your own facts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209063">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209063">
						November 4, 2013 12:06 PM					</a>

				</p>

				<p>Brian M: good post, agreed.. Will add a few things for everyone else&#8230;.</p>
<p>Have been following this guy for a while (well before this story broke) and he is a pretty reliable character so I can vouch that whatever he is reporting is what he believes is occurring. The three year quote in the AT article probably relates to a claim he made on Twitter and G+ that one of the machines he had started acting weird (not booting off CD, strange pips from speaker) almost three years ago it and wasn&#8217;t until the Copernicus tool came out from MITRE that he suspected foul play. By the way the BIOS dump he thought was suspicious as it was &#8220;modified&#8221; and put up for others to look at was actually clean.</p>
<p>As you&#8217;ve already noted using audio to network is possible. I spoke of &#8220;blurt&#8221; a while back, which is a bit of code someone is working on that is optimized to make low speed links between PCs using built in audio hardware.</p>
<p>The whole &#8220;ultrasonic&#8221; thing that has been spoken of is a bit misleading as Dragos himself reported hearing the bursts. Most likely they are spaced below 20khz to avoid being clipped by the audio hardware and are just high pitched but not necessarily &#8220;ultrasonic&#8221;. There is nothing impossible about all this &#8211; look at some of the ham radio modes for inspiration.</p>
<p>If there is a BIOS component it is likely there for persistence (think Computrace copying itself back into the filesystem when deleted) and this communication behavior occurs in userland. USB flash drives are obviously a vector &#8211; he claims that they may somehow elevate privileges using a buffer overrun during enumeration (ie by flashing the USB flash drive controller firmware with an &#8220;evil&#8221; one). The latter has been done before by the Russians who pioneered threBay scam of reflashing thumb drives with firmware that revealed a high capacity but really dropped any data above the physical capacity into the bit bucket in the sky. Who knows what else can be done but this does sound odd&#8230;</p>
<p>Anyway I doubt badBIOS works in the way Dragos thinks it does however I don&#8217;t doubt that he believes everything he has spoken of so far to be true and accurate. I think we need some better evidence before we go too strongly either in the affirmative or the negative. He mentioned on Twitter he is going to drop off a sample to sophos in Vancouver. Perhaps this will accelerate the process of elucidation.</p>
<p>His comment regarding &#8220;auctioning off&#8221; infected hardware for profit annoyed me a little but I have already mentioned my thoughts on that in another thread.</p>
<p>In summary: each individual claim on its own is plausible. The sum of the parts seems outlandish but nonetheless he could be right. Perhaps not 100% right but even if half of what he says is correct (let&#8217;s say it is just a win32 malware that combines a bootkit with a audio data transfer stack and spreads via two vectors &#8211; an 0day in IE for the initial infection and then infects flash drives once on a machine to try and breach an airgap. By being smart in its behavior by paying attention to the local clock time (only tx after 12am) and also sampling the mic to ensure the room is dead quiet for at least an hour it could reduce the chance of detection. After negotiation the least effective amplitude would be used to remain as covert as possible. Perhaps it would be spread spectrum rather than say FSK so it sounds more like interference or white noise than data. By stealing some functionality from, say AX25 or just rolling your own you could even have a situation where a series of airgapped but infected machines in hearing distance of a peer could work together, relaying the data until it reached a connected node where it could be sent off to the C&amp;C server.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209064">

			<div class="comment by-thierry-zoller ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.zoller.lu' rel='external nofollow ugc' class='url'>Thierry Zoller</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209064">
						November 4, 2013 12:37 PM					</a>

				</p>

				<p>&#8220;The weirdest part is how it uses ultrasonic sound to jump air gaps&#8221;<br />
vs.<br />
&#8220;The weirdest part is how it <em>supposedly</em> uses ultrasonic sound to jump air gaps&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209066">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209066">
						November 4, 2013 1:47 PM					</a>

				</p>

				<p>Unlikely, and I don&#8217;t buy it, even though it&#8217;s theoretically possible to have two or computers communicate and exchange files over this medium. Not possible to infect a computer through sound, simply because the target computer doesn&#8217;t have the functionality to accept the transferred information. It&#8217;s like saying a transmitter can send information to a device that doesn&#8217;t have a receiver and the capability to decode the packets and install the malware in the right place. But just in case your tin hat foil is the heavy duty type, then forget &#8220;Air-gapped&#8221; and use &#8220;Vacuum-gapped&#8221; instead &#8212; That&#8217;ll stop &#8217;em&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209067">

			<div class="comment by-george-william-herbert ">

				<p class="commentcredit">

					<span class="commenter">George William Herbert</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209067">
						November 4, 2013 1:56 PM					</a>

				</p>

				<p>I described an audio network as a joke in the late 80s; it was implemented shortly thereafter.  It&#8217;s now widely available as a hobbyist toy.</p>
<p>The 20 khz hardware limits are not that unusual but not a block to effective sidechannel use.  Most people won&#8217;t hear 18-20 khz, and those of us who do don&#8217;t usually ascribe it to anything malicious.  I have USB power/charger devices that humm above 15 khz when no load is applied, and many TVs, computer power supplies, &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209068">

			<div class="comment by-dilbert ">

				<p class="commentcredit">

					<span class="commenter">Dilbert</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209068">
						November 4, 2013 2:01 PM					</a>

				</p>

				<p>For those of you that are saying HOAX, please think back&#8230; a few months or years ago the thought of the Government spying on us was just another conspiracy theory.  I&#8217;ve known about this level of spying since the late 90s at least, but everyone told me to put on my tinfoil hat.  Search the archives here for &#8220;echelon&#8221; and you&#8217;ll see a report from Bruce in 1999.  The current situation is just the outgrowth of that old work (IMHO).</p>
<p>So now we KNOW the government is actively involved in spying on us, infiltrating our systems covertly, and gathering information on &#8220;everyone&#8221;.  What makes you think this isn&#8217;t technically feasible?  Does anyone here think a &#8220;State Actor&#8221; can&#8217;t marshal the resources to make this happen?</p>
<p>The badBIOS report may not have it all right.  Maybe some of it is not correctly understood, or its misinterpreted, or it&#8217;s misdirection at some level.  I&#8217;m just saying, with everything we know, and everything we keep learning &#8211; this is certainly POSSIBLE.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209069">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209069">
						November 4, 2013 2:03 PM					</a>

				</p>

				<p>@ George William Herbert</p>
<blockquote><p>Most people won&#8217;t hear 18-20 kHz </p></blockquote>
<p>Dogs won&#8217;t be amused. Then again, you may train some dogs to guard your air-gapped devices. One ear down, two eye brows up, and a small woof &#8211;&gt; Malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209070">

			<div class="comment by-spyvsspyvsspyvs ">

				<p class="commentcredit">

					<span class="commenter">SpyVsSpyVsSpyVs...</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209070">
						November 4, 2013 2:08 PM					</a>

				</p>

				<p>Nah, go with &#8220;hydrogen-gapped&#8221;. The flames are a built-in early warning system.</p>
<p>Or &#8220;peanut butter-gapped&#8221;. THAT oughta slow &#8217;em down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209071">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209071">
						November 4, 2013 2:20 PM					</a>

				</p>

				<p>@ SpyVsSpyVsSpyVs&#8230;</p>
<blockquote><p>&#8220;peanut butter-gapped&#8221;. THAT oughta slow &#8217;em down.</p></blockquote>
<p>The expression goes: &#8220;Slow as molasses&#8221; and not &#8220;Slow as peanut butter&#8221; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209072">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209072">
						November 4, 2013 2:26 PM					</a>

				</p>

				<p>@ Dilbert</p>
<blockquote><p>this is certainly POSSIBLE</p></blockquote>
<p>Only if the functionality is in the stock BIOS, or the pristine OS, and that means the OS supplier and/or the BIOS developer is in on it. Otherwise, I need to see a proposed proof of concept that tells me exactly how an uninfected computer can accept the sound packets, decode them, save them, install them, and then run them. Until then, its a hoax to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209073">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209073">
						November 4, 2013 2:36 PM					</a>

				</p>

				<p>After some more thinking&#8230;</p>
<blockquote><p>Only if the functionality is in the stock BIOS, or the pristine OS</p></blockquote>
<p>There maybe other ways: Sound card option ROM + Device driver that knows how to handle reception of sound packets. This means BIOS and OS subversion is not needed. Seems doable 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209074">

			<div class="comment by-matthew-x-economou ">

				<p class="commentcredit">

					<span class="commenter">Matthew X. Economou</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209074">
						November 4, 2013 2:51 PM					</a>

				</p>

				<p>I&#8217;m surprised no one&#8217;s mentioned Facedancer or Travis Goodspeed&#8217;s 29c3 talk yet.  Dunno if badBIOS is real but I definitely think it&#8217;s plausible.  At the very least this is a computer ghost story worthy of the fall season!</p>
<p><a href="http://travisgoodspeed.blogspot.com/2012/07/emulating-usb-devices-with-python.html" rel="nofollow ugc">http://travisgoodspeed.blogspot.com/2012/07/emulating-usb-devices-with-python.html</a></p>
<p><a href="http://travisgoodspeed.blogspot.com/2012/10/emulating-usb-dfu-to-capture-firmware.html" rel="nofollow ugc">http://travisgoodspeed.blogspot.com/2012/10/emulating-usb-dfu-to-capture-firmware.html</a></p>
<p><a href="http://www.cs.dartmouth.edu/~sergey/langsec//papers/wess2012.pdf" rel="nofollow ugc">http://www.cs.dartmouth.edu/~sergey/langsec//papers/wess2012.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209075">

			<div class="comment by-hm ">

				<p class="commentcredit">

					<span class="commenter">HM</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209075">
						November 4, 2013 3:31 PM					</a>

				</p>

				<p>Where are people getting the idea that Dragos is a &#8220;well respected researcher&#8221;?  As far as I can tell, he&#8217;s just an event organizer.  Based on his G+ posts, he is also clearly out of his mind and out of his depth, technically.  He says they are &#8220;learning&#8221; from him.  This appears to be some mental paranoia issue he is having.</p>
<p>Let&#8217;s just poke holes in one claim.  He removed all physical network devices and was still seeing network traffic.  How he sees it, he never explains.  He then says he disabled the speakers/mic/whatever and suddenly packets stopped appearing.</p>
<p>Okay.  There is a lot going on here.  First up, in order for two computers to talk via audio (let&#8217;s not get into the ultrasound tarpit) they both have to be infected.  Next, in order to see traffic on the network there has to be a network interface that the OS can &#8220;see&#8221;.  Otherwise, tools like wireshark have no place to attach and watch.</p>
<p>Simple?  Okay.  Now think about that for a minute.  It implies that the virus on two infected machines is communicating <em>directly</em> to one another.  Why the hell would it need a network?  The virus is already communicating to itself!!</p>
<p>So now you may think: well, perhaps the virus is trying to communicate to some machine across the Internet.  Maybe its mothership.  Or the NSA.  Or aliens.  That&#8217;s a valid concern.  But it doesn&#8217;t make $#!$ing sense.  The packets vanish when the speaker/mic/whatever is disabled.  It doesn&#8217;t add up.  Not to mention the <em>simple</em> fact that you can tell where packets are going.  They all have an IP address.  &#8220;Encrypted&#8221; or not.</p>
<p>And how did he know things were &#8220;encrypted&#8221;?  Unless you know the binary protocol, you&#8217;re not going to know encrypted data from random communication.  It&#8217;s such a steaming load of crap.  I shouldn&#8217;t have to mention it.</p>
<p>Hopefully Dragos is no longer &#8220;respected&#8221; by the whoever that respects him.  Just by the lack of sophistication he is bringing to debugging this problem, he should forever be regarded as a crackpot.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209076">

			<div class="comment by-sven ">

				<p class="commentcredit">

					<span class="commenter">Sven</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209076">
						November 4, 2013 3:48 PM					</a>

				</p>

				<p>What I gather mostly from reading the comments is that it would be good for everyone to be infected, so we can all look at it ourselves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209077">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209077">
						November 4, 2013 3:52 PM					</a>

				</p>

				<blockquote><p>First up, in order for two computers to talk via audio (let&#8217;s not get into the ultrasound tarpit) they both have to be infected.</p></blockquote>
<p>Or subverted. Either OS, BIOS, or device drivers and or ROM code on the sound HW. The functionality has to be in the &#8220;subverted&#8221; system before it gets &#8220;infected&#8221;. No subversion implies no possibility of infection, unless he knows something and not sharing it</p>
<blockquote><p>So now you may think: well, perhaps the virus is trying to communicate to some machine across the Internet. Maybe its mothership. Or the NSA. Or aliens. That&#8217;s a valid concern. But it doesn&#8217;t make $#!$ing sense.</p></blockquote>
<p>Think of an air-gapped system in the same room as a connected computer. The mothership wants to collect information on the air-gapped computer, so it uses the non-air-gapped other one as a hub to the air-gapped one.</p>
<blockquote><p>Just by the lack of sophistication he is bringing to debugging this problem, he should forever be regarded as a crackpot.</p></blockquote>
<p>That is evident!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209078">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209078">
						November 4, 2013 3:54 PM					</a>

				</p>

				<p>@ HM,<br />
Previous post is meant for you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209079">

			<div class="comment by-hm ">

				<p class="commentcredit">

					<span class="commenter">HM</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209079">
						November 4, 2013 5:01 PM					</a>

				</p>

				<p>@ Wael,</p>
<blockquote><p>
Think of an air-gapped system in the same room as a connected computer. The mothership wants to collect information on the air-gapped computer, so it uses the non-air-gapped other one as a hub to the air-gapped one.
</p></blockquote>
<p>I considered this.  But I don&#8217;t believe it&#8217;s very plausible.  Using inaudible frequencies to command/control a remote PC is one thing.  But transmitting larger data?  I don&#8217;t know the potential bandwidth in whatever inaudible range a consumer laptop can do, or the infrequent &#8220;chirps&#8221; or whatever other method of hiding the signal is.  But add in error correction, and I can&#8217;t imagine the networked computer would get that much data in any reasonable time frame.  It would be an interesting experiment though.</p>
<p>I&#8217;m just bewildered there is nothing more than &#8220;packets were seen.&#8221;  Until we see protocols, IP addresses, interfaces, how it was noticed&#8230; you know, <em>something</em> to go on, I just don&#8217;t believe any of it.  This should all be incredibly basic stuff for someone in the security industry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209080">

			<div class="comment by-glovesake ">

				<p class="commentcredit">

					<span class="commenter">glovesake</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209080">
						November 4, 2013 5:23 PM					</a>

				</p>

				<p>This is obviously stupid, there&#8217;s no way the government would install hardware/software malware on millions of consumer devices to get at data behind high security installations. Why that would require a mass surveillance network monitoring us 24/7, billions of dollars and a gigantic conspiracy between dozens of vendors!</p>
<p>CraaaaayzzzzZ! I suppose you guys think they&#8217;re listening to our phonecalls and monitoring comments on this blog too.</p>
<p>Oh wait. They are totally doing all of that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209081">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209081">
						November 4, 2013 5:31 PM					</a>

				</p>

				<p>Here&#8217;s a thought: just how malevolent is badBIOS, really?  Mr. Ruiu has had this going on for three years.</p>
<p>La la la &#8230; la la la la la &#8230; la de dah &#8230;</p>
<p>&#8220;Oh, like hey, do I have a rootkit running around here?  Oh, yeah, it&#8217;s talking to everything!  Even though it&#8217;s off!  OK, like you know, it&#8217;s talking in dog whistles and mouse squeaks!&#8221;  (Is there a canuck translator, something like jive?  I suppose it could be modeled on Bob and Doug McKenzie.)</p>
<p>I&#8217;m not making fun of Mr. Ruiu, but just questioning how dangerous this malware really is.  I would have thought that if this thing were dangerous and obnoxious, then it would be doing more than imitating Flipper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209082">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209082">
						November 4, 2013 5:35 PM					</a>

				</p>

				<p>@ HM,</p>
<blockquote><p>I&#8217;m just bewildered there is nothing more than &#8220;packets were seen.&#8221; Until we see protocols, IP addresses, interfaces, how it was noticed&#8230; you know, something to go on, I just don&#8217;t believe any of it. This should all be incredibly basic stuff for someone in the security industry.</p></blockquote>
<p>Yup! I still don&#8217;t buy it. But if it were doable, it would have to be something like I mentioned below. Sometimes <i>these people</i> just publish data and discoveries without any supporting evidence. Joanna did that <a href="https://www.schneier.com/blog/archives/2012/07/friday_squid_bl_334.html#c819015" rel="nofollow ugc"> previously </a> Reminds me of a joke&#8230;<br />
There was this scientist (choose the nationality of your choice, preferably the same nationality as the person you are talking to) who conducted an experiment on frogs. He cut one of the frog&#8217;s legs and asked it to jump, It jumped. He cut the second leg, it still jumped, same for the first hand. When he cut her last hand and asked her to jump, it didn&#8217;t. In his report, he wrote: After cutting the frogs last hand, it lost its sense of hearing.<br />
So there was this guy, that cut the wires to the speakers, and&#8230; Oh, well&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209083">

			<div class="comment by-glovesake ">

				<p class="commentcredit">

					<span class="commenter">glovesake</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209083">
						November 4, 2013 5:35 PM					</a>

				</p>

				<p>@HM</p>
<p>If you have a really valuable channel or exploit to hide, then you shall obfuscate its existence using every trick in the book. You wouldn&#8217;t do anything so obvious as sending information in the clear with ip addresses. Long before you&#8217;re hiding the stream of data across the network or visiting any port or interface you would be using side channels to communicate on the data/power buses so it shows up as random noise. Encrypted signaling should look like random noise anyway. Observing the copper directly and expecting to extract ip addresses is not likely.</p>
<p>Neither I nor you have any idea whether this is factual or not. So let&#8217;s hold our horses until all the facts are in.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209084">

			<div class="comment by-glovesake ">

				<p class="commentcredit">

					<span class="commenter">glovesake</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209084">
						November 4, 2013 5:39 PM					</a>

				</p>

				<p>I am also tired of these flippant remarks about Flipper. Dolphins have long been our allies in the war against Terra.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209085">

			<div class="comment by-sparkleface ">

				<p class="commentcredit">

					<span class="commenter">Sparkleface</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209085">
						November 4, 2013 5:43 PM					</a>

				</p>

				<p>HM makes an excellent point; if machines were somehow improbably communicating using pc speakers and microphones that were capable of writing directly to a BIOS that didn&#8217;t need to be specifically coded to the chipsets and hardware onboard the motherboard (which needs to pass a read only checksum), how was he detecting &#8216;packets&#8217; using never before seen protocols on completely novel network devices?</p>
<p>Furthermore, why make it obvious a compromised machine was infected? If I engineered a nearly impossible feat of computer science, I would want to covertly gather information rather than disable the CD ROM drive for no apparent reason.</p>
<p>As Schneier says though, it <i>is</i> a great story.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209086">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209086">
						November 4, 2013 5:45 PM					</a>

				</p>

				<blockquote><p>As Schneier says though, it is a great story.</p></blockquote>
<p>And if you believe it, I have a Rolex to sell you 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209088">

			<div class="comment by-aldus-gustave ">

				<p class="commentcredit">

					<span class="commenter">Aldus Gustave</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209088">
						November 4, 2013 5:56 PM					</a>

				</p>

				<p>Your not going to get ultrasonic, reliable (meaning low to no errors), long distance (over 6 inches), digital communication from ANY laptop sized speaker or microphone. Anybody who has worked Pro Audio and used things like ATC monitors, DPA mics, Waves software and various audio high end tools will tell you how hard, and how costly it is, to get precise, audible sound from even expensive gear. The story is complete FUD presented as a way to monitor discussion boards and comment sections to judge social awareness and future attack vectors.</p>
<p>Now using speakers and mics as a sensor array, to tell when someone is at the computer, tied to bad firmware and using an RFID  embedded in a chip to transmit P2P encrypted info, such as system meta-data, like what files are in /home for all users, and hopping around until it finds an exit (wifi,eth0,gsm via cellphone sync) is possible. Go over to InvisibleThings blog and look at the coverage of upcoming Intel chip features as well as current features &amp; exploits and it&#8217;s pretty scary. Let alone that RFID has been readable from space from it&#8217;s inception. Lots of ways to read, mask and spread data in the 2.4GHZ and 5.8GHZ spectrum. It&#8217;s also the same bands for wireless energy transmission. And when you figure that a handful of companies control most all market share and production (Intel, AMD, Broadcom (evil), ATI, Nvidia, etc.) it becomes trivial. What holding companies own those companies? What banks/hedge funds give them capital? Let alone the whole Chinese subcontractor  factor (Europe too).</p>
<p>The whole dilemma is not one of technology that has failed. There is no shortage of technology. The problem is people. Human beings have failed. Over and over again. By being &#8220;The Crowd&#8221; even as it destroys them. By accepting ideology that is infectious and corrodes the ability of one to be an individual and human. By accepting the principle &#8221; of having one half of humanity paid to kill the other half&#8221;.  By having zero morals. By not taking any responsibility for one&#8217;s actions or lack there of. By avoiding the saddle and being led/fed like cattle.</p>
<p>Forget about encryption, the chips, the apps, the warez, the attack vectors, the modelling, the social &#8220;nudging&#8221;, the iron fist wearing kitty mittens&#8230;  It&#8217;s time to stop looking at the symptoms and look at the cause. It&#8217;s time to put direct blame on the people who cause problems for humanity. It&#8217;s time to take direct action. Stop evading. Stop trying to get around the train. The train is you.</p>
<p>&#8221; The weakest link in a security environment is the human element.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209089">

			<div class="comment by-bruce-clement ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.clement.co.nz' rel='external nofollow ugc' class='url'>Bruce Clement</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209089">
						November 4, 2013 5:58 PM					</a>

				</p>

				<p>@HM &#8220;First up, in order for two computers to talk via audio (let&#8217;s not get into the ultrasound tarpit) they both have to be infected.&#8221;</p>
<p>But what if they started ex-factory with the communication software pre-installed in the BIOS? The malware might only need to send a special activation code to use it.</p>
<p>Crazy as it seems that this would be built in at source, once it became obvious that OBL was off the radar, the thought must have occurred to someone that he may have been using airgapped computers and building a mechanism for bugging him by communicating with those computers makes sense.</p>
<p>&lt;TinfoilHatMode&gt;Recent revelations make me wonder about any equipment designed or manufactured north of the equator.&lt;/TinfoilHatMode&gt;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209090">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209090">
						November 4, 2013 6:11 PM					</a>

				</p>

				<p>It is staggering how most of the &#8220;analyses&#8221; get fundamental, well-known stuff wrong.</p>
<p>For example, the last link claims that audio today has 96kHz at 24 bit. That is complete BS, unless you get some expensive audio card. Standard PC audio has 16 bit at 48kHz max, which, by Nyquist, readily explains why he could not drive his experimental transmission above 24kHz. He then claims that &#8220;vendors lie about sampling rates&#8221;. No, they do not, but he cannot read! (Or rather he could not be bothered to look up this fundamental part to the puzzle and just confidentially stated his misconception as true and accused vendors of lying without even checking what they say.) Many of the other &#8220;analyses&#8221; floating around have a similar level of incompetence displayed in them.</p>
<p>I have seen a few statements by people that actually have signal transmission experience, and they say that due to the very low bandwidth available, low sampling rate and very bad transmission and reception equipment, this will not work in most environments, and where it works, it will have extremely low transmission rates. This also fails if people use headphones, which is the standard in crowded offices.</p>
<p>My take is that this audio stuff is nonsense. Sure, it could be made to work with good equipment, but that is just not in place. If also does not fit the non-stealth level of sending IPv6 packets or preventing CD-booting. The cross-platform capabilities are also not credible. And the complete lack of posted evidence (recording the audio signal, for example, would be trivial as other PCs must be able to receive it for it to be any good, and attaching a cheap digital oscilloscope or other soundcard to the speakers is also easy) is telling.</p>
<p>Extraordinary claims require extraordinary proof. Here, we have no proof at all, even if proof would be easy to provide, i.e. BIOS dump, audio-recording, the malware itself. This makes it much more likely that there is no proof because this whole thing is a fabrication.</p>
<p>I think this guy has gone of the deep end, no matter how long he was a well respected member of the community. Psychological problems, drug use, a sudden perception he does not get enough attention, etc. all possible explanations.</p>
<p>What I find truly astonishing though, is that this gets repeated anywhere with zero proof despite the extraordinary claims. I think this thing illustrates very well how gullible people are.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209091">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209091">
						November 4, 2013 6:29 PM					</a>

				</p>

				<blockquote><p>Is it easier to verify raspberry pi&#8217;s embedded code than a desktop&#8217;s BIOS?</p></blockquote>
<p>JTAG port.  You could make a microprocessor that can read and write JTAG commands and have it verify the BIOS against a copy stored in it&#8217;s memory.  Give it a power connector, 2 JTAG Connectors to connect to P2 and P3 so it can verify both the Broadcom SoC chip&#8217;s and the LAN9512 LAN/USB-HUB chip&#8217;s programming.  Both headers are next to each other.  Give it an 8&#215;8 LED array for output.  Have it display a verification code hash on the display.  For the JTAG ports and LED display, choose IO pins to use on your microcontroller that aren&#8217;t used for programming it&#8217;s memory.  Pot the whole microcontroller circuit in a potting compound so it can&#8217;t be accessed.  Wrap it up with your verification tape.</p>
<blockquote><p>What if IvoryTower is pwned before you buy it and produces weak PGP keys?</p></blockquote>
<p>Always use random numbers generated on dice or with something like LavaRand.  Always use your own code and executables for generating the keys.  Possibly generate the software beforehand on a different system, burn it to the CDROM, and then hand verify it.  For random numbers.  Generate a set and burn them to CDROM.  You could then use the same random numbers on two different architecture systems to make keys and see if they match.</p>
<blockquote><p>My biggest nagging problems with this guy&#8217;s research:</p>
<p>He sat on this for 3years. No word if he has tried custom FOSS BIOS. Unclear if this affects multiple hardware models because zero details. </p></blockquote>
<p>Please note the time frames when he had breakthroughs.  This was an ongoing infection that they didn&#8217;t know was there, then didn&#8217;t understand how it was working for ages, then some breakthroughs happened recently.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209093">

			<div class="comment by-hugo-botas ">

				<p class="commentcredit">

					<span class="commenter">Hugo Botas</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209093">
						November 4, 2013 6:31 PM					</a>

				</p>

				<p>are a microphone and a speaker the same things? i mean, same connection, both operations?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209094">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209094">
						November 4, 2013 6:33 PM					</a>

				</p>

				<p>@Spark: Yes, getting an EEPROM image is pretty easy. I recently needed to duplicate a MAC address and because I felt like doing a bit of electronics work, I removed the EEPROM from an Intel network card, read it, reprogrammed it with modifications, and put it in again (with a socket added in between). This EEPROM is a 4MBit SPI EEPROM also used by many BIOSes, really cheap and really easy to read. The whole thing took me less than a weekend, with the only special equipment a $30 bus pirate, and some python scripts I wrote around its binary interface.</p>
<p>So, no, getting an authentic BIOS image is really not hard at all and even easier if you are not trying to put the chip back in undamaged.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209095">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209095">
						November 4, 2013 6:33 PM					</a>

				</p>

				<p>Although it sounds theoretically and practically feasible, I doesn&#8217;t look like a very efficient method to me. If I were a resourceful spying agency interested in bridging the air gap, I&#8217;d probably look into covert powerline communications instead of messing about with sound.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209096">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209096">
						November 4, 2013 6:39 PM					</a>

				</p>

				<p>@Hugo Botas: In principle, that would be doable. An ordinary speaker is also a microphone and some microphones could be used as speaker. But the optimal shapes and sizes are very different and separating the two signals would be prohibitively expensive. So, no, microphone and speaker are usually separate and they use separate connections and interfaces. (In really old phones, mic and speaker use the same line, with the effect that you have to speak loud and get a not very loud signal in the ear-piece. And you get to hear yourself.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209097">

			<div class="comment by-0xdeadbeef ">

				<p class="commentcredit">

					<span class="commenter">0xdeadbeef</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209097">
						November 4, 2013 6:42 PM					</a>

				</p>

				<p>People, it&#8217;s not audio, it&#8217;s RF. Audio equipment &#8211; both microphones and speakers &#8211; cuts off around the top of the human hearing range. This leaves precious little bandwidth to work with &#8220;inaudibly&#8221; (as someone estimated above, maybe 300 bps) &#8211; and unreliable at that. It would be easily detectable with any kind of ultrasonic equipment. And although the ultrasonic sounds themselves are not audible, the frequency response of the speakers being operated out-of-band means that there will be very audible clicks whenever the ultrasonic signaling is turned on or off.</p>
<p>Anyone who&#8217;s watched the movie Heat may remember this beautiful little exchange between Neil and Kelso:</p>
<p><a href="http://www.youtube.com/watch?v=HQMqKp1yS_Y" rel="nofollow ugc">YT clip where Kelso explains to Neil how he obtained sensitive blueprints of a bank</a></p>
<p>The US/UK intelligence establishment is all about RF, and always has been. Steve Blank explains it all in his lecture titled &#8220;The Secret History of Silicon Valley&#8221;. Look it up, it&#8217;s available online for free.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209098">

			<div class="comment by-johannes-rexx ">

				<p class="commentcredit">

					<span class="commenter">Johannes Rexx</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209098">
						November 4, 2013 6:46 PM					</a>

				</p>

				<p>The story smells of fish per <a href="http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/" rel="nofollow ugc">http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209099">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209099">
						November 4, 2013 6:50 PM					</a>

				</p>

				<p><i>What I find truly astonishing though, is that this gets repeated anywhere with zero proof despite the extraordinary claims. I think this thing illustrates very well how gullible people are.</i><br />
Gweihir<br />
&#8211;What I find truly astonishing is no one out of all the comp. scientists/engineers can definitively put it to rest.  What does that say about us as engineers?  The programmers don&#8217;t know radio and the RF guys can&#8217;t program.  There&#8217;s always the &#8220;possibility&#8221;.  For instance, just today I almost said something (and laughed) but I didn&#8217;t&#8230;I heard someone&#8217;s laptop w/ a high pitch sound putting out what almost sounded like morse code.</p>
<p>If anything, this is a glaring sign of too much complexity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209100">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209100">
						November 4, 2013 7:04 PM					</a>

				</p>

				<p>If you get two speakers and connect them with a 25 meter wire you&#8217;ll be able to hold a conversation with another person at the other end. You&#8217;ll have to put the speaker on your ear to hear, though. I used to play with that when I was a kid. I sat in one room, and the other person sat in a different room with both doors shut.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209101">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209101">
						November 4, 2013 7:18 PM					</a>

				</p>

				<p>@Figureitout: There are enough hoaxes and successful fraudsters out there that can convince the public and even the lesser capable members of the scientific and engineering community. Occasionally some of the more capable members fall for it too. The problem is that too many people &#8220;want to believe&#8221;. The great James Randi, for example, has written a lot on how &#8220;psychics&#8221; fool scientists successfully, time and again.</p>
<p>So,</p>
<pre><code>extraordinary claim, zero evidence =&gt; fraud 
</code></pre>
<p>by Occam&#8217;s razor. The &#8220;extraordinary&#8221; is really not needed in this implication, however it is clearly true, so actually extraordinary evidence is required. Instead we have none at all.</p>
<p>BTW, the &#8220;morse like sound&#8221; you heard is likely a high-pitch modulated by CPU power consumption, likely from some mechanically not quite stable components in the power circuit. (The switching frequencies are supposed to be too high to hear, but on low loads these regulators can go into a &#8220;hiccup mode&#8221; where they skip cycles. This can be audible. Just last week had an USB PSU here that was audible because of this problem.) The brain then tries to find structure and ends up with &#8220;morse-like&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209102">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209102">
						November 4, 2013 7:27 PM					</a>

				</p>

				<blockquote><p>&#8221; The weakest link in a security environment is the human element.&#8221;</p></blockquote>
<p>Yep, and considering how infallible we are, we need hardened technology to help protect us.</p>
<p>@Brandioch Conner</p>
<blockquote><p>I also had the understanding that an airgapped machine was infected via speaker/microphone.</p>
<blockquote><p>{snip}</p></blockquote>
</blockquote>
<p>I took that paragraph to mean the air-gapped computer wasn&#8217;t fully cleaned of infection.  There is possibly more FLASH code on a system than just the BIOS.  USB controllers can have their own internal CPUs with their own flash code.  They could have a small tailored reinfection kit stowed on it.  Same goes for the sound subsystem.  Often there is a DSP in it for handling sound processing.  I also remember some Intel IO controller chips having CPUs in them.  I&#8217;d bet some still do.  They too could have code.  One or more could be using 0 day&#8217;s on the BIOS code that interacts with them.  Then there are the BIOS blobs for various peripherals.  Any of them could be changed to host the re-attack code, and store other blobs of code.  Yes, it takes allot of planning to make a persistent infection like this, but it is doable.  All the code that stays behind needs to do is call out on the audio net link for modules to reinfect the system and the code that inserts the persistent kit can be large as it doesn&#8217;t need to persist.  In fact it is best if it never gets written to disk.  Only have it stick around for the initial infection, then it gets wiped so it doesn&#8217;t get discovered.  Also any near by nodes could provide the modules for reinfection.  That may be what that store of odd image files are part of.  They could also be stored in the spare blocks on USB FLASH drives.  They have more memory blocks than needed to allow for fab mistakes and bit wear.  Modern hard disks also have spare blocks that can be mapped in place of bad ones.  That&#8217;s another great spot to hide code that can&#8217;t be scanned by normal means.</p>
<p>To all the doubters, one thing I&#8217;ve found out over the years is if I have the will to do something.  I just have to stay motivated and focused on the task and I&#8217;ll learn enough and come up with a solution sooner or later.  Have a 100 people doing that and the possible solutions will come allot faster.  Personally I look at each of the described possible functions of this persistent infection plus air-gap spanning malware and see a few possible solutions to each of them in just the knowledge I already have.  Yeah, I may not have the details, but once a possible solution is seen, then it is only a matter of reading up on how others solved it and figuring out the specific implementation details.  Yeah, so the air-gap bridge is only capable of 150bps.  That&#8217;s a good megabyte+ a day which is enough to send all keyboard and mouse data plus allot more.  Over a few days it would have plenty of time to send lots of compressed source files and directory listings for a project.  Now, mind you I&#8217;d bet the data rate is at least in the kbs.  The code needed is in every modern high speed modem, just change the frequencies used.  For transferring the files, use a simplified xmodem protocol.  That will get rid of the packet overhead of TCP/IP.  BTW: modern CPUs are now fast enough to run the modem sound processing code.  Also, computers are infinitely patient.  They can spend all month sending data if they need to.  Remember, any data they get out is more than they had before.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209103">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209103">
						November 4, 2013 8:49 PM					</a>

				</p>

				<p>Dirk: I agree. It also seems a lot of work just for the vague hope that someone is going to have an airgapped machine /with connected mic and speaker/ next to, say someone&#8217;s laptop, not to mention the precondition that both machines would need to be infected via the USB vector anyway and you&#8217;d probably have more success if you wanted to exfiltrate data and had found some 0day in Windows (let&#8217;s say Windows, the multiplatform BIOS thing sound improbable) that could cause execution in much the same fashion as autorun (which should not be disabled by default. Bye such a 0day isn&#8217;t totally unexpected, let&#8217;s say in the chkdsk code. Make the fs unclean and va-voom) then I expect that you would just use the USB thumb drive itself as your side channel. Eventually that thumb drive will get inserted into an internet connected machine where your intelligence can get uploaded, no hassle at all.</p>
<p>That said re Ruiu &#8211; I think either he has found something he is unable to explain and has perhaps jumped to a few conclusions or he has truly gone nuts. I sincerely hope for his own sake that it is at least partially validated as something like this would end a career.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209104">

			<div class="comment by-nick ">

				<p class="commentcredit">

					<span class="commenter">Nick</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209104">
						November 4, 2013 9:07 PM					</a>

				</p>

				<p>So far, it seems that those who are calling bullshit have either misread or not read what is actually being claimed. And are ignorant of others who are now corroborating what he&#8217;s seeing.</p>
<p>It seems it has been demonstrated by many people that communicating at around 20KHz is possible using laptop speakers and mics, so there&#8217;s nothing fantastical about that side of it.</p>
<p>It has not been claimed that it infects via high-frequency sound, so there&#8217;s nothing to debunk there.</p>
<p>He hasn&#8217;t been sitting on it for 3 years &#8211; it&#8217;s only around a month ago that he&#8217;s begun to work out that there really is something going on. Others have stated that they have had similar issues for around the same time.</p>
<p>Oh, and I&#8217;d guess that there are some highly motivated people out there who&#8217;d like you all to believe that it&#8217;s just a hoax or a figment of someone&#8217;s imagination. So unless you want to tar yourself with that brush, sit down, think, read, understand, and prepare a real argument, based on facts. <em>Before</em> you start making handwavy claims that it&#8217;s all BS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209105">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209105">
						November 4, 2013 9:27 PM					</a>

				</p>

				<p>@ Nick,</p>
<blockquote><p>It seems it has been demonstrated by many people that communicating at around <b>20KHz</b> is possible using laptop speakers and mics, so there&#8217;s nothing fantastical about that side of it.</p></blockquote>
<p>You can communicate at 0.5 Hz. The question is how can a non infected computer accept the transmission? That question needs to be answered.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209106">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209106">
						November 4, 2013 9:34 PM					</a>

				</p>

				<p>Nick: I think it is certainly possible and have spoken about this culture of &#8220;it can&#8217;t be, it must be a hoax&#8221; in the netsec community on my blog last week. It seems that whenever someone comes up with something a bit unusual they are derided.</p>
<p>Sure, it&#8217;s an unlikely story&#8230; But again I don&#8217;t believe someone would risk their cred and potentially future employment prospects by making a bogus claim. I have no reason to doubt that Mr Ruiu has been honest and has called things the way he sees them.</p>
<p>There have been numerous proof of concepts that show that near inaudible (18khz+) data communications using commodity sound card and laptop mike and (ceramic) speaker. If you look at &#8220;blurt&#8221; you&#8217;ll see that with a small modification you could make such an implementation in minutes. I said on the other thread that if I were to do such a thing I would burst to minimize detection and linked to an example of a 2.4kbps burst TX (an ACARS transmission) to show just how much data could be encoded in a short period of time even with a relatively slow rate.</p>
<p>With some negotiation code to adjust the maximum kHz (as it will be speaker and sound card dependent as to just how high you could go) and amplitude (you don&#8217;t want to be unnecessarily noisy if the target device is only a foot away) you could have something workable. If you did something spread spectrum you&#8217;d have something reasonably high bandwidth &#8211; perhaps up to 14kbps but at the risk of losing stealthiness. That said you could make such a transmission sound like interference.</p>
<p>So I absolutely think the crux of his claim &#8211; that communications via audio is a way to breach an air gap &#8211; is coherent.</p>
<p>I am holding out my judgement until we see a full analysis.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209107">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209107">
						November 4, 2013 9:46 PM					</a>

				</p>

				<p>Wael: I don&#8217;t think the guy has claimed that infection can occur via audio, only that two already infected machines can communicate via audio in the absence of a traditional network.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209108">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209108">
						November 4, 2013 9:51 PM					</a>

				</p>

				<p>@ Hugo Botas,</p>
<ul><i>Are a microphone and a speaker the same things?</i></ul>
<p>They are both transducers that convert one type of energy into another.</p>
<p>As a general rule there are two types of transducers the first are bi-directional. That is they are like a DC motor which turns electrical energy into mechanical movment, but it also acts at the same time as a generator producing a back EMF (which generaly prevents the DC motor destroying it&#8217;s self or the power supply).</p>
<p>Many speakers are &#8220;moving coil&#8221; as are quite a few microphones. Basicaly sound is detected/produced by a diaphram which is mechanicaly connected to a coil of wire mounted in the gap between two poles of a magnet. If the coil is moved it creates an AC current, if a current is applied to the coil it moves in sympathy. In this respect it is similar to a DC motor/generator.</p>
<p>The second type of  transducers are uni-directional, this is often because they are not &#8220;generators&#8221; but &#8220;modulators&#8221; and don&#8217;t directly produce energy out, they simply change some charecteristic &#8211;like resistance&#8211; that modulates a supplied energy source.</p>
<p>An example of this was the old &#8220;carbon grannual&#8221; microphone, the movment of the diaphram with sound caused the granuals to be pushed together more/less tightly causing a consiquent decreas/increase in the resistance of the grannual container. This change in resistance would cause the current flowing through it from a high impedence source to be modulated which could be seen in the change of voltage across the microphones contacts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209109">

			<div class="comment by-george-william-herbert ">

				<p class="commentcredit">

					<span class="commenter">George William Herbert</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209109">
						November 4, 2013 10:02 PM					</a>

				</p>

				<p>The question of the day &#8211;</p>
<p>Regardless of this specific claim, this method has been available for exfil for some time.  And this method of infection.</p>
<p>Blocking the exfil is easy &#8211; deaf/mute computers.</p>
<p>How does one bring data into an airgap system without excess risk of compromise?</p>
<p>USB is not safe.</p>
<p>CD-ROM / DVD-ROM may be, but I am not convinced.</p>
<p>Printer + OCR?  Fine for an encrypted email, less so for any software.</p>
<p>Suggestions?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209110">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209110">
						November 4, 2013 10:24 PM					</a>

				</p>

				<p>@ Mike the goat<br />
I think he claimed that at more than place. He said machines that were wiped clean and flashed got infected within hours. He also implies that machines that started at t=0 being air gaped got infected.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209111">

			<div class="comment by-david-dyer-bennet ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://dd-b.net/' rel='external nofollow ugc' class='url'>David Dyer-Bennet</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209111">
						November 4, 2013 10:41 PM					</a>

				</p>

				<p>Sd memory cards have a &#8220;write lock&#8221; physical switch on them.  Does anybody know &#8220;for sure&#8221; if that switch really physically prevents writes?  Or if it just presents a bit that device drivers conventionally check before writing?</p>
<p>There are &#8220;USB drives&#8221; that actually are just an adapter that takes SD memory cards; if the write lock switch is a reliable physical block to writing, this provides an obvious way to make read-only USB drives (in fact, easily switched), which makes keeping an air-gapped system clean somewhat easier.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209112">

			<div class="comment by-zachary-smith ">

				<p class="commentcredit">

					<span class="commenter">Zachary Smith</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209112">
						November 4, 2013 10:48 PM					</a>

				</p>

				<p>This is a fascinating discussion, though I&#8217;ll freely admit most of it is over my head.   That said, during a quick examination of the posts I found no mention of information transmission through the power line.  This is old technology &#8211; for a time there was consideration of connecting to the internet via the electric lines.   Could this be another arrow in Big Security&#8217;s quiver?   If I were in charge it darned well would be!</p>
<p>Specs for the computer parts are written by somebody.   Trivial modifications could introduce entire new capabilities to the machines those parts will get installed into.   Domestic spy agencies, foreign spy agencies, and nosy Big Business &#8211; any or all of them might be doing this.  And the EM spectrum is very wide.   Innocent-looking emanations could communicate with other devices in the area, ones which ARE connected to the internet without any security concerns.</p>
<p><a href="http://abcnews.go.com/Business/household-products-spying/story?id=19974898" rel="nofollow ugc">http://abcnews.go.com/Business/household-products-spying/story?id=19974898</a></p>
<p>The badbios story speaks of high frequencies.  Is anybody looking at the low ones?    Elephants use the low range for long-distance communications.</p>
<p>IMO a secure machine couldn&#8217;t be trusted with a RW optical drive, no more than it could be connected to an ink-jet printer.    The idea of antique machines is a good one; my problem is that I don&#8217;t own any.   Given the recent disclosures, the old boat anchors are probably going to get mighty pricy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209113">

			<div class="comment by-anonymouse ">

				<p class="commentcredit">

					<span class="commenter">Anonymouse</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209113">
						November 4, 2013 11:57 PM					</a>

				</p>

				<p>Discussion of badBIOS equates to propagation of this &#8220;malware&#8221;.  Consider yourselves infected.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209114">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209114">
						November 5, 2013 12:08 AM					</a>

				</p>

				<p>Gweihir<br />
&#8211;Yeah, no need to look further than the lies being pushed on us by the intel community; leading this country to a bankrupt police state.  And I wasn&#8217;t saying the supposed like 15wpm morse (think I caught a &#8216;b&#8217; but was trying to do something else too) was anything, shit I heard a car horn beep out morse once, I hear it everywhere lol; but all one can say is it&#8217;s &#8220;likely this or that&#8221;, not it WAS this or that definitively.  Having zero doubt to the cause on something as complex as a modern motherboard is a lot of work.  The most irritating instance of this to me is the hidden memory on chips today, are you kidding me?  Why is this even a problem still?  There&#8217;s too much doubt, I just really need some baseline level of pure trust.</p>
<p>Not like this problem is going to go away anytime soon, and it&#8217;s just very frustrating to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209115">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209115">
						November 5, 2013 1:12 AM					</a>

				</p>

				<p>Wael: he has issued numerous clarifications on twitter yet people keep suggesting that he is adamant that audio is an infection vector rather than a comms post-infection. E.g. <a href="https://twitter.com/dragosr/status/397024072451620864" rel="nofollow ugc">here</a>.</p>
<p>others: I am not saying whether he is right or wrong. I too have my doubts but believe we should hold out judgement until all evidence is in.</p>
<p>George: I use RS232 with a custom made &#8220;data diode/analyzer&#8221; that I brewed up with an 8bit microcontroller with two UARTs. It strips everything except printable ASCII. If I must transfer high bit I uuencode on one side but most of the time I am just bringing ASCII armored pgp backwards and forwards. Not foolproof but at least I can control data direction and have some idea what is traversing the link in near real time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209116">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209116">
						November 5, 2013 1:14 AM					</a>

				</p>

				<p>@Mike the goat<br />
I only read the link Bruce posted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209117">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209117">
						November 5, 2013 1:33 AM					</a>

				</p>

				<p>For communication over a power line you need a hardware interface that just isn&#8217;t there on most computers.  On the other hand most computers have a microphone and speakers.  To move the data, you have to use what you got.  Otherwise you need to risk getting caught installing the power line communication hardware.  There are other issues with power line communications like the two computers being on different legs of the supply.  That can happen within the same room.</p>
<blockquote><p>The idea of antique machines is a good one; my problem is that I don&#8217;t own any. Given the recent disclosures, the old boat anchors are probably going to get mighty pricy.</p></blockquote>
<p>Good thing I still have my old Compaq lugable portable. LOL  I wonder if I can find a copy of Minux to put on it?  I wonder how long it would take to check an 8k bit signature? :O</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209118">

			<div class="comment by-vance ">

				<p class="commentcredit">

					<span class="commenter">Vance</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209118">
						November 5, 2013 1:52 AM					</a>

				</p>

				<p>Hmm, other than Anonymouse above, everyone seems to be looking at the technological aspect of the story.  Perhaps instead, it is psychological.  Think of the various reactions we&#8217;ve seen.</p>
<ul>
<li>OMG, this is the apocalypse!  It infects machines by sound!
</li>
<li>You idiot, it doesn&#8217;t infect by sound, but OMG it&#8217;s a serious threat!
</li>
<li>While on the whole this sounds implausible, many of the techniques are possible.  Further details are needed.
</li>
<li>This is utter crap, based on [some half-remembered statement about sampling theory or unsupported assertion about hardware limitations].
</li>
<li>These claims are extraordinary, and here is my 1,500 word analysis of the technical details.</li>
</ul>
<p>Wouldn&#8217;t there be value in seeing which way people respond to the story, and how those people are associated with one another?  We have the credulous, the knee-jerk skeptics, the over-analyzers.  Does membership in these categories depend on Ruiu being the source?  How do things change if additional details drip out?  This need not even be some Machiavellian government psyops mission; it&#8217;s well within the range of amateur trolling.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209119">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209119">
						November 5, 2013 2:07 AM					</a>

				</p>

				<p>@ Mike the goat<br />
Link still doesn&#8217;t answer my question. It also implies the following: what good is it to air gap an already infected computer? His Twitter statements negate what the article Bruce posted&#8230; To me, it&#8217;s not science fiction. Just an incomplete unsubstantiated claim.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209120">

			<div class="comment by-vinzent ">

				<p class="commentcredit">

					<span class="commenter">Vinzent</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209120">
						November 5, 2013 2:52 AM					</a>

				</p>

				<p>@Alice:</p>
<blockquote><p>Even if you go for DVD-quality audio (48kHz sampling rate) the highest frequency you can reproduce just from the DAC (digital to analog converter) of the sound card <i>would be 24kHz &#8212; and a lot of people can hear that high.</i></p></blockquote>
<p>No, they can&#8217;t, not even a few. (A lot of people&#8217;s cats can, though.)</p>
<p>First: Even the 20 kHz is a bit of a stretch and only applies to young, undamaged human ears under perfect laboratory conditions (so the 22 kHz a CD could theoretically deliver is already quite a safety-margin even for the occasional genetic freak).</p>
<p>Second: The drop-off for the hearing curve in the upper frequency range is quite sharp, so even for one being able to hear the 20 kHz sound this also requires a sound intensity very close to the threshold of pain. (Most speakers installed in any home or office couldn&#8217;t even deliver that).</p>
<p>So, to conclude: Actually hearing 24 kHz would quite literally <b>blow your ears</b>. (It also would amount to the same claim as &#8220;a lot of people can see ultra-violet light&#8221;. With comparable consequences.)</p>
<p>The only reason why 48 kHz is used in DVDs is that it makes (analog) filtering of aliasing effects easier (read: cheaper) than the 44.1 kHz used by CD-Audio.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209121">

			<div class="comment by-bastian-angerstein ">

				<p class="commentcredit">

					<span class="commenter">Bastian Angerstein</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209121">
						November 5, 2013 3:01 AM					</a>

				</p>

				<p>Years (80s) ago accustic transmition of data was a common standard techique. But this needed calibrated devices and bandwidth was even with this devices rather small. Yes, it is possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209122">

			<div class="comment by-wim-l ">

				<p class="commentcredit">

					<span class="commenter">Wim L</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209122">
						November 5, 2013 3:03 AM					</a>

				</p>

				<p>DDB: I don&#8217;t think the switch on a SD card is a true hardware write protect; it just touches a switch in the socket that hopefully tells the host not to write. I&#8217;ve accidentally written to &#8220;write-protected&#8221; SD cards while working on bootloaders and embedded systems (they were all µSD cards in SD adapters, but I don&#8217;t think that makes a difference).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209123">

			<div class="comment by-christo ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://christo.uk.com' rel='external nofollow ugc' class='url'>christo</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209123">
						November 5, 2013 3:16 AM					</a>

				</p>

				<p>If the receiving computer is expecting to decode sound signals into a meaningful instruction, it would have to know beforehand how to handle those instructions.  Think about it.  Without some protocol which describes what the sound profiles mean, this line of communication is dead.  Further, without a process running on the recipient machine which can take the ADC signal and compile that into a meaningful instruction set which could be inserted into the stack of the host system BIOS, kernel, or user-space executable, again the vector is dead.  As such, the recipient laptop would have to be pre-infected.</p>
<p>Let&#8217;s all get back to work now, yeah?</p>
<p>christo</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209124">

			<div class="comment by-christian-koch ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://cfkoch-tech.blogspot.com' rel='external nofollow ugc' class='url'>Christian Koch</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209124">
						November 5, 2013 3:22 AM					</a>

				</p>

				<blockquote><p>Ruiu also disconnected the machine&#8217;s power cord so it ran only on battery to rule out the possibility that it was receiving signals over the electrical connection.</p></blockquote>
<p>This makes absolutely no sense. Batteries use electricity, too!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209125">

			<div class="comment by-isc ">

				<p class="commentcredit">

					<span class="commenter">ISC</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209125">
						November 5, 2013 3:37 AM					</a>

				</p>

				<p>@George William Herbert: &#8220;How does one bring data into an airgap system without excess risk of compromise?&#8221;</p>
<p>Floppy discs ? No processor inside. USB floppy drive were common not so long ago.</p>
<p>For additionnal security, you might want to dedicate an air-gapped computer to copy floppies, to prevent a bit off-track transmissions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209126">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209126">
						November 5, 2013 3:43 AM					</a>

				</p>

				<p>Wael: I agree. As I stated before &#8211; if you know that an evil USB stick is going to be plugged into both safe and air gapped machines and you have a novel way of ensuring the code gets executed on insertion it would be a lot easier to just use the USB device itself to exfiltrate the data from the airgapped machine. After all we assume they are targeting some specific info.</p>
<p>So yes, we are in agreement that it is an unlikely story. I too want to see some hard evidence before I call it confirmed. You would hope that the guy would have got his ducks in a row prior to making these claims &#8211; I believe that this is the same malware that he referred to as &#8220;BIOS SDR&#8221; in his g+ post of about a month ago. If so it seems he changed the story from &#8220;software defined radio&#8221; (RF) to upper band audible (18-20khz) in between.</p>
<p>Yes, it seems fishy&#8230; I won&#8217;t write it off, however until I have seen some independent analysis. There is no reason why one couldn&#8217;t make a purely win32 malware (spread by conventional methods) that used audio to communicate &#8211; perhaps there is little point but I have seen a working PoC posted so we know it works (hell, most hams that experiment with packet radio will tell you it would work) and using a patched BIOS to achieve persistence ala Computrace pr the Award only &#8220;mebromi&#8221; has been done before.</p>
<p>So my analysis at this point is that we need more data. That what he claims is unlikely but theoretically possible. It seems there would be a much easier means to an end than using audio to transmit data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209127">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209127">
						November 5, 2013 3:50 AM					</a>

				</p>

				<p>A design that make sense to me would include a multi-phase initialization sequence initiated a boot looking for a response to a simple audio beacon. Once proximity has been established a hook is installed at the ACPI layer. After bringing up the kernel, call into the hook and broadcast/beacon an all ready message. As a client the newly &#8220;hooked&#8221; system is loaded with additional OS level features. One would probably be an audio version of a software defined radio (mod&#8217;d for use in the LF range). With a SDR, once clients or peers could form a robust mesh.  I&#8217;m sure someone already mentioned this but the number of threads got a bit large for a catch-up read. My apologizes. Now, how about a parasitic response client. Something that might ring the crap of of an infested host&#8211;just for fun.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209128">

			<div class="comment by-alain-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">Alain from Switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209128">
						November 5, 2013 4:31 AM					</a>

				</p>

				<p>&#8220;Although it sounds theoretically and practically feasible, I doesn&#8217;t look like a very efficient method to me. If I were a resourceful spying agency interested in bridging the air gap, I&#8217;d probably look into covert powerline communications instead of messing about with sound.&#8221;</p>
<p>I see your point, especially in the context of the &#8220;badBIOS&#8221; story, but generally my impression is the following:</p>
<p>From all the facts and programs that have been revealed about the NSA this year, it seems reasonable to assume that the NSA (and others) are exploring and trying to exploit ALL possible channels that could bridge an air gap, just like they are also otherwise looking for all ways to get information. For example, I could well imagine that someone uses a notebook computer with wireless/bluetooth hardware removed and battery operated only, but forgets about microphones and speakers or any other hardware that might produce or detect sound. Malware that is transported via USB sticks or so to the air gapped notebook could then make use of that to communicate back across the air gap. I guess in some cases, like a &#8220;high-profile&#8221; target in a country where you cannot get physically close, a slow connection via sound might be better than no connection at all. Having a few people explore the possibility would only consume a very small fraction of a budget that is at least 10 Billion $.</p>
<p>Moreover, I would expect the air gap now to become relatively fashionable among journalists, activists and maybe even artists to protect their original work, as well as of course also among criminals and so on. Air gaps got quite some media attention since the people who published the NSA revelations had been using them, not quite mainstream attention, but still&#8230;</p>
<p>About specifically the &#8220;badBIOS&#8221; I don&#8217;t know, will be interesting to hear what (if anything) remains in the end. If a lot of it was true, though, its robustness would maybe remind me most of a &#8220;Kalashnikov&#8221; of Malware 😉 ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209129">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209129">
						November 5, 2013 5:13 AM					</a>

				</p>

				<p>@ Mike the Goat,</p>
<p>With regards &#8220;ducks in a row&#8221; I don&#8217;t think he&#8217;s investigated that far yet, and that it&#8217;s still an ongoing investigation.</p>
<p>Take for instancs the SDR claim and what&#8217;s involved with SDR. If you are looking at a sampaling system from the software side not the transmission side then you would actually see very much the same activity with SDR that does baseband (zero IF) convertion that you would with an audio signal. What differentiates them is the zero offset RF oscillator and upconverter on the output of the sound card.</p>
<p>Now one thing I do know having seen/heard it is those fast rising edges out of a sampling system are rich in harmonics and any nonlinear component will act as a &#8220;mixer&#8221; and you will on a spectrum analyser see lots of spurs on a Sin X over X pattern centered on multiples of the sampling frequency. If your spectrum analyser has the appropriate detector circuitry you will hear the generated audio on those spurs.</p>
<p>So if the EMC filter components are not there you will see RF energy at the output, modulated with audio. Now seeing that could lead you investigation down a blind ally for a period of time.</p>
<p>What makes it worse is that these days due to cost sensitive nature of PC and importantly Laptop production all manner of methods are tried to minimise or remove the expensive and often bulky EMC filter components.</p>
<p>One method that has been used for years is to add jitter to the system clock &#8211;which is a DSSS technique used as &#8220;whitening&#8221;&#8211; such that all spurs get spread across the RF spectrum. That way the laptop will just get inside the EMC Masks so EMC components are not required&#8230;</p>
<p>Now the thing is many people beleive that this jitter causes their systems to be unreliable so they turn it off in the BIOS&#8230; So much so that some manufacturers started turning it off by default prior to shipping&#8230;</p>
<p>So I can see a fairly clear route by which somebody investigating this suspected malware could go down a blind ally quite easily.</p>
<p>Now there is another issue and that&#8217;s journalists and their low reputation for checking facts and or hype and pushing their own &#8220;make it sexy&#8221; line. If you have a hunt on the internet you will see that atleast one journalist gets singled out for comments about this sort of behaviour.</p>
<p>Now the issue is Ruiu is activly investigating so you would expect to see him to dropped into and pulled out of blind allys, in almost the same way police investigators do with suspects in serious organisd crime. The difference is that he is blogging about his investigation as it unfolds, the Police however have been repeatedly bitten by journalists in the past and thus are naturaly weary of what they say to them.</p>
<p>So if a journalist conntacted Ruiu and Ruiu did not clearly state the terms of refrence for the &#8220;chat&#8221; then it leaves it open for the journalist to do what they will and some will push it to far and not go back and check the details with the source. Now ask yourself honestly if a journalist contacted you over your blog entries would you know to set the terms of refrence and how not to leave the journalist wriggle room?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209130">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209130">
						November 5, 2013 6:24 AM					</a>

				</p>

				<p>Nwfor: yeah, I postulated on the idea of borrowing some concepts from AX25 and modern mesh networking to form a kind of mesh. You could even do something a lot simpler. Using the system clock to pick a time where nobody is likely to be around all hosts pick a random time to send their station ID burst. Every five minutes the process is repeated (in case of collisons) all hosts are elucidated or the hour has been used up. If the ARP like broadcast burst include not only a station ID but whether it has a route out to the Internet and also the station ID of peers it can also hear (along with quality or SNR estimates) then a mesh can be created with peers choosing the most convenient path to an internet connected node.</p>
<p>Clive: yes, that&#8217;s what I was thinking. It is clear from his twitter feed that he is hypothesizing about how this malware is functioning and hasn&#8217;t clearly elucidated exactly how it works. I don&#8217;t believe he is being deliberately deceptive as some on other forums have suggested (with someone saying he has a shill for MITRE to promote their Copernicus tool)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209131">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209131">
						November 5, 2013 6:53 AM					</a>

				</p>

				<p>@Clive<br />
&#8220;So if the EMC filter components are not there you will see RF energy at the output, modulated with audio. Now seeing that could lead you investigation down a blind ally for a period of time.&#8221;</p>
<p>Exactly. What ticks me off most about this badBIOS story is the idea that this thing can infect all OS platforms and all hardware equally well. Such a system would be extremely convoluted and brittle (bug-free code, anyone?).</p>
<p>Technically, all steps are physically possible. We can imagine a small payload that infects some persistent memory in most hardware, say the BIOS, and then downloads the necessary specific software for infection.</p>
<p>But such a thing would be extremely complex, with versions for all combinations of hardware and software releases. And then it communicates with a nearby co-infected computer over (ultrasonic) audio.</p>
<p>Targeted to a few specific computers in a specific locality, I can see that. Stuxnet was targeted at a specific site, a unique plant even. Just thrown out into the wild it would be extremely brittle I think.</p>
<p>What it looks to me is that he is trying out all physically possible scenarios. In the end, he just might have a mole in his organization that is spying on him. And he is looking at the wrong places.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209132">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209132">
						November 5, 2013 7:06 AM					</a>

				</p>

				<p>Winter: yes, if this was win32 malware that used audio to communicate and inserted itself into Phoenix BIOS&#8217;s as an ISA component to ensure persistence then it would be more believable than something that supposedly works on all OS&#8217;s and can infect magically just by a USB flash drive (not even mounting it, he claimed). None of the individual claims are outrageous by themselves nor are they technically impossible.</p>
<p>I don&#8217;t think he is being deliberately deceptive. More likely he has come across something he is having a difficulty understanding and has made the judgement error of publishing a running commentary on Twitter.</p>
<p>I hope that he is right (or close to &#8220;right&#8221;) as given the amount of attention and beat up this has been given by the tech media, if it turns out to be uh, nothing (or misinterpreted wildly) then it may adversely affect his credibility and potentially future employment prospects. But I am sure he knows that and didn&#8217;t intend for this to erupt into a storm. Note I found it funny that it took almost a month before the tech media picked up on his claims. Talk about lag!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209133">

			<div class="comment by-joni ">

				<p class="commentcredit">

					<span class="commenter">joni</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209133">
						November 5, 2013 7:29 AM					</a>

				</p>

				<p>I&#8217;m a little late here and I haven&#8217;t read all of the posts above so sorry if I&#8217;m repeating, but the bit where he observed network packets is just nonsensical. How did he observe them and why would the rootkit make them observable? I would say that this is his &#8220;wink wink&#8221; to anyone who isn&#8217;t clueless.</p>
<p>A surprising number of people are taking the story seriously, but it&#8217;s the internet age so maybe they didn&#8217;t even read past the first paragraph.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209134">

			<div class="comment by-dilbert ">

				<p class="commentcredit">

					<span class="commenter">Dilbert</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209134">
						November 5, 2013 7:46 AM					</a>

				</p>

				<p>It seems that numerous people are just browsing highlights without looking at specific details of the claims.</p>
<p>1) There&#8217;s no claim that the machines have been infected via mic/speaker/audio.  Rather, it seems that there&#8217;s a persistent BIOS infection that later leads to further malware being emplaced on the affected system.</p>
<p>2) The guy hasn&#8217;t been working on this for 3 yrs.  There&#8217;s been on/off problems that he&#8217;s finally correlating into a long-term pattern of infection and now he&#8217;s trying to determine the attack vectors and components.</p>
<p>It MAY be that there&#8217;s a persistent BIOS infection, but that doesn&#8217;t mean the WHOLE package is sitting in the BIOS.  This may just be the initial vector.  Once a system is compromised it can then download further payloads to enhance functionality or capabilities.</p>
<p>It&#8217;s been proven that audio communications is possible, so why is everyone getting hung up on this issue?</p>
<p>He&#8217;s &#8220;seeing packets&#8221; that he believes are being communicated over audio channels.  If that&#8217;s the case, then the malware must implement a pseudo network interface to channel these communicators over audio ports.  Again, this has all been done therefore it&#8217;s POSSIBLE.  Until we see the actual data, binaries, network captures, etc&#8230; we won&#8217;t be able to verify the conclusions.</p>
<p>Are any of you volunteering to assist?  Or are you just sitting here throwing rocks over TCP/IP???  I&#8217;d love to get in on this, but I lack the technical chops to be of much value.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209135">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">Tom</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209135">
						November 5, 2013 8:56 AM					</a>

				</p>

				<p>&#8220;It&#8217;s been proven that audio communications is possible, so why is everyone getting hung up on this issue?&#8221;</p>
<p>The best article about this so far:</p>
<p><b>Nobody Seems To Notice Nobody Seems To Care &#8211; Government &amp; Stealth Malware</b></p>
<p><a href="http://anonymous.livelyblog.com/2012/10/05/nobody-seems-to-notice-and-nobody-seems-to-care-government-stealth-malware/" rel="nofollow ugc">http://anonymous.livelyblog.com/2012/10/05/nobody-seems-to-notice-and-nobody-seems-to-care-government-stealth-malware/</a></p>
<p>and it was originally written and published elsewhere months if not a year or more prior to this &#8220;discovery&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209136">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209136">
						November 5, 2013 9:07 AM					</a>

				</p>

				<p>Dilbert: I would love to assist and have already offered to analyze an infected thumb drive or even better an actual infected PC. As you know I am one of the few that hasn&#8217;t immediately thrown out the possibility that this is legitimate. As I have said time and time again from a social perspective then it would be pretty stupid to come out with such claims only to be found incorrect so I agree that he is personally convinced of the fact that it exists and its capabilities are as he has postulated.</p>
<p>There is nothing impossible about using the audio hardware to transmit data. To all the nay sayers download &#8220;blurt&#8221; and try it out for yourself with two laptops perhaps five feet from each other. This is a very simplistic proof of concept but it shows that it can be done. I&#8217;d suggest that by choosing your spectrum carefully, timing the time of day you choose to &#8220;talk&#8221; and by using the lowest possible amplitude to get the job done you could probably make it quite inconspicuous. You could even monitor how &#8220;noisy&#8221; the environment is and use this as a variable to determine whether it is safe to transmit or not. Given it is likely running as a win32 service (let&#8217;s assume the BIOS component is just for persistence and just injects a dropper into a file executed when windows starts up and the core of the thing runs like typical win32 malware) it could potentially use the time since last keypress or mouse pointer movement as some indication as to how idle the computer is. I am going to make a joke and suggest it could use echolocation to see if anyone is standing between it and the other infected host (okay, crap joke).</p>
<p>Joni: it is our duty as security professionals to take every threat seriously, no matter how unlikely it sounds until it is proven not to be a threat.</p>
<p>At a minimum Ruiu&#8217;s purportedly infected PCs should be taken for analysis by someone equipped to do a thorough job. This means spectrum analyzers (for the audio component), USB interface debugging equipment, etc. No doubt this will happen soon enough and we can have a conclusion to this tale.</p>
<p>Yes, I am sitting on the fence on this one. I have been in the industry long enough to see &#8220;impossible&#8221; threats that everyone said were purely theoretical or just a PoC become very real. Ruiu might only be half right. He might be dead wrong. I don&#8217;t know and neither can anyone else until we get a full analysis, with said exploit code dumped from the &#8220;evil&#8221; USB device. Sounds outlandish, I agree&#8230; A lot of variables here and it seems unlikely you could make something that infects the BIOS portable enough o spread well. That said even if you targeted Phoenix you&#8217;d get a good percentage of PCs. The BIOS bit might be incidental. An extra feature but otherwise unnecessary. If the malware exists I expect it does its audio comms in Win32 land.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209137">

			<div class="comment by-re-rose-module-packet-radio ">

				<p class="commentcredit">

					<span class="commenter">re: rose module / packet radio</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209137">
						November 5, 2013 9:22 AM					</a>

				</p>

				<p><a href="https://github.com/djrbliss/rose-exploit" rel="nofollow ugc">https://github.com/djrbliss/rose-exploit</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209138">

			<div class="comment by-noe ">

				<p class="commentcredit">

					<span class="commenter">Noë</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209138">
						November 5, 2013 9:40 AM					</a>

				</p>

				<p>A demonstration of  ultrasonic networking with a laptop and a smartphone.</p>
<p><a href="http://youtu.be/w6lRq5spQmc" rel="nofollow ugc">Ultrasonic Networking using the Web Audio API </a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209139">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209139">
						November 5, 2013 9:40 AM					</a>

				</p>

				<p>@Mike the goat</p>
<blockquote><p>Wael: I don&#8217;t think the guy has claimed that infection can occur via audio, only that two already infected machines can communicate via audio in the absence of a traditional network.</p></blockquote>
<p>I also see implied in Ruiu&#8217;s statements that badBIOS can reassemble it&#8217;s self after system wipe plus BIOS rewrite and use audio based data transmission during that phase.  It sounded to me like the wiped system described didn&#8217;t have any other code sources than what was already on it, the OS install disk, and over audio.  They wiped it clean to a level they thought was clean, but enough bits were still there.  Those bits were enough to initiate a rebuild of the full exploit kit, and they saw that kit in action as they worked on it.  I&#8217;d really love to have a proper image of all the system&#8217;s FLASH and EEPROM memories.</p>
<p>@George William Herbert, safe data transmission.<br />
I&#8217;d use serial, and heavily audit the code used for the file transfer.  The device that strips the 8th bit sounds interesting, but could also be mostly done by setting both serial ports to only transmit 7 bit characters.  Knowing only 7 bit printable characters get though is way to easy to get around, but it does make sending over a buffer overflow much harder, but maybe not impossible.  The Raspberry PI has a serial port on the P1 connector, and some of the handshake lines are on the P5 connector.  It will need level translation hardware as the port pins are only 0 to 3.3V, but that is a simple chip, or could even be made using transistors and resistors.  USB to serial port chips could also be used if serial ports are lacking on the system, but they may have a hidden microcontroller in them.</p>
<p>@DDB<br />
The write lock switches only work on some SD cards.  From years ago I do remember some ads saying their write switch was truly effective.  Those ads made me not trust the switches at all.  A bigger issue is the on board controller and the unused replacement FLASH blocks.  My guess is the controller code could be changed on most SD cards, and the replacement FLASH blocks used for storage of exploit code or side channel data.  So, even if you used 100% of the physical space on the card, data could still be transferred in the bits that aren&#8217;t normally accessible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209140">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209140">
						November 5, 2013 10:17 AM					</a>

				</p>

				<p>Bryan: if you are interested I made my device using an ATMega164P and two MAX232 level converter ICs. The code is pretty simple. On boot it checks two GPIO pins that determine how it functions &#8211; depending on how they are set it will either allow full duplex comms, allow unidirectional u1&gt;u2, allow unidirectional allow u1&lt;u2. So there are two controls &#8211; an on/off toggle, and a two position toggle (top setting allows comms to my secure machine, middle setting allows bidirectional, bottom allows comma from my secure machine). Any change of the toggle during operation will cause a reboot, as the GPIO pins are only checked on boot up. The reboot is forced by a microswitch on the button cover (got the whole assembly from an aircraft boneyard, complete with a switch that actuates when you open the switch cover) &#8211; very simple.</p>
<p>Unfortunately it is limited to 9600bps but is perfect for my use (moving text and code backwards and forwards to sign/crypt). If I must move binary I uuencode or base64 first. The whole high ASCII restriction was an effort to mitigate buffer overflows in the RS232 code in the kernel, not to stop binaries from moving backwards and forwards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209141">

			<div class="comment by-uhu ">

				<p class="commentcredit">

					<span class="commenter">Uhu</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209141">
						November 5, 2013 11:32 AM					</a>

				</p>

				<p>I get the impression that we slowly get to the conclusion that what is claimed could technically be possible, but since it is an extraordinary claim (the malware would be beyond StuxNet), we would need more evidence. Unfortunately, what we have seen so far severely lacks technical details. In my opinion (and as stated by others), one of the key questions is: how does Mr. Ruiu observe packet transmissions?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209142">

			<div class="comment by-dilbert ">

				<p class="commentcredit">

					<span class="commenter">Dilbert</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209142">
						November 5, 2013 12:42 PM					</a>

				</p>

				<p>Why does everyone keep claiming this is &#8220;beyond StuxNet&#8221;?  There&#8217;s no real basis for comparison IMHO.  StuxNet infected systems, then targets Siemens industrial control systems in order to intentionally damage nuclear centrifuges.  What does that have to do with this possible badBIOS malware in any way?  The only correlation that I can see is that USB drives are a possible infection vector&#8230; beyond that I don&#8217;t see anything that can be directly compared.  Any judgement of &#8220;difficulty&#8221; is just a matter of opinion &#8211; at least until we see the actual code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209143">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209143">
						November 5, 2013 12:52 PM					</a>

				</p>

				<p>@Bryan</p>
<blockquote><p><i>I took that paragraph to mean the air-gapped computer wasn&#8217;t fully cleaned of infection.</i></p></blockquote>
<p>I can see how that paragraph could also be read that way. And I think that that lack of clarity in the original article is the root of the problem here.</p>
<p>So we end up with discussions of whether X can be done in a lab between two very specific systems.</p>
<p>And Y.</p>
<p>And Z.</p>
<p>And (for suitably broad cases of X) (for suitably specific systems) the answer is usually &#8220;yes&#8221;.</p>
<p>The discussion then becomes exactly how broadly defined X, Y and Z are and how specific the specific systems need to be.</p>
<p>Can a USB stick overwrite the BIOS of a specific motherboard? Yes. That&#8217;s how I upgrade the BIOS on my systems.</p>
<p>Can one USB stick (reformatted) overwrite the BIOS&#8217;s from 3 different vendors on 30 different motherboards (no OS) and still work sufficiently that it can use the microphone/speaker to download more code? I find that difficult to believe.</p>
<p>I am willing to donate a computer for testing. Is anyone setting up a lab?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209144">

			<div class="comment by-kevin ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://wiki.openwrt.org/doku.php?id=oldwiki:port.gpio' rel='external nofollow ugc' class='url'>Kevin</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209144">
						November 5, 2013 1:26 PM					</a>

				</p>

				<p>To answer David Dyer-Bennet&#8217;s question about the SD memory card &#8220;write lock&#8221;, as mentioned by wim/bryan this does not physically prevent writes, it is up the the card reader/adapter and/or the OS to enforce the write lock.   Some card reader interfaces will prevent the host computer from writing when the lock is set, but not all.</p>
<p>For all the cards I have seen, the card itself doesn&#8217;t have any way to enforce the write lock, the card doesn&#8217;t even know the position of the switch, which is not an electrical switch but rather a piece of plastic that slides down and interacts with a true electrical  or optical switch in the SD card socket on the reader.</p>
<p>If performance and capacity is not a consideration, you can directly interface to the SD card using a simple serial protocol on GPIO using the older protocol provided for backwards compatibility to the old MMC form factor.   The WRT54 team has quite a bit of info on this topic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209145">

			<div class="comment by-david-alexander ">

				<p class="commentcredit">

					<span class="commenter">David Alexander</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209145">
						November 5, 2013 2:03 PM					</a>

				</p>

				<p>Surely this must be a hoax if it claims to be working across an airgap with no previous interactions. The microphone would need to have a compromised device driver in order to respond to the audio tones (of whatever frequency). For this to work the airgapped machine would need some malware loaded from media of some kind so that it could then communicate this way. This could not spread by sound alone unless the systems were already pre-loaded with the modified device driver beforehand.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209146">

			<div class="comment by-mike-anthis ">

				<p class="commentcredit">

					<span class="commenter">Mike Anthis</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209146">
						November 5, 2013 2:38 PM					</a>

				</p>

				<p>&#8220;Now they know how many holes it takes to fill the Albert Hall.  I&#8217;d love to turn you on.&#8221;</p>
<p>This story has what it takes to trigger a geek frenzy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209147">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209147">
						November 5, 2013 4:38 PM					</a>

				</p>

				<p>@ Mike the Goat, Bryan,</p>
<p>If you think about it the one thing Ruiu&#8217;s little experiment did show is the code is not overwriting the BIOS in ROM&#8230; So maybe we should stop calling it BadBIOS.</p>
<p>It&#8217;s almost directly pointing to something a GoodBIOS (TM) does normaly to load executable code into memory (which is the expansion card extention from AT bus onwards). I pointed this out on the Friday Squid page and Jacob handily posted a link showing exactly how to do it.</p>
<p>As it happens it&#8217;s relativly easy to disable this functionality in the ROM code (look for the memory test for OxA5A55A5A and fail it). Unfortunatly it may disable the functionality of some of the IO devices. But if this done and the malware does not return you have the proverbial smoking gun.</p>
<p>I&#8217;ve also been thinking further and I would now say that this malware is aimed specificaly at laptops not at desktops or servers.</p>
<p>Importantly with laptops you know in advance what sound card chips are going to be used for two reasons, firstly they are soldered to the mainboard, and secondly in general laptops use a very limited set of generic sound chips, probably more limited than the range of CPUs&#8230;</p>
<p>Further I don&#8217;t think the software is going to be very large as most of it&#8217;s already built into the sound card as standard and it&#8217;s going to be more a case of calling existing subs than coding from scratch.</p>
<p>I also have an incling that the software was designed to infect laptops at conferances on those give-away USB drives with all the marketing PDFs and as such may exploit one of the myriad of Adobe PDFviewer bugs that were endemic back three years or so ago. Back then as an infection vector the USB/PDF combination would have had very close to 100% success rate of infection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209148">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209148">
						November 5, 2013 7:04 PM					</a>

				</p>

				<p>@Mike the goat,<br />
I&#8217;ve got plenty of leftover MCUs from various projects to make one from if I want to. 😉 I even have a few tubes of the RS232 level converters.  I guess that&#8217;s what I get for having an electronic hardware hobby for a few decades.</p>
<p>@Brandioch Conner</p>
<blockquote><p>Can one USB stick (reformatted) overwrite the BIOS&#8217;s from 3 different vendors on 30 different motherboards (no OS) and still work sufficiently that it can use the microphone/speaker to download more code? I find that difficult to believe.</p></blockquote>
<p>Maybe.  I see no reason it wouldn&#8217;t work.  BIOSes have defined interfaces that can be linked to and used for doing lots of things.  I&#8217;d guess if you know 0 days for the USB interfaces for a bunch of different OS/BIOS combinations you could also just try them all and see what sticks to the wall. :}  When something sticks, send the rest of the exploit for that system over.  This isn&#8217;t rocket science.  It&#8217;s plain and simple dotting the Is and crossing the Ts.  Computers can be very patient and thorough if programmed to be that way.  Also store the exploit code in the reserved pages on the FLASH device.</p>
<p>Clive filled in/confirmed the last details I was wondering about.  Thinking about it a bunch while I broiled lots of bacon for bacon bits, I&#8217;d be willing to bet that the persistent infection code is all stored in the device&#8217;s BIOS extension blocks, or whatever they are called.</p>
<p>@Clive Robinson</p>
<blockquote><p>It&#8217;s almost directly pointing to something a GoodBIOS (TM) does normaly to load executable code into memory (which is the expansion card extention from AT bus onwards). I pointed this out on the Friday Squid page and Jacob handily posted a link showing exactly how to do it.</p></blockquote>
<p>I&#8217;ve wondered about this, but I&#8217;ve never been a PC BIOS device driver coder so I don&#8217;t know how all that really works and has changed over time.  My device driver coding experience is under UNIX or embedded mircocontrollers.  They are different beasts.  I at least figured the extra space on the memories is a good spot to store persistent parts of the exploit.  They could easily be grafted in as part of the device&#8217;s code.  That would take a bit more pre planning and be a bit less flexible, but it would also be allot better at not causing bad side effects the target will see.  Weren&#8217;t those odd images Ruiu mentioned 4k and 8k in size&#8230; Hum&#8230; Perfect size to replace a specific controller&#8217;s BIOS block.  Looks like the space needed for the extra code in the CDROM handling code block squeezed out the code for booting from CDROM.</p>
<blockquote><p>Further I don&#8217;t think the software is going to be very large as most of it&#8217;s already built into the sound card as standard and it&#8217;s going to be more a case of calling existing subs than coding from scratch.</p></blockquote>
<p>I&#8217;d figured this out too.  It only makes sense to use what&#8217;s already there, and could potentially be different for different hardware.  Also, why rewrite what already exists.  If you do, then you must take into account hardware differences, and do you know them all?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209149">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209149">
						November 5, 2013 7:32 PM					</a>

				</p>

				<p>@Bryan</p>
<blockquote><p><i>Maybe. I see no reason it wouldn&#8217;t work. BIOSes have defined interfaces that can be linked to and used for doing lots of things.</i></p></blockquote>
<p>I do not know of any BIOS that controls the microphone.</p>
<p>Could you post the motherboard make/model and BIOS version of yours that does? Thanks!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209150">

			<div class="comment by-romulo-cholewa ">

				<p class="commentcredit">

					<span class="commenter">Romulo Cholewa</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209150">
						November 5, 2013 7:45 PM					</a>

				</p>

				<p>It is really hard to believe that a cheap mic or speakers are capable of listening to or even &#8220;speaking&#8221; in ultra high frequencies to one another.</p>
<p>These components are hardly capable of going beyond 20KHz.</p>
<p>If this is happening, other components are being used.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209151">

			<div class="comment by-visz ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tbd.my' rel='external nofollow ugc' class='url'>visz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209151">
						November 5, 2013 11:00 PM					</a>

				</p>

				<p>it is not a hoax.. i believe schenier and Dan are keeping their reputation well. How could the virus spreads through air gaps ? It must be a surveillance system that can do those thing</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209152">

			<div class="comment by-vinzent ">

				<p class="commentcredit">

					<span class="commenter">Vinzent</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209152">
						November 6, 2013 12:58 AM					</a>

				</p>

				<p>@Romulo Cholewa:</p>
<p>For microphones I&#8217;d say, yes, probably.</p>
<p>But speakers (especially small ones, like those used in Laptops) are perfectly capable of delivering 20 kHz, even though in most cases they will probably be outside the linear range (well, sound quality doesn&#8217;t really matter in the scenario, does it?).</p>
<p>Additionally, you don&#8217;t even need to go ultrasonic to appear virtually silent, because</p>
<p>a) the ear is more sensitive to certain frequencies, that means to mask in ambient noise you can use a louder signal with increasing frequency, and<br />
b) the duration of the noise is also quite important, not only because a certain energy is required to actually move things at the receiving end, even if it is just small hairs (which would pose a similar problem to the microphone), but also because this very advanced post-processing filter called brain. So, you could deliver the sound in short bursts (say 10 or 20 ms, which makes it four to eight complete sine waves at 20 kHz) to make them even more inaudible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209153">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209153">
						November 6, 2013 1:22 AM					</a>

				</p>

				<p>Clive: I like that. GoodBIOS®</p>
<p>Romulo: I think Vinzent gave a good response but I will offer that your malware could simply negotiate the highest frequency (and baud rate) that works.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209154">

			<div class="comment by-alain-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">Alain from Switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209154">
						November 6, 2013 1:29 AM					</a>

				</p>

				<p>Regarding initial infection via sound, here&#8217;s a clear disclaimer from Dragos Ruiu, from his <a href="https://plus.google.com/103470457057356043365/posts" rel="nofollow ugc">Google+ Account</a>, see the comments of the post of November 3rd with the 0-50kHz spectrum image:</p>
<blockquote><p>
[other poster] Are you hypothesizing that the motherboards/BIOS could be shipping &#8220;ready and listening to be infected&#8221; straight from the manufacturer, hence the ability to infect a clean and disconnected computer? I would assume such a state would be ensured only by the interference of something with nation-state-sized resources.</p>
<p>[Dragos Ruiu Nov 3, 2013] No these machines were probably infected via traditional means or USB. Wish folks would get off this infected by audio nonsense. The audio is only a c&amp;c channel between infected machines to bypass air gap.
</p></blockquote>
<p>Regarding the story as a whole: According to <a href="http://www.limit.ws/researcher-skepticism-grows-over-badbios-malware-claims/" rel="nofollow ugc">this article</a> and all I have seen like so far nobody found anything in provided BIOS, font files, disk dumps, etc. Apparently two (supposedly) infected laptops have been sent to other researchers:</p>
<blockquote><p>
&#8220;I’ve surrendered up a couple of my laptops. We had somebody fly in from New York and pick some up yesterday,&#8221; he told Ars on Tuesday, declining to identify them by name. &#8220;They’re going to have some smart guys force some eyes on it. We’ll get some peer review and find out if I’m completely losing it or if we found something significant.&#8221; Then, he paused for a moment and added: &#8220;By the way, I still don’t think I’m losing it.&#8221;
</p></blockquote>
<p>To me feels to be most likely an illusion in the end, nothing real, but also no pressure to judge, just yet 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209155">

			<div class="comment by-saint-crusty ">

				<p class="commentcredit">

					<span class="commenter">Saint Crusty</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209155">
						November 6, 2013 1:59 AM					</a>

				</p>

				<p>Theorising is one thing but here goes. In reverse order of boldness. Wild speculation starts here.</p>
<p>1) The researcher&#8217;s machines had already been compromised with what i&#8217;d dub crippleware. Payload was delivered but &#8216;dead&#8217; and exists of fragments. The real malware would only &#8216;boot&#8217; if all pieces were present, say by inserting an USB key.</p>
<p>2) There is a possibility of a covert channel which is even more theoretical than anything else.  The article(s) explicitly state the two computers communicating were close to one another. Could this imply somehow the magnetic field of the speaker or the sensitvity to electric/magnetic fields of the microphone were used  to measure information in some alternate way ? Could it be the voltage of these components can be &#8216;steered&#8217; ?</p>
<p>In some office environments this could be an ideal way to maintain covert communnications.</p>
<p>3) Did the researcher try removing only the microphone and/or speaker ? What happened then ? Did he apply a voltage meter to these components while in operation ?</p>
<p>4) I&#8217;ve been called paranoid by people too many times not to take this seriously. By now i&#8217;m in dire need of some luck as the ethical corruption in corporations is upsetting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209156">

			<div class="comment by-saint-crusty ">

				<p class="commentcredit">

					<span class="commenter">Saint Crusty</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209156">
						November 6, 2013 2:04 AM					</a>

				</p>

				<p>5) The data on Google+ and <a href="http://threatpost.com/dragos-ruiu-on-the-badbios-saga" rel="nofollow ugc">http://threatpost.com/dragos-ruiu-on-the-badbios-saga</a> are valuable. He&#8217;s probably not measuring unstable eletric current on his power supplies.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209157">

			<div class="comment by-saint-crusty ">

				<p class="commentcredit">

					<span class="commenter">Saint Crusty</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209157">
						November 6, 2013 2:05 AM					</a>

				</p>

				<p>6) He&#8217;s considering to release a record</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209158">

			<div class="comment by-andrew-crystall ">

				<p class="commentcredit">

					<span class="commenter">Andrew Crystall</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209158">
						November 6, 2013 8:07 AM					</a>

				</p>

				<p>That this stuff is even potentially possible really backs up my feeling that UEFI is going the wrong way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209159">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209159">
						November 6, 2013 8:35 AM					</a>

				</p>

				<p>Alain: I had a look at kit.tgz and found nothing untoward. the BIOS dump he posted was benign too.</p>
<p>I really hope there is some substance to this for Dragos&#8217; sake, but it seems less and less likely.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209160">

			<div class="comment by-alain-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">Alain from Switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209160">
						November 6, 2013 9:07 AM					</a>

				</p>

				<p>Mike: I agree. From what I have seen, I never got the impression that Dragos Ruiu was dishonest and after the arstechnica article was out, it seemed to me that he has been very helpful with providing everything needed to clarify the issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209161">

			<div class="comment by-phosphor ">

				<p class="commentcredit">

					<span class="commenter">Phosphor</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209161">
						November 6, 2013 10:58 AM					</a>

				</p>

				<p>Ultrasonic is analog, computers are digital. Unless you have a converter that can change that ultrasonic wave to ones and zeros. Maybe. Otherwise it would be the same sending smoke signals to your computer. And totally incompatible with your WiFi signal.</p>
<p>Also Ultrasonic travels primarily through air which makes the statement “Air Gap” a double statement. If it was a Vacuum there would be no ultrasonic wave.</p>
<ul>
<li>Marc Detrick</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209162">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209162">
						November 6, 2013 11:38 AM					</a>

				</p>

				<p>Today ArsTechnica reports growing researcher skepticism re: BadBIOS.<br />
<a href="http://preview.tinyurl.com/l6oh2bj" rel="nofollow ugc">http://preview.tinyurl.com/l6oh2bj</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209163">

			<div class="comment by-thinfoilhatman ">

				<p class="commentcredit">

					<span class="commenter">ThinfoilHatMan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209163">
						November 6, 2013 12:16 PM					</a>

				</p>

				<p>A couple of questions for anyone who might know:</p>
<ol>
<li>
<p>can a speaker be turned to a microphone with just a change in the driver?</p>
</li>
<li>
<p>could this sort of malware explain the static I hear when I listen to music on my PC?</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209164">

			<div class="comment by-aspie ">

				<p class="commentcredit">

					<span class="commenter">Aspie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209164">
						November 6, 2013 1:15 PM					</a>

				</p>

				<p>@TinfoilHatMan</p>
<p>I&#8217;m sure others will wade in with this with more sagacity but:</p>
<p>the answer is yes, it can be a <i>very poor</i> microphone, however &#8230;</p>
<p>The problem, as I see it, is that a speaker is designed to emit rather than collect sound so its design is more for the former than the latter.</p>
<p>Second it needs to be connected to sensitive amplifiers to pick up a usable signal. In addition to which, again because of its design, it has a completely different frequency response to a good microphone because it&#8217;s designed to move air to make sound rather than with delicacy to allow air to move it.</p>
<p>The static you hear is either poor quality audio from the PC sound card, a noisy transistor in the audio amp stage or a bad PSU passing through noise from the mains (if you&#8217;re using mains).</p>
<p>As for drivers, I doubt that amps can be reversed by them but then again there was always that splendid <a href="https://en.wikipedia.org/wiki/Thing_%28listening_device%29" rel="nofollow ugc">Theremin</a> thing &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209165">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209165">
						November 6, 2013 2:12 PM					</a>

				</p>

				<p>@Brandioch Conner</p>
<blockquote><p>@Bryan</p>
<blockquote><p>Maybe. I see no reason it wouldn&#8217;t work. BIOSes have defined interfaces that can be linked to and used for doing lots of things.</p></blockquote>
<p>I do not know of any BIOS that controls the microphone.<br />
Could you post the motherboard make/model and BIOS version of yours that does? Thanks!</p></blockquote>
<p>Please do just a bit of research.  ALL of the motherboards I&#8217;ve bought in the past 10 years have had integrated sound IO systems.  They are a dime a dozen out there in the real world.  Look up the VESA BIOS extensions, especially VBE/AI.</p>
<p>@Saint Crusty</p>
<blockquote><p>1) The researcher&#8217;s machines had already been compromised with what i&#8217;d dub crippleware. Payload was delivered but &#8216;dead&#8217; and exists of fragments. The real malware would only &#8216;boot&#8217; if all pieces were present, say by inserting an USB key.</p></blockquote>
<p>I doubt this.  There is no need.  Use the VESA BIOS extensions to get the reinfection code running.  It can then load other modules squirreled away in other places around the system.  Places like the USB controller&#8217;s FLASH code memory.</p>
<blockquote><p>2) There is a possibility of a covert channel which is even more theoretical than anything else. The article(s) explicitly state the two computers communicating were close to one another. Could this imply somehow the magnetic field of the speaker or the sensitvity to electric/magnetic fields of the microphone were used to measure information in some alternate way ? Could it be the voltage of these components can be &#8216;steered&#8217; ?</p></blockquote>
<p>N squared is not your friend.  Electro magnetic links like used for RFID tags have severely limited range, and that is even for tuned transmitters and receivers.  I&#8217;d bet that they would need to be within a foot or so of each other.  TI has some very good white papers on this.  They also sell some nice RFID tag reader evaluation modules.  I used one of them to make a RFID reader for cattle use.  Years ago RFID tag readers were expensive, so I made my own.  Learned allot, and saved over a thousand.</p>
<p>@ThinfoilHatMan</p>
<blockquote><p>1. can a speaker be turned to a microphone with just a change in the driver?</p></blockquote>
<p>It would take a hardware change.  The speaker would need to be hooked up to an ADC, but then some ADC input lines could be doubled up as a DAC output line.  It would depend on the chipset that provides the sound system and the components on the motherboard.  I don&#8217;t know if any do double up an ADC input with an DAC output.  A side note:  It is becoming common for microcontrollers to have multiple peripherals assigned to each IO pin, and peripherals to assignable to alternate pins.  The Broadcom SoC chip used in the Raspberry PI even has this capability.  What it means is some peripherals can be moved from pin to pin, but this usually also requires differences in the circuit board the chip is connected to.  Because the amplifier used to drive the speaker is likely a one way circuit, then it is highly likely even with chipset support it would not be possible.  Of course, what if the amplifier is part of a reconfigurable analog chip, then it may be possible.  There are analog equivalents of the FPGA.  To answer our question, in all likelihood, no, but that doesn&#8217;t mean that it isn&#8217;t possible for some odd system now, and hardware changes in the future may make it easy.  The tech is there, just not implemented.</p>
<p>So, what tools can we use now to find and disinfect systems with compromised VESA BIOS Extension chips, and USB drives?  JTAG is very cumbersome to use to detect and cleanup infections, but it may be the only way.  This is because the system may prevent you from getting direct access to the hardware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209166">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209166">
						November 6, 2013 2:32 PM					</a>

				</p>

				<p>The ONLY problem that I see with this explanation is<br />
How do you simultaneously infect three or more different computers with very different OS&#8217;s all at the same time.</p>
<p>It seems to me the solution might be easier then a lot are assuming.</p>
<p>Think about a typical Air-gapped computer system setup. From my experience all computers on the air-gapped side are basically the same OS and usually very similar hardware. This is done to simplify the maintenance issues.</p>
<p>So in reality we can infect the air-gapped systems ONE at a time. First off we could try a *NIX variant, second try Windoze third iOS and so on. The process does not need to be done in parallel IF you control one point, where the USB stick is regularly inserted  then simply go through the list of likely target os&#8217;s for the air gapped side, as they said the reinfection often took weeks to occur.</p>
<p>The other thing that makes this attack mode interesting is the likelihood that both Air-gapped and Internet connected servers will be co-located in the same air-conditioned space. I&#8217;m thinking about commercial air-gapped systems rather than something an individual or military might do.</p>
<p>Even for an individuals air-gapped system I&#8217;ll bet people regularly operate their isolated laptop in the same room as their internet connect computers so this return channel can work somewhat real time. What concerns me most is the likelihood that the normal return vector is over the data channel of the targets smartphone.  Think about it how many people using an air-gapped laptop have a smartphone in their pocket at the time. This makes surreptitious comms using audio an ideal vector for smartphone infection of air-gapped PC systems. As I&#8217;ve said before, I&#8217;ve seen security aware IT managers actually plug their 3G connected smartphone into the USB port of an air-gapped network computer to recharge, (as everyone with a smartphone knows battery life is miserable).  Do this once and get infected from then on the info flows easily over the acoustic path.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209167">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209167">
						November 6, 2013 2:53 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>You bring an interesting dimension into the discussion &#8212; The cell phone.</p>
<blockquote><p>As I&#8217;ve said before, I&#8217;ve seen security aware IT managers actually <b>plug their 3G connected smartphone into the USB port of an air-gapped network computer</b> to recharge</p></blockquote>
<p>Then, technically,  their &#8216;puter is no longer air gapped.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209168">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209168">
						November 6, 2013 3:04 PM					</a>

				</p>

				<p>Re Using Speaker as a microphone</p>
<p>As others have said it is possible BUT makes a bad microphone and is especially bad at high frequencies due to the high weight of the speaker diaphragm, compared with a typical microphone diaphragm .</p>
<p>These days the speaker amplifier is almost always a ClassD amplifier.</p>
<p>Most ClassD amps still use analog in =&gt; analog out so their is very little risk of a return channel unless someone intentionally solders a wire from the driver back to a microphone (along with a suitable potential divider network) (2W class D amp uses 5V supply, a typical ADC might have a maximum 1.8V input signal)</p>
<p>BTW when the speaker is connected to an amplifier the amplifier output impedance acts as an active load to suppress any movement of the speaker diaphragm so the sensitivity of this parasitic mic is further reduced.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209169">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209169">
						November 6, 2013 3:49 PM					</a>

				</p>

				<p>Re Audio cards.<br />
 Their might be a large variety of audio cards available but the truth is that 90% of the PC market uses Realtek audio chips especially for motherboard audio. They have such a large percentage share because the price for this function (AC97 audio) is VERY low so no other vendor wants to supply chips at this price point.  This is good news for an attacker because they can just focus on Realtek&#8217;s chipset and firmware.</p>
<p>Something for the security paranoid to consider: In the chip market place it is common for there to be less than 3 vendors for a particular function. The sales volume is usually<br />
50% for first<br />
30% for second<br />
15% for third<br />
5% others</p>
<p>This market share breakdown is common across a wide variety of parts, so the reality is that regardless of how many PC makers you have the odds are good that you can predict the chipset used for a given function especially at the consumer level. For a given vendor even when the part number changes it firmware is usually VERY similar.</p>
<p>Now for a more interesting question. In the case of Audio chipset nobody competes because the price is too low to make money, basically an Audio chip sells for less than its production cost (or very very close to production cost) WHY would any vendor willingly participate in a market at this price point?  Maybe, just maybe, they are being compensated from other sources. Maybe this is to include functionality above and beyond the requested device spec.</p>
<p>Having worked for many years on just this sort of part, I can assure you that no PC vendor has ever audited the security processes of the Audio chip vendor.  If the specified functions are met then the vendor can stuff whatever else they want onto the Audio chip, thats their business.  the reason to be concerned with this is that both Comms and Audio require very similar design styles that fall outside the normal digital flow, additionally the SoC market just keeps integrating more and More and MORE, so an Audio chip might easily contain a Bluetooth transceiver or an NFC comms system. Many times this might be something that the vendor is  developing and has not enabled yet and simply not told anyone about.  However If you look at the chip under a microscope you&#8217;ll be able to see functional blocks that are not needed to meet the device specification. Many vendors do this sort of analysis of their competition to get an idea about what new functionality the competition is thinking about and it is surprising what you find if you look close enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209170">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209170">
						November 6, 2013 4:23 PM					</a>

				</p>

				<p>@Dilbert,<br />
 &#8220;Are any of you volunteering to assist? Or are you just sitting here throwing rocks over TCP/IP??? I&#8217;d love to get in on this, but I lack the technical chops to be of much value.&#8221;</p>
<p>I&#8217;m thinking about it BUT very wary because anyone that developed this capability did not do so by accident. This is not the work of a few script kiddies, we are talking about professional organizations with a definite mission. They will not be amused when someone uncovers and publishes even some of their secrets.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209171">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209171">
						November 6, 2013 4:46 PM					</a>

				</p>

				<p>@Bryan</p>
<blockquote><p><i>Please do just a bit of research. ALL of the motherboards I&#8217;ve bought in the past 10 years have had integrated sound IO systems.</i></p></blockquote>
<p>It looks like you&#8217;re confusing &#8220;integrated&#8221; with a microphone that is controlled by the BIOS such that it can receive updates via audio tones.</p>
<p>They are not the same.</p>
<p>Now if you want to say that you do have a motherboard that can do that, would you be able to post the make/model of that motherboard and the BIOS version?</p>
<p>Otherwise this &#8220;virus&#8221; will need at least a vulnerable OS for it to update itself.</p>
<p>Given the level of the unsubstantiated claims being bandied about, this is starting to sound more and more like the &#8220;Blue Pill&#8221; virus from earlier this century.</p>
<p><a href="https://en.wikipedia.org/wiki/Blue_Pill_%28software%29" rel="nofollow ugc">https://en.wikipedia.org/wiki/Blue_Pill_%28software%29</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209172">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209172">
						November 6, 2013 6:49 PM					</a>

				</p>

				<p>@ Brandioch Conner,</p>
<ul><i>It looks like you&#8217;re confusing &#8220;integrated&#8221; with a microphone that is controlled by the BIOS such that it can receive updates via audio tones</i></ul>
<p>I don&#8217;t know why you even thinks this is relevant. As far as I&#8217;m aware it&#8217;s only the very ill informed that are hanging on to this notion.</p>
<p>For the sake of saving you having to re-read all the relevent (not journalistic hype) information.</p>
<p>As has been repeatedly pointed out the experements have been carried out on machines that WERE PREVIOUSLY INFECTED FROM USB. The BIOS was wipped and re-installed as was the hard drive. However other Flash ROM on the system was not wiped and reloaded.</p>
<p>As I and others have pointed out the BIOS as part of it&#8217;s ordinary operation loads code from IO Flash ROM and executes it. Thus if there is malware that has overwriten an IO device flash ROM the the code gets executed no matter how many times you wipe the disk and BIOS flash ROM.</p>
<p>Do you understand this now? And do you further understand how it makes your comment irelivant?</p>
<p>@ RobertT,</p>
<p>Thanks again for reenforcing the point that there are very few on board sound chips.</p>
<p>I&#8217;ve said it a couple of times already but various people still want to believe otherwise so they can argue that &#8220;It&#8217;s all improbable/impossable&#8221;.</p>
<p>Somebody I used to know who&#8217;s job was highend clan-EmSec once said the following to me &#8220;You know what they say can be found under a pony tail? Well the same can be found under an ostriches tail feathers, and it&#8217;s most obvious when they their head in the sand&#8230;&#8221;</p>
<p>With regards using speakers as mikes yup it&#8217;s unlikely that the speaker would have a full circuit back to an A-D converter unless it was put there as a payed for extra.</p>
<p>However I can think of one non obvious way to do it. You are probably aware that some DC motor controlers these days are bridge format Class D driven and the back EMF is sampled in the off period to get speed feedback under varying load conditions. And you are probably also aware that some highend digital speaker drivers are also bridge class D. What you may not be aware of is that one UK manufacturer used the back EMF of moving coil speakers to provide linearising of the speaker response some years ago (but because the owner would not &#8220;kickback&#8221; to the old grey haired &#8220;golden ears&#8221; reviewers it did not get written up by the HiFi mags). The thought occurs to me that the same could be done with either a low end DSP block or just given as another function to the CPU core in the audio SoC.</p>
<p>However as you note the sensitivity would be rather low at best due in part to the stiffness of the cones etc.</p>
<p>@ Wael,</p>
<p>With regard &#8220;air-gaped&#8221; computers I&#8217;ve yet to see one using a commodity OS such as any MS offering or *nix offering (including Apple&#8217;s OS&#8217;s). IT bods are frequently &#8220;patching or updating&#8221; and there is no verifiable audit trail to full level test on them.</p>
<p>As @ Nick P has pointed out before it&#8217;s only a few of the specialised vertical market OS for safety and medical systems that get the &#8220;full works&#8221; certification with verifiable retest&amp;certify on patches and upgrades. But even these are potentialy a fail due to &#8220;code signing&#8221; issues.</p>
<p>Oddly one or two *nix systems only patch and upgrade source code and don&#8217;t provide executables. In theory if you can strip back and audit the source code to the required level this is the safest way to go using an appropriate data diode / sluice / verifing choke system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209173">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209173">
						November 6, 2013 7:41 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<blockquote><p>With regard &#8220;air-gaped&#8221; computers I&#8217;ve yet to see one using a commodity OS such as any MS offering or *nix offering (including Apple&#8217;s OS&#8217;s).</p></blockquote>
<p>Oh, No! don&#8217;t get senile on us, @Clive Robinson, we need you man! I am sure you&#8217;ve seen a lot of them before the internet was popular. I still have a commodore 128 😉</p>
<p>Senile = Sea + Nile.<br />
Should be Rivernile, oh, lack of sleep getting to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209174">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209174">
						November 6, 2013 8:42 PM					</a>

				</p>

				<p>@Clive R</p>
<p>Re ClassD amps</p>
<p>Bridge vs single ended: Almost all low end consumer stuff is Bridge configured ClassD because the single ended typically needs a physically large Electrolytic cap something like 470uF to set the low freq pole.  If there is room for the Cap than single ended makes some sense because the FET Rds-on losses are halved (only one series fet)</p>
<p>Normally the reason for using Bridge configuration is to double the Watts power rating for a given supply. (Eg 12V bridge configuration  results in 8w to 10W amplifier in single ended you need 22V to 24V  for the same power rating.  Typical PC&#8217;s dont have 24V supply however LCDTV&#8217;s do so LCDTV&#8217;s are often single ended whereas PC 10W amps are bridge configured.</p>
<p>These days, for any ClassD amp above 6W it is typically a standalone part Analog audio in and direct drives the Speaker.</p>
<p>It s only worth considering Integrating the ClassD with other audio functions If you use an MCM (multi-chip-module) but it creates a lot of cooling problems so it is normally avoided)</p>
<p>Re Feedback around ClassD amps<br />
 Every reasonable ClassD on the market uses feedback to linearize the transfer function. Without feedback the best you can achieve with reasonable effort is about 50dB THD.  The same device with feedback to the integrator will easily deliver 70dB THD.  For direct drive  (no filter) the output of the switching elements feedsback typically through resistors to form a summing junction at the input to the first integrator stage. There are plenty of ClassD&#8217;s that will achieve 100dB plus THD BUT they typically feedback from after the LC filter.</p>
<p>This is all way OT so I&#8217;d better stop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209175">

			<div class="comment by-schneieronsecurityfan ">

				<p class="commentcredit">

					<span class="commenter">SchneieronSecurityFan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209175">
						November 7, 2013 1:44 AM					</a>

				</p>

				<p>In looking at the researcher&#8217;s spectrogram, maybe there is electromagnetic interference that is causing a speaker to produce the ultrasound or the microphone to detect ultrasound? The lab technique should utilize multiple microphones and meters or scopes to see if they produce equal measurements. Also, the lab should be in a Faraday cage or have copper-lined walls similar to a room with a medical MRI scanner.</p>
<p>Question: Can the audio from an infected computer&#8217;s speaker be in the audible range and masked from a human listener by utilizing psychoacoustic techniques?</p>
<p>Cases: For the last two or three years in the U.S., Arbitron &#8211; now Nielsen &#8211; has provided radio stations with a device that encodes station identification (and song info?) below a listener&#8217;s threshold of perception into a station&#8217;s audio program. These sounds are then picked up by a device called the Portable People Meter that is worn by a listener which identifies the station.</p>
<p>Around 2006, cellphone ringtones in the near-ultrasound range were used by children so that their teachers wouldn&#8217;t hear it. I was surprised that the speakers of cellphones at the time could reproduce those frequencies.</p>
<p>In 2005, Nils Schneider and Bernard Leach figured out how the 1st-generation iPod could be modified so that it will boot into Linux. There is a piezo speaker inside this iPod that could be programmed to &#8220;play&#8221; the bootloader. Different sounds represent the bits. It took 20 hours in a small soundproof box for the iPod to play the bootloader as beeps. A recording was made and the sounds were turned back into the bits and bytes of the bootloader.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209176">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209176">
						November 7, 2013 2:46 AM					</a>

				</p>

				<p>SonSfan: Are you referring to RDS that carries song info and station ID on a 57kHz subcarrier?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209177">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209177">
						November 7, 2013 3:47 AM					</a>

				</p>

				<p>Wael: sea + Nile?? Man, that sounded like something my good buddy would come out with. This is a guy that walks his dog while mumbling semi coherently in a torn up Grateful Dead T-shirt that looks like it&#8217;s from when Jerry was still alive. One hell of a guy. Our local residents co-op invited him to the Halloween function the neighborhood was having and he turned up to a &#8220;child friendly event&#8221; with a four gallon gas can filled with whiskey one of his &#8220;mountain brothers&#8221; had stilled himself.</p>
<p>Yep&#8230; Some say he went to war and came back, joined the peace movement and became a pot head. Others say he has always been that way. You know what I say? That he was a well regarded cryptographer that found a novel method of breaking RSA, and the government did it to him. A cautionary tale for all of us 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209178">

			<div class="comment by-alain-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">Alain from Switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209178">
						November 7, 2013 3:53 AM					</a>

				</p>

				<p>Here is 25 min <a href="http://threatpost.com/dragos-ruiu-on-the-badbios-saga" rel="nofollow ugc">radio interview</a> with Dragos Ruiu on the &#8220;badBIOS saga&#8221; (direct <a href="http://threatpost.com/files/2013/11/digital_underground_132.mp3" rel="nofollow ugc">download</a> of mp3 file). Actually it is for large parts a monologue and shares in my view the following characteristic with the original arstechnica article: Dragos is rather inspecific about facts and especially not clearly separating facts and how they might have been obtained from interpretation, hypotheses and speculation.</p>
<p>Assuming most of what he claims would be facts, the only viable hypothesis I would see would be that some attacker with some kind of shell access even across air gaps was actively playing cat and mouse with him (and whoever else was on his side, Dragos always speaks of &#8220;we&#8221;) and in the end maybe even deleted most or all traces of activity from disks and BIOS etc. I leave it to the reader whether hoping for this possibility is enough incentive to continue to investigate this saga.</p>
<p>On the other extreme, Dragos would be just a skilled manipulator of the media and people in general, i.e. he would be the one playing cat and mouse with the audience. Previously I wote that &#8220;it seemed to me that he has been very helpful with providing everything needed to clarify the issue&#8221;, now I disagree with me, especially in light of what he says near the end of the interview regarding the immediate future. I expect this saga to just linger on without facts clarifying significantly any more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209179">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209179">
						November 7, 2013 3:57 AM					</a>

				</p>

				<p>RobertT: that&#8217;s the thing. A motherboard manufacturer needs, say an audio chip. So they put out a tender and it turns out that RealTek can give them the best price, and will throw in 1000base LAN. The motherboard vendor doesn&#8217;t know any more than we do about what goes on in the &#8220;black box&#8221; that is these accessory ICs.</p>
<p>Regarding badBIOS: if the claims surrounding BB are true then I doubt that the nation state responsible would dare try and persecute researchers. It goes against their usual m.o. of deniability, ie &#8220;uh, wasn&#8217;t us.. Couldn&#8217;t have been us. Maybe it is the Chinese?&#8221; That said we live in a crazy world and the powers that be (the real owners of this country) are likely to do anything to neutralize anyone who may have embarrassed them or exposed their agenda. If sounds conspiratorial then I apologize in advance.</p>
<p>Clive: exactly right. Dragos has said repeatedly that the audio comms is a way for two already infected machines to share data, not a vector for infection yet the tech media won&#8217;t let this erroneous claim die. Given what I have seen in the last few days I think its possible that Dragos is way beyond his depth and badBIOS may turn out to be a complete non event. Even if it does &#8211; I think it is important that we consider that malware like badBIOS is a distinct possibility.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209180">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209180">
						November 7, 2013 4:04 AM					</a>

				</p>

				<p>Alain: I agree with you here. I was a staunch defender of Dragos but his recent behavior has led me to question his motives more strongly. As I said earlier though &#8211; even if badBIOS is a hoax/misunderstanding/nothing &#8211; perhaps some good will come out of it, in that people may consider side channels when designing supposedly secure systems. For example, does a supposedly secure office terminal used solely for email and word processing need a webcam, mike and speaker? Probably not. We are starting to see corporate America wake up about the danger of data exfiltration via employee&#8217;s thumb drives with many now disallowing their use (by policy, through disabling in software, or through physically disconnecting the front ports and using a locking port cover on the rear of the PC).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209181">

			<div class="comment by-schneieronsecurityfan ">

				<p class="commentcredit">

					<span class="commenter">SchneieronSecurityFan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209181">
						November 7, 2013 9:16 AM					</a>

				</p>

				<p>Mike the goat: No, RDS is detected by the radio receivers and doesn&#8217;t effect the audio program.</p>
<p>Arbitron&#8217;s audio encoders work in the audio portion of the program, either on analog or digtial broadcasts &#8211; analog radio; digital radio, television, internet streaming, etc.</p>
<p>The Portable People Meter (PPM) is worn by a listener. The PPM &#8220;listens&#8221; to the encoded audio no matter where the listener is &#8211; in a car, an office, a party, etc. It records station identification and the time of day.</p>
<p>Here&#8217;s a link to the <a href="http://www.google.com./patents/US5450490" rel="nofollow ugc">patent</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209182">

			<div class="comment by-schneieronsecurityfan ">

				<p class="commentcredit">

					<span class="commenter">SchneieronSecurityFan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209182">
						November 7, 2013 9:39 AM					</a>

				</p>

				<p>Mike the goat: To clarify &#8211; RDS is detected by compatible receivers only; not all receivers.</p>
<p>The PPM system has greatly effected radio station ratings in the U.S. over the last two to three years.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209183">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209183">
						November 7, 2013 10:10 AM					</a>

				</p>

				<p>@ Wael,</p>
<p>You forgot</p>
<p>See + nile, which could &#8211;like watching paint dry&#8211; provide a modest soul with contemplative entertainment untill old age gets them into scams such as pyramid selling&#8230;</p>
<p>With regards &#8220;air-gaps&#8221; perhaps I should have been a little more explicit, runing a system &#8220;stand alone&#8221; is not anywhere close to running it &#8220;air-gapped&#8221;, it is but the first step on a long and arduous journey.</p>
<p>It&#8217;s a mistake many people make and I&#8217;m sure it&#8217;s a distinction that whilst lost on the average tech is ruthlessly exploited by those with a view to seeing what it is you wish to keep private (be they ordinary criminals or those in government employ).</p>
<p>@ Robert T,</p>
<p>Yup it covers it 🙂</p>
<p>The problem I have posting on an open blog to those of a higher than average knowledge is including enough detail for others to read and get not just a feeling of what&#8217;s being discussed but able with a little thought to follow along.</p>
<p>I should say that one of my pet peeves is published papers in the more general journals, that when you read them you feel they were written in compliance of George Orwell&#8217;s postulated &#8220;new speak&#8221; rules.</p>
<p>And one thing I&#8217;m contious of on this particular thread, is what should be a fairly simple discussion has taken on an almost Halloween dimension of &#8220;don&#8217;t go there it&#8217;s full of spooks with magical powers you&#8217;ve no hope of understanding bewitching your very electronic soul&#8221;.</p>
<p>Whilst some of the things sound mystical they are all fairly readily explained well within the laws of physics and plenty of practicle examples that you, I and others had provided. Which I thought had &#8220;put it all to bed&#8221; on last Friday&#8217;s Squid page quite satisfactorily. Howevere many commenters here are apparently not reading what&#8217;s been said or are misunderstanding it, and as others have noted apparently deliberatly so. Thus trying to correct the misunderstanding is giving rise to more extensive comments, which try to head off more misunderstandings before they occure&#8230;</p>
<p>Hopefully there will soon be results of other testers showing what they have tested with the how and why of the tests so all the lose threads can be brought together.</p>
<p>However of one thing we can now be certain, if such malware did not exist prior to this point it will now be developed by any number of entities because it&#8217;s been shown with enough detail for the average under grad to stitch it all together as a project in a week or so&#8230;</p>
<p>As for three letter agencies getting upset about another of their easy but obscure techniques being revieled, they realy should be used to it by now, as they don&#8217;t have a monopoly on either curiosity or inventivness and the genie is out of the bottle.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209184">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209184">
						November 7, 2013 10:29 AM					</a>

				</p>

				<p>@Alain from Switzerland<br />
Thanks! I recommend everyone listen to that. At 12:50 he starts to talk about how USB might be the vector for infection. But his description of his process sounds flawed. Like how he may have infected one of his forensics systems with a USB drive from a suspected infected system when he was trying to move a file between them.</p>
<blockquote><p><i>Dragos is rather inspecific about facts and especially not clearly separating facts and how they might have been obtained from interpretation, hypotheses and speculation.</i></p></blockquote>
<p>Yes. He claims to have seen files from this &#8220;virus&#8221; on a hard drive but never goes into specifics.</p>
<p>Even if he didn&#8217;t have the tools to take apart a BIOS he could at least have snapshotted a clean Windows box and then infected it and then snapshotted it after the infection.</p>
<p>And with network packets, even if they are encrypted, he should be able to identify the destination IP addresses and block those.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209185">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209185">
						November 7, 2013 11:27 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<blockquote><p><i>untill old age gets them into scams such as pyramid selling&#8230;</i></p></blockquote>
<p>I&#8217;ll reimburse you. Hopefully you didn&#8217;t buy a warrantee, these things last for ever 😉<i></p>
<blockquote><p>runing a system &#8220;stand alone&#8221; is not anywhere close to running it &#8220;air-gapped&#8221;, it is but the first step on a long and arduous journey.</p></blockquote>
<p></i></p>
<p>Good observation. Stand alone is not a requirement, though. An air-gapped network of systems could also exist. For simplicity, I would think an Air-gapped system means the following:<br />
1- Isolated from external network<br />
2- Isolated from external input/output, such as Light and electromagnetics, for example Electromagnetic emissions and reception.<br />
3- Isolated from external power supply lines (probably by filtering)<br />
4- Started in a known clean state<br />
5- And after this thread, it needs to be isolated from sound as well.<br />
Can you share what other characteristics a system needs to meet to be qualified as an air-gapped system?<i></p>
<blockquote><p>as they don&#8217;t have a monopoly on either curiosity or inventivness and the genie is out of the bottle.</p></blockquote>
<p></i>1- They do have a monopoly on law enforcement, though!<br />
2- When the genie came out the bottle the first time, it was put back again &#8212; Long story.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209186">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209186">
						November 7, 2013 11:34 AM					</a>

				</p>

				<p>@ Mike the goat,</p>
<blockquote><p>Yep&#8230; Some say he went to war and came back, joined the peace movement and became a pot head.</p></blockquote>
<p>If I wanted to be a pot-head, I&#8217;d move to Washington.</p>
<blockquote><p>You know what I say? That he was a well regarded cryptographer that found a novel method of breaking RSA, and the government did it to him.</p></blockquote>
<p>Wouldn&#8217;t surprise me. I think that&#8217;s what happened to John Forbes Nash, Jr. as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209187">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209187">
						November 7, 2013 12:12 PM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8220;Can you share what other characteristics a system needs to meet to be qualified as an air-gapped system?&#8221;</p>
<p>Back when I was trying to figure it out, I just started with how US govt protected their most secret stuff. They used dedicated networks/PC&#8217;s for certain levels, air gaps, high assurance guards, non-bypassable TCB&#8217;s with custom firmware on certain things, EMSEC protection, certain cryptosystem approaches, power filters, and rooms within rooms with isolated tech (SCIF&#8217;s).</p>
<p>My assumption was that they&#8217;ve been dealing with these problems for a long time and plenty of wisdom would be built into their internal recommendations. Most of them seem like a good idea to this day. Quite compatible with many items on your list, for example.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209188">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209188">
						November 7, 2013 12:20 PM					</a>

				</p>

				<p>@ Nick P</p>
<blockquote><p>They used dedicated networks/PC&#8217;s for certain levels, air gaps</p></blockquote>
<p>@Clive Robinson brought up a good point. Is the term &#8220;Air-gapped&#8221; formally defined?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209189">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209189">
						November 7, 2013 12:51 PM					</a>

				</p>

				<p>@ Wael</p>
<p>When have you known me to go by formal definitions? Remember how our different backgrounds got us hung up on the word &#8220;trusted&#8221; in a previous discussion? 😉</p>
<p>Anyway, I&#8217;m not sure if there is a formal definition. The &#8220;de facto&#8221; definition is physical separation. Military/Intelligence groups did this with separate networks, PC&#8217;s, routers, fibers, etc. EMSEC was part of it from what I could tell because part of physical network separation included placing components a minimum distance apart to prevent a sensitive component&#8217;s emanations from causing an effect in wires/chips of another. Certain &#8220;controlled interfaces&#8221; were allowed for main classified networks, albeit with strong security requirements.</p>
<p>The definition is ad hoc and informal. The procedures are systematic and formal. So, you could say the air gap definition is semi-formal. It&#8217;s also a definition that&#8217;s implied by their methods of implementing it more than any statement on paper. I mean, the older documents I read didn&#8217;t even use the phrase although they told how to build it. For that reason, I focus less on definitions and more on practical aspects such as the How and Why of implementing them.</p>
<p>Their only screwups that I&#8217;ve seen were underestimating the importance of both object code attributes and the chips in their machines. Both have resulted in many security problems that their standards/certifications didn&#8217;t address well enough. They&#8217;re wisening up to that in this century hence all the DARPA, DOD and military research in that area.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209190">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209190">
						November 7, 2013 1:17 PM					</a>

				</p>

				<p>@ Wael, others re &#8220;what is an air gap actually?&#8221;</p>
<p>Here&#8217;s some supporting evidence for my theory. I figured why not just look up the first security paper I know of and see if it contains air gap, a description of one, etc.</p>
<p>The paper that started our field (1967-1970)<br />
<a href="http://www.rand.org/pubs/reports/R609-1/index2.html" rel="nofollow ugc">http://www.rand.org/pubs/reports/R609-1/index2.html</a></p>
<p>I think readers will enjoy this paper regardless of their curiousity about air gaps for its historical value. I enjoy it because I look at their situation then and what they decided was necessary for computer security. I then compare it with what we know now. They did a decent job with many principles having lasting significance, albeit not necessarily their implementation. Anyway, here&#8217;s a few things that relate to air gaps.</p>
<p>&#8220;Fundamental principles&#8230; The means employed to achieve system security objectives shall be based on any combination of software, hardware, and procedural measures sufficient to assure suitable protection for all classification categories resident in the system.&#8221;</p>
<p>&#8220;Any communication line that passes classified information between a terminal and the central computer facility or between computer systems must be protected in accordance with Government-approved communication security methods. They may include provision of approved secure cable between the terminal and the central location, or of approved cryptographic equipment. Intelligent deception of the link (i.e., spoofing) must not be possible. &#8221;</p>
<p>&#8220;Any terminal through which a user can gain access to classified information in the central computing facility must be physically protected in accordance with the highest classification of information processed through the terminal.&#8221;</p>
<p>&#8220;The software of a resource-sharing system includes the Supervisor, the language processors (compilers, assemblers, etc.), the program library, and the utility programs (e.g., sort programs, file copying programs, etc.9. The design of a computer system must consider all software components of the system, as well as the hardware on which the software will run. &#8221;</p>
<p>(Pretty thorough, that.)</p>
<p>&#8220;Central processor hardware must provide some or all of the following mechanisms, depending on the class of service it renders its users: user isolation; supervisory software1 protection; and assurance against unanticipated conditions. &#8221;</p>
<p>So, as you can see, the focus was more on procedures and technological equivalents to existing standards for classified information protection. That was the concept. <em>Those</em> basic principles and procedures date back to 1940 Executive Order for handling &#8220;Restricted Data&#8221; under which the Manhatten Project was also governed (source: FAS).</p>
<p>I&#8217;ll leave it to someone else to show us where &#8220;air gap&#8221; got its start. However, I think the paper &amp; EO I cited show it&#8217;s a ad hoc phrase representing an extremely watered down version of classified information handling procedures. Probably with watered down effectiveness, too. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209191">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209191">
						November 7, 2013 1:54 PM					</a>

				</p>

				<p>@ Nick P<br />
Good paper!</p>
<blockquote><p>I&#8217;ll leave it to <i>someone</i> else to show us where &#8220;air gap&#8221; got its start.</p></blockquote>
<p>I think he&#8217;s already working on it. I don&#8217;t think I need to disambiguate &#8220;he&#8221; 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209192">

			<div class="comment by-trickhat-fin ">

				<p class="commentcredit">

					<span class="commenter">TrickHat FIN</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209192">
						November 7, 2013 6:06 PM					</a>

				</p>

				<p>You are all just teaching it. Evolution at it&#8217;s prime. Take care.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209193">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209193">
						November 7, 2013 7:04 PM					</a>

				</p>

				<p>@Mike the goat<br />
&#8221; The motherboard vendor doesn&#8217;t know any more than we do about what goes on in the &#8220;black box&#8221; that is these accessory ICs.&#8221;</p>
<p>This is a good point because most times the chip vendor develops the firmware for something like an Audio + 1000baseT combo chip. The motherboard maker gets the firmware delivered by the chip vendor and rarely has time to make modifications, if firmware mods are needed it this task also falls back to the Chip vendor.  Generally speaking the Motherboard maker is clueless about what&#8217;s inside the chip. It could have an ARM processor plus with its own Flash integrated or maybe MIPS or possible 8085 the motherboard maker neither knows nor cares whats under the lid.</p>
<p>About 10 years ago the last of the US based chip makers got out of the low end component market (like Audio) they were replaced by mainly Taiwan companies like RealTek, MediaTek &#8230;. These days there are also a lot of Chinese companies doing low end PC Audio. Unfortunately many times these Chinese firms are such low budget affairs that NOBODY really knows how the chip or firmware works (sounds absurd but they&#8217;ll just get something like a RealTek chip reversed engineered and make their own copy), the whole company will be maybe 5 engineers so they have very low overhead AND only compete when the Fabs offer them a low price.</p>
<p>To be honest it would be trivial for me to rewrite their Audio code and add a virus, their design processes are also incredibly sloppy which opens up room for other exploits.</p>
<p>One final point, since these Chinese vendors copied something like a Realtek chip they are 100% compatible, so sometimes they&#8217;ll decide to even brand their chips as RealTek and sell them through the Hong Kong distributor markets.</p>
<p>Point is Nobody really knows what they are getting,  all they know is that it works OK as an Audio chip, what else it does is anyone&#8217;s guess.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209194">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209194">
						November 7, 2013 7:38 PM					</a>

				</p>

				<p>@Nick P</p>
<p>Good summary of Air-gapped principles.</p>
<p>On a related topic,<br />
Many years ago where I worked they had a Cray YMP it was used for secure calculations so the computer and terminal was actually built inside a big walk-in bank style safe.  Nobody ever used it, which I knew because my desk was close to the entrance door.</p>
<p>One day I had a difficult Finite Element Analysis problem (not really related to the exact work I was doing) so I coded it up and let it run on the YMP. The simulation took a few days to run and I was half way through my forth iteration when the big boss (along with his underlings)  comes thundering in and slaps down an old style line-printer accounts printout.  The first words from his mouth are WTF are you doing, I catch a glimpse of the bottom line and it was much higher than my yearly wage. I&#8217;m not sure what BS I told him but it certainly wasn&#8217;t the whole truth, job stuck in an infinite loop something like that.</p>
<p>What I didn&#8217;t know was that they allocated processing costs to any department that used the Cray, since I was running it full time they dumped all the costs onto me. After that it went back to being completely unused which suited everyone just fine. Eventually I thought this is stupid so I wrote a virus of sorts that corrupted job time logging software and returned the Null job indicator whenever my program was running.</p>
<p>Wonder how much hard time I&#8217;d get if I tried that sort of thing these days?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209195">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209195">
						November 8, 2013 2:41 AM					</a>

				</p>

				<p>RobertT: I seem to recall a story about chip counterfeiting in China/Taiwan. Given we have seen reports of consumers getting more than they bargained for with Chinese hardware (credit card terminals complete with integrated skimmer, kettles that launch a MITM attack against users of open WiFi networks, etc.) I can only imagine what a government (rather than a disorganized, perhaps ham fisted criminal group) could do &#8211; given China&#8217;s unique positioning in the global marketplace. The vast majority of accessory ICs are made in their country/administrative regions. Imagine the damage you could cause, particularly if you engaged in spying that had a low likelihood of detection.</p>
<p>Wael: hmm, isn&#8217;t it funny how our brains utilize context. I was reading your comment about pot smoking in Washington, saw the surname &#8220;Nash&#8221; and immediately thought of Crosby, Stills and Nash playing in the smoke filled air of Woodstock. Guess it wasn&#8217;t that funny after all&#8230; But yes, I agree that the govt could have somehow initiated his mental issues, no doubt about it. After all, they didn&#8217;t spend all that cash on MKULTRA for no reason.</p>
<p>Brandiocch: yes, it seems that he hasn&#8217;t adequately explained himself.</p>
<p>Schneieronsecurityfan: ahh, makes sense. I was thinking that a ratings agency would just give the volunteers a radio that would collect the RDS info and log it, but the &#8220;portable people meter&#8221; makes a lot of sense as a lot of radio listening is done away from home &#8211; in the car, at friend&#8217;s houses, etc. By modulating the signal in with the music, if carefully designed nobody would really notice it but your device could capture it with its mike. Very clever.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209196">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209196">
						November 8, 2013 10:27 AM					</a>

				</p>

				<p>@ Mike the goat</p>
<blockquote><p>I was reading your comment about pot smoking in Washington&#8230;</p></blockquote>
<p>I&#8217;m afraid that context will give readers the &#8220;wrong&#8221; impression about me 😉</p>
<blockquote><p>&#8230;MKULTRA&#8230;</p></blockquote>
<p>Perhaps Bruce should say something about this. Wondering if someone administered some weird control drug to him through his air-gapped computer. You know, aerosol can (able to, not the &#8220;can&#8221; you drink from) jump that air-gap, and make him tight lipped about things that they want to keep hidden&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209197">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209197">
						November 8, 2013 12:19 PM					</a>

				</p>

				<p>@ wael, mike the goat</p>
<p>Ah, MKULTRA. That reference inspired me to do a writeup on it in a <a href="https://www.schneier.com/blog/archives/2013/11/why_the_governm.html#c2230003" rel="nofollow ugc">thread</a> where it&#8217;s also on topic. 😉 It&#8217;s one of those things America should never forget. Matter of fact, I suspect elements of the project are ongoing or will repeat in the future as its goal is one governments will never let go of.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209198">

			<div class="comment by-sparx ">

				<p class="commentcredit">

					<span class="commenter">sparx</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209198">
						November 9, 2013 3:08 AM					</a>

				</p>

				<p>Probably more of a halloween prank even though hoaxy, but geez what an amount of collective  attention wasted. See below link for a decent debunking.</p>
<p><a href="http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/" rel="nofollow ugc">http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209199">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209199">
						November 9, 2013 9:25 AM					</a>

				</p>

				<p>@ Sparx,</p>
<ul><i>See below link for a decent debunking</i></ul>
<p>No it&#8217;s nothing like &#8220;a decent debunking&#8221;, in fact it comes about as close to a &#8220;strawman argument&#8221; as you can get without it being blatantly obvious.</p>
<p>About the only thing the writer got right is &#8220;BadBIOS&#8221; is a bad name.</p>
<p>As has been noted above you don&#8217;t need to change the BIOS as by default it will load in code from IO card ROMs at boot time. The fact the author of the page you&#8217;ve linked to claims to be a BIOS expert but has not mentioned this tends to cast a certain pall on his claims.</p>
<p>Further as noted above the sound systems on most mother boards come frome a very very small selection (of just about one) and the ROM on such systems would only require very small amounts of changes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209200">

			<div class="comment by-mr-man ">

				<p class="commentcredit">

					<span class="commenter">Mr Man</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209200">
						November 9, 2013 9:44 AM					</a>

				</p>

				<p>Am I the only person guessing that this is all an elaborate exercise in social engineering designed to illustrate how much silliness we&#8217;ll all believe when it comes from someone with a good reputation in the field? Honestly, I can&#8217;t believe people are taking the idea of this legendary malware seriously.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209201">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209201">
						November 9, 2013 10:15 AM					</a>

				</p>

				<p>@ Mike the Goat, Nick P, RobertT, Wael,</p>
<p>As I have an old protyping sound/modem AT card from the 1990&#8217;s knocking around I thought I would have a play around.</p>
<p>The sound/modem chip has a 6502 CPU core in it and an external ROM which I&#8217;ve swapped with a ROMulator I&#8217;ve also got that dates back to the 1990&#8217;s (when I was doing a settop box design based around a Motorola DragonBall single chip 68K device as used in some PDA&#8217;s).</p>
<p>I dug out of my dead tree cave a book on DOS and other PC related programing that had some usefull code for building your own AT format I/O cards as well as code for flashing Keyboard leds.</p>
<p>Cobbled it all together and wrote some 6502 code to implement a narrow band filter (notch and subtractor) tuned to 1Khz with the sound chip that raised a UART interupt on detection and loss of 1K tone that triggers the changing of the Caps Lock LED&#8230;</p>
<p>Ran up a vanilla Win95 install on a 486 motherboard I&#8217;ve got hanging around with no mods or additional programs to the BIOS or Win95 and once booted up with the moded AT card in the Caps Lock LED comes on and goes off with the card detecting a 1K tone from an audio generator.</p>
<p>So yes if you have data on the sound chip and embedded CPU core data transfer by audio is doable without changing the BIOS or OS on HD with 1990&#8217;s hardware&#8230;</p>
<p>I guess the question now is getting development data and hardware for an embedded AC97 chip set and trying that with Win2K, WinXP or Linux and making it look like a SLIP/PPP serial network port etc, oh and one other important resource &#8220;time&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209202">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209202">
						November 9, 2013 10:48 AM					</a>

				</p>

				<p>@Mr Man</p>
<blockquote><p><i>Am I the only person guessing that this is all an elaborate exercise in social engineering designed to illustrate how much silliness we&#8217;ll all believe when it comes from someone with a good reputation in the field?</i></p></blockquote>
<p>You are not alone. There are three broad scenarios here.</p>
<ol>
<li>BadBIOS does everything that has been claimed or implied or hinted at in the articles. This should be easy to demonstrate. But it has not been demonstrated, yet. The super-virulent virus has been around for three years (maybe) during which it has not escaped Ruiu&#8217;s lab (that anyone can show).</li>
<li>BadBIOS does a subset of the things claimed, implied and hinted at.</li>
<li>BadBIOS is a hoax/mistake. Whether from Ruiu or a friend with access to his machines or faulty hardware or sloppy practices or whatever.</li>
</ol>
<p>It isn&#8217;t whether X functionality can be demonstrated in a lab on specific hardware. It&#8217;s whether X, Y and Z functionality can be demonstrated, automatically, on various machines outside the lab. So far the extraordinary claims do not have the required extraordinary evidence. And as time passes, it becomes less likely that they will.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209203">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209203">
						November 9, 2013 10:58 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Interesting experiment. Seems you&#8217;ve proven the concept. I think the main takeaway, though, is that it&#8217;s 2013 and you&#8217;re still coding 6502 assembler for use in Windows 95 PC&#8217;s. 😛</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209204">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209204">
						November 9, 2013 11:52 AM					</a>

				</p>

				<p>@ RobertT</p>
<p>(late reply my bad)</p>
<p>&#8220;Many years ago where I worked they had a Cray YMP it was used for secure calculations so the computer and terminal was actually built inside a big walk-in bank style safe. Nobody ever used it, which I knew because my desk was close to the entrance door. &#8221;</p>
<p>I can see where this is going&#8230; 🙂</p>
<p>&#8220;&#8230;After that it went back to being completely unused which suited everyone just fine. &#8221;</p>
<p>This mentality no longer surprises me but never ceases to be aggravating. They for some reason decide to purchase a vector supercomputer that they never use because using it costs money. (facepalm) Why can&#8217;t people making these expensive decisions make beneficial expensive decisions&#8230;</p>
<p>&#8220;Eventually I thought this is stupid so I wrote a virus of sorts that corrupted job time logging software and returned the Null job indicator whenever my program was running. &#8221;</p>
<p>Nice hack. 🙂 I&#8217;m jealous as I never got to use a Cray in my time dealing with supercomputing. On related note, I think certain HPC techniques hold some potential for cloud or virtualization type security that have been untapped so far. Here&#8217;s a few things I noticed from my old studies.</p>
<ol>
<li>IBM mainframes give strong hardware separation with LPAR&#8217;s and their [presumably weaker] PowerVM software separation for within LPAR&#8217;s. These options can be mixed to a desired tradeoff. This trick should be doable within a suitably designed desktop or server that&#8217;s non-IBM.</li>
<li>I&#8217;ve often said a dedicated chip for each system function with easy management &amp; fast communication would be better than software security. People have a hard time wrapping their head around it. Funny thing is Massively Parallel Processing systems were most of the way there: 128 to several thousand independent nodes; low-latency, high speed interconnect; fault isolation; management nodes can can move work around; single system image; on certain machines a restricted OS for compute nodes (eg Cellular IRIX).</li>
<li>Many secure OS designs used forms of memory-based security. However, they ran on systems with little memory and the best strategy for IO was using dedicated external device for most of it. NUMA machines have global shared RAM and dedicated nodes for different functions (compute vs IO). Just imagine combining a high assurance separation/security kernel, global address space w/ crossbar switch, MMU/IOMMU, security-enhanced NUMA nodes, etc.</li>
<li>SGI&#8217;s NUMA machines showed that FPGA&#8217;s can be integrated directly into global address space &amp; seemlessly directed by regular nodes. Many ultra-secure, bottom-up designs are currently prototyped onto FPGA&#8217;s. These range from object processors all the way to secure monitoring coprocessors. One objection to some of those techs is that there&#8217;s only a tiny bit of chip real estate in a desktop or whatever meaning one must pick and choose functionality. Yet, NUMA machines are <em>designed</em> to be vertically expanded with many chips. And they have been used for desktop and server virtualization.</li>
</ol>
<p>I just keep looking at the supercomputing field, particularly 1990&#8217;s to early 2000&#8217;s, seeing so many possibilities for using their developments for security. Category 4 has nearly endless combinations for instance. Aside from FPGA issues, it might be my best idea yet for implementing software security w/ diverse techniques/components. Yet, I&#8217;ve seen almost no academic and commercial uptake to this idea outside of IBM&#8217;s System Z. And, of course, it barely compares to some stuff in points 2-4 and has legacy mainframe weaknesses.</p>
<p>Your thoughts on any of this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209205">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209205">
						November 9, 2013 3:35 PM					</a>

				</p>

				<p>@ Clive Robinson,<br />
I would have skipped the filter code and just checked the attack vector. I forgot to mention that those motherboards had built in speakers with a higher frequency response, unlike the magnetic type external ones. By the way, what range did get? And how high was the sound?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209206">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209206">
						November 9, 2013 7:10 PM					</a>

				</p>

				<p>@Clive Robinson<br />
You beat me to it.  I was thinking of modifying a ROM on a PCI ethernet card and have it take control of the sound system to output varying tones while Debian runs.</p>
<p>@Nick P</p>
<blockquote><p>&#8230;I think the main takeaway, though, is that it&#8217;s 2013&#8230;</p></blockquote>
<p>Not a problem at all.  VESA BIOS extensions data back to before then.  The soundcard one was formalized in &#8217;94.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209207">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209207">
						November 9, 2013 8:59 PM					</a>

				</p>

				<p>I dont get it, what&#8217;s not doable.</p>
<p>Audio Comms is definitely doable, heck its how we send messages to submarines.  There are definite throughput limitations on the acoustic channel, created by the response characteristics of speakers and microphones and the room reverberation, but I didn&#8217;t see any suggestion that this was a high bandwidth channel.  It&#8217;s a side channel through which very small amounts of data associated with system configuration seem to flow forwards, I dont remember any comment on what possible information flows back, the only claim was that the packets were encrypted (which is a claim I dont really know what to make of)</p>
<p>If I understand the claims correctly, even a 1bps Audio channel would be adequate (Skeptics: Is this acceptable ?) if not please specify a minimum channel throughput rate and provide some reasoning for this minimum)</p>
<p>As I&#8217;ve said before, there does not seem to be a need to simultaneously corrupt all possible OS&#8217;s with one Virus, Once you infect the Internet connected host, where the USB is regularly used, you can try a different virus load targeting a different OS each time.</p>
<p>So we know Acoustic comms is possible (heck its how we talk to each other)</p>
<p>We know USB sticks can be used as a virus transmission vector for infecting isolated systems with different OS types (Windoze to Siemens PLC OS)</p>
<p>We know that PC support device firmware can contain some unknown / unknowable elements.</p>
<p>We&#8217;ve seen viruses in the past that disable certain features like the CD drive because it make it harder for admin to use a liveCD to check for possible rootkits.</p>
<p>I&#8217;m obviously missing something here:<br />
What element of the #badbios claim is not technically possible?</p>
<p>Sure the combination of tactics is unusual, it definitely makes me  wonder what is so special about his setup that it is attracting this sort of attention.  I seriously doubt the data on the isolate computer is the real target. I&#8217;d guess his local network, for some unknown reason, looks similar to the real target network.  Since we have no idea what the real target is, it is hard to know what precautions the virus writers might have taken to avoid discovery and limit viruses spread.</p>
<p>Why hasn&#8217;t he shared this with other researchers and Anti-virus companies? that&#8217;s a good question. I&#8217;m guessing it is difficult to reproduce the infection. If he takes an infected USB to a friends house and nothing happens, that just tells me that whatever steps were taken to limit the viruses spread are working perfectly.</p>
<p>Bottom Line: IMHO It&#8217;s all possible, but its definitely not the work of script kiddies regardless of how talented they think themselves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209208">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209208">
						November 11, 2013 4:10 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Yes it was old hardware but it&#8217;s what I had in the junk box that required no &#8220;physical&#8221; modification, and that I had full development data that I&#8217;d signed an NDA for years ago.</p>
<p>PCI and more modern sound cards have two problems on this front, no development data on the internal ARM / MIPS / etc CPU core and ROMs that are surface mount. A secondary effect of this is Pb-Free solder issues the lead gets replaced by silver etc which have higher melting temps, pluss it pulls the copper of the much finer PCB which limits the number of re-works to around three.</p>
<p>This experment was &#8220;quick and dirty&#8221; making minimal changes to a copy of code I already had on floppy discs in the safe from the previous &#8220;set-top&#8221; development.</p>
<p>The main point behind it was not making a sound channel work &#8211;we know that works already&#8211; but showing that you did not have to change or add code on an existing motherboard BIOS ROM or importantly to the OS on the HD, just put the sound card in&#8230;</p>
<p>If you like to put it another way I was showing that Ruiu is &#8220;barking up the wrong tree&#8221; talking about a BadBIOS, it&#8217;s not the motherboard BIOS or the OS HD that have got malware on them it&#8217;s tucked away on another bit of semi-mutable memory. It&#8217;s an attack vector that you and I have talked about intermitantly for many years and it&#8217;s one that has likewise been ignored by the industry for years.</p>
<p>Also it may be a way around the Fritz chip and successor TPM systems that try to unrealisticaly enforce DRM I need to get more uptodate info to investigate if you can end run these TPM systems. I suspect you can by subverting an existing channel mechanism, that is you modify the &#8220;hidden CPU&#8221; code on an IO card to stuff illicit data into an existing approved channel in the right format. An end user supplied app then grabs the other end of this channel and transcodes the illicit data and sends it on to disk or whatever in an alowable format.</p>
<p>@ Wael,</p>
<p>I only implemented a very simple sound channel, I did not in any way optomise it, nobody is paying me to do it and I do have other &#8220;non payed time&#8221; activities including such mundane things as &#8220;house work&#8221;. I used 1KHz simply because it&#8217;s in the middle of the &#8220;age weighted&#8221; audio band. I don&#8217;t currently have an external audio analyser I got rid of it when I stopped doing telephone development. But the channel worked across the room with ordinary moving coil speakers at a level that you could comfortably hold a conversation over (I know this because at one point I had the mobile phone tucked between my ear and sholder chatting to a friend who had phoned me whilst I was playing with the setup).</p>
<p>@ Bryan,</p>
<p>I got one of those self induced head smack moments when I read your &#8220;PCI ethernet card&#8221; comment&#8230; yup whilst they are not quite &#8220;a dollar a bucket full&#8221; they are cheap and easily available so wrecking one during test/development is not an issue.</p>
<p>As for the VESA extentions yes they do go back a long way, whilst digging in the junk box I actuall found a VESA Local Bus RAID card, it cost a fortune when I got it, now it&#8217;s at best of historic interest only (for those reading along who are in their thirties or less who have never heard of or seen VLB have a look at <a href="http://en.m.wikipedia.org/wiki/VESA_Local_Bus" rel="nofollow ugc">http://en.m.wikipedia.org/wiki/VESA_Local_Bus</a> ).</p>
<p>However the two books I draged out of my dead tree cave are as old&#8230; One even talks about interfacing to the casset motor BIOS routiens in a very serious way, and yes in my dotage I&#8217;d forgoton the Debug commands for calculating a Device ROM check sum 🙂</p>
<p>@ Robert T,</p>
<p>As far as I&#8217;m concerned it&#8217;s all possible, but more importantly explainable including the bits Ruiu is getting hung up on. I can also see clearly how he arived at various assumptions like BIOS &amp; SDR (I also &#8220;feel his pain&#8221; on not having the right test kit on hand I&#8217;ve been there a few times myself).</p>
<p>But after a little thought I can even think of not just why the authorities might drop this on him but how. He&#8217;s not the target but his position as a conferance organiser makes him a usefull step in the chain to people the authorities might otherwise not be able to get at.</p>
<p>I certainly would target any computer that the likes of proffesional Black Hats might put their USB thumb drives in to upload their presentations. The chances are they will do a bit of poor OpSec and put it back into their own laptop later and thus step back up the line when they use that laptop to build a new presentation which they use another thumb drive to get screen dumps and data of their development machines etc&#8230;</p>
<p>Good opsec like good bio-control in a germ lad are very difficult to do right all day and every day year in and year out. And level 3 adversaries are generally very patient you only have to read up on Project VENONA to see that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209209">

			<div class="comment by-stephan ">

				<p class="commentcredit">

					<span class="commenter">Stephan</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209209">
						November 11, 2013 4:19 AM					</a>

				</p>

				<p>As outlined several times before, and specifically <a href="https://www.schneier.com/blog/archives/2013/11/badbios.html#c2249583" rel="nofollow ugc">by @RobertT</a>, there&#8217;s no doubt about the audio air-gapping. More details about this issue will be, by the way, released by two collegues of mine, working at the Fraunhofer Institute for Communication, Information Processing and Ergonomics, in the upcoming November edition of the <a href="http://onlinelibrary.wiley.com/journal/10.1111/(ISSN)1460-2466" rel="nofollow ugc">Journal Of Communication</a> &#8211; dubbed &#8220;On Covert Acoustical Mesh Networks In Air&#8221;.</p>
<p>On the other hand, I don&#8217;t have the in-deep knowledge on the BIOS-side. But, even if Phillip Jaenke is right <a href="http://www.rootwyrm.com/2013/11/the-badbios-analysis-is-wrong/" rel="nofollow ugc">in all his points</a>, that&#8217;s no proof that there&#8217;s no threat at all! It rather, in the first instance, means, that Drogos interpretation of the issues he (and his team) recognized, monitored and analyzed is not completeley true.</p>
<p>Dragos has shown he has sufficient operational security to research another 12-24 months on this one. We don’t need to know now, now, or now. We gain nothing by trashing his name neither. So that&#8217;s about that for now, I&#8217;m afraid &#8211; it&#8217;s a question that can not be answered by a single person and not right now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209210">

			<div class="comment by-snort ">

				<p class="commentcredit">

					<span class="commenter">snort</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209210">
						November 12, 2013 7:42 AM					</a>

				</p>

				<p>is this<br />
<a href="https://forums.comodo.com/general-security-questions-and-comments/is-this-real-or-bogus-and-paranoia-gpubasedparavirtualizationrootkit-t93778.0.html" rel="nofollow ugc">https://forums.comodo.com/general-security-questions-and-comments/is-this-real-or-bogus-and-paranoia-gpubasedparavirtualizationrootkit-t93778.0.html</a></p>
<p><a href="http://forum.sysinternals.com/gpu-based-paravirtualization-rootkit-all-os-vulne_topic26706.html" rel="nofollow ugc">http://forum.sysinternals.com/gpu-based-paravirtualization-rootkit-all-os-vulne_topic26706.html</a></p>
<p>the same thing ?</p>
<p>what if drago is looking in the wrong place ?</p>
<p>what if he got a variant of this malware paravirtulization if you looked at the both malware<br />
it could be plausible ???</p>
<p>anyway in the end this is no work of a kid<br />
who could be behind such strange attack ? NSA ?</p>
<p>BTW the virtulization rootkit exists &#8221; Blue Pill &#8221;<br />
for example</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209211">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209211">
						November 12, 2013 8:18 AM					</a>

				</p>

				<p>Snort: as much as I like the guy I believe Dragos has been truly stumped by this. I don&#8217;t want this to sound like a personal attack as I have been vocal in his defense for the last few weeks &#8211; especially those who claim that it was impossible to have an audio mesh (news flash: it&#8217;s not and PoCs exist).</p>
<p>The dumped BIOS&#8217;s are essentially the same except one has a Thawte certificate attached. This isn&#8217;t necessarily evil though &#8211; as the cert might be dropped when the BIOS is flashed (ie the flashing tool uses it for code signing then strips it). You&#8217;d see a hell of a lot more modification than a few kB for a bootkit of the capability he has described, even for the scenario where a basic  component was appended (in the same way Mebrombi did it &#8211; by using the OEM&#8217;s tool to dump the current ROM to a file, add the evil code as a component and then flash the new file) that just performed a &#8220;persistence&#8221; function by injecting a dropper &#8211; perhaps by using a bit of NTFS aware code ala Computrace to replace a file that is read by Windows on boot with the evil code that will download the full kit from the Internet.</p>
<p>So if we assume that Dragos is dumping the BIOS correctly then we have to rule out the actual BIOS flash itself as the &#8220;hiding&#8221; spot of the malware. This of course assumes that he isn&#8217;t in some kind of virtualized environment &#8211; in which case the evil hypervisor could make his flash dumping tool return whatever it wanted.</p>
<p>My theory at this point is that if there is code executing at boot time as Dragos suggests /and/ the BIOS dumps are clean then the next thing that should be considered are the option ROMs of all bus connected devices, which as Clive pointed out are dutifully executed by the BIOS at startup (example PXE client from your Ethernet card, RAID controller status screen given by a PCIe RAID controller, etc). So you could suspect the video card (distinct possibility), Ethernet basically everything that has a flashable firmware where we could modify what gets executed at boot.</p>
<p>The second precondition is that Dragos said that the malware communicates via audio. By far the easiest way to do this would be to do it in userland within Windows as you avoid becoming dependent on specific audio hardware as the abstraction layer of Windows audio APIs handles all that for you. I realize he mentioned that the /infection/ process worked under any OS but as far as I know the audio behavior was seen only under Windows. It is conceivable that it is occurring directly in the audio card firmware but it seems like you are really narrowing down on the hardware your malware can execute on.</p>
<p>As time goes by and other researchers find nothing untoward I am becoming increasingly skeptical that what we will find will necessarily correlate with what Dragos thinks we will find. I hope for his sake that his claims at least mesh somewhat with what can be proven or reproduced. It seems that at least one of his spectograms released is strongly suspected to be noise from a switching regulator. In one of his tweets he laments about dumps being changed when he exports them from the infected machine. One would assume if things like this were occuring a $100 digital camera would be a good way to document it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209212">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209212">
						November 12, 2013 8:27 AM					</a>

				</p>

				<p>Snort: sorry hit submit prematurely.</p>
<p>Regarding Blue pill and virtualization style rootkits. No doubt when these things are perfected they will become a very interesting new threat. It is entirely possible that Dragos could have something ofnthis type on his hands (and would explain a lot of the supposed behaviors), then again it is equally probable he doesn&#8217;t.</p>
<p>This is the problem &#8211; we haven&#8217;t seen enough data. Everything that has been uploaded as &#8220;proof&#8221; has been famously inconclusive. If the guy didn&#8217;t have some cred as an event organizer for Pwn2own a lot of people wouldn&#8217;t have taken him seriously. He has our attention now, and no doubt everyone at PacSec last week would have been volunteering their assistance. I think this is why a lot of people are getting upset &#8211; responses like &#8220;if this were my PC I would have desoldered every damn flash chip for analysis&#8221; are common. And they&#8217;ve got a point. There are many ways you could either confirm or refute his hypotheses, and yet here we are three years later. He doesn&#8217;t have the excuse that many have &#8211; knowing many in the security industry as part of his job as an event organizer &#8211; coordination of some serious analysis should have been trivial.</p>
<p>If I were in Dragos&#8217; shoes I would have kept silent and worked with a trusted team of researchers in concert to fully elucidate the threat &#8211; hell, at least produce enough evidence to positively confirm infection &#8211; before disclosing anything. He didn&#8217;t do this, and if the negative reaction is anything to go by, he probably wishes he didn&#8217;t play it this way.</p>
<p>Anyway &#8211; I truly hope we have a new and exciting piece of &#8220;stuxnet&#8221; grade government malware to analyze. While what he speaks of is all technically possible I am not seeing any evidence, and at this point my initial excitement is drying up and turning to suspicion.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209213">

			<div class="comment by-ives ">

				<p class="commentcredit">

					<span class="commenter">Ives</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209213">
						November 12, 2013 5:03 PM					</a>

				</p>

				<p>Well, I always read &#8211; the bios has been dumped &#8211; but I miss the part where the extension bios images are in the game? Maybe they are part of the bios dump but I doubt they may not &#8211; which may explain why the bios itself is/looks clean but the computer may be still infected.</p>
<p>About the sonic communication I&#8217;m unsure but for the infected bios part &#8211; I would place code within the extension bios images. Within older bioses it is nearly a trivia to write an extension bios image place it in some eeprom/flash and the bios will call those images (it must comply to some extension bios header requirementes &#8211; defined within isa/pci extension bios standards &#8211; match some hardware ids and some checksums) during system initialisation &#8211; depending on the eeprom/flash sizes and used code-packers quite some code could be placed there &#8211; usually at least 64k if the eeprom/flash is not used, as was the case for intel eepro 100 around year 2000 &#8211; we abused that for some fancy stuff back then -&gt; therefore I know you can place code there that does whatever you want &#8211; at least before the os comes up, which was sufficient for our use case.<br />
Never tried to keep that code alive after os start &#8211; therefore won&#8217;t comment that &#8211; but it would explain why it doesn&#8217;t matter &#8211; what os runs later on&#8230; as such code gets initiated simply before &#8211; and thats default behavior of a bios &#8211; no magic at those parts at least&#8230;</p>
<p>there are questions if the code survives the os startup later on but that may be achiveable &#8211; nontheless the pre execution rom/ram mappings are declared explicitly volatile by the standard, if I remember correctly but &#8211; well&#8230; doesn&#8217;t mean it&#8217;s impossible.</p>
<p>so getting code called by the bios not within the bios is possible and its really easy &#8211; at least with bios &#8211; don&#8217;t know about uefi/efi as I don&#8217;t know the standard &#8211; but if not much changed &#8211; it may be as easy as before (beside the signature stuff &#8211; that would make it a little bit harder most probably)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209214">

			<div class="comment by-ives ">

				<p class="commentcredit">

					<span class="commenter">Ives</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209214">
						November 12, 2013 5:09 PM					</a>

				</p>

				<p>I admit, I didn&#8217;t read all the comments before, just to realize the previous posts mentioned the extension bios stuff already. I also would suggest to take very close look on that site &#8211; as this is an easy to go way without even touching the bios itself.</p>
<p>Sorry for that ;).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209215">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209215">
						November 14, 2013 6:01 AM					</a>

				</p>

				<p>Ives: no problems, you&#8217;re absolutely right the extension code that resides in peripherals (e.g. Ethernet card boot ROM for PXE boots, video card, RAID consistency check code from the RAID card) is indeed loaded by the BIOS at startup and wouldn&#8217;t reveal itself in a BIOS dump. I think this is the most likely scenario.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209216">

			<div class="comment by-david-dilworth ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://daviddilworth.com/it/' rel='external nofollow ugc' class='url'>David Dilworth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209216">
						November 15, 2013 10:43 AM					</a>

				</p>

				<p>You’ve got to be kidding me!</p>
<p>Is no one here over 30 years old?</p>
<p>For the skeptical theorizers &#8212; Have you never heard of acoustic modems? sometimes called acoustic couplers?</p>
<p>That well-worn technology has been available for at least four decades. Adapting it up to do Bios updates, or anything else is not at all difficult &#8211; just darn clever.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209217">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209217">
						November 15, 2013 11:22 AM					</a>

				</p>

				<p>@ David Dilworth</p>
<blockquote><p> Have you never heard of acoustic modems? </p></blockquote>
<p>Acoustic whaaaa?</p>
<blockquote><p>That well-worn technology has been available for at least four decades</p></blockquote>
<p>From one &#8220;skeptical theorizer&#8221;:<br />
Have you <i>understood</i> the aspects I was &#8220;questioning?&#8221; Did all &#8220;skeptical theorizers&#8221; contest the same thing? Don&#8217;t take one comment and peanut-butter it all over the place, and that&#8217;s especially true when your comment has been answered several times on this thread.<br />
The main question relating to acoustic communications in this claim was: Is the frequency response (transfer function) of the cheap speaker/mic used in PC&#8217;s or laptops suitable for ultrasonic communications, and if so, how was did it manage to remain persistent after cleaning the system.</p>
<blockquote><p>That well-worn technology has been available for at least four decades. Adapting it up to do Bios updates, or anything else is not at all difficult &#8211; just darn clever</p></blockquote>
<p>Actually, it is difficult. And I did BIOS code development. Besides, the current consensus is the BIOS was not updated &#8212; it was more likely an Option ROM rogue. All is still speculation, because the guy didn&#8217;t give enough info.</p>
<blockquote><p>Is no one here over 30 years old?</p></blockquote>
<p>I&#8217;ll take that to be a rhetoric question, since most of us know @Clive Robinson is 730 years old 😉 (in encyclopedic-knowledge-accumulation years)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209218">

			<div class="comment by-atomic ">

				<p class="commentcredit">

					<span class="commenter">Atomic</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209218">
						November 15, 2013 7:05 PM					</a>

				</p>

				<p>You all forget the possibility of BIOS motherboard battery as last source. and I dont need pc speaker to send UHF, only a flip flop cycle program in one ic pin with diode attached. afterall the crytal clock is Mhz. S+up1d geek&#8230;:&gt;</p>
<p>seriously ou all need redesign your college paper to design microcontroller.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209219">

			<div class="comment by-saint-crusty ">

				<p class="commentcredit">

					<span class="commenter">Saint Crusty</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209219">
						November 20, 2013 2:27 PM					</a>

				</p>

				<p>@Mike the goat: Thanks for that post. As a senior in ICT i&#8217;m overwhelmed with the flood of &#8216;experts&#8217; below thirty these days. Not to say i&#8217;m stumped by what some experts above thirty dare to state.</p>
<p>Not that am much older than able to state i started in the late nineties. Firewalls, Intrusion Detection, Encryption, Hardening, Switches, Ajax &#8230; most of that was &#8220;fresh from the drawing boards&#8221;  some technologies more than others, but that was the general idea. It was the introduction of genuine &#8220;power&#8221; in the industry of information technology.</p>
<p>On top of that i&#8217;ve been ever stumped as around that time there were articles ( based on scientific research ) stating it had been proven the x86 architecture could not ever be assumed to be secure. Secure as in, not flipping one bit of information without knowing why. While most vendors of these spanking new toys claimed the exact opposite, security is feasible.</p>
<p>Then came the malware, mostly called &#8220;a virus&#8221; back then. And with it the proof as well as speculation on what was secure ( or insecure ) and what was not. I learned a lot back then, for sure. But I&#8217;ve also had people proclaim complete nonsense ( basics countered by &#8216;expert claims&#8217;) and get away with it ever since. Get away with it because they offered &#8220;manageable solutions&#8221; while the justified criticism they received was often determined as &#8220;unfair&#8221;, corporations seem allergic to criticism as solutions are manageable thus beneficial.</p>
<p>However, i perceive Dragos as a reputable researcher and consider what he&#8217;s describing as certainly viable (  imho: The audio is merely to exchange commands and keep-alives, a c&amp;c channel ( swarm intelligence so to speak ) as it could well be controlled by the simplest devices such as robotic flies etc )</p>
<p>I believe Software Defined Networking might be part of this puzzle. ( i don&#8217;t want to think of what as possible popularisation of reprogammable processors could mean for security researchers )</p>
<p>It is indeed most disturbing most of the information regarding this &#8220;BadBIOS&#8221; miracle is fragmented all over the internet. I don&#8217;t know for how long dragostech.com is down but it&#8217;s been a while.</p>
<p>It is not even discussed on VRT, so let&#8217;s assume this is a stunt of some kind. Every aspect of this type of supermalware however is plausible. Why would it not be real ? Is it not and has it not mostly been a playground for ultra-smart people and other power players ?</p>
<p>Just stumbled across this one, is all this really just driven by media ?</p>
<p><a href="http://rt.com/news/airgap-jumping-virus-navy-012/" rel="nofollow ugc">http://rt.com/news/airgap-jumping-virus-navy-012/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209220">

			<div class="comment by-avat4r ">

				<p class="commentcredit">

					<span class="commenter">Avat4r</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209220">
						November 21, 2013 11:45 AM					</a>

				</p>

				<p>You guys are all working under the assumption that you know what hardware is actually present in your boards&#8230; you do not. Even if it was physically hard to break into and modify the output of a hardware factory (note: it is not, nothing more than a few doors and people, who are fooled more easily than the doors) what would stop a state sponsored intervention, to allow such hardware to exist without your knowledge?</p>
<p>Bearing in mind the smallest possible graphene RF transceivers are no more than a few atoms in length&#8230; would you know?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209221">

			<div class="comment by-ronnie ">

				<p class="commentcredit">

					<span class="commenter">Ronnie</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209221">
						December 2, 2013 4:19 PM					</a>

				</p>

				<p>Proof of concept developed</p>
<p><a href="http://arstechnica.com/security/2013/12/scientist-developed-malware-covertly-jumps-air-gaps-using-inaudible-sound/" rel="nofollow ugc">http://arstechnica.com/security/2013/12/scientist-developed-malware-covertly-jumps-air-gaps-using-inaudible-sound/</a><br />
Scientist-developed malware covertly jumps air gaps using inaudible sound</p>
<blockquote><p>Computer scientists have developed malware that uses inaudible audio signals to communicate, a capability that allows the malware to covertly transmit keystrokes and other sensitive data even when infected machines have no network connection.</p></blockquote>
<p>&#8230;</p>
<blockquote><p>The new research neither confirms nor disproves Dragos Ruiu&#8217;s claims of the so-called badBIOS infections, but it does show that high-frequency networking is easily within the grasp of today&#8217;s malware.</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209222">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209222">
						December 3, 2013 11:27 PM					</a>

				</p>

				<p>HW Developers should (have to) implement a HW-Switch (i.e. a simple jumper) to disable/enable Firmware-flashing! This could not be overridden by Software.<br />
Disable flashing by HW &#8211; Problem solved, easy and effective.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209223">

			<div class="comment by-honey ">

				<p class="commentcredit">

					<span class="commenter">honey</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209223">
						December 4, 2013 1:32 PM					</a>

				</p>

				<p>I agree with &#8220;Brandioch Conner&#8221;.</p>
<p>Additionally:<br />
I rly do not have faith in the credibility of Dragos Ruiu or his research.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209224">

			<div class="comment by-elmo ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.troydyck.com' rel='external nofollow ugc' class='url'>Elmo</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209224">
						December 5, 2013 4:20 PM					</a>

				</p>

				<p>I&#8217;ve taken a standard PC, freeware Audacity, and manually generated both Morse Code and Binary data in a simple .wav file using 20kHz &#8211; 22kHz &#8220;sound&#8221; with some fade in/fade out to clean up &#8216;tics&#8217;. When played you cannot hear it (the dog goes nuts though). I then used my iPhone and a sound spectrum analyzer (free app) and monitored the inaudible frequencies. BINGO&#8230; A partition type virus combined with modem type software (but modified to use inaudible sound) could easily perform communication between PCs.  Sound itself cannot infect a PC so if a standalone PC was not infected by a USB Device virus then the original install media, the original operating system or a utility used on the hard drive was infected.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209225">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209225">
						January 7, 2014 7:45 PM					</a>

				</p>

				<p>Sounds a bit like &#8216;SCP-1198&#8217;.  A science-fiction virus that can infect through airgaps without any previous malware installed to listen for it.  It&#8217;s &#8216;interesting&#8217; that no one&#8217;s able to just walk into his lab and duplicate the behavior on other computers.  BS called and collecting the pot unless this challenge is met.</p>
<p>Seriously though, with ever-reducing costs of adding a microcontroller to every chip in a system, in theory you could have backdoors that are enabled by specific patterns of sounds.  This is in the realm of conspiracy theories right now, but is trivial to implement.  Now that people are thinking openly about it, I can imagine it being added silently (or even openly) not just for espionage but for Cinavia/Macrovision functionality.  It&#8217;s not like it would take much bandwidth over Gb/s busses, to send 50b/s of extra data.  Think of that as a tiny wedge which can then go to the Internet to download a full payload.  Even with just audio you could have several KB of code in a few minutes, which is plenty to run a downloader.  Technically, you don&#8217;t even need the Internet if you have enough time.  If you&#8217;ve ever reflashed a WRT54G or used (Gameboy/DS) Flash carts, you probably know where I&#8217;m going with this.  Chips now have hardware debuggers that can flip bits on pins.</p>
<p>What isn&#8217;t mere speculation is that scanners and copiers ALREADY have code to detect money.  There is probably some trivially simple algorithm that takes very little transistors for this.  I&#8217;m thinking something hidden in the frequency domain picked up by shift registers.  Of course, it could just be some shoddy implementation like a firmware module.  😉  As the US SS isn&#8217;t exactly talking about it, who knows how it works&#8230;  We just know that you can deliberately disable some machines with a common 20-dollar bill.  Also, yellow dots to identify counterfeiters (and data leakers AKA whistleblowers) are well-known among techies.</p>
<p>If it ever turns out that a brand of hardware has compromised firmware out of the factory for this purpose, I imagine I&#8217;d be wanting to dump/margin call that stock ASAP when discovering it.  But that would be wrong to do insider trading.  Yep, no one&#8217;s ever done that!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209226">

			<div class="comment by-bw ">

				<p class="commentcredit">

					<span class="commenter">bw</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209226">
						January 7, 2014 8:21 PM					</a>

				</p>

				<p>IRATEMONK &#8211; persists in the harddrive firmware.<br />
<a href="http://commons.wikimedia.org/wiki/File:NSA_IRATEMONK.jpg" rel="nofollow ugc">http://commons.wikimedia.org/wiki/File:NSA_IRATEMONK.jpg</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209227">

			<div class="comment by-david-joyce ">

				<p class="commentcredit">

					<span class="commenter">David Joyce</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209227">
						January 15, 2014 3:17 PM					</a>

				</p>

				<p>OK everyone, read the NYT story this morning (&#8220;N.S.A. Devises Radio Pathway Into Computers&#8221;), then re-read the entire blog.  Clarify your understanding of Ruiu&#8217;s credibility (it&#8217;s still intact) the audio issue (the suggested communication is possible), the implied cost and scope of this issue (NSA&#8217;s recently exposed activities, and decades of its $40b/yr budget), etc., etc.,<br />
Would they do this if they could?<br />
Lord Acton answered this in 1887, &#8220;Power corrupts; absolute power corrupts absolutely&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209228">

			<div class="comment by-badbiosvictim ">

				<p class="commentcredit">

					<span class="commenter">BadBIOSvictim</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209228">
						April 21, 2014 2:57 PM					</a>

				</p>

				<p>Bruce Schneier, thank you for having the courage to report on BadBIOS in the beginning before researched substantiated it.</p>
<p>Steve Szmidt, thank you for discussing piezo electric speaker. I had disconnected the speaker and glued my laptop shut. Still ultrasonically hacked. After reading your comment, I researched piezo to discover that dial up modems have a two way piezo electric speaker. The hackers converted the dial up modem to an acoustic ultrasound modem.</p>
<p>Since 2011, my linux boxes and personal files have been infected with BadBIOS. My abuser, Jack Alter, hired private investigators who hired NSA trained crackers. See my story at:</p>
<p><a href="http://www.reddit.com/r/Malware/comments/23fxaa/badbios_live_linux_dvds_persistent_storage" rel="nofollow ugc">http://www.reddit.com/r/Malware/comments/23fxaa/badbios_live_linux_dvds_persistent_storage</a></p>
<p><a href="http://www.reddit.com/r/Malware/comments/23fzww/text_files_infected_with_badbios_and_latex/" rel="nofollow ugc">http://www.reddit.com/r/Malware/comments/23fzww/text_files_infected_with_badbios_and_latex/</a>.</p>
<p><a href="http://www.reddit.com/r/privacy/comments/23ljtiprivate_investigators_hire_nsa_trained_hackers/" rel="nofollow ugc">http://www.reddit.com/r/privacy/comments/23ljtiprivate_investigators_hire_nsa_trained_hackers/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209229">

			<div class="comment by-nil ">

				<p class="commentcredit">

					<span class="commenter">Nil</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209229">
						April 25, 2014 4:01 AM					</a>

				</p>

				<p>SIR &#8211; IT MAY BE WORTH READING THIS COMMENT, AND TAKE IT SERIOUSLY.</p>
<p>I am no security expert, but have been using windows computers for 15 years. This super-bad boot virus is VERY REAL. I am having it in my HDDs (1 SATA and 1 IDE). After reading a lot on the net, I am certain my infection is a variant of the BadBIOS virus received by Mr. Ruiu.</p>
<p>The virus probably came from a low-end cheap made-in-china Android cellphone. Around 3-4 months ago, I plugged it in my PC to copy some images from the MicroSD card, and the phone installed MoboGenie on my machine. Since then, malfunctions started.</p>
<p>Initially PC didn&#8217;t boot. I figured if I flush the CMOS, it boots. It continued for a month. I suspected a virus, and scanned the boot sector with AVAST. Nothing much. After 15 days, it started &#8220;PXE ROM&#8221; failure notice at start-up. Then 1 day it didn&#8217;t detect the monitor (several reboots&#8230;). About 10 days later, my Wacom Intuos tablet cursor started jumping all around the screen. I thought the tablet has gone bad. In 10 more days time, the keyboard and mouse started malfunctioning. It&#8217;s then I was sure of a boot virus, and took it seriously.</p>
<p>I had already noticed a process running named &#8216;daemon_process.exe&#8217;. If terminated, it immediately came back. Mine is a Win XP Home with SP3 (OEM).</p>
<p>I formatted HDDs with HDDGuru LLF and reinstalled. Virus ruled. Several formats (HDDGuru and DBAN from pendrive) later, virus rules.</p>
<p>Meanwhile, my phone was behaving badly. Many small things made me believe &#8211; the virus was controlling the phone from the PC (I use a USB Dongle wireless Reliance Huawei modem). In the phone call-log, I found info on calls made that I didn&#8217;t make. I received alert about incoming call from an unknown number to my phone via 1 of my many Gmail IDs (using some net2phone type option?). I found an app running in the phone named &#8216;Mobogenie_daemon&#8217;. I uninstalled that (and also Mobogenie). Since then, the PC responded better to fresh formats. However, boot is still infected.</p>
<p>The virus has totally played with DBAN. On one occasion, it excluded itself from the list of HDDs while it listed the pen-drive (hosting DBAN) as a SCSI drive!</p>
<p>Needless to say, the RAM is infected (shows .99 GB).</p>
<p>Once in the system, you are helpless against it. It infects every firmware space. And it comes from a cellphone!</p>
<p>I wonder if the Malaysian airlines MH370 carried this virus in the cockpit machinery, and someone took control of the plane to take it elsewhere. I wonder if the recent sunken Korean vessel changed direction several times before sinking, thanks to BadBIOS in the system (<a href="http://www.huffingtonpost.com/2014/04/23/south-korea-ferry-cause_n_5199318.html?utm_hp_ref=mostpopular" rel="nofollow ugc">http://www.huffingtonpost.com/2014/04/23/south-korea-ferry-cause_n_5199318.html?utm_hp_ref=mostpopular</a>). I wonder if the 3 recent submarine accidents of the Indian Navy are only due to failure of china-made digital equipments on-board.</p>
<p>BadBIOS is not just real &#8211; it&#8217;s the biggest threat we have at hand. We cannot even comprehend what&#8217;s coming. General computer architecture is so old and vulnerable, and our whole world is now digital based on such architecture &#8211; once developed by scientists and now run by just engineers/MCAs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209230">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209230">
						April 25, 2014 5:42 PM					</a>

				</p>

				<p>Nil<br />
&#8211;I wouldn&#8217;t just say it&#8217;s a BIOS issue, it may be something else&#8230;deeper; or just something silly. Or a peripheral chip.  My old android smartphone got a malicious non-approved update and would continue connecting to wifi networks like a little whore.  So there would be plenty other opportunities to send the data back on something as porous as a smartphone.  Maybe if you have a spare computer set up Aircrack-ng running all the time and sniff.</p>
<p>I likewise have an older pc that I&#8217;m unable to diagnose at this time (hefty infection, hope to god not polymorphic) and now I&#8217;m paralyzed thinking just how deep and WHERE exactly this code is hiding.  Never mind the fact that (I forget the name of what lock was set) kept me from getting in HPA/DCO settings trivially so I need to have another go at it w/ some forensic software; that <em>could</em> have been the people initially setting up the computer or the virus.  DBAN reads incorrect amount of memory (off some 3.5 GB&#8230;) while another program reads the correct amount labeled on the damn HDD.  The only tiny shred of evidence is some Chinese malware b/c of a single char in what I can read from the HPA/DCO.</p>
<p>Extremely irritating b/c I just want to know what it is, just don&#8217;t want it to consume all my time for my other projects.  If I get lucky though and can pin down a few suspect chips, I want to decap and look at them under a microscope.</p>
<p>Please update if you discover the problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209231">

			<div class="comment by-ph-t ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://amerdreamduh.blogspot.com/' rel='external nofollow ugc' class='url'>Ph.T</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209231">
						July 31, 2014 3:36 PM					</a>

				</p>

				<p>news.cyb/sec/badUSB:<br />
<a href="https://srlabs.de/badusb/" rel="nofollow ugc">https://srlabs.de/badusb/</a><br />
<a href="https://www.blackhat.com/us-14/briefings.html#Nohl" rel="nofollow ugc">https://www.blackhat.com/us-14/briefings.html#Nohl</a><br />
<a href="http://amerdreamduh.blogspot.com/2013/11/badbios-dragosr-vs-mac-linux-and-pc.html" rel="nofollow ugc">http://amerdreamduh.blogspot.com/2013/11/badbios-dragosr-vs-mac-linux-and-pc.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209232">

			<div class="comment by-conundrum ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://4hv.org' rel='external nofollow ugc' class='url'>Conundrum</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209232">
						September 21, 2014 10:27 AM					</a>

				</p>

				<p>Interesting.<br />
A while back I theorized that the failure of some Dell Dimension desktops to boot anything but a genuine Windows CD was actually deliberate, added as a &#8220;feature&#8221; to prevent the use of pirate Windows CD.</p>
<p>What if it wasn&#8217;t?<br />
I suspect that the no-boot problem is actually a badBIOS variant that was installed at manufacture or by a later FW update, this machine and another more recent one worked fine until this was done.<br />
Once installed it then won&#8217;t let you update and features in the BIOS aren&#8217;t present.</p>
<p>Also have seen the mobogenie on some memory cards before, it always gets nuked when the card is zeroed (even the first 1MB) and doesen&#8217;t come back even if the card is put in a different device, etc.<br />
Fakeflash on the other hand can and do carry malware and one notable example on a counterfeit 64GB microSD actually detects and replaces H2testW with a bad copy reporting perfect results for other fake cards!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-209236">

			<div class="comment by-rachel-wallace ">

				<p class="commentcredit">

					<span class="commenter">Rachel wallace</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209236">
						November 2, 2018 9:35 AM					</a>

				</p>

				<p>Hi all..<br />
No comments in 4 years but wanted to ad my experience.. it&#8217;s very real. I&#8217;ve been dealing with this thing for about 5 years.<br />
My most recent &#8212; yesterday.. so many corrupted machines that I actually pulled WiFi gsm and bt cards from a notebook, (earlier that day I suspected 2xraspberry pi &#8211; also : new sdcards : had infected my Android via Bluetooth (though I was once convinced I had badbios I had a 4mo stretch with no symptoms and was recently reinfected; discounted my experience after reading all the naysaying comments) ..anyway.. i installed win 10&#215;64 1083 on a factory refurb notebook and was watching a YouTube video on a 3 day old Android when i suddenly noticed windows processes jumping off the chart in task monitor ..  looked at phone and it had turned on nfc and bt-midi! When I pulled the phone from the machine It calmed but in 10? 15 seconds? Irreversibly rooted! Something in the system referenced timing set to tics; wiped both. Secure erased hdd from bios and doubled down security but on 1st boot windows was eating appx alive with 8we kyb8*** extension &#8212; powershell script-removed all appx and windows store, everything looked clear, i left machine running 8hrs while I went to work.</p>
<p>Everything looked fine when I came home&#8211; log errors stopped.. dug around a bit and though and found many processes out of place, wrong folders, many odd usernames.. when I started to remediate &#8211; everything snapped back into place! Visually only though. My petmissions were removed and I couldn&#8217;t look, own, or open any thing. The Pi&#8217;s had been owned before I could get the spi flasher installed! This is machine #14! It wasn&#8217;t connected to anything but was fighting my attempts to even look at what was going on in it.</p>
<p>Tried running defender offline and reinstalling  windows immediately but windows popping up looked like everything was being virtualized..</p>
<p>A few boots later and I&#8217;m certain somehow the bios was virtualized also.</p>
<p>I have built around 600 machines in my life, but i quit teching about 15 years ago .. I can spot a malicious window in the install process I know where to look for problems.  But that&#8217;s where I have to seek help I&#8217;m not a hacker or a coder or even in the tech field anymore I just want a machine that I can use for artwork. I have no idea why I&#8217;ve been targeted with this .. it&#8217;s taken my time, money, sanity, reputation..</p>
<p>When I seek help people clown me. See my last plea for help on Reddit (rachelmariewallace@hotmail.com)</p>
<p>I have changed accounts so many times now not knowing what the vector is&#8230;</p>
<p>My friends have lost interest and think I&#8217;m nuts, and I totally get it .. it sounds like a fairy tale</p>
<p>this thing has infected everybody&#8217;s machine around me..<br />
Most of those ppl are uninterested or ..basically tell me &#8216;ignorance is bliss&#8217; ..</p>
<p>This is kind of like a last plea for help ..I don&#8217;t know if anyone out there can help but ..</p>
<p>..</p>
<p>..if it helps anyone, my Android shows the following symptoms: tons of Qualcomm packages which look out of place (sprintdm &#8216;dm&#8217;in several apks, bluetoothmidi app surely shouldn&#8217;t been there and running, Android icons have been changed, many apks are exactly 146mb filesize or 0b (suspect replaced) and when I did recovery my bootloader was unlocked .. Symantec halt showed quadrooter susceptibility.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-209237">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/#comment-209237">
						November 2, 2018 3:54 PM					</a>

				</p>

				<p>Try taking the HDD out and put it in a second,but don&#8217;t boot from it( bios setting) scan with malwarebytes and a AV ,<br />
You could try repairing the boot sector from win 10 DVD( forgot the cmd command)<br />
If the AV found something look through the registry for keys the basic start at runtime and wininit key,you can use hirens boot CD to do it from the second computer,</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2013/11/badbios.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2013/11/badbios.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F11%2Fbadbios.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2013/11/badbios.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5082' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2013/11/friday_squid_bl_398.html" rel="prev">← Friday Squid Blogging: 8-Foot Giant Squid Pillow</a>		<a href="https://www.schneier.com/blog/archives/2013/11/more_nsa_revela.html" rel="next">More NSA Revelations →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
