<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>DDOS Attacks Using NTP - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; DDOS Attacks Using NTP Comments Feed" href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5177" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5177' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fddos_attacks_us.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fddos_attacks_us.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5177 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5177" class="post-5177 post type-post status-publish format-standard hentry category-uncategorized tag-denial-of-service">

	<div class="article">

		<h2 class="entry">DDOS Attacks Using NTP</h2>
		<p><a href="http://www.tomsguide.com/us/new-ddos-attack-targets-gamers,news-18203.html">This</a> is new:</p>
<blockquote><p>The NTP method first began to appear late last year. To bring down a server such as one running &#8220;League of Legends,&#8221; the attackers trick NTP servers into thinking they&#8217;ve been queried by the &#8220;League of Legends&#8221; server. </p>
<p>The NTP servers, thinking they&#8217;re responding to a legitimate query, message the &#8220;League of Legends&#8221; server, overloading it with as many as 100 gigabits per second (Gbps). That&#8217;s large even for a DDoS attack.</p>
<p>In this way, one small request to an NTP server can generate an enormous response capable of taking down even high-capacity websites.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/denial-of-service/" rel="tag">denial of service</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html" rel="bookmark">Posted on January 20, 2014 at 6:18 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html#comments">32 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html" data-title="DDOS Attacks Using NTP" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-214013">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214013">
						January 20, 2014 6:28 AM					</a>

				</p>

				<p>The ultimate solution to this type of inflating DoS is &#8220;Limit the length of an<br />
answer packet to the length of its request packet.&#8221; For DNS, for NTP, HTTP, &#8230;</p>
<p>I already posted about that here: <a href="https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1710034" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1710034</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214014">

			<div class="comment by-paul-renault ">

				<p class="commentcredit">

					<span class="commenter">Paul Renault</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214014">
						January 20, 2014 6:54 AM					</a>

				</p>

				<p>I realize that some NTP servers are old and/or not easily patchable.  As well as providing the means of a DDOS attack, this also hobbles the NTP server.</p>
<p>Isn&#8217;t this something that could be stopped by a firewall between the NTP server and the &#8216;Net &#8211; given a set of rules that can stop the incoming request?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214015">

			<div class="comment by-vasil-kolev ">

				<p class="commentcredit">

					<span class="commenter">Vasil Kolev</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214015">
						January 20, 2014 6:55 AM					</a>

				</p>

				<p>This is not new, and has been talked about on the NTP pool mailing lists in 2012, maybe even earlier, on how to limit the amplification of the NTP servers. One mail from a thread is <a href="http://lists.ntp.org/pipermail/pool/2012-June/005822.html" rel="nofollow ugc">http://lists.ntp.org/pipermail/pool/2012-June/005822.html</a> .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214016">

			<div class="comment by-m ">

				<p class="commentcredit">

					<span class="commenter">M@</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214016">
						January 20, 2014 7:14 AM					</a>

				</p>

				<p>Not much different than the smurf attacks of yore, sending small ICMP packets to one network&#8217;s broadcast address but addressed from your target&#8217;s IP address (or broadcast address, if you wanted to take out two network&#8217;s at once). Ah the days before firewalls.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214017">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214017">
						January 20, 2014 8:03 AM					</a>

				</p>

				<p>Et tu NTP?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214018">

			<div class="comment by-bas ">

				<p class="commentcredit">

					<span class="commenter">Bas</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214018">
						January 20, 2014 8:37 AM					</a>

				</p>

				<p>@M@</p>
<p>Same idea, but very different, this works across networks. It&#8217;s a lot more difficult to solve on a large scale and you need to do that to really solve this.<br />
With smurf attacks you could only attack (part of) your own network. The problem with no smurf protection on your network (within your control) would only be a problem to yourself.<br />
With the NTP-DDOS you&#8217;re vulnerable to servers not in your control.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214019">

			<div class="comment by-secret-police ">

				<p class="commentcredit">

					<span class="commenter">Secret Police</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214019">
						January 20, 2014 8:39 AM					</a>

				</p>

				<p>This was fixed by OpenBSD years ago when they wrote OpenNTPD after seeing the nightmarish cluster of code inside the official ntp release and instead wanted something that could be audited.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214020">

			<div class="comment by-geogriffin ">

				<p class="commentcredit">

					<span class="commenter">geogriffin</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214020">
						January 20, 2014 8:51 AM					</a>

				</p>

				<p>Sometimes terrible &#8220;firewall&#8221; units make things worse. I always hated how this router (CPE) ate my NTP packets, and turns out its ntpd was vulnerable:</p>
<p><a href="http://corp.sonic.net/status/2014/01/15/ntp-vulnerability-fix/" rel="nofollow ugc">http://corp.sonic.net/status/2014/01/15/ntp-vulnerability-fix/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214021">

			<div class="comment by-chuck ">

				<p class="commentcredit">

					<span class="commenter">chuck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214021">
						January 20, 2014 9:20 AM					</a>

				</p>

				<p>Something similar happened a decade ago.<br />
  <i>Flawed Routers Flood University of Wisconsin Internet Time Server</i></p>
<p><a href="http://pages.cs.wisc.edu/~plonka/netgear-sntp/" rel="nofollow ugc">http://pages.cs.wisc.edu/~plonka/netgear-sntp/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214022">

			<div class="comment by-aladdin ">

				<p class="commentcredit">

					<span class="commenter">Aladdin</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214022">
						January 20, 2014 9:34 AM					</a>

				</p>

				<p>Who uses NTP nowadays anyway?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214023">

			<div class="comment by-christian ">

				<p class="commentcredit">

					<span class="commenter">Christian</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214023">
						January 20, 2014 9:42 AM					</a>

				</p>

				<p>&#8220;Who uses NTP nowadays anyway?&#8221;</p>
<p>Basically everyone? Of how do you get the time to pc/smartphone.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214024">

			<div class="comment by-timekeeper ">

				<p class="commentcredit">

					<span class="commenter">TimeKeeper</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214024">
						January 20, 2014 9:51 AM					</a>

				</p>

				<p>&#8220;Basically everyone? Of how do you get the time to pc/smartphone&#8221;</p>
<p>From the satellites obviously. NTP is being decomissioned.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214025">

			<div class="comment by-feelyat ">

				<p class="commentcredit">

					<span class="commenter">feelyat</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214025">
						January 20, 2014 9:55 AM					</a>

				</p>

				<p>@chuck<br />
That Wisconsin event was similar only because it involved an NTP server, but in that case, it was a flaw in a commercial product that effectively DDoS&#8217;d the University NTP server by distributing thousands of poorly behaving NTP clients. Although the linked article doesn&#8217;t contain much in the way of details, it sounds like in this case, NTP servers are being used to launch DDoS attacks on other systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214026">

			<div class="comment by-steve-friedl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://unixwiz.net' rel='external nofollow ugc' class='url'>Steve Friedl</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214026">
						January 20, 2014 9:55 AM					</a>

				</p>

				<p>NTP = Network Time Protocol</p>
<p>NNTP = Network News Transfer Protocol</p>
<p>The first is the subject of this post, the second is not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214027">

			<div class="comment by-roland-dobbins ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.arbornetworks.com' rel='external nofollow ugc' class='url'>Roland Dobbins</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214027">
						January 20, 2014 9:57 AM					</a>

				</p>

				<p>Actually, it isn&#8217;t new.  We&#8217;ve observed ntp reflection/amplification DDoS attacks in the wild for 6-7 years, now.  It&#8217;s just that the more mainstream tech media have picked up on it due to the broad consumer base affected by the attacks in December and early January against online gaming networks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214028">

			<div class="comment by-aladdin ">

				<p class="commentcredit">

					<span class="commenter">Aladdin</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214028">
						January 20, 2014 10:01 AM					</a>

				</p>

				<p>I thought computers dial + 44 123 to get the time</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214029">

			<div class="comment by-nobodyspecial ">

				<p class="commentcredit">

					<span class="commenter">NobodySpecial</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214029">
						January 20, 2014 10:40 AM					</a>

				</p>

				<p>@Alladdin &#8211; not now we have siri<br />
They now pick a random number in a timezone in the middle of the night, ring it and parse the resposnse of the person screaming &#8220;don&#8217;t you know it&#8217;s 4:00am&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214032">

			<div class="comment by-nakker ">

				<p class="commentcredit">

					<span class="commenter">nakker</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214032">
						January 20, 2014 12:53 PM					</a>

				</p>

				<p>Our datacenter &#8211; a major western tier 3 datacenter, providing colo for several hundred major companies suffered a connectivity outage for over an hour this weekend as a result of this attack bringing down one of the DC&#8217;s border routers. This is serious business, it&#8217;s not theoretical and not just going after games. I have some additional details I can provide if anyone takes interest.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214033">

			<div class="comment by-dev-badsuperblock ">

				<p class="commentcredit">

					<span class="commenter">/dev/badsuperblock</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214033">
						January 20, 2014 2:47 PM					</a>

				</p>

				<p>Shouldn&#8217;t NTP servers throttle the number of replies they send to a given IP? I don&#8217;t know why on earth someone would request 1000 NTP updates a second, for hours&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214034">

			<div class="comment by-garf ">

				<p class="commentcredit">

					<span class="commenter">garf</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214034">
						January 20, 2014 8:55 PM					</a>

				</p>

				<p>sshdoor: Doing that to http (and some other types of requests) screws over tons of end users &#8211; or to put it another way, consequently doing that would make adsl an obsolete form of technology, and I&#8217;m not sure if there&#8217;s adequate replacement available.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214035">

			<div class="comment by-harry-johnston ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://harryjohnston.wordpress.com' rel='external nofollow ugc' class='url'>Harry Johnston</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214035">
						January 20, 2014 9:04 PM					</a>

				</p>

				<p>Surely at some point these malicious packets have to cross at least one router that knows (or ought to know) that the sender address in the packet isn&#8217;t valid for the interface that the packet came in on.  Why aren&#8217;t they filtered?</p>
<p>Does IPv6 do any better in this respect?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214036">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214036">
						January 21, 2014 2:36 AM					</a>

				</p>

				<p>Oddly, my router doesn&#8217;t allow NTP connections. All boxes use the world clock manually. Now, DNS jacking is a different story but solvable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214037">

			<div class="comment by-dazzzer ">

				<p class="commentcredit">

					<span class="commenter">dazzzer</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214037">
						January 21, 2014 5:53 AM					</a>

				</p>

				<p>nakker, I&#8217;d relay appreciate further info if you are willing to share. Was impact caused by high CPU on the boarder router, or exhaustion of uplink bandwidth making the router unreachable? Were any mitigations effective, or did you have to ride it out?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214039">

			<div class="comment by-arielb1 ">

				<p class="commentcredit">

					<span class="commenter">arielb1</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214039">
						January 21, 2014 12:08 PM					</a>

				</p>

				<p>@garf:</p>
<p>schneier.com apparently removes angle brackets rather then escaping them &#8211; I&#8217;m reposting with 〈brackets〉 (U+2329/U+232A)</p>
<p>This is usually only done on pre-cookie packets &#8211; after you get a cookie you can get whatever you want.</p>
<p>Basically:</p>
<p>Simple &#8220;RPC&#8221; requests:<br />
C -&gt; S: Request 〈params〉 〈padding〉<br />
S -&gt; C: Response 〈result〉<br />
    (|result| ≤ |params| + |padding|)</p>
<p>Session Requests (both real (say SSH) sessions and long TCP-ey transfers):<br />
C → S: Hello 〈params〉 〈client-cookie〉 〈hello-padding〉<br />
S → C: Ready 〈server-cookie〉 〈client-cookie〉 〈ready-response〉</p>
<p>C → S: Request 〈cookie〉 〈req〉<br />
C → S: Acknowledge 〈cookie〉 〈ack-to〉<br />
S → C: Response 〈resp〉</p>
<p>With the cookie bound to the IP address (and typically also the incoming port &#8211; which is sometimes used as 〈client-cookie〉) &#8211; if 〈cookie〉 is calculable from just 〈ret-cookie〉 this prevents anyone who can&#8217;t sniff a connection from sending stuff to it &#8211; and in some protocols (I heard that HTTP 2.0 does it) 〈cookie〉 is actually generated from a DH of 〈client-cookie〉 and 〈server-cookie〉 &#8211; 〈init-cookie〉||〈client-cookie〉 is signed in 〈ready-response〉 &#8211; of course there&#8217;s a KDF with the sequence number in-between.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214041">

			<div class="comment by-harry-johnston ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://harryjohnston.wordpress.com' rel='external nofollow ugc' class='url'>Harry Johnston</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214041">
						January 21, 2014 5:02 PM					</a>

				</p>

				<p>That last comment from arielb1 (&#8220;Here are some further notes on the subject&#8221;) looks potentially malicious.  Or has the comment system just done something odd?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214042">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214042">
						January 22, 2014 4:18 AM					</a>

				</p>

				<p>@garf: &#8220;Doing that to http (and some other types of requests) screws over tons of end users&#8221;</p>
<p>My suggestion is only for protocol that will be designed in the future. A future without such powerful DOS is better than a future without asymetric ADSL.</p>
<p>You would be surprised at the size of the http requests, loaded by cookies.</p>
<p>@Harry Johnston: &#8220;at some point these malicious packets have to cross at least one router that knows (or ought to know) that the sender address in the packet isn&#8217;t valid&#8221;</p>
<p>Try traceroute between two clients you own in two different contries: the forward and backwards route will differ.</p>
<p>This is because the dynamic routing protocols would be too complicated if the set of hops (routers) had to be the same for a legitimate request and for its answer. Except if the list of encoutered routers were added to request packets, like it done currently to emails.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214043">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214043">
						January 22, 2014 4:26 AM					</a>

				</p>

				<p>@Harry Johnston, please forget about my (wrong) answer to your question.</p>
<p>The right answer is that deep packet inspection is a task with too much complexity (defragmentation of packets, &#8230;) for a router.</p>
<p>Future protocols could enforce the sender address to be in a fixed format in the first 1024 bytes of the first packet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214044">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214044">
						January 22, 2014 4:40 AM					</a>

				</p>

				<p>@arielb1: &#8220;This is usually only done on pre-cookie packets [&#8230; specifications]&#8221;</p>
<p>Very nice answer, thank you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214045">

			<div class="comment by-arielb1 ">

				<p class="commentcredit">

					<span class="commenter">arielb1</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214045">
						January 22, 2014 5:45 AM					</a>

				</p>

				<p>@sshdoor:</p>
<p>I will note that the specification I posted is actually the basics of many network protocols rather then something I invented (TCP,DNS,HTTP/2,actually even TLS &#8211; which has a handshake [Hello/Ready] exchange independent of TCP&#8217;s) &#8211; of course they typically don&#8217;t call it `cookies&#8217; &#8211; TCP calls 〈client-cookie〉 client port and 〈server-cookie〉 sequence number &#8211; but same same. DNS uses the RPC protocol &#8211; It actually has a 〈client-cookie〉 too (Again the client port &#8211; I forgot to add it in that specification, but it is actually needed in these kinds of protocols to distinguish multiple requests from the same IP)</p>
<p>So they actually go like this:<br />
C → S: Request  〈client-cookie〉 〈params〉 〈padding〉<br />
S → C: Response  〈client-cookie〉 〈result〉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214046">

			<div class="comment by-harry-johnston ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://harryjohnston.wordpress.com' rel='external nofollow ugc' class='url'>Harry Johnston</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214046">
						January 22, 2014 1:50 PM					</a>

				</p>

				<p>@sshdoor: looking at the IP header is hardly &#8220;deep packet inspection&#8221; and it is already in the first 1024 bytes of the packet.</p>
<p>I&#8217;m guessing the problem is that it would be too much work for the typical ISP / carrier to figure out and keep track of all the legitimate exceptions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-214047">

			<div class="comment by-no ">

				<p class="commentcredit">

					<span class="commenter">no</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214047">
						February 13, 2014 9:18 AM					</a>

				</p>

				<p>The LoL attack was apparently these guys <a href="https://twitter.com/DerpTrolling" rel="nofollow ugc">https://twitter.com/DerpTrolling</a></p>
<p>Who have been griefing in various forms for years.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-214048">

			<div class="comment by-timetoolsglobal ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.timetoolsglobal.com/' rel='external nofollow ugc' class='url'>TimeToolsGlobal</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/#comment-214048">
						November 11, 2014 5:24 AM					</a>

				</p>

				<p>The latest version of NTP &#8211; 4.2.7 fixes this DDOS security issue. NTP.org recommends all users to update to the letest version as soon as possible. For users that have to stick with older versions, disable the monlist function with:</p>
<p>restrict default kod nomodify notrap nopeer noquery</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/01/ddos_attacks_us.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/01/ddos_attacks_us.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fddos_attacks_us.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/01/ddos_attacks_us.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5177' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/01/friday_squid_bl_408.html" rel="prev">← Friday Squid Blogging: Camouflage in Squid Eyes</a>		<a href="https://www.schneier.com/blog/archives/2014/01/ctx4000_nsa_exp.html" rel="next">CTX4000: NSA Exploit of the Day →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
