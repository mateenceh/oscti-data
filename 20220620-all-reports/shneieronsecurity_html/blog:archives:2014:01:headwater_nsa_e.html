<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>HEADWATER: NSA Exploit of the Day - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; HEADWATER: NSA Exploit of the Day Comments Feed" href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5161" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5161' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fheadwater_nsa_e.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fheadwater_nsa_e.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5161 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5161" class="post-5161 post type-post status-publish format-standard hentry category-uncategorized tag-backdoors tag-exploit-of-the-day tag-exploits tag-firewall tag-hardware tag-malware tag-nsa tag-operating-systems tag-security-engineering">

	<div class="article">

		<h2 class="entry">HEADWATER: NSA Exploit of the Day</h2>
		<p>Today&#8217;s implant from the NSA&#8217;s Tailored Access Operations (TAO) group <a href="http://leaksource.wordpress.com/2013/12/30/nsas-ant-division-catalog-of-exploits-for-nearly-every-major-software-hardware-firmware/">implant catalog</a>:</p>
<blockquote><p><b>HEADWATER</b></p>
<p>(TS//SI//REL) HEADWATER is a Persistent Backdoor (PDB) software implant for selected Huawei routers. The implant will enable covert functions to be remotely executed within the router via an Internet connection.</p>
<p>(TS//SI//REL) HEADWATER PBD implant will be transferred remotely over the Internet to the selected target router by Remote Operations Center (ROC) personnel. After the transfer process is complete, the PBD will be installed in the router&#8217;s boot ROM via an upgrade command. The PBD will then be activated after a system reboot. Once activated, the ROC operators will be able to use DNT&#8217;s HAMMERMILL Insertion Tool (HIT) to control the PBD as it captures and examines all IP packets passing through the host router.</p>
<p>(TS//SI//REL) HEADWATER is the cover term for the PBD for Huawei Technologies routers. PBD has been adopted for use in the joint NSA/CIA effort to exploit Huawei network equipment. (The cover name for this joint project is TURBOPANDA.)</p>
<p>STATUS: (U//FOUO) On the shelf ready for deployment.</p></blockquote>
<p>Page, with graphics, is <a href="http://leaksource.files.wordpress.com/2013/12/nsa-ant-headwater.jpg">here</a>. General information about TAO and the catalog is <a href="https://www.schneier.com/blog/archives/2013/12/more_about_the.html">here</a>.</p>
<p>This one is interesting.  It basically turns the router into an eavesdropping platform.</p>
<p>In the comments, feel free to discuss how the exploit works, how we might detect it, how it has probably been improved since the catalog entry in 2008, and so on.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="https://www.schneier.com/tag/exploit-of-the-day/" rel="tag">exploit of the day</a>, <a href="https://www.schneier.com/tag/exploits/" rel="tag">exploits</a>, <a href="https://www.schneier.com/tag/firewall/" rel="tag">firewall</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/security-engineering/" rel="tag">security engineering</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html" rel="bookmark">Posted on January 14, 2014 at 2:10 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html#comments">40 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html" data-title="HEADWATER: NSA Exploit of the Day" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-213413">

			<div class="comment by-renke ">

				<p class="commentcredit">

					<span class="commenter">renke</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213413">
						January 14, 2014 2:30 PM					</a>

				</p>

				<p>This one is very interesting &#8211; I believe it&#8217;s the first router exploit stating explicitly that the tool can be installed remotely (or did I miss other examples?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-213414">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213414">
						January 14, 2014 2:34 PM					</a>

				</p>

				<p>&#8220;This one is very interesting &#8211; I believe it&#8217;s the first router exploit stating explicitly that the tool can be installed remotely (or did I miss other examples?)&#8221;</p>
<p>I think all of the software implants can be installed remotely.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213415">

			<div class="comment by-renke ">

				<p class="commentcredit">

					<span class="commenter">renke</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213415">
						January 14, 2014 2:47 PM					</a>

				</p>

				<p>I skimmed the pages &#8211; this is the only one with remote installation mentioned, though most of the other exploits can be remotely deployed when BANANAGLEE is already running on the router.</p>
<p>Do we have more details about BANANAGLEE besides the codename? (<a href="http://cryptome.org/2014/01/nsa-codenames.htm" rel="nofollow ugc">http://cryptome.org/2014/01/nsa-codenames.htm</a>)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213416">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213416">
						January 14, 2014 3:01 PM					</a>

				</p>

				<blockquote><p>
[&#8230;]the ROC operators will be able to use DNT&#8217;s HAMMERMILL Insertion Tool (HIT) to control the PBD as it captures and examines all IP packets passing through the host router.
</p></blockquote>
<p>The description doesn&#8217;t explicitly say, but I imagine that the internal functioning is an extra set of rules, much like the router would normally use, but geared more towards an intrusion detection system like SNORT.</p>
<p>Pure guesswork, then, but if that is true, then the operation could be something like:</p>
<ul>
<li>Install HEADWATER</li>
<li>Router boots and HEADWATER fires up, presumably opening or allowing a connection to/from the ROC</li>
<li>ROC operator either uploads new SNORT-like rules to check traffic or looks at the progress so far</li>
</ul>
<p>ID-databases can grow pretty quickly, so offline persistence is a question&#8211;does HEADWATER run the exploit autonomously and report, or only when told to with a live stream?  If it&#8217;s ever found in the wild by a disinterested (not gov&#8217;t- or corporate-employed) researcher, I bet there will be some real revelations&#8230;</p>
<p>I would also guess that there is a potential for a noticeable performance hit&#8211;try looking for everything, and the router starts bogging down.  Next thing you know, the local maintenance department is digging into the system or looking at replacing it because it&#8217;s bogging down the system.</p>
<p>I would guess that the performance impact is one of the things the ROC would watch&#8211;balancing stealthiness against the eavesdropping requests.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213417">

			<div class="comment by-marcos-el-malo ">

				<p class="commentcredit">

					<span class="commenter">Marcos El Malo</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213417">
						January 14, 2014 3:53 PM					</a>

				</p>

				<p>@David</p>
<p>&#8220;Next thing you know, the local maintenance department is digging into the system or looking at replacing it because it&#8217;s bogging down the system.&#8221;</p>
<p>If these are cheapo consumer grade routers, they&#8217;re either getting tossed or reflashed by the cable company that issues them to their customers. I don&#8217;t expect anyone is looking into what is causing the problems, since so many fail from &#8220;natural causes&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213418">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213418">
						January 14, 2014 4:24 PM					</a>

				</p>

				<p>The solution to such pwned routers is open source.  Every piece of hardware, every piece of software, every operating system, every BIOS, every firmware, every chip, every motherboard.</p>
<p>Not because open source enables every individual to verify, indeed not everyone has the expertise to understand.  But because the principle of openness makes it harder to hide things.  What grows in the darkness of secrecy withers in the light of openness.</p>
<p>Closed source, more secrecy, making things unchangeable, and pointless talking heads assuring everyone everything&#8217;s ok are not the answers.  More freedom and openness is the answer.</p>
<p>To be clear, open source is not a panacea.  Being open does not guarantee something is trustworthy.  It only guarantees it CAN BECOME trustworthy, over time, with enough peer review.  Whereas closed source is impossible to become trustworthy, by virtue of its resistance to review.  Trust is earned.  No verify, no trust, ever.  Verify, someday maybe trust.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213419">

			<div class="comment by-johnston ">

				<p class="commentcredit">

					<span class="commenter">Johnston</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213419">
						January 14, 2014 4:44 PM					</a>

				</p>

				<p>@Bruce</p>
<p>Since https is available on the leaksource site, would you please link there instead?  eg</p>
<p><a href="https://leaksource.files.wordpress.com/2013/12/nsa-ant-headwater.jpg" rel="nofollow ugc">https://leaksource.files.wordpress.com/2013/12/nsa-ant-headwater.jpg</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213420">

			<div class="comment by-douglas-knight ">

				<p class="commentcredit">

					<span class="commenter">Douglas Knight</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213420">
						January 14, 2014 4:57 PM					</a>

				</p>

				<p>Why is the status of some of these exploits (ie, ready for use, in the field, etc) classified Confidential, while others are Unclassified?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213421">

			<div class="comment by-russ ">

				<p class="commentcredit">

					<span class="commenter">Russ</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213421">
						January 14, 2014 5:05 PM					</a>

				</p>

				<p>As I said on another thread the real solution to this type of exploit is to have a physical toggle switch that interrrupts the flash chip&#8217;s write-enable pins or logic to that effect, controlled by that switch.</p>
<p>The age of consumer devices being designed to do firmware updates without physical presence and approval of the owner needs to come to an end.</p>
<p>Companies will complain about &#8216;field units&#8217; and sending staff in a truck to some remote installation, but hey, if you want real security, too bad, suck it up and send someone to throw the switch for the upgrade.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213422">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213422">
						January 14, 2014 5:18 PM					</a>

				</p>

				<p>@ Russ you still have to be able to trust the upgrade&#8230;  how can you, when it&#8217;s closed source?</p>
<p>Having the option to use a physical write protection switch is always a good thing, but beware that some such switches already existing on some media devices are in fact software switches that don&#8217;t offer any real protection&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213423">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213423">
						January 14, 2014 5:24 PM					</a>

				</p>

				<p>I&#8217;m starting to get real curious about the infrastructure needed to sneak out the data, when one of these routers is compromised.</p>
<p>For example, if a compromised router comes across data that needs to be sent back to the ROC, how does it get there stealthily?  A set of regular packets marked &#8220;Destined for [NSA-registered] IP&#8221; is kind of a big flag that something nefarious is going on&#8211;so how?</p>
<p>Setting up a roving band of &#8220;innocent&#8221; servers to collect the data is one possibility, but then you have to keep the clients updated, or tell them where to deliver the goods.</p>
<p>Maybe there is an NSA version of TOR installed along with the PDB&#8211;some obfuscated destination that, once it gets into the right hands, gets routed appropriately.</p>
<p>But that, by itself, wouldn&#8217;t cover the fact that the traffic output from a compromised router would be much higher than it should be.  I&#8217;m not sure what kind of traffic analysis would need to be done, but if the router is making copies of interesting data and redirecting it to the ROC, then the packet count going into the server should be significantly different from that coming out.</p>
<p>Hmmm&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213424">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213424">
						January 14, 2014 5:41 PM					</a>

				</p>

				<p>&#8220;I&#8217;m starting to get real curious about the infrastructure needed to sneak out the data, when one of these routers is compromised.&#8221;</p>
<p>And what&#8217;s it encrypted with? Hardcoded symmetric key? Public key known to the recipient?<br />
Steganography? Disguised as DNS? Oblivious transfer?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213425">

			<div class="comment by-stang ">

				<p class="commentcredit">

					<span class="commenter">Stang</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213425">
						January 14, 2014 6:42 PM					</a>

				</p>

				<p>It&#8217;s time to rethink &#8220;no security by obscurity&#8221;. The less info that is public, the harder it is for the NSA to compromise security. Or maybe we should: <a href="http://gizmodo.com/a-swedes-insane-rant-against-the-internet-as-told-by-g-1501098204" rel="nofollow ugc">Stang ner internet!</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213426">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213426">
						January 14, 2014 7:08 PM					</a>

				</p>

				<p>@Stang<br />
This kind of security totally depends on keeping something secret, and as Snowden and others have proved, is very, very difficult these days. A safe in your house made of tinfoil is secure if nobody can find it, sure, but the best solution is a safe nobody can open if it&#8217;s found. Anybody that gets in your house when you&#8217;re out of town will have ample time to find your tinfoil safe.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213427">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213427">
						January 14, 2014 7:53 PM					</a>

				</p>

				<p>@stang: security by obscurity is not security, that&#8217;s just head in sand.</p>
<p>Here&#8217;s a great quote:</p>
<p>&#8220;If I take a letter, lock it in a safe, hide the safe somewhere in New York, then tell you to read the letter, that&#8217;s not security.  That&#8217;s obscurity.  On the other hand, if I take a letter, and lock it in a safe, and then give you the safe along with the design specifications of the safe and a hundred identical safes with their combinations so that you and the world&#8217;s best safecrackers can study the locking mechanism&#8211;and you still can&#8217;t open the safe and read the letter&#8211;that&#8217;s security.&#8221;<br />
&#8211;Bruce Schneier, Applied Cryptography, 2nd Edition, p. xix</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213428">

			<div class="comment by-tony-h ">

				<p class="commentcredit">

					<span class="commenter">Tony H.</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213428">
						January 14, 2014 8:12 PM					</a>

				</p>

				<p><cite>I&#8217;m starting to get real curious about the infrastructure needed to sneak out the data, when one of these routers is compromised.</cite><br />
Clearly they can&#8217;t echo everything because it&#8217;ll be noticed by volume alone. But they don&#8217;t have to echo the whole stream, because they mostly have it already if they have the backbone compromised. What they need is the keys for encrypted traffic going onto the Internet (e.g. VPN between office branches), and the internal traffic that doesn&#8217;t go out. Leaking keys should be really easy because the volume is so small. Piggyback it on DNS queries, respond to a few of the usual torrent of breakin attempts that any Internet-exposed box gets. What about a few &#8220;call home&#8221; or &#8220;check for updates&#8221; packets to the router maker&#8217;s site? Routine NTP time checks? And I&#8217;d guess a good implant would do some observing; if there&#8217;s a lot of Facebook traffic, just add a few packets from time to time. If there&#8217;s a lot of porn site visiting, add a few more. Google, Gmail, Yahoo, etc. etc. if they can observe it all in transit somewhere.</p>
<p>Exfiltrating larger quantities of internal-only traffic would seem harder, but in the common office-to-office VPN scenario, if they can observe the traffic at some point they can sneak in a few extra packets or fields. As long as the other end has also been compromised so it doesn&#8217;t object&#8230; When I look at what goes in and what comes out of the (enterprise-grade) VPN box here, I see all kinds of mostly TCP stuff on the inside, HTTP, FTP, Windows SMB, etc, and nothing but RFC 4303 ESP packets on the outside. Packet sniffing on both sides at once tells me nothing; it would take much better tools to see anything amiss.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213429">

			<div class="comment by-john-doe ">

				<p class="commentcredit">

					<span class="commenter">John Doe</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213429">
						January 14, 2014 9:04 PM					</a>

				</p>

				<p>My old routers seemed to have a lot of logging features and the ability to write a lot of rules and create filters. Most of my recent routers have less and less ability to  monitor or modify. Practically tweak proof.</p>
<p>I see why now. They don&#8217;t want users to have control.</p>
<p>I don&#8217;t think the NSA needs to use their tricks on American hardware, the backdoors and loggers are already built into the chip.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213430">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213430">
						January 14, 2014 9:17 PM					</a>

				</p>

				<p>@Tony H.</p>
<p>You might be right&#8211;most of the scenarios that play out in arguments and jokes are &#8220;they copy everything&#8221;, but maybe it&#8217;s just encryption seed/keys and connectivity info&#8230;all of which would be exceedingly small and easy to drop into a gig+ pipe without anyone noticing.</p>
<p>As for delivery home, I&#8217;m not sure how it would play out.  If I were a super-secret paranoid spy agency, guaranteed delivery would be a lot more important than depending on another hacked site to gather up your messages-in-a-bottle.</p>
<p>I guess the easiest way would be to include an alternate routing with your exploits&#8211;as you break through firewall/router security, the next hop just backtracks through the previous infiltration until it&#8217;s out in the wild intarwebs, where any number of methods can be used to send it home.  Incoming commands can act as a gateway protocol&#8211;keeping routes up to date&#8211;and the &#8220;shadow&#8221; routing table would fit right into the existing functionality of the appliance.</p>
<p>If you&#8217;re trying to keep a random admin from stumbling upon your secret DarkNet routing tables, I guess you could reserve some memory&#8211;especially since a lot of these are firmware updates.  Getting toward the outer limits of my expertise, but could oddball memory usage be a worthwhile indicator of a compromise?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213431">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213431">
						January 14, 2014 10:49 PM					</a>

				</p>

				<p>@ DB</p>
<p>&#8220;but beware that some such switches already existing on some media devices are in fact software switches that don&#8217;t offer any real protection&#8230;&#8221;</p>
<p>Forgot to add: excellent point. Those must be avoided.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213432">

			<div class="comment by-jay ">

				<p class="commentcredit">

					<span class="commenter">Jay</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213432">
						January 14, 2014 11:17 PM					</a>

				</p>

				<p>@Russ:</p>
<p>Physical write switches are no defence against an opponent with evil maids, burglars, or access to the equipment before it ships.</p>
<p>[Also worth noting: in this hack, they already have control over the router before they make it reflash itself. Depending on the CPU architecture, they might have been able to make their backdoor live entirely in RAM instead.]</p>
<p>&#8230;I&#8217;d almost prefer firmware that automatically reflashes itself weekly, from updates the manufacturers&#8217; HTTPS site. Sure, it&#8217;s an easy path in for anyone who can compel the CA or the manufacturer to deliver you dodgy firmware &#8211; but at least that&#8217;s a legal path. How does handing permanent access to the first random hacker (NSA or not) with an exploit for your old firmware help any?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213433">

			<div class="comment by-youve-got-mail ">

				<p class="commentcredit">

					<span class="commenter">you&#039;ve.got.mail</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213433">
						January 14, 2014 11:24 PM					</a>

				</p>

				<p>@DB Security is simply another name for safety.</p>
<p>As an end, it can be achieved by taking control of the situation in one way or another.</p>
<p>Physical control may prevent an attack by interposing an obstacle to big to be physically moved.</p>
<p>Epistemological control may prevent an attack by denying an attacker the knowledge that they need to interfere.</p>
<p>And sometimes obscurity plus a provision for loss recovery provides satisfactory security:</p>
<p><a href="https://en.wikipedia.org/wiki/Hope_Diamond" rel="nofollow ugc">https://en.wikipedia.org/wiki/Hope_Diamond</a></p>
<p>&#8220;Smithsonian mineralogist George Switzer is credited with persuading Harry Winston to donate the Hope Diamond to the Smithsonian National Museum of Natural History for a proposed national gem collection to be housed at the museum.[47] On November 10, 1958,[12] Winston donated the diamond to the Smithsonian Institution, where it became Specimen #217868,[48] sending it through U.S. Mail in a box wrapped in brown paper,[2] insured via registered mail at a cost of $145.29, of which only $2.44 was for postage with the remainder covering insurance for the gem&#8217;s $1 million value at that time.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213434">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213434">
						January 15, 2014 12:04 AM					</a>

				</p>

				<p>So this is why US companies shouldn&#8217;t use Huawei routers? I read &#8220;the ROC operator&#8221; and wondered what Taiwan has got to do with it&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213435">

			<div class="comment by-russ ">

				<p class="commentcredit">

					<span class="commenter">Russ</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213435">
						January 15, 2014 1:04 AM					</a>

				</p>

				<p>@Jay, @DB</p>
<p>I was speaking specifically against persistent code threats written to flash, applied remotely. I understand that a black-bag job can do a firmware update even if one must flip a switch to enable the update; and that in-RAM (non-persistant) malware doesn&#8217;t need to update the firmware.</p>
<p>I&#8217;m just saying, hardware write-protect to persistent storage is one of many defenses that nowadays just seems to be out of fashion. I&#8217;m old enough to remember floppy discs that had a hole cut in the side or a slot that could be closed to control writing. It&#8217;s always bothered me that USB keys similarly should all have a hardware switch to prevent writing (and the SD card standard didn&#8217;t mandate that the write-protect switch was implemented either!). That might prevent many &#8220;air gap&#8221; jumping malware if modern storage didn&#8217;t always allow writing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213436">

			<div class="comment by-rogerh ">

				<p class="commentcredit">

					<span class="commenter">rogerh</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213436">
						January 15, 2014 1:57 AM					</a>

				</p>

				<p>All these exploits are sort of interesting &#8211; but what is the point of it all?  Seems to me that when it come to terrorists and serious spies the NSA and GCHQ are now a busted flush.  Both the US and UK governments could save big bucks by cutting back both operations.  Then again what useful information could looking into folk&#8217;s computers and comms discover &#8211; what Uzbek tank commanders eat for breakfast,  the colour of Mrs Merkel&#8217;s underwear,  the sex antics of oil sheiks,  the latest method India uses to manufacture some drug or other.  Interesting but nearly useless.  Of more use &#8211; who buys typewriter ribbons on Ebay.</p>
<p>Much more sinister is passing across the doings of local political opponents &#8211; very wrong,  let politicians flog each other in public &#8211; to use spying is to subvert democracy.  As for understanding the intentions of governments &#8211; that is what embassy parties are for &#8211; local knowledge &#8211; getting into bed (literally) with your target.  Similarly with industrial secrets &#8211; there are really very few secrets &#8211; what matters is the state of education and sophistication within a nation.  A close study of trade press and academic journals and the blogs reveals a lot &#8211; what one can do,  so can another.</p>
<p>Then there is the cost.  From a cold financial point of view the damage terrorists do does not amount to much and there is no evidence spying has any real chance of stopping terrorists &#8211; the ones that have been publicly unmasked were pretty poor specimens.  But any terror event is embarrassing to the politicians,  it makes them look powerless and to avoid that seems worth any cost (to the taxpayer).  Maybe what really scares the politicians is just you and me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213437">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213437">
						January 15, 2014 3:07 AM					</a>

				</p>

				<p>@renke</p>
<p>“…this is the only one with remote installation mentioned.”</p>
<p>I noticed that too. I also notice “On the shelf read for deployment” and on Huawei routers.</p>
<p>@David</p>
<p>D-databases can grow pretty quickly, so offline persistence is a question&#8211;does HEADWATER run the exploit autonomously and report, or only when told to with a live stream? If it&#8217;s ever found in the wild by a disinterested (not gov&#8217;t- or corporate-employed) researcher, I bet there will be some real revelations&#8230; I would also guess that there is a potential for a noticeable performance hit…”</p>
<p>Maybe and then maybe not – think about a BIOS hack and the CALEA law requirements.</p>
<p>[and]</p>
<p>&#8220;…if a compromised router comes across data that needs to be sent back to the ROC, how does it get there stealthily? A set of regular packets marked &#8220;Destined for [NSA-registered] IP&#8221; is kind of a big flag that something nefarious is going on&#8211;so how? …but if the router is making copies of interesting data and redirecting it to the ROC, then the packet count going into the server should be significantly different from that coming out.”</p>
<p>Unless it was “legal” exfiltrating of the traffic.</p>
<p>@Tony H</p>
<p>“Exfiltrating larger quantities of internal-only traffic would seem harder, but in the common office-to-office VPN scenario, if they can observe the traffic at some point they can sneak in a few extra packets or fields. As long as the other end has also been compromised so it doesn&#8217;t object&#8230; When I look at what goes in and what comes out of the (enterprise-grade) VPN box here, I see all kinds of mostly TCP stuff on the inside, HTTP, FTP, Windows SMB, etc, and nothing but RFC 4303 ESP packets on the outside. Packet sniffing on both sides at once tells me nothing; it would take much better tools to see anything amiss.”</p>
<p>Again, the CALEA law requirements forces all manufactures to provide a backdoor. There may be no need to sneak a few packets to the government &#8211; the whole stream may be legal.</p>
<p>This is just speculation &#8211; but what if the US government put the arm on Huawei to provide a “super back-door” to be able to sell routers in the US under the ruse of CALEA. The NSA could then put a set of implants into the CALEA port mirror or deep packet inspection probe to send all information to Fort Mead for further analysis (It may be against the &#8220;spirit of the law&#8221; but possibly &#8220;not be against the law” if the data was routed through the FBI’s router then to the NSA).</p>
<p>Here is some broad technical data on CALEA:</p>
<p>‘Technical Implementation’</p>
<p>“USA telecommunications providers must install new hardware or software, as well as modify old equipment, so that it doesn&#8217;t interfere with the ability of a law enforcement agency (LEA) to perform real-time surveillance of any telephone or Internet traffic. Modern voice switches now have this capability built in, yet Internet equipment almost always requires some kind of intelligent Deep Packet Inspection probe to get the job done. In both cases, the intercept-function must single out a subscriber named in a warrant for intercept and then immediately send some (headers-only) or all (full content) of the intercepted data to an LEA. The LEA will then process this data with analysis software that is specialized towards criminal investigations.</p>
<p>“All traditional voice switches on the U.S. market today have the CALEA intercept feature built in. The IP-based &#8220;soft switches&#8221; typically do not contain a built-in CALEA intercept feature; and other IP-transport elements (routers, switches, access multiplexers) almost always delegate the CALEA function to elements dedicated to inspecting and intercepting traffic. In such cases, hardware taps or switch/router mirror-ports are employed to deliver copies of all of a network&#8217;s data to dedicated IP probes.</p>
<p>“Probes can either send directly to the LEA according to the industry standard delivery formats (c.f. ATIS T1.IAS, T1.678v2, et al.); or they can deliver to an intermediate element called a mediation device, where the mediation device does the formatting and communication of the data to the LEA. A probe that can send the correctly formatted data to the LEA is called a &#8220;self-contained&#8221; probe.</p>
<p>“In order to be compliant, IP-based service providers (Broadband, Cable, VoIP) must choose either a self-contained probe (such as made by IPFabrics), or a &#8220;dumb&#8221; probe component plus a mediation device (such as made by Verint), or they must implement the delivery of correctly formatted for a named subscriber&#8217;s data on their own.”</p>
<p><a href="http://en.m.wikipedia.org/wiki/Communications_Assistance_for_Law_Enforcement_Act" rel="nofollow ugc">http://en.m.wikipedia.org/wiki/Communications_Assistance_for_Law_Enforcement_Act</a></p>
<p>Could CALEA be the ultimate backdoor for the NSA?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213438">

			<div class="comment by-rahul ">

				<p class="commentcredit">

					<span class="commenter">Rahul</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213438">
						January 15, 2014 4:04 AM					</a>

				</p>

				<p>What makes me curious is it has been more than a week now since this exploit has been reported but how come no reports of detection from the wild? None of the guys owning the target routers are aware nor concerned?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213439">

			<div class="comment by-ola ">

				<p class="commentcredit">

					<span class="commenter">Ola</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213439">
						January 15, 2014 4:21 AM					</a>

				</p>

				<p>@65535<br />
&#8220;USA telecommunications providers must install &#8230;&#8221;</p>
<p>Not router manufacturer.</p>
<p>Didn&#8217;t FX Lindner had an presentation about Huawei? From what I remember the software on them was so bad than even your grandmother could write an exploit for them.</p>
<p>It seems to me that this implant catalog is just two years ahead of &#8220;open source&#8221;. Should we cont. doing router exploitation in open? As it is most certainly used against you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213440">

			<div class="comment by-ted ">

				<p class="commentcredit">

					<span class="commenter">ted</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213440">
						January 15, 2014 8:49 AM					</a>

				</p>

				<p>&#8220;The PBD will then be activated after a system reboot.&#8221;</p>
<p>How often do people reboot their network devices? I work in a data center. Our network gear goes years between reboots.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213441">

			<div class="comment by-bytes ">

				<p class="commentcredit">

					<span class="commenter">Bytes</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213441">
						January 15, 2014 9:54 AM					</a>

				</p>

				<p>@ ted suspect that the firmware can force a reboot after it is loaded, unless you have and maintain a robust protective monitoring regimin for your systems , such issues would most likely be put down to a &#8220;network glitch&#8221; the apathy &amp; if it aint broke don&#8217;t fix it also contributes</p>
<p>whats always been the elephant in the room is you have your system &amp; application hardening, secure code development , Security operation procedures etc etc, but the supply chain for hardware infrastructure manufactures ? tin generally gets wheeled in the door, oh its new and from XXXX hardware manufacturer no longer ( well has never really ) offered any assurance, classic Trojan horse , your tin is the horse.</p>
<p>CC and EAL is also pretty laughable, you only have t look at the TOR to realise the assurance is only valid when left in the box i a dark room with the moon aligned to Pluto.</p>
<p>I guess i&#8217;m just a paranoid old security consultant but these revelations dont surprise me, though they are interesting to look at in the clear light of day.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213442">

			<div class="comment by-alan-wexelblat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://alanwexelblat.com' rel='external nofollow ugc' class='url'>Alan Wexelblat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213442">
						January 15, 2014 12:16 PM					</a>

				</p>

				<p>I think I have the outline of a system that would not prevent compromises but that would enable the router owner to know if it had been compromised. This assumes the router operator is an honest broker and not just a shill for the NSA or its Chinese counterpart.</p>
<p>Imagine that the router has the ability to compute a one-time pad member number. The generated &#8220;checksum&#8221; would be computed over the firmware and include sufficient information to uniquely identify each piece of hardware (mac address, gps coordinates, pick your preferred).</p>
<p>On boot and at some agreeable heartbeat interval the device &#8220;phones home&#8221; with its checksum. If there&#8217;s any error the device can&#8217;t start up. If there&#8217;s an error after that you can do any number of things such as take the router offline, raise an alarm, etc.</p>
<p>I think this gives three possible places to attack: the router, home, and man-in-the-middle. Assuming that the crypto is sufficiently good you ought not to be able to predict what the sum should have been so you can&#8217;t either force the router to emit it or have a MITM emit it. That leaves a compromise of the central device, which is always possible but I would hope easier to detect. There are fewer of them and they can be in more monitored and checked locations than a distributed network of routers.</p>
<p>You could say that I haven&#8217;t solved the problem &#8211; just moved it upstream. I think I read that a variant of &#8220;compromise the phone-home controller&#8221; was used as part of the Natanz operation, but the question posed was &#8220;how might we detect that a router has been turned into an eavesdropping platform&#8221; and that&#8217;s what I&#8217;m trying to address.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213443">

			<div class="comment by-insider ">

				<p class="commentcredit">

					<span class="commenter">Insider</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213443">
						January 15, 2014 12:49 PM					</a>

				</p>

				<p>As you mentioned, Bruce, this HEADWATER report is from 2008. There has been an enormous amount of innovation in the router/load balancer space since then&#8230; so I wonder if these backdoors still exist?</p>
<p>More importantly, as someone inside this industry and with an intimate knowledge of the hardware and software involved, it is a well-known secret that Huawei simply steals or copies other companies software and designs. (One of the benefits of doing your design/mfg in China, I guess.)</p>
<p>So the bigger question here is whether this backdoor existed in some IP they stole from elsewhere, or if it is in the part of the code that they wrote themselves?</p>
<p>In other words, if this works on a Huawei device, it is entirely possible there are other devices in the industry with the same weakness. (This wouldn&#8217;t be the first time that Huawei&#8217;s &#8220;product development&#8221; techniques were exposed by copying other mfgs unique bugs&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213444">

			<div class="comment by-tony-h ">

				<p class="commentcredit">

					<span class="commenter">Tony H.</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213444">
						January 15, 2014 2:24 PM					</a>

				</p>

				<p><cite>Could CALEA be the ultimate backdoor for the NSA?</cite><br />
Thing is, CALEA applies to telcos and ISPs and such, and the NSA is already in a position to tell them what to do via NSLs and the like. CALEA doesn&#8217;t provide for telling a company to spy on its own employees. I&#8217;d think the targets of the items in this catalog are routers/firewalls in corporate settings, and ISPs outside the USA where CALEA doesn&#8217;t help in any case.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213445">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213445">
						January 15, 2014 3:28 PM					</a>

				</p>

				<p>I know a neighbour who has a router called speedport ip 724V A from Deutsche Telekom. In the manual, it is said that this is actually a huawei router. This is also what wikipedia says: <a href="http://de.wikipedia.org/wiki/Speedport" rel="nofollow ugc">http://de.wikipedia.org/wiki/Speedport</a></p>
<p>Looking at the configuration interface, it becomes clear that this router has a builtin firewall, that can not be switched off. But strangely one also can not configure (i.e open or close) the following ports:</p>
<p>21,1900,5060,5061,7547,37215,37443,50000-50019,54058-56003,56005</p>
<p>The config site of the router says that all these ports can not be configured by the user, as they would be used by the internet service provider for maintenance work.</p>
<p>Indeed, if one does a firmware reset, the router gets automagically the newest firmware after the restart.</p>
<p>It is perhaps this way that the NSA can get into huawei routers.</p>
<p>They make the router believe, they are the internet service provider and install a &#8220;firmware update&#8221; through these service ports that the user can not configure.</p>
<p>The only way to work around to this would be, as far as i know, to throw the huawei router aka speedport.ip 724 into the waste bin.</p>
<p>Other routers might have other backdoors, as one sees from this backdoor, where an undocumented service lists on port 32764 that spills out your wlan passwort into the internet:</p>
<p><a href="https://github.com/elvanderb/TCP-32764" rel="nofollow ugc">https://github.com/elvanderb/TCP-32764</a></p>
<p>the search machine shodan now lists  13219 routers on the worldwide net that have this backdoor open:</p>
<p><a href="http://www.shodanhq.com/search?q=port%3A32764" rel="nofollow ugc">http://www.shodanhq.com/search?q=port%3A32764</a></p>
<p>It is somewhat scarry, that three manufracturers produce routers with exactly the same backdoor. This is the recent list of devices with that behavior:</p>
<p>Cisco WAP4410N-E 2.0.1.0, 2.0.3.3, 2.0.4.2, 2.0.6.1 (issue 44)<br />
Linksys WAG120N (@p_w999)<br />
Netgear DG834B V5.01.14 (@domainzero)<br />
Netgear DGN2000 1.1.1, 1.1.11.0, 1.3.10.0, 1.3.11.0, 1.3.12.0 (issue 44)<br />
Netgear WPNT834 (issue 79)<br />
OpenWAG200 maybe a little bit TOO open 😉 (issue 49)<br />
Backdoor confirmed in:</p>
<p>Cisco RVS4000 fwv 2.0.3.2 (issue 57)<br />
Cisco WAP4410N (issue 11)<br />
Cisco WRVS4400N<br />
Cisco WRVS4400N (issue 36)<br />
Diamond DSL642WLG / SerComm IP806Gx v2 TI (<a href="https://news.ycombinator.com/item?id=6998682" rel="nofollow ugc">https://news.ycombinator.com/item?id=6998682</a>)<br />
LevelOne WBR3460B (<a href="http://www.securityfocus.com/archive/101/507219/30/0/threaded" rel="nofollow ugc">http://www.securityfocus.com/archive/101/507219/30/0/threaded</a>)<br />
Linksys RVS4000 Firmware V1.3.3.5 (issue 55)<br />
Linksys WAG120N (issue 58)<br />
Linksys WAG160n v1 and v2 (@xxchinasaurxx @saltspork)<br />
Linksys WAG200G<br />
Linksys WAG320N (<a href="http://zaufanatrzeciastrona.pl/post/smieszna-tylna-furtka-w-ruterach-linksysa-i-prawdopodobnie-netgeara/" rel="nofollow ugc">http://zaufanatrzeciastrona.pl/post/smieszna-tylna-furtka-w-ruterach-linksysa-i-prawdopodobnie-netgeara/</a>)<br />
Linksys WAG54G2 (@_xistence)<br />
Linksys WAG54GS (@henkka7)<br />
Linksys WRT350N v2 fw 2.00.19 (issue 39)<br />
Linksys WRT300N fw 2.00.17 (issue 34)<br />
Netgear DG834[∅, GB, N, PN, GT] version &lt; 5 (issue 19 &amp; issue 25 &amp; issue 62 &amp; jd &amp; Burn2 Dev)<br />
Netgear DGN1000 (don&#8217;t know if there is a difference with the others N150 ones&#8230; issue 27)<br />
Netgear DGN1000[B] N150 (issue 3)<br />
Netgear DGN2000B (issue 26)<br />
Netgear DGN3500 (issue 13)<br />
Netgear DGND3300 (issue 56)<br />
Netgear DGND3300Bv2 fwv 2.1.00.53_1.00.53GR (issue 59)<br />
Netgear DM111Pv2 (@eguaj)<br />
Netgear JNR3210 (issue 37)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213446">

			<div class="comment by-a-team ">

				<p class="commentcredit">

					<span class="commenter">A-Team</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213446">
						January 15, 2014 5:17 PM					</a>

				</p>

				<p>Cisco fixed this particular vulnerability &#8212; Eloi Vanderbeken&#8217;s &#8212; late on the 10th of January with an update on the 14th suggesting it was an &#8220;undocumented test interface&#8221; without really saying whose, how it got into their products, how was possible for Cisco not to have been aware of it earlier, nor why they hadn&#8217;t done something about it if it was such a serious vulnerability but one easy to patch.</p>
<p>I could not really jibe Cisco&#8217;s sketchy explanation with what EV reported in such fantastic detail, attributing it to the common denominator in all these devices, SerComm.</p>
<p>Maybe someone here who is a &#8216;registered customer&#8217; can access the details:</p>
<p>&#8220;A vulnerability in the Cisco WAP4410N Wireless-N Access Point, Cisco WRVS4400N Wireless-N Gigabit Security Router, and the Cisco RVS4000 4-port Gigabit Security Router could allow an unauthenticated, remote attacker to gain root-level access to an affected device. This vulnerability can be triggered from the LAN interfaces of the Cisco WRVS4400N Wireless-N Gigabit Security Router and the Cisco RVS4000 4-port Gigabit Security Router from the wireless LAN (WLAN) and the LAN interfaces of the Cisco WAP4410N Wireless-N Access Point.</p>
<p>This vulnerability is due to an undocumented test interface in the TCP service listening on port 32764 of the affected device. An attacker could exploit this vulnerability by accessing the affected device from the LAN-side interface and issuing arbitrary commands in the underlying operating system. An exploit could allow the attacker to access user credentials for the administrator account of the device, and read the device configuration. The exploit can also allow the attacker to issue arbitrary commands on the device with escalated privileges.</p>
<p>This vulnerability is documented in Cisco bug ID CSCum37566 (registered customers only) for the Cisco WAP4410N Wireless-N Access Point; Cisco bug IDs CSCum43693 (registered customers only) and CSCum43700 (registered customers only) for the WRVS4400N Wireless-N Gigabit Security Router; and Cisco bug ID CSCum43685 (registered customers only) for the Cisco RVS4000 4-port Gigabit Security Router. This vulnerability has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2014-0659.&#8221;</p>
<p><a href="http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140110-sbd" rel="nofollow ugc">http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140110-sbd</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213447">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213447">
						January 16, 2014 2:29 AM					</a>

				</p>

				<p>@Ola<br />
It depends on the definition of a “USA telecommunications provider” regarding CALEA and the NSA/FISA. Are we talking Tier 1 or Tier 2 or Tier 3 providers – or all of them?</p>
<p>I agree that Huawei probably has easily hacked (or stolen) software. But, it is also possible the NSA weakened their software.</p>
<p>@Tony H<br />
“…CALEA applies to telcos and ISPs and such, and the NSA is already in a position to tell them what to do via NSLs… I&#8217;d think the targets of the items in this catalog are routers/firewalls in corporate settings, and ISPs outside the USA where CALEA doesn&#8217;t help in any case.”<br />
Maybe, but a Corporation has to transit the Telcos to get software patches and reach branch offices. Level 3 is an example of that type of link (Level 3 is composed of Global Crossing with multinational links). Level 3 was tapped why not others? It would be a great way to push-out the NSA firmware and software exploits.</p>
<p>@Benni<br />
Your post was in-depth and unpleasantly surprising. From your tone you seem to be indicating that the back-doors are from the Factory (it would seem unlike – but possible &#8211; that all those routers were interdicted and exploited during shipping). I find it hard not to think the NSA did not twist some arms and get those routers and firewalls exploited (or ready for exploitation).</p>
<p>@A-Team<br />
&#8216;…it was an &#8220;undocumented test interface&#8221; without really saying whose, how it got into their products, how was possible for Cisco not to have been aware of it earlier… could not really jibe Cisco&#8217;s sketchy explanation…&#8217;</p>
<p>Could it be NSA arm twisting to weaken routers and firewalls – all in the name of “National Security?” The same goes for the FBI now that they have adopted the “Nation Security” tag-line. I think Cisco has some explaining to do &#8211; and not just &#8220;non-denials&#8221; but real explaining.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213448">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213448">
						January 16, 2014 6:50 AM					</a>

				</p>

				<p>@65535</p>
<p>&#8220;From your tone you seem to be indicating that the back-doors are from the Factory&#8221;</p>
<p>Yes they the security issue reported by Vanderbeken is built in from factory. The firmware of these routers has this &#8220;undocumented test interface&#8221; when they are shipped.</p>
<p>@A-team:<br />
Did cisco really fix this now? since according to the german magazine c&#8217;t, cisco wants to deliver a fix until the end of january:<br />
<a href="http://www.heise.de/security/meldung/Router-Backdoor-Cisco-Netgear-und-Linksys-versprechen-Schutz-2084884.html" rel="nofollow ugc">http://www.heise.de/security/meldung/Router-Backdoor-Cisco-Netgear-und-Linksys-versprechen-Schutz-2084884.html</a></p>
<p>C&#8217;t also wonders, why these companys say they will fix that problem now, given that Vanderbeken was not the first to report it.  For example, Netgear was asked in its supportforum here: <a href="http://www.netgear-forum.com/forum/index.php?showtopic=6192" rel="nofollow ugc">http://www.netgear-forum.com/forum/index.php?showtopic=6192</a> by a frensh customer in the year 2003 about exactly this backdoor.</p>
<p>C&#8217;t wonders here: <a href="http://www.heise.de/security/meldung/Backdoor-in-Routern-Hersteller-raetseln-und-analysieren-2077308.html" rel="nofollow ugc">http://www.heise.de/security/meldung/Backdoor-in-Routern-Hersteller-raetseln-und-analysieren-2077308.html</a> why these manufacturers with the notable exception of cisco are merely  just saying that they are investigating this. Without proposing a fix, or telling how these backdoors came into the routers.</p>
<p>By the way, according to washington post, currently, nsa has infected 10.000 computers with their malware:</p>
<p><a href="http://www.nytimes.com/2014/01/15/us/nsa-effort-pries-open-computers-not-connected-to-internet.html?hp&#038;_r=1" rel="nofollow ugc">http://www.nytimes.com/2014/01/15/us/nsa-effort-pries-open-computers-not-connected-to-internet.html?hp&#038;_r=1</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213449">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213449">
						January 16, 2014 6:52 AM					</a>

				</p>

				<p>@65535</p>
<p>&#8220;From your tone you seem to be indicating that the back-doors are from the Factory&#8221;</p>
<p>Yes they the security issue reported by Vanderbeken is built in from factory. The firmware of these routers has this &#8220;undocumented test interface&#8221; when they are shipped.</p>
<p>@A-team:<br />
Did cisco really fix this now? since according to the german magazine c&#8217;t, cisco wants to deliver a fix until the end of january:<br />
<a href="http://www.heise.de/security/meldung/Router-Backdoor-Cisco-Netgear-und-Linksys-versprechen-Schutz-2084884.html" rel="nofollow ugc">http://www.heise.de/security/meldung/Router-Backdoor-Cisco-Netgear-und-Linksys-versprechen-Schutz-2084884.html</a></p>
<p>C&#8217;t also wonders, why these companys say they will fix that problem now, given that Vanderbeken was not the first to report it.  For example, Netgear was asked in its supportforum here: <a href="http://www.netgear-forum.com/forum/index.php?showtopic=6192" rel="nofollow ugc">http://www.netgear-forum.com/forum/index.php?showtopic=6192</a> by a frensh customer in the year 2003 about exactly this backdoor.</p>
<p>C&#8217;t wonders here: <a href="http://www.heise.de/security/meldung/Backdoor-in-Routern-Hersteller-raetseln-und-analysieren-2077308.html" rel="nofollow ugc">http://www.heise.de/security/meldung/Backdoor-in-Routern-Hersteller-raetseln-und-analysieren-2077308.html</a> why these manufacturers with the notable exception of cisco are merely  just saying that they are investigating this. Without proposing a fix, or telling how these backdoors came into the routers.</p>
<p>By the way, according to washington post, currently, nsa has infected 10.000 computers with their malware:</p>
<p><a href="http://www.nytimes.com/2014/01/15/us/nsa-effort-pries-open-computers-not-connected-to-internet.html?hp&#038;_r=1" rel="nofollow ugc">http://www.nytimes.com/2014/01/15/us/nsa-effort-pries-open-computers-not-connected-to-internet.html?hp&#038;_r=1</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213450">

			<div class="comment by-a ">

				<p class="commentcredit">

					<span class="commenter">A-</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213450">
						January 16, 2014 9:26 AM					</a>

				</p>

				<p>This morning, Shodan notes a few thousand routers on the internet with port 32764 open:</p>
<p><a href="http://www.shodanhq.com/" rel="nofollow ugc">http://www.shodanhq.com/</a><br />
Results 1 &#8211; 10 of about 1559 for port:32764 ScMM<br />
Results 1 &#8211; 10 of about 3488 for port:32764 MMcS</p>
<p>You can test your own router with telnet for LAN and these links for WAN. (I myself have nothing to fear as I have nothing to hide but checked anyway: port closed!)</p>
<p><a href="http://www.router-backdoor.de/?lang=en" rel="nofollow ugc">http://www.router-backdoor.de/?lang=en</a><br />
<a href="http://www.canyouseeme.org/" rel="nofollow ugc">http://www.canyouseeme.org/</a><br />
<a href="http://www.yougetsignal.com/tools/open-ports/" rel="nofollow ugc">http://www.yougetsignal.com/tools/open-ports/</a></p>
<p>Sercomm is the Taiwanese company that actually manufactures routers and firmware for resellers such as Cisco. It was founded in 1992. Here is a list of embedded devices &#8212; it matches the list of known affected routers according to arstechnica:</p>
<p><a href="http://wikidevi.com/w/index.php?title=Special:Ask&#038;q=%5B%5BManuf" rel="nofollow ugc">http://wikidevi.com/w/index.php?title=Special:Ask&#038;q=%5B%5BManuf</a>::SerComm]]+[[Global+type::~embedded*]]&amp;po=%3FFCC+ID%0D%0A%3FFCC+approval+date%3DFCC+date%0D%0A%3FEstimated+date+of+release%3DEst.+release+date%0D%0A%3FEmbedded+system+type%0D%0A%3FCPU1+brand%0D%0A%3FCPU1+model%3DCPU1+mdl.%0D%0A&amp;eq=yes&amp;p[format]=broadtable&amp;sort_num=&amp;order_num=ASC&amp;p[limit]=500&amp;p[offset]=&amp;p[link]=all&amp;p[sort]=&amp;p[headers]=show&amp;p[mainlabel]=&amp;p[intro]=&amp;p[outro]=&amp;p[searchlabel]=%E2%80%A6+further+results&amp;p[default]=&amp;p[class]=sortable+wikitable+smwtable&amp;eq=yes</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213451">

			<div class="comment by-search-engine-fanatic ">

				<p class="commentcredit">

					<span class="commenter">Search Engine Fanatic</span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213451">
						February 19, 2014 5:47 PM					</a>

				</p>

				<p>A month later and Shodan results have doubled.</p>
<p>Almost 30,000 open ports and <b>OVER 9000</b> exploitable.</p>
<p>Results 1 &#8211; 10 of about 28537 for port:32764</p>
<p>Results 1 &#8211; 10 of about 3265 for port:32764 ScMM</p>
<p>Results 1 &#8211; 10 of about 6797 for port:32764 MMcS</p>
<p>Epic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213452">

			<div class="comment by-thanks-edward ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.spiegel.de/media/media-35513.pdf' rel='external nofollow ugc' class='url'>Thanks Edward!</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/#comment-213452">
						December 29, 2014 8:51 PM					</a>

				</p>

				<p>This new (Dec 2014) document describes how NSA breaks in to Huawei routers via HAMMERMILL in order to extract IPSEC and VoIP negotiations in order to feed them to exploitation databases back at NSA.  <a href="http://www.spiegel.de/media/media-35513.pdf" rel="nofollow ugc">http://www.spiegel.de/media/media-35513.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/01/headwater_nsa_e.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/01/headwater_nsa_e.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fheadwater_nsa_e.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/01/headwater_nsa_e.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5161' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/01/debunking_the_n.html" rel="prev">← Debunking the "NSA Mass Surveillance Could Have Stopped 9/11" Myth</a>		<a href="https://www.schneier.com/blog/archives/2014/01/the_changing_co.html" rel="next">The Changing Cost of Surveillance →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
