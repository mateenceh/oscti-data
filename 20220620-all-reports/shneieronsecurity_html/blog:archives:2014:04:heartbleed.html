<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Heartbleed - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Heartbleed Comments Feed" href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5301" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5301' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F04%2Fheartbleed.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F04%2Fheartbleed.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5301 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5301" class="post-5301 post type-post status-publish format-standard hentry category-uncategorized tag-internet tag-keys tag-man-in-the-middle-attacks tag-passwords tag-patching tag-ssl tag-vulnerabilities tag-web tag-zero-day">

	<div class="article">

		<h2 class="entry">Heartbleed</h2>
		<p><a href="http://heartbleed.com/">Heartbleed</a> is a catastrophic bug in OpenSSL:</p>
<blockquote><p>&#8220;The Heartbleed bug allows anyone on the Internet to read the memory of the systems protected by the vulnerable versions of the OpenSSL software. This compromises the secret keys used to identify the service providers and to encrypt the traffic, the names and passwords of the users and the actual content. This allows attackers to eavesdrop communications, steal data directly from the services and users and to impersonate services and users.</p></blockquote>
<p>Basically, an attacker can grab 64K of memory from a server.  The attack leaves no trace, and can be done multiple times to grab a different random 64K of memory.  This means that anything in memory &#8212; SSL private keys, user keys, anything &#8212; is vulnerable.  And you have to assume that it is all compromised.  All of it.</p>
<p>&#8220;Catastrophic&#8221; is the right word.  On the scale of 1 to 10, this is an 11.</p>
<p>Half a million sites are <a href="http://news.netcraft.com/archives/2014/04/08/half-a-million-widely-trusted-websites-vulnerable-to-heartbleed-bug.html">vulnerable</a>, including my own.  Test your vulnerability <a href="http://filippo.io/Heartbleed/">here</a>.</p>
<p>The bug has been patched.  After you patch your systems, you have to get a new public/private key pair, update your SSL certificate, and then change every password that could potentially be affected.</p>
<p>At this point, the probability is close to one that every target has had its private keys extracted by multiple intelligence agencies.  The real question is whether or not someone deliberately inserted this bug into OpenSSL, and has had two years of unfettered access to everything.  My guess is accident, but I have no proof.</p>
<p><a href="http://arstechnica.com/security/2014/04/critical-crypto-bug-exposes-yahoo-mail-passwords-russian-roulette-style/">This article</a> is worth reading.  Hacker News <a href="https://news.ycombinator.com/item?id=7548991">thread</a> is filled with commentary.  XKCD <a href="https://xkcd.com/1353/">cartoon</a>.</p>
<p>EDITED TO ADD (4/9):  Has anyone looked at all the low-margin non-upgradable <a href="https://www.schneier.com/blog/archives/2014/01/security_risks_9.html">embedded systems</a> that use OpenSSL?  An upgrade path that involves the trash, a visit to Best Buy, and a credit card isn&#8217;t going to be fun for anyone.</p>
<p>EDITED TO ADD (4/10):  I&#8217;m hearing that the CAs are completely clogged, trying to reissue so many new certificates.  And I&#8217;m not sure we have anything close to the infrastructure necessary to revoke half a million certificates.</p>
<p>Possible <a href="https://www.eff.org/deeplinks/2014/04/wild-heart-were-intelligence-agencies-using-heartbleed-november-2013">evidence</a> that Heartbleed was exploited last year.</p>
<p>EDITED TO ADD (4/10):  I wonder if there is going to be some backlash from the mainstream press and the public.  If nothing really bad happens &#8212; if this turns out to be something like the Y2K bug &#8212; then we are going to face criticisms of crying wolf.</p>
<p>EDITED TO ADD (4/11):  <a href="http://krebsonsecurity.com/2014/04/heartbleed-bug-what-can-you-do/">Brian Krebs</a> and <a href="https://freedom-to-tinker.com/blog/felten/how-to-protect-yourself-from-heartbleed/">Ed Felten</a> on how to protect yourself from Heartbleed.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/internet/" rel="tag">Internet</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/passwords/" rel="tag">passwords</a>, <a href="https://www.schneier.com/tag/patching/" rel="tag">patching</a>, <a href="https://www.schneier.com/tag/ssl/" rel="tag">SSL</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a>, <a href="https://www.schneier.com/tag/web/" rel="tag">web</a>, <a href="https://www.schneier.com/tag/zero-day/" rel="tag">zero-day</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html" rel="bookmark">Posted on April 9, 2014 at 5:03 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html#comments">326 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/04/heartbleed.html" data-title="Heartbleed" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-219316">

			<div class="comment by-hugo ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.hiawatha-webserver.org/' rel='external nofollow ugc' class='url'>Hugo</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219316">
						April 9, 2014 5:11 AM					</a>

				</p>

				<blockquote><p>&#8230; you have to update your SSL certificate &#8230;</p></blockquote>
<p>Update the certificate like in requesting a new one based on the same public key is not enough, because your private key might have been stolen. Renew your public/private key pair and <i>then</i> request a new certificate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219317">

			<div class="comment by-m-krohn ">

				<p class="commentcredit">

					<span class="commenter">M Krohn</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219317">
						April 9, 2014 5:25 AM					</a>

				</p>

				<p>If the US agencies knew of and exploited this bug, then why all the legal wrangling with lavabit for their SSL keys?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219318">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219318">
						April 9, 2014 5:32 AM					</a>

				</p>

				<p>I accidentally posted my commentary in the squid blog section &#8211; summary: openSSL is a bloated piece of junk and there are myriad alternatives that are coded with less lines. With OpenSSL it isn&#8217;t so much the number of lines but the terse nature of the code and comments. Very difficult to audit.</p>
<p>I will repeat my delight at a small virtual hosting outfit responding to my phone call this morning complaining that a client&#8217;s websites were vulnerable -,&#8221;we know, and we will have it patched in an hour&#8221;. Of course this is days too late but as far as corporate response goes it isn&#8217;t too bad.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219319">

			<div class="comment by-boris-pi-piwinger ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://piology.org/' rel='external nofollow ugc' class='url'>Boris &#039;pi&#039; Piwinger</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219319">
						April 9, 2014 5:45 AM					</a>

				</p>

				<p>Key question: How did the bug get introduced in the first place? By whom and why?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219320">

			<div class="comment by-dimitris-andrakakis ">

				<p class="commentcredit">

					<span class="commenter">Dimitris Andrakakis</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219320">
						April 9, 2014 5:45 AM					</a>

				</p>

				<p><i>&#8220;The real question is whether or not someone deliberately inserted this bug into OpenSSL and has had two years of unfettered access to everything.&#8221;</i></p>
<p>Has anybody taken a look at the source and its check-in history ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219321">

			<div class="comment by-mafu ">

				<p class="commentcredit">

					<span class="commenter">mafu</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219321">
						April 9, 2014 5:59 AM					</a>

				</p>

				<p><a href="http://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=4817504d069b4c5082161b02a22116ad75f822b1" rel="nofollow ugc">http://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=4817504d069b4c5082161b02a22116ad75f822b1</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-219322">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219322">
						April 9, 2014 5:59 AM					</a>

				</p>

				<p>&#8220;If the US agencies knew of and exploited this bug, then why all the legal wrangling with lavabit for their SSL keys?&#8221;</p>
<p>My guess is that they learned about this &#8212; and started exploiting &#8212; this bug yesterday, along with everyone else who is fast enough to do that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219323">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219323">
						April 9, 2014 6:00 AM					</a>

				</p>

				<p>It&#8217;s open source. The initial pull request is here <a href="https://github.com/openssl/openssl/commit/4817504d069b4c5082161b02a22116ad75f822b1" rel="nofollow ugc">https://github.com/openssl/openssl/commit/4817504d069b4c5082161b02a22116ad75f822b1</a></p>
<p>The bug was there from day 1.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219324">

			<div class="comment by-offas ">

				<p class="commentcredit">

					<span class="commenter">offas</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219324">
						April 9, 2014 6:00 AM					</a>

				</p>

				<p>I wonder, how about all these OpenSSL FIPS compliant implementations? You can&#8217;t simply patch them as even the smallest change invalidate certification.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-219325">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219325">
						April 9, 2014 6:02 AM					</a>

				</p>

				<p>&#8220;Update the certificate like in requesting a new one based on the same public key is not enough, because your private key might have been stolen. Renew your public/private key pair and <i>then</i> request a new certificate.&#8221;</p>
<p>Yes.  I will make it clearer in my post.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219326">

			<div class="comment by-marco-tedaldi ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://medienkommentare.blogspot.ch/' rel='external nofollow ugc' class='url'>Marco Tedaldi</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219326">
						April 9, 2014 6:06 AM					</a>

				</p>

				<p>@Boris &#8216;pi&#8217; Piwinger</p>
<p>Fefe has a nice piece on that on his blog.<br />
<a href="http://blog.fefe.de/?mon=201404" rel="nofollow ugc">http://blog.fefe.de/?mon=201404</a></p>
<p>Basically:<br />
It was added by a T-Systems employee (biggest telecommunication company in germany and mostly owned by the state&#8230; ok, he did not work there at the time he wrote that code, but still a nice theory).<br />
The same person has also written the prposal for this heartbeat extension (where he admits that it does not need a payload but still implemented it for &#8220;flexibility&#8221;)</p>
<p>And the NSA is not the only secret service that has ever tried to plant backdoors, so maybe they just did not know about it or the people, that wanted the lavabit data did not find that exploit in the heap of other stuff they had&#8230; or maybe lavabit was running a version without the vulnerability.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219327">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219327">
						April 9, 2014 6:10 AM					</a>

				</p>

				<p>This bug targets the roots of eCommerce and all online financial transactions.</p>
<p>If it would be found out that this was inserted deliberately by some official outfit, it will discredit intelligence services for years to come.</p>
<p>They could not be that stupid.<br />
[/sarcasm]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219329">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219329">
						April 9, 2014 6:14 AM					</a>

				</p>

				<p>Would it make sense to have things like passwords in a differnt process than usernames? Just to add one more additional layer of defense (which &#8211; as far as I understand &#8211; couldn&#8217;t have been breached by this bug)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219330">

			<div class="comment by-test ">

				<p class="commentcredit">

					<span class="commenter">test</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219330">
						April 9, 2014 6:17 AM					</a>

				</p>

				<p>&#8220;why all the legal wrangling with lavabit for their SSL keys?&#8221;</p>
<p>Not everything uses vulnerable version of OpenSSL, maybe lavabit did not. Or maybe they wanted access even if lavabit updates OpenSSL one day or modify whatever they use. Last possibility: the group going after lavabit did not necessary knew about this even if other groups did. Those first weeks after Snowden might have been a bit panicky and a bit disorganized at NSA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219331">

			<div class="comment by-rich ">

				<p class="commentcredit">

					<span class="commenter">Rich</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219331">
						April 9, 2014 6:18 AM					</a>

				</p>

				<p>XKCD looks at the (limited) upside:</p>
<p><a href="http://xkcd.com/1353/" rel="nofollow ugc">http://xkcd.com/1353/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219332">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219332">
						April 9, 2014 6:20 AM					</a>

				</p>

				<p>@Anon, the password should not have been send to sshd in the first place. Just a public key derived  from the entry in /etc/shadow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219333">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219333">
						April 9, 2014 6:21 AM					</a>

				</p>

				<p>@Dimitris Andrakakis, see the comments here and the following ones:</p>
<p><a href="https://www.schneier.com/blog/archives/2014/04/unbreakable_enc.html#c5351914" rel="nofollow ugc">https://www.schneier.com/blog/archives/2014/04/unbreakable_enc.html#c5351914</a></p>
<p>Perhaps it is indeed irelevant whether the bug was deliberately placed or not, since it may be used  nevertheless. Also, people simply write stupid code sometimes. And a german programmer as an nsa agent sounds a bit far reaching.</p>
<p>I&#8217;m actually more disturbed by the microsoft closed source crypto libraries. They might contain similar bugs, but since they are closed source, there are far less chances that bugs in Microsoft Internet Information Server, Microsoft Crypto API, and Microsoft Schannel get fixed. With microsoft, the nsa even has an enormous advantage: Microsoft itself claims that it had to give important design information of the crypto libraries to the nsa for reviewing. Otherwise, microsoft could not export windows.<br />
So the nsa might know the windows sourcecode, but we do not, thereby the nsa has it very easy when they make exploits for microsoft crypto functions.</p>
<p>I see that one can (illegally) get parts of the windows 2000 sourcecode on piratebay <a href="http://www.kuro5hin.org/story/2004/2/15/71552/7795" rel="nofollow ugc">http://www.kuro5hin.org/story/2004/2/15/71552/7795</a>. Has somebody looked at that? Perhaps by looking at that, one can tell what the nsa key really is for. In that Microsoft code seem to be comments like</p>
<p>private\inet\mshtml\src\core\cdbase\baseprop.cxx:<br />
// HACK! HACK! HACK! (MohanB) In order to fix #64710 at this very late</p>
<p>private\inet\mshtml\src\core\cdutil\genutil.cxx:<br />
// HACK HACK HACK. REMOVE THIS ONCE MARLETT IS AROUND</p>
<p>private\inet\mshtml\src\other\moniker\resprot.cxx:<br />
//<br />
goto EndHack;<br />
//</p>
<p>private\inet\mshtml\src\site\layout\flowlyt.cxx:<br />
// God, I hate this hack &#8230;</p>
<p>private\inet\wininet\urlcache\filemgr.cxx:<br />
// ACHTUNG!!! this is a special hack for IBM antivirus software</p>
<p>private\ntos\w32\ntuser\client\dlgmgr.c:<br />
// HACK OF DEATH:</p>
<p>So, which bugs can be expected in these closed source crypto libraries from Microsoft, if openssl has bugs like heartbleed?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219336">

			<div class="comment by-kenneth-michaels ">

				<p class="commentcredit">

					<span class="commenter">Kenneth Michaels</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219336">
						April 9, 2014 6:29 AM					</a>

				</p>

				<p>&#8220;If the US agencies knew of and exploited this bug, then why all the legal wrangling with lavabit for their SSL keys?&#8221;</p>
<p>Another guess &#8211; parallel construction. If collected evidence has to be presented in court, the agency can show a legal means by which it was collected, without revealing the vulnerability or the illegal act of exploiting it against a US company.</p>
<p>Yet another guess &#8211; US agencies only exploit this vulnerability outside of the US (lavabit was in the US), while non-US spy agencies exploit this vulnerability within the US.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219338">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219338">
						April 9, 2014 6:58 AM					</a>

				</p>

				<p>Here is an interesting blog entry:<br />
<a href="http://blog.fefe.de/?ts=adba343f" rel="nofollow ugc">http://blog.fefe.de/?ts=adba343f</a></p>
<p>turns out that the programmer who wrote the heartbleed was, at that time, still at university (and he did not work for T-systems, which also maintains the computersystems of the german secret servoce bnd)</p>
<p>In the above blog entry, it is mentioned that the code was audited and accepted by this man here <a href="http://www.drh-consultancy.demon.co.uk/" rel="nofollow ugc">http://www.drh-consultancy.demon.co.uk/</a> who lives 100 miles away from gchq quaters in cheltenham.</p>
<p>@Kenneth<br />
&#8220;If the US agencies knew of and exploited this bug, then why all the legal wrangling with lavabit for their SSL keys?&#8221;</p>
<p>perhaps they just used an older version of openssl. The bug is not present, for example in OpenSSL 0.9.8 and earlier. The more secure systems are, the longer they usually wait with installing new versions that add new features.<br />
It may also be that they thought pressing lavabit would make it faster and give them much more insight than this hacking.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219339">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219339">
						April 9, 2014 6:59 AM					</a>

				</p>

				<p>Sorry for the quibble but I genuinely want to know what you meant. Did you mean to say &#8216;probability close to one&#8217;? (Odds close to one gives 50/50 chance.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219340">

			<div class="comment by-matt-t ">

				<p class="commentcredit">

					<span class="commenter">Matt T</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219340">
						April 9, 2014 6:59 AM					</a>

				</p>

				<p>I wonder just how big the certificate blacklist is going to be when all is said and done&#8230;and how many of those red screens about bad SSL certificates Chrome will be showing me in the coming days&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219343">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219343">
						April 9, 2014 7:08 AM					</a>

				</p>

				<p>Maybe knowledge of this exploit was confined to a few people inside of the government, and the people who went after Lavabit weren&#8217;t in the know.  Or maybe they went after Lavabit just to preserve the fiction that they didn&#8217;t have the data, in order to keep the exploit&#8217;s existence hidden.</p>
<p>If I had created this vulnerability I&#8217;d tell as few people as possible about it and try to act as if I didn&#8217;t have it, in the hope of preserving the exploit&#8217;s existence for as long as possible.</p>
<p>More generally, I think it&#8217;s hard to infer motives from the observed actions of intelligence services, and even harder to get an idea of what they know from those inferred motives and observed actions.  We just don&#8217;t know one way or another.</p>
<p>Does anyone know about the circumstances under which the hole was found?  One guy worked for Google.  Is there any chance that Google is funding systematic crypto code audits in response to the Snowden leaks?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219344">

			<div class="comment by-trey ">

				<p class="commentcredit">

					<span class="commenter">Trey</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219344">
						April 9, 2014 7:09 AM					</a>

				</p>

				<p>Looks like their site is down or is getting DDOSed. Someone must not want others to get that patch. Luckily I already have it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219345">

			<div class="comment by-konrad ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.fimsch.net/' rel='external nofollow ugc' class='url'>Konrad</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219345">
						April 9, 2014 7:11 AM					</a>

				</p>

				<p>The question is not who introduced that bug. That is bad, certainly. The question, to me, rather is: who was responsible for auditing the change coming in (although there is a reference to somebody in the git commit) and how can it be that a buffer vulnerability like that can go (mostly) unnoticed for over two years and not be caught by any audit, quality assurance or any other process making sure that this code is sound.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219347">

			<div class="comment by-anon9119849 ">

				<p class="commentcredit">

					<span class="commenter">Anon9119849</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219347">
						April 9, 2014 7:25 AM					</a>

				</p>

				<p>&#8220;In the above blog entry, it is mentioned that the code was audited and accepted by this man here <a href="http://www.drh-consultancy.demon.co.uk/" rel="nofollow ugc">http://www.drh-consultancy.demon.co.uk/</a> who lives 100 miles away from gchq quaters in cheltenham.&#8221;</p>
<p>Britain is only about 600 miles long &#8211; him being 100 miles away from anywhere is completely irrelevant.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219348">

			<div class="comment by-evan-anderson ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://serverfault.com/users/7200/evan-anderson' rel='external nofollow ugc' class='url'>Evan Anderson</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219348">
						April 9, 2014 7:26 AM					</a>

				</p>

				<p>I had look at the RFC and original thesis where the (D)TLS heartbeat extension was proposed (<a href="http://duepublico.uni-duisburg-essen.de/servlets/DerivateServlet/Derivate-31696/dissertation.pdf" rel="nofollow ugc">http://duepublico.uni-duisburg-essen.de/servlets/DerivateServlet/Derivate-31696/dissertation.pdf</a> page 66) and it makes me a bit frustrated.</p>
<p>re: the heartbeat payload the thesis says &#8211; &#8220;However, to make<br />
the extension as versatile as possible, an arbitrary payload and a random padding is preferred, illustrated in Figure 7.1. The payload of the HeartbeatRequest can be chosen by the implementation, for example simple sequence numbers or something more elaborate. The HeartbeatResponse must contain the same payload as the request it answers, which allows the requesting peer to verify it. This is necessary to distinguish expected responses from delayed ones of previous requests, which can occur because of the unreliable transport.&#8221;</p>
<p>In the context of DTLS, running over an unreliable transport (UDP), I can totally see the rationale behind the heartbeat needing a payload. It seems like something more like a fixed-length sequence number and random padding would have been reasonable. I guess we want the protocol to be &#8220;versatile&#8221;, though, so we need an arbitrary payload. &gt;sigh&lt; Seems like unnecessary complexity to me, though.</p>
<p>In the context of TLS there shouldn&#8217;t even be a heartbeat! The underlying reliable transport can (and should) provide that functionality. There <em>definitely</em> shouldn&#8217;t be a payload, arbitrary-length or otherwise, because it serves <em>no</em> purpose. I would think, personally, that a security-oriented protocol like TLS should be kept as minimal as possible but, clearly, that&#8217;s not how it actually works.</p>
<p>This protocol extension shouldn&#8217;t have ever applied to TLS. There would still be bugs in OpenSSL, had this particular extension never applied to TLS, but at least this &#8216;heartbleed&#8217; fiasco wouldn&#8217;t have had the impact that it has.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219349">

			<div class="comment by-gimli ">

				<p class="commentcredit">

					<span class="commenter">gimli</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219349">
						April 9, 2014 7:30 AM					</a>

				</p>

				<p>May want to check your own website, Bruce.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219350">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219350">
						April 9, 2014 7:30 AM					</a>

				</p>

				<p>Question is, should we change our passwords? I use Sticky Password manager (www.stickypassword.com) and they told me to change passwords for sensitive accounts just for sure. Do you think it is necessary as well?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219351">

			<div class="comment by-gimli ">

				<p class="commentcredit">

					<span class="commenter">gimli</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219351">
						April 9, 2014 7:31 AM					</a>

				</p>

				<p>Oh, you already  did.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219352">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219352">
						April 9, 2014 7:52 AM					</a>

				</p>

				<p>@Trey:</p>
<p>Or you could apply Occam&#8217;s Razor. Everybody&#8217;s trying to download the patch at the same time. That would have all the hallmarks of a DoS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219353">

			<div class="comment by-johan ">

				<p class="commentcredit">

					<span class="commenter">Johan</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219353">
						April 9, 2014 7:54 AM					</a>

				</p>

				<p>One thing that is not made clear by your post: Even if organizations like the NSA only found out about this yesterday they can still decrypt any data that they captured previously as long as they steal your private key before the vulnerability is patched (unless you use perfect forward secrecy).</p>
<p>My guess is that they are currently sitting on huge amounts of that they can now decrypt that they couldn&#8217;t before.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219354">

			<div class="comment by-blaze ">

				<p class="commentcredit">

					<span class="commenter">blaze</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219354">
						April 9, 2014 7:59 AM					</a>

				</p>

				<p>Maybe they knew exactly what lavabit had but didn&#8217;t want to tip their hand that they could get at it already, so they made a big public deal about this.</p>
<p>They probably do that <em>a lot</em>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219355">

			<div class="comment by-andrei ">

				<p class="commentcredit">

					<span class="commenter">Andrei</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219355">
						April 9, 2014 8:09 AM					</a>

				</p>

				<p>&#8220;The Heartbleed bug allows anyone on the Internet to read the memory of the systems protected by the vulnerable versions of the OpenSSL software. &#8221;<br />
&#8211; how is that &#8220;anyone&#8221; can grab 64kb of data? Even with no physical access to the server?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219356">

			<div class="comment by-not-really-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Not really anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219356">
						April 9, 2014 8:11 AM					</a>

				</p>

				<p>Note that in this context replacing a certificate should include revoking the old one in addition to using the new one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219357">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219357">
						April 9, 2014 8:17 AM					</a>

				</p>

				<p>@Andrei:</p>
<p>You make a request the the server, the server helpfully sends you 64K of memory contents. Completely and totally unlogged, with the contents of the memory unknown.</p>
<p>The details are in the link posted at the top of the article.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219358">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219358">
						April 9, 2014 8:43 AM					</a>

				</p>

				<p>@offas  re: FIPS compliance</p>
<p>FIPS compliance validates the crypto routines which is not where this bug occurs. Unless someone&#8217;s product packaged openssl directly into their system and not as a component then it wouldn&#8217;t be impacted.</p>
<p>A bigger question is what about embedded devices that use openssl where updating is difficult to impossible?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219359">

			<div class="comment by-richard-h-schwartz ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.poweroftheschwartz.com' rel='external nofollow ugc' class='url'>Richard H Schwartz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219359">
						April 9, 2014 8:45 AM					</a>

				</p>

				<p>Has anyone determined whether any Certificate Authorities are/were vulnerable to heartbleed, and considered what the implications of that would be?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219360">

			<div class="comment by-christian ">

				<p class="commentcredit">

					<span class="commenter">Christian</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219360">
						April 9, 2014 8:52 AM					</a>

				</p>

				<p>The sad thing is that this bug is not just at fault of C, but also at fault of TCP.</p>
<p>Every protocol on top of TCP has to implement a heartbeat function if it wants to get notification on a broken TCP connection.</p>
<p>TCP has failed to do so/ TCP Keep alive is, with its 2 hours instead of minutes checking interval, worthless for the task.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219361">

			<div class="comment by-ted ">

				<p class="commentcredit">

					<span class="commenter">Ted</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219361">
						April 9, 2014 8:59 AM					</a>

				</p>

				<p>How do we know you are even the real Bruce?? Maybe you are an imposter who has distracted us with a 95% legitimate post, and then injected one or two pieces of critical disinformation. What is even real anymore??</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219362">

			<div class="comment by-mork ">

				<p class="commentcredit">

					<span class="commenter">Mork</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219362">
						April 9, 2014 9:01 AM					</a>

				</p>

				<p>It&#8217;s worth noting that the commit was merged on new years eve, at 11pm. This is a strange time to be merging code, unless you are attempting to avoid scrutiny.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219363">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219363">
						April 9, 2014 9:15 AM					</a>

				</p>

				<p>Mork: I wouldn&#8217;t put anything past the NSA/gov&#8217;t. It seems their kind of style &#8211; reminds me of the Linux kernel one about a decade ago that allowed privilege escalation and it was so craftily done.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219365">

			<div class="comment by-j ">

				<p class="commentcredit">

					<span class="commenter">J</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219365">
						April 9, 2014 9:17 AM					</a>

				</p>

				<p>11?</p>
<p>That&#8217;s going a bit far.</p>
<p>As bad as it can get -which would still only be a 10), read only access inside a single address space is not a 11.</p>
<p>It&#8217;s easy to imagine something worse.  It would be worse if this attack allowed an attacker to upload arbitrary code to be run at root privileges.</p>
<p>THAT would be a 10.  This is an 8 or 9.  Very bad, to be sure.  Catastropic, sure.  But not an 11.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219366">

			<div class="comment by-1kb83b ">

				<p class="commentcredit">

					<span class="commenter">1KB83B</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219366">
						April 9, 2014 9:18 AM					</a>

				</p>

				<p>@ M Krohn</p>
<p>I suggest this is one of the rare real bugs beside the intentionally implemented backdoors. In this case even the mighty authorities didn&#8217;t knew that they could save some NSL.</p>
<p>It&#8217;s so frustrating to see how buggy the architecture of the basis is, all the <b>modern</b> technology is based on. You can&#8217;t open a webpage because a manipulated picture can exploit a browser-bug to gain full control or active content does the same or whatever. And for the people who want to be informed about what is going on in the world of security-problems; you can&#8217;t trust your tools, the providers of websites &amp; services and I think even automatic RSS-feed could be abused to execute a piece a bad code.</p>
<p>Maybe there are algorithms to realize secure (=unbreakable for thousands of years) encryption, but what does it matter, if the base of implementation is buggy/corrupt? You can&#8217;t even trust the firewall in front of you webservices, databases, applicationservers, etc.</p>
<p>My only hope of heartbleed is, that the security awareness gets pushed in the right direction and cybersecurity gets the needed management attention.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219367">

			<div class="comment by-brandonmarc ">

				<p class="commentcredit">

					<span class="commenter">BrandonMarc</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219367">
						April 9, 2014 9:20 AM					</a>

				</p>

				<blockquote><p>If the US agencies knew of and exploited this bug, then why all the legal wrangling with lavabit for their SSL keys?</p></blockquote>
<p>It makes a nice diversion. It also demonstrates (apparent) technical limitations of what NSA can and cannot do, which &#8211; if the limitations aren&#8217;t there after all &#8211; helps keep the world blissfully unaware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219368">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219368">
						April 9, 2014 9:25 AM					</a>

				</p>

				<p>Does anyone else find it weird the OpenSSL has a custom malloc function that doesn&#8217;t bother to clear out the memory before returning the pointer?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219369">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219369">
						April 9, 2014 9:37 AM					</a>

				</p>

				<p>To me this brings down the paradigm that open source software is automatically more secure. Because it is open source and free to use, it is likely to create a mono culture and thus a single &#8220;disease&#8221; can have catastrophic effects. Until a way is found and applied for writing secure software &#8211; audits simply are no suitable on a level of globally used software &#8211; the only escape seems to be to do some proprietary/custom/secret things on computers connected to the internet, maybe still based partially on open source software, maybe not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219370">

			<div class="comment by-noonereally ">

				<p class="commentcredit">

					<span class="commenter">noonereally</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219370">
						April 9, 2014 9:38 AM					</a>

				</p>

				<p>@Chris, yes others do find this weird.<br />
<a href="http://thread.gmane.org/gmane.os.openbsd.misc/211952/focus=211963" rel="nofollow ugc">http://thread.gmane.org/gmane.os.openbsd.misc/211952/focus=211963</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219371">

			<div class="comment by-latonya ">

				<p class="commentcredit">

					<span class="commenter">Latonya</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219371">
						April 9, 2014 9:41 AM					</a>

				</p>

				<p>So, Bruce, do you still think you can trust in open source? This bug was there for 2 years!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219372">

			<div class="comment by-anondev ">

				<p class="commentcredit">

					<span class="commenter">AnonDev</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219372">
						April 9, 2014 9:49 AM					</a>

				</p>

				<p>@ Mork • April 9, 2014 9:01 AM</p>
<p>&#8220;It&#8217;s worth noting that the commit was merged on new years eve, at 11pm. This is a strange time to be merging code, unless you are attempting to avoid scrutiny.&#8221;</p>
<p>Well heck, I will admit to working at 3am &amp; 4am on Christmas day, multiple years, I hope those file date/timestamps won&#8217;t make what I did autmatically suspicious to the customers some years in the future.  Some of us have missed a lot of parties and holidays, you know 🙁</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219373">

			<div class="comment by-david-in-toronto ">

				<p class="commentcredit">

					<span class="commenter">David in Toronto</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219373">
						April 9, 2014 9:59 AM					</a>

				</p>

				<p>Interestingly it appears that the severity rating on NVD is a tad low &#8230;</p>
<p><a href="http://www.kb.cert.org/vuls/id/720951" rel="nofollow ugc">http://www.kb.cert.org/vuls/id/720951</a> gives:</p>
<p>Base    9.4     AV:N/AC:L/Au:N/C:C/I:C/A:N</p>
<p><a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-0160" rel="nofollow ugc">http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-0160</a> gives:</p>
<p>CVSS v2 Base Score:5.0 (MEDIUM) (AV:N/AC:L/Au:N/C:P/I:N/A:N) (legend)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219374">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219374">
						April 9, 2014 10:00 AM					</a>

				</p>

				<p>Sorry to ask here &#8211; but maybe others with less ability to find out are also wondering: Are the 64k that are leaked each time protected by SSL or are they leaked in plain?</p>
<p>If the latter, how about the NSA (or similar) maybe having detected a pattern in web requests globally since some time and maybe even having found out that those requests returned private key material &#8211; looking for things like that might be something such organizations are likely to do anyway.</p>
<p>If the former, how about the NSA still detecting it because they likely know at least some CA public keys?</p>
<p>In both cases,  the reaction would most likely have to be to make the vulnerability public.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219375">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219375">
						April 9, 2014 10:08 AM					</a>

				</p>

				<p>That&#8217;s what I had in mind, if I remember correctly, about half of the bits of a RSA private exponent can only have (public exponent) different values &#8211; bits which can be derived from the public key alone:</p>
<p>Playing hide and seek with stored keys<br />
Adi Shamir and Nicko van Someren<br />
September 22, 1998</p>
<p><a href="http://www.cs.jhu.edu/~astubble/600.412/s-c-papers/keys2.pdf" rel="nofollow ugc">http://www.cs.jhu.edu/~astubble/600.412/s-c-papers/keys2.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219376">

			<div class="comment by-sad-clown ">

				<p class="commentcredit">

					<span class="commenter">Sad Clown</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219376">
						April 9, 2014 10:10 AM					</a>

				</p>

				<p>@Benni</p>
<p>&#8220;And a german programmer as an nsa agent sounds a bit far reaching.&#8221;</p>
<p>This seems like an absurd comment to me.  Since when is the NSA NOT far reaching?</p>
<p>Anyhow, it is clearly an unacceptable risk to run anything on a secure system that is not mandatory.  So much for leaving ssh open.  Not that I have been doing that for a year or so anyhow.  Just a creepy feeling I had.</p>
<p>So much for open source security.  And closed source security.</p>
<p>Is that the point of this?  To make us all feel insecure?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219377">

			<div class="comment by-choppedbroccoli ">

				<p class="commentcredit">

					<span class="commenter">ChoppedBroccoli</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219377">
						April 9, 2014 10:30 AM					</a>

				</p>

				<p>So for the average consumer this is a nightmare. We have 10-100 major passwords and we need to change most if not all. But the problem is that you cannot change them all at once. You have to be aware when the service you use implements the fix and then change your password. Doesn&#8217;t seem likely this is going to happen at all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219378">

			<div class="comment by-benoit ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.submeet.net' rel='external nofollow ugc' class='url'>Benoit</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219378">
						April 9, 2014 10:30 AM					</a>

				</p>

				<p>Vulnerability can also be checked using this url : <a href="http://submeet.net/tools/heartbleed.php" rel="nofollow ugc">http://submeet.net/tools/heartbleed.php</a>  when the original one&#8217;s overloaded.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219379">

			<div class="comment by-anondev ">

				<p class="commentcredit">

					<span class="commenter">AnonDev</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219379">
						April 9, 2014 10:38 AM					</a>

				</p>

				<p>Also test here for Heartbleed PLUS other site security if others are overloaded &#8211;</p>
<p><a href="https://www.ssllabs.com/ssltest/index.html" rel="nofollow ugc">https://www.ssllabs.com/ssltest/index.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219380">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219380">
						April 9, 2014 10:49 AM					</a>

				</p>

				<p>The payload in a Heartbleed attack may be encrypted or not:  You can do the attack before key exchange (which would allow an observer to see the payload as well) or after (where the payload is protected).</p>
<p>Each call will tend to get a different 64 kB chunk of memory.  Basically it works because the request is small, but the server is thought the request to echo is big, so it mallocs up a big block and then copies the &#8220;request&#8221; and the next 64 kB into the response and happily sends it back.</p>
<p>That people STILL, 20 years after I was first bitten by a C memory bug as an undergraduate, use C and C-derived memory unsafe languages (which, also, are type unsafe and have crap exception handling, the latter causing both &#8220;goto fail&#8221; and the GNU TLS bug) for crypto systems and other secure servers is ridiculous.</p>
<blockquote><p>
&#8220;Any suitably creative backdoor is indistinguishable from a C programming bug&#8221;.  -Me
</p></blockquote>
<p>Is a quip of mine, but, really, the use of C/C++/Objective C at all is the backdoor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219381">

			<div class="comment by-benoit ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.submeet.net' rel='external nofollow ugc' class='url'>Benoit</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219381">
						April 9, 2014 10:56 AM					</a>

				</p>

				<p>I really think that this kind of event was expected : Too many servers/systems are using OpenSSL, there&#8217;s not enough variety.</p>
<p>If all humans on earth had &#8220;the state of the art immune&#8221;, provided by a &#8220;science-fiction-mega-company&#8221;, everyone would be killed by the first unexpected bacteria.<br />
Everyone should accept and encourage diversity, because diversity means robustness.</p>
<p>In the special case of cryptography the main problem is : &#8220;No everyone could/<b>should</b> write it&#8217;s own crypto-library&#8221;, nevertheless anyone should encourage the use of alternatives to OpenSSL.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219382">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219382">
						April 9, 2014 10:59 AM					</a>

				</p>

				<p>I see that there has been plenty advice about password updates, but I would wait for a bit and only update a password after the relevant provider has confirmed that it has patched its services, otherwise you&#8217;ll end up with a new password exposed and a false sense of security.</p>
<p>What I would like to see is not just a patch, but also a detection mechanism that flags any attempt at exploiting this bug..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219383">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219383">
						April 9, 2014 11:03 AM					</a>

				</p>

				<p>There are patches to detect it from the IDS viewpoint, eg. here is one for Bro:<br />
<a href="http://blog.bro.org/2014/04/detecting-heartbleed-bug-using-bro.html" rel="nofollow ugc">http://blog.bro.org/2014/04/detecting-heartbleed-bug-using-bro.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219384">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://n3td3v.blogspot.co.uk' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219384">
						April 9, 2014 11:11 AM					</a>

				</p>

				<p>It is the NSA who made sure Heartbleed was public when there was evidence the Chinese and other states had their hands on it.</p>
<p>It was previously just the NSA who knew about it.</p>
<p>The NSA sit on high value vulnerabilities until they are known and used by other states to target US interests.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219385">

			<div class="comment by-dr_b_ ">

				<p class="commentcredit">

					<span class="commenter">Dr_b_</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219385">
						April 9, 2014 11:23 AM					</a>

				</p>

				<p>&#8220;why all the legal wrangling with lavabit for their SSL keys?&#8221;</p>
<p>If they had access to lavabit, they would not want to make it seem like they had access, and thus put on a big show of requiring SSL Keys to keep up appearances.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219386">

			<div class="comment by-wes ">

				<p class="commentcredit">

					<span class="commenter">wes</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219386">
						April 9, 2014 11:28 AM					</a>

				</p>

				<p>&#8220;Another guess &#8211; parallel construction. If collected evidence has to be presented in court, the agency can show a legal means by which it was collected, without revealing the vulnerability or the illegal act of exploiting it against a US company.&#8221;</p>
<p>I definitely agree. Legal wrangling is done for judicial ends, not technical ones. It seems almost foolheartedly optimistic to assume that the NSA only found out about this at the same time as the general public.</p>
<p>&#8220;It is the NSA who made sure Heartbleed was public when there was evidence the Chinese and other states had their hands on it.&#8221;</p>
<p>This seems more likely than not. Essentially we&#8217;ve arrived at the point where knowledge of software bugs is a strategic resource.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219387">

			<div class="comment by-buggy ">

				<p class="commentcredit">

					<span class="commenter">buggy</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219387">
						April 9, 2014 11:44 AM					</a>

				</p>

				<p>Is there are site compiling a list of commonly-used and/or high-value (e.g. banking) sites that have been bitten by this, ideally with a patch status? Average-shmoe consumers are going to need to react to this, and they are not going to weed through a tech analysis. They&#8217;ll need a simple to-do list, such as: If you are a Wells Fargo customer, don&#8217;t log in to WFB.com this week, check this page again next week, and if the site is showing as non-exploitable, then change your password.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219388">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219388">
						April 9, 2014 11:48 AM					</a>

				</p>

				<p>@ Sad Clown:</p>
<p>&#8220;This seems like an absurd comment to me. Since when is the NSA NOT far reaching?&#8221;</p>
<p>Wellm he was a phd student at that time, writing his doctoral thesis on this heartbeat stuff. Please note that the budget of the bnd is much smaller than that of nsa. BND does not go as far as making intense recruiting efforts on computer science students.</p>
<p>The most likely reason for this bug is simply a weak phd thesis where a weak proposal is made.</p>
<p>BND is sometimes quoted for an alledged &#8220;project Rahab&#8221;, but Bernd Fix, the programer whose virus the BND alledgedly stole, has found not much information on this: <a href="https://hoi-polloi.org/~brf/rahab.html" rel="nofollow ugc">https://hoi-polloi.org/~brf/rahab.html</a></p>
<p>Spiegel mentions that BND is sometimes ahead of NSA. Especially when it comes to tapping fibers. The Spiegel book &#8220;DER NSA COMPLEX&#8221; mentions that BND is helping the nsa by tapping fibers in war zones crysis regions and development countries, where the NSA can not go in. And BND even has a tapping method that has 100 times the cpacity of the GCHQ, they write in the spiegel book.</p>
<p>But hiring a programmer to weaken openssl is not the Style of the BND. It would, after all possibly damage german companies using ssl websites.</p>
<p>As long as there is no slide explicitely saying that openssl was deliberately weakened by the heartbeat option, I do not believe it.</p>
<p>But it does not matter. NSA IS running man in the middle attacks on websites using ssl: <a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html</a> they codenamed this operation &#8220;Flying Pig&#8221;. This attack is only possible if you have either stolen the certificate or if you can decrpyt the session with the help of some bug.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219389">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219389">
						April 9, 2014 11:48 AM					</a>

				</p>

				<p>In the past, i&#8217;ve kind of wanted to fork and refactor GnuTLS, make it more modular, clean up the code, make vulnerabilities less likely, but keep a common interface so it can be a drop in replacement. Now I&#8217;m thinking maybe I should learn Ada, port it to that, and make C and C++ wrappers for it &#8211; which my research tells me is possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-219390">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219390">
						April 9, 2014 12:07 PM					</a>

				</p>

				<p>&#8220;Sorry for the quibble but I genuinely want to know what you meant. Did you mean to say &#8216;probability close to one&#8217;? (Odds close to one gives 50/50 chance.)&#8221;</p>
<p>Yes: &#8220;probability close to one.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-219391">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219391">
						April 9, 2014 12:11 PM					</a>

				</p>

				<p>&#8220;So, Bruce, do you still think you can trust in open source? This bug was there for 2 years!&#8221;</p>
<p>I don&#8217;t believe that &#8212; as a matter of course &#8212; closed source bugs are found more quickly.</p>
<p>Yes, I still trust open source.  I don&#8217;t think anyone ever promised that it was perfect, or that it is somehow magically and automatically more secure than closed source.</p>
<p>I wrote about this in 1999:</p>
<p><a href="https://www.schneier.com/crypto-gram-9909.html#OpenSourceandSecurity" rel="nofollow ugc">https://www.schneier.com/crypto-gram-9909.html#OpenSourceandSecurity</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219392">

			<div class="comment by-rumple_stiltskin ">

				<p class="commentcredit">

					<span class="commenter">rumple_stiltskin</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219392">
						April 9, 2014 12:22 PM					</a>

				</p>

				<p>The principle of charity no longer applies to the NSA or any of the Five-Eyes intelligence agencies. There is no longer even a presumption of rationality because many of the Snowden leaks show that the intelligence agencies act with reckless abandon brought on by many decades of absolute non-accountability.</p>
<p>There is no reason not to assume that this bug was implanted. Whether by the Germans, the US, or someone else makes little difference because we already know that ECHELON-style cooperation is common among the intelligence agencies wherever it is convenient.</p>
<p>@Krohn:</p>
<p>As noted already, the intelligence agencies need a &#8220;legitimate&#8221; channel by which they could have seized information, in order to conceal the illegitimate channel by which they actually did seize information if they want to use that information to prosecute people. Furthermore, while heartbleed is a huge vulnerability, it is not exactly the same thing as just having the SSL keys. Finally, the presumption that NSA/FBI&#8217;s actions are rational is directly contradicted by many of the Snowden revelations. The intelligence agencies have become so reckless that they even act against their own interests. The phrase that comes to mind is &#8220;drunk on power&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219393">

			<div class="comment by-melina ">

				<p class="commentcredit">

					<span class="commenter">melina</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219393">
						April 9, 2014 12:29 PM					</a>

				</p>

				<p>Regarding key access- who outside governments can sniff networks outside the open wifi at the coffee shop?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219394">

			<div class="comment by-black-panther ">

				<p class="commentcredit">

					<span class="commenter">Black Panther</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219394">
						April 9, 2014 12:37 PM					</a>

				</p>

				<p>&#8220;Open-source&#8221; does NOT automatically mean &#8220;secure&#8221;, nor does closed-source automatically mean &#8220;insecure&#8221;. When will this myth die???</p>
<p>I&#8217;ve questioned the security of OSS for a long time, not least because so many people are so complacent about its security.</p>
<p>This flaw sucks, but it might be the wake-up call the OSS camp needs to kick it out of dreamland and into reality. The current arguments that OSS is somehow better, and that &#8220;many eyes read the code&#8221; with the implication that it somehow makes said code better, are just bogus.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219396">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219396">
						April 9, 2014 12:45 PM					</a>

				</p>

				<p>&#8220;My guess is that they learned about this &#8212; and started exploiting &#8212; this bug yesterday, along with everyone else who is fast enough to do that.&#8221;</p>
<p>I&#8217;m with you on Lavabit, but they could have had a longer window than everyone else if they intercepted and processed unencrypted email(s) Neel Mehta may have sent to the OpenSSL team or any shared amongst themselves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219397">

			<div class="comment by-coyne-tibbets ">

				<p class="commentcredit">

					<span class="commenter">Coyne Tibbets</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219397">
						April 9, 2014 12:47 PM					</a>

				</p>

				<p>@M Krohn<br />
The US agencies would have demanded LavaBit&#8217;s key, even if they already had it by attack. For deniability, they need to be able to show that they obtained the key by &#8220;legitimate&#8221; means, so that no one will guess they can get it by attack.</p>
<p>@Anon9119849<br />
The RFC is not specific enough: To some people, &#8220;random&#8221; equates to &#8220;uninitialized&#8221;. Which, of course, is the exact problem with OpenSSL. The standard should say something along the lines of, &#8220;The payload of the heartbeat MUST NOT reveal meaningful information. The payload MUST either be explicitly randomized or else initialized with a repeating non-informational constant or sequence.&#8221;</p>
<p>In fact, the omission is glaring: This RFC was supposed to be for a cryptographic product, but even though the author was supposedly versed in cryptography, there is no recognition in the RFC that the heartbeat might become a channel for information leakage.  Glaring to me, and I&#8217;m not a cryptography expert.</p>
<p>@anonymous from switzerland<br />
Exactly the opposite.  Let&#8217;s set aside for the moment the question of how this bug was actually discovered, and consider discovery of bugs in general.  For closed source products, the only means of discovery is &#8220;in operation&#8221;, while open source offers the additional channel of discovery by source review.</p>
<p>So now let&#8217;s consider discovery of this bug. So far as I know, the methodology of its discovery is not yet revealed, but I identify two methods above: &#8220;In operation&#8221; and &#8220;source review.&#8221; Let&#8217;s compare a product made by a large software company (LSC) versus an open source product (open).  For &#8220;in operation&#8221; review, the chances of discovery are equal for LSC and open. For discovery by source review, the chances of discovery are much greater for Open than for LSC. This seems to indicate that open is better simply because there is an increased overall likelihood of discovery, for any weakness.</p>
<p>There is no perfect solution.</p>
<p>@Benoit<br />
Sure, there&#8217;s a lot of servers and systems using OpenSSL, which increases the exposure. Shall we discuss the number of servers using, say, Microsoft? Or the number of network products using the Cisco systems?  Why would you think the exposure for OpenSSL is greater than, say, one of these other systems?</p>
<p>Suppose we replace the current handful of products with a thousand products. Certainly that reduces exposure due to a weakness in any one product, but it likely increases the overall number of weaknesses.  I&#8217;m not sure that constitutes an improvement to the current situation; in fact, I would go so far as to assert that it is better to have a few broadly used and very well debugged products. Even with the potential for a mess like this one.</p>
<p>Again, there is no perfect solution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219398">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219398">
						April 9, 2014 12:51 PM					</a>

				</p>

				<p>@Anura: &#8220;In the past, i&#8217;ve kind of wanted to fork and refactor GnuTLS, make it more modular, clean up the code, make vulnerabilities less likely&#8221;<br />
<em>Please</em> in your new protocol, do not send, even encrypted, anything not needed for authentification. Do not send the password (even in an encrypted tunnel), only send a public key derived from the password. See my previous comments months ago.</p>
<p>You may rise money from Kickstarter for your ADA implementation.</p>
<p><em>Please</em>, try to make it with at most thousands of lines of code.</p>
<p>And if you are in a hurry for a remplacement of openSSL, you may look at the sshd of openbsd: it does not depend on openssl despite the name of the latter. It instead depends on the hashing function of the libc, and on DJBernstein&#8217;s implementation of ed25519.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219399">

			<div class="comment by-matt-from-ct ">

				<p class="commentcredit">

					<span class="commenter">Matt from CT</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219399">
						April 9, 2014 12:59 PM					</a>

				</p>

				<blockquote><p>
  Because it is open source and free to use,<br />
  it is likely to create a mono culture
</p></blockquote>
<p>Not at all.</p>
<p>Microsoft is expensive and closed source.  As of February 2014 it has 32% of web servers v. 38% for Apache.</p>
<p>The OpenSSL bug hit 17% of servers (though my educated guess is that was lowered by a number of Linux web servers that were sitting behind load balancers / SSL offload engines that were not vulnerable &#8212; my company&#8217;s Ubuntu boxes were vulnerable, but only to an internal user; external users would have hit the F5 which used a non-compromised version of OpenSSL)</p>
<blockquote><p>
  Sorry to ask here &#8211; but maybe others with less ability to find<br />
  out are also wondering: Are the 64k that are leaked each time<br />
  protected by SSL or are they leaked in plain?
</p></blockquote>
<p>A &#8220;web server&#8221; like Apache sits at what is called the (Network) Layer 7 known as the &#8220;Application Layer&#8221; &#8212; this is where it does something with the data that is useful to non-computers.  The other Layers describe various ways of transforming data in ways they can be sent to other computers.</p>
<p>The encryption stack, like OpenSSL, operates on Layers 5 &amp; 6.  It receives the encrypted communication from the outside, decrypts it, and passes it to the web server up at Layer 7.  Or in reverse, it takes unecyrpted data from the web server and encrypts it before passing down to Layers 4-3-2-1 to be delivered to the client.</p>
<p>The unencrypted information sits in memory as it is being passed from Layer 6 to 7&#8230;and Heartbleed was dumping out this memory 64K at a time.  You couldn&#8217;t predict exactly what would come out at any given time, because what sat in the vulnerable 64K was constantly changing as it was passed on to other processes.</p>
<p>All machines with the Heartbleed bug would reveal this unencrypted information passing through memory by returning it back as plaintext to the exploiter.</p>
<p>My understanding is whether you were vulnerable to the private key being divulged depended on how your specific installation of Linux was set up to allocate memory; somewhere were secure enough to make it unlikely if not impossible to reveal the private key.  Other systems were vulnerable do to how they allocated memory, and I believe these systems it was almost certain your key would be revealed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219400">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219400">
						April 9, 2014 1:07 PM					</a>

				</p>

				<p>@Anura, see the warning <a href="http://security.stackexchange.com/questions/55163" rel="nofollow ugc">http://security.stackexchange.com/questions/55163</a> about reprogramming openssl in another language : only use a language that you know WELL.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219401">

			<div class="comment by-emanuele-cesena ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.theneeds.com' rel='external nofollow ugc' class='url'>Emanuele Cesena</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219401">
						April 9, 2014 1:11 PM					</a>

				</p>

				<blockquote><p>
  &#8220;Catastrophic&#8221; is the right word. On the scale of 1 to 10, this is an 11.
</p></blockquote>
<p>Not to mention the impact on Certificate Authorities, e.g.:<br />
<a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=744027" rel="nofollow ugc">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=744027</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219402">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219402">
						April 9, 2014 1:20 PM					</a>

				</p>

				<p>I think the continuing stream of such bugs makes a watertight case for writing these critical functions in a memory-safe language, eh?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219403">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219403">
						April 9, 2014 1:25 PM					</a>

				</p>

				<p>@sshdoor</p>
<p>Just to be clear, I&#8217;m not going to assume using a different language is going to solve all problems. My original plan, if I ever decide to take the time (it&#8217;s a huge undertaking), was to refactor GnuTLS in C, into the following main components:</p>
<p>1) A stand-alone crypto-library, implementing all the basic algorithms.</p>
<p>2) A certificate library implementing ASN.1/X509/related components.</p>
<p>3) A TLS library implementing only the SSL/TLS protocols, referencing the crypto library for all crypto stuff, and the certificate library for all certificate stuff.</p>
<p>4) A command line tool for certificate stuff, that references the other libraries.</p>
<p>The idea is to make the components modular and independently verifiable, while also refactoring. On top of all of that, my plan was to refactor the code so that each function does exactly one thing, minimizing code reuse, minimizing things like GOTO for cleanup, implement a consistent style to improve readability and reduce the possibility of accidental errors (e.g. always use braces for all control flow statements), and implement thorough unit testing to reduce the amount of bugs that can make it into production.</p>
<p>This is a very long project if I take it on, involving learning of the crypto standards in a much greater detail than I do now, as opposed to just the ones I find the most interesting. If I did decide to do it, and decide to move to a memory safe language, I would of course make sure I have done enough in the language first to be comfortable taking on a large project with.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219404">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219404">
						April 9, 2014 1:34 PM					</a>

				</p>

				<p>About writing more secure software, I am sure others here have said similar things than I am about to say (some in the comments above) and probably got it together better than me and have been thinking about this longer and hopefully more thoroughly, but still this &#8211; after all I am a man with maybe less inner barriers than most, not only because I am a physicist:</p>
<p>Open Source is in my view a very important tool for writing secure software, now and in the future. But ideally it would come in the form of small simple components that can be verified thoroughly, optimally even to a large degree using formal methods and formally proving as much as possible. Technically, such components could still be assembled to larger libraries, if separation between the components is good and the interplay can again be verified similarly, building things up layer upon layer of trust.</p>
<p>Openssl fails here for two reasons that have already been mentioned in the comments above, it is too complex in itself and it is written in C. A different language is needed that can be verified and then prevents things like random access to memory much more reliably.</p>
<p>Once you would have such a world of layered simple reliable components in the future, it might also come within reach at least for larger companies (resp. specialized smaller companies implementing such things for anybody willing to pay for it) to put additional checks and measures etc. on top of standard protocols. Maybe you would then again download specific clients for different companies (Amazon, Facebook, &#8230;) like today on smartphones instead of using a standard browser or maybe the world would solve things in a different way then (plugins or similar), hard to predict the future is. If I look at the trouble I had to access the Apple Store from just one laptop, such things are partially even here already.</p>
<p>Heinrich Rohrer who got the Nobel Prize in physics (as one of two) for inventing the Scanning Tunneling Microscope once said in a talk that people often overestimate what can change in 4 years, but underestimate what can change in 10 years. His basic idea behind that was that many things in technology evolve logarithmically and people tend to think linerarily.</p>
<p>At the time I considered this to be a bit naive, but now, a bit older, and applying this, one would expect the internet and computers 4 years after Snowden, i.e. summer 2017 not to be much more secure than now, but 10 years from now, summer 2023, things might be already significantly better. I hope I will be able to make a tiny contribution to that, here and there.</p>
<p>(And obviously, the NSA will still have an advantage then, at least that would be my current guess&#8230; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219405">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219405">
						April 9, 2014 1:49 PM					</a>

				</p>

				<p>I wrote:</p>
<blockquote><p>
  Because it is open source and free to use, it is likely to create a mono culture
</p></blockquote>
<p>Matt from CT replied:</p>
<blockquote><p>
  Not at all.
</p></blockquote>
<p>I got your point regarding MS and I agree regarding that.</p>
<p>But to be precise, my statement above as it stands &#8211; &#8220;Because it is open source and free to use, it is likely to create a mono culture&#8221; &#8211; is still something I consider true. That closed source necessarily produces less monoculture is not implied.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219406">

			<div class="comment by-fabrice-derepas ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://trust-in-soft.com/no-more-heartbleed/' rel='external nofollow ugc' class='url'>Fabrice Derepas</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219406">
						April 9, 2014 2:04 PM					</a>

				</p>

				<p>With my team we have just performed a formal validation of an open source SSL stack. This SSL stack is now immune to security flaws. I encourage you to have a look at formal methods and see how they can help a more reliable internet: <a href="http://trust-in-soft.com/no-more-heartbleed/" rel="nofollow ugc">TrustInSoft</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219407">

			<div class="comment by-joebloggs ">

				<p class="commentcredit">

					<span class="commenter">JoeBloggs</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219407">
						April 9, 2014 2:07 PM					</a>

				</p>

				<p>(as they say, talk to me like i&#8217;m stupid..)</p>
<p>exploiting HeartBleed would require access to the web server? (rootkits, or such)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219408">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219408">
						April 9, 2014 2:14 PM					</a>

				</p>

				<p>With regards LavaBit I realy don&#8217;t think many of you are thinking in the right way.</p>
<p>From what has been said about NSL&#8217;s they have next to zero or less oversight and take about three minutes to fill out another twenty to get rubber stamped and a couple of man hours to serve.</p>
<p>The last thing the FBI want&#8217;s is people contesting them, so any one foolish enough to try will on principle be hammered into the ground and then ground down to destruction as publicaly as required for every one else to get the message.</p>
<p>It&#8217;s the Federal MO these days if you had not noticed, and a little over a year ago the DoJ made it very clear in a congressional enquirey that this is the policy from the very top over Aaron Swartz, there was no option he had to do jail time regardless for what was a political reason (supposadly face saving but more likely campaign fund related).</p>
<p><a href="http://www.techdirt.com/articles/20130223/02284022080/doj-admits-it-had-to-put-aaron-swartz-jail-to-save-face-over-arrest.shtml" rel="nofollow ugc">http://www.techdirt.com/articles/20130223/02284022080/doj-admits-it-had-to-put-aaron-swartz-jail-to-save-face-over-arrest.shtml</a></p>
<p>I guess people in the US should wake up and realise that the US is now more of a &#8220;banana republic&#8221; than it&#8217;s southern neighbour, or atleast that&#8217;s how many of us who have the luck not to live there view it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219409">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219409">
						April 9, 2014 2:14 PM					</a>

				</p>

				<p>@JoeBloggs</p>
<p>No server access required. Any website or service using an unpatched version of OpenSSL can be exploited by sending a malformed request. The server will then respond with contents of a somewhat random chunk of memory, which may contain keys, passwords, credit card numbers, or other sensitive data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219410">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter">JJ</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219410">
						April 9, 2014 2:40 PM					</a>

				</p>

				<p>I am a bit upset that none of the big companies are making an announcement whether they were vulnerable to this or not, especially the big banks, paypal and gmail. They seem fine now according to the tools, but it is not clear to me if they updated their systems very early on or if they always used a different ssl implementation.</p>
<p>I don&#8217;t want to change my important passwords if I don&#8217;t have to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219411">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219411">
						April 9, 2014 2:52 PM					</a>

				</p>

				<p>Well, here is a scan as of Tuesday 12:00 UTC of the Alexa top 1K:</p>
<p><a href="https://github.com/musalbas/heartbleed-masstest/blob/master/top1000.txt" rel="nofollow ugc">https://github.com/musalbas/heartbleed-masstest/blob/master/top1000.txt</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219412">

			<div class="comment by-directattack ">

				<p class="commentcredit">

					<span class="commenter">DirectAttack</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219412">
						April 9, 2014 2:57 PM					</a>

				</p>

				<p>Fabrice Derepas wrote:</p>
<blockquote><p>
With my team we have just performed a formal validation of an open source SSL stack. This SSL stack is now immune to security flaws.
</p></blockquote>
<p>If you believe your software is immune to security flaws then you are naive, foolish, or careless to claim so. If you don&#8217;t believe it, then you are dishonest. None of those possibilities inspires confidence in your software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219413">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219413">
						April 9, 2014 3:00 PM					</a>

				</p>

				<p>@ Anura</p>
<p>&#8220;Now I&#8217;m thinking maybe I should learn Ada, port it to that, and make C and C++ wrappers for it &#8211; which my research tells me is possible.&#8221;</p>
<p>That&#8217;s what AdaCore did for their Ada Web Server. Except they used OpenSSL. 🙁</p>
<p>Also consider using <a href="http://www.matrixssl.org/" rel="nofollow ugc">MatrixSSL</a>. It has excellent properties far as complexity and portability go. You can do it GPL or commercial license. If it&#8217;s GPL program, I&#8217;d put Ada wrappers around that joker as a start. Then, piece by piece, implement a full SSL library in Ada with little unsafe code as possible, all checks turned on, and only safe defaults allowed (i.e. no NSA backdoor &#8216;features&#8217;). Could gradually reimplement core functions in SPARK, too. See the Skein in SPARK paper for tips on doing it fast.</p>
<p>Bootstrap the crypto part with something like Botan or NaCl. Maybe use an internal security kernel approach like Guttman&#8217;s cryptlib. The use of Ada or SPARK would make an assured pipeline approach work better than C/C++. Many possibilities for speeding development or improving security. Good luck.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219414">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219414">
						April 9, 2014 3:07 PM					</a>

				</p>

				<p>@JJ</p>
<p>See: <a href="http://googleonlinesecurity.blogspot.com/2014/04/google-services-updated-to-address.html" rel="nofollow ugc">Google Services Updated to Address OpenSSL CVE-2014-0160 (the Heartbleed bug) </a>.</p>
<p>Also see: <a href="https://isc.sans.edu/forums/diary/Heartbleed+vendor+notifications/17929" rel="nofollow ugc">Heartbleed vendor notifications</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219415">

			<div class="comment by-ivan ">

				<p class="commentcredit">

					<span class="commenter">Ivan</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219415">
						April 9, 2014 3:42 PM					</a>

				</p>

				<p>Lastpass&#8217;s Heartbleed checker also checks the site certificate issue date, which is useful information for people considering changing passwords:</p>
<p><a href="https://lastpass.com/heartbleed/" rel="nofollow ugc">https://lastpass.com/heartbleed/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219417">

			<div class="comment by-not-a-anonymous-fool ">

				<p class="commentcredit">

					<span class="commenter">Not A Anonymous Fool</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219417">
						April 9, 2014 3:44 PM					</a>

				</p>

				<p>Fabrice Derepas &amp; DirectAttack:</p>
<p>Not to mention the fact that anyone foolish enough to click blindly on a link these days that claims to be &#8220;immune to security flaws&#8221; deserves everything they (might) get.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219418">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219418">
						April 9, 2014 3:58 PM					</a>

				</p>

				<p>@M Krohn</p>
<blockquote><p>
  If the US agencies knew of and exploited this bug, then why all the legal wrangling with lavabit for their SSL keys?
</p></blockquote>
<p>Have you read Cryptonomicon? If you have the keys to the kingdom, you don&#8217;t want to show your hand. They very well could be saving it for the few cases where there&#8217;s no other option, and then only acting (in a publicly visible way) on the minimal amount of secret information possible. And/or, try to create the appearance of another plausible means that they could have obtained it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219419">

			<div class="comment by-someoneelsewhere ">

				<p class="commentcredit">

					<span class="commenter">someoneElsewhere</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219419">
						April 9, 2014 4:02 PM					</a>

				</p>

				<p>We forget that this bug affects both sides of the SSL session. Malicious servers can now extract client side memory. In theory, someone can take over your ISP&#8217;s DNS server and proxy Google through his boxes while mining your machine. The NSA might be doing this at US IXPs. AFAIK, the only way to detect this is sniffing every single packet crossing your interface. :/</p>
<p>Luckily, ffox and chrome use NSS (right?). Curl, wget, mutt might be up for grabs.</p>
<p>OTOH if the Google crawler or any other crawler is not patched, one might be able to extract data from Google/Yahoo&#8230; Given that everyone is considering TLS servers, this might be a very plausible attack vector.</p>
<p>Just my two cents. <i></i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219420">

			<div class="comment by-keithpeter ">

				<p class="commentcredit">

					<span class="commenter">keithpeter</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219420">
						April 9, 2014 4:05 PM					</a>

				</p>

				<p>Remember that versions of the openssl library prior to 1.01 did not contain the bug.</p>
<p>Enterprise Linux 6.4 (RHEL, CentOS, Scientific Linux, Springdale Linux) for instance used an older version of openssl.</p>
<p>Lavabit <em>may</em> have been using CentOS or similar and the close-down occurred prior to the EL6 update to 6.5.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219421">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219421">
						April 9, 2014 4:25 PM					</a>

				</p>

				<p>@someoneElsewhere</p>
<p>From what I&#8217;ve heard it only gets into the process that&#8217;s running OpenSSL, not the entire machine&#8217;s memory. Here&#8217;s an authoritative source (a TOR developer): <a href="https://twitter.com/puellavulnerata/status/453311990367154177" rel="nofollow ugc">https://twitter.com/puellavulnerata/status/453311990367154177</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219422">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219422">
						April 9, 2014 4:40 PM					</a>

				</p>

				<p><a href="http://www.kb.cert.org/vuls/id/720951" rel="nofollow ugc">CERT vulnerability notice</a>. This includes a long list of vendors and links to lists of affected products.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219423">

			<div class="comment by-ted-lemon ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://plus.google.com/+TedLemon/posts' rel='external nofollow ugc' class='url'>Ted Lemon</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219423">
						April 9, 2014 4:45 PM					</a>

				</p>

				<p>My big concern here at this point is what to say to all my non-geek acquaintances who are looking to me for advice on what to do next.   The usual question is &#8220;should I change all my passwords,&#8221; to which the naive answer is certainly &#8220;yes,&#8221; but only if the site is secure now.   In order for it to be secure now, they have to have fixed the software, updated their private key, gotten a new cert, and, <em>very</em> importantly, published their old cert on a CRL that I can get at.   Without a list of sites that <em>were</em> vulnerable, I have no way to know whether or not I can safely assume that any particular site is now <em>not</em> vulnerable.   And of course not all browsers support certificate revocation lists by default, which discovery surprised and dismayed me.</p>
<p>So I actually know of no way forward at the moment that provides any real assurance of trust, except perhaps rejecting any SSL cert that was issued earlier than, say, next week, starting next week, in hopes that everybody&#8217;s fixed by then.   But that won&#8217;t work either because not every site <em>needs</em> a new cert.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219424">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219424">
						April 9, 2014 4:54 PM					</a>

				</p>

				<p>By the way, a secure program that might interest you all, especially when you have to deal with large troves of powerpoint slides from Edward Snowden might be retroshare:</p>
<p><a href="http://retroshare.sourceforge.net/" rel="nofollow ugc">http://retroshare.sourceforge.net/</a></p>
<p>Retroshare is an open source application that first generates a pgp key (using, among other things, your mouse movement as partial entropy data). If you send your friends your  public key per e-mail or snail mail, and if you have received theirs, you can add each other to your retroshare network.</p>
<p>Retroshare can then be used to securely chat, phone using voice over ip, and for exchanging large quantities of files.</p>
<p>All data that is communicated via retroshare is end to end encrypted, with your private key only stored on your pc.</p>
<p>You can make your shared files available to specific users or groups of users only. You can also create anonymous mailing lists and  forums in retroshare, where you may only invite your friends.</p>
<p>You can also set it up such that your friends can download from other friends of yours. These indirect connections are then anonymized with a tor like network.</p>
<p>That means, If you are careless and add a policeman as a friend, the policeman may download from your friends, but he will not get their IP data. He will, however, get your Ip, since the direct connection is only encrypted, but not anonymized. But that could be seen as like the network is cleaning itself. Those who are careless enough to add people they do not know personally so that a policeman gets in their friendslist, are arrested and removed from retroshare. On the other hand, the persons remaining in retroshare have a real dark net that is end to end encrypted with no government access possible.</p>
<p>If Greenwald, Snowden, Appelbaum, Poitras, or Schneier would use retroshare, they would not need to fly to Rio everytime.</p>
<p>Retroshare is as fast as bittorrent. The encryption does not slow it down.</p>
<p>I&#8217;m usually using retroshare when I&#8217;m logged into the german research network Xwin.</p>
<p>Connected to a 1000Gbit/s fiber, I can say that you can transfer an entire 16 Gigabyte bluray in around 5 minutes from one university in germany to another one in the US. and all that is properly end to end encrypted, with no snooping possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219425">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219425">
						April 9, 2014 4:57 PM					</a>

				</p>

				<p>Coming out with such a bombshell on the day when Windows XP is no longer serviced (read: no Cert Revocation List updates) will sure send it fast to the dust bin&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219426">

			<div class="comment by-tony ">

				<p class="commentcredit">

					<span class="commenter">Tony</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219426">
						April 9, 2014 5:02 PM					</a>

				</p>

				<p>Quote from microsoft &#8211;<br />
When I hear opensource is safer, it makes my heart bleed</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219427">

			<div class="comment by-notnickp ">

				<p class="commentcredit">

					<span class="commenter">NotNickP</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219427">
						April 9, 2014 5:25 PM					</a>

				</p>

				<p>Nick P all languages that don&#8217;t run in VM have the same vulnerabilities, it is just hidden, and less easy to do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219428">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219428">
						April 9, 2014 5:29 PM					</a>

				</p>

				<p>To all those who think anyone ever claimed that open source was &#8220;automatically&#8221; more secure than closed source&#8230; um.. stop being so naive?</p>
<p>Anyone with a brain can see that open source is NOT <em>automatically</em> more secure&#8230; only that it&#8217;s POSSIBLE for it to be more secure.  Can you see the difference?  Both open source and closed source can (and do!) have serious bugs in them&#8230;  Always have and always will, nothing is bug free.  The difference is that it&#8217;s more easy to find and fix them in open source&#8230;</p>
<p>Ok, so here&#8217;s what happens as a result of it being more easy to find and fix:  WHEN something is widely used and looked at and investigated&#8230; THEN you get more bugs found and fixed (which may give it the illusion of appearing LESS secure, since it&#8217;s much more public)&#8230; and then AFTERWARD, you get a more secure product, after lots of such fixes.</p>
<p>HOWEVER&#8230; merely being open does NOT guarantee that ANYONE EVER LOOKS AT THE SOURCE&#8230; EVER!!!  So therefore being open doesn&#8217;t guarantee anything at all.  The added safety of open source only kicks in after something becomes popular enough to get a lot of attention and eyes on it, looking for its flaws.  And finding them (and flaws often come in groups, so keep looking boys!).. and you get big newsy stories like heartbleed&#8230; and THEN it becomes more safe than closed source (on average), after all that.</p>
<p>I&#8217;ve released open source stuff before that nobody cared about and nobody used (other than me).  Was it &#8220;more safe&#8221; by virtue of it being open source?  Absolutely not!  Not in the slightest.  It only had the POTENTIAL to be, someday, if everyone took a liking to it and looked at it, and told me where I was being a moron and wrote bad code, and if I listened to them.  There&#8217;s a big difference there.</p>
<p>Of course my getting 100% code path execution coverage in the test suite made me feel pretty good, but even that doesn&#8217;t guarantee that I&#8217;ve tested every possible edge case (in fact, I know that I didn&#8217;t, just some I thought to test), only that I&#8217;m doing way better than most products out there.</p>
<p>&#8212;</p>
<p>Ok, the above only talks about &#8220;accidental&#8221; bugs&#8230; let&#8217;s talk for a second further about &#8220;purposeful&#8221; bugs, also known as &#8220;backdoors&#8221;&#8230;  and how that relates to the open/closed source debate.</p>
<p>Since our human-rights-hostile government here in the USA can freely unrestrictedly secretly coerce any company, on pain of imprisonment, to purposefully put in backdoors into their products, and nobody can easily detect them without the source&#8230;. ALL CLOSED SOURCE MUST BE ABSOLUTELY FULLY 100% GUARANTEED *****NOT***** TRUSTED&#8230; BY DEFAULT&#8230; FOREVERMORE&#8230; until the broken laws/courts/congress/etc are all fixed.  Can I make this any clearer?</p>
<p>So closed source is <em>guaranteed</em> untrustworthy (NOT guaranteed unsafe, we can&#8217;t guarantee that every company has been coerced, since it&#8217;s all secret)&#8230; and open source is <em>possibly</em> safer (NOT guaranteed safer though)&#8230;..  Which do you think is better?  We&#8217;re pretty much screwed either way really, but IMO we&#8217;re at least potentially less screwed with open source.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219429">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219429">
						April 9, 2014 5:31 PM					</a>

				</p>

				<p>@ NotNickP</p>
<p>VM&#8217;s have the same potential for vulnerabilities too, just they&#8217;re hidden inside the VM itself now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219430">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219430">
						April 9, 2014 5:35 PM					</a>

				</p>

				<p>As far as I can tell, the bug allows read access to up to 64K bytes of unspecified heap memory. Not to diminish valid concerns, there are probably numerous other software products with similar bugs. The contents of an area of a fragmented heap in an application that has been running for a while are effectively random. You are as likely to retrieve a picture of someone&#8217;s aunt Mimi as you are sensitive data. Aunt Mimi might be annoyed of course.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219431">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219431">
						April 9, 2014 5:47 PM					</a>

				</p>

				<p>@Mark</p>
<p>However, you can keep calling it, and the more you call it the more likely you are to get the secret key, passwords, credit card numbers, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219432">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219432">
						April 9, 2014 5:56 PM					</a>

				</p>

				<p>@ Mark</p>
<p>&#8220;The contents of an area of a fragmented heap in an application that has been running for a while are effectively random.  You are as likely to retrieve a picture of someone&#8217;s aunt Mimi as you are sensitive data.&#8221;</p>
<p>Aunt Mimi&#8217;s picture is not random&#8230; it&#8217;s a picture, which is a clearly defined, non-random structure of real data.  Random pieces of non-random data isn&#8217;t truly random is it.  The concern here is that you can keep getting another 64K until you eventually find something useful&#8230; like the private key.  And it won&#8217;t even take you that long to do it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219433">

			<div class="comment by-jonah ">

				<p class="commentcredit">

					<span class="commenter">Jonah</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219433">
						April 9, 2014 6:01 PM					</a>

				</p>

				<p>@ Mark: Not to mention, it&#8217;s not 64 random kb in all of your memory, it&#8217;s 64 random kb of data in the heap of whatever process is using the OpenSSL library. Which is likely a smaller security related process where things like keys, passwords, etc are concentrated.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219434">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219434">
						April 9, 2014 6:14 PM					</a>

				</p>

				<p>@ DB, NotNickP</p>
<p>Languages are just abstractions over machine language. They all get converted into it. Safety/security features can be included at the high level language layer, the translation layer, or machine code itself. Without ability to change ISA, people tend to go with the first two. So, a language wanting extra safety might bounds check every array, be careful with stack manipulation, take measures for control flow integrity, etc. The tools handle that for the developer. Hence, for those trouble areas, the language is safer or more secure than the language that ignores such trouble areas.</p>
<p>Hence, I think I&#8217;m justified in recommending security-critical code be written in a language that prevents or reduces common classes of attack. And it doesn&#8217;t necessarily need a VM, either. That comes from the Java, Smalltalk, etc mindset. It might use just careful code generation (eg TAL), extra instructions for certain checks (eg Ada), a safer structuring (eg CFI), a safer interface (eg HLayer), or even a VM/interpreter (eg VLISP). Or a combination of above. The mechanisms vary.</p>
<p>Point is you can use a language that helps safely run your code or one that reliably helps the enemies run their code. Two of you seem to prefer the latter. Feel free to continue writing mission- or security-critical code in C/C++ while checking every function for potential code injections. Even worse, in unsafe languages you have to worry the most at the more common constructs: buffers, strings, etc. (Anyone else ever notice that?) My approach would have you worry less or not at all when doing common things through inherent safety of how language/compiler handle them.</p>
<p>Note: Empirical studies of C++ vs Ada done by defense/aviation industry a long time ago showed most Ada code has significantly fewer bugs while being easier to read. A recent report from Coverity put Python, also a safe[r] language, at a defect rate of 0.05 per 1k of code&#8230; one of lowest in industry. So, hard data backs my claim about better language design reducing defects and, hence, vulnerabilities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219435">

			<div class="comment by-skeptical ">

				<p class="commentcredit">

					<span class="commenter">Skeptical</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219435">
						April 9, 2014 6:38 PM					</a>

				</p>

				<p>Assuming the frequency of accidental bugs is much greater than NSA backdoors (10x greater? 100x?), the simple application of conditional probability suggests that this is very likely a bug.</p>
<p>Incidentally, notwithstanding this bug, the equities markets in the US rallied strongly, led by large gains in technology shares. Yahoo was up over 3%.</p>
<p>And of all the organizations and people who could exploit this, the NSA is the <i>least</i> worrisome. Focusing on the NSA in the context of bugs like this is a mistake, as it tends to reduce popular concern about security issues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219436">

			<div class="comment by-tz ">

				<p class="commentcredit">

					<span class="commenter">tz</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219436">
						April 9, 2014 6:41 PM					</a>

				</p>

				<p>If any of the other intel agencies knew about it, wouldn&#8217;t the first thing they would do is protect their own government and important infrastructure computers?</p>
<p>treasurydirect.gov anyone?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219437">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219437">
						April 9, 2014 6:57 PM					</a>

				</p>

				<p>@Skeptical</p>
<blockquote><p>And of all the organizations and people who could exploit this, the NSA is the least worrisome.</p></blockquote>
<p>I wouldn&#8217;t say they are the least worrisome, but yes there are worse organizations out there, which is the entire reason why, with programs like BULLRUN, the NSA is a significant threat to national and international, public and and private security interests.</p>
<blockquote><p>Focusing on the NSA in the context of bugs like this is a mistake, as it tends to reduce popular concern about security issues.</p></blockquote>
<p>Popular concern about security issues seems to be on the rise since the NSA leaks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219438">

			<div class="comment by-eric ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://brownhatsecurity.com' rel='external nofollow ugc' class='url'>Eric</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219438">
						April 9, 2014 7:14 PM					</a>

				</p>

				<p>I saw some information propagating re: <a href="http://seacat.mobi/blog/heartbleed" rel="nofollow ugc">Seacat</a> (google cache <a href="http://webcache.googleusercontent.com/search?q=cache:y92P5ipeQ3cJ:www.seacat.mobi/blog/heartbleed&amp;hl=en&amp;gl=us&amp;strip=1" rel="nofollow ugc">here</a>) claiming that they&#8217;d seen evidence in their logs of scanning for this bug as far back as March 23.</p>
<p>Needless to say, that&#8217;s a very worrisome proposition, if true.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219439">

			<div class="comment by-eli ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://retracile.net' rel='external nofollow ugc' class='url'>Eli</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219439">
						April 9, 2014 7:15 PM					</a>

				</p>

				<p>For users, you have to wait until the site is updated to no longer be vulnerable to change your passwords.  To determine that, you need to check the issue date of the SSL cert.  If the date is before Monday, there is no point in changing your password: either the site was not vulnerable (due to using an old OpenSSL library or some other implementation), or the site is still vulnerable.  In either case, updating your password isn&#8217;t needed for the heartbleed bug.<br />
If the date is newer than that, the site has taken the steps it is going to take to fix the heartbleed bug, and it makes sense to update your password.  (Hopefully they updated their private key and not just the cert, but a user isn&#8217;t going to be able to determine that.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219440">

			<div class="comment by-steve-schneider ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.tunnelx.com' rel='external nofollow ugc' class='url'>Steve Schneider</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219440">
						April 9, 2014 7:47 PM					</a>

				</p>

				<p>Bruce, what would be you theory as to why this isn&#8217;t being treated as stop-the-presses news?  This is being covered as a &#8220;tech story.&#8221;  This is a &#8220;tech story&#8221; only in the sense that Hiroshima was a &#8220;science story.&#8221;  99.99999% of internet users have visited a Heartbleed-affected website (not that all or even most of these users have been directly affected, but that&#8217;s part of the problem: we don&#8217;t know <i>which</i> of these 99.99999% of internet users were affected, or will be).  You&#8217;re right, of course, that this is &#8220;catastrophic.&#8221;  As in, <i>a catastrophe has occurred</i>.  An end-of-the-world-type catastrophe?  Of course not.  But a seriously, seriously, seriously bad thing has happened, with potentially far reaching (and certainly unknown, perhaps unknowable) consequences.</p>
<p>What do you think of the coverage?  I ask partly because you&#8217;re one of the go-to experts to whom journalists look when they want to understand the implications of this or that security/tech event.  Do you think mainstream journalists understand this story?  It doesn&#8217;t seem to me to be a particularly tough one for laypeople to understand: it&#8217;s been discovered that one third of the locked doors in the world weren&#8217;t actually locked at all; they just <i>looked like they were locked</i>.  But this is being covered as if it were the ILOVEYOU worm or something&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219441">

			<div class="comment by-eli ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://retracile.net' rel='external nofollow ugc' class='url'>Eli</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219441">
						April 9, 2014 7:51 PM					</a>

				</p>

				<p>@Steve:  As a data point regarding the coverage, the Dallas Morning News had it on the front page of their Wednesday print edition, right beside the big photo of the Ukraine parliament brawl.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219442">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219442">
						April 9, 2014 8:10 PM					</a>

				</p>

				<p>DD-WRT updated to <a href="http://svn.dd-wrt.com/changeset/23882/#file0" rel="nofollow ugc">openSSL 1.0.1g</a> on April 7. Users of other router firmware might not be so lucky. MIT Technology Review: <a href="http://www.technologyreview.com/news/526451/widespread-bug-will-linger-on-in-unpatched-devices/" rel="nofollow ugc">Widespread Bug Will Linger On in Unpatched Devices</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219443">

			<div class="comment by-mr-paul ">

				<p class="commentcredit">

					<span class="commenter">Mr. Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219443">
						April 9, 2014 8:19 PM					</a>

				</p>

				<p>From a security review point of view, the RFC is seriously flawed on two counts that should have been spotted:</p>
<p>1) The payload. This begs to be a covert channel, and has a ill-defined (essentially none) use case. Unnecessary fields are the food of attackers.</p>
<p>2) Arbitrary content in the payload. This is where you are practically destined to have the problem occur. With no guidance to implementors, and no defined value to test for, you are almost guaranteed that at least one implementation will use uninitialized memory. Unfortunately that turned out to be a wildly popular one.</p>
<p>Although the implementation was, indeed, flawed the RFC is simply terrible for a security protocol. It should not have survived review, and should not have been implemented.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219444">

			<div class="comment by-leo ">

				<p class="commentcredit">

					<span class="commenter">leo</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219444">
						April 9, 2014 8:30 PM					</a>

				</p>

				<p>I thought big players like Google, Amazon, Yahoo! would be using HSM (hardware security module) to protect their private keys. Am I naive?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219445">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219445">
						April 9, 2014 9:13 PM					</a>

				</p>

				<p>@Bruce, @M Krohn</p>
<p>Could it be because the NSA wouldn&#8217;t want to expose that they had this capability to anyone? Even the FBI? It seems that this is something you&#8217;d want to keep under wraps totally. I can&#8217;t believe they wouldn&#8217;t have known about it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219446">

			<div class="comment by-clifford-heath ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://dataconstellation.com' rel='external nofollow ugc' class='url'>Clifford Heath</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219446">
						April 9, 2014 9:21 PM					</a>

				</p>

				<p>What this bug says about open source is that given enough bugs, all eyes are shallow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219447">

			<div class="comment by-ben-r ">

				<p class="commentcredit">

					<span class="commenter">Ben R</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219447">
						April 9, 2014 10:04 PM					</a>

				</p>

				<p>I don&#8217;t think the NSA has any interest in promoting the use of crypto they can break if China will also plausibly figure out how to break it. Dual_EC_DRBG is only breakable if you know the private key. DES was only breakable if you had enough computing power, and it&#8217;s much easier to predict your adversary&#8217;s computing power than to predict when they&#8217;ll happen to notice a flaw that might be noticed at any time by anyone.</p>
<p>I just can&#8217;t envision a scenario where the NSA would consider it a good idea to introduce something like Heartbleed, or keep it secret (for long) if they found it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219448">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219448">
						April 9, 2014 10:13 PM					</a>

				</p>

				<p>There&#8217;s always something isn&#8217;t there? SSL is trash today.</p>
<p>The other day Target stores lost millions of accounts. GCHQ is downloading data from children playing computer games. And  NSA is bent on anything except making the internet secure.</p>
<p>I think it&#8217;s time to call  Humpty-Dumpty-ville on the internet. Let&#8217;s sweep up the pieces and start all over.</p>
<p>I would bet there are some smart guys out there right now who could do it, and maybe have some good ideas already.</p>
<p>It shoulda&#8217; started out with a secure foundation, but wasn&#8217;t. Seems the NSA had a hand in that too long ago.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219449">

			<div class="comment by-don-schreiber ">

				<p class="commentcredit">

					<span class="commenter">Don Schreiber</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219449">
						April 9, 2014 10:19 PM					</a>

				</p>

				<p>I suspect that the computer security problem cannot truly be solved until we collectively abandon the Von Neuman Architecture and adopt the Harvard Architecture, both within individual computers and for the network.</p>
<p>Recall that Jobs and Wozniack&#8217;s &#8220;Blue Box&#8221; exploited the telephone networks sending both dialing commands and conversations over the same communication channel.</p>
<p>Shure a change from Von Neuman Architecture to Harvard Architecture will cost a lot of money.  However, the change need not happen all at once, and the early adopters should attract loyal followers.</p>
<p>Both IBM in developing System 360 and the recent General Motors ignition switch recall suffered from the &#8220;it will cost too much money to solve the problem, and it will delay the product&#8221; reasoning.</p>
<p>The cheapest and quickest time to fix a problem is when it is first discovered.<br />
However, that takes an act of humility on the developer&#8217;s part and an iron willed commitment to quality, i.e. &#8220;I made a mistake and I must fix it.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219450">

			<div class="comment by-foobar ">

				<p class="commentcredit">

					<span class="commenter">foobar</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219450">
						April 9, 2014 10:27 PM					</a>

				</p>

				<p>Bruce, I am completely disappointed that you haven&#8217;t said what needs to be said.</p>
<p>The Internet Infrastructure based on OpenSSL is no longer secure.<br />
And that includes everything. It needs to be butchered.<br />
It was never a good idea to trust CA&#8217;s to begin with.</p>
<p>A few days back, a backdoor level bug was fixed in OpenSSL by Apple. And now this.<br />
You have called this a &#8220;11&#8221;. At what number are planning on stating the obvious ?</p>
<p>This is the Engineering equivalent of a Ship sinking because someone knocked on your door.</p>
<p>The fact that OpenBSD has this bug should tell you something.</p>
<p>Do you know how many tests are run by Nvidia for its Graphic Cards ?<br />
Software can no longer call itself an &#8220;Engineering&#8221;, when even<br />
a telemarketing product can give you more guarantee than OpenSSL.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219451">

			<div class="comment by-eli ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://retracile.net' rel='external nofollow ugc' class='url'>Eli</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219451">
						April 9, 2014 11:00 PM					</a>

				</p>

				<p>I&#8217;ve written a trivial little script to make it easier to check if certs have been replaced since Heartbleed: <a href="https://retracile.net/blog/2014/04/10/03.30" rel="nofollow ugc">https://retracile.net/blog/2014/04/10/03.30</a></p>
<p>Hopefully others will find it useful.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219452">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219452">
						April 9, 2014 11:19 PM					</a>

				</p>

				<p>@ Don Schreiber</p>
<p>Von Neuman vs Harvard debate won&#8217;t save you when it&#8217;s really a data leakage.  This is not to say we shouldn&#8217;t do what you suggest, just that it&#8217;s not all we should do and it&#8217;s really more complicated than that&#8230; 🙂</p>
<p>@ NSA debate people:</p>
<p>I would totally agree that it&#8217;s not in the NSA&#8217;s interest to abuse a bug like this instead of fixing it&#8230; except that lately the NSA has shown a surprising propensity for doing irrational things!</p>
<p>@ Language debate people:</p>
<p>I agree that we should be using all the tools at our disposal to reduce bugs and enhance security.  As a matter of principle this naturally includes higher level language features that protect us from mistakes, as well as many other things that fall into this general category.  We shouldn&#8217;t fool ourselves into thinking that one thing (like changing languages) will solve all the problems, we need a layered approach.  Defense in depth.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219453">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219453">
						April 9, 2014 11:31 PM					</a>

				</p>

				<p>Some quick thoughts about this (I didn&#8217;t read the comments or any other articles)</p>
<p>1.) If you&#8217;re changing keys anyway, now is a great time to go with 2048 bit keys and finally rid the internet of 1024 bit keys.</p>
<p>2.) Perfect forward secrecy is worth it and should be used when possible</p>
<p>3.) I doubt this is the work of the NSA/GCHQ/Some-other-agency but I have a hard time believing they didn&#8217;t know about it. One of the best things the NSA could do for their reputation, government security,  and everyone else would be to alert the community when they find stuff like this so it gets fixed. They are the best funded vulnerability hunting team ever. They could do a ton of good for security  if they weren&#8217;t hell-bent on ruining it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219454">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219454">
						April 10, 2014 12:19 AM					</a>

				</p>

				<p>@ Don</p>
<p>It&#8217;s funny you cite System/360 for your &#8220;cost too much&#8221; claim as IBM spent around $5bil developing it. Only project that decade that cost more and with similar number of people was getting to the moon. If anything, they put nearly everything on the line to make it, got plenty adoption, and enjoyed profitable lock-in for half a century as a result. Quite the success story.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219455">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219455">
						April 10, 2014 1:40 AM					</a>

				</p>

				<p>@leo:<br />
You may sell the banks and huge organisations really good HSMs but the problem is whether the staffs in there truely understand their operations and nature. Some of them simply buy them and leave them there in default settings. Some of them have unrealistic expectations and unrealistic plans. A good HSM with good plans and knowledgeable people would be the case for good security. Otherwise it isn&#8217;t.</p>
<p>Regarding spying organisations, it&#8217;s their business model to ruin things. That&#8217;s what make sense and make bucks for them. They would have reports to show their bosses they did their jobs, they would have numbers to tabulate and get their pay rise.</p>
<p>The business model of the internet nowadays is to log down and somehow lay your hands on as much data as possible as data is the currency of the digital age.</p>
<p>OpenSSL went down sinking and now it&#8217;s dragging so many with it down and all the mistrust of ecommerce would be reinforced and strong feelings to stay away from the internet as well.</p>
<p>OpenSSL should have a reform of sorts. I don&#8217;t know. Something to make it more trustworthy and efficient. For now, look to other crypto libraries.</p>
<p>Security providing more mobility should be investigated as future plans for secure communications.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219456">

			<div class="comment by-jonathan-wilson ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Wilson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219456">
						April 10, 2014 1:45 AM					</a>

				</p>

				<p>This is yet another reason why we need to throw away the entire mess that is SSL/TLS and come up with something new.</p>
<p>This new protocol should:<br />
1.Be as simple as possible (to make implementations easier to write and validate)<br />
2.Contain something like Diffie-Helman so that someone who captures information on the wire and then later acquires the private key is unable to decrypt the information they already have (my readings of Diffie-Helman indicate that it should be possible to implement it such that even with the private keys, its impossible to get the transaction unless you can man-in-the-middle the connection)<br />
3.Use and require algorithms that have had a lot of peer review (and cryptanalysis) in the community such as RSA and AES and SHA2 and require key lengths that are as strong as possible (e.g. dont allow any RSA keys less than 2048 bits in the standard and require implementers to support longer keys for future proofing)<br />
4.Limit the number of options for things like cypher suites as much as possible (to prevent the problem TLS faces where its hard for people to know which options to enable and which ones to disable in order to get the best possible security).<br />
5.Where different options need to be made available for whatever reason, the most secure option should always be the default.<br />
6.Completely replace the model of certificate authorities and certificates. In particular, the only information that this new system should verify is a link between the public key and the domain. The client should&#8217;t need to know that <a href="http://www.google.com" rel="nofollow ugc">http://www.google.com</a> is owned by Google inc of Mountain View California. All they need to know is that the public key they have is the one that was put out by the legal owner of <a href="http://www.google.com" rel="nofollow ugc">http://www.google.com</a> and not by an imposter. (something which things like the diginotar hack have shown the current system to be no good at doing)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219457">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219457">
						April 10, 2014 2:12 AM					</a>

				</p>

				<p>@Jonathan Wilson:<br />
The flaws of SSL/TLS are long known but the efforts resisting such replacement are huge. There are so many protocols like DNSSEC and all that stuff out there that provides secure communications but the adoption rates are very slow or non-existent. Some reasons are due to commercial or governmental pressures to use weak protocols and mask them as being something good.</p>
<p>There are topics of such secure protocols cropping up but afterall, the weakest link is seldom the maths. It&#8217;s usually program errors like Heartbleed, human ignorance or deviance, pure carelessness and many more.</p>
<p>It&#8217;s not to say that we should not consider the creation of new secure protocols. What is more important is to speed up the rate of realization that existing protocols require some work. Most ordinary users wouldn&#8217;t care much about DH Key exchanges, AES ciphers and what not. They just want something to be secure out of the box and they are usually used in a forgetful and clumsy manner.</p>
<p>What is truely essential now is to figure out how to bring more awareness of personal security because most of the users are simply ignorant. They wouldn&#8217;t feel the pinch until something&#8217;s already hit them. Two outcome from Heartbleed &#8211; user becomes aversive of the Internet after that and users simply forget about it and return back to normal being clumsy.</p>
<p>If there is a greater awareness and greater demand from users to actually want to protect their self-interest, then the greater demands for more &#8220;proper security&#8221; would actually create certain mindsets and behaviours to drive such goals into reality. Otherwise all these secure communications protocols would be some novel projects sitting in the corner of the room.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219458">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219458">
						April 10, 2014 2:27 AM					</a>

				</p>

				<p>If they knew it would be treason.</p>
<p>In case they didn’t know:</p>
<p>Given the fact that they did not protect <b>us</b>:<br />
The point of our national security agencies is highly questionable.</p>
<p>What is their duty?<br />
To “analyze” the conversation between Angela Merkel and her hairdresser?<br />
Probably the focus for their technicians and scientists should be changed?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219459">

			<div class="comment by-benoit ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.submeet.net' rel='external nofollow ugc' class='url'>Benoit</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219459">
						April 10, 2014 2:43 AM					</a>

				</p>

				<p>In my opinion, the simplest and easiest reaction this mess is : Web services should <b>hash passwords on the client side</b>, and never &#8211; ever &#8211; send them in clear form.</p>
<p>Using SSL to protect the channel is not a good reason the transmit a password in clear form : Facebook, Twitter, Gmail &amp; Co should not know your password, you probably use the same one on many other services.<br />
Password leaks is probably the most complicated thing to fix actually for IT teams (updating the openssl library and regenerating keys is not so complicated after all&#8230;).</p>
<p><a HREF="http://communications-security.blogspot.fr/2014/04/lessons-we-can-learn-from-heartbleed.html" rel="nofollow ugc">I wrote several lines on this in my blog</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219460">

			<div class="comment by-simon-capstick ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://Www.pscomputer.co.uk' rel='external nofollow ugc' class='url'>Simon Capstick</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219460">
						April 10, 2014 2:54 AM					</a>

				</p>

				<p>Having patched, rebooted, generated new SSL key pairs and CSRs, installed new certificates, and restarted web servers&#8230;</p>
<p>There is no way for others to verify I have done this other than taking my word for it.  The new certificates have been issued by the CA/reseller with the original &#8216;valid from&#8217; dates, with only the serial number and fingerprints having visibly changed.</p>
<p>Worse is that nobody, without use of a non-openssl vpn client, can now safely use an untrusted network such as a WiFi hotspot.  Anyone malicious in control of a hotspot could now perfectly impersonate any patched (or non-patched!) site that leaked it&#8217;s private SSL key over the last two years.  Use of CRLs (Certificate Revocation Lists) on consumer devices may be patchy at best?  CRLs themselves may not get updated for days/weeks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219461">

			<div class="comment by-b ">

				<p class="commentcredit">

					<span class="commenter">B</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219461">
						April 10, 2014 2:58 AM					</a>

				</p>

				<p>I wonder if there is really a point in generating new passwords and certificates. After all, if an attacker has my old keys and passwords, shouldn&#8217;t I assume they installed a root kit on my server? So if I just generate new keys, they&#8217;ll immediately have them again via the root kit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219462">

			<div class="comment by-robin ">

				<p class="commentcredit">

					<span class="commenter">Robin</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219462">
						April 10, 2014 2:59 AM					</a>

				</p>

				<p><cite>I&#8217;m actually more disturbed by the microsoft closed source crypto libraries. They might contain similar bugs, but since they are closed source, there are far less chances that bugs in Microsoft Internet Information Server, Microsoft Crypto API, and Microsoft Schannel get fixed.</cite></p>
<p>MVPs are independent professionals who have access to all Microsoft source code.  They are under NDA, but if they were to spot something, it&#8217;d be fixed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219463">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219463">
						April 10, 2014 3:00 AM					</a>

				</p>

				<p>@Benoit</p>
<blockquote><p>Web services should hash passwords on the client side, and never &#8211; ever &#8211; send them in clear form.</p></blockquote>
<p>Unless it involves some sort of asymmetric algorithm, there is no way that can protect you. At best, it means if your password has enough entropy and it is used for multiple things, then you don&#8217;t have to change it everywhere. Most passwords don&#8217;t have enough entropy. Hell, even if you use some sort of asymmetric algorithm, if your password doesn&#8217;t have enough entropy then it is just as brute forcible. Regardless, most people need to change their passwords.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219464">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219464">
						April 10, 2014 3:06 AM					</a>

				</p>

				<p>Bruce, you say &#8220;This means that anything in memory &#8212; SSL private keys, user keys, anything &#8212; is vulnerable.&#8221;</p>
<p>I don&#8217;t think this is correct. On Linux you will only get access to memory owned by your process id, so &#8220;anything in memory&#8221; is not true: your sshd private key is safe, for example.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219465">

			<div class="comment by-benoit ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.submeet.net' rel='external nofollow ugc' class='url'>Benoit</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219465">
						April 10, 2014 3:14 AM					</a>

				</p>

				<p>@Anura</p>
<p>Brute-forcing weak passwords will alway exists as long as we use password as a main security secret for general public.<br />
The main problem here is that anyone can attack an unpatched server and randomly gather login/passwords. In this case your might find, by chance, pretty strong password.</p>
<p>Hashing them on the client side first with javascript could FIX this. Websites use ajax to setup complex protocol (fetch page updates, complete fields..), why don&#8217;t use the same technology to setup a password hashing with salt ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219466">

			<div class="comment by-lence ">

				<p class="commentcredit">

					<span class="commenter">Lence</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219466">
						April 10, 2014 3:19 AM					</a>

				</p>

				<p>Guys at Sticky Password recommend to change passwords on sites that have already fixed the flaw. What is your opinion on that? <a href="http://grahamcluley.com/2014/04/heartbleed-bug-leak-yahoo-password/" rel="nofollow ugc">http://grahamcluley.com/2014/04/heartbleed-bug-leak-yahoo-password/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219467">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219467">
						April 10, 2014 3:34 AM					</a>

				</p>

				<p>About hashing passwords on the client side &#8211; maybe stupid to post without more consideration and research, but:</p>
<p>How about hashing something like this together:<br />
&#8211; Password<br />
&#8211; Current time<br />
&#8211; &#8220;Service destination&#8221; (e.g. &#8220;https://www.amazon.com/&#8221;)<br />
&#8211; A random salt value</p>
<p>The server thus gets a hash that is only valid for a certain time window and only for its service destination. This provides already some additional level of protection &#8211; a simple replay of the same hash won&#8217;t do.</p>
<p>But does that already protect the passwort sufficiently, assuming the user chose a really strong password (as many true random bits as the hash length)?</p>
<p>I presume most likely not for the example above in the generality that it stands, but maybe a more specific algorithm could be made as trusted as standard cryptographic algorithms like AES etc.?</p>
<p>Or is there a fundamental problem with this approach? I presume there is previous work into that direction and obviously I should just take a look&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219468">

			<div class="comment by-badmemory ">

				<p class="commentcredit">

					<span class="commenter">BadMemory</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219468">
						April 10, 2014 3:52 AM					</a>

				</p>

				<p>Somewhere in the documents about the NSA&#8217;s ability to break encrypted internet traffic this ability was called &#8220;fragile&#8221;. Maybe because it was based on a bug introduced to open source code?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219469">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219469">
						April 10, 2014 3:54 AM					</a>

				</p>

				<p>Sorry, that was imprecise near the end: Can you derive the hash for a different time and/or a different destination from the knowledge of the hash for a given time and destination? (If the password contains as many true random bits as the hash, there is no way to recover the password (possible weaknesses of the hash function set aside).)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219470">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219470">
						April 10, 2014 3:58 AM					</a>

				</p>

				<p>Better forget what I wrote, stupid, what I proposed would also require the server to know the plain password.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219471">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219471">
						April 10, 2014 4:00 AM					</a>

				</p>

				<p>The problem is that with any symmetric algorithm, the server has to retrieve both the submitted and stored vslue and store it in RAM to perform the calculations. If it is dynamic, then you have to store the value that the computations are performed on, so a compromise of the database means all accounts are 100% compromised. This is as opposed to letting the client send a static value in which a server can then apply to an algorithm like PBKDF2 or bcrypt to make brute force attacks more difficult in case of DB recovery. However, the value submitted can still be recovered in this case, buf only if it is in memory during the attack. My recommendation? Zero out all sensitive data immediately after you no longer need it.</p>
<p>To reiterate what I said before: client-side hashing <em>might</em> protect your users from having their passwords cracked on other sites, but not yours, and only if their passwords are strong enough to not be brute forcible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219472">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219472">
						April 10, 2014 4:08 AM					</a>

				</p>

				<p>@anonymous from switzerland</p>
<p>Don&#8217;t sweat it; I&#8217;ve gone through the same exact thought process in the past. I imagine every cryptographer who has ever considered password security has come up with that same idea at one point before realizing the obvious flaw.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219473">

			<div class="comment by-dylan-smith ">

				<p class="commentcredit">

					<span class="commenter">Dylan Smith</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219473">
						April 10, 2014 4:21 AM					</a>

				</p>

				<p>@anon:</p>
<blockquote><p>
  I don&#8217;t think this is correct. On Linux you will only get access to memory owned by your process id, so &#8220;anything in memory&#8221; is not true: your sshd private key is safe, for example.
</p></blockquote>
<p>No, it&#8217;s absolutely correct. When the OpenSSL library allocates a chunk of new memory, the VMM could assign that from anywhere in physical RAM. It could be that this new chunk of physical RAM was just freed by another process. If that chunk of memory happened to include something sensitive, bad luck.</p>
<p>Of course it&#8217;s far more likely that the memory you can read is something used recently by OpenSSL itself, but generally the stuff in OpenSSL&#8217;s memory is most likely to be just the stuff you don&#8217;t want to leak out to third parties.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219474">

			<div class="comment by-uhu ">

				<p class="commentcredit">

					<span class="commenter">Uhu</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219474">
						April 10, 2014 4:48 AM					</a>

				</p>

				<p>@Benni (RetroShare)<br />
One of the first things it says on the web site of RetroShare is this: &#8220;&#8230;using [..] OpenSSL to encrypt all communication&#8221;. We are talking about a bug in OpenSSL, and as a solution you propose to use a product that uses OpenSSL? 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219475">

			<div class="comment by-from-the-outside ">

				<p class="commentcredit">

					<span class="commenter">From the Outside</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219475">
						April 10, 2014 4:57 AM					</a>

				</p>

				<p>Is it pure coincidence that the end of Windows XP support and the detection of this flaw fall together?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219476">

			<div class="comment by-skeptical ">

				<p class="commentcredit">

					<span class="commenter">Skeptical</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219476">
						April 10, 2014 5:15 AM					</a>

				</p>

				<p>@Anura: No question that Snowden leaks have increased public attention on security, but most of the public isn&#8217;t concerned that NSA will be harming them. It was surprising to me how many people polled had, without following the stories closely, taken the worst possible interpretation of those stories as truth (literally that NSA is listening to every phone call without a warrant) and then shrugged (this is why Obama repeated that &#8220;no one is listening to your calls&#8221; btw; it&#8217;s not clever language, but an attempt to correct a perception captured by polling that much of the public believed that that&#8217;s what the metadata story actually reported). But that &#8220;shrug&#8221; is very consistent with the perception that the NSA isn&#8217;t actually harming anyone (I&#8217;m not condoning shrugging if one believes NSA is listening to every call, with or without a warrant).</p>
<p>So if they hear &#8220;a bug that lets the NSA break into systems,&#8221; the response will be &#8220;meh.&#8221; However, if they hear &#8220;a bug that lets cybercriminals grab their passwords, steal their money, and destroy their data,&#8221; then they will pay very close attention.</p>
<p>Regarding Ada: I dimly recall hearing somewhere that the biggest obstacle to its wider adoption is the lack of libraries (being very technically ignorant, I remain mystified as to how the availability of public libraries affects the adoption of a programming language). Is there any truth to that claim? And would its broader adoption resolve bugs of this nature, or is it more a matter of implementing programming practices and debugging software, irrespective of language, that can prevent and detect such bugs in advance of a release?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219478">

			<div class="comment by-chris-w ">

				<p class="commentcredit">

					<span class="commenter">Chris W</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219478">
						April 10, 2014 5:19 AM					</a>

				</p>

				<p>I have a TP-link router, on which I immediately installed OpenWRT when I bought it. (good idea coz the original firmware apparently had a security hole, but that&#8217;s another subject.)</p>
<p>Checked ssl version 1.0.1e&#8230; upgraded to 1.0.1g, done.<br />
The advantage of not having to wait for a supplier firmware update. 😉</p>
<p>Bruce asked about low-end non-upgradable devices. Unfortunately I don&#8217;t have one that have a interface allowing to check versions. But those devices might not even run openssl or older versions, in any case it&#8217;s gonna be difficult to determine since non-upgradable devices rarely reveal what version of software is embedded.</p>
<p>@Dylan Smith</p>
<p>Sry, that wrong. In any protected memory OS, newly allocated pages are zeroed. If that were not the case any malicious userspace process would be able to steal everything on the device.</p>
<p>And from what I understand this isn&#8217;t an malloc related issue, it&#8217;s a read buffer overflow. The attacker basically says &#8220;I&#8217;ve got 64k of payload I want you to send back to me.&#8221; while the actual payload is way shorter (packet = [message type, payload length, actual payload, some padding]). The code copies the received payload to the send buffer using the length specified by the attacked thus reading beyond the receive buffer bounds.<br />
I&#8217;ve only skimmed the code, so I might be wrong.<br />
Of course, like so many others said already, adding a payload to a heartbeat other than a fixed-size sequence number is just idiotic design.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219479">

			<div class="comment by-quirk ">

				<p class="commentcredit">

					<span class="commenter">Quirk</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219479">
						April 10, 2014 5:44 AM					</a>

				</p>

				<p>@Nick P:</p>
<p>I don&#8217;t believe moving to managed code would have helped at all in this instance. The bright sparks working on OpenSSL had customised the memory allocator to &#8220;improve performance&#8221;, and it was these customisations to the memory allocator that caused the trouble. It would also be possible to do custom memory allocation in managed code land, and that they felt they had to hack memory allocation to improve performance strongly suggests that anything that they would have been doing in managed code would not have been any safer. If anything, I&#8217;m happier with a world where people are working on such issues in C and C++, in a community where an understanding of the risks of raw memory accesses is now reasonably widespread, than I would be with a world where people struggling to torture managed code to deliver high performance on low level applications had to also understand the security implications of their optimisations.</p>
<p>The real killer was that they were using unsanitised user input to work out what should be given back. Having language features to discourage this would definitely be a plus, though it&#8217;s always going to be hard to prevent incompetent developers from being incompetent developers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219480">

			<div class="comment by-hagai-bar-el ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.hbarel.com' rel='external nofollow ugc' class='url'>Hagai Bar-El</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219480">
						April 10, 2014 5:46 AM					</a>

				</p>

				<p>I contributed an essay that helps application server owners understand what was put at risk and what not.</p>
<p><a href="http://www.hbarel.com/openssl-heartbleed-bug" rel="nofollow ugc">OpenSSL Heartbleed bug: what&#8217;s at risk on the server and what is not.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219481">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219481">
						April 10, 2014 5:48 AM					</a>

				</p>

				<p>@ anonymous from switzerland,</p>
<ul><i>Better forget what I wrote, stupid, what I proposed would also require the server to know the plain password.</i></ul>
<p>Incompleat not stupid.</p>
<p>Instead of password think token, then think of two different ways of sending it.</p>
<p>Problem one, how to get your token across to the server securely when you create/update it.</p>
<p>Use Diffie-Helman or equivalent to create a one time key, use this to encrypt the token and send it across securely to the server. The server decrypts the token puts it in it&#8217;s DB and securely junks the one time password as does the client. I&#8217;ll leave the issue of making the DB at the server secure as a design choice as there are known ways to do it.</p>
<p>Now go back and think through the token generation from the user password that needs to be done on the client side.</p>
<p>Then see if it makes your system work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219482">

			<div class="comment by-joshua ">

				<p class="commentcredit">

					<span class="commenter">joshua</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219482">
						April 10, 2014 6:02 AM					</a>

				</p>

				<p>To check a site for the heartbleed bug use <a href="http://heartbleedvulnerabilityscan.com" rel="nofollow ugc">http://heartbleedvulnerabilityscan.com</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219483">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219483">
						April 10, 2014 6:17 AM					</a>

				</p>

				<p>@ Chris W,</p>
<ul><i>Sry, that wrong. In any protected memory OS, newly allocated pages are zeroed. If that were not the case any malicious userspace process would be able to steal everything on the device.</i></ul>
<p>.</p>
<p>When the OS allocates a new page to the process heap what you say is &#8211;usually&#8211; true. BUT now consider the case when the process heap already has sufficient space from a free to the malloc code&#8230;</p>
<p>Many years ago Sun had a bug in some of their code that in effect attached part of the password file to the end of a file, due to this malloc/free issue. They fixed it initialy by changing the call from malloc to calloc. That is calling free did not clear the memory, nor did calling malloc and the version of malloc they had used a memory selection algorithm that tended to return the same piece of memory that had just been freed if the sizes were the same.</p>
<p>As others have noted OpenSSL had it&#8217;s own &#8211;supposadly more efficient&#8211; malloc. Now I&#8217;ve not looked at that code so I can&#8217;t pass direct comment on it. However I will say that in general when code cutters try to make things more &#8220;efficient&#8221; they tend to remove things they think waste CPU cycles, one such thing is zerroing large blocks of memory either before or after use, it is afterall the reason we have both calloc and malloc in the first place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219484">

			<div class="comment by-vicky ">

				<p class="commentcredit">

					<span class="commenter">Vicky</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219484">
						April 10, 2014 8:14 AM					</a>

				</p>

				<p>One question I have is whether keys / certificate information have a recognisable structure? For example if I request 64Kb of memory and I get back a bunch of stuff with what looks like a JPEG header in it, I can make a good guess that it&#8217;s a JPEG and decode it accordingly and see the results. Similarly if there&#8217;s plain ASCII text in there, it&#8217;s easy to try interpreting it.</p>
<p>But wouldn&#8217;t key or certificate data held in memory just be indistinguishable from random garbage? (And presumably random garbage will in fact be most of what I get&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219485">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219485">
						April 10, 2014 8:28 AM					</a>

				</p>

				<p>@Uhu,<br />
&#8220;@Benni (RetroShare)<br />
One of the first things it says on the web site of RetroShare is this: &#8220;&#8230;using [..] OpenSSL to encrypt all communication&#8221;. We are talking about a bug in OpenSSL, and as a solution you propose to use a product that uses OpenSSL? :-)&#8221;</p>
<p>Thank you for your comment. I have reported this to the retroshare devs.</p>
<p>This was their answer:<br />
<a href="http://retroshare.sourceforge.net/forum/viewtopic.php?f=17&#038;t=4031" rel="nofollow ugc">http://retroshare.sourceforge.net/forum/viewtopic.php?f=17&#038;t=4031</a></p>
<p>&#8220;Edit: it’s a good idea to update openssl though. If you’re on Linux a system update should do it. If you’re on Windows you might have to replace the openssl DLL in retroshare’s directory.</p>
<p>Edit: it’s vulnerable.&#8221;</p>
<p>When Retroshare was created, the developers were inspired by the way people living under oppressive regimes share information deemed &#8220;hostile&#8221; by their government (this can be books, newsletters, video and audio recordings, or even political jokes).</p>
<p>Because of the heartbleed bug, all retroshare users now need to first update their openssl library (system wide on linux, and in the retroshare directory on windows) and then create new user identities with new public and private keys, and add themselves again with their new identities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219486">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219486">
						April 10, 2014 8:30 AM					</a>

				</p>

				<p>Theo de Raadt, of the OpenBSD OpenSSH fame, claims that a malloc protective wrapper, provided for an exploit mitigation, was intentionally avoided by the openSSL maintainers in order to gain some performance advantages on some systems &#8211; causing this current fiasco.</p>
<p><a href="http://thread.gmane.org/gmane.os.openbsd.misc/211952/focus=211963" rel="nofollow ugc">http://thread.gmane.org/gmane.os.openbsd.misc/211952/focus=211963</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219487">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219487">
						April 10, 2014 8:40 AM					</a>

				</p>

				<p>The funny thing is that this bug is <b>exactly</b> what Snowden talked about when he said that he could read anything from anyone he was interested in.</p>
<p>The NSA analists don&#8217;t have to know how the bug works, but they can get all the data they want. And it&#8217;s because of bugs like this one.</p>
<p>I expect to see more of these bugs. (Apache is high on my list.)</p>
<p>It also showed that Bruce Schneier was right when he said that nothing on the internet should be trusted.</p>
<p>And don&#8217;t think that the particular bug has been created by a monkey who didn&#8217;t know how to code. It has been created by a PhD student and P2P reviewed. What (again) shows that the C language has serious issues.</p>
<p>However the biggest problem of today is bloat. But the bloat is also a result of the sorry state of IETF / W3C protocols.</p>
<p>There are at least 6 protocols all doing roughly the same: remote access / filesystems.</p>
<p>1 &#8211; NFS (used to be called: No Fucking Security)<br />
2 &#8211; CIFS<br />
3,4 &#8211; FTP / SFTP<br />
5 &#8211; FTPS<br />
6 &#8211; WebDAV</p>
<p>Am I the only one questioning why? We should not secure our protocols. We should have less and simpler protocols (think 9P) and one simple mandatory secure layer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-219488">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219488">
						April 10, 2014 8:42 AM					</a>

				</p>

				<p>Note: I&#8217;ve updated the post, above.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219489">

			<div class="comment by-celos ">

				<p class="commentcredit">

					<span class="commenter">Celos</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219489">
						April 10, 2014 9:00 AM					</a>

				</p>

				<p>This whole mess highlights an underlying problem: Sloppy and incompetent software engineering. OpenSSL is rather obvious a security critical piece of software, why do they not have mandatory time-of-use boundaries checks? They cost nearly nothing in terms of computing power. They make it easy to reject patches from clueless people. As this one was. Honestly, I think the person responsible should have their PhD removed for having causes severe damage in their field of study.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219490">

			<div class="comment by-chris-w ">

				<p class="commentcredit">

					<span class="commenter">Chris W</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219490">
						April 10, 2014 9:09 AM					</a>

				</p>

				<p>@Clive</p>
<p>&#8220;BUT now consider the case when the process heap already has sufficient space from a free to the malloc code&#8230;&#8221;</p>
<p><em>process</em> heap is the operative word, that already belongs to your process. An malloc call will gladly preserve the data that was in a freed block, you already had access to that memory anyway.<br />
Within a process heap/memory block you can do whatever you want. But you will never ever get data that belonged to another process without a major kernel screw-up.</p>
<p>@Jacob<br />
A malloc protective wrapper is to add protective blocks around each allocation, these blocks are marked as unreadable (using mprotect, google it if you want). If a piece of code continues reading beyond the allocated block it will hit the protective block and get a big fat exception, which would&#8217;ve prevented the data theft.<br />
(and without an exception handler the process would die allowing an attacker to DOS every server affected, but that&#8217;s another matter)<br />
But such protective wrappers come at some performance costs. Whether it&#8217;s smart to use it for each malloc is debatable.<br />
Probably would&#8217;ve been smart to surround every memory containing sensitive info (private keys and session keys for example) with those protective guards, which would been negligible in terms of performance cost and at least prevented the theft of those keys.<br />
But hindsight it easy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219492">

			<div class="comment by-l ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.fenrirproject.org' rel='external nofollow ugc' class='url'>L</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219492">
						April 10, 2014 9:17 AM					</a>

				</p>

				<p>@Anura, @sshdoor</p>
<p>Leave GnuTLS/OpenSSL alone.</p>
<p>You don&#8217;t really want to refactor that, not in C, and especially not x.509.</p>
<p>OpenSSL has 25k lines of code just for X.509, GnuTLS has ~35k. X.509 should just be abandoned.</p>
<p>Also, this problem came just from OpenSSL reimplementing the memory allocation on all platforms, as was commented here:<a href="http://article.gmane.org/gmane.os.openbsd.misc/211963" rel="nofollow ugc">http://article.gmane.org/gmane.os.openbsd.misc/211963</a></p>
<p>I&#8217;m in the process of writing the code for a new crypto/auth protocol, I&#8217;ll launch some kind of crowdfounding campaign around the end of this year. The basic protocol and implementation will already be there by that time, and the money will go into checking everything and making it faster.</p>
<p>So my advice for now is to wait a little bit while I complete my thesis, and then give me a hand: rewriting OpenSSL is huge and kind of useless now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219493">

			<div class="comment by-knottwhittingley ">

				<p class="commentcredit">

					<span class="commenter">KnottWhittingley</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219493">
						April 10, 2014 9:18 AM					</a>

				</p>

				<p>Clive:</p>
<blockquote><p>That is calling free did not clear the memory, nor did calling malloc and the version of malloc they had used a memory selection algorithm that tended to return the same piece of memory that had just been freed if the sizes were the same.</p></blockquote>
<p>Yes.  That&#8217;s common, both to save CPU time in the allocator and to improve locality.  You don&#8217;t merge freed blocks together too eagerly, only to split them up into the same size blocks again, if you keep allocating and freeing a moderate number of blocks of roughly the same size(s).  And by and large, you re-use the recently-freed stuff first, so that you&#8217;re mostly reusing memory while it&#8217;s still in your caches.</p>
<blockquote><p>As others have noted OpenSSL had it&#8217;s own &#8211;supposedly more efficient&#8211; malloc. Now I&#8217;ve not looked at that code so I can&#8217;t pass direct comment on it. However I will say that in general when code cutters try to make things more &#8220;efficient&#8221; they tend to remove things they think waste CPU cycles, one such thing is zerroing large blocks of memory either before or after use, it is afterall the reason we have both calloc and malloc in the first place.</p></blockquote>
<p>Yes, and unfortunately it&#8217;s particularly common in &#8220;systems&#8221; code that&#8217;s supposed to be both efficient and very portable.  Zero-filling modest amounts of memory is usually <i>very</i> cheap on most modern architectures if you do it right, because you don&#8217;t need to read the cache blocks before writing them and you can write 16 or 32 bytes in parallel with one store instruction, and most processors are just really fast these days anyhow.  But very portable software can&#8217;t assume any of those things, much less all of them.</p>
<p>I would hope that such bugs would be caught by a code review, because there&#8217;s an obvious channel there, and people ought to think about what could ever be in that payload section.</p>
<p>Failing that, I&#8217;d have thought it&#8217;d probably be caught in standard regression testing.  Is there not a brute-force test to look at all the outputs of high-level operations and see whether low-level information is leaking into them <i>in the clear</i>?  (By e.g., hashing all the secret data at lower levels, and the data exposed at higher levels, and looking for matches?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219494">

			<div class="comment by-codename-charlie-foxtrot ">

				<p class="commentcredit">

					<span class="commenter">Codename Charlie Foxtrot</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219494">
						April 10, 2014 9:24 AM					</a>

				</p>

				<p>You can always learn a lot from skeptical&#8217;s NSA glavlit. You can tell what scares them most.</p>
<p>First they fear for their strawmen and lies, which Snowden just exploded by explaining how the NSA Stasi actually works, <a href="http://www.emptywheel.net/2014/04/09/fingerprints-and-the-phone-dragnets-secret-correlations-order/" rel="nofollow ugc">http://www.emptywheel.net/2014/04/09/fingerprints-and-the-phone-dragnets-secret-correlations-order/</a></p>
<p>NSA tax parasites are still trying to reason from their own daily affirmations that they are well-meaning and not criminal. Like there&#8217;s anybody left who doesn&#8217;t know that NSA will use every scummy NKVD kompromat trick in the book, if they decide they don&#8217;t like you, <a href="https://www.aclu.org/national-security/nsa-reportedly-sought-discredit-radicals-disclosing-online-sexual-activities" rel="nofollow ugc">https://www.aclu.org/national-security/nsa-reportedly-sought-discredit-radicals-disclosing-online-sexual-activities</a></p>
<p>Then we have NSA trying to model how you should think, or rather shrug so what. Today&#8217;s Big Lie: &#8216;NSA isn&#8217;t actually harming anyone&#8217; with its systematic sabotage of global communications infrastructure. Tell that to Canada, while their revenue is cut off by the threat to online tax filing. Now multiply that by the OECD membership &#8211; twice, subtracting one, for the network effects of NSA sabotage &#8211; and repeat for affected commercial concerns. Then apply the settled law of state responsibility to figure reparations, compensation and satisfaction. Alexander&#8217;s epochal fiasco will keep ICJ and arbitral panels busy for a decade, and beggar DoD.</p>
<p>Good luck proving your innocence. Anons and PMers have already got NSA cutouts Stephen Henson and Robin Seggelmann hopelessly, undeniably pegged. Surely you&#8217;re monitoring the forums. No, not those forums, the good ones.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219495">

			<div class="comment by-knottwhittingley ">

				<p class="commentcredit">

					<span class="commenter">KnottWhittingley</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219495">
						April 10, 2014 9:56 AM					</a>

				</p>

				<p>Reportedly,</p>
<blockquote><p>The vulnerability in encryption software OpenSSL was discovered by Google researcher Neel Mehta and the security firm Codenomicon.</p></blockquote>
<p>If NSA or some other intelligence agency knew about this, I&#8217;d expect them to eventually tip security researchers off somehow&#8212;either by just telling some compliant person at some security company, or by doing something to anonymously tip security people off, e.g., forcing server crashes that draw attention to the bug and look like consequences of, say, Chinese botnets trying to exploit it.</p>
<p>I&#8217;d expect that NSA would tip the security community off one way or another only when they notice that the exploit is being attempted by unfriendlies&#8212;the Russians, the Chinese, criminal gangs, etc.</p>
<p>So the normal thing would be that these things would eventually be &#8220;discovered&#8221; by some security researcher somewhere, and that we&#8217;d be none the wiser.  Unless you investigate it very thoroughly, you&#8217;d usually have no way of knowing that the discovery wasn&#8217;t just a run-of-the-mill bug discovery.</p>
<p>I&#8217;d expect the NSA to often know about such things, because they have the resources to do more and better code reviews of open source and stolen source than the code developers and maintainers do, and because they presumably have an extensive set of honeypot systems that they analyze to see what the hell the &#8220;bad guys&#8221; are up to.</p>
<p>Am I wrong?  Is there some way we could tell if this alert came from NSA or GCHQ&#8212;or any old intelligence agency in the Netherlands or India or Latvia or whereever&#8212;that didn&#8217;t think the whole Internet should be shot full of gaping security holes?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219496">

			<div class="comment by-bingo ">

				<p class="commentcredit">

					<span class="commenter">Bingo</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219496">
						April 10, 2014 10:11 AM					</a>

				</p>

				<p>@KnottWhittingley: Maybe a retrospect analysis of some saved internet traffic can answer your question? If mismatch between heartbeat package sizes (IN/OUT) stops now but can be detected for the past, somebody stopped using the exploit?</p>
<p>What I do not understand about heartbleed is: How can such an error be introduced in 2012? There was no new functionality, or was it? If so, why did someone change the code at all? Did they try to fix other bugs and on the flight introduced heartbleed? Or was this a complete rewrite for the sake of efficiency? Why then was it still written in C? Why is nobody publishing the comments on the commit of the first buggy version?</p>
<p>???</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219497">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter">JJ</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219497">
						April 10, 2014 10:25 AM					</a>

				</p>

				<p>Thanks to those posting links to company statements and the log from Tuesday&#8217;s scan.<br />
I am confused though that several big &#8220;advice sites&#8221; urge users to change their gmail password even though google wrote that not gmail but only minor services were vulnerable to the bug.</p>
<p>Here is another thing I am trying to understand (please excuse my ignorance): what is the risk of having an unpatched version of OpenSSL on your router (e.g. DDWRT or Tomato)? Any SSL traffic from my computers is just passively routed through, right? Or is the OpenSSL implementation on the router involved in regular SSL traffic from connected computers as well?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219498">

			<div class="comment by-william-clark ">

				<p class="commentcredit">

					<span class="commenter">William Clark</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219498">
						April 10, 2014 10:40 AM					</a>

				</p>

				<p>I have not received a single e-mail from any service disclosing they were vulnerable and have taken the correct steps to fix that, even from two services that were widely reported to be vulnerable: Steam and Yahoo.</p>
<p>When the services I know were vulnerable (and have my e-mail address) won&#8217;t disclose that they patched the bug, created new keys, and had them certified, much less ask me to change my password, I have to assume they haven&#8217;t. No longer being vulnerable to the bug doesn&#8217;t mean that that their keys haven&#8217;t been copied, after all. And other services I have used or may use may have once been vulnerable and not done everything they have to do to be secure again, and I have no way of telling with them either.</p>
<p>Am I wrong in assuming that in an environment where non-disclosure appears to be the norm, that by default that all services are insecure, and can only be trusted if they WERE vulnerable AND have publicly disclosed the process they went through to restore security AND that process included all the actions needed to mitigate the damage?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219499">

			<div class="comment by-paul ">

				<p class="commentcredit">

					<span class="commenter">Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219499">
						April 10, 2014 10:50 AM					</a>

				</p>

				<p>This might have been mentioned before but as I write this&#8230;<br />
LastPass&#8217; tool says Paypal is not fixed.<br />
The tool linked to in the article says it is fixed.</p>
<p>Just wondering who to believe?<br />
Rough guess is LastPass is using cached data so might not be updated vs. the tool linked to in the article.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219500">

			<div class="comment by-poison-ivy ">

				<p class="commentcredit">

					<span class="commenter">Poison Ivy</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219500">
						April 10, 2014 11:10 AM					</a>

				</p>

				<p>As to that eff.org article Bruce links to in &#8220;Possible evidence that Heartbleed was exploited last year&#8221;&#8230;</p>
<p>That article mentions two IP-addresses (193.104.110.12 and 193.104.110.20) as being the source of the attack noticed by Terrence Koeman.</p>
<p>The article then says that those IP addresses appear to be part of a larger botnet.</p>
<p>Is that a NSA-operated botnet? And if someone says &#8220;no&#8221;, how would we really know?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219501">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219501">
						April 10, 2014 11:28 AM					</a>

				</p>

				<p>@Bingo</p>
<blockquote><p>What I do not understand about heartbleed is: How can such an error be introduced in 2012? There was no new functionality, or was it? If so, why did someone change the code at all? Did they try to fix other bugs and on the flight introduced heartbleed? Or was this a complete rewrite for the sake of efficiency? Why then was it still written in C? Why is nobody publishing the comments on the commit of the first buggy version?</p></blockquote>
<p>Yes, it was new functionality. They were implementing an extension to TLS, RFC 6520. The commit itself was discussed a little bit, but it&#8217;s not very interesting. The link was posted as well.</p>
<p>RFC:<br />
<a href="https://tools.ietf.org/html/rfc6520" rel="nofollow ugc">https://tools.ietf.org/html/rfc6520</a></p>
<p>Commit:<br />
<a href="https://github.com/openssl/openssl/commit/4817504d069b4c5082161b02a22116ad75f822b1" rel="nofollow ugc">https://github.com/openssl/openssl/commit/4817504d069b4c5082161b02a22116ad75f822b1</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219502">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219502">
						April 10, 2014 11:42 AM					</a>

				</p>

				<p>@Poison Ivy, yes the nsa seems to operate botnets</p>
<p>Oh my god: the IP</p>
<p>193.104.110.12 and 193.104.110.2</p>
<p>are not only in the range of a botnet that wanted to copy everything from freenode:</p>
<p>193.104.110.12 and 193.104.110.2</p>
<p>There was also this leak at cryptome (usually cryptome leaks are credible):<br />
<a href="http://cryptome.org/0001/nsa-ip-update14.htm" rel="nofollow ugc">http://cryptome.org/0001/nsa-ip-update14.htm</a></p>
<p>In 2007, someone leaked an ip table. Of course cryptome can not reveal its source, but it said that these IPs are nsa controlled.</p>
<p>Then in 2014, cryptome reports that there is a botnet that is attacking websites from these alledged nsa IPs leaked in 2007:</p>
<p><a href="http://cryptome.org/2014/03/nsa-zologize.htm" rel="nofollow ugc">http://cryptome.org/2014/03/nsa-zologize.htm</a></p>
<p>And now: the IP table reads:</p>
<p>&#8220;193.0.0.0 &#8211; 193.255.255.255 (subranges are NSA-affiliated and/or NSA fully-controlled)&#8221;</p>
<p>Apparently, the reported IPs 193.104.110.12 and 193.104.110.2 are in this range.</p>
<p>This together with the fact that these Ips were used to spy and copy every conversation on freenode smells much like we have found an nsa botnet here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219503">

			<div class="comment by-anderer-gregor ">

				<p class="commentcredit">

					<span class="commenter">Anderer Gregor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219503">
						April 10, 2014 11:45 AM					</a>

				</p>

				<p>Two things are making me very nervous right now.</p>
<p>The first one is that, right now, millions of admins are currently generating new SSL keys, on freshly booted machines, with recently downloaded packages, of which only a very small amount will exist. I could not imagine a better way to lower the available entropy for those keys &#8230; in other words, if there is anything, even the smallest thing wrong in the RNG or the key generation of the two or three OpenSSL version these admins are using for this, we will be in big trouble again sooner or later.</p>
<p>The other problem is that, right now, a couple of people seem to believe that is a good idea to implement Crypto stuff in some &#8220;safer&#8221; languages of their choice. Cryptocatting, so to say. So we will be going through all the protocol issues, timing attacks, side-channel attacks, RNG problems, initialization issues again we went through with the big&amp;ugly ones like OpenSSL, SSH etc over the last couple of years. With the extra fun that we are now doing this in programming languages where it is harder to make timing data-independent (because the language/machine/&#8230; and not the programmer decides which checks to do, which memory to free when, &#8230;), where it might be more difficult to obtain secure RNG states (see the Android (&#8220;Bitcoin&#8221;) RNG problem a while ago), etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219504">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219504">
						April 10, 2014 11:47 AM					</a>

				</p>

				<p>ah sorry, fifth line of my post reading &#8220;193.104.110.12 and 193.104.110.2&#8221; should have been <a href="https://botmonitoring.github.io/" rel="nofollow ugc">https://botmonitoring.github.io/</a> which is the site that reported them as spybots on freenode.</p>
<p>Notice that the attack, i linked above from cryptome came with a php script called &#8220;zologize&#8221;. Zologize means collecting critters, insects or bugs. So yes, given that our agency usually names its projects &#8220;FLYING PIG&#8221;, &#8220;FERETCANNON&#8221;, &#8220;FOXACID&#8221;, &#8220;Zologize&#8221; would fit into the naming sheme for a botnet that aims to hijack large numbers of webservers for turning them into bugs, thereby collecting bugs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219506">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219506">
						April 10, 2014 11:53 AM					</a>

				</p>

				<p>From slashdot (apologies if already referenced in this very busy entry):</p>
<p>Stung by file encrypting malware researchers fight back</p>
<p><a href="http://yro.slashdot.org/story/14/04/10/1518234/stung-by-file-encrypting-malware-researchers-fight-back" rel="nofollow ugc">http://yro.slashdot.org/story/14/04/10/1518234/stung-by-file-encrypting-malware-researchers-fight-back</a></p>
<p>From the last line of the post, it seems that Symantec had no problems telling CryptoDefense authors what mistake they made.</p>
<p>We have found the enemy and he is us.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219507">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219507">
						April 10, 2014 11:59 AM					</a>

				</p>

				<p>@ All re Password Handling</p>
<p>No new or guesswork constructions. This is INFOSEC. We just use what&#8217;s been proven in practice. OWASP has a nice <a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet" rel="nofollow ugc">cheat sheet</a> on how to properly handle passwords. Use it intead of whatever clever idea you have unless you&#8217;re a security engineer or cryptographer.</p>
<p>@ BadMemory</p>
<p>&#8220;Somewhere in the documents about the NSA&#8217;s ability to break encrypted internet traffic this ability was called &#8220;fragile&#8221;. Maybe because it was based on a bug introduced to open source code?&#8221;</p>
<p>Interesting thought. It could be. It might also be &#8216;fragile&#8217; in the sense that they weakened protocols or users did plenty plaintext assuming no harm. They&#8217;d be concerned trends could shift against them if people&#8217;s perception of risk of these things changed.</p>
<p>@ Uhu</p>
<p>&#8220;We are talking about a bug in OpenSSL, and as a solution you propose to use a product that uses OpenSSL? :-)&#8221;</p>
<p>I saw that too lol. I thought &#8220;This is so ridiculous I&#8217;m not even posting a critique of it.&#8221; Theo de Raadt burning OpenSSL team was the highlight of my day so far, though.</p>
<p>@ Quirk</p>
<p>&#8220;The bright sparks working on OpenSSL had customised the memory allocator to &#8220;improve performance&#8221;, and it was these customisations to the memory allocator that caused the trouble. It would also be possible to do custom memory allocation in managed code land, and that they felt they had to hack memory allocation to improve performance strongly suggests that anything that they would have been doing in managed code would not have been any safer. &#8221;</p>
<p>People writing in more safety-centered systems languages rarely do anything like that. So, it&#8217;s already more likely that it wouldn&#8217;t happen. That said, these people tried to cheat as you pointed out so this particular development team might shoot themselves in the foot in a safe language. But, it&#8217;s kind of a fake argument as you say &#8220;But, if they bypass the safety features with bad coding the safety features don&#8217;t help.&#8221; No kidding. They could also put their private key on twitter. But when do we judge a safety/security tool by how its more foolish users apply it?</p>
<p>&#8220;The real killer was that they were using unsanitised user input to work out what should be given back. &#8221;</p>
<p>A good point. My rules of secure development say look at <em>all</em> input coming into the application and check it. It&#8217;s a pain that adds a lot of extra code to the app logic. Most just don&#8217;t want to do it. Far as tools, there are cutting-edge systems that tag all data with a provenance bit and impose restrictions on externally-generated data. Then, a bit more practical, there are software libraries &amp; frameworks that do input validation of certain types. However, if it&#8217;s not well-understood and common case, I think it will always be up to the developer to just think about their application, identify potential input problems, and fix them.</p>
<p>Systems enforcing POLA, strong modularity, memory compartmentalization, etc. can also help here in containing damage. For instance, I had one design for secure web server that broke it up into separate address spaces on a microkernel. The SSL &amp; HTTP connection mgmt processes were both isolated. Message passing was architecture and web server components could only talk to message router. They ask &#8220;may I,&#8221; where router then checks source, destination, and size against security policy before moving message itself. Compromising any given component only allows you to send or receive messages authorized to flow through that component. So, a memory attack on OpenSSL would have trapped to the microkernel, which would send it to a process that handles this stuff. The process would log the error, optionally save entire execution state of SSL partition, notify admin, and temporarily disable web interface. Memory attack merely becomes a loss of availability that also tells me where the 0-day was. The power of sound, security architecture. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219508">

			<div class="comment by-paranoiduser ">

				<p class="commentcredit">

					<span class="commenter">ParanoidUser</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219508">
						April 10, 2014 12:02 PM					</a>

				</p>

				<p>Here&#8217;s a silly question &#8211; lots of &#8220;really popular&#8221; sites have been hit by huge DDOS attacks in the last two years.  Do you suppose some of those attackers were using the Heartbleed vulnerability to harvest loads of encrypted traffic/information from those servers?</p>
<p>#shudder</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219509">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219509">
						April 10, 2014 12:07 PM					</a>

				</p>

				<p>@ParanoidUser</p>
<p>A DDOS is a poor way to collect information. You are going to end up filling the memory with a ton of junk. Most DDOS attacks seem to be for either political or financial gain, e.g. businesses bringing down competitors to increase their traffic, or people trying to get ransom.</p>
<p>This is a very light-weight attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219510">

			<div class="comment by-sad-clown ">

				<p class="commentcredit">

					<span class="commenter">Sad Clown</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219510">
						April 10, 2014 12:13 PM					</a>

				</p>

				<p>I am amused/surprised/curious about the references to ADA.  Is that used outside of DOD?  I am no fan of the complexity of C++, and I have always thought of ADA as worse, but that is really an uninformed opinion.  Is it really a good language for networking and security?  Any great website to get up to speed on it?</p>
<p>I am a long time C programmer who has fallen in love with GO.  Yes, yes, it comes from google, but as source, and the source seems clear enough to desk check.  Any opinions &#8212; or facts &#8212; about security concerns in using go for encryption and secure networking?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219511">

			<div class="comment by-knottwhittingley ">

				<p class="commentcredit">

					<span class="commenter">KnottWhittingley</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219511">
						April 10, 2014 12:18 PM					</a>

				</p>

				<p>I&#8217;m not sure if this is what ParanoidUser means, but I was wondering if some apparent DDOS attacks are actually attempts to scoop up information using some exploit like Heartbleed, because somebody wants some information that&#8217;s on that computer <i>right now</i>&#8212;e.g., something about some user they&#8217;re particularly interested in who think is on that system now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219512">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219512">
						April 10, 2014 12:25 PM					</a>

				</p>

				<p>@Sad Clown</p>
<p>There has been some language discussion in the latest Squid Blogging post that you might be interested in:</p>
<p><a href="https://www.schneier.com/blog/archives/2014/04/friday_squid_bl_418.html#comments" rel="nofollow ugc">https://www.schneier.com/blog/archives/2014/04/friday_squid_bl_418.html#comments</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219513">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219513">
						April 10, 2014 12:46 PM					</a>

				</p>

				<p>@ Sad Clown</p>
<p>This page covers everything you need to know about its intentions and benefits:</p>
<p><a href="http://www.adaic.org/advantages/" rel="nofollow ugc">http://www.adaic.org/advantages/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219514">

			<div class="comment by-sad-clown ">

				<p class="commentcredit">

					<span class="commenter">Sad Clown</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219514">
						April 10, 2014 12:51 PM					</a>

				</p>

				<p>@Anura  Thanks, that was an amusing read.  It really shows how little one can know about a language without actually programming in it.</p>
<p>I have no doubt about GO&#8217;s capabilities, although a lot of important capabilities are in packages, not the core language.  I&#8217;m just looking for any heads ups security-wise.  It&#8217;s birth at Google gives me pause.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219515">

			<div class="comment by-softmasterg ">

				<p class="commentcredit">

					<span class="commenter">SoftmasterG</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219515">
						April 10, 2014 1:16 PM					</a>

				</p>

				<p>Are there any KNOWN cases of the random memory containing passwords, credit card numbers or private keys?  I know there&#8217;s a possibility, but has it actually happened?  How does a hacker turn random bits of memory into a clear picture?  Sure you can pull 64k of memory from a server but has anyone does this continuously and then compared that to the actual contents of memory or to data that they knew was being processed?  Sorry if I missed the answers to these questions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219516">

			<div class="comment by-william-clark ">

				<p class="commentcredit">

					<span class="commenter">William Clark</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219516">
						April 10, 2014 1:28 PM					</a>

				</p>

				<p>@SoftmasterG<br />
The original researchers reportedly managed to. And in the comments to the first Ars Technica article on this, some comments alleged that they were posted using credentials gleaned from the hack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219517">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219517">
						April 10, 2014 1:48 PM					</a>

				</p>

				<p>@Nick_P</p>
<p>&#8220;&#8221;We are talking about a bug in OpenSSL, and as a solution you propose to use a product that uses OpenSSL? :-)&#8221;</p>
<p>I saw that too lol. I thought &#8220;This is so ridiculous I&#8217;m not even posting a critique of it.&#8221;&#8221;</p>
<p>Actually, it is not as ridiculous as it seems. Retroshare is not an ordinary web server. For example, the full answer of this dev reads:</p>
<p><a href="http://retroshare.sourceforge.net/forum/viewtopic.php?f=17&#038;t=4031#p12264" rel="nofollow ugc">http://retroshare.sourceforge.net/forum/viewtopic.php?f=17&#038;t=4031#p12264</a></p>
<p>&#8220;<em>Debian/Ubuntu</em>: update libssl, and restart Retroshare.<br />
<em>Windows</em>: we&#8217;ll publish a new installer/windows package tonight (Apr. 10) since ssl is statically linked</p>
<p><em>MacOS</em>: make sure you&#8217;re not vulnerable. Apparently MacOS uses openssl 0.9.8 which is fine, otherwise, update libssl as well.</p>
<p>What to do next?</p>
<ul>
<li>Since your private PGP key is stored encrypted in memory, it&#8217;s unlikely that an attacker can obtain it. If your PGP password is not strong, that still can be a problem;</li>
<li>your location keys (SSL keys) might be compromised by an attacker. Since Retroshare uses PFS, recorded conversations cannot be decrypted anyway. But it is advised to generate new locations for your Retroshare nodes.</li>
</ul>
<p>In any case, if you&#8217;re dealing with sensible information, re-generate your keys.&#8221;</p>
<p>So, the private pgp key can not get in the hands of the nsa, even with retroshare being vulnerable, since it is additionally encrypted. But this key is needed to decrypt everything. Additionally, they have perfect forward secrecy enabled&#8230;</p>
<p>Retroshare has enough layers of security that the even the nsa will have to work really hard if they want to get in there.</p>
<p>Would Snowden have used retroshare to distribute his material, it still very likely still could be read only by his chosen friends and not by the nsa.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219518">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219518">
						April 10, 2014 1:56 PM					</a>

				</p>

				<p>I think it is worth noting that the filippo.io test sometimes has to be run many many times before it will report that the site is vulnerable</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219519">

			<div class="comment by-mclearn ">

				<p class="commentcredit">

					<span class="commenter">mclearn</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219519">
						April 10, 2014 2:00 PM					</a>

				</p>

				<p>@Vatos: The filippo.io test site is under heavy load which contributes to its inability to give precise answers all the time.  A timeout error is not necessarily the absence of the vulnerability which he is clear to point out.</p>
<p>@SoftmasterG: Yes. I&#8217;ve managed to extract my own passwords and session cookies from the memory dump giving me unauthenticated access to my own systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219520">

			<div class="comment by-random832 ">

				<p class="commentcredit">

					<span class="commenter">Random832</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219520">
						April 10, 2014 2:07 PM					</a>

				</p>

				<p>&#8220;In my opinion, the simplest and easiest reaction this mess is : Web services should hash passwords on the client side, and never &#8211; ever &#8211; send them in clear form.&#8221;</p>
<p>A client-side hash is a password equivalent unless you know what you&#8217;re doing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219521">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219521">
						April 10, 2014 2:12 PM					</a>

				</p>

				<p>@ Benni</p>
<p>&#8220;Retroshare has enough layers of security that the even the nsa will have to work really hard if they want to get in there.&#8221;</p>
<p>And it&#8217;s written in a risky language using shoddy libraries on platforms NSA has 0-days and automated attack systems for. I&#8217;m sure that this combination will be &#8220;really hard&#8221; for NSA to penetrate. 😉</p>
<p>QED</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219522">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219522">
						April 10, 2014 2:17 PM					</a>

				</p>

				<p>&lt;@ Clive Robinson (and Anura and all&#8230;)</p>
<p>Here&#8217;s a schematic &#8220;baby&#8221; approach for a way to authenticate and pay online using what I just called &#8220;onion hashes&#8221;:</p>
<p>Alice has a strong password (containing 256 true random bits), she uses that for all her online transactions.</p>
<p>She wants to buy things from Amazon with her VISA card.</p>
<p>Initially she shares the following with Amazon.com (SSL + DH):<br />
&#8211; auth-token-shared-with-amazon = SHA-256(&#8220;&lt;password&gt;;amazon.com&#8221;)<br />
&#8211; (her username(email) and address etc.)</p>
<p>And the following with VISA (how is TBD):<br />
&#8211; auth-token-shared-with-visa = SHA-256(&#8220;&lt;password&gt;;visa.com&#8221;)</p>
<p>To authenticate at Amazon, she presents the following:<br />
&#8211; auth-message = SHA-256(auth-token-shared-with-amazon +&#8221;;&lt;username&gt;;&lt;timestamp&gt;&#8221;) + &#8220;;&lt;username&gt;&#8221;</p>
<p>To pay for something, she presents the following:<br />
&#8211; payment-message = SHA-256(auth-token-shared-with-visa + &#8220;;&lt;amount-to-pay&gt;;&lt;card-number+exp+ccv&gt;;&lt;timestamp&gt;&#8221;) + &#8220;;amazon.com;&lt;amount-to-pay&gt;&#8221;</p>
<p>(Note that Amazon has to contact VISA in order to verify the validity of the payment message.)</p>
<p>IF (and that is the crucial if) this &#8220;onion hashing&#8221; really works in the sense that knowing any of one the hashes but not the secret password does not reveal any useful information about the other hashes or the password, then the following seems to be true:</p>
<ul>
<li>Amazon does not know your password, has no information about it</li>
<li>Anybody who discovers &#8220;auth-token-shared-with-amazon&#8221; (c.f. recent Adobe user DB leak) can use it to log in as you at Amazon, but it does not help in any way with logging in to other sites, even if the same secret password is used</li>
<li>Anybody who discovers an &#8220;auth-message&#8221; cannot use it to log in later on, an immediate second login within the same time window with the excact same &#8220;auth-message&#8221; has to be prevented by Amazon</li>
<li>Anybody who discovers a &#8220;payment-message&#8221; can do nothing with it, at the very most a replay of the same payment VISA to Amazon could be achieved if VISA/Amazon would not check for that</li>
<li>Amazon does not know your credit card number, expiry date, ccv, &#8230; (and hence loses also the burden of protecting that data &#8211; thus maybe a good incentive for corporations?)</li>
</ul>
<p>Now regarding the &#8220;crucial if&#8221;: Generally I would think that hash functions are built such that they are safe in this regard (different inputs even if only slightly different must yield totally different output), but then again attacks against hashes usually aim &#8211; I guess &#8211; mainly at finding collisions, not at finding out HASH(secret+known1) from HASH(HASH(secret+known1)+known2), but I am definitely not an expert at that.</p>
<p>So, how big are the chances that I just &#8220;invented the wheel&#8221;? 😉</p>
<p>(And even if so, the approach I just presented has of course still some practical issues like the long password (enter in web form or in browser or from a separate device which transmits already hashed messages to devices connected to the web, &#8230; ?) and details about formatting the messages to be defined, but maybe if the rest is sound, that might be worth the effort? Your call, of course&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219523">

			<div class="comment by-mikeacker ">

				<p class="commentcredit">

					<span class="commenter">mike~acker</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219523">
						April 10, 2014 2:29 PM					</a>

				</p>

				<p>this problem is a rank beginner&#8217;s error: you never allow user input to control your program.   you process the user&#8217;s request to the extent that it is with the specifications of the program.   that does not include over-running a wrong length record or going out of bounds on an array.</p>
<p>we may be at a tipping point in software quality control where product liaility will need to come under consideration.    if so it will be necessary to define who will be responsible for what part of the needed quality process</p>
<p>first off an o/s should not allow itself to be modified by the activity of an application program.    responsibility goes to the o/s oem</p>
<p>the o/s should not allow an app program to snoop on or modify the data belonging to another app.   responsibility goes to the o/s for implementing storage protection and to the chip makers for the storage protection circuitry</p>
<p>the o/s should not allow an app program to open read, execute from or write to dataset that the originating user does not have permission to use.    responsibility to the os/oem</p>
<p>application programs should be monitored and controlled where possible to assure they are operating as intended and that such activity is proper.</p>
<p>these are just ideas &#8212; meant to be trampled on.   hopefully something meaningful can derive from this mess we have experienced last few months.</p>
<p>remember: quality control is something you do not something you get.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219524">

			<div class="comment by-john-campbell ">

				<p class="commentcredit">

					<span class="commenter">John Campbell</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219524">
						April 10, 2014 2:32 PM					</a>

				</p>

				<p>A Blast from 12.5 years ago:</p>
<p><a href="http://www.systemtoolbox.com/bfarticle.php?content_id=61" rel="nofollow ugc">http://www.systemtoolbox.com/bfarticle.php?content_id=61</a></p>
<p>Yes, we need to maximize diversity in application systems that still work within communications &#8220;standards&#8221;&#8230;  how&#8217;s that for a conflict?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219525">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219525">
						April 10, 2014 2:43 PM					</a>

				</p>

				<p>@Nick_P</p>
<p>&#8220;And it&#8217;s written in a risky language using shoddy libraries on platforms NSA has 0-days and automated attack systems for. I&#8217;m sure that this combination will be &#8220;really hard&#8221; for NSA to penetrate. ;)&#8221;</p>
<p>Na,  for sharing with friends of friends, the connections are anonymized in Tor style.</p>
<p>NSA has written a slide called &#8220;Tor stinks&#8221;, saying &#8220;we will never be able to de anonymize all tor users&#8221;</p>
<p><a href="http://www.theguardian.com/world/interactive/2013/oct/04/tor-stinks-nsa-presentation-document" rel="nofollow ugc">http://www.theguardian.com/world/interactive/2013/oct/04/tor-stinks-nsa-presentation-document</a></p>
<p>when they say Tor stinks, then so does Retroshare, since both programs are using very similar mechanisms and techniques.</p>
<p>In fact, tor too, uses openssl:<br />
<a href="https://blog.torproject.org/category/tags/openssl" rel="nofollow ugc">https://blog.torproject.org/category/tags/openssl</a></p>
<p>and it seems that they have much more problems than retroshare because of this bug.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219526">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219526">
						April 10, 2014 2:43 PM					</a>

				</p>

				<p>The test site reports &#8220;All good&#8221; for me, most of the time. It only occasionally reports &#8220;is vulnerable&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219527">

			<div class="comment by-gp ">

				<p class="commentcredit">

					<span class="commenter">GP</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219527">
						April 10, 2014 2:55 PM					</a>

				</p>

				<p>Does anyone know why google hasn&#8217;t bothered to update their SSL cert?  It&#8217;s still dated March 12.  Have they known about/fixed the bug that long ago?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219528">

			<div class="comment by-david-in-toronto ">

				<p class="commentcredit">

					<span class="commenter">David in Toronto</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219528">
						April 10, 2014 2:59 PM					</a>

				</p>

				<p>@z</p>
<blockquote><p>1.) If you&#8217;re changing keys anyway, now is a great time to go with 2048 bit keys and finally rid the internet of 1024 bit keys</p></blockquote>
<p>Short version: In case you didn&#8217;t hear all 1024 bit certs are gone as of last December.</p>
<p>Longer version:<br />
A body that certifies CA&#8217;s, the certificate authority browser forum as I recall, read NISTs guidance on 1024 bit RSA and decided last February to mandate that they all a) not be renewed after 2013 and b) get revoked if they expire after 2013 because they are insecure.  Several CA&#8217;s got proactive and started revoking in October.  So they&#8217;re all gone by now.</p>
<p>Well almost.<br />
* They kind of missed that there are a lot of imbedded devices out there using 1024 bit certs that can&#8217;t be easily updated.  I&#8217;m not sure what happened there.  I am sure that some of these devices didn&#8217;t support CRLs or the newer replacement and are likely still operable.  And because I haven&#8217;t seen an industry melt down, I have to assume it either wasn&#8217;t an issue or there&#8217;s an exception list.<br />
* Also, they grandfathered a bunch of 1024 signing certs from prior to 2010.  These were the ones that were used to bootstrap the early 2048 certs into place.  I also find this hilarious because if all 1024 bit certs are insecure, then clearly revoking all the end points and not revoking the root signing certificates addresses the biggest risks.</p>
<p>I have real problems with how they went about this. Short time frames.  No visible public discussion. No consideration for impact. And an apparent double standard.  All rushed through because a perception. Very ad-hoc.</p>
<p>Yes, it should have been done but it was ham-handed and could have caused potential problems the way it was done. IMO they dodged a bullet that a bit more time and planning could have been a lot safer.</p>
<p>David</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219529">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219529">
						April 10, 2014 3:01 PM					</a>

				</p>

				<p>@GP<br />
Yeah given that NSA probably stole their cert for operation &#8220;Flying Pig&#8221;:</p>
<p><a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html</a></p>
<p>Where NSA fakes google servers,  they really should! update their cert asap.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219530">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219530">
						April 10, 2014 3:12 PM					</a>

				</p>

				<p>@Bruce Schneier<br />
&#8220;[&#8230;] if this turns out to be something like the Y2K bug &#8212; then we are going to face criticisms of crying wolf.&#8221;</p>
<p>I think that would not be a big problem.  Maybe an inconvenience.  I&#8217;m sure there would be more than enough voices explaining that the reason the sky didn&#8217;t fall is precisely <em>because of</em> the whoop-de-doo and mad scurrying around.</p>
<p>Too, DHS has been taking flak since&#8230; lemme see&#8230;ALWAYS &#8230; because NSA continues to spend eye-watering amounts of cash and cannot point to even one foiled terrorist attack, and yet their credibility is intact.  No, wait&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219531">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219531">
						April 10, 2014 3:17 PM					</a>

				</p>

				<p>Question: is heartbleed a ruse?</p>
<p>That is, perhaps NOBODY is getting any critical information from the 64K memory blocks, but somebody is poised to collect information on all of the new password change requests.  Spy agencies would be the best guess here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219532">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219532">
						April 10, 2014 3:19 PM					</a>

				</p>

				<p>@anonymous from switzerland</p>
<p>The extra hash doesn&#8217;t actually protect you from this type of attack, because that token can still be recovered (and it also has to be stored). As for the token:</p>
<p>SHA-256(&#8220;;amazon.com&#8221;)</p>
<p>If I recover Amazon&#8217;s password database, then I can guess passwords (dictionary attacks get pretty sophisticated). Without each password being uniquely hashed, I just have to run through my algorithm once to find all the matching passwords in the database. It also allows you to authenticate with Amazon without any effort whatsoever.</p>
<p>If instead I have a random salt, I have to run through my algorithm for each password until I find a match, and then I can move on to the next password. This significantly ups the time, however, but password entropy is low enough in general that it&#8217;s still pretty trivial to break most passwords in the database.</p>
<p>So you would have to use a slow hashing function on Amazon&#8217;s side, which is basically what we are doing now. Even if you do, a large chunk of the passwords will still be compromised since entropy is often close to non-existent, it just takes longer.</p>
<p>So what&#8217;s the solution? Well, the only way to protect your information is to not allow the server to have enough information to impersonate you in the first place. There is a way to do that, but from a usability point of view it&#8217;s pretty bad, and that is client certificates.</p>
<p>With an RSA client certificate, you essentially sign a unique message to verify your identity. This is great, because the only way to compromise you if you use a large enough key.</p>
<p>If we used Diffie-Hellman instead (and I&#8217;m not going to lookup how the TLS standard does it), then you combine your respective private and public keys to generate a shared secret; the problem with this is that if the server is compromised and you are using static keys, then anyone can reuse your shared secret to impersonate you. Note that the bigger problem in this case is that the server&#8217;s certificate has been compromised, so the shared secret itself is less of a big deal, and it&#8217;s fixed as soon as they renew their certificate.</p>
<p>Instead of using your static keys together to generate a shared secret, you can also use ephemeral keys. By generating two shared secret, one with the client&#8217;s ephemeral keypair and the server&#8217;s static keypair, and one with the server&#8217;s ephemeral keypair and the client&#8217;s static keypair, each shared secret is only used once. It&#8217;s still a problem if the server&#8217;s static key is compromised, but there&#8217;s not much you can do about that. However, it does provide perfect forward secrecy, as both one of the static private keys and one of the static ephemeral keys or the derived key has to be recovered to break the communications.</p>
<p>So again, the problem here is usability. However, that&#8217;s because a protocol doesn&#8217;t exist. Let&#8217;s say we had an extension to HTTP where the client can generate a static key for each host, sends them a certificate over an encrypted conenction (or even just a public key) and the server then signs that certificate (or just stores the public key alongside the account information). The client can then use that to authenticate, and then compromising the server won&#8217;t add any additional risk for the client (well, unless they use the attack to trick you into installing malware onto your computer) beyond the server losing its private key, which you can&#8217;t really mitigate anyway.</p>
<p>As for credit cards, I think they should be replaced with keypairs as well. As long as the merchant has enough information to charge your card without you present, it is a breach waiting to happen (in fact, it&#8217;s happening all the time).</p>
<p>Of course, now you have to exchange your private key with your various devices, which can be a usability problem for that as well. The likely solution will be to store your private keys on the cloud&#8230; Problem Solved!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219533">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219533">
						April 10, 2014 3:22 PM					</a>

				</p>

				<p>s/static ephemeral keys/ephemeral private keys</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219534">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219534">
						April 10, 2014 3:29 PM					</a>

				</p>

				<p>@Anura</p>
<p>Please note the initial (crucial) assumption:</p>
<blockquote><p>
  Alice has a strong password (containing 256 true random bits)
</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219535">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219535">
						April 10, 2014 3:38 PM					</a>

				</p>

				<p>@anonymous from switzerland</p>
<p>If you have that ability, and it&#8217;s a bad assumption to make, then you might as well have a random key for each website and store a hash of that on the server, avoiding complexity. Either way, if the memory is scraped you have to change your key with the compromised website. If you are using symmetric keys (passwords/passphrases or random keys in this case) they have to either store or receive enough informaton to authenticate you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219536">

			<div class="comment by-a-nonny-mouse ">

				<p class="commentcredit">

					<span class="commenter">A nonny Mouse</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219536">
						April 10, 2014 3:48 PM					</a>

				</p>

				<p>A lot of sites are saying &#8220;we&#8217;re not affected&#8221;, but what they really mean is their ssl server on 443 is unaffected. Its still likely that some of their back office tools are compromised. What if their vhost is fine, but its virtualized and the hypervisor is vulnerable, or they have some subsystem that can be compromised and gain access to the network. What if their upstream router, or firewall, or terminal server or their LOM management system is vulnerable? Or their inward facing systems? most attacks come from within and people are scrambling to give themselves a premature clean bill of health.<br />
I think this will get worse before it gets better.</p>
<p>Also much not commented on widely are the links between Codenomicon and Microsoft, namely their Chairman of the board Howard Schmidt, formerly microsoft&#8217;s chief security office. He should know about responsible disclosure proceedures right? yet that has been completely ignored.<br />
Feels very man behind the green curtain doesn&#8217;t it? same tired old dog from so many past battles, same tricks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219537">

			<div class="comment by-john-p ">

				<p class="commentcredit">

					<span class="commenter">John P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219537">
						April 10, 2014 4:10 PM					</a>

				</p>

				<p>@someoneElsewhere</p>
<p>Just built the latest version of mutt (1.5.23) from mac homebrew. It linked against openssl 1.0.1g, which is patched against CVE-2014-0160, per the NEWS file in the source directory.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219538">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219538">
						April 10, 2014 4:14 PM					</a>

				</p>

				<p>@A nonny Mouse</p>
<p>Everything upstream <i>is</i> vulnerable&#8230; Heartbleed or not, there are bound to be enough bugs (and at least one &#8216;feature&#8217; &#8211; CALEA) in network devices to facilitate the compromise of any downstream server. However, if these devices are not under control of the entity in question, it becomes &#8220;someone else&#8217;s problem&#8221;. This lack of capability/responsibility to do anything would make any litigation efforts totally worthless.</p>
<p>Though I will admit that embedded edge devices could prove quite the challenge for any providers lucky enough to be stuck with vulnerable proprietary hubs, routers, switches, etc&#8230;</p>
<p>Has anyone been compiling a list of networked appliances that come with a copy of OpenSSL 1.0.1?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219539">

			<div class="comment by-direct-hit-to-the-starship-bridge ">

				<p class="commentcredit">

					<span class="commenter">Direct hit to the Starship Bridge</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219539">
						April 10, 2014 5:14 PM					</a>

				</p>

				<p>Thanks much for the information on zologize, a telltale smartypants affectation of the Maryland Procurement Office. In systematic arbitrary use,</p>
<p><a href="https://www.eff.org/deeplinks/2014/04/wild-heart-were-intelligence-agencies-using-heartbleed-november-2013" rel="nofollow ugc">https://www.eff.org/deeplinks/2014/04/wild-heart-were-intelligence-agencies-using-heartbleed-november-2013</a></p>
<p>this is &#8220;une activité préjudiciable à la sécurité de l&#8217;Etat,&#8221; a type of illegal warfare cited in Geneva Convention IV. The term covers spying and sabotage, NSA&#8217;s two core missions. The NSA program is also a breach of the non-intervention principle, about which the ICJ ruled, &#8220;The principle of non-intervention is to be treated as a sanctified absolute rule of law,&#8221; and interestingly, depending, NSA&#8217;s indiscriminate sabotage of global communications infrastructure may constitute coercive interference or use of force:</p>
<p><a href="http://armscontrollaw.com/2012/10/09/did-stuxnet-breach-the-un-charters-principles/" rel="nofollow ugc">http://armscontrollaw.com/2012/10/09/did-stuxnet-breach-the-un-charters-principles/</a></p>
<p>In any case, NSA sabotage is a continuing internationally wrongful act giving rise to obligations including but not limited to reparation, that is, restitution, compensation and satisfaction, with interest.</p>
<p>This is what happens when you let 95-IQ military apes off the base.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219540">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219540">
						April 10, 2014 5:33 PM					</a>

				</p>

				<p>@Direct Hit:</p>
<p>Here is an old translated spiegel article from 1996,</p>
<p><a href="http://cryptome.org/jya/cryptoa2.htm" rel="nofollow ugc">http://cryptome.org/jya/cryptoa2.htm</a></p>
<p>telling how nsa and bnd together subverted crypto boxes. The nsa agent who helped subverting the boxes of crypto Ag used to formerly advice motorola. If you use crypto hardware from Motorola or Crypto Ag, this may interest you, but I merely link this because i think the following line fits so much here:</p>
<p>&#8220;In the industry everybody knows how such affairs will be dealed with,&#8221; said Polzer, a former colleague of Buehler. &#8220;Of course such devices protect against interception by unauthorized third parties, as stated in the prospectus. But the interesting question is: Who is the authorized fourth?&#8221;</p>
<p>Perhaps something similar is true with openssl.</p>
<p>In the Spiegel book &#8220;DER NSA COMPLEX&#8221; the journalists write that the nsa was given the following secret directive; &#8220;To own the internet&#8221;. Another directive says</p>
<p>&#8220;Any of our efforts must serve one goal: The information superiority of the world by America&#8221;.</p>
<p>Spiegel writes that the internet would be no longer free, if a state actor pursues and then even achives such goals.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219541">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219541">
						April 10, 2014 5:39 PM					</a>

				</p>

				<p>sorry, I translated it wrong:</p>
<p>&#8220;&#8221;Any of our efforts must serve one goal: The information superiority of the world by America&#8221;.&#8221;</p>
<p>Should read</p>
<p>&#8220;Any of our efforts must serve one goal: The information dominance of the world by America&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219542">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219542">
						April 10, 2014 5:43 PM					</a>

				</p>

				<p>Nah, still wrong,the sencence in the german spiegel book is &#8220;Informationelle Vorherrschaft von Amerika über die Welt&#8221;.</p>
<p>Google translates this as</p>
<p>&#8220;information supremacy of america over the world&#8221;</p>
<p>That a top secret directive of the nsa.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219543">

			<div class="comment by-direct-hit-to-the-starship-bridge ">

				<p class="commentcredit">

					<span class="commenter">Direct Hit to the Starship Bridge</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219543">
						April 10, 2014 6:03 PM					</a>

				</p>

				<p>benni, now that&#8217;s real journalism. They know where they&#8217;re going with their investigations. They&#8217;ve got NSA&#8217;s wrongful acts documented as attributable to the US government. And for NATO they&#8217;ve raised issues of complicity and joint and several liability under Articles 16 and 17 in (A/56/10) and corresponding case law.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219544">

			<div class="comment by-godel ">

				<p class="commentcredit">

					<span class="commenter">Godel</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219544">
						April 10, 2014 6:05 PM					</a>

				</p>

				<p>@ Paul<br />
&#8220;This might have been mentioned before but as I write this&#8230;<br />
LastPass&#8217; tool says Paypal is not fixed.&#8221;</p>
<p>Paypal said yesterday that they were never affected. Yahoo have fixed their stuff today, but password change is needed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219545">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219545">
						April 10, 2014 6:44 PM					</a>

				</p>

				<p>@Direct Hit:</p>
<p>In this comment<br />
<a href="https://www.schneier.com/blog/archives/2014/03/friday_squid_bl_420.html#c5240416" rel="nofollow ugc">https://www.schneier.com/blog/archives/2014/03/friday_squid_bl_420.html#c5240416</a></p>
<p>Ive written more on that spiegel book, showing that obama indeed has ordered the nsa to get ready for active internet attacks until 2012.</p>
<p>An old Spiegel article on the NSA is here:</p>
<p><a href="http://translate.google.de/translate?hl=de&#038;sl=de&#038;tl=en&#038;u=http%3A%2F%2Fwww.spiegel.de%2Fspiegel%2Fprint%2Fd-13494509.html&#038;sandbox=1" rel="nofollow ugc">http://translate.google.de/translate?hl=de&#038;sl=de&#038;tl=en&#038;u=http%3A%2F%2Fwww.spiegel.de%2Fspiegel%2Fprint%2Fd-13494509.html&#038;sandbox=1</a></p>
<p>showing that the nsa aimed to a full collection of 1/3 of all german phone calls in 1989.</p>
<p>and then we have these documents:</p>
<p>Showing the american government has founded an &#8220;advocacy centre&#8221;, where us companies can get direct first hand information from the nsa, for the purpose of &#8220;levelling the playing field&#8221; and better positions in &#8220;the bidding arena&#8221;. Spiegel writes by the way, that on their attack on Huawei, NSA was assisted by the trade ministry, by the way:</p>
<p><a href="http://www.heise.de/tp/artikel/7/7743/1.html" rel="nofollow ugc">http://www.heise.de/tp/artikel/7/7743/1.html</a><br />
<a href="http://www.heise.de/tp/artikel/7/7744/1.html" rel="nofollow ugc">http://www.heise.de/tp/artikel/7/7744/1.html</a><br />
<a href="http://www.heise.de/tp/artikel/7/7749/1.html" rel="nofollow ugc">http://www.heise.de/tp/artikel/7/7749/1.html</a><br />
<a href="http://www.heise.de/tp/artikel/7/7747/1.html" rel="nofollow ugc">http://www.heise.de/tp/artikel/7/7747/1.html</a></p>
<p><a href="http://www.heise.de/tp/artikel/7/7752/1.html" rel="nofollow ugc">http://www.heise.de/tp/artikel/7/7752/1.html</a></p>
<p>For example, in the last link above, we can read with the appropriate citing reference, of course, that &#8220;By July 1994, CIA director Woolsey was asserting that &#8220;several billion dollars a year in contracts are saved for American business by our conducting that type of intelligence collection.</p>
<p>We intend to continue to do it. It is relatively new. We are very &#8211; frankly &#8211; very good at it, and we have had some very positive effects on contracts for American businesses.&#8221;&#8221;</p>
<p>In the spiegel book basically the following is revealed:</p>
<p>After the attacks of 9/11, the budget of NSA increased dramatically.<br />
Before 9/11 Michael Hayden had blocked a plan for snooping on phone calls, out of juristical problems. After 9/11, Bush ordered him to break the law.<br />
And from then, the nse programs expanded.</p>
<p>But, anti terror operations only made up 30% of the goals that the nsa has.<br />
The problem is, that the sigint priority list did not change very much by the 9/11 attacks.</p>
<p>So in some sense we are seeing here something like we did with the Iraq war. There, the 9/11 attack and arguments with weapons of mass destruction wer used to attack a country, mainly for oil.</p>
<p>And in the nsa affair, we have a massive increase of intelligence budget and activities, but the goals of the nsa are not mainly concerned with terrorists, but they remained the same as before,</p>
<p>This here contains an excerpt:<br />
<a href="http://www.spiegel.de/international/world/secret-nsa-documents-show-how-the-us-spies-on-europe-and-the-un-a-918625.html" rel="nofollow ugc">http://www.spiegel.de/international/world/secret-nsa-documents-show-how-the-us-spies-on-europe-and-the-un-a-918625.html</a></p>
<p>The Americans recently drew up a secret chart that maps out what aspects of which countries require intelligence. The 12-page overview, created in April, has a scale of priorities ranging from red &#8220;1&#8221; (highest degree of interest) to blue &#8220;5&#8221; (low interest).</p>
<p>Countries like Iran, North Korea, China and Russia are colored primarily red, meaning that additional information is required on virtually all fronts.</p>
<p>But the UN and the EU are also listed as espionage targets, with issues of economic stability as the primary concern.</p>
<p>The focus, though, is also on trade policy and foreign policy (each rated &#8220;3&#8221;) as well as energy security, food products and technological innovations (each rated &#8220;5&#8221;).</p>
<p>Yea well, the nsa has a priority to spy on new technologies developed by europeans! And since 9/11 the nsa has much more money for this.</p>
<p>The programmer of the ssl bug now writes on Spiegel that it was just a mistake:<br />
<a href="http://www.spiegel.de/netzwelt/web/heartbleed-programmierer-deutscher-schrieb-den-fehlerhaften-code-a-963774.html" rel="nofollow ugc">http://www.spiegel.de/netzwelt/web/heartbleed-programmierer-deutscher-schrieb-den-fehlerhaften-code-a-963774.html</a></p>
<p>Well it does not matter. The NSA also welcomes mistakes and does not hesitate to use them if they find one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219546">

			<div class="comment by-ianm ">

				<p class="commentcredit">

					<span class="commenter">IanM</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219546">
						April 10, 2014 7:59 PM					</a>

				</p>

				<p>analysis of openssl freelist reuse</p>
<p><a href="http://www.tedunangst.com/flak/post/analysis-of-openssl-freelist-reuse" rel="nofollow ugc">http://www.tedunangst.com/flak/post/analysis-of-openssl-freelist-reuse</a></p>
<p>Interesting analysis of a bug reported 4 years earlier but not fixed by the OpenSSL folks&#8230;&#8230;&#8230;&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219547">

			<div class="comment by-direct-hit-to-lt-uhuru ">

				<p class="commentcredit">

					<span class="commenter">Direct Hit to Lt. Uhuru</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219547">
						April 10, 2014 8:47 PM					</a>

				</p>

				<p>NSA not only welcomes mistakes, they make them worth your while. Ask Eric Rescorla.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219548">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219548">
						April 10, 2014 9:45 PM					</a>

				</p>

				<p>This is the best article I have seen for explaining Heartbleed to non-experts.</p>
<p><a href="http://www.newyorker.com/online/blogs/elements/2014/04/the-internets-telltale-heartbleed.html" rel="nofollow ugc">http://www.newyorker.com/online/blogs/elements/2014/04/the-internets-telltale-heartbleed.html</a></p>
<p>A little off topic, but articles like this are hard to do. It&#8217;s not easy to simplify complicated technical subjects without losing the details that matter. Usually, the really detailed technical articles are incomprehensible to most people,  and  mainstream publications give a vague, hand-wavy gloss over that fails to explain anything beyond &#8220;change your passwords&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219549">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219549">
						April 10, 2014 9:50 PM					</a>

				</p>

				<p>@ Benni</p>
<p>Thanks for the NSA slide. It&#8217;s good to know they were still having trouble in 2012. I&#8217;d like to have more data on what they can do. Right now, we only have that slide set and posts like <a href="http://blog.erratasec.com/2013/08/anonymity-smackdown-nsa-vs-tor.html#.U0dN_1RdUYo" rel="nofollow ugc">this</a>. The part that jumps out most is Runa (worked on tor) says: &#8220;Global dragnet surveillance was never part of the threat model&#8230;&#8221; And that&#8217;s what NSA is building. Hence, the protocol will only get weaker over time barring major breakthroughs in anonymity tech.</p>
<p>Someone also posted here a while back a discussion about a certain weakness and a mailing list conversation. In short, the Tor person said the system would be broken against an adversary who could see about all network traffic. Similar to what Runa said. However, these problems just mean Tor isn&#8217;t perfect against a global TLA and that it&#8217;s clearly still an obstacle to them. If anything, it justifies it&#8217;s use for private web traffic as anything hard for NSA is probably <em>really</em> hard for everyone else. Just know that there&#8217;s always a risk re NSA and low tech tradecraft is still the safest if it&#8217;s something they&#8217;d <em>really</em> get you for. And there&#8217;s more ways than ever of encoding/hiding data in ordinary objects mailed to or dropped off at uninteresting places. 😉</p>
<p><b>Just got an idea&#8230;</b></p>
<p>Remember the map about their exploitation systems? We also have maps of Internet backbone and geographical lists of Tor nodes. There might be a security benefit to creating a whitelist of nodes that mostly in areas they have minimal coverage of. (Or at least did at time of presentation.) That would create gaps in what they see. Then, the threat model goes from global dragnet surveillance to a dragnet surveillance in certain spots. Might help on top of the security Tor already provides.</p>
<p>The other aspect is browsers and apps. Most successful attacks NSA does that I&#8217;m aware of are endpoint attacks. They use them to strip Tor&#8217;s privacy away. The more effort that can be put into containing attacks on them, the better. Efforts to port browsers such as Quark and OP2 to Tor, with necessary improvements, could go a long way. More modifications to common protocols &amp; network apps to reduce leaks as well. One shortcut, already done by hobbyists, is a hardened device that does nothing but shove all traffic through Tor. I say it needs to go a step further and be a ground-up secure router with a Tor proxy built into it. One of the various clean slate secure hardware-software architectures would be ideal for this.</p>
<p>Back to Retroshare.</p>
<p>&#8220;when they say Tor stinks, then so does Retroshare, since both programs are using very similar mechanisms and techniques.&#8221;</p>
<p>All the points in favor of Tor do <em>not</em> apply to them unless they use Tor itself. (Idk there.) This is true for about any security claim or evaluation as it has built in assumptions, design, implementation, etc that collectively make the claim true or false. Tor is designed/coded by experts working full-time, enhanced/supported by many others, and constantly reviewed by amateurs and pro&#8217;s alike for vulnerabilities. That&#8217;s why it&#8217;s giving NSA headaches. If Retroshare reuses their codebase, then maybe about the same. Otherwise, they&#8217;re doing A Good Thing by obfuscating their traffic &amp; aiming for privacy throughout, but with unknown level of security until it&#8217;s thoroughly reviewed by experts.</p>
<p>And if NSA goes after it, they&#8217;re certainly going to use experts. Many crypto and anonymity schemes were broken easily once qualified people looked at them. And anonymity is <em>much</em> harder to do right than regular encryption. The program, as I pointed out, also uses the kind of platforms and code that we have precedents of NSA subverting. If it&#8217;s safe right now, it&#8217;s probably just because most people don&#8217;t use it. (see Mac OS X) However, if NSA isn&#8217;t in your threat model, then it might be a decent alternative to similar programs as it&#8217;s always better to choose those that put effort into security/privacy over those that don&#8217;t. The less opponents can vacuum up, the better. That much we agree on for sure.</p>
<p>&#8220;and it seems that they have much more problems than retroshare because of this bug.&#8221;</p>
<p>Wouldn&#8217;t surprise me. They&#8217;re also the group that used 1,024-bit ephemeral keys against organizations that spend millions on custom key-cracking machines. (rolls eyes) Nothing shocks me in INFOSEC anymore&#8230; Well, maybe if they ported it to DOS. (Googles.) Ok, no DOS version. World is still sane. Kind of.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219550">

			<div class="comment by-marc ">

				<p class="commentcredit">

					<span class="commenter">Marc</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219550">
						April 10, 2014 11:09 PM					</a>

				</p>

				<p>This is an <em>accident</em>. Just look at the sloppy code. This is a prototypical malloc/memcpy bug. You make an assumption about size and that assumption is going to bite a huge chunk of meat off of your ass because <b>data</b> is not quite of <b>size</b>. If size is too small you just broke your software. If size is too big you just memcpy&#8217;ed your CC number to me. In this probably literally. Thank you. I&#8217;ll buy something useful.</p>
<p>The thing is that this is so trivial that everyone looking at the code with really little insight into it should have found it. This piece of code is trivial compared to the package we are talking about. All you really need to know to have a bug screaming in your face is that <em>payload</em> is actually payload_size and that payload_size is network provided value that obviously <b>needs to be checked</b>. The RFC states MUST BE CHECKED. The co-author of the RFC is the guy who coded this.</p>
<p>If this would be deliberately someone has gone a great length to make it obvious.</p>
<p>The problem, and that&#8217;s a problem with open source in general, is that we just <b>assume</b> someone has checked the code whereas in reality NO ONE has. Just because we CAN doesn&#8217;t mean we DO. I for sure didn&#8217;t. You probably didn&#8217;t either. So why do we both assume someone else did? I did. You probably did as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219551">

			<div class="comment by-john-doe ">

				<p class="commentcredit">

					<span class="commenter">John Doe</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219551">
						April 11, 2014 12:07 AM					</a>

				</p>

				<p>Keep It Simple SSL, lot of useless &#8220;QOS&#8221; features&#8230;<br />
This and sending raw commands to a server drive me insane.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219552">

			<div class="comment by-michael ">

				<p class="commentcredit">

					<span class="commenter">Michael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219552">
						April 11, 2014 12:07 AM					</a>

				</p>

				<p>It&#8217;s time that we stop pretending the C language is a reasonable one for writing secure software. It&#8217;s the equivalent of building skyscrapers out of Legos; regardless how how skilled the builders are, the result is a brittle toy. Sure, bounds-checking has a cost. But in a world where commerce almost universally occurs on top of code, bounds checking is orders of magnitude less costly than the alternative: inherently insecure transactions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219553">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219553">
						April 11, 2014 12:08 AM					</a>

				</p>

				<p>@Anura<br />
<em>&#8220;If you have that ability, and it&#8217;s a bad assumption to make, then you might as well have a random key for each website and store a hash of that on the server, avoiding complexity. Either way, if the memory is scraped you have to change your key with the compromised website. If you are using symmetric keys (passwords/passphrases or random keys in this case) they have to either store or receive enough informaton to authenticate you.&#8221;</em></p>
<p>I disagree that what I proposed increases complexity compared to known methods with comparable features. From the user perspective it is very simple to get &#8211; you have a single (albeit long) secret and you do not have to manage <em>anything</em> besides that. No useful information about your password or your credit card is stored at all the sites that you visit to buy things. And you remain free to chose different identities at different sites.</p>
<p>Is this more complex than PKI / SSL with client auth or than, say, SAML or OpenID etc.? I don&#8217;t think so, at least not necessarily. What makes it more complex initially is of course to specify it and to implement it. And it may be too small of a step to come after SSL+username/password. (And it may not be as secure as advertised, of course.)</p>
<p>How naive of me to post something like that here and at this specific time and to expect somebody to really take some time to consider it and how stupid to invest this kind of energy with a (so far mild) flu. So, I will definitely leave it at &#8220;Your call, of course&#8230;&#8221; for everybody, been in way to many &#8220;asymmetric wars&#8221; in online forums in the past.</p>
<p>Waer nod wott haett ghah 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219554">

			<div class="comment by-jen ">

				<p class="commentcredit">

					<span class="commenter">Jen</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219554">
						April 11, 2014 12:20 AM					</a>

				</p>

				<p>All of this is talk about the NSA is ridiculous.  If the NSA wants your data the NSA will get your data. If the NSA can&#8217;t get your data electronically, the NSA will figure out a way to get it anyway.  Offices robbed in the middle of the night?  Security alarms didn&#8217;t work, cameras were off, seriously people, if the NSA wants something they are going to get it, isn&#8217;t that hard to do in a low tech way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219555">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219555">
						April 11, 2014 12:53 AM					</a>

				</p>

				<p>This reminds me of Bruce&#8217;s post about inserting backdoors</p>
<p><a href="https://www.schneier.com/blog/archives/2013/10/defending_again_1.html" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/10/defending_again_1.html</a></p>
<p>Low discoverability, high deniability, minimal conspiracy</p>
<p>All it took was one guy to mess up the code just a little bit and it took 2 years to discover! Granted, since nobody expects FOSS to have backdoors hidden in it, people perhaps weren&#8217;t looking as hard as they should (which needs to change), but seriously, 2 years! And it&#8217;s all so simple. A perfect backdoor&#8230;</p>
<p>@Jen</p>
<p>Low tech ways won&#8217;t get you into a lot of foreign countries and highly secure (physically) server farms run by Google and Microsoft.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219556">

			<div class="comment by-l ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.fenrirproject.org' rel='external nofollow ugc' class='url'>L</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219556">
						April 11, 2014 2:21 AM					</a>

				</p>

				<p>@anonymous from switzerland:</p>
<p>I like token-based auth algorithms, I do not like your timestamps, as they introduce time-window management, usually require accurate clock synchronization, and you have to store everything to avoid replay attacks.</p>
<p>The real problem is: who manages those tokens? You need a program that manages all tokens, and I wouldn&#8217;t integrate that into a browser (way too big attack surface), so you now also need some way for your browser and the program to share tokens. Except that by your protocol a compromised browser can easily ask the id token for visa and make random payments. This is because you put together the authentication to a system and the authorization to payments.</p>
<p>Also, your payment doesn&#8217;t protect the receiver, so a malicious website could charge multiple times while billing to multiples destination.</p>
<p>In short, I believe the idea of using tokens to authenticate is correct, but not much else.</p>
<p>I&#8217;m also working on a token-based authentication algorithm that includes encryption and key-exchange (so it&#8217;s not based on SSL, although the key exchange is very similar). I&#8217;m done with the formal definition and analysis, I&#8217;m now implementing it all, should be finished by the end of the year.</p>
<p>If you are interested in token exchange protocols I suggest the old but always good &#8220;applied cryptography&#8221; from our Bruce Schneier, you&#8217;ll learn a lot and also why your assumptions do not hold up.</p>
<p>Bye,<br />
L</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219557">

			<div class="comment by-zakharias ">

				<p class="commentcredit">

					<span class="commenter">Zakharias</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219557">
						April 11, 2014 3:02 AM					</a>

				</p>

				<ol>
<li>
<p>And again a vulnerability was introduced by &#8211; applause &#8211; the ietf-standards. This game gets boring.</p>
</li>
<li>
<p>There was twitter and facebook communication analysed by experts. Why not analyse the connections in the ietf-standards and the mailinglists? Who collaborated with whom on standards; where do they wortk now? Who introduced vulns in mails, who gave Pro or Con on the proposals?<br />
E.g. Eric Rescorla collaborated on &#8216;Extended Random Values for TLS&#8217; and now is responsible for TLS in Mozilla. Again TLS.</p>
</li>
<li>
<p>Putting my aluhat on, I can&#8217;t see any use in transmission of random, unnecessary and unwanted data of variable length. Could this be planned as a future sublime communication channel for malware?</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219558">

			<div class="comment by-roy-b ">

				<p class="commentcredit">

					<span class="commenter">Roy B</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219558">
						April 11, 2014 4:01 AM					</a>

				</p>

				<p>As for Y2K, it still amazes me that it failed so miserably marketing-wise. Consider: &#8220;We spent millions of man-hours, billions of dollars, to fix Y2K-bugs, and what happened? Nothing! What a waste!&#8221; How hard could it be to explain that this was a true success?</p>
<p>It oughtn&#8217;t be too hard to explain the apocalypticness of this one, even if it should turn out we&#8217;ve been lucky.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219559">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219559">
						April 11, 2014 4:32 AM					</a>

				</p>

				<p>@L</p>
<p><em>&#8220;I like token-based auth algorithms, I do not like your timestamps, as they introduce time-window management, usually require accurate clock synchronization, and you have to store everything to avoid replay attacks.&#8221;</em></p>
<p>Authentication: You have to store authentication tokens on the server during the time-window in which they are accepted to prevent replay, yes. Not ideal. Then again, I see no simple alternative and this seems managable.</p>
<p>Payments: VISA has to store payment tokens on their server during the time-window in which they are accepted to prevent double payments. I see no problem at all with that. Their core business. (With payments that are e.g. only made once an item is shipped, things get more complicated but how exactly to deal with that would be a matter between Amazon and VISA, of no immediate concern to the buyer.)</p>
<p>Clock sync: I think clock sync within two hours could be made mandatory these days, resp. it would be up to Amazon resp. VISA which differences in time to accept &#8211; during that time window they have to prevent replays.</p>
<p>Overall, I see no show-stopper here.</p>
<p><em>&#8220;The real problem is: who manages those tokens? You need a program that manages all tokens, and I wouldn&#8217;t integrate that into a browser (way too big attack surface), so you now also need some way for your browser and the program to share tokens. Except that by your protocol a compromised browser can easily ask the id token for visa and make random payments. This is because you put together the authentication to a system and the authorization to payments.&#8221;</em></p>
<p>Token management: The user/client does not have to manage tokens! Only the password has to be managed/protected. All tokens can be generated when needed on the client side.</p>
<p>Password entry in web form: That is bad, any malicious site that gets you to enter the password and posts the password to itself (instead of calculating just the needed token), gets access to all your accounts and can make any payments with VISA.</p>
<p>Stronger forms of password entry / token generation:<br />
&#8211; Password entry in a special dialog that the browser presents, the browser calcuates the respective token<br />
&#8211; Password entry in a special dialog that the host OS presents, the OS calcuates the respective token<br />
&#8211; Tokens calculated on a separate hardware that protects the password</p>
<p>To me that is likely the killer. Without a separate hardware, I would not trust such a system enough in the sense that it would at most be too small a step after SSL+username/password. And with separate hardware, there are lots of contenders.</p>
<p><em>&#8220;Also, your payment doesn&#8217;t protect the receiver, so a malicious website could charge multiple times while billing to multiples destination.&#8221;</em></p>
<p>Huh? As long as the malicious website does not have the password, they can at most try their luck with replaying a previous payment. Or how would your attack look like?</p>
<p>Overall, I (humbly 😉 think that my idea has some interesting (maybe even original) properties that might come in handy some other time for some other purpose for someone somewhere&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219560">

			<div class="comment by-radu ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.hostmama.ro' rel='external nofollow ugc' class='url'>Radu</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219560">
						April 11, 2014 4:48 AM					</a>

				</p>

				<p>I check <a href="http://www.hostmama.ro" rel="nofollow ugc">http://www.hostmama.ro</a> and sometimes seems to be ok, sometimes no !</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219561">

			<div class="comment by-andromeda ">

				<p class="commentcredit">

					<span class="commenter">andromeda</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219561">
						April 11, 2014 5:28 AM					</a>

				</p>

				<p>I am wondering what google is doing with their chrome browser. Considering CRL checks are disabled per in chrome per default and their own method (using CRLsets) is likely not as fast as OCSP or CRL&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219562">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">Jon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219562">
						April 11, 2014 5:46 AM					</a>

				</p>

				<p>It sees still unclear to me as to under which circumstances the private keys (or parts thereof) can be seen through exploitation of the heartbleed vulnerability.</p>
<p>I&#8217;d like comments on the following analysis. I welcome comments as to which parts I might be failing in the analysis:</p>
<ul>
<li>As I understand it, the bug is limited to revealing up to 64 KB of memory accessible <em>to the process</em> running openssl, and limited to memory which <em>were available for writing</em> at the time of exploitation.  If so, static content is not exposed.</li>
<li>Since private keys probably are read in elevated/privileged mode of the process, whereas it during normal operation should run with limited privileges, this part of memory will not be freed during normal use of the program. The private key is needed each time a new ssl session should be initiated, and should not be freed.</li>
<li>The private keys will thus only be exploitable by heartbleed if the private keys also are copied to new temporary locations in memory. Under which circumstances is this the case?</li>
</ul>
<p>Though private keys might not be as exposed as originally assumed, user credentials, session cookies and user passwords etc still typically allocated to dynamic memory, and thus theoretically exploitable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219563">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219563">
						April 11, 2014 5:56 AM					</a>

				</p>

				<p>&#8220;It&#8217;s worth noting that the commit was merged on new years eve, at 11pm. This is a strange time to be merging code, unless you are attempting to avoid scrutiny.&#8221;</p>
<p>Reminds me that the NSA was founded Nov 4th, 1952 &#8211; U.S. Presidential Election Day, very arguably for the same reason.</p>
<p>Makes one suspect that security related open source projects are heavily infiltrated with spies/saboteurs, even in the apparently unlikely case where heartbleed would not be an example of that (a weakness with plausible deniability and who&#8217;s expoitation by others can be monitored by the ones who might have introduced it, or the other way round).</p>
<p>C is really bad at preventing that &#8211; implementing a back door with plausible denyability that can bleed a private key is already much harder with any language that nominally prevents random memory access.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219564">

			<div class="comment by-l ">

				<p class="commentcredit">

					<span class="commenter">L</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219564">
						April 11, 2014 6:00 AM					</a>

				</p>

				<p>Bruce, I&#8217;m running firefox with the Calomel SSL validation plugin, it gives me a 23% score for this website, and that&#8217;s pretty low&#8230;</p>
<p>there&#8217;s no PFS, still using RC4&#8230;</p>
<p>In NGINX I&#8217;m using these settings:<br />
ssl_protocols           SSLv3 TLSv1 TLSv1.1 TLSv1.2;<br />
ssl_ciphers     ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:!MD5:!aNULL:!eNULL:!DES:!EDH:!EXPORT56:!EXPORT40:!SSLV2:!ADH:!LOW;<br />
ssl_prefer_server_ciphers on;<br />
ssl_session_cache  builtin:1000  shared:SSL:10m;</p>
<p>This should support PFS, uses elliptic curves, protected against BEAST attacks&#8230;</p>
<p>tested with:<br />
<a href="https://www.ssllabs.com/ssltest/‎" rel="nofollow ugc">https://www.ssllabs.com/ssltest/‎</a></p>
<p>The website also gives a compatibility list for various browsers and devices.</p>
<p>my list misses the compatibility with a couple of devices, does anyone have a better one?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219565">

			<div class="comment by-jerry ">

				<p class="commentcredit">

					<span class="commenter">Jerry</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219565">
						April 11, 2014 6:38 AM					</a>

				</p>

				<p>So &#8230; assuming that I am a reasonably smart guy who tries to do the right thing, but is not capable of writing his own crypto library&#8230; what are the lessons that I can take from this?</p>
<p>I can think of some possibilities, but I don&#8217;t know if any of them are good ideas:</p>
<p>1) use the oldest maintained branch that has the features you need, instead of the newest maintained branch?</p>
<p>2) look at all of the possible build flags and try to remove any features that I don&#8217;t know what they do and figure I probably don&#8217;t need them?<br />
(e.g. look at all of the ./configure &#8211;without-foo flags and use all of the ones that I don&#8217;t know what they mean and figure I probably don&#8217;t need them? (Was there a ./configure &#8211;without-heartbeat, or just the -DOPENSSL_NO_HEARTBEATS?))<br />
(Oh right, and openssl doesn&#8217;t use ./configure anyway, it has its own &#8220;./config&#8221; &#8230; what is the deal with that, anyway?)</p>
<p>3) is there another compatible crypto library out there that is interested in developing safe code instead of new features? maybe one that uses some unit tests, you know, things like that?</p>
<p>Thanks for any advice.<br />
Jerry</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219566">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219566">
						April 11, 2014 6:40 AM					</a>

				</p>

				<p>For those a little more interested in &#8220;the blood and guts&#8221; of &#8220;heartbleed&#8221;,</p>
<p><a href="http://blog.cryptographyengineering.com/2014/04/attack-of-week-openssl-heartbleed.html" rel="nofollow ugc">http://blog.cryptographyengineering.com/2014/04/attack-of-week-openssl-heartbleed.html</a></p>
<p>A simple line of code to put in a bounds check would solve this particular problem.</p>
<p>However I will reiterate my point about calloc and malloc,</p>
<p>Neither malloc or free zeroise memory in the majority of versions this has significant security implications.</p>
<p>So when you create a block of memory with malloc it contains what was previously put in it by the process, which means the only time it is full of zeros by default is when the memory is &#8220;virgin&#8221; from the OS putting it into the process heap with the system call brk().</p>
<p>If however you use calloc it should fill it with zeros before returning the pointer to you (however check some idiot has not made it &#8220;more efficient&#8221; and removed the zeroing). But whilst that might prevent problems from that point onwards it won&#8217;t stop problems prior to this.</p>
<p>That is &#8220;any process&#8221; with sufficient ability to see memory of it&#8217;s choice will be able to read the contents of the memory prior to the zeroisation. By &#8220;any process&#8221; I&#8217;m not talking about just OS related processes but such things as DMA and Memory Freezing and covert channles as well (which might or might not depending on your definition of &#8220;memory scraping&#8221; fall into your mental threat model).</p>
<p>Thus the use of calloc can only be regarded as a partial solution that does not close some security vulnerabilities.</p>
<p>Which with a little thought should mean that you realise that you need to zeroise memory obtained by calloc/malloc prior to calling free. And that shows where K&amp;R should have thought a little further and made a &#8220;clear on free&#8221; call as well as free.</p>
<p>But even then a &#8220;cree()&#8221; call can only be regarded as a partial solution that whilst closing quite a few more vulnerabilities than calloc does not close as many as might be considered prudent.</p>
<p>You still have to consider that some security requirments &#8211;such as PrivKey protection&#8211; need extra precautions which have been discussed on this blog before.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219567">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219567">
						April 11, 2014 7:43 AM					</a>

				</p>

				<p>@ Chris Abbot, Jen,</p>
<ul><i>Low tech ways won&#8217;t get you into a lot of foreign countries and highly secure (physically) server farms run by Google and Microsoft.</i></ul>
<p>You might want to read this before saying that again 😉</p>
<p><a href="http://blog.detectify.com/post/82370846588/how-we-got-read-access-on-googles-production-servers" rel="nofollow ugc">http://blog.detectify.com/post/82370846588/how-we-got-read-access-on-googles-production-servers</a></p>
<p>It looks fairly &#8220;low tech&#8221; to me.</p>
<p>Any way Google were kind enough to pay for their next halfway around the worl holiday&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219568">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter">Craig</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219568">
						April 11, 2014 7:46 AM					</a>

				</p>

				<p>@Bruce:  Money magazine took your comment above about low-margin embedded systems and applied it directly to Cisco and Juniper equipment that may be vulnerable.  Is this a valid use of your quote?  I just began looking at this aspect, but the article looks like it&#8217;s talking about enterprise-class equipment.</p>
<p><a href="http://money.msn.com/top-stocks/post--heartbleed-bug-spreads-to-routers-and-other-gear" rel="nofollow ugc">http://money.msn.com/top-stocks/post&#8211;heartbleed-bug-spreads-to-routers-and-other-gear</a></p>
<p>Thanks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219569">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219569">
						April 11, 2014 8:00 AM					</a>

				</p>

				<p>More from xkcd: <a href="https://xkcd.com/1354/" rel="nofollow ugc">How the Heartbleed Bug Works</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219570">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219570">
						April 11, 2014 8:16 AM					</a>

				</p>

				<p>@ Jon,</p>
<p>The answer to your questions is in many cases, &#8220;implementation speciffic&#8221;.</p>
<p>However at the very least people should as a general precaution zeroise any memory as soon as it is finished with or if it needs to be kept in memory consider zerroing it and then reloading it to the same place.</p>
<p>Alternativly &#8211;and where security is important&#8211; use some method of in memory encryption where the &#8220;encryption keys&#8221; are kept out of normal memory spaces &#8211;ie user/kernal RAM hard drives etc&#8211; which is unfortunatly very implementation specific as it often requires additional specialized hardware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219571">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter">JJ</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219571">
						April 11, 2014 9:06 AM					</a>

				</p>

				<p>I asked this earlier but this thread is getting really long, so I am posting it again:</p>
<p>What is the risk of having an unpatched version of OpenSSL on your router (e.g. DD-WRT or Tomato)? Any SSL traffic from connected computers is just passively routed through, right? Or is the OpenSSL implementation on the router involved in regular SSL traffic from connected computers as well?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219572">

			<div class="comment by-wayne-conrad ">

				<p class="commentcredit">

					<span class="commenter">Wayne Conrad</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219572">
						April 11, 2014 9:12 AM					</a>

				</p>

				<p>@JJ If a device having the heartbleed bug has an embedded web server for managing the device, then heartbleed could be used to gain administrative credentials to the device.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219573">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter">JJ</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219573">
						April 11, 2014 9:13 AM					</a>

				</p>

				<p>One more thing: there is a new relevant XKCD: <a href="http://xkcd.com/1354/" rel="nofollow ugc">http://xkcd.com/1354/</a><br />
(Probably the most non-expert friendly explanation out there).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219574">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219574">
						April 11, 2014 9:43 AM					</a>

				</p>

				<p>@Nick_P</p>
<p>&#8220;That&#8217;s why it&#8217;s giving NSA headaches. If Retroshare reuses their codebase, then maybe about the same. Otherwise, they&#8217;re doing A Good Thing by obfuscating their traffic &amp; aiming for privacy throughout, but with unknown level of security until it&#8217;s thoroughly reviewed by experts.&#8221;</p>
<p>1)By the way, you can now download an updated version of retroshare:<br />
<a href="http://retroshare.sourceforge.net/" rel="nofollow ugc">http://retroshare.sourceforge.net/</a></p>
<p>2) Retroshare is open souce too. Here is a more detailed security description of retroshare:</p>
<p><a href="https://retroshareteam.wordpress.com/2012/12/28/cryptography-and-security-in-retroshare/" rel="nofollow ugc">https://retroshareteam.wordpress.com/2012/12/28/cryptography-and-security-in-retroshare/</a></p>
<p>&#8220;There’s one major difference between RS and TOR: With the later, you being an exit node make you transfer packets in the clear from the internet (to anonymous clients). So websites acting as bait can catch you as an exit node. With Retroshare, if you can trust your friends, you can’t be spied because all the traffic passes through them, and no one else.&#8221;</p>
<p>Adding a friend to retroshare means you must communicate your public pgp key to him via ordinary e-mail or otherwise. you can not simply add people to your retroshare network that you do not know from within the retroshare application.</p>
<p>Since you are likely to add thrusted peers to retroshare, retroshare does not have the exit node weakness of tor.</p>
<p>And in addition to that, the indirect communications, that is, all data transfer between friends of friends, is routet anonymously with a codebase that is quite similar to tor.</p>
<p>Please note also that even with a retroshare version being vulnerable by the heartbleed bug, nsa would not be able to decrypt anything, since the key for doing that is additionally encrypted.</p>
<p>On the contrary, in tor, we have the following situation:</p>
<p><a href="https://blog.torproject.org/blog/openssl-bug-cve-2014-0160" rel="nofollow ugc">https://blog.torproject.org/blog/openssl-bug-cve-2014-0160</a></p>
<p>&#8220;Relays and bridges: Tor relays and bridges could maybe be made to leak their medium-term onion keys (rotated once a week), or their long-term relay identity keys. An attacker who has your relay identity key can publish a new relay descriptor indicating that you&#8217;re at a new location (not a particularly useful attack). An attacker who has your relay identity key, has your onion key, and can intercept traffic flows to your IP address can impersonate your relay&#8221;</p>
<p>As a result, this is what retroshare users usually say on tor:</p>
<p><a href="https://www.google.de/#q=retroshar+etor" rel="nofollow ugc">https://www.google.de/#q=retroshar+etor</a></p>
<p>&#8220;On a side note, Tor isn&#8217;t very secure&#8230;&#8221;<br />
&#8220;Yes Tor is not realy secure .<br />
Its bether make own anon Network with RetroShare.&#8221;</p>
<p>So, if for the nsa, tor stinks, then retroshare must be smelling really ugly.</p>
<p>If nsa can not even get into the relatively weak security of tor, then it can be safely assumed that retroshare is quite out of their capabilities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219575">

			<div class="comment by-sticky-password ">

				<p class="commentcredit">

					<span class="commenter">Sticky Password</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219575">
						April 11, 2014 9:52 AM					</a>

				</p>

				<p>Open SSL use many websites so, this is a big problem all of the world.<br />
Fortunately, my passwords are safe.<br />
<a href="http://blogen.stickypassword.com/sticky-password-and-the-heartbleed-bug/" rel="nofollow ugc">http://blogen.stickypassword.com/sticky-password-and-the-heartbleed-bug/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219576">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219576">
						April 11, 2014 9:58 AM					</a>

				</p>

				<p>@ Benni</p>
<p>&#8220;If nsa can not even get into the relatively weak security of tor, then it can be safely assumed that retroshare is quite out of their capabilities.&#8221;</p>
<p>If you assume they only attack the protocol, which they don&#8217;t (see QUANTUM). I do agree, though, that such architectures are superior to the typical model of &#8220;let&#8217;s let a bunch of strangers send us malicious packets all day!&#8221; Last system I used for Retroshare-like purposes was Freenet. The protocol and asynchronous design of it was nice. It was also F2F and supported protocols running on top of it. However, much like my concern with RS, there was risk at the endpoint. Risk played out over time for FN in that Java is No 1 source of vulnerabilities today. (RS superior far as endpoint risk, ironically.) It&#8217;s why I advocate solutions like TAILS distro that work from OS to app to force all traffic through anonymity scheme, while minimizing leaks. A RetroShare on it, if it doesn&#8217;t exist already, would be awesome.</p>
<p>I&#8217;ll definitely try RetroShare in the future. I like what you&#8217;ve showed me about it. I&#8217;m just going to assume high end attackers will know what I use it for or be able to attack my machine with a 0-day in it. The assumption doesn&#8217;t actually bother me as it&#8217;s my default assumption for all things I do over an untrusted network or on a mainstream OS. News bites about black hats and recent NSA leaks just prove it out over and over again, with Tor mass collection failure a rare exception. I&#8217;ll keep my assumption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219577">

			<div class="comment by-thunderbird ">

				<p class="commentcredit">

					<span class="commenter">Thunderbird</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219577">
						April 11, 2014 10:40 AM					</a>

				</p>

				<blockquote><p>
Does anyone else find it weird the OpenSSL has a custom malloc function that doesn&#8217;t bother to clear out the memory before returning the pointer?
</p></blockquote>
<p>No version of malloc that I&#8217;ve used clears memory, at least that I&#8217;ve noticed&#8211;that&#8217;s what calloc was for. Are there vendors that have unilaterally changed it?  Sounds like a good idea, but I imagine &#8220;efficiency&#8221; rules safety, as usual.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219578">

			<div class="comment by-ecdh ">

				<p class="commentcredit">

					<span class="commenter">ECDH</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219578">
						April 11, 2014 11:07 AM					</a>

				</p>

				<p>@Nick P</p>
<p>&#8220;I&#8217;m just going to assume high end attackers will know what I use it for or be able to attack my machine with a 0-day in it. &#8221;</p>
<p>I believe this to be very true.. The state of endpoint protection is lot worse than protocols etc. And as a matter of fact I used to be worried about it a lot, knowing that any high-end attacker can enter your system at will (despite the numerous countermeasures) is not a pleasant feeling.<br />
So I kept searching for a solution and I believe there is, just my current threat model doesn&#8217;t warrant it.. So I have given up protecting my machine from NSA and like.</p>
<p>However if anyone would want some protection vs these actors I would recommend going down the &#8216;security through isolation&#8217; approach.<br />
Take a look at QubesOS, awesome idea, however before I could trust it, it would need some serious peer review.<br />
Other than that Hardened Gentoo with sufficiently tight MAC.<br />
For research purposes some microkernel based OSs look really nice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219579">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219579">
						April 11, 2014 11:13 AM					</a>

				</p>

				<p>@ Nick_P</p>
<p>Retroshare is relatively new. Therefore, there is still no official debian package, and that was the reason for the Tails devs not to include it:</p>
<p><a href="https://tails.boum.org/forum/RetroShare_to_replace_Pidgin_and_Claws-Mail__63__/" rel="nofollow ugc">https://tails.boum.org/forum/RetroShare_to_replace_Pidgin_and_Claws-Mail__63__/</a></p>
<p>They say: &#8220;But if Retroshare already proposes a non-official Debian package, maybe they are not so far from having it into Debian. You could check with them if that is in their plan.&#8221;</p>
<p>The retroshare developers say:</p>
<p><a href="http://retroshare.sourceforge.net/forum/viewtopic.php?t=1366&#038;p=5257" rel="nofollow ugc">http://retroshare.sourceforge.net/forum/viewtopic.php?t=1366&#038;p=5257</a></p>
<p>&#8220;We would love Retroshare to have offical packages for Debian, Ubuntu, Fedora, etc. We have actively tried in the past &#8211; but got ignored.<br />
Hopefully with Retroshare&#8217;s growing popularity, one day it will happen.<br />
If you have any contacts or influence in this area? let us know.&#8221;</p>
<p>And indeed there is now a bug in debian, saying that retroshare is a package that is currently being worked on to include it in future debian versions:</p>
<p><a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=659069" rel="nofollow ugc">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=659069</a></p>
<p>Therefore, it can be assumed that Retroshare will  soon be in the official Debian repository, and then finally make its way into Tails. The Tails developers say:</p>
<p>&#8220;By the way, I&#8217;m pretty sure we won&#8217;t use it to replace Pidgin and Claws Mail but provide it in addition to them&#8230;&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219580">

			<div class="comment by-thunderbird ">

				<p class="commentcredit">

					<span class="commenter">Thunderbird</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219580">
						April 11, 2014 11:45 AM					</a>

				</p>

				<blockquote><p>
Dylan Smith • April 10, 2014 4:21 AM</p>
<blockquote><p>
@anon:</p>
<p>&gt; I don&#8217;t think this is correct. On Linux you will only get access to memory owned by your process id, so &#8220;anything in memory&#8221; is not true: your sshd private key is safe, for example.
</p></blockquote>
<p>No, it&#8217;s absolutely correct. When the OpenSSL library allocates a chunk of new memory, the VMM could assign that from anywhere in physical RAM. It could be that this new chunk of physical RAM was just freed by another process. If that chunk of memory happened to include something sensitive, bad luck.
</p></blockquote>
<p>Sorry, but that is wrong (since this is starting to sound like a Pythons&#8217; routine, I mean the assertion that you can get memory from another process is wrong).  On Linux, you never get anything but zeroed memory for a newly-allocated page.  Residue attacks were understood in the 60&#8217;s, I think.  Certainly in the 70&#8217;s.  When people say &#8220;almost anything,&#8221; can be in the memory, they mean that since it&#8217;s a process on a server setting up SSL connections, you might find very security-relevant stuff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219581">

			<div class="comment by-prakash ">

				<p class="commentcredit">

					<span class="commenter">Prakash</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219581">
						April 11, 2014 11:56 AM					</a>

				</p>

				<p>Please read about Heartbleed bug that creates panic in Web world. I tried to add most of the information about Heartbleed i.e. vulnerable OS/network devices, effect and Solution in my blog <a href="http://wholovehacking.blogspot.in" rel="nofollow ugc">http://wholovehacking.blogspot.in</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219582">

			<div class="comment by-quirk ">

				<p class="commentcredit">

					<span class="commenter">Quirk</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219582">
						April 11, 2014 12:03 PM					</a>

				</p>

				<p>@NickP:</p>
<p>&#8220;People writing in more safety-centered systems languages rarely do anything like that.&#8221;</p>
<p>Which systems languages are we talking about here? I&#8217;m unaware of any widely used systems languages at this point other than C/C++. (Java and C# are not systems languages, but applications languages. You wouldn&#8217;t seriously attempt to write a kernel or even a network driver in them.)</p>
<p>People working with managed code who need very high performance frequently shell out to native code. (I do my share of tracing bugs in managed/unmanaged code interfaces). But then we&#8217;re back to OpenSSL being written in C. If you attempt to write a managed code system to deliver high performance, you end up with some pretty ugly optimisations being done, and some of these will have security applications.</p>
<p>So, to revisit my starting point: these people were already working in native code for reasons of performance, and were disabling existing malloc safety checks to get better performance. This is not a situation where managed code&#8217;s &#8220;safety&#8221; buys you anything at all. When people think they have valid performance concerns &#8211; rightly or wrongly &#8211; they are going to do horrible unsafe things to push the managed code to the limit to try and make it perform at native speed.</p>
<p>Beyond that, as pointed out by @Anderer Gregor, other classes of attack (such as timing attacks, RNG attacks etc) cannot be so easily guarded against in managed code. In short, managed code is not a panacea, and in many cases may even prove to be a worse solution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219583">

			<div class="comment by-noyb ">

				<p class="commentcredit">

					<span class="commenter">NOYB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219583">
						April 11, 2014 1:47 PM					</a>

				</p>

				<p>What is revealing about the Heartbleed issue:</p>
<ol>
<li>Even a core security over-the-wire protocol didn&#8217;t even have minimal unit tests set up.  I think everyone expected that something as critical as OpenSSL would be taken seriously by someone.</li>
<li>The open-source model is no panacea when it comes to security.  For every reviewer checking code for bugs to secure the code, there are going to be 10X professional white-hats &amp; black-hats looking to exploit the bugs.</li>
<li>The fact that some semi-anonymous developer-guy can check-in code to such a critical area, another semi-anonymous tester-guy can sign off on such obviously broken code, where the code that is checked-in to implement some semi-anonymous feature is just scary.</li>
<li>Is this stuff rigorously tested?  Really?  I&#8217;d tend to doubt it, considering the circumstances surrounding this incident.</li>
<li>
<p>C/C++ language implementation is problematic and always will be when handling wire protocols.</p>
</li>
</ol>
<p>My recommendations:</p>
<ol>
<li>
<p>Obviously the process surrounding critical infrastructure needs to change.  Wire-protocols especially need to be properly tested.  I there&#8217;s a place where care needs to be taken, it&#8217;s in where untrusted data is parsed.  I&#8217;d recommend using explicit &#8216;program by design&#8217; techniques in this area, where software is first designed, then unit-tests are designed to meet fully-documented use-cases, then code is written to pass the unit tests.</p>
</li>
<li>
<p>Open-source shouldn&#8217;t go away (and it shouldn&#8217;t) but &#8216;checked-in&#8217; code needs to be reviewed and approved by a committee of experts who have their professional reputation on the line and will be held accountable for mistakes.</p>
</li>
<li>
<p>Some sort of layer needs to be inserted into the framework that bounds-checks (etc) incoming data in a rational and consistent way.</p>
</li>
<li>
<p>Ideally, this stuff would be implemented in a pointer-restricted environment / language.</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219584">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219584">
						April 11, 2014 1:59 PM					</a>

				</p>

				<p>@L: &#8220;I&#8217;m in the process of writing the code for a new crypto/auth protocol,&#8221;</p>
<p>Please limit yourself to thousands of lines.<br />
For example:</p>
<ul>
<li>do not implement tunelling, only document that SLIRP could be used to tunnel in your encrypted connection.</li>
<li>do not implement keep alive packets.</li>
<li>do not pass environment variables.</li>
<li>use packets whose mandatory length is defined in the protocol: this will mean less mallocs.</li>
</ul>
<p>Bonus: code review will be simpler and hence faster.</p>
<p>Minimize the number of branch conditions to limit attack surface in the assembly code using a secret key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219585">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219585">
						April 11, 2014 2:37 PM					</a>

				</p>

				<p>Now it is official:</p>
<p>NSA knew, and used Heartbleed since 2 years;</p>
<p><a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartb" rel="nofollow ugc">http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartb</a><br />
leed-bug-exposing-consumers.html</p>
<p>The U.S. National Security Agency knew for at least two years about a<br />
flaw in the way that many websites send sensitive information, now<br />
dubbed the Heartbleed bug, and regularly used it to gather critical<br />
intelligence, two people familiar with the matter said.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219586">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219586">
						April 11, 2014 2:39 PM					</a>

				</p>

				<p>Sorry, link should have been:</p>
<p><a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html" rel="nofollow ugc">http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219587">

			<div class="comment by-bleedingheart ">

				<p class="commentcredit">

					<span class="commenter">BleedingHeart</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219587">
						April 11, 2014 2:59 PM					</a>

				</p>

				<p>This is just more proof that computers can never be secure.  We are fooling ourselves if we think so.  NSA/GCHQ/FBI/BND or any other TLA will always have a backdoor, even if not intentionally planted.  Us average people are fighting two fronts &#8212; one against well funded cyber-criminals and one against NSA.  Our hopes of ever winning both battles (or even one) is next to nil.</p>
<p>When an SSL library has millions upon millions of LoC, our hope of ever making it secure (especially with a highly insecure language like C) is impossible.  As big of an open-source fan as I am, I realize it will never be secure.  Better than Windows, perhaps, but never perfect.  There&#8217;s simply too many things that can go wrong.  Even if the programmers can be trusted and all have pristine intentions (unlikely), there is no guarantee they audit their own code.  And even if they do, there&#8217;s no guarantee they catch everything.  This is especially true with encryption software where the number of people in the world who are qualified to audit it numbers in the hundreds.  Most of them don&#8217;t bother.</p>
<p>And that&#8217;s just the software layer.  I cringe at the thought of what hardware the NSA has subverted (Snowden docs mention that NSA had subverted &#8220;encryption chips&#8221; used in many VPN&#8217;s, but the Guardian decided to retract the name of the company who has betrayed the public&#8217;s trust).  And I doubt that is the only hardware in which the NSA has planted backdoors.  We have to assume Intel, AMD and every other chip fabricator is subrverted as well.</p>
<p>If you want secure communication, do it the old fashioned way &#8212; in a secure room face-to-face.  Or have a courier send your contact a handwritten note encrypted with a properly implemented OTP.  Just don&#8217;t lose or reuse the pad.</p>
<p>So, no, I am not hopeful that we ever solve our cyber-security problems, especially when there are <em>very</em> powerful actors who don&#8217;t <em>want</em> the Internet to be secure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219588">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219588">
						April 11, 2014 3:17 PM					</a>

				</p>

				<p>CloudFlare has done some research that has led them to believe that it&#8217;s highly unlikely that private keys can be compromised using Heartbleed. Their work is documented here:</p>
<p><a href="http://blog.cloudflare.com/answering-the-critical-question-can-you-get-private-ssl-keys-using-heartbleed" rel="nofollow ugc">http://blog.cloudflare.com/answering-the-critical-question-can-you-get-private-ssl-keys-using-heartbleed</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219589">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219589">
						April 11, 2014 3:26 PM					</a>

				</p>

				<p>If anyone&#8217;s writing a replacement for or new implementation of SSL, I have some suggestions.</p>
<ol>
<li>Don&#8217;t implement authentication-only (aka the null cipher).</li>
<li>Don&#8217;t implement 40-bit encryption.</li>
<li>Don&#8217;t implement 56-bit encryption.</li>
<li>Don&#8217;t implement RC4.</li>
<li>Don&#8217;t implement RSA with less than a 2k-bit modulus.</li>
</ol>
<p>The above no-nos were all implemented in SSL the last time I looked (probably 10 years ago).</p>
<ol>
<li>Don&#8217;t implement protocols that omit Forward Secrecy.</li>
<li>When generating secret or private keys, use a really good PRNG, like Fortuna. Seeding the RNG is very important, but I admit that seeding the RNG is still an open research question.</li>
</ol>
<p>And if doing a replacement, I suggest<br />
8. Don&#8217;t send anything in the clear (If a public key or certificate has to be transferred, transfer it encrypted with an ephemeral shared secret, and cache it for next time.) except an ephemeral public key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219590">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219590">
						April 11, 2014 4:12 PM					</a>

				</p>

				<p>I think priority number one is a safer replacement for OpenSSL, preferably if it keeps the same interface or provides a wrapper so it can be a drop-in replacement without having to change code in the applications that use it.</p>
<p>SSL is not going away any time soon, but it can go away in the future. I think we should be looking to keep everything as simple and modular as possible for any replacement. For example, the highest level of the protocol should be abstracted so as to not going into details, but use a set of interfaces. As an example (and I am not necessarily proposing this should be what the algorithm looks like):</p>
<p>1) Communication Establishment Protocol &#8211; a generic protocol that returns the algorithms, protocols, and data to be used for the subsequent steps (this should determine what is supported, and select the most appropriate algorithms based on a set of rules)</p>
<p>2) Pre-Authentication Interface &#8211; A generic interface to test the validity of the host information, such as if certificate is valid</p>
<p>3) Key-Exchange Interface &#8211; A generic interface that works with multiple key-exchange protools and algorithms</p>
<p>4) Confirmation Interface &#8211; A generic interface that a secure connection has been established with the host. This would perform things like key-confirmation to verify the host does indeed hold the private key.</p>
<p>5) Secure Transport Interface &#8211; A generic interface for sending and receiving of encrypted data. This layer would provide encryption and message authentication.</p>
<p>Each interface is passed a structure containing the data returned by previous interfaces (if any), each interface returns success or fail, and those protocols may be use be on top of other interfaces as well.</p>
<p>The idea is that it shouldn&#8217;t take more than a few pages to describe each protocol involved, which means the implementation of each component stays simple as well. On top of that, because it&#8217;s modular you can add a new supported key-exchange protocol, confirmation protocol, or transportation protocol without having to replace the main protocol. This also means that if you make the implementation itself modular, it is easier to verify the code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219591">

			<div class="comment by-lizz ">

				<p class="commentcredit">

					<span class="commenter">Lizz</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219591">
						April 11, 2014 4:27 PM					</a>

				</p>

				<p>While anyone can introduce a bug, as German developer Robin Seggelmann readily admitted to (thanks for coming forth so quickly!!), I&#8217;m curious about OpenSSL&#8217;s code review process: checking a variable length should be detected several times before code gets put into production &#8211; both progmatically and manual reviews.</p>
<p>And if OpenSSL group missed this critical flaw, then it&#8217;s to be assumed virtually all other groups &#8211; open or not &#8211; aren&#8217;t doing this simple check, either. Aren&#8217;t there programming components or add-ons that can variable length checks have been done?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219592">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219592">
						April 11, 2014 4:39 PM					</a>

				</p>

				<p><i>If you want secure communication, do it the old fashioned way</i><br />
BleedingHeart<br />
&#8211;The problem is initiating that or suggesting it to people you want to have private talks w/.  I wouldn&#8217;t do any physical talking anywhere if you want <em>ultimate</em> &#8220;there&#8217;s no way in hell&#8221; security.  I get a little excited going over what to do, but there can&#8217;t be any discernible pattern and I naturally like my patterns; so it&#8217;s uncomfortable.  I&#8217;ll chat w/ anyone over hotmail email or wide open HF ham radio bands (have to make it sound like a normal conversation over airwaves) in the clear, w/ a well-made OTP exchanged physically.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219593">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219593">
						April 11, 2014 4:53 PM					</a>

				</p>

				<p>@ Quirk</p>
<p>Main language I&#8217;m referring to is Ada. Its basic static checks would&#8217;ve caught this. It&#8217;s also anything but slow and widely used in safety-critical industries. Others that still have tool support with good performance and some safety enhancements: Pascal (Lazuarus), Modula-2/3 (used still in Europe), PL/I/S (mainframe OS &amp; partners), Typed Assembler, C-like languages (eg Cyclone), and recently people are saying Go too.</p>
<p>Btw, your distinction between &#8220;system&#8221; and &#8220;application&#8221; languages is quite artificial. There&#8217;s OS&#8217; s written in Java, C#, Haskell, LISP, etc. They&#8217;re far from ideal for that but certain structuring and compilation choices  mean it can be done. Although I wouldn&#8217;t recommend them for it, it just goes to show the system vs app concept mainly depends on how you use them.</p>
<p>I honestly couldn&#8217;t even see why you mentioned bloated Java and .NET as, like you said, language under consideration must be fast and low level. That you keep referring to &#8220;managed code&#8221; while implying it&#8217;s slow makes me think they&#8217;re your only experience with it. Languages on my list, real systems languages, can be made to give you as much or as little protection as you like. You can, for instance, code an algoritm in SPARK Ada, prove no memory violations exist, and then deploy a &#8220;zero runtime&#8221; version of that code. Or you can deploy a runtime. Or you can do dynamic checks automatically inserted. Such is why the Mondex CA was written in Ada.</p>
<p>Which brings me to your claim about people working around the safety system in dumb ways for extra raw speed. Yeah, even a safe language usually has a FFI or assembler support so sure they can. But that&#8217;s not &#8220;using&#8221; a safe language: that&#8217;s abusing it. Idiots can ruin any good safety net. Doesn&#8217;t make the safety net a bad idea or negate its claimed benefits. It just means don&#8217;t use libraries from people that do dumb shit in their code, esp if it&#8217;s not memory safe. That simple. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219594">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219594">
						April 11, 2014 6:40 PM					</a>

				</p>

				<p>So when I think systems programming, I&#8217;m thinking low level components: Kernel, bootloader, drivers, filesystem, shell, internet layer, etc.</p>
<p>Things like an HTTP server, not so much. So the question is this? What are we actually talking about here? Well, in regards to this exploit, it isn&#8217;t systems programming &#8211; it&#8217;s application programming. The reality is the overhead for SSL is not that much, even if you implemented it in a slower language.</p>
<p>Let&#8217;s say we got rid of all the assembly code, got rid of the &#8220;fast&#8221; malloc implementation, and used a language with some basic security features like bounds checking. How much of a performance hit would you really have? Well, when Google made Gmail entirely use HTTPS they experienced a CPU usage increase of 1%&#8230; So if your implementation is twice as slow, that would bring it to 2%. That&#8217;s not much, and you probably aren&#8217;t talking twice as slow, you are probably talking more like 20-50% slower at most at the beenfit of a significantly higher security margin provided by a language like Ada or Go.</p>
<p>Assembly implementations of ciphers are generally not going to give you a significant enough boost to even be worth the higher security risk compared to using an easier to verify implementation in a higher-level programming language. Maybe if you are using AES-NI or CLMUL instructions, but GCC provides library functions to access those anyway.</p>
<p>That said, for most web applications, it&#8217;s network/disk/database/memory IO that is the main bottleneck, not CPU.</p>
<p>We can&#8217;t justify using C based on performance reasons, because the gains are just not that much. There may be some, but it&#8217;s about priorities, and for a programming language (or any development, really) I think the importance is generally like so:</p>
<p>1) Security<br />
2) Ease of Use<br />
3) Performance</p>
<p>So you don&#8217;t justify performance over security, unless the security gain is tiny and the performance hit is huge. Bounds checking is a huge security gain for a small performance hit. Ease of use can be a security issue as well, as a language in which an easy mistake (e.g. C with using = instead of ==) can make bugs more likely, and vulnerabilities in turn. Of course, those simple language design features has absolutely zero impact on performance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219595">

			<div class="comment by-jodina-joseph ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bit.ly/PZ4m9P' rel='external nofollow ugc' class='url'>Jodina Joseph</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219595">
						April 11, 2014 7:02 PM					</a>

				</p>

				<p>I&#8217;d really like to know which sites and articles to believe. One day, one article tells me that certain sites were never vulnerable. The very next day I see a different article with a list saying that these same sites were vulnerable originally, but are now patched, and that I need to change my passwords. I don&#8217;t know who to believe. Both articles say they are updating live, but the updates I keep seeing are changing their stories from one day to the next, &#8220;as reports continue to come in&#8221;. At this point I don&#8217;t even know who has their facts straight, or whom to trust, as I read all that I can about this Heartbleed thing. I guess that my best bet is to wait a while longer and then change ALL my passwords to every site that I use, just to make sure that I&#8217;m safe.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219596">

			<div class="comment by-hernanc ">

				<p class="commentcredit">

					<span class="commenter">hernanc</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219596">
						April 11, 2014 9:33 PM					</a>

				</p>

				<p>Looks like the cloudflare challenge has been completed successfully!</p>
<p><a href="http://www.theverge.com/us-world/2014/4/11/5606524/hacker-successfully-uses-heartbleed-to-retrieve-private-security-keys" rel="nofollow ugc">http://www.theverge.com/us-world/2014/4/11/5606524/hacker-successfully-uses-heartbleed-to-retrieve-private-security-keys</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219597">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219597">
						April 11, 2014 10:02 PM					</a>

				</p>

				<p>@ Anura</p>
<p>Great comment. From the problems to tradeoffs, well-presented in general. Btw, to support your point:</p>
<p><b>A type-safe, TPM-backed TLS implementation in Java</b><br />
<a href="http://www.cs.cmu.edu/~mmaass/tpm_tls/report.html" rel="nofollow ugc">http://www.cs.cmu.edu/~mmaass/tpm_tls/report.html</a></p>
<p>This prototype uses safe Java code for TLS and the Flicker secure execution scheme that I posted here a while back. We&#8217;ve basically proposed using a safer, still efficient, systems language to handle protocol engine. This one is a much higher-overhead option that uses a JVM and a TPM for each operation. Yet, even with all that TPM interaction, the total overhead for initialization is about 3 seconds. They note that&#8217;s a problem as it&#8217;s noticeable to the user. Yet, the TPM takes up 1-2 seconds of it and Flicker basically freezes the system in time as a side-effect of its operation. The actual encryption and protocol handling seem to happen fast.</p>
<p>The report doesn&#8217;t justify mass adoption of Java+TPM+TLS. However, noting similarities and specific performance numbers, I think this report <em>does</em> justify believing that SSL can be coded on a safer or even totally managed language with acceptable performance for users. I&#8217;m trying to find examples of SSL in type and/or memory safe code with benchmarks but this report was hopeful at least.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219598">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219598">
						April 11, 2014 10:51 PM					</a>

				</p>

				<p>BouncyCastle has both a TLS client and server implemented in both C# and Java. It might be worth setting up a simple server and running some load testing software/benchmarks to see what kind of hit you get compared to some other implementations.</p>
<p>Their API is a bit lower level, so it&#8217;s a bit of work to implement.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219599">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219599">
						April 11, 2014 11:11 PM					</a>

				</p>

				<p>I looked up some papers I posted here a while back on statically checked, network apps by Madhavapeddy. His 2006 <a href="http://anil.recoil.org/papers/anil-thesis-singlesided.pdf" rel="nofollow ugc">dissertation</a> set the stage for this 2010 <a href="http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-775.pdf" rel="nofollow ugc">technical report</a>. The guy stay doing good, useful work in INFOSEC. He uses his Ocaml-based protocol development system to develop SSH and DNS systems. The SSH system performed at over 10MBps throughput on a system where OpenSSH did about 20-30. He also noted the crypto library he had to use was 75% slower than what OpenSSH used, which was hand-optimized assembler. So, they had a very high level language with crappy crypto library still getting 10MBps is pretty good.  The DNS result was even cooler because Ocaml DNS actually <em>outperformed</em> BIND while also using less code &amp; more safety features. If you can do fast OpenSSH, you can do fast OpenSSL. If you can do fast and safe DNS, then&#8230; then you should be using a safe and fast DNS server too, damnit! 😉</p>
<p>Btw, I did find pure implementations of crypto and SSL in Java. They were all late 90&#8217;s to early 2000&#8217;s commercial and academic. Mostly gone. (shrugs) SSH on Ocaml tells me we could do SSL on Ada, GCJ, etc pretty easy. If performance were a worry, I&#8217;d do the following:</p>
<ol>
<li>Use a dedicated core or chip for the SSL processing.</li>
<li>Use an event-queue architecture.</li>
<li>Ensure SSL function isn&#8217;t called until data is in memory. </li>
<li>Ensure SSL process&#8217;s code and data fit into cache. </li>
</ol>
<p>The result should be a SSL function with high utilization and efficiency. This should offset some of the burden of safety checks, which is already small for most of them. This is also compatible with MILS architecture I used to promote, meaning SSL engine memory &amp; private key could be isolated at (currently) EAL6+ assurance. Formal analysis of protocol or implementation proving certain properties about data or memory access might also allow checks to be turned off in performance critical areas. (Common trick in SPARK crowd.) Another possibility I&#8217;ve seen in the literature is hybrid checks: things easy to statically check are done at compile-time, with the compiler using that information to wisely insert dynamic checks for the rest. Still a catch all problems approach, but with less overhead.</p>
<p>Dissertation quote maybe relevant to SSL bug:</p>
<p>&#8220;In Chapter 4 of his PhD thesis [131], Hayden discusses the impact of using OCaml<br />
and notes that reducing memory allocation is a key concern. He also reports that <b>using the<br />
C interface led to hard-to-track bugs, conﬁrming our approach of attempting to attain high<br />
performance without resorting to using foreign-function bindings.</b>&#8221;</p>
<p>The code worked fine until they escaped their safety net and relied on C allocation mechanisms. Then, all sorts of weird crap starts happening. Good argument for one instead of the other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219600">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219600">
						April 11, 2014 11:20 PM					</a>

				</p>

				<p>@ Anura</p>
<p>I did know about BouncyCastle. I didn&#8217;t know they had TLS so thanks for that. Load-testing it would be a good idea. I suggest whoever does this should first look at the crypto implementation and verify it&#8217;s all Java. Some &#8220;pure&#8221; Java implementations I&#8217;ve seen relied on libraries that used native code at some point. Any benchmark of a &#8220;Java&#8221; TLS or SSL should indicate where cut-off point is for type-safe code if there is one. If it&#8217;s at crypto primitive level, for example, it might not negate memory safety if constructed well and would still be easier to get right than a fully native system.</p>
<p>So far, nothing in BouncyCastle&#8217;s description indicates use of native code. I&#8217;d only call that validated if a Java veteran looked carefully at it to find both algorithm and cryptosystem implementations in Java code. Then, benchmarking could begin. Matter of fact, one wouldn&#8217;t even need a full SSL implementation: just pick one strong construction and simulate each part of the process while timing them. Compare to existing benchmarks that do it similarly, along with a check of overall time against what users find acceptable. It would be a nice start on real data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219601">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219601">
						April 11, 2014 11:30 PM					</a>

				</p>

				<p>I have used their C# implementation of OpenPGP before with good results, and went through and did not find any non-C# code. Now I haven&#8217;t actually sat down and gone through every line of code, but I&#8217;m pretty confident it&#8217;s pure Java/C#.</p>
<p>Java crypto is here:</p>
<p><a href="https://github.com/bcgit/bc-java/tree/master/core/src/main/java/org/bouncycastle/crypto" rel="nofollow ugc">https://github.com/bcgit/bc-java/tree/master/core/src/main/java/org/bouncycastle/crypto</a></p>
<p>C# crypto is here:</p>
<p><a href="https://github.com/bcgit/bc-csharp/tree/master/crypto/src/crypto" rel="nofollow ugc">https://github.com/bcgit/bc-csharp/tree/master/crypto/src/crypto</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219602">

			<div class="comment by-not-a-real-dr-chuck ">

				<p class="commentcredit">

					<span class="commenter">Not A Real Dr Chuck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219602">
						April 11, 2014 11:50 PM					</a>

				</p>

				<p>Excuse if this is a stupid question, but if Heartbleed only exposes data from OpenSSL&#8217;s heap, that means only information that has been encrypted relatively recently at the time of the attack (and of course the key used to encrypt it) is exposed, right?  So the advice we keep hearing telling everyone to change their passwords on any site they&#8217;ve ever been to seems to be unfocused, at least.  It&#8217;s the very act of logging in that puts your password up for grabs, so you should worry most about the places you logged into the past 4 days (and on day 1 they should have told us not to log in anywhere for awhile).</p>
<p>I get the concern that maybe possibly a few bad actors had the ability to heartbleed-eavesdrop before this was made public, but we know that everyone and his dog have had it for just a couple of days.</p>
<p>Again, I know I&#8217;m probably missing something.  What?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219604">

			<div class="comment by-required-field ">

				<p class="commentcredit">

					<span class="commenter">required field</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219604">
						April 12, 2014 1:48 AM					</a>

				</p>

				<p>Bruce, could you explain how Perfect Forward Secrecy and this bug relate to each others exactly, regarding past and future communications and the need to change passwords? And thanks so much for helping the rest of us with these tricky yet vital things!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219605">

			<div class="comment by-mathias-hollstein ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://tron-delta.org' rel='external nofollow ugc' class='url'>Mathias Hollstein</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219605">
						April 12, 2014 1:53 AM					</a>

				</p>

				<p>Not A Real Dr Chuck (April 11, 2014 11:50 PM), we came to the very same conclusion. Activity by the intelligence and cyber criminals must have been high throughout the last few days. Therefore we kept our own activity to an absolute minimum and did not transfer sensitive data like for e.g. passwords through TLS secured channels. Additionally its easy to grab passwords and the like but harder to get valuable certs or keys.</p>
<p>Also a good portion of services online was not affected at all either due to older libraries installed and used, heartbeat not compiled in or due to the fact that services were protected by some form of IPS or similar perimeter defense, for e.g. like some of those of 1&amp;1 from Germany.</p>
<p>Finally we/I use strong and different passwords for various services. Therefore the possible compromise of one or two accounts would not affect others easily. The most important thing right now in our opinion is to make sure our local perimeter is secured (servers, routers, etc.) and large organizations and corporations we have contracts with patch their systems and renew keys and certs ASAP. Until that time our operations stay reduced to an absolute minimum and alternative systems, channels and protocols are employed if possible. Further we stay in touch with our most important contractors like our ISP and other providers.</p>
<p>We think that most people out there won&#8217;t be severely affected by this flaw as long as they keep their head down and use services that are secured soon and adequately.</p>
<p>The most interesting question that arose however is whether the intelligence and criminals are/were able to decrypt large amounts of previously recorded data in transit throughout the last 24 months. If so that would likely (have) put large amounts of sensitive data at risk. Not to mention that its nearly impossible to estimate or audit the nature and amount of revealed sensitive data. This is a true nightmare since so little can be done about this (ever). Maybe even worse is the problem with OpenSSL and the certs at large. We expect more like this to happen in the nearer future and already prepare for a full and permanent compromise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219606">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219606">
						April 12, 2014 3:32 AM					</a>

				</p>

				<p>Nick P: I guess we can both feel validated by this vuln showing just how wholly inadequate C is for modern programming and/or secondarily how sloppy implementations become essentially grandfathered into use and get embedded in damn near everything.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219608">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219608">
						April 12, 2014 3:59 AM					</a>

				</p>

				<p>@Nick P</p>
<p>AFAIK OpenSSH has no assembly code. OpenSSL on the other hand has lots of Mb in assembly (gotta love it).</p>
<p>But&#8230;</p>
<p>Whatif&#8230;</p>
<p>(just thinking out loud)</p>
<p>A SSL/TLS library is not a (shared) library but an executable command. That way the cmd can&#8217;t access the server application data by itself, only what&#8217;s send through the stream of data (think pipes or 9p).</p>
<p>Of course this wouldn&#8217;t help against heartbleed, but who could figure out that someone is dumb enough (even a PhD student) to develop a protocol that bypasses all security measurements with plain text?</p>
<p>On the other hand, if the tls cmd itself is split into seperate processes (keystore, aes, sha and ecc), I think it could be hardened quite significantly and as a bonus it would also simplify the code and is more according to the UNIX ideology of having small tools that do one thing only and doing that well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219609">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219609">
						April 12, 2014 4:14 AM					</a>

				</p>

				<p>I forgot one thing. When tls is written as a command it could be written in any language, because the communication is with pipes (or a vfs), so it&#8217;s just a stream of bytes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219610">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219610">
						April 12, 2014 6:31 AM					</a>

				</p>

				<p>@ yesme,</p>
<ul><i>What if</i></ul>
<p>You are not alone in such thoghts.</p>
<p>I&#8217;m not sufficiently &#8220;indoctrinated&#8221; in either OpenSSH or OpenTSL &#8211;who is&#8230;&#8211; to know sufficien of the ins and outs of them to know all the relevent vulnerable bits.</p>
<p>But on the assumption it&#8217;s just keys/encryption I can see no reason why it can&#8217;t be split off into a seperate process. Which as Nick P and others will confirm is a &#8220;known soloution&#8221; when the use of crypto/smart cards are in use or likely to be. Such behaviour was quite common if you can remember back to the days of x86DX CPUs with built in math co-pros and the x86SX CPUs that did not but on motherboards with sockets for a co-pro chip.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219611">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219611">
						April 12, 2014 8:33 AM					</a>

				</p>

				<p>@ yesme</p>
<p>What you&#8217;re describing is a form of &#8220;assured pipelines.&#8221; That security model says decompose app into communicating components (typical), then enforce a specific information flow between those components. Highly secure platforms such as LOCK supported this structure. A form of it can be done in SELinux, as it&#8217;s a LOCK decendent. Only actual crypto library I know that does this is cryptlib. It has an internal security kernel that ensures each function properly uses other functions. This doesn&#8217;t stop, say, a memory attack but does allow one to ensure proper use of the crypto primitives.</p>
<p>Main problem I have with your version is that the command processor is in the TCB. The same thing would be nice if it only happens with simple IPC and input validation. This is essentially what I did with MILS architecture I referenced as separation kernel IPC is <em>fast</em>. They decompose the applications into functions in their own address spaces communicating with kernel IPC per a communications policy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219612">

			<div class="comment by-assman ">

				<p class="commentcredit">

					<span class="commenter">assman</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219612">
						April 12, 2014 9:04 AM					</a>

				</p>

				<p>&#8220;It&#8217;s time that we stop pretending the C language is a reasonable one for writing secure software.&#8221;</p>
<p>NO!!</p>
<p>Its time we stop pretending that C, C++, Unix, Linux and the whole diseased mentality has not horribly and badly damaged computing. The Unix Haters handbook is right. It has always been right. It will always be right. I am fucking tired of shitty piece of shit Unix nerds not admitting how their preferred systems suck. Repent your stupid evil ways and reform. Unix, Linux, C/C++ and that whole crap shit community is a pure form of computing evil.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219613">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219613">
						April 12, 2014 11:32 AM					</a>

				</p>

				<p>@Nick P</p>
<p>I don&#8217;t know any simpler IPC than pipes. So I think that&#8217;s ok.</p>
<p>It&#8217;s just that with seperate commands / processes you reduce the attack surface (AFAIK). If you can somehow read the memory banks than you are screwed anyhow, even with ALSR.</p>
<p>@assman</p>
<p>Here is an interesting <a href="http://doc.cat-v.org/bell_labs/good_bad_ugly/slides.pdf" rel="nofollow ugc">link</a> about the UNIX legacy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219615">

			<div class="comment by-sshdoor ">

				<p class="commentcredit">

					<span class="commenter">sshdoor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219615">
						April 12, 2014 3:38 PM					</a>

				</p>

				<p>Oops, sorry for the double post.</p>
<p>@Nick P, About languages, you may want to look at Parasail, at least the version that can then run without VM. No pointer, no GC, &#8230; But it is in a too ealry stage for now &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219616">

			<div class="comment by-htw ">

				<p class="commentcredit">

					<span class="commenter">HTW</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219616">
						April 12, 2014 7:52 PM					</a>

				</p>

				<p>The answer to TLS/SSL crap is very very very easy. We need JavaScript APIs to run internal browser crypto routines. Then better models could flourish. Browser devs could just wrap extant C/C++ routines with JavaScript APIs. Easy.</p>
<p>So why not do it tomorrow? Revenue. And you thought FOSS wasn&#8217;t about money and all about freedom of choice. Ha. I&#8217;m talking to YOU Mozilla. The TLS/SSL racketeering operation is just too good.</p>
<p>This revenue stream is exactly why Mozilla needlessly scares users away from self-signed certs with bogus dialogs.</p>
<p>And you thought Mozilla was all about &#8220;principles&#8221; lately? My ass.</p>
<p><a href="http://techrepublic.com/blog/it-security/ssl-tls-encryption-and-the-vacant-lot-scam-too-big-to-fail/" rel="nofollow ugc">Vacant Lot Scam</a></p>
<p><a href="http://techrepublic.com/blog/it-security/the-tls-ssl-certifying-authority-system-is-a-scam/" rel="nofollow ugc">CA Authority Scam</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219617">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219617">
						April 12, 2014 8:13 PM					</a>

				</p>

				<p>@HTW<br />
Javascript needs an overhaul for the language too. It has it&#8217;s many deficiencies.</p>
<p>For a security critical function, C/C++ may not be the best. Using languages that addresses the issues of memory leaking without the users&#8217; need to intervene is one of the plus that is needed that C/C++ does not cater. Running in a sandbox (VM languages) are a great choice too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219618">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219618">
						April 12, 2014 8:59 PM					</a>

				</p>

				<p>@ sshdoor</p>
<p>I&#8217;ve posted on Parasail before. It&#8217;s a very nice language in my opinion. It has a good combination of productivity, performance, and safety. This is unsurprising in that the company backing it is a top Ada vendor. 😉 It&#8217;s just too new for production use.</p>
<p>Best thing to do with Parasail is this:</p>
<ol>
<li>Identify its internal model for implementing the parallel constructions safely and efficiently.</li>
<li>Identify a safe, production-grade language to use for your project.</li>
<li>Implement &amp; test the parallel algorithm in Parasail with stub functions.</li>
<li>Have a tool automatically translate that, via the model, into code in the safe language.</li>
</ol>
<p>So, now you have the benefits of Parasail, while keeping a solid language. This is the same kind of thing I&#8217;ve done for many tools, languages, environments, etc. Writing C++ in BASIC and/or LISP (with code generator) for automating boilerplate, safety-checks, and more was one of my original uses for such a technique.</p>
<p>List of concurrent and parallel programming languages<br />
<a href="http://en.wikipedia.org/wiki/List_of_concurrent_and_parallel_programming_languages" rel="nofollow ugc">http://en.wikipedia.org/wiki/List_of_concurrent_and_parallel_programming_languages</a></p>
<p>(Just a bonus in case someone didn&#8217;t know about this index.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219619">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219619">
						April 13, 2014 6:13 AM					</a>

				</p>

				<p><i>The answer to TLS/SSL crap is very very very easy. We need JavaScript APIs to run internal browser crypto routines.</i><br />
HTW<br />
&#8211;Uhhh&#8230;.You just gave me an aneurism&#8230;..That is a failure on the nano second you just stated that; sorry to be mean but you need to corrected before more damage is done.  But good call on piling more crap on more crap.</p>
<p>Any devs rushing in w/ Javascript as the answer need to get slapped in the face real quick.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219620">

			<div class="comment by-bill-clontin ">

				<p class="commentcredit">

					<span class="commenter">Bill Clontin</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219620">
						April 13, 2014 9:22 AM					</a>

				</p>

				<p>There&#8217;s a guy in alt.comp.anti-virus who knew about the OpenSSL Heartbleed exposure years ago. Maybe he&#8217;s got some extra info on this problem.</p>
<p>[QUOTE]</p>
<p>From: Dustin <a href="mailto:a&#x62;&#117;&#x67;&#104;&#x75;&#110;&#x74;&#101;&#x72;&#064;&#x67;&#109;&#x61;&#105;&#x6c;&#046;&#x63;&#111;&#x6d;" rel="nofollow ugc">a&#x62;&#117;&#x67;&#104;&#x75;&#110;&#x74;&#101;&#x72;&#064;&#x67;&#109;&#x61;&#105;&#x6c;&#046;&#x63;&#111;&#x6d;</a><br />
Message-ID: &lt;XnsA30CA142042A4C9X238BHEUFHHI5RJ791@94.75.214.90&gt;<br />
Newsgroups: alt.2600,alt.comp.anti-virus,alt.comp.freeware<br />
Subject: Re: Heartbreak virus<br />
Date: Fri, 11 Apr 2014</p>
<p>X-No-Archive: yes</p>
<p>i&#8217;ve <em>known about</em> the &#8220;error&#8221; for two years now. It <em>was</em> in my<br />
little bag of tricks. it&#8217;s okay, I&#8217;ve still got others that nobodies<br />
published for the idiot savants to fix yet.</p>
<p>Why would I want to fix something that was useful to me and several<br />
other people? 🙂 Stupid person, you are.</p>
<p>[/QUOTE]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219621">

			<div class="comment by-blatant ">

				<p class="commentcredit">

					<span class="commenter">Blatant</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219621">
						April 13, 2014 9:49 AM					</a>

				</p>

				<p>&#8220;I&#8217;m actually more disturbed by the microsoft closed source crypto libraries.&#8221;</p>
<p>If we find out that Microsoft has been selling us out to the NSA, we can sue them. With Open source, we can&#8217;t sue anyone. So they are just saying &#8220;Sorry, I was a student!&#8221;. The whole open source license is built upon the concept that programmers could not be sued for coding mistakes regardless of how stupid or how malicious. This is what people should be afraid of. They should let go of the notion that Open Source is secure because it&#8217;s open and demand another software license aside from the open source ones.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219622">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">Tom</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219622">
						April 13, 2014 10:03 AM					</a>

				</p>

				<p>I think it&#8217;s humorous to point out up until a year or two ago, most people were sending their Facebook, gmail, Yahoo!, and the like passwords in the clear, as TLS was opt-in or not available at all.</p>
<p>Also, if users are being asked to change their passwords, what about their credit cards? If someone used their credit card at a vulnerable site, shouldn&#8217;t they have their bank re-issue it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219623">

			<div class="comment by-tim ">

				<p class="commentcredit">

					<span class="commenter">TIM</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219623">
						April 14, 2014 3:53 AM					</a>

				</p>

				<p>This time must be like christmas for NSA &amp; Co, because so many people are changing all their passwords this weeks and even if the new encrypted channels can&#8217;t be broken today, the density of fresh passwords that won&#8217;t be changed for the next few years must be much higher these days than any other day this year (until now).</p>
<p>I think this should be one good reason to change all passwords in short cycles.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219624">

			<div class="comment by-boni-bruno ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.endace.com' rel='external nofollow ugc' class='url'>Boni Bruno</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219624">
						April 14, 2014 11:59 AM					</a>

				</p>

				<p>Checking for vulnerable SSL servers and patching them is a must, finding what data has been leaked can be paramount for many.</p>
<p>If you have a packet capture fabric in place, using a simple wireshark filter against the packet data can quickly find the various leaks that have or that are occurring on your network&#8230;</p>
<p>Below is a wireshark filters you can use against packet data to identify successful exploits of Heartblead.</p>
<p>((ssl.heartbeat_message.type == 1) &amp;&amp; (ssl.heartbeat_message.payload_length &gt; 61))</p>
<p>This filter might result in some false positives depending on whether or not there are legitimate clients out there that use heartbeat payloads &gt; 61 bytes, but 61 seems to be the common number used.  This filter will identify heartbeat request packets where the ssl.heartbeat_message.payload_length is larger than normal – a strong indication of an exploit attempt.</p>
<p>(ssl.record.content_type == 24) &amp;&amp; (ssl.record.length &gt; 64)</p>
<p>This will identify if the server responded to the exploit.</p>
<p>To see the contents, install your SSL keys on wireshark and down load the packets of interest using the filters above accordingly.</p>
<p>A full write up and snap shots are available at: <a href="http://blog.endace.com" rel="nofollow ugc">http://blog.endace.com</a></p>
<p>Regards,</p>
<p>Boni Bruno</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219625">

			<div class="comment by-ejhuff ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ejhuff.wordpress.com' rel='external nofollow ugc' class='url'>ejhuff</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219625">
						April 14, 2014 3:32 PM					</a>

				</p>

				<p>Can someone comment please on the pro&#8217;s and con&#8217;s of using browser side certificates instead of passwords?  Is there a good reason this isn&#8217;t this available as an option on banking sites?  startssl.com provides free browser certificates and requires them to register and login to their site.</p>
<p>Also, Firefox stores the certificates in the &#8220;Software Security Device&#8221; also used to save passwords, encrypted by the Firefox &#8220;Master Password&#8221;.  What &#8220;Hardware Security Devices&#8221; are available?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219626">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219626">
						April 14, 2014 8:47 PM					</a>

				</p>

				<p>@ejhuff</p>
<p>I talked about it a little bit above. The main problem is that it is kind of a PITA to use, and customer support would spend way too much time helping customers use it. You would need a protocol for generating them in a friendly manner for it to be feasible for widespread use.</p>
<p>You could potentially have the server send an HTTP header requesting certificate authentication. If you didn&#8217;t support the protocol (or chose not to use it) you would just display a standard login/registration page, otherwise you would probably get a browser dialog confirming you want to register with a certificate or use an existing one. If you use an existing certificate you start a new TLS session using the client certificate, if you need to register you are redirected to a page that contains a form specifically for registration with a certificate. The browser would then submit your request to the server, which would sign the certificate with their private key and send it back to you. By including a list of domains this could possibly work for a limited single-sign-on.</p>
<p>Personally, I would like to replace TLS with a protocol that allows you to just send a public key that they store in their database to look up your user information. Signing a certificate is unnecessary if you are only talking to the issuer of the certificate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219627">

			<div class="comment by-paul-kosinski ">

				<p class="commentcredit">

					<span class="commenter">Paul Kosinski</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219627">
						April 15, 2014 4:37 PM					</a>

				</p>

				<p>&#8220;If we find out that Microsoft has been selling us out to the NSA, we can sue them.&#8221;</p>
<p>How do we sue Microsoft for complying with an NSA directive (CALEA, NSL). Anyway, their Terms and Conditions probably absolve them.</p>
<p>How do we find out? (Cf. NSL gag orders.)</p>
<p>If the only &#8220;acceptable&#8221; source of software is companies that can be sued, then we will end up only having software backed by the best lawyers, rather than software backed by the best engineers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219628">

			<div class="comment by-andrey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.viva64.com' rel='external nofollow ugc' class='url'>Andrey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219628">
						April 16, 2014 2:00 AM					</a>

				</p>

				<p>Some time ago, a vulnerability was revealed in OpenSSL, and I guess there&#8217;s no programmer who hasn&#8217;t been talking about it since then. I knew that PVS-Studio could not catch the bug leading to this particular vulnerability, so I saw no reason for writing about OpenSSL. Besides, quite a lot of articles have been published on the subject recently. However, I received a pile of e-mails, people wanting to know if PVS-Studio could detect that bug. So I had to give in and write this article.</p>
<p>A Boring Article About a Check of the OpenSSL Project: <a href="http://www.viva64.com/en/b/0250/" rel="nofollow ugc">http://www.viva64.com/en/b/0250/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219629">

			<div class="comment by-imedia-designs ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://imediadesigns.org/' rel='external nofollow ugc' class='url'>iMedia Designs</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219629">
						April 16, 2014 7:45 AM					</a>

				</p>

				<p>How did the bug get introduced in the first place?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219630">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219630">
						April 16, 2014 10:45 AM					</a>

				</p>

				<p>So far I have been unable to find any solid information on how a site or server can determine if they have been attacked with the Heartbleed vulnerability.  Is there any fingerprint left in the logs of a standard Apache2/OpenSSL configuration with production level logging (ie. NOT set to 11)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219631">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219631">
						April 16, 2014 12:56 PM					</a>

				</p>

				<p>@Rob</p>
<p>The only place you would likely be able to see this is in TCP logs, which is probably not done unless you explicitly installed a TCP logging utility. That would probably be a gigantic logfile if it was detailed enough to detect the exploit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219632">

			<div class="comment by-mbck ">

				<p class="commentcredit">

					<span class="commenter">Mbck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219632">
						April 17, 2014 5:35 PM					</a>

				</p>

				<p>Just a little confused here. I am usually the first to cast aspersions on C, which I refer to as &#8220;the portable assembler that thinks it&#8217;s an HLL&#8221;.  But the problem at isu here appears, to me, to be independent of the language.</p>
<p>What I read in the &#8220;offending&#8221; code is that the following happened.</p>
<ul>
<li>A function is invoked with two parameters:
<ul>
<li>one is a buffer (B),</li>
<li>the other a number (N).</li>
</ul>
</li>
<li>The function obtains<br />
a chunk of memory (M)<br />
whose length is as indicated by the number (N).</li>
<li>The function then copies (B) into (M),<br />
where it fits.</li>
<li>The function returns<br />
the whole content of the memory chunk (M).</li>
</ul>
<p>You can write that in C, C#, Java, Pascal or assembly code.  There will be no exception crash or otherwise.  You can run this in segment-based virtual memory machines, it will run and still be wrong.</p>
<p>There are two problems, but they are independent of C.</p>
<p>One is that the version of malloc used does not zero the contents of (M).  The requirements for malloc does not specify contents, and to use an existing version (e.g. calloc) that explicitly zeroes the buffer would, TTBOMK, be too expensive in many crypto or I/O operations.</p>
<p>The other is that the length of B, the length of M, and the number N, should match.  That&#8217;s a boundary condition testing error that involves a use case that was not envisioned.</p>
<p>Assembly languages should not be blamed of things they didn&#8217;t cause &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219633">

			<div class="comment by-mbck ">

				<p class="commentcredit">

					<span class="commenter">Mbck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219633">
						April 17, 2014 5:49 PM					</a>

				</p>

				<p>@sshdoor @Nick P</p>
<p>The only language that fits what is needed for this kind of task is DCALGOL&#8230;</p>
<p>:-O</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219634">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">NIck P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219634">
						April 17, 2014 6:22 PM					</a>

				</p>

				<p>@ Mbck</p>
<p>It&#8217;s a bounds-checking error. Wikipedia article lists these languages as supporting it: &#8220;Mainstream languages that enforce run time checking include Ada, C#, Haskell, Java, JavaScript, Lisp, PHP, Python, Ruby, and Visual Basic. The D and OCaml languages have run time bounds checking that is enabled or disabled with a compiler switch. C# also supports unsafe regions: sections of code that (among other things) temporarily suspend bounds checking to raise efficiency.&#8221;</p>
<p>Ada was my recommendation for low-level, critical stuff so error would have been caught. Pure Java with AOT compiler would&#8217;ve been fine, albeit slower. Article also notes that ALGOL, the grandfather of languages like C and Go, also had bounds checking. Hoare, its co-designer and a C.S. legend, said this about it:</p>
<p>&#8220;A consequence of this principle is that every occurrence of every subscript of every subscripted variable was on every occasion checked at run time against both the upper and the lower declared bounds of the array. Many years later we asked our customers whether they wished us to provide an option to switch off these checks in the interest of efficiency on production runs. Unanimously, they urged us not to—they already knew how frequently subscript errors occur on production runs where failure to detect them could be disastrous. I note with fear and horror that even in 1980, language designers and users have not learned this lesson. In any respectable branch of engineering, failure to observe such elementary precautions would have long been against the law.&#8221;</p>
<p>Another note was that certain tagged architectures, like Burroughs B5500 I&#8217;ve often referenced, supported it at the hardware instruction level. So, I actually could blame the assembly language for this one. 😉</p>
<p>&#8220;The only language that fits what is needed for this kind of task is DCALGOL&#8230;&#8221;</p>
<p>Haha nice. I heard that platform costs trillions to build, but only millions to wield.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219635">

			<div class="comment by-mbck ">

				<p class="commentcredit">

					<span class="commenter">Mbck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219635">
						April 18, 2014 5:43 PM					</a>

				</p>

				<p>@Nick P</p>
<ul>
<li>&#8220;It&#8217;s a bounds-checking error&#8221;</li>
</ul>
<p>Well, yes and no.  In this specific exploit, it is code written to be overly flexible.  If instead of copying anything to a fresh buffer, the code just passed back the reference to the input buffer, there would have been no bounds to check.  The design <em>assumed</em> that the length of the input and the length of the output could be different.</p>
<p>And the bounds-checking error, or lack thereof, would have manifested itself with the  length difference being the other way: the malloc&#8217;ed buffer could have been <em>smaller</em> than the one received.</p>
<p>Actually, this is probably what can be blamed on C:  Because such a buffer overrun error is so frequent, the author and the reviewer spent time checking for it &#8211; and omitted to check the cases where received size is less than allocated.  There&#8217;s only so many minutes in a day.</p>
<ul>
<li>&#8220;The Bxx00 .. supported it at the hardware instruction level&#8221;</li>
</ul>
<p>Not the only one.  Interestingly, if memory serves, the Intel 80286 did support segmented memory, and paged memory only became available with the 80386.  So the compilers could have assigned separate segments to each object &#8211; but the market (and memory sizes etc.) was not ready for that.  Instead, we are left with paging, which I think dates back to the OS/360 and before.  BTW, AFAIK, this OS is still with us.  Mainframe designs never die.</p>
<ul>
<li>&#8220;ALGOL, the grandfather of languages like C and Go&#8221;</li>
</ul>
<p>I take big exception.  Algol, Pascal (and, I think, PL/i) are block-structured languages.  The semantics of these is not supported easily by hardware and requires a little more than general-purpose registers and linearly addressed memory.  Hardware support for block-structured languages died, AFAIK, with the HP3000 &#8211; even though the Burroughs architecture endures in emulated mode (Intel hardware used in a very personal way).</p>
<p>Block-structured languages allow a completely different organization of code &#8211; and of memory allocation &#8211; than what is possible when all you have is an unstructured heap and a per-process stack.  Alas, RISC killed such &#8220;complicated&#8221; hardware cold.</p>
<p>For what I remember, in Large Systems MCP, the OS was compiled at lexical level 0, device drivers at lexical level 1, applications above.  When you needed a local buffer, you declared it at a higher lexical level &#8211; it was allocated on your process&#8217; stack, no garbage collection required.  The OS could address your data, you could not even construct an address to get to the OS data from an app.</p>
<p>This is similar to the design of the THE operating system (the Wikipedia article is good.)</p>
<p>I&#8217;d love to see someone with real Large Systems credentials correct me where I get it wrong.</p>
<hr />
<p>No, C is not a descendant of ALGOL.  It is a descendant of PDP-11 Assembler, with a little syntactic sugar added to make it tasty.  It is certainly better than straight Assembler, but it does not build anything solid on top of linear-memory-addressing-with-GP-registers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219636">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219636">
						April 18, 2014 9:36 PM					</a>

				</p>

				<p>@ Mbck</p>
<p>&#8220;And the bounds-checking error, or lack thereof, would have manifested itself with the length difference being the other way: the malloc&#8217;ed buffer could have been <em>smaller</em> than the one received.&#8221;</p>
<p>The gist of what I was saying was &#8220;Would a safe (dynamic checked) or managed language have prevented it, caught it at runtime, or gave the attacker the memory? And if it was coded as was typical in that language as well.&#8221; Certain languages handle it way better than C in both directions on bounds checking IIRC. Of course, I could be wrong about that.</p>
<p>&#8220;Interestingly, if memory serves, the Intel 80286 did support segmented memory, and paged memory only became available with the 80386. So the compilers could have assigned separate segments to each object &#8211; but the market (and memory sizes etc.) was not ready for that. Instead, we are left with paging, which I think dates back to the OS/360 and before. BTW, AFAIK, this OS is still with us. Mainframe designs never die.&#8221;</p>
<p>Intel still kept supporting the segmentation model. The GEMSOS security kernel (and I think XTS-400 STOP OS) used it to enhance security. The Native Client architecture (2009) that sandboxes Chrome used segments, too, noting that they&#8217;re a very efficient for such things. Matter of fact, an Intel document said on Atom processors unprotected access is 1 cycle, segments 2 cycles, and paging 8 cycles. So, it&#8217;s still a very efficient protection. That said, AMD eventually ditched it and most recent Intel processors might have. I&#8217;m not sure.</p>
<p>Burroughs B5000 had segments in 1961 so it was probably the first. (Many firsts with that one.) The IBM System/360 used keyed memory where a page of memory is associated with a key and a process needs to have the key to access it. Depending on implementation, the concept might involve several keys with a mix of hardware and software enforcement. PA-RISC and Itanium have that feature, too. IBM System Z and Secure 64&#8217;s SourceT both use this feature extensively inside the operating system for reliability &amp; security.</p>
<p>&#8220;The semantics of these is not supported easily by hardware and requires a little more than general-purpose registers and linearly addressed memory.&#8221;</p>
<p>P-code Pascal was ported to something like 70 architectures, 8-bit to mainframes, per Wirth. So, these kinds of languages can work fine with plenty of hardware profiles, amazingly so in case of P-code. They might take more overhead, though, as they&#8217;re not just throwing bits around. (eg safety checks, structuring)</p>
<p>&#8220;When you needed a local buffer, you declared it at a higher lexical level &#8211; it was allocated on your process&#8217; stack, no garbage collection required. The OS could address your data, you could not even construct an address to get to the OS data from an app.&#8221;</p>
<p>I didn&#8217;t know that. Thanks for the info as I&#8217;m quite interested in Burroughs architecture. I keep referencing it here as it&#8217;s far superior to most systems today in terms of security and support for high level languages. I think it was just too far ahead of its time. Check out this <a href="http://www.cs.virginia.edu/brochure/images/manuals/b5000/brochure/b5000_broch.html" rel="nofollow ugc">advertisement</a> I found recently. Feels strange and neat to look back in time at something that tried to look forward in time.</p>
<p>&#8220;This is similar to the design of the THE operating system (the Wikipedia article is good.)&#8221;</p>
<p>That and A1-class systems are how I learned layering back in the day. 😉</p>
<p>&#8220;No, C is not a descendant of ALGOL. It is a descendant of PDP-11 Assembler, with a little syntactic sugar added to make it tasty.&#8221;</p>
<p>C is a decendent of B, a variant of <a href="http://en.wikipedia.org/wiki/BCPL" rel="nofollow ugc">BCPL</a>. BCPL was a watered down version of <a href="http://en.wikipedia.org/wiki/Combined_Programming_Language" rel="nofollow ugc">CPL</a> to make it easier to compile. Strachey et al, per their <a href="http://comjnl.oxfordjournals.org/content/6/2/134.full.pdf+html" rel="nofollow ugc">paper</a> on CPL, required readers to be familiar with ALGOL 60 as CPL was heavily influenced by it, although was more complex. The lineage is ALGOL60-&gt;CPL-&gt;BCPL-&gt;B-&gt;C. So, they&#8217;re related. It&#8217;s just that ALGOL good design was so mutated and watered down that the end result looked like cross-platform assembler for, say, a PDP-11. 😉 And it&#8217;s safety, maintainability, and easy of integration follows from this. It&#8217;s real fast though!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219637">

			<div class="comment by-mbck ">

				<p class="commentcredit">

					<span class="commenter">Mbck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219637">
						April 20, 2014 8:26 PM					</a>

				</p>

				<p>@Nick P</p>
<p>Many thanks for this thread.  On the Large Systems, I still would recommend the book by E. Organick on Computer System Organization ACM Monograph, .  The notes by Jack Allweiss ( <a href="http://jack.hoa.org/hojaa/b5900.htm" rel="nofollow ugc">http://jack.hoa.org/hojaa/b5900.htm</a>) are a more direct narrative of the environment where the Large Systems philosophy developed.</p>
<p>The Large Systems Architecture (e-mode) survives to this day in the Unisys Libra/MCP systems.  To get information about how these machines work is essentially impossible to do.  The book by Organick was an anomaly in its time, and the Unisys philosophy about disclosing, or, worse, advertising architectural choices has not changed since (please prove me wrong.)</p>
<p>I take note of your remark about P-code; but P-code is an interpreter, and therefore incurs a penalty compared to running directly on the hardware: This is what I was aiming at.  Recent languages lay a thin layer on top of the flat-memory-and-registers hardware model and try to stick to it as closely as possible &#8211; witness the amazing results of work in code optimization.</p>
<p>IMHO, because of this idea of squeezing the latest instruction cycle out of code, we lost sight of code robustness. In the meantime, the notion that there could be a different architectural model that the current one is completely forgotten, or, worse, taught as an aberration of people who didn&#8217;t know.</p>
<p>It&#8217;s difficult to reintroduce ideas like block-structured languages and cactus stacks.  &#8220;You can&#8217;t have programmers write malloc and free calls &#8212; THEREFORE you <em>need</em> automatic garbage collectors&#8221; is essentially impossible to fight.</p>
<hr />
<p>&#8220;And it&#8217;s safety, maintainability, and easy of integration follows from this. It&#8217;s real fast though!&#8221;</p>
<p>&#8230; as you would expect from an assembler 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219638">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219638">
						April 21, 2014 1:23 PM					</a>

				</p>

				<p>@ Mbck</p>
<p>&#8220;On the Large Systems, I still would recommend the book by E. Organick on Computer System Organization ACM Monograph, . The notes by Jack Allweiss ( <a href="http://jack.hoa.org/hojaa/b5900.htm" rel="nofollow ugc">http://jack.hoa.org/hojaa/b5900.htm</a>) are a more direct narrative of the environment where the Large Systems philosophy developed.&#8221;</p>
<p>Links dead. Thanks for the book reference. I&#8217;ll look into it sometime.</p>
<p>&#8220;The Large Systems Architecture (e-mode) survives to this day in the Unisys Libra/MCP systems. &#8221;</p>
<p>Sort of. I&#8217;ve looked into them. They&#8217;re more like current machines that emulate the old ones. The biggest strength of B5000 line was that it enforced in hardware the foundation of system safety/security. Changing that to what&#8217;s essentially a virtual machine&#8230; well, look at Java. 😉</p>
<p>&#8220;To get information about how these machines work is essentially impossible to do.&#8221;</p>
<p>There&#8217;s plenty of information out there. I got a lot of technical information just Googling &#8220;Burroughs architecture,&#8221; &#8220;B5000,&#8221; and so on. There&#8217;s also the Capability-based security book online free that details many descripter- and capability-architectures. For composing it into a NUMA or mainframe machine, I don&#8217;t think we need to know how Burroughs/Unisys did it as much as look at similar machines with public info. For NUMA or interconnects, I always thought SGI was lightyears ahead of the competition so I&#8217;d copy them. There&#8217;s also many academic papers, prototypes, designs, etc for building large systems.</p>
<p>So, it doesn&#8217;t worry me. We only need to understand at an abstract level how they worked. Then, improve the design to help cover today&#8217;s threats. Then, have pro&#8217;s build it, others evaluate it, and a fab produce it. Simple as that. Expensive, though.</p>
<p>&#8220;I take note of your remark about P-code; but P-code is an interpreter, and therefore incurs a penalty compared to running directly on the hardware: This is what I was aiming at. Recent languages lay a thin layer on top of the flat-memory-and-registers hardware model and try to stick to it as closely as possible &#8211; witness the amazing results of work in code optimization.&#8221;</p>
<p>Definitely a penalty and what you say about mainstream systems languages is true. Compiler science has narrowed the gap you mention more than ever. Hope isn&#8217;t lost for robust systems programming on mainstream architectures. We at least have the likes of Ada and Modula for safe[r] systems programming with little performance hit. There&#8217;s others in development. I&#8217;d rather have hardware support, though.</p>
<p>&#8220;IMHO, because of this idea of squeezing the latest instruction cycle out of code, we lost sight of code robustness. In the meantime, the notion that there could be a different architectural model that the current one is completely forgotten, or, worse, taught as an aberration of people who didn&#8217;t know.&#8221;</p>
<p>Exactly. That&#8217;s totally what&#8217;s happened and is happening.</p>
<p>&#8220;It&#8217;s difficult to reintroduce ideas like block-structured languages and cactus stacks. &#8220;You can&#8217;t have programmers write malloc and free calls &#8212; THEREFORE you <em>need</em> automatic garbage collectors&#8221; is essentially impossible to fight.&#8221;</p>
<p>The battle I&#8217;ve been fighting&#8230; Funny you mentioned cactus stacks. I had totally forgotten about them. Looking it up, I found that Burroughs used that (more brilliance) and it was used in <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.25.8875&amp;rep=rep1&amp;type=pdf" rel="nofollow ugc">this</a> parallel machine that Tandem had a part in. I didn&#8217;t know about this machine before. So, this conversation was both interesting and rewarding.</p>
<p>&#8220;&#8230; as you would expect from an assembler :-)&#8221;</p>
<p>Lol. They started with a good HLL for systems, then worked from there to re-invent assembler in more portable form. Man years of research well spent, eh? 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219639">

			<div class="comment by-villy-madsen ">

				<p class="commentcredit">

					<span class="commenter">Villy Madsen</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219639">
						April 22, 2014 12:18 PM					</a>

				</p>

				<p>C Strikes again???<br />
Yes,  I know that applications development would grind to a screetching halt if programmers were forced to use languages that required you to specify the maximum size of a variable (or array) during program development.</p>
<p>On the other hand, it seems to me that debugging was easier and faster in those bad old days of Fortran, Cobol &amp; PLI.  (although I think that I would prefer Pascal these days).</p>
<p>It reminds me of a certain DB product running under VAX/VMS.  There was a hardware feature that prevented execution of code in data space.  You had to turn that feature off if you wanted to use that Database Product. &#8211; At least the feature was still enabled for everything else running on the box, but&#8230;.</p>
<p>Villy G. Madsen  CISA</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219640">

			<div class="comment by-mbck ">

				<p class="commentcredit">

					<span class="commenter">Mbck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219640">
						April 24, 2014 12:46 PM					</a>

				</p>

				<p>@Nick P</p>
<p>Sorry about the dead link &#8212; I just tried this one  &#8212; <a href="http://jack.hoa.org/hoajaa/BurrMain.html" rel="nofollow ugc">http://jack.hoa.org/hoajaa/BurrMain.html</a> &#8212; which, from here, is live.</p>
<p>Some quick notes, and more thanks&#8230;</p>
<ul>
<li>Yes, MCP-on-Intel is emulated.  From what I remember, and which is somewhat confirmed in Allweiss&#8217;s notes, this is the result of an effort to formally document the instruction set for Large Systems &#8211; &#8220;e-Mode&#8221; for &#8220;emulated mode&#8221;.  Up to the B6900, each machine model was slightly different from the others, because of the changes in the type of logic being used &#8211; that world was changing fast then.  </li>
</ul>
<p>It did not matter too much, since the Burroughs compilers were very fast and everything was available as source code: you got a new iron, brought up a minimal MCP that ran on the intersection of all instruction sets (&#8230;), compiled the compiler for that specific box, then compiled the MCP, the libraries, &#8230; and eventually the application programs.  Still if an installation had several boxes, it was a nuisance.</p>
<p>I would put e-Mode in the same class as p-code.  Java tries to be much more, emulates much more than just an instruction set, and gets immensely complicated because of that.</p>
<p>But I agree: what we need is not toe revive the B5500 product line with all its warts and limitations, but to sresume learning about NUMA, block-structured languages, and proper encapsulation as close to the hardware as possible.</p>
<ul>
<li>Cactus stacks and Tandem.  I quickly looked at the article; while the need for a &#8220;cactus stack&#8221; exists both in any complex MCP program and in the environment thewy describe, they apparently serve different purposes.  The Tandem article does not even reference Large Systems.  Interesting other anecdotes:  at Burroughs, I heard the tale that one of the Tandem architects was one of Burroughs&#8217; own hardware developers &#8211; never could verify, and now I do not remember his name.  Wikipedia pays tribute to the B5500/6800, but traces Trandem back only to the HP3000.</li>
<li>C, HLLs and Assemblers.  For what I remember, the main push for C in early UNIX was to write as much as possible in a portable language.  There were a few parts of the OS that were written in PDP-11 machine language, but I would say about 2%.  The emphasis was on extensibility, portability and reasonable efficiency.</li>
</ul>
<p>C delivered on most counts.  For extensibility, it forgot about adding language constructs for addressing new domains, relying on libraries instead.  Portability was actually limited to 8-bit-byte addressable machines &#8212; I remember an attempt to port UNIX to a VARIAN620, word addressable, no good.  But the industry eventually went to byte-addressability and the problem went away.</p>
<p>Secure programming was not a big concern; space was, since the design was for a machine that could only address 64Kbytes per process space.  Hence things like zero-terminated strings and the presence of strcpy in the libraries.</p>
<p>We should learn from the car industry.  They also started competing on speed (and luxury) with little attention to reliability and safety; they came a long way.  Hopefully Computer practice will, too.</p>
<p>Just like thirty years ago the slogan was &#8220;quality is free&#8221;, we should say that &#8220;security is free&#8221; as well.  Will take twenty years.</p>
<p>&#8230;</p>
<p>Cheers!</p>
<p>Cheers!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219641">

			<div class="comment by-bryo ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bryo.ca/heartbleed-openssl-funding-linux-foundation-core-infrastructure-initiative/' rel='external nofollow ugc' class='url'>Bryo</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219641">
						April 30, 2014 2:50 PM					</a>

				</p>

				<p>Catastrophic is, indeed, the right word. Luckily the Linux Foundation intervened and will be getting more much-needed funding for OpenSSL. It&#8217;s definitely a step in the right direction.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219642">

			<div class="comment by-katie ">

				<p class="commentcredit">

					<span class="commenter">katie</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219642">
						May 4, 2014 2:06 PM					</a>

				</p>

				<p>I have openssl v 1.0.1f and openvpn 2.0.5 installed and am still not vulnerable, do you know any solutions to make my server vulnerable? Thanks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219643">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219643">
						May 4, 2014 11:12 PM					</a>

				</p>

				<p>@katie</p>
<blockquote><p>I have openssl v 1.0.1f and openvpn 2.0.5 installed and am still not vulnerable, do you know any solutions to make my server vulnerable? Thanks</p></blockquote>
<p>First thing&#8217;s first, if you have any sort of device in between your server and the connection from your service provider, please remove it now! Then, disable (or open all ports for) any software based firewalls on the server. Obviously, if you have implemented any IPS solutions, you&#8217;ll want to uninstall those as well&#8230; There is an exception to these rules however; if the system is fairly common and especially if it has an internet facing administration portal, you may want to leave it running with the default username and password. Submit the publically available address to some of the major search engines for extra credit! 😉</p>
<p>Another step you may wish to take is enabling anonymous and (if your OS allows it) passwordless account access. If you&#8217;re operating a *nix system, you may try running <code>passwd -d root</code> and if you are running an SSH service (if you&#8217;re not, go ahead and do that now) you will probably also be interested in the &#8216;PermitEmptyPasswords&#8217; &amp; &#8216;PermitRootLogin&#8217; directives. Actually not 100% sure about that advice though&#8230; No-password logins may be rare enough that you&#8217;d be better off using a very common password, like &#8216;password&#8217; or &#8216;12345&#8217; &#8211; your mileage may vary.</p>
<p>One way to test the optimal &#8211; I&#8217;ll just call it &#8216;ownability&#8217; for the purpose of our discussion &#8211; level of your system, is by setting up some so-called honeypots. These may be real or virtual servers designed to function exactly like your real server except for a few key differences&#8230; For example, you may have no password set on your main server, while on your honeypots, you can try various common words &amp; phrases. Pay close attention to the logs, and if it appears that any of these potential passwords are likely to result in more efficient ownability, you may consider changing the password on the server you wish to be more vulnerable&#8230;</p>
<p>This last tidbit of advice is by no means the least, and it will certainly require more vigilance than many other security-avoidance techniques! You should constantly scan the bug fixes, errata, and patch notes from the developers of the operating system you&#8217;re using. Also see the CVE lists compiled by the <a href="https://cve.mitre.org" rel="nofollow ugc">MITRE Corporation</a> and the U.S. DHS&#8217;s <a href="https://nvd.nist.gov" rel="nofollow ugc">NVD</a>. If your configuration seems vulnerable (even better, test it yourself!) you&#8217;re pretty much golden, though you&#8217;ll need to stay away of any patches that could close these holes&#8230; Bonus points if you go out of your way to install vulnerable versions of network services! (Their &#8216;threat scores&#8217; aren&#8217;t always an appropriate measure, so you&#8217;ll want to remain alert for descriptive phrases such as &#8216;arbitrary code execution&#8217; and &#8216;remotely exploitable&#8217;)</p>
<p>If this feels daunting at first, fret not! You can always take it one step at a time&#8230; and you may find some solace in knowing that your server was likely delivered from the factory in a vulnerable state thanks to an arrangement between any one of your favorite TLA&#8217;s and a manufacturer near you! 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219644">

			<div class="comment by-t ">

				<p class="commentcredit">

					<span class="commenter">T</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219644">
						May 4, 2014 11:40 PM					</a>

				</p>

				<p>@Buck<br />
Katie wouldn&#8217;t get hacked with that setup, I don&#8217;t think anyone would, not even from worms 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219645">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219645">
						May 4, 2014 11:46 PM					</a>

				</p>

				<p>@ Buck</p>
<p>LMAO. That&#8217;s the most epic treatment of the topic I&#8217;ve seen to date. I&#8217;m adding it to my link collection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219646">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219646">
						May 5, 2014 1:04 AM					</a>

				</p>

				<p>@ T</p>
<p>Actually, Katie&#8217;s rig following Buck&#8217;s advice to the letter might be totally secure from remote attackers. I just noticed this one imperfection in his scheme:</p>
<p>&#8220;First thing&#8217;s first, if you have any sort of device in between your server and the connection from your service provider, please remove it now! &#8221;</p>
<p>Service providers typically ship a device, like a modem, that sits between the &#8220;server and the connection from&#8230; service provider.&#8221; Removing it disables the Internet. Removing the Internet should make the system quite secure from Internet threats, which make up 99+% of attacks. 😉</p>
<p>Of course, the system will still have trouble if it <em>also</em> has built-in wireless that automatically (and conveniently!) connects to nearby access points. <em>cough</em> Mac OS X <em>cough</em> I figure the latter feature would be included in Buck&#8217;s recommendations if they covered wireless networking.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219647">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219647">
						May 5, 2014 1:31 AM					</a>

				</p>

				<p>@ Buck,</p>
<blockquote><p>First thing&#8217;s first,..</p></blockquote>
<p>Nice! No more half-backed security 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219648">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219648">
						May 5, 2014 9:56 AM					</a>

				</p>

				<p>@Buck</p>
<p>I think you have stumbled across a new security paradigm called &#8220;security through visibility&#8221;. I believe, by manipulating attackers&#8217; sense of suspicion, this will turn out to be a vastly superior strategy to security through obscurity. If your system is too easy to break into&#8211;your system appears to be the lowest of the low-hanging fruit&#8211; bad guys will suspect a trap and stay away. It also keeps the NSA from snooping around as your level of NSA-suspiciousness is directly proportional to the number and sophistication of the security controls you have implemented. As the saying goes, you have nothing to fear if you appear to have nothing to hide.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219657">

			<div class="comment by-pax ">

				<p class="commentcredit">

					<span class="commenter">pax</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219657">
						September 22, 2014 6:32 PM					</a>

				</p>

				<p>I tried changing passwords, over 30 antivirus, malware &amp; firewall options none detected it. Uninstalling app they just restored it, factory reset they kept wot they wanted &amp; deleted the rest lost all music &amp; photos but they kept my phone numbers. Changing settings to no avail. Trying to delete scripts &amp; logs they created makes them really vicious. They eat through yr data rapidly. even stopped me from opening my dialler to phone an ambulance. This was my 1st android/web phone, I saved for 2 years for it &amp; it lasted 2 months taking my laptop &amp; $$$ DL optus music with it. Worse birthday present ever. My heart bleeding that&#8217;s for sure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219658">

			<div class="comment by-pax ">

				<p class="commentcredit">

					<span class="commenter">pax</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219658">
						September 22, 2014 7:04 PM					</a>

				</p>

				<p>I forgot to mention in my opinion on the scripts they create this is a company not an individual. They set up marketing EULA licensing agreements sent to mailing lists beginning from my contacts &amp; expanding, twitter, fb, you tube etc. They have wallet payments accepted. My laptop turned into some form of on-line gamers sys were they even cleaned out help files/menus &amp; had halo &amp; shrek &#8216;latest versions available&#8217; instead. My phone tho seems to fav Google apps &amp; androids?!  I&#8217;m a complete novice wen it comes to this device (didn&#8217;t get a change to learn it) and am bamoozalled where oss appeared from to start with. so this is my opinion only. I have no facts just a headache from trying to read scripts &amp; chasing androids around night after sleepless night trying desperately to kill the little glitter. I hope you all have better luk than I did. And bugger those responsible for truly ruining what could b an absolute delight.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219660">

			<div class="comment by-ludovic-f-rembert ">

				<p class="commentcredit">

					<span class="commenter">Ludovic F. Rembert</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219660">
						April 19, 2019 9:05 AM					</a>

				</p>

				<p>Heartbleed seems like a distant memory by now&#8230; but at the time it affected our entire group at Symantec. We were all using an enterprise version of Cisco&#8217;s OpenVPN at the time (OpenSSL-based), and immediately had to test our entire network for any vulnerabilities enabled by the bug as both Cisco and Juniper VPNs were affected &#8211; <a href="https://www.zdnet.com/article/cisco-juniper-products-affected-by-heartbleed/" rel="nofollow ugc">https://www.zdnet.com/article/cisco-juniper-products-affected-by-heartbleed/</a></p>
<p>Coincidentally, my wife was using <a href="https://privacycanada.net/vyprvpn-review/" rel="nofollow ugc">VyprVPN&#8217;s SSL VPN</a> at the time, which somehow managed to escape unscathed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219661">

			<div class="comment by-globex-it-solutions ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.globexitsolutions.com/' rel='external nofollow ugc' class='url'>Globex IT Solutions</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219661">
						October 22, 2019 8:24 AM					</a>

				</p>

				<p>The Heartbleed bug was initially discovered by an engineer from Google named &#8220;Neel Mehta&#8221; and the Finnish security firm Codenomicon. The security flaw was introduced in the open source OpenSSL encryption protocol by German software developer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219662">

			<div class="comment by-techopti ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://techopti.com/' rel='external nofollow ugc' class='url'>TechOpti</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219662">
						December 31, 2019 4:57 AM					</a>

				</p>

				<p>Heartbleed&#8217;s mainly used by hackers to access sensitive information on the web servers. Also, it caused by a flaw in openssl. To understand Heartbleed, you first need to understand how SSL/TLS protocol works.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219663">

			<div class="comment by-techbeon ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://techbeon.com/' rel='external nofollow ugc' class='url'>Techbeon</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219663">
						February 14, 2020 2:41 PM					</a>

				</p>

				<p>Sensitive information is highly affected by heartbleed. SSL and TSL understanding is needed to know heartblead.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219664">

			<div class="comment by-thegeniustips ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://thegeniustips.com/' rel='external nofollow ugc' class='url'>thegeniustips</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-219664">
						July 25, 2020 12:35 AM					</a>

				</p>

				<p>Superb post thanks for sharing</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-360308">

			<div class="comment by-healing-arenaa ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://healingarenaa.com' rel='external nofollow ugc' class='url'>Healing Arenaa</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-360308">
						December 10, 2020 8:25 AM					</a>

				</p>

				<p>Very nIce great Post good information</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-360310">

			<div class="comment by- ">

				<p class="commentcredit">

					<span class="commenter">-</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/#comment-360310">
						December 10, 2020 8:42 AM					</a>

				</p>

				<p>@ Moderator,</p>
<p>The above,</p>
<p>1, Globex IT Solutions<br />
2, TechOpti<br />
3, Techbeon<br />
4, thegeniustips<br />
5, Healing Arenaa</p>
<p>Are all unsolicited advertising.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/04/heartbleed.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F04%2Fheartbleed.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/04/heartbleed.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5301' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/04/unbreakable_enc.html" rel="prev">← "Unbreakable" Encryption Almost Certainly Isn&#039;t</a>		<a href="https://www.schneier.com/blog/archives/2014/04/police_disablin.html" rel="next">Police Disabling Their Own Voice Recorders →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
