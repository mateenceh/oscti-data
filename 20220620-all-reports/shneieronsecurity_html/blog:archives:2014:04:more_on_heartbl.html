<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>More on Heartbleed - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; More on Heartbleed Comments Feed" href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5303" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5303' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F04%2Fmore_on_heartbl.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F04%2Fmore_on_heartbl.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5303 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5303" class="post-5303 post type-post status-publish format-standard hentry category-uncategorized tag-internet tag-keys tag-passwords tag-patching tag-ssl tag-vulnerabilities tag-web">

	<div class="article">

		<h2 class="entry">More on Heartbleed</h2>
		<p>This is an update to my <a href="https://www.schneier.com/blog/archives/2014/04/heartbleed.html">earlier</a> post.</p>
<p>Cloudflare is <a href="http://.cloudflare.com/answering-the-critical-question-can-you-get-private-ssl-keys-using-heartbleed">reporting</a> that it&#8217;s very difficult, if not practically impossible, to steal SSL private keys with this attack.</p>
<blockquote><p>Here&#8217;s the good news: after extensive testing on our software stack, we have been unable to successfully use Heartbleed on a vulnerable server to retrieve any private key data. Note that is not the same as saying it is impossible to use Heartbleed to get private keys. We do not yet feel comfortable saying that. However, if it is possible, it is at a minimum very hard. And, we have reason to believe based on the data structures used by OpenSSL and the modified version of NGINX that we use, that it may in fact be impossible.</p></blockquote>
<p>The reasoning is complicated, and I suggest people read the post.  What I have heard from people who actually ran the attack against a various servers is that what you get is a huge variety of cruft, ranging from indecipherable binary to useless log messages to peoples&#8217; passwords.  The variability is huge.</p>
<p><a href="http://xkcd.com/1354/">This</a> xkcd comic is a very good explanation of how the vulnerability works.  And <a href="http://dankaminsky.com/2014/04/10/heartbleed/">this post</a> by Dan Kaminsky is worth reading.</p>
<p>I have a lot to say about the human aspects of this: auditing of open-source code, how the responsible disclosure process worked in this case, the ease with which anyone could weaponize this with just a few lines of script, how we explain vulnerabilities to the public &#8212; and the role that impressive logo played in the process &#8212; and our certificate issuance and revocation process.  This may be a massive computer vulnerability, but all of the interesting aspects of it are human.</p>
<p>EDITED TO ADD (4/12):  We have <a href="https://www.cloudflarechallenge.com/heartbleed">one example</a> of someone successfully retrieving an SSL private key using Heartbleed.  So it&#8217;s possible, but it seems to be much harder than we originally thought.</p>
<p>And we have a <a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html">story</a> where two anonymous sources have claimed that the NSA has been exploiting Heartbleed for two years.</p>
<p>EDITED TO ADD (4/12):  <a href="https://www.mattslifebytes.com/?p=533">Hijacking user sessions</a> with Heartbleed.  And a nice <a href="http://www.kalzumeus.com/2014/04/09/what-heartbleed-can-teach-the-oss-community-about-marketing/">essay</a> on the marketing and communications around the vulnerability</p>
<p>EDITED TO ADD (4/13):  The US intelligence community has <a href="http://icontherecord.tumblr.com/post/82416436703/statement-on-bloomberg-news-story-that-nsa-knew">denied</a> prior knowledge of Heatbleed.  The statement is word-game free:</p>
<blockquote><p>NSA was not aware of the recently identified vulnerability in OpenSSL, the so-called Heartbleed vulnerability, until it was made public in a private sector cybersecurity report. Reports that say otherwise are wrong.</p></blockquote>
<p>The statement also says:</p>
<blockquote><p>Unless there is a clear national security or law enforcement need, this process is biased toward responsibly disclosing such vulnerabilities.</p></blockquote>
<p>Since when is &#8220;law enforcement need&#8221; included in that decision process?  This national security exception to law and process is extending much too far into normal police work.</p>
<p>Another point.  According to the <a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html">original Bloomberg article</a>:</p>
<blockquote><p>http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html</p></blockquote>
<p>Certainly a plausible statement.  But if those millions didn&#8217;t discover something obvious like Heartbleed, shouldn&#8217;t we investigate them for incompetence?</p>
<p>Finally &#8212; not related to the NSA &#8212; <a href="https://zmap.io/heartbleed/">this</a> is good information on which sites are still vulnerable, including historical data.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/internet/" rel="tag">Internet</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/passwords/" rel="tag">passwords</a>, <a href="https://www.schneier.com/tag/patching/" rel="tag">patching</a>, <a href="https://www.schneier.com/tag/ssl/" rel="tag">SSL</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a>, <a href="https://www.schneier.com/tag/web/" rel="tag">web</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html" rel="bookmark">Posted on April 11, 2014 at 1:10 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html#comments">178 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html" data-title="More on Heartbleed" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-219712">

			<div class="comment by-walter ">

				<p class="commentcredit">

					<span class="commenter">Walter</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219712">
						April 11, 2014 1:26 PM					</a>

				</p>

				<p>The problem is that this &#8220;attack&#8221; doesn&#8217;t leave traces (or, in real life, it&#8217;s very hard to find someone that would store all data served from their servers in some log). Even if it was hard to leak the private key, that doesn&#8217;t exclude the possibility that some other attack could make a server reboot (or perhaps using so much memory allocation that the server could swap something to the disk and read again in the upper memory) so that it would be easier to get such keys.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219713">

			<div class="comment by-matthew-weigel ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://idempot.net/blog/' rel='external nofollow ugc' class='url'>Matthew Weigel</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219713">
						April 11, 2014 1:41 PM					</a>

				</p>

				<p>Reading the CloudFlare article, I don&#8217;t think they are saying &#8220;Heartbleed probably can&#8217;t be used to acquire private keys.&#8221; I think they are saying &#8220;Heartbleed probably can&#8217;t be used to acquire private keys from OUR systems.&#8221;  Can anyone say that unmodified Nginx has the same characteristics?  What about Apache?  (Which version?)  What about Lighttpd, Dovecot, Sendmail, Exim, Postfix, Courier, OpenLDAP, and every other application that implements a standard protocol that is often or typically protected with SSL as implemented by OpenSSL?</p>
<p>What about the reports I&#8217;ve seen elsewhere that &#8220;first SSL connection after process start&#8221; might be the one that can get an SSL key &#8211; does CloudFlare&#8217;s &#8220;hack me&#8221; stunt address that possibility?  (I don&#8217;t believe it does.)</p>
<p>That adds a lot of nuance, and points toward having a lot more factors you may want to consider in determining your response.  However, the complexity and number of factors to investigate before developing confidence that in no way are you secret keys at risk leads me to think that you may be better off just assuming that your secret keys are at risk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219714">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219714">
						April 11, 2014 1:45 PM					</a>

				</p>

				<p>Walter, it is leaking memory from the current process. So what leaks will depend on architecture details and memory layout and precise details of code. Most OSes protect against reading memory that is freshly allocated to stop one process reading data other processes had in memory, so what is paged to disk should be irrelevant. I can quite believe on tightly written code SSL key is read once, never freed, and a long way from user activity in RAM.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219715">

			<div class="comment by-edan-maor ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.purplebit.com' rel='external nofollow ugc' class='url'>Edan Maor</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219715">
						April 11, 2014 1:50 PM					</a>

				</p>

				<p>I think Patrick McKenzie&#8217;s post on the marketing aspects of this was particularly insightful. E.g. the logo, the webpage, the name, and how they all contributed to this being &#8220;solved&#8221;.</p>
<p><a href="http://www.kalzumeus.com/2014/04/09/what-heartbleed-can-teach-the-oss-community-about-marketing/" rel="nofollow ugc">http://www.kalzumeus.com/2014/04/09/what-heartbleed-can-teach-the-oss-community-about-marketing/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219716">

			<div class="comment by-bob-t ">

				<p class="commentcredit">

					<span class="commenter">bob t</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219716">
						April 11, 2014 2:04 PM					</a>

				</p>

				<p>The real problem is that this will go out into the media and people will start receiving emails that say. &#8220;Hello Facebook User, Due to the Heartbleed vulnerability we are asking all of our users to click here (badguys.com) to reset your password immediately, or your account will be closed in 24 hours. Sincerly, Facebook Administrator&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219717">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219717">
						April 11, 2014 2:04 PM					</a>

				</p>

				<p>That article about the marketing aspects of heartbleed triggered the following indirect chain of reasoning in me:</p>
<p>Doesn&#8217;t the name &#8220;heartbleed&#8221; remind quite a bit of an NSA codename (two simple words combined to create an easy to remember unique codename)?</p>
<p>OK, maybe such codenames have just come into fashion (or have already been in other organizations?), but let&#8217;s still suppose for fun that the NSA knew about the vulnerability for at least a week longer than the public and had some time to investigate what it can do worst case.</p>
<p>Now, under those circumstances, would &#8220;heartbleed&#8221; seem more appropriate for a backdoor that can reveal only passwords or for one that can also reveal private keys?</p>
<p>Would seem that the codename would fit the latter case better, but I guess that is not certain even under the assumptions made here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219718">

			<div class="comment by-ryan-ries ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://myotherpcisacloud.com' rel='external nofollow ugc' class='url'>Ryan Ries</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219718">
						April 11, 2014 2:05 PM					</a>

				</p>

				<p>I&#8217;ve already got about half of their private key, and I&#8217;ve only been at it for ~ 3 hours.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219719">

			<div class="comment by-ryan-ries ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://myotherpcisacloud.com' rel='external nofollow ugc' class='url'>Ryan Ries</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219719">
						April 11, 2014 2:05 PM					</a>

				</p>

				<p>From the challenge they issued, by the way: <a href="https://www.cloudflarechallenge.com/heartbleed" rel="nofollow ugc">https://www.cloudflarechallenge.com/heartbleed</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219720">

			<div class="comment by-darragh-delaney ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.netfort.com' rel='external nofollow ugc' class='url'>Darragh Delaney</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219720">
						April 11, 2014 2:10 PM					</a>

				</p>

				<p>Hi Bruce,<br />
We have just released an update to our LANGuardian product which can detect SSL/TLS servers and alert if it detects Heartbleed exploits. It uses packet data as a source. I can arrange to get you a personal copy of this software if you want it for test purposes.</p>
<p>Darragh</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219721">

			<div class="comment by-peter-a ">

				<p class="commentcredit">

					<span class="commenter">Peter A.</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219721">
						April 11, 2014 2:15 PM					</a>

				</p>

				<p>@nobody: hacker community likes such word-games, where deliberate misprounonciation or misspelling makes comical, topical, or otherwise meaniningful and &#8220;witty&#8221; result. So this &#8220;heartbeat &#8211; heartbleed&#8221; alteration is of no surprise and very much in style.</p>
<p>Some very old examples are here: <a href="http://www.catb.org/jargon/html/soundalike-slang.html" rel="nofollow ugc">http://www.catb.org/jargon/html/soundalike-slang.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219722">

			<div class="comment by-alext ">

				<p class="commentcredit">

					<span class="commenter">AlexT</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219722">
						April 11, 2014 2:21 PM					</a>

				</p>

				<p>In case anyone missed it: <a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html" rel="nofollow ugc"></p>
<p>Now if this is true &#8211; and I&#8217;d be really suprised if Bloomberg doesn&#8217;t have some grounds to put this out &#8211; I guess it&#8217;s really game over.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219723">

			<div class="comment by-walter ">

				<p class="commentcredit">

					<span class="commenter">Walter</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219723">
						April 11, 2014 2:23 PM					</a>

				</p>

				<p>@AlexT: Do you mean the &#8220;Millions of Android Devices Vulnerable to Heartbleed Bug&#8221; or the &#8220;NSA Said to Have Used Heartbleed Bug, Exposing Consumers&#8221; ? Or even the &#8220;Heartbleed Found in Cisco, Juniper Networking Products&#8221; ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219724">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219724">
						April 11, 2014 2:24 PM					</a>

				</p>

				<p>This?</p>
<p><a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html" rel="nofollow ugc">http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219725">

			<div class="comment by-lgw ">

				<p class="commentcredit">

					<span class="commenter">LGW</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219725">
						April 11, 2014 2:27 PM					</a>

				</p>

				<p>I&#8217;m guessing AlexT is linking the Bloomberg article about the NSA.  I&#8217;m guess I can&#8217;t link it either, so here&#8217;s the key snippet (is anyone surprised?):</p>
<p>The U.S. National Security Agency knew for at least two years about a flaw in the way that many websites send sensitive information, now dubbed the Heartbleed bug, and regularly used it to gather critical intelligence, two people familiar with the matter said.</p>
<p>The NSA’s decision to keep the bug secret in pursuit of national security interests threatens to renew the rancorous debate over the role of the government’s top computer experts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219726">

			<div class="comment by-tuck ">

				<p class="commentcredit">

					<span class="commenter">Tuck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219726">
						April 11, 2014 2:28 PM					</a>

				</p>

				<p>I once used a free-ware CD ripper.  It had one restriction: it would only rip half the tracks on the CD, and it picked them at random.  I thought I could live with that, but I quickly paid for the full version.</p>
<p>I suspect that this exploit is only going to be marginally useful: unless you get lucky, you&#8217;re going to have to hit the server so many times that it would probably be equivalent to a DoS attack&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219727">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219727">
						April 11, 2014 2:55 PM					</a>

				</p>

				<p>@Peter A.<br />
&#8220;So this &#8220;heartbeat &#8211; heartbleed&#8221; alteration is of no surprise and very much in style&#8221;</p>
<p>Hmn, coming to think of it &#8211; &#8220;Herzblut&#8221; (n.) or &#8220;herzbluten&#8221; (v.) is a common German term to express something of a very vital nature &#8211; &#8220;herzbluten&#8221; literally translated would be &#8220;to heartbleed&#8221;.</p>
<p>So maybe even a German speaking origin of the term? Would not be unexpected with the developer being German if it was a planted backdoor, maybe?</p>
<p>But, of course, this is speculation, for example one of the discoverers of the bug could have known German well enough, etc.</p>
<p>Still, conspiracy theorists have recently been more often provably right since Snowden, so I remain curious&#8230; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219728">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219728">
						April 11, 2014 3:03 PM					</a>

				</p>

				<p>What we need is some sort of security agency on the national level that hires all the best hackers and cryptographers and tries to find flaws in protocols and software that are used by the government (as well as major players in the private sector), and then works to get them fixed as soon as possible. If we had an agency doing this, then maybe it wouldn&#8217;t have become so widespread before being fixed. It seems like that is in the best interest of our national and economic security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219729">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219729">
						April 11, 2014 3:07 PM					</a>

				</p>

				<p>&#8220;Now if this is true &#8211; and I&#8217;d be really suprised if Bloomberg doesn&#8217;t have some grounds to put this out &#8211; I guess it&#8217;s really game over.&#8221;</p>
<p>Hmn, maybe America is still &#8220;working&#8221; in the sense that excessive power is not tolerated in the end and reduced &#8211; if regular means do not get you there, you find a different way, like getting Al Capone for tax evasion?</p>
<p>So, a covert operation aiming to expose the NSA as the reason why millions of citizens have to change their passwords and be afraid they could have been stolen, leading in the end to an NSA that has less power and is investing more of its energy into making computer systems more safe than the opposite?</p>
<p>Would be nice, if true &#8211; and if so &#8211; thanks a million to the ones who had the guts to do it 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219730">

			<div class="comment by-knottwhittingley ">

				<p class="commentcredit">

					<span class="commenter">KnottWhittingley</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219730">
						April 11, 2014 3:19 PM					</a>

				</p>

				<p>Just for explicitness, here&#8217;s the first para of what Bloomberg is reporting re Heartbleed:</p>
<p><i>The U.S. National Security Agency knew for at least two years about a flaw in the way that many websites send sensitive information, now dubbed the Heartbleed bug, and regularly used it to gather critical intelligence, two people familiar with the matter said. </i></p>
<p>The NSA declined to comment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219731">

			<div class="comment by-uknowwho ">

				<p class="commentcredit">

					<span class="commenter">UKNOWWHO</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219731">
						April 11, 2014 3:23 PM					</a>

				</p>

				<p>Rumor around the office is that &#8220;somebody who knows somebody over at Google&#8221; says that the scuttlebutt over there is that Google engineers have been monitoring traffic across their private networks, placing &#8216;tag&#8217; data in the stream, then looking for this tag data moving across other networks using stealth taps of their own.</p>
<p>Sure enough, they saw copies of (or at least hashes of) their data where it shouldn&#8217;t be and investigated.</p>
<p>Kind of makes sense.  I guess the NSA is going to have to start encrypting THEIR private data links!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219732">

			<div class="comment by-lol ">

				<p class="commentcredit">

					<span class="commenter">LOL</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219732">
						April 11, 2014 3:24 PM					</a>

				</p>

				<p>This on Bloomberg:</p>
<p><a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html" rel="nofollow ugc">http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219733">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219733">
						April 11, 2014 3:28 PM					</a>

				</p>

				<p>Re: Bloomberg Article</p>
<p>Unless we have leaked documents or something other than anonymous sources, I think we should proceed with caution. I mean, it fits in with everything we&#8217;ve learned, but what I want is solid proof. If we have that, we can make a case that the NSA is actually hurting national security, with a widely publicized exploit to go with it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219734">

			<div class="comment by-anondev ">

				<p class="commentcredit">

					<span class="commenter">AnonDev</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219734">
						April 11, 2014 3:30 PM					</a>

				</p>

				<p>KnottWhittingley • April 11, 2014 3:19 PM wrote:</p>
<p>&#8220;Just for explicitness, here&#8217;s the first para of what Bloomberg is reporting re Heartbleed:</p>
<p>The U.S. National Security Agency knew for at least two years about a flaw&#8221;</p>
<p>Sure. With the number of employees they have I think we can assume they are sitting on top of every code repository of any significance and in real-time examining any checkins for anything useful.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219735">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219735">
						April 11, 2014 3:30 PM					</a>

				</p>

				<p>As someone who isn&#8217;t a computer engineer or anything, I want to ask:</p>
<p>Can/could the Heartbleed bug be used to attack anyones computer that make use of the flawed OpenSSL code and simply solicit for memory content on that machine and probably aquire any data related to whaterver usernames and passwords are being cirulated on that machine throughout the day? (Basicly learning every username and passwords a user might have.)</p>
<p>Like, an attacker coming up with an excuse for contacting anyones client machine that happens to require a secure connection over SSL.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219736">

			<div class="comment by-the-george-john-dasch-medal-for-valor ">

				<p class="commentcredit">

					<span class="commenter">The George John Dasch Medal for valor</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219736">
						April 11, 2014 3:33 PM					</a>

				</p>

				<p>Oh boy, the next Snowden! An illegal, TOP SECRET disclosure by an NSA insider threat, to their criminal accomplices at Bloomberg.</p>
<p>&#8220;The agency found the Heartbleed glitch shortly after its introduction.&#8221;</p>
<p>This new whopper shows NSA&#8217;s hysterical panic. Even Rogers, dumbest American commander since William Winder, can dimly sense that his agency is in deep deep shit. If this historic goat rope threatens to run into money, NSA is going to get rolled up like the Diocese of Fairbanks. To protect NSA from summary liquidation, Rogers is fecklessly attempting to characterize NSA sabotage as a catastrophically destructive wrongful omission instead of an act. As if that&#8217;s going to make a difference once the open-source evidence gets arrayed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219738">

			<div class="comment by-anondev ">

				<p class="commentcredit">

					<span class="commenter">AnonDev</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219738">
						April 11, 2014 3:35 PM					</a>

				</p>

				<p>UKNOWWHO re Google scuttlebutt</p>
<p>It is interesting that there still seems to be no official advice or statement from Google to change passwords, as of now their security blog still states:</p>
<p>&#8220;We’ve assessed this vulnerability and applied patches to key Google services such as Search, Gmail, YouTube, Wallet, Play, Apps, and App Engine.  Google Chrome and Chrome OS are not affected. We are still working to patch some other Google services.&#8221;</p>
<p>(From <a href="http://googleonlinesecurity.blogspot.com/" rel="nofollow ugc">http://googleonlinesecurity.blogspot.com/</a> )</p>
<p>Maybe they are hinting they still do not know all the implications.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219739">

			<div class="comment by-pete ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/pnschmidt' rel='external nofollow ugc' class='url'>Pete</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219739">
						April 11, 2014 3:36 PM					</a>

				</p>

				<p>Here&#8217;s how you access private keys:</p>
<ol>
<li>Send legitimate heartbleed packets to an array of hosts at port 443 once every 30 seconds or so.</li>
<li>When you detect packet loss on 443 traffic to a site (indicating a restart), start pinging that IP with heartbleed messages.</li>
<li>Returned packets may contain a portion of the private key, e.g., for Apache servers on restart.</li>
<li>Solve for private key either through serial application of this process or by using a portion of the private key to seed a brute-force factoring of the public key.</li>
</ol>
<p>It seems unlikely that anyone but the NSA or a major backbone provider could put the pieces in place to do this &#8212; there would be very low yield, but for actions that can be automated, very difficult == possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219740">

			<div class="comment by-bleedingheart ">

				<p class="commentcredit">

					<span class="commenter">BleedingHeart</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219740">
						April 11, 2014 3:43 PM					</a>

				</p>

				<p>The bottom line is this:  Computers are not secure and probably never will be secure.  This is especially true when you have an agency with billions to spend subverting your security (and an agency that can compel software and hardware makers by LAW to cooperate). The game is fixed.  We are playing against the house, and the house laughs at us as we play games that return negative expected value. Sure, we might win a game here and there, but it&#8217;s just an illusion.  Just like in Vegas, if you play long enough, you will lose money over the long-run.</p>
<p>I have a feeling that the Snowden documents are just the tip of the iceberg.  I bet the NSA is dug deep into every major piece of security sensitive software and hardware (no doubt Apple and Microsoft are cooperating).  I doubt there is any hardware (or software) that is not subverted.  This includes open-source.  We have to assume <em>everything</em> we say or do electronically can be seen or heard by NSA (and it seems this is no exaggeration).  Two years ago people would say &#8220;paranoid&#8221; or &#8220;tin-foil hat.&#8221;  Now the tin-foilers are yelling &#8220;told you so.&#8221;</p>
<p>The best we can do is to fix major flaws that allow script kiddies to steal CC numbers.  However, we will never stop determined, smart, and well funded adversaries.  Simply won&#8217;t happen.  Sure, we might have an illusion of security, but you can bet your ass that NSA (and others) will always work to subvert it behind closed doors. We may find a flaw like heartbleed, patch it, and give a sigh of relief.  The truth is, it is just one exploit out of NSA&#8217;s <em>thousands</em> of critical flaws that do the same thing.  The Heartbleed fix has done nothing to thwart NSA surveillance.</p>
<p>I never believed NSA&#8217;s &#8220;dual mission.&#8221;  That is just a front for their intelligence gathering; a means to placate the skeptics and to fool foreign governments.  Now we know that all along they were rigging encryption standards (something I have always suspected).  I don&#8217;t trust any crypto that is NSA vetted.  Now I even question AES.  What NSA has given us is crypto that can keep secrets from your kid sister.  That&#8217;s about all it&#8217;s good for.</p>
<p>Moral of the story: do not do or say anything on the Internet (even if it is heavily encrypted) that you do not want made public to the world.  Period.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219741">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219741">
						April 11, 2014 3:53 PM					</a>

				</p>

				<p>&#8220;NSA knew&#8221; story</p>
<p>If it&#8217;s true that the NSA has been aware of and has used Heartbleed since right after it was introduced, that&#8217;s quite a revealing fact.</p>
<p>It implies that the NSA has a large staff of programmers who do nothing but search open-source code for new vulnerabilities.  I&#8217;m thinking dozens to hundreds of folks who constantly pull GIT and SVN updates from open-source project as they are submitted and then review them for weaknesses.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219742">

			<div class="comment by-just-an-australian ">

				<p class="commentcredit">

					<span class="commenter">Just an Australian</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219742">
						April 11, 2014 3:56 PM					</a>

				</p>

				<p>Are the authors of openSSL aware that it is critical public infrastructure subjet to active attack? Have they heard of the kind of engineering you do in response to this? Have they heard about TDD? Have all the people who used openSSL in spite of it&#8217;s shoddiness heard of these questions too?</p>
<p>I&#8217;m a user if openSSL. But not for long&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219743">

			<div class="comment by-knottwhittingley ">

				<p class="commentcredit">

					<span class="commenter">KnottWhittingley</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219743">
						April 11, 2014 3:57 PM					</a>

				</p>

				<p>Here&#8217;s Bloomberg&#8217;s Heartbleed-on-Android story:</p>
<p><a href="http://www.bloomberg.com/news/2014-04-11/millions-of-android-devices-vulnerable-to-heartbleed-bug.html" rel="nofollow ugc">http://www.bloomberg.com/news/2014-04-11/millions-of-android-devices-vulnerable-to-heartbleed-bug.html</a></p>
<p>It seems to be only Android 4.1.1 that has the bug.  Android 4.1.x is about a third of the installed Android base, but I don&#8217;t know what fraction of that is 4.1.1</p>
<p>It&#8217;s apparently particularly common in Germany, where there&#8217;s some very popular device still running 4.1.1.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219744">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219744">
						April 11, 2014 3:59 PM					</a>

				</p>

				<p>@Curious</p>
<p>I don&#8217;t think this is a concern. As you have probably gathered, in the vast majority of cases OpenSSL is running on the server side and can dump process memory to anyone who queries the server.</p>
<p>(I think) it&#8217;s pretty uncommon that OpenSSL is the SSL software on the client side &#8211; at least when the client is a browser. Even if OpenSSL was running on your machine (aka the client), the server side would have to exploit Heartbleed &#8211; perhaps navigating to a URL deliberately trying to exploit it (like a phishing link). An attacker wouldn&#8217;t be &#8220;dialing into&#8221; your computer.</p>
<p>Even then, what&#8217;s exposable is OpenSSL&#8217;s working memory at a given moment in time. So more data related to where you&#8217;re visiting &#8220;right now&#8221;, not where you&#8217;ve already been.</p>
<p>Perhaps someone else has comments on this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219745">

			<div class="comment by-the-nsa ">

				<p class="commentcredit">

					<span class="commenter">The NSA</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219745">
						April 11, 2014 4:00 PM					</a>

				</p>

				<p>IF I were the NSA, I&#8217;d definitely plant agents that have the EXACT profile these guys in Europe who checked &amp; approved this code have:</p>
<p>Ph.Ds who have pseudo &#8216;credibility&#8217; in the open-source / security community, who have a (somewhat short) history &#8216;contributing&#8217; fixes.</p>
<p>Just enough credibility to slip a massive &amp; untraceable vulnerability under the rug &amp; &#8216;review&#8217; it.</p>
<p>It should be interesting to watch what journalists turn up on these guys.</p>
<p>Was it a legimitate mistake, or were they NSA agents?  Stay tuned&#8230;</p>
<p>I think the core problem here is that it took only one guy to review and approve the change.  That has got to change.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219746">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219746">
						April 11, 2014 4:14 PM					</a>

				</p>

				<p>Now its on spiegel too:</p>
<p><a href="http://www.spiegel.de/netzwelt/netzpolitik/heartbleed-nsa-soll-sicherheitsluecke-seit-zwei-jahren-nutzen-a-964032.html" rel="nofollow ugc">http://www.spiegel.de/netzwelt/netzpolitik/heartbleed-nsa-soll-sicherheitsluecke-seit-zwei-jahren-nutzen-a-964032.html</a></p>
<p>Would be interested, what the snowden files say on this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219747">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219747">
						April 11, 2014 4:15 PM					</a>

				</p>

				<p>BleedingHeart<br />
&#8211;We all have our days when we feel like giving up, fact of the matter is there is too many ways to relay a message and too much data occurring nonstop everywhere that NSA still won&#8217;t see real threats or &#8220;surprises&#8221;.  The first thing that young college grads can do is, if you&#8217;re recruited by NSA, tell them to suck it.  Destroying the trust of the world in the US and leaving all our products and protocols open to buffer overflows and malicious circuits is not in the interest of national security.  I wonder how much US IP has been stolen as a direct result of NSA and other contractors letting our tech. infrastructure rot and be neglected.  I recall a recording where NSA was hiring linguists at a college and students actually stood up and called the recruiters out; which they eventually left and had the stupidest arguments.</p>
<p>Next is to begin planning how you want to make a &#8220;basis of trust&#8221;.  It will be layers and steps, as in slowly incrementing towards a nice isolated machine w/ defenses set up.  Me (I&#8217;m just getting my feet wet and won&#8217;t say anything is secure for awhile), mostly Nick P, NWFOR, Petrobras and others are looking towards endpoint security and secure languages.  Network engineers, guys/girls that like networks and nodes, we need new protocols.  Phone networks that get owned trivially, wifi, again it&#8217;s owned w/ tiny scripts as the protocols allow it.  We always need more crypto (Anura&#8217;s looking into that) as OTP&#8217;s are very impractical.</p>
<p>I would say the guys doing it for money, the private security groups, that&#8217;s great; people doing what they love for money.  At the same time, people working on security <em>in their free time</em>, those are the ones that may be a little more trustworthy.  Find an area you think you can contribute (and importantly educate simply to others) and help out.  Not today though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219748">

			<div class="comment by-knottwhittingley ">

				<p class="commentcredit">

					<span class="commenter">KnottWhittingley</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219748">
						April 11, 2014 4:20 PM					</a>

				</p>

				<p>AnonDev:</p>
<p><i>Sure. With the number of employees they have I think we can assume they are sitting on top of every code repository of any significance and in real-time examining any checkins for anything useful.</i></p>
<p>Now that we know about Heartbleed, and that it&#8217;s such an obvious bug, it would indeed have been surprising if the NSA hadn&#8217;t known about it right away.</p>
<p>I am a bit surprised that they sat on it for two years, given that it&#8217;s so obviously a gaping security hole that any code review should have caught.</p>
<p>I would have thought that they have enough less-obvious ways into systems that they&#8217;d rather this one got fixed so nobody else could use it.</p>
<p>Which leaves me wondering.  Do they not actually have all the ways in that I think they do, or do they just prioritize securing the nation&#8217;s infrastructure dead last?</p>
<p>I&#8217;m guessing it&#8217;s not the former.  Heartbleed provides a really easy and convenient way to get into a whole lot of stuff, and they&#8217;ll screw actual <i>national security</i> for their <i>convenience</i>.</p>
<p>That could a lot of powerful corporations unhappy with them, which is good.</p>
<p>It&#8217;s one thing to fuck with mere human rights, but it&#8217;s an entirely other thing to fuck around with <i>business</i>.</p>
<p>I do still have to wonder if the vulnerability was only uncovered because the NSA tipped somebody off, somehow, after noticing that someone else had noticed the vulnerability and started exploiting it too.</p>
<p>I hope they would usually do that, and not keep mum about a major vulnerability they knew was being exploited by hostile countries, criminals, etc.</p>
<p>No matter how cynical I get, though, <i>it&#8217;s never enough</i>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219749">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219749">
						April 11, 2014 4:22 PM					</a>

				</p>

				<p>By the way, is this a coicidence:</p>
<p>Theo de Raadt, of the OpenBSD OpenSSH fame, claims here:</p>
<p><a href="http://thread.gmane.org/gmane.os.openbsd.misc/211952/focus=211963" rel="nofollow ugc">http://thread.gmane.org/gmane.os.openbsd.misc/211952/focus=211963</a></p>
<p>that a malloc protective wrapper, provided for an exploit mitigation,<br />
was intentionally avoided by the openSSL maintainers in order to gain<br />
some performance advantages on some systems &#8211; causing this current<br />
fiasco.</p>
<p>And THAT indeed raises the question whether some devs of openssl get<br />
their money from an agency. Since by deliberately omitting a malloc<br />
protective wrapper, you literally just have to wait for some useful<br />
idiot, who, during a drunken night, makes a mistake and submits<br />
erroneous code.</p>
<p>And here is a similar thing:</p>
<p>This kernel dev is with right proud that he resisted pressure from intel developers, to make the linux random number generator solely dependend on the hardware random number generator:</p>
<p><a href="https://plus.google.com/+TheodoreTso/posts/SDcoemc9V3J" rel="nofollow ugc">https://plus.google.com/+TheodoreTso/posts/SDcoemc9V3J</a></p>
<p>After sometime, he got mails from an claimed redhead dev, with exactly the same argument as these openssl devs were having above: If you would use only the hardware random number generator, then you would have &#8220;better performance&#8221; on &#8220;some systems&#8221;. But the redhead dev does, even after being explicitely questioned, not tell, which systems should run faster, and for which applications a superfast random number generator is of advantage.</p>
<p>If one reads the following discussion, one must get the impression that this redhead developer was bought by some agency:</p>
<p><a href="https://lkml.org/lkml/2013/9/5/212" rel="nofollow ugc">https://lkml.org/lkml/2013/9/5/212</a></p>
<p>On Thu, Sep 05, 2013 at 08:18:44AM -0400, Prarit Bhargava wrote:</p>
<blockquote><p>
  The current code has two exported functions, get_bytes_random() and<br />
  get_bytes_random_arch().  The first function only calls the entropy<br />
  store to get random data, and the second only calls the arch specific<br />
  hardware random number generator.</p>
<p>  The problem is that no code is using the get_bytes_random_arch() and switching<br />
  over will require a significant code change.  Even if the change is<br />
  made it will be static forcing a recompile of code if/when a user has a<br />
  system with a trusted random HW source.  A better thing to do is allow<br />
  users to decide whether they trust their hardare random number generator.
</p></blockquote>
<p>I fail to see the benefit of just using the hardware random number<br />
generator.  We are already mixing in the hardware random number<br />
generator into the /dev/random pool, and so the only thing that using<br />
only the HW source is to make the kernel more vulnerable to an attack<br />
where the NSA leans on a few Intel employee and forces/bribes them to<br />
make a change such that the last step in the RDRAND&#8217;s AES whitening<br />
step is changed to use a counter plus a AES key known by the NSA.</p>
<p>On Thu, Sep 05, 2013 at 11:08:28AM -0400, Prarit Bhargava wrote:</p>
<blockquote><p>
  The issue isn&#8217;t userspace /dev/random as much as it is the use of<br />
  get_random_bytes() through out the kernel.  Switching to<br />
  get_random_bytes_arch()<br />
  is a search&#8217;n&#8217;replace on the entire kernel.  If a user wants the faster random<br />
  HW generator why shouldn&#8217;t they be able to use it by default?
</p></blockquote>
<p>Where is the speed of the random number generator a bottleneck?</p>
<p>In general, adding knobs when users can make what might be<br />
potentially<br />
the wrong chance is very dangerous.  There is a reason why there<br />
aren&#8217;t convenient knobs to allow users to select the use of the MD4<br />
checksum, &#8220;because it might be faster, why shouldn&#8217;t the user be<br />
allowed to shoot themselves in the foot&#8221;?</p>
<p>BTW, note the following article, published today:</p>
<p><a href="http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encrypti" rel="nofollow ugc">http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encrypti</a><br />
on.html?pagewanted=all</p>
<p>&#8220;By this year, the Sigint Enabling Project had found ways inside some<br />
of the encryption chips that scramble information for businesses and<br />
governments, either by working with chipmakers to insert back<br />
doors&#8230;.&#8221;<br />
Relying solely and blindly on a magic hardware random number<br />
generator<br />
which is sealed inside a CPU chip and which is impossible to audit is<br />
a <strong><em>BAD</em></strong> idea.</p>
<p>On Fri, Sep 06, 2013 at 08:08:52AM -0400, Prarit Bhargava wrote:</p>
<blockquote><p>
  Your argument seems to surround the idea that putting stuff on the internet is<br />
  safe.  It isn&#8217;t.  If you&#8217;ve believed that then you&#8217;ve had your head in the<br />
  sand<br />
  and I&#8217;ve got a lot of land in Florida to sell you.
</p></blockquote>
<p>I have no idea how you are getting this idea.  My argument is that<br />
putting all of our faith in one person (whether it is DNI Clapper<br />
lying to the US Congress), or one company (like Intel, Qualcomm, TI,<br />
etc.) is a bad idea.  Software can be audited.  Hardware can not.  We<br />
can at least test whether or not a network card is performing<br />
according to its specifications.  But a HWRNG is by definition<br />
something that can&#8217;t be tested.  Statistical tests are not sufficient<br />
to prove that the HWRNG has not been gimmicked.</p>
<p>Hence, unless you can show me where the speed advantage of bypassing<br />
the entropy pool is needed, why should we do this?  And if there is a<br />
specific place where need to consider adjusting the security<br />
vs. performance tradeoff, let&#8217;s do that on a case by case basis,<br />
instead of making a global change.</p>
<p>Hence, your patch is IMHO irresponsible.  It exposes us to more risk,<br />
for an undefined theoretical benefit.</p>
<p>Of course nothing on the internet is going to be perfectly safe.  But<br />
that doesn&#8217;t mean that we shouldn&#8217;t make it harder for any government<br />
agency, whether it is the Chinese MSS, the US NSA, or the UK GHCQ,<br />
from being able to easily perform casual, dragnet-style surveillence.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219750">

			<div class="comment by-alext ">

				<p class="commentcredit">

					<span class="commenter">AlexT</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219750">
						April 11, 2014 4:42 PM					</a>

				</p>

				<p>I was indeed referring to the NSA Bloomberg story, which has (unsurprisingly) been promptly refuted.</p>
<p>One of the problems with recent events is that no-one would believe the NSA, or for that matter, the US government, on face value in those matters anymore. What was conspiracy theory a few years ago is just business as usual today. Even if they did not know about Heartbleed they will have quite a hard time to get the message through&#8230;</p>
<p>Another question I have not seen addressed (but I might have missed it) is how was the issue discovered by the Google researcher ? Via code review or by observation of an actual exploit ?</p>
<p>Finlay does anyone here actually log <i>all</i> traffic to their servers for forensic analysis ? I understand the implications (I do only replicate it for real time analysis and it is quite a ordeal already) but it would be really interesting to see if / when Heartbleed started to show up&#8230; Is that being done ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219751">

			<div class="comment by-knottwhittingley ">

				<p class="commentcredit">

					<span class="commenter">KnottWhittingley</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219751">
						April 11, 2014 5:12 PM					</a>

				</p>

				<p>OK, now it&#8217;s being reported that NSA denies having known about the Heartbleed bug.</p>
<p>That&#8217;s almost worse, isn&#8217;t it?  You mean they&#8217;re NOT reviewing crucially important code to at least find really glaring dumbass bugs like missing bounds checks on buffers that could expose sensitive data?</p>
<p>I don&#8217;t know what to think.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219752">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219752">
						April 11, 2014 5:18 PM					</a>

				</p>

				<p>I am inclined to believe that NSA, or rather someone at the NSA, would be more than happy to offer propaganda than truthful statements. <em>shrugs</em></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219753">

			<div class="comment by-skeptical ">

				<p class="commentcredit">

					<span class="commenter">Skeptical</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219753">
						April 11, 2014 5:21 PM					</a>

				</p>

				<p>@Knott: Yeah, left a longer comment about it in Squid thread to avoid turning this one into a NSA discussion. Was surprised by the NSA commenting on this at all, which, combined with Riley&#8217;s description of his sources, inclines me to lend some credence to the denial.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219754">

			<div class="comment by-the-george-john-dasch-super-secret-disguise-kit ">

				<p class="commentcredit">

					<span class="commenter">The George John Dasch super secret disguise kit</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219754">
						April 11, 2014 5:23 PM					</a>

				</p>

				<p>More comical panic.</p>
<p>&#8220;Reports that NSA or any other part of the government were aware of the so-called Heartbleed vulnerability before April 2014 are wrong. The Federal government was not aware of the recently identified vulnerability in OpenSSL until it was made public in a private sector cybersecurity report. The Federal government relies on OpenSSL to protect the privacy of users of government websites and other online services. This Administration takes seriously its responsibility to help maintain an open, interoperable, secure and reliable Internet. If the Federal government, including the intelligence community, had discovered this vulnerability prior to last week, it would have been disclosed to the community responsible for OpenSSL.&#8221;</p>
<p>Clearly, they&#8217;ve lawyered up and tardily concluded that deniability is safest, plausible or not, because they&#8217;ve finally started to look at US state legal exposure to their out-of-control agency&#8217;s wanton destruction.</p>
<p>This is priceless: &#8216;biased toward responsibly disclosing such vulnerabilities.&#8217; Yes, because selectively withholding information to breach diplomatic and commercial obligations to specific states goes over so much better in the arbitral panels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219755">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219755">
						April 11, 2014 6:08 PM					</a>

				</p>

				<p>Bruce, et al.</p>
<p>See this today:</p>
<p><a href="http://www.zerohedge.com/news/2014-04-11/nsa-abused-heartbleed-bug-years-left-consumers-exposed-attack" rel="nofollow ugc">http://www.zerohedge.com/news/2014-04-11/nsa-abused-heartbleed-bug-years-left-consumers-exposed-attack</a></p>
<p>From Bloomberg:</p>
<pre><code>NSA SAID TO EXPLOIT HEARTBLEED BUG FOR INTELLIGENCE FOR YEARS

The U.S. National Security Agency knew for at least two years about a flaw in the way that many websites send sensitive information, now dubbed the Heartbleed bug, and regularly used it to gather critical intelligence, two people familiar with the matter said.
</code></pre>
<p>And the punchline:</p>
<pre><code>NSA SAID TO HAVE USED HEARTBLEED BUG AND LEFT CONSUMERS EXPOSED

Putting the Heartbleed bug in its arsenal, the NSA was able to obtain passwords and other basic data that are the building blocks of the sophisticated hacking operations at the core of its mission, but at a cost. Millions of ordinary users were left vulnerable to attack from other nations’ intelligence arms and criminal hackers.

“It flies in the face of the agency’s comments that defense comes first,” said Jason Healey, director of the cyber statecraft initiative at the Atlantic Council and a former Air Force cyber officer. “They are going to be completely shredded by the computer security community for this.”
</code></pre>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219756">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219756">
						April 11, 2014 6:25 PM					</a>

				</p>

				<p>NSA stands for “National <b>Security</b> Agency” (?).<br />
Shouldn’t they protect the nation?</p>
<p>If they knew about the bug and let it go it would be treason (helping the enemy).</p>
<p>If they didn’t know it may be a shame.</p>
<p>However, now it is time to investigate their huge database,<br />
to find out <b>if and who has used that exploit since when.</b></p>
<p>Last chance to earn some bonus points!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219757">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219757">
						April 11, 2014 8:19 PM					</a>

				</p>

				<p>Knott: their denial was curious and I guess post-Snowden there isn&#8217;t any way to read into what their statement /really/ meant. If the NSA&#8217;s audit team independently discovered Heartbleed they would not disclose such a boon (note I am not even suggesting they authored it in this hypothetical, just found what the commercial security world was going to find earlier).</p>
<p>Re the cloudflare challenge &#8211; the danger of this is that the mainstream media has already picked it up and are now playing down Heartbleed&#8217;s severity. This is dangerous and could lead some to not bother patching devices that are vulnerable. Given there are myriad of architectures and web servers, accelerators etc I think it is impossible to say at this point in time what can and can&#8217;t be leaked until further research is done. This is why the Cloudflare challenge is both important but also dangerous as it may breed complacency from those who aren&#8217;t running nginx on Linux x64 etc etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219758">

			<div class="comment by-norman-yamada ">

				<p class="commentcredit">

					<span class="commenter">Norman Yamada</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219758">
						April 11, 2014 8:48 PM					</a>

				</p>

				<p>Guess you&#8217;ve heard that CloudFlare&#8217;s challenge has been cracked.</p>
<p><a href="https://twitter.com/indutny/status/454773820822679552" rel="nofollow ugc">https://twitter.com/indutny/status/454773820822679552</a><br />
<a href="https://news.ycombinator.com/item?id=7576389" rel="nofollow ugc">https://news.ycombinator.com/item?id=7576389</a></p>
<p>So much for private keys being safe&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219759">

			<div class="comment by-greg-jaxon ">

				<p class="commentcredit">

					<span class="commenter">Greg Jaxon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219759">
						April 11, 2014 10:14 PM					</a>

				</p>

				<p>Among the &#8220;human aspects&#8221; were articles (Guardian was the first I saw) in which &#8220;experts&#8221; said you shouldn&#8217;t change your password until the server in question has been secured &#8211; that using that server made things worse (as if that was possible). Perhaps Randy @ xkcd should explain it this way:</p>
<p>UserName: Bruce<br />
Password: I don&#8217;t know Bruce&#8217;s password.</p>
<p>Server: Sorry that&#8217;s not Bruce&#8217;s password, because I just loaded Bruce&#8217;s (hashed?) password into memory and checked&#8230; but&#8230; you&#8230; already noticed, eh?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219760">

			<div class="comment by-sooth_sayer ">

				<p class="commentcredit">

					<span class="commenter">sooth_sayer</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219760">
						April 11, 2014 10:47 PM					</a>

				</p>

				<p>Open source is running the world now .. but it has real junk at a lot of places &#8212; this one was serious but there are others that are not noticed or fixed when known to be flawed.</p>
<p>Commercial software is not much better- that&#8217;s why on a good week my iphone updates 2-3 applications (out of about 40 ) have installed) .. in older days the software was much less functionality and COULDN&#8217;T be changed unless you spent some money .. even shipping a floppy &#8212; so there was some rigour to it. Now there is none!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219761">

			<div class="comment by-rogueai ">

				<p class="commentcredit">

					<span class="commenter">RogueAI</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219761">
						April 11, 2014 11:02 PM					</a>

				</p>

				<p>Government has being using the human aspect to mitigate responsibility for some time. By outsourcing to private corporations through confidential contracts, that rely on corporations self reporting abuses (which itself runs contrary to their maintaining of profit margin), governments avoid responsibility and proper scrutiny.</p>
<p>A department, such as the NSA, would simply employ a private contractor to exploit the HeartBleed bug via a confidential agreement, that directs the contractor to then dump all useful obtained information back into the intelligence network for analysis using selectors. The NSA can then state their department did not exploit the HeartBleed bug.</p>
<p>Governments have used the same system with prisons and detention facilities since Thatcher and Reagan. Private corporations have been found to breach their responsibilities often under these contracts, as it actually is in their interests to let problems grow out of control, then turn around and ask for more money to fix the problem. The government avoids scrutiny even though private contracting of state responsibilities becomes less efficient, more expensive and more unaccountable for it&#8217;s actions. A few minor staff are blamed and fired from the private corporation and no government minister or department takes responsibility.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219762">

			<div class="comment by-jimmy_large ">

				<p class="commentcredit">

					<span class="commenter">Jimmy_large</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219762">
						April 12, 2014 12:33 AM					</a>

				</p>

				<p>Many sites in an attempt to update their certificates and still keep their site functioning are simply allowing users to login using http and therefore negotiate in the clear.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219763">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219763">
						April 12, 2014 12:34 AM					</a>

				</p>

				<p>Re NSA / US government denial and my hypothesis:<br />
&#8220;Hmn, maybe America is still &#8220;working&#8221; in the sense that excessive power is not tolerated in the end and reduced &#8211; if regular means do not get you there, you find a different way, like getting Al Capone for tax evasion?&#8221;</p>
<p>Hmn, maybe some people simply thought to themselves, &#8220;if we can&#8217;t get the NSA for the things they did, lets get them for something they did not do, nobody is going to believe them now&#8221;?</p>
<p>Sort of a reverse &#8220;crying wolf&#8221;, the NSA too often denying things they did do (in very hypocritical ways like an &#8220;egoistical giraffe&#8221;, head high up, &#8220;oh you have nothing to eat down there &#8211; hey up here all the trees are still green&#8221; &#8211; sorry could not resist the pun 😉 and now when they are maybe really innocent, nobody believes them and they have maybe nothing in their hands to prove their innocence?</p>
<p>Would really love to know what is going on behind the scenes worldwide since Snowden&#8230; After all, maybe the NSA / US government really/genuinely secretly decided to change policy and to make the worst vulnerabilities for the public and industry public instead of keeping them to themselves &#8211; but decided to do this secretly and deny it? Oh, so many possibilities&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219764">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219764">
						April 12, 2014 12:35 AM					</a>

				</p>

				<p>@BleedingHeart (April 11, 2014 3:43 PM)</p>
<p>&#8220;<i>The bottom line is this: Computers are not secure and probably never will be secure </i>&#8221;</p>
<p>I disagree. Because that&#8217;s focussing on the symptom rather than on the cause. If at all, one needed to say that nothing involving humans will ever be secure.</p>
<p>I see 2 problems:</p>
<ul>
<li>Open Source<br />
Following the line of a chain being as strong or weak as its weakest element, OS is considered to be lousy.<br />
Kindly note that I don&#8217;t say it <em>is</em> lousy but that it is zo be considered to be lousy (from a security perspective).</li>
</ul>
<p>For two reasons. a) unqualified hobbyists and b) &#8211; and more interesting IMO &#8211; because it&#8217;s free (b being somewhat related to a)).</p>
<p>Looking at it from my pov. we&#8217;ve been too greedy. OS offers 2 major advantages namely, being open source (and such verifiable) and being free. While the former is a major plus the latter is shooting oneself in the foot by asking for docs to not be written and test to not be performed.</p>
<p>So, better get used to the idea of paying for OS software one way or another. If we do, OS people can afford better (motivated) developers and TESTING/auditing. And we still get way more than from closed source software! And cheaper, too. Still a very attractive deal money-wise and a way more attractive deal quality-wise.</p>
<ul>
<li>&#8220;Coolness&#8221;, stupidity &#8211; languages.</li>
</ul>
<p>Don&#8217;t get me wrong, I&#8217;ve used C myself for more than a decade. And yes, that was when I was young and when being cool meant a lot to me.</p>
<p>Let&#8217;s face it. C is outdated and a glorified &#8211; and badly mistaken &#8211; super assembler. And it&#8217;s a certain trouble ticket.</p>
<p>C isn&#8217;t formally verifiable and, in fact, it&#8217;s even hard to correctly parse. In other words, developing security related software in C is akin to Schneier or Bernstein not properly developing algorithms but asking drunk college boys on a weekend night to come up with something.</p>
<p>Wirth, Meyer and others were right after all. Yet I just looked up bcrypt and found implementations in C (of course), Ruby, Python, Perl (aka. &#8220;That was yesterday. Me not understand that code today&#8221;), PHP, and whatnot.</p>
<p>Pascal? Fail. Modula? Fail. At the very least Cyclone, a safe kind of C (well, an attempt at least)? Fail.</p>
<p>If heartbleed &#8211; something that just HAD to happen &#8211; doesn&#8217;t make us think again and think hard than we f*cking deserve to be hacked. Sorry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219765">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219765">
						April 12, 2014 2:10 AM					</a>

				</p>

				<p>@ Mr. Pragma</p>
<p>How is your fascination with closed source working out when our laws allow any company to be legally compelled to purposefully put in back doors and keep quiet about it, on pain of imprisonment?  Why are you promoting closed source when that&#8217;s the case?  Advocating closed source makes no sense in that kind of environment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219766">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219766">
						April 12, 2014 2:14 AM					</a>

				</p>

				<p>DB</p>
<p>Kindly read my post again. Pointing out problems related to Open Source is not identical to promoting closed source software (which I do <em>not</em>).</p>
<p>What I suggest is to support OS projects financially.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219767">

			<div class="comment by-fred ">

				<p class="commentcredit">

					<span class="commenter">Fred</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219767">
						April 12, 2014 2:21 AM					</a>

				</p>

				<p>Quoted from heartbleed.com:</p>
<p>&#8220;Without using any privileged information or credentials we were able steal from ourselves the secret keys used for our X.509 certificates&#8230;&#8221;</p>
<p>It appears someone was able to steal the secret private keys from a running server process.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219768">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219768">
						April 12, 2014 2:24 AM					</a>

				</p>

				<p>Norman: yeah, and I am hardly surprised. Cloudflare&#8217;s comments that it perhaps couldn&#8217;t be done were reckless and ultimately incorrect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219769">

			<div class="comment by-iain-moffat ">

				<p class="commentcredit">

					<span class="commenter">Iain Moffat</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219769">
						April 12, 2014 2:45 AM					</a>

				</p>

				<p>@Fred: I note from your quote that they report finding their own key. It occurs to me that if examining 64K blocks of data from unpredictable offsets in the SSL process memory, that finding one&#8217;s own (known) private key is a much lesser challenge than being able to recognise any other key &#8211; a simple search for a known sequence of bytes rather than having to identify a possible key from its context and structure and then test the candidate to see whether it works. Not impossible but certainly something requiring more knowledge and either automation or repetitive trial and error.</p>
<p>Iain</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219770">

			<div class="comment by-fred ">

				<p class="commentcredit">

					<span class="commenter">Fred</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219770">
						April 12, 2014 2:57 AM					</a>

				</p>

				<p>@Iain Moffat: Supposedly there was no privileged information used. Also, two separate individuals already defeated Cloudflare&#8217;s Heartbleed Challenge.</p>
<p><a href="https://www.cloudflarechallenge.com/heartbleed" rel="nofollow ugc">https://www.cloudflarechallenge.com/heartbleed</a></p>
<p><a href="https://news.ycombinator.com/item?id=7576389" rel="nofollow ugc">https://news.ycombinator.com/item?id=7576389</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219771">

			<div class="comment by-replay ">

				<p class="commentcredit">

					<span class="commenter">replay</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219771">
						April 12, 2014 3:03 AM					</a>

				</p>

				<p>Sep 22, 1998 &#8211; Playing hide and seek with stored keys. Adi Shamir and Nicko van Someren.</p>
<p><a href="http://www.cs.jhu.edu/~astubble/600.412/s-c-papers/keys2.pdf" rel="nofollow ugc">http://www.cs.jhu.edu/~astubble/600.412/s-c-papers/keys2.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219772">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219772">
						April 12, 2014 3:27 AM					</a>

				</p>

				<p>I wonder how all the CAs will manage everyone applying for replacement certs and if they will profiteer from it or offer Heartbleed affected customers a subsidized rekey?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219773">

			<div class="comment by-dave-walker ">

				<p class="commentcredit">

					<span class="commenter">Dave Walker</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219773">
						April 12, 2014 4:22 AM					</a>

				</p>

				<p>I&#8217;m not overly surprised that getting useful material out of Heartbleed (or rather, identifying and isolating useful material in the pile of stuff that comes back) is hard; I&#8217;d expect people would have to do a small version of Shamir and van Someren&#8217;s entropy-based searching.</p>
<p>Actually, though, one of the early thoughts which crossed my mind when I saw a detailed description of Heartbleed, was &#8220;why didn&#8217;t static code analysis tools pick this up?&#8221;. I&#8217;d assume such tools (not just security-enhanced lint, but maybe also code from the likes of McCabe) would get run against something as widely-used and security-critical as OpenSSL &#8211; is this not actually the case, or were they run against OpenSSL and missed the bug? If the latter, I&#8217;d say that&#8217;s a more serious bug in the analysis tools, than Heartbleed is itself&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219774">

			<div class="comment by-replay ">

				<p class="commentcredit">

					<span class="commenter">replay</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219774">
						April 12, 2014 5:04 AM					</a>

				</p>

				<p>&#8220;I&#8217;m not overly surprised that getting useful material out of Heartbleed (or rather, identifying and isolating useful material in the pile of stuff that comes back) is hard; I&#8217;d expect people would have to do a small version of Shamir and van Someren&#8217;s entropy-based searching.&#8221;</p>
<p>But not for RSA private keys, see section 2 in the paper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219775">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219775">
						April 12, 2014 5:10 AM					</a>

				</p>

				<p>Let&#8217;s try steping back from the heat of battle on this for a moment and try to look at it a little dispassionatly.</p>
<p>Firstly the OpenSSL project team is just a handfull of people working on it part time with their own resources. Now I don&#8217;t know what motivates them but I for one are thankfull that they do as it&#8217;s not an easy task at the best of times.</p>
<p>Now there has been a question over what some regard as an elementry mistake (not bounds checking correctly) however I don&#8217;t think they are looking at it dispassionatly and are also using 20-20 Hindsight.</p>
<p>The bounds check is not the problem, nor for that matter is the usage of malloc and friends, or for that matter the use of C.</p>
<p>The real problem was the wooly thinking that went into the original specification and that is what should be kept in mind and realy the starting point of any &#8220;enquiry&#8221;.</p>
<p>The first question should be not why the heartbeat was of the format it was, but why was it necessary at all and what were all the options available.</p>
<p>From what I can see it was a cludge in it&#8217;s own right, and that it&#8217;s design was likewise a cludge, giving rise to an ill thought out specification. All of which realy ment that anything that followed was going to break in some way.</p>
<p>This is part of what I have described on a number of occassions as &#8220;an artisanal aproach of the wheel wright&#8221; bereft of any real engineering. And it is something that is so prevelent in software production it should rightly be claimed as a plague.</p>
<p>As I&#8217;ve pointed out in the past the artisanal aproach might produce a &#8220;rustic look&#8221; but it also killed a lot of people by it&#8217;s faliure. Whilst most of these deaths went unreported as &#8220;accidents&#8221; or &#8220;the drivers fault&#8221; when wheels colapsed and those on board were thrown about, the advent of steam changed that. Whilst the anoying whistle of low preasure steam could be ignored, the explosion of a high preasure boiler with bits, pieces and bodies being flung far and wide could not it was to newsworthy. Eventialy sufficient preasure was put onto the English Parliment and they legislated that boilers like guns and cannon before them should not only be &#8220;proofed&#8221; at manufacture but regularly there after and boilers and the engines should be properly maintained and certified as such by independant inspectors. Engine making and keeping was turned from a craft into a proffession and science made the difference between artisan trades of metal smiths and engineering as we have come to know it.</p>
<p>Interestingly &#8220;regulation&#8221; was not as the neigh says of the time predicted &#8220;the death of industry&#8221; it drove up standards, saved lives and reduced wanton destruction, which increased condifence and thus increased the market for boilers and engines and thus actually brought new life and vigor to the industry.</p>
<p>Whilst I would not argue that software development is identical to artisanal boiler and engine development, the parallels are fairly clear to see.</p>
<p>And the recent &#8220;blow up&#8221; in the press about the NSA and other Five Eyes Nations is earily similar to the reporting of engine disasters.</p>
<p>Perhaps it&#8217;s time to make regulatory legislation to turn the artisanal code cutting driven by &#8220;managment&#8221; not &#8220;consumer&#8221; need into a proper proffessional industry, which properly addresses customer safety &#8211;which includes privacy&#8211; over short term profit. I suspect the result if regulated judiciously would be a significant improvment in the market.</p>
<p>However the weasle word is &#8220;judiciously&#8221; based on the various Five Eyes Executives and law makers currently I suspect any legislation would be anything other than judicious.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219776">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219776">
						April 12, 2014 5:16 AM					</a>

				</p>

				<p>@ Mr. Pragma</p>
<p>So you&#8217;re proposing that open source programmers should be paid, and that users should pay for open source software?  Interesting.  Without holding the software itself hostage to get everyone to pay (i.e. making it in fact closed source) how do you propose to make people pay for their OS?</p>
<p>I would admit that more open source programmers being paid by some charitable foundation would be beneficial, I just don&#8217;t see how you&#8217;re going to pass that cost along to the end users with it still being free and open.  Openness itself is a kind of freedom, so being free is not a detestable problem to be avoided.</p>
<p>Keep in mind that the word &#8220;free&#8221; means two different things: free as in no cost, and free as in freedom.  This might be where I misunderstood you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219777">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219777">
						April 12, 2014 5:29 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>I&#8217;m a bit leery of anything that concludes that we need more &#8220;regulatory legislation&#8221; to fix all our problems&#8230;  Is a cruel power-hungry overreaching government a problem or our savior?  I&#8217;d rather we be self-regulated in the industry than give up even more human rights to these jokers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219778">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219778">
						April 12, 2014 6:07 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p><i>&#8220;The bounds check is not the problem, nor for that matter is the usage of malloc and friends, or for that matter the use of C.</i></p>
<p><i>The real problem was the wooly thinking that went into the original specification and that is what should be kept in mind and realy the starting point of any &#8220;enquiry&#8221;.&#8221;</i></p>
<p>In this particular problem, and the previous disasters, WERE in fact caused because C is a <b>hard to read</b> language and easy to mess around with.</p>
<p>OpenSSL <b>is a very badly written library</b>. I mean, it has #ifdefs running around through &#8220;||&#8221;, through tertiary if-then-else statements and through goto labels. Frankly, I don&#8217;t know how you can write worse code than this that still compiles.</p>
<p>They should have just seperated the damn stuff. It&#8217;s not that hard.</p>
<p>But most of all, a ship needs a captain. (think Linus Torvalds and Theo de Raadt)</p>
<p>Last but not least, the IETF is indeed also to blame for making things way to complex. And the worst thing is that they let it all happen. It&#8217;s probably a habit of committee descision making, that&#8217;s actively being influenced by Big Corp and NSA.</p>
<p>You know, thinking about it, I ask myself the question of how long is this internet still maintainable?</p>
<p>The pile of garbage is immense.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219779">

			<div class="comment by-moz ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html' rel='external nofollow ugc' class='url'>moz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219779">
						April 12, 2014 6:27 AM					</a>

				</p>

				<p>from: <a href="http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html" rel="nofollow ugc">http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html</a></p>
<p>“Reports that NSA or any other part of the government were aware of the so-called Heartbleed vulnerability before 2014 are wrong,”</p>
<p>Bruceparsing: Heartbleed was found and used for us by one of our private industry partners.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219780">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219780">
						April 12, 2014 6:32 AM					</a>

				</p>

				<p>@DB</p>
<p>You said &#8220;I just don&#8217;t see how you&#8217;re going to pass that cost along to the end users with it still being free and open&#8221;.</p>
<p>Annual donation drives, as Wikipdia does, are a good source of income. I use Wikipedia regularly, and when I saw their donation drive I donated. I got in response a thank-you letter that gave me a warm fuzzy feeling, and since then I regulraly donate once a year.<br />
Evidently, it is not only me. According to AP last year: &#8220;Wikipedia has raised $20 million in its annual plea for donations to help expand and improve the Internet&#8217;s leading encyclopedia.&#8221;</p>
<p>Now back to openSSL: according to Bloomberg, there is a Foundation with a $1M annual budget that supports the 5 programmers which work on the openSSL project. I bet that they can do a good code refactoring and critical review with another $1M a year. Let&#8217;s have them run an annual domation drive. Many user will contribute &#8211; me included. Big companies that use their code and donate handsomely will get a prominent mark on a donation hall-of-fame poster page, and even a nice looking framed certificate (no pun intended) to hang on their corporate lobby wall.</p>
<p>It is doable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219781">

			<div class="comment by-moz ">

				<p class="commentcredit">

					<span class="commenter">moz</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219781">
						April 12, 2014 6:44 AM					</a>

				</p>

				<p>Actually; after thinking about the post above; I have realised I was completely wrong.  It should probably read:</p>
<p>&#8220;Heartbleed was identified and exploited by GCHQ under our contract with them to spy on US citizens.  Damn that&#8217;s clever.  What a good thing we never activated the part about trying to keep the USA secure.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219782">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219782">
						April 12, 2014 7:16 AM					</a>

				</p>

				<p>@ yesme,</p>
<p>I&#8217;m not blaiming the tool when the craftsman has limited choice.</p>
<p>But you also need to consider that even type safe languages are only &#8220;so good&#8221; and in many cased far from good.</p>
<p>Interestingly if you hunt around on the net for verification tools that have been run against OpenSSL either they don&#8217;t pick up on the lack of bounds check or produce such a verbose output with all sorts of warning etc messages that that the signal on this problem is as a submariner once said &#8220;is buried in whale song and seal farts&#8221;.</p>
<p>So if verifier tools specificaly designed to hunt out such things can not reliably find this one what hope for a compiler that is not? Which then gives rise to other questions about people relying on such tools thus never gaining the experiane to spot the more subtal bugs&#8230;</p>
<p>As for the IETF they have several problems not least of which is technology improvment is outstriping human ability to compensate for it. When they started even 8bit chips were as rare as hens teeth. Designs that made sense within the then current technological constraints got the thumbs up everything else got the thumbs down. Which means that much that should have been there was not nore even alowed for. This is the reason why the &#8220;functioning&#8221; DoD protocols won over the &#8220;blue sky&#8221; ISO protocols.</p>
<p>However as you have noted it&#8217;s not sustainable as someone one once observed &#8220;there&#8217;s only so high you can pile the brown stuff before it buries you in a stinking moras.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219783">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219783">
						April 12, 2014 7:32 AM					</a>

				</p>

				<p>@ DB,</p>
<p>As I said regulation has worked in the past as history shows.</p>
<p>However as I also noted you need to get it right by being suitably &#8220;judicious&#8221;, but with the way the Five-Eye nations legislators currently are I would be very cautious.</p>
<p>And that&#8217;s a real problem, because history shows us that &#8220;free markets&#8221; are almost always races for the bottom unless legal or some other regulatory effect &#8211;such as cartel/monopoly&#8211; applies, or they are &#8220;faux markets&#8221; designed for some alternative reason &#8211;such as asset stripping or stealing money&#8211; that as we see with Pyramid Scheams and Financial Instruments implode with the perps/organisers walking away with the assets/money.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219784">

			<div class="comment by-rj07thomas ">

				<p class="commentcredit">

					<span class="commenter">rj07thomas</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219784">
						April 12, 2014 7:42 AM					</a>

				</p>

				<p><a href="https://www.cloudflarechallenge.com/heartbleed" rel="nofollow ugc">https://www.cloudflarechallenge.com/heartbleed</a></p>
<p>seems cloudflare have been proved wrong, quite quickly.</p>
<p>Also, disagree with US warning only to change passwords once site &#8220;safe&#8221;. On individual scale, hassle of checking arbitrary sites unrealistic. Also, risk of not changing means account could be compromised from prior attack data leak anyway (can&#8217;t answer probability puzzle about increased attacks this week v. increased password changes meaning more or less likely to have credentials intercepted).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219785">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219785">
						April 12, 2014 8:01 AM					</a>

				</p>

				<p>@ Jacob</p>
<p>I agree&#8230; but getting something for free and then loving it so much you donate&#8230; is quite different from: &#8220;free&#8221; is the problem, make everyone pay!!  That&#8217;s the part that threw me off.  I&#8217;ve donated to some things too, both money, and time in my area of professional expertise.  Smart people study and learn about and find jobs in areas they love, so they are professionals not just clueless stupid hobbyists anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219786">

			<div class="comment by-z80 ">

				<p class="commentcredit">

					<span class="commenter">z80</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219786">
						April 12, 2014 8:04 AM					</a>

				</p>

				<p>Any thoughts on this?</p>
<p><a href="http://thread.gmane.org/gmane.os.openbsd.tech/35722/focus=35731" rel="nofollow ugc">http://thread.gmane.org/gmane.os.openbsd.tech/35722/focus=35731</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219787">

			<div class="comment by-anonymous-from-switzerland ">

				<p class="commentcredit">

					<span class="commenter">anonymous from switzerland</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219787">
						April 12, 2014 8:42 AM					</a>

				</p>

				<p>@Clive Robinson<br />
<em>&#8220;I&#8217;m not blaiming the tool when the craftsman has limited choice.</em></p>
<p><em>But you also need to consider that even type safe languages are only &#8220;so good&#8221; and in many cased far from good.&#8221;</em></p>
<p>I see a lot less ways to leak the private key of a web server using any language that nominally prevents random memory access at runtime <em><b>and</b></em> be able to plausibly deny to have intentionally rather than accidentally created this possibility.</p>
<p>For this reason alone, any language without nominal runtime memory access checks seems to be a no-go for future security software, and, yes, arguably finding a good alternative is not so easy&#8230; Maybe best pragmatic way would even be a modified more secure variant of C? (But maybe that is also not practical, but maybe not certain without some evaluation.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219788">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219788">
						April 12, 2014 8:44 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Most people forget that source code is being read way more times than it&#8217;s being written.</p>
<p>With that in mind it makes sense to have a language that is easy to read and understand.</p>
<p>I prefer a language that <b>doesn&#8217;t allow you to write hacks</b>, because everyone knows that hacks are like temporary laws: They don&#8217;t go away.</p>
<p>And C has lots of problems more besides that.</p>
<p>Now think 40 years ahead (C is little over 40 years old). Do we still want to talk about the nasty features of C? About it&#8217;s speed? About the preprocessor crap.</p>
<p>C has had it&#8217;s time. C++ was a mistake. Let&#8217;s face it.</p>
<p>We need a language that is unambigious, easy to understand and does what you think it should do. C is not that, and C++ certainly not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219789">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219789">
						April 12, 2014 9:11 AM					</a>

				</p>

				<p>Yesme: you wrote&#8230;</p>
<blockquote><p>OpenSSL is a very badly written library. I mean, it has #ifdefs running around through &#8220;||&#8221;, through tertiary if-then-else statements and through goto labels. Frankly, I don&#8217;t know how you can write worse code than this that still compiles.</p></blockquote>
<p>I nodded in agreement so hard I might have to see a chiropractor.</p>
<p>OpenSSL&#8217;s src is a mess. If cyaSSL can mirror its basic functionality and do such a thing with code that is both legible and importantly it is advertized as 20 times smaller than OpenSSL. Of course it is targeted towards the embedded market but I would rather audit a significantly smaller codebase that a lay sysadmin can likely understand than try and analyze the Pandora&#8217;s box that is OpenSSL&#8217;s source. It really is a disgrace.</p>
<p>Feature creep is a terrible thing. Security critical libraries should focus on their task. At least move redundant or niche usage extensions and other foolery out of the core and disable them unless uncommented in the Makefile at compile time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219790">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219790">
						April 12, 2014 10:01 AM					</a>

				</p>

				<p>@ Clive</p>
<p>I realize that &#8220;self regulation&#8221; in the business world is code for &#8220;we don&#8217;t give a f*** and we&#8217;d poison our own grand kids if it made us a buck&#8221; (I am thinking of a few examples where this is quite literal)&#8230; but open source in general is not quite so business driven, it&#8217;s got a lot of volunteers.  In the volunteer world it means a slightly more altruistic thing since money isn&#8217;t such a god.  It means, let&#8217;s figure out what works best and do that.  Now standards bodies on the other hand, they&#8217;ve become a bit tainted by business interests, yeah.  Regulation might be the only way to tame business, but don&#8217;t stifle the volunteers.  The problem is business has a full stranglehold on Congress, so there&#8217;s no way for it to go right&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219791">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219791">
						April 12, 2014 10:26 AM					</a>

				</p>

				<p>The exposure of RSA secret keys is clearly expensive, in terms of web site operators having to get new certificates and allowing decryption of traffic from previous sessions.</p>
<p>Perhaps it would be wise for OpenSSL to farm off the use of such keys to a separate process which would do the calculations required and send the results back to the main process.</p>
<p>Any hole which exposed the memory of the main process would therefore be much less likely to reveal the RSA secret key</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219792">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219792">
						April 12, 2014 1:01 PM					</a>

				</p>

				<p>Clive Robinson (April 12, 2014 5:10 AM)</p>
<p><cite>The bounds check is not the problem, nor for that matter is the usage of malloc and friends, or for that matter the use of C</cite></p>
<p>According to the OpenBSD guys, who damn know a thing or two about security, malloc was a problem or, more precisely, sailing blindly <em>was</em> a problem.</p>
<p>And so is using C.</p>
<p>Let me give you another ugly hint. The programming language tells a lot about the mindset. When C was created it did help to <em>avoid</em> errors because it&#8217;s so much better readable than asm and because software design is so much closer to the human.<br />
Unfortunately todays C users seem to have forgotten that point.</p>
<p>Yes, Pascal or Modula feel comparatively bureaucratic and tight and uncool or, to put it in todays setting, &#8220;unhacky&#8221;. But programmers generate considerably less errors using those uncool languages and the errors they produce are way easier to spot and to fix.</p>
<p>In the end it&#8217;s simple. It&#8217;s about how solid software is, how easy to maintain, and how effective the development is &#8211; in that order.<br />
And there C fails big time. Maybe it&#8217;s cool and fun but it doesn&#8217;t fu**ing deliver!</p>
<p>DB (April 12, 2014 5:16 AM)</p>
<p><cite>So you&#8217;re proposing that open source programmers should be paid, and that users should pay for open source software? Interesting. Without holding the software itself hostage to get everyone to pay (i.e. making it in fact closed source) how do you propose to make people pay for their OS?<br />
&#8230;</p>
<p>Keep in mind that the word &#8220;free&#8221; means two different things: free as in no cost, and free as in freedom. This might be where I misunderstood you.</cite></p>
<p>Kindly stop piling biased religious junk on me, will you.</p>
<p>If we had to pay, quite probably a rather modest price, we would still have the &#8220;free as in freedom&#8221; and, more importantly, we would still have the sources.</p>
<p>Now, chose: You prefer paying 300 $ for a binary blob or you prefer paying 100 $ for full sources? Well, I wouldn&#8217;t have to think for a second.<br />
Problem is, that we get (and want) everything and give (close to) nothing.<br />
This might look like a good deal to fools but it isn&#8217;t. As we&#8217;ve seen again and again (like right now).</p>
<p>yesme (April 12, 2014 6:07 AM)</p>
<p>YES! You hit it.</p>
<p>Jacob (April 12, 2014 6:32 AM)</p>
<p><cite>Now back to openSSL: according to Bloomberg, there is a Foundation with a $1M annual budget that supports the 5 programmers which work on the openSSL project. I bet that they can do a good code refactoring and critical review with another $1M a year. </cite></p>
<p>Well, money is just one part. Kindly note what I&#8217;ve written above about languages and attitudes.<br />
As a rule of thumb you can assume that C code will only rarely be refactored or even just properly maintained.<br />
For two reasons:<br />
a) software quality doesn&#8217;t mean too much for most C programmers (well, those who can choose the language for a project). If it did they wouldn&#8217;t use C in the first place. Furthermore it usually is <em>very</em> difficult to make any non-neglegible changes to C code for many reasons, one of them being loads of side effects.<br />
There are a few exceptions, Linus, Theo (OpenBSD) who are strong and accepted leaders and almost anal about code quality.</p>
<p>b) Besides some small corrections it is so troublesome and work intense to correct C Code that quite often projects (or parts thereof) are simply completely rewritten. It&#8217;s easier and cheaper and more promising.</p>
<p>What the money could do is to provide for payed people to write docs and to properly test and audit code.</p>
<p>But there&#8217;s still the other ugly problem, language. And for that there is only one way (and I&#8217;m inclined to bet that it won&#8217;t be taken) and that is using a language that is up to the task.</p>
<p>Clive Robinson (April 12, 2014 7:16 AM)</p>
<p><cite>I&#8217;m not blaiming the tool when the craftsman has limited choice.</cite></p>
<p>Pardon me but from what you write it looks like you are on the theoretical side and lack experience.</p>
<p>For a start, in 99,9% of the cases OS projects <em>can</em> chose their language.</p>
<p>And you are completely mistaken re. &#8220;DoD&#8221; and bureaucracy, too.</p>
<p>The fact is that languages of the Wirth, Meyer, Ichbiah/Tucker lines  have proven again and again to be highly efficient, very well maintainable, and verifiable to a large degree if not fully.<br />
The fact is also that those languages evolved over decades and there is, to name an example, Ada 2012 after Ada 2005 and Ada 95 and finally Ada 83. Similarly there is Object Pascal and even &#8220;old&#8221; Modula is still far more modern and up to date than C.</p>
<p>Ad verification tools: How the hell do you want to properly verify code that is even hard to parse? For verification one needs at least an educated guess about intention &#8211; which is all but absent in C code.</p>
<hr />
<p>And again, to name just one example: The best we can today to properly and securely store passwords is scrypt and bcrypt. Both have been implemented in C and for both there are implementations in Ruby, Python, Perl, Java and whatnot &#8211; but not in one single trustworthy language that lends itself to secure implementations.</p>
<p>Think about that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219793">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219793">
						April 12, 2014 1:17 PM					</a>

				</p>

				<p>Oh and btw:</p>
<p>A youngster (co-)designed and implemented heartbeat and an experienced man checked it and signed it off.</p>
<p>There&#8217;s a reason the error wasn&#8217;t spotted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219794">

			<div class="comment by-rilind-shamku ">

				<p class="commentcredit">

					<span class="commenter">Rilind Shamku</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219794">
						April 12, 2014 2:05 PM					</a>

				</p>

				<p>This is shocking! Very very trivial length check can cause all this mayhem. Anyone that’s read a few C code security books would have been able to avoid this fundamental error. This is not a C issue; it is definitely a human error. C was designed for efficiency and to give programmer more power especially around memory allocation. I can not believe that a crucial project for the internet such as, OpenSSL would let this fly by without checks. I understand that the project is underfunded (ridiculous, obviously giant internet companies don’t care about investing in security), etc… but still a simple source code analysis session would have been able to find this coding error. This leads me to believe that there might be more trivial errors like this one in the code. So with all that said, I believe it is very crucial that we spend the same exact amount of time that we use to develop code in developing source code analysis tools to check our code. Source code analysis is the first process of any code reviews. I hope this is the only major vulnerability with OpenSSL.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219795">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">tom</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219795">
						April 12, 2014 2:18 PM					</a>

				</p>

				<p>The OpenSSL Software &#8220;Foundation&#8221; is disingenuous calling itself a foundation when in fact it is shell for an ordinary for-profit commercial consulting company. At least the phony Bitcoin &#8216;Foundation&#8217; is a 501(c)4 trade association forced to file an annual 990 disclosure form with the IRS (and available online).</p>
<p>I&#8217;ve personally started and run a legitimate 501(c)(3) charitable organization for the past 17 years. It involves a one-time fee of $1200 for the initial IRS approval letter, about 10 hours a year for signing checks and another 4 hours for the annual reporting.</p>
<p>So the OpenSSL Software &#8220;Foundation&#8221; is being real economical with the truth: &#8220;We looked into it and concluded that 501(c)(3) status would require more of an investment in time and money than we can justify at present.&#8221;</p>
<p>They disclose support only from 3 companies (Qualys, opengear, and PSW Group) but acknowledge &#8220;we ask permission to identify sponsors and that some sponsors we consider eligible for inclusion here have requested to remain anonymous.&#8221;</p>
<p>A mission-critical internet infrastructure paid for by anonymous parties which might include intel and hacker firms? Does the OpenSSL SF really have the capacity to vett these parties or is it more like Expedian &#8216;vetting&#8217; detectives from Vietnam?</p>
<p>A million bucks a year for four core people and seven programmers who are &#8216;active contributers&#8217;? That&#8217;s a sweet deal for part-timers, $150k a year. Volunteer a little on SSL to get funneled juicy consulting gigs on SSL &#8212; not my idea of altruistic public service. Might those gig providers include BND, GCHQ, NSA or one of their many front groups or security industry allies?</p>
<p><a href="https://www.openssl.org/support/donations.html" rel="nofollow ugc">https://www.openssl.org/support/donations.html</a></p>
<p>The sole person to review Mr. Seggelmann&#8217;s wooly protocol and sloppy code (as characterized above) seems to have been  Dr. Stephen Henson of the UK, reportedly the only member of the OpenSSL core team who works full-time on the project.</p>
<p>His personal website is whimsical, unprofessional and uninformative: <a href="http://www.drh-consultancy.demon.co.uk/" rel="nofollow ugc">http://www.drh-consultancy.demon.co.uk/</a></p>
<p>No one seems to have asked Hensen to describe code checks he did on Seggelmann or what he would do differently today. As a practical matter (no one else was paid to do it), Hensen may have been the sole code reviewer on many hundreds of OpenSSL commits.</p>
<p>What is the motivation anyway to spend extra hours on code arcana when you&#8217;re on fixed annual salary? Well, the motivation for in-depth code review might be to find some backdoor bugs, approve the commit and sell the bugs on &#8212; it&#8217;s only human.</p>
<p>I&#8217;m not alleging Hensen or Seggelmann did anything dishonorable in the slightest. It&#8217;s the overall structure I&#8217;m unhappy with, not the individuals: we can&#8217;t base the whole of internet security on two unknown guys who have carved out sweet spots for themselves with great potential for abuse.</p>
<p>&#8220;Please note that the OpenSSL Software Foundation (OSF) is incorporated in the United States as a regular for-profit corporation. It does not qualify as a non-profit, charitable organisation under Section 501(c)(3) of the U.S. Internal Revenue Code. We looked into it and concluded that 501(c)(3) status would require more of an investment in time and money than we can justify at present. This means that, for individuals within the U.S., donations to the OSF are not tax-deductible. Corporate donations can of course be written off as a business expense.&#8221;</p>
<p>Donation? I think I&#8217;ll pass until there&#8217;s a really different business model.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219796">

			<div class="comment by-rj07thomas ">

				<p class="commentcredit">

					<span class="commenter">rj07thomas</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219796">
						April 12, 2014 2:40 PM					</a>

				</p>

				<p>Wowser. I was just sitting down to watch an online movie and thought, hang on a minute, what about heartbleed?</p>
<p>Did an online chat with company (no name being provided) who apparently don&#8217;t even know what heartbleed or OpenSSL is. I switched to watching &#8220;Gravity&#8221; on Blinkbox&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219797">

			<div class="comment by-moz ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.mattslifebytes.com/?p=533' rel='external nofollow ugc' class='url'>moz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219797">
						April 12, 2014 2:54 PM					</a>

				</p>

				<p>The link <a href="https://www.mattslifebytes.com/?p=533" rel="nofollow ugc">https://www.mattslifebytes.com/?p=533</a> is broken;  it has &lt;a hef rather than &lt;a href</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219798">

			<div class="comment by-l ">

				<p class="commentcredit">

					<span class="commenter">L</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219798">
						April 12, 2014 3:02 PM					</a>

				</p>

				<p>I read a lot of people here saying the C/C++ programming is bad for security.</p>
<p>I agree for C, since it&#8217;s hard and very verbose to read.</p>
<p>C++, and C++11 especially, on the other hand, can give you the low-level you need for performance, and the high-level, memory-safe version.</p>
<p>I don&#8217;t get why so many people are against C++. Personally I do not know of security-oriented software written in C++, it&#8217;s all C or some other safer/stricter language where performance is not a problem.</p>
<p>Also, we are talking about software written back when static analyzers where unusable, where a compiler warning could mean that the compiler was wrong&#8230;</p>
<p>Start using clang, &#8211;Weverything, static analyzers and you almost won&#8217;t even need things like valgrind, as long as you are not trying to do black magic.</p>
<p>C is long and hard, C++(11) can be easily modularized, checked, made safe and quick.</p>
<p>Sure, you might need to restrain a little bit the developers, but every project has coding guidelines. And that&#8217;s what a maintainer is for.</p>
<p>C++(11) is <em>NOT</em> on the same level as C in safety, and saying so shows you do not know the language.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219799">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219799">
						April 12, 2014 3:26 PM					</a>

				</p>

				<p>@L</p>
<p>&#8220;C++, and C++11 especially, on the other hand, can give you the low-level you need for performance, and the high-level, memory-safe version.&#8221;</p>
<p>The funny thing is that I expected a reaction like this.</p>
<p>This is what I said earlier:</p>
<p>&#8220;We need a language that is unambigious, easy to understand and does what you think it should do. C is not that, and C++ certainly not.&#8221;</p>
<p>The problem is that in C++ you can&#8217;t even guarantee that 1 + 1 = 2. You have to look at the disassembled code.</p>
<p>And about micro optimalisations, do you think that your micro optimalisation even matters in 10 years? The OpenSSL bug was also possible because of some ridiculous malloc reimplementation that these guys thought would be helpful 10 years ago. (here we have it again: temporary code)</p>
<p>Finally, C++11 is only C++11 is all the required libraries are C++11. If they contain old C++ code you still have to know the old C++ code. The problem is and always will be backwards compatibility.</p>
<p>So C++ is a crappy language, made worse with every release because it is still backwards compatible. It&#8217;s a bolted on language.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219800">

			<div class="comment by-larry-seltzer ">

				<p class="commentcredit">

					<span class="commenter">Larry Seltzer</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219800">
						April 12, 2014 4:25 PM					</a>

				</p>

				<p>As long as so many will be revoking and reissuing certificates, perhaps they could move to SHA2 at least?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219801">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219801">
						April 12, 2014 4:57 PM					</a>

				</p>

				<p>On the eff facebook page someone tipped me to this old but interesting discussion on how the heartbeat standard was developed:</p>
<p><a href="https://www.ietf.org/mail-archive/web/tls/current/msg08013.html" rel="nofollow ugc">https://www.ietf.org/mail-archive/web/tls/current/msg08013.html</a></p>
<p>I would need additional time to figure on what exactly they are talking, but what they are discussing here seems not very responsible to me.</p>
<p>This seems to contain discussions on draft work for the tls standard. But they seem not guided by anything related to security concerns, when explaining payloads, heartbeat and padding lengths&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219802">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219802">
						April 12, 2014 4:57 PM					</a>

				</p>

				<p>@ L</p>
<p>The problem for C++ is same as for C: language is hard to read, hard to compile correctly, and provides plenty opportunities for disaster.</p>
<p>The D language improves a lot on it. I think it deserves a mention.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219803">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">tom</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219803">
						April 12, 2014 5:49 PM					</a>

				</p>

				<p>I&#8217;m still mulling over the fact that Neel Mehta of Google discovered Heartbleed, apparently as part of assigned team duties. He has a rarely updated twitter page <a href="https://twitter.com/neelmehta" rel="nofollow ugc">https://twitter.com/neelmehta</a>; Google has not allowed interviews.</p>
<p>This says to me that Google doesn&#8217;t trust OpenSSL Software in the slightest and is paying for its own top to bottom code review of the whole security software enterprise.</p>
<p>If so, this was perhaps driven by NSA double-crossing them with wholesale extra-legal fiber optic theft from private leased lines which cost Google a bundle to remedy at their data centers. Not to mention the intangible costs of lost trust and its re-establishment. NSA became the top threat to their entire business model, stealing data that normally is sold.</p>
<p>While we can appreciated this bug being disclosed, we have no assurance that Google is reporting all the bad bugs they are presumably discovering. For negotiating traction (&#8220;back off, you *ssholes&#8221;), they may be holding some back that NSA is really using on a large scale.</p>
<p>As someone noted above, Google is in a position to taint traffic tags to establish if NSA/GCHQ is still stealing, even without knowing explicitly how they are doing it. (If you cannot constantly monitor agreement compliance with NSA/GCHQ, you won&#8217;t get any.) In that event, the SSL back doors that NSA really cares about might just surface as new CVEs.</p>
<p>In this scenario, Heartbleed was just a shot across the bows.</p>
<p><em>/</em>/<em>/</em></p>
<p>How about Codenomicon announcing the same bug 3 hours later, simultaneously naming it, designing the catchy icon, and releasing a dedicated web page? A coincidence &#8212; same day for a bug out there 828 days/ 3 hour window of 18,872?</p>
<p>Thus the options here are independent discovery yet somehow with shared communication; Mehta managing code review by an outside contractor;  a large informal consortium of companies cooperatively checking security software, each component assigned to pairs; or a German govt employee like Seggelmann serving as conduit between Google and Codenomicon.</p>
<p><em>/</em>/<em>/</em></p>
<p>I&#8217;m also mulling over Seggelmann causing billions of dollars of global damage but being entirely unapologetic, blowing it off as just one of those inevitable little things.</p>
<p>He evidently feels safe in the second year of his IT security job with Deutsche Telecom &#8212; where the German govt retained a 35% controlling interest &#8212; the company didn&#8217;t fire him for crappy code but instead bragged about his work yesterday on the corporate front page. Marketing the trust. <a href="http://www.telekom.com/corporate-responsibility/security/229078" rel="nofollow ugc">http://www.telekom.com/corporate-responsibility/security/229078</a></p>
<p>Recall a week earlier the German govt announced a no-holds-barred adverserial Sigint attack on the US, after failure of negotiations to become a genuine ally. The continuing NSA intransigence on monitoring the 134 top German officials below Merkel (who got a temporary reprieve but no deletion of 300 product reports on her) did not sit well with them.</p>
<p>We can thus speculate that Seggelmann originally introduced the bug, leveraged it into a top security job with the German telecommunications, with the govt then offering it as a bone to NSA.</p>
<p>After getting slapped down (like Google) in negotiations with NSA, the German govt then opted to send a message, third-partying the bug for disclosure to a Finnish security company with whom it does a lot of business. Google has had a lot of regulatory problems in Germany and a common enemy in the US security state so would have reasons to join the project.</p>
<p>The coincidence in bug release timing is thus part of the message: &#8216;we (Google and the German security state) have even more painful leaks  that can be disclosed if NSA won&#8217;t come to the table.&#8217;</p>
<p>OpenSSL is riddled with mistakes, used by top players for barter. Heartbleed was just a first shot across the bows.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219804">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219804">
						April 12, 2014 6:00 PM					</a>

				</p>

				<p>@Tom:</p>
<p>&#8220;They disclose support only from 3 companies (Qualys, opengear, and PSW Group) but acknowledge &#8220;we ask permission to identify sponsors and that some sponsors we consider eligible for inclusion here have requested to remain anonymous.&#8221;</p>
<p>A million bucks a year for four core people and seven programmers who are &#8216;active contributers&#8217;? That&#8217;s a sweet deal for part-timers, $150k a year. Volunteer a little on SSL to get funneled juicy consulting gigs on SSL &#8212; not my idea of altruistic public service. Might those gig providers include BND, GCHQ, NSA or one of their many front groups or security industry allies?</p>
<p><a href="https://www.openssl.org/support/donations.html" rel="nofollow ugc">https://www.openssl.org/support/donations.html</a></p>
<p>&#8220;Please note that the OpenSSL Software Foundation (OSF) is incorporated in the United States as a regular for-profit corporation. It does not qualify as a non-profit, charitable organisation under Section 501(c)(3) of the U.S. Internal Revenue Code.&#8221;</p>
<p>Your comment worried me very much.<br />
There are so many german programmers. On openssl I would have expected a broad international team. But there are almost none foreign persons.</p>
<p>Here is an old article in DER SPIEGEL. It is from 1996:<br />
<a href="http://cryptome.org/jya/cryptoa2.htm" rel="nofollow ugc">http://cryptome.org/jya/cryptoa2.htm</a></p>
<p>It describes how BND and NSA together worked to deliberately weaken Cryptographic devices of Crypto AG. The NSA advisor who told how to weaken used to formerly advise motorola. Whilst that may be interesting, if you have a motorola crypto device, the article writes that the BND practically owned the entire company!</p>
<p>&#8220;But a big part of the shares are owned by German owners in changing constellations. Eugen Freiberger, who is the head of the managing board in 1982 and resides in Munich, owns all but 6 of the 6,000 shares of Crypto AG. Josef Bauer, who was elected into managing board in 1970, now states that he, as an authorized tax agent of the Muenchner Treuhandgesellschaft KPMG [Munich trust company], worked due to a &#8220;mandate of the Siemens AG&#8221;. When the Crypto AG could no longer escape the news headlines, an insider said, the German shareholders parted with the high-explosive share.</p>
<p>Some of the changing managers of Crypto AG did work for Siemens before. Rumors, saying that the German secret service BND was hiding behind this engagement, were strongly denied by Crypto AG.</p>
<p>But on the other hand it appeared like the German service had an suspiciously great interest in the prosperity of the Swiss company. In October 1970 a secret meeting of the BND discussed, &#8220;how the Swiss company Graettner could be guided nearer to the Crypto AG or could even be incorporated with the Crypto AG.&#8221; Additionally the service considered, how &#8220;the Swedish company Ericsson could be influenced through Siemens to terminate its own cryptographic business.</p>
<p>The secret man have obviously a great interest to direct the trading of encryption devices into ordered tracks.</p>
<p>Sepending on the projected usage area the manipulation on the cryptographic devices were more or less subtle, said Polzer. Some buyers only got simplified code technology according to the motto &#8220;for these customers that is sufficient, they don&#8217;t not need such a good stuff.&#8221;</p>
<p>In more delicate cases the specialists reached deeper into the cryptographic trick box: The machines prepared in this way enriched the encrypted text with &#8220;auxiliary informations&#8221; that allowed all who knew this addition to reconstruct the original key. The result was the same: What looked like inpenetrateable secret code to the users of the Crypto-machines, who acted in good faith, was readable with not more than a finger exercise for the informed listener.</p>
<p>&#8220;In the industry everybody knows how such affairs will be dealed with,&#8221; said Polzer, a former colleague of Buehler. &#8220;Of course such devices protect against interception by unauthorized third parties, as stated in the prospectus. But the interesting question is: Who is the authorized fourth?&#8221;&#8221;</p>
<p>It would be very surprising if the activities of the german secret service would be restricted to only &#8220;crypto hardware&#8221;. If it manipulated crypto hardware, it can be assumed it is also interested in crypto software.</p>
<p>And there we have an open ssl foundation, consisting of merely germans, and which financed by groups or people who want to be anonymous!</p>
<p>That sounds strange. I mean, if an ordinary company wants to strengthen ssl encryption, why should it want to remain anonymous?</p>
<p>MDB Ströbele of the green party is in the parlamentarian controll comission and currently asking tough questions.</p>
<p>Someone should message him that it should be investigated whether BND has an involvement in openssl and knew heartbleed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219805">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219805">
						April 12, 2014 6:50 PM					</a>

				</p>

				<p>There is a &#8220;reverse&#8221; Heartbleed, that can suck up larger amounts of data, more continuously</p>
<p><a href="http://blog.meldium.com/home/2014/4/10/testing-for-reverse-heartbleed" rel="nofollow ugc">http://blog.meldium.com/home/2014/4/10/testing-for-reverse-heartbleed</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219806">

			<div class="comment by-william-payne ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.wtpayne.info' rel='external nofollow ugc' class='url'>William Payne</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219806">
						April 12, 2014 7:02 PM					</a>

				</p>

				<p>It is nice to see the emphasis on the programming omission that made heartbleed possible. It is also nice to see the discussion encompassing issues like static analysis tools and code review. Hopefully we can start to raise awareness of these tools and techniques in the public consciousness, as well as to spread the message about just how much effort it takes to provide any sort of meaningful quality assurance for real-world software.</p>
<pre><code>           ....Says the software / algorithms test guy trying to shore up institutional support for his discipline ...
</code></pre>
<p>🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219807">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219807">
						April 12, 2014 8:29 PM					</a>

				</p>

				<p>@anon</p>
<p>&#8220;Reverse heartbleed&#8221; has been mentioned as also possible since the beginning, just not with that fancy name and not with that much analysis yet.  Thanks for the url.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219808">

			<div class="comment by-secret-police ">

				<p class="commentcredit">

					<span class="commenter">Secret Police</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219808">
						April 12, 2014 8:43 PM					</a>

				</p>

				<p>This is a good talk by Poul-Henning Kamp (FreeBSD) @ FOSDEM &#8217;14</p>
<ul>
<li>he covers how open source projects are sabotaged</li>
<li>how discussion is distracted purposely</li>
<li>how NSA shills can sneak in patches</li>
<li>how NSA can shutdown privacy projects with patent trolling</li>
<li>how Skype was likely bought by the NSA thru proxy</li>
<li>how totally screwed OpenSSL is</li>
<li>how totally screwed Ipv6 is</li>
<li>how totally screwed DNSSEC is</li>
</ul>
<p><a href="http://youtu.be/fwcl17Q0bpk" rel="nofollow ugc">http://youtu.be/fwcl17Q0bpk</a></p>
<p>OpenSSL is like, the crown jewel of sabotaged standard libraries.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219809">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219809">
						April 12, 2014 9:07 PM					</a>

				</p>

				<p>@ Secret Police</p>
<p>&#8220;how NSA can shutdown privacy projects with patent trolling&#8221;</p>
<p>I was a step ahead on this one. I posted here that I was focusing my efforts on building a secure hardware/software architecture that only used 20+ year old tech. I said they&#8217;d use patents to destroy whatever I create. Good news is that permutations of old tech can produce highly secure and even usable systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219810">

			<div class="comment by-secret-police ">

				<p class="commentcredit">

					<span class="commenter">Secret Police</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219810">
						April 12, 2014 10:52 PM					</a>

				</p>

				<p>@Nick P</p>
<p>Go on alibaba and find feature phones. Create a SIM overlay that uses SIM toolkit to encrypt voice and sms, and acts as a firewall to block commands to the SIM like stealth type-0 SMS tracking and OTA. Remove the baseband, and attach it to the back of the phone cover and code it with Osmocomm open GSM stack or something. 😛 Though I suspect Nortel or old Blackberry patents have that covered</p>
<p>Didn&#8217;t know it would only cost them &lt;$30k to block any privacy project with a patent troll.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219811">

			<div class="comment by-secret-police ">

				<p class="commentcredit">

					<span class="commenter">Secret Police</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219811">
						April 12, 2014 10:54 PM					</a>

				</p>

				<p>Der, html filtered.<br />
Didn&#8217;t know it would only cost them under $30k to block all future privacy software with patents</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219812">

			<div class="comment by-fly_on_wall ">

				<p class="commentcredit">

					<span class="commenter">Fly_on_wall</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219812">
						April 12, 2014 10:55 PM					</a>

				</p>

				<p>Many networks and ISPs have the ability to spy on https using a proxy and an extra certificate to make the connection look secure. Microsoft has a handy tool to do this, and there are other companies that provide this service. Many connections if tested with a regular browser to see if traffic is being sent via a SSL proxy will come up positive.</p>
<p>How do you check this usually? By checking if the SHA1 fingerprint for that site match what you are being served via your browser. If you check the fingerprint using Tor it matches, but however using Firefox without Tor, for example which I was testing with, the SHA1 fingerprint does not match for that connection. That shows a proxy between your connection, perhaps your ISP, and the internet. Such a proxy could log all traffic for later analysis and filter it for keywords and internet addresses.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219813">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219813">
						April 12, 2014 11:04 PM					</a>

				</p>

				<p>That the D language is itself so commonly used for exploitation, should probably raise some red flags on its own&#8230; That it&#8217;s seen so much use covertly, it&#8217;s certainly a <b>d</b>isaster still hiding in the shadows&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219814">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219814">
						April 12, 2014 11:15 PM					</a>

				</p>

				<p>@ Buck</p>
<p>What the D language is commonly used for says nothing about its exploitability. That it&#8217;s an immature language and not primarily focused on security are risk factors. It would be something I&#8217;d say build on or try to improve rather than use right now. Ada with safety-checks on is my primary recommendation. I&#8217;m working on a special compiler design that get&#8217;s around <em>its</em> issues, while not actually being an Ada compiler. (what a paradox, eh?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219815">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219815">
						April 12, 2014 11:26 PM					</a>

				</p>

				<p>@ Secret Police</p>
<p>That won&#8217;t do. I already have several abstract secure phone designs. There&#8217;s plenty of custom hardware in there needed to get rid of most threats. The project would cost a LOT of money with no guarantees of end result. Meanwhile, I just continue thinking of cellphones as entertainment devices that also pass messages (eg calls) through crowds of gossiping middlemen. If I later buy Blackphone or a Cryptophone, I&#8217;ll think the same thing except there are fewer gossiping middlemen. Encrypted cell phone that&#8217;s safe against TLA&#8217;s isn&#8217;t practical right now unless wealthy individuals or organizations decide to fund it at a loss.</p>
<p>However, such a phone is doable if you change &#8220;cell&#8221; to &#8220;mobile&#8221; or &#8220;fixed-line.&#8221; I&#8217;ve already posted an abstract design of a brief-case sized device for that here with high design assurance. A rework by pro&#8217;s would be needed for high implementation assurance. The resulting system is a few hundred to a few grand in hardware depending on things. And both parties must use it and use it right. Yet, how many potential buyers would want to lug around a suitcase of communications gear for the few calls it&#8217;s used for?</p>
<p>Security engineering: the engineering discipline that is only pleasing to masochists. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219816">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219816">
						April 12, 2014 11:30 PM					</a>

				</p>

				<p>Buck (April 12, 2014 11:04 PM)</p>
<p>I think there is a simple explanation for that.</p>
<p>D is something like C++ done the right way. It tremendously enhances programming efficiency and it&#8217;s still considered cool. If I came from a C/C++ background and were not willing to learn/use a different language/paradigm yet wanted to gain efficiency D would be what I&#8217;d use.</p>
<p>At the same time D still has many quirks and the tools incl. compilers, debuggers, etc. as well as D&#8217;s library are still quite somewhat limited and/or floating. Which leads corporate users to not use it but to rather wait (or forget it).</p>
<p>Of course, this also translates to D a) being used to create lots of lousy code more efficiently and b) sooner or later looking very attractive to corporate customers (&#8220;efficiency -&gt; lower cost&#8221;) feeding back and adding to a).</p>
<p>Actually I consider D to be outright dangerous because it offers &#8211; and advertises &#8211; design by contract features which, of course, will attract lots of users (&#8220;Cool! Hacking in C and enjoying built-in security&#8221;) who quite soon will discover D&#8217;s powerful preprocessor (actually more like a dynamic compile time engine) and other major deficiencies considered to be great by D people.<br />
In other words: D risks to become a more potent disaster tool with a nice DbC label on it.</p>
<p>It&#8217;s about time that people, at least in sensitive areas, understood that readability is way more important than ease of hacking.</p>
<p>Just look up average response times (&#8220;Response&#8221; meaning problem solved) to bugs. C/C++ are <em>major</em> culprits for those shocking time frames.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219817">

			<div class="comment by-strangebedfellow ">

				<p class="commentcredit">

					<span class="commenter">strangebedfellow</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219817">
						April 12, 2014 11:50 PM					</a>

				</p>

				<p>Many may expect the Tor Browser Bundle to have an update after the latest revelations, and low and behold there is a new version 3.5.4</p>
<p>Upon launching the new version of Tor Browser Bundle 3.5.4 it imediately tries to establish a couple of new connections, one an SSH connection, and another IP 213.163.64.74 that identifies as malicious according to Malwarebytes Anti-Malware. This may be a false positive, however the previous Tor Browser Bundle 3.5.3 does not attempt to establish this connection, nor the SSH connection. Now this may just be some monitoring the contributors are doing to check this new release of 3.5.4 and a connection to a new directory server with new authority key certificates, as these connections are immediate before Tor asks for relay descriptors and establishes a Tor circuit.</p>
<p>Here&#8217;s the rub, may Tor Browser Bundle 3.5.3 and previous versions be exposed to an SSL vulnerability and leak information, and might Tor Browser Bundle 3.5.4 be being monitored via a new trick?</p>
<p>One may want to be a little warry about passing any sensitive information over the internet for some time until you can put some faith in the chain of trust.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219818">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219818">
						April 13, 2014 12:02 AM					</a>

				</p>

				<p>I may have been misunderstood here&#8230;<br />
I&#8217;m not really trying to say that D is inherently &#8216;bad&#8217;&#8230; but more that the advanced exploiters themselves seem to be distancing their own code from traditional C&#8230; Is there a reason for that? Probably 😉<br />
I think most of us can agree that technology is essentially neutral, while its application determines intent&#8230;<br />
I guess what I&#8217;m trying to say is that blackhats are more flexible than the whitehats. No need to constantly patch stuff that depends on nobody else knowing about it :-\</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219819">

			<div class="comment by-hiddenservice ">

				<p class="commentcredit">

					<span class="commenter">hiddenservice</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219819">
						April 13, 2014 12:11 AM					</a>

				</p>

				<p>Notes on Tor Browser Bundle 3.5.3</p>
<p>Hidden services: Tor hidden services might leak their long-term hidden service identity keys to their guard relays. Like the last big OpenSSL bug, this shouldn&#8217;t allow an attacker to identify the location of the hidden service [edit: if it&#8217;s your entry guard that extracted your key, they know where they got it from]. Also, an attacker who knows the hidden service identity key can impersonate the hidden service. Best practice would be to move to a new hidden-service address at your convenience.</p>
<p>Directory authorities: In addition to the keys listed in the &#8220;relays and bridges&#8221; section above, Tor directory authorities might leak their medium-term authority signing keys. Once you&#8217;ve updated your OpenSSL package, you should generate a new signing key. Long-term directory authority identity keys are offline so should not be affected (whew). More tricky is that clients have your relay identity key hard-coded, so please don&#8217;t rotate that yet. We&#8217;ll see how this unfolds and try to think of a good solution there.</p>
<p>There is a new 3.6-beta2 release you could try instead of 3.5.4, but be warned that it needs much more testing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219820">

			<div class="comment by-dlang ">

				<p class="commentcredit">

					<span class="commenter">Dlang</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219820">
						April 13, 2014 12:16 AM					</a>

				</p>

				<p>The language is irrelevant as these are crypto libraries and standards that are purposely designed to be crippled, obfuscated, and misleading. Just look at some of the TLS working group&#8217;s chat log&#8217;s</p>
<p>I may take some talking to convince DNSSEC library implementors to provide functions to verify DNSSEC records provided through a (standardized) flat memory buffer, rather than having it collect those records itself</p>
<p>Nothing could go wrong. Not like forming an illegal address and overflowing the buffer is dead simple with a flat memory model or anything. Let&#8217;s cram this into the library!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219821">

			<div class="comment by-dlang ">

				<p class="commentcredit">

					<span class="commenter">Dlang</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219821">
						April 13, 2014 12:24 AM					</a>

				</p>

				<p>Damnit allowed HTML tags ruining my cut + paste.</p>
<p><cite>[20:59:26] (mrex) I may take some talking to convince DNSSEC library implementors to provide functions to verify DNSSEC records provided through a (standardized) flat memory buffer, rather than having it collect those records itself</cite></p>
<p>Anyways, go through the TLS working group logs and find all sorts of incompetence. All these standards should be burned, competent people like D. J. Bernstein appointed instead of industry hacks with close connections to US intel agencies.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219822">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219822">
						April 13, 2014 12:32 AM					</a>

				</p>

				<p>Buck (April 13, 2014 12:02 AM)</p>
<p>vI guess what I&#8217;m trying to say is that blackhats are more flexible than the whitehats. No need to constantly patch stuff that depends on nobody else knowing about it :-\ </p>
<p>Well, their jobs are usually quite different.</p>
<p>While the white hats usually rather use configurable tools or do some scripting, the black hats write lots of code.(Disclaimer: Some of what I say might be not 100% correct; it&#8217;s a while since I played with D).</p>
<p>Where I need to care about details, for instance, allocating the necessary bytes on the heap via malloc, keeping track of it, making sure I don&#8217;t overrun it, and finally freeing it, in D I have a simple new operation and a readily available string.</p>
<p>If you look at C code you&#8217;ll find that there is a tremendous amount of housekeeping, using (and managing) libraries for rather mundane tasks, insane error handling with funny nesting in it, and so on. With D you can suddenly just hack away and concentrate on the job at hand.</p>
<p>Now, I don&#8217;t know too much about black hats but I strongly assume that time is quite often of essence (you just heard of that 0-day and want to be the first to exploit it &#8230;) so D&#8217;s very much increased efficience somes in more than handy. Feeling very close to C I remember hacking away at a small (hand coded. There&#8217;s a lib too, IIRC) parser within days. <em>Of course</em> that&#8217;s very attractive for experienced C programmers looking for decisively enhanced efficiency.</p>
<p>But then, the really interesting point for us here is how to keep them away, how to avoid exploitable code in the first place. And in that regard all C successors and friends up to and including java will keep us in the losing corner.</p>
<p>With hardly more than the kernels (Linux, <em>BSD, *Solaris) and some few softwares not more or less rotten and pretty much all software written in C and its ugly descendants exploits are not a surprise &#8211; everyday without a new exploit *is</em>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219823">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219823">
						April 13, 2014 12:39 AM					</a>

				</p>

				<p>Dlang</p>
<p>Well, I don&#8217;t see it as &#8220;either or&#8221; but rather as &#8220;both&#8221;. Lousy standards made, at least in part, by people with dubious motivations are implemented in C/C++ and toys.<br />
(I say toys because while, for instance, Python is a very useful tool, <em>any and every</em> language without static typing (and preferably being paranoid about it) is but a toy in terms of safe security tools).</p>
<p>Btw:</p>
<p>@Secret Police</p>
<p>Thanks for that link. Poul put our noses right into the dirt and quite probably his funny what-if scenario is way closer to reality than we&#8217;d like to believe.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219825">

			<div class="comment by-foureyes ">

				<p class="commentcredit">

					<span class="commenter">fourEYES</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219825">
						April 13, 2014 12:56 AM					</a>

				</p>

				<p>The beta version of Tor Browser 3.6-beta-2 checks out and does not launch any strange connections plus the SHA1 fingerprint for the site matches and the signature of the file matched when downloaded.</p>
<p><a href="https://www.torproject.org/projects/torbrowser.html.en#downloads-beta" rel="nofollow ugc">https://www.torproject.org/projects/torbrowser.html.en#downloads-beta</a></p>
<p>If only embedded hardware was so easy to fix, and that smartphone and tablet manufactures rolled out timely updates for the huge number of security flaws present in most. I completely avoid smartphones, but they are a very handy tool for remote network penetration testing and also many nefarious activities practiced by some individuals. I imagine smartphone manufactures and the software providers will update their client software and roll out patches sometime long after the next really bad exploit or bug is discovered leaving such devices always vulnerable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219826">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219826">
						April 13, 2014 1:06 AM					</a>

				</p>

				<p>Anyone interested in launching a lightweight and concise crypto library that only serve a handful of algorithms with inclusive a &#8220;stupid mode&#8221; (which means the defaults are made to be secure like using CBC mode by default for programmers who don&#8217;t know crypto) ? The requirement would also be to make the library modular so that if someone only wants the AES-CBC portion, they can simply compile only for that portion. I am thinking the set of algorithms to be supported should be very strict and small (Blowfish, Rijndael, Twofish and Serpent) with modes (ECB, CBC for now) and of course, no C/C++ allowed. Probably start off with Java while referencing the Bouncycastle library and other libraries. Documentations and consistency is highly sought after post-Heartbleed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219827">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219827">
						April 13, 2014 1:32 AM					</a>

				</p>

				<p>@Clive Robinson<br />
<em>&#8220;Now there has been a question over what some regard as an elementry mistake (not bounds checking correctly) however I don&#8217;t think they are looking at it dispassionatly and are also using 20-20 Hindsight.&#8221;</em></p>
<p>I agree on that. It is very difficult to find such bugs by reviewing C code (definitely C code in the way C software typically has been written a decade ago, like OpenSSL). A few years ago, I spent several weeks to find a bug that only showed occasionally in production in some relatively complex C server-side oftware. We first tried to also log more when it happened and activated cores, but for some specific reasons the logs were not written out then and also cores helped little, which is why we spent maybe more time that anticipated doing static code review. It really took two people, looking at the same code over and over again (on and off), several weeks to finally find the bug, even though the corresponding functionality had a relatively well-structured design relative to the rest of the code around it. So, yes, in general, unless maybe the NSA etc. has some much more advanced tools that can find such things automatically by static code analyis, there is a good chance that nobody can reliably detect even such issues that look so obvious in hindsight. In that sense, C may even help to protect.</p>
<p>Normally, I would just say &#8220;shit happens&#8221; with regard to the strange design of the heartbeat and with the bug in implementation and find it well possible that it would remain unnoticed for a long time, even for the largest organisations looking for such issues as their core business and with lots of money.</p>
<p>In other words, in dubio pro reo. However, the issue should be investigated. To me personally, this &#8220;smells&#8221; a lot like a planted backdoor, just a gut feeling, but it all looks so smooth and plausibly deniable that it might overall simply be to improbable to be real.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219829">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219829">
						April 13, 2014 2:12 AM					</a>

				</p>

				<p>Many Devices Will Never Be Patched to Fix Heartbleed Bug</p>
<p><a href="http://www.technologyreview.com/news/526451/many-devices-will-never-be-patched-to-fix-heartbleed-bug/" rel="nofollow ugc">http://www.technologyreview.com/news/526451/many-devices-will-never-be-patched-to-fix-heartbleed-bug/</a></p>
<p>The good news is devices released before 2011 won&#8217;t contain the bug, unless they were patched with updated firmware that introduced the HeartBleed bug. Lynksis posted that their routers are unaffected, but Cisco and Juniper have affected devices which they are releasing patched firmware for. Many other router manufacturers haven&#8217;t commented on their forums about their devices. If some of these other manufacturers do eventually comment or release updated firmware it&#8217;s unlikely many home users will update their devices anyway.</p>
<p>OpenSSL is used for remote administration and VPN for a large number of router/modem/firewall devices. You can and should disable remote admistration if it isn&#8217;t already (home routers often have remote administration turned off by default but it&#8217;s worth checking) then reboot your device.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219830">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219830">
						April 13, 2014 2:38 AM					</a>

				</p>

				<p>@Nick P,<br />
Speaking of &#8220;C&#8221; and &#8220;D&#8221; programming languages, I&#8217;d be interested to read your take on the &#8220;E'&#8221; programming language and capability-based Operating Systems&#8230;<br />
<a href="http://erights.org/index.html#2levels" rel="nofollow ugc">http://erights.org/index.html#2levels</a><br />
<a href="http://www.eros-os.org/eros.html" rel="nofollow ugc">http://www.eros-os.org/eros.html</a><br />
<a href="http://www.cs.cornell.edu/courses/cs513/2005fa/L08.html" rel="nofollow ugc">http://www.cs.cornell.edu/courses/cs513/2005fa/L08.html</a><br />
Also, you may want to consider adding ABAC; Attribute Based Access Control<br />
<a href="http://csrc.nist.gov/projects/abac/" rel="nofollow ugc">http://csrc.nist.gov/projects/abac/</a><br />
Perhaps that would make your design more secure? I think we talked about this briefly a while back&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219831">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219831">
						April 13, 2014 3:06 AM					</a>

				</p>

				<p>@Mr. Pragma</p>
<p>&#8220;D is something like C++ done the right way.&#8221;</p>
<p>&#8230; No sorry. You can&#8217;t do C++ the right way.</p>
<p>Just think about simplicity. Until now the only &#8220;new&#8221; language that really impressed me with simplicity is Go.</p>
<p>@Thoth</p>
<p>The problem with modular approaches is that both sides at the end of the line needs to have <em>all</em> the crypto stuff. Why not specify 2 modes, one military grade that takes all energy of the galaxy and billions of years to crack, for doing banking stuff and that kind of things, and one for ordinary use that would take 100 years with all the computers of the world to crack. You know, simple stuff, for ordinary chatting and Facebook stuff.</p>
<p>If you have only 1 or 2 predefined modes, with also predefined settings (AES256, SHA2, etc), not only would it simplify the protocols but also the libraries that implement these protocols.</p>
<p>In short, I am not really convinced that modularity is a good thing in security software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219832">

			<div class="comment by-itgrrl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://itgrrl.com/' rel='external nofollow ugc' class='url'>itgrrl</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219832">
						April 13, 2014 3:11 AM					</a>

				</p>

				<p>It&#8217;s interesting that the NSA have denied having prior knowledge of Heartbleed. They seem to prefer (at the moment) to claim incompetence rather than malice. If the NSA truly had no prior knowledge of Heartbleed, then it would seem to be failing <em>both</em> of its stated missions. Which then begs the question&#8230; why continue to fund it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219833">

			<div class="comment by-l ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.fenrirproject.org' rel='external nofollow ugc' class='url'>L</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219833">
						April 13, 2014 3:26 AM					</a>

				</p>

				<p>The D language sound nice, but still way to immature.</p>
<p>I still believe that C++11 is the way to go if you start a new project now, but you actually have to learn it again. If you think it is just a little library update, you&#8217;re definitely wrong, the design and programming in general gets much simpler and straightforward.</p>
<p>Of course you can do bad things in C++11. If you use it like the people in gtk or gcc, just as if it was &#8220;C with classes&#8221; you are obviously going to fail. Because you are using a language you don&#8217;t know.</p>
<p>You can do bad things with all languages. The problem with C++ is that you really can do anything. That&#8217;s why a maintainer who is knowledgeable with the language is needed, so that people do not write in C or do not overload all operators &#8220;just because&#8221;&#8230;</p>
<p>If you can find good coding guidelines then C++ is way safer than C.</p>
<p>Its the same in all languages. Without the right coding guidelines you can write unreadable code in <em>any</em> language, just think about the format, the declarations&#8230;</p>
<p>Any other language is either too esoteric, and then people won&#8217;t not help you, or too immature, and it&#8217;s not safe to use.</p>
<p>So IMHO, C++11 is the only sane choice for a new project right now if you do not want a big runtime env, a VM or interpreted code.</p>
<p>Anyway, I&#8217;m coding an authentication protocol in C++11, we&#8217;ll see how it turns out 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219834">

			<div class="comment by-mirar ">

				<p class="commentcredit">

					<span class="commenter">Mirar</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219834">
						April 13, 2014 3:43 AM					</a>

				</p>

				<p>@Dave Walker: I&#8217;ve heard complaints from people using OpenSSL that it gives heaps of problems with for instance valgrind (memory leaks etc). I find it quite possible that the static analysis tools will find a lot of problems in the OpenSSL project&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219835">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219835">
						April 13, 2014 3:55 AM					</a>

				</p>

				<p>@L</p>
<p>Please take a look at <a href="http://pastebin.com/ZAahS4LP" rel="nofollow ugc">this</a> code sample from OpenSSL. Do you trust C++ with these guys?</p>
<p>Believe me, you can&#8217;t write this kind of code in Go. You still can (and eventually will) write this kind of code in C++. You need a language where you <em>can&#8217;t</em> take shortcuts, because in ten years time your code is full of it.</p>
<p>Let me put if different. Name me one old large C++ library that isn&#8217;t full of crap.</p>
<p>That is the reality.</p>
<p>Edsger Dijkstra once said: <i>&#8220;The competent programmer is fully aware of the strictly limited size of his own skull; therefore he approaches the programming task in full humility, and among other things he avoids clever tricks like the plague.&#8221;</i></p>
<p>Compare this quote with the code sample and then think about C++.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219836">

			<div class="comment by-just-wondering ">

				<p class="commentcredit">

					<span class="commenter">just wondering</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219836">
						April 13, 2014 5:19 AM					</a>

				</p>

				<p>What about modern, high performance Java networking frameworks like e.g. <a href="https://mina.apache.org" rel="nofollow ugc">Apache Mina</a> or <a href="http://netty.io" rel="nofollow ugc">Netty</a> as an alternative to C/OpenSSL?</p>
<p>Regarding the sandbox, i.e. with regard to imposing higher restrictions than the privileges of the running process, Java has failed quite a bit. But otherwise? Anything that would be worse in a VM running with same privileges as a process written in C? And performance might nowadays be acceptable or maybe even superior depending on the application? And lots of libraries with mostly a good standard structure (unit tests, javadoc, &#8230;) available in Java, so clearly more than an academic niche alternative?</p>
<p>And maybe today more open source developers interested in and able to contribute in Java than in C? Not a panacea but maybe a robust step forward in terms of security?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219837">

			<div class="comment by-alext ">

				<p class="commentcredit">

					<span class="commenter">AlexT</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219837">
						April 13, 2014 5:44 AM					</a>

				</p>

				<p>Regarding the NSA debate I don&#8217;t really expect them to warn about such juicy exploits, no matter what they might claim.</p>
<p>That being said could we propose that whenever they identify an exploit they setup some monitoring (including honeypots) and if <em>else</em> shows up exploiting they promptly warn whoever is concerned, possibility through side channels (such as M. Mehta) ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219838">

			<div class="comment by-w ">

				<p class="commentcredit">

					<span class="commenter">W</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219838">
						April 13, 2014 5:58 AM					</a>

				</p>

				<p>&#8220;The Federal government relies on OpenSSL to protect the privacy of users of government websites and other online services. This Administration takes seriously its responsibility to help maintain an open, interoperable, secure and reliable Internet.&#8221;<br />
If this were true, certainly the government would now invest a little money to review the OpenSSL code and fix all vulnerabilities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219839">

			<div class="comment by-dlang ">

				<p class="commentcredit">

					<span class="commenter">Dlang</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219839">
						April 13, 2014 6:40 AM					</a>

				</p>

				<p>I think it&#8217;s pointless to put hopes in functional Java, Rust, Go and other &#8216;safe&#8217; languages to cure OpenSSL. The real problem is the entire infrastructure from standard libraries to essential protocols is, and has always been sabotaged. IETF Working groups are filled with shady state actors ensuring we maintain a 1990s standard of insecurity and centralization. They are still trying to get MtE block ciphersuites to work and refuse to acknowledge it&#8217;s a design flaw. They are still pushing DANE and DNSSEC, a ridiculous and almost laughably bad solution to PKI/CAs. They still create needlessly complex standards nobody can safely implement in any language.</p>
<p>Here&#8217;s a good example, this was drafted only last month <a href="http://datatracker.ietf.org/doc/draft-ietf-tls-encrypt-then-mac/" rel="nofollow ugc">http://datatracker.ietf.org/doc/draft-ietf-tls-encrypt-then-mac/</a></p>
<p>At this pace we should have TLS/OpenSSL fixed by 2025</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219840">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219840">
						April 13, 2014 11:00 AM					</a>

				</p>

				<p>@ Buck</p>
<p>I see what you&#8217;re saying. Yeah, they&#8217;re quite flexible. Flexible up to the point that one has the distinction of pushing <a href="http://philosecurity.org/2009/01/12/interview-with-an-adware-author" rel="nofollow ugc">more Scheme code</a> (as spyware) than anyone else. Malware authors also do more self-modifying code as it&#8217;s necessary for AV bypass. They also tend to work right in the abstraction gaps between running code &amp; C/C++ language that most developer neither focus on nor really understand. I actually even learned about an ultralightweight OOP C approach from one. Definitely things to learn from their choices as the nature of the work sometimes forces them to adapt with exotic or clever approaches to problem-solving.</p>
<p>@ Dlang</p>
<p>&#8220;The language is irrelevant as these are crypto libraries and standards that are purposely designed to be crippled, obfuscated, and misleading. Just look at some of the TLS working group&#8217;s chat log&#8217;s&#8221;</p>
<p>I agree that a garbage standard can lead to data compromise regardless of how it&#8217;s implemented. Yet, using a safe language <em>still</em> has benefits: an attacker using a memory violation to control your machine is <em>much</em> worse than recovering some plaintext off a SSL connection. The language and/or runtime is an important security layer that prevents and contains certain types of damage. And if the subversion is intended to target implementation, a safe language might make the standard safe despite subversion. Each link in security chain must be strong.</p>
<p>@ Thoth</p>
<p>&#8220;Anyone interested in launching a lightweight and concise crypto library that only serve a handful of algorithms with inclusive a &#8220;stupid mode&#8221; (which means the defaults are made to be secure like using CBC mode by default for programmers who don&#8217;t know crypto) ?&#8221;</p>
<p>It&#8217;s called <a href="http://nacl.cr.yp.to/features.html" rel="nofollow ugc">NaCl</a> and it&#8217;s made by the guy mentioned in Dlang&#8217;s request. So, you both win. Bernstein is also working on middleware like MinimalLT at the <a href="http://www.ethos-os.org/papers.html" rel="nofollow ugc">Ethos</a> project.</p>
<p>@ anonymous</p>
<p>&#8220;So, yes, in general, unless maybe the NSA etc. has some much more advanced tools that can find such things automatically by static code analyis&#8221;</p>
<p>There&#8217;s actually a ton of analysis tools and errors to catch. Talented white and black hats tend to use the better ones. Many memory violations and pointer issues can be detected with static or dynamic analysis tools. It just takes the money for the large number of staff to run through all the false positives looking for the real bug. NSA and their &#8220;offensive computing&#8221; contractors have that. So, any process creating stuff designed to resist such an organization must use every tool at its disposal to prevent exploits like this.</p>
<p>@ yesme</p>
<p>&#8220;Believe me, you can&#8217;t write this kind of code in Go. You still can (and eventually will) write this kind of code in C++. You need a language where you <em>can&#8217;t</em> take shortcuts, because in ten years time your code is full of it.&#8221;</p>
<p>That&#8217;s actually a good point. Either the language or the culture need to be designed to minimize hacks.</p>
<p>@ Wael</p>
<p>re E</p>
<p>It&#8217;s an interesting language that was used in several practical apps such as chat and a web browser. The system allows one to concisely write distributed apps with good security properties from the start. The drawback is that it&#8217;s implemented on top of the most attacked runtime in the world. It&#8217;s essentially the same drawback as any of the safer languages I mentioned. They each give you better odds of writing a robust app. And each can fail because they must eventually link to and run on unsafe constructions. Leads to the next topic.</p>
<p>re capability based systems</p>
<p>I&#8217;ve posted those links here before. 😉 My take on them is that capabilities are a powerful abstraction. Like tags, they seem to allow a single, highly-assured mechanism to enforce a wide range of security policies. Far as EROS link, click on &#8220;The KeyKOS System&#8221; to see how it was done in production &amp; KeySAFE which extended it for Orange Book trusted system requirements. EROS was a clean-slate version of KeyKOS for x86. It had a nice networking and GUI components, too. Doing many highly assured software designs over the years I found that the low-level architecture always fought against my efforts. For some reason, it never dawned on me that maybe I should just throw out existing architecture and build a <a href="http://homes.cs.washington.edu/~levy/capabook/" rel="nofollow ugc">better</a> one. If you need to narrow it down for time purposes, the Hydra, CAP, Intel, and System/38 designs were the most promising. System/38 proved a smart bet as it became AS/400 and hence only successful one.</p>
<p>I think capability machines have the potential to be a solution to our problems as they produce inherently more secure hardware that more easily maps to safe languages. Several such machines were exclusively programmed in higher-level, typed languages. An efficient, versatile mechanism is needed at hardware level and one of these machines might be key to discovering it. Ideally, the chosen language will be easy to learn or one already adopted. Alternatively, we can do it CLR- or VMS-style where certain low level aspects are standardized so many languages can seemlessly interoperate. For such reasons, my designs keep bouncing back and forth between tagged and capability style architectures. One implements both with the capabilities being managed in software, while tags ensure machine knows difference. At least one system in linked book did that but mine is expanded more. I&#8217;m also trying to integrate a secure I/O processor into it as most capability machines needed I/O offloading. I&#8217;m adding the requirement that I/O system transparently creates, removes, and enforces the tags/capabilities during device operations. Should prevent bypasses while unifying CPU and I/O security model.</p>
<p>Which of the capability machines interests you the most? And which approach do you think would be easiest to implement, esp by cheaper engineers? 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219841">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219841">
						April 13, 2014 12:07 PM					</a>

				</p>

				<p>Ha! Fantastic interview 😀 Thanks for the link!</p>
<blockquote><p>It was funny. It really showed me the power of gradualism. It&#8217;s hard to get people to do something bad all in one big jump, but if you can cut it up into small enough pieces, you can get people to do almost anything.</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219842">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://n3td3v.blogspot.co.uk' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219842">
						April 13, 2014 1:04 PM					</a>

				</p>

				<p>The National Security Agency (NSA) have denied that they were aware of the Heratbleed bug before the security flaw was made public.</p>
<p><a href="http://www.itv.com/news/update/2014-04-11/nsa-deny-knowledge-of-heartbleed-bug/" rel="nofollow ugc">http://www.itv.com/news/update/2014-04-11/nsa-deny-knowledge-of-heartbleed-bug/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219843">

			<div class="comment by-david-m ">

				<p class="commentcredit">

					<span class="commenter">David M</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219843">
						April 13, 2014 1:45 PM					</a>

				</p>

				<p>I see tons of web postings stating that new certificates are being issued, yet no one is clearly stating that they are FIRST generating a new private/public key pair for those new certificates.</p>
<p>How can a typical end user know for sure that the keys were regenerated, short of each end user calling the affected site and asking???</p>
<p>Without positive knowledge that the keys were regenerated, once cannot positively trust that the SSL connection is secure even after a new cert is in use&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219844">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219844">
						April 13, 2014 1:57 PM					</a>

				</p>

				<p>@ William Payne,</p>
<ul><i>It is nice to see the emphasis on the programming omission that made heartbleed possible. It is also nice to see the discussion encompassing issues like static analysis tools and code review.</i></ul>
<p>Firstly as I&#8217;ve already indicated this is not where we should be looking dor the root cause of the problem. People should actualy be looking at the requirment for the heartbeat in the first place (questionable design) and the ludicrous nature of the soloution (heartbeat specification).</p>
<p>Nobody at the IETF took a step back and said &#8220;WTF are we doining and WTF does it need such a rediculous solution?&#8221;</p>
<p>Supposadly the payload &#8220;length&#8221; issue is to do with preventing two or more heart beat responses getting confused&#8230; A thirty two bit (ie 4byte) fixed field would solve that issue, why anyone would think 64Kbyte (2^524288 number) was needed in this lifetime or the next thousand or so beats me on the common sense factor&#8230;</p>
<p>But that aside, there is no such thing as a safe/secure programing language that would be of real use. This was known long before the first electrical/electronic programable store machine was ever built.</p>
<p>Likewise Turing&#8217;s halting problem should tell you why any kind of &#8220;code analysis&#8221; system will always fail to catch the more interesting bugs.</p>
<p>And then there&#8217;s the &#8220;dependancy problem&#8221;, that is why should a code cutter even learn to program in a defensive manner to produce safe / secure code when an analyser can just be &#8220;run over it&#8221; and you then &#8220;fix the warning messages&#8221;&#8230;</p>
<p>It&#8217;s only taken two generations of &#8220;mobile phone&#8221; users for serious &#8220;dependancy problems&#8221; with them to be very real world issues. It&#8217;s fairly clear that many modern teenagers can not survive without the level of &#8220;connectivity&#8221; they provide. But two generations back people were easily able to cope without mobiles, by actually knowing how things could go wrong and planning ahead to avoid the problems, then think on their feet sensibly when unexpectef problems occured.</p>
<p>The problem with analysis tools is it won&#8217;t take long for code cutters to become hooked and dependant and then incapable of responding to the problems the analysis tools don&#8217;t pick up&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219845">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219845">
						April 13, 2014 2:08 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>The fact that any tool can be abused is no reason to refuse to use it even properly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219846">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219846">
						April 13, 2014 2:23 PM					</a>

				</p>

				<p>@ Mr. Pragma,</p>
<p>I said,</p>
<ul>The bounds check is not the problem, nor for that matter is the usage of malloc and friends, or for that matter the use of C</ul>
<p>And you reponded with,</p>
<ul><i>According to the OpenBSD guys, who damn know a thing or two about security, malloc was a problem or, more precisely, sailing blindly *was* a problem.</i></ul>
<p>It&#8217;s a shame that you did not go on to quote my paragraph that followed.</p>
<p>Just to reiterate the &#8220;problem&#8221; is the &#8220;need for a heartbeat in the first place&#8221; which resulted in a totaly &#8220;off the chart&#8221; specification for the heartbeat. One 20,000ft view of that protocol should have been raising &#8220;WTF questions&#8221;</p>
<p>Irespective of what the OpenBSD guys thought of the &#8220;custom malloc&#8221; I&#8217;ve already explained on this blog that a security leak problem would have occured with the traditional malloc and free, and that a programer with any security experiance would have been zeroing critical memory immediatly after use and most certainly befor freeing it.</p>
<p>I&#8217;ve also mentioned that the use of a secondary process to issolate KeyMat and other sensitive information has been standard practice in one way or another.</p>
<p>So I stick by what I&#8217;ve said in the two paragraphs and other postings prior to yours. And by the looks of it other people are taking a step back from pointless programing language discussions and starting to shine a light on what the OpenSSL and IETF were upto and it&#8217;s raising some interesting issues</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219847">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219847">
						April 13, 2014 2:40 PM					</a>

				</p>

				<p>@ DP,</p>
<ul><i>The fact that any tool can be abused is no reason to refuse to use it even properly.</i></ul>
<p>Whilst I agree with the sentiment it does raise an almost philisophical question as to what &#8220;properly&#8221; means.</p>
<p>For instance I can cut a mortice&amp;tennon with a mallet and chisle, but I know that carving a statue with the same tools is beyond my current abilities. Further although I have &#8220;an engineers eye and touch&#8221; I don&#8217;t have &#8220;an artists eye and touch&#8221; and don&#8217;t see/feel the &#8220;hidden grain within&#8221;. Thus whilst I would very much love the latters eye and ability, I&#8217;m aware of my &#8211;current&#8211; limitation, thus do I stick with what I can do or do I strive for better? And if I strive what happens to the substandard pieces I produce along the hopefully sucsessfull journy?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219848">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219848">
						April 13, 2014 2:49 PM					</a>

				</p>

				<p>yesme (April 13, 2014 3:06 AM)</p>
<p><i>&#8216;&#8221;D is something like C++ done the right way.&#8221;</p>
<p>&#8230; No sorry. You can&#8217;t do C++ the right way.&#8217;</i></p>
<p>Yes and no. The very concept of C++ is rotten and misguided. But D at least does it (mostly) right (mainly by not merely glueing object stuff to C) and adds some smart thoughts.</p>
<p><i>&#8220;Just think about simplicity. Until now the only &#8220;new&#8221; language that really impressed me with simplicity is Go.&#8221;</i></p>
<p>I had a good look at Go. Let me put it this way: I expect some well designed code in certain segments (important to Google) and lots of problem riddled hacks.</p>
<p><i>&#8220;The problem with modular approaches is &#8230;<br />
If you have only 1 or 2 predefined modes, with also predefined settings (AES256, SHA2, etc), not only would it simplify the protocols but also the libraries that implement these protocols&#8221;</i></p>
<p>And you would severely limit users and hamper adoption of good new algorithms.</p>
<p>The problem isn&#8217;t modules, neither as in many algorithms and modes (although one might want to clean out some) nor as in software modules.<br />
The problem (as far as software is concerned) is the utterly lousy design and implementation. Just look at the openssl code.<br />
What p<em>sses me off particularly is that it seems that some of that abomination did not &#8220;happen&#8221; or &#8220;creep in&#8221; but was actually intentional along the beloved C/C++ line of &#8220;real code *should</em> look obfucated!&#8221;</p>
<p>It&#8217;s also about time to get grown up and to see the reality. Which is: A language feature that can be abused <em>will</em> be abused.</p>
<p>L (April 13, 2014 3:26 AM)</p>
<p>You basically bring up the usual arguments like &#8220;You can do bad things with all languages.&#8221;<br />
Yes. But there are languages strongly inviting you to design and code properly and there are those, like C/C++, that invite you to spill the contents of a drunk youngster nightmare on crack into code.</p>
<p><i>&#8220;If you can find good coding guidelines then C++ is way safer than C.&#8221;</i></p>
<p>Sorry, no. Frankly, the only acceptable guideline for C/C++ is to not use it if it can be avoided. Period.</p>
<p>just wondering (April 13, 2014 5:19 AM)</p>
<p>Sorry to pick you (there are others, too).</p>
<p>Forget it! java being a language for safe code is a fairy tale.<br />
For one it repeats many errors from C/C++ (like notation). More importantly though java is a bureaucratic nightmare drawing way to much attention to its quirks and needs; programmers using java tend to design around or along javas weirdness (and it&#8217;s largely in the grip of one company). Don&#8217;t get me wrong; one can do a lot of funny proggies in java &#8211; but here we&#8217;re talking security.</p>
<p>A language should should work <em>for</em> the developer and <em>for</em> sound implementations. When it hampers you then that should be for the sake of sound programming and not because the language (or its designers) have diva allures.</p>
<p>More importantly though it&#8217;s about time to understand that code is written only once but read &#8211; and hopefully understood!- many times.</p>
<p>With C/C++ code we just experienced what happens or happens not when it&#8217;s read the fu**ing first time by the &#8220;controller&#8221;. If openssl had been written in, say, Pascal (don&#8217;t worry, I don&#8217;t like it neither), chances are that that error had been spotted at the sign off.</p>
<p>Now multiply that (problem) by a big number of your choice and you have the situation 6 months or 3 years later when another person reads that code and is supposed ti fix a bug, preferably without creating 3 more.</p>
<p>Dlang (April 13, 2014 6:40 AM)</p>
<p>Yes, quite probably the algorithms (rather than the implementation only) should be audited, too. Preferably incl. people like Schneier and Bernstein who supposedly didn&#8217;t sell out to governments.</p>
<p>But there&#8217;s still the question of proper implementation and, linked to that, the question of language.</p>
<p>Nick P (April 13, 2014 11:00 AM)</p>
<p><i>&#8220;Either the language or the culture need to be designed to minimize hacks.&#8221;</i></p>
<p>Good to see someone who is plus/minus looking in the right direction.</p>
<p>Actually I&#8217;m convinced that those two, language and culture, are quite closely related.</p>
<p>&#8220;It&#8217;s fun&#8221; is a statement frequently heard in C (and somewhat less C++) circles. They even put it on slides. Fun seems to be <em>the</em> motivation. I don&#8217;t think that&#8217;s happenstance.</p>
<p>Let&#8217;s look closer at your statement:</p>
<ul>
<li>static typing and casting being frowned upon unless absolutely necessary &#8211; Good thing to have. It makes developers put more weight on proper design rather than hacking away.<br />
Formal verifyability is a major plus.</li>
<li>readability &#8211; possibly <em>the</em> indicator for grown up professionals. College boys just hack away; there&#8217;s no tomorrow. Professionals know, accept, value, and prepare for code being well readable.</li>
<li>modularity &#8211; having real modularity (not the header files plague) and mechanism for proper interface design supports reusability and maintainability and at the same time offers a mechanism to painlessly include new algorithms/protocols.</li>
</ul>
<p>C/C++ is not that. And java might somewhat sound like it but is more of a tricky promise than a solution.</p>
<p>There&#8217;s more but I think one can already see a line</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219849">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219849">
						April 13, 2014 3:03 PM					</a>

				</p>

				<p>Clive Robinson (April 13, 2014 2:23 PM)</p>
<p>I think you took my statement harsher than it was meant. I merely opposed the &#8220;malloc wasn&#8217;t a problem neither&#8221; part.</p>
<p>Also kindly note that, while I do concentrate on the language issue, I <em>did</em> state (in reply to someone here) that the protocol design/standards bodies and other issues are problematic, too. To elaborate on that, however, I leave to others more knowledgable in that area than I am. I prefer to stick to issues I know something about.</p>
<p>As for the static analyzers I widely concur with you. I also see the danger of (particularly) youngsters, the &#8220;it&#8217;s fun!&#8221; hackers to let go what little safety consideration they might have because, oh well, there are cool tools to take care of it.</p>
<p>On the other hand I&#8217;ve painfully learned to become a fan of testing, be it unit testing, be it SAs or be it other forms. In particular, I feel that we need better formal verification for critical areas.</p>
<p>Sorry to bother you but I&#8217;m afraid all this touches the language issue, too. There is a reason for e.g. Ada being quite well verifyable but C being not (and, in fact, even hard to parse).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219850">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219850">
						April 13, 2014 3:52 PM					</a>

				</p>

				<p>Begging your pardon if already posted&#8230;</p>
<p>Private keys stolen within hours from heartbleed openssl site</p>
<p><a href="http://it.slashdot.org/story/14/04/13/1553258/private-keys-stolen-within-hours-from-heartbleed-openssl-site" rel="nofollow ugc">http://it.slashdot.org/story/14/04/13/1553258/private-keys-stolen-within-hours-from-heartbleed-openssl-site</a></p>
<p>There will have to be a flood of certificate changes and password changes, I expect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219851">

			<div class="comment by-somebody ">

				<p class="commentcredit">

					<span class="commenter">Somebody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219851">
						April 13, 2014 4:10 PM					</a>

				</p>

				<p>@Clive Robinson: Likewise Turing&#8217;s halting problem should tell you why any kind of &#8220;code analysis&#8221; system will always fail to catch the more interesting bugs.</p>
<p>This is a misuse of the halting problem.  The halting problem says you can&#8217;t divide programs into two classes: Those that can be proved to halt and those that can be proved not to halt.</p>
<p>But you can divide programs into the two classes: Those that have been proved to halt and those that have not been proved to halt.</p>
<p>If you need your program to halt you need to accept only programs that can be proven to halt, not reject programs that can be proven not to halt.  Sure you&#8217;ll reject some programs that halt, but so what?</p>
<p>In the context of code reviews, code that is hard to read is easy to review: you reject it and tell the author to do better next time.  Unfortunately in most cases code reviews (and static analysis) are used to find bad code, rather to find good code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219852">

			<div class="comment by-skeptical ">

				<p class="commentcredit">

					<span class="commenter">Skeptical</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219852">
						April 13, 2014 4:22 PM					</a>

				</p>

				<p>Let me ask a very uninformed technical question that is likely only to show my ignorance.</p>
<p>Would it not be an easier solution to craft prevention of such errors, and protection of information designated by a process as requiring extra protection against unintentional access, into the operating system? I&#8217;m told that C++ is a highly popular language with a huge number of useful libraries, and so it seems unlikely that it would be dropped.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219853">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219853">
						April 13, 2014 4:44 PM					</a>

				</p>

				<p>Alright&#8230;.  all you nay-sayers who say, &#8220;oh, but we can&#8217;t do X security measure [even though that would be a big improvement], because it doesn&#8217;t solve Y and Z [which also need to be solved, but are unrelated]&#8230;&#8221;  fuck off and stop trying to derail improvements, you NSA tool!</p>
<p>No one tool solves everything, obviously, but every tool is useful for what it&#8217;s intended/designed to be used for.  So&#8230; USE THEM ALREADY&#8230;.  Use all of them&#8230;  If you&#8217;re unable to use every tool today, use what you can today, and pick up and learn one more tomorrow.  And another the day after.  This is not something that will be solved overnight, it&#8217;s a process.  Start going down this road.  It takes effort, put it in.</p>
<p>Use code analysis tools to improve and verify code quality.</p>
<p>Use improved languages that enforce better security models.</p>
<p>Invent new hardware designs and software methodologies that improve security too.</p>
<p>Write tests, aim for 100% code path coverage in your tests, try to test edge cases.</p>
<p>Use good old fashioned self discipline to think about what&#8217;s readable and what&#8217;s not, what&#8217;s more safe and what&#8217;s less.</p>
<p>Never stop refactoring and improving things.</p>
<p>Never stop pestering your politicians either.</p>
<p>Never stop educating the public either.</p>
<p>Once you&#8217;ve finished all these goals, make new ones.  Set the bar higher yet again.  Keep doing this&#8230; forever! don&#8217;t stop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219854">

			<div class="comment by-national-insecurity ">

				<p class="commentcredit">

					<span class="commenter">National Insecurity</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219854">
						April 13, 2014 4:52 PM					</a>

				</p>

				<p>Arguing language is exactly the kind of distraction the 5 eyes alliance wants. If we focus on how awful OpenSSL is we won&#8217;t notice the Explicit Trusted Proxy nonsense in HTTP/2.0</p>
<p>&#8220;Users should also be made aware that the proxy has visibility to the actual content they exchange with Web servers, including personal and sensitive information.&#8221;</p>
<p><a href="http://tools.ietf.org/html/draft-loreto-httpbis-trusted-proxy20-01#section-7" rel="nofollow ugc">http://tools.ietf.org/html/draft-loreto-httpbis-trusted-proxy20-01#section-7</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219855">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219855">
						April 13, 2014 4:55 PM					</a>

				</p>

				<p>Skeptical (April 13, 2014 4:22 PM)</p>
<p>The problem is a little more complex.</p>
<p>For one, putting security into the OS doesn&#8217;t have nice sides only. It also, for instance, brings complexity with it (for the user, too).<br />
Furthermore, in the end every language is translated into executable code and there is only so much an OS can put up against that.</p>
<p>Probably more importantly, you can divide attacks (very roughly) into two quite different groups:</p>
<ul>
<li>&#8220;hackers&#8221; i.e. people who attack systems with malice intent and for a (usually money-related) purpose.<br />
Those typically act &#8220;commercially reasonable&#8221; that is, they create tools which address a very large part of the systems out there (windows, routers, &#8230;).</li>
<li>states/governments which usually can gain control of systems, networks, etc. in more than one way and they are usually very well funded.</li>
</ul>
<p>&#8220;Protecting against attacks&#8221; therefore must address very different situations and scenarios. The Heartbleed problem is particularly bad because it kind of connects the scenarios.</p>
<p>When protecting from governments one must assume that some agents have physical access to the system (or network or &#8230;) and such can circumvent most standard security measures.</p>
<p>This is in part what cryptography is about. An example would be that agents have physically taken away a server but, provided good protection, can not get confidential information.</p>
<p>Now openssl is &#8220;everybodys crypto-protection&#8221;.</p>
<p>In order to achieve a better situation the whole chain must be verified and implemented properly.</p>
<p>As someone here correctly stated that would begin by looking closely at committees and standards bodies as well as the standards and protocols themselves and, last but not least, proper implementation as well as trustworthy OSs.</p>
<p>Unfortunately one of your remarks is sadly correct. Rather than adequate point the actually applied criteria usually boil down to convenience, what&#8217;s wide spread, what everyone does/uses, and even questions of comfort.</p>
<p>At the same time those trying to create better alternatives have a hard time because usually they don&#8217;t have gazillion budgets and open or covert control of relevant bodies. Even worse, it&#8217;s hard to verify that alternatives aren&#8217;t tainted in the first place.</p>
<p>In that situation one can either give up (or &#8220;trust the system&#8221; which is just another form of giving up) or start modestly. Small &#8211; and by no means sufficient &#8211; starting points could be to carefully choose algorithms, to choose a good (albeit that&#8217;s relative) OS, to configure that OS properly, and to choose a language that supports safe programming rather than favouring unsound hacking.</p>
<p>Unfortunately that whole matter is so complex that even experts in one area make sad mistakes in another, e.g. an excellent cryptographer and generally bright mind like Bernstein coding in C and Go.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219856">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219856">
						April 13, 2014 5:17 PM					</a>

				</p>

				<p>National Insecurity<br />
&#8211;People are trying to be practical and solve problems that they themselves can solve.  It&#8217;s been stated many times that standards/protocols suck (no other word); but who&#8217;s ready to take on that responsibility here?  Likewise fabbing hardware where you don&#8217;t have hidden radios or malicious circuits that allow code to physically attack and destroy parts of your machine (or just overwrite a HDD).  It&#8217;s a helpless feeling when you can&#8217;t alter a chip w/o destroying it.</p>
<p>Are we ready to radically alter standards/protocols?  Who&#8217;s going to step up and take the reins and start kicking the current people out? (And not be another shill/sellout).  Big questions; and it needs to be an older person (and not a politician, someone w/ real knowledge) w/ experience, not some rookie.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219857">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219857">
						April 13, 2014 5:47 PM					</a>

				</p>

				<p>@ Mr. Pragma</p>
<p>So your hypothesis is that they&#8217;re going for languages that give them plenty of freedom to hack away. I think this might help instead of hurt in that plenty of languages have this feature and are safer. Most are scripting languages, although LISP comes to mind.</p>
<p>The trick with them is that they are value typed instead of type declared. You can quickly crank out code with runtime figuring out types. Additionally, they make it easy to get strings and control flow right without programmer headaches.</p>
<p>So, the best route might be to design a systems language (or enhance existing one) with same principles. Make it fun and easy to code in, with type controls optional on per module or function basis. And constructs good enough for real work. My Ada+LISP project intends to do that if I get it going: prototyping and ultra-productive coding in a LISP subset, autogeneration of Ada/SPARK for static checking and/or final release. I&#8217;d probably recommend Python + Java/c#/Go for others as more popular.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219858">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219858">
						April 13, 2014 5:49 PM					</a>

				</p>

				<p>Actually just came across an article: &#8220;Why I quit writing internet standards&#8221;</p>
<p><a href="http://gigaom.com/2014/04/12/why-i-quit-writing-internet-standards/" rel="nofollow ugc">http://gigaom.com/2014/04/12/why-i-quit-writing-internet-standards/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219859">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219859">
						April 13, 2014 6:27 PM					</a>

				</p>

				<p>Nick P (April 13, 2014 5:47 PM)</p>
<p><i>&#8220;So your hypothesis is that they&#8217;re going for languages that give them plenty of freedom to hack away.&#8221;</i></p>
<p>Yes. Mainly because of lazyness. &#8220;My friend develops in C/C++/java, too&#8221;, &#8220;That&#8217;s what I&#8217;m used to&#8221;, etc.</p>
<p>I&#8217;m getting increasingly suspicious, however, of government entities having a pro-active desire in C/C++/java.</p>
<p>After all, they want to introduce weaknesses, yet have plausible deniability and very low risk of their manipulations being discovered.</p>
<p>Playing Poul (HK) for a moment &#8230; if I were at nsa I would have my team find out expressly the kind of error that coverity and other often used analyzers do <em>not</em> find. Sure enough in C/C++ the outcome would be satisfying. And it provide a strong hint how we (nsa, &#8230;) can get our poison into OS, cryptography, etc.</p>
<p>As for your plans with Ada and Spark I am obviously looking happy. As far as prototyping and a scripting language is concerned I&#8217;m not so sure. O.K. for a quick prototype Python or Lisp might be fine but then, why not use a typed scripting language right away? What&#8217;s so inacceptable or difficult in specifying types? After all data is a vital part of prototyping in crypto.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219860">

			<div class="comment by-george-h-h-mitchell ">

				<p class="commentcredit">

					<span class="commenter">George H.H. Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219860">
						April 13, 2014 6:46 PM					</a>

				</p>

				<p>You describe the NSA&#8217;s recent statement as &#8220;word-game free.&#8221;  Close, but not quite:</p>
<blockquote><p>NSA was not aware of the recently identified vulnerability in OpenSSL, the so-called Heartbleed vulnerability, until it was made public in a private sector cybersecurity report.</p></blockquote>
<p><b>Which</b> &#8220;private sector cybersecurity report&#8221;?  Do we really know when the earliest one was?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219861">

			<div class="comment by-skeptical ">

				<p class="commentcredit">

					<span class="commenter">Skeptical</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219861">
						April 13, 2014 7:18 PM					</a>

				</p>

				<p>Hmmm&#8230; I appreciate the reply, Pragma. And I see what you&#8217;re saying.</p>
<p>I tend to look at this from an accident causation vantage (and with enormous technical ignorance of programming).</p>
<p>My underlying intuition is that one of the enabling factors here is the fact that a procedure that is not being written with the purpose of handling especially sensitive information can nonetheless access that information.</p>
<p>Given a large number of lines of code, I would expect some procedures to be written less carefully, and with less attention, than others. This is especially the case given the lack of regulation and control over a programmer&#8217;s environment. Someone can program with little sleep, late at night, with divided attention, i.e. under all conditions that favor human error.</p>
<p>Since programmers are human beings, they will bring varying amounts of attention and care to the writing of different procedures.</p>
<p>Moreover, different procedures will attract different levels of care and attention when being checked.</p>
<p>Procedures that are written with the purpose of handling and manipulating especially sensitive information will likely trigger more attention and care than other procedures.</p>
<p>While there is much that can be done to maximize the percentage of errors caught, and minimize the number of errors written, it seems prudent to enable a programmer to limit how certain information may be accessed.</p>
<p>In other words, a programmer should be able to make it hard to access certain information, easily. And this will in turn make unintentional capability to access certain information harder to achieve when writing procedures that need not access that information.</p>
<p>Is this not a feature enforceable (and surely already enabled) by operating systems, which can apply regardless of how an executable file was created? It seemed so obvious that I hesitated to even ask the question.</p>
<p>One additional technical question:</p>
<p>When code is reviewed in this type of production, is there commonly a checklist which indicates what was checked and was not checked? I don&#8217;t expect that any such checklist would be comprehensive, but any checklist that hit some important notes would reduce error and increase accountability.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219862">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219862">
						April 13, 2014 7:54 PM					</a>

				</p>

				<p>Skeptical (April 13, 2014 7:18 PM)</p>
<p><i>&#8220;When code is reviewed in this type of production, is there commonly a checklist which indicates what was checked and was not checked? I don&#8217;t expect that any such checklist would be comprehensive, but any checklist that hit some important notes would reduce error and increase accountability.&#8221;</i></p>
<p>Oh well, that&#8217;s a wild animal. It ranges from &#8220;Huh? Nope&#8221; to paranoid anal obsession; the latter quite rare, the former shockingly widespread.</p>
<p>In the vast majority of cases the only measure is &#8220;The compiler groked it and it seems to work, so it&#8217;s OK&#8221; (Note: A compiler is (somewhat simplified) a program that takes source code (the stuff written by programmers) and transforms it into something executable (stuff that runs, vulgo &#8220;program&#8221;)</p>
<p>There are many methods and tools out there to manage to test code, basically non of them capable of finding all errors and most of them able to find more or less common and/or obvious bugs (&#8220;errors&#8221;).</p>
<p>As a rule of thumb those tools are almost never used for prevention but rather for cure (&#8220;We leak memory&#8221; or &#8220;Around 0:00 our code crashes&#8221; so we must find the bug).</p>
<p>And then there is a plethora of code management tools that have basically two capabilities: a) they allow you to manage code (changes, docs, versions, etc.) and b) them being employed tends to slightly push benevolent developers to generally code somewhat more responsibly.</p>
<p>In the end, you got that right, it depends on the single human for the largest part. As a trend one might say that responsible developers (like Prof. Bernstein) act as grown up engineers with a somewhat anal attitude towards correctness and quality (which is a <em>good</em> thing) while particularly younger developer tend to be more on the hacking side.<br />
In the end, good developers will produce good code even with poor tools while hackers will find a way around whatever discipline is put in front of them. If it&#8217;s about the 4.321st PHP template engine one couldn&#8217;t care less, if, however, it&#8217;s about openssl it quickly turns into a nightmare.</p>
<p>Unfortunately that whole thing gets even more complicated when considering the human factor (which is rarely done but decisive). For instance, while software development is clearly engineering there are also aspects of art and many very human aspects like &#8220;being in the flow&#8221; (of coding).<br />
Most companies (if they care at all) tend to dictate an assortment of tools (source management, style guidelines and checkers, analyzers, etc) but to a degree that&#8217;s akin to handing out expensive weapons to the guys you happen to have; a few great developer will &#8220;fly&#8221; and produce excellent code, a few bad apples will fight against the &#8220;restraint&#8221; and the majority will be the same rather average shooters they were before albeit with an expensive weapon.</p>
<p>Very pragmatically speaking C is the most used language (in the wild) for basically 2 reasons: It feels cool and pretty everyone uses it (which also means there are loads of libraries and tools), the latter carrying far more sociological weight that one would like to think (hint: what do you think is by far the most prevalent motivation to produce open source code?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219863">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219863">
						April 13, 2014 8:03 PM					</a>

				</p>

				<p>@Nick P,</p>
<p>I looked at Capability based Opertaing Systems a few years ago. They had their problems as well because of the need to envolve a human element. As for HW, if you think of a capability as a token or a crypto-proof an entity presents to gain access to an API or a privileged system call, then HW has to be supportive in enforcing the control.  I agree with your take on &#8220;E&#8221;. Which is cheaper&#8230; Hmm&#8230; The simplest system that delivers the designed functionality, I guess 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219864">

			<div class="comment by-made-maid-made ">

				<p class="commentcredit">

					<span class="commenter">made maid made</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219864">
						April 13, 2014 9:02 PM					</a>

				</p>

				<p>Since Tor is being mentioned here, the current version of Tails is safe:</p>
<p><i>&#8220;If you&#8217;re using an older OpenSSL version, you&#8217;re safe.&#8221;</i></p>
<p>openssl version: 0.9.8o-4squeeze14</p>
<p><a href="https://blog.torproject.org/blog/openssl-bug-cve-2014-0160" rel="nofollow ugc">https://blog.torproject.org/blog/openssl-bug-cve-2014-0160</a></p>
<p>For those using TBB, consider switching to Tails:</p>
<p><a href="https://tails.boum.org/" rel="nofollow ugc">https://tails.boum.org/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219865">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219865">
						April 13, 2014 9:43 PM					</a>

				</p>

				<p>@ made maid made</p>
<p><i>&#8220;Since Tor is being mentioned here, the current version of Tails is safe&#8230;&#8221;</i></p>
<p>At least until the next news item.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219866">

			<div class="comment by-yesme ">

				<p class="commentcredit">

					<span class="commenter">yesme</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219866">
						April 13, 2014 9:47 PM					</a>

				</p>

				<p>@ Figureitout • April 13, 2014 5:49 PM</p>
<p><i>Actually just came across an article: &#8220;Why I quit writing internet standards&#8221;</i></p>
<p>I only have one word: IPSec.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219867">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219867">
						April 13, 2014 9:51 PM					</a>

				</p>

				<p>@ Mr Pragma</p>
<p>&#8220;I&#8217;m getting increasingly suspicious, however, of government entities having a pro-active desire in C/C++/java.</p>
<p>After all, they want to introduce weaknesses, yet have plausible deniability and very low risk of their manipulations being discovered.</p>
<p>Playing Poul (HK) for a moment &#8230; if I were at nsa I would have my team find out expressly the kind of error that coverity and other often used analyzers do <em>not</em> find. Sure enough in C/C++ the outcome would be satisfying. And it provide a strong hint how we (nsa, &#8230;) can get our poison into OS, cryptography, etc.&#8221;</p>
<p>All quite possible and all the more reason to avoid such languages as much as possible.</p>
<p>&#8220;O.K. for a quick prototype Python or Lisp might be fine but then, why not use a typed scripting language right away? What&#8217;s so inacceptable or difficult in specifying types? After all data is a vital part of prototyping in crypto.&#8221;</p>
<p>Python and LISP are strongly typed, though, and that&#8217;s the trick to them. They use the value to determine the type. LISP is more permissive as it&#8217;s designed for ultra-flexible use. Yet, the popular scripting languages are all quite type and memory safe. The problem is they have complex runtimes, no safe ways of manual memory management, and a performance hit. So, my language proposal was one that&#8217;s more like our systems programming languages but with compiler handling as much as possible. Then, compiler hints, types, unsafe modules, etc can be used to further improve performance where necessary.</p>
<p>Far as my LISP to Ada thing goes, the idea for it is to leverage LISP&#8217;s exploratory programming ability. In it, you can throw apps together a function at a time and even compile a single function. There&#8217;s always a live instance running in the background. So, testing is as easy as calling the function through REPL. So, I can write a bunch of code, test it, refactor it, etc without pausing for a compiler. This maintains my mental flow. When I&#8217;m ready, I can issue a command to translate it to Ada and run it through its rigorous compiler. I used to do this with BASIC and C++ to great effect. I also get real macro&#8217;s in LISP, which have so many nice uses I couldn&#8217;t begin.</p>
<p>Thing is, neither Ada nor LISP have had much takeup so I was just naming off other propular languages with similar properties that might get takeup. Python, particularly, has been written in itself and also extended for high performance code (Cython). LISP&#8217;s are still faster and more powerful, though, along with being an abstract syntax tree that&#8217;s easy to parse. Good for certified compilation, as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219868">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219868">
						April 13, 2014 11:37 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>You forgot to mention the &#8220;P&#8221; word much beloved by managment 😉</p>
<p>Over the years it&#8217;s become accepted that &#8220;low level&#8221; languages are &#8220;less productive&#8221; than high level ones.</p>
<p>On *nix the tradition was &#8220;Prototype with sh Production with C&#8221; with LISP hiding very productivly in Emacs&#8230;</p>
<p>And back in the &#8220;CLI only&#8221; days hardware resources issues made &#8220;Production with C&#8221; sensible whilst the better than RAD &#8220;Prototype with sh&#8221; (or equiv) still holds true.</p>
<p>Then there is also the &#8220;CLI only&#8221; days *nix &#8220;3 layer&#8221; rule also made sense (and still does with most humans).</p>
<p>Since the old CLI days graphical interfaces shook things up for a while but in most cases the &#8220;3 layer&#8221; rule can still be seen though it tends to be horizontal these days with browser UI&#8217;s talking to middle ware that talks to very non graphical back ends (with 3layers in each ;-).</p>
<p>Whilst human abilities (contrary to what some claim) have not changed hardware resources realy are not a constraint on most programmers any longer, and in fact it&#8217;s increasingly the OS becoming the &#8220;bottle neck&#8221;.</p>
<p>Thus as I&#8217;ve said befor why not have general application programers work with very high level safe/secure scripting leaving the development of the scripting apps/widgets they need to those who can programe safely/securely in low level languages such as asm/C.</p>
<p>Thus LISP or more preferably something &#8220;higher&#8221; should be that &#8220;application&#8221; developers tool of choice with it&#8217;s &#8220;P word&#8221; benifits that managment crave, with low level C/asm being the languages of necessity for those who develop the system/OS and high level languages.</p>
<p>The reality we currently have is we &#8220;fudge&#8221; the issue we use low level languages to fake high level scripting by the use of C/C++ and masive labarynthine libs of often questionable code with incomprehensable interfaces usualy arived at by commity with all it&#8217;s vested interest failings. Applications programers then want to &#8220;build it all&#8221; often giving seven or more layers, that even they can not realy &#8220;see in their minds&#8221;, and we &#8220;act surprised&#8221; when systems built this way fail to give either safety or security&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219869">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219869">
						April 14, 2014 12:18 AM					</a>

				</p>

				<p>Nick P.</p>
<p>I know what you mean, type deduction. Seeing &#8220;myvar := 5&#8221; the compiler is supposed to deduct that obviously(?) you want an integer.</p>
<p>Again, we&#8217;re discussing security related or critical software.</p>
<p>And there is a golden rule, from which I&#8217;m not willing to deviate a single millimeter. Tell what you want and tell it as precisely and unmistakably as any possible. Period.<br />
Not at last for formal verification purposes.</p>
<p>As for GUI stuff, PHP templates or the like, I don&#8217;t care batshit. If anyone feels it&#8217;s a great idea to develop using in PHP on net or whatever, great (I won&#8217;t use his sh*t anyway).</p>
<p>If it&#8217;s about prototyping some algorithm, yeah, maybe that could be done in Python, Lisp, Basic, whatever. Although, frankly, I fail to see the beauty of it. Why not prototype my algorithm with fully specified data right away? After all more often than not data <em>are</em> relevant. And I can still cut corners for a quick shot, for instance, by not cutting my types down to a certain range, by ignoring housekeeping, logging, and all the usual stuff. But that is me and my opinion, your&#8217;s may vary and as long as the final code is on Modula, Oberon, Ada or similar I see no major problem.</p>
<p>I&#8217;m still somewhat haunted by the wake up call re. standards bodies and that whole shebang.</p>
<p>I&#8217;m not done thinking (are we ever) but right now my pov. is sth. like this:<br />
Let&#8217;s assume that a miracle happens and tomorrow morning we get proper standards and algorithms that are properly designed, properly verified, etc.</p>
<p>Then what? Then we adapt openssl? Ridiculous! If we tried we&#8217;d quite certainly introduce a sh*tload of new bugs and problems using C/C++ or, yuck, java.<br />
When Bernsteins Salsa got introduced into the crypto libs, thank God, they quite probably just stole his reference implementation and introduced new bugs &#8220;only&#8221; in the library wrappings &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219870">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219870">
						April 14, 2014 12:28 AM					</a>

				</p>

				<p>@ Skeptical,</p>
<p>There is a dirty little secret when it comes to &#8220;code review&#8221; and it&#8217;s that it&#8217;s neither &#8220;sexy&#8221; nor &#8220;productive&#8221; and you are always on the wrong end of the stick as the reviewer.</p>
<p>That is managment don&#8217;t want &#8220;their brightest and best&#8221; code cutters being unproductive doing code review and most code cutters have the view that code review is not good for the mojo etc, and view code reviewers as a hinderance at best.</p>
<p>Which has caused and in some places still causes a strange work dynamic. Managment generaly want code out the door on day X which is frequently way sooner than it should be. So code cutters are under preasure to deliver code, that &#8220;sort of works&#8221; (with patches to follow). The unfortunate code reviewers get this pile of &#8220;regurgitated dog food&#8221; to wade through as late as the code cutter can get away with, and thus you can be assured that the reviewers are &#8220;not going to smell of roses at the end of the day&#8221; and if they try to clean the mess up the code cutter just vomits up worse and managment start jumping up and down about scheaduls, often on the reviewers head.</p>
<p>More enlightend practitioners have seen why this might not be effective and thus have developed various &#8220;work flows&#8221; to reduce or supposadly stop such problems. In essence they revolve around what might be thought of as a &#8220;buddy system&#8221; where a small team of programers work together and review each others code as they cut code&#8230; Yup it develops other strange work dynamicssome even more pathalogical than the older process it&#8217;s trying to replace. If you want to know more look up the aptly named &#8220;Scrum&#8221; Software Development model on Wikipedia [1] and as you read keep asking yourself &#8220;how can this go pear shaped&#8221; or &#8220;how would personality type XXX on the team effect this&#8221;, then ask yourself about &#8220;groupthink&#8221; and external conflict issues and how that could become pathalogical (remember programers generaly don&#8217;t believe that &#8220;the customer is right&#8221; nor do Marketing or often managment in larger organisations).</p>
<p>[1] <a href="http://en.m.wikipedia.org/wiki/Scrum_(software_development)" rel="nofollow ugc">http://en.m.wikipedia.org/wiki/Scrum_(software_development)</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219871">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219871">
						April 14, 2014 4:02 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>When it comes to code review, I think people can easily get into the habit of skimming and not paying close attention for many of the reasons you mentioned. Pair Programming is a good way to solve this, as you have one person reviewing every single line as it is typed. On top of this, you have two people discussing the best way to approach the problem. This doesn&#8217;t really work for independent developers, however.</p>
<p>Personally, I think automated unit testing is probably one of the best tools available for finding and preventing bugs. There are two main questions I think you should ask when writing unit tests: &#8220;What should I expect when this code is correct, and (more relevant to the point) &#8220;Are there any invalid inputs?&#8221; In test-driven development, you write your interface and tests first, verify that your tests fail, and then write your code to make them successful. In an ideal world, your tests will cover all of the specs, and code will do only what is necessary to pass the tests.</p>
<p>After you have completed writing unit tests and code, I think it&#8217;s prudent to run the tests while walking through the code in a debugger, making sure every possible code path is covered by the tests, and step through each line while asking the two questions mentioned above, making sure the unit tests are adequate. I think this is what the code reviewer should be doing (the programmer should do it at least once, and the reviewer should do it at least once).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219872">

			<div class="comment by-skeptical ">

				<p class="commentcredit">

					<span class="commenter">Skeptical</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219872">
						April 14, 2014 4:37 AM					</a>

				</p>

				<p>Thanks Clive &amp; Pragma for the excellent and helpful replies</p>
<p>Let me ask another question:</p>
<p>Is there a set of &#8220;best practices&#8221; guidelines governing the engineering and testing of software that will handle sensitive information?</p>
<p>If there is, then is there a body that will certify a product if the engineers have followed best practices, and that will refuse to certify a product if the engineers have not?</p>
<p>Part of the problem seems to be lack of easy transparency concerning how a given item of software was created. If it were widely known that a given instance of Self_Described_Ultra_Secure_Software did not follow a set of best practices in design, creation, and testing, many would be disinclined to adopt it.</p>
<p>Personally, I&#8217;d like to know more than &#8220;x number of people reviewed the code and decided it was ok, and person y wrote the code, and this program is used by z number of people.&#8221;</p>
<p>I&#8217;d like to know if data in the software is appropriately segregated and impossible-to-unintentionally-escape limits are placed by default, easily, in a hard-to-f<strong><em>-up-and-if-you-do-it&#8217;s-a-screamingly-loud-f</em></strong>-up fashion, on segments of code that do not need to access sensitive data.</p>
<p>I&#8217;d like to know that a review process requires checklists for checking known types of vulnerabilities, and that these checklists are submitted when an individual completes a review of proposed code.</p>
<p>I&#8217;d like to know that the entire set of best practices, which I lack any expertise whatsoever to enumerate, has been followed in the production of a given program.</p>
<p>And I&#8217;d like to know all these things simply by checking to see whether a program has received certification from an organization.</p>
<p>The certification need not be expensive to obtain, and for open source could involve simply documenting the adherence to best practices as one goes along (e.g. checklists submitted as part of a code commit).</p>
<p>It would be a big step forward from &#8220;it&#8217;s open source and everyone uses it, so it&#8217;s probably okay.&#8221;</p>
<p>One other quick point and then I&#8217;ll stop interrupting the thread.</p>
<p>Again emphasizing my technical ignorance as a disclaimer, it is <i>astounding</i> to me that sensitive information can easily be accessible, unintentionally, from procedures that need not touch such information. To me this is like designing an aircraft in which the programmable coffee-machine can access the data used by the flight computer. Personally, I don&#8217;t just want the coffee-machine programmers to be really safe in their programming; I want the coffee-machine isolated from the flight computer data so that if an enterprising programmer finds a hack that gets us coffee 5 seconds faster, I don&#8217;t even have to consider whether this could impact pilot performance beyond the availability of a hot beverage.</p>
<p>Is there a deep, sound reason for the lack of such separation that I&#8217;m missing in my technical ignorance?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219873">

			<div class="comment by-derek-p-moore ">

				<p class="commentcredit">

					<span class="commenter">Derek P. Moore</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219873">
						April 14, 2014 9:14 AM					</a>

				</p>

				<p>Bruce,</p>
<p>There remains a known-plaintext attack vector in the &#8220;fixed&#8221; Heartbeat code, as I found when I decided to engage in a code review of the matter on Friday.</p>
<p>The Heartbeat doubles as an echo service. The length field of the echo payload can always be determined; as implemented, OpenSSL always utilizes the minimum random padding of 16 bytes. That&#8217;s 1 byte for message type, 2 bytes for length of payload, plus 16 bytes for random padding equals 19 bytes, subtracting 19 from the length of the ciphertext in an intercepted Heartbeat packet gives you the legnth of the payload. Knowing the length of the payload gives you knowledge of what region of the ciphertext commits the cardinal cryptologic sin of encrypting the same message twice with the same key.</p>
<p>If interception is occurring in both directions, 3 of 19 bytes are known (message type &amp; length prefix). If interception is only in one direction, 2 of 19 bytes are known. What is also known by this information is the twice-encrypted echo message.</p>
<p>Heartbeat RFC should be revoked at best, or implementations should always use a randomized length of random padding at worst, even when not engaging in Path MTU Discovery.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219874">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219874">
						April 14, 2014 9:29 AM					</a>

				</p>

				<p>@ Mr. Pragma</p>
<p>Funny thing is INFOSEC community has even compromised with them by giving them safe[r] <a href="http://en.wikipedia.org/wiki/Cyclone_(programming_language)" rel="nofollow ugc">C</a> and <a href="http://www.cs.cornell.edu/talc/" rel="nofollow ugc">typed assembly</a> (check that out). They can keep it pretty low level, make porting easier, and avoid many of most dangerous errors. Most won&#8217;t even do <em>that</em> when I tell them about such tools. Both closed and open source INFOSEC development are very broken, with few exceptions.</p>
<p>@ Clive</p>
<p>&#8220;Over the years it&#8217;s become accepted that &#8220;low level&#8221; languages are &#8220;less productive&#8221; than high level ones.&#8221;</p>
<p>There&#8217;s been empirical evidence of this. The results showed more about the specific features of languages rather than how low or high level they were. Anything that save&#8217;s programmer thinking, typing or testing time is A Good Thing so long as it doesn&#8217;t cause other problems.</p>
<p>&#8220;Since the old CLI days graphical interfaces shook things up for a while but in most cases the &#8220;3 layer&#8221; rule can still be seen though it tends to be horizontal these days with browser UI&#8217;s talking to middle ware that talks to very non graphical back ends (with 3layers in each ;-).&#8221;</p>
<p>You forgot the 4GL&#8217;s and CASE tools that dominated between CLI and GUI, while popping up from time to time. They were used to great effect in the past with its ugly 3GL&#8217;s. Their creators even assured us they would replace all 3GL&#8217;s in &#8220;the near future&#8221; and eliminate 90+% of all coding. Boy, am I glad they did that. 😉</p>
<p>&#8220;Thus as I&#8217;ve said befor why not have general application programers work with very high level safe/secure scripting leaving the development of the scripting apps/widgets they need to those who can programe safely/securely in low level languages such as asm/C.&#8221;</p>
<p>It makes sense. It&#8217;s <em>sort of</em> what happened in Java world. The end result has been a mess so the idea needs to be refined a bit.</p>
<p>&#8220;with low level C/asm being the languages of necessity for those who develop the system/OS and high level languages.&#8221;</p>
<p>I don&#8217;t think that&#8217;s even necessary. So many projects, not to mention 1960&#8217;s technology, showed higher level languages can program OS&#8217;s. There has to be unsafe code in it, for sure. However, a few projects have shown it&#8217;s only the tiniest bit right where memory, CPU state, and I/O resources are handled. That bit can be wrapped behind typed interfaces where the rest of the code experiences <em>some</em> safety benefit. C and asm largely don&#8217;t have that so I recommend these better programmers you mention avoid them as much as possible for low level development.</p>
<p>I see something along these lines: app programming languages -&gt; a language like Ada or Wirth&#8217;s -&gt; typed assembler -&gt; assembler. Remember that C enforces a certain structure that&#8217;s incompatible with some languages, even causing vulnerabilities in safe ones (eg Ada + C). Might as well take a safe systems language down to the bare metal by disabling safety features in just that module &amp; using inline typed/untyped assembler for most primitive/performing stuff. That&#8217;s my model, anyway. The first part of this is typical in Ada development. The second is my addition based on progress in type systems and verification for assembly languages.</p>
<p>&#8220;The reality we currently have is we &#8220;fudge&#8221; the issue we use low level languages to fake high level scripting by the use of C/C++ and masive labarynthine libs of often questionable code with incomprehensable interfaces usualy arived at by commity with all it&#8217;s vested interest failings. &#8221;</p>
<p>And that&#8217;s the rest of the world&#8217;s model. 🙁</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219875">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219875">
						April 14, 2014 11:40 AM					</a>

				</p>

				<p>@ Skeptical,</p>
<p>First a word of caution about &#8220;best practice&#8221; very often they are nothing more than &#8220;myths and juju&#8221; you would find in &#8220;Cargo cults&#8221;, the fact that lawers band them about in civil cases makes them even less reputable&#8230; so beware.</p>
<p>You should always look for the science behind them, failing that the mathmatics and in either case check both the axioms and measurands behind them. Often with &#8220;best practice&#8221; they are missing / wrong / inappropriate / untested or some combination there of.</p>
<p>As an example an institute produced an anual &#8220;best practice&#8221; &#8220;Top Ten&#8221; recomendations. It was at one time a self selected list of organisations who &#8220;claimed&#8221; not to have been breached during the previous year. The institute found the top ten things they had in common and said that was &#8220;best practice&#8221;. Do you see the axioms and what&#8217;s wrong with them? And can you see any maths that might be of use let alone science?</p>
<p>The other problem when it comes to the science of security &#8211;and there is actualy quite a bit&#8211; is many Governments treat the information as classified. History tells us &#8220;long term&#8221; this does not work, however in the short term it&#8217;s worth it&#8217;s weight in gold several times over.</p>
<p>The problem with classifing such information is not just that only the &#8220;chosen few&#8221; on your side benifit whilst the rest of your nation loses, it also &#8220;chills&#8221; talking about it and this stops research. The thing about opren research is &#8216;it lifts all boats&#8217; irrespective of if they are &#8220;saint, sinner or both&#8221; and as more tend to saint than sin the overal result is a benifit not a loss to society.</p>
<p>It&#8217;s open research that is pushing the worst of &#8220;best practice&#8221; lists back to times of the &#8220;dark ages where snake oil was prized, and fakes and quack remidies abounded&#8221;, but it&#8217;s difficult to keep the light burning when powerfull vested interests don&#8217;t want the steralising effect of the light of day shining in on their faux markets. Thus you can see the problem when one vested interest is a government.</p>
<p>This also raises the specter of &#8220;conflict of interest&#8221; when the test houses are not fully independent of the government, it&#8217;s agencies or their influance, the NSA-NIST arangment might or might not have been benign the problem is it was not open thus it&#8217;s suspect. Also some afencies won&#8217;t test or approve some manufactures equipment, the reasons for this are unclear and frankly verges on good old fashioned &#8220;restrictive trade practices&#8221; which are technicaly in breach of international trieties. It&#8217;s why you have the ludicrous situation of one Five Eyes Nation (US) &#8220;condeming&#8221; Chinese companies and another prasing them (UK). If the processes were fully open, independant and based on science and mathmatics not &#8220;best practice&#8221; then that situation could not arise. The equipment could be verifiably tested, and would pass testing or it would not and the cause of failure clearly identified and demonstrable.</p>
<p>Undortunatly for &#8220;science&#8221; to be real you need tests that follow the &#8220;Scientific model&#8221; of Bacon and Newton not Aristotal and Descartes. Whilst their is some science in the technology and some methods of information processing in much there is not.<br />
The reason for this failing is lack of rational and suitable for scientific reasoning measurands. Which unfortunatly has a significant impact on Security, where much reliance is placed on the uncertain mathmatics of probability.</p>
<p>That is not to say security is lacking in method, in fact much is based on what could be termed &#8220;common sense reasoning&#8221;. However there is a significant problem with &#8220;common sense&#8221; it&#8217;s usualy based on observations of our tangible physical world ruled by finite energy/mass and the speed of light and thus comes with a large number of hidden assumptions. Unfortunatly many of these assumptions just don&#8217;t apply in the intangible non physical information universe that could well be infinite and not constrained by either energy or matter except when being communicated, stored or processed by being impressed on physical objects.</p>
<p>The assumptions of the physical world give rise to issues such as &#8220;physicality&#8221;, &#8220;locality&#8221; and &#8220;resource constraint&#8221; which can currently be seen to not apply to the likes of malware, yet many still reach for insurance style acterial tables to do their risk analysis, or reley on physical security methods where they can be shown to be inappropriate.</p>
<p>Thus many of the problems with security can be shown to be due to reasoning based on inappropriate or false assumptions. Which as I&#8217;m sure you will realise makes for &#8220;interesting times&#8221; and any kind of certificate near worthless.</p>
<p>But the problem gets worse, you mention &#8220;check lists&#8221; the problem with this is they only work with &#8220;Known knowns&#8221; and a very limited number of &#8220;Unknown knows&#8221; and by chance against some &#8220;uknown unknowns&#8221; which is by far the largest set of vulnerability instansiations and classes of vulnerabilities. Thus check lists whilst very useful in some areas are in other areas a case of &#8220;fighting the last war with the war befores tactics&#8221; and compleatly inapropriate for fighting the next war where the adversary is well versed in the weak points of the tactics and how to exploit them.</p>
<p>As for the in air coffee machine issue you hypothosize about, it&#8217;s actually a very real problem and I&#8217;ve mentioned it before. Issolating systems in any kind of environment is at best difficult at worst impossible. To see why, both the coffee machine and the flight system are due to the closed environment &#8220;coupled&#8221;, it&#8217;s identified by the old question about the weight of an aircraft full of humingbirds in flight or all perched. The mere prescence of one system effects the other, you as an engineer have to recognise all methods by which they are coupled and then identify the bandwidth and antenuation of each coupling channel, then reason out how to mitigate and to what extent each channel based on reducing the bandwidth and increasing the antenuation. For example one coupling method is via the power supply. Even if you chose to use seperate fuses and wiring busses you get back to the power source. Even seperate generators run on seperate engines are still coupled by the flight dynamics of the aircraft which effects both engines. Similar reasoning applies to mechanical vibration and the acompanying &#8220;sound&#8221; and even gravity by the balance of the aircraft.</p>
<p>However aircraft are generaly only earning money when in the air thus anything that inceases the effective cargo or reducess the ground time will be used. Thus it&#8217;s desirable to have aircraft systems talk to ground systems whilst in flight. One way of reducing cost and weight is to couple systems together in the same way office PC&#8217;s get connected to a LAN that has a common &#8220;gateway&#8221; to a WAN and hence the rest of the world. In theory it would be possible for the coffee machine to indicate to a ground system it was low on sugar, this info is outside of the aircraft interacting with inventory systems which in turn interact with each other which could change the flight manifest causing changes in cargo and weight information that would need to be communicated to the flight system which means even though it&#8217;s indirect the coffee machine does effect in theory the flight system. And it&#8217;s also true in practice, so having identified a valid coupling the question falls to one of cause and effect and potentialy effect mitigation. That is the coffee machine orders a 1000grams of sugar, you do not want the flight system to be told 1Kg but the inventory system actually loading 1tonne ie 1000Kg (yes such mistakes have happened with fuel and conversion from one measurment system to another). But as I noted both systems inside the aircraft also share a common communications network, so there is potentialy direct coupling and thus invalid messages generated by one system could be treated as valid by the other, and people have demonstrated that such problems are possible on test systems at hacker conferances. What is not known is if anybody has dared test it on actuall aircraft systems and if so to what level. I personal suspect few have dared try it to the required level to verify one way or the other, simply because I have experiance as an engineer and I&#8217;ve seen what engineers do to get systems working. That is how vulnerabilities in &#8220;test harnesses&#8221; get left behind for the likes of &#8220;maintainance / repairs / fault finding&#8221; and how they can compleatly breach safety / security. If you want an example think back to CarrierIQ&#8230;</p>
<p>[]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219876">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219876">
						April 14, 2014 12:27 PM					</a>

				</p>

				<p>@ Anura,</p>
<ul><i>Pair Programming is a good way to solve this, as you have one person reviewing every single line as it is typed. On top of this, you have two people discussing the best way to approach the problem. This doesn&#8217;t really work for independent developers, however.</i></ul>
<p>Yes &#8220;pair programing&#8221; is a &#8220;buddy system&#8221; by another name (I&#8217;ll leave Shakespear to do the &#8220;smell test&#8221; 😉</p>
<p>However it needs a minimum of two people as you note but also they need to be broadly comparable in skills/ability. To often I&#8217;ve seen managers and team leaders actually misuse it as a &#8220;sitting next to Nellie&#8221; system to &#8220;productivly&#8221; train up a junior code cutter without using formal training.</p>
<p>It also needs a non adverserial environment, where people can not misuse it to gain pecunary or other benift at their &#8220;buddies&#8221; expense.</p>
<p>I&#8217;m hoping that team leaders and managment above will learn from LEAN methods that adverserial environments realy don&#8217;t work. However half a thousand years of employment history which gave rise to amongst other things revolution, Unions and workers rights organisations and political parties suggest an uphill strugle against the less inteligent psychopaths climbing the managment tree.</p>
<p>As for code analysers and similar, I welcome them as aids to productivity, but not as crutches for poor ability or learning. As I&#8217;ve said else where these tools are far from perfect and sometimes their output needs further mental work with considerable background skill to interpret correctly and get the best from.</p>
<p>I know many managment types want &#8220;Monkey see Monkey do&#8221; programing systems to not just improve productivity but drive worker cost down (history shows this with weavers etc). However they dail to realise that they actually increase the overal &#8220;product life&#8221; costs to the point of bankrupting themselves. In many respects it&#8217;s a &#8220;slash and burn&#8221; methodology that leads quickly to a permanently damaged echo system which much to the blindness of a short term profit they dailt to realise beggers them as much as those they chose to exploit.</p>
<p>For some reason managment often forget their workers are also their customers either directly or indirectly and if the workers cannot aford to buy the product who else can or will&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219877">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219877">
						April 14, 2014 1:52 PM					</a>

				</p>

				<p>Skeptical (April 14, 2014 4:37 AM)</p>
<p>Well that comes somewhat down to the holy grail question.</p>
<p>At first sight (and the way you put the question): No, can&#8217;t be done. Because even putting security police people next to everyone at the development site won&#8217;t cut it.</p>
<p>But then, one doesn&#8217;t need to. What <em>can</em> be done is:</p>
<ul>
<li>Verify algorithms<br />
Actually that&#8217;s widely done in cryptography in the form of peer reviews, cracking attempts, etc.</li>
<li>Verify design (in real world software there&#8217;s more than your wonderful algorithm. There&#8217;s processors, busses, networks, OS &#8230;)<br />
A &#8220;funny&#8221; example that&#8217;s hammering our heads right now: What if your OS isn&#8217;t trustworthy at all?<br />
So design has to ask way more questions than how to implement that algorithm. That&#8217;s also a, probably <em>the</em> point of concern in openssl and the likes.</li>
<li>Verify tools<br />
Obviously it makes a difference whether you use e.g. Ada and paranoically and anally tested compilers or John Does funny new superhyper cool language.</li>
<li>Verify product<br />
That&#8217;s not only &#8220;It doesn&#8217;t crash, so it&#8217;s fine&#8221;. It&#8217;s also not just &#8220;We used unit test and they all passed&#8221;. It&#8217;s bombarding your product with uncommon, senseless, garbage, and even outright evil minded input, data, environment.</li>
<li>
<p>Verify your verification and tools<br />
Are your unit test friendly small town police routines or do they include evil spirited input, data, etc.? <em>Very</em> often unit tests are used only along the line &#8220;does the tested stuff do what it&#8217;s supposed to do?&#8221;. That next to worthless. Unit tests should attack, shake, and rattle your stuff.<br />
Note: The earlier a problem is spotted the cheaper (and usually easier) it is to solve.<br />
Are your assumptions correct?</p>
</li>
</ul>
<p>So, if you want to have something to look at, an indicator of reliability, check the <em>chain</em>. And don&#8217;t be stubborn! Example: Companies just love to have some other large and well established organization to check or verify their software (actually they want &#8211; and pay for &#8211; a nice seal saying &#8220;Tested, worked perfectly, buy!&#8221;).<br />
Better: (At least additionally) pick up some guys at your local university and ask them clearly to shake, rattle, and attack your software. And pay them well. Use their creativity, make use of their youngsters readiness to do shit with your software. They can&#8217;t give you a nice seal but they can give you a nice amount of confidence.</p>
<p>Hint: You can do that as buyer, too.</p>
<p>Or, more generally and philosophically:<br />
Companies tend to be quite organized and formalized and to use the services of other organized and formalized organisations. Problem is, the guys attacking your product are not, neither is nature and life. So, if you want proper testing you need a high amount of disorder, creativity, chaos.</p>
<p>Oh, and btw. if any possible do <em>not only</em> have your designers and developers write their own test cases. Not because of mistrust but because they are humans. They should write some tests. But not all of them. Neither should they write tests mutually (dev. A for dev. B).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219878">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219878">
						April 14, 2014 2:18 PM					</a>

				</p>

				<p>Nick P (April 14, 2014 9:29 AM)</p>
<p>I know about Cyclone. And while I think that C and asm should be avoided wherever possible I&#8217;m aware that some low level stuff sometimes actually needs to be coded in Assembler. And yes I take the liberty to call C an assembler, too, because it <em>is</em> a meta assembler or at least that&#8217;s how it should be seen and used (using C as a meta-assembler is about the only way I see where using C actually is a good thing to do).</p>
<p>And therefore I&#8217;m not all opposed to that. In fact I value Cyclone and typed assembly &#8211; if used properly and as little as necessary.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219879">

			<div class="comment by-relaxing ">

				<p class="commentcredit">

					<span class="commenter">relaxing...</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219879">
						April 14, 2014 3:42 PM					</a>

				</p>

				<p>From the <a href="http://icontherecord.tumblr.com/post/82416436703/statement-on-bloomberg-news-story-that-nsa-knew" rel="nofollow ugc">Official Statement</a>:<br />
&#8220;If the Federal government, including the intelligence community, had discovered this vulnerability [Heartbleed] prior to last week, it would have been disclosed to the community responsible for OpenSSL.&#8221;</p>
<p>Winston Churchill:<br />
&#8220;You can always count on Americans to do the right thing &#8211; after they&#8217;ve tried everything else.&#8221;</p>
<p>me:<br />
&#8220;Exploits like Heartbleed that almost everybody &#8211; as opposed to only the USA/NSA (due to its privileged position in the internet, computing power, etc.) &#8211; can effectively put to use are in the interest of the USA to be made public, because this protects US businesses and people better; especially it protects global business of US companies better, because it restores trust in global electronic business. Hopefully it will also be possible to &#8220;convince&#8221; the USA/NSA to change policies regarding some other aspects of electronic data handling in time. To the people of the World: You have the Power! &#8211; Oops, sorry, your money has the power, it can buy the USA/NSA, make it do (almost) anything you want &#8211; this is the country where &#8220;free&#8221; means both free literally and in terms of money &#8211; the USA is foremost a Plutocracy, never forget that&#8230;&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219880">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219880">
						April 14, 2014 9:22 PM					</a>

				</p>

				<p>@ Skeptical</p>
<p>re security evaluations</p>
<p>I thought your question was important enough to merit an essay on the topic. I posted it in the squid thread <a href="https://www.schneier.com/blog/archives/2014/04/friday_squid_bl_419.html#c5457853" rel="nofollow ugc">here</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219881">

			<div class="comment by-backtothepoint ">

				<p class="commentcredit">

					<span class="commenter">BackToThePoint</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219881">
						April 14, 2014 10:01 PM					</a>

				</p>

				<p>At least 4 examples of SSL private keys obtained reported by security sources yesterday, and probably many others we might assume that aren&#8217;t being reported by the people that obtained them. Huge amounts of data are being fired at servers around the world, as well as record amounts of NTP reflection attacks, and other DDoS attacks. Many provider&#8217;s front and back-end services are being affected intermediately, along with outages in some areas. Servers are rebooting all over the place, while users attempt to update passwords and providers assess their exposure.</p>
<p>We are seeing an escalating cyber arms race in reaction to a &#8220;Wild West&#8221; environment. Some no longer feel secure just wearing their firewall/AV vest and are increasingly turning to attack mitigation services, others are &#8220;tooling-up&#8221;, and some still stumble around saying they don&#8217;t need firewalls and AV.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219883">

			<div class="comment by-reflecting ">

				<p class="commentcredit">

					<span class="commenter">reflecting</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219883">
						April 14, 2014 10:57 PM					</a>

				</p>

				<p>Heartbleed used to steal Canadian taxpayer data.</p>
<p><a href="http://www.itnews.com.au/News/382816,heartbleed-used-to-steal-canadian-taxpayer-data.aspx" rel="nofollow ugc">http://www.itnews.com.au/News/382816,heartbleed-used-to-steal-canadian-taxpayer-data.aspx</a></p>
<p>Combine this threat with banking Trojans like Zeus, and Gameover which uses SSL to encrypt traffic making it difficult to detect, they can log keystrokes, steal credentials and launch DDoS attacks, and you get some idea of the sophistication of recent malicious code developments. The latest Trojans can not only be delivered through email, but served via a web page as an Internet Explorer document and fool any detection system by using an apparently legitimate digital signature.</p>
<p>Many modern Antivirus suites and Firewalls will allow a file with a digital signature to automatically connect to the internet if it appears legitimate.<br />
Not only may users create an exception for a certificate they think may be legitimate, your security software may allow files with a digital signatures which appear legitimate to launch a variety of unseen actions and attacks.</p>
<p>Software publishers need to strongly protect the secrecy of the cryptographic keys used to create each signature, and strongly enforce the signing authorisation process – typically using hardware security modules (HSMs) which create a tamper-resistant environment for managing and using keys.Without an HSM, keys and processes are subject to a host of attacks since they can be ‘seen&#8217; in the processor&#8217;s memory, easily copied and modified.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219884">

			<div class="comment by-autolykos ">

				<p class="commentcredit">

					<span class="commenter">Autolykos</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219884">
						April 15, 2014 4:24 AM					</a>

				</p>

				<p>@Mr. Pragma:<br />
I don&#8217;t think introducing monetary rewards into Open Source development would be healthy or good for quality. Usually, people who do something because they <em>want</em> to will be way more motivated and diligent than anything you can achieve by paying them (even quite unreasonable amounts). And paying motivated guys will shift their thinking (unless they&#8217;re extremely disciplined). Once they see it as business, they will start to optimize payment per invested time, which results in lazy, half-baked code and shipping too early (only it&#8217;s also written by amateurs).<br />
If you want good, reliable Open Source software, you should pay for reviews and audits instead (which is usually pretty non-fun anyway, so it&#8217;s hard to find skilled and motivated people who&#8217;d do it pro bono).<br />
You can&#8217;t really blame a bunch of hobby programmers for occasionally writing bad code (motivation alone doesn&#8217;t cut it), especially if you took it for free. But you can blame a company with a budget competing with small nations to use that code in security-critical places without ever having it reviewed properly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219885">

			<div class="comment by-minus1 ">

				<p class="commentcredit">

					<span class="commenter">minus1</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219885">
						April 15, 2014 5:06 AM					</a>

				</p>

				<p>There are no coincidences, everything happens for a reason!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219886">

			<div class="comment by-kevin-lyda ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.phrye.com/' rel='external nofollow ugc' class='url'>Kevin Lyda</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219886">
						April 15, 2014 8:02 AM					</a>

				</p>

				<p>Regarding <a href="https://tools.ietf.org/html/rfc6520" rel="nofollow ugc">https://tools.ietf.org/html/rfc6520</a> , isn&#8217;t it a problem that the response must contain a copy of the data sent?  Isn&#8217;t that a possible attack vector?</p>
<p>From RFC 6520:<br />
&#8220;&#8221;&#8221;<br />
   When a HeartbeatRequest message is received and sending a<br />
   HeartbeatResponse is not prohibited as described elsewhere in this<br />
   document, the receiver MUST send a corresponding HeartbeatResponse<br />
   message carrying an exact copy of the payload of the received<br />
   HeartbeatRequest.<br />
&#8220;&#8221;&#8221;</p>
<p>For cryptanalysis, isn&#8217;t knowing that the same text is being encrypted by the same key a useful thing to know?  I&#8217;m not clear if TLS is using the same key to encrypt in each direction of course, but if it is this seems like a problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219887">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219887">
						April 15, 2014 1:27 PM					</a>

				</p>

				<p>Anyone have an idea on the number of printers are vulnerable? A number of orgs leave printers forward facing for IPP printing off-site, some with VPN (using TLS/SSL gateways) as a precaution, but I am sure there are a number of devices that are not DMZ or layered away from production systems. What could be the exposure/risk matrix in this situation?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219888">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219888">
						April 15, 2014 2:00 PM					</a>

				</p>

				<p>@ name.withheld</p>
<p>The printers all top out at EAL4 usually connected to a device or network maxed at EAL4. So, by definition, they&#8217;re all vulnerable.  Just got to identify the vulnerabilities. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219889">

			<div class="comment by-mr-pragma ">

				<p class="commentcredit">

					<span class="commenter">Mr. Pragma</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219889">
						April 15, 2014 2:32 PM					</a>

				</p>

				<p>Autolykos (April 15, 2014 4:24 AM)</p>
<p>You are right, at least to to a large degree. But: That&#8217;s not what I suggested.</p>
<p>Funny that most take it as that but &#8220;paying for OS software&#8221;  is NOT identical to &#8220;paying the developers&#8221;.</p>
<p>To name just two examples for things that rarely get done properly in OS projects, usually either because it&#8217;s considered boring or because it&#8217;s forbiddingly expensive:</p>
<ul>
<li>code audits, security evaluation</li>
<li>documentation</li>
</ul>
<p>There are more but I think those two rather striking examples will do for the moment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219890">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219890">
						April 15, 2014 5:15 PM					</a>

				</p>

				<p>&#8220;I&#8217;m not clear if TLS is using the same key to encrypt in each direction&#8221;</p>
<p>It doesn&#8217;t.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219891">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219891">
						April 16, 2014 12:10 PM					</a>

				</p>

				<p>@Kevin Lyda</p>
<blockquote><p>Regarding <a href="https://tools.ietf.org/html/rfc6520" rel="nofollow ugc">https://tools.ietf.org/html/rfc6520</a> , isn&#8217;t it a problem that the response must contain a copy of the data sent? Isn&#8217;t that a possible attack vector?</p></blockquote>
<blockquote><p>For cryptanalysis, isn&#8217;t knowing that the same text is being encrypted by the same key a useful thing to know? I&#8217;m not clear if TLS is using the same key to encrypt in each direction of course, but if it is this seems like a problem.</p></blockquote>
<p>Even if it was the same key, at best it falls under the realm of a known plaintext (but the plaintext itself isn&#8217;t actually known to the attacker, so it&#8217;s not even thant). Ciphers are designed to be secure against known and chosen plaintext attacks with ridiculously large numbers of plaintexts.</p>
<p>The big problem is that it&#8217;s completely pointless to allow 65535 bytes of data. I don&#8217;t see any reason not to just hardcode the damned thing to one byte (justifying the need for a heartbeat in the first place is another matter entirely).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-219892">

			<div class="comment by-notamused ">

				<p class="commentcredit">

					<span class="commenter">NotAmused</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219892">
						April 17, 2014 3:13 AM					</a>

				</p>

				<p>There are many webservices to perform heartbleed-tests online (for the own or others websites), but I would like to know, if there are offline tools available for internal tests (intranet webservers), too?<br />
The best would be, if these are open source tools, because I would like to compile it myself to be sure there are no unwanted features added.</p>
<p><b>Do you have any suggestions?</b></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-219893">

			<div class="comment by-nsa-word-games ">

				<p class="commentcredit">

					<span class="commenter">nsa word games</span> •

					<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/#comment-219893">
						April 17, 2014 2:11 PM					</a>

				</p>

				<p>Bruce,</p>
<p>You say the NSA statement is wordgame free, but it&#8217;s not possible to trust that.  We already know that NSA redefines terms so that things which sound wordgame free really aren&#8217;t. For example, when they said they weren&#8217;t collecting data and it larer turned out that they defined collect to include review as part of a court case if and only if a reviewer remembered to check the checkbox saying the data was reviewed.</p>
<p>Also, as someone else loints out, which private report did the NSA first learn about heartbleed from and what date was it? Was it the same time OpenSSL learbed about it? Or a private contractor working for the NSA who discivered it and reported it privately?</p>
<p>You simply <em>cannot</em> trust anything the nsa says. They are proven and ver ingenuitive liars.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/04/more_on_heartbl.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/04/more_on_heartbl.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F04%2Fmore_on_heartbl.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/04/more_on_heartbl.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5303' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/04/police_disablin.html" rel="prev">← Police Disabling Their Own Voice Recorders</a>		<a href="https://www.schneier.com/blog/archives/2014/04/friday_squid_bl_419.html" rel="next">Friday Squid Blogging: Bronze Giant Squid Sculpture →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
