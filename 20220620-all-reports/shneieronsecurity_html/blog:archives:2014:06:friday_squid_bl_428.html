<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Friday Squid Blogging: Squid Cartoon - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Friday Squid Blogging: Squid Cartoon Comments Feed" href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5364" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5364' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F06%2Ffriday_squid_bl_428.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F06%2Ffriday_squid_bl_428.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5364 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5364" class="post-5364 post type-post status-publish format-standard hentry category-uncategorized tag-humor tag-squid">

	<div class="article">

		<h2 class="entry">Friday Squid Blogging: Squid Cartoon</h2>
		<p><a href="http://rhymeswithorange.com/comics/june-1-2014/">Rhymes with Orange</a>.</p>
<p>As usual, you can also use this squid post to talk about the security stories in the news that I haven&#8217;t covered. </p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/humor/" rel="tag">humor</a>, <a href="https://www.schneier.com/tag/squid/" rel="tag">squid</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html" rel="bookmark">Posted on June 6, 2014 at 4:09 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html#comments">221 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html" data-title="Friday Squid Blogging: Squid Cartoon" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-224159">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224159">
						June 6, 2014 4:12 PM					</a>

				</p>

				<p>A story by the ACLU:</p>
<p>US Marshals raided a Florida police station to whisk away documents about to be released under FOIA request regarding the Stringray surveillance system (fake cell towers). Also pointed to some illegal acts by the Feds and the court system there.</p>
<p><a href="https://www.aclu.org/blog/national-security-technology-and-liberty/us-marshals-seize-local-cops-cell-phone-tracking-files" rel="nofollow ugc">https://www.aclu.org/blog/national-security-technology-and-liberty/us-marshals-seize-local-cops-cell-phone-tracking-files</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224160">

			<div class="comment by-vas-pup ">

				<p class="commentcredit">

					<span class="commenter">vas pup</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224160">
						June 6, 2014 4:18 PM					</a>

				</p>

				<p><a href="http://www.bbc.com/future/story/20140603-brain-zapping-the-future-of-war" rel="nofollow ugc">http://www.bbc.com/future/story/20140603-brain-zapping-the-future-of-war</a><br />
Good reading for all IT/SEC/LEAs/Intel</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224161">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224161">
						June 6, 2014 4:20 PM					</a>

				</p>

				<p>Parents Mobilize Against States&#8217; Student Data Mining</p>
<p><a href="http://news.slashdot.org/story/14/06/06/2041236/parents-mobilize-against-states-student-data-mining" rel="nofollow ugc">http://news.slashdot.org/story/14/06/06/2041236/parents-mobilize-against-states-student-data-mining</a></p>
<p>That is why people think there is a problem in education.  Also, the State of Florida (or some such in that territory) uses an IBM system to mine such data for prediction of criminal juvenile activity&#8230;</p>
<p><a href="http://gizmodo.com/5517231/crime-prediction-software-is-here-and-its-a-very-bad-idea" rel="nofollow ugc">http://gizmodo.com/5517231/crime-prediction-software-is-here-and-its-a-very-bad-idea</a></p>
<p>Based on some comments in the Slashdot post, who is to say that this educational data gathering won&#8217;t be used for the same purpose (guilty unless proven innocent).</p>
<p>And, if you want to avoid such shenanigans, then don&#8217;t do Xanadu:</p>
<p><a href="http://tech.slashdot.org/story/14/06/06/1757210/xanadu-software-released-after-54-years-in-the-making" rel="nofollow ugc">http://tech.slashdot.org/story/14/06/06/1757210/xanadu-software-released-after-54-years-in-the-making</a></p>
<p>Those links will never be broken (speculation on somebody&#8217;s part).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224162">

			<div class="comment by-paul-suhler ">

				<p class="commentcredit">

					<span class="commenter">Paul Suhler</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224162">
						June 6, 2014 4:39 PM					</a>

				</p>

				<p>A new vulnerability has just been patched in OpenSSL.  And the discoverers have learned the publicity lessons from Heartbleed; they even have a logo.</p>
<p><a href="http://ccsinjection.lepidum.co.jp/" rel="nofollow ugc">http://ccsinjection.lepidum.co.jp/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224164">

			<div class="comment by-jonathan-wilson ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Wilson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224164">
						June 6, 2014 5:36 PM					</a>

				</p>

				<p>The most likely reason for the feds censoring the Stingray stuff is because if it was released it would give people being charged with crimes where this tech was used a way to get the evidence derived from it thrown out. That or provide bad guys with info that could make it easier for them to detect the use of the devices and change their behavior pattern to avoid giving the cops evidence (just like the way criminals will change their behavior pattern if they think their phone is tapped or their house is being watched by the cops)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224165">

			<div class="comment by-rick ">

				<p class="commentcredit">

					<span class="commenter">Rick</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224165">
						June 6, 2014 5:38 PM					</a>

				</p>

				<p>If Snowden &amp; co. could somehow use known vulnerabilities against the NSA establishment in order to force the world to protect itself from snooping (given a disappointing lack of esprit de corps among the public to demand change thus far) then it might look like the announcement of this new SSL vulnerability, CCS injection. In my opinion.</p>
<p>Perhaps this vulnerability reveals what was meant to the reference in a Snowden story, &#8220;Just send it over for a decrypt&#8230;&#8221; with regard to the intercept and review of captured data in flight. Check out the &#8220;Bullrun&#8221; and &#8220;Cheesy Name&#8221; programs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224167">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224167">
						June 6, 2014 7:17 PM					</a>

				</p>

				<p>Openssl contains this nice undocumented API function that can jump to every desired adress</p>
<p><a href="http://goo.gl/TFjQNl" rel="nofollow ugc">http://goo.gl/TFjQNl</a></p>
<p>It was written by Andy Polyakov of Openssl.</p>
<p>And there is this Critical infrastructure initiative that supports Openssl</p>
<p><a href="http://arstechnica.com/information-technology/2014/05/openssl-to-get-" rel="nofollow ugc">http://arstechnica.com/information-technology/2014/05/openssl-to-get-</a><br />
a-security-audit-and-two-full-time-developers/</p>
<p>This initiative gets its money from companies like Amazon which supports the CIA with hardware and Microsoft which helps NSA to spy on Skype.</p>
<p>So it is clear which persons the Core Infrastructure Initiative supports:</p>
<p>Today, the foundation announced that the first projects to get<br />
funding will be OpenSSL, OpenSSH, and Network Time Protocol.</p>
<p>&#8220;OpenSSL will receive funds from CII for two, full-time core<br />
developers,&#8221; the announcement said. &#8220;The Open Crypto Audit Project<br />
(OCAP) will also receive funding in order to conduct a security audit<br />
of the OpenSSL code base.&#8221;</p>
<p>The fellowships are going to developers</p>
<p>Stephen Henson and  Andy Polyakov</p>
<p>Yes this Andy Polyakov is the same one who introduced that undocumented ROP function into Openssl. Of course the agents must be supported during these hard times, especially since they will need much time to figure out the NSA interfaces of future Openssl versions. Simply writing some wrappers to obfuscate the code and then intruducing an API function won&#8217;t suffice anymore, I guess&#8230; So their job will be much harder, which needs money&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224168">

			<div class="comment by-cshannon ">

				<p class="commentcredit">

					<span class="commenter">cshannon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224168">
						June 6, 2014 7:51 PM					</a>

				</p>

				<p>Interesting article over on wired about two security professionals that reversed engineered desktop IP phones and found buffer over flows, and other vulnerabilities that allowed them to take over the display of the phone and play audio clips over the speaker, all remotely.</p>
<p><a href="http://www.wired.com/2014/06/desk-phone-hacks/" rel="nofollow ugc">http://www.wired.com/2014/06/desk-phone-hacks/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224169">

			<div class="comment by-marshall ">

				<p class="commentcredit">

					<span class="commenter">Marshall</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224169">
						June 6, 2014 7:55 PM					</a>

				</p>

				<p><a href="http://theworldlink.com/news/local/crime-and-courts/wonnacott-guilty-but-not-contrite/article_bce5794c-ec07-11e3-839e-0019bb2963f4.html" rel="nofollow ugc">http://theworldlink.com/news/local/crime-and-courts/wonnacott-guilty-but-not-contrite/article_bce5794c-ec07-11e3-839e-0019bb2963f4.html</a></p>
<p>“The new evidence was from a forensic examination of a GPS device that Wonnacott had with him showed that, even when it was off, it remained in contact with a satellite. That meant that investigators could track his movement throughout the days in question.</p>
<p>“Monson says it showed that Wonnacott flew to Reno on July 29 and retrieved a vehicle, which they could now prove he drove back to North Bend. It showed he arrived outside the victim’s shop at the exact time the incident reportedly took place, and then quickly sped away back to Reno.”</p>
<p>Hmmm, really??? … Out here in the sticks, this nutball perp pleaded on the eve of going to trial. I suspect maybe this was a bluff that speaks mostly to how modern surveilance tech is perceived by the public … blackest magic &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224170">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224170">
						June 6, 2014 8:22 PM					</a>

				</p>

				<p>@Benni</p>
<p>A few ways we can go:<br />
1.)   Make our own crypto libraries from scratch. (terribly poor choice)<br />
2.)   Leverage on LibreSSL that has been forked off OpenSSL which is still unstable. (Requires audits and funds)<br />
3.)   Continue OpenSSL. (Funded by Microsoft, Amazon and companies whom you accused are in cahoots with the Government of USA)</p>
<p>Honestly all of them are a bad choice from my point of view. Anything can go wrong at any point during the creating/maintenance of critical crypto codes. Crypto is easy to get wrong and very rarely to get right as Bruce have said.</p>
<p>What we need are active support from seasoned cryptographers and security researchers to help during the creating and maintenance of the critical crypto libraries side by side with developers and the community. Money have to come from somewhere so a paid for open source version like MySQL would be nice.</p>
<p>The basic crypto libraries can be given for free and the extended libraries with SSL/TLS and advanced protocol for some paid amount but everything is open sourced. The money are used to pay the people involved. Too much free work taken for granted out there.</p>
<p>On the crypto side, SSL/TLS protocols are rather complex and tricky and it&#8217;s not surprising people get them wrong most of the time. GNUTLS, OpenSSL, Apple&#8217;s goto bug are some classical examples of the complexity of the SSL/TLS protocol.</p>
<p>I would suggest scraping the protocol and coming up with a properly designed and field tested one before releasing it to the public. SSL/TLS was never field tested in real world conditions before being released into the wild and it&#8217;s security is still debatable. I am quite surprised that the IETF actually allowed SSL/TLS to be implemented without proper cryptanalysis until it&#8217;s deployed and cryptographers start to do cryptanalysis after it has been released into the wild. Shouldn&#8217;t cryptanalysis proceed before product release ?</p>
<p>These are just my few cents of thoughts on SSL/TLS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224171">

			<div class="comment by-luckeyluke ">

				<p class="commentcredit">

					<span class="commenter">luckeyluke</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224171">
						June 6, 2014 8:44 PM					</a>

				</p>

				<p>The most bizarre thing about Openssl yet:</p>
<p><a href="https://plus.google.com/+MarkJCox/posts/L8i6PSsKJKs" rel="nofollow ugc">https://plus.google.com/+MarkJCox/posts/L8i6PSsKJKs</a></p>
<p>OpenBSD itself wasn&#8217;t on the &#8216;sec&#8217; list,<br />
advisories kept hidden from OpenBSD until publicly disclosed.</p>
<p>Anger is in the air &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224172">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224172">
						June 6, 2014 10:20 PM					</a>

				</p>

				<p>@Thoth</p>
<p>I find it extremely problematic that the linux foundation supports openssl and not libressl. There is now money being paid to audit openssl. But what should come out of such an audit? A library that contains a function which enables you to jump to every adress is not secure and can not be trusted. A paid audit will just reveal what we already know.</p>
<p>They should found libressl instead.</p>
<p>By the way, Mr Robin Seggelmann, coder of Heartbleed, also introduced this newer vulnerability to openssl:</p>
<p><a href="http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/ZDI-14-173-CVE-2014-0195-OpenSSL-DTLS-Fragment-Out-of-Bounds/ba-p/6501002" rel="nofollow ugc">http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/ZDI-14-173-CVE-2014-0195-OpenSSL-DTLS-Fragment-Out-of-Bounds/ba-p/6501002</a></p>
<p>Since Crypto AG, the german BND is very successfull in running entire Crypto hardware companies:</p>
<p><a href="http://cryptome.org/jya/cryptoa2.htm" rel="nofollow ugc">http://cryptome.org/jya/cryptoa2.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224175">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224175">
						June 7, 2014 1:33 AM					</a>

				</p>

				<p>@ Thoth</p>
<p><i>&#8220;On the crypto side, SSL/TLS protocols are rather complex and tricky and it&#8217;s not surprising people get them wrong most of the time. GNUTLS, OpenSSL, Apple&#8217;s goto bug are some classical examples of the complexity of the SSL/TLS protocol.&#8221;</i></p>
<p>Actually they are not. The TLS spec is bad, but <em>all</em> the bugs are directly related to C. These are:</p>
<ul>
<li>No proper error handling / type (GnuTLS).</li>
<li>Ambiguous indentation / scoping &#8220;{}&#8221; in the case of the double goto.</li>
<li>No buffer overflow check in the case of Heartbleed. </li>
</ul>
<p>The language C, although still very popular, is over 40 years old and it shows. Today a bug can have a massive impact because of the internet. C has too many weak spots, on the semantic level, the implementation level, and the tool chain.</p>
<p>When do people start to realize that we need to get rid of C? And please don&#8217;t get me wrong, I am not a C basher, in fact, I like the language, but it is not safe anymore.</p>
<p>@ Benni</p>
<p>Let me be frank and ask the question: Do you think OpenSSL is a conspiracy?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224176">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224176">
						June 7, 2014 1:59 AM					</a>

				</p>

				<p>@Gerard van Vooren,</p>
<blockquote><p> &#8211; No proper error handling / type (GnuTLS).<br />
&#8211; Ambiguous indentation / scoping &#8220;{}&#8221; in the case of the double goto.<br />
&#8211; No buffer overflow check in the case of Heartbleed.</p></blockquote>
<p>The first two are not unique to &#8220;C&#8221;, wouldn&#8217;t you agree? The last one is debatable.<br />
As for &#8220;C&#8221;, whether you want to ditch it or not, The language today has gone many evolutions. &#8220;C&#8221; today is not the same as &#8220;C&#8221; in 1969. So, in a way, it&#8217;s not showing it&#8217;s age, because it got many face lifts 🙂</p>
<p><a href="http://cm.bell-labs.com/who/dmr/chist.html" rel="nofollow ugc">http://cm.bell-labs.com/who/dmr/chist.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224177">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224177">
						June 7, 2014 3:48 AM					</a>

				</p>

				<p>@Benni</p>
<p>I do agree that LibreSSL should also be funded. I feel that Linux Foundation (LF) should decide who they want to fund and if better, to fund both LibreSSL and OpenSSL and LF has chosen to fund OpenSSL. One of the reasons I suspect OpenSSL gets most of the attention and spotlight for fundings is due to publicity and usage but LibreSSL should also deserve funds nonetheless in my opinion. One way to bring more funding for LibreSSL is to bring more attention and more publicity. Create an image for LibreSSL and funds would start pouring in. It&#8217;s more of the PR issue. Those who are good at graphics design and PR relations can aid LibreSSL in creating an image and getting more attention.</p>
<p>OpenSSL being full of bugs does not equate to just dumping the project and walking away. It requires auditing and fixing in-depth. LibreSSL being a fork should also require the same attention as well to remove bugs inherited from OpenSSL.</p>
<p>The coder who have introduced many bugs into OpenSSL should be removed from the commit list and his codes not be accepted anymore until all the bugs have been fixed.</p>
<p>@Gerard</p>
<p>The C language is indeed an aging language and should not be used for crypto-critical projects anymore.</p>
<p>Regarding the OpenSSL conspircy, I personally feel that it&#8217;s more of careless programming than someone trying to meddle with OpenSSL to create backdoors. The codes are in the open but no one spotted it until recently.</p>
<p>Once OpenSSL gets an overhaul and becomes slimmer just like what LibreSSL is attempting to do, it would be easier to maintain the codes and catch bugs.</p>
<p>Just a thought, if the NSA wants entry into computer systems, they would be in any moment whenever they wantand they have tonnes of methods to enter any computer system they want.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224178">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224178">
						June 7, 2014 4:49 AM					</a>

				</p>

				<p>Question to the board members:</p>
<p>Since the NSA is demonstrably interested in encryption, and<br />
since this board deals with security and encryption items,<br />
do you think that the each board member may be a &#8220;person of interest&#8221;?<br />
And I mean not just monitoring talkback posting, but actually going into the poster computer to see if there are things of interest.</p>
<p>And if you do, does this hinder your postings?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224179">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224179">
						June 7, 2014 5:06 AM					</a>

				</p>

				<p>Jacob: I am almost certain that regular contributors to any forum the NSA deems to be of &#8216;interest&#8217; would be flagged and added to the relevant database. Whether schneier.com is interesting enough, and whether such a low level &#8216;flagging&#8217; would result in them actually attempting to compromise your computer(s) is questionable, but I have been wrong before.</p>
<p>Re ACLU: yes, I read about this. It is incredible to think that the government of a country which &#8211; at least prior to about ten years ago &#8211; considered itself to be the bastion of individual rights and free speech is behaving in this way, contravening its own laws and indeed the Constitution. I&#8217;m not sure where it stops, and if it will end &#8211; without their hand being forced by the people I&#8217;d say probably not.</p>
<p>Gerard: what are your thoughts on the legitimacy of OpenSSL? I heard that the initial author wrote the thing as an exercise in understanding how to code with bignum arithmetic?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224180">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224180">
						June 7, 2014 5:46 AM					</a>

				</p>

				<p>@Mike t g</p>
<p>You didn&#8217;t get what it means &#8220;master the internet&#8221;? 100% coverage?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224181">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224181">
						June 7, 2014 6:02 AM					</a>

				</p>

				<p>@ Jacob</p>
<blockquote><p>And if you do, does this hinder your postings?</p></blockquote>
<p>There may be personnel, an agent/mole, that participates in the discussions on this board. Most likely the NSA is auto-collecting blog data from Schneier.com (there is some automated blog slurping spider/crawler) and some trigger/process management invokes some other action automatically. I would find it hard to believe that some clod is sitting at a terminal watching this or other similar sites. Wonder how many hops out &#8220;we&#8221; are tracked&#8230;and&#8230;if your http referrer string is from schneier to x than that&#8217;s  hit, if it&#8217;s from cnn/wired (not slashdot or arstechnica) to schneier than it&#8217;s dropped. If you&#8217;re launching from a bookmark&#8211;red alert. And if your using passive tools to scrap content&#8211;they&#8217;re parked outside in a black van.</p>
<p>Oh, the self censoring echos in my brain&#8211;NSA has completely transmogrified my own processes in so many ways. It even ruined my run at a new start-up (fixed investment from savings for a one-year tech boot&#8211;date of start-up&#8211;OCT 2012). In September I became aware of a series of problematic issues regarding the integrity and status of general technological market sectors in background research for the start-up.</p>
<p>In Feb of 2013, developed Draft of new Business process model to answer the lack of robustness in the SME/Tech business operations and the problems that would be revealed four months later. With experience in ISO 9000 (aerospace), 15408 (computer manufacturer), 27000 (assurance model, infosec) and a number of MilSPEC, NSA, and NIST-based standards, identifying the level of entropy a small tech company may experience, the need to adopt an appropriate framework that can be reliable used without inordinate costs.</p>
<p>Considering specific industry trends&#8211;the self censorship is indirect&#8211;the efforts of the last year would have been better spent in research, developing our base, and carrying out the design engineering we&#8217;d anticipated as the highest order activity. Now, after a year of preventing a sinking due to a hull breach, no measurable progress on a half-dozen projects. My consideration in this matter revolved around the amount of time I&#8217;ve spent in the industry, the long-term implications of business and government actions, and the reckless cyber warfare theoretical and statutory positions the U.S government has decided (in secret) is appropriate. Not only that, the devolution of power (and at the same time the centralization of power) in the Presidency to the DoD.</p>
<p>And in November I contacted an alumi relations department (a walk-in task) for my friend, a mathematician that apparently received threats from their government during the course of our business development efforts (several projects were discussed and entertained). My friend was excited about opportunity in Apr 2013, by July the problems began. In late summer, my friend expressed their fear about the situation&#8211;thus elevating my sensitivity to the situation. In December 2013 it was decided to terminate the effort for sanity&#8217;s sake. Nough said.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224182">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224182">
						June 7, 2014 6:14 AM					</a>

				</p>

				<p>@jacob</p>
<p>I have no doubt that NSA has a list with every person posting here. If they had resources to spend on War of Warcraft, be sure they monitor more important places, directly related to their activity, like this board.</p>
<p>I was also supposing Edward Snowden is reading this blog, now that I saw the EPIC footage I am sure. Also, it&#8217;s probably Skeptical and one or two more people who were assigned for damage control and to report summaries of what&#8217;s going on.</p>
<p>Does this change things? I&#8217;m not sure, the whole world became aware of the amplitude of the surveillance and the consequences (and counter-measures) already occurred. As for the NSA guys, most of them are most likely just specialists doing their job. There are politics and big fat rich asses behind, at the power buttons, who are using NSA as a tool, taking the nasty decisions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224183">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224183">
						June 7, 2014 6:47 AM					</a>

				</p>

				<p>keiner: I don&#8217;t know what you&#8217;re driving at. I also suspect that their coverage is far from universal. No doubt they would like to remedy that, though.</p>
<p>nwfor: I agree with your assessment of the general vibe here. There are certainly many puppets. Whether that is just a consequence of people with too much time on their hands or if it really is some kind of opinion shaping/etc. being done by an agency of some sort, I don&#8217;t know, but I definetely notice it and I see that others have too.</p>
<p>alex: Snowden is likely reading this blog &#8211; hell, he is probably an occasional contributor. More importantly, the future &#8216;Snowdens&#8217; of the world are probably reading this blog. This is probably why &#8211; if I was an NSA agent &#8211; I would want to monitor a blog such as Bruce&#8217;s.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224184">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224184">
						June 7, 2014 6:55 AM					</a>

				</p>

				<p>@Gerard van Vooren</p>
<p>What &#8220;Conspiracy&#8221;</p>
<p>Wikipedia Says:<br />
<a href="http://en.wikipedia.org/wiki/OpenSSL#History_of_the_OpenSSL_project" rel="nofollow ugc">http://en.wikipedia.org/wiki/OpenSSL#History_of_the_OpenSSL_project</a></p>
<p>Steve Marquess, a former military consultant in Maryland started the foundation for donations and consultancy contracts and garnered sponsorship from the United States Department of Homeland Security and the United States Department of Defense.[2]</p>
<p>The NSA Currently has a billion dollar budget. With that budget, one can fairly assume that they have created their own much better crypto library that is used by the US government. At some Spiegel interview, general Hayden said that the NSA would have &#8220;improved&#8221; the Blackberry of Obama a bit that its communications are harder to tap. This is only possible if you have your own crypto library that is easily portable to numerous platforms.</p>
<p>There is a law in the US saying that the NSA must collect all encrypted communication it intercepts as long as it is unable to encrypt them. This law should make clear that the US government is hostile towards the use of encryption in the general population.</p>
<p>Openssl is a library which contains an API function written in Assembly that allows  you to jump on an arbitrary adress. For example it allows to jump to an arbitrary function and load your own arbitrary stuff there. Thats a hackers dream.</p>
<p>The author who wrote this function writes in a comment:</p>
<p>&#8220;This function can become handy under Win32 in situations when<br />
-# we don&#8217;t know which calling convention, __stdcall or __cdecl(*),&#8221;</p>
<p>That makes no sense. The calling convetion of some function is defined in its C header.</p>
<p><a href="http://msdn.microsoft.com/en-us/library/zkwh89ks.aspx" rel="nofollow ugc">http://msdn.microsoft.com/en-us/library/zkwh89ks.aspx</a></p>
<p><a href="http://msdn.microsoft.com/en-us/library/zxk0tw93.aspx" rel="nofollow ugc">http://msdn.microsoft.com/en-us/library/zxk0tw93.aspx</a></p>
<p>Who wants to call some function, when he/she does not know exactly how that function which is being called, is defined. If you do not know e.g which parameters a function takes, which calling convention it has, what it does return, then you do not call it, right?</p>
<p>Well, only a hacker usually does not know exactly how the functions in a program are defined. The hacker also has to try to load some wrong data into a function, or at best start the call at some desired starting point, which would be illegal if you would follow the C language.</p>
<p>And according to the Openbsd developers, OpenSSL has a function for exactly this action included in its API:</p>
<p><a href="http://www.openbsd.org/papers/bsdcan14-libressl/mgp00025.html" rel="nofollow ugc">http://www.openbsd.org/papers/bsdcan14-libressl/mgp00025.html</a></p>
<p><a href="http://goo.gl/TFjQNl" rel="nofollow ugc">http://goo.gl/TFjQNl</a></p>
<p>The Random Number generator DUAL_EC that was deliberately weakened by NSA was introduced by the &#8220;request of an anonymous sponsor&#8221; into OpenSSL.</p>
<p><a href="http://openssl.6102.n7.nabble.com/Flaw-in-Dual-EC-DRBG-no-not-that-on" rel="nofollow ugc">http://openssl.6102.n7.nabble.com/Flaw-in-Dual-EC-DRBG-no-not-that-on</a><br />
e-td47744.html</p>
<p>That is no surprise. And it is no Conspiracy. That is the code quality you can expect when a publicly available crypto library is openly sponsored by the defense ministry and the homeland security department.</p>
<p>With these sponsors, contributions of OpenSSL developers into other projects must be granted with suspicion, as this can be potential sponsors from government agencies, or from people who earn their money from the department of defense and the homeland security department.</p>
<p>Please note that secret services like the NSA can officially not act as a sponsor of something.</p>
<p>In germany, the listening station in Bad Aibling is officially a &#8220;wide range telecommunication site&#8221; that is run by the german army. The OSZE military observers in Ukraine come from the centre for verification affairs of the german army, even if they have been briefed by the BND, according to the government.</p>
<p>Similarly, the NSA can not sponsor a Crypto Library directly. But I do not believe that the Department of Defense has large expertise in crypto software, because this is what the NSA was build for.</p>
<p>If the Department of Defense sponsors a Crypto library and hires the developers to do contraction work, then its clear what you can expect.</p>
<p>I guess there will be more to come than just some ROP entry point and a few bugs.</p>
<p>Project Flying Pig where the NSA fakes google servers in MITM attacks must work somehow&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224185">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224185">
						June 7, 2014 7:29 AM					</a>

				</p>

				<p>To elucidate How unlikely it would be, if the OpenSSL developers were no government spies, I think the following passage from this Spiegel article suffices:</p>
<p>&#8220;But on the other hand it appeared like the German service had an suspiciously great interest in the prosperity of the Swiss company. In October 1970 a secret meeting of the BND discussed, &#8220;how the Swiss company Graettner could be guided nearer to the Crypto AG or could even be incorporated with the Crypto AG.&#8221; Additionally the service considered, how &#8220;the Swedish company Ericsson could be influenced through Siemens to terminate its own cryptographic business.&#8221;</p>
<p>So in 1970, the german secret service BND was not  content with owning the major shares, employing the management and directing the engineers of One major crypto hardware company.</p>
<p>It also wanted to merge the crypto department of large companys like Ericcsson, a large phone company, into its fake corporation. They were, in early 1970, only content if all crypto hardware in the world is sold by BND or their partners. Motorola was &#8220;advised&#8221; from the same NSA agents than the engineers of the BND fake company.</p>
<p>One Openssl developers has it only 20 minutes from where he lives with the suburb train to Pullach, the BND headquaters. The ticket for that costs 2 Euro.</p>
<p>If the BND even considered buying the crypto department of Ericcsson, just for gaining control over the worldwide encryption market, it would be almost like a wonder to assume that given the marketshare of Openssl, its developer, living near BND headquaters, was not approached by the agents, if only for his expertise and consultancy.</p>
<p>So the Openssl developers certainly were approached by secret services. This is out of question.</p>
<p>The question is how they reacted.</p>
<p>But with that:</p>
<p><a href="http://en.wikipedia.org/wiki/OpenSSL#History_of_the_OpenSSL_project" rel="nofollow ugc">http://en.wikipedia.org/wiki/OpenSSL#History_of_the_OpenSSL_project</a></p>
<p>Steve Marquess, a former military consultant in Maryland started the foundation for donations and consultancy contracts and garnered sponsorship from the United States Department of Homeland Security and the United States Department of Defense.[2]</p>
<p>It is clear.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224186">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224186">
						June 7, 2014 8:30 AM					</a>

				</p>

				<p>@Mike</p>
<p>The bad thing about reality: It doesn&#8217;t care for what we &#8220;suspect&#8221;, &#8220;think&#8221;, &#8220;assume&#8221;, it&#8217;s simply out there and does what it does&#8230; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224187">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224187">
						June 7, 2014 10:04 AM					</a>

				</p>

				<p>keiner: I am with you there.<br />
Re OpenSSL: I agree, there is compelling evidence that the EC rng support was added due to government coercion/pressure/etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224188">

			<div class="comment by-sasparilla ">

				<p class="commentcredit">

					<span class="commenter">Sasparilla</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224188">
						June 7, 2014 10:05 AM					</a>

				</p>

				<p>In light of the conversation on OpenSSL there&#8217;s this great quote from the article at the Register the other day:<b></b><b></p>
<p>&#8220;In one of the most alarming slideshows, NSA&#8217;s successes in smashing basic general internet cryptography security is described in classic style as &#8220;improving security&#8221;. NSA&#8217;s project BULLRUN was described thus:</b><b></b><b></p>
<p>For the past decade, NSA has led an aggressive, multipronged effort to break widely used Internet encryption technologies &#8230; Cryptanalytic capabilities are now coming online. Vast amounts of encrypted Internet data which have up till now been discarded are now exploitable. Major new processing systems &#8230; must be put in place to capitalise on this opportunity.&#8221;</b><b></b><b></p>
<p>Makes you wonder what technologies these are?  </b><b></b><b></p>
<p>(best review of one year since Snowden article I&#8217;ve seen so far):  </b><b></b><b></p>
<p><a href="http://www.theregister.co.uk/2014/06/05/how_the_interenet_was_broken/" rel="nofollow ugc">http://www.theregister.co.uk/2014/06/05/how_the_interenet_was_broken/</a></b></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224190">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224190">
						June 7, 2014 10:58 AM					</a>

				</p>

				<p>@Alex,</p>
<blockquote><p>I have no doubt that NSA has a list with every person posting here</p></blockquote>
<p>You see the first link, under Blog Menu? It&#8217;s labeled &#8220;Archives by Date&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224191">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224191">
						June 7, 2014 11:02 AM					</a>

				</p>

				<p>Shout out here to anyone with the bandwidth and server resources to host what I hope will be a viable replacement for the MIT style PGP servers. Backwards compatible with them, but with a newly fangled API for access to keys and key sychronization &#8211; it will hopefully provide a much more relevant search response and could be used by mail programs to further streamline the key acquisition process. If anyone is interested, please check out my blog &#8211; my key is on there and the email embedded within is watched.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224192">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224192">
						June 7, 2014 11:14 AM					</a>

				</p>

				<p>@ Sasparilla</p>
<p>Thank you for that link! The list of countries is invaluable. It shows some surprises. Example: many factors made me concerned about Switzerland&#8217;s level of cooperation, while I was thinking countries like Finland might be helpful in anti-NSA efforts. Then, the list shows Finland supports the SIGINT efforts, but Switzerland doesn&#8217;t. Oh, how The Game never ceases to surprise me&#8230;</p>
<p>I was still betting on Switzerland for a few things. Good to see they&#8217;re resisting SIGINT. Iceland I&#8217;ve promoted, although I can see how this might change later. Good to see the Irish are holding out. In retrospect, it shouldn&#8217;t be too surprising as corporations have been using Ireland to dodge governments&#8217; wishes for a while now. The other two are too small for me to be sure they&#8217;ll last or still are resisting since those documents were published.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224193">

			<div class="comment by-robert-in-san-diego ">

				<p class="commentcredit">

					<span class="commenter">Robert in San Diego</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224193">
						June 7, 2014 11:34 AM					</a>

				</p>

				<p><b>Chess Life</b> has an interesting article about detecting cheating with statistics. They left the article outside their paywall.</p>
<p>Link/URL:<br />
<a href="http://www.uschess.org/content/view/12677/141/" rel="nofollow ugc">http://www.uschess.org/content/view/12677/141/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224194">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224194">
						June 7, 2014 11:38 AM					</a>

				</p>

				<p>@ Mike</p>
<p>I still think your should change your policy about never receiving unencrypted mail. There are many people without high assurance workstations (the 99.999%?) who are likely compromised at endpoint anyway. The spooks will be able to read the messages if they want with little more than a few clicks and keystrokes (eg QUANTUM). Many good developers are also relatively open about what they do and aren&#8217;t located in U.S. Even those that might use PGP might not care to open the dialog that way, hoping you prove you&#8217;re worth the trouble first.</p>
<p>I&#8217;m posting this here so anyone else with a blog notices the point. I think forcing a cumbersome process on any potential correspondent will just chase off plenty good ones. Best route, imho, is to encourage use of encryption on contact page and provide links with super-easy instructions on doing that. Maybe even a pre-built binary for worst case where that&#8217;s better than nothing. If we&#8217;ve learned anything in a decade, forcing a manual process doesn&#8217;t work out well.</p>
<p>Note: Anyone running the site on a computer you think you can protect physically and logically is best off hosting an online secure contact page. The system should be SSL protected by a non-Five-Eyes country&#8217;s CA with a good configuration. The communications app takes the input, sanitizes it, converts it to a usable format (w/ IP/port/timestamp), encrypts it with your public key, deletes original, and then stores/forwards it for later reading. It&#8217;s a nice compromise that lets users send you protected mail without knowing PGP, etc. Best if it&#8217;s a standalone app written in safest language/style you know which web server merely forwards HTTP to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224195">

			<div class="comment by-herman ">

				<p class="commentcredit">

					<span class="commenter">Herman</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224195">
						June 7, 2014 12:23 PM					</a>

				</p>

				<p>The latest compromise found in OpenSSL is not a backdoor by itself, but it provides a great DIY Kit to subvert the system and it is conveniently built right into the Windows software API: <a href="http://www.openbsd.org/papers/bsdcan14-libressl/mgp00025.html" rel="nofollow ugc">http://www.openbsd.org/papers/bsdcan14-libressl/mgp00025.html</a></p>
<p>OpenSSL should not be lightly discarded, it should be thrown, with great force and the programmers who are responsible for subverting it cannot be trusted ever again.</p>
<p>OpenBSD needs your support to reconstruct this crucial piece of security software the right way &#8211; please donate: <a href="http://www.openbsdfoundation.org/donations.html" rel="nofollow ugc">http://www.openbsdfoundation.org/donations.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224196">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224196">
						June 7, 2014 12:29 PM					</a>

				</p>

				<p>Nick: I agree with you in principle. Perhaps I should at the very least provide a page with some instructions on how to grab a free TLS certificate from one of the many CAs that offer it and install it into their browser so that they can at least send me a S/MIME encrypted email? The learning curve for SMIME is a lot less than that for PGP, which is often not integrated. I agree it is a barrier to entry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224197">

			<div class="comment by-leon-wolfeson ">

				<p class="commentcredit">

					<span class="commenter">Leon Wolfeson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224197">
						June 7, 2014 1:10 PM					</a>

				</p>

				<p>Herman &#8211; Say, you know the time period when OpenBSD was DARPA funded? Among other things. And everyone &#8220;knows&#8221; that the core devs do security audits, etc.</p>
<p>If you start drawing lines, you rule out a LOT of software.</p>
<p>(To be clear, I don&#8217;t believe in the conspiracies)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224198">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224198">
						June 7, 2014 2:38 PM					</a>

				</p>

				<p>@Nick P</p>
<p>Re the SigInt partners table in The Register, I wonder why no South American country is listed there. Not even Mexico.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224199">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224199">
						June 7, 2014 4:09 PM					</a>

				</p>

				<p>@ Wael</p>
<p><i>&#8220;The first two are not unique to &#8220;C&#8221;, wouldn&#8217;t you agree? The last one is debatable.&#8221;</i></p>
<p>Whether these features are unique to C or not that doesn&#8217;t matter. What matters is that C has these features. And therefore C is not a safe language.</p>
<p>About OpenSSL:</p>
<p>The construction of both the FIPS consulting firm and the open source library makes it fishy. I wouldn&#8217;t be surprised if they deliberately obscured the code for &#8220;job security&#8221;.</p>
<p>@ Benni</p>
<p>Thanks for the reply. It is a good summation of the pain points of OpenSSL. I am still digesting all the information 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224200">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224200">
						June 7, 2014 4:59 PM					</a>

				</p>

				<p>Wow!! This does indeed seem to be quite an important development in quantum computing&#8230;</p>
<blockquote><p><b>Electrical control of nuclear spin qubits: Important step towards quantum computers</b> (<i>June 6, 2014</i>)</p></blockquote>
<blockquote><p>To integrate nuclear spin-based qubits into electronic circuits and specifically trigger novel information processes, specific electric manipulation of nuclear spins is required. A team of scientists of the KIT and the Centre National de la Recherche Scientifique (CNRS) in Grenoble and Strasbourg recently succeeded for the first time in manipulating a single nuclear spin in a purely electric manner. &#8220;Use of electric instead of magnetic fields paves the way to addressing quantum states in conventional electronic circuits,&#8221; explains Professor Mario Ruben, Head of the Molecular Materials Research Group of KIT&#8217;s Institute of Nanotechnology (INT). &#8220;There, quantum states can be manipulated specifically by so-called displacement currents. Then, they can be directly read out electronically.&#8221;</p></blockquote>
<blockquote><p><a href="http://www.sciencedaily.com/releases/2014/06/140606091423.htm" rel="nofollow ugc">http://www.sciencedaily.com/releases/2014/06/140606091423.htm</a></p></blockquote>
<p>What was that about the NSA not being made of magic..? Perhaps they should get in touch with some persons of interest at the Karlsruhe Institute of Technology in Germany&#8230; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224201">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224201">
						June 7, 2014 5:02 PM					</a>

				</p>

				<p>@ Gerard van Vooren,</p>
<blockquote><p>Whether these features are unique to C or not that doesn&#8217;t matter. What matters is that C has these features. And therefore C is not a safe language.</p></blockquote>
<p>Good point! But some of the bugs you listed are logical bugs caused by the &#8220;programmer&#8221; rather than the &#8220;language&#8221;, such as the two goto statements in a row. This is &#8220;language&#8221; independent. Regarding the &#8220;goto&#8221; statement, maybe &#8220;C&#8221; makes it easy for a programmer to make such a mistake, and the syntax will have to be improved in a more &#8220;secure&#8221; language to prevent this sort of error.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224202">

			<div class="comment by-we-are-being-bred-for-slavery ">

				<p class="commentcredit">

					<span class="commenter">We are being bred for slavery</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224202">
						June 7, 2014 6:00 PM					</a>

				</p>

				<p><b>They are dismantling the sleeping middle class. More and more people are becoming poor. We are their cattle. We are being bred for slavery. </b></p>
<p><i>They are dismantling the sleeping middle class. More and more people are becoming poor. We are their cattle. We are being bred for slavery.</i></p>
<blockquote><p>They are dismantling the sleeping middle class. More and more people are becoming poor. We are their cattle. We are being bred for slavery.</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224203">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224203">
						June 7, 2014 6:31 PM					</a>

				</p>

				<p>@We are being bred for slavery</p>
<p>Awww how quaint&#8230; 😉<br />
Is that little post a feeler for testing the angst of any other commenters here?</p>
<p>Sorry if you&#8217;re being super serious, and I&#8217;m out of line, but I do think you may get along well with @Jarda on &#8220;Chinese Hacking of the US&#8221; over at: <a href="https://www.schneier.com/blog/archives/2014/06/chinese_hacking_1.html#c6477792" rel="nofollow ugc">https://www.schneier.com/blog/archives/2014/06/chinese_hacking_1.html#c6477792</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224204">

			<div class="comment by-octome ">

				<p class="commentcredit">

					<span class="commenter">OctoMe</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224204">
						June 7, 2014 7:00 PM					</a>

				</p>

				<p>Has there been a discussion on the Firefox/Chrome safebrowsing<br />
feature (turned on by default) which sends any url you type to Google to check for malware? Do the benefits outweigh the privacy risk here?</p>
<p><a href="http://beta.slashdot.org/submission/1047147/googles-safe-browsing-could-compromise-privacy" rel="nofollow ugc">http://beta.slashdot.org/submission/1047147/googles-safe-browsing-could-compromise-privacy</a></p>
<p>looks scary !!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224205">

			<div class="comment by-unamerican ">

				<p class="commentcredit">

					<span class="commenter">unamerican</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224205">
						June 7, 2014 7:06 PM					</a>

				</p>

				<p>Meta: in re controversy on a previous thread related to Skeptical and Mr. Pragma. I would suggest that Skeptical produces a quality of speech much more dangerous and offensive than that of Mr. Pragma. The greater danger is offensively calculated pro-neoliberal/capitalist/fascist, authoritarian, statist, putatively &#8216;democratic&#8217; propaganda. I would urge readers going forward to examine the Skeptical narrative as prima facie evidence of a sophisticated (but not too sophisticated) military intelligence disinformation operation designed to co-opt dissent and distract from honest discussion of paramount issues of individual liberty and social justice. And to engage with the Skeptical identity only as an experiment in tactics to defeat that identity&#8217;s agenda generally in all venues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224206">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224206">
						June 7, 2014 7:15 PM					</a>

				</p>

				<p>OctoMe: not only that, but many browsers now have OCSP certificate revocation lookups enabled by default, effectively providing who-ever runs the CRL server with a list of SSLized sites visited. It is a slow and slippery slope, and unfortunately I believe that we (those who value privacy by default) are losing the war.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224207">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224207">
						June 7, 2014 7:22 PM					</a>

				</p>

				<p>Clive Robinson (if you are watching): you&#8217;ll be pleased to know that I successfully created and tested an EMSEC &#8216;validation device&#8217; against an MSI 15&#8243; LCD laptop approximately fifteen feet away, separated by a single drywall. Sufficient contrast was available for the trained eye to observe the actions on the device. When we redoubled our efforts and developed a hand wire-wrapped directional antenna and aimed at what we believed was not the display but the notebook itself the results improved &#8211; we had a decent picture. It goes to show just how pathetic consumer laptops are against electromagnetic surveillance. We have more things planned for our little device, including perhaps some construction plans (ours is fancy only in that it has DSP to &#8216;clean&#8217; up the received signal). That&#8217;s if we don&#8217;t get &#8220;disappeared&#8221; first.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224209">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224209">
						June 7, 2014 7:48 PM					</a>

				</p>

				<p>@Hermann:<br />
&#8220;right into the Windows software API:&#8221;</p>
<p>No, You cite a slide with the function I refered to in my earlier postings. According to the comments of the openbsd developers to which I linked above, it actually is not only built in the OpenSSL Windows API. It unconditionally compiles for EVERY platform, says the openbsd commenter.</p>
<p>I think Andy Polyakov who wrote this function into Openssl has a good way to prove that he is not an agent. Once he had learned that this function could be used by hackers, he could have and should have simply delete this thing out from Openssl.</p>
<p>But he has not done that yet. You can guess why&#8230;.</p>
<p>What is somewhat troublesome is the code comment trying to explain why he wrote this function:</p>
<p>&#8220;It would come handy if you do not know the callinc convention stdcall or cdecl of a function&#8221;.</p>
<p>What nonsense. If you do not have the function header, where the calling convention is defined, you do not call that function. Its as simply as that.</p>
<p>Except if you are a hacker who wants to call some stuff illegaly and put some wrong data into there circumventing the ordinary compiler rules of a programming language, in order to see what happens then. So in some way the code comment indicates that this function was deliberately written for hackers wanting to subvert the system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224212">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224212">
						June 7, 2014 8:27 PM					</a>

				</p>

				<p>@ Mike the Goat,</p>
<p>Insomnia is yet again playing it&#8217;s little game with me, so yes I&#8217;m casting a bleary weary eye in this direction at the moment whilst waiting for the inevitable to happen around five minutes befor the alarm clock (I&#8217;m not being helped by a bunch of rutting cats in the garden and thoughts of cross hairs keep crossing my mind 😉</p>
<p>I must admit I&#8217;m far from surprised at your results, as I&#8217;ve said on the odd occasion before, to save money they find inventive ways to meet the EMC masks of the FCC or European CE rather than removing the actual radiated energy (check the BIOS for a spread spectrum setting etc).</p>
<p>Now I don&#8217;t know what equipment you have available to you, but with a decent spectrum analyser and a suitable output power signal source, you could try a HIJACK or TEAPOT attack.</p>
<p>Put simply you run the signal source into a directional antenna (say LDPA) pointed at the lap top and with the spectrum analyser in zero span mode (signal demod and display) connected to another antenna check and see if you can get data to cross modulate onto the sig gen frequency or on one of it&#8217;s odd harmonics. You might easily be able to extend your range out beyond 50meters&#8230;</p>
<p>There are other tricks you can try depending on what you want to get at, for instance rather than just the display get the keyboard scan/output to capture passwords/phrases etc&#8230;</p>
<p>If you have basic EMC test equipment you might be very shockd at what you can do, even without agumentation via broad band RF amps for both RX&amp;TX.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224213">

			<div class="comment by-jean-meslier ">

				<p class="commentcredit">

					<span class="commenter">Jean Meslier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224213">
						June 7, 2014 8:38 PM					</a>

				</p>

				<p>Layperson here wondering what you security gurus think about the future potential of wireless ad hoc networks like Firechat to get away from the octopus. Get a secure device, crypto your message, break it up into different packets that must find different routes&#8230; is there hope?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224214">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224214">
						June 7, 2014 8:59 PM					</a>

				</p>

				<p>@Jean Meslier,</p>
<blockquote><p> is there hope?</p></blockquote>
<p>Only superficially! Firechat, as far as I know, sends the whole payload to a device. It doesn&#8217;t break up a message into multiple packets that must go through different routes. Assuming we have control on the routes and the packet distribution among routes, there will be some requirements that have to be met to &#8220;enhance&#8221; the privacy, and this is just scratching the surface&#8230;<br />
1- Your device &#8220;must be assumed to be secure&#8221;, un-tamered with, and doesn&#8217;t have other components that relay the message elsewhere &#8212; real time, or otherwise<br />
2- You&#8217;ll have to have some assurance that there is no &#8220;crypto&#8221; functionality &#8220;deliberate degradation&#8221; on your device<br />
3- Assurances that the packet went through different (and maybe trusted routes) &#8212; some routes could be compromised or &#8220;controlled&#8221;<br />
But if designed well, I think it raises the barrier a couple of notches. If it&#8217;s not well-designed, it&#8217;ll reduce the &#8220;security&#8221; posture of the solution for the simple reason that the surface of attack has been expanded &#8212; a side effect of added complexity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224215">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224215">
						June 7, 2014 9:15 PM					</a>

				</p>

				<p>There has been much talk about using crypto to defend here and it&#8217;s a good idea. There&#8217;s something I feel we left untouched during so much discussions which is the Rubberhose cryptanalysis. So far I don&#8217;t see a working defense against Rubberhose cryptanalysis and Julain Assange&#8217;s RubberhoseFS is not maintained anymore.</p>
<p>@Jean Miller<br />
Our electronic data is sadly very very vulnerable. You can grab monitor screens via directional antenna, you can subvert crypto, software or hardware, you can use human engineering, you can do so much against someone to get at their data. What we can do is just try our best to delay attacks. Nothing last forever. Properly implemented crypto with proper libraries and software, use a trusted hardware with electronic warfare shielding and tamper evident sealing. Self-destruct devices (lots of people overlook this one) with RubberhoseFS (another feature people usually miss out) would be great.</p>
<p>Here&#8217;s my design for a RubberhoseFS with possible self-destructing capabilities. Segment data into blocks and blocks can be encrypted with any key and algorithm. Fix length blocks to be more specific. Extra spaces in blocks to be appended behind in random bits or bytes depending on what you want to use. Segment your data profiles into multiple layers using multiple keys and algorithms. Choose one or two profiles to have the hard-kill command embedded so once you give away your keys to unsuspecting people who attempt to decrypt your RFS without proper acquisition techniques, it&#8217;s going to self-destruct the data. In case they have a backup already, of course dont expose the self-destruct keys but give the keys to other profiles that are plausibly designed (if you are good at faking profiles). For the rest of the blocks of data, point out the fact that the RFS randomly sprinkles random blocks of data so you have no keys to the rest and they have to work hard.</p>
<p>Of course, if you give them the keys honestly, they will not let you off the hook and if you give them the wrong keys they will also not let you off the hook so might as well face the fact that you are now a captive of theirs and just give them wrong keys. Oh, maybe you can embed tiny executables and bugs into other portions of the RFS and give them those wrong keys so when they decrypt and attempt to run it, those exploits you have encrypted would be nice to rampage around their system if they attempted decryption on their secure environment.</p>
<p>That RFS above might cover up for the lack of discussion on the design of RFS here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224216">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224216">
						June 7, 2014 9:29 PM					</a>

				</p>

				<p>@Jacob</p>
<p>Given the topics here, the fact that it&#8217;s Bruce Schneier&#8217;s blog and most of are clearly anti-NSA, I&#8217;m sure they do. Especially given the professions most of us here have (e.g. anyone remember the document that was titled &#8220;I Hunt Sysadmins&#8221;?). It&#8217;s not going to affect what I say. I won&#8217;t self-censor. Freedom of speech is our God-given right enshrined in the constitution. It&#8217;s at the core of Democracy. I&#8217;d honestly rather die than let them do that. It simply disgusts me that we&#8217;ve gotten to the point where we have to discuss this. It&#8217;s seems like this is becoming an authoritarian government.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224217">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224217">
						June 7, 2014 9:31 PM					</a>

				</p>

				<p>Honest and open speech and conversastion are the basis and requirements for an open and democratic society. Sadly most &#8220;democratic society&#8221; are undemocratic due to Government interference.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224218">

			<div class="comment by-sasparilla ">

				<p class="commentcredit">

					<span class="commenter">Sasparilla</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224218">
						June 7, 2014 9:50 PM					</a>

				</p>

				<p>@Jacob <b></b><b></p>
<p>&#8220;Re the SigInt partners table in The Register, I wonder why no South American country is listed there. Not even Mexico.&#8221; </b><b></b><b></p>
<p>Seems pretty obvious, its not because those govts all said &#8220;No way&#8221;, I&#8217;m sure its because the document listing partners/targets for South/Central/lower North America hasn&#8217;t been released or wasn&#8217;t recovered.</b></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224219">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224219">
						June 7, 2014 11:26 PM					</a>

				</p>

				<p>@ Leon</p>
<p>Always remember about funding that there isn&#8217;t <em>one</em> U.S. government. It&#8217;s a bunch of different groups with competiting interests collectively called U.S. govt. Tor has been funded by NSF for quite a while. Leaked slides indicate it&#8217;s giving NSA plenty problems as of 2012. So, obviously funding != backdoors or even weakness. Quite a few groups in government fund plenty of good work in INFOSEC for their own use, but release papers or prototypes to public. It&#8217;s the dual nature of US govt.</p>
<p>The thing is, though, that all code and protections should be treated guilty until proven innocent. Sponsored, government, FOSS&#8230; any must be reviewed for intentional or accidental vulnerabilities. So long as it&#8217;s well documented, it doesn&#8217;t matter where it came from. It will be vetted like anything else. OpenBSD, Tor, NSF&#8217;s many grants, DARPA CRASH projects&#8230; the government&#8217;s had a hand in many tools that can protect freedom in the right hands. Assuming they&#8217;re properly vetted, transmitted, installed, configured, and maintained. &#8220;Because that&#8217;s where they get you.&#8221; 😉</p>
<p>@ Jacob</p>
<p>That&#8217;s worth noting. The other comment suggested it&#8217;s on another list. That might be true. A lesser explanation is that we&#8217;ve angered so many of them with covert operations that they don&#8217;t trust wholesale taps of their fibers. That would depend heavily on the country, though. Some are allies, even with military agreements. Others are distrustful or outright opponents. My money is on there being no <em>willing</em> SIGINT taps in Venezuela, Brazil, or Argentina, for example. 😉</p>
<p>@ Gerard van Vooren</p>
<p>Take a look at this low-level language project I found. It&#8217;s actually from 2005, but has comparisons against Cyclone and SFI:</p>
<p>Cuckoo &#8211; a language for implementing memory- and thread-safe system services<br />
<a href="http://www.flux.utah.edu/download?uid=89" rel="nofollow ugc">http://www.flux.utah.edu/download?uid=89</a></p>
<p>@ Mike the goat</p>
<p>re EMSEC attack</p>
<p>It&#8217;s interesting that you know how to do that. Few do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224220">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224220">
						June 7, 2014 11:37 PM					</a>

				</p>

				<p>@ Jean Meslier</p>
<p>First idea that comes to my mind requires no technical skill at all: dead drops and brush passes. The classic ways spies exchanged information. The idea was that it was local, physical, and hard to observe. I&#8217;ve heard years ago that bluetooth-type tech was already used for a modern brush pass without physical contact or briefcases changing hands. The signal was weak enough to reduce odds of detection. The modern version of dead drops is pretty much stegonagraphy, anonymous email/storage/hosting, etc. More detectable than the real thing.</p>
<p>I could see a peer-to-peer (P2P), mobile technology being used to do similar stuff. Making it a local or P2P phenomenon should reduce effectiveness of dragnet surveillance. One could further reduce effect of traffic analysis by using anonymous relay technology similar to Tor, I2P, or Freenet. Further, darknet (friends-only network) approach could be used for groups by having a shared password and even a maximum range in signal strength or hops.</p>
<p>So, I think there&#8217;s potential in that type of stuff. It&#8217;s just potential that will take time to understand both in theory and practice. Old school tradecraft is still more effective at dealing with an electronics loving spy organization, as various groups have been showing NSA over the years. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224221">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224221">
						June 8, 2014 12:55 AM					</a>

				</p>

				<p>Mike the goat RE: LCD TEMPEST &#8220;security&#8221;<br />
&#8211;Thought you could sneak a radio post past me, eh?  Those horns are busy, I always assumed you were letting the world know when you had a boner or some such thing. :p  And here I am stuck reinstalling windows, drivers, and wiping harddrives&#8230;But I got these old PC&#8217;s and their power supplies &#8220;blown out&#8221; (they were dusty) today and getting ready for a couple digital radio stations (only problem is I can&#8217;t put up antennas how I want b/c of stupid neighbors).  Neat, but prefer countermeasures and I&#8217;ve thought of trying some of these attacks on real targets&#8230;like my school.  They have a testing center and I wonder if it&#8217;s shielded (the doors are clear glass).  They&#8217;ve f<em>cked up before like letting students print test results from the testing center&#8230;Then had us &#8220;sign a paper&#8221; saying we won&#8217;t do it, why don&#8217;t they f</em>cking pull the network access there?!  But you need to shrink the POC down to something you can carry mobile unless you just don&#8217;t give a what.  Maybe before I&#8217;m done w/ school, I could get the IT dept. to let me do a Bluetooth logger for all the kiddo&#8217;s smartphones (which they won&#8217;t even touch default bluetooth settings), just to show people just how easy it is just sniff data&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224222">

			<div class="comment by-tal-beery ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.linkedin.com/in/talbeery' rel='external nofollow ugc' class='url'>Tal Be&#039;ery</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224222">
						June 8, 2014 1:48 AM					</a>

				</p>

				<p>What do you think about the recent publications on &#8220;Cyber Warfare Strategy&#8221; drawing from the military strategy knowledge? Do you find the analogy of the cyber battlefield to the real world one viable?</p>
<p>Some examples<br />
<a href="http://www.brookings.edu/research/papers/2014/05/07-strategy-not-speed-digital-defenders-early-cybersecurity-thinkers-bejtlich" rel="nofollow ugc">http://www.brookings.edu/research/papers/2014/05/07-strategy-not-speed-digital-defenders-early-cybersecurity-thinkers-bejtlich</a></p>
<p>and</p>
<p><a href="http://www.securityweek.com/how-can-cyber-defenders-regain-advantage" rel="nofollow ugc">http://www.securityweek.com/how-can-cyber-defenders-regain-advantage</a> (by yours truly)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224223">

			<div class="comment by-koita-nehaloti ">

				<p class="commentcredit">

					<span class="commenter">koita nehaloti</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224223">
						June 8, 2014 2:40 AM					</a>

				</p>

				<p>Taliban video showing the release of Army Sergeant Bowe Bergdahl :</p>
<p><a href="https://www.youtube.com/watch?v=H0_eMLM5DD8" rel="nofollow ugc">https://www.youtube.com/watch?v=H0_eMLM5DD8</a></p>
<p>The actual release is on about 6:40</p>
<p>This story is partly about trust. How it was possible for the 2 sides to gain enough trust to do what they did in the video?</p>
<p>I would have guessed that Bergdahl would walk 300 meters alone to a spot where helicopter would land, but no. It is surprising how the sides did meet.</p>
<p>This story may also be about communication? Did taliban and nato communicate with old analog 2 way radio format using coded language to hide from 3rd party gunmen? Did they communicate via internet at some point?</p>
<p>Are the special forces delta force?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224224">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224224">
						June 8, 2014 4:25 AM					</a>

				</p>

				<p>&#8216;WASHINGTON &#8211; Edward Snowden does not appear to have taken as much as originally thought from NSA files, The Washington Post reported late Thursday.</p>
<p>The damage is still &#8220;profound&#8221; from the former NSA contractor who blew the cover on vast US surveillance programs of everything from everyday people&#8217;s phone calls to intrusions into high-tech companies&#8217; servers, Director of National Intelligence James Clapper said, according to the Post.</p>
<p>Still, &#8220;it doesn&#8217;t look like he took as much&#8221; as first thought, Clapper was quoted as saying in what the Post called a rare interview Tuesday.</p>
<p>&#8220;We&#8217;re still investigating, but we think that a lot of what he looked at, he couldn&#8217;t pull down,&#8221; Clapper said. &#8220;Some things we thought he got he apparently didn&#8217;t,&#8221; the director was quoted as saying. &#8216;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224225">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224225">
						June 8, 2014 6:39 AM					</a>

				</p>

				<p>Clive: I am surprised that this hasn&#8217;t been brought up as a major issue and mitigated. For example, I found that there was pretty much an omnidirectional emanation from the laptop. I would have expected them to at least be partially shielded. I guess it depends on the vendor too &#8211; I have broken apart laptops with thick conductive foil backings that sit behind the LCD display. Then again, a lot of vendors are putting their wireless antennas up near the webcam areas of the screen now and I guess they don&#8217;t care too much about it anyway.</p>
<p>Obtaining emanations from the keyboard interests me greatly. I have an SDR and was hoping of using it, along with some kind of directional antenna and input amp to obtain data from the keyboard controller but I think at the distance we are talking about acoustic pickup via a directional mike &#8220;gun&#8221; would be more productive.</p>
<p>What really gets me is that it appears that the bulk of the signal leaks from the LVDS cable from the mobo of the laptop and the LCD, and the LCD controller board itself. It would appear to be relatively easy to mitigate, but hell even having some kind of encryption on the signal would render these attacks useless. Perhaps on first power on it can negotiate a key (assuming first power on is done in a secure location away from prying/EM listening eyes this should suffice) &#8211; or just do something like HDCP (except without the compromised keys ;-). I guess the simplicity of doing LVDS signalling bit them in the ass.</p>
<p>Nick: all the information is pretty much public domain. This is why it surprises me why the govt seems so damn scared of any information on EMSEC.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224226">

			<div class="comment by-unimportant ">

				<p class="commentcredit">

					<span class="commenter">unimportant</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224226">
						June 8, 2014 7:17 AM					</a>

				</p>

				<p>@Jacob: Which thing do you mean?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224227">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224227">
						June 8, 2014 7:32 AM					</a>

				</p>

				<p>@unimportant</p>
<p>If you refer to &#8220;to see if there are things of interest.&#8221;, then I can think of various things:</p>
<ul>
<li>security / crypto development and discussion<br />
(e.g. internal business discussion about methods and vulnerabilities of specific products)</li>
<li>internal documents held by members of a security apparatus of foreign govs</li>
<li>Remote management related passwords (e.g. if you are a sys admin &#8211; or even a user &#8211; and use your home computer to remote access your place of work). </li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224228">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224228">
						June 8, 2014 8:36 AM					</a>

				</p>

				<p>Ooh&#8230; By the way Nick, I am almost finished the RFC for blogsig.</p>
<p>In another unrelated project &#8211; remember when we were all complaining about ipv6 and what a failure it has been, and I spoke out saying what I would have done as an interim solution and called it ipv4.1. Turns out I figured I best put my money where my mouth is. I initially assumed it would be a five second job and a ten line diff to an existing ipv4 stack but the Linux stack is way complicated and changing the size of ipv4 addresses causes problems downstream with things like netfilter. So I have instead been playing with minix3 &#8211; which is convenient as the tcpip stack is in userspace so testing is pretty straightforward. I hope to have a few different systems &#8211; perhaps two MINIX VMs and three DOS/wacom stack machines in a test network shortly. Not to seriously propose any real alternative but more just to put my money where my mouth is and show it can be trivially accomplished.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224229">

			<div class="comment by-incredulous ">

				<p class="commentcredit">

					<span class="commenter">Incredulous</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224229">
						June 8, 2014 9:15 AM					</a>

				</p>

				<p>@Jacob</p>
<p>&#8220;If you&#8217;re launching from a bookmark&#8211;red alert. And if your using passive tools to scrap content&#8211;they&#8217;re parked outside in a black van.&#8221;</p>
<p>Could you elaborate?  How could a clean bookmark to schneier.com be a problem?  How can you scrape with passive tools?  I use scrapbook on firefox, but it sends actually requests, so it is not passive.  Do you mean a scraper that collects data as I browse manually?  How would passive scraping be detected?</p>
<p>Thanks.  It is nice to hear that some of my concerns on the EPIC thread are shared.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224230">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224230">
						June 8, 2014 9:50 AM					</a>

				</p>

				<p>@Incredulous</p>
<p>That quote you cited was written by<br />
name.withheld.for.obvious.reasons</p>
<p>I have no idea what he/she meant by that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224231">

			<div class="comment by-im-going-to-be-put-on-a-watchlist-amnt-i ">

				<p class="commentcredit">

					<span class="commenter">I&#039;m going to be put on a watchlist, amn&#039;t I?</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224231">
						June 8, 2014 9:58 AM					</a>

				</p>

				<p>Hey fellas, I was planning to post this on the previous week but I forgot about it. Anyway, we all know the NSA has been subtley collecting massive amounts of data and even went to crazy extremes. (On the other hand, it&#8217;s not that hard to affect 13 year olds, and when combined with America&#8217;s emphasis on &#8220;Individuality&#8221; is actually a pretty smart plan that&#8217;s likely to have a good success:failure ratio.)</p>
<p>But I was thinking, does the NSA having your data actually makes you less suspicious? Say, like, you have a Facebook, Youtube, Whatsapp accounts, and other &#8220;popular&#8221; services. You&#8217;re basically blending in. You&#8217;re not setting off an alarm. I&#8217;m probably missing something, because just now I thought about facial recognition, but by the time you&#8217;re being facially scanned is probably the same time you already have your mobile phone on you being scared to death your battery won&#8217;t run out because you get instant updates from your 10+ accounts or whatever. On a different note I do wonder how many people who frequent Bruce&#8217;s blog actually have a facebook account, or maybe even more? 🙂</p>
<p>On the other hand, does lacking all of these actually put you in the clear? Sure, you might not be a criminal, but what&#8217;s the reason you really don&#8217;t have 10+ accounts constantly drowning you in updates to your mobile phone?</p>
<p>A more simple way to this would be I presume signal and noise. Noise is basically everywhere, but you probably want the signal, right? Or does the NSA want both? Is the NSA&#8217;s plan is to get security to absurdity?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224232">

			<div class="comment by-koita-nehaloti ">

				<p class="commentcredit">

					<span class="commenter">koita nehaloti</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224232">
						June 8, 2014 10:41 AM					</a>

				</p>

				<p>Getting hashes for Linux distribution .iso s or getting public keys of the distro disseminators is really confusing and feels risky. Even when Linux is installed, adding more repositories in some distros gives even more confusing question about &#8220;do you trust this public key fingerprint? &#8221; (actual wording may be something scarier than that) This kind of question may scare many people and organizations off from Linux.</p>
<p>Could we have more trust-inducing way to verify operating system ISOs etc.?</p>
<p>Some copy pasting from a tor hidden service (&#8220;torchan&#8221;):</p>
<p>&#8221;<br />
Secure way to distribute hashes</p>
<p>We need a system to distribute a weekly or daily big packet of hashes (sha512) of important software and Linux distributions, public keys of people, websites and organizations and possibly even hashes of parts of bitcoin and litecoin etc. block chain. SHA512 hash of that packet itself will be disseminated by various of-band methods, like data transmissions in 100 megahertz to 100 kilohertz radio, text-tv, paid ads in paper newspapers and within satellite radio data transmission.</p>
<p>Radio is special, because the bigger the wavelength (smaller frequency), the bigger the transmitting antenna needs to be, while the receive antenna size does not grow so much. Submarine VLF antennas can be 300 meters wide with tall poles, but the receiving antenna fits on table(but is heavy with lots of wire rolled). Forging / spoofing those submarine radio sha512 hash transmissions would be extremely expensive and would be noticed worldwide, but using them normally would be cheap for those who already have them.</p>
<p>15 megahertz transmission would be easier to spoof, but it would be noticed in wide area. 15Mhz goes thousands of kilometers by reflecting from ionosphere, and I imagine that a cell phone or usb memory stick sized usb device could receive it with 1-2 meters of wire. I have seen old hand fitting radio that receive it and most of that radio is loudspeaker and other analog-audio-radio related things that are not needed with data when computer can handle all interface via usb.</p>
<p>&#8221;</p>
<p>&#8221;<br />
VLF transmitter</p>
<p><a href="https://en.wikipedia.org/wiki/Very_low_frequency#Antennas" rel="nofollow ugc">https://en.wikipedia.org/wiki/Very_low_frequency#Antennas</a></p>
<p>For distribution of master hashes, much weaker transmitter would be enough.</p>
<p>&#8221;<br />
&#8220;Why can someone not transmit their own hashes on the same frequency?&#8221;</p>
<p>It would be noticed. 2 simultaneous different transmissions would garble each other or if the spoofing transmission is drowning out the real, it probably can be noticed by measuring power levels and comparing them to natural sources (lighting, ionosphere, somewhere in the world), but that is complex question that I don&#8217;t know much about.</p>
<p>With separated real and spoofed transmission:<br />
Know the error margin of your clock, then start waiting for the master hash that time before the announced time, until after same time, and if you got 2 transmissions that are in the master hash format, you know someone is trying to attack someone, and then you know to buy a magazine or newspaper with a small ad containing the master hash, from a random shop.</p>
<p>If military radio intel organizations want any useful function, they should locate the spoofed transmission.</p>
<p>If classified ads section has 2 hashes apparently from the same source, you know there is attack. Newspapers should and probably would be vigilant about their hash printing, and alert police if someone tries to print spoofed hashes. This system is anyway probably worth an article in that same newspaper, so they should know.<br />
&#8220;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224233">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224233">
						June 8, 2014 10:58 AM					</a>

				</p>

				<p>@ Figureitout</p>
<p>You&#8217;re confusing all the benefits of desktop computers with the &#8220;feature&#8221; of power button in front of the knee. I had a problem with only one of these. 😉 The thing is that people wouldn&#8217;t have accidentally shut off their boxes if they had put the button&#8230; anywhere else on the box. lol</p>
<p>@ Mike the Goat</p>
<p>Cool on Blogsig and IPv4.1. Look forward to seeing them done. The Linux implementation being incredibly complex&#8230; Who&#8217;d have thought? I would&#8217;ve suggested a BSD but that&#8217;s what you&#8217;ll be using as MINIX 3 borrows from NetBSD. And DOS? Ok, I didn&#8217;t see that coming.</p>
<p>Btw, what&#8217;s this about PGP keyserver replacement? You going to put that on your blog (didn&#8217;t see it) or just keep in in private correspondence with interested parties?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224234">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224234">
						June 8, 2014 11:02 AM					</a>

				</p>

				<p>@ Mike the Goat,</p>
<blockquote><p>Clive: I am surprised that this hasn&#8217;t been brought up as a major issue and mitigated.</p></blockquote>
<p>It had been brought up as a major issue over and over again in many different places for many different reasons, but almost always totaly ignored by those whos job it is to ensure EMC to FCC or even European CE standards.</p>
<p>The problem is what a test house might see as a transitory blip for EMC certification is actually acceptable providing the energy radiated after a one second normalisation is inside the EMC mask. Further testing of computers etc is done in what amounts to a passive way with no I/O active and no kby entery.</p>
<p>But lets say it does break the mask even after the one second normalisation, it will be looked at only as an EMC Cert failure not as a significant security breach&#8230;</p>
<p>And this is just another variation on the &#8220;free market mantra&#8221; that causes a race for the bottom in required standards and an almost hopless night mare in security.</p>
<p>Because often the solution is worse than the original problem&#8230;</p>
<p>As the designer of the laptop which is an FMCE device your three main tasks are 1, keep marketing happy, 2, meet required market standards, 3, minimise costs as much as possible.</p>
<p>2&amp;3 trade off against each other, that is you want to reduce component cost and production cost in a way that only just meets the electrical safety and EMC requirments.</p>
<p>However whilst HiPot test measurements are generaly not averaged over time EMC measurments frequently are&#8230; thus a third vector to EMC costs arises &#8220;time&#8221;. If you look at the output spectrum of a computer at rest with no EMC components or measures in place, it looks like a broadband noise source, however focus in and you can see it&#8217;s actually a &#8220;comb generator&#8221; of hundreds if not thousands of discreate frequency spurs each with their own amplitude. The majority will be inside the EMC mask but some won&#8217;t. Traditionaly the solution was to add filter components that are large, expensive and add to production costs for no improvment in &#8220;marketing&#8221; functionality. So how to reduce the few problem frequency spurs without adding such components?</p>
<p>Well as I said the spurs are descreate with their own amplitude, if you FM modulate it itwill spread the spur energy across multiple frequencies and as a consiquence bring it&#8217;s amplitude by the ratio of the unmodulated to modulated bandwidth.</p>
<p>So if the chip manufacturer adds some circuitary to the master clock generator inside the chip the cost is virtualy zero to solve the spur amplitude problem. The simplest way to do this is with a Direct Sequence Spread Spectrum modulator which in effect is an XOR gate and a bunch of latches and xor gates aranged as a Linear Feedback Shift Register (LFSR). Quick simple and very low cost.</p>
<p>However the total Eam energy radiated by the device is still the same, it&#8217;s just spread all over the spectrum. Now with coding gains of 20dB easily achivable the reality is the laptop could radiate one hundred times the energy with the DSSS turned on than it could with it off. Greate for the designer as they have meet the EMC requirment without actuall spending any money on filtering components.</p>
<p>BUT&#8230; if the radiated EM is one hundred times greater it has to still go somewhere, and in practice this means that it travels ten times further than if it meet the masks without the DSSS modulator on the master clock.</p>
<p>Now if you happen to know the sequence used by the DSSS modulator then you can demodulate the spurs back to what they originaly would have been. Which is greate because you can evesdrop at ten times the range. But it gets better&#8230; the demodulation process is cohearant only to the transmitted signal you are tracking, all other signals will be spread into the noise floor by the demodulator. Thus you can not hide one computer in amongst many others when the attacker knows the chip sequence&#8230;</p>
<p>So the free market solution to the EMC mask actually makes your privacy/security margin range ten times worse&#8230;</p>
<p>The US Gov know this and have known it since late in WWII though the information was known to telco engineers since WWI or earlier.</p>
<p>The US Gov decided that the best thing to do was classify it (TEMPEST) and prevent people getting hold of screening materials and filter components etc. Untill the density of radios etc made EMC a requirment for simple usability, however preasure was applied to standards commities to keep the EMC requirments minimal so the likes of the DoD and NSA could keep spying on eminations as could other Five Eye nations. It was an easy sell as nobody wanted the EMC requirments to be overly onerous due to consumer cost and loss of profit involved.</p>
<p>But as you have found as far as privacy / security is concerned it&#8217;s a compleate disaster&#8230;</p>
<p>As I was commenting to @Nick P the other day, for various reasons although we intrinsicaly know the risks as engineers, we discount them away on the idea of &#8220;they won&#8217;t do it to me, or my customers unless they are evil and thus deserve it&#8221;&#8230; How wrong can one be?</p>
<p>The funny thing is some of us have said it over and over again and in effect got the &#8220;You&#8217;re paranoid&#8221; or &#8220;That&#8217;s just some silly conspiracy theory&#8221; from people who would rather &#8220;not think hinky&#8221; as Bruce so apptly put it.</p>
<p>We naturaly tend to think good of people not the worst and now people have had a little wake up call curticy of Ed Snowden, the question is are they going to not just smell the coffee but actually take a good long drink of it&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224235">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224235">
						June 8, 2014 11:16 AM					</a>

				</p>

				<p>@koita nehaloti</p>
<p>Linux distributions use hashes and PGP keys because the people involved are geeks and purists.<br />
Had they not, they would have purchased a code-signing cert from a recognized CA and then it would be easy to verify for the non geek.</p>
<p>I trust many CA (not all, but many) to the same level as I trust linux maintainers, which is more than I trust the device drivers corporate writers who insert their own binary blobs into the various official distributions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224236">

			<div class="comment by-incredulous ">

				<p class="commentcredit">

					<span class="commenter">Incredulous</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224236">
						June 8, 2014 12:02 PM					</a>

				</p>

				<p>@Jacob</p>
<p>Sorry.  I guess the threads aren&#8217;t as easy to parse w human intelligence as I thought.  Or I shouldn&#8217;t ask questions until after coffee&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224237">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224237">
						June 8, 2014 12:16 PM					</a>

				</p>

				<p>@ Incredulous</p>
<p>Their main use of Internet eavesdropping is profiling via traffic analysis. That&#8217;s their passive monitoring goal. Then, if they need to target someone, they can leverage that information and infrastructure in the process. The passive collection uses filters to catch anything they think might be of interest. Interesting parties <em>probably</em> include hotspots for activity that hurts the NSA&#8217;s mission. This might be big time blogs, technical mailing lists, etc.</p>
<p>Name.withheld guessed, like I did, that they probably have monitoring scheme for this blog. They&#8217;d start with the list of all connections to it. From that point, they&#8217;d look at frequency of visits, whether comments were made, and how often. A passive monitoring tool, like a web scraper, was my first idea for how to keep up with this blog during busy periods. Anyone having that shows up as connecting to the site one or more times per day in identifiable intervals without commenting during such sessions. So, such a person would be grouped in with others that seem to be committed participants of the blog rather than casual readers. The dedicated participants are relatively few and could get more manual/automated analysis.</p>
<p>Many here consider Skeptical to be a plant pushing a pro-NSA agenda. The truth of that is irrelevant for this discussion. The point is that NSA and Britain both have programs to get people in games, blogs, etc to collect information and sway people. Hard to be sure how they&#8217;d allocate their resources. Yet, Bruce&#8217;s is a very high profile blog and he&#8217;s regularly in media. It&#8217;s worth targeting with humans in aforementioned programs. If that&#8217;s true, then it&#8217;s <em>definitely</em> worth targeting with their SIGINT collection systems that run 24/7 with abundant storage and bandwidth. The app in question I could throw together in a day on a cheap server. My mantra is, if it&#8217;s that easy and useful, assume they&#8217;re doing it.</p>
<p>Re bookmark thing. I have a few ideas on that. Yet, I think name.withheld just mixed his risks together: the &#8220;almost certainly doing it&#8221; with the &#8220;wild possibility I&#8217;m brainstorming.&#8221; A bit overzealous about getting the risk across, I think, is all that was.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224238">

			<div class="comment by-incredulous ">

				<p class="commentcredit">

					<span class="commenter">Incredulous</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224238">
						June 8, 2014 12:26 PM					</a>

				</p>

				<p>Sniffing has shown me time and time again that there is no way to tell what your computer is up to unless you monitor it.</p>
<p>I was exercising my sniffer while working with my latin american proxy and I noticed something really strange under fedora yum &#8212; it was getting its repos from a us govt mirror: mirror.pnl.gov.  DOE site.  It advertises itself as a friendly aid to the internet.  I wish I could believe the US govt has any such intention.</p>
<p>Research shows that yum looks for the most appropriate mirror based on your location.  Seems an unlikely mirror for latin america.  I wonder if it is designed to delay security fixes to latin american targets.  Fedora packages are PGP signed so inserting a totally new one would be harder than simply delaying updates.  Any opinions of what it might be up to?  Or not?</p>
<p>You can edit your /etc/yum.repos.d/*.repo (Under Fedora 19) and place an ip parameter in the mirrorlist url to set your location somewhere else.  And it works based on my sniffing.  It might be a good idea if you think you might be offered fake or obsolete packages.</p>
<p>But this discovery makes me more hesitant to trust Fedora.  I have used the PRISM-BREAK site to vet my OS choices.  I used to use Ubuntu, but although it doesn&#8217;t take a site to let you know Ubuntu is intent on selling your private info, PRISM-BREAK did put a nail in its coffin.</p>
<p>I like TAILS on read-only media, but it is a pain for doing any development work.  Anybody have a strategy or link for a use of TAILS for development?  Or a linux alternative, besides air-gapping?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224239">

			<div class="comment by-incredulous ">

				<p class="commentcredit">

					<span class="commenter">Incredulous</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224239">
						June 8, 2014 12:40 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>Thanks for your comments.  I wish the NSA didn&#8217;t think it was worth it to monitor us.  I used to focus on tracking malware, rather than worrying about privacy and Big Brother.  I would have been proud to work for the NSA.  When Obama was first elected I was excited about the incipient new America that was facing its inequities and injustices and really living up to its potential.</p>
<p>WAH wah&#8230;  What a disappointment.  Maybe I am idealist, maybe even unrealistic, but idealism interacting with reality is the engine of change and growth.  I foresee stagnation and reduced prosperity for all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224240">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224240">
						June 8, 2014 1:28 PM					</a>

				</p>

				<p>Nick P<br />
<i>I had a problem with only one of these. 😉</i><br />
&#8211;Are you like putting the desktop b/w your legs and mounting it or what..?  Oh you must have that dreadful <a href="http://en.wikipedia.org/wiki/Restless_legs_syndrome" rel="nofollow ugc">&#8220;restless leg syndrome&#8221;</a>.  Ok, nvm don&#8217;t answer that (that would explain a lot though lol), the winky smiley face says it all&#8230; :p</p>
<p>I&#8217;ve got 3 split open PC&#8217;s around me now, all the power button consists of in one of them is a tiny board w/ LED&#8217;s and a button on a tiny board w/ screws; the other is a button again which is harder to get and goes back to the MOBO (still slightly movable).  In other words you can move it or solder an extended cable to bring the button up in your face.  It&#8217;s a silly non-problem, actually wait&#8230;Sometimes I run my fingers along a keyboard to remove dust (just a little quirk) and the other day I hit the power button by hitting this little button that tells the laptop that it&#8217;s closed.  It takes forever for this laptop to boot up and I was working on it so I was pissed.  If it was around my knee I wouldn&#8217;t be hitting it&#8230;</p>
<p>Oh BTW, found a CF card for that Cassiopeia thing, today is a good day.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224241">

			<div class="comment by-mikea ">

				<p class="commentcredit">

					<span class="commenter">MikeA</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224241">
						June 8, 2014 4:47 PM					</a>

				</p>

				<p>@clive: I have yet to see a motherboard that was decently reliable with spread-spectrum clocks enabled. Apparently that feature is <em>only</em> to pass tests, then disabled for actual use. I know of one (large, un-named here) company who left them enabled, and their time across clusters was, um, <em>challenging</em>.</p>
<p>As for shielding. A year or so back a mailing list I frequent was wondering about a large number of dropped (as SPAM or Malware by email &#8220;firewalls&#8221;) messages. Some triangulation determined that the &#8220;dirty word&#8221; was a brand-name for conductive paint used for EMI shielding. Oddly, the original message that triggered the failure avalanche was from a person in Oak Ridge TN. Got a lot of folks re-tightening their mu-metal helmets.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224242">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224242">
						June 8, 2014 4:51 PM					</a>

				</p>

				<p>OFF Topic :</p>
<p>It would appear that China is further upping the anti against US service / software / hardware companies, which may actually end up costing the US economy rather more than the US Gov TLAs budgets for spying did&#8230;</p>
<p><a href="http://www.reuters.com/article/2014/06/04/us-china-usa-tech-idUSKBN0EF0CA20140604" rel="nofollow ugc">http://www.reuters.com/article/2014/06/04/us-china-usa-tech-idUSKBN0EF0CA20140604</a></p>
<p>Which suggests that mass economic spying may turn out to have a very bad ROI, however I suspect well targeted economic espionage will as the French once pointed out continue to show quite a good ROI.</p>
<p>At the end of the day, currently the US is on the wrong end of the stick by poor/shortterm economic choice, the corps have chosen to &#8220;sup with the devil&#8221; but neglected &#8221; to use a long spoon&#8221;. Whilst the issue is far from insoluable in the long term, share investors might well go for the &#8220;Sue Grabbit and Run&#8221; option as a &#8220;stop loss&#8221; in the very near term which will add more instability and might just act as a tipping point. Whilst it is of academic interst to watch it play out, it needs to be remembered it will have effects on employment in the high tech arena. Which perversely may cause an even worse problem by further out sourcing to other countries including Europe, India, Israil, Russia all of whom are in effect currently competitors&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224243">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224243">
						June 8, 2014 8:07 PM					</a>

				</p>

				<p>@Figureitout, @Nick P.</p>
<p>That&#8217;s why I say hell with the power button. I just touch the appropriate pins together with a straight bit screwdriver. Works great!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224244">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224244">
						June 8, 2014 8:09 PM					</a>

				</p>

				<p>@kashmarek</p>
<p>That&#8217;s horrible, spying on little kids? How low will things go?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224245">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224245">
						June 8, 2014 8:13 PM					</a>

				</p>

				<p>@Paul, @Benni, @Thoth:</p>
<p>From what I&#8217;m reading it&#8217;s starting to look like OpenSSL is junk. I&#8217;m guessing it&#8217;s been getting more scrutiny and code review than ever since things like BULLRUN became known. Am I wrong, or do you think that&#8217;s all likely?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224246">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224246">
						June 8, 2014 8:34 PM					</a>

				</p>

				<p>@Incredulous</p>
<p>Unfortunately, untrustworthy source repositories &amp; DNS in general, surely are a real major problem, but you&#8217;d almost certainly be a fool to think that setting a specific IP address could possibly offer any additional security against state-level or organized-criminal attackers&#8230;<br />
(See <a href="https://www.schneier.com/blog/archives/2013/10/how_the_nsa_att.html" rel="nofollow ugc">QUANTUM and FOXACID</a> &#8230; and <a href="https://www.schneier.com/blog/archives/2014/05/the_nsa_is_not_.html" rel="nofollow ugc">NSA not Made of Magic</a>)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224247">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224247">
						June 8, 2014 11:09 PM					</a>

				</p>

				<p>@ Jacob</p>
<p>&#8220;Linux distributions use hashes and PGP keys because the people involved are geeks and purists.<br />
Had they not, they would have purchased a code-signing cert from a recognized CA and then it would be easy to verify for the non geek.&#8221;</p>
<p>Idealism vs pragmatism. A theme I keep revisiting in discussions here. One must use pragmatism if widespread success is the goal.</p>
<p>@ Figureitout</p>
<p>&#8220;Are you like putting the desktop b/w your legs and mounting it or what..? Oh you must have that dreadful &#8220;restless leg syndrome&#8221;. &#8221;</p>
<p>LOL. No, more like where they were located in typical work desks. And the button was always right in front of the knee and activated with the slightest touch. It&#8217;s why most modern power buttons require you to hold the button a few seconds. One huge annoyance replaced by a lesser annoyance so engineers couldn&#8217;t fix the root problem: location of button.</p>
<p>@ Chris Abbott</p>
<p>Yeah there&#8217;s always the geeky, over-the-top way to do it. Personally, I miss the power switch in the back that gave us the distinction between &#8220;soft&#8221; and &#8220;hard&#8221; resets. I prefer the hardwired switches for power, knobs for audio, and so on because they always <em>work</em>. Simply no firmware or drivers to screw up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224248">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224248">
						June 9, 2014 1:45 AM					</a>

				</p>

				<p>@ Chriss Abbott,</p>
<p>Hmm I would not try the &#8220;screwdriver tickle&#8221; method with any of the systems I&#8217;ve built, otherwise the &#8220;force will be with you&#8221; until you or the fuses pop which ever first&#8230;</p>
<p>@ Nick P,</p>
<p>Soft switches are a &#8220;no no&#8221; as far as I&#8217;m concerned even on laptops. I want to know &#8220;off means off&#8221; not just for my safety but security as well.</p>
<p>Also as I&#8217;ve mentioned before, the older systems I use have either proper UV wipe PROM with write voltage disabled or RAM without battery backup. Getting hold of old network cards without EEPROM is now getting hard but thankfully building them is still possible as the older NE1000 chipsets are suprisingly still available and cheap and the manufacture of double sided AT PCBs in &#8220;ten offs&#8221; is not a problem and can be done in 24hour turn around if you don&#8217;t mind paying the extra.</p>
<p>I like the old AT interface as it&#8217;s easy to work with with modern microcontroler chips, which makes certain novel solutions possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224249">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224249">
						June 9, 2014 5:35 AM					</a>

				</p>

				<p><a href="http://www.spiegel.de/politik/deutschland/nsa-affaere-maas-fordert-snowden-zu-voller-kooperation-in-moskau-auf-a-973873.html" rel="nofollow ugc">http://www.spiegel.de/politik/deutschland/nsa-affaere-maas-fordert-snowden-zu-voller-kooperation-in-moskau-auf-a-973873.html</a></p>
<p>The german minister of justice calls Edward Snowden for full cooperation in Moskow.</p>
<p>He says that Snowden should tell everything he knows to the german members of the parlamentarian NSA investigation Panel, when they visit Snowden in Moskow in July.</p>
<p>I would say, Snowden should only meet the germans if his german lawyer takes part in the negotiations and if he is in the room when they ask Snowden. During this interrogation, Snowden should tell the members of parliament which informations he has to offer, once they bring him to germany.</p>
<p>In his best interests, Snowden should give out details only after he has touched german ground, and not before that.</p>
<p>Before Snowden is in germany, these members of parliament should just get some kind of list what information they can expect, and nothing more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224250">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224250">
						June 9, 2014 9:45 AM					</a>

				</p>

				<p>Nick: I was (and continue to be) surprised at just how much seemingly [at first glance] unrelated stuff I can break just by &#8211; for example &#8211; changing the length of an address in the IP stack.</p>
<p>PGP keyserver replacement is going to be my attempt to deal with the current abysmal state of the key servers. They are hard for newbies to use, suffer from a huge number of fraudulent and/or lost keys [owners lost the private key, didn&#8217;t have the revocation cert to upload, etc] amongst other issues. Sure, there are great things about them too but I hope to try and at least develop something better. Given my current workload and the number of existing projects and responsibilities I am already neglecting this one is going to have to wait a few months before it gets any real attention. I hope to publish a treatise, of sorts, on the problem and my intended solutions. Here&#8217;s hoping. I am also seriously thinking about physically relocating, perhaps to Cali, at least temporarily (say, 2-3 years) &#8211; that&#8217;s if anyone is still employing people like me. :-). Funnily enough you so often don&#8217;t find the kind of jobs I have worked at in the past posted up on career websites (or you do, and they are full of euphemisms like, &#8220;penetration tester&#8221;). But, realistically, I can work in a number of roles and am flexible re hours and pay; just want to have a bit of a holiday.</p>
<p>Clive: I had to laugh when &#8211; and I&#8217;ll paraphrase &#8211; you said that the USG&#8217;s response to an issue they couldn&#8217;t solve was to classify it. It reminded me of the whole &#8220;duck and cover&#8221; propaganda re nuclear bomb attack. It appears so utterly ridiculous to us in 2014 but I imagine the bulk of the population back then believed that this nonsense was a viable way to mitigate the effects of a thermonuclear blast!</p>
<p>I believe that the transititon from CRTs over to LCDs, operating over either LVDS (in the case of laptops) or DVI-D links has probably worsened the operational situation and not improved it. At least for the CRTs there were certain mitigations (copper shielding in &#8216;hot spots&#8217; for leakage, &#8216;TEMPEST-proof&#8217; fonts, etc.) that are either not effective at all (fonts) or less effective (shielding of the display cable) with the &#8216;newer&#8217; digital tech.</p>
<p>Buck: I could whine on for hours about the sad, sorry state of the DNS roots and how DNSSEC won&#8217;t make a shred of difference but I won&#8217;t&#8230; all I really wanted to add is that I agree with you!!</p>
<p>Nick/Figureitout &#8211; re power buttons: yeah&#8230; at least the &#8216;hard&#8217; off buttons were a definite, mechanical way of turning off power to the PC. In my first year of college I was introduced to our computer sciences lab and found out, after a bit of experimentation that all the PC&#8217;s had WoL enabled (and funnily enough this was in an era where they had separate NICs, and they actually had a small WoL cable that had to be connected between the NIC and a header on the mobo so it wasn&#8217;t like it was hard for the school to disable &#8211; but perhaps they used it for administrative purposes &#8211; eg insuring they were all on to roll out new software or something?).. anyway, great fun was had randomly turning on huge banks of computers. I also discovered a small script that mounted some network drives upon logon and used it to run a tiny 2k tool called, funnily enough &#8216;eject.exe&#8217; that I pulled off one of the netware resource disks. There were optical drives moving all over the place! 🙂</p>
<p>Benni: exactly. Snowden needs to start thinking of his own hide, but I would guess that his legal team is already doing everything they can as far as positioning him for a potential &#8216;transfer&#8217; elsewhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224251">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224251">
						June 9, 2014 11:02 AM					</a>

				</p>

				<p>@ Mike the goat</p>
<p>&#8220;Dependency hell&#8221; comes to mind re IP stack. Re PGP servers. Take your time. Re jobs. Yeah, I feel you on that. It&#8217;s worse in my area as there&#8217;s hardly any work outside big companies whose H.R. teams make it hard for talent to get in. I might relocate myself. I&#8217;m considering trying to do some work in an inexpensive European country so I can do some fun sightseeing and maybe take advantage of the no taxes up to $100k+/yr for a few years. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224252">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224252">
						June 9, 2014 11:18 AM					</a>

				</p>

				<p>Nick P: what annoys me is that there is a six year chunk of my life which I am not <em>able</em> to disclose on my CV. I should have thought about that problem before agreeing to do such work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224253">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224253">
						June 9, 2014 11:25 AM					</a>

				</p>

				<p>@Mike the goat<br />
Re: TEMPEST proof fonts, any suggetion on which font to use to make it harder?<br />
//Chris</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224254">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224254">
						June 9, 2014 11:33 AM					</a>

				</p>

				<p>Hi, something that I have been waiting for but still havent seen or I might have missed it, is a device eather builtin or added by interdiction that sends data back to a listening device over AC Current Power Network.</p>
<p>What I can think of is that at least in theory thats how to do it, all this talk about using a loudspeaker to send data over an airgap doesnt make any sence to me.<br />
If I would design anything like an airgap destroyer that would be it.<br />
And not only for airgaps but it makes it easier to listen in to someone where the location is known.</p>
<p>Just a thought, using an RTL-SDR stick and looking at 50/60hz would probably see if there is something there or not. who knows?<br />
//Chris</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224255">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224255">
						June 9, 2014 11:52 AM					</a>

				</p>

				<p>@ Mike</p>
<p>Mine&#8217;s closer to ten. I had a selective disclosure scheme worked out for a while. Unfortunately, those references are no longer available so we&#8217;re in the same boat. What I recommended for ex-black hats in the past was to stage references. I mean, if one&#8217;s ethics arent an obstacle&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224256">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224256">
						June 9, 2014 12:35 PM					</a>

				</p>

				<p>Re: TEMPEST Fonts<br />
found this <a href="https://www.cl.cam.ac.uk/~mgk25/emsec/softtempest-faq.html" rel="nofollow ugc">https://www.cl.cam.ac.uk/~mgk25/emsec/softtempest-faq.html</a><br />
//Chris</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224257">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224257">
						June 9, 2014 12:57 PM					</a>

				</p>

				<p>@Nick P<br />
&#8220;maybe take advantage of the no taxes up to $100k+/yr for a few years&#8221;</p>
<ul>
<li>I guess you refer to the tax exclusion extended by the USG to expats, but you will pay dearly, OTOH, to the local European tax authorities&#8230;</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224258">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224258">
						June 9, 2014 1:20 PM					</a>

				</p>

				<p>Hmm, maybe there is something to the microphone loudspeaker airgap theory after all 🙂</p>
<h2>Found this now:</h2>
<p>24.641 MHz<br />
Over on Reddit, user cronek discovered by using his RTL-SDR that the microphone on his HP EliteBook 8460p laptop computer<br />
was continuously and unintentionally transmitting the audio from the built in microphone at 24 MHz in FM modulation</p>
<p>//Chris</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224259">

			<div class="comment by-true-randomness ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://crypto.stackexchange.com/q/10776/12164' rel='external nofollow ugc' class='url'>True Randomness</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224259">
						June 9, 2014 1:53 PM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Oh, that explains why I just had to lock down a whole bunch of Chinese <b>Military</b> IP ranges after watching them hit my servers using a broad range of attack-types during the past few months. I already wondered why Chinese Mil IPs try to hack their way into US servers (the server itself; not some CMS).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224260">

			<div class="comment by-iain-moffat ">

				<p class="commentcredit">

					<span class="commenter">Iain Moffat</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224260">
						June 9, 2014 4:34 PM					</a>

				</p>

				<p>@Chris:</p>
<p>Regarding power line networking I think the relatively common (here in the UK at least) use of in home ethernet-over-mains devices &#8211; as apart from devices operating over power company lines which I think you meant &#8211; must be another potential source of information leakage comparable to WiFi in the home, but I cant recall seeing any published investigation of what can be received remotely or extracted from the received signal. Are any of the blog contributors aware of any research in this field ?</p>
<p>I used to have some Devolo Homeplug devices which claimed to use AES-128 and some kind of multi carrier modulation scheme so maybe that has deterred people from trying to recover any information from radiated leakage ?</p>
<p>Iain</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224261">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224261">
						June 9, 2014 5:46 PM					</a>

				</p>

				<p>Darpa testing the idea of using online games to crowdsource formal verification of software:</p>
<p><a href="http://www.darpa.mil/Our_Work/I2O/Programs/Crowd_Sourced_Formal_Verification_%28CSFV%29.aspx" rel="nofollow ugc">http://www.darpa.mil/Our_Work/I2O/Programs/Crowd_Sourced_Formal_Verification_%28CSFV%29.aspx</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224262">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224262">
						June 9, 2014 5:56 PM					</a>

				</p>

				<p>to make subversion easier, openssl comes shipped with a compiler option that disables certificate verification:</p>
<p><a href="http://freshbsd.org/commit/openbsd/5db84f7ac0ecbe122a2607668f9f30b58e0dae92" rel="nofollow ugc">http://freshbsd.org/commit/openbsd/5db84f7ac0ecbe122a2607668f9f30b58e0dae92</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224263">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224263">
						June 9, 2014 6:39 PM					</a>

				</p>

				<p><a href="https://www.techdirt.com/articles/20140517/07153627270/michigan-state-politicians-looking-into-sheriff-departments-use-cell-tower-spoofer.shtml" rel="nofollow ugc">https://www.techdirt.com/articles/20140517/07153627270/michigan-state-politicians-looking-into-sheriff-departments-use-cell-tower-spoofer.shtml</a></p>
<p>More news has surfaced of cell tower spoofers being deployed without the public&#8217;s knowledge. This time it&#8217;s the Oakland County (Michigan) Sheriff&#8217;s Department rolling out an upgraded Stingray device from Harris Manufacturing, known as &#8220;Hailstorm.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224264">

			<div class="comment by-david-c ">

				<p class="commentcredit">

					<span class="commenter">David C.</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224264">
						June 9, 2014 6:42 PM					</a>

				</p>

				<p>@ Jacob</p>
<p>Earlier you said this:</p>
<p>&#8220;Question to the board members:</p>
<p>Since the NSA is demonstrably interested in encryption, and<br />
since this board deals with security and encryption items,<br />
do you think that the each board member may be a &#8220;person of interest&#8221;?<br />
And I mean not just monitoring talkback posting, but actually going into the poster computer to see if there are things of interest.</p>
<p>And if you do, does this hinder your postings?&#8221;</p>
<p>NSA&#8217;s knowledge of encryption technology is probably way more advanced than anything in the public sector. I doubt very much if they bother with people who post here. What could they possibly gain? I think you are being way too paranoid. The only hindering on my posts is that at present I dont want to reveal my full identity in case my employer determines it is not in the companies interest to have a publicly outspoken individual on the staff. However when I make a comment I have to enter my full real email address. But dont be paranoid, just be honest and believe in yourself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224265">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224265">
						June 9, 2014 8:27 PM					</a>

				</p>

				<p>@ David C,</p>
<blockquote><p>I doubt very much if they [NSA et al] bother with people who post here. What could they possibly gain? I think you are being way too paranoid</p></blockquote>
<p>You are making the mistake of buying into the &#8220;Myth of NSA superiority&#8221;. On a historical note it was the Mafia that invented things like the &#8220;infinity bug&#8221; that they used on the authorities, not the other way around. MI5 actually stole the design for land line anti-bugging technology based around TDR from a UK journalist who you have claimed is a traitor&#8230; lkewise they also stole the idea for using lasers to reflect off of objects in a room to recover audio and actually gave it to a UK company so that they could be made for both UK and US Intel services including MI6 who in turn passed it on to the CIA.</p>
<p>If you look back on this blog you will find that one or two of the regular posters have come up with attack vectors and other security solutions that were way way ahead of anything else published. Subsiquently some of those methods have appeared not in cyber-crime malware but State Level cyber-espionage malware, such as stuxnet and air-gap crossing being just one of several.</p>
<p>You will also see that &#8220;software signing&#8221; was called out on this blog as not being the security mechanism most people thought it was and identifying numerous ways it could be circumvented easily by an attacker, which was another idea that poped up in stuxnet subsiquently.</p>
<p>You will also find descriptions of transaction authentication methods that significantly reduce or can eliminate online banking fraud going back several years before the rest of the industry had realised that session based passwords are a compleate security fail.</p>
<p>I&#8217;m sure that others can provide other leading edge examples.</p>
<p>But back to the NSA Myth, if you have looked carefully at the TAO catalogue, you will not find anything in there that was new or novel, and equipment similar or superior to it had been discussed on this blog long prior to the dates given in the catalogue.</p>
<p>You will also see active fault injection via EM carrier has been repeatedly discussed on this blog and there is currently no direct indication that the TAO has yet got around to using such techniques (though they are known to work and have been demonstrated to UK intel agencies back in the 1980s).</p>
<p>You will also see in the early BadBIOS discusions some regular posters had already used sound and SDR techniques for air-gap crossing and accuratly described the what and how of it. It was only later that it was shown via the Ed Snowden revelations that the TAO was using such techniques.</p>
<p>Yes the NSA might be ahead in some areas to do with encryption, voice compression and data storage, but in others such as the work of the TAO they are behind the curve of some of the comments on this blog by a considerable amount.</p>
<p>The important point to note is in general people in the security industry are not objectivly analysing open data with a little &#8220;hinky thinking&#8221; to see how it might be used as an attack vector ( perhaps due to &#8220;Golden Goose Fears&#8221;). An example of this was SCADA security one or two posters to this site were waving red flags a long long time before most people in either the ICS or Security industries had realised that there was a significant danger related to them being connected to the Internet and other publicaly accessable networks. Years later in 2006 the USG started investigating with the likes of project aurora.</p>
<p>The NSA, DoD, DoE etc most certanly do not have a monopoly on &#8220;thinking hinky&#8221; and actually usualy lack the required industry experiance to be on par let alone ahead of the game in areas that they have not traditionaly covered.</p>
<p>So yes I would say that members of the NSA and related organisations certainly do read this blog and I would not be surprised to find that they had done background checks on some posters. In fact I would say they would have been failing in their duties if they had not&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224266">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224266">
						June 9, 2014 9:42 PM					</a>

				</p>

				<p>@Clive Robinson, @Nick P, @Chriss Abbott,</p>
<blockquote><p>Soft switches are a &#8220;no no&#8221; as far as I&#8217;m concerned even on laptops. I want to know &#8220;off means off&#8221; not just for my safety but security as well.</p></blockquote>
<p>100% agree. Perhaps one should pry open smart phones and hookup a physical switch between the battery and the board. Turn it off, it&#8217;s off &#8212; unless there is a small backup battery hidden elsewhere in the device. There are many ways to do it, one can install a &#8220;reed-switch&#8221; with some minor circuitry. Reed switches are magnetically activated, so the outside of the device need not be  defaced. Other innovative ways to use different types of switches such as mercury switches may be explored. Sounds like a worthwhile project. Be careful that <a href="http://www.aliexpress.com/item/5pcs-Knife-Switch-Double-Pole-Double-Throw-DPDT-toggle/964005356.html" rel="nofollow ugc">this sort of switch</a> may void your warranty&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224267">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224267">
						June 9, 2014 10:55 PM					</a>

				</p>

				<p>Wael: a friend of mine gave me a professionally produced &#8216;pouch&#8217; made of what appears to be three layers &#8211; the inner layer feels like high density foam, perhaps for acoustic dampening; and the middle layer is some kind of brillo-like material and the outermost layer looks like a standard antistatic bag. Supposedly you can put your phone in one of these little pouches for some extra assuredness. I am a bit unconvinced though &#8211; if you had malware on the device, listening and buffering what is recorded for later transmission, perhaps a 1/4&#8243; layer of foam isn&#8217;t sufficient to truly attenuate all of the sound?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224268">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224268">
						June 9, 2014 11:12 PM					</a>

				</p>

				<p>@ David C</p>
<p>Clive said it very well. I&#8217;ll simply say they can&#8217;t be so ahead if their BULLRUN program is mostly about introducing weaknesses into standard security so they can easily break them. I repeat: so they can break <em>standard</em> security products. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224269">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224269">
						June 9, 2014 11:23 PM					</a>

				</p>

				<p>@Mike the goat,</p>
<blockquote><p>professionally produced &#8216;pouch&#8217;&#8230;</p></blockquote>
<p>With DSP capabilities, and who knows how much the amplifier gain can be increased, plus the super sensitivity of the microphone, I wouldn&#8217;t trust it. You have three issues to consider:<br />
1- Sound insulation, I don&#8217;t think it&#8217;s sufficient and you need to test it.<br />
2- Electromagnetic isolation. Not sure the Brillo-like material is sufficient, you have to test it.<br />
3- Your &#8220;friend&#8221; giving you a &#8220;gift&#8221;. Trust no one 😉</p>
<p>Best thing I know is leave the phone behind (I don&#8217;t practice what I preach), or completely cut the power off &#8212; and that can be counter measured as well 😉 But you know that I know you know all of that 🙂 Out with it, Mike the goat, what are you leading to?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224270">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224270">
						June 9, 2014 11:51 PM					</a>

				</p>

				<p>Chris Abbott<br />
&#8211;Hah, was turning a pot. on a [crappy] PIR sensor (while plugged in, smart) w/ a screwdriver and that little arc scared the crap out of me.  Had another scare the other day, reaction time is never ever fast enough&#8230;Probably not smart that I plan on a small electric fence for a little garden b/c damn rabbits get nibbly, but I can&#8217;t shoot a gun in a suburban neighborhood&#8230;</p>
<p>Mike the goat<br />
&#8211;Hah funny story.  Had a couple random shutdowns in the school lab one time, better not have been you.. :p  I wonder what they would do if I just unplugged the ethernet cable though, and I mean when I&#8217;m all alone in a computer lab it&#8217;d be kind of fun to put all that computing power to some use&#8230;like supreme SDR calculations.</p>
<p>There&#8217;s something funny w/ my school acct. so I don&#8217;t try much of anything, just sit and get compromised and log out.  But I now can see the internals of the new Dell PC&#8217;s (which the case is mostly empty&#8230;fill it up w/ some RAM!) and can hopefully work a little on what causes the noise that I can hear from my headphones whenever there&#8217;s movement on the VGA/LCD screen (I can also hear high pitch noises when flashing a chip, so again I wonder what can be gathered from that noise&#8230;).  I got confirmatory evidence of a signal but not enough, hopefully I can get my laptop to somewhat normal functioning and reliable to use for experiments.</p>
<p>RE: shielding<br />
&#8211;Nothing new to people in the field but 3M sells copper tape which will come in very handy for shielding tiny crevices and such, extremely simple test showed it worked but I&#8217;m probably going to get a roll for many more tests.  Also, while I&#8217;m looking for noise resistant components to build w/, I came across &#8220;metal-film resistors&#8221; which look like what&#8217;s commonly used today so that&#8217;s good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224271">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224271">
						June 10, 2014 12:03 AM					</a>

				</p>

				<p>@Nick P, @Dave C, @Clive Robinson,</p>
<blockquote><p>I&#8217;ll simply say they can&#8217;t be so ahead&#8230; </p></blockquote>
<p>I think you and @Clive Robinson based this assessment on the information that was leaked. You don&#8217;t know all of the capabilities were leaked. I even think the technology to listen to a regular conversation between two or more people from a satellite (or a drone) exists. I am aware that sound does not travel through space, by the way! Have you considered that an innocent looking insect flying by you could be a tiny <a href="http://robobees.seas.harvard.edu" rel="nofollow ugc">robot</a> listening and recording your actions? Remember! They have superior <a href="https://www.schneier.com/blog/archives/2013/10/how_the_nsa_att.html#c1847648" rel="nofollow ugc">technology</a> 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224272">

			<div class="comment by-digitalbloodhound ">

				<p class="commentcredit">

					<span class="commenter">digitalBLOODHOUND</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224272">
						June 10, 2014 12:41 AM					</a>

				</p>

				<p>@Wael</p>
<p>NSA/et. all maybe put laser in satillite, laser acoustic window bounce?</p>
<p>Anyone know if orbital satillite accurate enough positiong?</p>
<p>Hubble accurate, why not laser sat?</p>
<p>Could aim window, listen in.</p>
<p>Idea?</p>
<p>PS: I no care if NSA listen here, browse through Tor/I2P&#8230;plus can&#8217;t hack this box.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224273">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224273">
						June 10, 2014 1:08 AM					</a>

				</p>

				<p>@digitalBLOODHOUND,</p>
<blockquote><p>NSA/et. all maybe put laser in satillite, laser acoustic window bounce?</p></blockquote>
<p>That&#8217;s certainly one way. Quick! Break all your windows 🙂 What if there are no windows, how would you do it?</p>
<blockquote><p>PS: I no care if NSA listen here, browse through Tor/I2P&#8230;plus can&#8217;t hack this box.</p></blockquote>
<p>It&#8217;s free consulting 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224274">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224274">
						June 10, 2014 1:15 AM					</a>

				</p>

				<p>Nick: I agree. The NSA are almost certainly unable to defeat conventional crypto &#8211; that&#8217;s why they have got so many programs focused on &#8220;cheating&#8221;.</p>
<p>Wael: now that I think about it, yeah, a phone pouch was an odd random gift. Then again &#8211; this is a guy who gave me a throat mic and an earwig set for my ICOM last Xmas.</p>
<p>Nick (o/t): I am at a bit of a crossroads with blogsig. I really like djb&#8217;s Curve25519 but there are lots of practical reasons to use ECDSA. What to do?!!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224275">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224275">
						June 10, 2014 1:29 AM					</a>

				</p>

				<p>@Mike the goat (horn equipped),<br />
This ICOM? <a href="http://www.icomamerica.com/en/" rel="nofollow ugc">http://www.icomamerica.com/en/</a><br />
I&#8217;ve been thinking which one to get ICOM or <a href="http://www.yaesu.com" rel="nofollow ugc">http://www.yaesu.com</a></p>
<blockquote><p>I really like djb&#8217;s Curve25519</p></blockquote>
<p>Given your current attribute, I am afraid to ask&#8230; The curves or the figure? 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224276">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224276">
						June 10, 2014 2:26 AM					</a>

				</p>

				<p>@ David C.</p>
<p>In addition to what Clive said re thoughts and discussions to advance the state-of-the-art which you can occasionally find in these board postings, I thing along more mundane NSA interests:</p>
<p>This board is one of the watering holes for security professionals, and it is frequently visited by international sec officers/engineers.</p>
<p>The ROI for the NSA would be much better than the usual dragnet sweep by trying to get into the computers of these people to see if they can steal credentials or infect down the line their employers systems (which, having a security officer/engineer on board, means that they do interesting things, and, along the published motto of &#8220;we hunt sys admins&#8221;, does make a perfect sense).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224277">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224277">
						June 10, 2014 2:53 AM					</a>

				</p>

				<p>s/Curve/ED/g</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224278">

			<div class="comment by-question ">

				<p class="commentcredit">

					<span class="commenter">Question</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224278">
						June 10, 2014 3:14 AM					</a>

				</p>

				<p>Can someone please point me to a simple and safe PGP based file encryption utility? After half hour of searching the internet still can&#8217;t find one from some trustable source.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224279">

			<div class="comment by-question ">

				<p class="commentcredit">

					<span class="commenter">Question</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224279">
						June 10, 2014 3:19 AM					</a>

				</p>

				<p>&#8230;windows version, freeware, no source code, just a simple tool to encrypt a file based on an external key. A link please?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224280">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224280">
						June 10, 2014 3:27 AM					</a>

				</p>

				<p>Question:<br />
<a href="http://www.gnupg.org" rel="nofollow ugc">gpg</a> -c filename?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224281">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224281">
						June 10, 2014 3:28 AM					</a>

				</p>

				<p>@ Mike the Goat,</p>
<p>Back when ICOM made &#8220;headless radios&#8221; I had a need for their products and I still have many knocking around like original IC2E 4E, and now a member of the household is doing a bit of radio astronomy the R7000 has escaped the test bench for not just nights under stary skies.</p>
<p>Which reminds me of that PITA FCC &#8220;no continuous coverage&#8221; nonsence which stops the US versions of their kit also being good tools for testing. Another example of the usless &#8220;if we cann&#8217;t control it, we&#8217;ll ban it&#8221; mentality the USG practices ad norsium.</p>
<p>As for the gift of a pouch for posing with, that foam may not be there for achostic reasons, it could be just simple cushioning, or it might be a variation on the old &#8220;Hundred ohm foam&#8221; which is loaded with carbon or metal particles to act as an EM absorber (as seen in the horn like structures that give anechoic chambers that retro-Punk-Rock look.</p>
<p>As for curves, just remember the older you get the more atractive the curvier curves made by others become&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224282">

			<div class="comment by-wesley-parish ">

				<p class="commentcredit">

					<span class="commenter">Wesley Parish</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224282">
						June 10, 2014 3:29 AM					</a>

				</p>

				<p>@Wael et alii</p>
<blockquote>
<blockquote><p>NSA/et. all maybe put laser in satillite, laser acoustic window bounce?</p></blockquote>
<p>That&#8217;s certainly one way. Quick! Break all your windows 🙂 What if there are no windows, how would you do it?</p></blockquote>
<p>I would suggest moving one&#8217;s stereo up close to the window and playing at full bore the latest and greatest from the hallowed halls of <a href="http://en.wikipedia.org/wiki/Death_metal" rel="nofollow ugc">Death Metal</a>. <a href="http://en.wikipedia.org/wiki/John_Batchelor" rel="nofollow ugc">John Calvin Batchelor</a> in his 1980 novel <em>The Further Adventures of Halley&#8217;s Comet</em> had one character do precisely that &#8211; though with <em>The Who</em> rather than Death Metal &#8211; to someone attempting to murder him.</p>
<p>I suppose that would fall into the realm of Psychological Warfare, rather than OPSEC, because by playing Death Metal at full bore, you are actively attempting to induce suicidal depression in a hostile, rather than preventing said hostile from interfering with your home environment. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224283">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224283">
						June 10, 2014 3:36 AM					</a>

				</p>

				<p>@Question</p>
<p>I suggest you go to gpg4win.org and install their program. During installation, select from the options only the core gnuPG, Kleopatra, GpgEX and the compendium (help files).</p>
<p>gnuPG &#8211; core + command line capabilities<br />
Kleopatra &#8211; GUI for key generation and management, files enc/dec and signing<br />
GpgEX &#8211; allows enc/dec and signing from the context menu of the Win Explorer</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224284">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224284">
						June 10, 2014 4:14 AM					</a>

				</p>

				<p>@Wael and others,</p>
<p>Whilst space telescopes are fantastic people tend to forget why they are up there when mountain top real estate would be cheaper easier and a lot more conveniant.</p>
<p>The answer is important because of the effect it has on spy sats looking downwards to earth.</p>
<p>Even on the clearest and calmest of days the earths atmosphear is a very active and turbulant place. It&#8217;s the reason stars twinkle, shimmer and distort in various other ways.</p>
<p>Back last century a group of scientists in africa demonstrated a heated air lense. Essentialy all it was was an open pipe spun coaxialy at speed with an intense heat source applied to the middle. This caused the air inside to bend light sufficiently to make the object lense of a crude telescope.</p>
<p>Again thinking in reverse you can see why spy sats have a number of issues with these atmospheric optical effects.</p>
<p>Even a few years ago they represented what many regarded as an insumountable barrier to what spy sats could see and focus on, and it looked like reading the brand off of cigeret packets would not be possible. Well it turns out &#8211;as is often the case&#8211; what nature can do man can undo with sufficient computing power and whilst newspaper print is still belived to be beyond such techniques centimetre resolving is commercialy possible. However the likes of the NRO have also looked at the issue another way which is with drones. A UK defense contractor used a few hundred mobile phone cameras in an array such that resolving to less than 15CM whilst covering a 40 square mile area can be done from a drone or helicoptor mounted pod&#8230;</p>
<p>So settle back with a nice cup of Brownian motion producer and start thinking hinky about say bouncing lasers of car roofs, or even street trash such as thrown away soft drinks cans. Because you can make a reasonable bet, that if you can think that way, so can others who would also love to get a nice fat slice of DHS Pork to flesh them out.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224285">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224285">
						June 10, 2014 6:38 AM					</a>

				</p>

				<p>@ Clive<br />
Speaking of satellites&#8230;</p>
<p>A few years back worked on a satellite platform, SSMIS, that used some interesting method to integrate EM sources on the host platform. The size of the system is essentially a floating tractor-trailer container. NASA and NOAA have information on the platform and the platform operation is detailed to some level. I worked with the original design engineer/scientist, learning what approach from an architectural perspective to achieve design objectives. Had a chance to review and comment on the &#8220;replacement&#8221; system, wrote a report for program management and essentially shoot myself in the foot&#8211;told them what they didn&#8217;t want to hear.</p>
<p>The report described the problem with the implementation and components, designed based on the tool (in this case, Labview) constrained any attempt to meet the design criteria. Design should drive the technological decisions&#8230;not the other way around. The report also suggest an approach that could serve both the platform performance requirements and add some flexibility with respect to implementation and the production engineering process.</p>
<p>One interesting thing, the new platform survived and the report that detailed a way forward fell to the floor&#8211;part of what made this possible was the classified status of the program. Shedding any light on this would have made these choices difficult to defend.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224286">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224286">
						June 10, 2014 7:29 AM					</a>

				</p>

				<p>Clive: I too expect the foam is primarily for EM absorption, after thinking about it.</p>
<p>nwfor/clive: I have seen amateur sat tracking stations that can attain quite respectable accuracy. Would it not be outside the realm of science fiction to create a directed energy &#8211; perhaps a nice big magnetron focused in a narrow beam &#8211; to damage/destroy the satellite&#8217;s sensitive RX equipment?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224287">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224287">
						June 10, 2014 7:56 AM					</a>

				</p>

				<p>@Mike the goat,</p>
<blockquote><p>s/Curve/ED/g</p></blockquote>
<p>Awww, poor goat! I hear something that rhymes with Niagara can help 😉</p>
<p>Re: Foam. Yes, it&#8217;s used for sound and EM absorption in shielded enclosures<br />
@Clive Robinson,.</p>
<blockquote><p>So settle back with a nice cup of Brownian motion producer </p></blockquote>
<p>Sounds good! I&#8217;m in the mood for a cup of Turkish chaos this AM.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224288">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224288">
						June 10, 2014 8:16 AM					</a>

				</p>

				<p>@name.withheld.for.obvious.reasons,</p>
<blockquote><p>One interesting thing, the new platform survived and the report that detailed a way forward fell to the floor&#8211;part of what made this possible was the classified status of the program. Shedding any light on this would have made these choices difficult to defend.</p></blockquote>
<p>It&#8217;s a wide spread problem. The NIH symptom. You needed a godfather there!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224289">

			<div class="comment by-autolykos ">

				<p class="commentcredit">

					<span class="commenter">Autolykos</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224289">
						June 10, 2014 8:27 AM					</a>

				</p>

				<p>@Mike: That beam probably won&#8217;t stay focused all the way up to space. Wave optics is a female dog.<br />
You could probably compensate by using a phased array (which would be huge), or just saturate the general area of the satellite with way too much power, but either way it won&#8217;t be long until your efforts are discovered and located.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224290">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224290">
						June 10, 2014 8:29 AM					</a>

				</p>

				<p>@Clive Robinson, all</p>
<blockquote><p>what nature can do man can undo with sufficient computing power and whilst newspaper print is still belived to be beyond such techniques centimetre resolving is commercialy possible&#8230;</p></blockquote>
<p>Another fascinating example is the use of sound transducers in the ocean to pinpoint objects. The idea was to arrange several thousand microphones in the ocean, then calibrate them by making some noise at various locations in the ocean, say with a small explosive. When the calibration is done, the reverse can be achieved by replaying the recordings (with the proper amplification and phase) &#8211; the computing power you talk about &#8211; to focus the sound energy at arbitrary locations in the ocean. I believe the same technique is used for shattering kidney stones using ultrasonic waves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224291">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224291">
						June 10, 2014 8:47 AM					</a>

				</p>

				<p>Autolykos: I realize that we are probably talking on the order of thousands of watts eirp, but am pondering just whether it is conceivable. I imagine it would be easier than trying to physically deorbit the thing&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224292">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224292">
						June 10, 2014 11:53 AM					</a>

				</p>

				<p>Wow, it got crazy in here since I was gone.</p>
<p>@ Mike the goat</p>
<p>A list of pro&#8217;s and con&#8217;s of each would be a start. Then, people here might review and offer a suggestion. The first thought I have is NaCl implements a clever, timing channel mitigation. I hope your alternative thought that far. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224293">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224293">
						June 10, 2014 4:01 PM					</a>

				</p>

				<p>Another whistleblower?</p>
<p><a href="http://cryptomeorg.siteprotect.net/dea-nsa-sandkey.pdf" rel="nofollow ugc">http://cryptomeorg.siteprotect.net/dea-nsa-sandkey.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224294">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224294">
						June 10, 2014 4:07 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>You might find this of interest,</p>
<p><a href="http://michaelrbernste.in/2014/06/10/types-are-the-truth.html" rel="nofollow ugc">http://michaelrbernste.in/2014/06/10/types-are-the-truth.html</a></p>
<p>Also the home page of the author of the book the above is based on will almost certainly be of interest, not just to you but to several others, especialy as the author has a newer book you can download as well as some security related stuff of interest.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224295">

			<div class="comment by-david-c ">

				<p class="commentcredit">

					<span class="commenter">David C.</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224295">
						June 10, 2014 4:27 PM					</a>

				</p>

				<p>@ Clive Robinson, Jacob</p>
<p>You made many interesting points. Hard to counter them. Correct me if I am wrong but I thought Snowden&#8217;s leaks were mainly up to the Top Secret level not compartmented. There may be much more secret capabilities we are unaware of.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224296">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224296">
						June 10, 2014 4:33 PM					</a>

				</p>

				<p>@ Nick P and others 🙂</p>
<p>It would appear that Microsoft are trying to shut the visual stable door long after the insecure C nag has bolted,</p>
<p><a href="http://blogs.msdn.com/b/vcblog/archive/2014/06/10/the-great-crt-refactoring.aspx" rel="nofollow ugc">http://blogs.msdn.com/b/vcblog/archive/2014/06/10/the-great-crt-refactoring.aspx</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224298">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224298">
						June 10, 2014 5:16 PM					</a>

				</p>

				<p>@ David C,</p>
<p>The difference between secret and code word level is usually more to do with the &#8220;circulation list&#8221; than it is technology.</p>
<p>Thus take something like signals analysis, what is required to direction find a mobile phone user is open knowledge, specific equipment to do it might be classified at secret, however a project to use the equipment to kill &#8220;persons of interest&#8221; in a specific class (drugs/terrorism) would almost certainly be code word or above classified.</p>
<p>Out side of abstract fields of endevor such as crypto math, most technology has to follow the well known &#8220;laws of nature&#8221; such as conservation of energy, energy/mass equivalence, speed of light and basic forces irrespective of who is using it (it&#8217;s why classifing some types of technology such as TEMPEST is fairly pointless as it can all be worked out from first principles by those with graduate level knowledge in the basic sciences).</p>
<p>The exception is where nobody has bothered actually doing rsearch into a particular sub field.</p>
<p>For instance we know that if you can generate a voltage or current at the input to a circuit then you can change it&#8217;s behaviour. We also know that EM radiation will be picked up by conductors, and if a semiconductor device is connected a junction will either act as a diode or a square law device, which will have the effect of rectifing EM induced currents/voltages, thus giving us the voltage/current that will disturbe the intended circuit function.</p>
<p>We have known since the late 1800&#8217;s / early 1900&#8217;s that not only are circuits suseptable to EM radiation they will also couple even very low frequency EM energy from one conductor to another in what engineers have long called &#8220;cross talk&#8221;.</p>
<p>Thus it does not take to much imagination to realise that EM radiation that impinges onto a conductor, will by the process of back EMF etc be reradiated, but importantly modulated by the &#8220;secret signals&#8221; in the circuit. This goes by various names and if you look on the internet at TEMPEST related sites you will come across the code words HIJACK &amp; TEAPOT which are supposadly related to the exploitation of this effect.</p>
<p>However with a little further thinking you will realise that if the EM signal is modulated in some way, then this modulation waveform will be demodulated by the circuit. Thus you can inject complex waveforms into a circuit. Thus if you have a way to synchronise the modulated waveform with the circuits operation you can inject tailored faults into it.</p>
<p>As far as I&#8217;m aware little or no research in this area has been undertaken by those in the academic community, so there is little in the way of published information. However I was exploiting this back in the 1980s to get at electronic wallets and pocket gambeling machines. And from discussions with others it appears other design engineers had come across the problem and one or two like me had investigated further.</p>
<p>It is I think unlikly that the intel community has not researched into this area as &#8211;as I&#8217;ve indicated befor&#8211; I&#8217;d demonstrated it to them back in the 1980s.</p>
<p>Thus whilst they might appear to have some secret advantage &#8211;that might apear akin to magic&#8211;, the reality is there is nothing secret about it, it&#8217;s just a matter of joining the dots from well known engineering issues going back more than a century.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224299">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224299">
						June 10, 2014 6:44 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;The &#8220;best&#8221; example of this maintainability problem could be found in the old implementation of the printf family of functions. The CRT provides 142 different variations of printf, but most of the behavior is the same for all of the functions, so there are a set of common implementation functions that do the bulk of the work. These common implementation functions were all defined in output.c in the CRT sources(1). This 2,696 line file had 223 conditionally compiled regions of code (#ifdef, #else, etc.), over half of which were in a single 1,400 line function. This file was compiled 12 different ways to generate all of the common implementation functions. Even with the large number of tests that we have for these functions, the code was exceedingly brittle and difficult to modify.&#8221;</p>
<p>Good Lord&#8230; The following paragraphs show they&#8217;re doing great work at the refactoring. Work like this has earned them good comments from me over past few years as they&#8217;re trying hard to improve their software. I&#8217;m looking forward to see that new system language they&#8217;re working on. I wonder if they&#8217;re just focusing on new software development or hoping to use it for legacy rewrites too.</p>
<p>re Type Erasure</p>
<p>It&#8217;s interesting stuff. The full impact might take a while to happen for me. <a href="https://en.wikipedia.org/wiki/Typed_lambda_calculus" rel="nofollow ugc">Related</a> note due to his mentions of lambda calculus. The more interesting (and useful) concept to me is keeping types throughout the compilation to assembler to improve performance, safety, and security. The this old <a href="http://flint.cs.yale.edu/shao/papers/pccwhite/" rel="nofollow ugc">proposal</a> from the FLINT project summarizes many uses and approaches. Of course, once it gets to the assembler and linker we can apply type erause to get rid of the types. Unless the machine code is one of those tagged (i.e. typed) ISA&#8217;s I like. Then, the types stay and get enforced by hardware during runtime. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224300">

			<div class="comment by-wesley-parish ">

				<p class="commentcredit">

					<span class="commenter">Wesley Parish</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224300">
						June 10, 2014 6:49 PM					</a>

				</p>

				<p>Interesting!!! Washington Post publishing NSA&#8217;a claims that <a href="http://www.washingtonpost.com/blogs/the-switch/wp/2014/06/09/nsa-our-systems-are-so-complex-we-cant-stop-them-from-deleting-data-wanted-for-lawsuit/" rel="nofollow ugc">the NSA doesn&#8217;t have the wits to organize a fsckup in a brothel! Or a pisstake in a brewery!</a></p>
<p>Who&#8217;d a thunk it! No wonder Snowden walked off with what he did. NSA OPSEC must be like that old hymn:</p>
<blockquote><p>Holey, wholly holey &#8230;<br />
Lord God Almighty!</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224301">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224301">
						June 10, 2014 7:04 PM					</a>

				</p>

				<p>Nick: I guess &#8211; fundamentally &#8211; it is a about balancing whether to use something everyone knows, loves and understands (ECDSA) vs something that appears to be superior in terms of key length and other attributes yet isn&#8217;t quite as battle proven.</p>
<p>I believe I will be proceeding using ED25519. The advantages can&#8217;t be ignored, and as we have discussed before &#8211; the whole purpose of blogsig is to balance assurance against convenience with an emphasis on the latter.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224302">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224302">
						June 10, 2014 7:32 PM					</a>

				</p>

				<p>@ Mike the goat</p>
<p>Seems like a wise choice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224303">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224303">
						June 10, 2014 8:55 PM					</a>

				</p>

				<p>@ Clive Robinson, Wael, Mike</p>
<p>Found a nice C to FPGA compiler here:</p>
<p><a href="http://c-to-verilog.com/index.html" rel="nofollow ugc">http://c-to-verilog.com/index.html</a></p>
<p>They have examples like Ethernet and SHA-1. I&#8217;m wondering how useful it would be for prototyping safe processor designs. They&#8217;re a bit more complex than the examples given. Yet, when it comes down to it, they&#8217;re just state machines [possibly composed of other state machines].</p>
<p>I&#8217;m already aware of options such as SystemC. I&#8217;m just seeing how much closer it can be pushed to normal programming while still being synthesizable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224304">

			<div class="comment by-rick ">

				<p class="commentcredit">

					<span class="commenter">Rick</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224304">
						June 10, 2014 9:14 PM					</a>

				</p>

				<p>It looks like OPENSSL_indirect_call, the &#8220;undocumented ROP function&#8221; mentioned in previous posts on this thread was indeed written by Andy Polyakov and has been in place since 2005.</p>
<p>OpenSSL_indirect_call:<br />
<a href="http://freshbsd.org/commit/openbsd/f868fc6f39a2c45a6c2bab70addc92525d467904" rel="nofollow ugc">http://freshbsd.org/commit/openbsd/f868fc6f39a2c45a6c2bab70addc92525d467904</a></p>
<p>Email from Andy Polyakov:<br />
<a href="http://marc.info/?l=openssl-cvs&#038;m=113361101503116" rel="nofollow ugc">http://marc.info/?l=openssl-cvs&#038;m=113361101503116</a></p>
<p>OpenSSL needs to be purged. Someone with greater influence than myself has a solemn duty to expose these (intentionally introduced) flaws and assist with the cleanup effort. I&#8217;m willing, but I wield little to no resources and/or influence over the matter.</p>
<p>Thoughts?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224305">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224305">
						June 10, 2014 9:14 PM					</a>

				</p>

				<p>Compromising reflections: How to read computer monitors around a corner</p>
<p><a href="http://www.infsec.cs.uni-saarland.de/projects/reflections/" rel="nofollow ugc">http://www.infsec.cs.uni-saarland.de/projects/reflections/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224306">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224306">
						June 10, 2014 10:54 PM					</a>

				</p>

				<p>So much radio, woohoo! My kind of thread.</p>
<p>Mike the goat RE: satellite beams<br />
&#8211;Won&#8217;t help you take down a satellite lol (way too destructive for me) but I&#8217;m sure you could whip up a quick antenna, something like <a href="http://ve2zaz.net/Arrow_Ant/Arrow_sky.jpg" rel="nofollow ugc">this</a>, there&#8217;s much better (looking) ones, and these are some of my favorite kinds of antennas rather than something like a <a href="http://www.hamradio.co.za/iMAGES/A4S.jpg" rel="nofollow ugc">4 element tribander</a>, but the weird ones catch different waves.  Then you need internet to get the timing right on whatever Sat you want to contact and it&#8217;s a pileup.</p>
<p>BTW, don&#8217;t know if you intended or it&#8217;s just another thing on my end, but your blog had quite the interesting picture:  <a href="http://prntscr.com/3ro4rf" rel="nofollow ugc">http://prntscr.com/3ro4rf</a>    Freaky, to say the least.</p>
<p>Nick P<br />
&#8211;Neat link on reflections, creepy of course too&#8230;</p>
<p>Now to do my best Nick P act (I&#8217;d have to talk about type-safety and BASIC boobs though to really sell it :p), found some random links when an inverter caught my eye (have no affiliation w/ site nor any of the companies):</p>
<p><a href="http://www.electronicproducts.com/Digital_ICs/Microprocessors_Microcontrollers_DSPs/Security_chip_protects_connected_electronics.aspx?id=264#.U5eQM7em4-5" rel="nofollow ugc">The OPTIGA Trust P (SLJ 52ACA) 16-bit Common Criteria EAL 5+ certified programmable security controller chip</a>.</p>
<p><a href="http://www.electronicproducts.com/Analog_Mixed_Signal_ICs/Standard_Linear/Op-amp_noise_sources_and_minimizing_system_noise.aspx?id=264#.U5eQt7em4-5" rel="nofollow ugc">Op-amp noise sources and minimizing system noise</a></p>
<p><a href="http://www.electronicproducts.com/Digital_ICs/Microprocessors_Microcontrollers_DSPs/8-bit_MCU_handles_safety_critical_applications.aspx?id=264#.U5eQ_rem4-5" rel="nofollow ugc">8-bit MCU handles safety critical applications</a></p>
<p><a href="http://www.electronicproducts.com/Digital_ICs/Communications_Interface/Secure_Hardware_and_Software.aspx?id=264#.U5eRZLem4-5" rel="nofollow ugc">Secure Hardware and Software</a></p>
<p>Rick<br />
&#8211;It doesn&#8217;t matter how much resources or influence you have, that you&#8217;re willing to help does though, a lot.  There&#8217;s always something to do, always.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224307">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224307">
						June 10, 2014 11:45 PM					</a>

				</p>

				<p><i>NSA: Our systems are so complex we can’t stop them from deleting data wanted for lawsuit</i></p>
<p><a href="http://www.washingtonpost.com/blogs/the-switch/wp/2014/06/09/nsa-our-systems-are-so-complex-we-cant-stop-them-from-deleting-data-wanted-for-lawsuit/" rel="nofollow ugc">http://www.washingtonpost.com/blogs/the-switch/wp/2014/06/09/nsa-our-systems-are-so-complex-we-cant-stop-them-from-deleting-data-wanted-for-lawsuit/</a></p>
<p>So complex that it&#8217;s worthless and the analysts are just getting flooded w/ data and there&#8217;s no usable intelligence.  We know.  Oh and one of your people just walked out the building and off to RUSSIA w/ an unknown amount of data and you wouldn&#8217;t have known about it if he didn&#8217;t speak up&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224308">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224308">
						June 11, 2014 12:01 AM					</a>

				</p>

				<p>@Figureitout,</p>
<blockquote><p>and you wouldn&#8217;t have known about it if he didn&#8217;t speak up&#8230;</p></blockquote>
<p>Good point. What if someone already did and kept silent?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224309">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224309">
						June 11, 2014 12:08 AM					</a>

				</p>

				<p>@Nick P,<br />
Re:reflections&#8230;<br />
I have seen this type of spying a while back. Can&#8217;t find the link, but the demo used a spoon or a tea cup for reflection. It&#8217;s why high security buildings have no windows and are shielded. That&#8217;s why people cover their mouths when they talk, so no one reads their lips from far away&#8230; But we know that from movies.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224310">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224310">
						June 11, 2014 12:36 AM					</a>

				</p>

				<p>@Rick,<br />
Re OpenSSL&#8230;<br />
I don&#8217;t see this as the only way to accomplish the advertised reason. Why not simply have a conditional #IF DEF for Various OS&#8217;s? Whenever inline assembly is embedded with a &#8220;justification&#8221; one should be suspicious. Sometimes this tactic is used to avoid flagging by a static analysis tool &#8212; in the deliberate case. Sometimes developers try to be clever and introduce holes unintentionally. You can checkin code, or become a maintainer, which I suspect you already are, but maybe for a different component. By the way, where in the code was it returning to libc rather than libcrypto? I think I mentioned before that Macros are evil, so is undocumented in-lined assembler. And developers who write self-modifying code need to be&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224311">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224311">
						June 11, 2014 12:45 AM					</a>

				</p>

				<p>@ Wael</p>
<p>I mentioned here a while back I read an article describing something similar. Spy claimed he put a reflective, decorative sphere in the room with target computer during a visit. (Paperweight? Shrugs) Then, they aimed a telescope at it from an adjacent building to see reflection of monitor and keyboard. That&#8217;s what he claimed anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224312">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224312">
						June 11, 2014 12:51 AM					</a>

				</p>

				<p>@Nick P,<br />
Right! It was you. Perhaps looking at the &#8220;milk of amnesia label is effective&#8221; 🙁<br />
When we read a lot we sometimes forget who the originator was. My apologies&#8230;<br />
Hopefully I didn&#8217;t get anyone upset with my sense of humor. When it&#8217;s late at night I get a little goofy&#8230; I know I got someone upset &#8212; unintentionally&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224313">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224313">
						June 11, 2014 1:31 AM					</a>

				</p>

				<p>@Figureitout,<br />
Thanks for the OPTIGA link. Was looking for a PUF type device &#8211; Physically Unclonable Function. Seems this chip contains a combination of some TPM functionality in addition to some GP functions. Took a glance at the data sheet, and it may work 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224314">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224314">
						June 11, 2014 2:11 AM					</a>

				</p>

				<p>@Wael, about OpenSSL #ifdefs</p>
<p>They have #ifdefs for everything. If the lib could make coffee, there would be an #ifdef for cappuccino, mokka, sugar, cream etc.</p>
<p>You can write a book about OpenSSL. Heck, you can make a textbook of how not to write code AND you can make a fictional detective about OpenSSL like a Frederick Forsyth book at the same time.</p>
<p>But&#8230;</p>
<p>The preprocessor is a part of the fundamental weaknesses of C and C++.</p>
<p>Bjarne Strousstrup (who is never abbreviated) made a funny remark at Lang.NEXT last week. The ISO committee came to the conclusion that C++ should have modules.</p>
<p>AFTER 25 YEARS!!!</p>
<p>Why are modules such a game changer? The flat scope of C and C++ allow macros to have a global reach. Macros can be controlled by header files, makefiles, M4 and in the C files. I have seen projects where the order of header file inclusion changed the program. If modules in C++ is implemented right, macros are only influential in the current module because of namespaces and that is the way you want it. With modules header file inclusion is obsolete, so that problem is solved as well. It also changes makefiles, drastically reduces compile times etc.</p>
<p>Modules in C++ is probably part of C++17. I don&#8217;t know whether it will be part of C.</p>
<p>Returning to the #ifdefs. They are just a nasty piece of history. It is a shame that in all this time the industry didn&#8217;t look forward to develop a decent replacement of C. While Wirth keep on developing his languages, from Pascal to Modula and Oberon, C only got minor changes and non of these changes tackled the fundamental problems of C.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224315">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224315">
						June 11, 2014 2:44 AM					</a>

				</p>

				<p>@Gerard van Vooren,</p>
<blockquote><p>They have #ifdefs for everything&#8230;</p></blockquote>
<p>I got the point you have against C, and I more or less agree. I was not arguing  for or against &#8220;C&#8221;. I was trying to argue that this indirect call looks suspicious with a seemingly lame excuse given that there are other known ways of handling it through a preprocessor directive &#8212; regardless of the goodness or weakness of the language. Until a &#8220;safe&#8221; language is adopted, we&#8217;ll continue to talk about the reasons some bugs have security implications, and whether circumstantial evidence point to &#8220;foul play&#8221;. The alternative is we just say:Well, see, &#8220;C&#8221; sucks &#8212; use something else. This will not happen overnight, and until then we&#8217;ll be talking about cappuccino, mokka, sugar, cream etc, so to speak&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224316">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224316">
						June 11, 2014 3:00 AM					</a>

				</p>

				<p>@Gerard van Vooren,<br />
By the way,</p>
<blockquote><p>Why are modules such a game changer&#8230;It also changes makefiles, drastically reduces compile times etc.</p></blockquote>
<p>I also agree with you on that part! and I&#8217;ll add that make files are another evil because you can do nasty things in them as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224317">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224317">
						June 11, 2014 3:16 AM					</a>

				</p>

				<p>Truecrypt 7.1a verified copies are out: <a href="https://twitter.com/OpenCryptoAudit/status/476192449614708736" rel="nofollow ugc">https://twitter.com/OpenCryptoAudit/status/476192449614708736</a></p>
<p>My Truecrypt tutorial will continue on.</p>
<p>Next tutorial topic I will release is using Truecrypt as a crypto-container to store GPG keyrings.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224318">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224318">
						June 11, 2014 8:05 AM					</a>

				</p>

				<p>figureitout: yeah, it is intended. I got sick of the wordpress default images. If you are interested, the montage is of (from left to right) &#8211; ascii art of goats, random hexdump, RSA in Perl (top), decss in perl (bottom), minix tcp stack sha256.c. Random, eh? 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224319">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224319">
						June 11, 2014 8:37 AM					</a>

				</p>

				<p><a href="http://www.nytimes.com/2014/06/11/technology/microsoft-protests-order-for-email-stored-abroad.html" rel="nofollow ugc">Microsoft Protests Order to Disclose Email Stored Abroad</a></p>
<p><i>Privacy experts are concerned that the judge’s order, if it stands, will open the gate to unchecked investigations in the digital world, of anyone, anywhere. “United States search warrants do not have extraterritorial reach,” said Lee Tien, a lawyer for the Electronic Frontier Foundation. “The government is trying to do an end run.” But the Justice Department asserts that Microsoft is stretching the law. In a filing, Preet Bharara, United States attorney for the Southern District of New York, described the company’s analogy between physical search warrants and digital ones as “misguided,” and said Internet companies cannot avoid complying with a search warrant “simply by storing the data abroad.”</i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224320">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224320">
						June 11, 2014 10:12 AM					</a>

				</p>

				<p>@ Figureitout</p>
<p>Trying to act like me, huh? Where&#8217;s the solid frameworks, identification of threats 10 years out, and effective solutions to existing ones? Absent? Oh my, it must be an imposter! 😉</p>
<p>OPTIGA is interesting for its feature set. The assurance level is the minimum required for smartcards and security controllers. Infineon can do EAL5+ in their sleep. The noise sources link is nice as it briefly lists and describe the common sources people run into. I didn&#8217;t even know there was an 8-bit MCU for safety-critical. I keep it at 16-bits or higher, but I&#8217;ll give it to some people I know that do 8-bit work. I&#8217;ve never seen 8-bit developers caring much about safety though. (hmmm)</p>
<p>The last link I have mixed feelings about. It mentions that they&#8217;re getting concerned with security in microcontrollers. They&#8217;re adding things like firewalls. The other aspect is over the years they&#8217;ve been adding functionality such as embedded networking stacks. The problem is much of this is <em>features</em> whereas security comes from assurance arguments based on good engineering. I doubt an embedded, microcontroller has a secure anything if it&#8217;s network or filesystem related as it&#8217;s hard enough to do with a powerful desktop CPU. So, such products are a double-edged sword for me: (a) I can isolate more functionality onto dedicated chips because there&#8217;s new cheap chips with onboard support for certain things; (b) the chips themselves will have vastly more attack surface and I probably can&#8217;t effectively audit that.</p>
<p>So, first three links are nice. Last one is maybe a sign of bad things to come.</p>
<p>@ Wael</p>
<p>Yeah, the chip runs that <em>Java</em> platform you all like so much. 😛 In the past, I always said I&#8217;d rather have an assured OS such as MULTOS on such a chip. I updated that to JavaCard when Gemalto (Gemplus?) got their JVM to EAL7 to match MULTOS&#8217;s assurance. (Product was EAL5+, VM EAL7) I wonder what the assurance is of Infineon&#8217;s JavaCard 3.0.4 OS. We know they assure the hardware well, but software is said to be a significant attack vector these days. It pays to put effort into it.</p>
<p>Tried to find its JavaCard evaluation status with a quick Google. Instead, I found a job ad from Infineon for JavaCard programmers working in India for $11,800 a year. A guy I know outsourcing development of school software paid around $16,000 a year. Probably a good sign for security and quality of the software, yeah? 😉</p>
<p>@ Mike</p>
<p>Yeah, you&#8217;re goat ASCII art is awesome. I laughed my butt off when I saw it.</p>
<p>@ All</p>
<p>Check out the show Silicon Valley which parodies startups, billionaires, and programmers in the same area. The main criticism is there wasn&#8217;t enough character development and they opted for common stereotypes instead. Sure enough. Yet, two to three episodes in it was good enough to keep watching and got better over time. Also had a few truly original and hilarious moments I won&#8217;t spoil.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224321">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224321">
						June 11, 2014 11:21 AM					</a>

				</p>

				<p>@Wael: &#8220;trying to argue that this indirect call looks suspicious with a seemingly lame excuse given that there are other known ways of handling it through a preprocessor directive&#8221;</p>
<p>Well, as someone who has used the Windows API, I can tell you that the comment of Andy Polyakov seems to be complete nonsense for me.<br />
 Polyakov writes:</p>
<p>&#8220;-# This function can become handy under Win32 in situations when<br />
-# we don&#8217;t know which calling convention, __stdcall or __cdecl(*),<br />
-# indirect callee is using. In C it can be deployed as&#8221;</p>
<p>The calling convention of a function is in its header. If you use the winapi, then it uses stdcall. All this is defined in the windows headers. If you call this functions from a C program, then the compiler should automatically take care of all this. I have written some dlls on windows, and I never needed such a thing like Andy Polyakov wrote in his function &#8220;Openssl_indirect_call&#8221;.</p>
<p>Polyakov says this would be usefull when you do not know the calling convention of something. But since this calling convention is in the c header, when does it happen when you do not know the calling convention?</p>
<p>Well, I say that if you have good intentions, then you do not call something whose definition you do not know.</p>
<p>In fact only a hacker usually does not know the exact function header of something, as he does not have the function header of the box he&#8217;s hacking into.</p>
<p>As a result, the hacker has to start his hack with function that is exactly like the code which Polyakov has written in &#8220;Openssl_indirect_call&#8221;. So even the comment from Polyakov himself, where he introduced this function indicates that this was implemented as some help for hacking purposes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224323">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224323">
						June 11, 2014 11:43 AM					</a>

				</p>

				<p>@Benni,</p>
<blockquote><p>when does it happen when you do not know the calling convention?&#8230;</p></blockquote>
<p>Totally agree, it can happen when the developer is developing his code on an OS for a different target OS. If he developped this on Linux and is not familiar with Windows, I can find a minor execuse. I can also find another &#8220;minor&#8221; execuse for him if he claimed &#8220;compatibility with diffferent compilers&#8221;, which peggs the <a href="http://media.photobucket.com/user/JRLloydIII/media/WebStuff/insults/bullshit-meter-011.gif.html?filters[term]=bovine%20excrement&amp;filters[primary]=images&amp;filters[secondary]=videos&amp;sort=1&amp;o=2#/user/JRLloydIII/media/WebStuff/insults/bullshit-meter-011.gif.html?filters%5Bterm%5D=bovine%20excrement&amp;filters%5Bprimary%5D=images&amp;filters%5Bsecondary%5D=videos&amp;sort=1&amp;o=2&amp;_suid=140250478383407764196061785773" rel="nofollow ugc">Bullsh** scale.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224324">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224324">
						June 11, 2014 12:17 PM					</a>

				</p>

				<p>Nick: I am glad to hear that you enjoyed it. There is nothing like an ASCII goat (or an ASCII <a href="http://www.retrojunkie.com/asciiart/animals/squid.htm" rel="nofollow ugc">squid</a> for that matter) to cheer everyone up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224325">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224325">
						June 11, 2014 12:27 PM					</a>

				</p>

				<p>@Mike the goat,<br />
I liked it as well&#8230; Horn equipped too 🙂</p>
<p>@ Benni,<br />
There is another possibility this function was added for instrumentation. The comment doesn&#8217;t support this hypothesis, though. I really haven&#8217;t looked closely at this, and I&#8217;ll do so when I have the chance. So I&#8217;ll stop at saying it looks suspicious, at the moment. Now I am convinced that &#8220;Open source&#8221; doesn&#8217;t add much more security than &#8220;Closed Source&#8221;. We had this discussion previously. I don&#8217;t have the time to embed the link, but will follow up at a later time&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224326">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224326">
						June 11, 2014 1:58 PM					</a>

				</p>

				<p>@Wael:<br />
Yes the function does not only look suspicious, it is suspicious.</p>
<p>And no, the argument of not being familiar with an OS is no excuse for writing such a function.<br />
Even if you are not familiar with windows, you have to include the windows headers in your program, whenever you want to call a function of them.</p>
<p>Then, the Compiler recognizes the calling convention in the windows headers and you do not need to think at all about any &#8220;calling convention&#8221;. You can call these functions like ordinary C functions. That there are different rules for the order of what is put in the stack does not need to concern you at all, since the compiler does all this thinking for you, once you have the headers.</p>
<p>But now assume you want to attack some closed system. Then you would want to call some functions, where you, with certainty, do not have any C header. That is what a hacker does. Only a hacker does call some function from which he does not know the calling convention. With that comment</p>
<p>&#8220;-# This function can become handy under Win32 in situations when<br />
-# we don&#8217;t know which calling convention, __stdcall or __cdecl(*),<br />
-# indirect callee is using. In C it can be deployed as&#8221;</p>
<p>Poyakov basically says that he intended with this function to help people whose aim is to attack and hack into some computers running openssl.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224327">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224327">
						June 11, 2014 2:19 PM					</a>

				</p>

				<p>@Benni,<br />
Have you downloaded the source code, built it and tried to call the function? At the surface of it, I see a potential buffer overflow deliberate vector. I haven&#8217;t validated that &#8220;max&#8221; is used properly  throughout rest of the calculations. When I have the time, I&#8217;ll go through the exercise.</p>
<p>@Rick,<br />
Any insight you can shed on this? Have you seen an exploitation, or experimented with one? Can save us some time 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224328">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224328">
						June 11, 2014 2:21 PM					</a>

				</p>

				<p>@Benni,</p>
<p>I looked at the module code, not just the diff, It&#8217;s perl code. Changes the view a little &#8212; will still look at it 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224329">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224329">
						June 11, 2014 3:47 PM					</a>

				</p>

				<p>@Benni, @Rick,</p>
<p>The function was removed. I didn&#8217;t even pay attention to that, curtesy of insomnia and a nice tooth ache. I think I understand now the answer to my previous question about how the function returns to libc instead of libcrypto where proper handling of buffer overflows can be handled.  False alarm, Rick &#8212; It has been removed, just make sure its not in the version you are using&#8230;<br />
Also keep unto date with the security advisories they have there: <a href="http://www.openssl.org" rel="nofollow ugc">http://www.openssl.org</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224330">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224330">
						June 11, 2014 8:31 PM					</a>

				</p>

				<p>Eleventh Circuit decision that warrantless cell phone tracking violates the 4th Amendment: <a href="https://www.aclu.org/sites/default/files/assets/q_davis_opinion.pdf" rel="nofollow ugc">United States v. Davis</a>.</p>
<p>The decision drew on the Jones case which was previously discussed on this blog <a href="https://www.schneier.com/blog/archives/2012/01/supreme_court_r.html" rel="nofollow ugc">here</a>. And , maybe more importantly, didn&#8217;t follow the logic of other earlier cases e.g. Smith v. Maryland.</p>
<p>Jennifer Granick discusses the case  and implications for NSA&#8217;s bulk metadata collection programs <a href="http://justsecurity.org/11520/eleventh-circuit-warrantless-cell-tracking-calls-metadata-programs-question/" rel="nofollow ugc">here</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224332">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224332">
						June 11, 2014 10:51 PM					</a>

				</p>

				<p>OFF Topic :</p>
<p>ARStechnica plays the role of the NSA for a week against an NPR reporter.</p>
<p><a href="http://arstechnica.com/security/2014/06/what-the-nsa-or-anyone-can-learn-about-you-from-internet-traffic/" rel="nofollow ugc">http://arstechnica.com/security/2014/06/what-the-nsa-or-anyone-can-learn-about-you-from-internet-traffic/</a></p>
<p>It&#8217;s quite an interesting read.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224334">

			<div class="comment by-rick ">

				<p class="commentcredit">

					<span class="commenter">Rick</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224334">
						June 11, 2014 11:03 PM					</a>

				</p>

				<p>@Wael,@Benni,</p>
<p>Thank you for your expertise&#8211; both of you. I am not a coding pro; rather, I have scripted a bit since I was once a data analyst for an AI/data modeling shop in Seattle in another life. Now I&#8217;m the 47 year old owner of a small networking shop. In these last 14 months or so, I have turned all of my spare time and attention to the subject of infosec, encryption, crypto, privacy, etc. I&#8217;m still learning and I&#8217;m benefiting from the process.</p>
<p>The fact that the function (openssl_indirect_call) was included at all is a testament to the fact that 1) open source can indeed be as surly and difficult as closed source on many levels 2) Andy Poyakov&#8217;s future coding efforts should be treated with reasonable suspicion (I largely agree with Benni&#8217;s hypothesis on this point), 3) Andy P&#8217;s efforts to audit OpenSSL should also be treated with suspicion (<a href="http://arstechnica.com/information-technology/2014/05/openssl-to-get-a-security-audit-and-two-full-time-developers/" rel="nofollow ugc">http://arstechnica.com/information-technology/2014/05/openssl-to-get-a-security-audit-and-two-full-time-developers/</a>), 4) now that we have evidence of the NSA&#8217;s subversive ways, we should treat just about everything with suspicion. It&#8217;s an Orwellian Twilight Zone.</p>
<p>As I mentioned before, it&#8217;s fairly obvious that OpenSSL should be purged. Apparently the code is a mess that receives little attention by way of maintenance while the authors pursue FIPS seminar gigs. Everyone requires an income, but too many individuals and institutions alike have grown dependent upon this project&#8217;s success to allow it to deteriorate or be compromised. Even if neglected by necessity, OpenSSL&#8217;s current condition creates an environment that welcomes attempts to subvert it.</p>
<p>I&#8217;ve been watching the progress of LibreSSL (<a href="http://www.libressl.org/" rel="nofollow ugc">http://www.libressl.org/</a>) and I appreciate the team&#8217;s (apparent) noble motives. Perhaps this is a step in the right direction.</p>
<p>As to the removal of the ROP function in question, do you have a link to indicate that fact? Not that I doubt you, but I&#8217;d like to review it, study it. I&#8217;m coordinating security efforts with a VPN shop, and of course OpenVPN makes use of OpenSSL. I&#8217;d like to share this news with them.</p>
<p>All the best to all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224335">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224335">
						June 11, 2014 11:54 PM					</a>

				</p>

				<p>@Rick, @Benni,</p>
<blockquote><p>The fact that the function (openssl_indirect_call) was included at all is a testament to the fact that 1) open source can indeed be as surly and difficult as closed source on many levels 2) Andy Poyakov&#8217;s future coding efforts should be treated with reasonable suspicion (I largely agree with Benni&#8217;s hypothesis on this point), 3) Andy P&#8217;s efforts to audit OpenSSL should also be treated with suspicion</p></blockquote>
<p>I agree with the first point, as implied by my comment: <i>Now I am convinced that &#8220;Open source&#8221; doesn&#8217;t add much more security than &#8220;Closed Source&#8221;.</i> I am not in a position to comment on the last two points, although, like you, I agree with Benni&#8217;s hypothesis.</p>
<blockquote><p>As I mentioned before, it&#8217;s fairly obvious that OpenSSL should be purged.</p></blockquote>
<p>That&#8217;s a little harsh. Just compile it on your own, and make sure you are using the latest patched versions. Purging it won&#8217;t help that much &#8212; what you replace it with is likely to have it&#8217;s own issues.</p>
<blockquote><p>As to the removal of the ROP function in question, do you have a link to indicate that fact? Not that I doubt you, but I&#8217;d like to review it, study it.</p></blockquote>
<p>You should always doubt me 😉 But here are the links:<br />
<b>Firstly :</b>  The first link you sent! See the &#8220;-&#8221; signs on the left in the pink highlighted block? It means these lines were removed from the source code. And the comment in the header states the rationale. The block of code was removed from &#8220;lib/libssl/src/crypto x86cpuid.pl&#8221; as stated in the top of the &#8220;commit&#8221;. I would think this is the date it took place &#8220;2014-04-22 21:52:21&#8221;.</p>
<p><b>Secondly: </b>I downloaded openssl-fips-1.1.2.tar.gz from <a href="http://www.openssl.org/source/" rel="nofollow ugc">http://www.openssl.org/source/</a> , and unarchived / uncompressed it and searched for &#8220;OPENSSL_indirect_call&#8221;, could not find it. On a related topic, I use <a href="http://www.sublimetext.com" rel="nofollow ugc">SublimeText2</a> for an editor &#8211; It&#8217;s a great one. You can click CNTR P or COMMAND P on a mac then type the function or variable name, and it&#8217;ll search the whole directory tree for you&#8230; I have no vested interest in it, btw, (I like vi, too).</p>
<p>If you only have the binary, then try searching for the &#8220;OPENSSL_indirect_call&#8221; using something like &#8220;strings&#8221; command, although that may not be the best way to do it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224336">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224336">
						June 12, 2014 2:00 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<blockquote><p>ARStechnica plays the role of the NSA for a week against an NPR reporter.</p></blockquote>
<p>Interesting article indeed, I also recommend others to read it. Most of the information in it is not new, but I learned a couple of things from it. The article contains some dated information as well. I could write a few tens of pages of comments on it &#8212; not my style! I&#8217;d rather encode my reply in a limerick 🙂 &#8211; However, there are parts in the article that are remarkable and worth a comment, probably later tonight. One question though! Why did you tag the link as &#8220;OFF Topic&#8221;, given that:</p>
<ul>
<li>It&#8217;s on a squid thread</li>
<li>It really is very relevant &#8211; my comments will show the relevance, later.</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224337">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224337">
						June 12, 2014 6:08 AM					</a>

				</p>

				<p>@Wael:</p>
<p>This commit, from 2014-04-22 21:52:21<br />
<a href="http://freshbsd.org/commit/openbsd/f868fc6f39a2c45a6c2bab70addc92525d467904" rel="nofollow ugc">http://freshbsd.org/commit/openbsd/f868fc6f39a2c45a6c2bab70addc92525d467904</a></p>
<p>is NOT from Openssl. It is from Libressl, with the comment from an OpenBSD developer entiteling this Openssl function as ROP entry point.</p>
<p>I still have to look for a similar removal line in Openssl itself&#8230;..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224338">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224338">
						June 12, 2014 6:27 AM					</a>

				</p>

				<p>In Openssl-1.0.1h, which is described as latest in</p>
<p><a href="http://www.openssl.org/source/" rel="nofollow ugc">http://www.openssl.org/source/</a></p>
<p>the function is still present. At least I can find it in its appropriate place when I unpack the library.</p>
<p>Of course, real agents do not delete their backdoors that easily.<br />
This is observed by the Openbsd folks for some time now, even with bugs that compromise the security of the library:</p>
<p><a href="https://twitter.com/MiodVallat/status/476581687338729476" rel="nofollow ugc">https://twitter.com/MiodVallat/status/476581687338729476</a></p>
<p>The DUAL_EC random number generator was implemented in OpenSSL after the request of an anonymous sponsor, as Openssl said in an official statement I linked to in some posts above this one. There you can also find the OpenSSL statement that their implementation had a bug which prevented DUAL_EC&#8217;s execution except in test cases.</p>
<p>So the customer who made the request to implement this never really tested it. This means that the customer did not really need this function for his own.</p>
<p>And it makes clear that this customer has a very good trust in the openssl developers.</p>
<p>The NSA says:<br />
<a href="http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html?pagewanted=all&#038;_r=0" rel="nofollow ugc">http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html?pagewanted=all&#038;_r=0</a></p>
<p>“Cryptanalytic capabilities are now coming online. Vast amounts of encrypted Internet data which have up till now been discarded are now exploitable.”</p>
<p>From this it follows that some crypto library which is responsible for &#8220;vast amounts of encrypted internet data&#8221; must be broken.</p>
<p>If I were NSA, I would trust the Openssl developers, too. They are probably among their best field agents they have&#8230;</p>
<p>One may note that code of these Openssl folks also made its way to GnuTls. Here is an example of code from Andy Polyakov which  straigthforwardly made its way to GnuTls:</p>
<p><a href="http://upstream-tracker.org/changelogs/gnutls/3.1.4/changelog.html" rel="nofollow ugc">http://upstream-tracker.org/changelogs/gnutls/3.1.4/changelog.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224339">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224339">
						June 12, 2014 6:35 AM					</a>

				</p>

				<p>Rick: while I appreciate the efforts of the LibreSSL team, sometimes you just need to walk away from a code base that is demonstrably terrible. My feelings on this are compounded by the reality that there are more TLS libraries than I have fingers &#8211; and some of them are actually (structurally) very good. I know that some of us have beat on about this before, but you&#8217;ve got GNUTLS, Mozilla&#8217;s NSS, PolarSSL, CyaSSL, etc. and most of the aforementioned libraries can emulate openssl functionality (or at least a superset).</p>
<p>That said, there have been instances of people/teams taking ugly code and fixing it. I can only think of a few examples where this has worked and it is generally only done (commercially anyway) when a rewrite is out of the question.</p>
<p>I am sure a few people are going to flame me for this position, especially as I have used OpenSSL in previous projects myself (primarily out of laziness).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224340">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224340">
						June 12, 2014 7:46 AM					</a>

				</p>

				<p>Benni: absolutely, your comment about Polyakov and GNUTLS being most noteworthy.</p>
<p>I am almost certain the NSA do not have the ability to defeat properly implemented conventional crypto en masse, my emphasis being on &#8216;properly implemented&#8217;. When you think about the number of vulnerabilities that the NSA likely have cached &#8211; vulns that we likely don&#8217;t know about yet, then some of the statements made begin to make sense. I guess the $64m question is a) what bug or vuln are they exploiting (there is additionally the possibility that this is disinformation, of course) and b) was this engineered or just the result of then exploiting an existing accidental bug.</p>
<p>That said &#8211; a lot of the info obtained as a result of the Snowden disclosures is bewilderingly contradictory. For example, if they had an effective way to target TLS/SSL encapsulated communications en masse, why are they bothering with MITM style attacks? Why try and exploit the admittedly ripe for the picking CA trust model with dodgy root certs? It all doesn&#8217;t make sense and likely points to the fact that their abilities are limited to essentially what <em>we</em> could do in the commercial sphere using unclassified tools and ingenuity <em>if</em> we had NSA&#8217;s resources (ie: essentially a mirrored feed of all traffic from their beam splitting intercept locations).</p>
<p>Probably the most important things that have or will likely come about as a result of this whole debacle will be;</p>
<ol>
<li>a critical review of default cipher lists, with a view to eliminate the ability to fall back to weak ciphers like RC4
</li>
<li>the implementation of PFS on the server side to ensure that if the server&#8217;s key is compromised any content which the govt has cached is not immediately decipherable
</li>
<li>widespread adoption of some kind of WoT based verification to alert users of a site whose cert appears to suddenly change &#8211; again, just like OCSP <em>seemed</em> like a great way to fix the CRL problem a Convergence/Perspectives like solution may betray information as to sites visited to the notary servers. At the very least, browsers could learn a thing or to from OpenSSH and keep a cache of known hosts to alert the user to changes.
</li>
<li>the elimination of the dangerous CA practice of issuing root or intermediate certs to organizations (eg. geotrust&#8217;s georoot program); despite the inconvenience this may cause legitimate large organizations.
</li>
<li>a view to ultimately &#8216;fix&#8217; the CA problem &#8211; we need something to decentralize &#8216;trust&#8217; in a meaningful way. Related concepts like DNSSEC that&#8217;s rely upon an &#8216;authority&#8217; are to be similarly scrutinized.
</li>
<li>an audit of all commonly used encryption tools and libraries with a view that at least some of them have been deliberately weakened
</li>
<li>user education sessions to encourage the non-geek public to care more about what they send in the clear and what they can do about it both in terms of countermeasures like encryption and political efforts &#8211; perhaps their understanding and ultimately care about the surveillance state will lead to increased funding for folks like the EFF/EPIC/etc.
</li>
</ol>
<p>Just a few thoughts on what may and should occur once the world has got over the shock of the NSA revelations.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224341">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224341">
						June 12, 2014 8:42 AM					</a>

				</p>

				<p>@Benni,<br />
Good catch. I still didn&#8217;t find it in the version I posted. I&#8217;ll look at the version you posted&#8230; I wonder how many of these &#8216;gems&#8217; are hiding in the code&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224342">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224342">
						June 12, 2014 8:47 AM					</a>

				</p>

				<p>@Mike: &#8220;For example, if they had an effective way to target TLS/SSL encapsulated communications en masse, why are they bothering with MITM style attacks? Why try and exploit the admittedly ripe for the picking CA trust model with dodgy root certs? &#8221;</p>
<p>Because they generally make things robust, so that, if one plan A fails, they have plans B and C and D as alternatives.</p>
<p>The same document from Bullrun which I quoted above also says that this technique, which would make many encrypted web communications readable, would be &#8220;very fragile&#8221;.</p>
<p>For me, that sounds much like an Openssl vulnerability, but which one they are using exactly is the billion dollar question indeed.</p>
<p>If openssl is cleansed properly, I assume the NSA folks are blind as in 1968 where CIA called a report of the german secret service  on the invasion of warshaw pact troops a &#8220;german fabrication&#8221;.</p>
<p><a href="http://en.wikipedia.org/wiki/Bundesnachrichtendienst#1960s" rel="nofollow ugc">http://en.wikipedia.org/wiki/Bundesnachrichtendienst#1960s</a></p>
<p>At that time, the BND was able to fully read russian cryptography whereas NSA was unable to do so.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224343">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224343">
						June 12, 2014 9:15 AM					</a>

				</p>

				<p>Benni is correct&#8230;</p>
<p>The function exists in the so called &#8220;latest version&#8221;.</p>
<pre>
[openssl-1.0.1h] grep -ir "indirect_call" *
crypto/x86cpuid.pl:#    type OPENSSL_indirect_call(void *f,...);
crypto/x86cpuid.pl:#    OPENSSL_indirect_call(func,[up to $max arguments]);
crypto/x86cpuid.pl:&amp;function_begin_B("OPENSSL_indirect_call");
crypto/x86cpuid.pl:&amp;function_end_B("OPENSSL_indirect_call");
[openssl-1.0.1h] 
</pre>
<p>It&#8217;s not in the &#8220;Fips&#8221; version, however. Regarding &#8220;trust&#8221; in a developer&#8217;s name, it&#8217;s not 100% foolproof to &#8220;blacklist&#8221; the untrusted name, because &#8220;names&#8221; can change as in a Sockpoppet, for example&#8230; hmmm</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224344">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224344">
						June 12, 2014 9:41 AM					</a>

				</p>

				<p>The &#8220;grep&#8221; was the quick and dirty way.</p>
<p>Download source tree from <a href="http://www.sourcetreeapp.com" rel="nofollow ugc">http://www.sourcetreeapp.com</a><br />
then add clone repository form git://git.openssl.org/openssl.git</p>
<p>Or you can do the command line described here:<br />
<a href="http://www.openssl.org/source/repos.html" rel="nofollow ugc">http://www.openssl.org/source/repos.html</a></p>
<p>You can then track every commit and branch. You can also un-commit suspected “functions”, and build your own OpenSSL…</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224345">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224345">
						June 12, 2014 10:46 AM					</a>

				</p>

				<p>@ Mike</p>
<p>Benni beat me to it. I&#8217;ll add that each tool has different properties in what control or data it gives them. Each tool might also have different properties far as detection by enemy goes. Some tools can also be used on many more targets than others. So, NSA is just practicing Offense in Depth.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224346">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224346">
						June 12, 2014 11:14 AM					</a>

				</p>

				<p>Benni: I agree with you on your suspicions re openssl.</p>
<p>Nick: &#8216;offense in depth&#8217; &#8211; I like it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224347">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224347">
						June 12, 2014 12:13 PM					</a>

				</p>

				<p>@Nick P, @Mike the goat,<br />
I also like &#8220;Offence in depth&#8221; &#8211; I really thought about posting it, but Nick P was faster, and I was sleepy 🙂 So I&#8217;ll have to expand on it. Creepy how we are getting to think alike &#8212; if you believe my claim, that is&#8230;<br />
&#8220;Defense in depth&#8221; is not adequate against someone who has the capability to mount an &#8220;Offence in depth, width, height, and other dimensions they extracted from the poor aliens they have imprisoned at Area 51, hanger 18&#8221; operation 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224348">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224348">
						June 12, 2014 2:15 PM					</a>

				</p>

				<p>@ Wael, Mike</p>
<p>Thank you and funny haha.</p>
<p>@ All</p>
<p>I previously posted <a href="http://homes.cs.washington.edu/~levy/capabook/" rel="nofollow ugc">this</a> informative book about Capability-based Systems of the past. I read it by skipping to the more modern architectures. I also read the &#8220;Early Descripter Machines&#8221; chapter for info on Burroughs Architecture. Anyway, I regret skipping early capability machines chapter as it had this gem: the first capability machine was a <a href="https://en.wikipedia.org/wiki/PDP-1" rel="nofollow ugc">PDP-1</a>.</p>
<p>That&#8217;s right. The PDP-1 implemented a more advanced and secure system architecture than most modern machines. This was despite it having around 9KB of memory, 18-bit words, and 200 <em>kilo</em>hertz memory clock speed. So, modern designers aiming for more secure and robust systems have little excuse technologically. If the PDP-1 could run a capability system, then a modern machine probably can too. And a whole lot cheaper, too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224351">

			<div class="comment by-rick ">

				<p class="commentcredit">

					<span class="commenter">Rick</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224351">
						June 12, 2014 5:22 PM					</a>

				</p>

				<p>@Benni, @Wael, @Mike the Goat, et al,</p>
<p>I am thankful that this subject is being discussed and vetted. At first when Benni mentioned the ROP function (openssl_indirect_call), and after reading about its potential as a hack, I considered that it could be devastating to privacy, and in particular, VPN services (of which I am a consumer and an advocate of). I am not yet convinced it is devastating, but I&#8217;m not not convinced, yet, either. I want to learn more.</p>
<p>I thank Benni for his astute observations about the NSA&#8217;s behavior patterns (which simply make good sense, almost to the point of being self-evident, bravo!), and Wael for his assistance with reading software development repository jargon. Very helpful indeed.</p>
<p>As for dumping OpenSSL altogether, Mike the Goat insists that such a move might be the best plan. Perhaps so? I am not qualified to determine that. But I am vaguely familiar the hurdles involved and I can understand his sentiment given what I&#8217;ve read about OpenSSL&#8217;s current condition. I mentioned &#8220;purged&#8221; before in this thread to convey the idea that it should be audited and generally cleaned up if salvageable. If the result is not worth the effort, then perhaps starting fresh is indeed the better route&#8230;</p>
<p>&#8230;But what of backwards compatibility? Someone is going to have to pitch the new code in a &#8220;dog &amp; pony show&#8221; to those who hold the purse strings for all of the affected institutions. And so the switch to a new library/code base will take an unpleasant amount of time. Meanwhile, the 4th amendment shrivels away. Then again, this sort of thing has been going on already for years and years. Regardless, the sooner we reclaim privacy, the better, for surely the NSA will not relent, and the current political environment will continue to fund their ventures.</p>
<p>A question for the coders here: what, then, can you actually <u>DO</u> with &#8220;openssl_indirect_call&#8221;. Can you actually call any function and jump to any address you desire? A &#8220;ROP coder&#8217;s dream&#8221;?</p>
<p>I agree with Benni: project Bullrun (decrypting SSL en masse) has to function somehow. So, vulnerabilities in OpenSSL are surely choice weapons. This link provides additional thought on the subject: <a href="http://blog.cryptographyengineering.com/2013/12/how-does-nsa-break-ssl.html" rel="nofollow ugc">http://blog.cryptographyengineering.com/2013/12/how-does-nsa-break-ssl.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224352">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224352">
						June 12, 2014 7:04 PM					</a>

				</p>

				<p>While we are at OpenSSL, I have a technical question about it.</p>
<p>We all know that OpenSSL is a library with lots of obfuscations. It has a unreadable style, its own overrides of standard functions, etc..</p>
<p>But assembly written in perl, is that valid? The readme file in &#8220;crypto/perlasm&#8221; starts with:</p>
<p><i>&#8220;The perl scripts in this directory are my &#8216;hack&#8217; to generate<br />
multiple different assembler formats via the one origional script.&#8221;</i></p>
<p>Personally I don&#8217;t like the word &#8220;hack&#8221; in security related software, however considering everything else it fits right in.</p>
<p>I always considered the gas / gcc style &#8220;.S&#8221; (with capital S) files as the norm but I am not an assembler expert so I ask the question whether this is (1) valid, (2) code from the past, or (3) obfuscation?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224353">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224353">
						June 12, 2014 7:36 PM					</a>

				</p>

				<p>@ Rick</p>
<p>I&#8217;m actually with Mike on dumping the whole thing. Gerard&#8217;s comment illustrates just how bad the codebase is. A codebase for safety- or security-critical applications should be well-documented, easy to understand, written to be easy to analyze (eg static analysis), well tested, and [in this case] use portability conventions. The OpenSSL codebase seems to be the opposite in every way. The amount of work LibreSSL team is doing to it would probably be better off building a library from scratch that&#8217;s compatible with high level OpenSSL API&#8217;s.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224354">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224354">
						June 12, 2014 9:42 PM					</a>

				</p>

				<p>@ Wael,</p>
<p>You asked,</p>
<blockquote><p>One question though! Why did you tag the link as &#8220;OFF Topic&#8221;</p></blockquote>
<p>It&#8217;s steeped in the mists of time&#8230;.</p>
<p>Back in the days of old the squid page was like a dress down friday for Bruce, and did not have the alowance it does to day of any other security related subjects.</p>
<p>I occasionaly would make an on topic comment but in an amusing way, then I would occasionaly post a mild mannered joke or link to something I and others might find amusing and called it a Friday Funny or equivalent. Sometimes as Nick P will probably confirm they took a walk on the risky side (like supposadly exploding breasts on aircraft due to faulty implants) but still had a security element even if it was a bit tenuous 😉</p>
<p>I also started puting links to security items up, that were news worthy, and I marked them as off topic to warn people. I did this rather than EMail Bruce and fill up his inbox, or muck up the current thread, and it was also in some cases more timely. Others started to do likewisew and some made further comment on them.</p>
<p>Bruce did not object to relevant subjects and even blogged about them in more depth later, it kind of became a tradition (and occasionaly has had the apperance of a competative sport 🙂</p>
<p>I thus use &#8220;off topic :&#8221; to let people know it&#8217;s a news or related item and thus could be the start of what you might call a sub thread. However if I reply to some one who has posted a new sub thread or has made an &#8220;on squid&#8221; comment I use their name to try to preserve some linkback.</p>
<p>Sadly the squid page now rarely sees squid comment from readers and thus if I make one I put &#8220;ON Topic :-)&#8221; at the top to signify the special status&#8230;</p>
<p>Yes I know, it might be mad but there is logic behind it, if not a little history.</p>
<p>Now having addresed your first point, it&#8217;s time for you to live upto your second point, as they say &#8220;I&#8217;m all ears&#8221; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224355">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224355">
						June 12, 2014 10:33 PM					</a>

				</p>

				<p>@Gerard van Vooren,</p>
<blockquote><p>But assembly written in perl, is that valid?</p></blockquote>
<pre>
Look at the make file:
x86cpuid.s: x86cpuid.pl perlasm/x86asm.pl
    $(PERL) x86cpuid.pl $(PERLASM_SCHEME) $(CFLAGS) $(PROCESSOR) &gt; $@
perl is used as a "script" to generate an assembler source file for different CPU's.
I tried to compile and build it on my machine, but it's failing for some reason -- and I don't have the desire to fix it -- It's "suspicious" after all...

If you have better luck building it, do this:
make | tee make.log
then edit the make.log file and see what is going on, and share with us...


@Clive Robinson,
You are next on the queue! I'll need an hour or so.
</pre>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224356">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224356">
						June 12, 2014 10:34 PM					</a>

				</p>

				<p>@ Gerard van Vooren,</p>
<p>Simple answer is it&#8217;s no more valid than using some other tool such as an enhanced macro language or for that matter things like YACC.</p>
<p>It is however undesirable, but can unfortunatly be necessary, due to limitations of standards and some major corporates pushing their own agenda.</p>
<p>When it comes to ASM there are various aproaches and none of them have realy been dignified as standard as it&#8217;s usually hidden at the unseen output end of the tool chain and thus the assumption it&#8217;s hidden and thus does not require to be standard&#8230; (an example of the greate &#8220;a round tewit&#8221; circular reasoning 😉</p>
<p>AT&amp;T produced a CPU independent format for input to their assembler that the GNU crowd quite sensibly used for gas as their tool chain was designed not just to be CPU independant but cross platform as well. However Intel has it&#8217;s &#8220;house standard&#8221; for it&#8217;s CPU range that has been around for fourty years, and many tool chain suppliers use it for their assemblers as their tool chain is single CPU targeted.</p>
<p>As a consiquence we have the likes of nasm that does a similar job to gas but uses the Intel house standard as it&#8217;s input.</p>
<p>But if only these issues were only tucked out of sight at the bottom of the tool chain&#8230; sadly they are not. You will see issue with assembler support all the way up the tool chain, such as inline in the compiler or hidden away in preprocessor macros etc in some embedded development tool chains. For instance some compilers actually have a switch for inline code to say if it&#8217;s in &#8220;house style&#8221; or &#8220;AT&amp;T style&#8221; which can cause some real problems with header files etc.</p>
<p>The big question though is why did the developers chose to use perl, it&#8217;s not as though it&#8217;s actually formaly part of most tool chains and it&#8217;s not guarenteed to even be available on any given platform&#8230;</p>
<p>The only advantage I can see is it is sort of standard across all major platforms, freely available and many programers will be familiar with either version five or six.</p>
<p>Could it be used to hide things away out of sight? Simple answer is Definatly, but then that&#8217;s true of all Turing compleate languages (even the much loved BrainF**k 😉</p>
<p>A better question would be one of why the asm is in the code in the first place, personaly I think the writter of the code should not have gone there. If you think about it there should be no &#8220;close to the metal code&#8221; required in OpenSSL it&#8217;s not as though it talks directly to hardware. As with the famous comments about &#8220;goto&#8217;s&#8221; you have to ask if it&#8217;s a &#8220;programer fault&#8221; with the developer trying to be clever or if there is a valid reason for it.</p>
<p>Currently the &#8220;reason&#8221; is very much under question/scruitiny and the &#8220;go faster stripes&#8221; argument which people would once have assumed by default may be found to be invalid, and possibly extreamly suspect. Which will almost certainly bring the developers ethics into question in a way they won&#8217;t be easily able to defend, even if originaly innocent.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224357">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224357">
						June 13, 2014 12:04 AM					</a>

				</p>

				<p>@ Clive Robinson,</p>
<blockquote><p>Now having addresed your first point, </p></blockquote>
<p>Thank you for the history lesson! Much obliged!</p>
<blockquote><p>it&#8217;s time for you to live upto your second point, as they say <b>&#8220;I&#8217;m all ears”</b> 😉</p></blockquote>
<p>Sweet! And I’am all <b>lips</b>, and will start flapping them. First the introduction&#8230; I was going to reply yesterday, but the blog was suspiciously quiet, so I decided to delay my response. Any way, made a mistake yesterday and drank a cup of Turkish coffee late at night. Finished the Brownian random liquid, and continued into the Darker deterministic sludge — big mistake.</p>
<p>So the link is interesting because it showed how mach data can be collected, and it’s a huge amount. It’s  a huge amount given that they used no malware and only looked at one of the channels — WiFi. They did not collect data from Bluetooth, Baseband (3G/4G/LTE) voice and data, etc… So I got a perspective of how large the surface of attack of a smart phone. In addition to that, the type of attack they conducted falls under “Passive Man In the Middle” — meaning the attacker is only observing packets and analyzing them. The attacker is not injecting the packets for replay. If you add the possibility of an “Active Man In the Middle” — meaning the attacker is capturing the packets, manipulating them, and injecting them realtime or at a later time, then the attack surface increases a lot, and so does the damage level. I think I said before that one will need to construct a bunch of attack not trees that will cover an area the size of the Siberian forest to describe the possible attacks on such a device.<br />
At one point I mentioned that I was messing with wireshark because I noticed some strange behavior. I connected my smart phone to the hotspot, and started wireshark and collected packets with a basic filter (no broadcast and no multicast). Started looking at my phone traffic. It was constantly sending packets everywhere; Google, Apple, other strange places. Put it to sleep, it sent a ton of packets before it went to sleep and after it woke up — HTTPS and TLS stuff. By the way, wireshark can decrypt the packets if you enter the hotspot keys (either wpa-pwd or wpa-psk home, not enterprise). It usually works better in monitor mode for me.</p>
<p>One of the areas that has changed (and I said dated) is the UUID on iOS devices. It’s no longer available to the applications. It’s the reason I asked once about IV and encryption because I believed there is a way to fingerprint the device even with UUID obscured.</p>
<p>The article also doesn&#8217;t talk about cookie theft attacks and how to hack someones email account or login to their Facebook account for example through capturing the authentication cookie and injecting the cookie into another browser to go into the victims page without the ability or need to capture their password.</p>
<p>The main point to get out of this paper is that attacks are no longer “simple” type attacks. They are compound in nature, and harder to discover, as they are buried in the noise. These attacks are using the principle of divide and conquer, but in a strange way… And that’s just scratching the surface of it. I’ll continue on this thread later so I don&#8217;t make it too long, and I am not sure if my time is up. I also need a cup of coffee to keep up a little longer&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224358">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224358">
						June 13, 2014 12:39 AM					</a>

				</p>

				<p>Wael<br />
<i>What if someone already did and kept silent?</i><br />
&#8211;Uhh I think you know the answer to that..Then there would be a mole lurking in our intel agencies and other countries are working to copy or countermeasures.</p>
<p><i>Thanks for the OPTIGA link.</i><br />
&#8211;NP, just a link; they should arrange for secure delivery services too if they really want a happy security customer.  I say try to hack their product (not the development area, that&#8217;s cheating) if they&#8217;re going to push out a java-based OS in a product as secure and try to make money off it.</p>
<p>Nick P<br />
<i><a href="http://www.reactiongifs.com/wp-content/uploads/2013/06/you-got-me.gif" rel="nofollow ugc">must be an imposter! 😉</a></i><br />
&#8211;Ah, forgot the winky smiley face, of course! (No one makes that face in real life BTW, you just look like you&#8217;re cringing).</p>
<p>You&#8217;ve mentioned your faith in EAL ratings before, can they not be &#8220;gamed&#8221;&#8230; or falsified&#8230;?  And yeah there&#8217;s not a lot of room or time w/ 8 bits for security, but first off most times you probably won&#8217;t need it or will be able to see fragrantly malicious behavior.  Importantly you will be able to see those CPU resources being used and make it semi-impossible to get at (unless..well..you know..).  But who can write all these stacks from scratch?  I don&#8217;t mind a ridiculously minimal machine (plan on putting an extremely small linux on my granny&#8217;s PC instead of a digital radio station as it simply doesn&#8217;t have the strength needed&#8230; 🙁 ), but most won&#8217;t even have machines compatible w/ my format.  Even on my cell phone now, I can&#8217;t receive certain iphone text messages now for some stupid formatting issue (they can keep their stupid file format) and it&#8217;s annoying when people do mass texts.</p>
<p><i>Last one is maybe a sign of bad things to come.</i><br />
&#8211;My visions are pure hell on a number of issues like sanitation, pollution, energy, water, and food&#8230;barring some sort of miracle on the order of a revelation like Newton&#8217;s F=ma (there&#8217;s many other extremely important contributions but that simple equation makes you feel like you understand a large chunk of the universe).</p>
<p>Oh by the way, Chris Abbott and his screwdriver may like this.  Just heard another way (hilarious and old school) to seek out noise sources in a circuit which I&#8217;m going to try tomorrow, use a screwdriver handle to your ear on suspect spots.  Based on some consultation, I may know where this noise is coming from, and it&#8217;s a repeatable bug, just weird and is initiated by a software program.  Maybe put a &#8216;scope on it too.</p>
<p><a href="http://forum.audacityteam.org/viewtopic.php?p=242483&#038;sid=88e7af4c8421af009ed9e9a665b9736d#p242483" rel="nofollow ugc">http://forum.audacityteam.org/viewtopic.php?p=242483&#038;sid=88e7af4c8421af009ed9e9a665b9736d#p242483</a></p>
<p>Clive Robinson<br />
<i>It&#8217;s steeped in the mists of time&#8230;.</i><br />
&#8211;You know you started saying &#8220;If you&#8217;ll have a read back in the past..&#8221; almost immediately when the blog started; and have stated it so many times since like some sort of professor angrily trying to get his/her students to read.  And I searched out your first reference and was unable to find it lol (I checked diligently).  Also I noted sometimes you strangely seemingly addressed people before they even responded or weren&#8217;t there, as if you had a time machine or something&#8230; :p.  And&#8230;your little coin-flipping trick; I asked about it but got no response pretty much.  At first I thought you would flip it, catch it, then look at it really quickly and decide to flip it again as you put it on your other hand if it was the wrong side.  Now I&#8217;m thinking something magnetic since you said it stands up and goes on neither side; perhaps two magnets that keep it locked in an upwards position.  Don&#8217;t care that much, just slightly irritating&#8230; :p</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224359">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224359">
						June 13, 2014 12:43 AM					</a>

				</p>

				<p>@Wael<br />
It would appear that I&#8217;m on a similar wavelength with you 😉<br />
At least partially; with a subset of your proposed exploitable spectra (phone basebands to be precise)&#8230;<br />
Will share more shortly!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224360">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224360">
						June 13, 2014 12:49 AM					</a>

				</p>

				<p>AH! Forgot.</p>
<p>Clive Robinson<br />
&#8211;You&#8217;ve banged on about patents (in DPA) and how they restricted experimentation and new knowledge and technologies; and how that&#8217;s linked to the &#8220;free market&#8221;.  Well, a rather big development, Elon Musk over at Tesla, another one of those people that &#8220;make things happen&#8221;, just opened up all patents on their electric vehicles.  Notice how such a successful individual is beating all the other old business folks, making moves first before many other dinosaurs.  No doubt, getting a patent is surely a good feeling and can lock in a business&#8217;s profits; but certain ones are restricting development in extremely important areas, and we need to be not so stupid to realize that.</p>
<p>Also, at the end of the day, they still built the cars w/ their processes and someone would have to eavesdrop on that entire process <em>cough</em> someone&#8230; <em>cough</em> to steal their entire business.</p>
<p><a href="http://www.teslamotors.com/blog/all-our-patent-are-belong-you" rel="nofollow ugc">http://www.teslamotors.com/blog/all-our-patent-are-belong-you</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224361">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224361">
						June 13, 2014 2:57 AM					</a>

				</p>

				<p>@ Wael</p>
<p>Thanks for showing us code in the Makefile. I didn&#8217;t search for it because it would ruin my day. 😉</p>
<p>@ Clive Robinson</p>
<p>You mention lots of good points.</p>
<p><i>&#8220;A better question would be one of why the asm is in the code in the first place, personaly I think the writter of the code should not have gone there. If you think about it there should be no &#8220;close to the metal code&#8221; required in OpenSSL it&#8217;s not as though it talks directly to hardware. As with the famous comments about &#8220;goto&#8217;s&#8221; you have to ask if it&#8217;s a &#8220;programer fault&#8221; with the developer trying to be clever or if there is a valid reason for it.&#8221;</i></p>
<p><i>&#8220;Currently the &#8220;reason&#8221; is very much under question/scruitiny and the &#8220;go faster stripes&#8221; argument which people would once have assumed by default may be found to be invalid, and possibly extreamly suspect. Which will almost certainly bring the developers ethics into question in a way they won&#8217;t be easily able to defend, even if originaly innocent.&#8221;</i></p>
<p>In short it comes to this: Why invite the nasty guests for dinner?</p>
<p>The price to pay for optimization is high. It hinders portability, in the case of OpenSSL there is a massive amount of asm code with a staggering amount of magic numbers. It also depends on third party tools (perl, masm, gas etc..), which don&#8217;t always work as expected.</p>
<p>I agree it could/should be written in pure C and the crypto code optimized for speed with compiler flags alone.</p>
<p>It certainly questions the ethics of the developers.</p>
<p><i><b>&#8220;The competent programmer is fully aware of the limited size of his own skull. He therefore approaches his task with full humility, and avoids clever tricks like the plague.&#8221;</b></i> — Edsger W. Dijkstra</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224362">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224362">
						June 13, 2014 6:34 AM					</a>

				</p>

				<p>@ Gerard van Vooren,</p>
<p>I&#8217;m glad you made the Edsger W. Dijkstra link, he made some pithy but quite valid comments about the art and science of programing, his comment about BASIC being one of the most remembered (and most misquoted 🙂 with the &#8220;goto&#8221; a close second.</p>
<p>Much as I have a love hate relationship with both C and ASM I have some fairly strict rules about using them together as did the originators of Unix back when I was almost &#8211;still&#8211; a lad.</p>
<p>Much of my work over the years has been either very close to the metal &#8211;and often below&#8211; or squeasing the last few drops out of hardware resources. However I always adopted the policy of writing the code in the high level language, then as required move that which had need of ASM out into a seperate header file with enough documentation &#8211;including the original high level code&#8211; in it such that it was easily possible should the resources become available to be easily and cleanly moved back into the high level source where it belonged. Which unsurprisingly happened rather more often than not simply due to the pace of increased resources to the same or reduced cost in a development cycle. Likewise it alowed for easy migration to different CPUs and platforms quickly and easily.</p>
<p>These days however with 32bit microcontrolers with a quater meg or more of RAMcosting less than 16bit and 8bit solutions the need to dip down in all but hardware register addressing is long past.</p>
<p>For those who want a rough rule as to when to use ASM and where not to, the bulk of your OS kernel should not be in asm nore your system libraries that act as helpers to apps nor the apps. The only part of the OS you should consider in asm is task switching and  interupts that are not over kernel generated. Hardware addressing asm should be kept absolutly minimal. Think of all interupts as consisting of two parts, a fast interupt driven data to/from a small circular buffer handler written to a very strict API written in asm. And a slow polled handler not written in asm that moves data to/from the circular buffer to a kernel buffer, that then applies &#8220;line disaplin&#8221; / &#8220;raw to cooked&#8221; handeling. It has some disadvantages but in the vast majority of cases will make your life much easier in the long run.</p>
<p>In all cases when asm is used the case must be very clear cut and fully documented in the source, otherwise the developer is being negligent, macho or both.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224363">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224363">
						June 13, 2014 8:27 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<p>With regards patents for electric vehicals I can make a very clear business case for doing it&#8230;</p>
<p>Currently there is too little demand for electric vehical components, which means a masive price premium has to be paid over that of petrol or diesal vehicals. Which translates into eye watering consumer prices that limit consumer demand and little or no profit for the manufacturer.</p>
<p>Any patents held just causes further restrictions in the market which has the negative effect of causing much technology diversification &#8211;AKA patent dodging&#8211; that keeps that price premium on components high.</p>
<p>Thus if you open your patents up manufacturers will use the same technology and components you use or some small variation, this will mean much increased demand for the components alowing the significant reductions in cost mass production brings.</p>
<p>Thus Elon Musk will see a drop in component prices he uses which will enable him to either make more profit or reduce his consumer price and attract more buyers and thus get more profit that way. As he is also already setup to manufacture as prices of component parts drops he should be able with agile behaviour to stay ahead untill the market becomes more mature, by which time he can move into a niche high profit &#8211;hypercar&#8211; market or become irresistably atractive for a permium brand buyout by one of the big manufacturers.</p>
<p>As they say &#8220;watch this space&#8221; to see what happens and if I&#8217;m right or wrong.</p>
<p>As for the coin trick, unless it&#8217;s been taken down in a site shift etc then it should still be up here somewhere.</p>
<p>But to save you hunting the process is,</p>
<p>1,  put the coin on your thumb,<br />
2, flick it high into the air,<br />
3, catch with an open hand,<br />
4, slap the coin down still covered onto the back of your other hand.</p>
<p>Which is the normal way of doing things and what people expect to see.</p>
<p>Now the missing bits,</p>
<p>3a, glance up and see which side is uppermost in your hand.<br />
4a, rememmber coin is now the other way up.</p>
<p>Now when the other person calls, if the coin is the otherway simply lift your catching hand off your rest hand to show the coin the other way and they have lost the call. If however they call correctly as you lift your catching hand use it to turn the coin over so the person again had lost the call.</p>
<p>The two hard parts are firstly making 3a non obvious, this is generaly easiest done if you flip the coin high and catch high. Most people will keep their eye on the coin not on your eyes and even if they do because the coin goes high you watching your hand looks natural. The second and perhaps hardest part is learning how to slightly cup your catching hand to hold the coin so it actually does not touch the rest hand but stays a few milimeters above it. Thus when the call is made you either just press it doen as you take your hand off, or dig one edge into the rest hand and partly slide the catching hand over such that it turns the coin over.</p>
<p>With practice you can do this over and over again and people will know it&#8217;s a trick but not know how you do it even if they watch carefully.</p>
<p>My son when a lot younger spent an entire afternoon loosing befor he got the message that gambling is a mugs game, I&#8217;ve since shown him the Hunt the Queen card trick and the Find the pea trick. I also had a bit of gentel fun with his maths teacher who at the time was teaching him probability, who was a very nice young lady and a good sport and did not mind being shown her &#8220;fair coin&#8221; was anything but fair.</p>
<p>Which is a point worth noting, simple magic tricks are a great ice breaker and generaly better than even the classiest of chat up lines, and often if you do it right you get another person to buy the drinks so saves you money as well 😉</p>
<p>Even if you are &#8211;suposadly&#8211; to old to chat people up, it&#8217;s still good practice to keep hand eye codordi ation in and keep your joints working even with a touch of arthritis. It also teaches you some &#8220;palming skills&#8221; which are needed for doing basic &#8220;fieldcraft&#8221; such as &#8220;passing&#8221; from a &#8220;brush&#8221; and &#8220;droping&#8221; into a dead letter box, or into a marks pocket. With further practice &#8220;lifting&#8221; becomes natural so you could do pick pocketing as well. It&#8217;s best to start with a thumb lift from a facing bridge, simply you have a flat surface with a couple of coins stacked up on it, you put your finger tips on the surface between the coins and the observer with your thumb behind your fingers. As you appear to lean forward your thumb slides and tips the top coin such that your thumb pushes it up into your hand where a slight cupping holds it your thumb then comes out quit naturaly you pause to say something then lift your hand up whilst making a distracting movment with the other hand like a nose scratch or cough drop the coin in your pocket and bring the hand back. A little more advanced is to close the hand slightly pushing the coin between your fingers a you turn your hand annd open it again such that your palm is visable, bring it across your body in a natural movement such as holding your hand outto shake, but in the process drop the coin in the other hand. This trick has been done against jewlers for years where you covertly lift one ring from a pad whilst obviously picking a second, as you try the second one on you transfer the first to that hand covertly, you then take the second ring off and put it back in the pad whilst covertly pocketing the first. The jewlers attention tends to stay on the second ring. I&#8217;ve seen this done with watches, and even seen a swap where in the process of trying on the second the first valuable watch is replaced with a cheap fake that is sufficiently good to pass non detailed examination. With some famous name watches in mall shops being up in the 25K-50K USD range and good fakes being less than 5K you can see why some people do it. And dishonest traders do similar swapping whilst wrapping up the goods you have carefully examined, likewise when exchanging money etc. Also, when you &#8220;present papers&#8221; or &#8220;credit cards&#8221; check carefully you are getting yours back not somebody elses or fakes your passport could be worth several thousand dollars to a person on the run who looks like you, and could be out of the country and landed in abother within a few hours, whilst even if you notice fairly quickly they have been swapped, by the time you have rerported it to the local authorities it might take half a day or more before border inspectors get told. Then of course a passport can be cloned fairly rapidly, so it might even get handed in at the local police station or given back to you fairly quickly with profuse appologies for a simple mistake which means you might not even report it missing so it does not get canceled, and your &#8220;look alike&#8221; has upto ten years to travel on it or borrow money, setup businesses etc etc&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224364">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224364">
						June 13, 2014 8:53 AM					</a>

				</p>

				<p>@ Figureitout</p>
<p>re Walter White</p>
<p>Quite appropriate because I am the one who knocks [bogus security claims down].</p>
<p>re EAL&#8217;s</p>
<p>&#8220;You&#8217;ve mentioned your faith in EAL ratings before, can they not be &#8220;gamed&#8221;&#8230; or falsified&#8230;?&#8221;</p>
<p>I have an evidence-supported belief (not faith) that higher EAL&#8217;s increase <em>assurance in development process.</em> The security comes in  this combined with what&#8217;s in the Security Target or Protection Profile. Those list the requirements, features, safeguards, etc. What&#8217;s contained in them is where they try to game the system so read it closely for any vendor. The EAL says how rigorous your development process is when you produce it. Both have to be good. An EAL7 evaluation of a firewall that doesn&#8217;t include countermeasures to firewall bypassing techniques in its Security Target might be quite insecure, for example.</p>
<p>The EAL5 rating is commonly called medium assurance. The Cygnacom Evaluation Lab explains it as such:</p>
<p>&#8220;EAL5 permits a developer to gain maximum assurance from security engineering based upon rigorous commercial development practices supported by moderate application of specialist security engineering techniques. Such a TOE will probably be designed and developed with the intent of achieving EAL5 assurance. It is likely that the additional costs attributable to the EAL5 requirements, relative to rigorous development without the application of specialised techniques, will not be large.</p>
<p>EAL5 is therefore applicable in those circumstances where developers or users require a high level of independently assured security in a planned development and require a rigorous development approach without incurring unreasonable costs attributable to specialist security engineering techniques.&#8221;</p>
<p>So, it&#8217;s commercial best practices plus some specialist security engineering. It might be a little and it might be a lot. For instance, Boeing SNS Server is designed with assurance features of highest level (EAL7) in key places, but stopped evaluation of system as a whole at EAL5 Augmented to avoid unnecessary effort/expense. At other end, the French evaluation lab certified a version of Mandrake Linux at EAL5 because it met the minimum for the standard&#8230; somehow. (Doubt they did a covert channel analysis&#8230;) EAL4 should be minimum for any software you buy that matters, with EAL6-7 representing more secure end.</p>
<p>re Tesla</p>
<p>Personally, I think what they&#8217;re doing is dumb. Wael and I&#8217;s conversation on patents ended with his recommendation I stockpile my own for defense. That&#8217;s easier said than done but is the right advice. It&#8217;s how all the big players are doing it. Those that don&#8217;t just get sued and forced to pay up 99% of the time. So, if Tesla has no patents, then they can be hit in future for infringing on <em>others</em> patents and not have a chance of a countersuit. It&#8217;s not a great position to be in.</p>
<p>@ Gerard</p>
<p>&#8220;I agree it could/should be written in pure C and the crypto code optimized for speed with compiler flags alone.&#8221;</p>
<p>Mostly. Having optional assembler implementations for crypto <em>primitives</em> is fine as it&#8217;s a standard practice in this field. Programmers also have portability-enhancing libraries from Apache and Mozilla if they want to totally ignore platforms in most of their code. Those also get plenty of security review thanks to widespread use and big bounties on bugs in respective apps.</p>
<p>Note: A mix of imperative programming, multiple assembler routines, and readibility is ridiculously easy to do with LISP macro&#8217;s. If only the main imperative languages had them. (!)</p>
<p>@ Clive Robinson</p>
<p>&#8220;These days however with 32bit microcontrolers with a quater meg or more of RAMcosting less than 16bit and 8bit solutions the need to dip down in all but hardware register addressing is long past.&#8221;</p>
<p>That Oberon was targeted to ARM Cortex microcontrollers supports your point. A minimal RTOS can usually handle the rest. RTEMS, eCos, ucLinux, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224365">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224365">
						June 13, 2014 9:35 AM					</a>

				</p>

				<p>@Rick:</p>
<p>Regarding your statement:<br />
&#8220;, and after reading about its potential as a hack, I considered that it could be devastating to privacy, and in particular, VPN services&#8221;</p>
<p>Well, what can this function Opensslindirect Call potentially do?</p>
<p>I can only speak a few programming languages. Mostly C and C++. So perhaps this is a question where someone from libressl can give a better answer. And they indicate here</p>
<p><a href="http://www.openbsd.org/papers/bsdcan14-libressl/mgp00025.html" rel="nofollow ugc">http://www.openbsd.org/papers/bsdcan14-libressl/mgp00025.html</a></p>
<p><a href="http://goo.gl/TFjQNl" rel="nofollow ugc">http://goo.gl/TFjQNl</a></p>
<p>that it can be used as an ROP hack.</p>
<p>For me, I only can only comment regarding on the source code comments from Andy Polyakov, when he wrote this function:</p>
<p>&#8220;-# This function can become handy under Win32 in situations when<br />
-# we don&#8217;t know which calling convention, __stdcall or __cdecl(*),<br />
-# indirect callee is using. In C it can be deployed as&#8221;</p>
<p>The windows Hello world program goes like this:</p>
<p>#include &lt;windows.h&gt;<br />
int WINAPI WinMain ( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd )<br />
{<br />
    MessageBox ( NULL, TEXT(&#8220;Hello World!&#8221;), TEXT(&#8220;Test&#8221;), MB_OK );<br />
    return 0;<br />
}</p>
<p>The function MessageBox is defined as follows</p>
<p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms645505(v=vs.85)" rel="nofollow ugc">http://msdn.microsoft.com/en-us/library/windows/desktop/ms645505(v=vs.85)</a>.aspx</p>
<p>int WINAPI MessageBox(<br />
  <em>In_opt</em>  HWND hWnd,<br />
  <em>In_opt</em>  LPCTSTR lpText,<br />
  <em>In_opt</em>  LPCTSTR lpCaption,<br />
  <em>In</em>      UINT uType<br />
);</p>
<p>and this WINAPI is a macro like the following:<br />
<a href="http://msdn.microsoft.com/en-us/library/zxk0tw93.aspx" rel="nofollow ugc">http://msdn.microsoft.com/en-us/library/zxk0tw93.aspx</a></p>
<p>#define WINAPI __stdcall</p>
<p>usually, as I said above, you do not need to think about this calling convention, __stdcall or __cdecl.</p>
<p>If you do not specify the calling convention, youf function is a __cedecl function by default. This callinc convention is merely responsible for the order how things are put into the stack when a function is called:</p>
<p><a href="http://msdn.microsoft.com/en-us/library/zkwh89ks.aspx" rel="nofollow ugc">http://msdn.microsoft.com/en-us/library/zkwh89ks.aspx</a></p>
<p>Microsoft wants that the Main function, the first function with which the program starts is called  int WINAPI WinMain.</p>
<p>But appart from that, your own functions can use __cdecl right away, If you export functions in a dll (that is some library in windows), you can use both conventions, one convention for a certain part of the exported functions and the other convention for the rest</p>
<p><a href="http://www.codeexperts.com/showthread.php?745-What-is-the-difference-between-cdecl-and-stdcall" rel="nofollow ugc">http://www.codeexperts.com/showthread.php?745-What-is-the-difference-between-cdecl-and-stdcall</a></p>
<p>But of course, whenever you write a dll, you have to give a correct c header to the client which uses it that contains the function definitions. And that header contains the calling convention.</p>
<p>Now we come to this code comment from Andy Polyakov:</p>
<p>&#8220;-# This function can become handy under Win32 in situations when<br />
-# we don&#8217;t know which calling convention, __stdcall or __cdecl(*),<br />
-# indirect callee is using. In C it can be deployed as&#8221;</p>
<p>You do not know the calling convention, when you have either been given an incorrect header file, or no header file at all.</p>
<p>This happens, if you want to call something that is not supposed to be called, for example, if you want to hack into some closed source program.</p>
<p>Now what programs can this be?</p>
<p>Current versions of Microsoft Windows have memory protection:<br />
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa366785(v=vs.85)" rel="nofollow ugc">http://msdn.microsoft.com/en-us/library/windows/desktop/aa366785(v=vs.85)</a>.aspx</p>
<p>However, MS-DOS, or Windows95 either have none (MS-Dos) or only partial memory protection:<br />
<a href="http://de.wikipedia.org/wiki/Speicherschutz" rel="nofollow ugc">http://de.wikipedia.org/wiki/Speicherschutz</a></p>
<p>But given that this Openssl_indirect Call was added in 2005, one can assume it was there for systems with memory protection.</p>
<p>OpenSSL itself apparently exposes most of its functions in its API. So Openssl can not be the target.</p>
<p>Wael writes in a posting above:</p>
<p>&#8220;There is another possibility this function was added for instrumentation&#8221;.</p>
<p>I believe this is in fact a possibility.</p>
<p>Openssl provides support for hardware random number generators.</p>
<p><a href="http://freshbsd.org/commit/openbsd/ab683e568bf8833c84b88b4c827186bee90b84ea?diff=lib%2Flibssl%2Fsrc%2Fengines%2Fe_4758cca.c" rel="nofollow ugc">http://freshbsd.org/commit/openbsd/ab683e568bf8833c84b88b4c827186bee90b84ea?diff=lib%2Flibssl%2Fsrc%2Fengines%2Fe_4758cca.c</a></p>
<p>these generators would, if called by openssl, run in an adress space which is accessible by Openssl regardless of some memory protection of the operating system.</p>
<p>Certainly, if e.g. the boss of Huawei uses some hardware random number generator, the nsa would have a high interest, to make it generate numbers that the NSA knows. For this, you would need some way of hacking into the driver of the hardware at the time when it is called by openssl.</p>
<p>Perhaps the &#8220;openssl indirect call&#8221; function is for this purpose?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224366">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224366">
						June 13, 2014 9:38 AM					</a>

				</p>

				<p>sorry, the #include</p>
<p>should be #include windows.h</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224367">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224367">
						June 13, 2014 11:29 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Re Tesla patents,</p>
<p>I note the following &#8220;weasel statment&#8221; in Elon&#8217;s blog comment,</p>
<p><i></p>
<ul>Tesla will not initiate patent lawsuits against anyone who, in good faith, wants to use our technology</ul>
<p></i></p>
<p>&#8220;Good faith&#8221; means many things to many people, and it means nothing to a patent infringer without a legal agreement. Thus if another company used Tesla patents and then tried restrictive practice with their own then that is not &#8220;good faith&#8221; and leaves Elon and Tesla an open field to litigate in.</p>
<p>In essense what he is proposing is not &#8220;open source&#8221; but &#8220;cross licencing&#8221; where the other party has patents, where they don&#8217;t have patents then he is free to use their technology. The exception is an entity that has patents but does not use them or any of Tesla&#8217;s patents, the way the wind is starting to blow with patent trolls and Washington, it may not be long before judges start vacating patents that the holders only use to exthort illegitimate licence fees. Further if Tesla owns what are in effect primary patents to other entities secondary patents then any licence they charge to tesla for use of the secondary patent, Tesla get back with bonus on the primary patent.</p>
<p>The thing is that for all the broughar on electric cars they realy are quite environmentaly unfriendly, the batteries are heavy and low capacity with a very short life time. Recovering the metals etc used is expensive and again quite environmentaly unfriendly. But worse there is not enough of these metals to ever have more than a small percentage of vehicals world wide use this sort of grosely inefficient storage technology.</p>
<p>Unless alternative low cost light weight efficient storage technology is developed fully electric cars will remain a curiosity.</p>
<p>As with trains and various boats a hybrid solution is best, that is you use chemical storage and a hydrocarbon power plant run at it&#8217;s optimum efficiency, excesse power is put into short term efficient mechanical or electromechanical storage (think gyro generators etc) that is also fed from braking etc. The power plant is stopped and short term storage used untill virtually depleated then the power plant kicks back in again. Based on what I&#8217;ve been told by various researchers you could today with a little thought and care get the equivalent of 150 &#8211;UK&#8211; MPG, further more efficient solar cells could provide a significant boost to this on crussing in sunny environments. Apparently a good power plant currently would be a gas tubine similar to a small jet engine, or for small light weight vehicals fuel cell technology.</p>
<p>The only sustainable way for vehicals to remain as numerous and viable is to up their efficiency and replace fossil hydrocarbons with hydrocarbons efficiently generated from primary energy sources ( ie from the sun or nuclear fission or if it ever happens fusion).</p>
<p>Now I&#8217;m sure that Tesla and most large volume vehical manufacturers are more than aware of the significant issues with batteries, the question is thus what technology will actually if ever make them anything more than niche curiosities.</p>
<p>In the long term I&#8217;d put my money on some form of gassification of plant waste such as corn wheat maize and rice stem and leaf stock, where solar derived energy is used to turn them into some form of liquid hydrocarbon fuel and fertiliser efficiently. Rather than just use it as waste that is at best destined for landfill.</p>
<p>One novel sugestion I&#8217;ve seen is solar heating of sea water for desalination and then irigation the excess heat from this is used to provide a bio-digester running a little over blood heat, with the excess heat from this ending up in the equivalent of green houses for rapid growth of equitorial swamp type plants, that also get fed sewage and industrial effluant and feed the bio-digester. The digester output is the likes of methane and an organic slurry which ends up being burnt at high temprature to recover various minerals, the heat is then used as part of a gassification process to convert the methane upto liquid gas etc. Novel as this is I suspect it won&#8217;t happen because fracking output will be used in CHP type gassification to produce liquid gas in the future simply because of the advantages it has in energy density and transportation. Such gas mixtures even town gas and hydrogen will very hapily and efficiently drive gas turbines.</p>
<p>I won&#8217;t say the writings on the wall for battery only electric cars but, with current and forseable technology they will not be anything other tha niche, and I&#8217;m sure Elon has fa tored that in his thinking. Also he may have decided his future is not realy with electric cars but space systems&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224369">

			<div class="comment by-mike-the-goat-horn-equipped ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com' rel='external nofollow ugc' class='url'>Mike the goat (horn equipped)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224369">
						June 13, 2014 1:48 PM					</a>

				</p>

				<p>sockets instead of netbsd in my next embedded project. I have a cemetery display board project coming up soon &#8211; might be the testbed for it. All it needs to do is control an antique flipboard (for the memorial display) and drive a small console with a touch screen to let people look up grave sites. I have done this before with X, no window manager and then having Firefox with a set geometry with the kiosk addon which disables pretty much everything. I had to write a custom driver for the touch screen (warning: don&#8217;t buy generic Asian junk) but asthing with jquery (there were only 10k records). A daily cron job checked an email account for updates. If found and the signature is okay it would turn it into a CSV with catdoc and then parse it into all the HTML files. The kiosk itself was in a phone booth style enclosure with a magnetic lock on it to close it during the night etc. I ended up using a little USB to GPIO board and hooking up a reed switch on the door which woke the PC if it was asleep when someone opened the door, and had a latching relay controlled by the board for the door lock &#8211; normally controlled by time, with time clock changeable by sending a signed email of a specific format. I wrote a cute little windows app for them to run on their client machine that lets them modify the door clock from a GUI and it works as a shell extension so they can just right click their excel spreadsheet of the deaths and send it to the kiosk. Simple but effective, but I am rambling.</p>
<p>Clive: on the subject of old machines and why they were superior &#8211; coding software to fit into limited resources was an exercise in itself and we saw some really clever ideas. Ultimately it meant that people had to think about how to optimize their code and if they could do it in five lines instead of twenty. You could argue that legibility often suffered and I guess in the extreme case that&#8217;s true. Then everyone got lazy.</p>
<p>Re alternative fuels and inventions &#8211; I truly think that in the next decade direct methanol fuel cells will advance to the point where it will make sense just to fuel our gas tanks up with methanol and have it power a fuel cell which keeps either a bank of supercaps or batteries charged (as a buffer and for regen braking) and we can say goodbye to the internal combustion engine forever.</p>
<p>Speaking of fuel cells I got a 10W cell off eBay a while back with the idea that I could take it camping with me and keep my gadgets powered up. I made an enclosure and setup a reservoir, made a charging circuit that feeds into a few 18650&#8217;s and have a 2A USB charger integrated. The only problem is that it in cold conditions the cell must be preheated before it will function.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224372">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224372">
						June 13, 2014 7:10 PM					</a>

				</p>

				<p>@Buck,</p>
<blockquote><p>Will share more shortly!</p></blockquote>
<p><i>The longest time holding the breath underwater was 22 min 00 sec by Stig Severinsen (Denmark) at the London School of Diving in London, UK, on 3 May 2012.</i> I think I obliterated his record. But if I hold my breath any longer, I&#8217;ll suffocate 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224373">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224373">
						June 13, 2014 7:42 PM					</a>

				</p>

				<p>@Wael</p>
<p>Bleh! I&#8217;m being lazy 😉<br />
It&#8217;s more a collection of articles than anything new&#8230; Still working on it<br />
Long story short &#8211; Stingray-like devices can be produced with COTS software at a very modest price because mobile phone encryption is an exercise in security through expense (money or time) that has been basically eliminated thanks to Moore&#8217;s Law.</p>
<p>I was thinking that I should just go ahead and make my own and release the plans, but there are two problems for me&#8230; First being potential legal issues (although legitimate LEA Stingray use itself probably runs afoul of multiple laws), but the second is the bigger of the two. Do I really want to up the ante in this cat&amp;mouse spy/counterspy game!?</p>
<p>If these devices become widely available, then we&#8217;ll simply see another slight increase in security, and then have to do this whole mess over again in 5-10 years&#8230; If what we&#8217;re doing here is really just propping up a new tech industry, lets call it like it is! No more of this mumbo-jumbo &#8216;National Security&#8217; nonsense&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224374">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224374">
						June 13, 2014 8:04 PM					</a>

				</p>

				<p>@ Wael, Buck</p>
<p>Stingrays work by mimicking a base station to get a connection to a phone, then using typical triangulation techniques to get a lock on its location. The triangulation I&#8217;m guessing an engineer like Wael can figure out. The other part is done by devices called IMSI catchers. Chris Paget does plenty of good work in that area. <a href="http://www.wired.com/2010/07/intercepting-cell-phone-calls/" rel="nofollow ugc">This</a> Wired article reports on one of his that costs $1,500. It&#8217;s aimed at 2G calls, but can jam 3G signals to force fall-back to 2G.</p>
<p>Combine the two technologies and you have a DIY Stingray.</p>
<p>Note: I always thought they had an agreement with the carrier to easily impersonate their base stations and just made crap up about high tech, up-close attacks for deniability. Of course, maybe the carriers aren&#8217;t cooperative and it takes the equipment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224376">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224376">
						June 13, 2014 9:31 PM					</a>

				</p>

				<p>@Buck,<br />
Femtocell</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224377">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224377">
						June 13, 2014 9:35 PM					</a>

				</p>

				<p>@Nick P, @Buck,<br />
Hard to communicate wirelessly for a period of time without being located. But you can create a confidential secure channel between two end points.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224378">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224378">
						June 13, 2014 10:07 PM					</a>

				</p>

				<p>@ Wael</p>
<p>It is. Only thing I&#8217;ve heard of that&#8217;s been fielded was burst transmission. I later looked into meteor burst, moon bounce, FSO relays, entangled photons, hyperencryption, and neutrinos for potential options. Still can&#8217;t say I&#8217;ve found a good option.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224379">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">@Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224379">
						June 13, 2014 10:28 PM					</a>

				</p>

				<p>Excellent! Burst is the one. Compress the data and send it in a burst of a few short seconds, then change your location. Spies do / did that at one point. Meteor burst, I know nothing about. Moon bounce, I know. EME &#8211; Earth-Moon-Earth. Saw that in the early 80&#8217;s with a Ham radio operator, 2KW station. His neighbors complained as it screwed up their TV reception. His location was not exactly difficult to find. I kid you not, when he pushed the transmit button, his house lights dimmed and were modulated with his voice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224381">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224381">
						June 14, 2014 2:56 AM					</a>

				</p>

				<p>@Benni,<br />
I got OpenSSL to build on my Mac, but x86cpuid.s was not generated (as expected, since it&#8217;s supposed to be for Windows). Maybe you should try it on your Windows machine if you care. Also if you do a ./config -no-asm, I am guessing it won&#8217;t be generated either, so I doubt the comment by the OpenBSD guys claiming it&#8217;s &#8220;unconditionally compiled&#8221; is true. Their other concerns seem rational to me. By the way, the calling convention is not only about the order of pushing the parameters on the stack, it&#8217;s also about who cleans the stack (caller or callee). I don&#8217;t think I want to spend anymore time on this&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224382">

			<div class="comment by-iain-moffat ">

				<p class="commentcredit">

					<span class="commenter">Iain Moffat</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224382">
						June 14, 2014 5:41 AM					</a>

				</p>

				<p>@@Nick P</p>
<p>The classic burst radio transmission device was the clockwork AN/GRA-71 which was used in the 1960s by the CIA and regular forces in Vietnam and the British in Malaya and Aden. The later RACAL MEROD devices and the EMU fitted to SAS UK/PRC-319 radios in Iraq was a solid state counterpart using 300 baud data. While faced with a scanning receiver or spectrum analyser as an adversary and using narrow band fixed frequency radios, shortening the transmission to complete in a small fraction of the time the scanner takes to tune across the band is somewhat effective in reducing the chance of being detected, but such things became unsafe as soon as Bragg cell and later digital FFT based wideband receivers became practical as they see all signals within their pass band in real time. Modern fast A/D converters with 500MHz clocks or faster should make an FFT analyser that can cover the entire HF and VHF spectrum quite affordable now.</p>
<p>Amateurs have done meteor burst at least as long as moon bounce (EME) &#8211; while it allows VHF communication over the horizon the meteor echoes can be received over a wide area and is certainly not secure from detection &#8211; it may be harder to locate a source from the ground than an HF transmitter of equivalent range however. I would say that an EME or meteor ground station is about as hard for an adversary to locate as a satellite ground station &#8211; a significant effort to do remotely if ground-bound but trivial if air or space based receivers are available. Meteor has some merit over moon for clandestine use in that the ground station needs less power and is easier to hide, and the adversary has to scan the whole sky all the time rather than follow one easily predicted moon.</p>
<p>The other factor to consider when assessing the detection and location threat (as apart from decryption) is how far radio signals travel. At one time it was possible to hide from all but very local receivers on the ground by use of VHF or UHF and low power. The existence of airborne and space based monitoring significantly changes that calculation. Amateur radio contact between space and ground stations using a few watts is routine so even a cheap handheld radio can be monitored with ease from low earth orbit where the radio horizon is thousands of miles. It must also be remembered that an airborne or orbiting platform is moving so provides its own baseline and can take multiple bearings on a radio source to enable triangulation much more easily than a ground based system that requires multiple coordinated stations or to relocate repeatedly.</p>
<p>I believe the only way for radio communication to genuinely be safe due to physical limits on an adversary now is to use spread spectrum communications at low power (low enough to be well below the noise floor at satellite altitudes) and if possible use microwave frequencies around 25 or 60GHz where range is limited by water or oxygen absorption in the atmosphere.</p>
<p>Iain</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224383">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224383">
						June 14, 2014 7:37 AM					</a>

				</p>

				<p>@ Nick p, Wael, Buck,</p>
<blockquote><p>Hard to communicate wirelessly for a period of time without being located.</p></blockquote>
<p>We have discussed this befor&#8230;</p>
<p>All EM radiation follows an inverse square law as simple mathmatics will describe ( ie Pwr/Area). You need a certain minimum bandwidth for any information content.</p>
<p>Thus anyone betweeny your TX and recipients RX has as good a chance of receiving your communication as they do.</p>
<p>Those are the basic rules of the game and they are underpined by various assumptions and laws that are believed to be valid.</p>
<p>You can however play with the area covered, the transmission bandwidth used and the length of time of the transmission.</p>
<p>The simplest thing to do is to reduce the area the transmission is radiated across, this is achived in a number of ways, the simplest being the use of high gain antennas at both the TX and RX. More complicated is the use of multiple phase cohearent antennas which can be taken to extreams by MIMO systems. In theory MIMO of the EM carrier and information will prevent any adversary who cannot see all information channels from seeing the information.</p>
<p>There are two bandwidths you can play with, the EM carrier bandwidth abd the information bandwidth. The former gives rise to the likesof Spread Spectrum systems the latter burst transmission and multiple information channel systems.</p>
<p>Finally the one that tends to get ignored, which is time, the information channel can be compressed in time but as a consiquence has to increase both power and bandwidth. This is the major problem of burst systems they tend to stand out like a lightning strike on a moonless summer night. However the opposit also applies, if you streach the time the information is transmitted on the bandwidth or power or both can be reduced.</p>
<p>I have used microwatts of power in the VHF band to send simple t&#8217;lem info at 0.2bits/sec hundreds of miles very reliably which people using conventional equipment cannot receive standing with in eyeball range of the TX antenna.</p>
<p>The next series of tricks to play is to bend the EM signal around the corner or corners, it is however generally very lossy due to the issue of beam spread. Almost any vaguely conductive surface or surface with a suitably different dialectric constant will bend or bounce what would otherwise be a line of sight transmission.</p>
<p>The simplest is bending LF and HF in the atmosphear layers and even VHF and UHF can be &#8220;ducted&#8221; at certain times of year and weather conditions. For instance the &#8220;Northen Lights&#8221; caused by particles from the sun ionize the atmosphear making it extreamly conductive and tiny amounts of power will be efficiently reflected.</p>
<p>The same applies to meteor showers, their ionized trails make efficient reflectors. As for the moon yup it&#8217;s got a largesurface, but it&#8217;s not a particularly efficient reflector for various reasons sothe uplink needs tobe in the tens of killowatts Effective Radiated Power (ERP) for a just above the noise floor return.</p>
<p>You can &#8211;and it has been done&#8211; reflect signals off of low orbit space craft, but unless it&#8217;s designed to do it (tri-corner reflector) the efficiency is going to be way way down.</p>
<p>However there is the option of a &#8220;passive repeater&#8221; which essentialy is two antennas joined back to back by a veryshort length of transmission line. These used to be used in hilly or mountainous areas to get TV and radio signals into otherwise screened valleys. The advantage of such as system is it&#8217;s bi-directional simultaniously without all the attendant problems of active systems. I&#8217;ve built and used a system using 70cm antennas to relay signals from south London upto the &#8220;Downs&#8221; near Epsom and down to the &#8220;South Downs&#8221; near Brighton so that two walkie talkes could communicate over an otherwise impossible 70mile path.</p>
<p>As I&#8217;ve mentioned before &#8220;gumstick computers&#8221; with WiFi and broadband mobile modems can be easily built for less than a hundred USD and put up on municiple carparks etc simply by parking a car on the roof level. A simple script acting as a timer keeps the GSM and WiFi sides down except for a short time window. And it&#8217;s not that difficult to make &#8220;port knocker&#8221; software. Or as I&#8217;ve mentioned befor use an old fashioned &#8220;pager&#8221; to act as a switch via a serial line. A chain of systems using WiFi or amatur radio equipment or even X-band traffic light doppler radars and satellite dishes and set top boxes can link hundreds of miles with few node points.</p>
<p>The problem with such systems is not putting them together or deploying them, but blending in such that traffic correlation is difficult even for the likes of s Boeing &#8220;Rusty Rivet&#8221;. This is where the &#8220;herd mentality&#8221; comes in. Most network traffic is not like voice comms thus VoIP and equivalent video comms stands out no matter how much you encrypt it.</p>
<p>Thus you need your signal to be variously compressed, expanded and apparently sent to multiple valid IP addresses such that it looks like HTTPS traffic to say Google or other service. All without being to objectionble  by the end users. Writing software to do this is actually not that difficult and most 2nd year CS grad students could do it as a one simester project with little diffuculty, if given pointers in the right direction.</p>
<p>Personally I would avoid standard mobile voice comms it&#8217;s dessigned so it cannot be easily made anonymous, not just for billing but because the Five-Eyes Intel Orgs have been backdooring phone communications in the name of &#8220;customer/network safety&#8221; since befor the phone was in general service to anyone other than an exceptional few, and Strowger was lossing business to a rival &#8220;en-cryptor&#8221;[1].</p>
<p>[1] The word &#8220;encrypt&#8221; in many countries means the same as &#8220;entomb&#8221; or to bury a body safely. Strowger was an undertaker by proffession and believed he was loosing business to a rival undertaker, and went from suspission to belief when he found that a close femail relative of his rival worked on the phone switch board. Which led him to invent the &#8220;woman less, fickel less automatic switch board&#8221; that remaind in service in many places even in the 1990&#8217;s because it was largely very very reliable and unlike most electronic solutions EMP and solar burst proof, and realy it was the advent of Home Broadband that was the final nail for strowger systems in all but a few select places.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224384">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224384">
						June 14, 2014 10:41 AM					</a>

				</p>

				<p>Clive Robinson RE: Coin trick<br />
&#8211;Ah ok now I can see it, flipping in the palm of your hand.  Takes quick thinking.  I was thinking you catch it, look, then flip or not depending on the call (which the person could call &#8220;unfair&#8221;).  You can beat that trick though by saying to let the coin hit a hard ground (and keep your paws away from the landing :).</p>
<p>RE: icebreakers and &#8220;game&#8221;<br />
&#8211;Yeah I&#8217;ve stopped those and my game&#8217;s cold now lol. I&#8217;ve pissed off a lot of girls though b/c I don&#8217;t want to put up w/ their BS, then of course I run into them later&#8230;I don&#8217;t know what to say to some people&#8230;I&#8217;ll just buy cheap beer and go back to my lab.</p>
<p>RE: a life of stealing<br />
&#8211;Not for me nor really interesting, don&#8217;t have anything to prove to anyone.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224385">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224385">
						June 14, 2014 11:30 AM					</a>

				</p>

				<p>Clive (and others re covert channels): The paper by Hanspach and Goetz on covert acoustic mesh networks is <a href="http://cryptome.org/2014/06/covert-acoustical-mesh.pdf" rel="nofollow ugc">interesting reading</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224386">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224386">
						June 14, 2014 12:34 PM					</a>

				</p>

				<p>@ Wael</p>
<p>I knew it was your post as it was in the same &#8220;time slot&#8221; as the rest of your posts and the writing style is similar. 😉 Far as moon bounce, I just think bouncing communications off the moon is a cool idea. My investigation into its covert use presumed an ability to narrowly focus the beam enough to avoid the problems you mentioned. I wasn&#8217;t sure if that was achievable so I didn&#8217;t investigate much into it past a fun comms tech to play with. Infrared point-to-point, burst, meteor, quantum, and E/VLF were my primary investigations.</p>
<p>@ Iain</p>
<p>Thanks for your reply. With what little knowledge I have I&#8217;d suspected the properties of meteor burst transmission might make triangulation difficult. I&#8217;m glad you mentioned satellites because I overlooked it for some reason. So, final recommendation is spread spectrum at 25 to 60GHz. You sure they can&#8217;t monitor the entire spectrum in real-time? In that case, does spread spectrum really have benefit?</p>
<p>@ Clive Robinson</p>
<p>Thanks for the [beyond my skill] tips. A few I can use immediately. Others I&#8217;ll archive as usual for my future team of EE majors that can build it all. 😉</p>
<p>@ All (esp RobertT)</p>
<p>Nice article on how analog engineering skills are still in demand and in shorter supply each year:</p>
<p><a href="http://www.eetimes.com/document.asp?doc_id=1322672&#038;amp" rel="nofollow ugc">http://www.eetimes.com/document.asp?doc_id=1322672&#038;amp</a>;</p>
<p>I remember during our secure chip discussions that RobertT kept bragging that he mixed analog and digital components together for obfuscations because most engineers didn&#8217;t even understand analog. Inspired by that, I speculated here a little about all-analog security schemes for encryption and computation. Mostly left that to gather dust. Yet, this article shows the viability of his scheme is accelerating in somewhere between a linear and exponential way. Future efforts to slow TLA&#8217;s should probably learn from it and put some amount of control/confidentiality protection into clever analog circuits.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224387">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224387">
						June 14, 2014 1:10 PM					</a>

				</p>

				<p>@Iain Moffat,</p>
<blockquote><p>The classic burst radio transmission device was the clockwork AN/GRA-71 which was used in the 1960s by the CIA and regular forces in Vietnam and the British in Malaya and Aden.</p></blockquote>
<p>&#8220;@@NIck P&#8221; happens to be my illegitimate sockpoppet. I accidentally put his name in the name field.<br />
Thank you for the informative links&#8230; One other possibility is line-to-line laser modulated beams. If the laser is in the invisible band, it can&#8217;t be detected easily, but there will be significant effort needed to align the receivers, and mobility is not easily achieved.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224388">

			<div class="comment by-iain-moffat ">

				<p class="commentcredit">

					<span class="commenter">Iain Moffat</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224388">
						June 14, 2014 5:41 PM					</a>

				</p>

				<p>@NickP:</p>
<p>There is probably greater expense and inconvenience to monitoring higher microwave frequencies. Having said that the choice of 25 or 60GHz is to ensure that, if the power level is calculated to be low enough, atmospheric absorption will ensure that the power reaching a remote detector is below its sensitivity.</p>
<p>A DSS type spread spectrum system (or indeed any kind of simultaneous multi channel transmission which requires knowledge of the spreading code or correlation over multiple channels known to the receiver to recover a signal) avoids the need to radiate significant and detectable power on a single frequency which also helps keep a low profile against local receivers.</p>
<p>@Wael:</p>
<p>Free space optical is definitely viable for point to point links. There has been a lot of work done by radio amateurs in the North of England recently with routine communication over 90-100km paths. See:</p>
<p><a href="http://www.g4jnt.com/OpticalComms/OpticalComms.htm" rel="nofollow ugc">http://www.g4jnt.com/OpticalComms/OpticalComms.htm</a><br />
<a href="http://www.earf.co.uk/nanotrx.htm" rel="nofollow ugc">http://www.earf.co.uk/nanotrx.htm</a><br />
<a href="http://modulatedlight.org/optical_comms/optical_index.html" rel="nofollow ugc">http://modulatedlight.org/optical_comms/optical_index.html</a></p>
<p>They mostly use LEDs rather than lasers as pointing accuracy is less critical and some atmospheric problems are avoided by using a physically large and non-coherent source. The emphasis to date has been on range and throughput; from the security viewpoint I do ponder about dust/rain/mist in the path being illuminated by the beam and visible from the side or above.</p>
<p>Regards</p>
<p>Iain</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224389">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224389">
						June 15, 2014 1:48 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<blockquote><p>All EM radiation follows an inverse square law as simple mathmatics will describe</p></blockquote>
<p>This law applies to the far field. The near field relation is a lot more complex, but far filed is what we mainly care about anyway.</p>
<blockquote><p>I have used microwatts of power in the VHF band to send simple t&#8217;lem info at 0.2bits/sec hundreds of miles very reliably which people using conventional equipment cannot receive standing with in eyeball range of the TX antenna.</p></blockquote>
<p>Microwatts going hundreds of miles! How did you achieve that? I am really curious. I had a hard time reaching 10 miles with tens of milliwatts of power in that frequency band. What kind of antenna did you build? Must have been a parabolic directional antenna at both ends?</p>
<pre> </pre>
<blockquote><p>final nail for strowger systems in all but a few select places.</p></blockquote>
<p>You really needed to insert the word “coffin” after nail. Fits the amusing story!</p>
<pre> </pre>
<p>@Iain Moffat,</p>
<pre> </pre>
<blockquote><p>They mostly use LEDs rather than lasers as pointing accuracy is less critical </p></blockquote>
<p>Appreciate the links! I was referring to this <a href="http://www.omicron-laser.de/english/lasers/diode-lasers/phoxx-lasers/phoxx-diode-laser.html" rel="nofollow ugc">sort</a> of lasers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224390">

			<div class="comment by-rick ">

				<p class="commentcredit">

					<span class="commenter">Rick</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224390">
						June 15, 2014 1:03 PM					</a>

				</p>

				<p>@Benni,</p>
<p>I was down for a bit but I&#8217;m back, now. Thank you for taking the time and patience to respond to someone who cannot code to the same degree that many on this forum enjoy. I read through your answer, cross referenced the information to a few sites, and like a layman reading a journeyman&#8217;s guide, I was able to piece together the concept. (I can script a bit but I surely don&#8217;t code for a living.)</p>
<p>So, in conclusion, it would appear that the ROP function in &#8216;plain vanilla&#8217; OpenSSL remains suspicious, is a potential threat, but the keys to the kingdom haven&#8217;t been handed over a 3-letter government agency du jour (at least through that function).</p>
<p>Still, the messy condition of OpenSSL welcomes subversion and that (in and of itself) is reason enough to be suspicious given its wide role to protect the public&#8217;s private information. Apparently, according to Wael (contributor to this thread), that ROP function is not included in the FIPS version. Imagine that.</p>
<p>The VPN shop I communicate with was interested to know this, and fortunately, due to the informed discussion that ensued here their OpenVPN package will now include the FIPS version in a forthcoming release to their (numerous) users soon. Positive change can indeed happen, one step at a time.</p>
<p>Thank you!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224391">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224391">
						June 15, 2014 6:29 PM					</a>

				</p>

				<p>@Rick:</p>
<p>In order for details that you can use in your business, it would be good if you contact the openssl developers on this matters.</p>
<p>I can only say that the comment from Polyakov regarding Windows looks like nonsense to me, since i have learned C and C++ on windows machines, and there never occured any problem for which I would have needed such a function, even if you do quite dirty hacks involving function pointers of API functions.</p>
<p>What the function Openssl_indirect_call itself is able to, for this the Openssl developers who found it are the persons who can answer better.</p>
<p>Ask them. Perhaps others would be interested in their answer, if they provide one.</p>
<p>Regarding the Fips version of Openssl:<br />
I can not give any recommendation, since I would have to look at the Fips module first.</p>
<p>For example, in openssl-fips-2.0.5.tar.gz provided by the openssl homepage, I see the function Openssl_indirect_call still there. And I see it at the same place where it is in the regular Openssl library.</p>
<p>I do not know which package Wael ment when he said it would be absent in the Fips version. But perhaps the Openbsd developers can provide more reliable information for which systems this is compiled and where it is available.</p>
<p>On my gentoo Linux system, the assembler file that contains it seems to get compiled, too.</p>
<p>There are some blogposts indicating that the fips module was not affected by heartbleed:</p>
<p><a href="http://fips140.blogspot.de/2014/04/openssl-heartbleed-bug-and-fips.html" rel="nofollow ugc">http://fips140.blogspot.de/2014/04/openssl-heartbleed-bug-and-fips.html</a></p>
<p>but since this announcement came from openssl developers, I would have to verify it, before i could jump to conclusions. And for this i do not have the time now.</p>
<p>I do not know if the fips version is affected by these bugs:</p>
<p><a href="https://www.openssl.org/news/secadv_20140605.txt" rel="nofollow ugc">https://www.openssl.org/news/secadv_20140605.txt</a></p>
<p>Since it was last updated in June.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224392">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224392">
						June 15, 2014 8:03 PM					</a>

				</p>

				<p>@Benni, @Rick,</p>
<blockquote><p>I do not know which package Wael ment when he said it would be absent in the Fips version</p></blockquote>
<p>I specified it here: <i>Secondly: I downloaded openssl-fips-1.1.2.tar.gz from <a href="http://www.openssl.org/source/" rel="nofollow ugc">http://www.openssl.org/source/</a> </i> earlier on this thread.</p>
<p>I did a search for the function in the files. Below, it doesn&#8217;t show in &#8220;openssl-fips-1.1.2&#8221; but shows in &#8220;openssl-1.0.1h&#8221;.</p>
<pre>
[openssl-fips-1.1.2] grep -ir "OPENSSL_indirect" *
[openssl-fips-1.1.2] cd ../openssl-1.0.1h
[openssl-1.0.1h] grep -ir "OPENSSL_indirect" *
crypto/x86cpuid.pl:#    type OPENSSL_indirect_call(void *f,...);
crypto/x86cpuid.pl:#    OPENSSL_indirect_call(func,[up to $max arguments]);
crypto/x86cpuid.pl:&amp;function_begin_B("OPENSSL_indirect_call");
crypto/x86cpuid.pl:&amp;function_end_B("OPENSSL_indirect_call");
[openssl-1.0.1h] 
</pre>
<p>I also said, grep is not the way to find out since the function name &#8220;may&#8221; change to something else. You need to get the tree as I outlined above and build it on your own. You&#8217;ll need to check the commits and really check the source on your own. I am not saying the FIPS version is any better or worse. As such, please don&#8217;t take my comments as a recommendation for one or the other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224393">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224393">
						June 15, 2014 9:02 PM					</a>

				</p>

				<p>@Wael</p>
<p>&#8220;I specified it here: Secondly: I downloaded openssl-fips-1.1.2.tar.gz from&#8221;</p>
<p>Openssl-fips 1.1.2? You mean this file, which is dated from</p>
<p>Dec  1 00:25:33 2007 ?<br />
<a href="https://www.openssl.org/source/openssl-fips-1.1.2.tar.gz" rel="nofollow ugc">https://www.openssl.org/source/openssl-fips-1.1.2.tar.gz</a></p>
<p>I would strongly discourage to use an old openssl version. Openssl developers usually do not fix bugs. They only fix bugs when they are so severe that they can not ignore them. An old openssl version has to be assumed to be vulnerable with all sorts of flaws, and more importantly, with known flaws that were publicly announced. So using an old openssl version is an open entry door for hackers.</p>
<p>The recent fips version is:<br />
 Jun 20 21:21:47 2013 openssl-fips-2.0.5.tar.gz (MD5) (SHA1) (PGP sign)</p>
<p>And this contains openssl indirect call.</p>
<p>And still I do not know whether the recent fips version it is vulnerable by something that the developers have fixed in their recent non-fips versions of the library. That the module has been certified by NSA agents who placed a fips marker on it does not mean that its secure then. Just that it delivers a sort of security that NSA wants to see. Like their weakened standard random number generator DUAL_EC that made it into the FIPS versions of Openssl&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224394">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224394">
						June 15, 2014 9:15 PM					</a>

				</p>

				<p>@Benni,<br />
Was looking at the history in the git (used sourcetree). The indirect call was added by Andy in Dec, 3 2005. If I were worried about this function, I would remove it from the tree and compile my own version. I could not find a FIPS-1.1.2 Tag in the tree. I checked openssl-fips-1.2, and found it to contain OPENSSL_indirect. I would just remove it or use the version from the OpenBSD guys, if I were to do it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224395">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224395">
						June 16, 2014 8:41 AM					</a>

				</p>

				<p>@Wael: Yes, removing these things by yourself is the only option.</p>
<p>Look at the libressl code. Look at the openssl code.</p>
<p>And then you might perhaps guess that some of the removals they made in libressl can also be made in your version of the openssl library.</p>
<p>And then you can start changing the library by yourself, making your own changes, appart from the removals they did in libressl, in order to make your openssl library more secure. But do not forget to send patches to libressl.</p>
<p>For a business concerned about its security that is the obvious way to go.</p>
<p>It is hard, but there is no other way.<br />
The only person you can thrust is yourself these days.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224396">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the goat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224396">
						June 17, 2014 4:07 AM					</a>

				</p>

				<p>Benni: the other way would be using something like cyaSSL which has an openssl compatibility layer to facilitate migration.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-224397">

			<div class="comment by-michael-moser ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mosermichael.github.io/cstuff/' rel='external nofollow ugc' class='url'>Michael Moser</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224397">
						June 18, 2014 7:38 AM					</a>

				</p>

				<p>what&#8217;s all this fuzz about openssl? They can always put in a SSL proxy in the middle; no problem.  Chrome will not allow this for google certificates because its own certificate (interesting if there is a feature somewhere that can disable this check), for the rest of the world there is no problem.</p>
<p>Another issue is that the protocol is way to complicated, whatever they do there will be tons of bugs left;</p>
<p>i guess it would be better to focus on a comprehensive and openly accessible test suite for ssl implementations, so that the library can be tested with valgrind as an automation test.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-224398">

			<div class="comment by-michael-moser ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mosermichael.github.io/cstuff/' rel='external nofollow ugc' class='url'>Michael Moser</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/#comment-224398">
						June 18, 2014 7:41 AM					</a>

				</p>

				<p>i doubt that anybody will focus on a openssl test suite; QA is not sexy enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/06/friday_squid_bl_428.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/06/friday_squid_bl_428.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F06%2Ffriday_squid_bl_428.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/06/friday_squid_bl_428.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5364' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/06/gchq_intercept_.html" rel="prev">← GCHQ Intercept Sites in Oman</a>		<a href="https://www.schneier.com/blog/archives/2014/06/security_and_hu_3.html" rel="next">Security and Human Behavior (SHB 2014) →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
