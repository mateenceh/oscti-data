<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Identifying Dread Pirate Roberts - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Identifying Dread Pirate Roberts Comments Feed" href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5955" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5955' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F09%2Fidentifying_dre.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F09%2Fidentifying_dre.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5955 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5955" class="post-5955 post type-post status-publish format-standard hentry category-uncategorized tag-authentication tag-captchas tag-geolocation tag-identification">

	<div class="article">

		<h2 class="entry">Identifying Dread Pirate Roberts</h2>
		<p>According to court documents, Dread Pirate Roberts was identified because a CAPTCHA service used on the Silk Road login page <a href="http://krebsonsecurity.com/2014/09/dread-pirate-sunk-by-leaky-captcha/">leaked</a> the users&#8217; true location.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/authentication/" rel="tag">authentication</a>, <a href="https://www.schneier.com/tag/captchas/" rel="tag">captchas</a>, <a href="https://www.schneier.com/tag/geolocation/" rel="tag">geolocation</a>, <a href="https://www.schneier.com/tag/identification/" rel="tag">identification</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html" rel="bookmark">Posted on September 17, 2014 at 2:30 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html#comments">37 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html" data-title="Identifying Dread Pirate Roberts" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-230874">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230874">
						September 17, 2014 2:45 PM					</a>

				</p>

				<p>Software as a secret service&#8230;? 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230875">

			<div class="comment by-danno-ferrin ">

				<p class="commentcredit">

					<span class="commenter">Danno Ferrin</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230875">
						September 17, 2014 2:45 PM					</a>

				</p>

				<p>Two questions, (a) Do you think what was presented in court could have actually lead to the identification of DPR? and if so (b) Do you think that is actually what was used to ID him or was this a case of parallel construction?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230876">

			<div class="comment by-st37 ">

				<p class="commentcredit">

					<span class="commenter">st37</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230876">
						September 17, 2014 3:03 PM					</a>

				</p>

				<p>There is an analysis that questions this idea.</p>
<p><a href="http://www.wired.com/2014/09/fbi-silk-road-hacking-question/" rel="nofollow ugc">http://www.wired.com/2014/09/fbi-silk-road-hacking-question/</a><br />
<a href="http://weev.livejournal.com/407404.html" rel="nofollow ugc">http://weev.livejournal.com/407404.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230877">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230877">
						September 17, 2014 3:14 PM					</a>

				</p>

				<p>@Danno Ferrin</p>
<p>In hindsight, yes, they could have gotten a warant to access to logs from the captcha service, made a series of requests looking at what they received and what IP the captcha service used to send them.</p>
<p>Whether they actually did that, I don&#8217;t know. Parallel construction is just as plausible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230878">

			<div class="comment by-vas-pup ">

				<p class="commentcredit">

					<span class="commenter">vas pup</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230878">
						September 17, 2014 3:19 PM					</a>

				</p>

				<p>Looks like Internet becoming kind of &#8216;Wild West&#8217; when neither &#8216;sheriff&#8217; nor &#8216;gang&#8217; bound by law.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230879">

			<div class="comment by-thomasblair ">

				<p class="commentcredit">

					<span class="commenter">thomasblair</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230879">
						September 17, 2014 3:29 PM					</a>

				</p>

				<p>I apologize for the length up front.</p>
<p>This is very different than the method that was described in the criminal complaint filed on 9/27/13.</p>
<h2>Summary of criminal complaint below:</h2>
<p>As for Ulbricht, this is how the complaint reads that they found him:</p>
<p>Jan 2011 &#8211; When Ulbricht made SR he went on a site called shroomery.org and posted some concern marketing as a user named &#8220;altoid&#8221;. He did the same on a site called bitcointalk.org.</p>
<p>Oct 2011 &#8211; Another post by &#8220;altoid&#8221; on bitcointalk.org asking for an IT pro in the bitcoin community. The posting directed users to a gmail account &#8211; <a href="mailto:rossulbricht@gmail.com">rossulbricht@gmail.com</a></p>
<p>The gmail acct has a google+ acct with pic posted. It matches a linkedin acct with Ulbricht&#8217;s name.</p>
<p>The Google+ page has links to favorite youtube videos &#8211; many from mises.org. There is a mises.org acct with the name Ross Ulbricht and his pic that matches google+ and linkedin.</p>
<p>The DPR account on SR has a link to mises.org in the signature (one of only two in the signature). In forum postings, DPR cites the Austrian economic theory and von Mises and Rothbard as providing the philosophical underpinnings of his creating SR.</p>
<p>The records they got from Google showing IP addresses that accessed the gmail account put him at an address in on Hickory St in San Francisco. The server code for SR was written such that only someone logging in from a certain IP can get access. That IP was traced to a VPN service. Records subpoenaed from the VPN indicate the IP used to access was traced to an internet cafe 500 ft from the Hickory St address where Ulbricht was known to be living and where he accessed the gmail acct. These logins all occurred on the same day within 500&#8242; of each other &#8211; June 3, 2013.</p>
<p>In July Ulbricht moves to an address on 15th St in SF. Customs stumblefvcks (as part of a &#8220;routine search&#8221;) into inspecting a package that contains 9 forged identity documents, each for a different name but all with Ulbricht&#8217;s photo. The package was addressed to the 15th St address where Homeland Security finds Ulbricht (who obviously matches the photos on the forged ID&#8217;s). Ulbricht refuses to answer questions but offers that &#8220;hypothetically&#8221; someone could go the the &#8220;silk road on Tor&#8221; and purchase any drugs or fake ID&#8217;s they wanted. Ulbricht provided the DHS agents with his true license (TX) and told them he was renting a room for cash. The roommates knew him as &#8220;Josh&#8221; and said he spent all his time on the computer in his room.</p>
<p>In June and July 2013 the DPR acct expressed interest in a batch of fake ID&#8217;s on SR. The FBI knows what is contained in all private messages from SR because they had the server hosting company make an image and send it to them in late July.</p>
<p>March 2012 &#8211; On stackoverflow Ulbricht had an acct with his name and gmail address and posted a question about how to use a certain kind of code to connect to a Tor hidden service. One minute after posting, the acct name is changes from &#8220;Ross Ulbricht&#8221; to &#8220;frosty&#8221;. A few months later he changes the email associated with the acct to <a href="mailto:frosty@frosty.com">frosty@frosty.com</a>. The sections of code that Ulbricht posted on stack overflow asking for help are substantially identical (less the small changes for the bugs he was trying to work out) as the source code for SR as obtained in the image of the server the FBI obtained.</p>
<h2>An encryption public key ends with the text string &#8220;user@computer&#8221; wherein the username and computer name of the person creating the public key is recorded. The encryption key for authenticating the administrator trying to sign into the SR back end has the text string frosty@frosty meaning whoever made the public key for signing into the SR back end as an admin did so from a computer named &#8220;frosty&#8221; using a user account named &#8220;frosty&#8221;.</h2>
<p>So which method is it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230880">

			<div class="comment by-douglas-knight ">

				<p class="commentcredit">

					<span class="commenter">Douglas Knight</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230880">
						September 17, 2014 5:13 PM					</a>

				</p>

				<p>thomasblair, they could both be true.</p>
<p>Contrary to Bruce&#8217;s headline, this was a method of finding the server, not a method of identifying DPR. The documents you cite claim that they found the server long before they identified DPR. They claim to have obtained physical access to the server and still not found DPR. (but I think they also mentioned ways that they could have traced him from the server)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230881">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230881">
						September 17, 2014 6:05 PM					</a>

				</p>

				<p>I&#8217;ll admit that I used silk road to buy cannabis a few times. But I&#8217;m not a trusting person so I did my own analysis before trusting the site with an actual purchase.</p>
<p>A lot of that analysis was on the login/registration pages (including the captcha). My deep packet inspection included checking the IP headers and attempting to verify if they were assigned to current Tor relays (using publicly available relay lists). Weather or not they were listed &#8230;none of them hosted services accessible on the clearnet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230882">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230882">
						September 17, 2014 6:15 PM					</a>

				</p>

				<p>follow up: of coarse, I was just verifying if Tor was really doing its job to protect me. If I was trying to locate the hidden service&#8217;s actual IP address &#8230; I would have tried other methods. It&#8217;s safe to say that investigators tried such methods.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230883">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230883">
						September 17, 2014 6:46 PM					</a>

				</p>

				<p>@ thomasblair</p>
<p>They probably did all that after the fact for a court-worthy case. A jury would simultaneously be overwhelmed with the information and see lots of dots connecting. It&#8217;s a good case. The problem is they had to start somewhere and they&#8217;re known to hide that part.</p>
<p>@ st37</p>
<p>Those documents give the missing piece of the puzzle. Specifically, the vulnerability assessment and thomasblair&#8217;s stackoverflow references show the guy had no skill in secure, web development. This is a common problem. Web apps keep getting hit by the same problems, even with free frameworks &amp; libraries to mitigate them. He was probably just throwing stuff together, relying on Tor for security instead of just anonymity. They did some fuzz testing, owned the box, and then the box outed itself.</p>
<p>From there, it was just connecting dots. The FBI has way more experience with that part and appears to have done a good, thorough job.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230884">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230884">
						September 17, 2014 6:59 PM					</a>

				</p>

				<p><b>Draft proposal for preventing such deanonymizing attacks</b></p>
<p>Aside from web security, how can we prevent something like this? The simplest method is to have a dedicated, hardened device for Tor traffic. This device is the only one with an outside IP. It communicates to the other device either over internal IP addresses with a direct link. The device also does basic inspection looking for certain easily-identified leaks. Both the use and administration of the device occur over Tor, so as to look similar.</p>
<p>Note: This isn&#8217;t totally original as there are quite a few Tor proxy device projects. I&#8217;m talking one with <em>very</em> strong and professional effort in its security engineering. Also, defeating FBI might be easier than NSA, but FBI can always ask NSA for some collected info. And they might be able to get it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230885">

			<div class="comment by-tail-between-his-legs ">

				<p class="commentcredit">

					<span class="commenter">Tail Between His Legs</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230885">
						September 17, 2014 7:01 PM					</a>

				</p>

				<p>@ Tails Gurus:</p>
<p>Does this mean that Tails anonymity is compromised if you fill out a captcha whilst using Tails?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230886">

			<div class="comment by-the-robert-hanssen-integrity-award ">

				<p class="commentcredit">

					<span class="commenter">The Robert Hanssen Integrity Award</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230886">
						September 17, 2014 7:41 PM					</a>

				</p>

				<p>The big story is the quick response of system users who exposed FBI cyberattacks. Without that, FBI would have run the network and peddled the contraband to trap informants, provocateurs, and fake terrorists. Silk Road would have ended up like giganews</p>
<p><a href="http://cryptome.org/2014/09/giganews-fbi.htm" rel="nofollow ugc">http://cryptome.org/2014/09/giganews-fbi.htm</a></p>
<p>They don&#8217;t mind drugs, they don&#8217;t mind child sexual abuse. They just want to control the trade. They use it for kompromat like the NKVD did.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230887">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230887">
						September 17, 2014 7:57 PM					</a>

				</p>

				<p>@Nick P<br />
I think you should try to expand your proposal into more details. Here&#8217;s my try at making something practical out of a draft proposal. Do comment on the details. Just to give it a little more boost in security, we should consider adding a home made HSM in the brew as well. You could add some advise on hosting a home-made HSM that would operate in FIPS 140-2 Level 3 mode to protect the HSM keys.</p>
<p>1.)   Get an open source hardware like the Raspberry Pi (if you don&#8217;t want to build your own). Encase the Raspberry Pi in a clear plastic cover and glue all the ends tight. You need two pieces of Raspberry Pi. One act as the Tor server and the other as the HSM for your crypto keys.</p>
<p>2.)   Find an unwanted same vault and obtain some bricks, pottery and thermite. Lay 2 layers of bricks on the inside of the vault and the rest of the bricks as a pool for the vault to rest on and a thermite setup above the vault. Nick P, do elaborate more on the thermite setup since I am inexperienced in this part. You would need a few drilled holes in your vault to allow cable connection.</p>
<p>3.)   Load a Raspbian OS onto your Pis and put your Pis into the vault and connect it&#8217;s cables. Once it&#8217;s all setup, shut the vault and arm the thermite trap.</p>
<p>4.)   The Tor Pi will have an internal connection to the HSM Pi and all crypto keys (PGP/SSH/SSL keys) are handled by the HSM Pi and so are all crypto operations. The HSM Pi should be entered into FIPS 140-2 Level 3 mode where the keys should not leave the HSM and all crypto ops will be handed to HSM Pi to handle. The HSM Pi only allows a single port to be opened that will handle requests and will only recognize requests from the Tor Pi and the Tor Pi&#8217;s MAC Address.</p>
<p>5.)   The Tor Pi will also have a connection outside the physical vault which would pass through a router (multiple network port Pi ?). The router would have on cable going to the external network. The connection from the router into the vault can be protected by a firewall device (another Pi if you have on to spare) The rest of the internal connections are hooked to the router and maybe protected by a separate firewall device (yet another Pi).</p>
<p>6.) The Tor Pi will accept suitable SSH connections from registered devices and SSH authentication.</p>
<p>7.) When emergency appears, activate the thermite which would burn up both Pis in the vault at the same time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230889">

			<div class="comment by-chief-michael-airic-white-sr ">

				<p class="commentcredit">

					<span class="commenter">chief michael airic white sr</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230889">
						September 17, 2014 8:36 PM					</a>

				</p>

				<p>The question of whether the data came from the court case or whether indeed it was of parallel const is a good question. My reply is that there are always two sides and depending on the testimony allowed it would make a grave influence.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230891">

			<div class="comment by-amateur ">

				<p class="commentcredit">

					<span class="commenter">Amateur</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230891">
						September 17, 2014 9:24 PM					</a>

				</p>

				<p>Pi is known to have only one wired network interface. A model with two Ethernet ports would solve this handicap.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230892">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230892">
						September 17, 2014 9:40 PM					</a>

				</p>

				<p>@Amateur<br />
Yes Pi only has 1 ethernet port which you could add another on the chipboard itself with something like this (<a href="https://www.sparkfun.com/products/9473" rel="nofollow ugc">https://www.sparkfun.com/products/9473</a>). You essentially need to find a way to add a secondary ethernet port.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230893">

			<div class="comment by-chief-michael-airic-white-sr ">

				<p class="commentcredit">

					<span class="commenter">chief michael airic white sr</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230893">
						September 17, 2014 10:36 PM					</a>

				</p>

				<p>By using a single ethernet port the pi network fails as intended by the host. Remote connection u iploads a virus and no more computer i have seen. In essence a high dollar piece of hardware with pre installed software directly intended for one use and re-install on what appears to be a fresh connection. Man i have seen my software on the install cdrom disappear only after multiple instances reapper a month later. The registry is the key &#8211; without registry there is nada zip zilch</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230894">

			<div class="comment by-chief-michael-airic-white-sr ">

				<p class="commentcredit">

					<span class="commenter">chief michael airic white sr</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230894">
						September 17, 2014 10:41 PM					</a>

				</p>

				<p>I dont even access the net using my laprop but somehow im still wireless optimal. The days before computers both pc and not i miss. Those were the days of the tail</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230895">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230895">
						September 17, 2014 11:00 PM					</a>

				</p>

				<p>@chief michael airic white sr<br />
Optimally you do not want network connections but that is not going to happen because you are trying to run a Tor service and that means you need a network connection. Unless&#8230; if you meant using Nick P&#8217;s method of using the good old ways of Guards and serial cables for internal data routing and for external routing over a low security network you use Ethernet, that would be of higher assurance.</p>
<p>If you want to air gap over a trusted and highly assured environment, don&#8217;t publish a Tor service and don&#8217;t do anything obvious 🙂 .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230896">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230896">
						September 18, 2014 1:17 AM					</a>

				</p>

				<p>Thoth<br />
&#8211;You&#8217;ve got your priorities seriously screwed up if you want to protect a slightly hardened RasPi-based anonymous networking scheme w/ thermite&#8230;For starters, there&#8217;s better OS&#8217;s than Raspian for security too, I&#8217;d go w/ one of my faves, Kali over that.  Also may try Plan 9 for that bare-bones feel.  Think about what you&#8217;re getting yourself into if you go that route. A mistake and you&#8217;ve got a fried PC for no reason, a hole in your home, or worse which I won&#8217;t say. Are you physically protecting the system <b>24/7</b>?  If not, you assume entry into your residence while you&#8217;re at work has happened and they observe the protocol for destruction.  What&#8217;s the easy way around the thermite?  No EMC shielding?  Clear plastic case?  Ok, hole.  Carry the device[s] w/ you 24/7 if it must be protected like that.</p>
<p>You can integrate better solutions than a RasPi, I&#8217;ll make one eventually to illustrate.  How about OpenBSD on a Beaglebone instead?  Has ethernet too, faster.</p>
<p>Build it to prove me wrong or if you&#8217;re just doing it for fun/practice if you want, but there are vastly superior solutions like for starters, controlling the flow of data (diodes) and monitoring critical points (net-taps &amp; network analyzers).</p>
<p>Nick P won&#8217;t know much about thermite solutions, it&#8217;s Clive who&#8217;s said he actually made one, and RobertT who claims to have used nitric and hydrofluoric acid to destroy chips.  HF acid will f*ck you up, and likely create poisonous fumes.  Just don&#8217;t dive into this willy-nilly.</p>
<p><a href="https://www.schneier.com/blog/archives/2011/03/erasing_data_fr.html" rel="nofollow ugc">https://www.schneier.com/blog/archives/2011/03/erasing_data_fr.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230897">

			<div class="comment by-andrew_k ">

				<p class="commentcredit">

					<span class="commenter">Andrew_K</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230897">
						September 18, 2014 1:27 AM					</a>

				</p>

				<p>Regarding the thermite setup.</p>
<p>I wonder if there is an easier solution. Thermite may be safe &#8212; if and only if it ignites. If it does not, you pretty much look like a fool. Plus, you cannot (or do not want to) test the setup&#8217;s working. At least I would not ignite thermite for testing the setup in my flat since that stuff is hardly controllable once it has been ignited. When SWAT knocks for entry, I would change that reluctance.</p>
<p>If it&#8217;s about destroying harddisks, yes, there may not be that much other options to physically destroy the medium. But what about starting with an USB-Stick. It may provide some GBs storage (which, should suffice for critical data unless it&#8217;s video). Why can&#8217;t you destroy it with current? Blowing up transistors is fun and works by applying overrated current causing the die to overheat. Is there a possibility to do something similar to flash memory chips &#8212; electronically rendering them unrecoverable? Or is it easier mechanize dropping them into a blender?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230898">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">Nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230898">
						September 18, 2014 2:10 AM					</a>

				</p>

				<p>Not only is thermite remarkably hard to ignite&#8211;hardly something that you want to rely upon for emergency data destruction&#8211;but rigging it up like that is illegal on so many levels it&#8217;s not even funny anymore. We&#8217;re talking charges like booby trapping as well as arson. Committing multiple felonies in front of a police officer isn&#8217;t exactly the best way to defend yourself from criminal charges.</p>
<p>Besides, why go through all that effort when you could just keep a disk encryption key in RAM and zero the key the moment tamper sensors are tripped? You don&#8217;t have to destroy the disk, just the keys.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230899">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230899">
						September 18, 2014 3:23 AM					</a>

				</p>

				<p>@Figureitout<br />
If you have an open custom hardware is is ready for use and proven with better assurance than the Pi, by all means you may use it. Clear plastic is to simply provide protection from wear and tear instead of EMSEC reasons. It can be costly to buy a faraday&#8217;s cage setup unless you can make one. If you can get Kali onto the Pi, I would like to see such a custom high assurance OS if there&#8217;s one.</p>
<p>With all the comments that are not readily available and not commercially viable, how can any of those non high assurance (normal devs and non-techies) get their feets off the ground first ?</p>
<p>All those nice TEMPEST and EAL 10+ feature may not come so readily despite being good features and do not forget the monetary cost. Some substances like thermite and undiluted high concentrated acid may not be readily available (acid is considered controlled in my country).</p>
<p>Of course what I suggested is a base skeleton to build on from something abstract.</p>
<p>Don&#8217;t forget, if it cost more than it&#8217;s perceived benefits, you will only make it more insecure because few would want to use it. If a balanced and gradual approach that is materially pragmatic and also not very costly, it will allow more people to be willing to build these stuff and then attract them to go deeper into higher assurance experiments and deployments.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230900">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230900">
						September 18, 2014 3:37 AM					</a>

				</p>

				<p>@Nobody<br />
Zeroize keys would be a good idea when tamper are detected.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230901">

			<div class="comment by-amateur ">

				<p class="commentcredit">

					<span class="commenter">Amateur</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230901">
						September 18, 2014 6:26 AM					</a>

				</p>

				<p>Kali may be excellent as a pentest tool, but I don&#8217;t think it&#8217;s supposed to act as a Tor gateway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230902">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230902">
						September 18, 2014 7:19 AM					</a>

				</p>

				<p>Coincidentally if the vault used is a conductive metal, it would act as a Faraday&#8217;s cage which turns into a bonus EMSEC tool 😀 .</p>
<p>Another thing to consider is that my setup presumes you are hosting the devices at home (instead of in a server farm). You have electronics at home and concrete walls and basement. How are agents going to know where your device is kept in the house so that they can use their beaming devices to aim at your vault server unless they break into your house or simply get a warrant or execute a warrantless entry.</p>
<p>To have an effective zeroize of keys, you need a spare power pack inside the vault server just in case the main power supply goes down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230903">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230903">
						September 18, 2014 8:20 AM					</a>

				</p>

				<p><a href="https://www.nikcub.com/posts/analyzing-fbi-explanation-silk-road/" rel="nofollow ugc">&#8220;This theory does not stand up to scrutiny because the Silk Road image CAPTCHA was hosted on the same server and at the same hidden URL as the Silk Road website. It was not, contrary to some reports, a third-party CAPTCHA. The CAPTCHA image was produced by a script that sat alongside the login and authentication endpoints.&#8221;</a></p>
<p>It&#8217;s far more likely they used the CAPTCHA field to inject code into the site, to force a var_dump of the server&#8217;s $_SERVER PHP variable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230904">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230904">
						September 18, 2014 9:10 AM					</a>

				</p>

				<p>W/R to thermite etc,</p>
<p>Step one is to identify what you are protecting, how and most importantly why. If you don&#8217;t do this then you will set out on the wrong path and either end up &#8220;you know not where&#8221; and or &#8220;in a world of hurt&#8221;.</p>
<p>Step two is to critically examine the What, How and Why. Whilst it&#8217;s not possible to give any specific advice, you need to check more general advice holds in your specific case.</p>
<p>Step three is the good old KISS principle, complicated solutions fail in all sorts of ways you probably can not guess, and may unfortunately only find out &#8211;if at all&#8211; long past the point you are dead in the water.</p>
<p>Step four is to go around the loop again and again untill you are sure you cannot get the use of thermite etc out of the system.</p>
<p>Importantly thermite is a solution to primarily destroy hardware that may contain some secret information. It&#8217;s not to destroy the secret information, which is usually better protected in a number of other ways involving other information.</p>
<p>Thus you need to consider why you might need to destroy hardware and how you can take steps to avoid the need. I have used thermite to destroy custom hardware, and still use it where &#8220;memory burn in&#8221; may be a consideration. Virtually all other uses in ICT can be done other ways, or with a lot less thermal energy, and other problems legal and safety wise.</p>
<p>For instance you could encrypt the stored data, which if done correctly shifts the destruction to the encryption key which is much easier. The master key for an encrypted hard drive can be written with highly soluable non toxic vegtable inks on large stamp size pieces of rice paper, which you can eat, burn or drop in a cup of tea etc.</p>
<p>But with a little further thought you can remove this problem by having a PIN/Password/Passphrase written down instead and this can be used in a way from which the master key cannot be found, thus destroying the paper is not realy required.</p>
<p>Thus moving the encryption function from the computer and the hard drive and putting it in a small &#8211;single chip&#8211; Inline Media Encryptor (IME), significantly reduces the attack surface and what might need to be destroyed. Further how about using a SIM or Smart Card that&#8217;s got the appropriate crypto on it and is rated to a suitably high EAL rating&#8230;</p>
<p>If the IME is correctly designed and manufactured, simple anti-tamper and dead mens switches will ensure it does what you want without causing you any hard problems with destruction.</p>
<p>With a little thought you can come up with a solution whereby you never get to see the encryption key, and can provably show you never did nor needed to. We have discussed such solutions before on this blog when talking about the &#8220;Border Crossing&#8221; problem.</p>
<p>However there is still the issue of &#8220;residual plaintext&#8221; on the PC. To which the first thought &#8220;Why Windows&#8221; etc on the PC. Put simply all Windowing systems and their underlying OSs are all way to complex to ever be remotely considered secure, no ifs no buts no maybes. So ask &#8220;Why use them&#8221;, the simple answer in by far the majority of cases is you don&#8217;t. A simple single user 8bit computer with 32K of RAM and a serial interface or two was more than sufficient for a decade or so. You can get all of this and a lot lot more on a single chip costing around a dollar these days. Heck there are MicroChip PIC24s which beat the hardware for early minicomputers hands down &#8211;and apart from soft interupt issue&#8211; can run early versions of *nix and support four VT100 terminals, using flash cards instead of hard drives&#8230; So ask again &#8220;Why&#8221; complex OS&#8217;s, Windows systems and apps?</p>
<p>I urge everyone to rethink the Why, What, How and look seriously at the &#8220;How of times past&#8221; where needless complexity was not desirable.</p>
<p>Then consider the &#8220;How&#8221; of KeyMat, IMEs and simple methods of protecting the KeyMat in ways where rubber hose / thermorectal and other human inducments cannot work.</p>
<p>Only when you have done that and you are sure you have no other way should you start even remotely consider thermite or other hardware destroying systems. And by then you should be looking at only destroying a single chip or two at the most on a fairly small PCB&#8230;</p>
<p>It&#8217;s also worth noting that most modern military or diplomatic communications signals units don&#8217;t have to lug &#8220;destruction kits&#8221; around with them any more one reason for this is that crypto when used properly can obviate their use&#8230; those that do are generaly not for &#8220;comms&#8221; but specialised &#8220;intel&#8221;.</p>
<p>Oh one last thing, whilst thermite does not explode, the things you are trying to destroy might. Some batteries have the ability to liberate their own chemical energy in the form of rapidly expanding and oxidizing gases which if constrained in any way will make you think a hand grenade has gone off&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230905">

			<div class="comment by-anoni ">

				<p class="commentcredit">

					<span class="commenter">Anoni</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230905">
						September 18, 2014 11:50 AM					</a>

				</p>

				<p>You people are out of your freaking gourd.</p>
<p>There was this case I read about a while back where someone was suspected of possession of child porn.  Police raided his house, found him destroying (physically) a USB stick.  There was no evidence of CP in his home other than that destroyed USB drive, which may have had CP or pretty much anything else the fellow might have found embarrassing.  Court still found him guilty of CP possession and sent him off to jail.</p>
<p>Your talk of thermite is ridiculous.  Encrypt with a decent key and overwrite the key (dd /dev/random&#8230;) when necessary.</p>
<p>This whole thing is really off-topic.  Getting back to the point at hand, DPR had to have a server on the net.  Somewhere somebody [DPR] is paying for that.  When the NSA can watch all the pipes, and governments control so many of the TOR entry/exit nodes, figuring out where TOR traffic is going hardly seems impossible.  Hit silk-road often enough and try to figure out where that traffic is winding up.  It&#8217;s just a question of how badly they want you, and how much effort they&#8217;re willing to expend to catch you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230906">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230906">
						September 18, 2014 2:36 PM					</a>

				</p>

				<p>Using a static typing language for your backend would alleviate all these sql injection issues.</p>
<p>&#8230; but strict data types makes programming less exploratory or fun so that hasn&#8217;t gotten traction on the web. 🙁</p>
<p>DoD developed programs use strong typing. The rebels should learn from their opponents.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230907">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230907">
						September 18, 2014 6:35 PM					</a>

				</p>

				<p>@anon</p>
<p>SQL Injections are a problem that&#8217;s been solved on most platforms since PDO was inroduced in 2004 with PHP 5.0; for ADO on Windows and JDBC for Java, I&#8217;m not sure they have been a problem since their inception in the mid 1990s.</p>
<p>Programmers have the tools, they were just taught to dynamically build their own queries.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230908">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230908">
						September 18, 2014 7:00 PM					</a>

				</p>

				<p>re thermite &amp; data destruction</p>
<p>It is big and offtopic so I suggest we move it to the Squid thread so readers here can focus on Tor &amp; DPR. I&#8217;ve replied <a href="https://www.schneier.com/blog/archives/2014/09/friday_squid_bl_441.html#c6678905" rel="nofollow ugc">here</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230910">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230910">
						September 18, 2014 8:53 PM					</a>

				</p>

				<p>@ Thoth</p>
<p><b>How to secure services like Tor against FBI/NSA</b></p>
<p>The topic of Tor security is special: the opponents are typically TLA&#8217;s. Silk Road was taken down by a very capable TLA with hackers, 0-days, and legally-empowered investigators. They are partnered with the most powerful TLA (NSA) in the world of SIGINT collection, with ability to ask for their help &amp; parallel construct that away. They also have legal partnerships with others around the world. So, this is a situation where even remote attacks demand a high assurance solution. If it&#8217;s medium, it needs to focus assurance activities on everything we know they hit. And you better be covered legally, but I&#8217;ll focus on technical side for now.</p>
<p>The best way to start on requirements is look at it logically. Without knowing much about Tor&#8217;s insides, I&#8217;m guessing the logical system involves these components: hardware, main firmware, peripheral firmware, OS kernel, networking stack, storage, network time, Tor protocol activities, networked apps people connect to/with, configuration management tools, and administrative tools. A number of these are security-critical, being in the TCB and designated &#8220;trusted.&#8221; The TCB of the Tor engine must be initialized into a trusted state at boot, protected from attacks during running, and be sanitized upon shutdown.</p>
<p>So, what are the threat vectors? Most of the stuff I just mentioned&#8230; The FBI definitely can find 0-days in OS kernel, drivers, main firmware, or apps. The skill is the same for each of these, so if we haven&#8217;t seen it they just haven&#8217;t displayed it yet. The NSA adds attacks on peripheral firmware, protocols, covert channels, side channels, and hardware subversion (esp by interdiction). To stop FBI, one must ensure they can&#8217;t hit any layer from I/O up to protocol engine. To stop NSA, one must protect even more. This is&#8230; challenging*. 😉</p>
<ul>
<li>&#8220;Challenging&#8221; is synonmous with &#8220;You&#8217;re f***ed&#8221; in this usage.</li>
</ul>
<p>The simplest strategy for both is physical decomposition. Like my PCI backplane and Artigo designs years ago, the logical &#8220;system&#8221; is actually a bunch of different computers communicating over various links. You can break the system into untrusted and trusted systems communicating over non-DMA links. Can&#8217;t trust U.S. companies&#8217; IOMMU&#8217;s because we can&#8217;t trust U.S. companies. (Simple, eh?) The hardware is ideally pre-2004 that wasn&#8217;t shipped or was couriered by someone who is incredibly trustworthy (yourself even). It must never get into enemy hands. Ever. For those inclined, one can make a custom SOC or board that basically acts as both a switch with IO/MMU and guard for traffic mgmt rules. Will be faster, almost plug n play, simpler, require less hardware, and <em>cost a lot of money</em> to develop. Tradeoffs, tradeoffs&#8230; 😉</p>
<p>The simplest decomposition has three nodes: internal transport, tor node, external transport. The transport gateways apply basic security filtering while also converting the packets to easily parsed format sent over non-DMA lines. As such communications are handled by CPU directly, it&#8217;s advisable to make a scheduling policy whereby I/O is only done so often. That keeps number of interrupts and cache misses to a minimum. A deprivilged subject does the I/O where possible, moving it to/from a specific and protected storage area. One or more separate subjects with their own protected, internal memory does the security-critical operations.</p>
<p>At this point, we have to secure the main points of attack. Let&#8217;s start simple. The middle system is <em>only</em> running a pre-configured Tor server modified to use our safer I/O interfaces rather than networking. It also needs a process or processes to handle that I/O. The configuration, executables, etc are all created on another machine and simply moved to this one. There&#8217;s no remote administration in this model: it&#8217;s done locally via the hard disk itself or a dedicated port with authentication. This system <em>just</em> runs Tor and only needs the kernel functions that it depends on.</p>
<p>The easiest setup starts with a monolithic OS. You can use OpenBSD or a Linux with extra protections. Configure the Tor service with maximum isolation using any technique you have. Make sure the firewall filters out anything that isn&#8217;t Tor (optionally doing other checks). Like in Poly2 project, remove every piece of code in the system that&#8217;s not critical to its functioning. Don&#8217;t just disable it: go into it, delete the code in the functions, and tell it to return success (or failure). This is easier than outright deleting modules because it requires less work and understanding of the system. For stuff the system does use, ensure security checks are in there &amp; optionally use the special compilers that automatically add safety. Use things like SVA-OS or system call mediation to give kernel a bit of extra protection.</p>
<p>Your attack surface is already very low. The I/O is simple enough to write nearly bug-free implementations. They will be forced to focus on the application and few kernel calls it uses. The application logic should be made in a functional way with an internal state of the entire thing, incoming data causing a change in state, and optionally causing a response. Each state should be analyzed for the effect of common errors and attacks. Error states should recover or fail safely with logging. The system should be written in a safe language or safe subset of a language with input validation, static analysis, dynamic analysis, extensive testing of every state/feature, and fuzz testing running overnight regularly on instrumented code. Techniques such as control flow integrity or safety-critical memory management can be used to reduce likelihood of attacks. The compiler and linker must be verified to not screw anything up, like optimizing away security checks.</p>
<p>That&#8217;s one application on a hardened platform. The next step is breaking it into pieces that each do a job and communicate. A microkernel platform open to inspection should be used such as OC.L4, OKL4, Genode, seL4, Minix3, etc. Each logical component, inside or outside of Tor, is put into its own address space. The system is modified using distributed programming techniques to safely coordinate the overall system activity over message passing. Each TCB component is then designed, coded, and tested just as described above. The interaction of components can be modelled in a specification or programming language with concurrency checkers to find such errors, although there are distributed transactional approachs if I recall.</p>
<p>At this point, each part of the TCB is quite hardened. If cash flow continued, higher assurance techniques can be applied. Among the most important would be a covert channel analysis of the system. There&#8217;s tools to model and track information flows to make it easier. The next step would be an inherently safer architecture*. Typed (Sandia SSP), tagged (crash-safe.org), or capability (Cambridge CHERI) processors can be employed to contain or prevent code injection attacks. Dedicated I/O processing chips with DMA to Tor memory might be added for performance, extra security, or avoid using the same TCB setup for app logic &amp; I/O. Formal verification might be used on any aspect of the system. Tools might be expanded for automatically adding security protections to safer source code, then certifying compilation &amp; linking at object code level.</p>
<ul>
<li>The architecture might actually be one of the first things you do. When I did stuff, there were none around. Now, there&#8217;s over a dozen in various stages of maturity, licensing, and ASIC cost. It could be the very first thing the project does. </li>
</ul>
<p>People might want remote administration. One of my old approaches applies here: use a production system and a management system. There&#8217;s a safe link between the two. The production system can be ROM&#8217;d to do self-checks, then automatically boot from management system&#8217;s storage. Combined with a object store or RAM disk, this design choice means Tor node doesn&#8217;t even need a filesystem layer. :O All the tools needed for diagnosing, generating, or otherwise managing the Tor node are on the management computer. Like with Tor, a dedicated application (eg SSH) runs on the Tor node that basically acts as a middleman between external network &amp; management node, shuffling the data. The service is off &amp; I/O blocked by default. A guard application listening on a certain port checks incoming data for an authenticated command to activate administration. It then leverages trusted code for initiating a session&#8230; from the Tor node <em>to</em> a designated external node. One can use SSH or just PGP-style encrypted commands sent back and forth asynchronously. I did the latter with pre-shared master secret for simplicity, speed, and immunity to quantum advances.</p>
<p>Finally, for your personal satisfaction, you put all this stuff in an EMSEC safe with obfuscated tamper circuits that can activate thermite. The circuits should detect RF attacks, extreme heat/cold, radiation spikes, and strong vibration. A HEPA filter on incoming air can prevent troubles nobody has published yet. (Don&#8217;t ask.) The circuits should send data to radiation-hardened microcontrollers that have battery backup. Need at least three in lockstep with voting protocols. Redundancy and diversity in detection circuits helps. All this stuff costs so much already (esp EMSEC) that you might as well spend a bit more to prevent your tamper circuitry from nuking it accidentally. Let them run in the production environment under your supervision in a learning mode to adjust to the common operating ranges of the environment. Then, they are put into production mode and can&#8217;t be disabled without a secure, secret method. You need to personally courier it to destination and set it up. See how costs can add up for tamper resistant remote solutions?</p>
<p>Of course, they are a coalition with legal authority and covert ops. You <em>cannot</em> control the box if you&#8217;re in a Five Eyes country and there&#8217;s risk in a foreign one. Whoever is managing it can&#8217;t be a citizen of one of these countries as they can be extradited. Their citizenship, location and travels must keep them away from those countries complicit in Five Eye&#8217;s covert activity. You also need crime to be low with a decent standard of living to make bribes cost more. Switzerland has best track record in most of these traits, with Iceland having some strong attributes. In short, if Five Eyes courts or spooks can target you easily, then you are screwed no matter what tech you use.</p>
<p>So, there you people have it: a combo of NSA-resistant INFOSEC 101 &amp; Tor Secure Development Guide. This should be a start. (Hears someone in the audience say, &#8220;A&#8230; start&#8230;?&#8221;) Yeah, a start. I don&#8217;t list all potential attacks. The opponents are highly likely to fail, though, using most methods they will try. They might even give themselves away while telling you exactly where the flaws are if you&#8217;re logging crash data. Now start building! 🙂</p>
<p>Note: My earliest post on this stuff was on Freenet <a href="https://www.schneier.com/blog/archives/2011/03/identifying_tor.html#c524552" rel="nofollow ugc">here</a>. It begins an argument for high assurance techniques with covert channel mitigation, along with base deign.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230911">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230911">
						September 19, 2014 1:01 AM					</a>

				</p>

				<p>@ Anura</p>
<p>Yes, programmers have the tools but most programmers don&#8217;t make use of those available options to harden their systems.</p>
<p>Using a safe, statically typed language for web development would force programmers to build applications that are immune to these attacks; without relying on developers to use appropriate precautions.</p>
<p>I&#8217;m suggesting a secure by default approach. PHP doesn&#8217;t give us that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-230912">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230912">
						September 19, 2014 11:31 AM					</a>

				</p>

				<p>@ anon</p>
<p>I addressed web application security innovation <a href="https://www.schneier.com/blog/archives/2014/04/the_security_of_8.html#c5626550" rel="nofollow ugc">here</a>. Use it, build on it, tell your programmer friends. It&#8217;s not really the concepts or technology that&#8217;s lacking: people just keep building on insecure foundations instead of improving on what&#8217;s already proven to work. Same problem throughout IT industry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-230913">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/#comment-230913">
						September 19, 2014 11:32 AM					</a>

				</p>

				<p>EDIT:</p>
<p>Link <a href="https://www.schneier.com/blog/archives/2014/04/the_security_of_8.html#c5626550" rel="nofollow ugc">here</a>.</p>
<p>The one time I don&#8217;t use preview today crap happens&#8230; haha</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/09/identifying_dre.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/09/identifying_dre.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F09%2Fidentifying_dre.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/09/identifying_dre.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5955' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/09/tracking_people_3.html" rel="prev">← Tracking People From their Cell Phones with an SS7 Vulnerability</a>		<a href="https://www.schneier.com/blog/archives/2014/09/the_full_story_.html" rel="next">The Full Story of Yahoo&#039;s Fight Against PRISM →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
