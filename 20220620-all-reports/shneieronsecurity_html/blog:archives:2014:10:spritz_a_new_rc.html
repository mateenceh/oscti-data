<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Spritz: A New RC4-Like Stream Cipher - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Spritz: A New RC4-Like Stream Cipher Comments Feed" href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/6380" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=6380' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F10%2Fspritz_a_new_rc.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F10%2Fspritz_a_new_rc.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-6380 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-6380" class="post-6380 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-cryptanalysis tag-cryptography tag-encryption tag-rc4">

	<div class="article">

		<h2 class="entry">Spritz: A New RC4-Like Stream Cipher</h2>
		<p>Last week, Ron Rivest gave a talk at MIT about <a href="http://people.csail.mit.edu/rivest/pubs/RS14.pdf">Spritz</a>, a new stream cipher by him and Jacob Schuldt. It&#8217;s basically a redesign of <a href="https://en.wikipedia.org/wiki/RC4">RC4</a>, given current cryptographic tools and knowledge.</p>
<p>RC4 is an example of what I think of as a too-good-to-be-true cipher. It looks so simple. It <i>is</i> so simple. In classic cryptographic terms, it&#8217;s a single rotor machine. It&#8217;s a single self-modifying rotor, but it modifies itself very slowly. Even so, it&#8217;s very hard to cryptanalyze. Even though the single rotor leaks information about its internal state with every output byte, its self-modifying structure always seems to stay ahead of analysis. But RC4 been around for over 25 years, and the <a href="https://en.wikipedia.org/wiki/RC4#Security">best attacks</a> are at the edge of practicality. When I talk about what sorts of <a href="http://threatpost.com/the-nsa-is-not-made-of-magic/104499">secret cryptographic advances</a> the NSA might have, a practical RC4 attack is one of the possibilities.</p>
<p>Spritz is Rivest and Schuldt&#8217;s redesign of RC4. It retains all of the problems that RC4 had. It&#8217;s built on a 256-element array of bytes, making it less than ideal for modern 32-bit and 64-bit CPUs. It&#8217;s not very fast. (It&#8217;s 50% slower than RC4, which was already much slower than algorithms like AES and Threefish.) It has a long key setup. But it&#8217;s a very clever design.</p>
<p>Here are the cores of RC4 and Spritz:</p>
<blockquote><p>RC4:</p>
<blockquote><p><tt>1: i = i + 1<br />
2: j = j + S[i]<br />
3: SWAP(S[i];S[j])<br />
4: z = S[S[i] + S[j]]<br />
5: Return z</tt></p></blockquote>
<p>Spritz:</p>
<blockquote><p><tt>1: i = i + w<br />
2: j = k + S[j + S[i]]<br />
2a: k = i + k + S[j]<br />
3: SWAP(S[i];S[j])<br />
4: z = S[j + S[i + S[z + k]]]<br />
5: Return z</tt></p></blockquote>
</blockquote>
<p>S is an 8-bit permutation. In theory, it can be any size, which is nice for analysis, but in practice, it&#8217;s a 256-element array. RC4 has two pointers into the array: i and j. Spritz adds a third: k. The parameter w is basically a constant. It&#8217;s always 1 in RC4, but can be any odd number in Spritz (odd because that means it&#8217;s always relatively prime to 256). In both ciphers, i slowly walks around the array, and j &#8212; or j and k &#8212; bounce around wildly. Both have a single swap of two elements of the array. And both produce an output byte, z, a function of all the other parameters. In Spritz, the previous z is part of the calculation of the current z.</p>
<p>That&#8217;s the core. There are also functions for turning the key into the initial array permutation, using this as a stream cipher, using it as a hash function, and so on. It&#8217;s basically a <a href="https://en.wikipedia.org/wiki/Sponge_function">sponge function</a>, so it has a lot of applications.</p>
<p>What&#8217;s really interesting here is the way Rivest and Schuldt chose their various functions. They basically tried them all (given some constraints), and chose the ones with the best security properties. This is the sort of thing that can only be done with massive computing power.</p>
<p>I have always really liked RC4, and am happy to see a 21st-century redesign. I don&#8217;t know what kind of use it&#8217;ll get with its 8-bit word size, but surely there&#8217;s a niche for it somewhere.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/rc4/" rel="tag">RC4</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html" rel="bookmark">Posted on October 27, 2014 at 9:55 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html#comments">38 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html" data-title="Spritz: A New RC4-Like Stream Cipher" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-233605">

			<div class="comment by-rgp-security ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://rgpsecurity.wordpress.com/' rel='external nofollow ugc' class='url'>RGP Security</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233605">
						October 27, 2014 10:48 AM					</a>

				</p>

				<p>Very interesting!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233606">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233606">
						October 27, 2014 12:00 PM					</a>

				</p>

				<p>Great to see some crypto here again finally. Where&#8217;s your new cipher Bruce?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233607">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233607">
						October 27, 2014 12:47 PM					</a>

				</p>

				<p>@Bruce: <i>I don&#8217;t know what kind of use it&#8217;ll get with its 8-bit word size, but surely there&#8217;s a niche for it somewhere.</i></p>
<p>Considering the vast array of places where RC4 is being used right now, I wouldn&#8217;t characterize RC4 as a &#8220;niche&#8221; cipher. Spritz is a drop-in replacement for all of those.</p>
<p>As just one example, RC4 and Spritz are very easy to implement in JavaScript. This means that encryption or decryption code can be embedded in web pages and run in the user&#8217;s browser, gaining end-to-end encryption of sensitive data without relying on SSL/TLS and its many bugs. Try doing that with AES. It can be done, but oh the pain.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-233608">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233608">
						October 27, 2014 1:25 PM					</a>

				</p>

				<p>&#8220;Considering the vast array of places where RC4 is being used right now, I wouldn&#8217;t characterize RC4 as a &#8216;niche&#8217; cipher. Spritz is a drop-in replacement for all of those.&#8221;</p>
<p>That&#8217;s a good point. RC4 is pretty much the only stream cipher in general use, and this is an easy drop-in replacement in all those cases.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233609">

			<div class="comment by-parrot ">

				<p class="commentcredit">

					<span class="commenter">parrot</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233609">
						October 27, 2014 1:36 PM					</a>

				</p>

				<p>@Alan Kaminsky</p>
<p>At the risk of derailing the topic from Spritz&#8230;</p>
<p>Isn&#8217;t the notion of re-downloading your cryptographic implementation each time you visit a site fundamentally broken in terms of satisfying end-to-end encryption needs? I mean, if the threat model is that someone compromised the server, and you don&#8217;t want your data being compromised as well, wouldn&#8217;t the attacker also be able to just change the Javascript served to you to be the null cipher?</p>
<p>In other words, if you don&#8217;t trust the security of the server, don&#8217;t trust the code the server gives to you.</p>
<p>Maybe this makes sense for browser plugins or Greasemonkey-like scripts? I don&#8217;t know.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233610">

			<div class="comment by-a-nonny-bunny ">

				<p class="commentcredit">

					<span class="commenter">A Nonny Bunny</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233610">
						October 27, 2014 1:55 PM					</a>

				</p>

				<p>@parrot</p>
<p>Isn&#8217;t the threat model mostly passive eavesdropping? There&#8217;s certainly a risk a man-in-the-middle could change the javascript code you receive, but it&#8217;s not the most common one. And on the plus side, the algorithm is simple enough to check.</p>
<p>Aside from that, there&#8217;s also the Mega use-case, where the server simply wants to be agnostic about the crap you&#8217;re uploading.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233611">

			<div class="comment by-parrot ">

				<p class="commentcredit">

					<span class="commenter">parrot</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233611">
						October 27, 2014 2:23 PM					</a>

				</p>

				<p>@A Nonny Bunny</p>
<p>Hey, thanks for the reply.</p>
<blockquote><p>Isn&#8217;t the threat model mostly passive eavesdropping?</p></blockquote>
<p>No, that should be covered with TLS.</p>
<blockquote><p>Aside from that, there&#8217;s also the Mega use-case, where the server simply wants to be agnostic about the crap you&#8217;re uploading.</p></blockquote>
<p>I think <i>this</i> is the threat model @Alan Kaminsky was suggesting (though he could prove me wrong). I presume being agnostic means that if a government implicates or extorts the service for holding illegal data, they can wash their hands of the issue because they don&#8217;t have the keys.</p>
<p>What I&#8217;m suggesting is, for example, the FBI sends the service a National Security Letter to that service saying &#8220;Hey, change the Javascript implementation to this weaker one.&#8221;</p>
<blockquote><p> And on the plus side, the algorithm is simple enough to check.</p></blockquote>
<p>How would a browser check that? With integrity checking code also provided by the server as Javascript? Then the NSL would just have &#8220;&#8230;and change the checking code, too.&#8221;</p>
<p>Or are you suggesting a manual check of the algorithm? But, that would have to happen every time you pulled new code from the server. And since Javascript is more or less dynamic, who&#8217;s to say that the semantics of the algorithm can&#8217;t be changed without changing the core encryption functions?</p>
<p>I think end-to-end requires more integration into the browser or other external tools.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233612">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233612">
						October 27, 2014 3:25 PM					</a>

				</p>

				<p>I was hoping that this would be the year that admins started switching en mass from RC4 to the Snuffle family for their stream cipher needs. It&#8217;s now been 9 years since the eStream contest so they have almost a decade of crypto-analysis behind them. djb is also trusted and respected in the community for his critical and innovative work in elliptic curves, implementation vulnerabilities and the fact that he&#8217;s an academic (as opposed to being a government or commercially employed cryptographer). Ron even suggested Salsa20 during his &#8220;Growth of Crypto&#8221; talk at Princeton&#8217;s Alan Turing centennial.</p>
<p>I hope Spritz doesn&#8217;t derail that migration.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233613">

			<div class="comment by-ryan ">

				<p class="commentcredit">

					<span class="commenter">Ryan</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233613">
						October 27, 2014 3:36 PM					</a>

				</p>

				<p><a href="http://burtleburtle.net/bob/rand/isaac.html" rel="nofollow ugc">http://burtleburtle.net/bob/rand/isaac.html</a></p>
<p>Isaac is a good stream cipher and has withstood a decade of casual cryptanalysis.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233614">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233614">
						October 27, 2014 4:45 PM					</a>

				</p>

				<p>@anon</p>
<p>Until it is easily broken in the field by someone with reasonable resources (e.g. a botnet), there won&#8217;t be an en masse move because so much is implemented in embedded systems which are notoriously slow to update. On top of that, major businesses like banks are reluctant to upgrade. You&#8217;ll find most banks still use 3DES for encryption, because it was a lot easier to migrate to it from DES. I wouldn&#8217;t be the least bit surprised if 3DES was used more than AES these days.</p>
<p>Upgrading to something that&#8217;s a drop in replacement, such as Spritz is going to go a lot faster. For new development use AES, where we probably won&#8217;t see practical attacks for at least a couple of decades if at all, but for those legacy systems they are going to go with a drop-in replacement.</p>
<p>All that said, I&#8217;d love to see a drop in replacement FOR AES. Something with a bit stronger key-schedule and more rounds. If you can fix some of the weaknesses in the key schedule, it&#8217;s possible that you don&#8217;t need too many more rounds for it to be secure.</p>
<p>Personally, I would go with 16 rounds for the 128-bit key, 20 for the 192-bit key, and 24 for the 256-bit key. I would personally go for a completely different, and much slower key-schedule, just to provide a larger security margin:</p>
<p>1) Initialize a 32-bit value z to a constant k, initalize a counter i = 0<br />
2) Run each byte of z, XORd to a i through an s-BOX and MDS Matrix<br />
3) For each four-byte chunk of the key, add the key chunk to z modulo 2^32 and then repeat step 2 for each chunk of key<br />
4) Set subkey<sub>i</sub> = z<br />
5) Set z = z xor k, increment i by 1. Goto step 2</p>
<p>Much slower, but much less likely to have attacks against it, while still being extremely simple.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233615">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233615">
						October 27, 2014 4:46 PM					</a>

				</p>

				<p>I think it&#8217;s probably wise to remember that almost all computers in the world are 8-bit. The primary reasons assemblages of circuit boards will remain single security domains are lack of interest in securing them and lack of ability to secure them. The former is rapidly changing as embedded designers realize anything programmable is a vulnerability in a design. The latter is just reality when the center of the design is a 50 cent microcontroller with 2KB flash and 63 bytes RAM. Yes it can fit TEA or XTEA; no it can not fit any known authentication algorithm.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233616">

			<div class="comment by-guy-shaw ">

				<p class="commentcredit">

					<span class="commenter">Guy Shaw</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233616">
						October 27, 2014 4:56 PM					</a>

				</p>

				<p>RC4 does not have to implemented using an array of 8-bit bytes.<br />
It is allowed to use more memory, and store a 256 entry array<br />
of 32-bit words.  There are implementations that do that,<br />
because it improves performance, dramatically.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233617">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233617">
						October 27, 2014 6:22 PM					</a>

				</p>

				<p>@ Bruce</p>
<p>I was reluctant to let the RC4 cipher go for lower assurance applications. It was indeed simple &amp; performed well on weak hardware. Yet, it&#8217;s time for it to be retired into history.  If anything, encryption in practice was often buying the user time against the adversary. RC4 bought enough time for AES, eSTREAM, <em>and</em> SHA-3 ciphers to come out. A number also got close to a decade of cryptanalysis. It was also widely deployed.</p>
<p>So, Rivest et al can still feel proud of RC4&#8217;s contribution.</p>
<p>@ anon</p>
<p>Yeah, I&#8217;ve been recommending Salsa20. We already have a good stream cipher that&#8217;s fast and has an implementation (NaCl) resistant to timing channels. No need for RC4++.</p>
<p>@ Brian</p>
<p>The potential solution is an uptake in the eSTREAM ciphers designed for hardware. <a href="http://www.ecrypt.eu.org/stream/docs/hardware.pdf" rel="nofollow ugc">Grain</a> has especially low gate count and power usage even at 128 bits with 900Mbps+.</p>
<p>@ Ryan</p>
<p>ISAAC is the shit. I&#8217;ve used it for a long time in various ways. I&#8217;d like to see more cryptanalysis of it just because it&#8217;s worked so well for so long.</p>
<p>@ Anura</p>
<p>You&#8217;re definitely right on the 3DES for banks. I encountered this studying IBM&#8217;s FIPS Level 4 crypto processor. It&#8217;s main library, along with all similar chips, were advertising 3DES for almost everything security-critical. Even a number of government COMSEC devices did that. I was thinking &#8220;What the hell people?&#8221; Compatibility with existing certified software and hardware implementations of DES seemed to be best explanation.</p>
<p>RC4 transition might be easier, though, because AES is in so many things. The NIST standardization at least had that value for us.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233618">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233618">
						October 27, 2014 10:48 PM					</a>

				</p>

				<p>@Nick P &amp; all<br />
I would agree that Salsa20 family by djb is a really good cipher and more RC4++ or whatever it is would make no difference to the reality of security.</p>
<p>Yet another cipher does not solve the real world problem of more ciphers and protocols but no agents to convey it&#8217;s security performance and perimeters.</p>
<p>One more to note&#8230; patents, trademarks, copyrights might turn out to be an issue with the new Spritz cipher. We know that RC4 and RC6 have trademark, copyrights and trademark issues&#8230; so will we see Spritz with same issues too ?</p>
<p>If I were to choose a few stream ciphers fro eSTREAM, they do be Salsa family (primary) and HC family (secondary). HC would be chosen due to the huge internal states and so far there is no solid cryptanalysis breaking it yet and it has been known to be &#8220;built like a tank&#8221; with huge conservative boundaries.</p>
<p>CTR mode as a stand-in stream cipher would always be a good option as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233619">

			<div class="comment by-perl-crusher ">

				<p class="commentcredit">

					<span class="commenter">Perl Crusher</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233619">
						October 27, 2014 11:06 PM					</a>

				</p>

				<p>@Brian</p>
<p>How much then is the 8KB flash 1KB ram upgrade? $0.52?  Though it seems in a large number of cases the $0.02 can be spent on flash write-enable pads/washer/jtrig/spi/etc to address the programmable vulnerability</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233620">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233620">
						October 28, 2014 1:01 AM					</a>

				</p>

				<p>@Nick P<br />
The security industry is more concerned with userbase issues like backwards compatibility and ease of use (including key recovery) than compared to high assurance. We need to thank the powers that be for their efforts of pushing such concepts into the civilian security industry which propagates very successfully into almost every other sector.</p>
<p>Hardware based link encryptors have CC EAL 3+ (no kidding) and are sold as high assurance link encryptors to commercial and government agencies. What a joke &#8230;</p>
<p>HSM &#8230; CC EAL 4+ (SafeNet and Thales). If HSMs are simply CC EAL 4+ and lower then how is it different from Linux/MS/Mac which are also CC EAL 4+ and lower except they have FIPS 140-2 certification.</p>
<p>Security industry in a general sense is like a rotting apple. Lots of smokes and mirrors and no lack of security theater just for the good $$$ cash $$$ rush.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233621">

			<div class="comment by-bill-p-godfrey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://billpg.com/' rel='external nofollow ugc' class='url'>Bill P. Godfrey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233621">
						October 28, 2014 4:39 AM					</a>

				</p>

				<p>AES can be used as a stream cipher with a trivial amount of XOR-ing. What&#8217;s the benefit of something designed as a stream cipher over using AES this way?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233622">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233622">
						October 28, 2014 5:52 AM					</a>

				</p>

				<p>There is one lesson we should learn, but for some reason we don&#8217;t despite all that history teaches us, and that is,</p>
<p><b>Security Should Not Be Baked In</b></p>
<p>Whilst in theory encryption systems could be perfect, history tells us that offten they algorithms are not and worse the implementations are any thing but secure.</p>
<p>Thus we have to upgrade the implementation or algorithm on a fairly regular basis.</p>
<p>Thus our designs should alow for such upgrades as a matter of normal operation, not as being so exceptional we have to throw entire systems into landfill.</p>
<p>With the advent of implanted medical electronics, smart meters and the Internet of Things, we realy should mandate via legislation or standards or both that security elements for such things be upgradable in a non invasive but secure way.</p>
<p>It&#8217;s something I&#8217;ve suggested before that the likes of NIST should be doing in prefrence to having algorithm contests.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233623">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">Jon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233623">
						October 28, 2014 9:34 AM					</a>

				</p>

				<p>I beg the pardon of those who know, but I don&#8217;t understand the point of the SWAP instruction in RC4.</p>
<p>Addition is commutative: a+b = b+a, therefore exchanging the two elements in the array seems entirely pointless given that the next thing you do is add them together.</p>
<p>Have I misunderstood something?</p>
<p>Thanks, J.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233624">

			<div class="comment by-shevek ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://quitter.se/shevek' rel='external nofollow ugc' class='url'>Shevek</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233624">
						October 28, 2014 11:23 AM					</a>

				</p>

				<p>RC4 is paper&amp;pencil-able with a reduced alphabet, for example the English alphabet,:</p>
<p>1) take 26 symbols of English alphabet and write down each symbol on small pieces of wood or paper;<br />
2) make a key-driven permutation S, and order the pieces accordingly;<br />
3) under the pieces, write down the alphabet normal sequence, one symbol under one piece<br />
4) use two pebbles that roles {i, j} indexes<br />
5) run the algorithm, moving the pebbles on the pieces and on the sequence, and interchanging the pieces whenever necessary</p>
<p>Of course, you must be aware about addition mod 26.</p>
<p>Spritz is harder paper&amp;pencil-able 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233625">

			<div class="comment by-jeremy ">

				<p class="commentcredit">

					<span class="commenter">Jeremy</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233625">
						October 28, 2014 12:51 PM					</a>

				</p>

				<p>@Jon<br />
That algorithm is run in a loop; the swap operation in RC4 doesn&#8217;t affect the current output, but it affects future outputs.</p>
<p>@Guy Shaw<br />
An array containing 256 entries of 32-bit words is going to reduce the entropy of your output by about a factor of 4, because there are only 2^8 possible 32-bit patterns you can output.  To do 32-bit outputs &#8220;right&#8221; you&#8217;d need a permutation array containing 2^32 entries, which means you&#8217;re now using gigabytes of memory (as opposed to less than a kilobyte in the 8-bit version).</p>
<p>A 16-bit permutation array might be reasonable in some settings (128 KB, if my math is correct).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233626">

			<div class="comment by-atk ">

				<p class="commentcredit">

					<span class="commenter">atk</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233626">
						October 28, 2014 1:04 PM					</a>

				</p>

				<p>@clive robinson,</p>
<p>while this is probably semantic nitpicking, I am concerned that a less erudite reader could easily be confused by your usage of &#8216;baked in&#8217;  as conpared to the common usage.</p>
<p>I beg to differ with the proposition that &#8216;security should not be baked in.&#8217;   In common usage,  the comparison is &#8216;baked in&#8217;  vs &#8216;bolted on&#8217;.  In this usage,  baking security in means designing and implementing the system with the intent that it be secure in the first place.  Bolting security on,  on the other hand,  is modifying the application after the fact to be able to hamdle a security need that it otherwise is completely incapable of handling.  For example,  adding crypto where there is no crypto,  or adding the OWASP CSRFGuard in full-auto mode,  or usong a Web application firewall .  in each of these cases,  the app is broken,  and the security functionality is poorly integrated into the app.</p>
<p>I would contend that better phrasing would be &#8216;crypto agility&#8217;  if you loke a popular phrase,  or &#8216;configurable and replaceable crypto&#8217;  if you don&#8217;t.  This is complementary to baking security in,  in that well architected software is genetally highly modular and often highly configurable.  Being highly modular allows for the upgrading of the crypto module of whoch your post describes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233627">

			<div class="comment by-mrc ">

				<p class="commentcredit">

					<span class="commenter">MrC</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233627">
						October 28, 2014 1:13 PM					</a>

				</p>

				<p>@ Jon: It makes S[] different for the next iteration.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233628">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">Jon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233628">
						October 28, 2014 1:38 PM					</a>

				</p>

				<p>Thanks, @Jeremy &amp; @MrC.  Makes more sense that way.  J.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233629">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233629">
						October 28, 2014 2:17 PM					</a>

				</p>

				<p>@Thoth <i>One more to note&#8230; patents, trademarks, copyrights might turn out to be an issue with the new Spritz cipher. We know that RC4 and RC6 have trademark, copyrights and trademark issues&#8230; so will we see Spritz with same issues too ?</i></p>
<p>The Spritz paper that Bruce linked says this on page 25:</p>
<p>&#8220;We do not know of any patent or other restrictions on the use of the ideas proposed here. We have not filed for any such patents (and will not). The authors place into the public domain any and all rights they have on the use of the ideas, methods or systems proposed here. As far as we are concerned, others may freely make, use, sell, offer for sale, import, embed, modify, or improve the ideas, methods, or systems described in this note. There is no need to contact us or ask our permission in order to do so. We ask only that this paper be cited as appropriate.&#8221;</p>
<p>Maybe some patent troll will come out of the woodwork and claim intellectual property rights, but Rivest and Schuldt won&#8217;t.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233630">

			<div class="comment by-mrc ">

				<p class="commentcredit">

					<span class="commenter">MrC</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233630">
						October 28, 2014 3:54 PM					</a>

				</p>

				<p>@Jeremy:</p>
<p>Guy&#8217;s post confused me for a good bit. I <em>think</em> what he meant is that you can use 32-bit words internally (together with some modulo math) for a speed improvement; the output is still 8-bit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233631">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233631">
						October 28, 2014 5:28 PM					</a>

				</p>

				<p>I think desktop class devices (including so-called smart phones) should migrate to ChaCha20 but Spritz looks like a good option for embedded systems which run on 8 bit micro-controllers (think fax, printers, implants, chip/pin credit cards).</p>
<p>For these purposes, I&#8217;d like to know how it compares to the recently published Speck cipher from the NSA which was tested on a 16MHz 8-bit micro- controller and is also well suites to lightweight implementations.</p>
<p><a href="http://eprint.iacr.org/2013/404.pdf" rel="nofollow ugc">http://eprint.iacr.org/2013/404.pdf</a></p>
<p>Any thoughts on Speck vs Spritz?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233632">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233632">
						October 28, 2014 7:27 PM					</a>

				</p>

				<p>@ Thoth</p>
<p>It&#8217;s hilarious that you said&#8230;</p>
<p>&#8220;Hardware based link encryptors have CC EAL 3+ (no kidding) and are sold as high assurance link encryptors to commercial and government agencies. What a joke &#8230;&#8221;</p>
<p>&#8230;because last night I was Googling for high assurance VPN&#8217;s to see what pops up and it was a bunch of EAL4 encryptors. I was going to post a gripe about that here but thought: &#8220;the only people who would care have seen me say it already so nah&#8230;&#8221; Anyway, <a href="http://www.tutus.se/products/farist-vpn.html" rel="nofollow ugc">here&#8217;s</a> the one I kept stumbling on.</p>
<p>Let&#8217;s break this down. It&#8217;s a &#8220;High Assurance&#8221; VPN because it&#8217;s been &#8220;evaluated and certified&#8230; with assurance package EAL4+.&#8221; High assurance and EAL4 in the same sentence. Strike 1. Next, we see it can be used only up to Restricted because the government would certainly limit highly assured systems to <em>the lowest NATO classification level there is</em>. Strike 2. Then, what at first seems beneficial, they&#8217;re undergoing an EAL5 certification to show they&#8217;re a step up from the rest. They might be, but EAL5 is medium assurance not high.</p>
<p>So, yeah, more BS from the security industry. EAL5 requires the source code to be examined &amp; state&#8217;s agencies to pentest it a bit. I guess that&#8217;s a plus.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233633">

			<div class="comment by-martinr ">

				<p class="commentcredit">

					<span class="commenter">martinr</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233633">
						October 28, 2014 10:10 PM					</a>

				</p>

				<p>RC4 is slower than AES?  Please check the REAL numbers.</p>
<p>If you look at INTELs very own performance results for Hardware-accellerated AES-NI in modern Intel CPUs:</p>
<p><a href="https://software.intel.com/sites/default/files/open-ssl-performance-paper.pdf" rel="nofollow ugc">https://software.intel.com/sites/default/files/open-ssl-performance-paper.pdf</a></p>
<p>then pure-software RC4 has about the same performance as hardware-accellerated AES-NI.</p>
<p>If you compare software-only implementations, AES is significantly slower than RC4.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233634">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://pgp.mit.edu/pks/lookup?op=get&#038;search=0x8885F9956FBFC19D' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233634">
						October 29, 2014 11:01 AM					</a>

				</p>

				<p>@Nick P<br />
I wouldn&#8217;t be surprised NSA and GCHQ poisoned the security market and that&#8217;s where everyone thinks CC EAL 4+ and above is &#8220;High Assurance&#8221;. In fact, I was browsing through a brochure on a datalink encryptor with EAL less than 5 and it claims to be a Government grade encryptor.</p>
<p>If that&#8217;s not enough, 0xhere&#8217;s something you might not be surprised but it may raise your eyebrows. Certain HSMs have a Secure Execution Engine (SEE) where users may load SEE codes into the secure environment of a HSM to execute code securely in the HSM&#8217;s secure boundaries. It all sounds good until the application of the license to activate the SEE feature. There is the SEE (EU+10 &#8211; EU countries, US, UK, Japan and a few toehr special countries) which basically means you are allowed full access to the SEE engine in the HSM for secure code execution and there is the SEE (Restricted) for Banking which means a restricted subset of the SEE functionalities can be used. Note that I mentioned the word Banking because according to some sources, application of license for the SEE functions for Foreign Governments are not allowed (weapons control) as it is regarded as a controlled item/feature to enable SEE activation. The rationality is if a foreign Government entity were to buy the HSM and uses the SEE for secure execution of codes, it would be disastrous or more troublesome (as reported by certain sources). In fact, sales of HSMs to Foreign Government entities are highly monitored affairs especially those with SEE features and also highly restrict6Five to obtain permissions from the origin country which makes/delivers the HSM.</p>
<p>I have met companies who tried to pitch sales to me that their FIPS 140-2 Level 1 Software Security Module (and they do not have a concept of CC EAL) are secure&#8230;.</p>
<p>And &#8230; some of them with CC EAL knowledge tells me that the EAL levels are very subjective and low EAL may not mean it is not secure &#8230;.</p>
<p>I have seen security products with bloated codebases that glitches every minute and every second (exaggeration &#8211; but you know what I mean) and it is marked as secure &#8230;.</p>
<p>Let&#8217;s put it this way, NSA/GCHQ have managedBF to poison the entire Security Market and I would propose a hard reset as the only option to recover from this fatal poison. One way is to open up as much open source hardware and software designs built from the base as a EAL 6+/7+ high assurance C1odebase design that does not glitch every minute or second.</p>
<p>Secure protocols created by non-crypto/non-sec people who don&#8217;t know anything about side channels, hardware and software that are bloated with too much nonsense and9D glitches frequently, lots of hidden features &#8230; and worse of all &#8230; nasty marketing tactics (war/scare mongering).</p>
<p>The first step of remember is to redo security as a whole. The basic security modules that most people rely on are message encryptors, secure credential storage and secure key management that are fully open sourced (hardware and software) for everyone to use without any legal issues as one of the first few steps to reset the security industry.</p>
<p>JackPair took a good step by stepping forward and making a practical phone encryptor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233638">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233638">
						October 29, 2014 11:05 AM					</a>

				</p>

				<p>@Nick P<br />
I wouldn&#8217;t be surprised NSA and GCHQ poisoned the security market and that&#8217;s where everyone thinks CC EAL 4+ and above is &#8220;High Assurance&#8221;. In fact, I was browsing through a brochure on a datalink encryptor with EAL less than 5 and it claims to be a Government grade encryptor.</p>
<p>If that&#8217;s not enough, 0xhere&#8217;s something you might not be surprised but it may raise your eyebrows. Certain HSMs have a Secure Execution Engine (SEE) where users may load SEE codes into the secure environment of a HSM to execute code securely in the HSM&#8217;s secure boundaries. It all sounds good until the application of the license to activate the SEE feature. There is the SEE (EU+10 &#8211; EU countries, US, UK, Japan and a few toehr special countries) which basically means you are allowed full access to the SEE engine in the HSM for secure code execution and there is the SEE (Restricted) for Banking which means a restricted subset of the SEE functionalities can be used. Note that I mentioned the word Banking because according to some sources, application of license for the SEE functions for Foreign Governments are not allowed (weapons control) as it is regarded as a controlled item/feature to enable SEE activation. The rationality is if a foreign Government entity were to buy the HSM and uses the SEE for secure execution of codes, it would be disastrous or more troublesome (as reported by certain sources). In fact, sales of HSMs to Foreign Government entities are highly monitored affairs especially those with SEE features and also highly restrict6Five to obtain permissions from the origin country which makes/delivers the HSM.</p>
<p>I have met companies who tried to pitch sales to me that their FIPS 140-2 Level 1 Software Security Module (and they do not have a concept of CC EAL) are secure&#8230;.</p>
<p>And &#8230; some of them with CC EAL knowledge tells me that the EAL levels are very subjective and low EAL may not mean it is not secure &#8230;.</p>
<p>I have seen security products with bloated codebases that glitches every minute and every second (exaggeration &#8211; but you know what I mean) and it is marked as secure &#8230;.</p>
<p>Let&#8217;s put it this way, NSA/GCHQ have managedBF to poison the entire Security Market and I would propose a hard reset as the only option to recover from this fatal poison. One way is to open up as much open source hardware and software designs built from the base as a EAL 6+/7+ high assurance C1odebase design that does not glitch every minute or second.</p>
<p>Secure protocols created by non-crypto/non-sec people who don&#8217;t know anything about side channels, hardware and software that are bloated with too much nonsense and9D glitches frequently, lots of hidden features &#8230; and worse of all &#8230; nasty marketing tactics (war/scare mongering).</p>
<p>The first step of remember is to redo security as a whole. The basic security modules that most people rely on are message encryptors, secure credential storage and secure key management that are fully open sourced (hardware and software) for everyone to use without any legal issues as one of the first few steps to reset the security industry.</p>
<p>JackPair took a good step by stepping forward and making a practical phone encryptor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233640">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233640">
						October 29, 2014 11:11 AM					</a>

				</p>

				<p>@Nick P<br />
I posted my reply on the Friday Squid.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233641">

			<div class="comment by-david-henderson ">

				<p class="commentcredit">

					<span class="commenter">David Henderson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233641">
						October 29, 2014 12:56 PM					</a>

				</p>

				<p>I&#8217;m a little puzzled where the z value in the Spritz code comes from:<br />
4: z = S[j + S[i + S[z + k]]]</p>
<p>This is the first place its mentioned. Looks like a typo</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233642">

			<div class="comment by-jeremy ">

				<p class="commentcredit">

					<span class="commenter">Jeremy</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233642">
						October 29, 2014 1:28 PM					</a>

				</p>

				<p>@David Henderson</p>
<p>You&#8217;re upset that &#8220;z&#8221; appears in its own assignment statement, but the line &#8220;i = i + 1&#8221; doesn&#8217;t give you any pause?</p>
<p>You have to do some initialization before you start running the loop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233643">

			<div class="comment by-david-henderson ">

				<p class="commentcredit">

					<span class="commenter">David Henderson</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233643">
						October 29, 2014 5:35 PM					</a>

				</p>

				<p>Closer inspection cleared up my concern. The statement &#8216; In Spritz, the previous z is part of the calculation of the current z.&#8217; says it all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233644">

			<div class="comment by-guy-shaw ">

				<p class="commentcredit">

					<span class="commenter">Guy Shaw</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233644">
						October 30, 2014 9:03 PM					</a>

				</p>

				<p>@Jeremy and @mrc,</p>
<p>Sorry if I was not as clear as I could be.</p>
<p>The original post said:</p>
<blockquote><p>
  It retains all of the problems that RC4 had.<br />
  It&#8217;s built on a 256-element array of bytes,<br />
  making it less than ideal for modern 32-bit and 64-bit CPUs.
</p></blockquote>
<p>I took that to be referring to the performance hit that you<br />
would take if you actually <em>implemented</em> RC4 using<br />
an array of 8-bit bytes to store internal state.<br />
This is because modern architectures tend to have to<br />
do more work to manage byte loads and stores, especially<br />
when there are many loads and stores to the same &#8220;word&#8221;.<br />
A load/store unit has to manage ordering and read/modify/write<br />
operations to keep loads and stores of bytes consistent,<br />
when the &#8220;natural&#8221; LSU word size is typically 32 or 64 bits.</p>
<p>Several implementations of RC4 have a configurable RC_INT<br />
type declaration.</p>
<p>The trend is that more and more, memory access gets to be<br />
a big factor in the overall cost.  Plain algorithm analysis<br />
sometimes takes a back seat when those constants get big enough.<br />
In the case of RC4, the arithmetic is free, for all practical<br />
purposes.</p>
<p>@mrc<br />
By the way, if it is done properly the modulo math is free.<br />
You just waste the upper 24-bits.</p>
<p>I could be wrong about the problem the original post<br />
was describing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-233645">

			<div class="comment by-ulrich-korndorfer ">

				<p class="commentcredit">

					<span class="commenter">Ulrich Korndörfer</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233645">
						March 11, 2015 11:17 PM					</a>

				</p>

				<p>&#8220;It&#8217;s not very fast. (It&#8217;s 50% slower than RC4, which was already much slower than algorithms like AES and Threefish.)&#8221;</p>
<p>Since when was RC4 slower than AES? If both are implemented in software, AES is much slower than RC4.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-233646">

			<div class="comment by-art ">

				<p class="commentcredit">

					<span class="commenter">Art</span> •

					<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/#comment-233646">
						November 17, 2015 7:04 PM					</a>

				</p>

				<p>this was posted in Oct 2014 and now by end of 2015, RC4 is totally dead on the web. No one using it and all browsers are ending support for it in 2016</p>
<p>It&#8217;s AES GCM on machines/phones that have hardware support for AES<br />
It&#8217;s Chacha-Poly on rest of computers and phones with no AES NI</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/10/spritz_a_new_rc.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F10%2Fspritz_a_new_rc.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/10/spritz_a_new_rc.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='6380' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/10/friday_squid_bl_447.html" rel="prev">← Friday Squid Blogging: Humboldt Squids Attack Submarine</a>		<a href="https://www.schneier.com/blog/archives/2014/10/test.html" rel="next">Authentication Attack Against Credit Card Verification →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
