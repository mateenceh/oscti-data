<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>The IDEA Encryption Algorithm with a 128-bit Block Length - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; The IDEA Encryption Algorithm with a 128-bit Block Length Comments Feed" href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/6730" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=6730' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F01%2Fthe_idea_encryp.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F01%2Fthe_idea_encryp.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-6730 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-6730" class="post-6730 post type-post status-publish format-standard hentry category-uncategorized tag-algorithms tag-cryptanalysis tag-cryptography tag-encryption">

	<div class="article">

		<h2 class="entry">The IDEA Encryption Algorithm with a 128-bit Block Length</h2>
		<p><a href="http://eprint.iacr.org/2014/704.pdf">Here&#8217;s</a> an IDEA-variant with a 128-bit block length. While I think it&#8217;s a great idea to bring IDEA up to a modern block length, the paper has none of the cryptanalysis behind it that IDEA had. If nothing else, I would have expected more than eight rounds. If anyone wants to practice differential and linear cryptanalysis, here&#8217;s a new target for you.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/algorithms/" rel="tag">algorithms</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html" rel="bookmark">Posted on January 27, 2015 at 6:24 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html#comments">20 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html" data-title="The IDEA Encryption Algorithm with a 128-bit Block Length" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-240091">

			<div class="comment by-guest ">

				<p class="commentcredit">

					<span class="commenter">Guest</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240091">
						January 27, 2015 7:32 AM					</a>

				</p>

				<p>The use of arithmetic operations for ciphers has been criticizes on a very general level. This was taken into account in the design of IDEA-NXT, the official successor of IDEA, which supports 128 bit block length (but, like all IDEA variants, is patented). This proposal is a step backwards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240092">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240092">
						January 27, 2015 8:56 AM					</a>

				</p>

				<p>Two thoughts:</p>
<p>1) Given its origin, we can probably rule out any NSA backdoors.<br />
2) Not sure why they limit themselves to a 256 bit key length instead of 512.</p>
<p>I&#8217;ll leave the cryptanalysis to people who are more proficient at it than I am.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240093">

			<div class="comment by-jill-england ">

				<p class="commentcredit">

					<span class="commenter">Jill England</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240093">
						January 27, 2015 12:01 PM					</a>

				</p>

				<p>I&#8217;m not sure you can ever rule out NSA back-doors.  But if it makes you feel better ok. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240094">

			<div class="comment by-lightbit ">

				<p class="commentcredit">

					<span class="commenter">LightBit</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240094">
						January 27, 2015 12:47 PM					</a>

				</p>

				<p>My list of block ciphers to avoid (implementing): Camellia, <b>IDEA</b>, MARS and SAFER*</p>
<p>I think I&#8217;ve seen 128-bit block Blowfish once.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240095">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240095">
						January 28, 2015 1:14 AM					</a>

				</p>

				<p>While I won&#8217;t use IDEA cipher going forward, my GPG key still prioritizes IDEA as the main cipher. It may be old, but it is still pretty safe for texts and emails. Those who criticize it for using arithmetic operations are blowing smoke since 1) Rjindael/AES also uses arithmetic operations, and 2) IDEA and Rjindael are still practically (though not theoretically) secure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240096">

			<div class="comment by-random ">

				<p class="commentcredit">

					<span class="commenter">Random</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240096">
						January 28, 2015 2:13 AM					</a>

				</p>

				<p>Bruce, few words of your commentary on chacha20, poly1305 and Ed25519 as used in OpenSSH and TLS would be interesting. Relatively unknown ciphers pushed as modern standard in many of the most important projects, especially by Google.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240097">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240097">
						January 28, 2015 2:17 AM					</a>

				</p>

				<p>@Dan</p>
<p>I&#8217;m not sure who criticizes IDEA for using arithmetic operations; using all arithmetic operations has the potential for making it a lot easier to implement without side-channel attacks. IDEA however, you have to be careful. Computing the multiplicative inverse mod 65537 can introduce branching, which has the potential for side channels, and the fact that when multiplication is done, zero is mapped to 65536, meaning you have to get clever if you want to avoid branching (a much safer method would be to make &#8220;mul(x,y) = ((x+1)*(y+1) mod 65537) &#8211; 1&#8221; as it doesn&#8217;t require branching).</p>
<p>By just adding 1, you would get rid of the potential branching, and then there is actually a really easy way to make IDEA 128-bit without having to worry about the branching in the multiplicative inverse calculation: make it a feistel cipher. Then it becomes very easy to implement using only non-branching code.</p>
<p>Of course, that leaves two things that need to be done: 1) Improve the key schedule (I&#8217;ve a relatively simple key-schedule design that would dramatically improve security, see below) and 2) Increase the round; the number of rounds should be determined by the cryptanalysis</p>
<p>What I would do with the key schedule:</p>
<p>So say you need n 16-bit subkeys, n&gt;4, set a zero-indexed array A of n+7 words to the numbers 0,1,2, &#8230;, n+6. XOR the first 64 bits of key to the first 4 words, run the round function, XOR A[0] to A[4], and then XOR the next 64 bits of key to A[1],A[2],A[3],A[4], run the round function on those four words, and then XOR A[1] to A[5]. Continue doing this, starting with each position of the array until you have run through all the elements in the array. If you reach the end of the key, start over from the beginning (sorry if the description is not clear, I don&#8217;t really feel like writing pseudocode). The key schedule is A[4] through A[n+3].</p>
<p>What I like about this method is that it fulfills several properties that I personally like in a key schedule: 1) it has good psuedo-random properties as long as the round function is halfway decent 2) it can be performed in-place using only a few registers 3) knowing part of the key-schedule does not allow you to determine the rest of the key schedule 4) if you store the last three words that were discarded along with the last word in the key schedule, you can reverse the algorithm, so decryption can be done without having to store the entire key schedule.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240098">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240098">
						January 28, 2015 3:01 AM					</a>

				</p>

				<p>@Random</p>
<p>Ed25519 is just ECDSA using the 256-bit Montgomery curve (aka Curve25519). These are well understood and equal in security to the NIST ECC curves (although Curve25519 is easier to implement and not as likely to be subverted). ChaCha20 is an improved version of Salsa20, and Salsa20 has been around for years and was selected as part of the eSTREAM competition, which was an effort by the EU that underwent a similar process to AES. That said, I would have gone with Salsa20 itself since it&#8217;s more well-known.</p>
<p>I can&#8217;t comment on Poly1305.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240099">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240099">
						January 28, 2015 3:06 AM					</a>

				</p>

				<p>That should be &#8220;a 256-bit Montgomery curve&#8221; not &#8220;the 256-bit Montgomery curve&#8221; as I am pretty sure that there is more than one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240100">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240100">
						January 28, 2015 3:17 AM					</a>

				</p>

				<p>Actually, it&#8217;s not really using Curve25519, it&#8217;s using a curve based on that; the point still stands. (I really need to get some sleep)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240101">

			<div class="comment by-gonzo ">

				<p class="commentcredit">

					<span class="commenter">Gonzo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240101">
						January 28, 2015 11:01 AM					</a>

				</p>

				<p>Here are my thoughts after looking this implementation over.</p>
<p>Each subblock of plain text and each round sub key participates in the MA box, which was in many respects the crucial feature of original IDEA.  Each key and each input subblock participates in each output block, in consequence.</p>
<p>One major difference is that the MA box in IDEA was transformed with two of the six round subkeys, whereas this implementation necessarily replaces those subkey inputs at the MA box with input blocks from the periphery rows that were transformed by the addition or multiplication operations with subkeys previously.  I wonder if it achieves the same mixing level with this approach.</p>
<p>Years ago, I had a wonderful geek-out session discussing the IDEA cipher with my former father in law before he passed  (he was a mathematics and physics guy and a pretty solid mathematician whose grad level book on acoustics is still taught).  I came away from the discussion with the impression that he thought the mixing of incompatible operations (addition, multiplication, XOR) was great, but that it was the involvement of multiplication by a Fermat Prime that would be the biggest factor in IDEA&#8217;s resistance to various attacks.  I remember there was an update of a Lai Massey framework at the time that was working on wider subblocks and used multiplication modulo 2^32+1 (which is not prime) and his view was it would be seriously weaker.</p>
<p>I&#8217;m not bashful about saying that I remain a huge fan of IDEA and like a poster above, its still used as the preferred cipher on one of my RSAv4 PGP keys.</p>
<p>That said, these guys have done nothing about the week and related key issues with IDEA (all zero or all 1 keys, for example) that are a function of IDEA&#8217;s original very linear key schedule.  They also do not seem to have analyzed their subblock swaps and there may be too much parallelism in what they&#8217;ve done.</p>
<p>Realizing I&#8217;m no where knowledgeable enough to do so, but in the spirit of discussion, if I were to offer advice to the team working on this reboot of IDEA, my suggestions would be:</p>
<ol>
<li>Add the use of a few more subkeys in each round, possibly XOR&#8217;d against the inputs to the multiplication operations on the upper left and lower right of the central MA box.   Obviously, it would be important to make sure not to break the reversibility of the algo but it does strike me that original IDEA used six subkeys to mix 4 subblocks totaling 64 bits, whereas this implementation uses 8 subkeys to mix 8 subblocks totaling 128 bits &#8212; that&#8217;s less  keymat per sub-block, and less  keymat as a percentage of bits processed in each round.</li>
<li>Implement an expensive initial key expansion step as in Blowfish.  I know, I know, terrible for hardware implementations and low power devices, but creating the sub-keys by running a large number of iterations of the cipher structure against intermediate keymat processed by PI (or some other innocent bitstream) has always struck me as a great feature of Blowfish.  The expensive key setup impacts brute force attacks, and ought to make data and memory requirements for things like differential or biclique attacks much more daunting.</li>
<li>Consider whether the swaps as depicted in this structure at the end of each round are too symmetrical and evaluate whether adjusting the swap structure would improve resistance to attacks.</li>
<li>MORE ROUNDS!  Current IDEA has a narrow biclique attack that very slightly reduces work compared to brute force.  The authors of that attack suggest that very expensive key setup would preclude their approach, but reading their paper it struck me just how much each additional round added in terms of expanding the work and memory requirements.  There&#8217;s no reason that a 128 bit IDEA style cipher would not be safer using more rounds.</li>
</ol>
<p>Of course, I write all this having just read the excellent write up on the &#8220;type confusion&#8221; vulnerability in the Black Phone (<a href="http://blog.azimuthsecurity.com/2015/01/blackpwn-blackphone-silenttext-type.html" rel="nofollow ugc">http://blog.azimuthsecurity.com/2015/01/blackpwn-blackphone-silenttext-type.html</a>).</p>
<p>Sometimes, I feel like waxing on about crypto primitives is a waste of time until we can get a better handle on implementation.   After all we are blessed with an abundance of strong, well studied, practically unbreakable crypto.  IDEA itself is not itself practically broke, nor is Blowfish I should add in a nod to Bruce.  Excepting applications with encryption of a ton of data using the same key (where the block size creates problems with birthday issue), each of these are still safe for PGP messages or protection of individual files or small archives.  They&#8217;re also fine for things like short VPN sessions (Blowfish is still default in OpenVPN) where the data transmitted with the same key does not approach tens of gigabytes.</p>
<p>But its all for naught if the implementations are buggy.</p>
<p>Truly, the crypto world would be served greatly by a portable, cross-platform, programming library akin to LibTomCrypt but based on a programming language that is memory safe.   Unmanaged C has had a VERY bad few years in terms of its use in crypto software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240102">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240102">
						January 28, 2015 11:29 AM					</a>

				</p>

				<p>@ Gonzo</p>
<p>The implementation issue is a mostly solved problem: <a href="http://www.cryptol.net/" rel="nofollow ugc">CRYPTOL</a>. Work like that can be extended to handle remaining issues. Just another example of IT/INFOSEC not leveraging and building on existing solutions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240103">

			<div class="comment by-gonzo ">

				<p class="commentcredit">

					<span class="commenter">Gonzo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240103">
						January 28, 2015 11:41 AM					</a>

				</p>

				<p>@Nick &#8212; the problem I see is that Cryptol itself says its not useful for implementation of the whole shebang, such as a complete SSL/TLS suite.</p>
<p>I don&#8217;t blame the developers of the BlackPhone for using  libscimp &#8212; they need to have something they can put to work on various platforms.  I just want folks to move past unmanaged C altogether for applications connected to the internet.  Its wishful stupid thinking, but good heavens some of these BUGS that are getting through.</p>
<p>A friend of mine (a legal eagle) was telling me about an archaic rule in the law called the rule against perpetuities.  Its amazingly complex.   Judges have found that its not malpractice to screw it up, but it IS malpractice not to put in the safety clause. Analogizing to crypto I&#8217;d say to err is human and expected, but to keep using unmanaged C when you know humans are writing the code is problematic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240104">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240104">
						January 28, 2015 2:17 PM					</a>

				</p>

				<p>@Gonzo</p>
<blockquote><p>1. Add the use of a few more subkeys in each round, possibly XOR&#8217;d against the inputs to the multiplication operations on the upper left and lower right of the central MA box. Obviously, it would be important to make sure not to break the reversibility of the algo but it does strike me that original IDEA used six subkeys to mix 4 subblocks totaling 64 bits, whereas this implementation uses 8 subkeys to mix 8 subblocks totaling 128 bits &#8212; that&#8217;s less keymat per sub-block, and less keymat as a percentage of bits processed in each round.</p></blockquote>
<p>I would probably go in another direction, I would reduce the number of subkeys, and look to make it more nonlinear by replacing two of the multiplications by subkeys with multiplication between two words in the function. Something like this:</p>
<pre>
x1 = k1*x1
x2 = k1^x2
x3 = k3^x3
x4 = k4*x4

x2 = x1*x2
x3 = x4*x3
x3 = x2+x3
x2 = x3+x2

x1 = x3^x1
x4 = x2^x4
</pre>
<p>I haven&#8217;t tested it, but I suspect if you try it you will find it is a bit more nonlinear and provides a bit better diffusion than the IDEA round function (it&#8217;s also fewer operations).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240105">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240105">
						January 28, 2015 7:24 PM					</a>

				</p>

				<p>Just for fun, I implemented a variant of idea based on all of the suggestions I gave above. No clue how secure it actually is, the number of rounds is a parameter and should probably be at least 16, but I just wanted to show that with some minor tweaks IDEA can be made a lot easier to implement securely (specifically, without being susceptible to timing attacks).</p>
<p><a href="http://pastebin.com/zZ84acxh" rel="nofollow ugc">http://pastebin.com/zZ84acxh</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240106">

			<div class="comment by-ryan ">

				<p class="commentcredit">

					<span class="commenter">Ryan</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240106">
						January 28, 2015 9:01 PM					</a>

				</p>

				<p>@Anura</p>
<p>I have a similar idea, using block XTEA or XXTEA where after a round encryption of a section, it would be added with it&#8217;s neighbors. It might also reduce some susceptibility to related key attacks (using AES implemented in excel, an appalling few new of subkey bytes are changed when you change a few bits).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240107">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240107">
						January 29, 2015 7:52 AM					</a>

				</p>

				<p>Somewhat related question from a non-cryptographer: How much data would you feel comfortable encrypting with a 64 bit block cipher in 2015, assuming CBC mode (CBC seems to be the most common mode for IDEA and Blowfish implementations) and no other practical weaknesses in the cipher design or key size?  For argument&#8217;s sake, let&#8217;s limit it to  for file, partition,  or full disk encryption, not SSL, SSH, or any other data in transit situation.</p>
<p>I know Applied Cryptography states 34 GB as being the point at which repeated blocks will become likely with a 64 bit block cipher, but I assume one would want  some cushion. I&#8217;m not sure how much that should be though.</p>
<p>(I know someone will be along to say &#8220;Just use AES&#8221; or something like that, but that&#8217;s not the point of the question)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240108">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240108">
						January 29, 2015 10:21 AM					</a>

				</p>

				<p>@ z,</p>
<p>&lt;</p>
<p>blockquote&gt;How much data would you feel comfortable encrypting with a 64 bit block cipher in 2015, assuming CBC mode</p>
<p>The answer has a lot less to do with the blockwidth than the mode it is used in. Also of more importance is how long do you want it to remain secret for.</p>
<p>Whilst CBC is quite common it is possible to muck it up, you would be surprised how many people don&#8217;t deal with the IV properly, it should realy be selected in a random way, and never reused under the same key, thus requiring either some kind of database or secure pseudorandomness in the design, if &#8220;explicit initialisation vectors are used, you don&#8217;t have to seperatly send the IV to the decryptor. CBC does not play well with communication or storage errors as due to it&#8217;s design errors propergate, it can also have issues with simple message padding as well. It also has the disadvantage that you can only encrypt as a serial process which is a bottleneck in quite a few applications, as it makes it append only not random access.</p>
<p>There are better modes you can use that can also as a consequence improve the length of data you can encrypt however some are encumbered by patents which might be of concern if you need to commumicate with the US or US organisations.</p>
<p>In systems I have control over I prefere to use two or more different algorithms using different modes in series. This tends to overcome the problem you refere to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-240110">

			<div class="comment by-s ">

				<p class="commentcredit">

					<span class="commenter">S</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240110">
						February 2, 2015 7:15 PM					</a>

				</p>

				<p>@ z,</p>
<p>If you use random IVs and encrypt <i>n</i> 64-bit blocks, then the probability of leaking information to an attacker is less than n<sup>2</sup>/2<sup>64</sup>, even if the attacker can choose or already knows stuff about some of the plaintexts. (A formal statement and proof of this would be covered in an intro crypto class, and would assume that there are no direct attacks on the blockcipher itself.)</p>
<p>So if you want the probability of info being leaked to an attacker to be less than 1 in a million (say, 2<sup>-20</sup>), you want to limit n so that n<sup>2</sup>/2<sup>64</sup> &amp;leq; 2<sup>20</sup>, which works out to be n &amp;leq; 2<sup>22</sup> 64-bit blocks, or about 32MB. You can set the &#8220;1 in a million&#8221; to whatever value you consider acceptable, and then do the math yourself. The 32MB amount is obviously rather low in many applications, and although the issue can mitigated by using a different key for each, say, 20MB of data, it is for this reason that 128-bit block sizes are recommended.</p>
<p>Keep in mind that this is a very low bar for &#8220;leaking any information&#8221;, since the &#8220;information&#8221; in question could be something as simple as &#8220;The seventh 64-bit chunk of THIS desk sector does not contain the same value as the tenth 64-bit chunk of THAT sector.&#8221; But it&#8217;s usually best if you can avoid having to guess what info will be leaked and what an attacker could do or infer based on that info.</p>
<p>Note that the only part of this answer that could make the &#8220;&#8230;in 2015&#8221; part of your question matter is the part about the blockcipher itself being secure. If the blockcipher uses 56 bit keys, it&#8217;s probably not secure in 2015.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-240111">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/#comment-240111">
						February 3, 2015 12:48 AM					</a>

				</p>

				<p>@s</p>
<p>I believe what the previous poster was referencing is that you do not want to allow two blocks to repeat, as this causes a problem in all modes of operation. The probability that a block will repeat is 50% once you have encrypted about 2<sup>n/2</sup> blocks with an n-bit block size. In output feedback mode, it&#8217;s particularly bad because you can&#8217;t guarantee that a block won&#8217;t repeat and if there is any repetition then all subsequent blocks will be repeated and you end up with the stream cipher problem, however if your data appears sufficiently random then the attacker might not be able to determine there is an issue. With CBC mode, having two blocks encrypt the same tells you that they are identical except they may be XORd to different known value, you may be able to guess the other. With CFB mode you can determine that two blocks of ciphertext are identical, however they may not repeat.</p>
<p>Counter mode makes it easy to mitigate the problem: deterministic IVs. For a 64-bit IV, you can take some of the bits, and have a fixed identifier so that know two devices with the same key have the same identifier, a global counter that is not allowed to repeat, and then the rest of the bits are used for the normal counter operation (which is 0 for the first block). The counter bits limits the data to 2<sup>c</sup>n/8 bytes of data per key/global counter combination, and the global counter limits the total number of connections that can be encrypted. If you have an 8-bit identifier, 20-bit global counter, and 36-bit normal counter, then you can encrypt 512 gigabytes. The specification for GCM mode describes this way to do deterministic IVs, unfortunately they limit the counter to 32-bits regardless of whether you are using random or deterministic IVs, limiting the amount of cihpertext per IV.</p>
<p>Counter mode also avoids the problem if you never reuse keys, e.g. if you are doing a key-exchange for each connection, you don&#8217;t have to worry about how much you encrypt since the keystream is never going to repeat. However, there is the issue in that you will be able to distinguish the ciphertext from truly random data in a chosen plaintext attack. Whether that leads to a feasible attack is another story.</p>
<p>The best solution is to just not use 64-bit block ciphers. Use 128-bit block ciphers, and it&#8217;s no longer a problem. I take that back; it&#8217;s possible to create realistic scenarios involving massive amounts of data where it may be too much of a risk; this is a good reason to start looking at 256-bit block ciphers.</p>
<p>Although I&#8217;ve played with one really ridiculous and slow cipher design in the past that generated a separate key-schedule for each block based on a nonce, a counter, and the key, which prevents any of the problems mentioned as long as the nonce isn&#8217;t repeated. It was a fun design, a 256-bit block size, 256-bit key, 256-bit nonce, and 256-bit counter; it was a feistel cipher with the feistel function performing a 2&#215;2 matrix multiplication modulo 2^64 against a static matrix, followed by multiplication in GF(2^128) by a key-dependent value that changed each block, followed by addition modulo 2^64 to 2 64-bit subkeys. Computing the key schedule was done by first multiplying the counter by a 4&#215;4 matrix, followed XORing the nonce, followed by multiplication of each half by a different constant in GF(2^128), followed by muliplying again by the matrix, followed by XORing the key, followed by multiplying each half by another constant in GF(2^128). Then there was a counter for each round that it was XORd by, then there was addition mod 2^64 by a static value computed from the key and nonce in a similar fashion as the block-specific key value (but with no counter), then muliplication in GF(2^128), then the 4&#215;4 matrix again, followed by one final mutiplication in GF(2^128) with a constant that differed with each round &#8211; one half was the key that was added at the end, and the other was used for the multiplication in GF(2^128) except with the highest bits set to 0 (for simplicity/performance reasons) and the next highest bit set to 1 (to guarantee no multiplication by zero). Like I said, ridiculous and slow &#8211; but fun to design, and it can encrypt everything in parallel. Another feature was that it take the ciphertext that results from running half the rounds, XOR them all together, and when all data was encrypted, it would then encrypt that value, which could be used as a message authentication code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2015/01/the_idea_encryp.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2015/01/the_idea_encryp.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F01%2Fthe_idea_encryp.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2015/01/the_idea_encryp.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='6730' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2015/01/basaaly_moalin_.html" rel="prev">← Basaaly Moalin: The One "Terrorist" Caught by Section 215 Surveillance</a>		<a href="https://www.schneier.com/blog/archives/2015/01/police_using_ra.html" rel="next">Police Using Radar that Sees Through Walls →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
