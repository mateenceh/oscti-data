<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>IRS Encourages Poor Cryptography - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; IRS Encourages Poor Cryptography Comments Feed" href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/6777" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=6777' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F02%2Firs_encourages_.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F02%2Firs_encourages_.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-6777 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-6777" class="post-6777 post type-post status-publish format-standard hentry category-uncategorized tag-aes tag-cryptography tag-encryption tag-irs">

	<div class="article">

		<h2 class="entry">IRS Encourages Poor Cryptography</h2>
		<p>I&#8217;m not sure what to make of this, or even what it means. The IRS has a standard called <a href="http://www.irs.gov/Businesses/Corporations/International-Data-Exchange-Service">IDES</a>: International Data Exchange Service: &#8220;The International Data Exchange Service (IDES) is an electronic delivery point where Financial Institutions (FI) and Host Country Tax Authorities (HCTA) can transmit and exchange FATCA data with the United States.&#8221; It&#8217;s like IRS data submission, but for other governments and foreign banks.</p>
<p>Buried in one of the <a href="https://ides.desk.com/customer/portal/topics/756321-data-prep-guide/articles">documents</a> are the <a href="https://ides.desk.com/customer/portal/articles/1839960-step-3---encrypt-the-xml-file-with-aes-256-key">rules for encryption</a>:</p>
<blockquote><p>While performing AES encryption, there are several settings and options depending on the tool used to perform encryption.  IRS recommended settings should be used to maintain compatibility:</p>
<ul>
<li>Cipher Mode: ECB (Electronic Code Book).
<li>Salt: No salt value
<li>Initialization Vector: No Initialization Vector (IV). If an IV is present, set to all zeros to avoid affecting the encryption.
<li>Key Size: 256 bits / 32 bytes Â­ Key size should be verified and moving the key across operating systems can affect the key size.
<li>Encoding: There can be no special encoding. The file will contain only the raw encrypted bytes.
<li>Padding: PKCS#7 or PKCS#5.</ul>
</blockquote>
<p>ECB? Are they <a href="https://bobnalice.wordpress.com/2009/01/28/friends-don%E2%80%99t-let-friends-use-ecb-mode-encryption/">serious</a>?</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/aes/" rel="tag">AES</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/irs/" rel="tag">IRS</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html" rel="bookmark">Posted on February 18, 2015 at 6:42 AM</a>			â¢
			<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html#comments">53 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html" data-title="IRS Encourages Poor Cryptography" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-241542">

			<div class="comment by-musashi ">

				<p class="commentcredit">

					<span class="commenter">Musashi</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241542">
						February 18, 2015 7:03 AM					</a>

				</p>

				<p>Perhaps this is the new government policy to weaken security to protect us against drug dealers, terrorists and pedophiles&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241543">

			<div class="comment by-z-lozinski ">

				<p class="commentcredit">

					<span class="commenter">Z.Lozinski</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241543">
						February 18, 2015 7:07 AM					</a>

				</p>

				<p>The IBM cryptanalysis of DES showed why ECB is a bad idea.  The example used was encrypting a file with a well-defined structure, which is clearly still visible in the ciphertext.  That was published in the IBM Systems Journal back around 1980, when we were trying to get the IT industry to understand why crypto and DES were important, and how best to use it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241544">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241544">
						February 18, 2015 7:24 AM					</a>

				</p>

				<p>Any body remember why Swift ended up moving to Switzerland?</p>
<p>It was because a person friendly to the Bush administration was aranging for all the Swift transaction data to be made available to the US Gov to aid in the war on terror&#8230; when the Europeans were made aware of this via the work of PI, the kick back was very large , and the fall out was significant.</p>
<p>Thus I would be suspicious that any such &#8220;crypto mistake&#8221; would be to the NSA&#8217;s or GCHQs advantage, in that they could get the data without asking the IRS etc. Which has all sorts of advantages, especialy in political organisations. Thus it is quite possible the standard designers had the same issues/help NIST did with one of theirs&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241545">

			<div class="comment by-wiredog ">

				<p class="commentcredit">

					<span class="commenter">wiredog</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241545">
						February 18, 2015 7:27 AM					</a>

				</p>

				<p>Oh, FFS, guess who else uses ECB?  The Department of Defense.  Specifically, the Defense Health Service.  All the medical records transmitted to/from <a href="http://en.wikipedia.org/wiki/Armed_Forces_Health_Longitudinal_Technology_Application" rel="nofollow ugc">AHLTA.</a></p>
<p>Why am I not surprised?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241546">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241546">
						February 18, 2015 7:37 AM					</a>

				</p>

				<p>It might have changed as I&#8217;ve not checked recently, but at least one UK government department explictly states that files submitted to them must NOT be encrypted. seems it&#8217;s to ensure they (and of course by extension anyone else on the internet) will have no issues reading the data. Would not be an issue were it not that some of the data is actually quite sensitive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241547">

			<div class="comment by-pope-jenner ">

				<p class="commentcredit">

					<span class="commenter">Pope Jenner</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241547">
						February 18, 2015 8:19 AM					</a>

				</p>

				<p>@wiredog: ECB in AHLTA sounds like bad news. What&#8217;s encryption like in the private sector?</p>
<p>Last I see about HIPAA on this blog is from 2005. Can anyone offer current updates on medical privacy/security best practices, especially in light of Snowden&#8217;s revelations?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241548">

			<div class="comment by-lazlo ">

				<p class="commentcredit">

					<span class="commenter">lazlo</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241548">
						February 18, 2015 8:37 AM					</a>

				</p>

				<p>To me this reeks not of anything underhanded, but purely of someone who does not understand encryption and/or security writing documentation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241549">

			<div class="comment by-wooster ">

				<p class="commentcredit">

					<span class="commenter">wooster</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241549">
						February 18, 2015 8:39 AM					</a>

				</p>

				<p>Pope Jenner: mostly fax machines and hotmail</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241550">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241550">
						February 18, 2015 8:42 AM					</a>

				</p>

				<p>&#8220;Buried in one of the documents are the rules for encryption:</p>
<p>&#8220;<em>Cipher Mode: ECB (Electronic Code Book).<br />
&#8220;</em>Salt: No salt value<br />
&#8220;<em>Initialization Vector: No Initialization Vector (IV). If an IV is present, set to all zeros to avoid affecting the encryption.<br />
&#8220;</em>Key Size: 256 bits / 32 bytes Â¬ Key size should be verified and moving the key across operating systems can affect the key size.<br />
&#8220;*Encoding: There can be no special encoding. The file will contain only the raw encrypted bytes.</p>
<p>&#8220;*ECB? Are they serious?&#8221; -Bruce S</p>
<p>Whoa, the IRS needs some âserious backward&#8221; compatibility â or the government wants to ensure the NSA can âman-in-the-middleâ [break the encryption] your tax return on the fly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241551">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">Steven</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241551">
						February 18, 2015 8:48 AM					</a>

				</p>

				<p>The job is to transfer data from here to there. To the people responsible for getting that job done, encryption&#8211;and security in general&#8211;is an obstacle. They write guidelines like this to minimize the chances that encryption will get in their way. They aren&#8217;t recommending ECB with the idea that they&#8211;or anyone&#8211;will exploit the information that it leaks. They are recommending ECB because it is the simplest, LCD, and therefore most likely to work in practice.</p>
<p>The U.S Navy used to have a similar attitude towards communications security. Commanders were responsible for communicating with ships at sea. They made decisions that effectively traded security for reliability in these communications. Individually, each of these decisions made sense to the commanders who made them. In the aggregate, they created a security environment that made it easy for John Walker to sell the encryption keys to the Soviet Union.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241553">

			<div class="comment by-audit-me ">

				<p class="commentcredit">

					<span class="commenter">Audit me</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241553">
						February 18, 2015 9:13 AM					</a>

				</p>

				<p>Don&#8217;t worry, the IRS is on it. NSA sent over a crack tiger team and they&#8217;re writing an RFI for a sole-source classified MIPR to Booz Allen, FFP $483.69M for a four-stage program to upgrade to ROT-13.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241554">

			<div class="comment by-vicky ">

				<p class="commentcredit">

					<span class="commenter">Vicky</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241554">
						February 18, 2015 9:52 AM					</a>

				</p>

				<p>Audit Me, I heard it was better to apply ROT-13 twice for double the security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241555">

			<div class="comment by-zedarth ">

				<p class="commentcredit">

					<span class="commenter">Zedarth</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241555">
						February 18, 2015 10:23 AM					</a>

				</p>

				<p>At the risk of a flame war I am curious as to the plausibility of actually decrypting the data posited by the IRS.</p>
<p>The article that Bruce links is showing an example of cryptanalysis allowing someone to see underlying patterns across a large swath of data, but how is that relevant to common text based files vs images where there are potentially large patches of repeating blocks&#8211; more to the point&#8211; if I encrypted a small file using the specs outlined above, what would be the realistic level of effort for anyone to decrypt it and actually read the data. How big would the file need to be before cryptanalysis would become possible, also given the fact that every file may use its own key.</p>
<p>I&#8217;m not trying to be ignorant, just inquisitive!</p>
<p>I would think this would be relevant to understand before comparing it to ROT13 or DES&#8211; and also understanding the nature of the files IRS is receiving and how large they are.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241556">

			<div class="comment by-4028uf298u ">

				<p class="commentcredit">

					<span class="commenter">4028uf298u</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241556">
						February 18, 2015 11:04 AM					</a>

				</p>

				<p>They also don&#8217;t correlate data when processing taxes. This is why organizations and businesses in America can &#8216;burn books&#8217; so easily..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241557">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241557">
						February 18, 2015 11:29 AM					</a>

				</p>

				<p>ECB mode? And with no initialization vector? WHAT!?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241558">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241558">
						February 18, 2015 11:52 AM					</a>

				</p>

				<p>Really ? Sounds like a seriously backward system to me.</p>
<p>Over here, indviduals nowadays use an on-line system called &#8220;Tax-on-Web&#8221; for filing personal income tax returns. We authenticate using a card reader with chip (and pincode) embedded in our eID identity cards. There&#8217;s even a Firefox add-on for it. For businesses, there is BizTax. Many e-government sites and portals such as My.belgium.be and <a href="http://www.policeonweb.belgium.be" rel="nofollow ugc">http://www.policeonweb.belgium.be</a> use the same mechanism for access and encryption. For those interested, check out <a href="" target="_blank" rel="noopener noreferrer nofollow ugc">http://eid.belgium.be/en/</a>.</p>
<p>I guess the USG is more interested in penetrating and cracking what others are doing than securing the critical infrastructures of their own country.</p>
<p>@ Audit Me</p>
<p><i>NSA sent over a crack tiger team and they&#8217;re writing an RFI for a sole-source classified MIPR to Booz Allen, FFP $483.69M for a four-stage program to upgrade to ROT-13.</i></p>
<p>+1</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241559">

			<div class="comment by-david-leppik ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.leppik.net/david/blog/' rel='external nofollow ugc' class='url'>David Leppik</a></span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241559">
						February 18, 2015 12:00 PM					</a>

				</p>

				<p>@Zedarth:  I&#8217;m not a cryptographer, I&#8217;m a developer who takes security seriously.  And even if you posit that the keys don&#8217;t get reused and are for short messages, there are several things going on here that make me wince.</p>
<p>Think of these as my heuristics for people who are serious about security but aren&#8217;t cryptographers.</p>
<ol>
<li>  Security fails due to slip-ups.  If you have to think about doing it right, the procedures are wrong.  Therefore there are good algorithms and bad algorithms, and you don&#8217;t want to have to think about the latter.  You don&#8217;t even want bad algorithms on your computers.  (See:  the NSA sneaking a bad random number generator into RSA Inc.&#8217;s software libraries, so an attack could look like a configuration error.)
</li>
<li>  Information leakage, however trivial it may seem to you, can often be leveraged by an attacker.  If you can avoid leaking it, don&#8217;t leak it.  That&#8217;s especially true for an encryption algorithm, which isn&#8217;t supposed to leak anything.
</li>
<li>  Suggesting a bad algorithm, when better ones exist, suggests that the author of the document doesn&#8217;t know that it&#8217;s a bad algorithm&#8211; and probably doesn&#8217;t know a lot about the equally important, mundane details of security.  (I.e. my points #1 and #2.)  So the document almost certainly has security as a check-list item, rather than a thought-through requirement.
</li>
</ol>
<p>In this case, choosing an algorithm that&#8217;s over a decade out of date means somebody copied the security procedure from some other long out-of-date procedure, rather than look at what might be reasonable in the 21st century.  So there&#8217;s no need to look at the rest of the document to know that the security stinks.</p>
<p>What it comes down to is that real-world security, as practiced by software developers, managers, and front-line staff (e.g. security guards, call center agents), is about gut feelings.  If something seems wrong, there&#8217;s a good chance it is wrong&#8211; not because that particular thing is bad, but because something has changed for apparently no good reason.  And if you have to think about whether something is dangerous or just unusual, you&#8217;re in the realm of having to outsmart a potentially smarter opponent.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241560">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241560">
						February 18, 2015 12:24 PM					</a>

				</p>

				<p>I seem to remember the IRS and FBI have been trying to upgrade/migrate their computer systems for at least a decade to the tune of 100s of millions. Still haven&#8217;t finished. They are still running COBOL and windows 98 on some.<br />
COBOL is in a lot more places than you would guess. I have seen a functioning 100 year old fire alert system, gamewell so I half expect to see an Amiga OS on a Motorola 68000 chip&#8230; ð</p>
<p>Hanlon&#8217;s razor.<br />
ââNever attribute to malice that which can be adequately explained by stupidity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241561">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241561">
						February 18, 2015 1:10 PM					</a>

				</p>

				<p>This is why I am leaning away from the idea of traditional ciphers in computing: don&#8217;t give a choice because people will make the wrong one. With stream ciphers, reusing an IV has disasterous results, and with a block cipher, handling padding incorrectly or choosing the wrong mode of operation can be dangerous, and with any cipher not using an MAC can be dangerous.</p>
<p>I wrote a proof of concept block cipher recently; the idea is that it&#8217;s designed to be an efficient block cipher that encrypts every block differently &#8211; padding is defined by the algorithm, a message authentication code is automatically appended to the output and checked, and there is no choice of modes of oepration. Because there is no chaining as with CFB and CBC modes, there is no way that a malicious user could force a specific bit or set of bits to flip (as long as the cipher itself is secure, which is beyond the scope of my proof of concept).</p>
<p>An IV is still required; I haven&#8217;t found a way around that, but reusing an IV is less bad with this than reusing an IV with a stream cipher and less than or equal to as bad as reusing an IV with a traditional block cipher. With a reused IV, it gives away whether or not two blocks at the same position in two different messages have the same value, but nothing else.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241562">

			<div class="comment by-grumpy ">

				<p class="commentcredit">

					<span class="commenter">Grumpy</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241562">
						February 18, 2015 1:30 PM					</a>

				</p>

				<p>In the minds of children, college students, and many academics, important technical decisions are made by the experts, the folks who really know what they are doing.</p>
<p>The real world is quite different.  The folks who are technically incompetent (utterly clueless) are foisted off on all the meetings.  They&#8217;re seen.  They&#8217;re the ones who get promoted.  Add this to a top-heavy hierarchy, where most of the staff is &#8220;managing&#8221; the very few people at the bottom who are working their asses off.  And then play the old &#8220;telephone&#8221; game where directives are passed up and down the hierarchy, with little out-of-band information or details to go on other than &#8220;we need security&#8221; or &#8220;no you don&#8217;t get a budget increase for adding security&#8221;.  Oh, and remember that anybody even remotely competent at the bottom is aggressively searching for a better job and just doing the minimum they need to get by.  And that it&#8217;s just basically a &#8220;we have security&#8221; checkbox for the sales team where nobody discovers how worthless your security is until after their check has cleared.</p>
<p>It&#8217;s a recipe for disaster, and I&#8217;ve seen it many a time.  My favorite was the guys who said their password file was encrypted.  Later I found out this meant they XOR&#8217;ed every byte in the file with the same 8-bit value.  And most of that data was NULLs (zeros).  Rot13 would have been an upgrade!</p>
<p>The other side of this is politics.  All those folks doing the managing are playing political turf wars with each other to advance their careers.  So there&#8217;s intentional sabotage as well as accidental.  Or lip service being paid to intentions while the letter of the requirements is fulfilled.</p>
<p>Consider too how many graduating students want to go work for Google, Apple, Microsoft, etc vs how many want to work for the IRS.  What is the caliber, the technical proficiency, of their employees?</p>
<p>I don&#8217;t think this is deliberate, or involves the NSA or anything.  It&#8217;s more the level of incompetence that I&#8217;ve come to expect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241563">

			<div class="comment by-thomas ">

				<p class="commentcredit">

					<span class="commenter">Thomas</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241563">
						February 18, 2015 1:31 PM					</a>

				</p>

				<p>&#8220;IRS recommended settings should be used to maintain compatibility: &#8221;</p>
<p>All these good compatibility recommendations, and then they leave the end-user to choose their own keys rather than standardise those as well.</p>
<p>Typical sloppy government work, as it leaves the possibility not only of incompatibility, but also insecurity due to &#8220;Weak keys&#8221;: <a href="http://downlode.org/Etext/alicebob.html" rel="nofollow ugc">http://downlode.org/Etext/alicebob.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241564">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241564">
						February 18, 2015 2:56 PM					</a>

				</p>

				<p>Thinking about it, in the past I&#8217;ve worked with APIs in the past for sending sensitive XML-encoded data to banks and various vendors, and they came up with a couple novel solutions:</p>
<p>1) Create a TLS connection and send using a SOAP API. In some cases, this also made use of client certificates, in others a static API key.<br />
2) Send PGP files over FTP</p>
<p>Okay, maybe not novel, but they seemed to work without any compatibility issues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241565">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info/pgp/askg.txt' rel='external nofollow ugc' class='url'>Thoth</a></span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241565">
						February 18, 2015 6:17 PM					</a>

				</p>

				<p>I am guessing ECB mode is used for the sake of simplicity so that code cutters and security contractors writing codes don&#8217;t need to meddle with anything more complex. Of course it is a bad excuse and a very bad one. Their goals are to simply complete security audit requirements and not to actually promote security anyway so I am not surprised they are not bothered to do any clean and good crypto. This is a good example how to fail crypto compliance audit.</p>
<p>What they should have done is to follow the standard PGP/GPG style as it has been well tested and deployed rather than creating their own standards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241566">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241566">
						February 18, 2015 6:47 PM					</a>

				</p>

				<p>@ Thoth, Bruce</p>
<p>Might just be easier for their COBOL guys to implement. Haha.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241567">

			<div class="comment by-paul-coddington ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://paulcoddington.info' rel='external nofollow ugc' class='url'>Paul Coddington</a></span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241567">
						February 18, 2015 8:18 PM					</a>

				</p>

				<p>Could be much worse. I once attended a meeting at a big government department where the entrenched developers (who despised us know-nothing temporary contractors) came to the conclusion that the department must implement its own encryption algorithms for Internet communications, because all the others in common use were widely known, had source code publically available and were therefore completely insecure.</p>
<p>Luckily, people who think like this end up in non-critical areas, such as designing systems for monitoring border security (I wish I were kidding).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241568">

			<div class="comment by-tyr ">

				<p class="commentcredit">

					<span class="commenter">tyr</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241568">
						February 18, 2015 8:38 PM					</a>

				</p>

				<dl>
<dt>Let me make a guess. Most of their traffic is</dt>
<dt>standardized forms with the blanks filled in.</dt>
<dd>
^ )
</dd>
</dl>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241569">

			<div class="comment by-jonathan-rosenne ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Rosenne</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241569">
						February 19, 2015 1:06 AM					</a>

				</p>

				<p>ECB demo:</p>
<p><a href="https://bobnalice.wordpress.com/2009/01/28/friends-don%E2%80%99t-let-friends-use-ecb-mode-encryption/" rel="nofollow ugc">https://bobnalice.wordpress.com/2009/01/28/friends-don%E2%80%99t-let-friends-use-ecb-mode-encryption/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241570">

			<div class="comment by-victor ">

				<p class="commentcredit">

					<span class="commenter">Victor</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241570">
						February 19, 2015 2:02 AM					</a>

				</p>

				<p>I guess somebody over there panicked (or the site blocks UK IP addresses). All I get at the &#8220;rules for encryption&#8221; link is &#8220;This article doesn&#8217;t have a translation for English&#8221; (which is their default 404 page, it seems) and no link to any translations.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241571">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241571">
						February 19, 2015 2:16 AM					</a>

				</p>

				<p>Click on link under &#8220;documents&#8221; and then click on &#8220;Step 3 Encrypt the XML&#8230;&#8221;</p>
<p>&#8230;this will work</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241572">

			<div class="comment by-alain ">

				<p class="commentcredit">

					<span class="commenter">Alain</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241572">
						February 19, 2015 3:23 AM					</a>

				</p>

				<p>@Dirk Praet</p>
<p>The Belgian &#8221; eID identity card&#8221; is a security and privacy disaster, everything is easy readable when you put an e-id in a reader, including a certificate, the photo of the user and the national nr of the user.  There&#8217;s no security for the data on the card (except maybe a check for genuine cads).</p>
<p>So anytime you put you&#8217;re eID in a reader, the owner of the reader has all that info.</p>
<p>Oh yeah, the certificate uses you&#8217;re national nr open and clear.  With the default software it&#8217;s by default installed on the computer, this is more user friendly.</p>
<p>My advice is : <b>Never, really never,</b> use the eID except when forced to by cops.  And then I would ask their ID first.</p>
<p>BTW. The Belgian taxes allow another way of identity check, which is simple (a printed pad with 20 codes + username + password) and given the low use of the application more secure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241573">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241573">
						February 19, 2015 4:01 AM					</a>

				</p>

				<blockquote><p>
  At the risk of a flame war I am curious as to the plausibility of actually decrypting the data posited by the IRS.
</p></blockquote>
<p>My feelings as well. If someone really wants some person&#8217;s tax records badly enough then they&#8217;ll blackmail/bribe/whatever one of the X million IRS employees to get them, not carry out some large-scale wiretap, capturing all IRS traffic, and then looking for patterns in the ECB-mode data and trying to figure out what they represent.  Sure, it&#8217;s awful encryption, but it&#8217;s nowhere near the weakest link in the chain.  If no-one&#8217;s going to bother attacking your encryption then it doesn&#8217;t matter whether you use AES-256-GCM, AES-128-ECB, or RC4-40, it&#8217;ll be all the same to an attacker.</p>
<p>(There&#8217;s a pity quote in there somewhere, just can&#8217;t think of it at the moment. Bruce?).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241574">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241574">
						February 19, 2015 5:44 AM					</a>

				</p>

				<p>It&#8217;s not as bad as one third party card payment company I once worked with. They supplied my client with a key which was to be kept private and used to VigenÃ¨re-encrypt some transaction data; this would then be sent via a form submission on the end user&#8217;s browser to the payment company, making the end user a man in the middle who could easily extract the key. The payment company would presumably then have blamed my client for not protecting they key well enough.</p>
<p>When I kicked up a fuss, they turned out &#8220;by coincidence&#8221; to be working on an AES-based system, whose deployment they &#8220;accelerated&#8221; for me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241575">

			<div class="comment by-eliot-spitzer-in-socks ">

				<p class="commentcredit">

					<span class="commenter">Eliot Spitzer in socks</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241575">
						February 19, 2015 10:04 AM					</a>

				</p>

				<p>Dave, re &#8220;If someone really wants some person&#8217;s tax records.&#8221; We&#8217;re not talking about someone, we&#8217;re talking about NSA, which is already carrying out a large-scale wiretap, capturing all IRS traffic. Direct surveillance and parallel construction bypass legal restraints on explicit inter-agency cooperation. It lets you investigate the man and not the crime.</p>
<p>Rule by secret decree after 9/11 institutionalized the Huston Plan for domestic surveillance. IRS is actively complicit with intelligence agencies&#8217; domestic operations &#8211; Why do you think David Cohen went to CIA? Pretend encryption just is the most effectively way to help the spies.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241576">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241576">
						February 19, 2015 10:49 AM					</a>

				</p>

				<p>Can&#8217;t wait for squid post, this is too nuts:</p>
<p><a href="http://arstechnica.com/security/2015/02/lenovo-pcs-ship-with-man-in-the-middle-adware-that-breaks-https-connections/" rel="nofollow ugc">http://arstechnica.com/security/2015/02/lenovo-pcs-ship-with-man-in-the-middle-adware-that-breaks-https-connections/</a></p>
<p>Some adware company called Superfish Inc. got Lenovo to bundle their adware with new machines.  It installs a self-signed root certificate and MITMs your SSL connections.</p>
<p>I used to roll my eyes at the guys who clean out all the pre-installed root certs and only whitelist specific certs themselves, but this kind of crap certainly justifies their level of paranoia.  I wonder if Lenovo will be sued for this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241577">

			<div class="comment by-mesrik ">

				<p class="commentcredit">

					<span class="commenter">mesrik</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241577">
						February 19, 2015 12:30 PM					</a>

				</p>

				<p>@Clive</p>
<p><i>&#8220;Any body remember why Swift ended up moving to Switzerland?&#8221;</i></p>
<p>Hmm&#8230; AFAIK, <a href="http://en.wikipedia.org/wiki/Society_for_Worldwide_Interbank_Financial_Telecommunication" rel="nofollow ugc">SWIFT</a> HQ is located in La Hulpe, Belgium.</p>
<p>I think it&#8217;s Switzerland&#8217;s significant role in banking industry and because SWIFT starts with an S that many (wrongly) conclude it&#8217;s Swiss &#8230; something. But really it&#8217;s not, it&#8217;s <b>Society for Worldwide Interbank Financial Telecommunication</b> that the abreviation comes from.</p>
<p>Cheers,</p>
<p>ð riku</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241578">

			<div class="comment by-sabu ">

				<p class="commentcredit">

					<span class="commenter">sabu</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241578">
						February 19, 2015 3:13 PM					</a>

				</p>

				<p>&#8220;moving the key across operating systems can affect the key size.&#8221;</p>
<p>Sure it can. Why, just the other day I copied my 256-bit key to a Linux machine and found that it was now 192 bits.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241579">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241579">
						February 19, 2015 4:08 PM					</a>

				</p>

				<p>@Eliot Spitzer: Given that the NSA is one branch of the USG and the IRS is another, I suspect if some part of the USG (whether it&#8217;s the NSA, FBI, DHS, or whatever) wants access to IRS records they won&#8217;t need to resort to traffic-interception to get them. Even if they want to get them surreptitiously, I&#8217;m sure they have easier means than going for encrypted traffic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241580">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241580">
						February 19, 2015 4:09 PM					</a>

				</p>

				<p>@sabu: Here&#8217;s your answer:</p>
<p><a href="http://en.wikipedia.org/wiki/Shrinkage_%28accounting%29" rel="nofollow ugc">http://en.wikipedia.org/wiki/Shrinkage_%28accounting%29</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241581">

			<div class="comment by-eliot-spitzers-black-socks ">

				<p class="commentcredit">

					<span class="commenter">Eliot Spitzer&#039;s black socks</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241581">
						February 19, 2015 5:54 PM					</a>

				</p>

				<p>Dave, they have it anyway, since they Collect It All. Why go all the way to Federal Triangle when it&#8217;s at your fingertips? Much of it doesn&#8217;t even have to be encrypted. For a long time IRS did not bother with encryption because&#8230; their protocols were so obsolete that nobody understood them anymore. No really. More importantly, when you ask for it, that might generate a paper trail. Or somebody might want to run it by the counsel&#8217;s office. When you&#8217;re <a href="http://whowhatwhy.org/2014/01/16/transcript-another-nsa-whistleblower-russell-tice/" rel="nofollow ugc">breaking the law</a> spying on State Senator Obama, or Chief Justice Alito, or Colin Powell, or General Petraeus, or journalists, bankers, attorneys, and all the other people NSA spies on and blackmails, it&#8217;s crazy not to use what you already stole.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241582">

			<div class="comment by-vincent ">

				<p class="commentcredit">

					<span class="commenter">Vincent</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241582">
						February 20, 2015 3:21 PM					</a>

				</p>

				<p>Looks like someone tinkered with the available settings until some rather limited test case succeeded.</p>
<p>Worrying about changing key size when &#8220;moving the key across operating systems&#8221; on the one hand and disregarding encoding on the other hand is pretty much giving away one simple explanation: Whoever wrote that specification is completely clueless whey those annoying settings are there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241583">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241583">
						February 20, 2015 4:22 PM					</a>

				</p>

				<p>So, the IDES is an IRS electronic delivery point so FIs and HCTAs can transmit FACTA data within the USA, using AES in ECB mode with no IV and PKCS#7 or PKCS#5 padding?</p>
<p>The government must have a special acronym agency (SAA) just to keep track of all that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241584">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241584">
						February 21, 2015 5:01 PM					</a>

				</p>

				<p>@Dave</p>
<p>I tend to agree that it&#8217;s probably not that big of a deal; considering the data is compressed first, it&#8217;s unlikely to even have patterns, especially those that are exploitable. However, this is cryptography 101; the fact that they rolled their own and didn&#8217;t follow even basic rules is facepalm worthy. They could have simply used PGP and would have had no issues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241585">

			<div class="comment by-michael ">

				<p class="commentcredit">

					<span class="commenter">Michael</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241585">
						February 22, 2015 10:19 PM					</a>

				</p>

				<p>Could we consider another explanation? The purpose of this particular system is for non-US institutions to make reports. Encrytion tools much stronger than this are likely going to exceed the standards of US export control laws. The IRS isn&#8217;t allowed to ignore those laws. Thus, the agency must presume that the foreign institutions are not going to have access to anything better. (Insert eye roll here.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241586">

			<div class="comment by-nathanael ">

				<p class="commentcredit">

					<span class="commenter">Nathanael</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241586">
						February 23, 2015 12:48 PM					</a>

				</p>

				<p>&#8220;I guess the USG is more interested in penetrating and cracking what others are doing than securing the critical infrastructures of their own country.&#8221;</p>
<p>Yes.</p>
<p>When done by the IRS, this is merely incompetence.</p>
<p>When done by people at the NSA, CIA, DOD, and DHS, who are supposed to be securing the critical infrastructure of the country,&#8230; it&#8217;s treason.</p>
<p>There&#8217;s only one US government agency I  know of which is actually helping secure the nation&#8217;s critical infrastructure.  It&#8217;s the EPA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241587">

			<div class="comment by-nathan ">

				<p class="commentcredit">

					<span class="commenter">Nathan</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241587">
						February 25, 2015 12:24 PM					</a>

				</p>

				<p>I can SORT OF understand the &#8220;moving the key across operating systems&#8221; thing if they&#8217;re directly using a file as a key, and that might be affected by endline issues on MS Wordpad versus saner OSes.  Now, if they&#8217;re doing that with no ASCII armoring, base64, etc, they&#8217;re just plain stupid.</p>
<p>As for this being some kind of NSA backdoor, generally their backdoors aren&#8217;t totally obvious to anyone who reads the standard after doing a master&#8217;s in CS.  I&#8217;d expect something more like a &#8220;convenient&#8221; encryption library that leaks data, or uses a given set of 2^45 keys, or, well, anything that can&#8217;t be uncovered by skimming the first page of a Google search on &#8220;electronic code book&#8221;.</p>
<p>The flip side is that WE know that 256 bit AES is undermined by having too few rounds, and I don&#8217;t think it&#8217;s totally implausible that the NSA knows some way to leverage that in combination with using basically the worst possible settings for the cypher.  No IV might be handy if they&#8217;re pre-computing some huge structure for use in the attack (which also has the advantage that it would be impossible for Joe Hacker looking for credit cards to save said structure).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241588">

			<div class="comment by-stefan ">

				<p class="commentcredit">

					<span class="commenter">Stefan</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241588">
						February 26, 2015 5:12 AM					</a>

				</p>

				<p>The IRS IDES user guide at the irs.gov (<a href="http://www.irs.gov/pub/fatca/p5190idesuserguide.pdf" rel="nofollow ugc">http://www.irs.gov/pub/fatca/p5190idesuserguide.pdf</a> , p.89) references NIST sp800-38a.</p>
<p>In the definitions section (p.3) it says:<br />
&#8220;The confidentiality modes in this recommendation are the ECB, CBC, CFB, OFB, and CTR modes.&#8221;<br />
Some non-crypto-familiar clerk might just pick the first one, without knowing about the implications.</p>
<p>Further, the statement in the ECB section (sec. 6.1, p.9 et seq.)is:<br />
&#8220;In the ECB mode, under a given key, any given plaintext block always gets encrypted to the same ciphertext block. If this property is undesirable in a particular application, the ECB mode should not be used.&#8221;<br />
Maybe someone finds this desireable&#8230;. ð</p>
<p>Anyway, it seems that someone is just following recommendations without basic knowledge on the topic. Even if the consequences are probably neglectable, I don&#8217;t think that&#8217;s the right approach to security topics.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241589">

			<div class="comment by-notme ">

				<p class="commentcredit">

					<span class="commenter">NotMe</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241589">
						February 26, 2015 1:24 PM					</a>

				</p>

				<p>I don&#8217;t understand why people are balking over no IV. How would that be used in ECB anyway?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241592">

			<div class="comment by-seniorexpat ">

				<p class="commentcredit">

					<span class="commenter">Seniorexpat</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241592">
						March 16, 2015 2:44 AM					</a>

				</p>

				<p>@ mesrik<br />
@ clive</p>
<p>Here is documention of the claim about SWIFT:<br />
&#8220;SWIFT will open a new server in Switzerland for inner-European transactions in September, which would exclude US authorities from accessing these&#8221;, <a href="http://history.edri.org/edri-gram/number7.15/new-swift-problems-us-eu" rel="nofollow ugc">2009 </a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241593">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241593">
						March 16, 2015 3:42 AM					</a>

				</p>

				<p>@ Seniorexpat, mesrik,</p>
<blockquote><p>Here is documention of the claim about SWIFT:</p></blockquote>
<p>You might also wish to read the view of the person who brought the scandle to the fore,</p>
<p><a href="http://www.privacysurgeon.org/blog/incision/campaign-notebook-2006-the-us-bank-data-scandal-and-the-great-uncle-of-prism/" rel="nofollow ugc">http://www.privacysurgeon.org/blog/incision/campaign-notebook-2006-the-us-bank-data-scandal-and-the-great-uncle-of-prism/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241594">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">jon</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241594">
						July 9, 2015 4:41 PM					</a>

				</p>

				<p>I thought salt was used for hashing. Can someone explain how to use salt with encryption?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241595">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241595">
						July 10, 2015 12:56 AM					</a>

				</p>

				<p>@jon,</p>
<p>Unfortunately &#8220;salt&#8221; and &#8220;IV&#8221; are sometimes used interchangeably. Sometimes the term &#8220;nonce&#8221; is used instead of the word &#8220;salt&#8221; as well. Salt applies to hashing, IV applies to both encryption and bashing [1], and nonce applies, among other uses, to some modes such as CCM.</p>
<p>And ECB is weak (as clear from the X-rated picture of Tux &#8212; X-rated means you can see through) but does have its uses, such as when the clear text is not more than one or two blocks, and the use of an IV is &#8220;less convenient&#8221;. But generally speaking, ECB should be avoided.</p>
<p>Another possible answer is when you lump hashing and encryption under &#8220;cryptographic operations&#8221; then IV and salt can apply to the &#8220;operation&#8221;.</p>
<p>[1] IV for encryption stands for Initialization Vector, IV used in hashing stands for Initial Hash Value.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241596">

			<div class="comment by-asus-guy ">

				<p class="commentcredit">

					<span class="commenter">Asus guy</span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241596">
						July 22, 2015 8:02 AM					</a>

				</p>

				<p>It&#8217;s even worse than encouraging poor cryptography. <a HREF="https://web.archive.org/web/20150715233849/http://www.irs.gov/Businesses/Corporations/FATCA-IDES-Technical-FAQs#TransmissionD13" rel="nofollow ugc">Now the IRS is encouraging no cryptography whatsoever</a>:</p>
<blockquote><p>D13. I uploaded a FATCA Report to IDES 3 days ago and have not received a notification about the status of my FATCA Report. Does the XML format cause a problem?</p>
<p>The IRS has identified a specific scenario where notifications are not issued to filers when certain errors are present. A possible cause for a missing notification is XML that is not formatted and is contained on one continuous line. In this scenario, <strong>you can reformat the XML into an acceptable format using a variety of online tools, such as XML Pretty Print</strong>. The correctly formatted version of the XML can be resubmitted in a new data packet.</p></blockquote>
<p>The IRS are recommending that IDES users (i.e. banks &amp; governments trying to submit private taxpayer data to the IRS) use some random website to reformat the XML files containing that data prior to submission.</p>
<p>The IRS didn&#8217;t even bother trying to find a website which does the reformatting on the client side using Javascript; that one happily POSTs the XML you paste into the form over to the server, without SSL either (no doubt because the poor guy who put that website up as a weekend project never expected a tax agency would tell banks to use it for confidential data.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241597">

			<div class="comment by-tax-payer ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://content.govdelivery.com/accounts/USIRS/bulletins/13fe1c6' rel='external nofollow ugc' class='url'>Tax Payer</a></span> â¢

					<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/#comment-241597">
						May 23, 2016 2:21 PM					</a>

				</p>

				<p>No comment is necessary or sufficient:</p>
<p><a href="https://content.govdelivery.com/accounts/USIRS/bulletins/13fe1c6" rel="nofollow ugc">https://content.govdelivery.com/accounts/USIRS/bulletins/13fe1c6</a></p>
<p>&#8220;The Internal Revenue Service (IRS) maintains a high standard of confidentiality and continuously evaluates security protocols related to information technology. <strong>During a routine review</strong>, the IRS decided to update the cipher mode used for encryption from Electronic Code Book (ECB) to Cipher Block Chaining (CBC). The CBC cipher is a stronger algorithm for encrypting data that can be implemented in code or by your software of choice.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2015/02/irs_encourages_.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F02%2Firs_encourages_.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2015/02/irs_encourages_.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='6777' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html" rel="prev">â The Equation Group&#039;s Sophisticated Hacking and Exploitation Tools</a>		<a href="https://www.schneier.com/blog/archives/2015/02/the_obsolescenc.html" rel="next">The Obsolescence of Submarines â</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
