<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>The Equation Group&#039;s Sophisticated Hacking and Exploitation Tools - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; The Equation Group&#039;s Sophisticated Hacking and Exploitation Tools Comments Feed" href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/6779" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=6779' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F02%2Fthe_equation_gr.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F02%2Fthe_equation_gr.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-6779 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-6779" class="post-6779 post type-post status-publish format-standard hentry category-uncategorized tag-edward-snowden tag-essays tag-exploits tag-hacking tag-implants tag-kaspersky tag-nsa tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">The Equation Group&#039;s Sophisticated Hacking and Exploitation Tools</h2>
		<p>This week, Kaspersky Labs published <a href="https://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/">detailed</a> <a href="https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf">information</a> on what it calls the Equation Group &#8212; almost certainly the NSA &#8212; and its abilities to embed spyware deep inside computers, gaining pretty much total control of those computers while maintaining persistence in the face of reboots, operating system reinstalls, and commercial anti-virus products. The details are impressive, and I urge anyone interested to read the Kaspersky documents, or this <a href="http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/">very detailed article</a> from Ars Technica.</p>
<p>Kaspersky doesn&#8217;t explicitly name the NSA, but talks about similarities between these techniques and Stuxnet, and points to NSA-like codenames. A related <a href="http://www.reuters.com/article/2015/02/16/us-usa-cyberspying-idUSKBN0LK1QV20150216">Reuters story</a> provides more confirmation: &#8220;A former NSA employee told Reuters that Kaspersky&#8217;s analysis was correct, and that people still in the intelligence agency valued these spying programs as highly as Stuxnet. Another former intelligence operative confirmed that the NSA had developed the prized technique of concealing spyware in hard drives, but said he did not know which spy efforts relied on it.&#8221;</p>
<p>In some ways, this isn&#8217;t news. We saw examples of these techniques in 2013, when <i>Der Spiegel</i> <a href="http://www.spiegel.de/international/world/catalog-reveals-nsa-has-back-doors-for-numerous-devices-a-940994.html">published</a> details of the NSA&#8217;s 2008 <a href="http://leaksource.info/2013/12/30/nsas-ant-division-catalog-of-exploits-for-nearly-every-major-software-hardware-firmware/">catalog</a> of implants. (Aside: I <a href="https://www.schneier.com/blog/archives/2014/08/the_us_intellig.html">don&#8217;t believe</a> the person who leaked that catalog is Edward Snowden.) In those pages, we saw examples of malware that embedded itself in computers&#8217; BIOS and disk drive firmware. We already know about the NSA&#8217;s infection methods using <a href="http://www.wired.com/2013/11/this-is-how-the-internet-backbone-has-been-turned-into-a-weapon/">packet injection</a> and <a href="http://arstechnica.com/tech-policy/2014/05/photos-of-an-nsa-upgrade-factory-show-cisco-router-getting-implant/">hardware interception</a>.</p>
<p>This is targeted surveillance. There&#8217;s nothing here that implies the NSA is doing this sort of thing to <i>every</i> computer, router, or hard drive. It&#8217;s doing it only to networks it wants to monitor. Reuters again: &#8220;Kaspersky said it found personal computers in 30 countries infected with one or more of the spying programs, with the most infections seen in Iran, followed by Russia, Pakistan, Afghanistan, China, Mali, Syria, Yemen and Algeria. The targets included government and military institutions, telecommunication companies, banks, energy companies, nuclear researchers, media, and Islamic activists, Kaspersky said.&#8221; A <a href="http://graphics.thomsonreuters.com/15/02/CYBERSECURITY-USA.jpg">map</a> of the infections Kaspersky found bears this out.</p>
<p>On one hand, it&#8217;s the sort of thing we <i>want</i> the NSA to do. It&#8217;s targeted. It&#8217;s exploiting existing vulnerabilities. In the overall scheme of things, this is <a href="http://www.wired.com/2013/01/wiretap-backdoors/">much</a> <a href="http://papers.ssrn.com/sol3/papers.cfm?abstract_id=2312107">less</a> disruptive to Internet security than deliberately inserting vulnerabilities that leave everyone insecure.</p>
<p>On the other hand, the NSA&#8217;s definition of &#8220;targeted&#8221; can be pretty broad. We know that it&#8217;s hacked the <a href="https://firstlook.org/theintercept/2014/11/24/secret-regin-malware-belgacom-nsa-gchq/">Belgian telephone company</a> and the <a href="http://www.theguardian.com/world/2013/sep/09/nsa-spying-brazil-oil-petrobras">Brazilian oil company</a>. We know it&#8217;s collected every phone call in <a href="https://firstlook.org/theintercept/2014/05/19/data-pirates-caribbean-nsa-recording-every-cell-phone-call-bahamas/">the Bahamas</a> and <a href="https://wikileaks.org/WikiLeaks-statement-on-the-mass.html">Afghanistan</a>. It hacks <a href="https://firstlook.org/theintercept/2014/03/20/inside-nsa-secret-efforts-hunt-hack-system-administrators/">system administrators</a> worldwide.</p>
<p>On the other other hand &#8212; can I even have three hands? &#8212; I remember a line from my <a href="https://www.schneier.com/book-dg.html">latest book</a>: &#8220;Today&#8217;s top-secret programs become tomorrow&#8217;s PhD theses and the next day&#8217;s hacker tools.&#8221; Today, the Equation Group <a href="http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/">is</a> &#8220;probably the most sophisticated computer attack group in the world,&#8221; but these techniques aren&#8217;t magically exclusive to the NSA. We know China uses similar techniques. Companies like Gamma Group sell less sophisticated versions of the <a href="https://citizenlab.org/2012/07/from-bahrain-with-love-finfishers-spy-kit-exposed/">same</a> <a href="https://citizenlab.org/2013/03/you-only-click-twice-finfishers-global-proliferation-2/">things</a> to Third World governments worldwide. We need to figure out how to maintain security in the face of these sorts of attacks, because we&#8217;re all going to be subjected to the criminal versions of them in three to five years.</p>
<p>That&#8217;s the real problem. Steve Bellovin <a href="https://www.cs.columbia.edu/~smb/blog/2015-02/2015-02-16.html">wrote</a> about this:</p>
<blockquote><p>For more than 50 years, all computer security has been based on the separation between the trusted portion and the untrusted portion of the system. Once it was &#8220;kernel&#8221; (or &#8220;supervisor&#8221;) versus &#8220;user&#8221; mode, on a single computer. The <a href="http://csrc.nist.gov/publications/history/dod85.pdf">Orange Book</a> recognized that the concept had to be broader, since there were all sorts of files executed or relied on by privileged portions of the system. Their newer, larger category was dubbed the &#8220;Trusted Computing Base&#8221; (TCB). When networking came along, we adopted firewalls; the TCB still existed on single computers, but we trusted &#8220;inside&#8221; computers and networks more than external ones.</p>
<p>There was a danger sign there, though few people recognized it: our networked systems depended on other systems for critical files&#8230;.</p>
<p>The National Academies report <a href="http://books.nap.edu/catalog/6161/trust-in-cyberspace">Trust in Cyberspace</a> recognized that the old TCB concept no longer made sense. (Disclaimer: I was on the committee.) Too many threats, such as Word macro viruses, lived purely at user level. Obviously, one could have arbitrarily classified word processors, spreadsheets, etc., as part of the TCB, but that would have been worse than useless; these things were too large and had no need for privileges.</p>
<p>In the 15+ years since then, no satisfactory replacement for the TCB model has been proposed.</p></blockquote>
<p>We have a serious computer security problem. Everything depends on everything else, and security vulnerabilities in anything affects the security of everything. We simply don&#8217;t have the ability to maintain security in a world where we can&#8217;t trust the hardware and software we use.</p>
<p>This article was <a href="http://www.lawfareblog.com/2015/02/the-equation-groups-sophisticated-hacking-and-exploitation-tools/">originally published</a> at the Lawfare blog.</p>
<p>EDITED TO ADD (2/17): Slashdot <a href="http://yro.slashdot.org/story/15/02/16/2031248/how-omnipotent-hackers-tied-to-nsa-hid-for-14-years-and-were-found-at-last">thread</a>. Hacker News <a href="https://news.ycombinator.com/item?id=9059156">thread</a>. Reddit <a href="https://www.reddit.com/r/news/comments/2w5h0h/equation_group_the_crown_creator_of_cyberespionage/">thread</a>. BoingBoing <a href="http://bbs.boingboing.net/t/nsa-has-ability-to-embed-spying-software-in-computer-hard-drives-including-yours/52022/17">discussion</a>.</p>
<p>EDITED TO ADD (2/18): Here <a href="https://www.ibr.cs.tu-bs.de/users/kurmus/papers/acsac13.pdf">are</a> <a href="http://spritesmods.com/?art=hddhack&#038;page=1">are</a> two academic/hacker presentations on exploiting hard drives. And <a href="http://www.wired.com/2015/02/kapersky-discovers-equation-group/">another article</a>.</p>
<p>EDITED TO ADD (2/23): Another <a href="http://www.wired.com/2015/02/nsa-firmware-hacking/">excellent article</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/edward-snowden/" rel="tag">Edward Snowden</a>, <a href="https://www.schneier.com/tag/essays/" rel="tag">essays</a>, <a href="https://www.schneier.com/tag/exploits/" rel="tag">exploits</a>, <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/implants/" rel="tag">implants</a>, <a href="https://www.schneier.com/tag/kaspersky/" rel="tag">Kaspersky</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html" rel="bookmark">Posted on February 17, 2015 at 12:19 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html#comments">143 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html" data-title="The Equation Group&#039;s Sophisticated Hacking and Exploitation Tools" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-241777">

			<div class="comment by-chris-brand ">

				<p class="commentcredit">

					<span class="commenter">Chris Brand</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241777">
						February 17, 2015 12:32 PM					</a>

				</p>

				<p>The &#8220;third hand&#8221; is the <a href="http://catb.org/jargon/html/O/on-the-gripping-hand.html" rel="nofollow ugc">gripping hand</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241778">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241778">
						February 17, 2015 12:36 PM					</a>

				</p>

				<p>One thing interesting: Its ALREADY the stuff of Ph.D. theses:  The big innovation is the firmware bootkit (aka IRATEMONK).  There are already multiple implementations of such malcode in proof-of-concept form.</p>
<p>I&#8217;d give over/under of two weeks until we have a demo setup of a malicious drive firmware which is combined with the &#8220;sploit signed driver to (regain) root&#8221; trick to do a full windows trojan install protected with a HDD driver firmware attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241779">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241779">
						February 17, 2015 12:41 PM					</a>

				</p>

				<p>It appears attack by corrupt firmware, hardware and hard drives is the wave of the future for most users and clearly a major threat for some special targets already.</p>
<p>It&#8217;s probably time to start turning over vulnerable hardware every 6 months or so. Somehow you would need a way to regenerate programs and data files without losing too much and still maintain security. Or maybe not. The idea is to replace hardware and drives. Other measures would be necessary to protect files and data.</p>
<p>I am thinking modular construction, everything is an add-on (and removable) from something else. Simply moving stuff around the shop might confuse attackers, somewhat.</p>
<p>Oddly, the goal  many times will be to keep your own government out of your pockets more than some teenybop cracker across he ocean.</p>
<p>Those were the days!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241780">

			<div class="comment by-alext ">

				<p class="commentcredit">

					<span class="commenter">AlexT</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241780">
						February 17, 2015 12:43 PM					</a>

				</p>

				<p>Wonder if there is any hard drive in the market with sealed firmware? If not it will most likely come soon&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241781">

			<div class="comment by-steve37 ">

				<p class="commentcredit">

					<span class="commenter">steve37</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241781">
						February 17, 2015 12:56 PM					</a>

				</p>

				<p>I&#8217;m wondering whether the drive manufacturers will publish a firmware to fix these security holes and whether dvd drives are affected too?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241782">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241782">
						February 17, 2015 12:58 PM					</a>

				</p>

				<p>@Bruce: &#8220;There&#8217;s nothing here that implies the NSA is doing this sort of thing to every computer, router, or hard drive.&#8221;</p>
<p>I dont think so. Its a two step mechanism.</p>
<p><a href="http://cdn.arstechnica.net/wp-content/uploads/2015/02/evo_doublefantasy.png" rel="nofollow ugc">http://cdn.arstechnica.net/wp-content/uploads/2015/02/evo_doublefantasy.png</a></p>
<p><i>&#8220;DoubleFantasy: a validator-style trojan designed to confirm if the infected person is an intended target. People who are confirmed get upgraded to either EquationDrug or GrayFish.&#8221;</p>
<p>If they have a first foot in the door with the DoubleFantasy Trojan, they will try to keep it open. No one risks to loose a potential source by free will, they dont know if they would get a second chance.</i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241783">

			<div class="comment by-roland ">

				<p class="commentcredit">

					<span class="commenter">Roland</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241783">
						February 17, 2015 1:27 PM					</a>

				</p>

				<p>How to hack a disk drive, requires physical access:<br />
  <a href="http://spritesmods.com/?art=hddhack" rel="nofollow ugc">http://spritesmods.com/?art=hddhack</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241784">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241784">
						February 17, 2015 1:36 PM					</a>

				</p>

				<p>I recall reading Tom Clancy&#8217;s Threat Vector in late 2012 or early 2013.  One of the key bits of spy tech was a tampered hard drive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241785">

			<div class="comment by-albert ">

				<p class="commentcredit">

					<span class="commenter">albert</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241785">
						February 17, 2015 2:05 PM					</a>

				</p>

				<p>@Bruce</p>
<p>&#8220;&#8230;On one hand, it&#8217;s the sort of thing we <i>want</i> the NSA to do&#8230;&#8221;<br />
.<br />
 What you mean &#8216;we&#8217; Kimosabe?<br />
.<br />
 &#8216;We&#8217; invade and decimate sovereign nations, and then get pissed when terrorists from those nations attack us. Sauce for the goose is sauce for the gander.<br />
.<br />
 Our business and industrial infrastructure is dangerously non-secure. The NSA budget would be better spent on increasing our security, not wasting it by chasing bogeymen, and waging war on every little nation can&#8217;t can&#8217;t fight back.<br />
.<br />
Stuxnet was cyberwarfare. Totally illegal. For proof, just consider what &#8216;we&#8217; would do if Iran did that to us (or actually, to Israel, who was the real instigator for using Stuxnet). There&#8217;d be boots on the ground. US boots of course.<br />
.<br />
One that would help tremendously would be for &#8216;us&#8217; to stop viewing every nation we don&#8217;t control as &#8216;the enemy&#8217;. It&#8217;s easy to make enemies, but more difficult to make friends.<br />
&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241786">

			<div class="comment by-interesting-article ">

				<p class="commentcredit">

					<span class="commenter">Interesting article</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241786">
						February 17, 2015 2:13 PM					</a>

				</p>

				<p>An interesting article on the website below about how to establish, through official channels, if data has been obtained about you.</p>
<p>Whether or not they&#8217;ll disclose this is another matter.</p>
<p><a href="http://www.welivesecurity.com/2015/02/17/gchq-illegally-spy/" rel="nofollow ugc">http://www.welivesecurity.com/2015/02/17/gchq-illegally-spy/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241787">

			<div class="comment by-the-clapper-clap ">

				<p class="commentcredit">

					<span class="commenter">The Clapper Clap</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241787">
						February 17, 2015 2:34 PM					</a>

				</p>

				<p>Let&#8217;s hope Bruce is using &#8216;targeted&#8217; tongue-in-cheek. Targeted at 30 countries. Countries we&#8217;re not at war with. Countries including the USA. And that notorious existential threat Great Britain.</p>
<p>The map clearly confounds NSA IT-sabotage intensity with IT diffusion. You really think Mongolia is less infected, sandwiched between and dependent on eternal enemies Russia and China? Of course not. You don&#8217;t have a computer in your Ghir, that&#8217;s all. You think Equatorial Africa is less infected? If you saw their security standards you&#8217;d pass out. They simply have fewer computers, shared by more users. Those boxes get everything there is. Aid workers will take the NSA sabotage toolchain home with their new STDs. If we had a world war with weaponized smallpox, this map is exactly what it would look like. In the early stages.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241788">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241788">
						February 17, 2015 2:50 PM					</a>

				</p>

				<p>We need someone to come up with some simple instructions on how to modify the board on some semi-popular hard drives so the firmware can&#8217;t be updated &#8212; cut a pin, track, etc..  Same goes for the rest of the system (bios, dvd, network, etc.)  Although I know some Western Digital drives actually store part of its firmware on the platters.  Drives that load from disk should be listed so they can be excluded.  Then trow it all out and try again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241789">

			<div class="comment by-boo ">

				<p class="commentcredit">

					<span class="commenter">boo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241789">
						February 17, 2015 3:55 PM					</a>

				</p>

				<p><a href="http://Www.prosol1.com" rel="nofollow ugc">http://Www.prosol1.com</a></p>
<p>Expertise in technology, security and middle east. Located in Washington and Virginia.</p>
<p>Lead Security engineer is Robert Greene.</p>
<p>Could this be?</p>
<p>C.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241790">

			<div class="comment by-sidd ">

				<p class="commentcredit">

					<span class="commenter">sidd</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241790">
						February 17, 2015 4:07 PM					</a>

				</p>

				<p>Mr. Weaver wrote:<br />
&#8220;I&#8217;d give over/under of two weeks until we have a demo setup &#8230;&#8221;</p>
<p>I referenced</p>
<p><a href="http://spritesmods.com/?art=hddhack" rel="nofollow ugc">http://spritesmods.com/?art=hddhack</a></p>
<p>in the last squid post, where linux was induced to partially boot from drive firmware, a couple years ago, so I would not take the other side of the bet. Along these lines, I would be very surprised if network adaptor firmware exploits aren&#8217;t lurking about too.</p>
<p>I also imagine that thirty seconds after the news hit the web, a large majority of (competent) admins began monomaniacally checking for those signatures, and all those CandC servers came under surveillance and/or attack. I expect more reports of NSA malware shortly.</p>
<p>These exploits are very short sighted, and will be turned against their creators as well as bystanders. Far, far, better would have been for the zero days and firmware exploits to be publicized and vendors shamed into fixes. But I suppose, although defense wins games, offense sells tickets. And the tickets are for much more lucrative budgets, whih grow ever larger the longer the game continues. There is no profit for the spooks in ending the game.</p>
<p>sidd</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241791">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">steven</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241791">
						February 17, 2015 4:12 PM					</a>

				</p>

				<p>Asking to write-protect the firmware or make it permanent is an odd request.  Especially if the vendor can&#8217;t be trusted anyway.  Surely we&#8217;d prefer the opposite:  source code to compile our own, trusted firmware image;  and ability to overwrite the firmware of a disk even if it has been compromised.</p>
<p>Of course, you&#8217;d still need a trusted system to build and flash firmware from.  Live CDs should help a lot here, especially if you have old media lying around that predates the malware in question.  Share and compare firmware source and compiled images with your friends.  A diversity of hardware architectures and age of systems is also good to have, as malware has many constraints and can&#8217;t target everything conceivable.</p>
<p>Once you have a trusted system, having barely enough trusted storage to boot the OS, you can even use untrusted disks quite safely &#8211; as encrypted storage.  That way you never write anything sensitive to that disk, and you authenticate the data returned to you by its firmware.  Just so long as your BIOS won&#8217;t ever try to boot from it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241792">

			<div class="comment by-michael ">

				<p class="commentcredit">

					<span class="commenter">Michael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241792">
						February 17, 2015 4:24 PM					</a>

				</p>

				<p>I thought most hard drive firmware was written outside the US.  India.  How does the NSA coerce Programers in India to create a Malware hook, and then stay silent about it.</p>
<p>If I was cracking Linux, I think I would think of putting the hook into Graphics Drivers.</p>
<p>Maybe a company itself does not have to be involved, just a private payment to someone.  Such as getting hooks into Windows only requires greasing an individual&#8217;s hands to get Malware hook in.</p>
<p>I have never heard of anyone conjecturing that Servers have been altered in some way to aid NSA tracking.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241793">

			<div class="comment by-tyr ">

				<p class="commentcredit">

					<span class="commenter">tyr</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241793">
						February 17, 2015 4:44 PM					</a>

				</p>

				<p>I was particularly struck by the leftover detritus<br />
as Kaspersky got hold of a bunch of abandoned domains<br />
where the infected machines were still reporting back.</p>
<p>Bruce was looking good on RT television, the soundbite<br />
nature of their format makes it hard to get much info<br />
but at least it isn&#8217;t the hysterical spin version.</p>
<p>One posibility that might work is scrounging up some<br />
obselete hardware and use that for your TCB basis. I<br />
recall lots of new websites trying to push Windows<br />
crap onto the Unix I was using at the time. They were<br />
assuming everybody used Windows. Now they assume we<br />
all use some modern disc tech. If you don&#8217;t it will<br />
at least give you some small space of invulnerability.</p>
<p>On the political horizon if such things are considered<br />
acts of war this is the most dangerous kind of insane<br />
stupidity. The Atomic Scientist Doomsday Clock is far<br />
too close as it is and major hacks against Nuclear<br />
powers are a really bad idea. Leaving your cutesy ID<br />
codewords behind is even worse.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241794">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">steven</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241794">
						February 17, 2015 5:09 PM					</a>

				</p>

				<p>The FBI could learn a lot from the Kaspersky PDF:  if you want to attribute a hacking incident to a nation state &#8211; convincingly &#8211; then this is how you should go about it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241795">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241795">
						February 17, 2015 5:32 PM					</a>

				</p>

				<p>@ Bruce,</p>
<blockquote><p>We simply don&#8217;t have the ability to maintain security in a world where we can&#8217;t trust the hardware and software we use.</p></blockquote>
<p>There are a couple of issues behind this&#8230;</p>
<p>The first is the &#8220;permissive business model&#8221;, basicaly computers have been sold into business not on the idea of segregation/security but connectivity/insecurity. That is the greater the degree of connectivity and access the more use computers are as &#8220;business enablers&#8221; which is what executives pay for. As the industry so often shows &#8211;Sony being one of the more obvious&#8211; managment are to short sighted to care about security other than in name for audit and compliance.</p>
<p>As for &#8220;trust&#8221; forget it it&#8217;s a pipe dream that&#8217;s not happened and is not going to happen, plain and simple, the systems are to complex and the supply chains to long and opaque. The solution as it is with placing trust in humans is to mitigate the problem in some manner.</p>
<p>However mitigation is going to be expensive, and that is going to be a realy tough sell to people who&#8217;s main interest is in maximizing &#8220;shareholder return&#8221; for the next couple of quaters as it&#8217;s the way to keep their jobs&#8230; Likewise at all levels down from executive row people want systems that enable them to keep up with the targets they have been set, and thus do not want systems that get in their way.</p>
<p>Yes we can have improved security, but only at a price few are prepared to spend, and then as with infrastructure companies because they are required to by legislation.</p>
<p>Thus if we want more secure systems we need legislation that will force a level playing field by requiring it of all not a few. However with legislation lies many pit falls and dangers. Personally I have no faith in our legislators getting it right, there are to many &#8220;well healed vested interests&#8221; that will lobby to neuter any such legislation.</p>
<p>Further I don&#8217;t believe that either of the two main US parties are even remotely interested in raising the bar on computer security, in fact just the opposite. As their deeds rather than their speeches have clearly shown.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241796">

			<div class="comment by-wp ">

				<p class="commentcredit">

					<span class="commenter">wp</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241796">
						February 17, 2015 6:15 PM					</a>

				</p>

				<p>I would like to see hardware vendors especially of hard drives and motherboards to use parts which have a write protect pin and allow the user to disable the write protect only through a physical jumper or switch in the hardware in case you need to update it, otherwise keep it disabled. If you did this for all NV storage in the system (except for your hard disk itself) then you can at least prevent malware from being stored in NV memory and have some assurance that a system is sanitized by wiping the hard drive(assuming the hardware you have didn&#8217;t have implants). I&#8217;d like the vendors to also sign their firmware and publically post the signature, though you might have to pull the part off the board and read it manually to prove anything.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241797">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241797">
						February 17, 2015 6:16 PM					</a>

				</p>

				<p>HD firmware, BIOS hacks, subverted chips &#8211; OK.<br />
Lock one door, they will use the other.</p>
<p>So the computer (targeted means a small (my) machine, not a server system) is pwned.<br />
It also means there must be “something” very intelligent within the machine, undetected by AV software, collecting “specific” information on the machine &#8211; not a simple task, anyway. Nearly unbelievable to hide that in HD firmware only.</p>
<p>But the data (which? <b>[1]</b>) finally has to leave the machine via Internet (?).</p>
<p>Would that mean we need another device, much simpler than a universal PC, to monitor our computer’s networking activity?<br />
Similar to a router or a proxy, or e.g. the “Little Snitch” (for OS X) running on the (supposedly) pwned machine, where it would be useless?</p>
<p>It would check all outgoing connections, cross check the destination IP against a manually configurated whitelist, checking the <b>amount of outgoing data</b> to each connection for plausibility and / or confirmation by the user.<br />
The device would only listen, like Wire Shark, probably cut the line in real time, and could not be directly updated via Internet.</p>
<p>Could such a device detect suspicious activity?<br />
(not a device for Jane &amp; John Doe, however)</p>
<p><b>[1]</b><br />
I’m asking because nearly everything interesting has to leave the computer &#8211; and the target is interesting, too (metadata). They already have it from the backbone.<br />
So it must be looking for passwords and encryption keys / OTP’s?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241798">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241798">
						February 17, 2015 6:16 PM					</a>

				</p>

				<p>@sidd: google.com/search?q=broadcom+nic+hack</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241799">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241799">
						February 17, 2015 6:36 PM					</a>

				</p>

				<p>@Michael: google.com/search?q=nsa+server+implant</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241800">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241800">
						February 17, 2015 6:55 PM					</a>

				</p>

				<p>@Sancho: &#8220;&#8230;there must be “something” very intelligent within the machine, undetected by AV software, collecting “specific” information on the machine &#8211; not a simple task, anyway.&#8221;</p>
<p>The attack has two stages, stage one &#8220;DoubleFantasy: a validator-style trojan&#8221; does the scanning.</p>
<p>Do we already know &#8220;DoubleFantasy&#8221; is not DualUse AV software? Some kind of &#8220;Malicious Software Removal Tool&#8221;? 🙂</p>
<p>If you want to monitor your traffic get a switch with a monitoring port (cheap gigabit websmart) between your systems and your internet link. Let a primitive machine do the scanning. Something like this combo: openbsd.org/armv7.html</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241801">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241801">
						February 17, 2015 7:00 PM					</a>

				</p>

				<p>@ Michael</p>
<p>They could offer them a large sum of money or a better job later on if they do the subversion. Telling them the risk is low for them (if done properly) while offering a violent alternative to compliance might increase odds they go along with it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241802">

			<div class="comment by-nate ">

				<p class="commentcredit">

					<span class="commenter">Nate</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241802">
						February 17, 2015 7:04 PM					</a>

				</p>

				<p>Bruce, you said:</p>
<p>&#8220;On one hand, it&#8217;s the sort of thing we want the NSA to do. It&#8217;s targeted. It&#8217;s exploiting existing vulnerabilities.&#8221;</p>
<p>Sorry Bruce, but I beg to differ. In the strongest possible terms.</p>
<p>We don&#8217;t know that EquationGroup is only &#8216;exploiting existing vulnerabilities&#8217;. We know that they ARE exploiting vulnerabilities, and we know that they are not reporting the vulnerabilities that they discover (so they&#8217;re certainly not making the cyber-world more secure).</p>
<p>We also know from the Snowden documents that other groups within the NSA <em>are</em> tasked to introduce new vulnerabilities, and there&#8217;s absolutely no reason to believe that the group which creates vulnerabilities and the group that exploits them have any kind of conflict of interest. Common sense would argue the opposite: that a capability requiring vulnerabilities will feed demand for the manufacture of vulnerabilities. It&#8217;s at the VERY least a &#8216;perverse incentive&#8217;, and much likely far worse.</p>
<p>We also know from this very Kaspersky report that EquationGroup are additionally interdicting physical CDs in the post and introducing malware into them. We knew this from the TAO catalog but this should frighten us. We now can have no trust in the integrity of the postal service. Is this a good thing for democracy? I don&#8217;t believe so. The implications of this kind of intervention run very deep, and very dark.</p>
<p>Finally, &#8216;targeting&#8217;? Are you really okay with this? (p15 of the report):</p>
<p>&#8220;One such incident involved targeting participants at a scientific conference<br />
in Houston. Upon returning home, some of the participants received by mail a copy of the conference proceedings, together with a slideshow including various conference materials. The [compromised ?] CD-ROM used “autorun.inf” to execute an installer that began by attempting to escalate privileges using two known EQUATION group exploits. Next, it attempted to run the group’s DOUBLEFANTASY implant and install it onto the victim’s machine. The exact method by which these CDs were interdicted is unknown. We do not believe the conference organizers did this on purpose. At the same time, the super-rare DOUBLEFANTASY malware, together with its installer with two zero-day exploits, don’t end up on a CD by accident.&#8221;</p>
<p>Scientific conferences in the continental USA? Is that REALLY a legitimate war/espionage target? I&#8217;m not American, but surely some things should be sacred to US military, and science happening on US soil would be up there, wouldn&#8217;t it? And yet, nope.</p>
<p>p21:<br />
&#8220;Victims generally fall into the following categories:<br />
Governments and diplomatic institutions<br />
Telecommunication<br />
Aerospace<br />
Energy<br />
Nuclear research<br />
Oil and gas<br />
Military<br />
Nanotechnology<br />
Islamic activists and scholars<br />
Mass media<br />
Transportation<br />
Financial institutions<br />
Companies developing cryptographic technologies&#8221;</p>
<p>Are you ABSOLUTELY sure these are &#8216;legitimate&#8217; war targets? They look like civilian infrastructure to me.</p>
<p>So please speak for yourself, but I do NOT want the NSA or any other nation-state group doing this kind of subversion of the civilian infrastructure I depend on for peaceful living.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241803">

			<div class="comment by-defcon-8-bis ">

				<p class="commentcredit">

					<span class="commenter">DEFCON 8 bis</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241803">
						February 17, 2015 7:07 PM					</a>

				</p>

				<p>Can&#8217;t wait to find out why dkk was carefully, precisely targeted by country and forum membership</p>
<p><a href="https://forum.lowyat.net/topic/1488855/all" rel="nofollow ugc">https://forum.lowyat.net/topic/1488855/all</a></p>
<p>in 2010, while the KLWCT happened to be marshaling forensic evidence of universal-jurisdiction crimes by the US and UK command structure.</p>
<p>Monitoring threats to US impunity &#8211; the sort of thing we want the NSA to do!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241804">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241804">
						February 17, 2015 7:38 PM					</a>

				</p>

				<p>@ DEFCON 8 bis<br />
your comment packs a lot of punch.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241805">

			<div class="comment by-harry-johnston ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://harryjohnston.wordpress.com' rel='external nofollow ugc' class='url'>Harry Johnston</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241805">
						February 17, 2015 7:46 PM					</a>

				</p>

				<p>The &#8220;other other hand&#8221; is also known as &#8220;the gripping hand&#8221;, from <a href="en.wikipedia.org/wiki/The_Mote_in_God&#039;s_Eye" rel="nofollow ugc"><i>The Mote in God&#8217;s Eye</i></a>.  Although I suppose perhaps if you used that only science fiction geeks would know what you meant. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241806">

			<div class="comment by-jonknowsnothing ">

				<p class="commentcredit">

					<span class="commenter">JonKnowsNothing</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241806">
						February 17, 2015 8:04 PM					</a>

				</p>

				<p>My first computer was a terrific (RIP) Radio Shack one with 8&#8243; floppies and a notoriously bad floppy drive that nearly every write cycle corrupted the file directory structure.  From simple directions in a popular magazine anyone who had one of these used &#8220;defensive recovery&#8221; methods of re-writing part of the drive routine to make a copy of the file directory in a hidden/unused area of the floppy.  If the main directory failed you executed your recovery script and rewrote the file directory.</p>
<p>The same techniques worked quite well when the IBM PC made it&#8217;s appearance and their 5.25&#8243; floppies weren&#8217;t any more reliable than the 8&#8243; ones.</p>
<p>Years ago the baddies found that they could stash their malware in GPU memory and other non-volatile memory areas beyond reach and detection.</p>
<p>Anyone with a bit of ddg-fu (or google-fu if you must) can download the specs from nearly any corporation that makes firmware and read all-about-it.  It&#8217;s not scintillating reading but with a bit of perseverance you learn that: <b>Anything in Firmware is Anything but Secure</b>.</p>
<p>The best news though is that Kaspersky has broken ranks with the <i>Silent Partners of the NSA</i> &#8211; the AVCos.  The US News outlets are busy pushing this news off the front pages as fast as they can but it keeps filtering upwards even though a goodly number of people probably couldn&#8217;t find a hard drive even if it landed on a plate in front of them.</p>
<p>What&#8217;s even better is that by &#8220;using your little grey cells&#8221; you can figure out a lot more about what is and isn&#8217;t happening simply by reverse engineering: What would it take to do X?  For many complex problems stepwise increments can be very simple to understand.</p>
<p>What comes from this is what a lot of people have been saying: <b>THE INTERNET IS BROKEN</b></p>
<p>There is no protocol, crypto or other solution that will &#8220;fix&#8221; this problem.  A while back someone posted that the Internet 5 years from now won&#8217;t look like it does today.   Once corporations begin to consider the magnitude of the problem and users are finally freed from the <i>&#8220;I have nothing to hide&#8230;&#8221;</i> ideology a <i>Newer Net</i> may have a chance to evolve.</p>
<p>That&#8217;s a big MAY &#8230; there will be a lot of skepticals who do not want to give up their bread and butter and governments who find the current incarnation so convenient that they will stick as many spanners in the works as they can.</p>
<p>There isn&#8217;t any security at all on the net.  It&#8217;s all <i><b>MAYA</b></i>&#8230;</p>
<p>ht tp://en.wikipedia.org/wiki/Maya_(illusion)<br />
(url fractured to prevent auto-run.  remove the space from the header)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241807">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241807">
						February 17, 2015 8:09 PM					</a>

				</p>

				<p>@ Nate</p>
<p>&#8220;Are you ABSOLUTELY sure these are &#8216;legitimate&#8217; war targets? They look like civilian infrastructure to me.&#8221;</p>
<p>Absolutely. Being able to selectively or totally disable those during a conflict would be tremendously valuable to a military organization (eg NSA). Some are more appropriate than others, not to mention blowback. Problem I have is, as you point out, they aren&#8217;t just targeting these in hostile countries. Even worse, they&#8217;re firing at their own people. (!)</p>
<p>The funny thing is this was something that I didn&#8217;t seriously contemplate until I saw <a href="https://www.youtube.com/watch?v=AoNT6u3mQew" rel="nofollow ugc">Enemy of the State</a>. Even then, I thought it would only be used for the most exceptional (or just criminal) situations if Americans were the targets. The movie damaged their reputation and domestic power for years. They spent those years convincing us they wouldn&#8217;t do anything like that to Americans. After 9/11, they asked (and were allowed) to do <em>way</em> more than that. So, they voluntarily became exactly what they spent years telling us they had no intention of being. And this time their intel supported indefinite detention, torture, and murder by drones!</p>
<p>Note: Movie focused on satellites and CCTV surveillance where reality mostly ended up being Internet and cell phones. Gene Hackman using a faraday cage, air gaps, and countersurveillance proved to be accurate on minimum defense necessary. Blowing up one&#8217;s office because someone made a phone call: yet to be tested for effectiveness but his motivation makes more sense now than then.</p>
<p>@ All</p>
<p>Stumbled upon this hilarious <a href="https://www.youtube.com/watch?v=oS-BQF1X7Qw" rel="nofollow ugc">Snowden remix</a> of Enemy of the State trailer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241808">

			<div class="comment by-da ">

				<p class="commentcredit">

					<span class="commenter">DA</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241808">
						February 17, 2015 8:35 PM					</a>

				</p>

				<p><i>On one hand, it&#8217;s the sort of thing we want the NSA to do.</i></p>
<p>I know you&#8217;re going to get a lot of pushback on this, but as one of those guys in the middle on this issue, I appreciate it. And you&#8217;re right.</p>
<p>There&#8217;s a pretty good chunk of the public who will believe that anything the NSA (and the rest of the IC) does, no matter how sketchy or draconian, is absolutely a good thing that protects us from all manner of horrible people. And there&#8217;s a pretty good chunk of the public who believes that anything the NSA does is by definition evil, that all they do is twirl their mustaches and think of ways to create a turnkey totalitarian state.</p>
<p>I do not myself buy into &#8220;the truth is always in the middle&#8221; fallacy. But in this case it is in fact true that a nation has to be able to suss out the secrets of other nations. It&#8217;s been absolutely necessary since the modern nation state has been a thing. At the same time, it can be a civil liberties danger. We need to be responsible citizens and try to see that this country meets both challenges.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241809">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241809">
						February 17, 2015 8:42 PM					</a>

				</p>

				<p>@ wp</p>
<p><i>I would like to see hardware vendors especially of hard drives and motherboards to use parts which have a write protect pin and allow the user to disable the write protect only through a physical jumper or switch in the hardware in case you need to update it, otherwise keep it disabled.</i></p>
<p>Technically feasible, but highly unpractical. Admins and power users can open up servers and desktops to change jumper, dipswitch or pin settings, but that sort of stuff is beyond the average user and a complete nightmare in a corporate environment with hundreds or thousands of machines to service. Removing a hard drive from most laptops is not too difficult either, but what about other infectable components such as NICS, controllers and the like ? That essentially boils down to taking the machine apart. Same goes for tablets and smartphones.</p>
<p>We know from the <a href="" target="_blank" rel="noopener noreferrer nofollow ugc">ANT division catalog</a> that NSA also has a series of BIOS exploits (e.g. ARKSTREAM + DEITYBOUNCE, IRONCHEF), which begs the question why these are not write-protected by default. I am pretty baffled too with nls_933w.dll, the Equation Group module that on Windows does the re-writing of the HD firmware. I always thought the UEFI+TPM combination was specifically designed to prevent this kind of subversion. On some HP Proliant servers, for example, HP SUM (Smart Update Manager) utilities for iLO, Smart Array, NIC and BIOS will detect if a TPM is enabled on the system and will warn users prior to a flash. If Bitlocker is enabled, the recovery key is even needed to access the user data upon reboot. Which obviously indicates that it is very much possible to detect any firmware tampering before it happens.</p>
<p>The really bad part is that because of the very nature of the infection, it is almost impossible to detect if a hard drive is infected, or to re-flash it. Which totally changes the game of data sanitation and incident response.</p>
<p>@ Nick P., @ Nate</p>
<p><i>Are you ABSOLUTELY sure these are &#8216;legitimate&#8217; war targets? They look like civilian infrastructure to me.</i></p>
<p>Under the assumption that these are legitimate war targets, that would imply that the NSA is effectively preparing for such a scenario. It is however more likely that they have infiltrated many of these organisations for economic and industrial espionage. As for domestic targets, I guess that&#8217;s the NSA&#8217;s interpretation of &#8220;data sharing&#8221; between corporate entities and the government.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241810">

			<div class="comment by-mit-m-fisher ">

				<p class="commentcredit">

					<span class="commenter">Mit M Fisher</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241810">
						February 17, 2015 9:28 PM					</a>

				</p>

				<p>Re. &#8220;Today&#8217;s top-secret programs become tomorrow&#8217;s PhD theses and the next day&#8217;s hacker tools.&#8221;</p>
<p>A number of today&#8217;s top secret programs are also today&#8217;s contractor employees&#8217; outside-of-work &#8216;toys.&#8217; This includes both weaponized software and hardware. This is likely one conduit by which the exploits find their way into the wild, but is also a significant problem in its own right. Many of those with &#8216;recreational access&#8217; clearance are at best juvenile sociopaths, some are much worse. You can really do a lot of damage to a community with these things.</p>
<p>From Nov 14, 2014 article regarding NSA Director Rogers speaking at a RAND Corp. conference:<br />
&#8220;Asked how he pitches jobs at the NSA to top tech recruits, Rogers cracked another joke. &#8220;We&#8217;re gonna let you do some really neat stuff,&#8221; he said. &#8220;Some really neat stuff that, quite frankly, you can&#8217;t legally do anywhere else.&#8221;&#8221;</p>
<p>It might have been framed as a joke but it is very clearly a common recruiting angle. If NSA ($11B budget) or Defense Intelligence ($80B budget) recruits this way, what sort of behavior should we expect from them at home or afield? And where exactly does the allowance for illegal use of these weapons end?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241811">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241811">
						February 17, 2015 9:29 PM					</a>

				</p>

				<p>The ABC&#8217;s of TLA&#8217;s cyber-recon???<br />
&#8230; Duqu, Equation, Flame, Gauss &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241812">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241812">
						February 17, 2015 10:29 PM					</a>

				</p>

				<p>All this talk of &#8216;(il)legitimate&#8217; domestic/foreign targets is such a yawn&#8230; The lines have already been drawn:</p>
<blockquote><p><b>DoD Strategy for Operating in Cyberspace (DSOC)</b> (<i>July 14, 2011</i>)</p></blockquote>
<blockquote><p>Strategic Initiative 1: Treat cyberspace as an operational domain to organize, train, and equip so that DoD can take full advantage of cyberspace&#8217;s potential.</p></blockquote>
<blockquote><p><i>Press Release</i>: <a href="http://www.defense.gov/releases/release.aspx?releaseid=14651" rel="nofollow ugc">http://www.defense.gov/releases/release.aspx?releaseid=14651</a></p></blockquote>
<blockquote><p><i>Official Download</i><i> (.pdf): <a href="http://www.defense.gov/news/d20110714cyber.pdf" rel="nofollow ugc">http://www.defense.gov/news/d20110714cyber.pdf</a> (I&#8217;ve previously had some troubles with this specific file getting corrupted on the mobile phone, but surely a search for &#8216;d20110714cyber.pdf&#8217; will result in the proper document 😉</i></p></blockquote>
<p>The &#8216;great&#8217; information war is well underway! The instant you step into to the virtual world (unavoidable), you are most certainly considered a potential enemy combatant. How &#8217;bout this one: <a href="http://www.buzzfeed.com/mhastings/congressmen-seek-to-lift-propaganda-ban" rel="nofollow ugc"><b>Congressmen Seek To Lift Propaganda Ban</b></a> (<i>May 18, 2012</i>)<br />
Yes, I am very much aware of my patriotic duty to support the party lines, yet I still can&#8217;t help but feel that Snowden&#8217;s revelations are more policy-based continuations rather than any real attempt of bureaucratic/political-subversions&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241813">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241813">
						February 17, 2015 11:55 PM					</a>

				</p>

				<p>@Dirk Praet, @ Nick P</p>
<blockquote><p>I am pretty baffled too with nls_933w.dll, [&#8230;] On some HP Proliant servers, for example, HP SUM (Smart Update Manager) utilities for iLO, Smart Array, NIC and BIOS will detect if a TPM is enabled on the system and will warn users prior to a flash. If Bitlocker is enabled, the recovery key is even needed to access the user data upon reboot. Which obviously indicates that it is very much <b>possible to detect any firmware tampering before it happens.</b></p></blockquote>
<p>Several things to keep in mind:</p>
<ol>
<li>The TPM is a &#8220;passive&#8221; device (slave); it executes commands.</li>
<li>The BIOS / UEFI controls what the TPM does in the early stages of power-on starting from the time the CPU comes out of reset</li>
<li>The TCG specifications state what is &#8220;measured&#8221; in each PCR</li>
<li>The TPM only measures and doesn&#8217;t &#8220;Detect&#8221; &#8212; that&#8217;s one of the differences between trusted boot and secure boot; secure boot will detect and flag an anomaly, but trusted boot won&#8217;t. It&#8217;s possible to have both trusted and secure boot.[1]</li>
</ol>
<p>Regarding the hard drive firmware: As far as I remember (and it&#8217;s been close to 7 years since I worked on this), this isn&#8217;t an &#8220;option rom&#8221; that&#8217;s measured by the TPM. Some firmware isn&#8217;t exposed (reachable) to be measured. You can ask the hosting board to update it, but not read it. If it&#8217;s not reachable by the BIOS / UEFI, then it can&#8217;t be measured in the TPM&#8217;s PCRs.</p>
<p>As for:</p>
<blockquote><p> NIC and BIOS will detect if a TPM is enabled on the system and will warn users prior to a flash.</p></blockquote>
<p>It&#8217;s because of the possibility that a measured option rom will change one of the PCRs (PCR2, 3), which the decryption key is sealed to. And if the PCR value changes, then the decryption key won&#8217;t be &#8220;unsealed&#8221;, resulting in the drive data being indecipherable.</p>
<p>[1] &#8220;Trust&#8221; does not imply &#8220;Goodness&#8221;! It simply means that the challenger can cryptographically verify the reported state is correct. The challenger trusts that the state reported by the &#8220;challenged device&#8221; is true (good or bad state&#8230; is irrelevant, in this context)<br />
[2] <a href="https://www.ibr.cs.tu-bs.de/users/kurmus/papers/acsac13.pdf" rel="nofollow ugc">Hard drive stealth paper</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241814">

			<div class="comment by-pb ">

				<p class="commentcredit">

					<span class="commenter">pb</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241814">
						February 18, 2015 12:35 AM					</a>

				</p>

				<p>Hi,<br />
Thanks for the link,</p>
<p>A note in article states that the code remained on the compromised disks even after being wiped by military standard wiping procedure.</p>
<p>&#8221; The malicious firmware created a secret storage vault that survived military-grade disk wiping and reformatting, making sensitive data stolen from victims available even after reformatting the drive and reinstalling the operating system. &#8221;</p>
<p>As per know-how, a military issue re-writing consists of at least<br />
minimum 7 tries of writing with pseudo-random data over whole span of a disk.<br />
(Gutmann, Yours, DoD Unclassified Computer Hard Drive Disposition, etc. )</p>
<p>How is it possible for data to remain on the infected disk even after<br />
7-35 wipe outs, cause usually such procedure is carried out on another physically separate system ?</p>
<p>Thanks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241815">

			<div class="comment by-sidd ">

				<p class="commentcredit">

					<span class="commenter">sidd</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241815">
						February 18, 2015 12:50 AM					</a>

				</p>

				<p>Sighting in 2008 (in french)</p>
<p><a href="http://forums.ixus.net/viewtopic.php?t=41554" rel="nofollow ugc">http://forums.ixus.net/viewtopic.php?t=41554</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241816">

			<div class="comment by-ole-juul ">

				<p class="commentcredit">

					<span class="commenter">Ole Juul</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241816">
						February 18, 2015 1:24 AM					</a>

				</p>

				<p>@pb I too am doubtful that the &#8220;military standard&#8221; wiping is inadequate, but it is certainly possible. Their standard wipe could be just the regular part of the disk where date is written. It is possible to create other areas, particularly at the ends, which are not touched by that. There may also be a little space left at the end of firmware (not data) sections. A full wipe (eg the whole disk made blank) would render it useless for any data storage purpose. It&#8217;s easier to just physically destroy the whole unit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241817">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241817">
						February 18, 2015 1:33 AM					</a>

				</p>

				<p>@pb: &#8220;How is it possible for data to remain on the infected disk even after 7-35 wipe outs&#8221;</p>
<p>The surviving part of the disk is invisible for the format / wiping program and it isnt wiped, not even one time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241818">

			<div class="comment by-transparency ">

				<p class="commentcredit">

					<span class="commenter">Transparency</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241818">
						February 18, 2015 2:25 AM					</a>

				</p>

				<p>The answer is easy enough. Just like we have GPL3 software where we demand the requirement to be able to examine and change the source code, we need a type of GPL3-like hardware design where we have the ability to specify AND verify the hardware design to conform to publicly accepted standards of security.</p>
<p>The market for such open hardware design specs I think will grow in the coming years just like Linux grew though in a more open manner rather than the GPL2 kernel and other licenses that fall short of an accountable license model.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241819">

			<div class="comment by-937da4fc4d ">

				<p class="commentcredit">

					<span class="commenter">937da4fc4d</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241819">
						February 18, 2015 4:04 AM					</a>

				</p>

				<p>How can this firmware implant be detected?  Is it enough comparing the geometry provided by the HDD/SSD drive to the one printed on the attached label?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241820">

			<div class="comment by-937da4fc4d ">

				<p class="commentcredit">

					<span class="commenter">937da4fc4d</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241820">
						February 18, 2015 4:09 AM					</a>

				</p>

				<p>To be more precise, some HDDs are larger than announced (e.g., some 2TB drives are really 3TB ones whose capacity has been limited in firmware) and SSDs usually reserve some space to overprovisioning.  Are these areas used by Equation group implant or are they less clever and just get the space for the encrypted filesystem from the available one?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241821">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241821">
						February 18, 2015 4:36 AM					</a>

				</p>

				<p>Bruce Schneier textual comments on Russia Today:<br />
<a href="http://rt.com/news/233215-wikileaks-equation-hackers-kaspersky/" rel="nofollow ugc">http://rt.com/news/233215-wikileaks-equation-hackers-kaspersky/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241822">

			<div class="comment by-max ">

				<p class="commentcredit">

					<span class="commenter">Max</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241822">
						February 18, 2015 6:35 AM					</a>

				</p>

				<p>In the Reuters story, it quotes Kaspersky researcher Costin Raiu saying that the hackers (presumably NSA) must have had access to hard drive source code. Really? What do you need source for? You put your code in some unused space and patch the existing code to jump to it. Or you can fully disassemble the code, modify it, and reassemble (but that&#8217;s more work and riskier).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241823">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241823">
						February 18, 2015 6:46 AM					</a>

				</p>

				<p>&#8220;NSA, is taking advantage of the centralization of hard-drive manufacturing to the US, by making WD and Seagate embed its spying back-doors straight into the hard-drive firmware&#8230;&#8221;</p>
<p>&#8220;Kaspersky claims that the new backdoor is perfect in design.&#8221;</p>
<p>Source:  <i><a href="http://www.techpowerup.com/209925/nsa-hides-spying-backdoors-into-hard-drive-firmware.html/" rel="nofollow ugc">NSA Hides Spying Backdoors into Hard Drive Firmware</a> </i></p>
<p>When the Revelations first came out I was vocal about it here and other places. In a matter of a few months without warning TWO hard drives went BSOD on me. I wondered if that was a coincidence. I am still wondering, more.</p>
<p>The implications of a government having an undetectable, unbeatable backdoor in, almost, every PC in the world are boggling. And depressing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241824">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241824">
						February 18, 2015 6:58 AM					</a>

				</p>

				<p>@ Wael</p>
<p><i>You can ask the hosting board to update it, but not read it. If it&#8217;s not reachable by the BIOS / UEFI, then it can&#8217;t be measured in the TPM&#8217;s PCRs.</i></p>
<p>Which is exactly why it&#8217;s so hard to determine whether or not a disk has been infected. In the light of what we are seeing today, perhaps that design specification/implementation should be reconsidered, unless for some reason it would be technically impossible to do so.</p>
<p>@ Buck</p>
<p><i>All this talk of &#8216;(il)legitimate&#8217; domestic/foreign targets is such a yawn&#8230; The lines have already been drawn: &#8230;</i></p>
<p>Which makes it all the more necessary to get a tad more serious about international talks, covenants and treaties governing the subject matter in order to avoid certain nations imposing their dominance in the field upon others. Not everyone on the globe agrees with the vision of US DoD and DoJ that they can pretty much do what they want where ever they want.</p>
<p>It may be interesting in this context to point to a current DoJ initiative that would make it possible for the US to &#8220;legally&#8221; search and seize data on computers worldwide. It&#8217;s not even debated in Congress but in the Judicial Conference’s Advisory Committee on the Federal Rules of Criminal Procedure. For more details, see <a href="https://cdt.org/blog/us-doj-seeks-to-search-and-seize-data-on-computers-worldwide/" target="_blank" rel="noopener noreferrer nofollow ugc">this article</a> by the Center for Democracy &amp; Technology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241825">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">steven</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241825">
						February 18, 2015 7:00 AM					</a>

				</p>

				<p>@937da4fc4d:<br />
someone (on Reddit I think &#8211; thank you) suggested reading the first blocks (MBR) from the disk, power-cycling the disk so that its firmware thinks the system is booting (how else can it know?), then read it again and compare.</p>
<p>Maybe the exact block size and sequence of reads has to match how BIOS would read it at boot.  For GPT partitioning or UEFI systems maybe the process is different again.</p>
<p>I suggest booting from a Live CD in order to try this.  (p.s., I wonder how safe optical drive firmwares are).</p>
<p>Surely there are old disks out there from machines that got infected and then taken out of service, and the malware would have no means to remove itself unless it booted to the OS (then reads system clock, realises much time has passed, panics and erases or disables itself).</p>
<p>An infected disk may have been sold on the second-hand market, having been &#8216;securely erased&#8217; but still having bad firmware on it.  If a different/newer OS was installed, one that the malware doesn&#8217;t know how to re-infect, it may be unable to erase itself then.  Or similarly, if the hard drive had bad firmware installed from the start, or was interdicted, etc. and the implant was unsuccessful.</p>
<p>Still it may be more stealthy than this.  It might only modify the MBR if the MBR on-disk exactly matches an OS it knows how to infect.  It might count the number of boot attempts, and disable itself (return to normal behaviour) if it fails too many times to reinfect the OS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241826">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241826">
						February 18, 2015 7:10 AM					</a>

				</p>

				<p>One thing that does worry me is the repeated &#8220;Only the NSA had the budjets to do this&#8221; refrain from journalists, and it&#8217;s a real problem.</p>
<p>Let&#8217;s get down to brass tacks, all that&#8217;s needed is a brain, a computer and some information all of which was available longer than 14 years ago. In theory one person who was keenly motivated could have produced such code.</p>
<p>Thus repeated emphasizing &#8220;suprer state level resources&#8221; is in part like alowing people to use &#8220;I was gods instrument&#8221; excuses, and thus giving them a pass on their poor security practice. It also gives people a false sense of both apathy and security, with &#8220;but nobody can stand up agaist such resources, and I would not be a target so why should I bother&#8221;.</p>
<p>Whilst Bruce has pointed out that &#8220;these particular attacks&#8221; are being used by the NSA/GCHQ today and somebodies PhD thesis tomorow, I don&#8217;t agree on the attacks the day after. Personaly I think that there are potentialy way better attacks already around and have been for quite some time.</p>
<p>As I frequently point out as far as we can tell apart from one specialised case the TAO are not very advanced technically, everything we have seen about them comes into the &#8220;already known publicaly for some time&#8221; catagory. That is you can find sufficiently detailed information on the methods they use on this and other blogs, in accademic papers and printed books.</p>
<p>Now does this strike you as odd? Well not if you think the NSA/GCHQ etc are &#8220;followers&#8221; not &#8220;leaders&#8221; and are just as most national IC organisations do and have done for centuries, stealing and reusing ideas from other people.</p>
<p>The thing is we also know that the NSA/GCHQ et al are not employing the brightest or best people, they can not offer the pay and packages industry especialy start ups offer. We also know that criminals can offer more convincing terms in quite a large part of he world.</p>
<p>This gives rise to two interesting possabilities&#8230;</p>
<p>Firstly that the NSA/GCHQ might be &#8220;keeping their powder dry&#8221; or playing to &#8220;plausible denyability&#8221;, that is they have way better techniques they are deliberatly not using for various reasons of which I can think of a few. One is that they work their way up an attack list using steadily stronger attacks untill they gain access, thus the real high end attacks rarely if ever get used.</p>
<p>Secondly that private industry / criminals likewise have way better techniques that they are not using for various reasons&#8230;</p>
<p>Does the suggestion that the criminal fraternity are all willingly &#8220;hanging back&#8221; on new way more powerfull attack tools sound likely?</p>
<p>Well no it does not which leaves us with some interesting thoughts.</p>
<p>One of which is for some reason we are not picking up on these attacks&#8230; That is the AV companies and academic researchers are for some reason not spoting these attacks for a variety of reasons.</p>
<p>Now both Stuxnet and this current batch of Equation Group attacks, realy tends to suggest that AV companies and academic researchers are a long way behind the curve&#8230;</p>
<p>Thus I suspect that way better tools are not waiting on PhDs etc but are already in use but are being used cautiously enough that their difficult to spot signals are not sufficiently visable in the other &#8220;nuisance noise&#8221;.</p>
<p>Several years ago on this blog I pointed out that you could use what looked like a brain dead script kiddy attack to enumerate networks and discover if you were looking at network of real independent machines or some facsimile of a network of machines that were realy just virtual machines running on a single machine. Which would give you a very good idea as to if you had found a &#8220;honey net&#8221; trap or not. I also went on to say that if I had one or two very good new exploits, I would take quite a bit of care not to waste them by using them in such obvious traps&#8230;</p>
<p>Unfortunatly when you look at quite a bit of academic research into what attackers are upto, the instrumentation they use nearly always comes up short in a way that is detectable if you think about it&#8230; which suggests there is a probability their experements get detected, and thus their results will be skewed to the script kiddy end of the attack spectrum, which unfortunatly will paint a too rosie a picture of what may be going on.</p>
<p>The AV companies have an advantage in that people who think they might have been attacked send in samples of code for the AV techs to look at. However there are way to few techs so they will use what are in effect statistical methods to find attack ware, which means they will see the more common lower level attacks way more frequently than they will the high end attacks. Also it&#8217;s highly likely they will only recognise attack code where it uses some kind of familiar exploit code. We have evidence of this with the fact that the equation group attack was discovered back in 2006, but people did not act on it.</p>
<p>Thus if a new high end attack method is found and used judiciously then it will go either undetected or ignored untill it comes above the noise. As a sneaky attacker I might use my new attack as an APT back door but cover my activities by putting an already known attack which has been weaponised to pass AV detectors onto the system and use that instead. Thus when the AV techs go through the code they see the known attack and deal with that, I as the attacker will see this avenue closed off, so will keep my head down for a bit before using the back door to get in again at a later date. I might even make the backdoor a &#8220;pull system&#8221; so that it reaches back to me at some point after it has not had it&#8217;s timer reset. As I&#8217;ve shown in the past you don&#8217;t need a dedicated command server to do this, you can use Google or any number of main stream services instead.</p>
<p>Thus my view point is there is more than sufficient grounds to belive that there is much higher level attack code already out there, because importantly it does not need vast almost impossible to imagine financial resources to do it. Just a brain a computer and information will do it, you could find the required information in any number of ways including by your own research using various testing tools on commercial software, it just requires a brain a computer copies of the software and a little patience. Large financial resources, of course does also alow you to get a degree of exclusivity, by buying such information from exploit brokers thus giving a time money trade off but this has &#8220;trust issues&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241827">

			<div class="comment by-ern ">

				<p class="commentcredit">

					<span class="commenter">Ern</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241827">
						February 18, 2015 7:51 AM					</a>

				</p>

				<p>&#8220;There&#8217;s nothing here that implies the NSA is doing this sort of thing to every computer, router, or hard drive.&#8221; If they would have, this would proably have been discovered years ago already.</p>
<p>Let&#8217;s hope anti-virus developers will focus much stronger on this low level area of computing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241828">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241828">
						February 18, 2015 8:04 AM					</a>

				</p>

				<p>[Equation malware kit/botnet] appears [to] attack by corrupting firmware, hardware and hard drives [t]is the wave of the future for most users and clearly a major threat for some special targets already. It&#8217;s probably time to start turning over vulnerable hardware every 6 months or so.” – Bob S</p>
<p>This firmware malware is extremely troubling. Tossing out hardware [HDD boards and even motherboards] could get a expensive.</p>
<p>“We need someone to come up with some simple instructions on how to modify the board on some semi-popular hard drives so the firmware can&#8217;t be updated…” –me</p>
<p>I agree.  But, I think we are a decade too late. I would guess that the NSA has even more firmware viruses at it’s beck-and-call.</p>
<p>“As for &#8220;trust&#8221; forget it it&#8217;s a pipe dream that&#8217;s not happened and is not going to happen…” – Clive</p>
<p>I concur. I would not trust anything within the tentacles of the NSA/GCHQ. They will just NSL you and gag you.</p>
<p>“A former NSA employee told Reuters that Kaspersky&#8217;s analysis was correct, and that people still in the intelligence agency valued these spying programs as highly as Stuxnet. Another former intelligence operative confirmed that the NSA had developed the prized technique of concealing spyware in hard drives… NSA spokeswoman Vanee Vines declined to comment.” –Reuters</p>
<p><a href="http://www.reuters.com/article/2015/02/16/us-usa-cyberspying-idUSKBN0LK1QV20150216" rel="nofollow ugc">http://www.reuters.com/article/2015/02/16/us-usa-cyberspying-idUSKBN0LK1QV20150216</a></p>
<p>“Update: Reuters reporter Joseph Menn said the hard-drive firmware capability has been confirmed by two former government employees. He wrote: A former NSA employee told Reuters that Kaspersky&#8217;s analysis was correct, and that people still in the intelligence agency valued these spying programs as highly as Stuxnet.” –Arstech</p>
<p><a href="http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/4/" rel="nofollow ugc">http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/4/</a></p>
<p>&#8220;Technically feasible, but highly unpractical. Admins and power users can open up servers and desktops to change jumper, dipswitch or pin settings, but that sort of stuff is beyond the average user and a complete nightmare in a corporate environment with hundreds or thousands of machines to service. Removing a hard drive from most laptops is not too difficult either, but what about other infectable components such as NICS, controllers and the like ? That essentially boils down to taking the machine apart. Same goes for tablets and smartphones.&#8221;- Dirk Praet</p>
<p>Yes. The situation looks grave. A lot of hardware and software will have to inspected or simply discarded.</p>
<p>Nick P has an opportunity of getting funding for his “secure” equipment project. I just hope it is not from the NSA. We need secure systems.</p>
<p>[Other observations]</p>
<p>The information stolen from the PC and prepared for transmission to the C&amp;C<br />
is stored in encrypted form throughout several fake font files (*.FON) inside the Windows\Fonts folder on the victim&#8217;s computer –Kaspersky<br />
see pdf page 9</p>
<p><a href="https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf" rel="nofollow ugc">https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf</a></p>
<p>“When the computer starts, GrayFish hijacks the OS loading mechanisms by injecting its code into the boot record . This allows it to control the launching of Windows at each stage. In fact, after infection, the computer is not run by itself more: it is GrayFish that runs it step by step, making the necessary changes on the fly…” –Kaspersky, pdf p. 12</p>
<p>GrayFish implements its own encrypted Virtual File System (VFS) inside the Windows registry.  interesting observation: the first stage GRAYFISH loader computes the SHA-256 hash of the NTFS of system folder (%Windows% or %System%) Object_ID one thousand times. The result is used as an AES decryption key for the next stage. This is somewhat similar to Gauss, which computed the MD5 hash over the name of its target folder 10,000 times and used the result as the decryption key. -Kaspersky</p>
<p>“At least four of these were used as zero-days by the EQUATION group. In addition to  these, we observed the use of unknown exploits, possibly zero-day, against Firefox 17, as used in the TOR Browser.” -Kaspersky</p>
<p>“An interesting case is the use of CVE-2013-3918, which was originally used by the  APTgroup behind the 2009 Aurora attack. The EQUATION group captured their exploit and repurposed it to target government users in Afghanistan.” -Kaspersky</p>
<p>“How do victims get infected by EQUATION group malware?”</p>
<p>“The Equation group relies on multiple techniques to infect their victims. These include:<br />
“• Self-replicating (worm) code – Fanny<br />
“• Physical media, CD-ROMs<br />
“• USB sticks + exploits<br />
“• Web-based exploits&#8221;</p>
<p>“The attacks that use physical media (CD-ROMs) are particularly interesting Because they indicate the use of a technique known as “interdiction”, where the attackers intercept shipped goods and replace them with Trojanized versions…<br />
“One such incident involved targeting participants at a scientific conference in Houston. Upon returning home, some of the participants received by mail a copy of the conference proceedings, together with a slideshow including various conference materials. The [compromised?] CD-ROM used “autorun.inf ” to execute an installer that began by attempting to escalate privileges using two known EQUATION group exploits. Next, it attempted to run the group’s DOUBLEFANTASY implant and install it onto the victim’s machine. “ &#8211;Kaspersky</p>
<p>[the USPS probably did the interdiction and spread spyware to a group of innocent scientists &#8211; along with photographing every individual&#8217;s piece of mail &#8211; thanks a lot./]</p>
<p>Hdd firmware implant details: SeePage18 of pdf for LZMA HDD ware implant details [neat info on the compressed implant to the HDD board]</p>
<p>“All C&amp;C domains appear to have been registered through the same two major registrars, using “Domains By Proxy” to mask the registrant’s information…”&#8211;Kaspersky</p>
<p>[Domains By Proxy seems to be owned by the infamous &#8220;G0D@dd@y&#8221; owners &#8211;  who just happen to own their own CA, certificate signing request, CSR, and issue SSL/TLS Certificates to their captive customers.]</p>
<p><a href="https://en.wikipedia.org/wiki/Domains_by_Proxy" rel="nofollow ugc">https://en.wikipedia.org/wiki/Domains_by_Proxy</a></p>
<p>[RC6 cipher exploit]</p>
<p>“In most publicly available RC5/6 code, this constant is usually stored as 0x9E3779B9 , which is basically &#8211; 0x61C88647…Since an addition is faster on certain hardware than a subtraction, it makes sense to store the constant in its negative form and adding it instead of subtracting”  -Kaspersky  pdf p. 23</p>
<p>[Please excuse the grammar and other errors. I am pinched for time]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241829">

			<div class="comment by-e2-busywork ">

				<p class="commentcredit">

					<span class="commenter">E2 busywork</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241829">
						February 18, 2015 8:12 AM					</a>

				</p>

				<p>Say hello to our special guest, NSA persona DA! He&#8217;s here with the official propaganda line straight from Big Brother. He&#8217;ll show us how it&#8217;s done.</p>
<p>First, acknowledge that your position has no credibility &#8211; clumsily, using the telltale bureaucratic jargon &#8216;pushback.&#8217; Then, caricature the law and ethics of government privacy interference into two camps at opposite extremes. Extra points for implicitly dumping Bill Binney into the bin with the cartoon antis by appropriating &#8216;turnkey totalitarian state.&#8217;</p>
<p>Next split the difference in the crudest way, while acknowledging that that&#8217;s stupid. Present your unsubstantiated opinion as &#8216;a true fact,&#8217; namely, dragnet surveillance is necessary. Absolutely necessary, that clinches it. Assert absolute necessity in general, and not in each specific case, as required by the supreme law of the land. But sneak in the discredited idea of balance &#8211; don&#8217;t come out and say it, or everyone will know you&#8217;re an enlisted puke following orders. Then close with some heartwarming buzzwords: challenges, responsible citizens, that&#8217;ll do it. Now anyone in your audience with a sub-95 IQ is putty in your hands. They&#8217;ll be mouthing your bumper-sticker slogans like a pop song.</p>
<p>That&#8217;s the theory, put out pre-chewed opinions for the dopes. Wait, hold on there, Gomer Pyle. This is not like your unit, there are smart people here.</p>
<p>Stick your rehashed balance up your ass. Each individual interference with our privacy must meet specific tests. You don&#8217;t balance anything, you meet the <a href="http://www1.umn.edu/humanrts/gencomm/hrcom16.htm" rel="nofollow ugc">tests</a>. Or else we&#8217;ll storm your fucking coward&#8217;s fort like the Stasi it is and shut it down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241830">

			<div class="comment by-solomon ">

				<p class="commentcredit">

					<span class="commenter">Solomon</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241830">
						February 18, 2015 8:44 AM					</a>

				</p>

				<p>I don&#8217;t believe Kaspersky just found all this. Somebody told them first, then they dug into it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241832">

			<div class="comment by-999999999 ">

				<p class="commentcredit">

					<span class="commenter">999999999</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241832">
						February 18, 2015 9:25 AM					</a>

				</p>

				<p>You can have three hands. The third hand would be &#8220;the gripping hand&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241833">

			<div class="comment by-34uifi3ufh3i ">

				<p class="commentcredit">

					<span class="commenter">34uifi3ufh3i</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241833">
						February 18, 2015 11:11 AM					</a>

				</p>

				<p>I&#8217;ve always believed the reason there isn&#8217;t a lot of BIOS firmware malware isn&#8217;t because complexity, but because of expense of development. You first have to RCE a lot of ROMs, then make a few generic infectors.</p>
<p>There are only a few BIOS providers, and often times the only difference are bit-fields and signing within each vendor&#8217;s solutions..</p>
<p>Also I see zero day payload techniques and infrastructure management and obfucation as the focus of real advancements..</p>
<p>This group only gets away with HDD firmware infection because there are no signatures for it, and nobody is looking at dumps in IDA..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241834">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241834">
						February 18, 2015 12:21 PM					</a>

				</p>

				<p>@65535 &#8220;Nick P has an opportunity of getting funding for his “secure” equipment project.&#8221;</p>
<p>If Nick could offer a simple SATAwall he would be rich quick now! 🙂</p>
<p>Transparent SATA bidirectional i/o filter, USB powered, passing only standard commands and answers over the SATA bus, dropping all others and sending warnings via USB if something was dropped and why. Could be accompanied by a software SATA driver sniffer logging wich thread sent unusual commands.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241835">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241835">
						February 18, 2015 12:48 PM					</a>

				</p>

				<p>The Kaspersky report on Equation Group is an <b>absolute MUST read</b>.</p>
<p>Search for: &#8220;Equation group: questions and answers&#8221; PDF<br />
(available from various sources, pick one you trust, <b>save a copy</b>, some are already disappearing.)</p>
<p>I think Kaspersky deserves vast credit for their research and reporting on this situation. And, we should buy their product to show it. I did.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241836">

			<div class="comment by-937da4fc4d ">

				<p class="commentcredit">

					<span class="commenter">937da4fc4d</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241836">
						February 18, 2015 1:13 PM					</a>

				</p>

				<p>@steven:</p>
<p>Thanks a lot for this information.  It makes a lot of sense.</p>
<p>Agreed, we should worry (at least slightly) about optical drives firmware.  There are too many Live-CDs and operating systems &#8212; I am not using either Windows, OS X or Linux so, indeed, there are too many choices.  However there are not so many computer architectures right now and there is a chance this implant will overwrite the boot record to hide its presence and only show itself while using an undocumented low level command.  I have not a lot of knowledge about how firmware works, but it seems plausible to me allowing arbitrary execution of code if written in the ARM9-like assembler targeted to the HDD/SDD processor.</p>
<p>Kaspersky should release any information they have about the chances to detect a firmware implant (at least the ones they have analyzed) and, of course, information about the way the firmware implant destroys itself&#8230; perhaps there is a way to elicit implant self-destruction.</p>
<p>HDD manufacturers should release firmware to reflash their HDDs too (even if only a single firmware release has been developed for a given model) together with a flashing tool that erases the remaining space in the flash area.  Just a dream, I know they will not do it.</p>
<p>I am not using any of the mainstream operating systems (Windows, OS X, Linux, &#8230;) so I learned years ago flashing firmware by using CD-ROM bootable media or, if a Windows executable is required, a bootable WinPE 3.0 CDROM.  Never on a networked system (one of the few advantages of not managing a large set of computers!).</p>
<p>At last, I have an off-line collection of firmware releases.  I may try reflashing anything I can, from BIOS up to HDD firmware, not to miss optical drives, external drives, network/video adapters or even my small eight port KVM server.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241837">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">steven</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241837">
						February 18, 2015 2:43 PM					</a>

				</p>

				<p>@937da4fc4d: if some HDD/SSD vendor takes this as a PR opportunity, releases open-source firmware, flashing tool and hardware documentation, that would be a wonderful outcome of this.  (Even if it is not freely-licensed or cross-platform, someone could at least reverse-engineer it to produce something that is).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241838">

			<div class="comment by-justme ">

				<p class="commentcredit">

					<span class="commenter">JustMe</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241838">
						February 18, 2015 5:03 PM					</a>

				</p>

				<p>Hi i have been here so many times but never thought i could say anything that you allready dont know. so i keep it short and as reminders, there might or might not be possible but after my investigations an mitigation to these threats, and this is importent in security is to know your enemy. So they are more towards non state threats but in general.<br />
&#8211; use an operating system that does not involve: windows, android<br />
  todays threat model also would meen dont use iphones or any apple products<br />
  to put it short make a fingerprint that is not standard and do that on the os level any<br />
  which way is conveniant for you to do your task.<br />
&#8211; Now this is hardcore perhaps but never mentioned or i havent seen it, ditch DNS use hosts files only as whitelists to where you want to communicate (seems to mitigate all the threats even if you are using windows)<br />
&#8211; disable: flash, pdf, utf8. java, javascripts, any scripting, be careful of fonts in general<br />
&#8211; disable exec rights from any temp variables<br />
&#8211; ok that environment might sound like it sucks, but it doesnt, it can be actually done and managable, the hardpart is the hosts file that needs to be maintained, but in an virtualisation easy, you can have a BANKING VM that dont have dns but only 10 hosts entries that are needed to do the job. again depends on who you want to protect yourselfe from</p>
<p>hmm then that gives me some other outputs because all the fuzz is about 3 letter organisations<br />
lets put it this way even if I would be a mustafa al bubu if i dont trigger any known subsets then i will go under the radar, so mustafa needs mostly protect himselfe from the local isp</p>
<p>so local isp protection<br />
number one<br />
&#8211; block at least dns requests (use tor for that)<br />
&#8211; block port 53 on firewall for outgoing to make sure no leaks can happen<br />
&#8211; then depending on who you are and what resources you have<br />
  make sure that all the traffic is going in different paths as much as possible<br />
  so if you can only use tor and dont have access to ipsec or other vpn tunnels<br />
  you can use squid proxies to make sure that a destination for example usa goes through<br />
  one tor proxy chain, another countries destination goes through another proxy chain<br />
  preferably beacuse of legislation rules, its preferable to make that proxy chain end in<br />
  an tor exit point that exits that particular country ( read 5 eye regulation ) arab<br />
  israel russian and other countries dont care, and maybe the 5 eyes also dont care but<br />
  in a legislative point of view it makes sense.</p>
<p>Fingerprinting: ok there are many ways to do that and more are covered for everyday<br />
and more will follow trust me, but just somethings<br />
&#8211; check your browsers fingerprint at <a href="http://ip-check.info" rel="nofollow ugc">http://ip-check.info</a><br />
  timezones must be set to utc<br />
  my personal opinion about firefox is !BAD! its same as google<br />
  mozilla is in my opinion in bed with NSA so be very careful especially after upgrades<br />
&#8211; if you do the hosts file only approach you will allready be protected to the unknowns<br />
   but if you insist to use dns then pay attention to some common tracking traps as these<br />
   * all sorts of updates<br />
   * all sorts of telemtery<br />
   * ocsp<br />
   * safe this and safe that (many brands have many names its useless and a sort of<br />
tracking)<br />
   * authentication headers (some in firefox cant be disabled) !!!!!!!! why ???<br />
   * ssl http fallback<br />
   * canvas<br />
   * url headers in general are not between the most important competitors made the same<br />
   why the fuck not????????<br />
now we only touched on tracking mechanisms, then we have the actual vulnerabilties in such operatin systems as android, iphone, windows etc, and yes *nix too</p>
<p>i am kindof pissed off rightnow to the fact that i actually have told my customers to use firerox and use some plugins, but the more i see what that company is doing it just feels like they are in bed with the enemy and not making it impossible to &#8220;opt out&#8221; but just about and for every damned upgrade i have to through all configs to see what is changed if nothing but!!! all the news that occured and most of it as far as i am concerned are not privacy oriented at all, quite the opposite, so a RED flag to mozilla.</p>
<p>btw most of my machines use dns but i also use host files and dnsmasq, and my hostsfiles are aroung 40k in size and consists of whitelsts, redirection lists and blocklists<br />
but for the banking stuff i use a virtualmachin with a hosts only approach.<br />
and even that feels scary!</p>
<p>ok<br />
i have more points to cover actually but i am tired and i dont want to get people bored<br />
but actually read<br />
one final note i do have is, encryption, i use 2 encryptions only<br />
encfs for cloudnetworks what evere those might be and for my containers i use<br />
a swedish zip thing called axcrypt i was using bcrypt before and then &#8220;updated&#8221; to tcrypt but it only makes sense to usb drives, for me all my data is in my own cloud<br />
for the cloud right now i use btsync version 1.3.0.9 you might argue not to, but i prefer it to any other cloud thing out there that i have tried, and if you put encfs to it you can access it from windows and *nix no problem so its doable and !!! i can use my android camera to backup my photos very nicely&#8230;</p>
<p>Last but not least due to the fuzz around eq group, check out LOKI and THOR<br />
i dont have a license for THOR so i cant say how good it is, but i do know that LOKI works<br />
then a disturbing reminder about USB stick insecurity, we all know about autorun.inf<br />
and stuxnet, but for what ever reason i have not seen much talk about U3 sticks</p>
<p>i have still an image that i can copy to any usb stick that makes it an u3 and that puts payloads on it that autoruns no matter what you do, and it still works!! very well!!!  this was perhaps forgotten but i have used it shitloads of times and it still works today some antivirues finds it but very very few. go figure</p>
<p>Hastalavista babes</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241839">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241839">
						February 18, 2015 5:26 PM					</a>

				</p>

				<p>@ Grauhut</p>
<p>Re: Switch<br />
<b>Only</b> we&#8217;d have to find a manufacturer that wasn’t blessed by the good guys.<br />
Cisco?<br />
Do they offer both, remote access and auto update?<br />
Would they lend me their golden key in case I lost my pwd?</p>
<p>Regarding the &#8220;DoubleFantasy”: I agree, the AV software would be the only one not being detected by the AV software when searching for specific data on the HD.<br />
Also to infect the HD one has to have admin access to the machine first, the drive can’t change it’s firmware because all of a sudden it learns from itself it’s in a targeted computer.<br />
And again, the malware, not the HDD, has to send some data to someone.</p>
<p>Conclusion: They victims either didn’t use an AV or AV software is snake oil.</p>
<p>But the first question remains:<br />
Would that suggested “safety box” (similar to an external firewall) help?<br />
Is it technically feasible to delay / scan the uploaded stream by a switch and a small machine at 100Mbps?<br />
Or within the switch itself to run the software to investigate uploads?<br />
(same problem, trusted vendor, probably we&#8217;d have to buy from Russia 🙂<br />
&#8211; Oh, that brings me back to Kaspersky 🙁</p>
<p>Could we forget about spyware on our machine because the external box takes care of unaware leaks?<br />
The box could also warn the user if data supposed to be encrypted (sent to specific targets, like TFC would use) does not look like random data.</p>
<p>@ Clive Robinson</p>
<p>Yep, a single brain may be sufficient (to infect the hard drive) and what is generally attributed to TLAs could be in part the work of ordinary criminals (industrial / financial espionage).<br />
Only the mentioned targets …</p>
<p>Interestingly we learn each year about “the most modern and sophisticated malware implant” and “highly sophisticated threat actor”, still now to some extent using vulnerabilities closed by Microbrain since years. The rest sounds a bit like a PR campaign for AV software.</p>
<p>However, to be useful for the attacker particular data has to be found at and uploaded from the victim’s computer. That’s common to all spyware.<br />
But why seems no one really to be interested in the recipients of outgoing data?<br />
Registrant’s personal information will be released in case of a legal subpoena.</p>
<p>Setting up honeypots (victims) should be relatively easy for someone who really wants to catch blowflies, regardless how sophisticated the <b>most recent</b> attack software is.</p>
<p>Let’s not only search inside victims after the attack is already cold (@ Kaspersky).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241840">

			<div class="comment by-justme ">

				<p class="commentcredit">

					<span class="commenter">Justme</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241840">
						February 18, 2015 5:31 PM					</a>

				</p>

				<p>I forgoet to mention a product and i dont really like products, i am a linux opensource person<br />
and also sorry for my bad engrish</p>
<p>Hehh&#8230; well the product is Sandboxie, i personally only use the latest version made before the company was bought by american defence industry but.. that is you own choise</p>
<p>this is for winblows machines especially w2k and xp, and yes there are still w2ks out there and its in my opinion a very good operating system compared to all the other crap microsoft have made 🙂</p>
<p>sorry good nights</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241841">

			<div class="comment by-albert ">

				<p class="commentcredit">

					<span class="commenter">albert</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241841">
						February 18, 2015 5:33 PM					</a>

				</p>

				<p>@Buck<br />
&#8220;&#8230;Congressmen Seek To Lift Propaganda Ban&#8230;&#8221;<br />
.<br />
Hilarious! Belongs in <i>The Onion</i>. Can someone point out <i>anything</i> from the gummit/MSM that <i>isn&#8217;t</i> propaganda?<br />
.<br />
@anyone<br />
1. I guess I missed those Microsoft TV ads with Orson Welles proclaiming, &#8220;We will release no software before its time.&#8221;<br />
2. We need rewriteable ROM memory. Done!<br />
3. We&#8217;ll redefine &#8216;beta testing&#8217; as &#8216;first product release&#8217;.<br />
4. Our EULAs will prevent any accountability for anything.<br />
.<br />
It is simple to use &#8216;fusible link&#8217; firmware memory, which can be made Read Only after the unit is tested. But wait! The firmware needs to be bug free; this is a problem. Of course a state actor could tamper with the firmware <i>before</i> it&#8217;s loaded.</p>
<p>@Grauhut<br />
I like your idea; call it SATA-Sentry(tm)  🙂<br />
I suspect that a &#8216;standard commands&#8217; filter might not be enough though&#8230;..</p>
<p>Regarding encrypted storage. Why not go back to the old battery-backed SRAM. We had memory modules with BB-SRAM, (and the battery was backed up with a 1 farad capacitor). You&#8217;d still have to trigger it manually, but that&#8217;s always a tradoff. The memory is gone once power is removed, so it&#8217;s not an &#8216;active&#8217; system.<br />
&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241842">

			<div class="comment by-loki ">

				<p class="commentcredit">

					<span class="commenter">Loki</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241842">
						February 18, 2015 5:55 PM					</a>

				</p>

				<p>Hmm just realized after googl-ing that loki nor thor is easy to find<br />
this is a really good tool for finding all sorts of stuff including writing your own yara sets</p>
<p><a href="https://www.bsk-consulting.de/loki-free-ioc-scanner/" rel="nofollow ugc">https://www.bsk-consulting.de/loki-free-ioc-scanner/</a></p>
<p>Included IOCs</p>
<p>Loki currently includes the following IOCs:</p>
<pre><code>Equation Group Malware (Hashes, Yara Rules by Kaspersky and 10 custom rules generated by us)
Carbanak APT - Kaspersky Report (Hashes, Filename IOCs - no service detection and Yara rules)
Arid Viper APT - Trendmicro (Hashes)
Anthem APT Deep Panda Signatures (not officialy confirmed) (krebsonsecurity.com - see Blog Post)
Regin Malware (GCHQ / NSA / FiveEyes) (incl. Legspin and Hopscotch)
Five Eyes QUERTY Malware (Regin Keylogger Module - see: Kaspesky Report)
Skeleton Key Malware (other state-sponsored Malware) - Source: Dell SecureWorks Counter Threat Unit(TM)
OpCleaver (Iranian APT campaign) - Source: Cylance
More than 180 hack tool Yara rules - Source: APT Scanner THOR
More than 600 web shell Yara rules - Source: APT Scanner THOR
Numerous suspicious file name regex signatures - Source: APT Scanner THOR
</code></pre>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241843">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241843">
						February 18, 2015 6:37 PM					</a>

				</p>

				<p>@ Grauhut</p>
<p>It&#8217;s pretty straightforward if you use a custom driver that simply won&#8217;t pass risky commands to the HD. Good interface and/or inline reference monitor. That&#8217;s on top of an IOMMU for DMA portion. The best route though is a general purpose I/O processor with interfaces to a number of devices and interrupt handling. Gives you all the benefits of Channel I/O (see wikipedia article) while letting you add silicon for security purposes.</p>
<p>A side benefit can be had: I/O protection on systems without I/O MMU&#8217;s. If interfaced right, the device can emulate Linux driver model for hardware support while using it&#8217;s own driver for security and portability. So, you could provide secure, modern device support for older or novel systems without device manufacturer support. With support, it&#8217;s even easier.</p>
<p>Many possibilities. I&#8217;d start with an FPGA-based product focused on PCI protocol. If it worked and sold plenty, it could be converted to S-ASIC or ASIC for lower unit cost.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241844">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241844">
						February 18, 2015 10:56 PM					</a>

				</p>

				<p>@Sancho_P</p>
<p>We&#8217;ll just have to agree to disagree&#8230;</p>
<blockquote><p>Regarding the &#8220;DoubleFantasy&#8221;: I agree, the AV software would be the only one not detected by the AV software when searching for specific data on the HD.</p></blockquote>
<p>Well, that&#8217;s not quite right&#8230; Generally, the data that somebody would be looking for is loaded into working memory from time to time (so as to actually make some use of one&#8217;s &#8216;secret&#8217; data). Since the exfiltrated bits and malicious code are encrypted and polymorphic, AV signatures are sure to be useless!<br />
While I think that you may have been hinting at this later in your comment, I still feel like it should be stated here explicitly &#8211; We would all be incredibly foolish to focus our collective efforts on 15+ year-old spook frameworks&#8230; Doing so will mean missing out on the present.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241845">

			<div class="comment by-pb ">

				<p class="commentcredit">

					<span class="commenter">pb</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241845">
						February 19, 2015 1:32 AM					</a>

				</p>

				<p>Hi,<br />
Thanks for the replies @Ole Juul and @Grauhut.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241846">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241846">
						February 19, 2015 1:44 AM					</a>

				</p>

				<p>@Nick: &#8220;I&#8217;d start with an FPGA-based product&#8221;</p>
<p>There is Openhardware SATA Controller IP for FPGAs, but FPGAs could be overkill for this. 🙂</p>
<p>A programmable Port Multiplier Chip like the JMB572 for instance could be enough.</p>
<p>And there is also the &#8220;Badusb&#8221; stuff, could be reworked&#8230; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241847">

			<div class="comment by-gary-busey ">

				<p class="commentcredit">

					<span class="commenter">Gary Busey</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241847">
						February 19, 2015 6:28 AM					</a>

				</p>

				<p><a href="http://motherboard.vice.com/read/the-nsas-undetectable-hard-drive-hack-was-first-demonstrated-a-year-ago" rel="nofollow ugc">The NSA&#8217;s Undetectable Hard Drive Hack Was First Demonstrated a Year Ago</a></p>
<p>Implementation and Implications of a Stealth Hard-Drive Backdoor &#8211; (<a href="http://www.s3.eurecom.fr/docs/acsac13_zaddach.pdf" rel="nofollow ugc">.PDF</a>)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241848">

			<div class="comment by-tony ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.excellus.com' rel='external nofollow ugc' class='url'>Tony</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241848">
						February 19, 2015 10:18 AM					</a>

				</p>

				<p>Hi,</p>
<p>I think a bigger problem here is that anything that has firmware can become tainted.  For a government spying might not be the only goal, code that rendered a device broke on command would be a tool worth planting.</p>
<p>If a government/hacker could cause 200 million devices to go offline that would be something I would worry about.  With the amount of connectivity for a multitude of firmware based control systems, appliances, computers, not to mention the so called Internet of things we should all be concerned.  Anything that allows firmware to be written to is subject to remote infection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241849">

			<div class="comment by-vdsn892 ">

				<p class="commentcredit">

					<span class="commenter">vdsn892</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241849">
						February 19, 2015 11:03 AM					</a>

				</p>

				<p>@Tony &#8220;Anything that allows firmware to be written to is subject to remote infection.&#8221;</p>
<p>The problem isn&#8217;t quite that extensive.</p>
<p>Many embedded devices that are firmware programmable require the use of a special programming adapter to do the job. Sometimes a specific write voltage needs to be applied at certain pins. Typically they are programmed at the factory using custom built equipment to save even on the cost of putting a programming socket on the board.</p>
<p>Due to the extra expense of supporting field upgrades to firmware, many products do not have this capability.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241850">

			<div class="comment by-937da4fc4d ">

				<p class="commentcredit">

					<span class="commenter">937da4fc4d</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241850">
						February 19, 2015 2:13 PM					</a>

				</p>

				<p>@steven.</p>
<p>Agreed, the open source model is the only way to go.  Not only for firmware but also for anything that is serious about security.</p>
<p>In my humble opinion open source drivers work better than their closed source counterparts, so why not firmware?  We had been fighting for years to workaround bugs in the firmware of wireless network adapters.  Open source firmware will allow not only auditing these devices but also fix problems were they lie (firmware) instead of writing workarounds at the wrong level (drivers).</p>
<p>On the other hand availability of open source firmware will allow hackers improve firmware quality (and they are very good at it).  Currently we depend on manufacturers to get firmware updates: some provide decent support (ranging from four up to eight years for high-end gear) but others hardly release a single update (if any!).</p>
<p>Offtopic&#8230; what will happen now that current systems have UEFI BIOSes?  Will manufacturers fix security weaknesses that happen years after computers are EOL&#8217;d?  In the past a buggy BIOS mean that the computer was not able to boot from an external device, or that it would hang when a PCI card was attached.  Sad, but we can live with it.  Now a buggy BIOS means remote code execution before operating system takes control of the hardware (see latest UEFI BIOS vulnerabilities).  I feel lucky as I have a ThinkPad T430s that is supported (yet!).  Lenovo provides ~four years of firmware updates.  We will see what happens if a serious 0day exploit against UEFI BIOSes is discovered next year &#8212; something that will possibly happen, as UEFI source is full of integer overflows.</p>
<p>In short, I agree with you.  We need open source firmware and (for people and business serious about security) open source operating systems and tools.  We do not need POSIX certification, we need a computing base that can be trusted.  And trust can only be achieved by public review.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241851">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241851">
						February 19, 2015 3:51 PM					</a>

				</p>

				<p>Short in Gemalto: firstlook.org/theintercept/2015/02/19/great-sim-heist/</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241852">

			<div class="comment by-sidd ">

				<p class="commentcredit">

					<span class="commenter">sidd</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241852">
						February 19, 2015 6:02 PM					</a>

				</p>

				<p>I like the bit about suppressing billing. They used to screw this one up in the 90&#8217;s</p>
<p>Anyone still believe the certificate authorities are not penetrated ? Might as well switch to self signed certs now &#8230;</p>
<p>sidd</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241853">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241853">
						February 19, 2015 6:04 PM					</a>

				</p>

				<p>@ Buck</p>
<p>First I will fully agree that finding virus signatures in encrypted data / program structures will not work 🙂<br />
But hopefully the ancient and from the beginning insane concept of using an endlessly growing virus signature database is nowadays not the only tool of AV software. How would they fill their database? Yes, after 2000+ infected machines and someone investigating they may find a “fingerprint” to add. A small virus modification … back to the start.<br />
Checking dead executes on disk is a nice attempt, however, from dead (encrypted) “data” on the HD a malware can’t run, the “data” has to be in RAM to be executed.</p>
<p>Running malware detection software on an infected machine is generally a problem, the (sophisticated) malware will answer all questions to perfection &#8211; or may kill the (known) AV program entirely.</p>
<p>E.g. the “Little Snitch” on my Mac has two problems:<br />
&#8211; I don’t know about connections which it doesn’t report (the malware),<br />
&#8211; I may accept “xyz wants to connect to port 80 of wu.apple.com”, but I would not allow (but don’t know) to upload more than a few Bytes.<br />
Same goes for ntp (UDP at port 123), allowed to any server, I love it, but would like to know about “unusual” use of it.<br />
It’s not the connection that’s dangerous in the first place, it’s the upload.</p>
<p>Only an external, clean and trusted observer is able to identify irregularities in destination, amount or content.<br />
The network connection is the ideal (and likely the only) point to observe and prevent data theft.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241854">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241854">
						February 19, 2015 6:23 PM					</a>

				</p>

				<p>@Sancho_P</p>
<p>Whilst I think I agree with much of what you&#8217;re saying, I can&#8217;t help but feel that something has been lost in the translation&#8230; Sorry, I&#8217;ll try my best to clarify soon. Thanks for your input!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241855">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241855">
						February 20, 2015 12:16 AM					</a>

				</p>

				<p>@Dirk Praet,</p>
<blockquote><p>unless for some reason it would be technically impossible</p></blockquote>
<p>Few things are technically impossible. It would be rather expensive to &#8220;fingerprint&#8221; an extension card which contains firmware running on an internal bus not mapped to the host memory address space.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241856">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241856">
						February 20, 2015 1:25 AM					</a>

				</p>

				<p>@ Dirk Praet, Wael,</p>
<p>Whilst few things are technically impossible, some are so difficult to do that they might as well be&#8230;</p>
<p>For instance you have an IO device with it&#8217;s own CPU, how do you ensure that that running CPU ROM/RAM does not contain modified code?</p>
<p>The obvious answer is halt the CPU and connect up to it&#8217;s internal buses&#8230; But what if you need the IO CPU running at the time for some reason such as it&#8217;s the display or disc controller?</p>
<p>Whilst there are technical solutions they are generaly neither easy or cheap, and in a cost sensitive market short cuts will be made&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241857">

			<div class="comment by-seriousaaha ">

				<p class="commentcredit">

					<span class="commenter">SeriousAAHA</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241857">
						February 20, 2015 7:56 AM					</a>

				</p>

				<p>Could this exploit be key that gives DARPAS &#8220;MEMEX&#8221; technology the ability to access, capture, and index the dark web (MEMEX as the front end)?</p>
<p>Background on Memex:</p>
<p><a href="http://www.shtfplan.com/experts/feds-unveil-new-surveillance-tool-developed-by-darpa-that-could-kill-the-dark-web_02142015" rel="nofollow ugc">http://www.shtfplan.com/experts/feds-unveil-new-surveillance-tool-developed-by-darpa-that-could-kill-the-dark-web_02142015</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241858">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241858">
						February 20, 2015 9:50 PM					</a>

				</p>

				<p>@Sancho_P</p>
<p>I think one of <a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html#c6689444" rel="nofollow ugc">@Clive Robinson</a>&#8216;s recent comments summarizes the issue quite succinctly:</p>
<blockquote><p>Thus when the AV techs go through the code they seen the known attack and deal with that, I as the attacker will see this avenue closed off, so will keep my head down for a bit before using the back door to get in again at a later date. I might even make the backdoor a &#8220;pull system&#8221; so that it reaches back to me at some point after it has not had it&#8217;s timer reset. As I&#8217;ve shown in the past you don&#8217;t need a dedicated command server to do this, you can use Google or any number of main stream services instead.</p></blockquote>
<p>(I can personally attest that Clive has indeed gotten to the real crux of the problem in the past, but I can&#8217;t seem to find any of those references off the top of my head)<br />
<a href="https://www.schneier.com/blog/archives/2015/02/friday_squid_bl_465.html#c6689669" rel="nofollow ugc">@Wael</a> also hit at it recently too:</p>
<blockquote><p>@Leia Organa,</p>
<blockquote><p>Wireshark should, but probably won&#8217;t, add an audio recording feature&#8230;</p></blockquote>
<p>That maybe a good start. What if the audio is encrypted or encoded in a proprietry format? All you can tell is the existance of some audio communication channel.</p></blockquote>
<p>Basically, connection monitoring is doomed to suffer the same fate as AV signatures. Novel exfiltration sequences will also be cryptographically encoded, so in effect we will be limited to looking only for known classes of previously discovered data smuggling routines.  Whitelisting hosts won&#8217;t help here either, because whitelisted hosts will just be abused to attack other whitelisted hosts until the target has been breached.</p>
<p>Unless we terminate operation of all information producing or observing systems, the leaks will continue to drip. Thus, the real trick is to not focus so much on prevention of attacks themselves, but on mitigation of any potential fallout from the theft of that data to begin with.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241859">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241859">
						February 21, 2015 5:35 AM					</a>

				</p>

				<p>@ Buck,</p>
<p>@Nick P is the one with the &#8220;link farm&#8221; 😉</p>
<p>However I&#8217;ve made various posts over the years about this sort of thing. However when searching for something else just now this quite recent comment of mine poped up,</p>
<p><a href="https://www.schneier.com/blog/archives/2014/01/friday_squid_bl_410.html#c4157362" rel="nofollow ugc">https://www.schneier.com/blog/archives/2014/01/friday_squid_bl_410.html#c4157362</a></p>
<p>Is it the one you were thinking off or one of the earlier ones?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241860">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241860">
						February 21, 2015 12:17 PM					</a>

				</p>

				<p>@ Buck</p>
<p>That whole second half of your post was spot on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241861">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241861">
						February 21, 2015 4:52 PM					</a>

				</p>

				<p>Thanks guys! 😉</p>
<p>I do remember that one Clive, but I know that I&#8217;ve definitely seen the same theme come up in a few more comments before&#8230; No need to dig them all up though. 😛</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241862">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241862">
						February 21, 2015 5:08 PM					</a>

				</p>

				<p>@Buck,</p>
<blockquote><p>Thus, the real trick is to not focus so much on prevention of attacks themselves, but on mitigation of any potential fallout from the theft of that data to begin with.</p></blockquote>
<p>Perhaps you&#8217;ll have better chances convincing @Nick P that his Castle is dripping? What you described is a Prison type mechanism! Tell him the Castle won&#8217;t be bulletproof unless we have access to HW and SW, including all Firmware and protocols, communication channels, transports, etc&#8230; High assurance, my ankle (or a little higher) 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241863">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241863">
						February 21, 2015 5:21 PM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8221; What you described is a Prison type mechanism! &#8221;</p>
<p>He actually described the monitoring and recovery aspects of overall security. Strong prevention is another aspect. My schemes all call for having both.</p>
<p>&#8220;Castle won&#8217;t be bulletproof unless we have access to HW and SW, including all Firmware and protocols, communication channels, transports, etc&#8230; &#8221;</p>
<p>The [in]security assumptions behind your critique also apply to prison architectures given the tendency of almost everything in hardware design to result in a monoculture or oligopoly for each market segment. At worst, the strong attackers fund a few more projects to cover the differences. The only counter to that kind of threat is distributed, transactional, diverse, obfuscated, verifying, P2P computation of each work unit with the voter itself distributed. The interface-level security might need to be stronger in this model. In this model, you&#8217;re trusting high level design correctness, interface, and probability that small percentage gets compromised.</p>
<p>A start on these are the recovery-oriented computing and software diversity papers I posted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241864">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241864">
						February 21, 2015 5:46 PM					</a>

				</p>

				<p>@ Buck</p>
<p>Thanks for coming back to that point.</p>
<p>Probably we were (are) a bit asynchronous so I’ll try to go through your comment in detail (my jumping mind, poor English and “short” postings often contribute to confusion, sorry):</p>
<p>From where you cited @Clive he was talking about the fire brigade only coming when there is already a severe fire, so you need 2000+ infections (<i>= ”above the noise”</i>) to trigger the AV boys’ investigation. One (or 500) dedicated, targeted breach(es) will never trigger their radar until by chance.</p>
<p>-&gt; AV software is not made to protect data of individuals. It’s made to prevent a pandemic.</p>
<p>In your quote @Clive wrote about offering a scapegoat, if it’s taken, hide in cover and wait: A nice idea but won’t work with AV <b>software</b> because the AV program won’t stop at the first hit (as a human probably would). So the malware has to have a unknown “signature” when trying to hide.<br />
And <i>“at a later date”</i> the AV may still watch …<br />
(To make use of encrypted malware there has to be something unencrypted “hidden” in RAM, before (to trigger) <b>and</b> when decrypting / manipulating files. AV should be able to detect that, but we are back at the 2000+ issue with signatures, + that the root kit malware <i>“… may kill the (known) AV program entirely”</i> whenever it’s going down to business.)</p>
<p>Then @Clive hinted to avoiding dedicated C&amp;C servers, at which our friends from the Equation Group were not up to that time (see the page 34ff. of the pdf report)</p>
<p>Clive’s linked post pointed at strange postings which indeed can be seen here in this forum: Pretty useless text (“thank you so much …”), probably a spam (ad) link in it so the Mod would hopefully find and delete it soon (you could call it “ephemeral posting” then), posted at a certain time, the “recipient” knows and will check the last 100 postings some seconds later, to find the posting and grab e.g. the user name to append it (like a salt) to the already known key phrase for today’s message (different channel).<br />
As Clive’s other hint (no crime in spy circles) is also true I will only reveal that there’s another salt in the message and it also depends how to use the salt shaker.<br />
Disclaimer: I (we) do not abuse Bruce’s forum for such bad bad bad things, <b>trust me</b>!!! 😉</p>
<p>Re: Connection monitoring is doomed (the second half for @ Nick P).</p>
<p>I dunno what @Leia Organa meant, it sounds insane to me at first (many clever things do, no sweat), but probably @Wael’s comment has taken you far away from my proposal and led you to the hilarious idea of fingerprinting of communication, similar to AV databases  🙂</p>
<p>Connection monitoring isn’t about content, because no machine can evaluate communication content for good, bad, correct, or malicious.<br />
Even a human observer could not, as no one could know whether the conversation is “encrypted” or not. I may write “Yes, it’s going to happen tonight” and the observer wouldn’t know ‘what’ would probably happen but there is no way they could know that “tonight” always means “this week on Friday”, because we (the recipient and I) always meet only on Friday at the pub.<br />
We need a lot of surrounding information to understand human communication, and we often fail (see our comments).</p>
<p>The idea to ban encryption is a far (political) shot to get other measures through,<br />
mind you, they are <b>not</b> stupid.</p>
<p>My proposal was only regarding outgoing data, the observer must be external (not in the root kit controlled universal Win or whatever PC).<br />
The data stream may be encrypted / compressed, and the observer may inform us about the most common types of content, which may be interesting, but wrong / misleading anyway (e.g. the used port doesn&#8217;t mean the data is what we&#8217;d expect).<br />
Digging deeper (e.g. frequency analysis) would involve too much time / delay for all connections but may be feasible for certain destinations to verify that the message is indeed encrypted.</p>
<p>Anyway, the content wouldn’t be the first question to ask an automated observer. The first question would be “How much” would go to “which destination + port” and “is this a known + confimed upload”.<br />
The latter is tricky and involves some learning (“please confirm upload of 2.5 kB to <a href="https://www.schneier.com" rel="nofollow ugc">https://www.schneier.com</a> at 204.11.247.93”) to accept it as “known size and destination” but we do not upload so much stuff, most is sending requests &#8211; that could be basic knowledge of the observer.</p>
<p>You wrote <i>”… because whitelisted hosts will just be abused to attack other whitelisted hosts until the target has been breached.”</i> but sorry, I did not understand that: When you think of MITM attacks (CA model) or that the destination is already owned by the adversary &#8211; these are different issues, the observer can’t help in both cases.</p>
<p>However, there is another point I’d like to make for the external observer:<br />
I’d add a simple timer to the “confirmation” button, that is, the PC can only upload for a couple of minutes after pressing the button. If there is no outgoing (http or whatever) request from the PC the timer will run down and prevent any upload <b>until the user is present</b> again.<br />
Of course a LED would indicate any upload above a couple of bytes to the user (chilling, reminds me of the sound of modems).</p>
<blockquote><p><i>“Unless we terminate operation of all information producing or observing systems, the leaks will continue to drip. Thus, the real trick is to not focus so much on prevention of attacks themselves, but on mitigation of any potential fallout from the theft of that data to begin with.”</i><br />
(Buck)</p></blockquote>
<p>I will slightly agree when you think about avoiding nude selfies on your PC but I can not accept the basic idea that my machine is open to any investigation without my consent.</p>
<p>Long posting, thanks for reading!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241865">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241865">
						February 21, 2015 7:51 PM					</a>

				</p>

				<p>@Wael &amp; Nick P</p>
<p><a href="http://m.youtube.com/watch?v=YADkRK5tDaY" rel="nofollow ugc">http://m.youtube.com/watch?v=YADkRK5tDaY</a></p>
<p>@Sancho_P</p>
<p>Sorry, I really oughta brush up some of my foreign language skills! 😉 Meanwhile, I will try to address what I feel are our biggest misunderstandings as soon as possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241866">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241866">
						February 21, 2015 10:10 PM					</a>

				</p>

				<p>@Buck, @Nick P</p>
<p>The rain will stop when there are no clouds or when there is no one left to witness the &#8220;rain&#8221;!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241867">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241867">
						February 21, 2015 10:35 PM					</a>

				</p>

				<p>@Wael</p>
<p>Ahhh&#8230; So when that tree falls in the woods, it won&#8217;t make a sound..?</p>
<p>Seems to me as though you two generally agree &#8211; at least when you&#8217;re not pouring gasoline on each other! 😉</p>
<p>I think your C v P argument is deeply entrenched with now outdated assumptions and divisive generalities based on analogies/metaphors/trivialities&#8230; But hey, who am I to speak on such matters!? 😛</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241868">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241868">
						February 21, 2015 11:18 PM					</a>

				</p>

				<p>@Buck,</p>
<blockquote><p>Ahhh&#8230; So when that tree falls in the woods, it won&#8217;t make a sound..?</p></blockquote>
<p>Funny! I almost referenced this <a href="https://www.schneier.com/blog/archives/2013/10/nsa_eavesdroppi_2.html#c2122067" rel="nofollow ugc">unperceived existence</a> link when I posted, but was too lazy. Now you bring it up; it was meant to be brought to attention, I guess.</p>
<blockquote><p>Seems to me as though you two generally agree &#8211; at least when you&#8217;re not pouring gasoline on each other! 😉</p></blockquote>
<p>Yes we do! The gasoline is just us fooling about &#8212; don&#8217;t take it seriously 😉 I like @Nick P, even @Figureitout (masquerading as me) can attest to <a href="https://www.schneier.com/blog/archives/2014/08/friday_squid_bl_437.html#c6676257" rel="nofollow ugc">it</a>&#8230; lol</p>
<blockquote><p>I think your C v P argument is deeply entrenched with now outdated assumptions and divisive generalities based on analogies/metaphors/trivialities.</p></blockquote>
<p>I&#8217;m coming to realize that @Nick P&#8217;s design isn&#8217;t a pure &#8220;Castle&#8221; it does contain elements of a &#8220;Prison&#8221;. I was simply trying to breakdown and model the elements of security and map them to the definition then go from there before we talk about &#8220;Firewalls&#8221;, &#8220;Firmware&#8221;, &#8220;subversion&#8221; etc&#8230; Or at least to understand at the high level what our best weapons are!</p>
<blockquote><p>But hey, who am I to speak on such matters!? 😛</p></blockquote>
<p>Didn&#8217;t stop @Nick P from speaking about them 🙂 didn&#8217;t stop me either. It&#8217;s all good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241869">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241869">
						February 21, 2015 11:22 PM					</a>

				</p>

				<p>@ Clive</p>
<p>&#8220;@Nick P is the one with the &#8220;link farm&#8221; ;-)&#8221;</p>
<p>I&#8217;d prefer to think of it as a prestigious, well-curated museum of IT and INFOSEC history. Then, I remember the barely organized mess it is and&#8230; I&#8217;ll clean it up eventually. I got the search feature meanwhile. Haha.</p>
<p>@ Sancho_P</p>
<p>I don&#8217;t see myself posting anything to you in this thread. What specifically are you responding to and which points in your post? (Quite a few names in &#8220;the second half.&#8221;) Just trying to be clear about what points you&#8217;re directing at me and why.</p>
<p>@ Buck</p>
<p>re the video</p>
<p>Nice song. Hadn&#8217;t heard it in a while. Regardless, no need to wait for someone to stop the rain: America should just <a href="https://www.youtube.com/watch?v=aTL4qIIxg8A" rel="nofollow ugc">wake up</a> and act like it&#8217;s raining.</p>
<p>&#8220;I think your C v P argument is deeply entrenched with now outdated assumptions and divisive generalities based on analogies/metaphors/trivialities&#8230; &#8221;</p>
<p>That&#8217;s what I&#8217;ve been telling them. I don&#8217;t like the metaphor. The closest buzzphrase to what I attempt is Correct by Construction: using highly assured methods to design the thing right with a proof showing it has claimed properties. Here&#8217;s <a href="http://www.anthonyhall.org/c_by_c_secure_system.pdf" rel="nofollow ugc">a case study</a> on one of those methodologies. My old strategy focused on isolation kernels with assured pipelines of communication between components. The TCB would be built with methods similar to above case study. Now, I focus on applying such rigor to hardware-software combinations that make enforcing the security properties easier.</p>
<p>I&#8217;m sure there&#8217;s a good metaphor for that somewhere out there. Meanwhile, I just keep calling it high assurance security engineering: an engineered solution to a security problem whose design and implementation justify high confidence that it works. That simple.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241870">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241870">
						February 21, 2015 11:42 PM					</a>

				</p>

				<p>@Nick PMeanwhile, I just keep calling it high assurance security engineering: an engineered solution to a security problem whose design and implementation justify high confidence that it works. That simple.Is it really so simple though? Your &#8220;distributed, transactional, diverse, obfuscated, verifying, P2P computation&#8221; can actually be derived from our abstract prison&#8217;s methods to account for inherent human uncertainties/vulnerabilities! Confidence maybe, but assurance? Certainly not&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241871">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241871">
						February 21, 2015 11:44 PM					</a>

				</p>

				<p>Accidentally started with an end tag :-\ this should be a bit more legible:</p>
<p>@Nick P</p>
<blockquote><p>Meanwhile, I just keep calling it high assurance security engineering: an engineered solution to a security problem whose design and implementation justify high confidence that it works. That simple.</p></blockquote>
<p>Is it really so simple though? Your &#8220;distributed, transactional, diverse, obfuscated, verifying, P2P computation&#8221; can actually be derived from our abstract prison&#8217;s methods to account for inherent human uncertainties/vulnerabilities! Confidence maybe, but assurance? Certainly not&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241872">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241872">
						February 21, 2015 11:58 PM					</a>

				</p>

				<p>@Buck,</p>
<blockquote><p>Your &#8220;distributed, transactional, diverse, obfuscated, verifying, P2P computation&#8221;</p></blockquote>
<p>Ummm, Buck! Don&#8217;t forget @Nick P is from the south! You know, the &#8220;Orange Book&#8221; belt?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241873">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241873">
						February 21, 2015 11:59 PM					</a>

				</p>

				<p>@ Buck</p>
<p>Oh no, that thing is a monstrosity created in response to the assumptions that absolutely everything is going to be compromised by various attacks. There are smaller assumptions that allow for much simpler designs. An older example trust the hardware to do its job while providing strong containment with separation kernels. A simple version of my monstrosity comes from Clive and I&#8217;s voting schemes: same highly assured software running on diverse hardware/software implementations with a simple voter checking the results. The obfuscation might involve what hardware, firmware, OS, drivers, language, and so on. There are, in existence and in development, various methods to automatically diversify software which can be tied into high assurance development. P2P is just a system of systems which we have modeling techniques for.</p>
<p>And so on and so forth. The models with simpler assumptions are easier to handle with high confidence. The full monstrosity addition is medium assurance at best. There is potential for high assurance in between the two. I try to select components in such a way as to minimize the number of worries I have and move things toward the simpler problems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241874">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241874">
						February 22, 2015 12:11 AM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8220;I&#8217;m coming to realize that @Nick P&#8217;s design isn&#8217;t a pure &#8220;Castle&#8221; it does contain elements of a &#8220;Prison&#8221;. I was simply trying to&#8221;</p>
<p>FINALLY! And to think that my starting point (Orange Book) used high assurance methods to implement a security model that was mostly <em>containment</em> of information in various levels and compartments (a prison?). Only took you several years to notice.</p>
<p>&#8220;Ummm, Buck! Don&#8217;t forget @Nick P is from the south! You know, the &#8220;Orange Book&#8221; belt? &#8221;</p>
<p>You motherf&#8230;</p>
<p>&#8220;Yes we do! The gasoline is just us fooling about &#8212; don&#8217;t take it seriously 😉 I like @Nick P&#8221;</p>
<p>Of course! I like you too, buddy. Otherwise, the &#8220;&#8230;&#8221; would&#8217;ve been a lot longer and NSFW. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241875">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241875">
						February 22, 2015 12:22 AM					</a>

				</p>

				<p>@Nick P</p>
<p>Maybe, but I&#8217;m not sure if I can believe you, unless you can clearly define your concepts in the terms of human capabilities&#8230;</p>
<p>Or as Wael might say:</p>
<blockquote><p>breakdown and model the elements of security and map them to the definition then go from there before we talk about &#8220;Firewalls&#8221;, &#8220;Firmware&#8221;, &#8220;subversion&#8221; etc&#8230;</p></blockquote>
<p>P.S.: It&#8217;s OK! 😉 I&#8217;m from the south too&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241876">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241876">
						February 22, 2015 12:38 AM					</a>

				</p>

				<p>@ Buck</p>
<p>It&#8217;s already been done in a variety of situations. What we lack is a place that puts all the knowledge and wisdom together in a way that&#8217;s easy for the aspiring to make use of. Major government programs are unlikely to fund such a thing (personal experience) unless one can show that it will have buy-in. Private groups might. Who knows. If I ever get a chance, I&#8217;ll give you exactly that.</p>
<p>&#8220;P.S.: It&#8217;s OK! 😉 I&#8217;m from the south too&#8230;&#8221;</p>
<p>I know. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241877">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241877">
						February 22, 2015 12:47 AM					</a>

				</p>

				<p>@Buck, @Nick P,</p>
<p>Perhaps I inadvertantly offended you &#8211; my apologies&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241878">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241878">
						February 22, 2015 1:12 AM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8220;Perhaps I inadvertantly offended you &#8211; my apologies&#8230;&#8221;</p>
<p>The metaphor was annoyingly distracting as usual. Past that&#8230; no offense at all. All in jest. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241879">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241879">
						February 22, 2015 2:26 AM					</a>

				</p>

				<p>@Nick P,</p>
<p>C-v-P: Quit calling it an &#8220;analogy&#8221; &#8212; it&#8217;s not! Although it may have started that way between you and @Clive Robinson, and we decided long ago that we drop the analogy and move to a &#8220;model&#8221;.</p>
<blockquote><p>FINALLY! And to think that my starting point (Orange Book) used high assurance methods to implement a security model that was mostly *containment* of information in various levels and compartments (a prison?). Only took you several years to notice.</p></blockquote>
<p>Your &#8220;high assurance&#8221; methods are sound and all. However, they depend on one false assumption: The trust in other entities. Unless you control every thing including the &#8220;trust assurance certifications&#8221; and the &#8220;Formal testing and proofs&#8221;, your systems will be vulnerable to the attacks we are currently witnessing. You surely felt warm and fuzzy with an EAL 5+ SIM or smart card. Tell me how you feel about your &#8220;high assurance&#8221; now that you know someone has the private keys? What else don&#8217;t you know? In other words, what other assumptions have you made that became not true today? Take the hard drive firmware holes we saw recently&#8230; Are you <b>yourself</b> going to code review all the firmware? Are you going to pen test it? Or will you just accept a report that gives it a FIPS rating? The best solution you have right now is to complement your high assurance systems with additional OPSEC procedures, which will limit the functionality of the systems.</p>
<p>How about the advice of using &#8220;older&#8221; hardware? That&#8217;s also based on an assumption, although some people give it a probabilistic confidence level higher than newer hardware without proof, mind you. You know I am still waiting for someone to tell me <a href="https://www.schneier.com/blog/archives/2013/10/on_secrecy_1.html#c1846149" rel="nofollow ugc">at what point in time</a> chips were subverted!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241880">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241880">
						February 22, 2015 4:21 AM					</a>

				</p>

				<p>@ Buck,</p>
<p>@Nick P does not like &#8220;Castle-v-Prison&#8221; or as Wael contracted it &#8220;CvP&#8221; as a name, not as a series of ideas (one day I&#8217;ll ask him what he thinks of the name &#8220;Cathedral and the Bazaar&#8221; as long as we can both &#8220;duck n cover&#8221; from the &#8220;Most outrageously offensive&#8221; Fossie brigade 😉</p>
<p>I started thinking about how to deal with subversion in the computer stack a while ago (although it feels like eons it was only last century). Back then few people thought about what goes on down under the nebulous physical layer and what goes on above the presentation layer of the ISO OSI &#8220;seven layer&#8221; stack. At some point somebody defined layer 8 as &#8220;wet ware&#8221; but these days you quite often hear people joke about &#8220;layer 8&#8221; user problems or &#8220;layer 9&#8221; managment problems and &#8220;layer 10&#8221; political problems, which no doubt will get further expanded with time.</p>
<p>When it comes to &#8220;Intrinsicaly Safe&#8221; systems design &#8211;which I used to do&#8211; you quickly learn that the physical problems start with the &#8220;energy&#8221; and mass and work up from there. One lesson you learn is there is no such thing as &#8220;safe energy&#8221; or &#8220;unsafe energy&#8221; just energy in environmets. The underlying principle of IS is entropy happens to matter and thus &#8220;faults occure and you have to mitigate them safely&#8221;, thus you look at a design from that perspective.</p>
<p>As people are starting to realise &#8220;safety&#8221; is a quality issue as is &#8220;reliability&#8221; / &#8220;availability&#8221; and &#8220;security&#8221;, that is they are in effect all facets of the same problem, and that quality is a mitigation process . Further that quality is a &#8220;day -1&#8221; asspect of any project, that is a quality process has to be in place before the project is even thought of.</p>
<p>With that in place you then start thinking about the computing stack and what quality means and how you obtain it. One thing you end up realising, is that there are two aproaches you can take to get to a desired out come &#8220;bottom up&#8221; or &#8220;top down&#8221;. You also realise that there is an implicit assumption in nearly all &#8220;security reasoning&#8221; which is you start from a secure base or point, and reason forward from it.</p>
<p>What is usually not stated is how you get the secure base or point to start off with, especially when you remember that neither energy or matter are &#8220;secure&#8221; by default, and even if currently secure entropy says that the current state will change&#8230;</p>
<p>Which is a problem because it tells you that a secure base or point does not exist naturally, you have to create them, further even having created a secure base or point, you have to ensure it remains secure from that point on&#8230;.</p>
<p>Which is probably why @Nick P says,</p>
<blockquote><p>Oh no, that thing is a monstrosity created in response to the assumptions that absolutely everything is going to be compromised by various attacks.</p></blockquote>
<p>Yes it&#8217;s a monstrosity, but like all real monsters it consists of many interwoven, interworking and interdependent parts and as such there is a certain minimum of parts you need to ensure it works.</p>
<p>Look at it this way a monsters heart is not the monster, and to function as the heart it needs the blood, lungs, liver, digestive tract etc to function, but those other parts need the heart functioning or all you have is a rotting pile of monster bits&#8230;</p>
<p>The real question is thus &#8220;What is the minimum&#8221; to which the answer is we don&#8217;t realy know.</p>
<p>For instance you see a lot of talk about &#8220;secure software&#8221; in design, build and use, but it is only valid if the platform it runs on is secure.<br />
As has just publicaly been made clear with the NSA HD firmware attack you can not trust the standard hardware, because you can not establish trust. The COTS motherboard CPU can not see what is on the HD platters it has to ask the HD controller. The controller functionality comes from the firmware in it&#8217;s flash memory and from a hidden place on the HD platters. The motherboard CPU has no way to reliably check what the controler flash or HD platters have in the way of firmware because the controller has to be functioning for the motherboard CPU to communicate with it. The reason it&#8217;s not reliable is the controler will tell the motherboard CPU whatever the running controller firmware tells it to&#8230; Catch-22.</p>
<p>Likewise the COTS motherboard CPU will only tell you what it&#8217;s software tells it to, and that software came via the HD controler&#8230;</p>
<p>There is no real way for you to check that your once secure software is still secure, because you do not have an independent and transparent and verifiable verification mechanism.</p>
<p>You could add a PC card that uses the COTS motherboard DMA channel, to examin the memory, and this is just part of the &#8220;Prison&#8221; process. However you could argue that such a PC card would have it&#8217;s own controller&#8230; however you could design the PC card with it&#8217;s own verification port.</p>
<p>That said as long as the verifing system is Turing compleate then you can not trust it. Thus you have to design a state machine verifier where all states are known and can not be changed.</p>
<p>That can be fairly easily be seen to establish an initial chain of trust. However unless the systemchecks the chain periodicaly the trust can not be assumed to remain, which is a major failing of all current COTS systems.</p>
<p>The question then is how do you limit the ability of malware getting into the system inbetween the checking times&#8230; Well there are several ways, but I think this post is long enough as it is.</p>
<p>And before you ask, yes I was well aware of the problem of modifing firmware back nearl a third of a century ago when I designed and got aporoved the first 16bit Intrinsically Safe RTU. It was based around an 8086 and originally had a number of 8051 microcontrolers to do various types of IO for reading pannel controlls and some types of instrumentation as well as controlling communications equipment for both reliable and secure communications across open channels. Needless to say I had a few run ins with managment over it and they vetoed the security asspects&#8230; something they might think differently about today, if they are still working&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241881">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241881">
						February 22, 2015 1:03 PM					</a>

				</p>

				<p>@Clive Robinson, @Nick P, @ Buck,</p>
<p>Evidently @Nick P&#8217;s designs, approach, and recommendations cannot be accurately described as a &#8220;Castle&#8221;. If you want to drop the labeling, then you will need to shift the discussion to &#8220;My approach&#8221; vs. &#8220;His approach&#8221;. Feel free to use different terminology.</p>
<p>I repeatedly tried to abstract out the characteristics of the Castle and the Prison without much success or agreement. Looking back at the discussion thread, I realize I was trying to achieve a different goal, that I oulined on several occasions, than what you two originally aimed for &#8212; perhaps that&#8217;s the reason we haven&#8217;t progressed much in the past three years, although it was a fun discussion.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241882">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241882">
						February 22, 2015 1:30 PM					</a>

				</p>

				<p>@ Wael</p>
<p>I&#8217;ll address smaller statements before the big one.</p>
<p>&#8220;Unless you control every thing including the &#8220;trust assurance certifications&#8221; and the &#8220;Formal testing and proofs&#8221;, your systems will be vulnerable to the attacks we are currently witnessing.&#8221;</p>
<p>You have to put your trust into something. Still, I don&#8217;t have to control everything. I only need my distributed, secure SCM concept with entities involved that I can trust to do their part. Bonus points to their trustworthiness if they&#8217;re ideological, paranoid, and/or have skin in the game (eg use deliverable). I&#8217;d also have members of intelligence services involved to reduce the likelihood that one state actor could shut everyone up. If everyone&#8217;s product comes out the same, then the result should inspire high confidence that it does only what it claims to.</p>
<p>&#8220;You surely felt warm and fuzzy with an EAL 5+ SIM or smart card. Tell me how you feel about your &#8220;high assurance&#8221; now that you know someone has the private keys?&#8221;</p>
<p>EAL5+ is medium assurance. The plus signifies a few pieces are higher assurance. I feel the same about them: they offer significantly higher security against most attackers than the competition. I&#8217;d also avoid the key escrow option or request a method to ensure I control keys generated on-chip. That must be independently evaluated. I&#8217;m pretty sure some company already offers it. Anyway, even if I used vanilla smart cards, I&#8217;d have avoided <em>this</em> compromise because you and I already agreed that another company was the best at security IC (esp TPM&#8217;s).</p>
<p>&#8220;Take the hard drive firmware holes we saw recently&#8230; Are you yourself going to code review all the firmware? &#8221;</p>
<p>If you trust the firmware, you&#8217;re Doing It Wrong. My advice has always been to use a host IOMMU, a per-device guard with PIO + trusted driver, or a typical network guard mediating a machine dedicated for that function. I also advice mixing up which manufacturers and software you use for each. Combined with EAL6+ trusted software, the vast majority of their TAO catalog wouldn&#8217;t have worked.</p>
<p>&#8220;The best solution you have right now is to complement your high assurance systems with additional OPSEC procedures, which will limit the functionality of the systems.&#8221;</p>
<p>Yep: diversity and obfuscation as I said above. Also makes for good insurance against surprises in trusted software.</p>
<p>&#8220;How about the advice of using &#8220;older&#8221; hardware? That&#8217;s also based on an assumption&#8221;</p>
<p>I&#8217;ve already <a href="https://www.schneier.com/blog/archives/2013/11/friday_squid_bl_400.html#c2368845" rel="nofollow ugc">explained</a> it to you. I&#8217;ll add that <em>all leaks</em> indicate they have an ongoing program to break into different stuff that took until 2008 to get some critical successes. Recent leaks show their subversion programs began years after 9/11. No assumptions: just concrete evidence from the inside along with probability. There&#8217;s a risk that a datapoint, esp in a SAP, hasn&#8217;t leaked yet and the subversion happened a few years before. I documented that in my essay, though.</p>
<p>&#8220;You know I am still waiting for someone to tell me at what point in time chips were subverted!&#8221;</p>
<p>2001-2004 mainstream. 2004-ongoing anything else. Chips themselves might not even be subverted: NSA just attacks errata, firmware, and so on.</p>
<p>Security models are next.</p>
<p>EDIT: Just noticed several posts showed up while writing this. I&#8217;ll respond to them later, maybe. I promised the security models and I&#8217;m halfway into it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241883">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241883">
						February 22, 2015 1:56 PM					</a>

				</p>

				<p>@ Wael</p>
<p>re CvP and security models</p>
<p>Oh you want a model. A single model that governs the security of every conceivable type of system. Two models that divide the entire field into two neat categories? I hate to tell you, Wael, but there&#8217;s no such thing. There are many types of systems, attributes, and security policies. Each one is easy to model using one set of techniques, but hard to model using others. Even within one system we find that formal verification (includes models) must use different tools for, say, computation and I/O. So, there&#8217;s no reductionist cheating in our field.</p>
<p>I can give you some security models to play with, though.</p>
<p><i>MLS/MILS non-interference model</i></p>
<ul>
<li>All active entities in the system are subjects</li>
<li>All entities they can manipulate are objects</li>
<li>They are isolated by default</li>
<li>A security policy exists for how subjects can manipulate objects</li>
<li>A security kernel (or mechanism) mediates every access</li>
<li>Hard to express many security policies using pure isolation</li>
<li>Implemented by Aesec GEMSOS, Boeing SNS Server, XTS-400, and INTEGRITY-178B</li>
</ul>
<p><i>Capability-security model</i></p>
<ul>
<li>Builds on capabilities (pointers) that act as keys</li>
<li>Access to individual resources or methods requires a pointer to it</li>
<li>Pointers are unique, only created via trusted software/mechanisms, can&#8217;t be modified by untrusted data, and must be unforgeable in general</li>
<li>Capabilities might be passed as arguments to functions or used to build data structures</li>
<li>Special techniques exist for controlled propogation and revokation</li>
<li>Can express arbitrary security policies</li>
<li>Closest thing to your &#8220;One Model to Rule Them All&#8221; preference</li>
<li>Implemented by KeyKOS, CAP, System/38, EROS, and CHERI</li>
</ul>
<p><i>Information flow control model</i></p>
<ul>
<li>System activity is a series of information flows between entities in system</li>
<li>Sources and destinations of flows are labeled</li>
<li>A security policy dictates permissible flows</li>
<li>A reference monitor (hardware or software) ensures only permissible flows happen</li>
<li>Reference monitor might also look for risky flows (taint-based methods)</li>
<li>Like assured pipelines, it can express many security policies</li>
<li>Implemented by SAFE w/ Breeze and Cornell&#8217;s SIF</li>
</ul>
<p><i>Language-based security model</i></p>
<ul>
<li>Identify correctness or security properties system needs</li>
<li>Build a type system that prevents or detects insecure constructions</li>
<li>Integrate that with an existing or new programming language</li>
<li>Construct tools that convert that to an executable embodying same properties</li>
<li>Build system or application in that language and tools do the rest</li>
<li>Researchers stretch this into new use cases every year</li>
<li>Risk is in abstraction gaps, translation, and/or runtime</li>
<li>Examples include SPIN OS in Modula-3, JX OS in Java, and ASOS in Ada (also fits MLS)</li>
<li>Tagged processors enforcing language-related typing (eg SAFE, SSP) are also examples</li>
</ul>
<p><i>Security through artificial diversity model</i></p>
<ul>
<li>Assumes success of single attack goes down as diversity of targets increases</li>
<li>Identify the various attributes targeted or leveraged in attacks</li>
<li>Diversify those as much as possible</li>
<li>Amount of manual effort, diversity, and granularity varies between techniques</li>
<li>Leads to probabilistic security argument</li>
<li>Weaker than others: best used in combination with strong model</li>
</ul>
<p><i>Security through cryptographic protection of TCB</i></p>
<ul>
<li>Usually just a MILS, capability, or info-flow model with crypto</li>
<li>Gets its own category because the researchers all do similar things</li>
<li>Encryption is used for confidentiality of data and/or integrity of instructions</li>
<li>Design makes unauthorized reads get scrambled data</li>
<li>Unauthorized attacks on control flow causes integrity checks to fail</li>
<li>Designs might make processes, devices, and/or everything outside CPU untrusted</li>
<li>Used in Aegis, SP, HAVEN, SecureME, and many modern prototypes</li>
<li>Modern work either models them with MILS or information flow control</li>
</ul>
<p><i>Control flow integrity (weaker)</i></p>
<ul>
<li>Included because all successful models must have this property</li>
<li>This property by itself prevents external data from hijacking a system</li>
<li>Can be applied at hardware, firmware, and software levels</li>
<li>Can be compatible with legacy code or use purpose-built languages</li>
<li>If hijacking is prevented, basic software and language techniques can do the rest</li>
<li>Potentially the easiest and cheapest option if no others are available</li>
<li>Examples include Burrough&#8217;s B5000 (1961), NaCl, CPI, and many academic prototypes</li>
</ul>
<p>So, there&#8217;s you some models to play with. The next thing for you to do is to map a given system&#8217;s features and security requirements onto one of the models. Then, you implement it using high assurance techniques. Boom: a [hopefully] secure system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241884">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241884">
						February 22, 2015 2:27 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>Um, I’m a bit confused now, here’s what I saw in this thread:</p>
<p>Buck,   17, 09:29 PM (@all, short)<br />
Buck,   17, 10:29 PM (@all, but does it have 2 parts?)<br />
&#8211; 18, 05:26 PM (Sancho, reply @Grauhut)<br />
Buck,   18, 10:56 PM (comment @Sancho &#8211; Grauhut)<br />
&#8211; 19, 06:04 PM (Sancho, reply @Buck)<br />
Buck,   19, 06:23 PM (short @ Sancho)<br />
<b>Buck</b>,    20, 09:50 PM (reply @Sancho)<br />
&#8211; Clive,    21, 05:35 AM (reply @Buck &#8211; Sancho)<br />
<b>Nick P</b>,  21, 12:17 PM (<b>@Buck</b>: <i>“That whole second half of your post was spot on.”</i><br />
&#8211; 21, 05:46 PM (Sancho mentioning Nick P for the second half)</p>
<p>My guess was you were referring to @Buck 20, 09:50 PM replying to me, the second half of his posting starting “Basically …”.<br />
In fact there is a third part in Buck’s posting, but it seems you didn’t address that either?<br />
Just wanted to give you a handle to find my comment, which would also disagree with your <i>”was spot on”</i>.</p>
<p>Sorry if I got that wrong!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241885">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241885">
						February 22, 2015 3:23 PM					</a>

				</p>

				<p>@ Sancho_P</p>
<p>You&#8217;ve just illustrated the advantage of sub-threading on forums quite nicely. 😉 Alright, here&#8217;s what I agreed with:</p>
<p>&#8220;Basically, connection monitoring is doomed to suffer the same fate as AV signatures. Novel exfiltration sequences will also be cryptographically encoded, so in effect we will be limited to looking only for known classes of previously discovered data smuggling routines. Whitelisting hosts won&#8217;t help here either, because whitelisted hosts will just be abused to attack other whitelisted hosts until the target has been breached&#8221;</p>
<p>&#8220;Thus, the real trick is to not focus so much on prevention of attacks themselves, but on mitigation of any potential fallout from the theft of that data to begin with.&#8221;</p>
<p>I thought his critique of connection monitoring was spot on. I&#8217;ve used variations on this approach and let&#8217;s say it&#8217;s ridiculously hard to do with strong security. You have to greatly constrain the communication protocol&#8217;s data formats and operations. You also have to strongly enforce integrity and authentication. Each application will have its own type, list of permissible operations, and so on. Guard software and configurations must be done per app. Covert channel mitigation must be applied to transport level if TCP/IP. Only then, can connection monitoring hope to achieve something without being bypassed by existing or novel techniques. I doubt you will find any major app or commercial network meeting these requirements. So, connection monitoring by itself can&#8217;t counter strong attackers hitting such apps and networks.</p>
<p>His whitelisting argument is true, too. For one, the whitelisting method might be attacked. An example is forged IP&#8217;s for IP-based whitelisting. Two, the system might be compromised by incoming data&#8217;s effect on lower layers before whitelisting code even runs. Three, DDOS attacks on whitelisted hosts might force users or admins to work around whitelisting for a homebrew solution [which is insecure]. So, whitelisting on insecure machines isn&#8217;t going to stop strong attackers. It&#8217;s great for stopping some social engineering and spearfishing attacks, though. DefenseWall showed it can block some malware, too.</p>
<p>Additionally, I agreed that it&#8217;s good to &#8220;mitigate potential fallout from theft of that data.&#8221; The fallout comes in a number of forms. The exposure of the data itself can be mitigated by keeping it encrypted in storage and/or untrusted processing. This would&#8217;ve mitigated leaks from physical hard disk failures, hacks of legacy database machines, and some attacks on virtualized systems. Another aspect is recovery: ensure you can recover your machines and data to a clean state rapidly. I&#8217;m sure you understand the benefits and issues here enough that I don&#8217;t need to explain further.</p>
<p>So, that sums up my thoughts on what I saw. Now, let me look at your comment in light of that.</p>
<p>You&#8217;re comment basically describes an NIDS that tries to identify malicious leaking of outgoing data. Am I right or wrong? As is typical there, you try to leverage the metadata of the connections (including past history) to estimate how legitimate it is. This has many of the issues I describe above and I&#8217;ll add that <em>these systems have already been beaten.</em> There&#8217;s a huge cat and mouse game here where the cats win more often. One example technique is disguising the C&amp;C as HTTPS sessions with traffic behavior consistent with web applications or browsing. Takes a certain set of skills and setup to reliably spot such a leak. And that&#8217;s just one method many with a range of dozens of techniques on about as many OS&#8217;s and protocols!</p>
<p>You also mention an external device that mediates uploads where user has to physically authorize it. Now you&#8217;re getting closer to the The Right Thing approach to this situation. The problem is that you&#8217;re just looking at download time. You should look at the data&#8217;s characteristics and metadata about destination like you did above. Then, combine that with the external device to leverage its trusted functionality to validate those things and even facilitate the transfer. For an example, look up how Nexor combines their Outlook-compatible proxy with a robust, mail guard for an easy-to-use, secure email solution. Think of how you might do something similar for uploads.</p>
<p>EDIT: This is actually already a solved problem. I was enjoying the conversation and overlooked the obvious fact that there&#8217;s a whole industry dedicated to this: cross-domain solutions. This usually involves a guard with both automated and manual inspection available. The endpoints need some strong isolation capability (eg MLS, MILS, SKPP) with labels on different partitions. The networking system, isolated in its own partition, puts the labels on the packets. Smart implementations do IPsec-style protection of packet data/metadata. The guard makes decisions on information flow based on metadata, data, and labels. Example would be a <a href="http://www.lynx.com/products/hypervisors/lynxsecure-separation-kernel-hypervisor/lynxsecure-secure-by-design/" rel="nofollow ugc">MILS Workstation</a> + BAE&#8217;s <a href="https://en.wikipedia.org/wiki/XTS-400" rel="nofollow ugc">XTS-400</a> + <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.133.4225&amp;rep=rep1&amp;type=pdf" rel="nofollow ugc">SAGE</a>.  Boeing&#8217;s <a href="http://www.dtic.mil/cgi-bin/GetTRDoc?Location=U2&amp;doc=GetTRDoc.pdf&amp;AD=ADA425566" rel="nofollow ugc">OASIS</a> architecture modernized it with a more clean-slate approach. E programming language does <a href="http://combex.com/tech/index.html" rel="nofollow ugc">something similar</a> at the object level for distributed systems and could be ported to, say, JX Operating System.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241886">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241886">
						February 22, 2015 5:17 PM					</a>

				</p>

				<p>@Nick P,</p>
<blockquote><p>Oh you want a model. A single model that governs the security of every conceivable type of system. Two models that divide the entire field into two neat categories?</p></blockquote>
<p>Yes! I am after that model! It doesn&#8217;t have to be two, it can be more.</p>
<blockquote><p>I hate to tell you, Wael, but there&#8217;s no such thing.</p></blockquote>
<p>I know, let’s make such a thing! But I think you are saying: Such a thing cannot exist — It&#8217;s impossible.</p>
<blockquote><p>Each one is easy to model using one set of techniques, but hard to model using others. </p></blockquote>
<p>Great! Now substitue these in a definition of security of your choice, then tell me how secure or insecure the system is!</p>
<blockquote><p>Even within one system we find that formal verification (includes models) must use different tools for, say, computation and I/O. So, there&#8217;s no reductionist cheating in our field.</p></blockquote>
<p>This is about validating the low level work to be done later. It’s not a reductionist cheating, its a validation vector that tells us what it is were trying to achieve and how it fits in the big picture. It tells us what other gaps exist (in terms of the security definition) that need to be bridged.</p>
<blockquote><p>I can give you some security models to play with, though.</p></blockquote>
<p>I’m familiar with some of them — not all. But I’ll humor you and continue…</p>
<blockquote><p>A security policy exists for how subjects can manipulate objects</p></blockquote>
<ol>
<li>Where did the policy come from?</li>
<li>Who protects the policy?</li>
</ol>
<blockquote><p>A security kernel (or mechanism) mediates every access</p></blockquote>
<ol>
<li>Who developed the kernel</li>
<li>Who verified its functionality</li>
<li>Source code available?</li>
</ol>
<p>What you describe is protection against bugs, security flows and unintentional weaknesses. Does it really cover subversion and defending against an adversary who has control on everything from the silicon all the way to layer 12?</p>
<blockquote><p>Then, <b>you implement it</b> using high assurance techniques. <b>Boom: a [hopefully] secure system.</b></p></blockquote>
<p>Uh! But I’m not willing to implement every component of the system by myself! <b>Bang! The system doesn&#8217;t exist, therefore it&#8217;s <i>unconditionally secure</i> 🙂</b> &#8212; ok, @Buck: You can chime in about &#8220;The possibility of unperceived existence&#8221; 🙂</p>
<p>However, the model + the definition will help you identify what “minimal” component you need to control to give you the desired security properties of the platform! I detailed an example once on confidential &#8220;Texting&#8221;.</p>
<p>We will be in agreement if you identify the “people” involved in designing the system using your approach, then describe the trust relationship between them. And then tell me how such a system can be shared with the uninformed! And after you do that, then:</p>
<ol>
<li>Tell me how some entity or organization with close to omnipotent powers can subvert it</li>
<li>Go back and add the needed mechanisms to mitigate identified weaknesses.</li>
<li>Repeat 1 &#8211; 2 as necessary 🙂 </li>
</ol>
<p>After a few iterations, bring the system to this blog for us to poke a few more holes in it, and&#8230; oh well Repeat the process again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241887">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241887">
						February 22, 2015 5:45 PM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8220;What you describe is protection against bugs, security flows and unintentional weaknesses. Does it really cover subversion and defending against an adversary who has control on everything from the silicon all the way to layer 12?&#8221;</p>
<p>What I describe is how to protect the system. The high assurance (eg CC EAL6-7) processes apply to each layer of it. The people applying it and physical security are separate aspects of the process. At silicon level, you have to trust the people making the tools, masks, and so on. That&#8217;s inevitable. So, getting control of that situation is a prerequisite for silicon-up security. If it&#8217;s just firmware up, then hardware/software/system design as I described it should suffice.</p>
<p>&#8220;Uh! But I’m not willing to implement every component of the system by myself! &#8221;<br />
&#8220;We will be in agreement if you identify the “people” involved in designing the system using your approach&#8221;</p>
<p>The important point is that the process is followed properly (requirements to implementation), it&#8217;s reviewed properly, you can trust at least one reviewer, and you have trusted distribution from them to you. If requirements were right and process was followed, the trust portion reduces to one or more parties of your choosing with the skills capable of evaluating it and distributing it to you. That&#8217;s my whole trust model for security evaluation. Simple, eh?</p>
<p>Far as people, there&#8217;s actually a <em>lot</em> of people that can do the review whose morality and loyalties run the gamut. Take your pick and pay them if you lack the time slices. Don&#8217;t have the money? Convince a group to invest in funding the design or review with a beneficial outcome for them. Crowdfund it through potential users. You could also pick a guy that&#8217;s survived plenty of government intimidation + has IT brains to do it. (I vote Appelbaum or Moxie.) You think <em>that</em> person is going to take money from the government to subvert what they themself will use? Not likely.</p>
<p>I think what you and a lot of others are missing is that the problem isn&#8217;t really one of technology: it&#8217;s one of psychology. It&#8217;s trying to understand whether a given person will do what he or she says. If that&#8217;s a high probability, you can trust the outcome. If it&#8217;s uncertain, don&#8217;t trust outcome unless a bunch of them with different attributes come to same conclusion. Even then, watch out.</p>
<p>&#8220;However, the model + the definition will help you identify what “minimal” component you need to control to give you the desired security properties of the platform! I detailed an example once on confidential &#8220;Texting&#8221;.&#8221;</p>
<p>I get the concept. Yet, that was one type of device and problem domain with relatively narrow security requirements. Even then you had to work quite a long time to produce a model. And you&#8217;re asking me to do something similar for general-purpose systems running arbitrary (even self-modifying) code in an NP complete number of hardware, software, and I/O combinations? Where do I even begin&#8230;? So, instead, I give you models that you apply to a specific problem while (if smart) greatly limiting complexity the above factors introduces.</p>
<p>&#8220;After a few iterations, bring the system to this blog for us to poke a few more holes in it, and&#8230; oh well Repeat the process again.&#8221;</p>
<p>Alternatively, I can keep coaching people on how to build, evaluate, and distribute such systems. I might do both, though, as people keep asking those questions. Clearly they need a bit more than my security framework and the Common Criteria. Gotta get back to work, though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241888">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241888">
						February 22, 2015 5:46 PM					</a>

				</p>

				<p>@Wael</p>
<p>Your &#8216;unperceived existence&#8217; link really made me wonder about a surveillance equivalent of Heisenberg&#8217;s Uncertainty Principle or the Quantum Zeno effect! 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241889">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241889">
						February 22, 2015 5:47 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>Unfortunately there seems to be a basic misunderstanding, so from your detailed reply (that before and after the light) only the sentence mentioning the NIDS is somewhat close to the point:</p>
<p>No. it’s not a NIDS, as this term is occupied by a phantasy, as is worldwide peace and no crime. Not realistic. These devices are too bloated (see your EDIT).</p>
<p>I’m talking about a small budget device with two RJ45 sockets, a RS232, a small LCD (text only), a LED (or two) and a big button.<br />
No “OS”, no games, no fun.<br />
Not a device for everybody, but for those who do not want their data leaked.</p>
<p>A single PC (in my case a Mac, but it doesn’t matter which OS) is connected to the box which then connects to the LAN / Internet.<br />
To simplify thinking we assume:<br />
Only the upload (Tx) from the PC is connected to the electronics (probably an FPGA) and investigated.<br />
Download from Internet is not interesting.</p>
<p>We can’t fix our workhorses, they were lost from the beginning, we only didn’t know <b>[1]</b>,<br />
but we may block unauthorized uploads (?).</p>
<p><b>[1]</b><br />
This makes me again thinking about highly specific malware to destroy data, alter documents (!!!) or place “evidence” on our machines.<br />
Horrible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241890">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241890">
						February 22, 2015 6:06 PM					</a>

				</p>

				<p>@Nick P,</p>
<blockquote><p>I think what you and a lot of others are missing is that the problem isn&#8217;t really one of technology: it&#8217;s one of psychology.</p></blockquote>
<p>Is that a fact? Would you like me to give you links that show the opposite?<br />
Basically you need technical solutions for protection against &#8220;hackers&#8221; or &#8220;crackers&#8221; &#8212; You need political solutions for state actors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241891">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241891">
						February 22, 2015 6:14 PM					</a>

				</p>

				<p>@Buck,</p>
<blockquote><p>made me wonder about a surveillance equivalent of Heisenberg&#8217;s Uncertainty Principle or the Quantum Zeno effect</p></blockquote>
<p>That&#8217;s some profound sh*t! Lemme help you think about it. It really is an amazing observation! 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241892">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241892">
						February 22, 2015 8:49 PM					</a>

				</p>

				<p>@Nick P,</p>
<p>A while back you posed a question about subversion.<br />
My answer then was <a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_329.html#c782244" rel="nofollow ugc">It’s impossible for an individual</a> to protect against it.</p>
<blockquote><p>I get the concept. Yet, that was one type of device and problem domain with relatively narrow security requirements. Even then you had to work quite a long time to produce a model. </p></blockquote>
<p>The model isn&#8217;t complete, still! And I didn&#8217;t do it alone; it came out of our discussions.</p>
<blockquote><p>And you&#8217;re asking me to do something similar for general-purpose systems running arbitrary (even self-modifying) code in an NP complete number of hardware, software, and I/O combinations? Where do I even begin…?</p></blockquote>
<p>Oh, no! I’m not asking you to do it in one step! Neither will I press @Clive Robinson to detail to an implementable level how a “prison” &#8211; in all it’s manifestations works! I’m picking your brains &#8211; or whatever is left of it 😉 Where do we start! Thats the good question! We start from the basics, I claim 🙂</p>
<p>Don’t take my persistence as an attempt to show your recommendations are “weaker” than others; it&#8217;s not the case! I learnt a lot from them!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241893">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241893">
						February 22, 2015 9:18 PM					</a>

				</p>

				<p>@Buck,</p>
<p>I took a glance at <a href="http://plato.stanford.edu/entries/paradox-zeno/#ArgDen" rel="nofollow ugc">this</a>. That Zeno dude was pretty slick for his time! Perhaps if we convince people that observing us changes the results, or stops us from committing the acts they want to catch? Or should we find someone to observe the observers?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241894">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241894">
						February 22, 2015 9:22 PM					</a>

				</p>

				<p>@Sancho_P</p>
<blockquote><p>My proposal was only regarding outgoing data, the observer must be external (not in the root kit controlled universal Win or whatever PC).</p></blockquote>
<blockquote><p>&#8230;</p></blockquote>
<blockquote><p>Anyway, the content wouldn&#8217;t be the first question to ask an automated observer. The first question would be &#8220;How much&#8221; would go to &#8216;which destination + port&#8221; and &#8220;is this a known + confimed upload&#8221;. The latter is tricky and involves some learning (&#8220;please confirm upload of 2.5 kB to <a href="https://www.schneier.com" rel="nofollow ugc">https://www.schneier.com</a> at 204.11.247.93&#8243;) to accept it as &#8220;known size and destination&#8221; but we do not upload so much stuff, most is sending requests &#8211; that could be basic knowledge of the observer.</p></blockquote>
<p>Sounds good in theory, but it&#8217;s a bit more complex in practice, and it doesn&#8217;t really help much that the observer is external&#8230; User-input is still required to verify your expected upload data, so how do you propose to validate the actual data that&#8217;s leaving your unsecured endpoint? Are you really prepared to manually count each outbound byte for every legitimate connection you initiate? Even a single bit of information lost each outbound request is likely to add up real quick. I have been told that patience can be a virtue, and thus I believe &#8216;the leaks will continue to drip&#8217;.&lt;blockquote You wrote &#8220;<i>… because whitelisted hosts will just be abused to attack other whitelisted hosts until the target has been breached.</i>&#8221; but sorry, I did not understand that: When you think of MITM attacks (CA model) or that the destination is already owned by the adversary &#8211; these are different issues, the observer can&#8217;t help in both cases.These are not totally distinct issues &#8211; the observer can&#8217;t help unless it knows precisely what it&#8217;s observing, and the observed can&#8217;t communicate that clearly unless it knows exactly what is happening!</p>
<p>What you&#8217;ve missed from @Leia Organa and @Wael&#8217;s exchange is, there&#8217;s no guarantee that uploaded data will even go through your external observer. It could be transmitted via electromagnetic radiation, power usage, sound waves, or any number of various other side-channels.</p>
<blockquote><p>I will slightly agree when you think about avoiding nude selfies on your PC but I can not accept the basic idea that my machine is open to any investigation without my consent.</p></blockquote>
<p>Your use of the word &#8216;investigation&#8217; seems to imply some sort of legal procedure, yet at the same time ignoring the threat of potential criminal activities or the possibility of radically different policies from other countries.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241895">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241895">
						February 22, 2015 10:11 PM					</a>

				</p>

				<p>@ Wael,</p>
<p>Just to chip in and help out 🙂</p>
<blockquote><p>Oh, no! I’m not asking you to do it in one step! Neither will I press @Clive Robinson to detail to an implementable level how a “prison” &#8211; in all it’s manifestations works! I’m picking your brains &#8211; or whatever is left of it 😉 Where do we start! Thats the good question! We start from the basics, I claim 🙂</p></blockquote>
<p>Have a look at what I&#8217;ve said to @ Grauhut in answer to a different but similar question,</p>
<p><a href="https://www.schneier.com/blog/archives/2015/02/friday_squid_bl_466.html#c6689851" rel="nofollow ugc">https://www.schneier.com/blog/archives/2015/02/friday_squid_bl_466.html#c6689851</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241896">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241896">
						February 22, 2015 10:22 PM					</a>

				</p>

				<p>@Wael</p>
<p>I think I may have inadvertently touched upon your last question in my most recent reply to Sancho_P. 😛</p>
<p>I can&#8217;t claim to profess an optimal solution to the problem, but I definitely do feel that more transparency will be the best route forwards!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241897">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241897">
						February 22, 2015 11:38 PM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8220;Is that a fact? Would you like me to give you links that show the opposite?&#8221;</p>
<p>They&#8217;d be wrong. The solution is multipart: political, psychological, and technical in that order. The law (political) must allow people to protect their data and not force weakness into systems. People, yourself or others, must put in honest effort to protect the data. Technology gives them increased capability to do that. It&#8217;s not a prerequisite, though: the Amish have the least of it and the most privacy of information. 😉 Security technology certainly helps protect data moving through other technology.</p>
<p>Alright, to the specifics. Your counter is funny because you essentially said what I did with your questions. So, there&#8217;s a protection, a process, a review. By WHO? And why do you trust them? Were they incompetent? Were they malicious? How do you know this? If they left traces, you might use technology and logic. Otherwise, you&#8217;re going on your assessment of people. Welcome to counterintelligence and personnel security. 🙂</p>
<p>It&#8217;s critical that you understand that it boils down to who you trust and why. Psychology, reason, and probability constituting the why. Who wrote the tools you trust in the assessment? Who said the security proofs of the design check out? Who said the configuration management was in order? Who (a bunch of who&#8217;s) said the design was properly converted into a mask? Who physically moved the hardware and/or ensured seals were properly checked?</p>
<p>All these who&#8217;s clearly argue that it comes down to you trusting a person&#8217;s word or actions at some point. With subversion as a risk, they might turn on you for any number of reasons. Make the wrong choices, get a subverted design. The current President and the technology they promised they used to build it had no effect. You just trusted the wrong person to vet or do something critical. So I maintain, whatever the tech or political position, it&#8217;s human psychology that&#8217;s the most important part of assessing those that you end up trusting.</p>
<p>re subversion</p>
<p>Ahh, the thread where you first asked about CvP.</p>
<p>&#8221; The (necessary, but not sufficient) condition is, they have to fully control the design, manufacture, test, and deployment of the hardware / software. This implies nothings outsourced including the FABs.&#8221; (Wael)</p>
<p>Correction: control <em>or verification</em> of that. Or <em>verification of controls</em> that ensure the process works correctly. You have a lot more flexibility than you think. This lets you outsource about all of it so long as it&#8217;s done in a way that&#8217;s verifiable and you trust your verification. A simplistic example is how verifying isolation and communication mechanisms in a MILS kernel lets you ensure policies are enforced for arbitrary computations in partitions. One verification of someone else&#8217;s work keeps applying to new work. Doubtful that it would be a single individual for a whole, modern system as you pointed out in the old thread.</p>
<p>Yet, Moore and Wirth have both done the whole thing from language down to silicon by keeping it simple. The systems were usable, too, albeit in a very minimalist way. SAFE is going from application-level, info-flow language all the way down to dedicated, custom hardware. That&#8217;s quite a complex effort with under 15 people total. A single author once wrote a paper on verifiable translation of high-level HDL to RTL. The reverse engineering firms seem motivated by money more than ethics and could do a tear-down of the fab&#8217;s work. So, a whole new platform down to gates with 16 people plus one or more companies reverse engineering it for extra effort. That&#8217;s the easiest and cheapest way to keep trust down.</p>
<p>I have better one&#8217;s but they&#8217;re not easy and might not be cheap. Gotta hold off on publishing them for now.</p>
<p>&#8221; I’m picking your brains &#8211; or <i>whatever is left of it</i> 😉 Where do we start! Thats the good question! We start from the basics, I claim 🙂 &#8221;</p>
<p>Good catch haha. I might take a stab at it. There was one great paper that I can&#8217;t find or remember the name of that integrated much of it. It literally worked from the most fundamental issues to the specifics of high assurance design in PowerPoint style. Best one I&#8217;ve ever seen. Anyway, I&#8217;ll have to put together a different one lol.</p>
<p>&#8220;Don’t take my persistence as an attempt to show your recommendations are “weaker” than others; it&#8217;s not the case! I learnt a lot from them! &#8221;</p>
<p>I appreciate it. I counted you as one of my proteges in high assurance engineering. Older, smarter, and teaching me back more than most. I labeled that <a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_329.html#c776618" rel="nofollow ugc">link</a> in my archive: &#8220;I teach Wael how to make secure reference monitors. He, Clive and I have many enlightening discussions from that point.&#8221; Clive and I had started more practical discussion on high assurance security than anything I&#8217;d seen in academia or commercial sector. Your entry made it even more interesting and productive. It was all fun, too. 🙂</p>
<p>re Zeno Effect</p>
<p>For malware, I&#8217;d say it&#8217;s the NSA Equation Group malware that disappears the second you look to see if it&#8217;s there. Kaspersky, using the Unified Surveillance Theory, was able to undermine the effect and grab a sample of the stuff. Meanwhile, the physical, Zeno Effect was one of the many things the Ph.D&#8217;s at the Cracked Institute of Technology <a href="http://www.cracked.com/article_16583_the-5-scientific-experiments-most-likely-to-end-world.html" rel="nofollow ugc">warned us</a> about.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241898">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241898">
						February 23, 2015 12:01 AM					</a>

				</p>

				<p>@ Sancho_P</p>
<p>I still don&#8217;t get it. The reason being that most networking and Internet activity is built on two-way protocols. For instance, TCP always starts with an upload (three-way hand shake) and keeps sending more (i.e. ACK&#8217;s). Protocol layers above it do as well. So, most of the Internet doesn&#8217;t work on your machine. If you change it, then you&#8217;re allowing both download and upload by protocols susceptible to covert channels. Allowing download also lets them hit you with malware. So, they hit you with malware, then they leak your secrets over covert channels.</p>
<p>The designs in my EDIT didn&#8217;t get more complex just for fun: they needed the extra functionality to deal with real-world use. Not to mention bloat was in some specific examples rather than the architecture itself. The MILS kernels are usually under 10Kloc, guards can be built with them + limited extra stuff, and the automated software can be similarly small. The whole thing can be kept reasonably simple, modular, layered, and with interface checks if you tolerate the overhead. The TCB&#8217;s can always be small and easy to verify. That&#8217;s been proven by many past works.</p>
<p>&#8220;We can’t fix our workhorses, they were lost from the beginning, we only didn’t know&#8221;</p>
<p>Sounds beautifully poetic but thankfully not believable. There are a number of projects that prevent, limit, contain, and/or recover from damage to workhorse software (esp Linux/BSD). They have achieved many interesting results. Our workhorses might be fixable after all. Yet, regardless of method, we will have to gradually re-engineer them over time to get the most assurance of the method. Although, someone might find a way to fight the need for that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241899">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241899">
						February 23, 2015 12:17 AM					</a>

				</p>

				<p>@Buck,</p>
<blockquote><p>I think I may have inadvertently touched upon your last question in my most recent reply to Sancho_P</p></blockquote>
<p>I noticed and thought about it a bit. You must have some kind of ESP. I guess it&#8217;s one of those strange synchronicities&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241900">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241900">
						February 23, 2015 12:27 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<p>I read your reponce to @Grauhut. And I generaly agree with it 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241901">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241901">
						February 23, 2015 2:55 AM					</a>

				</p>

				<p>@Nick P,</p>
<blockquote><p>They&#8217;d be wrong.</p></blockquote>
<p>Well, <a href="http://youtu.be/zANvYB93u2g" rel="nofollow ugc">Excuse me</a>! I know you guessed the link before you clicked it, but you won&#8217;t guess the next link correctly 🙂</p>
<blockquote><p>The solution is multipart: political, psychological, and technical in that order […] the Amish have the least of it and the most privacy of information.</p></blockquote>
<p><a href="http://youtu.be/rmLAj9iIfQk" rel="nofollow ugc">Nonsense</a>!</p>
<blockquote><p>Alright, to the specifics. Your counter is funny because you essentially said what I did with your questions […] Otherwise, you&#8217;re going on your assessment of people. Welcome to counterintelligence and personnel security. 🙂</p></blockquote>
<p>Nope! The decision has been made. We can’t trust anyone or anything because of subversion, interdiction, and other tactics. The rules of the game is: Design a secure system under these conditions. The system doesn&#8217;t have to be a general purpose system — It could be a specific purpose system at least initially. This is what @Clive Robinson mentioned recently, and is the exact reason I asked @Figuretout <a href="https://www.schneier.com/blog/archives/2015/02/friday_squid_bl_465.html#c6689208" rel="nofollow ugc">this question</a>. When we have a few of these systems, perhaps we can think about combining them later to get our &#8220;general purpose&#8221; system, if it&#8217;s doable.</p>
<blockquote><p>It&#8217;s critical that you understand that it boils down to who you trust and why. […] Who physically moved the hardware and/or ensured seals were properly checked?</p></blockquote>
<p>1- Isn&#8217;t it evident I understand that when I said: If you are forced to relinquish[1] control of a component of the system, divide control among parties that are not likely to cooperate against you?<br />
2- When a gov agent interdicts your hardware, you’ll be none the wiser. They aren&#8217;t “schmucks”, see! They won&#8217;t put a label in the package saying this package was inspected by xxx!</p>
<blockquote><p>Correction: control *or verification* of that. Or *verification of controls* that ensure the process works correctly… </p></blockquote>
<p>Now where is that link to the bull video? 🙂</p>
<blockquote><p>There was one great paper that I can&#8217;t find or remember the name of that integrated much of it.</p></blockquote>
<p>I want no papers! I have them coming out of my ears and can’t keep up with the amount I receive! What I want is <b>your brain</b>.</p>
<blockquote><p>I appreciate it. I counted you as one of my proteges in high assurance engineering. Older, smarter, and teaching me back more than most.</p></blockquote>
<p>Older? Probably! Smarter? Unknown and very subjective. But thanks for the compliment &#8212; as long as @Clive Robinson and his country folk don&#8217;t read it as &#8220;more handsome&#8221; 😉</p>
<blockquote><p>Zeno Effect…</p></blockquote>
<p>Read that stuff. They came across as whack jobs. Maybe I’ll change my mind later, but for now, the site name they chose isn&#8217;t exactly a missnomer 😉</p>
<p>My turn to go to sleep. Gotta wake up in 4 hours!</p>
<p>[1] I know &#8220;forced to relinquish&#8221; sounds oxymoronic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241902">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241902">
						February 23, 2015 11:28 AM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8220;Nope! The decision has been made. We can’t trust anyone or anything because of subversion, interdiction, and other tactics.&#8221;</p>
<p>I call bullshit right back at ya homie. As Bruce <a href="https://www.schneier.com/essays/archives/2013/02/trust_and_society.html" rel="nofollow ugc">pointed out</a>, you trust way more people than you give credit to. He was flying too. 😉 Your decision can&#8217;t work in the real world unless you&#8217;re pulling a Moore or Wirth-style job on custom hardware. Even <a href="http://www.homebrewcpu.com/" rel="nofollow ugc">Magic 1 homebrew CPU</a> wouldn&#8217;t meet your criteria because you&#8217;d have to trust the TTL chips. You&#8217;d be back to handwiring circuits that ran at kiloherts with so little memory the command line overflows! 😛</p>
<p>Bruce&#8217;s point is even stronger when I think about you&#8217;re engineering degree: all that math, theory, and methods you&#8217;ve trusted your whole career without independently re-running their experiments and checking their proofs. Now you tell me you&#8217;ll leverage that in determining secure INFOSEC methods, but in the new field you can&#8217;t trust any single person? Lmao&#8230;</p>
<p>Our infrastructure will be built by more than one paranoid person living in a faraday cage. You will need ways to assess those people or vet what they produce. You&#8217;re going to trust someone or something at some point. That&#8217;s a fact that you can&#8217;t escape. Now, you must determine how to make human nature work for you instead of against you. Who and what do you trust? Where do you begin in your work?</p>
<p>I trust TTL and FPGA chips sold in lots before 2004. That&#8217;s back when they were just focused on delivering products. 🙂</p>
<p>&#8220;It could be a specific purpose system at least initially. &#8221;</p>
<p>That was my plan too. Except it&#8217;s nearly as easy in hardware to design a secure, general purpose system. So, I went straight for such designs.</p>
<p>&#8220;I want no papers! I have them coming out of my ears and can’t keep up with the amount I receive! What I want is your brain.&#8221;</p>
<p>I&#8217;ll give you a paper on my brain. Jk. Meanwhile, I&#8217;ll work on the model in the future.</p>
<p>&#8220;Read that stuff. They came across as whack jobs. Maybe I’ll change my mind later, but for now, the site name they chose isn&#8217;t exactly a missnomer ;)&#8221;</p>
<p>It&#8217;s an infotainment site: part informing, part bullshit, always funny.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241903">

			<div class="comment by-nathanael ">

				<p class="commentcredit">

					<span class="commenter">Nathanael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241903">
						February 23, 2015 12:52 PM					</a>

				</p>

				<p>&#8220;But I suppose, although defense wins games, offense sells tickets. And the tickets are for much more lucrative budgets, whih grow ever larger the longer the game continues.&#8221;</p>
<p>This seems to describe the dynamic.  It&#8217;s quite self-destructive in the long run.  The question is how much these NSA/CIA/DOD clowns are going to take down with them when they go down.  It could be the entire US government.  It could be the world, if they manage to trigger a nuclear war (so let&#8217;s not let them).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241904">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241904">
						February 23, 2015 2:51 PM					</a>

				</p>

				<p>@ Buck</p>
<p><i>”… but it&#8217;s a bit more complex in practice …”</i> &#8211; Bingo!<br />
As I have learned from my boss it’s always easy when one has no idea about the details 😉</p>
<blockquote><p><i>“Even a single bit of information lost each outbound request is likely to add up real quick. I have been told that patience can be a virtue, and thus I believe &#8216;the leaks will continue to drip&#8217;.”</i></p></blockquote>
<p>Yes, that’s really dangerous.<br />
However, the <b>combination</b> of “destination + amount + frequency” should suffice to trigger an alarm,<br />
whereas the <b>destination</b> alone could only be a once confirmed destination, say Facecrook or Dr. Goo and needs either a MITM or being a compromised service / host / destination (e.g. my friend there with a gun at his head).<br />
Anyway, this point needs special attention and knowledge.</p>
<p>Not sure how Wireshark (@Leia Organa) and various side channels are related but I think we&#8217;ll agree on the following:<br />
When I’m such a high valued target that they rent the apartment above mine and have their van 24/7 parked downstairs then I’m lost, whatever communication I’ll try, including the waggle dance, and even when I don’t communicate at all.</p>
<p>By using “any investigation” I really meant “any” as I see the content of my PC (Personal Computer) as my intellectual property without difference to my brain. All my ideas, thoughts, artwork, phantasy, personality is there and no one but me could sort or interpret the content to make sense of it.<br />
The content per se can’t harm anybody and therefore is off limits to anybody without my consent.<br />
Regardless of (man made) laws and legal hairsplitting I deem any attempt to secretly access it as a crime and a personal and hostile attack.<br />
What’s in my brain can be right or wrong, sane or ill, genuine or altered by mistake or intention.<br />
No “evidence” can be taken from my brain.</p>
<p>Self destructing malware, as it was shown by Equation Group and can be utilized by any attacker, renders whichever “evidence” void anyway.</p>
<p>@ Nick P</p>
<p>Yep, the hand shake is tricky but standardized (I don’t know much about it, so that’s “the easy part” for me, but what I see from Wireshark it is not rocket science or magic). There is the possibility of leaking data in snippets, and as @Buck pointed out, add drop to drop …<br />
Even access to well known sites (&#8220;get&#8221;) may leak some information in the URL, but not to an “unknown” C&amp;C server.</p>
<blockquote><p><i>”Allowing download also lets them hit you with malware.”</i></p></blockquote>
<p>We must start one step before: The malware is already on the PC.<br />
So there’s no need to download it, but yes, add more, no problem.<br />
To keep the workhorse usable is a different task.</p>
<p>My “we can’t fix our workhorses” was meant as<br />
&#8211; we can’t go back in time, the machines are already there<br />
&#8211; the system were not made with adversaries in mind (&#8220;lost from the beginning&#8221;)<br />
&#8211; there is a monoculture of only three systems and a billion of machines<br />
&#8211; non of these systems was built from scratch as it is now, they grew up over the years<br />
&#8211; the task to build a universal, modern machine (PC) is tremendous complex<br />
&#8211; running nearly any low level (compiled) software is insecure per se<br />
&#8211; the machines are all out there, both cheap and useful.</p>
<p>What we’d need are simple boxes which are not subverted from the beginning, created with today’s experience, knowledge and caution.</p>
<p>I just think that would make the crook’s job not impossible, but it would be much much harder for them to access e.g. the my proposal to <a href="http://en.wikipedia.org/wiki/Anesrif" rel="nofollow ugc"> Anesrif </a> before I send it to the intended destination.<br />
What would the malware look for at my HD? Drawings? Text? Encrypted stuff?<br />
Upload 200GB by appending slices to URLs and collect them from the backbone?<br />
Without transport control? Good luck!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241905">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241905">
						February 23, 2015 7:07 PM					</a>

				</p>

				<p>@ Sancho_P</p>
<p>&#8221; Drawings? Text? Encrypted stuff?<br />
Upload 200GB by appending slices to URLs and collect them from the backbone?&#8221;</p>
<p>Fair enough. It&#8217;s unlikely if they can&#8217;t use any air gap jumping techniques against you. They can destroy the data or systems, though. You also still have to integrate your apps with the upload system so it only lets out traffic from the exact apps you want it to. Tricky stuff on a machine you assume is compromised. It will complicate the design.</p>
<p>Btw, the more typical use of covert channels is leaking keys, passwords, and so on. Then, they just use them on data they&#8217;ve intercepted on the network or on an encrypted disk they&#8217;ve physically stolen. They might also leak a description of your hardware, OS, and running software to make for a better attack. That&#8217;s one of my old tricks.</p>
<p>Far as rate of leaking, basic TCP channels can leak over 1Kbps on top of any IP or HTTP channels in use. Let&#8217;s use the 1Kbps per TCP connection number. A typical web session makes hundreds of connections. File uploads also make a steady stream of connections. The result is that, after even 10-15 minutes, they could leak a lot more than encryption keys or passwords. Most of the above data would get out. Now, if they get a copy of your transfers or storage, they can decrypt it.</p>
<p>I&#8217;ll admit this is a targeted attack, though. This isn&#8217;t likely to be used in fire-and-forget QUANTUM attacks although it could be done that way. Same can be said about guard architecture, though, which gives you more options. Most common thing employed by non-experts is OpenBSD with a particular firewall configuration just because they probably got most of the bugs out. You can always take apps and even kernel code out if it&#8217;s not needed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241906">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241906">
						February 25, 2015 12:12 AM					</a>

				</p>

				<p>Nick P<br />
<i>As Bruce pointed out, you trust way more people than you give credit to.</i><br />
&#8211;Which is wrong too, I don&#8217;t trust them, there&#8217;s a difference between having a choice and not having a choice to do certain things when monopolies take over.  Doing something b/c there&#8217;s no other way and placing trust in something are 2 separate things.</p>
<p>For instance, almost any &#8220;clean slate&#8221; computer security effort is going to start w/ likely infected tools b/c handwiring and amount of circuits and building the logic necessary for a real re-do isn&#8217;t feasible (and even discrete components have large space for all kinds of crap due to the market focusing on SIZE when it doesn&#8217;t frickin&#8217; matter much anymore).</p>
<p>The math and electical theory have had quite a testing (though I think we all know there&#8217;s some holes lurking).</p>
<p>One thing you&#8217;re right about is going back to boring circuits, no frickin&#8217; command line, no normal keyboard, no screen, just LED&#8217;s (still susceptible to EMSEC issues as they are not ideal diodes, not to mention emanations from simple circuits will be very revealing), resistors, and transistors (power supply components too, preferably hand-rung transformers).  There&#8217;s analog ammeters capable of measuring microAmps, but it&#8217;s boring eh?  Digital screens are so much cooler.  F<em>ck this sh</em>t, it&#8217;s annoying.  I&#8217;d rather code and order pristine perfectly manufactured boards and cables.  Hand-wiring 1000&#8217;s upon 1000&#8217;s of turns of wire is frickin&#8217; dull and annoying, let me tell you.  And you have to be a craftsman heat-shrinking your cables or they&#8217;re going to suck ass and break and not be portable, which is another security risk.  Going backwards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241907">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241907">
						April 11, 2016 1:18 AM					</a>

				</p>

				<p>@Nick P,</p>
<blockquote><p>I trust TTL and FPGA chips sold in lots before 2004. That&#8217;s back when they were just focused on delivering products. 🙂</p></blockquote>
<p>Was digging around in search of something[1]&#8230; Quick question: how can you tell when the lots were sold? Can&#8217;t subversion include bogus chip markings &#8212; I would put a 2003 date on a chip I subverted!</p>
<p>[1] Things I said I&#8217;ll do later&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241908">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241908">
						April 11, 2016 10:16 AM					</a>

				</p>

				<p>@ Wael</p>
<p>Good thinking. It&#8217;s actually the date of manufacture that matters. The listing can be faked. The main defense is heuristics I have no intention of publishing. However, one is acquiring hardware from people that are low risk of subversion but know when they bought it. Just gotta buy a bunch extra cuz used breaks more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241909">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241909">
						April 11, 2016 11:15 AM					</a>

				</p>

				<p>@Nick P,</p>
<blockquote><p>It&#8217;s actually the date of manufacture that matters.</p></blockquote>
<p>Wouldn&#8217;t you think the manufacture date can be tampered with?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241910">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241910">
						April 11, 2016 11:44 AM					</a>

				</p>

				<p>@ Wael</p>
<p>I just said that. 😛 One of the other benefits of stuff like TTL and old FPGAs is a small outfit can implenent them on 350nm or 500nm processes. Visually inspect some if them.</p>
<p>Btw, accidentally discovered ECL logic chips when Googling for this response. Apparently, it was even faster than TTL for use in things like mainframes. Also better side-channel resistance. So, make that two runs on old fabs. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241911">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241911">
						April 11, 2016 11:57 AM					</a>

				</p>

				<p>@ Wael, Nick P,</p>
<p>&lt;</p>
<p>ul&gt;Wouldn&#8217;t you think the manufacture date can be tampered with?</p>
<p>&lt;</p>
<p>ul&gt;</p>
<p>It is quite frequently, along with speed markings etc.</p>
<p>Sometimes though the manufacturer lies when they mark the package up which is why the scammers get away with it.</p>
<p>Take a company like Intel or similar, they manufacture chips for the best spec and then due to pricing issues mark many premium parts down into the higher selling lower spec groups. It&#8217;s why quite a few &#8220;overclockers&#8221; get away with running lower spec chips at top spec performance.</p>
<p>So if you buy second hand stock of low to medium spec parts you can quite quickly &#8220;test them up&#8221; to a higher spec, then you have to re-etch the chip cap to reflect that and make a nice little earner. The problem is their &#8220;quick tests&#8221; will not always pick up on issues, so such marked up chips will in a number of cases die an early death.</p>
<p>In the PC game this does not realy matter as businesses can write them off tax wise in as little as 18months so upgrade them quite cheaply overall. Likewise home PCs have only a three months warranty in some parts of the world. So a chip dying at a couple of years rather that ten or twenty years is not going to attract any attention in the majority of cases.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241912">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241912">
						April 11, 2016 12:07 PM					</a>

				</p>

				<p>@ Clive</p>
<p>You got experience with Emitter-Coupled Logic? The Wikipedia pagd had some impressive benefits. Power  use was a drawback. That&#8217;s expected. Any uses or issues a quick Google would miss?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241913">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241913">
						April 11, 2016 12:10 PM					</a>

				</p>

				<p>OH phutz I left out the slash on the second UL above 🙁</p>
<p>@ Nick P,</p>
<p>At the time ECL was upto 450MHz whilst TTL was lucky to push 30Mhz, however there were several prices to pay for that speed. Firstly PCBs of the required spec were very expensive, tracking was a pain due to transmission line impedence matching. The power requirments were a pain etc etc and the chips were invariably gold/ceramic at MIL spec so cost about ten to thirty times as much as commercial grade TTL of the same gate count.</p>
<p>I&#8217;ve still got some tucked away somewhere but they are worth more for their high valuable metal count than they are for functionality value. Though I&#8217;m told NASA did used to pay through the nose for them which was just one reason the Space Shuttle got to expensive to keep going.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241914">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241914">
						April 11, 2016 12:21 PM					</a>

				</p>

				<p>@Clive Robinson, @Nick P,</p>
<blockquote><p>Sometimes though the manufacturer lies when they mark the package &#8230;</p></blockquote>
<p>That&#8217;s exactly my point. It seems easier to etch a chip than to subvert it. So what assurance will you have that the &#8220;old&#8221; chip you got isn&#8217;t a subverted/re-etched one? Manufacture date isn&#8217;t such a strong control to use, then! You&#8217;ll have to work with the assumption that the chips you&#8217;re building a system with are &#8220;evil&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241915">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241915">
						April 11, 2016 1:53 PM					</a>

				</p>

				<p>@ Wael</p>
<p>My question is instead what are the odds that THEY&#8230; who I get it from&#8230; were given a subverted unit. Run of the mill, cheap, older chips are unlikely to have been done that way because physical behavior would&#8217;ve been different.</p>
<p>Today, they might be able to pull some shit on new chips or new supplies of older ones. Not the ones already printed that I have good reason to believe are what they appeared to be.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241916">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241916">
						April 11, 2016 1:58 PM					</a>

				</p>

				<p>@ Clive</p>
<p>Damn. Didnt know it was gold and stuff. You could still implement it on one of modern CMOS or Bipolar processes with similar benefits, though, right?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241917">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241917">
						April 11, 2016 4:22 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>To rework an old saying&#8230;</p>
<ul>Thar be gold in them thar chips</ul>
<p>Early chips were full of precious metals, gold was used to not just heavily plate leads and provid links from the carrier to the chip where they were &#8220;cold welded&#8221; by hand under a microscope.</p>
<p>As for the ECL masking etc, I&#8217;m not sure, if RobertT was still around I&#8217;d say chat to him.</p>
<p>One of the reasons ECL was fast is that the output stages were linier and not driven into saturation, but the price was quite high currents etc.</p>
<p>Perhaps oddly we regarded ECL as obsolete around the time the first 16bit bit slice processor chips with inbult register files such as the AM29016 became readily available in the early 80&#8217;s.</p>
<p>The major use I had with ECL after that was in digital video and RF systems such as frequency synthesizers and counters used as pre-scalers and early pulse swallowers and other digital radio stuff. For various reasons there is not much I can talk about on what such systems were to be used for, other than I still expect some of it will fall on my or somebody elses head eventually.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241918">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241918">
						April 11, 2016 7:11 PM					</a>

				</p>

				<p>@ Clive</p>
<p>Thanks for the tips and insight. Interesting stuff. Another resource gave actual numbers where the ECL vs TTL had ECL literally 10x more speed at like 60x more power. Still acceptable power at 60mW per MHz given 1GHz would&#8217;ve been about 60W right? Just might need Cray&#8217;s cooling for multicore. Then they subvert THAT with an EMSEC attack. 😉</p>
<p>@ Wael</p>
<p>Thanks for the reminder. I sometimes forget little things. Periodic reminders keep tgat to a minimum..</p>
<p>@ both</p>
<p>Last thing for today was finding that old Z80&#8217;s, etc implemented XOR in pass-transistor logic. Apparently makes it and some other gates common in crypto faster or cheaper. Might be worth remembering for anyone working on old nodes. Needless to say, I quickly found a synthesis method. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-241919">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241919">
						April 12, 2016 11:29 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Talking of the Z80, did you know that originaly it&#8217;s ALU was actually 4bit not 8bit and it did some other quite nifty non logic gate tricks. Which is why it had a minimum clock speed of around 120KHz which made &#8220;single steping debug&#8221; well nigh impossible&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-241920">

			<div class="comment by-khizer-ali ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.onlinegamesx.com/' rel='external nofollow ugc' class='url'>khizer ali</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/#comment-241920">
						February 11, 2020 1:36 PM					</a>

				</p>

				<p>In the PC game this does not realy matter as businesses can write them off tax wise in as little as 18months so upgrade them quite cheaply overall. Likewise home PCs have only a three months warranty in some parts of the world. So a chip dying at a couple of years rather that ten or twenty years is not going to attract any attention in the majority of cases.<a href="//www.onlinegamesx.com/xshare-file-transfer-andriodios-and-pc-download/”" rel="nofollow ugc">xshare(s)</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2015/02/the_equation_gr.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F02%2Fthe_equation_gr.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2015/02/the_equation_gr.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='6779' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2015/02/co3_systems_cha.html" rel="prev">← Co3 Systems Changes Its Name to Resilient Systems</a>		<a href="https://www.schneier.com/blog/archives/2015/02/irs_encourages_.html" rel="next">IRS Encourages Poor Cryptography →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
