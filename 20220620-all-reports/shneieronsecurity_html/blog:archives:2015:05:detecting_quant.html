<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Detecting QUANTUMINSERT - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Detecting QUANTUMINSERT Comments Feed" href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/7002" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=7002' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fdetecting_quant.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fdetecting_quant.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-7002 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-7002" class="post-7002 post type-post status-publish format-standard hentry category-uncategorized tag-browsers tag-edward-snowden tag-hacking tag-nsa tag-quantum tag-tcp">

	<div class="article">

		<h2 class="entry">Detecting QUANTUMINSERT</h2>
		<p>Fox-IT has a <a href="http://.fox-it.com/2015/04/20/deep-dive-into-quantum-insert/">blog post</a> (and has published <a href="https://github.com/fox-it/quantuminsert/tree/master/detection/snort">Snort rules</a>) on how to detect man-on-the-side Internet attacks like the NSA&#8217;s QUANTUMINSERT. </p>
<p>From a <a href="http://www.wired.com/2015/04/researchers-uncover-method-detect-nsa-quantum-insert-hacks/">Wired article</a>:</p>
<blockquote><p>But hidden within another document leaked by Snowden was a slide that provided a few hints about detecting Quantum Insert attacks, which prompted the Fox-IT researchers to test a method that ultimately proved to be successful. They set up a controlled environment and launched a number of Quantum Insert attacks against their own machines to analyze the packets and devise a detection method.</p>
<p>According to the Snowden document, the secret lies in analyzing the first content-carrying packets that come back to a browser in response to its GET request. One of the packets will contain content for the rogue page; the other will be content for the legitimate site sent from a legitimate server. Both packets, however, will have the same sequence number. That, it turns out, is a dead giveaway.</p>
<p>Here&#8217;s why: When your browser sends a GET request to pull up a web page, it sends out a packet containing a variety of information, including the source and destination IP address of the browser as well as so-called sequence and acknowledge numbers, or ACK numbers. The responding server sends back a response in the form of a series of packets, each with the same ACK number as well as a sequential number so that the series of packets can be reconstructed by the browser as each packet arrives to render the web page. </p>
<p>But when the NSA or another attacker launches a Quantum Insert attack, the victim&#8217;s machine receives duplicate TCP packets with the same sequence number but with a different payload. &#8220;The first TCP packet will be the &#8216;inserted&#8217; one while the other is from the real server, but will be ignored by the [browser],&#8221; the researchers note in their blog post. &#8220;Of course it could also be the other way around; if the QI failed because it lost the race with the real server response.&#8221;</p>
<p>Although it&#8217;s possible that in some cases a browser will receive two packets with the same sequence number from a legitimate server, they will still contain the same general content; a Quantum Insert packet, however, will have content with significant differences.</p></blockquote>
<p>It&#8217;s important we develop defenses against these attacks, because <a href="https://www.schneier.com/blog/archives/2015/04/the_further_dem.html">everyone is using them</a>.</p>
<p>EDITED TO ADD (5/14): Detection for QI was <a href="https://github.com/fox-it/quantuminsert">recently released</a> for Bro, Snort and Suricata.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/browsers/" rel="tag">browsers</a>, <a href="https://www.schneier.com/tag/edward-snowden/" rel="tag">Edward Snowden</a>, <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/quantum/" rel="tag">QUANTUM</a>, <a href="https://www.schneier.com/tag/tcp/" rel="tag">TCP</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html" rel="bookmark">Posted on May 4, 2015 at 6:17 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html#comments">55 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html" data-title="Detecting QUANTUMINSERT" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-246726">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246726">
						May 4, 2015 7:15 AM					</a>

				</p>

				<p>Hi</p>
<p>Suricata, which is a derivative of Snort (f*cked up by being bought by the NSA subsidiary CISCO) is developed on behalf of</p>
<p>US HOMELAND SECURITY</p>
<p><a href="http://suricata-ids.org/about/consortium/" rel="nofollow ugc">http://suricata-ids.org/about/consortium/</a></p>
<p>&#8230;the same US HOMELAND SECURITY requests stopping encryption:</p>
<p><a href="http://gizmodo.com/dhs-secretary-begs-silicon-valley-to-stop-the-encryptio-1699273657" rel="nofollow ugc">http://gizmodo.com/dhs-secretary-begs-silicon-valley-to-stop-the-encryptio-1699273657</a></p>
<p>This US HOMELAND SECURITY sh*t can only be part of the problem or part of the solution. Choose yourself&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246727">

			<div class="comment by-momo ">

				<p class="commentcredit">

					<span class="commenter">Momo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246727">
						May 4, 2015 7:23 AM					</a>

				</p>

				<p>Best hope there&#8217;s no stateful firewall not under your control between your network and the attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246728">

			<div class="comment by-mikeacker ">

				<p class="commentcredit">

					<span class="commenter">mike~acker</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246728">
						May 4, 2015 7:25 AM					</a>

				</p>

				<p>this <em>should</em> fail on any SSL or TLS connection: the attacker <em>should not</em> be able to steal the session key.</p>
<p>without the session key the attacker could not properly encrypt the packet to be inserted</p>
<p>the session key should be generated during the SSL/TLS &#8220;handshake&#8221; and once generated &#8212; encrypted with Public Key Encryption &#8212; and then sent to the Client machine.</p>
<p>as a result &#8212; only the client which initiated the communication session will be able to decrypt the packet that holds the session key.   and that would be game over for our QI attacker</p>
<p>if SSL/TLS is not doing this properly then all of SSL/TLS is entirely compromised and we need to talk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246729">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246729">
						May 4, 2015 8:32 AM					</a>

				</p>

				<p>I am interested to know if Fox-IT’s code patch for Snort really works against packet injectors like Quantum Insert/Fox acid. I have seen Snort used as a firewall with good success. It would be welcome news to find Snort can be patched to protect against state sponsored packet injection. I would recommend it for my customers.</p>
<p>I see some qualification [which seems minor]:</p>
<p>&#8220;&#8230;it’s possible that in some cases a browser will receive two packets with the same sequence number from a legitimate server, they will still contain the same general content; a Quantum Insert packet, however, will have content with significant differences. The researchers have detailed in their blog post other anomalies that can help detect a Quantum Insert attack&#8230;&#8221; -Wired</p>
<p><a href="http://www.wired.com/2015/04/researchers-uncover-method-detect-nsa-quantum-insert-hacks/" rel="nofollow ugc">http://www.wired.com/2015/04/researchers-uncover-method-detect-nsa-quantum-insert-hacks/</a></p>
<p>I read this to mean Fox-IT/snort combination will almost always detect the Quantum Insert packet injection – but may not always block it.</p>
<p>Some other remediation must take place in certain instances. This Fox-IT/Snort combination would certainly benefit the non-encrypted website to browser communications [The majority of websites are not encrypted and would benefit].</p>
<p>This also assumes that Snort has not been compromised by the NSA.</p>
<p>Am I close on the Fox-IT/Snort assumption?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246730">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246730">
						May 4, 2015 8:43 AM					</a>

				</p>

				<p>@65535<br />
I&#8217;m a snort user but far from an expert and would read it that way that by the differences in package load (legit server and QI) the two packages can be differentiated and the detection will work, while when a legit server sends two packages with same seq. number this will be detected as a false positive due to the same package load.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246731">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246731">
						May 4, 2015 9:44 AM					</a>

				</p>

				<p>@65535<br />
Blocking Injected packets will be difficult as you cannot be certain which of the duplicate packets is the inserted one. Ofcourse you could check TTL differences, and other anomalies. But they can be faked to be the same as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246732">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246732">
						May 4, 2015 9:47 AM					</a>

				</p>

				<p>@bob</p>
<p>But snort blocks based on IP, so both, the legit. as well as the fake traffic should be blocked. The browser should show nothing&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246733">

			<div class="comment by-tsl-ssl-retort ">

				<p class="commentcredit">

					<span class="commenter">tsl ssl retort</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246733">
						May 4, 2015 11:18 AM					</a>

				</p>

				<p>@mike acker</p>
<p>tsl/ssl <em>IS</em> very broken.  google beast attack.  This nsa quantum insert attack works for two reasons:  1.  They can connect to your machine faster then you destination page can.  And 2.  They have ALL the Certificates from the signing companies so they can impersonate anyone.</p>
<p>So yes, the system is very broken.  Don&#8217;t tell anyone, wouldn&#8217;t want to up set the people.  Just like how the MLK documents are out, etc.  It goes on and on.  The truth is out there,  but unlike Fox Mulder, out there isn&#8217;t very far.  In fact, either your local library or nowadays, your very own in-home networked computer allows you to view the shocking truth about the world &#8211; just laying around!</p>
<p>The great scam here is not that powerful governments hide and sneak and spy and manipulate their own people!  The scam is that the people have all knowledge and means to understand and end these crimes but do nothing!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246734">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246734">
						May 4, 2015 11:21 AM					</a>

				</p>

				<p>Yes, &#8220;EVERYONE is using them&#8221; (packet injection): USA GB GER China, crooks, hackers crackers your next door neighbor.</p>
<p>It would be a different story if the National SECURITY Agency and it&#8217;s ilk used their resources to make the internet SECURE. Instead, we know now they see their job as DESTROYING SECURITY so they can collect electronic data from EVERYONE in the world, including the people that pay them (taxpayers) and those supposed to be their bosses (Congress).</p>
<p>Based mostly based on the Snowden Revelations we know their game anymore. We may not know every one of their plays, but we know what the rules are:</p>
<p>There aren&#8217;t any.</p>
<p>That&#8217;s NOT the way a democratic republic is supposed to work, no matter how many times repeat the BIG LIE: &#8220;It&#8217;s all legal&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246735">

			<div class="comment by-on-snort-info ">

				<p class="commentcredit">

					<span class="commenter">on snort info</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246735">
						May 4, 2015 11:22 AM					</a>

				</p>

				<p>This is not unique to FoxIt/Snort.  All you need is a simple packet sniffer.  The attack works by matter of being faster, that is all.  So if your session is hijacked, two packets with identical headers/ACK codes will arrive.</p>
<p>Just watching for DUP packets at the start is all you need to do.  Of course, when you start doing that suddenly you are very easy to Denial Of Service, as you will drop connections with doubled start packets.  Well, you can&#8217;t have everything, can you?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246736">

			<div class="comment by-james-sutherland ">

				<p class="commentcredit">

					<span class="commenter">James Sutherland</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246736">
						May 4, 2015 11:31 AM					</a>

				</p>

				<p>Presumably the inserted packets will also be defeated if the target HTML stream is gzip-compressed, let alone anything more elaborate like SSL &#8211; which might suggest they&#8217;d have to do something beforehand to disable gzip on target requests as well, unless they just rely on the target sites all lacking that feature?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246737">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246737">
						May 4, 2015 11:58 AM					</a>

				</p>

				<p>AFAIK <a href="http://www.ethos-os.org/~solworth/minimalt-20131031.pdf" rel="nofollow ugc">Minimalt</a> solves that with mandatory PKI. It is still not released however&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246738">

			<div class="comment by-jeff ">

				<p class="commentcredit">

					<span class="commenter">Jeff</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246738">
						May 4, 2015 12:34 PM					</a>

				</p>

				<p>Why can&#8217;t the MITM just delete the real packets?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246739">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/AndrewSecurity' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246739">
						May 4, 2015 1:01 PM					</a>

				</p>

				<p>This is traditonal man in the middle with a sexed up name used by the NSA from old documents that Snowden had access to and decided to publish to main stream media outside of cybersecurity circles.</p>
<p>The defences required are no different from traditional man in the middle attacks.</p>
<p>All we have learned is that the NSA years ago were using the same tactics as teenagers in the same era just with a more organised and funded approach and for national security agenda purposes.</p>
<p>Rather than the teenagers who were doing it for their own entertainment or to gain credibility among online peer groups.</p>
<p>Even with Stuxnet that the NSA were alleged to have carried out. The tactics resemble that of what teenagers use just with a more organised and funded approach.</p>
<p>To sum up, the NSA are paying close attention to online peer groups from teenagers who are unsuspectingly giving the NSA tips for their next attack designs.</p>
<p>The NSA are on the same page as the teenage hackers but are able to launch the same attack style class with more sophistication.</p>
<p>Bruce said in You Tube videos that it has been the teenage hackers learning from the NSA passing tactics down to UNIVERSITY grads doing a thesis.</p>
<p>I believe the opposite. It is teenage hackers being eavesdropped on are leading the next attack designs for the NSA to take tips from.</p>
<p>Andrew</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246740">

			<div class="comment by-jesse ">

				<p class="commentcredit">

					<span class="commenter">Jesse</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246740">
						May 4, 2015 1:10 PM					</a>

				</p>

				<p>@on snort info:<br />
You can&#8217;t be <em>that</em> easy to DoS, as people would at least need to be able to spoof source IP packets to you in direct response to your TCP connection requests. Anybody in a position to do that is already in a uniquely simple position to mess up your shit compared to, say, any random script kiddie on Xbox live. :J</p>
<p>@James Sutherland:</p>
<blockquote><p>
  Presumably the inserted packets will also be defeated if the target HTML stream is gzip-compressed
</p></blockquote>
<p>Why would that have any effect on anything?<br />
1&gt; Your browser has to announce it&#8217;s <em>willingness</em> to work with gzip codec in it&#8217;s request headers, and then the server has to announce in it&#8217;s uncompressed headers that the payload will be compressed. QI is already on the case from the beginning of the server headers. Even if the real server is passing back gzip data, QI packets can elect to pass back uncompressed data with headers basically reading &#8220;Sorry, I don&#8217;t feel like sending you anything gzipped today!&#8221;</p>
<p>2&gt; The first packet for any non-trivial webpage will always be 1500 bytes (or whatever the chosen MTU is, 1500 is the most popular) so even if the original packet is gzipped, it is not smaller than the QI packet.. it just has a greater portion of the uncompressed payload packed into it.</p>
<p>3&gt; QI could offer you as small of a packet as they feel like, nobody is holding a gun to their head to fill the 1500 bytes.</p>
<p>4&gt; Even <em>if</em> the real packet were smaller than the QI packet due to compression, QI wins thanks to latency not thanks to bandwidth. We are talking about a race between two individual datagrams and not two very long file downloads.</p>
<p>5&gt; If QI felt like compressing <em>it&#8217;s</em> payload, there is nobody stopping that either. Gzip is an embarrassingly simple stream-filter codec to apply to anything that moves.</p>
<p>Hello, QI could compress the attack pages impersonating servers that <em>don&#8217;t</em> support compression, if they&#8217;d like. xD</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246741">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246741">
						May 4, 2015 2:59 PM					</a>

				</p>

				<p>@ Andrew Wallace</p>
<p>Great assessment. I agree entirely.  Ill add that they&#8217;ll leverage academia, industry, and black hats for developing new techniques as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246742">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246742">
						May 4, 2015 3:12 PM					</a>

				</p>

				<p>@ on snort info,</p>
<blockquote><p>Of course, when you start doing that suddenly you are very easy to Denial Of Service, as you will drop connections with doubled start packets. Well, you can&#8217;t have everything, can you?</p></blockquote>
<p>Maybe not but you can have a little more&#8230;</p>
<p>Think a little further on the issue of your statefull firewall</p>
<p>Think not so much on just matching packets by their content but also by their time component as well (thing not also not just a time component but also another dimenson as well).</p>
<p>But also think not so much of dropping packets but capturing them and seperatly analysing them further.</p>
<p>With a little further thought you can see a way to differentiate the wanted from the unwanted packet.</p>
<p>Once you know the bad packet form you can use it in a number of ways, not least is to help recognise further bad packets.</p>
<p>By no means a perfect solution but it raises the bar quite a bit for the attacker, which in effect moves them on to another game.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246743">

			<div class="comment by-mrc ">

				<p class="commentcredit">

					<span class="commenter">MrC</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246743">
						May 4, 2015 4:26 PM					</a>

				</p>

				<p>Where exactly is the redundant (legit, too slow) packet getting discarded by the victim? Presuming that it&#8217;s the browser that&#8217;s doing the discarding, then I&#8217;d think that the appropriate place to be doing this kind of detection would be baking it into the browser. The public at large is not going to go download snort, plus the patch, plus the definitions. Simply not going to happen. They might pay attention to a browser warning saying &#8220;hey, looks like you&#8217;re getting QIed here.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246744">

			<div class="comment by-q ">

				<p class="commentcredit">

					<span class="commenter">Q</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246744">
						May 4, 2015 4:32 PM					</a>

				</p>

				<p>Pardon the naivete, but could this technique be implemented in browsers?  Seems like a relatively simple change.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246745">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246745">
						May 4, 2015 4:36 PM					</a>

				</p>

				<p>@65535 Main reason for a legitimate server to send two packets with identical sequence numbers is a resend due to a NAK (packet got corrupted), or a resend due to a timeout (missing ACK). In either of those two cases, the payload of the packets would be identical or close to identical. So it seems to be a darn near perfect detection of a QI attack is to maintain a fairly short term log of incoming uncorrupted packets where the log contains the associated IP addresses, sequence number, and a hash of the packet content. Reason for storing only uncorrupted packets is to eliminate the case of a packet getting corrupted en-route. Then if a packet is found that has the same IP addresses and sequence number, but differing content hash, then a QI attack has been detected.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246746">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246746">
						May 4, 2015 5:35 PM					</a>

				</p>

				<p>I doubt this works.</p>
<p>If i were a member of the &#8220;Equation Group&#8221; i would reroute your GET request by sending a routing message after your SYN, destination would be a route to a content manipulating &#8220;spoof every ip&#8221; proxy and the original machine wouldnt even see a GET, just a lost connection (happens billions of times a second )so it would not answer directly after a dead SYN-ACK and there would be no dup packages.</p>
<p>In my world you would have to scan for dup SYN-ACKs, but this also only works if they forgot to also reroute the traffic from the original server to the victims box ipaddr to a black hole of their choice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246747">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/AndrewSecurity' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246747">
						May 4, 2015 5:55 PM					</a>

				</p>

				<p>The NSA have two options:</p>
<ol>
<li>Eavesdrop on teenagers</li>
<li>Hire teenagers</li>
</ol>
<p>We&#8217;ve seen an emphasis on a recruitment drive in the last few years so option 2 is picking up more momentum than it was in the past.</p>
<p>Teenagers sitting in their bedroom for hours on end are the main leverage of innovation coming out of NSA.</p>
<p>Nobody likes to admit that and to be honest it would be embarrassing for anyone in the NSA to talk about but it is what is going on.</p>
<p>We see the NSA as a vast superpower so to admit they get their tips from teen hackers is something rather not talked about.</p>
<p>Why do we know this. We just need to look at the Snowden documents to work it out.</p>
<p>The embarassment for the NSA is not that Snowden has stolen the documents it is what the documents say about the NSA and who NSA keep an eye on and taking tips from.</p>
<p>For it to be known that NSA has been taking tips from teenagers in bedrooms is of deep embarrassment for the American administration who finely trim their public profile of something far more superior.</p>
<p>The bubble for the NSA is not burst but its bouncing all over the place.</p>
<p>Sure, NSA have been keeping an eye on politicians such as Merkel for geopolitical intelligence but for technical intelligence its been teen hackers.</p>
<p>What does that tell us as a community.</p>
<p>It tells us NSA keep an eye on exactly the same people we do and don&#8217;t have anything superior to anyone else as far as geopolitical and technical intelligence is concerned.</p>
<p>We&#8217;re looking at the same stuff as each other.</p>
<p>We&#8217;ve been worried that the NSA have been doing different stuff but it looks like NSA are on the same page with only a slight give and take margin.</p>
<p>There has been a worry in the community that NSA have been streets ahead but that&#8217;s not what the Stuxnet and Snowden documents are telling everyone.</p>
<p>The NSA is essentially the byproduct of teen hackers with an on steroids budget to beef up teen tactics.</p>
<p>Andrew</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246748">

			<div class="comment by-larryh ">

				<p class="commentcredit">

					<span class="commenter">LarryH</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246748">
						May 4, 2015 7:26 PM					</a>

				</p>

				<p>@AndrewWallace</p>
<p>I doubt teenagers dig cryptography. However, your point certainly isn&#8217;t without merit (logic?). Therein, lies the power of mass surveillance. We focus on watching for terroristic tendencies, predicting crimes, and other vices over the Net, but it is also a vast knowledgebase to learn from, provided that it takes one to know one.</p>
<p>BTW, I&#8217;ve been enjoying your posts because they are simple and soothing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246749">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246749">
						May 4, 2015 10:25 PM					</a>

				</p>

				<p>@ Andrew Wallace</p>
<p>You went from a decent point about NSA knocking off others&#8217; work to sheer nonsense. NSA has a lot more than those options. They hire all kinds of people for SIGINT, most of which aren&#8217;t teenagers. Most of their R&amp;D is academics with basic COTS kits coming from offensive computing companies and zero days from black market. I agreed that they&#8217;d knock off anyone&#8217;s work once they published it but there&#8217;s zero evidence that they&#8217;re just hiring teens massively. Most published evidence is to the contrary.</p>
<p>Wouldn&#8217;t surprise me if a large number of their script kiddies joined after high school. That&#8217;s still speculation, though, as we know little about them. You seem to be derailing the discussion with strawman points again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246750">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246750">
						May 4, 2015 10:35 PM					</a>

				</p>

				<p>Detecting that type of insertion with a passive tap is dead easy. (And a passive tap cannot be detected by the attacker.) All it needs is a hash-table (key: seq_no ++ h(payload)) coupled with a queue for aging or, alternatively, explicit garbage collection. A small device like an Raspberry Pi (or the far, far better Banana Pi) should be quite able to do it for a home network. Of course, this gets a bit more difficult if they split the insert (sending several packages for one original one), but even then just keeping the first, say, 1000 bytes of each new connection and looking for deviations in data would be enough. Or just detect the deviation in splitting. On detection, log everything and maybe sound a bell or the like. Personally, I would kill the connection, just to be safe.</p>
<p>Basically, this is a project for one rainy weekend to get it to work and some additional ones to make it general enough to give away. May be something I will put on my Linux firewall in the future.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246751">

			<div class="comment by-philip-van-hoof ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://pvanhoof.be/blog' rel='external nofollow ugc' class='url'>Philip Van Hoof</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246751">
						May 5, 2015 4:46 AM					</a>

				</p>

				<p>I keep wondering about this MIN in the patch: if (memcmp(p-&gt;data, seg-&gt;payload, MIN(p-&gt;dsize, seg-&gt;size)). Doesn&#8217;t that mean that you can still place the insert after the size of the smallest and not get detected by this?</p>
<p>The FoxIT article mentions that a retransmission with a different payload size will sometimes look like a QUANTUMINSERT, this can happen when a retransmission is cut short, for example during TCP window size changes. But doesn&#8217;t the session need a new SYN/ACK for that anyway (which requires changes to the sequence numbers).</p>
<p>I noticed that they recently changed the patch from comparing p-&gt;data to p-&gt;payload. Does this solve it (I&#8217;m not an expert in snort&#8217;s apis, so I don&#8217;t know what the difference is between p-&gt;data and p-&gt;payload).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246752">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246752">
						May 5, 2015 10:03 AM					</a>

				</p>

				<p>After reading the comments, the detection of inserted packets in an http stream or segment [not the MTU] seems more difficult that expected.</p>
<p>Re-reading the Fox-IT solution it seems they base the decision to flag QI packets on a 10% weight difference in payload. Intuitively, that 10% payload difference seems OK… to a point.</p>
<p>@ keener</p>
<p>&#8220;…[I] would read it that way that by the differences in package load (legit server and QI) the two packages can be differentiated and the detection will work, while when a legit server sends two packages with same seq. number this will be detected as a false positive due to the same package load.”</p>
<p>That is the way I read it.</p>
<p>If the two packets with the same payload of 10% +/- amount arrive one could either say it was false positive or a real QI [which should be dropped] which is a problem. This assumes the packet was properly forged with the correct IP data and so on.</p>
<p>@ bob</p>
<p>“Blocking Injected packets will be difficult as you cannot be certain which of the duplicate packets is the inserted one. Of course you could check TTL differences, and other anomalies. But they can be faked to be the same as well.”</p>
<p>That is the problem with a “properly forged” packet. Which brings us back to the decision to drop the packet on a 10% payload differentiation – will this 10% payload differential work?</p>
<p>@ on snort info</p>
<p>&#8220;Just watching for DUP packets at the start is all you need to do. Of course, when you start doing that suddenly you are very easy to Denial Of Service, as you will drop connections with doubled start packets. Well, you can&#8217;t have everything, can you?&#8221;</p>
<p>Good observation.</p>
<p>@ Clive Robinson</p>
<p>“Maybe not but you can have a little more&#8230;Think a little further on the issue of your statefull firewall… Think not so much on just matching packets by their content but also by their time component as well (thing not also not just a time component but also another dimenson as well).</p>
<p>“But also think not so much of dropping packets but capturing them and seperatly analysing them further. With a little further thought you can see a way to differentiate the wanted from the unwanted packet… no means a perfect solution but it raises the bar quite a bit for the attacker, which in effect moves them on to another game.”</p>
<p>That is a very good idea. I think there has to be other parameters to determine if it is a real QI packet insertion.</p>
<p>The problem now is what to do if you let the “close call” packets in [to avoid dos&#8217;g yourself]. How do you re-mediate the bogus packets after they start the infection process?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246753">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/AndrewSecurity' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246753">
						May 5, 2015 12:24 PM					</a>

				</p>

				<p>Nick P,</p>
<p>Script kiddie is a derogatory term that we should stop using in the security industry.</p>
<p>Andrew</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246754">

			<div class="comment by-beepeepeep ">

				<p class="commentcredit">

					<span class="commenter">Beepeepeep</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246754">
						May 5, 2015 1:03 PM					</a>

				</p>

				<p>@Andrew Wallace</p>
<p>Why should we stop using it? There&#8217;s behavior we want to discourage and behavior we want to encourage.  We want to discourage reliance on using tools other people write without understanding what the tool exactly does.</p>
<p>Most of the security industry unfortunately are script kiddies nowadays.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246755">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/AndrewSecurity' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246755">
						May 5, 2015 1:44 PM					</a>

				</p>

				<p>Why don&#8217;t we call them penetration testers? That is the professional term used.</p>
<p>Andrew</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246756">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246756">
						May 5, 2015 2:47 PM					</a>

				</p>

				<p>@Andrew Wallace,</p>
<blockquote><p>Why don&#8217;t we call <b>them</b> penetration testers? That is the professional term used.</p></blockquote>
<p>Good question! Perhaps because &#8220;them&#8221; may or may not be &#8220;pen testers&#8221;, dontcha know?</p>
<p>Describe the characteristics and capabilities of &#8220;them&#8221;, then look at the thread below. Pen testers are orthogonal to &#8220;script-kiddies&#8221;.</p>
<p><a href="https://www.schneier.com/blog/archives/2015/03/can_the_nsa_bre_1.html#c6691379" rel="nofollow ugc">Classes of attackers</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246757">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246757">
						May 5, 2015 2:57 PM					</a>

				</p>

				<p>If security is wide open (&#8220;everyone is using them&#8221;), why are we not hearing about the widespread compromise of VISA cards?</p>
<p>I would think that money would be a powerful motive for people to use the QUANTUMINSERT attack</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246758">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/AndrewSecurity' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246758">
						May 5, 2015 5:04 PM					</a>

				</p>

				<p>Wael</p>
<p>To me &#8220;them&#8221; ment young people looking to get hired with no criminal element who are still being ringfenced under the script kiddie tag.</p>
<p>Andrew</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246759">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246759">
						May 5, 2015 5:19 PM					</a>

				</p>

				<p>@ 65535,</p>
<blockquote><p>The problem now is what to do if you let the “close call” packets n [to avoid dos&#8217;g yourself]. How do you re-mediate the bogus packets after they start the infection process?</p></blockquote>
<p>I have thought about this issue off and on for some time, I first thought about it when MS IE was susceptible to malware using graphics files.</p>
<p>The solution I was thinking about is simple in principle but practice might be harder depending on what level you want to take it to.</p>
<p>That is build a firewall that&#8217;s actually part way to being a browser and server &#8211;as with thin clint tech&#8211; it also acts as a format converter and delay line.</p>
<p>So your client browser sends of it&#8217;s request, and it heads off to rryour gateway where it hits this firewall which then forwards the request onto the actual remote site. Under normal circumstances the reply comes back from the remote site to this firewall that builds the page internaly. Once the page is built it converts it into a different form that it then sends on to the client browser as though it had come from the remote server.</p>
<p>When it gets two packets with the expected headers etc but different pay loads instead of sending it onto the client browser it sends a popup warning to the user and if the user decides to carry on it strips out all suspect javascript etc and converts all images to a different format etc.</p>
<p>That&#8217;s the rough idea, a lot of the code to do this already exists with various &#8220;thin client&#8221; and other systems it&#8217;s just a matter of somebody cobbling up a prototype, and finding out where the dificult to solve practical problems are.</p>
<p>Of course there will be some issues with web sites that can not function without javascript etc, the question is are people prepared to live without them?</p>
<p>In my case the answer is yes as I have Javascript turned off and various other things as well. OK I can not see slashdot pages and Utube videos, but tobe honest I&#8217;m not that fussed, they&#8217;ve always struck me as a way to waste your time/life which you are never going to get back&#8230; as they say &#8220;lifes to short&#8221; to waste it 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246760">

			<div class="comment by-marcos-el-malo ">

				<p class="commentcredit">

					<span class="commenter">Marcos El Malo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246760">
						May 5, 2015 6:35 PM					</a>

				</p>

				<p>Your idea brings to mind the scheme used by the Opera Mini browser, which received relayed web pages from intermediary Opera servers. Of course the intention was different: the idea was to compress graphics and reduce the amount of data transfered.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246761">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246761">
						May 5, 2015 8:08 PM					</a>

				</p>

				<p>@Andrew Wallace,</p>
<blockquote><p>To me &#8220;them&#8221; ment young people looking to get hired with no criminal element who are still being ringfenced under the script kiddie tag.</p></blockquote>
<p>So you want to call all <b>&#8220;young people looking to get hired with no criminal element&#8221;</b> penetration testers? What if they  aren&#8217;t even working with computers or information security? Someone flipping burgers at a joint next to you would then qualify as a penetration tester? Then again a &#8220;penetration tester&#8221;, by your definition, isn&#8217;t one if s/he had a criminal record! I think you need to be more specific in your definition 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246762">

			<div class="comment by-andrew-wallace ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/AndrewSecurity' rel='external nofollow ugc' class='url'>Andrew Wallace</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246762">
						May 5, 2015 8:51 PM					</a>

				</p>

				<p>Young people looking to get hired into the NSA with no criminal background was the context already specified.</p>
<p>These folks should not be described in the same way as a script kiddie and I believe the term is outdated.</p>
<p>Andrew</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246763">

			<div class="comment by-marcos-el-malo ">

				<p class="commentcredit">

					<span class="commenter">Marcos El Malo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246763">
						May 5, 2015 9:08 PM					</a>

				</p>

				<p>@clive</p>
<p>My comment three comments up was directed at you. Whoops, should have previewed!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246764">

			<div class="comment by-marcos-el-malo ">

				<p class="commentcredit">

					<span class="commenter">Marcos El Malo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246764">
						May 5, 2015 9:10 PM					</a>

				</p>

				<p>@Wael</p>
<p>Have you forgotten your youth, when your hormones were running wild? I&#8217;m pretty sure the great majority of teenage boys are penetration testers (not all successful, of course).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246765">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246765">
						May 5, 2015 9:31 PM					</a>

				</p>

				<p>@ Andrew Wallace</p>
<p>The term script kiddie originally described people who hacked computers using tools they didn&#8217;t understand made by real hackers. They followed step by step instructions for the common case, while getting the help of <em>real</em> hackers in unusual situations. Snowden leaks show that this is how most of NSA&#8217;s foot-soldiers work, too. The TAO and offensive computing companies employ the real hackers who package up shrink-wrap tools with instructions and heuristics for their users. This situation is identical to the hacker and script kiddie relationship.</p>
<p>So, they&#8217;re script kiddies. Err, script kiddies hitting U.S. government-sanctioned targets in exchange for taxpayer money. So, script kiddies with a bankroll and get out of jail free cards. Must be nice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246766">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246766">
						May 5, 2015 9:56 PM					</a>

				</p>

				<p>@Marcos El Malo,</p>
<p>Apparently so&#8230; Wait until @Figureitout reads this! He&#8217;s gonna have a field day with you 🙂</p>
<p>@Andrew Wallace</p>
<blockquote><p>Young people looking to get hired into the NSA with no criminal</p></blockquote>
<p>Still not penetration testers only! Some could be developers, some could be architects, and some&#8230; could be proctologists! You dig me?</p>
<blockquote><p>and I believe the term is outdated.</p></blockquote>
<p>I&#8217;m not aware of that! What replaced this term?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246767">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246767">
						May 5, 2015 11:24 PM					</a>

				</p>

				<p>Clive Robinson RE: utube<br />
&#8211;Actually you&#8217;re missing out on quite a bit funny videos and more importantly some informational ones (just don&#8217;t read the comments, you might get cancer lol).  These days, once I get the funds (probably after I graduate, but I&#8217;ll be ready to implement) to get multiple connections and truly dedicated modern PC&#8217;s; it&#8217;s good to have PC&#8217;s dedicated to surfing &#8220;unsafe web&#8221; for research/enjoyment, then others for &#8220;safer web&#8221;, then local network, then air gap.</p>
<p>Not to mention some things on my school network are reliant on javascript (I always had to download an insecure version of Adobe flash to do physics homework online at home, someone could just crack my account and screw my grade) and it&#8217;s frickin&#8217; embarrassing, they used to do their own thing and it was good before selling out to google; now they got the &#8220;NSA/DHS&#8221; seal of approval&#8230;lol.  So backdoored garbage then, it&#8217;s not going to be funny when it fails big time.  And the printers are wide the f*ck open, looks like crap, no craftsmanship.  I don&#8217;t get it, brand new printers then installing them like crap.</p>
<p>Wael<br />
&#8211;Don&#8217;t get it.  I&#8217;m always super calm and non-passionate and never let my emotions get the best of me. :p</p>
<p>But seriously I don&#8217;t want more beef and don&#8217;t have anything to prove to anybody.  Don&#8217;t care.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246768">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246768">
						May 6, 2015 1:55 AM					</a>

				</p>

				<p>@ Marcos El Malo,</p>
<blockquote><p>Your idea brings to mind the scheme used by the Opera Mini browser, which received relayed web pages from intermediary Opera servers. Of course the intention was different&#8230; </p></blockquote>
<p>Yes, it&#8217;s a funny old world like that, several unrelated people trying to come up with solutions to various different problems arive at the same basic underlying idea.</p>
<p>The upside when it happens &#8211;and it has happened to me quite a few times&#8211; is it gives confidence that you are thinking in the right direction. The down side is if some one patents the basic underlying idea, it can then become a Patent Troll Tool against many unrelated products.</p>
<p>There is of course another advantage to having this intermediate firewall/server, you can include it in a very wide area VPN or encrypted mixnet etc, which makes the job of the likes of the NSA et al harder still&#8230;</p>
<p>As far as I can see the likes of the NSA et al will not stop their activities legal or otherwise, as long as they can get funding. Thus raising the bar and thus the cost significantly is kind of like a reverse DDoS on them, if you make each attack they want to make expensive then they will stop focusing on &#8220;collect it all&#8221; and go back to the old ways of &#8220;targeted surveillance&#8221;, because although the tax payer purse is large it is limited and politicos want to use it for many other vote gaining and feather bedding activities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246769">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246769">
						May 6, 2015 2:03 AM					</a>

				</p>

				<p>@Jesse, @Nick P, @Andrew Wallace, @Beepeepeep, @Wael, @Marcos El Malo</p>
<p>DDOSers, teenagers, code-cutters, professionals, criminals, penetrators, hackers&#8230;</p>
<p>Please, feel free to define any of the above terms as a singular concept that we all agree upon! Then, maybe we can continue to debate the (de)merits of the terms or classes of people!</p>
<p>At least, <a href="https://www.schneier.com/blog/archives/2015/03/can_the_nsa_bre_1.html#c6691379" rel="nofollow ugc">@Wael tried</a>!!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246770">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246770">
						May 6, 2015 2:07 AM					</a>

				</p>

				<p>@65535:<br />
<cite>That is the problem with a “properly forged” packet. Which brings us back to the decision to drop the packet on a 10% payload differentiation – will this 10% payload differential work?</cite></p>
<p>Even if the 10% differential will work, to do the comparison you would need two or more packets with overlapping sequence numbers. So to effectively <strong>block</strong> QI you would need to delay each packet and see if there will be a duplicate or else you are potentially letting through the inserted one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246771">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246771">
						May 6, 2015 2:21 AM					</a>

				</p>

				<p>@Clive</p>
<p>Yup! That sort of firewall/server could come in handy for a multitude of reasons &#8212; not the least of which is experience/knowledge gained in the process.</p>
<p>Otherwise, it seems silly to devote so much effort towards detecting or deferring these QI &#8216;Man-on-the-Side&#8217; attacks&#8230; Seriously, what sort of topologies are still in use that it wouldn&#8217;t be super easy to leverage such a privileged network position for a MITM..?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246772">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246772">
						May 6, 2015 5:14 AM					</a>

				</p>

				<p>It would be nice to have some Linux kernel switch to use second packet instead of first.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246773">

			<div class="comment by-mike-the-goat-horn-equipped-redux ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://mikethegoat.wordpress.com/' rel='external nofollow ugc' class='url'>Mike the Goat (horn equipped, redux)</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246773">
						May 6, 2015 6:45 AM					</a>

				</p>

				<p>Nick P: exactly! The vast majority of the NSA are indeed script kiddies, most of them using public domain tools that we already know about slightly modified and given some stupid govt codename. Sure, the TAO team probably has some super secret 0day exploits that we don&#8217;t know about but I am beginning to suspect that they are neither as organized or as smart as we&#8217;ve previously given them credit for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246774">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246774">
						May 6, 2015 8:22 AM					</a>

				</p>

				<p>@ Mike the Goat, Nick P, and others,</p>
<p>We have had this conversation about the NSA&#8217;s abilities in this area before. And as I&#8217;ve said before in many respects they are playing catch up, it&#8217;s one of the reasons I disagree with Bruce&#8217;s notion about things moving from PhDs research, it&#8217;s to overly generalised, and can be shown in oh so many cases that some of the moree interesting attacks were discussed in other places &#8211;such as this blog&#8211; long before they made it into PhD research or NSA systems.</p>
<p>Yes there are things that the NSA are far ahead in, but these have been their traditional research areas and the open and academic researchers are catching up rather quickly.</p>
<p>As for the NSA et al having &#8220;script robots&#8221; be they human (kiddies) or AI (systems) is it makes a lot of financial and resource sense when you are running in &#8220;collect it all mode&#8221;. Where as it makes way more sense in &#8220;directed attacks&#8221; to use specialised highly talented staff.</p>
<p>To me this has always appeared to be the sensible way to go about things, I just wonder why there is so much opposition to the idea.</p>
<p>I sometimes think it&#8217;s because it&#8217;s &#8220;more Macho&#8221; to fight and slay a Giant than it is to fend off a pack of rats. The reality is that unless you fight rats with the right defences they will be at the heart of things before you know it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246775">

			<div class="comment by-philip-van-hoof ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://pvanhoof.be/blog' rel='external nofollow ugc' class='url'>Philip Van Hoof</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246775">
						May 6, 2015 2:20 PM					</a>

				</p>

				<p>@Alex: this requires the kind of state that the patch for snort also keeps, to be kept in the kernel. That sounds like a pretty bad idea (a kernel&#8217;s state should not significantly grow over time). Therefore I think it&#8217;s better for userland to detect this (the firewall software, for example snort). By the way, how do you know for sure to drop the first and not the second packet? Dropping the second would actually make quantum-insert much more easy. Plus userland could never detect malicious intent anymore (wireshark would be blind). No, the kernel must deliver as-is and as good as possible deliver a tcp/ip stack.</p>
<p>I think it would be interesting for other userland applications to query the firewall service, like snort, about its analysis. That way the browser could become knowledgeable about the use of duplicate sequence numbers for a given piece of data.</p>
<p>Many designs are possible. I wonder how or what we will end up using in a few years.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246776">

			<div class="comment by-henry ">

				<p class="commentcredit">

					<span class="commenter">Henry</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246776">
						May 6, 2015 9:54 PM					</a>

				</p>

				<p>&#8220;Script kiddie is a derogatory term that we should stop using in the security industry.&#8221;</p>
<p>Security industry invented the word. There is nothing derogatory about the term. If all bad peoples make their own tools of crime, then there will be less risk exposure for good peoples. Enlarge time to crime, then less crime will committed given resource constraint.</p>
<p>Using basic and complex tools to task is fundamental to enterprising and conscription. They increase free market efficiency. Unfortunately, this can also be detrimental to society.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246777">

			<div class="comment by-ronnie-sahlberg ">

				<p class="commentcredit">

					<span class="commenter">ronnie sahlberg</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246777">
						May 6, 2015 9:54 PM					</a>

				</p>

				<p>@bob</p>
<p>&#8221; you would need to delay each packet and see if there will be a duplicate &#8221;</p>
<p>Actually, this happens pretty much automatically nowadays since most computers are on really lossy networks (wifi).<br />
When you download something, the train of TCP segments you receive will often have missing packets due to unreliably networks. When this happens all other segments received behind the lost packet will be queued internally in the RX queue until the host receives the retransmission of the originally lost packet.</p>
<p>I.e. server sends you packets 1 2 3 4 5 6 7 8 9  but packets 1 is lost.<br />
The remaining packets are then kept in the RX queue until the missing pacekt 1 can be retransmitted which takes anything from a few ms, if you are lucky, or &gt;=1 second if you have to take a full retransmission timeout.</p>
<p>This happens a lot in networking  so there are enormously many opportunities for a host to do these kind of checks between every segment it receives and those queued segments that have not yet been delivered to the application.</p>
<p>I would give it a really good chance to very successfully detect almost every single QI attempt just due to this, if just the network stack would &#8220;check any received segment to whatever we have already received but not yet delivered to the application&#8221;.<br />
Would probably be quite trivial to add to at least the linux stack if it doesnt already have these simple checks.</p>
<p>Ethereal/Wireshark actually has a check that detects and flags overlapping segments with conflicting data.<br />
The display filter is &#8220;tcp.segment.overlap.conflict&#8221; and should still work.</p>
<p>It did work at least about 10 years ago when I coded it, for completely different reasons. (I added this to check and quickly find this kind of situation due to broken TCP implementations. There were TCP implementations that did this exact thing due to bugs back in the day.)</p>
<p>So if you have a network trace, wireshark should be able to detect this by that filter.  It works by comparing all segments against the TCP PDU reassembly buffer so you must also make sure you have TCP reassembly enabled in the preferences.</p>
<p>But on the other hand, If they can listen in on your outgoing packets and learn the sequence numbers and then just inject spoofed TCP segments. If they can do that they are already in the path for both forward and reverse direction for your tcp session to the server.<br />
Why cant they just discard the real packets that the server were returning back to you, then  you would never receive any duplicates and you would not be able to detect anything.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246778">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246778">
						May 7, 2015 12:11 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>“…build a firewall that&#8217;s actually part way to being a browser and server &#8211;as with thin clint tech&#8211; it also acts as a format converter and delay line… your client browser sends of it&#8217;s request, and it heads off to rryour gateway where it hits this firewall which then forwards the request onto the actual remote site. Under normal circumstances the reply comes back from the remote site to this firewall that builds the page internaly. Once the page is built it converts it into a different form that it then sends on to the client browser as though it had come from the remote server.</p>
<p>“When it gets two packets with the expected headers etc but different pay loads instead of sending it onto the client browser it sends a popup warning to the user and if the user decides to carry on it strips out all suspect javascript etc and converts all images to a different format etc. a lot of the code to do this already exists with various &#8220;thin client&#8221; and other systems it&#8217;s just a matter of somebody cobbling up a prototype, and finding out where the dificult to solve practical problems are… there will be some issues with web sites that can not function without javascript etc, the question is are people prepared to live without them”</p>
<p>Yes, when you combine your solution with the javascript issue [which many sites rely upon] it becomes an extremely complex issue. But, without the .js issue your solution has a lot of merit. I think the final workable solution will have to be a combination of Snort with a browser fix or IP stack fix.</p>
<p>@ bob<br />
“Even if the 10% differential will work, to do the comparison you would need two or more packets with overlapping sequence numbers. So to effectively block QI you would need to delay each packet and see if there will be a duplicate or else you are potentially letting through the inserted one.”</p>
<p>That is valid, and that delay might not be acceptable for some users. The solution is more difficult that I thought [it took me quite awhile to read and digest each comment].</p>
<p>@ ronnie sahlberg</p>
<p>“this happens pretty much automatically nowadays since most computers are on really lossy networks (wifi). When you download something, the train of TCP segments you receive will often have missing packets due to unreliably networks. When this happens all other segments received behind the lost packet will be queued internally in the RX queue until the host receives the retransmission of the originally lost packet. server sends you packets 1 2 3 4 5 6 7 8 9 but packets 1 is lost. The remaining packets are then kept in the RX queue until the missing pacekt 1 can be retransmitted which takes anything from a few ms, if you are lucky, or &gt;=1 second if you have to take a full retransmission timeout. This happens a lot in networking so there are enormously many opportunities for a host to do these kind of checks between every segment it receives and those queued segments that have not yet been delivered to the application. I would give it a really good chance to very successfully detect almost every single QI attempt just due to this, if just the network stack would &#8220;check any received segment to whatever we have already received but not yet delivered to the application&#8221;</p>
<p>That is a good point. That brings us back to a change in the network stack or some browser plug-in/fix. It is a complex problem which will probably get worse as common hackers adopt these sophisticated packet injection attacks.</p>
<p>HTTPS for all web communications is look better each day [as this site uses].</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-246779">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246779">
						May 7, 2015 12:51 AM					</a>

				</p>

				<p>@ 65535,</p>
<blockquote><p>Yes, when you combine your solution with the javascript issue[which many sites rely upon] it becomes an extremely complex issue.</p></blockquote>
<p>From a security perspective nobody and I realy do mean nobody should be allowed &#8220;to load code&#8221; onto your system.</p>
<p>As far as .js goes, it is a technology that&#8217;s a decade or so past it&#8217;s sell by date. Those who insist on .js are being quite indolent on using it.</p>
<p>Javascript and similar all belong on the scrap heap of history, not in the developers or even maintainers tool box, they are the major security vulnerability these days and should as a consequence be given the drop kick into the bad idea dump&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-246780">

			<div class="comment by-roy ">

				<p class="commentcredit">

					<span class="commenter">roy</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/#comment-246780">
						October 3, 2016 5:05 AM					</a>

				</p>

				<p>I don&#8217;t know why people keep suggesting to implement detection in browsers. Browsers aren&#8217;t able to access the raw TCP data. In order to do that, they&#8217;d have to run as root (or with CAP_NET_ADMIN) and bind directly to the interface like a packet capture utility. I suppose theoretically a browser could run a setuid/setcap privilege-separated program which binds to the network interface which the browser will be using, sending the browser events over a simple interface like a pipe, which would allow better integration between detection and browser response&#8230; But having the browser in any way need to bind to an interface and sniff raw packets seems like an overall nasty concept.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2015/05/detecting_quant.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2015/05/detecting_quant.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fdetecting_quant.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2015/05/detecting_quant.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='7002' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2015/05/friday_squid_bl_476.html" rel="prev">← Friday Squid Blogging: Ceramic Squid Planters</a>		<a href="https://www.schneier.com/blog/archives/2015/05/easily_cracking.html" rel="next">Easily Cracking a Master Combination Lock →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
