<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Story of the ZooKeeper Poison-Packet Bug - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Story of the ZooKeeper Poison-Packet Bug Comments Feed" href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/7046" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=7046' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fstory_of_the_zo.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fstory_of_the_zo.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-7046 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-7046" class="post-7046 post type-post status-publish format-standard hentry category-uncategorized tag-aes tag-apache tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">Story of the ZooKeeper Poison-Packet Bug</h2>
		<p>Interesting <a href="http://arstechnica.com/information-technology/2015/05/the-discovery-of-apache-zookeepers-poison-packet/">story</a> of a complex and deeply hidden bug &#8212; with AES as a part of it.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/aes/" rel="tag">AES</a>, <a href="https://www.schneier.com/tag/apache/" rel="tag">Apache</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html" rel="bookmark">Posted on May 25, 2015 at 9:20 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html#comments">20 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html" data-title="Story of the ZooKeeper Poison-Packet Bug" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-248432">

			<div class="comment by-snarki-child-of-loki ">

				<p class="commentcredit">

					<span class="commenter">Snarki, child of Loki</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248432">
						May 25, 2015 9:38 AM					</a>

				</p>

				<p>The linked article gets all the way to the workaround, but doesn&#8217;t<br />
quite nail the culprit.</p>
<p>Was the hardware aes-ni instruction, or the linux aesni-intel module, the source<br />
of the bug?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248433">

			<div class="comment by-chris-s ">

				<p class="commentcredit">

					<span class="commenter">Chris S</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248433">
						May 25, 2015 11:46 AM					</a>

				</p>

				<p>@snarki;</p>
<p>That&#8217;s actually part of the interesting, if frustrating, result. They still aren&#8217;t quite sure. They know the workaround works, but as they explicitly state &#8220;a proper fix still regrettably eludes us&#8221;.</p>
<p>Futher comments suggest that it&#8217;s actually the Xen virtualization layer which may not accurately save and restore state on VM switches; this is further indicated because as of Xen 4.4, the problem ceases.</p>
<p>Kudos to them for getting this far, AND publishing this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248434">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248434">
						May 25, 2015 12:19 PM					</a>

				</p>

				<p>Even though most internet tech stuff is beyond me, I still thought the linked article was a fascinating read. 🙂</p>
<p>Btw, someone in the comment field claimed something that I found bewildering and at the same time a fasicnating piece of information:<br />
&#8220;For something that not a lot of network people seem to know, 2 single bit errors exactly 16 bits apart will calculate to the same TCP checksum.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248435">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248435">
						May 25, 2015 12:35 PM					</a>

				</p>

				<p>Fascinating.<br />
Does the native Intel AES-NI instruction bogus?<br />
Or AES-NI software emulation in Xen is incorrect?<br />
(see <a href="https://communities.intel.com/message/107795" rel="nofollow ugc">https://communities.intel.com/message/107795</a> &#8220;AES-NI is not available in a virtualized environment&#8221;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248436">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248436">
						May 25, 2015 12:46 PM					</a>

				</p>

				<p>Not being a computer engineer or anything, thus not having a basic understanding of the whole thing, forgive me for asking:<br />
Am I to understand that, if the standards is to blame for deeming a second checksum to be literally &#8220;unnecessary&#8221;, could this &#8216;bug&#8217; also be deemed an &#8216;exploit&#8217;?</p>
<p>What is interesting with this notion of an exploit, would be that the problems that arise with this &#8216;bug&#8217;, might as I imagine it, quietly manifest itself in other situations (w. Windows for example).</p>
<p>Bewildered by my ignorance in these matters, I am still wondering:<br />
Would a bug in sort of having a checksum in TCP with IPsec have anything to do with using crypto on the internet in general?</p>
<p>My simple mind recall &#8220;IPsec&#8221; being a part of IPv6, but I wouldn&#8217;t think IPsec was a part of everyday stuff on the internet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248437">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248437">
						May 25, 2015 1:55 PM					</a>

				</p>

				<p>@Curious</p>
<p>I&#8217;m not sure how you could exploit it, as you would have to manipulate the packet before it is encrypted. Tampering with it over the wire is just going to cause the MAC to fail to validate. The TCP checksum is designed only to detect accidental errors, and yeah, it&#8217;s probably insufficient even for this purpose; with only 65536 possible values, a bad packet will go undetected quite often. The checksum is designed to be as fast as possible, and thus only does addition.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248438">

			<div class="comment by-ray-dillinger ">

				<p class="commentcredit">

					<span class="commenter">Ray Dillinger</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248438">
						May 25, 2015 2:07 PM					</a>

				</p>

				<p>It depends on your programming environment, but I always start by assuming that whatever the code I&#8217;m writing must interact with is an application written by Satan.</p>
<p>Thus I wind up with lots of checks for things that &#8220;Can&#8217;t happen&#8221; if some other system is working correctly, and most of the same people who call me a &#8220;raging hair-triggered paranoid doing unnecessary work for no reason&#8221;, are later astonished how often those checks fail.</p>
<p>I probably am paranoid in fact; I assumed from the outset that Intel would get the AES instruction wrong.  I assumed this because of a combination of two reasons: First, it was no longer source code where everyone could see how it was done and verify that it was right.  Second, there are powerful entities who are motivated to ensure that they fail in subtle ways that are exploitable but won&#8217;t usually be noticed. Sometimes I hate being right, but color me completely unsurprised.</p>
<p>So, no, in my universe you don&#8217;t skip a checksum just because it&#8217;s also supposed to have been done somewhere else.  You don&#8217;t fail to handle an exception because the exception won&#8217;t happen if the system you&#8217;re interacting with does its job.  You use unsigned if there&#8217;s any chance of overflow because signed overflow is undefined behavior&#8230; and so on.  And code takes several times longer to write, and in the short run I&#8217;m less productive than a lot of programmers.  In the long run I like to think I spend a smaller fraction of my career chasing down crap like this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248439">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248439">
						May 25, 2015 2:29 PM					</a>

				</p>

				<p>@Ray Dillinger</p>
<p>If Intel got the code wrong, it would be a lot more noticeable; anything using AES in GCM or CCM modes or using AES with CBC-MAC would end up failing regularly with any implementation using AES-NI instructions. The fact that it only happens on virtualized environments with certain versions of Xen seems to indicate it is not a problem with the hardware implementation itself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248440">

			<div class="comment by-its-a-conspiracy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://just@kidding.com' rel='external nofollow ugc' class='url'>It&#039;s a conspiracy!</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248440">
						May 25, 2015 3:08 PM					</a>

				</p>

				<p>Plot twist: This is actually an Intel EAS-NI backdoor malfonctionning!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248441">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248441">
						May 25, 2015 3:18 PM					</a>

				</p>

				<p>Somehow I was reminded of a batman comic when reading the linked article. The comic might have been a spinoff from a Batman movie. Anyway, iirc the Joker poisons people by selling consumable products, but the consumables are not poiosonous by themselves, but become toxic when used in combination with other consumables. 😛</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248442">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248442">
						May 25, 2015 4:44 PM					</a>

				</p>

				<p>@Curious</p>
<p>Ha! I&#8217;d be willing to wager that the Joker had some clowns on the inside of those grocery store &#8216;loyalty&#8217; card databases&#8230; ^_^</p>
<p>(Sorry, way off topic! Uhhh&#8230; yeah, this particular bug/exploit is Xen-based, not Intel initiated.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248443">

			<div class="comment by-snake-oil-alert ">

				<p class="commentcredit">

					<span class="commenter">Snake Oil Alert</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248443">
						May 25, 2015 7:40 PM					</a>

				</p>

				<p>I&#8217;m going to post this in the next Squid Blog but whilst we&#8217;re on-topic you can all have a good laugh at this.</p>
<p>I was researching <a href="http://www.sandisk.co.uk/products/software/secureaccess/" rel="nofollow ugc">Sandisk Secure Access Software</a> when I discovered the supplier: &lt;a href=&#8221;http://www.encryptstick.com/&#8221;EncryptStick&#8221;&gt;EncryptStick.  My suspicions were aroused when I saw this <a href="http://www.encryptstick.com/encryptstick.html" rel="nofollow ugc">claim</a>:</p>
<p><i>&#8220;You have the option to encrypt your vaults with 128, 256, or 512-bit AES ciphers.  Our encryption is registered and government approved, and is FIPS 140-2 compliant. In an upcoming release, we will offer a 1024-bit encryption option.&#8221;</i></p>
<p>The official AES standard is 128, 192 or 256 bits and not 128, 256, 512 or 1024 bits&#8230; a definite sign of snake oil. They say their product is FIPS &#8220;compliant&#8221; but not &#8220;certified&#8221;, presumably to mislead gullible purchasers.</p>
<p>Worst still I found who I believe to be the parent company, offering a piece of software called TurboCrypt, which supposedly offers &#8220;1024 bit Polymorphic Encryption and 4&#215;256 bit AES&#8221;. They showcase their <a href="https://www.turbocrypt.com/eng/content/TurboCrypt/File-Encryption.html" rel="nofollow ugc">&#8220;Polymorphic Giant Block Size Cipher&#8221;</a> and even have a <a href="https://www.turbocrypt.com/vpics/9a8f098c615a425eab6d17c804dd67ae/whitepapers/giant_block_size_polymorphic_cipher.pdf" rel="nofollow ugc">pseudo-scientific paper</a> to support their wild claims.</p>
<p>Their <i><a href="https://www.turbocrypt.com/eng/content/Backround-Info/Polymorphic-Medley-Cipher.html" rel="nofollow ugc">&#8220;Polymorphic Medley Cipher V.2 &#8211; AES, Twofish, Serpent, Cast-256, RC6, SEED, Camellia and Anubis cascaded with keyed cipher selection&#8221;</a></i> source code is here 🙂</p>
<p><b>Has anybody heard of their founder C.B. Roellgen?</b></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248444">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248444">
						May 25, 2015 11:00 PM					</a>

				</p>

				<p>@Snake Oil Alert</p>
<p>Even if you try, I doubt that you can concoct such a low server security grade at seen at turbocrypt.com:</p>
<p><a href="https://www.ssllabs.com/ssltest/analyze.html?d=www.turbocrypt.com&#038;s=80.242.134.246" rel="nofollow ugc">https://www.ssllabs.com/ssltest/analyze.html?d=www.turbocrypt.com&#038;s=80.242.134.246</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248445">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248445">
						May 25, 2015 11:41 PM					</a>

				</p>

				<p>@Curious<br />
&#8220;For something that not a lot of network people seem to know, 2 single bit errors exactly 16 bits apart will calculate to the same TCP checksum.&#8221;</p>
<p>If I understand it correctly, only in some cases will 2 single-bit errors 16 bis apart leave the checksum unchanged. If bit A is the same as bit B which occurs 16 bits later, then changing them both will change the checksum. But if they&#8217;re different, then changing them both will leave the checksum unchanged.</p>
<p>The TCP checksum is just a sum (albeit ones-complement). If you exchange one 16-bit word of the TCP payload with any other, the checksum remains unchanged. If you exchange 1 or more bits of any 16-bit word with the corresponding bits of any other 16-bit word, the checksum remains unchanged.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248446">

			<div class="comment by-rgaff ">

				<p class="commentcredit">

					<span class="commenter">rgaff</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248446">
						May 26, 2015 12:05 AM					</a>

				</p>

				<p>@ Jacob how is this possible to get such a grade?  That has to take some real serious effort to get that low!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248447">

			<div class="comment by-g ">

				<p class="commentcredit">

					<span class="commenter">G</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248447">
						May 26, 2015 1:13 AM					</a>

				</p>

				<p>Interesting.  Just to comment on the upper layer in this stack, having written a couple data data replication subsystems for enterprise storage systems and the like, I have to say, not checksumming your messages yourself (depending on TCP to do it for you?  Really?), and passing raw RPC length fields straight to malloc (or the Java equivalent here) is pretty noobish.  Even if nothing in the infrastructure or network clobbered that value, the client may have had a bug and emitted a message with a bogus value there.  That&#8217;s all it takes.</p>
<p>This type of problem is not as hard to debug as one might conclude from this article.  The main thing is it&#8217;s not all that hard to repeat, and it&#8217;s easy to detect (corrupt packets) when it happens.  This allows you to dig and iterate.  The main cool thing about this story is that they persisted (didn&#8217;t just settle for the first workaround they discovered), and documented it for the rest of the world.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248448">

			<div class="comment by-dm ">

				<p class="commentcredit">

					<span class="commenter">dm</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248448">
						May 26, 2015 4:44 AM					</a>

				</p>

				<p>Roellgen sounds like a kook, but that may just be the result of the language difference. Over the years I have worked with many foreigners for whom English is a second language, and they often sound just like Roellgen, even when they really do have something to offer.</p>
<p>I don&#8217;t want to impose any opinions about his work &#8212; I do have my own opinion. But for an objective assessment, he mentions that his &#8220;Polymorphic Encryption&#8221; is a <em>patented</em> technique.</p>
<p>I work on the side as a &#8220;Scientific Advisor&#8221; to Patent Law firms. If his method is really patented, then all of the information needed to replicate it must also be published in the patent disclosure. Hence, it cannot be held as a secret sauce.</p>
<p>It should therefore be easy enough to discern whether or not he is a kook&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248449">

			<div class="comment by-snake-oil-alert ">

				<p class="commentcredit">

					<span class="commenter">Snake Oil Alert</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248449">
						May 26, 2015 7:49 AM					</a>

				</p>

				<p>@Jacob &#8211; I didn&#8217;t even look at his website security &#8211; &#8216;F&#8217; is terrible. Last time I checked my own site I had an A+ rating and that is <i>easily</i> achievable with modern certificates/server programming. How a security company can get such a poor rating is beyond me.</p>
<p>@dm &#8211; I don&#8217;t think it is the language difference &#8211; I can understand what he&#8217;s saying but his logic doesn&#8217;t add up. It&#8217;s his whole explanation of standards and (unrelated) mathematical concepts in his &#8216;literature&#8217;. He seems to have copy and pasted explanations of cryptographic concepts and changed them slightly to fit his idea.</p>
<p>His use of phrases like <i>&#8220;No Government Agency in this world can ever break TurboCrypt&#8221;, &#8220;Royalty-free use for any legal civil application&#8221;</i> and his <a href="https://www.turbocrypt.com/eng/content/Backround-Info/03-2013-challenge.html" rel="nofollow ugc">$7,000 bounty for cracking his cipher complete with corny pictures makes me laugh.</a></p>
<p>He then tries to debunk established ciphers like Rijndael (a.k.a. AES) despite the fact he uses it within his own products! If Bruce Schneier had something interesting to say about AES we&#8217;d all listen &#8211; he&#8217;s a well established expert with demonstrable work/proof. Mr Roellgen seems more akin to a charlatan than an expert.</p>
<p>The software EncryptStick (developed by Roellgen) which SanDisk are using for their encrypted USB sticks is trivial to defeat because of its poor implementation.</p>
<p>@Schneier &#8211; If you see this post I&#8217;ve just found your old Crypto-Gram newsletter on <a href="https://www.schneier.com/crypto-gram/archives/1999/0215.html#snakeoil" rel="nofollow ugc">Snake Oil</a> and Mr Roellgen seems to hit almost all of your warning signs. Your <a href="https://www.schneier.com/crypto-gram/archives/1998/1215.html#contests" rel="nofollow ugc">other article</a> on the Fallacy of Cracking Contests is also very pertinent here. If you have a &#8216;Rogues Gallery&#8217; you might want to consider awarding Mr Roellgen a place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-248450">

			<div class="comment by-petrov ">

				<p class="commentcredit">

					<span class="commenter">Petrov</span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248450">
						May 27, 2015 10:01 AM					</a>

				</p>

				<p>Comment:</p>
<p>I was interested in this because the title maybe promised either a security issue which was put in by nation states, or possibly previous found by nation states. As very difficult to find security issues of a critical rating are among the highest of value for such parties. However, while it does sound like it is likely exploitable, and it was extremely difficult to find, and it likely would have been exploitable at a critical level using a high value (encrypted) protocol&#8230; it requires a number of &#8216;stars to be aligned&#8217; for it to actually work.</p>
<p>So, unlikely to have been found before (though the developer indicated some manner of crash, he did not seem to have had solid enough data beyond a &#8216;pretty good suspicion&#8217; of the culprit) (developers and especially ones tending bug databases tend to find out these sorts of issues as they have, effectively, such a large citizen qa team)&#8230; and unlikely to have been put there by anyone intentionally. (There are plenty of ways to have done this level of attack so there was not a &#8216;many stars aligned&#8217; problem, and have low likelihood of detection due at the least to the complexity of the underlying encruption and packet handling systems required.)</p>
<p>Interesting story, though, and well told. I feel for them going that far to track out the problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-248451">

			<div class="comment by-jeroen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.encryptstick.com' rel='external nofollow ugc' class='url'>Jeroen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/#comment-248451">
						June 15, 2015 2:55 PM					</a>

				</p>

				<p>Hi Guys,<br />
I would like to comment on the things I read here in relation to EncryptStick.<br />
TurboCrypt and EncryptStick are totally unrelated and Roellgen is certainly not a founder of EncryptStick, nor does he have any relation with the current product or the company.<br />
EncryptStick used the PMC cipher many years ago but it was replaced by the FIPS OpenSSL AES implementation.<br />
SanDisk SecureAcces uses the OpenSSL AES FIPS version. Not a single bit PMC.<br />
Need more info? just email <a href="mailto:support@encryptstick.com">support@encryptstick.com</a> and you can get the facts.</p>
<p>We are trying to build the best security product we can for a broad audience. Associating us with TurboCrypt or Roellgen does not help.<br />
Like always, don&#8217;t take my word for it, do the hard work and check the facts.</p>
<p>Jeroen</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2015/05/story_of_the_zo.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2015/05/story_of_the_zo.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fstory_of_the_zo.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2015/05/story_of_the_zo.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='7046' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2015/05/friday_squid_bl_481.html" rel="prev">← Friday Squid Blogging: Giant Squid Washes Up in New Zealand</a>		<a href="https://www.schneier.com/blog/archives/2015/05/stink_bombs_for.html" rel="next">Stink Bombs for Riot Control →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
