<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Back Door in Juniper Firewalls - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Back Door in Juniper Firewalls Comments Feed" href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/7751" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=7751' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F12%2Fback_door_in_ju.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F12%2Fback_door_in_ju.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-7751 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-7751" class="post-7751 post type-post status-publish format-standard hentry category-uncategorized tag-backdoors tag-firewall tag-juniper tag-nist tag-nsa tag-random-numbers tag-ssh tag-vpn">

	<div class="article">

		<h2 class="entry">Back Door in Juniper Firewalls</h2>
		<p>Juniper has warned about a <a href="http://arstechnica.com/security/2015/12/unauthorized-code-in-juniper-firewalls-decrypts-encrypted-vpn-traffic/">malicious</a> <a href="http://www.wired.com/2015/12/juniper-networks-hidden-backdoors-show-the-risk-of-government-backdoors/">back</a> <a href="http://www.engadget.com/2015/12/17/juniper-networks-finds-backdoor-code-in-its-firewalls/">door</a> in its firewalls that automatically decrypts VPN traffic. It&#8217;s been there for years.</p>
<p>Hopefully details are forthcoming, but the folks at Hacker News have <a href="https://news.ycombinator.com/item?id=10764274">pointed</a> to <a href="https://kb.juniper.net/InfoCenter/index?page=content&#038;id=KB28205&#038;pmv=print&#038;actp=LIST">this page</a> about Juniper&#8217;s use of the DUAL_EC_DBRG random number generator. For those who don&#8217;t immediately recognize that name, it&#8217;s the pseudo-random-number generator that was <a href="https://en.wikipedia.org/wiki/Dual_EC_DRBG">backdoored by the NSA</a>. Basically, the PRNG uses two secret parameters to create a public parameter, and anyone who knows those secret parameters can predict the output. In the standard, the NSA chose those parameters. Juniper doesn&#8217;t use those tainted parameters. Instead:</p>
<blockquote><p>ScreenOS does make use of the Dual_EC_DRBG standard, but is designed to not use Dual_EC_DRBG as its primary random number generator. ScreenOS uses it in a way that should not be vulnerable to the possible issue that has been brought to light. Instead of using the NIST recommended curve points it uses self-generated basis points and then takes the output as an input to FIPS/ANSI X.9.31 PRNG, which is the random number generator used in ScreenOS cryptographic operations.</p></blockquote>
<p>This means that all anyone has to do to break the PRNG is to hack into the firewall and copy or modify those &#8220;self-generated basis points.&#8221;</p>
<p><a href="https://www.imperialviolet.org/2015/12/19/juniper.html">Here&#8217;s</a> a good summary of what we know. The conclusion:</p>
<blockquote><p>Again, assuming this hypothesis is correct then, if it wasn&#8217;t the NSA who did this, we have a case where a US government backdoor effort (Dual-EC) laid the groundwork for someone else to attack US interests. Certainly this attack would be a lot easier given the presence of a backdoor-friendly RNG already in place. And I&#8217;ve not even discussed the SSH backdoor which, as <a href="http://www.wired.com/2015/12/juniper-networks-hidden-backdoors-show-the-risk-of-government-backdoors/">Wired notes</a>, could have been the work of a different group entirely. That backdoor certainly isn&#8217;t NOBUS &#8212; Fox-IT claim to have found the backdoor password in six hours.</p></blockquote>
<p>More details to come, I&#8217;m sure.</p>
<p>EDITED TO ADD (12/21): A <a href="https://community.rapid7.com/community/infosec/blog/2015/12/20/cve-2015-7755-juniper-screenos-authentication-backdoor">technical overview</a> of the SSH backdoor.</p>
<p>EDITED TO ADD (12/22): Matthew Green wrote a really good <a href="http://.cryptographyengineering.com/2015/12/on-juniper-backdoor.html">technical post</a> about this. </p>
<blockquote><p>They then piggybacked on top of it to build a backdoor of their own, something they were able to do because all of the hard work had already been done for them. The end result was a period in which someone &#8212; maybe a foreign government &#8212; was able to decrypt Juniper traffic in the U.S. and around the world. And all because Juniper had already paved the road.</p></blockquote>
<p>Another <a href="http://www.wired.com/2015/12/researchers-solve-the-juniper-mystery-and-they-say-its-partially-the-nsas-fault/">good article</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="https://www.schneier.com/tag/firewall/" rel="tag">firewall</a>, <a href="https://www.schneier.com/tag/juniper/" rel="tag">Juniper</a>, <a href="https://www.schneier.com/tag/nist/" rel="tag">NIST</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/random-numbers/" rel="tag">random numbers</a>, <a href="https://www.schneier.com/tag/ssh/" rel="tag">SSH</a>, <a href="https://www.schneier.com/tag/vpn/" rel="tag">VPN</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html" rel="bookmark">Posted on December 21, 2015 at 6:52 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html#comments">41 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html" data-title="Back Door in Juniper Firewalls" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-264277">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264277">
						December 21, 2015 8:09 AM					</a>

				</p>

				<p>Off the two back doors that appear to be present &#8211;so far&#8211; there are two questions that arise,</p>
<p>1, is there an NSA insider at Juniper.</p>
<p>2, Why did take so long to spot the easy backdoor, during code review processes.</p>
<p>As others have noted, this news quite nicely points out why even NSA et al backdoors are very very bad news for everyone. But Obama still signed on the dotted line&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264278">

			<div class="comment by-green-squirrel ">

				<p class="commentcredit">

					<span class="commenter">Green Squirrel</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264278">
						December 21, 2015 8:12 AM					</a>

				</p>

				<p>Good info on Rapid7 about the backdoor: <a href="https://community.rapid7.com/community/infosec/blog/2015/12/20/cve-2015-7755-juniper-screenos-authentication-backdoor" rel="nofollow ugc">https://community.rapid7.com/community/infosec/blog/2015/12/20/cve-2015-7755-juniper-screenos-authentication-backdoor</a></p>
<p>It seems people really do pay nothing more than lip service to code review.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264279">

			<div class="comment by-sowhatdidyouexpect ">

				<p class="commentcredit">

					<span class="commenter">SoWhatDidYouExpect</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264279">
						December 21, 2015 8:25 AM					</a>

				</p>

				<p>From Slashdot&#8230;</p>
<p>Juniper&#8217;s Backdoor Password Disclosed, Likely Added In Late 2013</p>
<p><a href="http://it.slashdot.org/story/15/12/21/1257200/junipers-backdoor-password-disclosed-likely-added-in-late-2013" rel="nofollow ugc">http://it.slashdot.org/story/15/12/21/1257200/junipers-backdoor-password-disclosed-likely-added-in-late-2013</a></p>
<p>It even includes the &#8220;special&#8221; password!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264280">

			<div class="comment by-steph ">

				<p class="commentcredit">

					<span class="commenter">Steph</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264280">
						December 21, 2015 8:44 AM					</a>

				</p>

				<p>Wild speculation: The suits mandated use of dual-ec-drbg due to political pressure, the programmers knew it was defective by design, so they tried to salvage things by using a non-default parameters.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264281">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264281">
						December 21, 2015 9:32 AM					</a>

				</p>

				<p>Just great /</p>
<p>&#8220;The argument to the strcmp call is &lt;&lt;&lt; %s(un=&#8217;%s&#8217;) = %u, which is the backdoor password, and was presumably chosen so that it would be mistaken for one of the many other debug format strings in the code. This password allows an attacker to bypass authentication through SSH and Telnet, as long as they know a valid username&#8230;&#8221; –Wired</p>
<p><a href="http://it.slashdot.org/story/15/12/21/1257200/junipers-backdoor-password-disclosed-likely-added-in-late-2013" rel="nofollow ugc">http://it.slashdot.org/story/15/12/21/1257200/junipers-backdoor-password-disclosed-likely-added-in-late-2013</a></p>
<p>Now, the other question is where is the backdoor in Cisco&#8217;s firewalls [PIX and ASA]?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264282">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264282">
						December 21, 2015 9:36 AM					</a>

				</p>

				<p>should be:</p>
<p>[&#8230;%s(un=&#8217;%s&#8217;) = %u&#8230;]</p>
<p>If the above do not post the moderators are hard at work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264283">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264283">
						December 21, 2015 9:59 AM					</a>

				</p>

				<p>&#8220;Basically, the PRNG uses two secret parameters to create a public parameter, and anyone who knows those secret parameters can predict the output.&#8221;</p>
<p>Kind of. Someone who knows the secret backdoor parameter (AFAIK, there&#8217;s only one, P/Q (or maybe it&#8217;s Q/P)) and who has a block of output from Dual_EC can predict the future blocks of output from it. IIRC SSL/TLS is in particular vulnerable because it sends some of its raw RNG output on the connection before using subsequent RNG output to generate session keys. But if Juniper is using Dual_EC output only to feed into some other RNG, I would think it&#8217;s not vulnerable to the back door.</p>
<p>Of course, this doesn&#8217;t address the fundamental problem of RNGs, getting the seed entropy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264284">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264284">
						December 21, 2015 10:27 AM					</a>

				</p>

				<p>@ Steph</p>
<p><i>The suits mandated use of dual-ec-drbg due to political pressure, the programmers knew it was defective by design, so they tried to salvage things by using a non-default parameters.</i></p>
<p>Which still left an open backdoor.</p>
<p>Since the VPN backdoor predates Snowden, the 64k question here is who knew for a fact in 2012-2013 that DUAL-EC-DRBG was rigged and how to exploit it. IMHO, that&#8217;s either the NSA or another 5-Eyes party that information was shared with. Which leaves quite some possible attribution scenarios:</p>
<p>1) Juniper is in bed with the NSA, knew about the backdoor and someone within the company during a code review inadvertently sounded a general alarm that could not be contained. The FBI is now investigating how this could happen.<br />
2) Juniper is not in bed with the NSA, but the backdoors were done by an NSA or 5-Eyes implant.<br />
3) Neither backdoor was done by the NSA or its partners, but by a 3rd party nation state actor who knew about DUAL-EC-DRBG.</p>
<p>Which leads to either of the following:</p>
<p>1) Juniper are rat b<em>st</em>rds who don&#8217;t take their customers&#8217; security serious and deserve to go out of business.<br />
2) Juniper doesn&#8217;t take version control and code review processes seriously. But by coming clean, they at least acknowledge there is a problem and that they&#8217;ll be working on it.<br />
3) If it wasn&#8217;t the NSA, NOBUS has once again been shown to be a fairy tale.</p>
<p>I&#8217;m quite curious to see which countries will be putting Juniper products on their blacklist in the time to come. If both the Russians and the Chinese do so, then we can be reasonably certain it was the NSA quite alright.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264285">

			<div class="comment by-sasparilla ">

				<p class="commentcredit">

					<span class="commenter">Sasparilla</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264285">
						December 21, 2015 10:29 AM					</a>

				</p>

				<p>The Wired article is the best overview article I&#8217;ve read so far.  Appears there are 2 back doors.</p>
<p>The first backdoor Juniper found would give an attacker administrative-level or root privileges over the firewalls.</p>
<p>The second backdoor would effectively allow an attacker who has already intercepted VPN traffic passing through the Juniper firewalls to decrypt the traffic without knowing the decryption keys.</p>
<p>The 1st backdoor password was easy to guess and the analyst in the Wired article was thinking it was too sloppy to be the NSA, but didn&#8217;t think that of the 2nd one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264286">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264286">
						December 21, 2015 10:30 AM					</a>

				</p>

				<p>@ Steph</p>
<p>&#8220;Wild speculation: The suits mandated use of dual-ec-drbg due to political pressure, the programmers knew it was defective by design, so they tried to salvage things by using a non-default parameters.&#8221;</p>
<p>Interesting idea. I&#8217;m surprised we haven&#8217;t seen that scenario happen already.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264287">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">david</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264287">
						December 21, 2015 10:45 AM					</a>

				</p>

				<p>It&#8217;s not clear that the change was the backdoor keypair of Dual EC.</p>
<p>And it&#8217;s also not clear if there is an exploit since Juniper says that they only use in parts of their product that can&#8217;t be exploited with the known backdoor</p>
<p>(more info on how dual EC works, and how it is a backdoor: <a href="https://www.youtube.com/watch?v=OkiVN6z60lg" rel="nofollow ugc">https://www.youtube.com/watch?v=OkiVN6z60lg</a> )</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264288">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264288">
						December 21, 2015 11:46 AM					</a>

				</p>

				<p>@ Steph,</p>
<blockquote><p>Wild speculation: The suits mandated use of&#8230;</p></blockquote>
<p>How about a different &#8220;wild&#8221; scenario,</p>
<p>The DUAL-EC random generator backdoor was found by an insider, or they overheard some one on the inside talk about it&#8230; They then decided if &#8220;it&#8217;s policy&#8221; to add an easy to use backdoor of their own&#8230; No doubt the FBI will find &#8220;the easy backdoor&#8221; suspect and work them over so they cop to both to save managment blushes or the real implants job&#8230;</p>
<p>One thing that might be worth doing is to see which US Gov Depts had the effected routers and which did not, it might tell an interesting story in it&#8217;s own right.</p>
<p>However that does not change my points from the other day, in that importantly this shows the problems with,</p>
<p>1, Insider / Implant agents.<br />
2, Backdoors of any kind.<br />
3, Not using proper &#8220;end to end&#8221; encryption.<br />
4, Trusting proprietary solution providers.<br />
5, Closed sorce &#8220;code review&#8221; processes.</p>
<p>And one or two others besides&#8230;</p>
<p>The only solution to this type of issue is &#8220;To instrument and mittigate&#8221; and don&#8217;t forget you don&#8217;t realy control your hardware unless you take proper segregation steps&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264289">

			<div class="comment by-herman ">

				<p class="commentcredit">

					<span class="commenter">herman</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264289">
						December 21, 2015 11:56 AM					</a>

				</p>

				<p>Nothing beats staring at the logs every day.</p>
<p>The trouble with supposedly secure endpoint devices is that the logs need to be forwarded to another machine, else nobody will ever look at them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264290">

			<div class="comment by-blame_shifter ">

				<p class="commentcredit">

					<span class="commenter">blame_shifter</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264290">
						December 21, 2015 12:30 PM					</a>

				</p>

				<p>I love how Juniper is claiming &#8220;unauthorized code&#8221; to shift the blame away from whatever actually happened.</p>
<p>It&#8217;s still a horrible excuse.  If it were actually &#8220;unauthorized code&#8221; then that says far more about the state of security in an org that derives value from providing security.  Cisco, I&#8217;m certain, is no better.</p>
<p>I just hope pfsense (bsds) are marginally better in this regard.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264291">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264291">
						December 21, 2015 12:50 PM					</a>

				</p>

				<p>Encryption is a honeypot. End of story.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264292">

			<div class="comment by-jesse-thompson ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.lightsecond.com' rel='external nofollow ugc' class='url'>Jesse Thompson</a></span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264292">
						December 21, 2015 2:44 PM					</a>

				</p>

				<p>@Dirk Praet</p>
<blockquote><p>
  the 64k question here is who knew for a fact in 2012-2013 that DUAL-EC-DRBG was rigged and how to exploit it.
</p></blockquote>
<p>Well, I learned it was rigged in 2012 for one. 2012 is when I began to study Bitcoin, and discovered that Satoshi chose Secp256k1 due to insufficient base point entropy to suggest the presence of any back doors, unlike the NIST recommendations of the time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264293">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264293">
						December 21, 2015 3:28 PM					</a>

				</p>

				<p>@ Jesse Thompson</p>
<p><i>Well, I learned it was rigged in 2012 for one.</i></p>
<p>DUAL-EC-DRBG was suspected to be backdoored as early as 2004-2005, amongst others by our esteemed host. But it was not until 2013 that it was kinda confirmed as being part of NSA&#8217;s <a href="https://en.wikipedia.org/wiki/Bullrun_(decryption_program)" target="_blank" rel="noopener noreferrer nofollow ugc">BULLRUN</a> efforts. In April 2014, NIST eventually withdrew it from its draft guidance on random number generators. Both events were a clear heads-up to ANY vendor to remove it from ANY security product. Which Juniper obviously ignored, again leaving the following options:</p>
<p>1) Juniper are a bunch of incompetent and irresponsible *ss clowns.<br />
2) Someone coerced them to leave it in.</p>
<p>We know from Snowden that Juniper&#8217;s NetScreen was a target of the NSA&#8217;s <a href="https://www.schneier.com/blog/archives/2014/01/feedtrough_nsa.html" target="_blank" rel="noopener noreferrer nofollow ugc">FEEDTHROUGH</a> program ( DNT&#8217;s BANANAGLEE and CES&#8217;s ZESTYLEAK).<br />
So either the now revealed backdoors were indeed done under this program, or &#8211; if not &#8211; are something else by another state actor. Which for all practical purposes would make them a Swiss cheese subverted by multiple state actors and whose security certifications should be revoked immediately until they come up with an acceptable story.</p>
<p>I am at this point recommending all of my customers to ditch all Juniper firewall/VPN appliances, including those running JunOS. This company can no longer be trusted. It&#8217;s only by hitting them where it hurts the most that they will learn to take their stuff seriously and/or say no to the NSA and its ilk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264294">

			<div class="comment by-3y8f64jt ">

				<p class="commentcredit">

					<span class="commenter">3y8f64jt</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264294">
						December 21, 2015 6:10 PM					</a>

				</p>

				<p>Everyone keeps calling that NSA program &#8220;FEEDTHROUGH&#8221; but it&#8217;s actually &#8220;FEEDTROUGH&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264295">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264295">
						December 21, 2015 7:54 PM					</a>

				</p>

				<p>Cisco products are safe, because installing backdoors in their products is against their policy.</p>
<p><a href="http://blogs.cisco.com/security/update-for-customers" rel="nofollow ugc">http://blogs.cisco.com/security/update-for-customers</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264296">

			<div class="comment by-mr-paul ">

				<p class="commentcredit">

					<span class="commenter">Mr. Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264296">
						December 21, 2015 8:52 PM					</a>

				</p>

				<p>The &#8220;irresponsible *ss clowns&#8221; theory is often a pretty sound one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264297">

			<div class="comment by-no-such-agency ">

				<p class="commentcredit">

					<span class="commenter">No Such Agency</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264297">
						December 21, 2015 8:55 PM					</a>

				</p>

				<p>That Cisco FAQ is a joke. Read it very carefully; it is so specific, it allows backdoors to exist.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264298">

			<div class="comment by-hugo ">

				<p class="commentcredit">

					<span class="commenter">hugo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264298">
						December 22, 2015 12:41 AM					</a>

				</p>

				<p>What&#8217;s the chance that the backdoor was installed while the product was under control of NetScreen Technologies, before Juniper&#8217;s acquisition?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264299">

			<div class="comment by-hugo ">

				<p class="commentcredit">

					<span class="commenter">hugo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264299">
						December 22, 2015 12:56 AM					</a>

				</p>

				<p>To answer my own question, the Rapid7 blog post states:</p>
<blockquote><p>This is interesting because although the first affected version was released in 2012, the authentication backdoor did not seem to get added until a release in late 2013</p></blockquote>
<p>According to Wikipedia the NetScreen acquisition was 2004.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264300">

			<div class="comment by-vesselin-bontchev ">

				<p class="commentcredit">

					<span class="commenter">Vesselin Bontchev</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264300">
						December 22, 2015 2:48 AM					</a>

				</p>

				<p>There are indeed 2 backdoor. The one disclosed by Rapid7 has been put there by some lamer. First of all, it is in cleartext in the code (instead of using some hash of it, for instance). Second, they managed to do it only the last year:</p>
<p><a href="https://twitter.com/thegrugq/status/679028059907887104" rel="nofollow ugc">https://twitter.com/thegrugq/status/679028059907887104</a></p>
<p>The other one has been in there for much longer. The reason why Juniper Networks sounded so confident after the Snowden disclosure that the NSA had backdoored DUAL_EC_DRBG was because they used it with parameters different from the ones suggested by NIST. It&#8217;s like changing the locks on the backdoor.</p>
<p>However, it is not immediately clear how this second backdoor could be used for breaking the VPN traffic. See this for a technical discussion of the issue:</p>
<p><a href="https://rpw.sh/blog/2015/12/21/the-backdoored-backdoor/" rel="nofollow ugc">https://rpw.sh/blog/2015/12/21/the-backdoored-backdoor/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264301">

			<div class="comment by-detunizedgravity ">

				<p class="commentcredit">

					<span class="commenter">DetunizedGravity</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264301">
						December 22, 2015 3:03 AM					</a>

				</p>

				<p>As for Juniper not alloting enough resources to things like code review, etc. I&#8217;d like to bring your attention to the fact that it happened during the very last years of the lifetime of NetScreen. Most commercial and technical resources at that time were dedicated to polishing and selling the security aspects of JunOS and the SRX devices. Juniper was missing its customers very very hard towards its next gen products back then. I remember how hard it could be to obtain support for, and changes in, NetScreen at that time. This probably participated in what we discover today.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264302">

			<div class="comment by-detunizedgravity ">

				<p class="commentcredit">

					<span class="commenter">DetunizedGravity</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264302">
						December 22, 2015 3:05 AM					</a>

				</p>

				<p>-missing+pushing. Phone autocorrection. Sorry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264303">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264303">
						December 22, 2015 4:06 AM					</a>

				</p>

				<p>@ DetunizedGravity,</p>
<blockquote><p>As for Juniper not alloting enough resources to things like code review, etc. I&#8217;d like to bring your attention to the fact that it happened during the very last years of the lifetime of NetScreen.</p></blockquote>
<p>Here is a quote from the article:</p>
<blockquote><p>ScreenOS does make use of the Dual_EC_DRBG standard&#8230;</p></blockquote>
<p>It has been said before that Dual_EC_DRBG is questionable but after the Snowden revelations alarm bells should have rang. There is no excuse for this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264304">

			<div class="comment by-woo ">

				<p class="commentcredit">

					<span class="commenter">Woo</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264304">
						December 22, 2015 6:19 AM					</a>

				</p>

				<p>I don&#8217;t really get it.. if someone managed &#8220;to hack into the firewall and copy or modify those &#8220;self-generated basis points.&#8221;&#8221;, isn&#8217;t he in there already and could siphon the traffic out by an easier means?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264305">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264305">
						December 22, 2015 8:57 AM					</a>

				</p>

				<p>@ Woo,</p>
<blockquote><p>&#8230; isn&#8217;t he in there already and could siphon the traffic out by an easier means?</p></blockquote>
<p>With easy comes high visability.</p>
<p>That is the attacker has no way of knowing how the target is &#8220;instrumented&#8221; to detect intrusion and exfiltration of data.</p>
<p>However with the points and other problems in the protocol, you get to know what the random number is generating and thus with a little work have the all important keys.</p>
<p>Thus if you are one of the FiveEyes with a &#8220;collect it all&#8221; mentality and the ability to hover it all up well upstream of the site under attack. No matter what instrumentation the person under attack has they won&#8217;t see anything as the attack is now being carried out outside of what they can see.</p>
<p>Worse if the attacker has previously copied all the traffic, then they can see traffic from before the point the points were exfiltrated.</p>
<p>It&#8217;s the reason people like Nicholas Weaver are directly attributing it to a nation state. Such as the US UK Israel etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264306">

			<div class="comment by-l-w-smiley ">

				<p class="commentcredit">

					<span class="commenter">L. W. Smiley</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264306">
						December 22, 2015 1:26 PM					</a>

				</p>

				<p>According to Wired <a href="http://www.wired.com/2015/12/researchers-solve-the-juniper-mystery-and-they-say-its-partially-the-nsas-fault/" rel="nofollow ugc">http://www.wired.com/2015/12/researchers-solve-the-juniper-mystery-and-they-say-its-partially-the-nsas-fault/</a>  the second rng, ANSI X.9.31, is never used, just dual_ec. Further the current patch hasn&#8217;t fixed this just replacing the Q point to what it was leaving the possibility that Juniper could generate a corresponding secret key e to go with Q giving Juniper a backdoor. The researchers in the Wired article suggest that all this coul be fixed with a single line of code which they haven&#8217;t done yet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264307">

			<div class="comment by-scrattaee ">

				<p class="commentcredit">

					<span class="commenter">Scrattæe</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264307">
						December 22, 2015 6:26 PM					</a>

				</p>

				<p>A lot of sources seem to imply that the orignal (and now restored) Q chosen by Juniper was probably generated maliciously as well, to allow someone (Juniper or a client) to monitor the traffic.</p>
<p>But, assuming that someone was actually using an e based on the Q chosen by Juniper to collect and decrypt VPN traffic, shouldn&#8217;t that same someone notice the &#8220;unauthorized&#8221; change of Q, since their e would no longer allow them to decrypt traffic? Why, then, did it take so long for Juniper to detect that the Q had been changed?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264308">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">steven</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264308">
						December 22, 2015 7:22 PM					</a>

				</p>

				<p>@Scrattæe, who really bothers to patch these things after deploying them?  As that slowwwly growing portion of users applies patches, it would still take time, to realise why that &#8216;backdoor zero&#8217; no longer works against specific targets (as you may not even know what firmware version they&#8217;re running);  to get some Juniper insider to fix it for you (perhaps covertly);  and find some compelling reason for everyone to apply the patch restoring the original Q.  The SSH backdoor gives that compelling reason everyone must patch now, and in the very same update Juniper restored the original Q.  As a customer, you may either run an insecure device or restore the original Q.</p>
<p>To save face, Juniper really must get rid of Dual EC DRBG now.</p>
<p>I speculate (actually, wish) that whoever changed the Q &#8211; &#8216;unauthorised&#8217; &#8211; may have done so with the intention of locking the NSA out, rather than letting someone else in.  I can&#8217;t think of a better protest against a government-mandated backdoor, than by sneakily closing it, and leading people to discover and expose it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264309">

			<div class="comment by-jroberts ">

				<p class="commentcredit">

					<span class="commenter">JRoberts</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264309">
						December 23, 2015 12:34 AM					</a>

				</p>

				<p>What if the code existed pre-2013 but the password was only recently changed? SN.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264310">

			<div class="comment by-jg4 ">

				<p class="commentcredit">

					<span class="commenter">JG4</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264310">
						December 23, 2015 7:51 AM					</a>

				</p>

				<p>Karl is a bit rabid, but he often is right and he is self-consistent.  Not sure if this adds anything novel to the discussion.</p>
<p>More On The Juniper &#8216;Hack&#8217;<br />
<a href="http://market-ticker.org/akcs-www?post=230988" rel="nofollow ugc">http://market-ticker.org/akcs-www?post=230988</a><br />
The allegations in this article are explosive, if true.<br />
<a href="http://blog.cryptographyengineering.com/2015/12/on-juniper-backdoor.html" rel="nofollow ugc">http://blog.cryptographyengineering.com/2015/12/on-juniper-backdoor.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264311">

			<div class="comment by-coyne-tibbets ">

				<p class="commentcredit">

					<span class="commenter">Coyne Tibbets</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264311">
						December 24, 2015 2:31 AM					</a>

				</p>

				<p>One of the problems with that &#8220;accidentally disabled&#8221; loop that has been raised, is the question of how this could pass code review (much less debugging).</p>
<p>It occurs to me that perhaps the loop is window dressing&#8230;that it was never intended to work. It presumably was added in response to <i>someone</i> who raised a concern about Dual_EC, and so Juniper would need to show that party that the problem was addressed.</p>
<p>A very obvious loop that addresses the concern&#8230;disabled by a very well hidden modification to a <i>local scope</i> field&#8230;would be the perfect window dressing to convince a concerned customer that, &#8220;See? Everything is fine now.&#8221;  While actually doing nothing, so that the same Dual_EC back door continues to be present.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264312">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264312">
						December 24, 2015 5:03 AM					</a>

				</p>

				<p>More on Juniper&#8217;s hack: <a href="https://theintercept.com/2015/12/23/juniper-firewalls-successfully-targeted-by-nsa-and-gchq/" rel="nofollow ugc">https://theintercept.com/2015/12/23/juniper-firewalls-successfully-targeted-by-nsa-and-gchq/</a></p>
<blockquote><p><i>The author of the 2011 GCHQ document, an NSA employee who was working with GCHQ as part of an “Access Strategy Team,” takes a similarly adversarial view of encryption, referring to Juniper as a “threat” and a “target” because it provides technology to protect data from eavesdropping.</i></p></blockquote>
<p>It seems Juniper Networks has been a target for a long time&#8230; wish to know if OpenBSD is classified the same way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264313">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264313">
						December 24, 2015 12:18 PM					</a>

				</p>

				<p>Appelbaum dropped this one today.. &#8220;Juniper appears to use Oakley group 1 for SSH (!) &#8211; so passive decrypt for that is done.&#8221;</p>
<p>Previously he dropped that &#8220;caprios&#8221; is the name of the SSH decrypt db.</p>
<p>SSH on any of these vendor supplied products is a joke.  If they don&#8217;t get you on the key-exchange, they&#8217;ll get you on key generation, DHE with known moduli or AES-CBC.  muahaha.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264314">

			<div class="comment by-why ">

				<p class="commentcredit">

					<span class="commenter">Why</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264314">
						December 24, 2015 4:38 PM					</a>

				</p>

				<p>Of course $1 is a target, everything is a target. the #Eyes themselves are also a target as is their (subordinate) governments. A target for themselves I mean, not only for others.</p>
<p>Everything being a target is not the end-game, it is the preconditional assumption of all mass surveillance: the conceptual beginning, the dream/nightmare of omniscience &amp; omnipotence. It cannot be any other way but people want to deny the obvious in desperate vain hope of avoiding the realization that future decades or centuries of waste and destruction will be for nothing, for no gains at all, not even insight or learning or history&#8217;s lessons (because look how fast we forget those each time, not that anyone ever seems to learn much in the first place).</p>
<p>For the NSA or whatever other brand of the powers-that-be to not spy on &#8220;themselves&#8221; never mind other departments etc. would be a logical fallacy.</p>
<p>When there is no trust trusting yourself is also a fallacy. Some obviously already know and the rest will have to learn the hard way.</p>
<p>If we&#8217;re lucky this will &#8220;stop&#8221; due to some &#8220;magical&#8221; reason (take your pick; $deity, aliens, AI, civil rights movements, laws (LOL) etc.) when the world (and primarily the previous 1st world) is the 21st or 22nd century equivalent of 1945 Dresden and Hiroshima. If we&#8217;re unlucky the technology and science has improved and will continue to improve enough to survive that and it won&#8217;t ever stop.</p>
<p>That&#8217;s about as far down the rabbit hole as I can see, I can only speculate on what&#8217;s further down below (there could be something there but I&#8217;m never going to write about that possibilities in detail: contexts that makes the insanity of it all &#8220;make sense&#8221; as unavoidable necessities, in which case the only way to win is to lose faster).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264315">

			<div class="comment by-abbadabba ">

				<p class="commentcredit">

					<span class="commenter">abbadabba</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264315">
						December 29, 2015 9:14 AM					</a>

				</p>

				<p>We need to keep in mind that what we shouldn&#8217;t do unto ourselves will be done for NSA, FBI and our county sheriffs by GCHQ, right Watson?  Vise for vise, Versa.  What could be worsa?  We&#8217;re British, again.  Roll over, VanWinkle, and wake me when the thunder bolts, like anyone can sleep through that hellfire, A-10.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-264316">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">steven</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264316">
						January 12, 2016 8:01 AM					</a>

				</p>

				<p>&#8220;To save face, Juniper really must get rid of Dual EC DRBG now.&#8221;</p>
<p>Yay!  Seems they will go ahead with that in ScreenOS 6.3, I just hope people update:<br />
<a href="https://forums.juniper.net/t5/Security-Incident-Response/Advancing-the-Security-of-Juniper-Products/ba-p/286383" rel="nofollow ugc">https://forums.juniper.net/t5/Security-Incident-Response/Advancing-the-Security-of-Juniper-Products/ba-p/286383</a></p>
<p>This is actually thanks to the analysis and public commentary by security researchers who exposed Dual_EC as being at fault, something that Juniper didn&#8217;t initially admit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-264317">

			<div class="comment by-sasparilla ">

				<p class="commentcredit">

					<span class="commenter">Sasparilla</span> •

					<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/#comment-264317">
						January 12, 2016 9:52 AM					</a>

				</p>

				<p>Two things on reflection.  Notice the lack of Official protest and &#8220;foul&#8221; being cried here?  Nothing from the top of Juniper and nothing from the Administration saying the U.S. was blahblahblah&#8217;d by whomever?  Weird, Eh?  This makes it all look as if it was almost surely done by Juniper leadership in willing partnership with the NSA and the beans got spilled (accidentally perhaps?.</p>
<p>Wired had a follow up article that was fabulous so I had to add it here.  They added a timeline for things.  Duel_EC was demonstrated as compromised in 2007 at a cryptography conference.  Juniper added it to the firmware at the end of 2008 / early 2009 &amp; started using it even though their existing code was secure.  Now just adding Duel_EC wouldn&#8217;t be enough they needed to make 3 other changes the most damming of which was the change from a 20 byte nonce (infeasible to attack the encryption with Duel_EC) to a 32 byte one (required to attack the encryption in fractions of a second), but as Duel_EC only outputs 30 bytes at a time, they had to rewrite their code to run Duel_EC twice to get the 32 bytes of output).  Here&#8217;s the article:</p>
<p><a href="http://www.wired.com/2016/01/new-discovery-around-juniper-backdoor-raises-more-questions-about-the-company/" rel="nofollow ugc">http://www.wired.com/2016/01/new-discovery-around-juniper-backdoor-raises-more-questions-about-the-company/</a></p>
<p>From the article:  &#8220;“The key point here is that if any one of the four listed changes in [firmware version] 6.2.0r1 had not happened, then the VPN traffic could not be passively decrypted…,” says Checkoway. “If this backdoor was not intentional, then, in my opinion, it’s an amazing coincidence.”&#8221;</p>
<p>Seems like a 3 party audit of ScreenOS and Junos OS is warranted at this point as who knows what else is in there?  Same for Cisco.  Juniper and Cisco should move to Open Source OS and firmware models before the NSA destroys their businesses (if too much long term damage hasn&#8217;t already been done).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2015/12/back_door_in_ju.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2015/12/back_door_in_ju.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F12%2Fback_door_in_ju.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2015/12/back_door_in_ju.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='7751' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2015/12/friday_squid_bl_506.html" rel="prev">← Friday Squid Blogging: Penguins Fight over Squid</a>		<a href="https://www.schneier.com/blog/archives/2015/12/the_medieval_or.html" rel="next">"The Medieval Origins of Mass Surveillance" →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
