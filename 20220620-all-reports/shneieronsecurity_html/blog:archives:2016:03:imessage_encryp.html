<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>IMessage Encryption Flaw Found and Fixed - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; iMessage Encryption Flaw Found and Fixed Comments Feed" href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/9309" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=9309' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F03%2Fimessage_encryp.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F03%2Fimessage_encryp.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-9309 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-9309" class="post-9309 post type-post status-publish format-standard hentry category-uncategorized tag-apple tag-encryption tag-ios tag-malware tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">iMessage Encryption Flaw Found and Fixed</h2>
		<p>Matthew Green and team found and reported a <a href="https://www.washingtonpost.com/world/national-security/johns-hopkins-researchers-discovered-encryption-flaw-in-apples-imessage/2016/03/20/a323f9a0-eca7-11e5-a6f3-21ccdbc5f74e_story.html">significant iMessage encryption flaw</a> last year.</p>
<blockquote><p>Green suspected there might be a flaw in iMessage last year after he read an Apple security guide describing the encryption process and it struck him as weak. He said he alerted the firm&#8217;s engineers to his concern. When a few months passed and the flaw remained, he and his graduate students decided to mount an attack to show that they could pierce the encryption on photos or videos sent through iMessage.</p>
<p>It took a few months, but they succeeded, targeting phones that were not using the latest operating system on iMessage, which launched in 2011.</p>
<p>To intercept a file, the researchers wrote software to mimic an Apple server. The encrypted transmission they targeted contained a link to the photo stored in Apple&#8217;s iCloud server as well as a 64-digit key to decrypt the photo.</p>
<p>Although the students could not see the key&#8217;s digits, they guessed at them by a repetitive process of changing a digit or a letter in the key and sending it back to the target phone. Each time they guessed a digit correctly, the phone accepted it. They probed the phone in this way thousands of times.</p>
<p>&#8220;And we kept doing that,&#8221; Green said, &#8220;until we had the key.&#8221;</p>
<p>A modified version of the attack would also work on later operating systems, Green said, adding that it would likely have taken the hacking skills of a nation-state.</p></blockquote>
<p>This flaw is fixed in iOS 9.3. (You should download and install it now.)</p>
<p>I <a href="https://www.schneier.com/essays/archives/2016/03/cryptography_is_hard.html">wrote about</a> this flaw in <i>IEEE Security and Privacy</i> earlier this year:</p>
<blockquote><p>Going back to the new vulnerability that you&#8217;ll learn about in mid-February, the lead researcher wrote to me: &#8220;If anyone tells you that [the vendor] can just &#8216;tweak&#8217; the system a little bit to add key escrow or to man-in-the-middle specific users, they need to spend a few days watching the authentication dance between [the client device/software] and the umpteen servers it talks to just to log into the network. I&#8217;m frankly amazed that any of it works at all, and you couldn&#8217;t pay me enough to tamper with any of it.&#8221; This is an important piece of wisdom.</p>
<p>The designers of this system aren&#8217;t novices. They&#8217;re an experienced team with some of the best security engineers in the field. If these guys can&#8217;t get the security right, just imagine how much worse it is for smaller companies without this team&#8217;s level of expertise and resources. Now imagine how much worse it would be if you add a government-mandated back door. There are more opportunities to get security wrong, and more engineering teams without the time and expertise necessary to get</p></blockquote>
<p>Related: A different iOS flaw was reported last week. Called <a href="http://researchcenter.paloaltonetworks.com/2016/03/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/">AceDeceiver</a>, it is a Trojan that allows an attacker to install malicious software onto an iOS device, bypassing Apple&#8217;s DRM protections. I don&#8217;t believe that Apple has fixed this yet, although it seems as if Apple just has to add a certificate revocation list, or make the certs nonreplayable by having some mandatory interaction with the iTunes store.</p>
<p>EDITED (4/14): The <a href="https://isi.jhu.edu/~mgreen/imessage.pdf">paper</a> describing the iMessage flaw.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/apple/" rel="tag">Apple</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/ios/" rel="tag">iOS</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html" rel="bookmark">Posted on March 21, 2016 at 1:45 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html#comments">28 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html" data-title="iMessage Encryption Flaw Found and Fixed" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-270098">

			<div class="comment by-k15 ">

				<p class="commentcredit">

					<span class="commenter">K15</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270098">
						March 21, 2016 2:09 PM					</a>

				</p>

				<p>And we function as a society with protection of privacy and private property how, exactly?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270099">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270099">
						March 21, 2016 2:11 PM					</a>

				</p>

				<blockquote><p>Although the students could not see the key&#8217;s digits, they guessed at them by a repetitive process of changing a digit or a letter in the key and sending it back to the target phone. Each time they guessed a digit correctly, the phone accepted it. They probed the phone in this way thousands of times.</p></blockquote>
<p>I&#8217;m not sure whether this description is dumbed down to the point of being incorrect, or if this flaw was really that unbelievably bad.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270100">

			<div class="comment by-k15 ">

				<p class="commentcredit">

					<span class="commenter">K15</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270100">
						March 21, 2016 2:12 PM					</a>

				</p>

				<p>Is there a solution space?  What would living there look like?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270101">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270101">
						March 21, 2016 2:39 PM					</a>

				</p>

				<p>Let&#8217;s say the 64-digit key was &#8220;the&#8221; key to decrypt the file, how did sending individual digits to the phone for checking work? I haven&#8217;t read the article or other reports yet, but that alone seems very strange.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270102">

			<div class="comment by-kenneth-ng ">

				<p class="commentcredit">

					<span class="commenter">Kenneth Ng</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270102">
						March 21, 2016 2:57 PM					</a>

				</p>

				<p>Is this like the WiFi WEP chop-chop attack?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270103">

			<div class="comment by-victor ">

				<p class="commentcredit">

					<span class="commenter">Victor</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270103">
						March 21, 2016 2:59 PM					</a>

				</p>

				<p>There have been talks of Apple moving towards zero-knowledge encryption of iCloud. For people who use Apple&#8217;s cloud (which uses Amazon AWS and Google) this is a great move to protect privacy but I&#8217;d like users to be given the option. Some people may feel comfortable allowing Apple to reset their password &#8211; they don&#8217;t want to lose priceless photos &#8211; but others will be happy to undertake key management themselves. Providing it doesn&#8217;t result in people using weaker passwords then I&#8217;m all for it.</p>
<p>My concern with iMessage is that no matter how good (or bad) the encryption is it&#8217;ll make no difference if the sender or receiver backup their messages to iCloud because as we know the data on there can be accessed with a warrant. It&#8217;d be good if Apple introduced an ephemeral message (self destruct after X seconds/minutes/days) as it&#8217;d allow a sender to be confident that their message will be destroyed after that amount of time has lapsed (unless the recipient consciously took a screenshot).</p>
<p>On a side note the new Night Shift facility in iOS 9.3 is amazing. Now you can get true night-time reading with very low brightness and very high &#8216;warmth&#8217; of colour. It really makes for a dim but readable screen. As a user of f.lux on the desktop I&#8217;m glad Apple have incorporated it into iOS without the need to dangerously jailbreak your device.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270104">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270104">
						March 21, 2016 3:04 PM					</a>

				</p>

				<p>The level of distrust in LEA and NSA is so great, that one must consider the possibility that the NSA picked up the comm by Prof. Green at the active reasearch state late last year noting that its the iPhone line, the FBI served NSL to get the details and then have used the discoveries to its purpose until patch time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270105">

			<div class="comment by-victor ">

				<p class="commentcredit">

					<span class="commenter">Victor</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270105">
						March 21, 2016 3:05 PM					</a>

				</p>

				<p><b>The 1970 bug has been fixed in this release too.</b></p>
<p>With this update your iPhone, iPad and iPod touch gain improvements to Notes, News, Health, Apple Music and a new feature called Night Shift that may even help you get a better night’s sleep by shifting the colours in your display to the warmer end of the spectrum at night. New features, improvements and bug fixes include:</p>
<p>Night Shift</p>
<p>When enabled, Night Shift uses your iOS device’s clock and geolocation to determine when it’s sunset in your location, then it automatically shifts the colours in your display to the warmer end of the spectrum and may even help you get a better night’s sleep.</p>
<p>Notes improvements</p>
<p>Protect notes that contain your most personal data with Touch ID or a passcode<br />
Sort notes alphabetically, by date created or by date edited<br />
When sketching, quickly bring up a fresh canvas with a two finger swipe or by tapping the New Sketch button<br />
A new checklist button at the bottom of every note makes it easier to create lists<br />
Show thumbnails instead of large images and attachments by long-pressing on any image or attachment in a note<br />
Choose whether photos and videos taken within Notes are stored only in Notes or also added to Photos<br />
Long-press on an Evernote Export file to import its contents into Notes</p>
<p>News improvements</p>
<p>New Top Stories section in For You highlights the most important stories of the day<br />
Discover something great to read in Editors&#8217; Picks, a selection of channels and topics handpicked by our Apple News editors<br />
Swipe left on stories in For You on iPhone to quickly share or save or swipe right for more options<br />
Play video stories right from For You — without opening the article<br />
Read stories and watch videos in landscape orientation on iPhone<br />
Change the text size in articles to make reading easier</p>
<p>Health improvements</p>
<p>Related third-party apps for select data types such as weight, workouts and sleep are displayed in the Health app<br />
Health dashboard adds support for move, exercise and stand Activity data and goals from Apple Watch<br />
Easy access to Dashboard and Medical ID using 3D Touch Quick Actions from the Home screen<br />
Third-party apps now have access to Activity rings and summaries from Apple Watch through HealthKit</p>
<p>Apple Music improvements</p>
<p>Add songs from the Apple Music catalogue to playlists without having to add them to your library<br />
Watch music videos on iPad in full screen<br />
See what’s playing on Beats 1 directly from the Radio tab — without having to tune in<br />
Tap the name of the currently playing song in Now Playing to go to the album<br />
See which songs are most popular on albums in the Apple Music catalogue</p>
<p>Photos improvements</p>
<p>Extract the still image from a Live Photo by tapping Duplicate which will give you the option to duplicate the Live Photo or just the still image<br />
Improved download performance of full size original photos or videos stored in iCloud Photo Library<br />
Share Live Photos between iOS and OS X through AirDrop and Messages</p>
<p>iBooks improvements</p>
<p>Adds the ability for iBooks to store your PDFs in iCloud, making them available across all of your devices<br />
Adds support for downloading previously purchased audiobooks from the iBooks Store<br />
Adds the ability to share your audiobook purchases with any of your family members using Family Sharing<br />
New controls for reading Manga more comfortably with faster page turns and simple controls for enlarging text<br />
Adds Apple Pencil support to highlight and save your favourite passages for later</p>
<p>Education improvements</p>
<p>Introduces a preview of Shared iPad that enables multiple students to use the same iPad at different times throughout the day<br />
Adds support for signing into iCloud with Managed Apple IDs<br />
Adds compatibility for the new Classroom app<br />
New configuration options to control the organisation of apps on the Home Screen<br />
New controls to determine which apps to show or hide on the Home Screen<br />
Adds support for new restrictions for iCloud Photo Library and Apple Music</p>
<p>CarPlay improvements</p>
<p>Apple Music members now have access to their For You and New content in CarPlay<br />
New Nearby screen in Maps to quickly find petrol, Parking, Restaurants, Coffee and other driving essentials<br />
Siri speaks more concisely when reading back and composing messages in CarPlay<br />
Equalised sound levels between different audio sources in CarPlay<br />
Dolby Digital Plus<br />
Adds support for playing video encoded with Dolby Digital Plus audio streams with support for multichannel output using the Apple Lightning Digital AV Adapter</p>
<p>Hardware keyboard improvements and fixes</p>
<p>Enables the use of arrow keys to navigate through lists in Spotlight, Mail and Safari<br />
Enables the use of space bar to scroll in Mail<br />
Improves performance when using the space bar to scroll in Safari<br />
Adds the ability to bring up the software keyboard from the Shortcut Bar when a hardware keyboard is connected<br />
Fixes an issue that could prevent unlocking an iPad using the hardware keyboard<br />
Fixes an issue that caused hardware keyboards to become unresponsive in captive login pages<br />
Fixes an issue that could cause the Messages input field to disappear behind the Shortcut Bar when connected to a hardware keyboard</p>
<p>Other improvements</p>
<p>Maps adds support for getting a highlighted view of destinations and stops for a specific public transport line by tapping on it<br />
Maps now displays whether there are multiple public transport line options for each route suggestion<br />
Wallet app adds the ability to view the app related to a card or pass in the Wallet app by tapping an icon on the card or pass<br />
Apple Pay adds support for signing up for store rewards programs with Apple Pay at point of sale terminal<br />
Podcasts adds support for fullscreen video playback<br />
Activity app adds a new Workout tab with monthly summaries of key metrics and the ability to filter by workout type<br />
Move to iOS now offers app suggestions from the App Store based on apps installed on your Android device<br />
iCloud Storage adds proactive status information and in-app notifications to let you know before you run out of space<br />
Two-factor authentication is now available for all iCloud accounts<br />
Support for Spanish (Latin America) system language<br />
Siri support for Finnish (Finland), Hebrew (Israel) and Malay (Malaysia)<br />
Enterprise bug fixes<br />
Resolves an issue that could prevent some VPP purchased apps from launching after being updated<br />
Adds iCloud backup support for device-assigned VPP apps<br />
Addresses an issue that could prevent certificates from installing correctly when updating configuration profiles<br />
Fixes an issue for some IPSec VPN configurations that could cause the Internet connection to be interrupted after a VPN session was ended<br />
Fixes an issue to prevent iBooks from emailing enterprise managed PDFs from unmanaged accounts<br />
Resolves an issue for some Exchange users that caused Calendar to send multiple responses to the same invitation<br />
Improves reliability for devices connecting to OS X Caching Server</p>
<p>Accessibility bug fixes</p>
<p>Improves 3D Touch reliability with Switch Control Accessibility option<br />
Fixes an issue where VoiceOver interferes with speech after dictation<br />
Fixes an issue where VoiceOver users could not write a review on the App Store<br />
Resolves an issue where VoiceOver becomes unresponsive when receiving a phone call with a Bluetooth headset<br />
Fixes an issue where large text was unreadable in Reminders<br />
Other bug fixes, performance and stability improvements<br />
Fixes an issue where manually changing the date to May 1970 or earlier could prevent your iOS device from turning on after a restart<br />
Fixes issues that could prevent some iCloud Backups from completing<br />
Fixes an issue for some users where Health data was incomplete after restoring from iCloud Backup<br />
Fixes an issue where an inaccurate battery percentage could be displayed<br />
Addresses an issue that prevented iMessage or FaceTime activation for some users<br />
Addresses an issue that could prevent displaying the Phone interface while receiving a call<br />
Fixes an issue that enabled overriding restrictions applied to mobile data toggle<br />
Fixes an issue that caused notification settings to appear in the Watch app for apps that were not installed on Apple Watch<br />
Improves reliability when using 3D Touch on the keyboard<br />
Improves stability of the Phone app when setting up voicemail<br />
Improves stability of the Mail app when your device is low on storage<br />
Improves stability in Mail while using Mail Drop to send large attachments</p>
<p>Some features may not be available for all countries or all areas, for more information visit: <a href="http://www.apple.com/uk/ios/feature-availability" rel="nofollow ugc">http://www.apple.com/uk/ios/feature-availability</a> and <a href="http://www.apple.com/uk/ios/updates/" rel="nofollow ugc">http://www.apple.com/uk/ios/updates/</a></p>
<p>For information on the security content of this update, please visit this website:<br />
<a href="http://support.apple.com/kb/HT1222?viewlocale=en_GB" rel="nofollow ugc">http://support.apple.com/kb/HT1222?viewlocale=en_GB</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270106">

			<div class="comment by-victor ">

				<p class="commentcredit">

					<span class="commenter">Victor</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270106">
						March 21, 2016 3:30 PM					</a>

				</p>

				<p><a href="https://support.apple.com/en-us/HT206166" rel="nofollow ugc">https://support.apple.com/en-us/HT206166</a></p>
<p>Messages</p>
<p>Available for: iPhone 4s and later, iPod touch (5th generation) and later, iPad 2 and later</p>
<p>Impact: Visiting a maliciously crafted website may auto-fill text into other Message threads</p>
<p>Description: An issue existed in the parsing of SMS URLs. This issue was addressed through improved URL validation.</p>
<p>CVE-2016-1763 : CityTog</p>
<p>Messages</p>
<p>Available for: iPhone 4s and later, iPod touch (5th generation) and later, iPad 2 and later</p>
<p><b>Impact: An attacker who is able to bypass Apple&#8217;s certificate pinning, intercept TLS connections, inject messages, and record encrypted attachment-type messages may be able to read attachments</b></p>
<p>Description: A cryptographic issue was addressed by rejecting duplicate messages on the client.</p>
<p>CVE-2016-1788 : Christina Garman, Matthew Green, Gabriel Kaptchuk, Ian Miers, and Michael Rushanan of Johns Hopkins University</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270107">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270107">
						March 21, 2016 5:26 PM					</a>

				</p>

				<p>Matthew Green has a new blog post about this:</p>
<p>&#8220;Attack of the Week: Apple iMessage&#8221;<br />
<a href="http://blog.cryptographyengineering.com/2016/03/attack-of-week-apple-imessage.html" rel="nofollow ugc">http://blog.cryptographyengineering.com/2016/03/attack-of-week-apple-imessage.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270108">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270108">
						March 21, 2016 5:32 PM					</a>

				</p>

				<p><a href="https://isi.jhu.edu/~mgreen/imessage.pdf" rel="nofollow ugc">https://isi.jhu.edu/~mgreen/imessage.pdf</a></p>
<p>The paper on the flaw is a available here. A quick skim through, and I have to say the Washington Post description is just plain wrong. According to the paper, the attack exploits the use of GZIP compression, which has CRC32 checksums they can use as an oracle. On top of that, it exploits the fact that you can replace the signature with the signature of another sender whose account you control, and it will see the message as valid.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270109">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270109">
						March 21, 2016 6:17 PM					</a>

				</p>

				<p>FBI moves to postpone Apple court hearing tomorrow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270110">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270110">
						March 21, 2016 6:18 PM					</a>

				</p>

				<p>This attack would be impossible if it wasn&#8217;t for the fact that you can replace the signatures. Let this be a lesson: whenever you derive a key, the identity of the sender should be passed as part of the data included in the Key Derivation Function, so that if someone else tries to pass off ciphertext as their own, it will decrypt to gibberish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270111">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270111">
						March 21, 2016 7:19 PM					</a>

				</p>

				<p>@ Jacob</p>
<p>Or they could just spy on communications of all vulnerability researchers or disclosure sites/addresses. Free vulnerabilities. It&#8217;s what I&#8217;d do if I were them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270112">

			<div class="comment by-hugh ">

				<p class="commentcredit">

					<span class="commenter">Hugh</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270112">
						March 21, 2016 8:31 PM					</a>

				</p>

				<p>@Jacob</p>
<p>You won&#8217;t believe this. The FBI have vacated the trial.</p>
<p><a href="http://appleinsider.com/articles/16/03/21/fbi-requests-court-delay-iphone-encryption-motion-citing-new-unlock-method" rel="nofollow ugc">http://appleinsider.com/articles/16/03/21/fbi-requests-court-delay-iphone-encryption-motion-citing-new-unlock-method</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270113">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270113">
						March 21, 2016 8:38 PM					</a>

				</p>

				<p>@ Anura,</p>
<p>The real underlying problem was Apple using a stream cipher (AES-CTR) without a crypto MAC to prevent &#8220;bit flipping&#8221; attacks.</p>
<p>I&#8217;m guessing Apple incorrectly assumed that using the compression algorithm would do as a substitute.</p>
<p>Apple would have got away with this if it were not for a side channel of Apple&#8217;s own making, that could be used as an &#8220;oracle&#8221;.</p>
<p>The side channel is &#8220;out of band signaling&#8221; for attachments. For various reasons attachments to messages are not sent within the message system, only a URL and decryption key. The URL is not &#8220;locked&#8221; to Apples servers. This means that it is possible to give a URL that you control and use that as the &#8220;oracle&#8221;. If you flip a bit in the compressed message and the correct bits in it&#8217;s CRC then the phone does not see an error and goes and fetches the URL. If you get the CRC bits wrong then the phone sees an error and does not fetch the URL.</p>
<p>The compression CRC is a linear code which is why you can do this (there are papers that describe how to do it). If the compression function had used a crypto MAC instead then the attack would not have be able to use this known bit flip attack.</p>
<p>Asside from the non use of crypto MACs with stream ciphers, and out of band signaling as a side channel, it highlights the fact that what appears nonsensical as an attack&#8211;the resigning of an old valid message&#8211; can be used in combination with other issues as an attack.</p>
<p>With hindsight it&#8217;s easy to see where it went wrong, but I&#8217;ll be honest and say it would have probably got past me, even though I know about the other two &#8220;no no&#8217;s&#8221;. So Mat Green&#8217;s students deserve quite a bit of credit, for spotting it in the first place.</p>
<p>The other thing it highlights is the difference between general &#8220;engineering&#8221; and &#8220;security engineering&#8221;. From an engineering aproach Apple&#8217;s protocol was quite robust in terms of communications error detection, that is the chance of getting a false positive by chance was vanishingly small. But from a security engineering perspective a vanishingly small chance is &#8220;whole cloth&#8221; to work up into a nice little number&#8230;</p>
<p>Mat Green&#8217;s comments about not being able to get encryption right thus no chance on &#8220;backdoors&#8221; is a message that should be tattooed on peoples foreheads lest people don&#8217;t get the message.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270114">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270114">
						March 21, 2016 9:18 PM					</a>

				</p>

				<p>@ Clive, @ Anura</p>
<p><i>The real underlying problem was Apple using a stream cipher (AES-CTR) without a crypto MAC to prevent &#8220;bit flipping&#8221; attacks.</i></p>
<p>There is (or was) a similar problem with Telegram in that they are trying to do “Mac and Encrypt” instead of “Encrypt then Mac” with HMAC-SHA512. Interesting analysis by Crypto Fails <a href="http://www.cryptofails.com/post/70546720222/telegrams-cryptanalysis-contest" target="_blank" rel="noopener noreferrer nofollow ugc">here</a>.</p>
<p><i>Mat Green&#8217;s comments about not being able to get encryption right thus no chance on &#8220;backdoors&#8221; is a message that should be tattooed on peoples foreheads lest people don&#8217;t get the message.</i></p>
<p>I bet he and <a href="http://www.theguardian.com/politics/2012/feb/17/ken-livingstone-hang-bankers-speech" target="_blank" rel="noopener noreferrer nofollow ugc">Ken Livingstone</a> would make great drinking buddies.</p>
<p>@ Mike, @ Curious, @ CallMeLateForSupper, @ Jack Jones</p>
<p>Re. Telegram</p>
<p>Please <a href="http://www.theregister.co.uk/2015/11/23/homebrew_crypto_in_telegram_app/" target="_blank" rel="noopener noreferrer nofollow ugc">be very careful with Telegram</a>. Although not obviously broken, neither @thegrugq or Matthew Green think very highly of it. Green even compared their crypto to &#8220;being stabbed in the eye with a fork&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270115">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270115">
						March 21, 2016 9:30 PM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Apple assumed that since the message was signed, they didn&#8217;t need the MAC. It&#8217;s a reasonable assumption, but flawed in a not obvious way. It prevents forgery, but not other attacks. Simply doing what I suggested, including the sender as part of the data passed to the KDF (something that is provided for in NIST KDF specs, but not necessarily considered a must) would have stopped the attack. Others recommend sign-then-encrypt as it will cause a hard error that something is wrong, rather than just gibberish &#8211; I think that&#8217;s fair. ECDH using two static and one ephemeral key, with a MAC is my preference, as the key exchange results in implicit authentication. However, there are reasonable concerns about the security of ECDH, and due to recent precomputation attacks traditional diffie-hellman should probably be avoided as every user would need to use the same parameters to use it for authentication.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270116">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270116">
						March 21, 2016 10:09 PM					</a>

				</p>

				<p>That should say &#8220;implicit authorship verification&#8221; not &#8220;implicit authentication&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270117">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270117">
						March 22, 2016 1:30 AM					</a>

				</p>

				<p>Thinking about it, even signature + MAC you need to be careful. Generic scenario:</p>
<p>You are sending your paper to a teacher, you generate key material, encrypt the key material with your teacher&#8217;s RSA key, and from the keymat you derive an encryption key and MAC key. You encrypt the paper, append a mac, and then sign the whole shebang before emailing it to the teacher.</p>
<p>Another student has access to the mail server. They intercept your paper, strip your signature and append their own. The MAC is still valid, and everything looks good. The teacher gives the malicious student an A, while the innocent student gets an F for not turning in their paper.</p>
<p>No forgery is involved, but the problem is that it still wasn&#8217;t enough to verify authorship. This is a situation where sign then encrypt could have been used to avoid the problem, but that has the same problems as mac-then-encrypt in which an attacker can exploit the possible implementation flaws that occur since you need to decrypt the message before verifying the MAC/signature. Alternatively, you need to sign the message, append the signature, and then compute the MAC over the entire message with the signature. Using ECDH as mentioned above works as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270118">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info/' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270118">
						March 22, 2016 5:01 AM					</a>

				</p>

				<p>@Anura<br />
A session message should be tied to it&#8217;s session keys (encryption and MAC). If you tie it to a long term key that can be chopped up and replaced like Matt Green et. al. did to chopping up the encrypted message from the signature, you can claim them your own.</p>
<p>What a MAC does is to tie the message to the short term session symmetric key which only both side know whereas a long term asymmetric key allows you retrospective analysis opportunities. This is where MAC-ing with a symmetric short term session key comes in by ensuring only two parties know the secrets. You can&#8217;t simply chop up a session message and then invent some session key and MAC the data as that will be an obvious error.</p>
<p>Another thing to this that is not commonly noted is the thousands of erroneous tries they have to use. What if a tolerance limit to how many seemingly wrong messages that do not yield the correct authentication code is put in place before resetting the session and requiring a session negotiation all over again. This can open up to DOS-like attacks but it is better than allowing so many wrong messages to go through without being stopped. Sending the thousand over wrong messages by itself is already a form of DOS anyway so might as well force a session disconnection and forcing a renegotiation.</p>
<p>Adding some proof-of-work games like hashing message games into the protocol to make communication spamming more expensive to attackers would also make the protocol less likely of a low hanging fruit.</p>
<p>Traditional DH is still secure if you use a big enough key size (&gt;= 2048 bits) over an RFC standardized parameter set. If paranoid, just use 4096 bit keys since very rarely would anyone support anything bigger than 4096 bits on hardware and on software it&#8217;s even slower. Pre-computation over a secure key size is still not very feasible (although plausible). Another alternative of generating own primes is actually more problematic due to people getting it wrong by mistaking non-primes as primes for the code cutters that don&#8217;t know how to do it right (too many of them just don&#8217;t get it right :)).</p>
<p>ECC based curves are now in a state of limbo due to NSA dropping the bombshell on ECC crypto. It is not a killing blow to ECC but it&#8217;s enough to cause doubt. Is DJB&#8217;s Curve25519 and Ed25519 still safe ? No idea&#8230;.. no comments nor research into any impact from NSA&#8217;s bombshell on ECC implicating Curve25519 and Ed25519.</p>
<p>In fact, both traditional DH and ECC are bound to fail once a competent quantum computer emerge some long years (or may short years) later with ECC predicted to fall first.</p>
<p>I only offer RSA and DH for implementations I do (unless ECC is enforced by standards for a particular protocol or format) with &gt;= 2048 bits key sizes just to be on the safe side that NSA&#8217;s bombshell has any grain of truth which they attempt to hide routinely. Plus, implementing your own Curve25519 or Ed25519 on an embedded hardware (e.g. smartcard) with just 2KB RAM and 5KB EEPROM/Flash is a difficult attempt (probably even suicidal with so much side-channels for attack) whereas the hardware offered RSA and NIST ECC are usually covered with DPA/SPA protection mechanisms to a certain degree which can be leveraged.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270119">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info/' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270119">
						March 22, 2016 5:22 AM					</a>

				</p>

				<p>@Anura<br />
re: Student&#8217;s stolen paper<br />
This is a problem with asynchronous messaging where you don&#8217;t have a concept of session negotiation with shared secrets. Shared secrets between two parties makes it the case where no one learns the secret and thus cannot simply cut and paste what they like. This makes the message bind to the session.</p>
<p>I doubt there is any way to prevent such an attack unless it is bound by some sort of shared secret used to establish some form of two-way trust for that session.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270120">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270120">
						March 22, 2016 5:40 AM					</a>

				</p>

				<p>Isn&#8217;t iMessage using 1280 bit RSA keys? I understand  that there are probably other weaknesses in the system, but that always struck me as uninspiring given the wide range of governments that are probably trying to attack iMessages.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270121">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270121">
						March 22, 2016 5:45 AM					</a>

				</p>

				<p>@Thoth</p>
<p>Regarding ECC, I also tend to trust RSA more in light of those revelations, but I still happily use Curve25519 in my own code because Libsodium makes it easy to implement and hard to shoot yourself in the foot. I take the view that an implementation error on my part is far more likely than a break of Curve25519, so I&#8217;d rather go with a library that minimizes that risk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270122">

			<div class="comment by-vesselin-bontchev ">

				<p class="commentcredit">

					<span class="commenter">Vesselin Bontchev</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270122">
						March 22, 2016 6:07 AM					</a>

				</p>

				<p>The &#8220;hole&#8221; in the iMessage encryption is the usage of non-authenticated encryption (i.e., no MAC). This allows for message malleability &#8211; the attacker can change a single bit in the message, re-sign it, and check whether it can be decrypted by the recipient. In order for the attack to be practical, the attacker needs to be able to re-sign the message (i.e., prevent the recipient from receiving the original message). This doesn&#8217;t work on the modern versions of iOS (even before the patch), because they use certificate pinning. Second, the attacker has to be able to determine if the recipient is able to decrypt the modified message. This is why the attack works only against messages that contain photos or videos (they aren&#8217;t in the message; instead the recipient gets an URL for accessing them after decrypting the messages; by monitoring this URL the attacker can determine if the message was decrypted successfully). Even then, the attacker has to be able to isolate the victim from Apple&#8217;s servers. Doable for a nation-state and for Apple (if served a National Security Letter), but not for a random hacker. Still, it&#8217;s good that Apple has figured out a workaround. In the long run, iMessage ought to be replaced by a better crypto protocol.</p>
<p>The AceDeceiver thing is pretty serious, too. The actual malware is crap and doesn&#8217;t pose significant threat (if you aren&#8217;t trying to pirate apps in China) but the method it uses is quite dangerous and can be exploited much more efficiently in the future. Basically, if your PC is infected with malware using this attack, when you pair your iPhone with it, the PC can start pushing malware to your iPhone without your notice or consent. The only requirement is that the malware has been at some point of time in the AppStore. It doesn&#8217;t have to be still there at the time of the attack &#8211; i.e., removing it from there doesn&#8217;t stop the attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270123">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270123">
						March 22, 2016 6:47 AM					</a>

				</p>

				<p>@z<br />
I lean more to discrete log (RSA and DH) since they are easier to understand thus easier to verify than ECC. There are so many curve variants and who knows what they might contain (backdoors). DJB wrote about Safecurves which he identified many &#8220;unsafe&#8221; curves deployed and approved by NIST !!! With so many different curves ot takes time to validate them as secure from anything sneaky and also secure and correctness of implementation. We can even get discrete log crypto right (mistaking non-primes as primes), moving to more complex crypto schemes like ECC is going to yield more problems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-270124">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270124">
						March 22, 2016 11:32 AM					</a>

				</p>

				<p>@Thoth</p>
<p>iMessage is an offline system, and doesn&#8217;t have a session key. Each message is encrypted independently, and without two-way key negotiation. If it did, the attack would be thwarted by key confirmation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-270125">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> •

					<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/#comment-270125">
						March 28, 2016 12:34 PM					</a>

				</p>

				<p>@Thoth, who wrote:</p>
<p>&#8220;I lean more to discrete log (RSA and DH) since they are easier to understand thus easier to verify than ECC.&#8221;</p>
<p>I think there is a problem of classification here.  As far as I know, ECC schemes are based on the elliptic curve version of the discrete log problem (DLP).</p>
<p>Perhaps you meant &#8220;integer multiplication&#8221; rather than &#8220;discrete log&#8221; as the category including RSA and (non-EC) DH.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2016/03/imessage_encryp.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2016/03/imessage_encryp.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F03%2Fimessage_encryp.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2016/03/imessage_encryp.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='9309' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2016/03/brennan_center_3.html" rel="prev">← Brennan Center Report on NSA Overseas Spying and Executive Order 12333</a>		<a href="https://www.schneier.com/blog/archives/2016/03/observations_on.html" rel="next">Observations on the Surveillance that Resulted in the Capture of Salah Abdeslam →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
