<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Hijacking the PC Update Process - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Hijacking the PC Update Process Comments Feed" href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/10513" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=10513' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F06%2Fhijacking_the_p.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F06%2Fhijacking_the_p.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-10513 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-10513" class="post-10513 post type-post status-publish format-standard hentry category-uncategorized tag-exploits tag-hacking tag-malware tag-patching tag-windows">

	<div class="article">

		<h2 class="entry">Hijacking the PC Update Process</h2>
		<p>There&#8217;s a <a href="https://duo.com/blog/out-of-box-exploitation-a-security-analysis-of-oem-updaters">new</a> <a href="https://duo.com/assets/pdf/out-of-box-exploitation_oem-updaters.pdf">report</a> on security vulnerabilities in the PC initialization/update process, allowing someone to hijack it to install malware:</p>
<blockquote><p>One of the major things we found was the presence of third-party update tools. Every OEM we looked at included one (or more) with their default configuration. We also noticed that Microsoft Signature Edition systems also often included OEM update tools, potentially making their distribution larger than other OEM software.</p>
<p>Updaters are an obvious target for a network attacker, this is a no-brainer. There have been plenty of attacks published against updaters and package management tools in the past, so we can expect OEM&#8217;s to learn from this, right?</p>
<p>Spoiler: we broke all of them (some worse than others). Every single vendor had at least one vulnerability that could allow for a man-in-the-middle (MITM) attacker to execute arbitrary code as SYSTEM. We&#8217;d like to pat ourselves on the back for all the great bugs we found, but the reality is, it&#8217;s far too easy.</p></blockquote>
<p>News <a href="https://www.wired.com/2016/05/2036876/">article</a>. </p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/exploits/" rel="tag">exploits</a>, <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/patching/" rel="tag">patching</a>, <a href="https://www.schneier.com/tag/windows/" rel="tag">Windows</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html" rel="bookmark">Posted on June 6, 2016 at 6:10 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html#comments">51 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html" data-title="Hijacking the PC Update Process" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-275661">

			<div class="comment by-kai-howells ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://automatica.com.au' rel='external nofollow ugc' class='url'>Kai Howells</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275661">
						June 6, 2016 6:44 AM					</a>

				</p>

				<p>I fail to understand what OEMs actually hope to achieve by installing all their crapware on new machines. I don&#8217;t know one single person who uses any of it, and no-one actually likes having it there.</p>
<p>You can&#8217;t add crap like this to Windows and expect it to run better &#8211; so what purpose does it serve?</p>
<p>Surely the OEMs expend non-trivial amounts of resources in developing this software &#8211; why do they continue to do so?</p>
<p>Nothing will run as well straight out of the box as a machine with a fresh install of Windows and nothing else.</p>
<p>I can understand that there are bundling deals with 3rd party software vendors and OEMs, that&#8217;s why we get things like Evernote, CD burning software, Outlook plugins, trial versions of Office and crappy AV software &#8211; but this doesn&#8217;t explain why the OEMs feel like they have to put their own software in the mix as well.</p>
<p>With all the marketing that Microsoft is putting behind Signature Edition (basically a clean install of Windows with minimal other 3rd party crapware) &#8211; why doesn&#8217;t any OEM realise the value in this and go one step further &#8211; just install Windows and nothing else?</p>
<p><a href="http://www.microsoftstore.com/store/msusa/en_US/cat/Signature-Edition-Computers/categoryID.69916600" rel="nofollow ugc">http://www.microsoftstore.com/store/msusa/en_US/cat/Signature-Edition-Computers/categoryID.69916600</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275662">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275662">
						June 6, 2016 6:55 AM					</a>

				</p>

				<p>@ Kai Howells</p>
<p>Monye$? The might simply get paid for installing crap, kind of subsidy for the price, huh?</p>
<p>Your perspective is totally WRONG, the customer is just the idiot to pay the money for the crap he buys. Nobody cares for your &#8220;product experience&#8221; or related marketing bullshit bingo. Proof: Try to get adequate service for your &#8220;high-level&#8221; products, and you are out alone in the dessert&#8230;</p>
<p>Capitalism is not there to make customers happy. But the shareholders.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275663">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">steve</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275663">
						June 6, 2016 7:41 AM					</a>

				</p>

				<p>Isn&#8217;t this one of the ways FinFisher attacks the OS? By their FinFisher ISP appliance product? It intercepts MS updates at the ISP and deploys itself on your PC from there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275664">

			<div class="comment by-mike-gerwitz ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://mikegerwitz.com' rel='external nofollow ugc' class='url'>Mike Gerwitz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275664">
						June 6, 2016 8:03 AM					</a>

				</p>

				<blockquote><p>There&#8217;s a new report on security vulnerabilities in the PC initialization/update process</p></blockquote>
<p>There is no one process for &#8220;the PC&#8221;; would you mind changing that to &#8220;the Windows&#8221;?</p>
<p>For example, on many GNU/Linux distributions, this report would be a non-issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275665">

			<div class="comment by-cormacolinde ">

				<p class="commentcredit">

					<span class="commenter">Cormacolinde</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275665">
						June 6, 2016 8:27 AM					</a>

				</p>

				<p>@ Kai Howells</p>
<p>This isn&#8217;t about the usual crapware, though. We&#8217;re talking about the self-update software. About the only OEM software you&#8217;d want to leave on a system to easily allow users to update drivers and various software in order to protect them from other vulnerabilities that will often crop up in those.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275666">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275666">
						June 6, 2016 8:34 AM					</a>

				</p>

				<p>@ Mark Gerwitz</p>
<p>Same thing irritated me in the beginning. But count together 1+1 (IBM + Microshyte) and your&#8217; done!</p>
<p>Btw, nearly no consumer hardware to buy with Linux out-of-the-box, anyways&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275667">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275667">
						June 6, 2016 8:54 AM					</a>

				</p>

				<p>How long until Win 10 is officially marked as &#8220;MALWARE&#8221;?</p>
<p><a href="https://www.change.org/p/the-electonic-frontier-foundation-have-the-eff-investigate-microsoft-for-malicious-practices-regarding-windows-10" rel="nofollow ugc">https://www.change.org/p/the-electonic-frontier-foundation-have-the-eff-investigate-microsoft-for-malicious-practices-regarding-windows-10</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275668">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275668">
						June 6, 2016 8:57 AM					</a>

				</p>

				<p>@steve</p>
<p>I&#8217;d like to assume that Windows updates are signed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275669">

			<div class="comment by-jeff-martin ">

				<p class="commentcredit">

					<span class="commenter">Jeff Martin</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275669">
						June 6, 2016 9:49 AM					</a>

				</p>

				<p>How long until updating is more dangerous than not updating?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275670">

			<div class="comment by-anonymous-cow ">

				<p class="commentcredit">

					<span class="commenter">Anonymous Cow</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275670">
						June 6, 2016 10:38 AM					</a>

				</p>

				<p>I just scanned the Duo paper Bruce linked to. The coverage on mitigation strategies is generic and high level.</p>
<p>Does anyone have concrete mitigation procedures for popular PC brands, especially ones that don&#8217;t involve wiping the system and installing a &#8220;clean&#8221; copy of the Windows?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275671">

			<div class="comment by-de-la-boetie ">

				<p class="commentcredit">

					<span class="commenter">de La Boetie</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275671">
						June 6, 2016 10:46 AM					</a>

				</p>

				<p>@Anonymous Cow &#8211; very sorry, but the only mitigating MO is to re-install from new, as clean a fresh copy of Windows as MS will let you, then install necessary drivers as needed.  A Royal PITA, especially with update times, but necessary.</p>
<p>I don&#8217;t feel there&#8217;s an alternative, all the other controls you add afterwards are worthless unless you have a more solid base.  And for laptops, it&#8217;s an opportunity to pop in a larger SSD than you&#8217;d otherwise be get, given the fabulous margins they put on them.</p>
<p>If you&#8217;re corporate, this will naturally be rather more industrialised and slick.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275672">

			<div class="comment by-k15 ">

				<p class="commentcredit">

					<span class="commenter">K15</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275672">
						June 6, 2016 11:46 AM					</a>

				</p>

				<p>Bruce, how about a standing post on the sidebar or someplace, about the government internet security org whose presence and activity would have averted this?<br />
What are the utilities now, and how do we keep them reliable?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275673">

			<div class="comment by-mrc ">

				<p class="commentcredit">

					<span class="commenter">MrC</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275673">
						June 6, 2016 12:08 PM					</a>

				</p>

				<p>@ Anonymous Cow:</p>
<ol>
<li>
<p>First and best option is to reformat the drive and replace Windows with Linux (or, better yet, something like Genode when it&#8217;s ready for prime time).</p>
</li>
<li>
<p>Second-best option is to reformat the drive and do a clean install of non-OEM Windows.</p>
</li>
<li>
<p>Third-best option is to identify and manually uninstall all of the OEM crapware before connecting the computer to the internet for the first time.</p>
</li>
<li>
<p>Fourth-best option is to identify all of the OEM crapware, figure out which registry entry, etc., is causing it to run on start-up, and manually disable its ability to run on start-up before connecting the computer to the internet for the first time. Then remember to never update manually. (Though, if you&#8217;re going to do all this, I don&#8217;t see any reason not to just uninstall the crapware instead.)</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275674">

			<div class="comment by-albert ">

				<p class="commentcredit">

					<span class="commenter">albert</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275674">
						June 6, 2016 1:53 PM					</a>

				</p>

				<p>If you&#8217;re forced to use Windows at work, then rule number one is &#8216;don&#8217;t do ANY personal stuff&#8217; on that computer, EVER&#8217;.  Now, -you- are relatively safe (HR drones notwithstanding). I don&#8217;t understand why folks use Windows for their -personal- business.<br />
. .. . .. &#8212; &#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275675">

			<div class="comment by-richard ">

				<p class="commentcredit">

					<span class="commenter">Richard</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275675">
						June 6, 2016 2:12 PM					</a>

				</p>

				<p>@ Mike Gerwitz</p>
<p><b>There is no one process for &#8220;the PC&#8221;; would you mind changing that to &#8220;the Windows&#8221;?</b></p>
<p><b>For example, on many GNU/Linux distributions, this report would be a non-issue.</b></p>
<p>You&#8217;re so right Mike ! &#8211; Linux is soooo much better&#8230;</p>
<p>For example with Linux Mint, you don&#8217;t even have to wait for an &#8216;update&#8217; to get your malware; you can download a backdoor&#8217;d O.S. right from the source!</p>
<p><a href="http://arstechnica.com/security/2016/02/linux-mint-hit-by-malware-infection-on-its-website-and-forum-after-hack-attack/" rel="nofollow ugc">linux-mint-hit-by-malware-infection-on-its-website</a></p>
<p>Of course the Linux fanboyz will say that this was just a one-off freak occurrence.</p>
<p>Uh huh, NOW, all you have to do is verify your <a href="https://www.linuxmint.com/download.php" rel="nofollow ugc">Linux Mint</a> download ISO against its &#8220;MD5&#8221;.</p>
<p>The only problem is &#8211; MD5 as a signature mechanism is TOTALLY BROKEN AND COMPLETELY INSECURE.</p>
<p>With even the very modest computational power of a single desktop PC, it is trivial to generate a &#8220;good&#8221; file for validation purposes, and a &#8220;malware&#8221; file for distribution &#8211; BOTH OF WHICH HAVE IDENTICAL MD5 HASH SIGNATURES.</p>
<p>So even after their recent disgraceful security screw-up &#8211; THEY ARE STILL CLUELESS ABOUT SECURITY.</p>
<p>In my experence, Ubuntu, Debian, Arch and others are only a little better security wise, and ALL have had remarkably stupid security screw-ups &#8211; in part because the whole POSIX &#8220;C&#8221; language based development model STINKS and leaves a LOT of vulnerabilities &#8211; and partially because Linux twits are so stupidly arrogant about security.</p>
<p>Trust me on this &#8211; &#8216;open source&#8217; projects are amongst the EASIEST to hack.</p>
<p>Easiest because it&#8217;s ridiculously easy to hide malicious code written in a cryptic language like &#8216;C&#8217; in a bloated O.S. which has millions of lines of poorly documented code, managed by arrogant twits who think their O.S. is soooooo wonderful that it MUST  be absolutely secure &#8211; and who cling to this belief as a matter of religious faith, despite obvious facts to the contrary<br />
.</p>
<p>I say these things as someone who uses Linux on a daily basis, but who no longer harbors any illusions about its so-called &#8216;security&#8217;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275676">

			<div class="comment by-ray-dillinger ">

				<p class="commentcredit">

					<span class="commenter">Ray Dillinger</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275676">
						June 6, 2016 2:34 PM					</a>

				</p>

				<p>Wow.</p>
<p>I honestly had no idea.  For the last ump years, every time I&#8217;ve gotten a new computer I&#8217;ve been installing a new hard drive in it before starting it up for the first time.  (Step Zero: replace the drive.  Step One: Install an operating system &#8230; ).  I have vague memories of a few little pieces of extraneous crapware packaged by OEMs, but I hadn&#8217;t thought about them in years.</p>
<p>This is just a simple cost-saving thing, really; a supposedly lower-end machine built on a good motherboard, plus hard drive and RAM upgrade, is usually indistinguishable from a high-end machine that would come at a greater total expense.</p>
<p>The drives that I take out are usually good enough to stick into external enclosures for use as removable media.  The first thing I do with removable media though, is format it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275677">

			<div class="comment by-huffed-glue-till-my-eyes-turned-blue ">

				<p class="commentcredit">

					<span class="commenter">huffed glue till my eyes turned blue</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275677">
						June 6, 2016 4:13 PM					</a>

				</p>

				<p>@ keiner</p>
<p><i>&#8220;How long until Win 10 is officially marked as &#8220;MALWARE&#8221;?&#8221;</i></p>
<p>&#8220;People are aware that Windows has bad security but they are underestimating the problem because they are thinking about third parties. What about security against Microsoft? Every non-free program is a &#8216;just trust me program&#8217;. &#8216;Trust me, we&#8217;re a big corporation. Big corporations would never mistreat anybody, would we?&#8217; Of course they would! They do all the time, that&#8217;s what they are known for. So basically you mustn&#8217;t trust a non free programme.&#8221;</p>
<p>[Apple and Microsoft] &#8220;Those companies are very powerful. They are cleverly finding new ways to take control over users. Nowadays people who use proprietary software [programs whose source code is hidden, and which are licensed under exclusive legal right of the copyright holder] are almost certainly using malware. The most widely used non-free programmes have malicious features &#8211; and I&#8217;m talking about specific, known malicious features.&#8221;</p>
<p>[malicious features] &#8220;There are three kinds: those that spy on the user, those that restrict the user, and back doors. Windows has all three. Microsoft can install software changes without asking permission.&#8221;</p>
<ul>
<li>Richard Stallman, a few quotes from an interview:</li>
</ul>
<p><a href="http://www.newint.org/features/web-exclusive/2012/12/05/richard-stallman-interview/" rel="nofollow ugc">http://www.newint.org/features/web-exclusive/2012/12/05/richard-stallman-interview/</a><br />
<a href="https://web.archive.org/web/*/http://www.newint.org/features/web-exclusive/2012/12/05/richard-stallman-interview/" rel="nofollow ugc">https://web.archive.org/web/*/http://www.newint.org/features/web-exclusive/2012/12/05/richard-stallman-interview/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275678">

			<div class="comment by-erik ">

				<p class="commentcredit">

					<span class="commenter">Erik</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275678">
						June 6, 2016 4:23 PM					</a>

				</p>

				<p>Fortunately, nearly all of this software registers itself through Microsoft&#8217;s software installation processes &#8211; which means it&#8217;s fairly easy to get rid of via scripting. We have a script that runs on all machines regularly that gets rid of all of the crapware. We simply update it as necessary. It&#8217;s a few hundred lines that look like this:</p>
<p>start /WAIT &#8220;Uninstall Evil Bing Bar&#8221;                         msiexec /x {77F8A71E-3515-4832-B8B2-2F1EDBD2E0F1} /quiet<br />
start /WAIT &#8220;Uninstall Trend Micro Client /Server Sec Agent&#8221;  msiexec /x {BED0B8A2-2986-49F8-90D6-FA008D37A3D2} /quiet</p>
<p>etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275679">

			<div class="comment by-yoshi ">

				<p class="commentcredit">

					<span class="commenter">Yoshi</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275679">
						June 6, 2016 5:51 PM					</a>

				</p>

				<p>This reminds me of how most BIOS/firmware updates that I run into are NOT checksummed and are also delivered in the same non-secure ways.</p>
<p>To me the BIOS/firmware is probably the most important part of the system, and yet it&#8217;s given the least amount of care by some tech supporters/manufacturers.</p>
<p>It really makes me kind of sad and mad at the same time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275680">

			<div class="comment by-jdgalt ">

				<p class="commentcredit">

					<span class="commenter">jdgalt</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275680">
						June 6, 2016 7:05 PM					</a>

				</p>

				<p>In other articles linked from this blog, it is made clear that operating systems behaving as malware are just the tip of the iceberg.  We have BIOSes that can be updated remotely, disk drives that can be addressed over the Internet, and probably back doors in CPUs themselves.</p>
<p>Clearly the community needs a whole array of secure technologies that don&#8217;t yet exist (or have existed in the past but were abandoned).  We need to generate enough demand that the market produces all of them &#8212; and do enough checking up that they can&#8217;t lie to us and get away with it.  The job of building good security really hasn&#8217;t even begun yet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275681">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275681">
						June 6, 2016 9:50 PM					</a>

				</p>

				<p>@ Yoshi,</p>
<blockquote><p>To me the BIOS/firmware is probably the most important part of the system, and yet it&#8217;s given the least amount of care by some tech supporters/manufacturers.</p></blockquote>
<p>It&#8217;s not just the main BIOS/firmware to consider, there is a whole load of other &#8220;hidden&#8221; computers in I/O devices as well including the keyboard. Most of these can be messed with these days. Oh and don&#8217;t forget the &#8220;Smart batteries&#8221; like those found in Apple portable equipment.</p>
<p>But it also goes lower than this, there are CPU &#8220;microcode upgrades&#8221; to consider as well&#8230;</p>
<p>@ All,</p>
<p>The base assumption to work from these days is that you do not in any way own your computer, those days went at the turn of the century. Likewise your router etc.</p>
<p>Thus you have to consider how you are going to behave at the physical OpSec level.</p>
<p>Complaining and moaning about OS XXX is a little bit like arguing the shape of the hole below the waterline in the side of your boat is important when you are sinking.</p>
<p>As with the boat you need to &#8220;beach it&#8221; and make sure it&#8217;s &#8220;ship shape&#8221; from the lowest levels up. Only you can&#8217;t&#8230;</p>
<p>Due to the way every body gave a pass to &#8220;bells and whistles tommorow marketing&#8221; instead of insisting on &#8220;security today engineering&#8221;, and likewise with the hardware we have grown the computer industry of our current nightmares one purchase at a time for the last thirty or so years. And it is to late to scurry off backwards to do anything about it, you can now nolonger wind that clock back.</p>
<p>That is the reality of it so accept it and make your plans based on the fact you don&#8217;t own your computers at any level the majority of people can understand let alone control.</p>
<p>For instance it is known that the PC architecture has had a security flaw in the original design which is certainly still there today in Win 10 operation. It was put in for good reason so that &#8220;added hardware&#8221; via interface cards could add software to the computer so they could work. This feature was a &#8220;direct steal&#8221; from the Apple ][ design that preceded the PC by a long way, and was the most popular computer of it&#8217;s time back at the 1970s and early 80&#8217;s.</p>
<p>It was only a short while ago that a Chinese laptop manufacturer got &#8220;rapped over the knuckles&#8221; for using this mechanism for hiding advertising type malware in the BIOS image, thus this backdoor into your PC is well known about. So even taking out the harddrive and installing a new OS was not going to stop the malware getting up into the freshly installed MS Win OS.</p>
<p>Thus as has been described on this blog before, you have to develop an entirely different strategy. So you have to ask how do use PCs to get your required degree of privacy and security&#8230;</p>
<p>In essence you need an &#8220;off line PC&#8221; and an &#8220;On line PC&#8221; and a way to securely transmit data between the two PC&#8217;s in a mediated way, to have any chance of a little privacy.</p>
<p>However as always with ICTsec and OpSec in general &#8220;the devil is in the details&#8221;&#8230; And if your particular demon has state level resources and a picture of your face on their wall with &#8220;cross hairs&#8221; then you have a harder problem on your hands. Which means you have to take your security further than just the &#8220;Off line PC&#8221;. It needs to go back before the PC and through your eyes head and hands (see previous posts about securely athenticating transactions).</p>
<p>However for the majority a little change in behaviour will get them a lot of privacy and some security. Firstly remember everything you type, every picture you post, and nowadays every word you utter close to your computers microphone will be whisked away to the likes of Google then onwards to some US Government agency etc etc. George Orwell might have expressed it in a more dystopian way, but he was not wrong about the technology, or the politics, when he wrote 1984 back in 1948.</p>
<p>So treat your computer not as a confident but as a potential mugger on the street, would be step one.</p>
<p>Thus for most of you &#8220;give up both the faux and real convenience the PC may give you if you need &#8220;security&#8221;, or if you must use the PC and only want some measure of privacy and a little security then practice sensible OpSec and don&#8217;t bleed every drop of your private and financial life through it&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275682">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275682">
						June 6, 2016 11:41 PM					</a>

				</p>

				<p>@ Yoshi, All,</p>
<p>I forgot to add a link to the three blatent &#8220;crapware / snoopware / malware&#8221; offences of Lenovo in 2015</p>
<p><a href="http://www.computerworld.com/article/2984889/windows-pcs/lenovo-collects-usage-data-on-thinkpad-thinkcentre-and-thinkstation-pcs.html" rel="nofollow ugc">http://www.computerworld.com/article/2984889/windows-pcs/lenovo-collects-usage-data-on-thinkpad-thinkcentre-and-thinkstation-pcs.html</a></p>
<p>Of the three offences,</p>
<p>1, Superfish adware.<br />
2, Service Engine Software.<br />
3, Lenovo Customer Feedback program</p>
<p>It&#8217;s number two you need to have a think about, because it was effectively &#8220;put in thr BIOS&#8221; so you could not remove it&#8230;</p>
<p>Whilst the Lenovo Customer Feedback Program 64, is &#8220;spyware&#8221;, it&#8217;s on their &#8220;proffesional / Business&#8221; line of machines (thinkpad etc) not the consumer ranges that the first two were on. This of course has legal implications for businesses in all sorts of ways, and it shows that Lenovo realy do not think or act appropriately. Something Microsoft should heed with their Win10 &#8220;spyware&#8221; and &#8220;crapware&#8221; forced updating in Win7 and beyond, which has caused some people to unknowingly incure huge data charges when MS downloaded Win10 in the background without the users express or for that matter implied permission.</p>
<p>Whilst it is possible to own something you can not control due to your own limitations, having something you can not control unless you have well above normal almost &#8220;super human&#8221; abilities means in effect not only do you not own it, but others do not care about their &#8220;duty of care&#8221; when they force such &#8220;rent seeking&#8221; malware down your throat.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275683">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275683">
						June 6, 2016 11:44 PM					</a>

				</p>

				<p>Clive Robinson<br />
&#8211;Yeah, for targeted attacks maybe but I think that&#8217;s still a bit overblown.  There&#8217;s no way in hell they can store all this data (unless there&#8217;s some ultra-compression algorithm) and do something useful w/ it, more likely it&#8217;s all simply a massive waste of power and humans analyzing crap data providing a lot of useless reports.</p>
<p>If this were true, why aren&#8217;t all the embedded chips all around us failing nonstop?  Internet goes down?  Our world would simply crumble if this level of hacking was actually feasible b/c we all know some people would do it if they could.</p>
<p>I agree w/ the gist of your sentiments, just the reality of making use of all that data.  I don&#8217;t believe it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275684">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275684">
						June 7, 2016 12:27 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<blockquote><p>I agree w/ the gist of your sentiments, just the reality of making use of all that data. I don&#8217;t believe it.</p></blockquote>
<p>Like all bubbles &#8220;Big Data&#8221; has kind of had it&#8217;s day from the commercial perspective, though the IC want their &#8220;time machine&#8221; so will not give up on storing it (on the &#8220;just in case&#8221; principle that costs more than any king&#8217;s ransom ever did).</p>
<p>The whole &#8220;Big Data&#8221; idea hung on two assumptions. The first that there was data that could be sensibly &#8220;commoditized&#8221;. The second was that the &#8220;numerati&#8221; could come up with algorithms to do the commoditization. Of the two the second has nowhere near been achived in a &#8220;cost effective&#8221; way, and the first looks fairly shaky due to &#8220;data polution&#8221; both accidental and deliberate as people try to stop themselves being commoditized.</p>
<p>But even where worthwhile information has been obtained, it appears that it&#8217;s value due to other constraints is worth far less than was originaly expounded. Interestingly that and the &#8220;ham fisted&#8221; sociopathic behaviour of the FBI/DOJ with regards Apple, has made a number of businessmen think (funny how potential ruin and jail time focuses some of the smarter peoples minds). They have suddenly realised that &#8220;the little extra&#8221; income they were getting from the &#8220;collect it all&#8221; policy on user data is not worth the risk attached with the likes of the FBI/DOJ or bad public oppinion sending customers to competitors in &#8220;safer&#8221; countries. Thus some are stopping the collect it all as the risk is now seen as to high.</p>
<p>However that said, it will not be long before they find ways to &#8220;externalise the risk&#8221;. One way of which is to use a third party data collector within their software that sends the data in an encrypted form they never see to a data aggregator. The aggregator then pays them a few cents but takes on the risk of the FBI/DOJ as part of that. Which raises the question again of is there sufficient money to be made in the aggregation of data to keep the likes of the FBI/DOJ at bay (Microsoft are fighting this one at the moment so watch for a judgment).</p>
<p>Like you my thinking is that there is not enough money in it and the bubble will either pop or deflate as the pendulum swings back the other way (think on it as kind of the &#8220;ringing&#8221; on a fast rising edge, that will eventually settle at some mean level hopefully at near zero).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275685">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275685">
						June 7, 2016 2:10 AM					</a>

				</p>

				<p>@Yoshi</p>
<p>Yesterday I wanted to update a brand new Gigabyte board to the latest BIOS and found:</p>
<ul>
<li>download via http</li>
<li>no checksums on site or anywhere to be determined from the homepage with reasonable effort.</li>
</ul>
<p>But it&#8217;s an UEFI Bios update. So what could go wrong here?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275686">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275686">
						June 7, 2016 4:39 AM					</a>

				</p>

				<p>@Clive<br />
&#8220;In essence you need an &#8220;off line PC&#8221; and an &#8220;On line PC&#8221; and a way to securely transmit data between the two PC&#8217;s in a mediated way, to have any chance of a little privacy.&#8221;</p>
<p>All true, but more than a little disheartening. Where to start to solve these security challenges?</p>
<p>What would be a good model for investigating this?</p>
<p>You do not trust the hardware of either PC, and your solution seems to rely on isolating the off-line PC from all communication channels (including direct power access) and then carefully control all communication between the PCs. I was wondering whether such an approach could be used between the hidden computer components inside a PC?</p>
<p>Maybe some things could in future be done with homomorphic encryption?<br />
<a href="https://en.wikipedia.org/wiki/Homomorphic_encryption" rel="nofollow ugc">https://en.wikipedia.org/wiki/Homomorphic_encryption</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275687">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275687">
						June 7, 2016 5:03 AM					</a>

				</p>

				<p>@ Winter,</p>
<blockquote><p>I was wondering whether such an approach could be used between the hidden computer components inside a PC?</p></blockquote>
<p>Probably not.</p>
<p>We used to call it &#8220;air gapping&#8221; but more strictly it needs to be called &#8220;energy gapping&#8221;. As energy in one form or another will travel through just about any medium you can think of, one of the best defences is distance, because signals tend to fall off or antenuate between the square and qube of distance.</p>
<p>Whilst shielding does work, you have to know what it is you are shielding against. For instance you decide it&#8217;s EM radiation, so you put things in a nicely made metal box with internal metal partitions that are nicely welded / braised and silver plated. It does not work if in fact you have magneto constriction in one coil causing mechanical vibraton that gets coupled into the box that then gets mechanicaly coupled to another coil that picks it up via the process of microphonics&#8230; Infact the more solid the metal construction the more likely it is to happen.</p>
<p>Similar arguments go for ventilation slits/holes and acoustic energy.</p>
<p>There is a lot you have to know when doing security engineering that most engineers don&#8217;t get to think about normaly. Our host Bruce calls it &#8220;thinking hinky&#8221;, whist that does come into it you need to understand what to &#8220;think hinky about&#8221;. To do this you need a very good grounding in &#8220;test and measurment techniques&#8221; as well as a deep understanding of what a transducer is and why.</p>
<p>But a good rule to remember is &#8220;distance&#8221; be it real or synthetic is usually good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275688">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275688">
						June 7, 2016 8:01 AM					</a>

				</p>

				<p>@ Yoshi, Clive Robinson</p>
<p>Yoshi has a valid point here, firmware updates must be signed or at least have secure hashes available.  Not only BIOS or UEFI updates, all other firmware classes should be authenticated and provide secure downloading methods (AMT, ECP, HDD/SSD, LAN, WLAN, WWAN, USB controllers, video, processor microcode, battery, diagnostics, optical drives&#8230;).</p>
<p>At least we should have valid strong hashes and the ability to download the firmware images from an HTTPS server; in a perfect world all these blobs should be signed so they can be easily verified by the computer during the upgrade process.</p>
<p>UEFI firmware is usually signed, as it is the ECP, processor microcode or video firmware when it is part of the same bundle, but in most cases firmware cannot be automatically verified.  Even in this case secure download channels and hashes should be provided.  I download firmware by HTTPS and verify its hash if it is possible, even if just to discard a transfer problem, before applying an update even if firmware is signed.</p>
<p>Hopefully NIST has some good advice that has been followed by most manufacturers on the last years:</p>
<p><a href="http://dx.doi.org/10.6028/NIST.SP.800-147" rel="nofollow ugc">http://dx.doi.org/10.6028/NIST.SP.800-147</a></p>
<p>But, as said, this one is a recent set of recommendations.  Even some printers (like the HP LaserJet P3005) have signed firmware updates now.  With regard to signed firmware updates this printer is a valuable example, as its first firmware versions were not signed but they added this feature later.  I would invite any serious hardware manufacturer to re-release its most recent firmware with a signature verification algorithm on it if not supported yet, so it makes more challenging an unauthorized modification of its code.</p>
<p>By the way, recently I worked with a few cheap i3 computers (Acer?) that had flash BIOS and ME write protection switches on the motherboard.  But it is unusual these days.</p>
<p>Another problem is our confidence on these binary blobs.  Can we trust UEFI, AMT, our processors microcode or other firmware?  I try running my computers firewalled, using a strict egress filtering policy if possible, to minimize the impact of a backdoored firmware, but I cannot be sure it is enough.  On the other hand if something odd happens with our firmwares it should be known to security researchers, right?</p>
<p>With regard to Lenovo I understand why they add bloatware to their low-end computers.  Each bloatware manufacturer pays Lenovo to add its software, so these computers can be relatively cheap.  Anyone is free to change the operating system that runs on these computers.  In my humble opinion, Windows itself is the most dangerous malware installed on these computers.</p>
<p>A different matter is the dangerous management software provided in the UEFI firmware of these computers.  I know, Lenovo Service Engine (LSE) has been widely criticized, and with strong reasons.  But it has been quickly removed from the firmware of affected Lenovo systems (again low-end series only).  Please, do not point your finger to Lenovo, LSE is an implementation of Windows Platform Binary Table (WPBT).  Why are users accusing Lenovo while Microsoft is the author of this abhorrent technology?</p>
<p>Allowing control of the operating system from the computer firmware is a poor design choice.  LSE just uses a technology that has been implemented in Windows by Microsoft.  This technology has not been only exploited by Lenovo&#8217;s LSE.  I remember how some time ago Microsoft remotely changed a few files on all Windows systems through a backdoor in the Microsoft Explorer browser to recover from a bad patch that blocked further system updates.  This time this technology has been used for the good, but it can be obviuosly used in very wrong ways or even exploited by criminals and intelligence services to plant malware, child pornography or other compromising files into computers running Windows.</p>
<p>Anyone running Windows 7 was able to test this widely deployed PC update process hijacking on his own computer two years ago.  Good for Microsoft that helped its users, but I would avoid an operating system that gives so high degree of control of our computers to its manufacturer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275689">

			<div class="comment by-mike-gerwitz ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://mikegerwitz.com' rel='external nofollow ugc' class='url'>Mike Gerwitz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275689">
						June 7, 2016 11:22 AM					</a>

				</p>

				<p>@Richard:</p>
<p>Mint is known for its problems.</p>
<p>Otherwise, your response doesn&#8217;t merit a serious reply.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275690">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275690">
						June 7, 2016 11:28 AM					</a>

				</p>

				<p>@ Who?</p>
<blockquote><p>Please, do not point your finger to Lenovo, LSE is an implementation of Windows Platform Binary Table (WPBT). Why are users accusing Lenovo while Microsoft is the author of this abhorrent technology?</p></blockquote>
<p>As I noted above Microsoft did not invent the idea, Apple did for the Apple][ back in the 1970s such that IO cards could load software in to the system from onboard ROMs (it&#8217;s why the Apple disk IO card only had seven chips as opposed to the thirty or fourty other drive controlers had). IBM filched the idea for the PC so it to could load ROM code to control the cards. Microsoft inherited this and you&#8217;ve been able to put ROM code into a PC ever since. So back in the early days of DOS and later Win you could overright the likes of autoexec.bat  etc (which some early video cards and hard drive controlers did and is alleged to have happened in BadBIOS more recently). Microsoft just evolved the technology into WPBT.</p>
<p>Now the question is who do you blaim when cookies get stolen from the cookie jar? The kid that took the cookies, the person putting cookies in the jar, or the jar maker for not putting a child proof lid on it?</p>
<p>When you look at WPBT MS put it in Win8, not Win7, it was Lenovo or one of their suppliers that effectively backported the idea into Win7. So personally I think Lenovo get the blaim for being not just the kid steeling from the jar, supplying the cookies and along with IBM being an inferior jar maker, whilst MS was only making a new jar, to retain compatability over thirty years&#8230;</p>
<p>th regards,</p>
<blockquote><p>Yoshi has a valid point here, firmware updates must be signed or at least have secure hashes available.</p></blockquote>
<p>Hashes are of no real use when you have a State Level or equivelent attacker up stream of you doing a MITM attack, the network is a pipe not a security mechanism and is inherently insecure. As Stuxnet showed neither hashes or code signing is of any security use. Also as I&#8217;ve pointed out for a long time befor Stuxnet, neither the hash or code signirure mean squat diddly about the code quality or security, and does nothing to stop insider attacks.</p>
<p>With regards,</p>
<p>&lt;</p>
<p>blockquote&gt;</p>
<p>Have you actually read and thought about section 3 of NIST SP 800-147?</p>
<p>Because it does not solve these security issues. And most of all it does not solve what you note with,</p>
<blockquote><p>Another problem is our confidence on these binary blobs. Can we trust UEFI, AMT, our processors microcode or other firmware?</p></blockquote>
<p>Which as you ask it in a rhetorical fashion I&#8217;m sure you know the answer is &#8220;No&#8221; plain and simple. Which brings us onto your question of,</p>
<blockquote><p>On the other hand if something odd happens with our firmwares it should be known to security researchers, right?</p></blockquote>
<p>Not realy, how long and often has &#8220;suspect code&#8221; been uploaded to various AV research lists etc to basicaly be ignored for months, years and in effect decades for some classes of attack vector (ie loading ROM code, boot sector attacks etc). Put simply there are to few researchers and to much malware, thats why &#8220;China APT&#8221; made so much noise several years ago, and proved if that was required that the &#8220;squeaky wheel&#8221; principle applies to AV companies. So from an attackers point of view keep it &#8220;low and slow&#8221; or &#8220;tight and out of sight&#8221; and you will boil any number of selected frogs before the rest ever catch on.</p>
<p>Which brings us to your &#8220;operational&#8221; comment,</p>
<blockquote><p>I try running my computers firewalled, using a strict egress filtering policy if possible, to minimize the impact of a backdoored firmware, but I cannot be sure it is enough.</p></blockquote>
<p>I can tell you for free it&#8217;s nowhere near enough even for everyday Jo&#8217;s privacy / security, as is becoming obvious to more and more people. Modern Commercial OS&#8217;s not just MS offerings try to hard &#8220;to be all things to all men&#8221;. WHich means the attack surface of Commercial OSs is generaly way bigger than most people can even realise let alone understand sufficiently to mitigate.</p>
<p>Which is why I basicaly say &#8220;don&#8217;t try, most won&#8217;t succeed&#8221; against many of the low hanging crook attacks. As for your better than average crook, they are always going to find a zero day you&#8217;ve not prepared for. Even if you have prepared if you are targeted by a state level attacker it&#8217;s game over. They will if required do either a &#8220;black bag&#8221; job against your systems when you are not around and if that does not work a &#8220;wet work&#8221; job against you in person, if you are lucky, your pocket will get picked, if you are less lucky it will be a wet cloth over your face, if you are unlucky the $5 wrench or &#8220;potty trainer&#8221; will be only a short term issue that you will not get to tell anybody about, before they drop you in their chosen waste disposal system&#8230;</p>
<p>It&#8217;s why I talk about the need for humam OpSec as much as I do technical measures. The Squeaky Wheel issues apply to everybody, if you don&#8217;t make noise, the chances are you will not become a target. Likewise if you don&#8217;t squeeze every last drop of private and financial information into social networking and online purchase / banking you will be much less of a target.</p>
<p>However not having an Online Presence is almost deemed suspicious these days so you do have to be slightly visable. But what you mainly say and do can be kept inoffensive (unless you live in the likes of Thailand where not attacking those who make anything other than glowing praise for the monarch godhead is considered as a worse crime than murdering people).</p>
<p>It&#8217;s why I advocate as a minimum a &#8220;two machine&#8221; solution, where you have effectively a sacraficial &#8220;On-Line&#8221; PC to establish a presence, and an &#8220;Off-Line&#8221; PC which you never connect to any potential communications path, and keep your private thoughts and actions there. Whilst this second PC is often called &#8220;air gapped&#8221; it needs to be a lot more than that hence I refere to it more accurately as &#8220;energy gapped&#8221; these days.</p>
<p>Depending on your level of need you may require to get data to or from the Off-Line PC &#8220;online&#8221; but this does not mean you have to use your &#8220;On-Line&#8221; PC, in fact I would suggest you do otherwise. As for your On-Line PC I would recomend a stripped down turn of the century PC with a lot of RAM no hard disk and an older DVD-ROM (ie read only) drive with one of the smaller Linux OSs on it. If you do need to get data on or off it &#8220;localy&#8221; there are various ways to do this. One of which is to use an RS232 serial connection through a mediating device which acts as a Guard. Other ways are with a printer and scanner  into OCR software, as a matter of &#8220;OpSec Cover&#8221; it is best to keep a reasonable quantity of the print outs in a filing cabinate etc, such that anyone who gains access to your property will see just a load of paper records not a hidden away hard disk or other electronic storage. You will also need to shred some of the more innocuous print outs and put them in the household etc rubbish, or get a rabbit/hamster and use it as bedding in it&#8217;s cage, then chuck it out in the refuse.</p>
<p>But as with all OpSec it is all to easy to be in a hurry or some such and blow your cover, hence keep stuff away from home and thus don&#8217;t dirty your own doorstop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275691">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275691">
						June 7, 2016 11:41 AM					</a>

				</p>

				<p>Oh darn&#8230;</p>
<p>@ Who?,</p>
<p>In my above I mucked up the blockquote tags when pasting in part of your post, thus this,</p>
<blockquote><p>Hopefully NIST has some good advice that has been followed by most manufacturers on the last years:</p></blockquote>
<p>Got left out between &#8220;With regards,&#8221; and &#8220;Have you actually read&#8230;&#8221; at the start of the indent for the rest of my comment back to you.</p>
<p>Note to self :- Remember to use Preview&#8230; 🙁</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275692">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275692">
						June 7, 2016 2:51 PM					</a>

				</p>

				<p>@Mike Gerwitz</p>
<p>It doesn&#8217;t help that Mint is likely the place potential new Linux users would go.  Supposedly Cannonical is cleaning up some of the more blatant issues with Ubuntu (presumably sending all your searches to Amazon), but I&#8217;d still point a newbie at Mint.</p>
<p>The bigger problem is that a user has to be willing to learn a whole new set of software.  Sure, way too much is just chrome, and lots of other stuff is straightforward, but the details are killers.  And I don&#8217;t think 1/3 of my steam games work in Linux (although with Kerbal Space Program and Civ5, that should be enough).  Anyone who stuck with Microsoft <em>this</em> long has to be suddenly seriously motivated to build a [slightly] more private machine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275693">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275693">
						June 7, 2016 3:12 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>I can assure know better than me.  I am glad for being able to learn from people like you and other readers of this blog every day, so let me start saying a big THANKS for the valuable information your are sharing here.</p>
<p>However I do not fully agree with you on who invented the WPBT technologies.  What Apple did on its early computer systems is not comparable to Microsoft and its WPBT technology.  Apple just allowed customers to install internal expansion cards on the Apple II.  We have similar firmware cards today, let us say the ROM cartridges in the DEC VT-xxx family of serial terminals.  I see nothing wrong on allowing a user to install a card that expands the features of a computer, it is comparable to installing a software package.</p>
<p>However WPBT is a very intrusive technology that permits software being installed remotely without user authorization or knowledge.  My point is that firmware should not be allowed to interact in this way with an operating system, and an operating system should not provide ways to allow this unrestricted access to its supposedly private resources.  Firmware should not be a mean to allow persistence, at least not without user acknowledgment.  Customers who care about thievery may hire a corporation like Computrace or Intel to track their devices, but this should be a choice and it should be disabled by default.</p>
<blockquote><p><i>Now the question is who do you blaim when cookies get stolen from the cookie jar? The kid that took the cookies, the person putting cookies in the jar, or the jar maker for not putting a child proof lid on it?</i></p></blockquote>
<p>Both Lenovo and Microsoft are blamable.  LSE would not have existed without collaboration from Microsoft.  It is a highly intrusive technology.  Perhaps it has its place in remote management, but it is a feature that should be disabled by default and certainly restricted to a few trusted management stations.  I do not know Lenovo&#8217;s goal.  Perhaps they were testing this technology on low-end system to analyze user&#8217;s response before applying it to more expensive, and critical, gear.</p>
<blockquote><p><i>Hashes are of no real use when you have a State Level or equivelent attacker up stream of you doing a MITM attack, the network is a pipe not a security mechanism and is inherently insecure. As Stuxnet showed neither hashes or code signing is of any security use. Also as I&#8217;ve pointed out for a long time befor Stuxnet, neither the hash or code signirure mean squat diddly about the code quality or security, and does nothing to stop insider attacks.</i></p></blockquote>
<p>Sure, firmware should be protected by means of digital certificates and ideally, once installed on a computer, by means of write protection jumpers like the ones protecting Sun&#8217;s OpenBoot PROM on sparc64 systems.  I said strong hashes and secure download channels should be a minimum, just to assure integrity in the case of a failed download or providing some basic protection against less advanced attackers.</p>
<blockquote><p><i>Have you actually read and thought about section 3 of NIST SP 800-147?</i></p></blockquote>
<p>Sure, I am not saying this document is perfect nor I am saying in any way NIST must be trusted.  However in the last years more and more manufacturers are providing secure methods to upgrade the firmware on their devices through signed images.  This document at least has improved the status when compared to previous years where any binary could be written on the flash chips.  This mechanism, even being mathematically sound, is not perfect either &#8212; let us consider the sleep mode configuration bypass on UEFI firmware.</p>
<p>Indeed, we should not trust on firmware.  It can be backdoored (in fact, I would be really surprised in case it is not, as most firmware manufacturers are U.S. corporations at just one small step from a government NSL).  Even if firmware has no backdoors it is not written by the security-targeted developers and, in recent years, it has become extremely convoluted.</p>
<p>About firewalls:</p>
<blockquote><p><i>I can tell you for free it&#8217;s nowhere near enough even for everyday Jo&#8217;s privacy / security, as is becoming obvious to more and more people. Modern Commercial OS&#8217;s not just MS offerings try to hard &#8220;to be all things to all men&#8221;. Which means the attack surface of Commercial OSs is generaly way bigger than most people can even realise let alone understand sufficiently to mitigate.</i></p></blockquote>
<p>I know, commercial operating systems are not really protected even behind the most strict egress filtering policies.  These operating system may be compromised by just downloading the wrong Excel or PDF file, not to say email attachments or hijacked updates.  However a restrictive egress filtering policy (in both outbound and inbound traffic) implemented in an OpenBSD firewall running on simple devices (PC Engines APU systems, old i386 gear, arm, sparc/sparc64 hardware&#8230;) protecting a small network of OpenBSD computers is a good starting point, in my humble opinion.  It is not perfect, but should be enough for Internet facing computers.</p>
<p>Of course air-gapped (or, as you suggest, energy gapped) computers are important too.  I have a few ones, in the same way I have off-line storage (usually on CD-ROM) for critical files (like firmware images, that I download periodically from different networks on different days just to compare different checksums with the images stored in non-writable media).  When using ISO images from a manufacturer is not possible, I run the firmware updates from a Windows PE 3.0 media stored on a non-writable CD-ROM a few years ago.  In all cases, the firmware is applied off-line and moved to the air-gapped computer using non-writable CD-ROMs to avoid the risk of USB devices.  I have a few &#8220;air-gapped&#8221; USB devices too, the only ones that use on the air-gapped computers, to provide the firmware updates to the WinPE CD-ROM when writable media is required (e.g., when certain installers need to be used to run the firmware upgrade tool).  Of course as soon as one of these air-gapped flash drives is used on a non air-gapped computer it is not used anymore on the air-gapped systems.  I know, it is far from being perfect, but it is the best I can do as there is a risk on anything downloaded from external sources.</p>
<p>Sometimes I download firmware images years after being applied just to verify that checksums on the original media have not changed.  If possible, getting the firmware images from different sources when a corporations gives a choice.</p>
<p>Indeed, I try to maintain a low profile on all my activities.  And I can assure you all these activities are completely legal ones, I just try to be careful.</p>
<p>Attack surface on simple operating systems like OpenBSD should be easy to understand for an advanced system administrator.  So the firewall is mainly to stop some unexpected activity from the few software packages or firmware installed on my computers.  Just a basic operational security, nothing advanced.</p>
<blockquote><p><i>One of which is to use an RS232 serial connection through a mediating device which acts as a Guard.</i></p></blockquote>
<p>This sounds clever.  Would you mind telling us a bit more?  How is the serial connection being used?  I understand you are not encapsulating full TCP/IP on it.  Are you using it to just transfer files using, let us say, Kermit?</p>
<p>Thanks!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275694">

			<div class="comment by-yoshi ">

				<p class="commentcredit">

					<span class="commenter">Yoshi</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275694">
						June 7, 2016 4:44 PM					</a>

				</p>

				<p>@Clive R:</p>
<p>Surely you aren&#8217;t advocating for the abolishment of checksums and signatures etc just because of Stuxnet types of attacks?  The whole internet isn&#8217;t Stuxnet.</p>
<p>So yes, valid checksums, still have their value.  Don&#8217;t throw the baby out with the bathwater.  Yes there are other multiple points of vulnerability in a transer of data, but it makes no sense to quit one security feature that is still valid just because of a different vulnerability that (sometimes) (may) exist elsewhere.</p>
<p>Most people would value validation of some sort even if not perfect that their ware isn&#8217;t corrupted nor infiltrated with malware nor replaced with a completely different ware.</p>
<p>Yes, it&#8217;s important to have data integrity and security throughout the chain, but just because one vulnerability might sometimes exist doesn&#8217;t mean that then you therefore give up and add more vulnerabilities.</p>
<p>Some things aren&#8217;t mutually exclusive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275695">

			<div class="comment by-pwned ">

				<p class="commentcredit">

					<span class="commenter">pwned</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275695">
						June 7, 2016 5:24 PM					</a>

				</p>

				<p>Holy crap, I had never heard of WPBT.  I guess I am never running Windows 8 or 10 then.  Why would MS intentionally introduce such a dangerous vector for malware?  Did the NSA insist on it or something?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275696">

			<div class="comment by-moz ">

				<p class="commentcredit">

					<span class="commenter">moz</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275696">
						June 7, 2016 5:31 PM					</a>

				</p>

				<p>@richard&#8217;s comment is interesting, shows clear commercial bias and looks like a reminder that Microsoft will <em>never</em> give up on it&#8217;s strategy of FUD outlined in the <a href="https://en.wikipedia.org/wiki/Halloween_documents" rel="nofollow ugc">Haloween Documents</a>.  It mixes a small amount of truth (some Linux distros have had real security problems / many are not nearly careful enough) with a large part of FUD and ignores the key facts.</p>
<p>The key fact is that RHEL is basically the only place where you can get a complete signed system (no, kernel + GUI + some admin tools as delviered by Apple and Microsoft does not a system make) with properly considered and implemented security.  Their signing infrastructure <a href="https://www.redhat.com/archives/fedora-announce-list/2008-August/msg00012.html" rel="nofollow ugc">has actually been shown to stand up to compromise</a> and they do appear to take things seriously.  It&#8217;s also, alongside OpenBSD, one of the few places which take security seriously and attempt to deliver the entire source code for their system allowing you to audit who caused a system compromise once it&#8217;s discovered.  You can expect to get a system where you know the entire code base is built from source by one organization on one set of infrastructure from source to delivered, signed, verified package.</p>
<p>In this area, as in many others, you get what you pay for.  RHEL security is almost acceptable.  Fedora, with fully working SELinux and <a href="https://docs.pagure.org/releng/philosophy.html" rel="nofollow ugc">a serious attempt at a proper release process</a> is live-with-able.  No other operating system commonly available (and I am staring hard at OpenBSD which lacks MAC and only recently implemented working binary updates for normal admins) comes close.</p>
<p>Linux is not nearly perfect.  Multics was almost certainly better.  VMS probably came close and was made much longer ago.  However in a world in which the default language for writing large parts of operating systems remains C and competitors like Microsoft continue to leave office macros on for commercial reasons even though they are a major reason for compromise, Linux is the slightly glowing coal in the gloom of Mordor.  Let us give it the credit for that until we get a better option.  Maybe one of the new proposed operating systems based on Rust?    Maybe for example perhaps a future version of <a href="https://www.qubes-os.org/" rel="nofollow ugc">Qubes</a>?At least <a href="https://www.qubes-os.org/news/2016/05/30/build-security/" rel="nofollow ugc">they seem to care about their build process</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275697">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275697">
						June 7, 2016 6:48 PM					</a>

				</p>

				<p>@ moz</p>
<p>Overall, good outlook of it. I&#8217;ll add a few points.</p>
<p>re Windows</p>
<p>Richard is mostly right that there&#8217;s tons of issues in FOSS right now outside just a few projects and OS&#8217;s that are high-quality. I was just countering the many eyeballs myth earlier where someone thought it meant something for security. It does for debugging but not security. Security takes responsibility by a team. That&#8217;s uncommon in both proprietary and FOSS sadly.</p>
<p>Now, Microsoft started as a clone of the <a href="http://windowsitpro.com/windows-client/windows-nt-and-vms-rest-story" rel="nofollow ugc">best OS</a> from the 80&#8217;s. Far as I can tell, it&#8217;s problems developed due to rush to market with no concern for security, weird stuff required for backward compatibility, and code to make broken, 3rd party stuff work. The reason was to get a near monopoly, which they did. Then, they had to fix it once problems got too big. Lipner&#8217;s SDL turned it around quite a bit. They did mandatory integrity controls, sandboxing, some whitelisting, safer languages for apps, transformations for unsafe languages, formal verification of hypervisors&#8230; all sorts of stuff. Now, there&#8217;s hardly any 0-days found in Windows kernel compared to Windows apps and FOSS software. Speaks wonders for its current quality.</p>
<p>If only they&#8217;d stop being such subversive and expensive assholes, eh? Then I might become a customer again. As you said, specific Linux or BSD OS&#8217;s offer much better package for users. Plus have source for anyone willing to inspect.</p>
<p>re build process, securing it, and&#8230; the software supporting that</p>
<p>Like with &#8220;Reproducible Builds,&#8221; the Qubes work is another that&#8217;s barely adequate and ignoring history. You seem to know some OS history as you named one that still beats out modern ones in some respects. Wheeler already did the <a href="http://www.dwheeler.com/essays/scm-security.html" rel="nofollow ugc">definitive guide</a> on securing SCM or builds with many, relevant links. Here&#8217;s a start on <a href="https://news.ycombinator.com/item?id=10478742" rel="nofollow ugc">principles and methods</a> for ensuring correctness of systems &amp; software while eliminating subversion from lifecycle. I take it further <a href="https://news.ycombinator.com/item?id=10182282" rel="nofollow ugc">here</a> with a post countering &#8220;reproducible builds&#8221; that describes, immediately &amp; in follow-up comment, how to do subversion-resistant, verifiable builds. Much larger issue than OSS or most proprietary are willing to tackle despite tools available to help with some components already built.</p>
<p>Red Hat doesn&#8217;t have it. Better than many, though. Qubes certainly doesn&#8217;t have it. Most FOSS doesn&#8217;t have it. Most proprietary not only are missing secure SCM but take steps to prevent us from knowing. 😉 Shapiro&#8217;s OpenCM, Aegis, and others like them that try get ignored and wither. So, this is one of software lifecycle&#8217;s most longstanding problems. Unusually, they have everything they need to know and use to deal with it to. Just outright refusal outside some outliers that deploy a half-assed or decent custom process that approximates prior work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275698">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275698">
						June 7, 2016 9:35 PM					</a>

				</p>

				<p>Clive Robinson<br />
&#8211;The fundamental flaws in your advice is a) use older computers (they&#8217;ll all be dead in 10-15 years regardless) and b) how to develop your offline PC w/ a PC that has verifiably never been connected to another PC that has malware.  Solving a) is only possible creating new hardware and being able to check it which is a problem that&#8217;s yet to be solved.  Solving b) is again more or less impossible.  Something I do at my work, is send commands to a small infrared receiver that actually has an &#8220;MCU&#8221; in it (this thing is so tiny you would not believe it) from a completely separate chip over i2c.  We write to registers from one firmware to another.  It&#8217;s weird, writing code for 2 chips at once.  This kind of thing makes you wonder if say up to 5-6 chips registers could be touched by just one chip, so long as the connections are correct on the motherboard and actual chips can be disguised as a power transistor or op-amp or rectifier even.  It&#8217;s a false sense of security even if there&#8217;s minimal IC&#8217;s on the board. F*cking impossible.</p>
<p>People know about code signing not being a silver bullet but there&#8217;s no better ideas, nothing practical to implement.  Insider attacks are impossible to prevent besides doing strip searches on entry/exit and total surveillance (and surveillance on the surveillance, it&#8217;s surveillance all the way down); no business would survive that as no one would work in that kind of place.  So, it&#8217;s not some revelation that code signing isn&#8217;t secure in itself if the computer signing the code is infected.  More like it means that specific computer needs to be compromised and that binary targeted for the attack to work.</p>
<p>State level attackers aren&#8217;t game over, some of them suffer from severe dunning-kruger effect, it&#8217;s pretty clear when it happens since they don&#8217;t know how to be really paranoid like everyday attackers since they can sometimes operate w/ no fear of getting arrested.  Once you go thru it and get your free training in, you can sneak quite a bit past them and they won&#8217;t have a clue b/c again, there&#8217;s simply too many holes to slip thru, it&#8217;s just a fact of life lol.  It&#8217;s a game of attrition at that point, how much time and money can you get wasted.  Losing game all around, devolving into mutally assured destruction of resource depletion where we all lose, just losers all around and the world becomes a darker more death-filled place.  Living in fear of a black bag job or someone mugging you or whatever is no way to live.  2-way street.  It&#8217;s just like bullies in grade school, fight back.  Learn self-defense and hopefully kill the bastard/coward if they try anything physical.  Proper self-defense, can be <em>very</em> effective.  Always love hearing the stories in the US of some home intruder getting killed by a 80 year old granny, one less scum bag threat to breaking into your home.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275699">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275699">
						June 7, 2016 9:58 PM					</a>

				</p>

				<p>@ Figureitout</p>
<p>&#8220;Always love hearing the stories in the US of some home intruder getting killed by a 80 year old granny, one less scum bag threat to breaking into your home.&#8221;</p>
<p>Agreed. Another <a href="https://www.youtube.com/watch?v=1G1_CgiXwNM" rel="nofollow ugc">fun example.</a> 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275700">

			<div class="comment by-richard ">

				<p class="commentcredit">

					<span class="commenter">Richard</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275700">
						June 8, 2016 12:06 AM					</a>

				</p>

				<p>@ Mike, Nick P, moz</p>
<p>I don&#8217;t want to leave the wrong impression &#8211; I DO run Linux on my PC&#8217;s, and I do consider it reasonably secure given the current threat model (which includes a certain amount of security through obscurity) &#8211; but don&#8217;t fool yourself, if Linux Desktop users were targeted and attacked with the intensity and sophistication that MS Windows users are on a daily basis &#8211; then given the current pathetic state of Linux Desktop security, Linux would fair worse &#8211; FAR WORSE.</p>
<p>So, I&#8217;m sorry if I seemed a bit crotchety, but the idea that the typical &#8220;Linux Desktop&#8221; is somehow a paragon of security is simply ludicrous.</p>
<p>The problem is that the Linux community seems to be totally clueless regarding the simple fact that SERVER SECURITY IS NOT THE SAME AS DESKTOP SECURITY, so the security measures you need to keep pizza munching nerds from hacking into your precious server at 3:00 A.M. are not the same as those you need to secure a user&#8217;s desktop while they surf around the net clicking things at random.</p>
<p>As a result, ALL the major Linux Desktop Distributions lack even the minimal essential features you would expect in a modern secure desktop environment.  Features like an outbound application level firewall and effective real time heuristics based virus protection.</p>
<p>But given that MS Windows systems HAVE these features, where Linux Desktops do not, then why does Windows get hacked all the time and Linux only rarely?</p>
<p>Simple answer; Linux Desktop users don&#8217;t get hacked BECAUSE NO ONE CARES TO WASTE THEIR TIME.</p>
<p>Why would any self respecting malware author waste their time writing malware to attack the Linux Desktop, when Windows is where the money is, and Linux has such a minuscule portion of the desktop PC market?</p>
<p>When they do try, such as during the recent Firefox PDF Zero Day&#8230;</p>
<p><a href="http://www.securityweek.com/mozilla-patches-firefox-zero-day-exploited-wild" rel="nofollow ugc">mozilla-patches-firefox-zero-day</a></p>
<p>&#8230; Linux users had their critical information stolen to the same degree as their Windowz neighbors (or possibly worse) &#8211; so as a Linux user, I think some humility is in order.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275701">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275701">
						June 8, 2016 2:39 AM					</a>

				</p>

				<p>@ Yoshi,</p>
<blockquote><p>Surely you aren&#8217;t advocating for the abolishment of checksums and signatures etc just because of Stuxnet types of attacks? The whole internet isn&#8217;t Stuxnet.</p></blockquote>
<p>No I&#8217;m saying, as I&#8217;ve said for a very long time, that code signing is not an indicator of the quality of code, or the security of code at any time. All it realy says is thst a collection of files were hashed and the overall hash was signed by a private key. Further that as we know hashes can be vulnerable to falsification and likewise so can the signing keys that can also be stolen. Further we know from other attacks on CA systems that it is possible to hide from a user the fact that a signing key is nothing what so ever to do with the organisation the user is mislead to belive.</p>
<p>Put more simply &#8220;Code signing is not fit for it&#8217;s stated purpose as currently implemented&#8221;.</p>
<p>If we are going to make code signing more fit for purpose we need to sort out as a first step the CA issues, which as we know significantly effect security in other areas. Yet a quater of a cenrury down the road nobody has addressed the CA issues, in fact they have scurried in the direction of making it worse in nearly all cases, under the excuse of either making it easier for users or not scaring users with details. Need I say that security is all about the details? Especialy those the devil hides in.</p>
<p>Go and read NIST SP 800-147 (it only takes about twenty minutes) then see what it actualy does (very little) and what it&#8217;s weak points are (many) and how you might attack it&#8230;</p>
<p>So just to reiterate I am saying code signing does not currently do what people think it does, and worse it is based entirely on known to have failed assumptions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275702">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275702">
						June 8, 2016 4:31 AM					</a>

				</p>

				<p>@ pwned,</p>
<blockquote><p>Holy crap, I had never heard of WPBT. I guess I am never running Windows 8 or 10 then.</p></blockquote>
<p>As I&#8217;ve indicated it started back in the late 1970&#8217;s over a third of a century ago, and it has evolved with time and OS complexity and other changes.</p>
<p>It is a solution to a quite real problem, but has real side effects.</p>
<p>The problem is fairly simple to describe &#8220;new technolog&#8221; especially in storage technology.</p>
<p>Let&#8217;s say I come up with a new way to store data it needs an interface to the computer part of which is a &#8220;software driver&#8221;. The driver will not be in the standard OS, so how do you get it into the OS?</p>
<p>Well the original option was ROM code on the interface card that would be mapped in at a specific area of memory with a &#8220;magic number&#8221; to tell the OS it should be run. OS functions such as reading from mass storage is often done by either a jump table in RAM or a Software IRQ, both of which can be over written to redirect the execution of code.</p>
<p>Thus you would write your ROM code such that it replaced the Jump Table entry to point to your functions in your ROM code.</p>
<p>When the system boots up the ROM code gets run by the BIOS, which puts your ROM code into the BIOS code via the jump table. The BIOS then loads the OS image in using the disk driver on your ROM. When the OS image starts it also runs the ROM again which updates the OS jump table to use the ROM code, thus the OS now has your ROM code driver in it and things will work despite the fact that the OS does not have a driver for your new mass storage system.</p>
<p>This need is not going to go away, the fact that it is a massive security hole is likewise not going to go away.</p>
<p>Whilst there are ways to close the security gap down, it involves extra work, liability or both to the OS supplying company. So in a cost saving and risk averse environment the closing of the gap is not going to realy happen.</p>
<p>The fact that it is also a godsend to the likes of the NSA, GCHQ et al for doing updatable implants is just an unfortunate side effect of an otherwise usefull if not necessary function&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275703">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275703">
						June 8, 2016 8:08 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<blockquote><p>The fundamental flaws in your advice is a) use older computers (they&#8217;ll all be dead in 10-15 years regardless) and b) how to develop your offline PC w/ a PC that has verifiably never been connected to another PC that has malware.</p></blockquote>
<p>As you well know I have solutions to these problems BUT they are not practical for most people. For instance, have you ever taken a microcontroler development board with two serial interfaces and made a &#8220;Guard&#8221; from it? I know that you have access to the resources and some of the knowledge, but would you consider it a practical project? Not just for you but 99.8% of computer users who don&#8217;t have the resources, or for that matter the knowledge / ability to code it all up&#8230;</p>
<p>So odd as it might seem it&#8217;s kind of a more practical suggestion for most to work with, and as old computers can be purchased for as little as $10, it does not carry a finacial risk for most people.</p>
<p>But lets examine your two points in a little more depth.</p>
<p><b>a) use older computers (they&#8217;ll all be dead in 10-15 years regardless)</b></p>
<p>Whilst newer computers do die alarmingly fast, the older ones were often built to a better build quality. I&#8217;ve a couple of 386 HP computers that are not only going strong, their level of EMC shielding means I can use them inside an RF cage and not mess up readings on the other instruments. Admittedly they run my own wierd OS and C compiler but they do their jobs admirably. Importantly though, they are &#8211;compared to modern surface mount computers&#8211; fairly easy to repair the PSU and motherboard, and I have plenty of spares of old serial and display cards, some of which I&#8217;ve already made &#8220;socketed&#8221; for easier repair.</p>
<p>As for storage, they use floppy and QIC tape drives which you can still get hold off that work off the old floppy drive interface. I also have another with a cheap well known NE2000 &#8220;knock off&#8221; network card (the chips of which are still very much being manufactured) which has a PXE boot NetROM on in a 27C128 of which I have bucket loads of.</p>
<p>Whilst this does sound very &#8220;hobby shack&#8221; there are loads of older Ham Radio guys still using and cherishing such kit, rather more of them than I suspect can write guard code on a modern microcontroler.</p>
<p><b>b) how to develop your offline PC w/ a PC that has verifiably never been connected to another PC that has malware.</b></p>
<p>It depends on the vintage of the motherboard and cards, but there are lots of boards that never had Flash PROM or EEROM on them. Thus after you make them run on floppies or CDROM only, the fact that in a previous life they were connected with out protection to that festering disease pit of the Internet does not actually matter.</p>
<p>Thus the main concern with vintige kit is the one you did not mention which I&#8217;ll add,</p>
<p><b>C) How do you get conectivity</b></p>
<p>The answer is via several methods SneakerNet might be old and venerable but still works, and direct conectivity such as serial, Parallel or Ethernet ports, with SLIP/PPP, PLIP, if you need IP connectivity or Kermit / Xmodem etc if you don&#8217;t. Supprisingly if you know where to look on the Internet it&#8217;s all described in excruciating detail and usable source code that an individual can get to grips with all nicely presented.</p>
<p><b>D) Performance of old kit</b><br />
The important point to note with even computers a couple of generations old is you will get a performance hit, it&#8217;s unavoidable. However the reality is that for most things you might want to do in terms of &#8220;productivity&#8221; not &#8220;entertainment&#8221; performance is not an issue, and it&#8217;s possibly the most important consideration to think about.</p>
<p>For instance I still use WordStar a version of which including the spell checker fits happily on a 1.44Mbyte floppy and will run within 64K of memory on an 8086 machine I have. Likewise I&#8217;ve older K&amp;R style C compilers, and more modern ANSI compatible Turbo C that all run off of floppies including the IDE. As for lower level code DEBUG can be used to write assembler code in and will import text files from the likes of Edit/Basic. You can with a little hunting find all of those for free on the Internet as well as Forth (yeh I know you don&#8217;t like it but it&#8217;s got many advantages when considering Privacy and Security).</p>
<p>As for OS&#8217;s you can still find MS Dos 5 and earlier if you look, there are also &#8220;Free DOSs&#8221; out there you can find out about, one works well not just on it&#8217;s own but in WINE or Qemu etc. And there are early versions of Linux and similar *nix that will run off of either a CD or striped down on a floppy or two and will mount what else you need read only via NFS etc across SLIP at 9600baud. You can get these early verisons of Linux on a CD out of the back of older second hand books (Slackware being a notable early contender). Which gives you a certain degree of confidence that any bugs, are bugs not builtin backdoors.</p>
<p><b>E) The modern Approach</b><br />
But if you do want to go down the modern route and want to avoid the security madness that is modern Intel / ARM hardware, you do have the option of the microcontroler route. For instance there is a copy of RetroBSD for PIC32 chips (MIPS core) that even though SMD can be purchased on &#8220;break out&#8221; boards for the PicKit Explorer 16 etc. Which is about the cheapest way I know of getting *nix up on the cheapest of microcontrolers, without getting your soldering iron out.</p>
<p>Though you might want to look up MMbasic ( <a href="http://geoffg.net/Maximite_Story.html" rel="nofollow ugc">http://geoffg.net/Maximite_Story.html</a> ), it will give you the full GWbasic experience on a PIC32. The guy that developed it alows people access to the code to extend it in various ways, so a crypto extension or two would be of interest to him. But perhaps more importantly there is another person with a crowd funded project to produce a rather nifty little computer with kby, screen and an electronics break out prototype area ( <a href="http://www.theverge.com/circuitbreaker/2016/6/1/11829996/ello-2m-retro-computer-crowdsupply" rel="nofollow ugc">http://www.theverge.com/circuitbreaker/2016/6/1/11829996/ello-2m-retro-computer-crowdsupply</a> ).</p>
<p>So yes there are options which cater for most skill / risk / productivity points. But I will leave you with another consideration.</p>
<p>On the assumption your modern PC is owned by MicroSoft, Google, GCHQ, NSA et al, that does not make it unusable. Providing your &#8220;entertainment&#8221; requirments are not particularly &#8220;moral offending&#8221; then you can use it for that. And to be honest, how many people realy do &#8220;productivity&#8221; at home?</p>
<p>That is you by and large don&#8217;t need MS Office/365 or Google equivalent on an entertainment box. Thus it&#8217;s no great loss to not have them on it. Especialy when you consider they are slurping up every key stroke back to the &#8220;Corporate Motherships&#8221; and thus to the NSA, GCHQ et al, in transit, thus you will hemorage any privacy / secrecy if you use them.</p>
<p>By and large most &#8220;productive&#8221; work on a computer is destined to be &#8220;human readable&#8221; print outs, or text files for the likes of Emails etc. This means old and slow tools that were more than usable in the mid to late 1980&#8217;s are still more than adiquate nearly a third of a century later. The only real issue is &#8220;file formats&#8221;. Which unless you realy need leading edge fancy effects can be a non issues if you use standard &#8220;old as the hills&#8221; human readable file formats.</p>
<p>As a matter of habit I only generate &#8220;human readable&#8221; files so CSV, RTF, PostScript, which I can check with text based tools (occasionaly converting to early HTML if I do need to pull in pictures and graphics).</p>
<p>Whilst it&#8217;s not impossible to hide malware in such files &#8211;source code is human readable after all&#8211; it makes such attempts more obvious to the eye and various tools I&#8217;ve developed over the years.</p>
<p>Thus your &#8220;productive&#8221; private secure machine can be quite old and not realy slow you down. The only difficulty left to solve is printing. To which I say get yourself a PostScript Level 2 printer with a network interface, most will directly print out plain text files or earlier levels of PostScript (if it won&#8217;t directly print text, you can find online a PostScript wrapper you can hand edit into a text file in seconds).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275704">

			<div class="comment by-mike-gerwitz ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://mikegerwitz.com' rel='external nofollow ugc' class='url'>Mike Gerwitz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275704">
						June 8, 2016 9:04 AM					</a>

				</p>

				<p>@Richard:</p>
<p>I encourage you to substantiate your claims with concrete examples.  Lumping all GNU/Linux systems together, and lumping all software together, does not make sense.</p>
<p>I can&#8217;t possibly address such blanket claims.</p>
<p>Debian is known for its stringent controls, and GNU Guix is well on its way.</p>
<p>@wumpus:</p>
<p>I&#8217;m referring to the standard package system on that particular OS.  If you have other software (like Steam), they&#8217;re subject to their own practices.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275705">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275705">
						June 8, 2016 1:42 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>I have nothing to add this time, just want writing to say you thank you.  Your approach to security is sane and logical.</p>
<p>I have not enough old hardware right now.  My 286 was destroyed fifteen years ago as a consequence of a known design flaw in its power supply that fried the motherboard (two decades ago it was much harder getting a recall for a defective product from a company).  Now I own just a Siemens Nixdorf pentium computer I bought in 1997 to run Solaris on it (hopefully, one of the last machines designed without the memory sinkhole vulnerability), an IBM 5140 (convertible) with a poor quality display and, worse of all, without ISA slots or serial ports, and a few old (but reliable) SPARC/SPARC64/PA-RISC/MIPS gear.  There is nothing as DOS on these computers, but can run isolated, have serial ports and a physical switch to protect BIOS (the Siemens Nixdorf PC has a switch for this purpose too) and run OpenBSD nicely.  These machines are airgapped (well, all except the Sun Ultra 30), but are my main gear yet.</p>
<p>I had not been very lucky with that old hardware.  Only a few but reliable computers, as you can see.  Surprisingly, I had been more lucky with software (PC/TCP, WordPerfect 5.1, Lotus 1-2-3, DOS from 4.01 up to 6.22, Microsoft Word for DOS, MASM 6&#8230;).  All these software packages are complete, with full media and documentation.  Most of them were gifts, some adquired by me over the years.</p>
<p>I will certainly have room for a few reliable computers.  Siemens Nixdorf had an exceptional PCD and PCE series (the PCD-4T/66 was a superb computer, well engineered and easy to repair, and the PCE-5T was a fine server), but these old computers are very difficult to get right now.  I will get a few of these Siemens, HP, Unisys, IBM systems if I have a chance, but it seems they have just dissapeared from the earth.</p>
<p>I understand your HP 386 computers are Vectra&#8230; these are very nice systems.  Heavy, but quiet and reliable (and, if you have the right models, small desktops too).  It is very nice to see you have them yet.  These are good systems, like the HP 150 and 150-II.  These machines were expensive years ago, but its quality was higher than the one of modern computers&#8230; and they were more reliable too:</p>
<p><a href="https://en.wikipedia.org/wiki/Capacitor_plague" rel="nofollow ugc">https://en.wikipedia.org/wiki/Capacitor_plague</a></p>
<p>The old computers approach seems right.  Better do not try to connect one of these machines to the unfriendly Internet using PC/TCP, but certainly these systems have its place on our infrastructure.</p>
<p>Sometimes I like running DOS (DR-DOS and PC-DOS mainly) on an hypervisor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275706">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275706">
						June 8, 2016 1:53 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>About the &#8220;modern approach&#8221;</p>
<p>I like it a lot too.  It is easier right now, cheap and widely available, and works as expected in terms of performance/features.  However, I try to get &#8220;old hardware&#8221;-like machines for the firewalls.  I think the Alix/APU boards are a good choice.  Never worked with an APU, but its predecesor (Alix) had a decent firmware.  Nothing related to UEFI or the Intel Management Engine on it, have AMD Geode processors (APU has a quad-core Jaguar), so they should be sinkhole-free too, and run OpenBSD.</p>
<p>My first step when setting up a network exposed to the wild Internet is making a firewall using one of these small computers.  Then I build the internal systems using OpenBSD too.  At least I know the expected AMT ports are blocked for both inbound and outbound traffic.</p>
<p>Not perfect, but it is a good compromise between performance, features and hardware availability.</p>
<p>Of course, I am talking only about networks connected to the Internet.  I like running most computers airgapped.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275707">

			<div class="comment by-gerard-van-vooren ">

				<p class="commentcredit">

					<span class="commenter">Gerard van Vooren</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275707">
						June 8, 2016 3:22 PM					</a>

				</p>

				<p>@ Richard,</p>
<p><i>&#8230; Linux users had their critical information stolen to the same degree as their Windowz neighbors (or possibly worse) &#8211; so as a Linux user, I think some humility is in order.</i></p>
<p>Wtf? It&#8217;s easy to forget that the windows security problems that started with Windows XP being &#8220;internet ready&#8221; (when Bill was caught with his pants down) are self inflicted. Today we still see &#8220;security updates&#8221; for Windows 7. How is it possible that a multi billion dollar company still needs to update the security of their operating systems? It&#8217;s bullsh*t.</p>
<p>So humility? Yeah right. What is it to be humble upon in the first place? W10 and Office365 are tracking (=stealing) ad platforms with legal fine print up to Mars. I can continue if you want to but I am not humble when it comes to Microsoft software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275708">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275708">
						June 8, 2016 11:02 PM					</a>

				</p>

				<p>Nick P<br />
&#8211;Ha, yeah.  Dude got owned.</p>
<p>Clive Robinson<br />
&#8211;They can be practical, someone just has to take the time to make step-by-step tutorials.  No I&#8217;ve not made a guard b/c I&#8217;m not 100% how they work or what to filter for (have to update filters all the time like web firewalls..? B/c that&#8217;s a nightmare) but I told you that I got lucky and my next project is going to be something very much like a guard.  I&#8217;d be taking in comms of one protocol from an external MCU (w/ another older chip handling the critical timing of it, then another being that first serial interface) and my job will be to make one serial output for debugging and another passing on data to an internal MCU.  I&#8217;m going to lean on our team a bit but want to do as much as I can (well commented and clean).  The chip I choose needs a bare minimum of 3 serial ports.</p>
<p>No I wouldn&#8217;t consider it practical now though (but maybe I&#8217;ll be the first one to post instructions on how to build one here, who knows), once I get nRF_Detekt deployed for testing and my radio connected to my PC I&#8217;m going to try to make a data diode like M. Ottela made, and transfer a file (preferably zip file) via putty or some popular terminal program on an internet connected &#8220;infected&#8221; PC one-way to a connecting PC.  Then vice-versa.</p>
<p>RE: old pc&#8217;s<br />
&#8211;I told the blog about my oldest one in case it helps someone debug a broken PC.  I just removed one bad RAM card and it booted up again.  Then I let it be as I was saving it, well won&#8217;t boot again lol.  The HDD, I&#8217;m not sure how it&#8217;s still alive lol.  I&#8217;m not sure if the RAM cards I see online for ~$1 will work so I didn&#8217;t pull the trigger (carders getting my debit card and making fraudulent charges on paypal had something to do w/ it too; I&#8217;m not going to live in fear of those scum either).  If I could boot off a floppy disk (I&#8217;ve got like 5-10 floppies) and just run &#8220;live&#8221; w/ FreeDOS or DOS, then hell yeah but I&#8217;m not feeling it right now.</p>
<p>Another one still works but I took offline myself and I gotta replace like 8 caps around the CPU that are oozing like hell (ugh why?! stupid design&#8230;).  It&#8217;s you know got wires galore so I need to take a picture etc. then just make sure I get right polarity on them.</p>
<p>Another one that&#8217;s working, not sure if I want that to be an openBSD machine or a firewall, saving it.  It&#8217;s got a nice serial port so it&#8217;d make a nice endpoint.  Cool design too, very hacker friendly.  I just want to replace the HDD, another project I don&#8217;t really wanna do but gotta do it&#8230;my gf now takes up more of my free time and money so&#8230;bah can&#8217;t win :p</p>
<p>Regardless, there&#8217;s no getting around that that strategy is temporary and relying on dwindling supplies of parts.  Depressing.  I definitely would&#8217;ve been stocked if I was an adult in the 70&#8217;s/80&#8217;s.</p>
<p><i>It depends on the vintage of the motherboard and cards</i><br />
&#8211;Still doesn&#8217;t account for if the computer burning the ROM was itself infected&#8230;pretty easy to point to impossible situations eh?  Highly unlikely, still feasible.</p>
<p>So yeah you know I&#8217;m going to be doing the modern approach w/ some dev board w/ a chip I really like and a toolchain supported by linux.  Yawn.  Oh well if someone can do better and actually lay it out here&#8230;otherwise it&#8217;ll be most future proof and I look forward to the attacks on air-gapped MCU&#8217;s that don&#8217;t involve known methods.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275709">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275709">
						June 10, 2016 9:52 AM					</a>

				</p>

				<p>Thanks to all, again, for the valuable information shared on this thread.</p>
<p>Now to stay on topic&#8230; <a href="http://teletext.zaibatsutel.net/post/145370716258/deadupdate-or-how-i-learned-to-stop-worrying-and" rel="nofollow ugc">http://teletext.zaibatsutel.net/post/145370716258/deadupdate-or-how-i-learned-to-stop-worrying-and</a></p>
<p>Worrying&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-275710">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275710">
						June 11, 2016 12:47 PM					</a>

				</p>

				<p>@Who?</p>
<p>&#8220;[&#8230;] IBM 5140 (convertible) with a poor quality display and, worse of all, without ISA slots or serial ports [&#8230;]&#8221;</p>
<p>Thanks for the memory; the &#8220;ragtop&#8221; was the second PC in my arsenal.  The stock LCD was indeed eye-strain-in-a-box.  Knowing that ahead of time, I ordered both the &#8220;super-twist&#8221; display and a CRT.  Also a backpack and the serial- and parallel-port &#8220;slice&#8221;. [1]   The 5150 fed my EPROM burner for a number of years.</p>
<p>I made two productivity enhancements.  First, I added a certain terminate-and-stay-resident (TSR) to every boor diskette that greatly sped up the coffee-grinder diskette drives&#8217; seek time.  I think that TSR originated at Toshiba (or maybe not; some well-known Japanese company at any rate), and one could find it at many a BBS.  Second, I added &#8220;turbo&#8221; to the processor with a DIP oscillator and SPDT toggle.  Switch to standard clock; boot; switch to turbo.</p>
<p>I trashed the whole system when I tired of replacing &#8220;reversed&#8221; NICAD cells.  The only thing I kept was the backpack.  A cyclist, I carry groceries and all manner of other things in it, so I&#8217;m tempted to say that the ($$ optional) backpack has been the most appreciated part of the Convertible.</p>
<hr />
<p>[1] A colleague gave me a new-in-the-box Convertible printer.  (I didn&#8217;t ask how/where he got it.)  It snapped onto the 5150 like the other slices&#8221;.  It was a curious thing, a very pricey, MONO-directional dot-matrix that not only was glacially slow but also consumed very expensive, propriatary, ribbon at an alarming rate.  I immediately cannibalized it for the motor, screws and a few other general use parts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-275711">

			<div class="comment by-nerdicus-baticus ">

				<p class="commentcredit">

					<span class="commenter">Nerdicus Baticus</span> •

					<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/#comment-275711">
						June 12, 2016 9:40 PM					</a>

				</p>

				<p>I once had access to the private FTP server that a certain hardware manufacturer used for their code monkeys to upload drivers and BIOS updates for distribution to their various support websites. I was just given the password without verification of who I was so I could then access a newer BIOS version with updated hardware and memory capacity support from the FTP server. I scanned all the drivers and BIOS versions on the FTP server, starting with the most recent network driver, and found the driver had been injected with a quite versatile Trojan/Worm for it&#8217;s time.</p>
<p>Router manufacturers don&#8217;t bother to patch for most exploits in under a year or mostly they never fix the issue. I don&#8217;t imagine hardware manufacturers are any better at securing who has access to their network assets containing BIOS and driver versions these days either.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2016/06/hijacking_the_p.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2016/06/hijacking_the_p.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F06%2Fhijacking_the_p.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2016/06/hijacking_the_p.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='10513' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2016/06/friday_squid_bl_528.html" rel="prev">← Friday Squid Blogging: Giant Mechanical Squid</a>		<a href="https://www.schneier.com/blog/archives/2016/06/another_side-ch.html" rel="next">Another Side-Channel Attack on PC Encryption →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
