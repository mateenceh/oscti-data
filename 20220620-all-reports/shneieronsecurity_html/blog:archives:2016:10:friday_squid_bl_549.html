<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Friday Squid Blogging: Which Squid Can I Eat? - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Friday Squid Blogging: Which Squid Can I Eat? Comments Feed" href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/10837" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=10837' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F10%2Ffriday_squid_bl_549.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F10%2Ffriday_squid_bl_549.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-10837 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-10837" class="post-10837 post type-post status-publish format-standard hentry category-uncategorized tag-squid">

	<div class="article">

		<h2 class="entry">Friday Squid Blogging: Which Squid Can I Eat?</h2>
		<p>Interesting <a href="https://www.theguardian.com/lifeandstyle/shortcuts/2016/oct/19/squids-out-are-there-any-that-it-is-still-ok-to-eat">article</a> listing the squid species that can still be ethically eaten.</p>
<p>The problem, of course, is that on a restaurant menu it&#8217;s just labeled &#8220;squid.&#8221;</p>
<p>As usual, you can also use this squid post to talk about the security stories in the news that I haven&#8217;t covered.</p>
<p>EDITED TO ADD: By &#8220;ethically,&#8221; I meant that the article discusses which species can be sustainably caught. The article does not address the moral issues of eating squid &#8212; and other cephalapods &#8212; in the first place.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/squid/" rel="tag">squid</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html" rel="bookmark">Posted on October 21, 2016 at 4:00 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html#comments">182 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html" data-title="Friday Squid Blogging: Which Squid Can I Eat?" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-285800">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285800">
						October 21, 2016 4:07 PM					</a>

				</p>

				<p><a href="https://nakedsecurity.sophos.com/2016/10/21/linux-kernel-bug-dirtycow-easyroot-hole-and-what-you-need-to-know/" rel="nofollow ugc">https://nakedsecurity.sophos.com/2016/10/21/linux-kernel-bug-dirtycow-easyroot-hole-and-what-you-need-to-know/</a></p>
<p>Ouch.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285801">

			<div class="comment by-tarquin ">

				<p class="commentcredit">

					<span class="commenter">Tarquin</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285801">
						October 21, 2016 4:14 PM					</a>

				</p>

				<p>The Dirty Cow vulnerability has been present in Linux for nearly 9 years. Here&#8217;s more proof, if needed, that open-source software isn&#8217;t necessarily more secure. Not patching it for such a long period is inexcusable.</p>
<p><a href="http://arstechnica.com/security/2016/10/most-serious-linux-privilege-escalation-bug-ever-is-under-active-exploit/" rel="nofollow ugc">http://arstechnica.com/security/2016/10/most-serious-linux-privilege-escalation-bug-ever-is-under-active-exploit/</a></p>
<p>VeraCrypt, the successor to TrueCrypt, has been audited by QuarksLab. They found:<br />
8 Critical Vulnerabilities<br />
3 Medium Vulnerabilities<br />
15 Low or Informational Vulnerabilities / Concerns</p>
<p><i>&#8220;This public disclosure of these vulnerabilities coincides with the release of VeraCrypt 1.19 which fixes the vast majority of these high priority concerns. Some of these issues have not been fixed due to high complexity for the proposed fixes, but workarounds have been presented in the documentation for VeraCrypt.&#8221;</i></p>
<p><a href="https://ostif.org/the-veracrypt-audit-results/" rel="nofollow ugc">https://ostif.org/the-veracrypt-audit-results/</a><br />
<a href="https://ostif.org/wp-content/uploads/2016/10/VeraCrypt-Audit-Final-for-Public-Release.pdf" rel="nofollow ugc">https://ostif.org/wp-content/uploads/2016/10/VeraCrypt-Audit-Final-for-Public-Release.pdf</a></p>
<p>How private is YOUR messaging app? Charity rates WhatsApp as the most secure &#8211; but experts aren&#8217;t so sure</p>
<p><a href="http://www.dailymail.co.uk/sciencetech/article-3859412/How-private-messaging-app-Charity-rates-WhatsApp-secure-experts-aren-t-sure.html" rel="nofollow ugc">http://www.dailymail.co.uk/sciencetech/article-3859412/How-private-messaging-app-Charity-rates-WhatsApp-secure-experts-aren-t-sure.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285802">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285802">
						October 21, 2016 4:25 PM					</a>

				</p>

				<p>@Nick P @Thoth @Sancho_P @Clive Robinson et. al.</p>
<p>It&#8217;s been six months and the next version of TFC, 0.16.10 is now ready.<br />
<a href="https://github.com/maqp/tfc" rel="nofollow ugc">https://github.com/maqp/tfc</a></p>
<hr />
<p>@NickP IIRC you talked about locally encrypting TFC&#8217;s keys a long time ago. This is now featured. Previously keyfiles were unencrypted files containing the keys changed by hash-ratchet. Group files contained plaintext list of group members, and log files contained the plaintext log.</p>
<p>This is now all different. There&#8217;s a contact database with simple structure that contains accounts, user accounts, nicks, forward secret symmetric message keys, static symmetric hash ratchet counter (harac) header keys, public keys used during key exchange (private keys are ephemeral and discarded after symmetric keys are derived) and some settings like logging (TxM/RxM), file reception and window notification privacy (RxM).<br />
I put extra care into separately padding every data field per contact. There&#8217;s a setting that defines the maximum number of contacts. This is used to pad the number of entries in the database. So the size of database never changes. The entire database is re-encrypted with new nonce after every message. This works fast enough even with gen1 RPi under default settings.</p>
<p>This database padding applies also to groups that now contains the name of group, logging setting and list of members. There are two settings for group: Maximum number of groups and maximum number of members per any group.</p>
<p>These databases can be scaled upwards in size when user adds more and more contacts. There&#8217;s protective logic that prevents down-scaling database size if there&#8217;s more contacts that would be possible after down-scale.</p>
<p>Message log database works a bit differently. Each entry contains padded date, contact information and the message. Number of entries (sent messages is not padded). On the other hand each, all logged messages are written to same database so only max number of sent messages is revealed. Furthermore, the logged data is not the message itself, but the assembly packet delivered to contact. This means the number logged entries reveals no more metadata than what communication over XMPP server reveals. There&#8217;s also an option (disabled by default) to log noise packets during trickle connection (constant transmission). This hides even the max number of actual messages sent. Sent files might be more sensitive than the discussion so the file itself is never logged, only placeholder data.</p>
<p>SSH password used to connect to RPi for HWRNG sampling is no longer stored in plaintext, but is padded and encrypted to separate file.</p>
<p>All this data is encrypted with master key derived from master password (created when software first starts up). The password is combined with urandom spawned 256-bit salt and derived through PBKDF2-HMAC-SHA256 over at least 65536 iterations, but if hardware is fast enough, the number will double until it takes at least 2000ms. The master key is entered into new animated login screen written on curses.</p>
<p>The encryption adds some protection against physical attacker, protects from impersonation, mitigates the wear leveling problem and makes data exfiltration harder.</p>
<p>PSKs are also password+salt protected over 65536 iterations.</p>
<hr />
<p>The trickle connection design is much better: Tx.py uses constant time list lookups to determine highest priority queue to load data from, plus a new constant time context manager. Together they should hide runtime much better. All data given to the sender process via queues is pre-padded. Trickle connection works for groups, and I finally got the messages and commands to take turns reliably.</p>
<hr />
<p>TFC can now use multiple accounts in Pidgin. This hides the network of communicating accounts from servers to some extent when each user can route messages via multiple servers.</p>
<hr />
<p>Previously the hash ratchet counter used for forward secrecy has been an unauthenticated public value. Now it&#8217;s encrypted with static key that&#8217;s either a separate PSK or key domain separated from ECDHE shared secret.</p>
<hr />
<p>The data structure of transferred data has much less headroom (e.g. base64 encoding over serial was unnecessary).</p>
<hr />
<p>The protocol is now much cleaner and there&#8217;s clearer abstractions between layers.</p>
<hr />
<p>TFC no longer uses one window to display all sent and received messages. Selecting a contact/group now sends encrypted command to RxM to display the chat log for that person.</p>
<p>Messages per session are ephemeral. Logged messages can be viewed with command /history or exported in plaintext with /export. Screen can still be cleared with /clear and returned with /msg Alice. There&#8217;s a new command called /reset that resets each terminal and removes the ephemeral message history (it&#8217;s essentially shoulder surfing protection on steroids) from Rx.py.</p>
<hr />
<p>The public keys and local key&#8217;s key decryption key that are typed manually now use Bitcoin&#8217;s Wallet Import Format that&#8217;s Base58 for convenient manual typing, and it comes with integrated SHA256 based checksum.</p>
<hr />
<p>Whenever user manages a group (creates it, adds/removes from it or deletes it), Tx.py asks to send a message about it to related contacts so that they can manage their groups as well. As spoofing the message about leaving the group could be used nefariously, software of recipients displays a warning about the contact still being able to receive messages they send to group.</p>
<hr />
<p>The local testing feature is completely re-designed. It now uses Terminator as mux to launch all software (aside IM client) adjacent to one another. Installer creates two launchers (TFC and TFC DD) where the latter launches the dd.py data diode visualizer proxy software to relay messages between Tx.py/Rx.py and NH.py.</p>
<p>The /names command now shows key exchange and logging setting and when it&#8217;s printed during start. Contact can no longer be selected with the ID number but with account or nick (tab complete supported). Group can finally be selected from main menu.</p>
<hr />
<p>I fixed the screen clearing issue with Ubuntu 16 by moving from os.system(&#8220;clear&#8221;) to VT100 codes that allowed for much more interactive feel to many prompts.</p>
<hr />
<p>The code quality is much much better and there&#8217;s a significant amount of more unit tests. (A month&#8217;s worth of effort in one sentence.)</p>
<hr />
<p>The serial interfacing is much better. I noticed 19200 bauds was stable with current data diode design so I doubled the speed. In case there&#8217;s any problems, there&#8217;s now a user adjustable Reed-Solomon erasure code that&#8217;s used during serial transmissions.</p>
<p>The removal of serial interfaces no longer crash the programs (they now scan for the adapter instead), and any random device name mappings (e.g. /dev/ttyUSB0 &gt; /dev/ttyUSB2) are automatically handled. NH.py can even solve user moving serial cables to opposing ends provided user sends any message from TxM so NH can learn about the change.</p>
<p>RPi 3 moved serial interface from /dev/ttyAMA0 to /dev/serial0, that&#8217;s fixed too. Raspbian&#8217;s Kernel maps this file correctly to serial, agnostic of underlying RPi version (AMA0 is now bluetooth under RPi3).</p>
<hr />
<p>Tx.py now shows HWRNG sampling progress in real time over SSH.</p>
<hr />
<p>The installer is a lot easier to use. Raspbian configurations are no longer displayed when launched on *ubuntu/Mint. There&#8217;s a set of interactive prompts.</p>
<p>Installer randomizes the order in which dependencies are downloaded.</p>
<p>Apt-get was changed to newer version &#8212; Apt.</p>
<p>Installer can now automatically configure static IP for TxM and HWRNG configurations so HWRNG use is easy. Local testing has interactive setup for IP and user name of HWRNG (settings are stored to Tx.py).</p>
<hr />
<p>Most (if not all) of the 3D models in documentation were updated to cleaner, minimalistic style.</p>
<p>There&#8217;s now a brand new Wiki with articles on threat model, security design, protocol, HW configurations, installation and how to use the software. There&#8217;s a FAQ, and brand new set of step-by-step tutorials on how to build HWRNG on perfboard and breadboard, and how to build data diode either point-to-point, or on a perfboard so that it uses two DC power supplies. The security design is the most detailed one and combines thoughts I expressed in blog and some discussions here. It still needs some work but maybe we can now start discussing the terminology and overall design. Protocol needs some attention too.</p>
<p>The whitepaper is something that&#8217;s going to take time to write so that&#8217;ll have to wait. It&#8217;ll most likely summarize the more detailed articles in Wiki so no need to wait for that to get to work.</p>
<hr />
<p>This is just to summarize the key features. The rest is in the update log:</p>
<p><a href="https://github.com/maqp/tfc/wiki/Update-Log" rel="nofollow ugc">https://github.com/maqp/tfc/wiki/Update-Log</a></p>
<hr />
<p>I hope you&#8217;ll find the time to test the software. I made it particularly easy for this purpose. Just run</p>
<p>sudo echo &amp;&amp; wget <a href="https://raw.githubusercontent.com/maqp/tfc/master/setup.py" rel="nofollow ugc">https://raw.githubusercontent.com/maqp/tfc/master/setup.py</a> &amp;&amp; sudo python setup.py 4</p>
<p>under Ubuntu virtual machine to get started with the local testing software. Let me know what you think.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285803">

			<div class="comment by-annoyed-users ">

				<p class="commentcredit">

					<span class="commenter">Annoyed Users</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285803">
						October 21, 2016 4:34 PM					</a>

				</p>

				<p>@Moderator</p>
<p>Is there something that can be done about excessively long &#8220;comments&#8221;? The post above is not a comment, it is a blog post at almost 1500 words. It will make it difficult to read all the other comments because it requires so much scrolling.</p>
<p>TIA</p>
<p>Annoyed User</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285804">

			<div class="comment by-pedro ">

				<p class="commentcredit">

					<span class="commenter">Pedro</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285804">
						October 21, 2016 4:36 PM					</a>

				</p>

				<p>En Argentina diputados aprobó el Voto Electrónico (e-vote) ahora falta que lo apruebe la cámara de Senadores y saldrá la ley. Quieren implementarlo en 2017.</p>
<p>Fue una promesa del actual presidente de la Nación y es reticente a cualquier crítica, poniendo en juego la garantía constitucional del secreto del voto de todos los ciudadanos (y probablemente un buen negocio para unos pocos).</p>
<p>Ignoraron absolutamente las observaciones de los expertos,<br />
quieren implementar un sistema donde se imprime el voto en una boleta y también se graba en un chip RFID que se encuentra en ella.</p>
<p>El proyecto de ley (que se aprobó a las 04 AM en el recinto de diputados, fue aprobado por gran mayoría -impulsado por el oficialismo-), incorpora PENALIDADES DE PRISIÓN a los investigadores que traten de entender como funciona la máquina de voto electrónico.</p>
<p>Hace un año un investigador (Joaquín Sorianello) se le allanó la casa y se le secuestraron sus computadoras y tuvo un proceso penal por haber encontrado LOS CERTIFICADOS SSL PÚBLICOS EN INTERNET Y REPORTARLOS A LA EMPRESA. Finalmente la justicia determino que su conducta lejos de ser considerada un delito representa un ciudadano alerta.</p>
<p>Existen múltiples personas que encontraron vulnerabilidades en el sistema incluso mostradas en congresos de seguridad (ejemplo: Ekoparty 2015) como la vulnerabilidad MultiVoto que permitía incorporar múltiples votos en una misma boleta probada y verificada (descubierta por el Dr. Alfredo Ortega, quién también en una exposición en diputados mostró como accedió a la base de datos del sitio de la Cámara de Diputados mediante un SQLInjection).</p>
<p>Investigación independiente (<em>excelent paper</em>): <a href="http://ivan.barreraoro.com.ar/vot-ar-una-mala-eleccion/" rel="nofollow ugc">http://ivan.barreraoro.com.ar/vot-ar-una-mala-eleccion/</a></p>
<p>MultiVoto: <a href="http://www.elladodelmal.com/2015/07/como-votar-multiples-veces-con-el.html" rel="nofollow ugc">http://www.elladodelmal.com/2015/07/como-votar-multiples-veces-con-el.html</a></p>
<p>Subsistemas del Voto Electrónico implementado en 2015 en la Ciudad Autónoma de Buenos Aires en 2015 (sistema muy similar que se quiere implementar a nivel nacional ahora): <a href="https://blog.smaldone.com.ar/2015/07/15/el-sistema-oculto-en-las-maquinas-de-vot-ar/" rel="nofollow ugc">https://blog.smaldone.com.ar/2015/07/15/el-sistema-oculto-en-las-maquinas-de-vot-ar/</a></p>
<p>Nota de HOY con videos de demostraciones: <a href="http://www.lanacion.com.ar/1948796-la-boleta-unica-electronica-implica-riesgos-para-el-secreto-del-voto" rel="nofollow ugc">http://www.lanacion.com.ar/1948796-la-boleta-unica-electronica-implica-riesgos-para-el-secreto-del-voto</a></p>
<p>Por favor quien quiera traduzca este comentario, copielo, comentelo, denle visibilidad. Muchas gracias.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285805">

			<div class="comment by-ram ">

				<p class="commentcredit">

					<span class="commenter">Ram</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285805">
						October 21, 2016 4:54 PM					</a>

				</p>

				<p>No squid can be ethically eaten &#8211; they are smart and should not be eaten unless necessary for life.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-mod even thread-even depth-1" id="comment-285806">

			<div class="comment by-moderator official">

				<p class="commentcredit">

					<span class="commenter">Moderator</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285806">
						October 21, 2016 5:04 PM					</a>

				</p>

				<p>@Annoyed: The Friday squid post is for open discussion of security-related matters. Markus&#8217;s post qualifies; it is the continuation of an extended conversation (involving the individuals noted at the head of the comment, and others) about Tinfoil Chat, an encrypted messaging system. It&#8217;s long, but it&#8217;s relevant, and it&#8217;s in the right place. If you&#8217;re not interested in reading it, please keep scrolling.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285807">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285807">
						October 21, 2016 5:23 PM					</a>

				</p>

				<p>@Annoyed Users</p>
<p>The longish post summarizes more than thousand hours of work I&#8217;ve put since May to give endpoint secure messaging free to everyone. Like the moderator said, it&#8217;s been discussed extensively with many people who discuss here. I hope you&#8217;ll find it useful, take part in the discussion and maybe even contribute to the project.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285808">

			<div class="comment by-annoyed-user ">

				<p class="commentcredit">

					<span class="commenter">Annoyed User</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285808">
						October 21, 2016 5:26 PM					</a>

				</p>

				<p>@Moderator</p>
<p>Bruce has many readers but as of this date I will no longer be one of them. Whether you like it or not the effective impact of these excessively long posts is to drown out and silence other voices. I come here to listen, not to make myself heard, but if all I hear and the same person babbling there is no point to me coming. I can listen else where. Good luck,</p>
<p>Annoyed User</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285809">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285809">
						October 21, 2016 5:58 PM					</a>

				</p>

				<p>Annoyed User</p>
<p>In the couple of weeks I&#8217;m here Markus Ottela has posted less than a dozen times, I think even less than 5 times, and only 1 of his posts was longer than what&#8217;s usual here.</p>
<p>Moreover, he hasn&#8217;t blabbered but reported on actual work in our general field of interest here. How could that be an annoyance? In the universe I live in actual work and technical reports on it are <em>welcome</em>.</p>
<p>The annoyance, pardon me, are you. If people like Markus Ottela stopped writing here in any length they deem adequate, I&#8217;d take that as a loss.</p>
<p>As for you: bon voyage.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285810">

			<div class="comment by-harold-thomas-martin ">

				<p class="commentcredit">

					<span class="commenter">Harold Thomas Martin</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285810">
						October 21, 2016 6:02 PM					</a>

				</p>

				<p>For the How Stupid Do They Think We Are archive:</p>
<p>The RUSSIAN HACKER!!!!1! turns out to be a hacker who&#8217;s Russian. Because there&#8217;s nobody less obvious the FSB could pay to hack defenseless Democrat chumps. And because nobody would hack helpless incompetent Democrats just for shits &amp; grins. And because FSB couldn&#8217;t wait ten seconds for 30 thousand stoned adolescents to bust the DNC&#8217;s tender maidenhead. Because what Eugene got busted for is undisclosed, but obviously that.</p>
<p><a href="http://theins.ru/news/34012" rel="nofollow ugc">http://theins.ru/news/34012</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285811">

			<div class="comment by-c ">

				<p class="commentcredit">

					<span class="commenter">C</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285811">
						October 21, 2016 6:08 PM					</a>

				</p>

				<p>Hey Bruce,</p>
<p>The post you linked to doesn&#8217;t talk about ethics: it talks about conservation status.  There is hardly a connection. It&#8217;s upsetting enough that you alternate between &#8220;squids are so smart, they can do xyz&#8221; and &#8220;5 favorite squid recipes&#8221; in your Friday posts; please don&#8217;t start mistaking environmental protection with ethics — it&#8217;s not ethical to slaughter sentient beings for food when other options are available.</p>
<p>In any case, it&#8217;s easy to avoid eating the endangered ones: simply stop eating squid 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285812">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285812">
						October 21, 2016 6:15 PM					</a>

				</p>

				<p>@ Ram,</p>
<blockquote><p>&#8230; they are smart and should not be eaten unless necessary for life.</p></blockquote>
<p>Some species such as the Humboldt, have become ecological disasters. Short of just ignoring the problem, fishing them for food has kept their numbers under some kind of control.</p>
<p>In more recent times the increase in disolved carbon doxide in the water due to climatic changed has made this voracious always hungry predator slower thus more vulnerable. However they are pack hunters and form shoals of upto a thousand individuals and devour entire shoals of fish. The diminishing fish stocks and increasing numbers have caused the Humboldt to increase the scope of it&#8217;s food sources and are thus destroying entire ecologies. Traditional hand line fishing of these six foot monsters called localy as diablo rojo (red devils) is an extremely risky business and fishermen get regularly injured or killed. Likewise divers that are in the vicinity of Humboldt have been seriously injured even though they did not provoke them.</p>
<p>But Humboldt are just one of very many species, many of which are still in balance within their environment, so not all need to be predated as a human food source.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285813">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285813">
						October 21, 2016 6:22 PM					</a>

				</p>

				<p>Markus Ottela</p>
<p>Some remarks.</p>
<ul>
<li>While I consider NaCl an excellent choice it might be desirable to provide a fallback and to not put all eggs into one basket.</li>
<li>sampling (i.a.) random through SSH over ethernet seems to be an inconsistency actually weakening your design. It might be worthwhile to use NaCl there, too.</li>
<li>PBKDF2-*? From what I understand that is mainly used in contexts that require it  (e.g. smartcards). Wouldn&#8217;t there be more attractive KDFs/Hash ratchets (e.g. Argon2 (PHC winner))?</li>
<li>You might want to look into mypy (<a href="http://mypy-lang.org" rel="nofollow ugc">http://mypy-lang.org</a>) which allows &#8220;lite type annotations&#8221;.</li>
</ul>
<p>Compliments for your work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285814">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285814">
						October 21, 2016 6:39 PM					</a>

				</p>

				<p>@ Marcus,</p>
<blockquote><p>The longish post summarizes more than thousand hours of work I&#8217;ve put [in] since May to give endpoint secure messaging free to everyone.</p></blockquote>
<p>That is over &#8220;fulltime employment&#8221; hours, and is much appreciated by a number of us here (some of whom would like to be able to put in the same level of effort in our own non-employment coding projects).</p>
<p>Saying something like &#8220;keep up the good work&#8221; etc does not sound right, so hopefully a &#8220;well done&#8221; will sound better.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285815">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285815">
						October 21, 2016 8:07 PM					</a>

				</p>

				<p>@all<br />
It is quite sad to see some readers putting themselves in the center thinking that by saying they wouldn&#8217;t read @Bruce Schneier&#8217;s blog because we posted some long posts and it requires scrolling would be meaningful or helpful.</p>
<p>These people have no idea how much time is spent drafting a long post jam packed with all these useful insights and important development notes released by some of us who are doing practically free and open source security development which not many would be willing to burn their weekends and pull their hairs out over it.</p>
<p>Please be more empathic to how we feel putting the effort to write highly informative information that you won&#8217;t find lying around on the Internet and to include progress notes   of practical security development we do in our free time vs. that few seconds of frustration while scrolling through the long pages. I believe a few of us are using smartphones to access the contents and have to scroll through the long amount of posts and  some of us have to type on tiny little smartphone screens to reply (and sometimes in a long winded fashion out of necessity).</p>
<p>If scrolling is too troublesome, then this is a wrong place to be in. Expect tonnes of scrolling and be more empathic to those of us who have lots to say with important contents to publish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285816">

			<div class="comment by-drone ">

				<p class="commentcredit">

					<span class="commenter">Drone</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285816">
						October 21, 2016 8:09 PM					</a>

				</p>

				<p>&#8220;&#8230;listing the squid species that can still be ethically eaten.&#8221;</p>
<p>How &#8217;bout a list of squid species that can ethically eat humans?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285817">

			<div class="comment by-andrew-smith ">

				<p class="commentcredit">

					<span class="commenter">Andrew Smith</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285817">
						October 21, 2016 8:30 PM					</a>

				</p>

				<p>Bruce,</p>
<p>Was today a harbinger?</p>
<p><a href="https://www.schneier.com/blog/archives/2016/09/someone_is_lear.html" rel="nofollow ugc">https://www.schneier.com/blog/archives/2016/09/someone_is_lear.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285818">

			<div class="comment by-rubicon ">

				<p class="commentcredit">

					<span class="commenter">Rubicon</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285818">
						October 21, 2016 9:42 PM					</a>

				</p>

				<p>Google is the latest tech company to drop the longstanding wall between anonymous online ad tracking and user’s names:</p>
<p><a href="https://www.propublica.org/article/google-has-quietly-dropped-ban-on-personally-identifiable-web-tracking" rel="nofollow ugc">https://www.propublica.org/article/google-has-quietly-dropped-ban-on-personally-identifiable-web-tracking</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285819">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285819">
						October 22, 2016 12:30 AM					</a>

				</p>

				<p>@Markus Ottela<br />
Regarding Yubikeys which you mentioned in your change log:</p>
<p>&#8220;No magical crypto dust exists to protect from this so make sure to use strong passphrases and possibly 2FA with something like Yubikey, that remembers a static part of the passphrase&#8221;</p>
<p>Nice way of putting it by the way 🙂 .</p>
<p>Now for the Yubikey part, I have an idea how to make some magical crypto dust via some magical crypto token 🙂 &#8230; or more of an illusionary one that looks magical &#8230;</p>
<p>If you remember how Android OS does it&#8217;s Full Disk Encryption with Qualcomm&#8217;s QSEE hardware backed Keymaster, the hardware backed Keymaster stores an RSA private key which is used to sign a user entered PIN or Password and the signature is then put through some process to shorten it to whatever key length the Android OS FDE system wants. Essentially the signature is hashed to the key length to put it very simply.</p>
<p>What are the features Yubikeys have:<br />
 &#8211; HOTP<br />
 &#8211; PIV (Smart card login)<br />
 &#8211; FIDO U2F 2FA<br />
 &#8211; OpenPGP smart card</p>
<p>It now becomes very apparent that there are 3 options that enable smart card based secure key storage of an RSA 2048 bit key inside the smart card chip of a Yubikey. Those are the PIV, FIDO and OpenPGP applets.</p>
<p>The Android FDE technique can be emulated in this context by using either one of these three smart card applet found in a Yubikey token to store an RSA private key that will sign the user derived PBKDF hash and then the 2048-bit signature would be hashed to derive a 256-bit key for use.</p>
<p>It can be represented as:</p>
<p>CryptoKey = Hash(RSA2048Sign(HardwarePrivateKey, PBKDF2(Hash, UserPassword)))</p>
<p>This ensures that a &#8220;What You Have&#8221; and &#8220;What You Know&#8221; exist at the same time to provide a strong cryptographic protection. Even if the password is weak, the attacker will need a tamper resistant hardware protected private key to derive the decryption keys.</p>
<p>There are three applets in Yubikey and which of them is the most suitable applet to invoke to get the job done.</p>
<p>PIV applet:<br />
 &#8211; It is used in Windows login and Governmental stuff but it is rarely used in a normal user setting and is complex if you want to use this stuff. It requires reading thousands of pages of PIV document by NIST FIPS 201 and other accompanying standard linked below to understand how to get this stuff working.</p>
<p>OpenPGP applet:<br />
 &#8211; This is one of the better choice but the problem is OpenPGP specification only allows a single keyset in it&#8217;s applet. Users might want to segregate their email security keys from their TFC security keys.</p>
<p>Due to how OpenPGP works, an OpenPGP keyset is made up of three pieces of keys. One for decryption, one for signing and one for authentication but all of them are simply RSA-2048 bit keys at the end of the day. You can specifically decide to only use one of the keys to perform an RSA operation if you want to but another problem appears which is smart card PIN. In order to execute a security operation, the user have to submit a smart card PIN to operate the RSA keys and now the user not only has to know his weak password, he needs to remember his PIN.</p>
<p>Methods can be used to derive a smart card PIN from the hashed password but that means when a user wants to independently operate the OpenPGP applet from the Yubikey, the user must know how to derive the weak password into the hashed password and then into the smart card PIN which is a pain but this surely provides much better security when compared to the next method I am below.</p>
<p>FIDO U2F 2FA applet:<br />
 &#8211; You do not need a PIN to operate the FIDO U2F applet because that&#8217;s part of the specifications. All you need to do is press the golden button found on the Yubikey to activate the RSA key operation. The reason PINs are not required is it&#8217;s primary role as a &#8220;What You Have&#8221; to complement the already existing &#8220;What You Know&#8221; and the FIDO U2F does exactly what it was intended very well.</p>
<p>Another plus point is the FIDO U2F applet is allowed to create unlimited amounts of cryptographic keys and the FIDO keys are NOT RSA-2048 but NIST/NSA Suite B ECDSA P-256 keys as per the FIDO standards. Now, someone might be shouting loudly &#8220;BACKDOOR SPOTTED&#8221; and before yelling that, chill and listen. You have to figure out the P-256 key and you have to be able to reverse the hash function on the signature to be of any use at all from the above algorithm I have given.</p>
<p>The FIDO U2F applet can allow unlimited keys because the U2F specification have a provision for derived or wrapped key offloading where the smart card / Yubikey will house a master secret key to derive or wrap the P-256 key which the garbled P-256 key material would then be exported since it is not a live key anymore. Yubikeys take the path of using it&#8217;s internal HMAC-SHA256 algorithm to be combined with unique nonces to derive the unique P-256 key which is much more secure than using AES to encrypt the P-256 key (in my opinion). Linked below includes the Yubikey&#8217;s U2F key derivation method. Whatever that is offloaded during the creation of the unique P-256 are actually unique nonces which are by themselves not sensitive unless somehow the Yubikey&#8217;s master HMAC key for the FIDO applet can be extracted from the tamper resistant smart card chip inside the Yubikey and the master HMAC key for each Yubikey device is uniquely generated to ensure that the compromise of one Yubikey is not going to affect another Yubikey if the smart card&#8217;s tamper resistant barriers and sensors somehow becomes breached and reverse engineered successfully.</p>
<p>Without needing to remember additional PIN (except for a button press on the golden button), the user can use the FIDO applet to create a unique P-256 signing key which during the process will offload it&#8217;s unique nonce and public key certificate. You can store the public information together with the encrypted database and if you need so, you can sign the encrypted database and public cryptographic information itself with the P-256 key to detect tampering with the ease of a golden button press on the Yubikey token.</p>
<p>The FIDO U2F smart card APDU protocol (use to connect to the Yubikey applets) are open standards and Yubikey being a FIDO certified device must implement the standards. I have linked the FIDO U2F APDU protocol below and from the protocol, it&#8217;s very simple with only 3 request message formats (look for XXXXXX Request XXX under Chapter 6) which are Registration type (key generation operation), Authentication type (signing operation) and Version querying type (theoretically 🙂 ).</p>
<p>Comparing all the options available above, FIDO U2F is the better choice to create a hardware secured private key as part of the &#8220;magic sauce&#8221; to protect a weak user password from being bruteforced as long as the Yubikey token is secured.</p>
<p>On top of that, I have a couple of spare Yubikeys sitting around, so if you want help for the Yubikey/FIDO portion, you can drop me a message.</p>
<p>Links:<br />
 &#8211; <a href="http://csrc.nist.gov/groups/SNS/piv/standards.html" rel="nofollow ugc">http://csrc.nist.gov/groups/SNS/piv/standards.html</a><br />
 &#8211; <a href="https://www.yubico.com/2014/11/yubicos-u2f-key-wrapping/" rel="nofollow ugc">https://www.yubico.com/2014/11/yubicos-u2f-key-wrapping/</a><br />
 &#8211; <a href="https://fidoalliance.org/specs/fido-u2f-usb-framing-of-apdus-v1.0-rd-20140209.pdf" rel="nofollow ugc">https://fidoalliance.org/specs/fido-u2f-usb-framing-of-apdus-v1.0-rd-20140209.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285820">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285820">
						October 22, 2016 12:31 AM					</a>

				</p>

				<p>@Markus Ottela<br />
To add to the above, if using FIDO U2F applet for private key, the algorithm I offered have to be updated to:</p>
<p>CryptoKey = Hash(ECDSA-P256-Sign(HardwarePrivateKey, PBKDF2(Hash, UserPassword)))</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285821">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285821">
						October 22, 2016 12:48 AM					</a>

				</p>

				<p>Google or maybe Alphabet, is less concerned with respecting people&#8217;s privacy as I understand it:</p>
<p>&#8220;Google Has Quietly Dropped Ban on Personally Identifiable Web Tracking&#8221;<br />
<a href="https://www.propublica.org/article/google-has-quietly-dropped-ban-on-personally-identifiable-web-tracking" rel="nofollow ugc">https://www.propublica.org/article/google-has-quietly-dropped-ban-on-personally-identifiable-web-tracking</a></p>
<p>&#8220;But this summer, Google quietly erased that last privacy line in the sand – literally crossing out the lines in its privacy policy that promised to keep the two pots of data separate by default. In its place, Google substituted new language that says browsing habits “may be” combined with what the company learns from the use Gmail and other tools.&#8221;</p>
<p>&#8220;The practical result of the change is that the DoubleClick ads that follow people around on the web may now be customized to them based on your name and other information Google knows about you. It also means that Google could now, if it wished to, build a complete portrait of a user by name, based on everything they write in email, every website they visit and the searches they conduct.&#8221;</p>
<p>I stopped having anything to do with Google a long time ago: No Youtube account, no Gmail account, not using Google Chrome browser. I hope I haven&#8217;t missed anything.</p>
<p>Hrm, I must try set up some Linux machine before Microsoft screws me over. This costs money and I don&#8217;t want to repurpose my pc desktop (maybe a laptop with a big screen could be interesting), it is a little bit confusing to me (have done it before though) and I don&#8217;t really trust linux os that much either.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285822">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285822">
						October 22, 2016 1:35 AM					</a>

				</p>

				<p>@Curious<br />
Privacy and tracking are two opposing business models. They cannot be put together as this is what happens. The business of offense/tracking has higher short term payout so that is where Google will focus on unsurprisingly.</p>
<p>You should mot wait for such situations to setup Linux. It should be done long time ago as part of privacy and security enhancing routines.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285823">

			<div class="comment by-volt ">

				<p class="commentcredit">

					<span class="commenter">Volt</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285823">
						October 22, 2016 3:20 AM					</a>

				</p>

				<p>@Curious<br />
If not trusting Linux is a reason for you to stick with Microsoft, you&#8217;re either lacking in knowledge about either or both, or there&#8217;s an opportunity for you to recognize you&#8217;ve made up an excuse.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285824">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285824">
						October 22, 2016 3:37 AM					</a>

				</p>

				<p>@Volt</p>
<p>Haha, good point. I just don&#8217;t feel fulfilled in desiring Linux is all I wanted to say I guess.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285825">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285825">
						October 22, 2016 5:34 AM					</a>

				</p>

				<p>@Markus Ottela<br />
I was looking through the FIDO documentations and despite the commands being simple, it is difficult to manipulate it&#8217;s signing feature for use as a hardware protected brute-force prevention mechanism for the What You Have factor in 2FA.</p>
<p>I decided to spin up my own Smart Card Root Of Trust (SCROT) scheme below that is easily workable on many smartcards available on the market as long as you buy one with AES-256-CBC.</p>
<p>SCROT operates as a hardware-based Root of Trust where it is used in an authentication scheme that requires a What You Know and What You Have. The SCROT contains an AES-256 bit key that is corresponding to the What You Have factor in the form of a Smart Card or Secure Element running JavaCard.</p>
<p>SCROT works with a What You Know factor in the form of a user supplied secret byte string  (i.e. hashed passwords or keys) and during the registration phase, the user supplied secret byte string with a limit of 200 bytes would be hashed and stored as a PIN using SHA-256 hashing. A randomly generated AES-256 bit key would be generated and stored nothing exportable.</p>
<p>When a user intends to authenticate, to perform the Root of Trust key mixing operation, the user has to supply the same secret byte string (max of 200 bytes) used when creating the ROT derived key for authentication. During the creation of the ROT master key, the user may set flags to specify whether there will be limitations on failed authentication which will result in CSP wiping or whether to allow unlimited authentication tries. If authentication limitation flag is set to TRUE, user may set the amount of retries in a single connected session before the CSP wipes itself if failure is detected.</p>
<p>The hardware secured AES-256 bit key would be used as an encryption key to encrypt the user supplied secret and padded with zero bytes until it satisfy the block length (16 bytes) for AES and the resulting ciphertext would be SHA-256 hashed to derive a final 256-bit key. The AES cipher mode will be CBC mode of operation with 16 bytes of zeroes as the IV.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285826">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285826">
						October 22, 2016 6:11 AM					</a>

				</p>

				<p>@Figureitout<br />
I have managed to glue the decryption command handling on the Java desktop client side up and now I have the decryption timing.</p>
<p>345 KB file decrypted within 137582ms which is 2.5 minutes which is a little slower than encryption since I include a &#8220;implicit checksum&#8221; flag which is some sort of internal security mechanism in the GroggyBox scheme. The flag must be enabled for decryption if encryption uses it and vice versa but that should not be too breaking (speed wise). I guess we can safely settle on the speed of about 2+ minutes for something around 345 KB.</p>
<p>Very delighted to know that the decryption and encryption logic are working after all these efforts spent on integration between both desktop client and the Java Card applet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285827">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285827">
						October 22, 2016 6:16 AM					</a>

				</p>

				<p>@ Thoth,</p>
<blockquote><p>I decided to spin up my own Smart Card Root Of Trust (SCROT) </p></blockquote>
<p>A word to the wise, &#8220;SCROT&#8221; is not a good name&#8230; It&#8217;s a slang word to refer to a male delinquent implying worse behavior than a &#8220;Yob&#8221;.</p>
<p>Yob is derived from &#8220;a backwards boy&#8221; and &#8220;scrot&#8221; is derived from various derisive comments about a part of the male anatomy&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285828">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285828">
						October 22, 2016 6:42 AM					</a>

				</p>

				<p>&#8220;Indiscreet Logs: Persistent Diffie-Hellman Backdoors in TLS&#8221;<br />
<a href="https://eprint.iacr.org/2016/999" rel="nofollow ugc">https://eprint.iacr.org/2016/999</a></p>
<p>&#8220;We conducted an investigation of discrete logarithm domain parameters in use across the Internet and discovered evidence of a multitude of potentially backdoored moduli of unknown order in TLS and STARTTLS spanning numerous countries, organizations, and protocols. Although our disclosures resulted in a number of organizations taking down suspicious parameters, we argue the potential for TLS backdoors is systematic and will persist until either until better parameter hygiene is taken up by the community, or finite field based cryptography is eliminated altogether.&#8221;</p>
<p>Not sure if anyone linked to this in the previous days on this website.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285829">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285829">
						October 22, 2016 6:43 AM					</a>

				</p>

				<p>@ Bruce,</p>
<p>With regards the Grauniad article on squid, I&#8217;m not sure they have the correct view of things (butvI don&#8217;t have the time to do a full research document triage).</p>
<p>This is from a few years ago,</p>
<p><a href="http://www.pnas.org/content/104/31/12948.full" rel="nofollow ugc">http://www.pnas.org/content/104/31/12948.full</a></p>
<p>And indicates despite increased fishing, their had been an increase in range and habitat damage by the Humboldt Squid for the preceding decade and a half, and was actively destroying the Hake fish stocks which was the primary economic source in those areas being invaded.</p>
<p>I know the Humboldt is short lived and the research document is several of it&#8217;s generations old but it would require a significant event or change to reverse that growth trend.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285830">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285830">
						October 22, 2016 6:46 AM					</a>

				</p>

				<p>@Clive Robinson<br />
I didn&#8217;t even think about that&#8230; lol.</p>
<p>Was just using the boring convention of most developers to use acronymns of concepts as a name.</p>
<p>Oh well, give me some ideas for a name that would sound nice and simple.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285831">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285831">
						October 22, 2016 7:19 AM					</a>

				</p>

				<p>@Curious<br />
re: Indiscreet Logs: Persistent Diffie-Hellman Backdoors in TLS</p>
<p>Stick to the tried and tested DH groups (MODP/RFC3526 and Oakley) for now. The main problem is getting your browser to detect weak or problematic groups and then weed them out. You don&#8217;t really have fine grain control of your own browser and this makes the problem even worst.</p>
<p>The way forward would be to standardize a set of tried and true DH groups for those who are still using DH.</p>
<p>Another method is to have a long term RSA signing key and for a single session, you generate a random pre-master RSA session key and use the long term RSA signing key to sign the session pre-master RSA key. The pre-master RSA key would encrypt 24 bytes of nonce and send to the destination (assuming the destination also sends their signed RSA pre-master session public keys) which they would also encrypt with their own pre-master RSA key to send their own 24 bytes nonce.</p>
<p>Both sides combine the two pieces of 24 bytes nonce into a complete 48 byte nonce and the first 32 byte is used as the session 256-bit encryption key and the last 16 bytes are used as the session 128-bit HMAC key. Once the secure session is finally established, the pre-master RSA keys are discarded (wipe memory buffer) and use have a sort of RSA-based Forward Secrecy scheme (kinda like DH but not DH).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285832">

			<div class="comment by-europe-vs-american-models ">

				<p class="commentcredit">

					<span class="commenter">Europe vs American Models</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285832">
						October 22, 2016 7:27 AM					</a>

				</p>

				<p>EU<br />
Crusader Margrethe Vestager, the Danish head of the EU’s competition division, has been dropping hints about a new front against Silicon Valley. She’s scrutinizing how companies’ stockpiles of data might breach antitrust or merger rules. Meanwhile, privacy rules the EU passed this year will give authorities across the region broad powers to investigate and fine companies that don’t seek consent before collecting user data. “Europeans are much more sensitive to the idea of exploitation of their personal data and much less inclined to buy into the social contract where we get a service for ‘free’ by paying for it with our personal data,” says Van Someren, the investor.</p>
<p>On the the U.S. approach is to let tech companies go wild with (as Wikileaks reveals) Google Schimdt and Facebook writing White House tech policy.<br />
<a href="http://www.bloomberg.com/news/articles/2016-10-20/silicon-valley-s-miserable-euro-trip-is-just-getting-started" rel="nofollow ugc">http://www.bloomberg.com/news/articles/2016-10-20/silicon-valley-s-miserable-euro-trip-is-just-getting-started</a></p>
<p>America<br />
People with conscience and morals used to run America. Now its tax dodging, profit minded Wall St backed corporations using big-data to crush competition.  As Curious states, they are becoming evermore intrusive and literally push or force themselves upon clueless, addicted, lazy Americans:<br />
<a href="http://www.theatlantic.com/technology/archive/2016/10/incessant-consumer-surveillance-is-leaking-into-physical-stores/504821/" rel="nofollow ugc">http://www.theatlantic.com/technology/archive/2016/10/incessant-consumer-surveillance-is-leaking-into-physical-stores/504821/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285833">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285833">
						October 22, 2016 8:50 AM					</a>

				</p>

				<p>In Germany a new intelligence law for the BND was passed.</p>
<p>They did it like GHCQ, just legalized all snooping formally, knowing that German constitutional court will not accept it like that. But this will takes years to get fix. 🙂</p>
<p>&#8220;Reporters Without Borders (RSF) is appalled by the adoption of the reform bill on the German foreign intelligence agency (BND) in the German Bundestag today. With the reform bill, the ruling coalition wants to allow surveillance of foreign journalists abroad by the BND and thus to legalize a severe breach of the fundamental rights to freedom of expression and freedom of press.<br />
&#8230;</p>
<p>Today the German Bundestag has passed the law without any noteworthy amendments. As a consequence, the BND has the explicit right to spy without restrictions on non-EU journalists, as long as this is deemed to serve Germany’s political interests.</p>
<p>The ruling coalition thus not only defies the unanimous criticism of media associations and human rights organizations, three UN Special Rapporteurs (<a href="http://t1p.de/gwdl" rel="nofollow ugc">http://t1p.de/gwdl</a>), the OSCE Representative on Freedom of the Media (<a href="http://t1p.de/iut5" rel="nofollow ugc">http://t1p.de/iut5</a>) and the legal committee of the German Bundesrat (<a href="http://t1p.de/1ian" rel="nofollow ugc">http://t1p.de/1ian</a>), but also technical objections (<a href="http://t1p.de/ut2d" rel="nofollow ugc">http://t1p.de/ut2d</a>; <a href="http://t1p.de/4xx5" rel="nofollow ugc">http://t1p.de/4xx5</a>).&#8221;</p>
<p><a href="https://rsf.org/en/news/bnd-law-german-bundestag-ignores-criticism-civil-society-and-breaches-constitution" rel="nofollow ugc">https://rsf.org/en/news/bnd-law-german-bundestag-ignores-criticism-civil-society-and-breaches-constitution</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285834">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285834">
						October 22, 2016 9:24 AM					</a>

				</p>

				<p>@Grauhut<br />
Any nation that waves the flag of respecting privacy and personal security is total nonsense. I don&#8217;t buy into such nonsense and neither would the vast majority of the regulars here I believe.</p>
<p>Germany used to take pride in it&#8217;s &#8220;IT Security &#8211; Made in Germany&#8221; and I think that would simply tarnish the brand as well. When it comes to spying and personal security, everyone and everything is simply a bunch of data and metadata asking to be collected as long as it exist somewhere.</p>
<p>I am wary of that &#8220;Made in __________ country&#8221; nonsense and I find them appalling that people actually buy into it and next thing it hits them are the stark reality.</p>
<p>What we need are much more robust personal security and privacy that we create on our own as much as possible and not dictated to us by someone else.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285835">

			<div class="comment by-hawk ">

				<p class="commentcredit">

					<span class="commenter">hawk</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285835">
						October 22, 2016 10:03 AM					</a>

				</p>

				<p>The more technical a solution the less likely anyone will use it and often, the more unfriendly it is to use.<br />
Just listen to yourself, it&#8217;s like a kitchen appliance with a ten ton user manual. Oh, and you better not make a mistake or the whole thing breaks and worse, you won&#8217;t even know it until it&#8217;s too late. But don&#8217;t come back here expecting any sympathy.</p>
<p>Here, let me save you the time in responding:<br />
@hawk<br />
Hey man, you sure are dumb. No problem here typing with my left foot on the jagger502b while holding down three space bars with both hands while I do the retinal thingy with the crypto key masher version 9.02 on one certain Linux flavor only. No problems here. Why doesn&#8217;t everyone do this? They must be dumb.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285836">

			<div class="comment by-john-waynes-evil-twin ">

				<p class="commentcredit">

					<span class="commenter">John Wayne&#039;s Evil Twin</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285836">
						October 22, 2016 10:24 AM					</a>

				</p>

				<p>@Thoth</p>
<p>Smart Card Root Of Trust, Ultimate Manifestation (SCROTUM). ^o^</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285837">

			<div class="comment by-slime-mold-with-mustard ">

				<p class="commentcredit">

					<span class="commenter">Slime Mold with Mustard</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285837">
						October 22, 2016 12:04 PM					</a>

				</p>

				<p>@ Europe Vs American Models</p>
<p>From the <a href="http://www.theatlantic.com/technology/archive/2016/10/incessant-consumer-surveillance-is-leaking-into-physical-stores/504821/" rel="nofollow ugc"> second article </a><a> you linked:</p>
<p><b>Turrow:</b> &#8220;People don’t read privacy policies. In fact, most Americans misunderstand the meaning of the phrase &#8216;privacy policy&#8217;&#8230; (they think) it means the site won’t share your information with other sites&#8230;don’t let them call it a privacy policy! Get them to call it &#8216;How we use your information&#8217;!&#8221;</p>
<p><b>Outstanding idea!</b> I will talk to my congressman after the election (he&#8217;s in a tight one) and contact the EFF. Does anyone else think this is worth pursuing?</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285838">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285838">
						October 22, 2016 12:47 PM					</a>

				</p>

				<p>Markus Ottela<br />
&#8211;Looks great.  I like the new data diode w/ DC power plugs instead.  There <em>could</em> maybe be some kind of crazy attack there over powerlines thru a powersupply but not worth it IMO to fully prevent that.  Being able to leave it on your bench w/o changing batteries is nice.</p>
<p>Thoth<br />
&#8211;Ok, so looks like that freescale/nxp chip uses an external crystal, prob. 32.768kHz, not clocked internally.  Work w/ an HCS08 lol.  Wonder what J3 is used for.  U5, U6 and U3 I&#8217;d guess some kind of regulator.  Not sure wbout U2 (probably another regulator) or U4.  3 of those regulators must be for 1.8,3,and 5V operating voltage you can switch to.  Looks like it supports class A,B,&amp;C cards w/ T=0 and T=1, and PPS protocol.</p>
<p>Anyway, so USB (2.0, 12Mbps) comes in, via CCID protocol it can communicate directly w/ card over USB.  Can&#8217;t really comment on hardware design, I&#8217;d have to look over code to have any clue for optimizing.  Probably not much.</p>
<p>So, you have 2,826,240 bits you can transmit at a rate of 12,000,000 bits per second thanks to CCID protocol.  So you should be able to send that payload in 0.23552 seconds to the card, times 2 would be 0.47104 seconds ideally for full comms trip.  Out of total time of 137.582 seconds, the comms would take 0.34% of the time.  Based off that rate, you could encrypt 2.5 KB per second.  Word files, you just put a space in them and it&#8217;s a KB lol, but text files, well&#8230;it&#8217;s much better but still will add up quickly if you have a lot.</p>
<p>The bottleneck isn&#8217;t the comms I think.  It&#8217;s Java on the PC and the encryption on the card going from Java down to actual executing code.  Easiest way to speed that up is probably specs of computer and specs of smartcard eh?  Well as long as you&#8217;re satisfied I&#8217;ll look for other smart card readers and cards and go back to all my other projects, thanks. :p</p>
<p>Definitely would be plenty to probe on that board though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285839">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285839">
						October 22, 2016 1:11 PM					</a>

				</p>

				<p>Slime Mold with Mustard</p>
<p>For the sake of fairness: We Europeans sometimes tend to smirk about us-americans, and frankly, there is plenty reason for that in my minds eye.</p>
<p>HOWEVER: Looking around I fail to see how &#8220;our&#8221; EU-rope is any better. Your politicians are but a bunch of corrupt crooks and so are ours. Your politicians don&#8217;t care a rat&#8217;s a** about the normal people, neither do &#8220;ours&#8221;.</p>
<p>To a certain part, one might excuse ourselves as being hardly more than vassals of the united states of a part of a part of America. But still, we fell for the same traps as you did over there. We, just like you, lousily failed to enforce the holy rule of &#8220;we the people&#8221; and allowed the crooks to pervert the whole system.</p>
<p>Leaving politics &#8211; at least it would seem so &#8211; I see very similar patterns repeating in our field:</p>
<p>The googles and mozillas and facebooks make a lot of PR and theater but in the end they bend the rules, shift vast amounts of $ to clinton, abuse their power to censor people, etc.</p>
<p>Getting technical, one might look again at SSL and lots of other nightmares and less than perfect hw and sw and ask &#8220;Are those <em>really</em> real problems that just couldn&#8217;t be avoided or is it just another cycle of the &#8216;oh well, the world is bad but we try very hard&#8217; bla bla we know from politicians?&#8221;</p>
<p>Fact is that there are plenty of corps which do have billions; and we <em>do</em> have ways and tools to do considerably better. Yet, the whole stack is rotten.</p>
<p>Example: letsencrypt. Sounds great (if brain deactivated). BUT: In my books &#8220;you install some crappy sw from us on your machine to then enjoy our super-duper-security magic&#8221; isn&#8217;t anything like secure. To me that sounds simply like &#8220;Let us put some hooks right into your heart and brain. It will be wonderful, promised&#8221;.</p>
<p>As for open source: It wouldn&#8217;t be the first time that the crooked found ways to make well meaning people do their bidding.</p>
<p>Just thinking.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285840">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285840">
						October 22, 2016 1:36 PM					</a>

				</p>

				<p>@ Thoth, Curious and many others,</p>
<blockquote><p>You don&#8217;t really have fine grain control of your own browser and this makes the problem even worse.</p></blockquote>
<p>And there is no excuse for it either, it&#8217;s not as though people have not been complaining about web browsers and this lack since before this century&#8230; But it appears to have always fallen on &#8211;deliberately?&#8211; deaf ears with the developers of the major browsers.</p>
<p>Personaly I&#8217;m thoroughly disgusted with most of them but those that came via Mozilla and Chrome have now become completely untrustable in this respect. As they were not originaly that bad you have to ask what incentives the developers had to make their products that way&#8230;</p>
<p>As they say, &#8220;Answers on a postcard, so all the world can read it&#8230;&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285841">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285841">
						October 22, 2016 1:50 PM					</a>

				</p>

				<p>@ Europe</p>
<blockquote><p>People with conscience and morals used to run America. Now its tax dodging, profit minded Wall St backed corporations using big-data to crush competition.</p></blockquote>
<p>One thing we do know is that will only get considerably worse if Hillary &#8220;Wall St bought and payed for&#8221; Clinton gets tenure for the next four years. Not that most Americans actually understand this or probably even care&#8230;</p>
<p>As for the other side of &#8220;the non divide&#8221; it&#8217;s far from clear what Donald Trump would do, some of his early utterances suggested on this asspect he would be the better option, now however&#8230;</p>
<p>The one thing most Europeans who think about it tend to agree on, is that the US will probably pass &#8220;Global Scope&#8221; legislation for the likes of the big spying orgs like Google, Twitter, Facebook et al so they can not be legally or financially penalised in any way. Or as one friend put it &#8220;American exceptionalism supported at the point of a gun&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285842">

			<div class="comment by-vinnyg ">

				<p class="commentcredit">

					<span class="commenter">VinnyG</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285842">
						October 22, 2016 2:19 PM					</a>

				</p>

				<p>@SlimeMoldWithMustard re &#8220;privacy policy&#8221;. The application of the term is precisely correct: it is a &#8220;policy on privacy&#8221;. Anyone so naive, obtuse, or lazy as to assume that any policy is what he or she would like it to be without actually reading it is imo highly unlikely to benefit from a mere change in document title. If any top-down regulatory change would be of benefit (I&#8217;m highly skeptical of that proposition generally) I think it would be more along the lines of prohibiting legalese mumbo jumbo and double talk, and restricting policy descriptions to combinations drawn from a dictionary of simple phrases and terms, and/or some kind of common/standard graphical representation of the features of privacy policies. I would add that those changes, like any others in this domain, could be forced by a knowledgeable, concerned public without recourse to government regulation. Unfortunately no such entity exists, which probably dooms any effort at improving the situation via either venue to long term failure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285843">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285843">
						October 22, 2016 2:33 PM					</a>

				</p>

				<p>@Thoth: &#8220;What we need are much more robust personal security and privacy that we create on our own&#8221;</p>
<p>The crazier the the snooping gets, the more talented people will work against it&#8230; 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285844">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285844">
						October 22, 2016 6:17 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>Have you seen<br />
<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_547.html#c6736252" rel="nofollow ugc">https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_547.html#c6736252</a><br />
and some of the posts below that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285845">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285845">
						October 22, 2016 6:19 PM					</a>

				</p>

				<p>@Figureitout<br />
Probably once I have finish implementing the native desktop I/O to bulk read/write the files then it would be more conclusive of the problem.</p>
<p>I sometimes wonder if the actual speed lag might be from the JVM in the card but that is hard to conclude.</p>
<p>The method I am using to measure the milliseconds spent does not include native file I/O by the way. What the timing measures is the total transaction time between the card and the desktop. For every transaction, it would add up to a total transaction timer I set in place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285846">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285846">
						October 22, 2016 6:25 PM					</a>

				</p>

				<p>@Grauhut,</p>
<p>Not that I&#8217;m talented, but:</p>
<p>The have lists upon lists of us starting from grade school, one can only finish so much when running against the grain. It&#8217;s overbearing at times, are they trying to use the weight of reality to wear us down?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285847">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285847">
						October 22, 2016 7:21 PM					</a>

				</p>

				<p>Thoth</p>
<p>Again, I lack any significant experience in Smartcards and I&#8217;m following your project rather superficially, but those problems intrigue me.</p>
<p>I suppose the problems are based in mainly 2 areas: a) industry blurb and b) java.</p>
<p>Those thingies are made to infrequently do some crypto and to transmit a low amount of data. Things like 2048 key bits. I assume that a timeframe of about a quarter to  half a second is considered acceptable.</p>
<p>So, from my (possibly ridiculously wrong) perspective, the story goes roughly like this: Transmitting about half a KB is already a rather major job for those scenarios (e.g. a 4096 bit key). Supposedly a line speed of 33 Kb is considered a reasonable minimum (simply because that&#8217;s still used and once was the &#8220;standard speed&#8221; in the typical scenarios). So transmitting 2 Kb (plus some protocol overhead) takes about 1/10 of a second. If the smartcard chip could deliver, say, a 2 Kb key within another 30 to 50 or so ms, the whole process could be comfortably handled in much less than a 1/4 of a second. Case closed (meaning: everyone would be happy and those specs would be fine).</p>
<p>Which comes down to everyone having had even some reserve. The Infineon chip we talked about would actually be a speed demon for those typical scenarios (like signing a 32 Byte hash).</p>
<p>All of this also translates to the industry not being under any pressure. Bloody java was fast enough. In fact, even lousy and poor jvm implementations were good enough. And anyway the hardware would get faster, so what.</p>
<p>When they added USB capability they didn&#8217;t do that because they needed more speed but because USB became an omnipresent standard and end customers wanted something to simply plug into their PC.</p>
<p>In the end, I suppose, (part of) your problem is that you assumed that USB means at least 1.5 Mb speed and hey, the chip could do the crypto in 5 or so ms. I don&#8217;t doubt that Infineon has a reference implementation that actually delivers that. But I strongly doubt that that&#8217;s what you get out of a lousily implemented jvm.</p>
<p>Your usage is just far out of industry bounds, I assume.</p>
<p>Which must not be a major problem, unless you do way too much on those thingies. Maybe you should re-distribute your workload and use those thingies just for what they were really made for (rather than what the blurb numbers say).</p>
<p>You have some not fast but &#8220;safe&#8221; crypto and some &#8220;safe&#8221; on chip memory and some security gadgets available. That&#8217;s a nice basis which quite well supports quite nice approaches. Example: Seeding a good PRNG, drawing some key out of a &#8220;magic hat&#8221; (the smartcard thingy), etc.</p>
<p>I&#8217;ve worked on a vaguely related project where we also definitely wanted some decisive and vital stuff outside of the box. Reason: one of the major problems turned out to be the question of trust, meaning &#8220;We can run stuff on a system but how can we make sure that stuff hasn&#8217;t been poisoned?&#8221;. We solved it with an elaborate verification chain whose pivot element was a tiny hash routine that was pulled from a &#8220;magic outside box&#8221; so as to make sure that the further verification routines and self checks were performed by unpoisoned/unaltered software.</p>
<p>In case I got the hole thing completely wrong and just blabbered stupid things, forgive me and accept my good intentions (and curiosity).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285848">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285848">
						October 22, 2016 8:07 PM					</a>

				</p>

				<p>@all<br />
Looking pass the flaws of medical devices, the MedSec security bug hunting team are more of market speculators than actually concerned security researchers wishing to improve embedded security.</p>
<p>Medical devices are flawed and that is a known thing but the really disturbing part is for someone or some organisation to use flaws to short sell stocks, meddle with markets, hoard vulnerabilities and other actions that are not positive to the situation.</p>
<p>Link: <a href="http://www.theregister.co.uk/2016/10/22/st_jude_new_security_claims/" rel="nofollow ugc">http://www.theregister.co.uk/2016/10/22/st_jude_new_security_claims/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285849">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285849">
						October 22, 2016 8:25 PM					</a>

				</p>

				<p>@ab praeceptis</p>
<p>&#8220;Those thingies are made to infrequently do some crypto and to transmit a low amount of data&#8221;</p>
<p>Indeed. Those shouldn&#8217;t take too long though as most of the memory crypto are usually XORs but that just my guess. Each chip uses different methods to encrypt their internal RAM and EEPROM and are kept under multiple layers of red tapes.</p>
<p>&#8220;The Infineon chip we talked about would actually be a speed demon for those typical scenarios (like signing a 32 Byte hash)&#8221;</p>
<p>Yes. This is indeed true as Infineon chips are one of the fastest I have ever worked with (NXP, Infineon, Samsung). NXP gives pretty decent speeds too.</p>
<p>&#8220;When they added USB capability they didn&#8217;t do that because they needed more speed but because USB became an omnipresent standard and end customers wanted something to simply plug into their PC.&#8221;</p>
<p>That&#8217;s correct as most people are ditching the CCID card reader and are doing USB FIDO/PKI tokens and what better than to simply add an additional USB firmware into the chip. I recently bought a small batch of JavaCard USB tokens and they simply out perform any smart card reader + smart card (traditional setup) in terms of speed test. I have not uploaded my GroggyBox applet since the USB smart card token does not support PKCS 5 pad mode natively and that is a major headache so I am giving myself sometime to think of how to handle this situation. I could either implement zero pads and not use PKCS 5 padding mode or I could implement software PKCS 5 pad mode but I am leaning to switching to zero pad mode but breaking compatibility with PKCS 5 pad would also be questionable when it is the industry standard.</p>
<p>&#8220;Your usage is just far out of industry bounds, I assume.&#8221;</p>
<p>That is correct. Smart cards were never built for bulk encryption like what I have done. The most they were expected to handle were small transactions and wrapping of cryptographic keys and leave the bulk encryption to the host (insecure) computer.</p>
<p>&#8220;You have some not fast but &#8220;safe&#8221; crypto and some &#8220;safe&#8221; on chip memory and some security gadgets available. That&#8217;s a nice basis which quite well supports quite nice approaches. Example: Seeding a good PRNG, drawing some key out of a &#8220;magic hat&#8221; (the smartcard thingy), etc.&#8221;</p>
<p>I guess that sums it up. Pretty much I have to lower the user&#8217;s expectation of a fast and safe smart card file encryptor into a slow and safe and friendly smart card file encryptor. To compensate for the slow speed, the only thing I can think of to keep users happy would be to make the GUI much more friendly and usable so that despite the slow speed, the UX would make up for the slow speed and also to lower the user&#8217;s expectation on the crypto speed of these tiny security devices.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285850">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285850">
						October 22, 2016 8:29 PM					</a>

				</p>

				<p>@ All</p>
<p>Quickly dropping this <a href="https://www.cs.umd.edu/~mwh/papers/cmod-journal.pdf" rel="nofollow ugc">paper</a> on a type-safe linking and information hiding model for C programs. It&#8217;s based on 4 rules they say are compatible with how C programs are written when authors have sense. They claim the application of it to 30 OSS programs found over a 1000 problems that could&#8217;ve turned into bigger ones over time. Linker-level correctness and security gets little research plus a ton of stuff is written in C. So, I like this work even though I only skimmed it for a few seconds. 😉</p>
<p>Additionally, the F* team doing the verified HTTPS just released a <a href="https://fstarlang.github.io/general/2016/09/30/introducing-kremlin.html" rel="nofollow ugc">compiler to C</a> from a subset of F*. Originally targeted F# and Ocaml. So, this is nice addition to COGENT-to-C system from Australians.</p>
<p>Finally, best for last, I can&#8217;t recall if I already shared this <a href="http://infohost.nmt.edu/~al/cseet-paper.html" rel="nofollow ugc">article</a> on Cleanroom Software Methodology. Unlike many others, it&#8217;s very approachable intro that combines standard fare with what author learned at a training session from IBM that has details overviews leave off. Additionally, author has been teaching students to use the method then recording their results. The results have been impressive. I still think it should be combined with functional programming a la Haskell w/ QuickCheck or Ocaml in style of MirageOS TLS.</p>
<p>Bonus: On discussion about DDOS dominating Internet, I pointed out the people using 1970&#8217;s tech called dial-up over POTS, dedicated point-to-point, BBS&#8217;s, and intranet email are doing just fine. That&#8217;s right: the 70&#8217;s is still more resilient than the modern Internet circa 2016. Mwahahaha.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285851">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285851">
						October 22, 2016 10:10 PM					</a>

				</p>

				<p>@r: &#8220;&#8230;are they trying to use the weight of reality to wear us down?&#8221;</p>
<p>Possible. Remember that IRS ./. Tea party scrunity game?</p>
<p><a href="https://en.wikipedia.org/wiki/IRS_targeting_controversy" rel="nofollow ugc">https://en.wikipedia.org/wiki/IRS_targeting_controversy</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285852">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285852">
						October 22, 2016 10:41 PM					</a>

				</p>

				<p>Nick P</p>
<p>Re. CMOD (your 1st item), oh well, one of many, many academic efforts that will hardly ever take off. There are tough practical issues, the major of which probably is that one must use yet another wrapper. Very few developers will accept that.</p>
<p>Sure, the matter is important and it would be highly desirable to have something at least vaguely like what a whole zoo of Wirth languages (and some others) have since decades. But: C programmers are a mercilessly pragmatic bunch and they will hardly accept another wrapper.</p>
<p>However, the paper has a nice side, too, namely the math behind CMOD. That certainly deserves positive mentioning and some attention.</p>
<p>Re &#8220;F*&#8221;</p>
<p>I&#8217;m enchanted. Having looked at diverse evil corp and INRIA cooperations I have, as you probably know, found quite some good stuff, that however, wasn&#8217;t practically useable/acceptable for me due to one or the other microsoftism (.net, needs windows, &#8230;).</p>
<p>The way the F* people chose isn&#8217;t really new (but quite). I mentioned LEON (EPFL, the &#8220;sister of ETH) earlier. Much of the thinking is quite similar. LEON is build on a Scala base and also creates C code for some (reasonably large and useful) subset of Scala. And, interestingly, also looking at and using C as an omnipresent meta-assembler (which it ideally is).</p>
<p>I&#8217;m not really a fan of Scala; I feel that it has been brutally hampered by its java heritage and closeness. F* looks quite good. Stringent, consistent, verif not as an add on but fully and seriously designed in from the start. And while I&#8217;ve not yet found hard proof, considering its surroundings I would bet that the (left vague) &#8220;SMT&#8221; backend mentioned translates to or at least includes/allows for Z3. Plus F* is more hardcore about safety and more consistent than Scala it seems to me.</p>
<p>The minus I see that F* is rather young and not yet mature, let alone endowed with goof tool support, libraries, etc. But that can be forgiven considering its strong background (i.a. OCaml) and the fact that often just sensitive parts of a project will be done in F*.</p>
<p>Excellent, and finally, it seems, not evil corp. license or OS or &#8230; crippled. Kudos to evil corp. They move and they move in a good direction (at least in the field I care about).</p>
<p>As you might feel between the lines, I&#8217;m very pleased and excited. You see, determined stout weirdos like myself somehow had our toolbox and our ways to do things the way they should be done anyway (if clumsy and burdensome), but I always felt lost when trying to convince others. Usually it ended with them telling me that the entry barrier is way too high, that it&#8217;s not well portable, etc, etc.</p>
<p>Finally it seems that there is a way every serious professional can take. Wonderful. I hereby forgive evil corp quite some of their ugly sins.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285853">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285853">
						October 22, 2016 11:16 PM					</a>

				</p>

				<p>Thoth</p>
<p>&#8220;Pretty much I have to lower the user&#8217;s expectation &#8230;&#8221;</p>
<p>Maybe not. First, let&#8217;s not mix up things. Your endeavour was bringing fruits in that you quite considerably extended your knowledge and gained insights and know-how into a valuable field.</p>
<p>The other thing is that you want to build something new and useful. That can still be done, just not the way you chose first, I guess.</p>
<p>Maybe it would be worthwhile to look at and consider my earlier hint. Let me elaborate a bit:</p>
<p>You could summarize the context as a) can the user trust his (insecure) system (which, however is powerful) and b) can the user trust my software on his system being not poisoned?</p>
<p>a) is not something one needs to ascertain fully each and every time. Hence it may need much more (run)time, who cares. There your smartcard does more resource and time consuming things (basically coming down to a host OS check).</p>
<p>b) <em>can</em> be done very well with very low (smartcard) resources by following a staging approach. So, a very small routine, maybe 1% or 2% of the size you have been experimenting with (about 350 KB) and hence within the time comfort zone (1s or 2s) is to be loaded from the smartcard and then verifies that the larger and costlier verif. routines of the host system are not poisoned; those then verif. the &#8220;big&#8221; program (crypto or whatever) and iff all tests passed e.g. given a hash computed along the way (showing that all verif stages passed) is sent to the smartcard, which then and only then hands out some keymat or whatever.<br />
It could be simple and modest; e.g. your smartcard generates a random and transmits it to the verif downloaded before, then computes something (e.g. how a hash should look like if the host is OK and clean) and then checks what the host verif routine computed matches the internally computed hash or whatever.</p>
<p>From that point on your users can be, say, 99,99% sure that the crypto or whatever stuff done by your main program on the host OS is actually safe and secure. That&#8217;s not 100% but it&#8217;s much, much more than what one can usually get with small resources and it&#8217;s also a good starting point for more services (like e.g. tranferrig HIDS keys to your smartcard or similar).</p>
<p>(And I have a question in mind that hunts me, which to answer, however, I don&#8217;t know enough about the smartcard industry: Are you really limited to java? I would assume that Infineon also supports e.g. C (but maybe only for <em>large</em> customers))</p>
<p>Sorry that I can&#8217;t offer more and more useful input but again, my skills in your field are very limited.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285854">

			<div class="comment by-ratio ">

				<p class="commentcredit">

					<span class="commenter">Ratio</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285854">
						October 23, 2016 12:55 AM					</a>

				</p>

				<p>@Markus Ottela,</p>
<p>I haven&#8217;t played with TFC, but I&#8217;ve read bits and pieces of the code. Some comments on the code:</p>
<ul>
<li>setup: you may want to check out <a href="https://pip.pypa.io/" rel="nofollow ugc">pip</a> (and <a href="http://virtualenv.pypa.io/" rel="nofollow ugc">virtualenv</a>) and the way you can specify SHA-256 hashes for packages in requirements files. Ideally someone should be able to install all the Python bits using <i>pip install -r requirements.txt</i> (once you&#8217;ve got whatever OS packages you need using <i>apt install &#8230;</i> or what have you).</li>
<li>In <i>hwrng</i>: the docstring on <i>main</i> doesn&#8217;t match the code: <i>ent_size</i> can be 768 bits</li>
<li>In <i>NH.input_validation</i>: <i>isinstance(param_tuples, tuple)</i> is always true. You want a tuple (or any sequence, really) of 2-tuples or something along those lines.</li>
<li>Maybe <i>for n, (param, exp_type) in enumerate(param_tuples, start=1)</i> is a nicer way to do what you&#8217;re doing in <i>NH.input_validation</i>; these variables correspond to your <i>n, t[0], t[1]</i>. (You could also make <i>nth</i> a list or a tuple and drop the <i>start=1</i>.)</li>
<li>In <i>NH.phase</i>: <i>sum(&#8216;\n&#8217; in c for c in string)</i> is just <i>string.count(&#8216;\n&#8217;)</i></li>
<li><i>Rx.padding</i> is basically no more than evaluating <i>string.ljust(255, chr(255 &#8211; len(string)))</i>
</li>
<li>There seems to be quite a bit of duplication between <i>NH</i>, <i>Rx</i>, and <i>Tx</i>?</li>
<li>The globals, they burn. 😉</li>
</ul>
<p>Anyway, that&#8217;s as far as I got in half an hour or so. Hope that helps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285855">

			<div class="comment by-ego ">

				<p class="commentcredit">

					<span class="commenter">ego</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285855">
						October 23, 2016 1:46 AM					</a>

				</p>

				<p><b>World largest glorified advertising company Google has dropped ban on personally identifiable web tracking</b></p>
<p><a href="https://www.msn.com/en-my/news/techandscience/google-has-quietly-dropped-ban-on-personally-identifiable-web-tracking/ar-AAjfJBr" rel="nofollow ugc">https://www.msn.com/en-my/news/techandscience/google-has-quietly-dropped-ban-on-personally-identifiable-web-tracking/ar-AAjfJBr</a></p>
<p><i><br />
When Google bought the advertising network DoubleClick in 2007, Google founder Sergey Brin said that privacy would be the company’s “number one priority when we contemplate new kinds of advertising products.”<br />
</i><i><br />
But this summer, Google quietly erased that last privacy line in the sand – literally crossing out the lines in its privacy policy that promised to keep the two pots of data separate by default. In its place, Google substituted new language that says browsing habits “may be” combined with what the company learns from the use Gmail and other tools.<br />
</i><i><br />
The change is enabled by default for new Google accounts. Existing users were prompted to opt-in to the change this summer.<br />
</i><i><br />
The practical result of the change is that the DoubleClick ads that follow people around on the web may now be customized to them based on your name and other information Google knows about you. It also means that Google could now, if it wished to, build a complete portrait of a user by name, based on everything they write in email, every website they visit and the searches they conduct.<br />
</i><i><br />
The move is a sea change for Google and a further blow to the online ad industry’s longstanding contention that web tracking is mostly anonymous.<br />
</i></p>
<p><b>Of course Google needs to &#8220;show growth&#8221; in one way or another and since they don&#8217;t really manufacture much of anything that brings ongoing revenue, except adverts, their only resource to mine are their users&#8230;</b></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285856">

			<div class="comment by-tyr ">

				<p class="commentcredit">

					<span class="commenter">tyr</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285856">
						October 23, 2016 1:55 AM					</a>

				</p>

				<p>@Nick P., Clive</p>
<p>Here&#8217;s an interesting saga of development team<br />
problems. It could be a capsule of why a lot<br />
of software is crap down in the heart of it.</p>
<p><a href="http://www.wargamespace.com/2014/05/05/gaming-graveyard-a-10-warthog/" rel="nofollow ugc">http://www.wargamespace.com/2014/05/05/gaming-graveyard-a-10-warthog/</a></p>
<p>Humboldt squid are like bears, it is OK to<br />
eat something that wants to eat you if it<br />
gets a chance&#8230; : ^ )</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285857">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285857">
						October 23, 2016 1:56 AM					</a>

				</p>

				<p>@ab praeceptis<br />
If I were to do native Infineon blobs or any native smart card blobs, I will be (and my applet as well) subjected to:<br />
 &#8211; NDAs &#8230; tonnes of them<br />
 &#8211; Create the Card OS from scratch which is a pain<br />
 &#8211; Not able to open source anything</p>
<p>All these would doom the FOSS nature of my project and adds unnecessary cost, legal, resource and time wastage.</p>
<p>I would prefer to use a standardised JavaCard which is fully open platform and thus my applet can be comfortably open sourced without any NDAs, legal, cost, resource or other problems a native applet with native from scratch Card OS brings.</p>
<p>So no, I would not consider another solution that will impact the FOSS nature of my project and which would prevent the ease of running a single applet on multiple platforms (NXP, Infineon, Samsung ..etc..).</p>
<p>Sadly, only JavaCard fits the bill as it is the single most widely adopted Card OS out there only following behind by MULTOS and for MULTOS OS, it uses C but it still have the overhead of a VM like JavaCard and there is only one supplier of MULTOS while JavaCard suppliers can be found across all major smart card suppliers and almost 99% of card development are JavaCard safe for proprietary card development encumbered by red tapes and NDAs.</p>
<p>So the short answer is no, I will only stick to JavaCard for now as it&#8217;s the single most widely adopted smart card platform with the most market shares and also the most support and tools.</p>
<p>Maybe you could take some time to pick up JavaCard and buy a small batch of JavaCard enabled smart cards online. It isn&#8217;t too hard to pick up JavaCard since the syntax is mostly Java style and you just need to remember your codes cannot do dynamic calls and there is only one software applet package per applet. I picked up most of my JavaCard and smart card APDU skills and settled down within about 1 week plus pretty quickly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285858">

			<div class="comment by-krista-well-socialised-geekogirly ">

				<p class="commentcredit">

					<span class="commenter">Krista Well Socialised Geekogirly</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285858">
						October 23, 2016 2:03 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>first time caller long time admirer</p>
<p>You have so much wise, worldly practical advice that can be of great benefit to the 99% of people on the this planet that don&#8217;t understand infosec and are not likely to come up to speed with the complexity of topics on this blog (mostly) .  Your advice includes infosec for the laywoman but goes beyond computers into old school trade craft amongst many other things</p>
<p>Do you have a legacy? Have you written any books or papers? I am just wondering if your great knowledge can be available for the world in the years and decades after you have ascended into light and continue to guide us mortals from your Valhalla ?</p>
<p>So far my only thoughts are that all of your posts on this blog over the years can be scraped and compiled into a book, curated by Bruce.<br />
My question is, is that the best we can expect for your posterity?</p>
<p>a warm embrace and a hot mug of motion generation your way xoxo</p>
<p>PS your post about surviving a power outage in a cold climate.  You said coffee fared well with unsalted butter.Well did you know it&#8217;s a whole phenome known as bullet proof coffee.  But ignore the marketing and the book and website and blah. Just DIY &#8211; it has many health benefits, the fat fuels thermogenesis of the coffee and really boosts cognitive function. A good two tablespoons of grassfed organic butter unsalted,  with coffee and blend into a delicious frothy mass of delight.  The recipe calls for coconut oil and butter but it makes one very sluggish and is heavy on the liver. Just butter is best.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285859">

			<div class="comment by-krista-well-socialised-geekogirly ">

				<p class="commentcredit">

					<span class="commenter">Krista Well Socialised Geekogirly</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285859">
						October 23, 2016 2:06 AM					</a>

				</p>

				<p><a href="https://www.theguardian.com/media/2016/oct/19/wikileaks-ecuador-julian-assange-internet-access" rel="nofollow ugc">https://www.theguardian.com/media/2016/oct/19/wikileaks-ecuador-julian-assange-internet-access</a></p>
<p>Ecuador Embassy cuts Julians internet access over concerns he is interfering in US elections</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285860">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285860">
						October 23, 2016 9:29 AM					</a>

				</p>

				<p>@ab praeceptis re: <i>Smart Card Inspector</i> (TM)</p>
<p>Um, I don’t know if I understood your proposal / idea in full, but:<br />
I’m afraid there’s a basic issue with that approach, it’s called authentication.</p>
<p>Imagine to sit in a cardboard box from, say, a washing machine.<br />
The only connection to the outside world would be a small slit where you can send / receive a piece of paper with some data.<br />
How would you know what’s going on outside?<br />
You may read ‘I’m @Bruce, trust me’, verify the Mi$o signature or check if &#8220;they&#8221; can compute your secret, but that’s all, you’d never know how many black hats or guns are involved out there.</p>
<p>Generally it may (!) be possible to inspect from upside down, but never the other direction.</p>
<p>But the real issue is with your 99.99%.<br />
History has shown that all NOBUS isn’t true for tomorrow, their tools are ours 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285861">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285861">
						October 23, 2016 10:41 AM					</a>

				</p>

				<p>Bruce has mentioned in the past that he thinks the future of attacks on big data lies in data corruption. The case below is evidence in support of his claim.</p>
<p><a href="http://www.todayonline.com/world/asia/rogue-immigration-officers-msia-pocketed-s6m-two-years-report?google_editors_picks=true" rel="nofollow ugc">http://www.todayonline.com/world/asia/rogue-immigration-officers-msia-pocketed-s6m-two-years-report?google_editors_picks=true</a></p>
<p>Immigration officials tamper with immigration database to allow illegals to enter the country, make  six million in the process.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285862">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285862">
						October 23, 2016 11:14 AM					</a>

				</p>

				<p>@ tyr</p>
<p>I was so confused at first since it was written like this involved the simulator for the actual A-10. Then I realized it was a game but still confused since I played <a href="https://en.wikipedia.org/wiki/A-10_Tank_Killer" rel="nofollow ugc">A-10 Tank Killer</a> and its sequel. I especially loved trying to come in low through the rivers then napalm or maverick their asses just as I came up. Not that I was a great aim. In real life, I had a training round for the Avenger cannon from my grandpa. Something about holding a bullet that&#8217;s nearly a foot tall helps people understand how this plane could shred tanks. I thought the real one was awesome since it was a beast that flew right into gunfire tearing through the enemies. A big, ugly heaping machine of Get Her Done philosophy. 🙂</p>
<p>Ok, back to this game. So, it was a realism-oriented sim. Looks like a neat project. The culprit is obvious to any Dilbert readers: horrifically bad management combined with short-term thinking and no real understanding of the market. They were seriously about to mix a realistic flight-sim with MMORPG concept that was just invented because point-and-click spell casters liked MMORPG&#8217;s? Huuuuh? How would they even do all that on old hardware is what I&#8217;d have asked? And forced to do a dynamic 3D game in a throwaway 2D engine? It was just FUBAR all the way. It ends with a warning that has been true to this day: games, even genre&#8217;s, will disappear if the margin gets too low for big companies. It happened to space sims despite Wing Commander, Privateer, Freerunner, etc showing there&#8217;s definitely a market. The companies just won&#8217;t build them since it&#8217;s not a profitable market if there&#8217;s competition.</p>
<p>They need to start doing enterprise software on the side. Even acquire something with a decent codebase that&#8217;s already selling. Then, you have game coders moonlight as optimizers for the enterprise software. Just make sure they mostly do gaming to keep them from quiting. The enterprise software becomes bread-and-butter to cover business if gaming side isn&#8217;t doing so well. Gaming side has potential for moonshots or bursts of profit. Keeps high-grade talent to do occassional extensions of enterprise, especially if there&#8217;s overlap. Storage, networking, or chat come to mind.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285863">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285863">
						October 23, 2016 11:59 AM					</a>

				</p>

				<p>@ ab praeceptis,</p>
<p>You might find this of interest,</p>
<p><a href="http://www.drmaciver.com/2016/10/static-typing-will-not-save-us-from-broken-software/" rel="nofollow ugc">http://www.drmaciver.com/2016/10/static-typing-will-not-save-us-from-broken-software/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285864">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285864">
						October 23, 2016 12:13 PM					</a>

				</p>

				<p>Sancho_P</p>
<p>It is presumably <em>known</em> what&#8217;s in the box (Smartcard) and it can be checked and verified what&#8217;s in the host box.</p>
<p>The point in my approach is that one can hardly verify a host system (on which some sensitive code should run) without a trusted reference. In a way an Analogon to Gödels incompleteness theorems.<br />
Second, as we learned from Thoth, both the performance (at least with java) and the transmission capabilities of smartcard systems are very limited. But &#8211; and that&#8217;s the pivot point &#8211; one can use it as a reference (possibly even as a balanced mutual one) with low performance and transmission requirements.</p>
<p>Think, as an example, of a classical HIDS problem. A HIDS is nice and dandy but of little worth if its reference (the last known good state) is on the very same system to be tested. Accordingly one is typically advised to mount the reference read only or similar.</p>
<p>A smartcard would nicely lend itself to that problem. One could have a) a key (say 32 bytes), b) last good hash, c) some first stage verif. element on the smart card and then<br />
1) transfer the first stage to host<br />
2) make it check/verify second stage (on host)<br />
3) have 2nd stage hash check HIDS ref.<br />
4) decrypt HIDS ref<br />
5) run HIDS<br />
6) take current HIDS hash to smartcard<br />
7) clean up, etc.</p>
<p>Sure, there are still problems that this does <em>not</em> solve; the host verif, for instance, is either limited or very, very time expensive. But then, it was the very premise that there is an untrusted host system involved.</p>
<p>But anyway, Thoth seems to be not interested or disliking what I wrote, so the case is closed anyway for me. And I said from the beginning that I have good intentions but very limited knowledge in the smartcard field. So I&#8217;m neither surprised nor pissed off by Thoth rejecting my thoughts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285865">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285865">
						October 23, 2016 12:36 PM					</a>

				</p>

				<p>Clive Robinson</p>
<p>Thanks.</p>
<p><cite>frustration stems from the idea that static typing will solve all our problems, or even one specific problem: The ubiquity of broken software</cite></p>
<p>So what? Static typing isn&#8217;t meant to solve any problems. It&#8217;s one requirement next to others which, properly met, will help to create software that is troublefree (oh well, at least better more than what we had).</p>
<p>And the value and power of static typing (at least for what languages and understanding we have today) is easy to demonstrate (as has been amply shown).</p>
<p>It seems that McIver mixes up quite diverse elements, some rather technical, some more social, etc. Btw, I widely agree with his non technical/compsci arguments.</p>
<p>Much of the discussions going on come down to a simple point: Some argue in terms of usage, often mentioning arguments like &#8220;the computer is better at it anyway&#8221;, while others, like myself, strongly oppose.</p>
<p>Simple reason: <em>No</em> the computer isn&#8217;t better at it. In fact, it can not possibly deduct what the programmer wanted; it can deduct what type matches what the programmer typed. It can deduct that &#8220;day = 15; month = 11&#8221; are integers &#8211; but it can not know what they mean. Moreover and more importantly, those variables are but elements of an attempt to properly implement an algorithm.<br />
It just so happens that days &gt; 31 or months &gt; 12 for a date related algorithm are nonsensical and quite certainly introducing serious trouble. How would the compiler know that?</p>
<p>Another view: We don&#8217;t say in math &#8220;let x be some kind of number thing and let A be a function that does [whatever]&#8221;. No. We properly specify the function and its domain and codomain.</p>
<p>Unless some people seriously want to argue the fact that code is the implementation of algorithms (and such disqualifying themselves) that whole type deduction, inference, ducking and whatnot discussion is moot, alone for the fact that we are discussing quite different matters. I&#8217;m looking at proper algo implementation while they look at funny transformation magic, ease of use, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285866">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285866">
						October 23, 2016 12:39 PM					</a>

				</p>

				<p>@ Krista,</p>
<p>Welcome to the fold of commentors.</p>
<p>I will have a look into &#8220;bullet proof coffee&#8221;, thank you for bringing it to my attention, though a quick glance at Wikipedia suggests there is a strange extra added which I will certainly treat with caution 😉</p>
<p>@ tyr, Nick P,</p>
<p>I once had an unfortunate run in with an A10 and it still wakes me at night from time to time&#8230;</p>
<p>Put simply back when I was wearing the green we were erecting some Clark Masts with HF antennas in a field in UK MOD property on a cliff edge early one summer morning, with a little mist still in the air. Not to far away was an airbase where A10&#8217;s were resident for training at the time. Due to one of life&#8217;s little cockup&#8217;s nobody told the fly boys they were not supposed to come in off the sea there as there was a hazard to low level air navigation&#8230; Well they did at very low level and at the last moment the pilot realised that there was a sizable antenna in front and thus stood the A10 on it&#8217;s tail pipe. The first I knew about it was a physical pain from the power of the jet wash and noise and I looked up into a hell on earth that was the engines giving it full welly&#8230;</p>
<p>Luckily I did not have to change my cloths unlike the person standing a few yards from me who found the stomach churning vibration to much after a night on the beer and let loose from their tail pipe. Thus they had to ride back to camp in the back of the Landy due to the overpowering aroma of distressed digestion, that Theakstan&#8217;s Old Peculiar[1] can induce.</p>
<p>[1] Apart from Old Peculiar Theakston&#8217;s make a whole range of specialty beers that get shipped all over the world. A more recent one &#8220;Christmas Ale&#8221; owes it&#8217;s existance to NCIS,</p>
<p><a href="http://www.theakstons.co.uk/m/Tasting-Notes/Ale-Information/%3FBeerDetails%3D2" rel="nofollow ugc">http://www.theakstons.co.uk/m/Tasting-Notes/Ale-Information/%3FBeerDetails%3D2</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285867">

			<div class="comment by-ted ">

				<p class="commentcredit">

					<span class="commenter">Ted</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285867">
						October 23, 2016 12:40 PM					</a>

				</p>

				<p>On October 19, the Nat’l Telecommunications and Information Administration (NTIA) convened its first multistakeholder process meeting in Austin to discuss Internet of Things Security Upgradability and Patching.</p>
<p>The Federal Register notice announcing the meeting is <a href="https://www.ntia.doc.gov/files/ntia/publications/2016-22459.pdf" rel="nofollow ugc">here&lt;/a href&gt;. (Bruce is cited.)</p>
<p>The notes from the discussion indicate that the next meetings are scheduled for December (IIC meeting in San Diego and IEEE World Forum on IoT in Reston, Virginia).</p>
<p></a><a href="https://ntia.doc.gov/other-publication/2016/multistakeholder-process-iot-security" rel="nofollow ugc">https://ntia.doc.gov/other-publication/2016/multistakeholder-process-iot-security</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285868">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285868">
						October 23, 2016 12:51 PM					</a>

				</p>

				<p>Europe vs American Models<br />
shared a link to story at The Intercept:<br />
incessant-consumer-surveillance-is-leaking-into-physical-stores</p>
<p>It is instructive to consider that 1) such surveillance cannot happen in the absence of certain physical things and 2) that the surveilled control these things.</p>
<p>This is one example of your being empowered to metaphorically poke a thumb into surveillors&#8217; eyes.  Don&#8217;t waste the opportunity.  Turn Off that expensive tracking device.</p>
<p>The dark humor part of me often opines that, any day now, I will walk into a store and immediately be swept up and dumped into a dust bin&#8230;. because I carry no tracking beacon, therefore cannot possibly be human.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285869">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285869">
						October 23, 2016 1:21 PM					</a>

				</p>

				<p>Re: my earlier post<br />
&#8220;shared a link to story at The Intercept&#8221;<br />
should have been<br />
&#8220;shared a link to story at The Atlantic&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285870">

			<div class="comment by-jg4 ">

				<p class="commentcredit">

					<span class="commenter">JG4</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285870">
						October 23, 2016 4:30 PM					</a>

				</p>

				<p>I am a big fan of grass-fed butter and milk products in general.  Coffee in moderation is one of the many natural health tonics.</p>
<p>@Sancho P</p>
<p>You offered some time ago to provide further details on a data diode.  I really like the idea of open-source hardware as a complement to high-assurance software and firmware.  I&#8217;d like to see more information about your design.</p>
<p>If I weren&#8217;t mired in profound and continuing dysfunction, I would have posted my designs for a Faraday cage and power supply energy gap.  That and the missing groundswell of enthusiasm for the blindingly obvious.</p>
<p>Speaking of health tonics, one of the reasons you have to go easy is that some of them upset the gut microbiome.</p>
<p><a href="https://www.scientificamerican.com/article/drinking-causes-gut-microbe-imbalance-linked-to-liver-disease/" rel="nofollow ugc">https://www.scientificamerican.com/article/drinking-causes-gut-microbe-imbalance-linked-to-liver-disease/</a></p>
<p>This may also explain the cardioprotective effect of stout beers, which provide fodder and shelter for gut microbes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285871">

			<div class="comment by-k15 ">

				<p class="commentcredit">

					<span class="commenter">k15</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285871">
						October 23, 2016 5:31 PM					</a>

				</p>

				<p>What is the agency that we report problems to?  What is the URL, where is the physical office?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285872">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285872">
						October 23, 2016 6:14 PM					</a>

				</p>

				<p>@JG4</p>
<p>It’s very simple, I’ve published screenshots together with text and links at imgur:<br />
<a href="http://datadiode.imgur.com" rel="nofollow ugc">http://datadiode.imgur.com</a></p>
<p>You may also read a discussion with @Figureitout following my original posting:<br />
<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_547.html#c6736252" rel="nofollow ugc">https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_547.html#c6736252</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285873">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285873">
						October 23, 2016 6:24 PM					</a>

				</p>

				<p>@ab praeceptis</p>
<p>I have no idea how to do a verifier in a smart card so I have to spend time reading up before I can decide. Don&#8217;t want to introduce too much complexity into it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285874">

			<div class="comment by-mike-barno ">

				<p class="commentcredit">

					<span class="commenter">Mike Barno</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285874">
						October 23, 2016 7:23 PM					</a>

				</p>

				<p>@Clive Robinson,</p>
<p><i>Theakstan&#8217;s Old Peculiar</i></p>
<p>Isn&#8217;t it &#8220;Old Peculier&#8221;, with the last vowel an E, named after some community officer in your peculiar nation?  I thought I remembered it&#8217;s an official position, but Wikipedia <a href="https://en.wikipedia.org/wiki/Theakston_Brewery" rel="nofollow ugc">Theakston Brewery</a> says not quite:</p>
<p><i>It is named after the peculier of Masham, a peculier being a parish outside the jurisdiction of a diocese.</i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285875">

			<div class="comment by-tyr ">

				<p class="commentcredit">

					<span class="commenter">tyr</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285875">
						October 24, 2016 12:57 AM					</a>

				</p>

				<p>@Nick P.. Clive</p>
<p>A10s are devastating beasties, they can do a<br />
low level pass so fast you can&#8217;t react to it.<br />
Keeps infantry humbler that way. If you can hear<br />
the gun they you&#8217;re alive, if you&#8217;re the target<br />
you never hear it.</p>
<p>I always wanted the Wing Commander bunch to do<br />
a game called Renegade so I could fly the enemy<br />
ships from Privateer. As far as I know the whole<br />
team fell over in the Star Citizen fiasco. The<br />
tendency to chase bigger better faster with more<br />
pretty pictures has ruined what would have been<br />
a pretty good industry. I haven&#8217;t seen much to<br />
expect the staying power of chess from in comp<br />
gaming.</p>
<p>If you get the core engine that reacts to the<br />
player right the rest is just fancy artwork but<br />
too often the AI and sequencing take a back seat<br />
to dazzley eyecandy. That only masks off the<br />
deficiencies for a short time.</p>
<p>I&#8217;d like to see a browser that wasn&#8217;t an<br />
about:config nightmare of obscure settings that<br />
supposedly do something. When they said Chrome<br />
was an interpreter I immediately fled from it.<br />
An interpreter opened to the Net attack surface<br />
struck me as a horrible idea. Between the feaping<br />
creaturism and gee whizz involved I&#8217;m amazed<br />
that everyone hasn&#8217;t been owned big time in one<br />
big happy botnet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285876">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285876">
						October 24, 2016 2:08 AM					</a>

				</p>

				<p>@ tyr,</p>
<blockquote><p>I&#8217;m amazed that everyone hasn&#8217;t been owned big time in one big happy botnet.</p></blockquote>
<p>That made me think of the old joke,</p>
<p>An old boy had a business in the rag trade that was not doing so well. It did not matter what he tried he was not getting the work. So he had a confidential word with some of his old friends about what to do and the general consensus was he was in such dire straights that his best option was to pray for a bolt of lightning to hit the business and burn it down so he could break even on the fire insurance. Anyway he goes back to work and things get worse, and he decides it&#8217;s time to be decisive, and put a plan in place. A few days later he&#8217;s walking down the street thinking further on the matter, when the wife of one of his old friends stops him, and starts wailing on about his misfortune. In the process she says &#8220;such a terrible fire to lose everything&#8221; at which point he says &#8220;Shush that&#8217;s not till next week&#8221;.</p>
<p>So on the same basis with your prediction of universal &#8220;owned&#8217;,</p>
<ul>Shush, that&#8217;s not till next week</ul>
<p>😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285877">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285877">
						October 24, 2016 2:27 AM					</a>

				</p>

				<p>@ tyr, and the usuall suspects,</p>
<p>Speaking of universal ownership, especially by the likes of corporates with Android&#8230;</p>
<p>It appears it&#8217;s also got under others skin, and they have come up with a version of RowHammer to &#8220;root&#8221; Android devices,</p>
<p><a href="http://arstechnica.com/security/2016/10/using-rowhammer-bitflips-to-root-android-phones-is-now-a-thing/" rel="nofollow ugc">http://arstechnica.com/security/2016/10/using-rowhammer-bitflips-to-root-android-phones-is-now-a-thing/</a></p>
<p>I&#8217;m not sure how to feel about this&#8230; From my egalitarian streak, anything that alows you as an individual to take ownership of the hardware you have purchased is a good thing and allows you to exert the traditional sense of ownership over tangible objects and &#8220;The Freedom to Tinker&#8221;.</p>
<p>However another part of me knows that there are sufficient people of &#8220;evil intent&#8221; who will use such a development to act as pariahs to society in general.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285878">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285878">
						October 24, 2016 2:47 AM					</a>

				</p>

				<p>@ All,</p>
<p>You might not of heard of &#8220;Black Mirror&#8221; it started in the UK as the brain child of Charlie Brooker, who started his work life as a computer games reviewer.</p>
<p>Any way what started as Cult Noir viewing on the UK Channel 4 has moved to Netflix where it will find a larger audience.</p>
<p>Put simply it&#8217;s a near future Techno dystopia look at what could well happen with the technology of today (an earlier episode earily parallels the Trump Presidential run).</p>
<p><a href="http://www.nytimes.com/2016/10/21/arts/television/review-black-mirror-finds-terror-and-soul-in-the-machine.html" rel="nofollow ugc">http://www.nytimes.com/2016/10/21/arts/television/review-black-mirror-finds-terror-and-soul-in-the-machine.html</a></p>
<p>Give it a watch you might not get nightmares, but you should enjoy it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285879">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285879">
						October 24, 2016 2:47 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<p>The head sockets aren&#8217;t in very good shape these days&#8230; sight and sound, I guess! May I use your timeshare? 🙂</p>
<blockquote><p>However another part of me knows that there are sufficient people of &#8220;evil intent&#8221; &#8230;</p></blockquote>
<p>Keeps us busy. I think there is a solution to this rooting problem. Having flags or single bits to control access is a fundamental weakness&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285880">

			<div class="comment by-jg4 ">

				<p class="commentcredit">

					<span class="commenter">JG4</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285880">
						October 24, 2016 6:55 AM					</a>

				</p>

				<p><a href="http://www.nakedcapitalism.com/2016/10/links-102416.html" rel="nofollow ugc">http://www.nakedcapitalism.com/2016/10/links-102416.html</a><br />
&#8230;<br />
The Little-Known Company That Enables Worldwide Mass Surveillance Intercept. <a href="https://theintercept.com/2016/10/23/endace-mass-surveillance-gchq-governments/" rel="nofollow ugc">https://theintercept.com/2016/10/23/endace-mass-surveillance-gchq-governments/</a><br />
Lambert: “Wondered what role NZ was playing in 5 Eyes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285881">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285881">
						October 24, 2016 7:38 AM					</a>

				</p>

				<p>@Clive, CC: tyr</p>
<p>In response to your &#8216;walk of paths&#8217;,</p>
<p>A certain level, or a certain quality of outliers is a good thing. Everyone on this site is an outlier when you shine the light on the center of society, we might seem to be a random sample economically etc but more than likely there&#8217;s a different center point we could all be hidentified from outside of here&#8230; genetic, psychological, etc.</p>
<p>Outliers are envelope pushers, destructive or not. Yes there are malicious ones with malignant habits but there&#8217;s others that are Hark Tamils &#8211; ones that should be allowed to play and to push &#8211; sometimes maybe under supervision [and super-vision] but none-the-less allowed to participate for the greater good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285882">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285882">
						October 24, 2016 7:41 AM					</a>

				</p>

				<p>@JG4</p>
<p>It&#8217;s the usual Military-Industrial-Goverment complex which focuses on profiting over the trampled rights of their own citizens and of the notion of humanity and in favour of a highly controlled world order where citizens are simply economic generators to feed the elites.</p>
<p>It&#8217;s all about profit for elites where the rich gets richer and poor gets poorer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285883">

			<div class="comment by-skeptical ">

				<p class="commentcredit">

					<span class="commenter">Skeptical</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285883">
						October 24, 2016 9:13 AM					</a>

				</p>

				<p>@Clive: Surprised your eardrums were intact. Though I&#8217;d be more concerned if I were on the receiving end from the 30mm gun on the other side. I believe it&#8217;s going to be retired in the near future as more F-35s become operational.</p>
<p>@Nick: Probably some overlap between development of certain simulations, visualizations, and game development, but I am a little skeptical as to whether it&#8217;s enough for a company to split resources between the two. The market moves fast, and the economics often weights speed to shipment more greatly than final quality. Although I suppose if certain components were abstracted in just the right way&#8230;</p>
<p>Re recent IoT-driven ddos, autonomous/semi-autonomous vehicle hacking, and the like&#8230; the price of failures of security, and the likely liability that will attach to companies involved, will be clearer and more dramatic than much of what we&#8217;ve seen thus far. Over the long run, I think the prospects are good that the incentives will line up appropriately. The recent attacks have been on the lowest of the lowest hanging fruit &#8211; and seem to rely as much on certain servers being beyond the easy reach of Western law enforcement as anything else.</p>
<p>And, I think this particular vector will lose current rather quickly. The attack last week essentially put every company on notice that selling internet accessible devices with non-random, non-unique login credentials poses a serious danger to both customers and others in society.</p>
<p>Indeed, so easily were these devices harnessed for use of harm that frankly I think companies harmed by the events of last Friday have a plausible cause of action against the merchants of the goods utilized in the attack, though the bar for attaching liability to a person for the criminal actions of a third-party is rather high. However, given recent FTC enforcement actions, and the number of people who predicted such an event, I&#8217;d venture the suit to likely be viable.</p>
<p>Moreover, though I haven&#8217;t looked closely, I suspect there is room on federal and certain state levels for regulatory and law enforcement agencies to look hard at the question of liability or penalty for companies whose products were utilized.</p>
<p>And those companies whose products were not on Mirai&#8217;s list (but was it the full list?) but have vulnerabilities of the same class had better be very, very proactive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285884">

			<div class="comment by-jg4 ">

				<p class="commentcredit">

					<span class="commenter">JG4</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285884">
						October 24, 2016 11:22 AM					</a>

				</p>

				<p>the mention of the F-35 disaster reminded me of this excellent discussion, which is spot on the topic of nation-state security</p>
<p><a href="https://thearchdruidreport.blogspot.cz/2016/10/the-future-hiding-in-plain-sight.html" rel="nofollow ugc">https://thearchdruidreport.blogspot.cz/2016/10/the-future-hiding-in-plain-sight.html</a></p>
<p>the substance of Boyd&#8217;s work is that simple systems often outperform complex systems, besides offering the insiders less opportunity to feather their nests</p>
<p>@Thoth &#8211; your point is well taken.  the system has been perverted &#8211; or, adapted, if you prefer, to serve the needs of the few, while claiming to serve the needs of the many.  I&#8217;ve done a bad job of pointing out that many systems are adaptive and respond to feedback.  Very little of it is accidental, as wikileaks are showing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285885">

			<div class="comment by-ted ">

				<p class="commentcredit">

					<span class="commenter">Ted</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285885">
						October 24, 2016 12:54 PM					</a>

				</p>

				<p>IoT updates, patching, and taxes.</p>
<p>According to this <a href="http://deloitte.wsj.com/riskandcompliance/2016/05/20/tax-implications-of-the-internet-of-things-2/" rel="nofollow ugc">WSJ article&lt;/a href&gt; written by Deloitte Insights, IoT blurs the line between products and services. And there are different tax treatments for goods (eg: tangible products) vs services (eg: monthly subscriptions). Additionally, businesses will be taxed as a regulated utility if what they sell is deemed to be telecommunications.</p>
<p>Companies that generate increased revenue streams from service and communications-type offerings will face determinations made by regulatory and taxing authorities when they are audited.</p>
<p>There are significant administrative and technology-related costs associated with calculating and processing telecom-related taxes, fees, and surcharges. What constitutes telecommunications in one state may pass as a more basic service in another.</p>
<p>Often sorting out these issues requires litigation to finalize the appropriate tax treatment of certain offerings. According to the author, companies may benefit from designing business models around the IoT with the tax consequences in mind.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285886">

			<div class="comment by-bernard-marx ">

				<p class="commentcredit">

					<span class="commenter">Bernard Marx</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285886">
						October 24, 2016 1:07 PM					</a>

				</p>

				<p>@ all</p>
<p>Longs posts. Please keep them rolling [or scrolling]. This is not Twitter.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285887">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285887">
						October 24, 2016 1:43 PM					</a>

				</p>

				<p>From the Face-Palm file:<br />
FUD and security theatre in Kemper County, Mississippi, have resulted in the enactment of an ordnance outlawing the wearing of a clown costume by anyone of any age, until 1 November 2016.  Violators are subject to a $150 fine.</p>
<p>Clown: not OK<br />
Assault Rifle: OK<br />
WTF, over!</p>
<p><a href="http://arstechnica.com/tech-policy/2016/10/mississippi-county-bans-clown-costumes-as-internet-meme-comes-to-life/" rel="nofollow ugc">http://arstechnica.com/tech-policy/2016/10/mississippi-county-bans-clown-costumes-as-internet-meme-comes-to-life/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285888">

			<div class="comment by-joshua-pritikin ">

				<p class="commentcredit">

					<span class="commenter">Joshua Pritikin</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285888">
						October 24, 2016 2:36 PM					</a>

				</p>

				<p>Squid is loaded with cholesterol. Eat it at your peril, <a href="http://nutritionfacts.org/video/trans-fat-saturated-fat-and-cholesterol-tolerable-upper-intake-of-zero/" rel="nofollow ugc">http://nutritionfacts.org/video/trans-fat-saturated-fat-and-cholesterol-tolerable-upper-intake-of-zero/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285889">

			<div class="comment by-steak-holden ">

				<p class="commentcredit">

					<span class="commenter">Steak Holden</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285889">
						October 24, 2016 2:59 PM					</a>

				</p>

				<p>&#8220;Webcams used to attack Reddit and Twitter recalled&#8221;</p>
<p>Voluntarily? 🙂</p>
<p><a href="https://news.ycombinator.com/item?id=12778869" rel="nofollow ugc">https://news.ycombinator.com/item?id=12778869</a><br />
<a href="http://www.bbc.com/news/technology-37750798" rel="nofollow ugc">http://www.bbc.com/news/technology-37750798</a></p>
<p>&#8230;</p>
<p><a href="https://www.washingtonpost.com/news/wonk/wp/2014/10/18/poor-kids-who-do-everything-right-dont-do-better-than-rich-kids-who-do-everything-wrong/" rel="nofollow ugc">https://www.washingtonpost.com/news/wonk/wp/2014/10/18/poor-kids-who-do-everything-right-dont-do-better-than-rich-kids-who-do-everything-wrong/</a></p>
<p>&#8230;</p>
<p>&#8216;Don&#8217;t persuade people, &#8220;pre-suade&#8221; them.&#8217; I prefer to think of it as &#8220;pre-seeding&#8221;.<br />
<a href="http://www.latimes.com/opinion/op-ed/la-oe-cialdini-presuasion-20161023-snap-story.html" rel="nofollow ugc">http://www.latimes.com/opinion/op-ed/la-oe-cialdini-presuasion-20161023-snap-story.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285890">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285890">
						October 24, 2016 10:35 PM					</a>

				</p>

				<p>@ab praeceptis</p>
<p>&#8220;While I consider NaCl an excellent choice it might be desirable to provide a fallback and to not put all eggs into one basket.&#8221;</p>
<p>Curve25519 is the weakest link, not XSalsa20. I&#8217;ve given this some thought since I deprecated OTP and CEV versions. With the current version, 2-3 algorithms could be used in cascade for PSKs. It wouldn&#8217;t be too hard to implement either, most of the work was done when writing CEV version: The options are Twofish, AES and SHA3-256-CTR.</p>
<p>The issue is local key&#8217;s key decryption key would have to be 100 or 150 chars instead of current 50 to ensure no weak links in security (if rest of the keys are delivered over just XSalsa20, there&#8217;s no added security if adversary compromises the networked computer and breaks the encryption).</p>
<p>&#8220;Sampling (i.a.) random through SSH over ethernet seems to be an inconsistency actually weakening your design. It might be worthwhile to use NaCl there, too.&#8221;</p>
<p>NSA likes to talk about <a>red/black concept</a>. According to this jargon, TxM that outputs ciphertexts is what&#8217;s called a blacker. In theory it would be possible to have an entire isolated network of systems that use the TxM as a gateway; The HWRNG is an element in such network: it sits behind data diode so it can not be exploited:</p>
<p><a href="https://www.cs.helsinki.fi/u/oottela/tfcwiki/hwconf/2.png" rel="nofollow ugc">https://www.cs.helsinki.fi/u/oottela/tfcwiki/hwconf/2.png</a></p>
<p>The TCB base is of course wider but the installer is just for convenience. It would take the user 10 minutes to type the sampler program on Raspbian without it never having been connected to Internet. Otherwise, the Ethernet connected HWRNG sampler RPi stands pretty close to threat model of TxM.</p>
<p>&#8220;PBKDF2-*? From what I understand that is mainly used in contexts that require it (e.g. smartcards). Wouldn&#8217;t there be more attractive KDFs/Hash ratchets (e.g. Argon2 (PHC winner))?&#8221;</p>
<p>This is definitely something that needs improving. Most of the attacks are done with parallel CPUs.  I&#8217;m going to have to look into the differences between pbkdf2, bcrypt, scrypt and argon2, find a library and test vectors and run some performance tests but yes, it will be done.</p>
<p>I&#8217;ll take a look at the mypy when I find some time.</p>
<hr />
<p>@Clive Robinson</p>
<p>&#8220;some of [us] would like to be able to put in the same level of effort in our own non-employment coding projects&#8221;</p>
<p>It&#8217;s come with a cost on everything else in my life but I feel it&#8217;s worth it.</p>
<p>&#8220;hopefully a &#8220;well done&#8221; will sound better.&#8221;</p>
<p>You made my day! (:</p>
<hr />
<p>@Thoth</p>
<p>TFC works as long as there&#8217;s no pre-compromise of TxM (malware outputs keys to network). If this attack doesn&#8217;t happen, data diodes provide security until the adversary does their next optimal move: Exploit serial stack and inject malware to RxM that has access to RAM and a key logger. This way it can access master password, PIN and ultimately master key, that can decrypt persistent data. The sensitive keys or plaintext data stored by malware is then exfiltrated by attacker that compromises the end point physically.</p>
<p>If the smart card returns the static master decryption key (hash of signed password) to RxM, the malware can grab it from the memory and store it in plaintext. Even if the smart card would yield a new symmetric encryption key every time, malware could still store all keys or all displayed plaintext  messages separately.</p>
<p>TFC&#8217;s current persistent data encryption works against medium strength adversaries that haven&#8217;t compromised RxM but are accessing TFC files when user left screen unlocked. In this context Yubikey&#8217;s static password provides similar protection against brute force to that of a smart card with one significant drawback: If user leaves Yubikey on table, the entropy takes a few seconds to copy to personal device. Smart cards on the other hand require the PIN before they yield the key. So user can make a lot of effort to ensure future mistakes won&#8217;t have dire consequences. This is worth looking into, but then again, it&#8217;s the high strength adversaries and physical compromise by HSAs we&#8217;re worried about.</p>
<p>If smart cards would be used, best application would be ephemeral conversations, where the forward secret symmetric keys are generated based on public keys, stored and used inside the smart card. Similar to what the Google Project vault&#8217;s messenger does. That way the malware on RxM would have yet another layer up against it. Malware could still log plaintext messages displayed from the point of compromise onwards, but impersonation would be an infeasibly hard problem. A pre-requisite for this would be to have a capacitive numpad integrated into the smart card surface. That way infected RxM would have no access to PIN.</p>
<p>I have no expertise with smart card programming and use so I can&#8217;t say how much effort this all would add to end users, but if it&#8217;s doable, then any usable guide would be worth trouble integrating into TFC.</p>
<hr />
<p>@Sancho_P</p>
<p>&#8220;Have you seen [data diode designs and discussion from last week]?&#8221;</p>
<p>Apologies, getting the release out took most of my time. The data diode design and article is fantastic. All the necessary information is there. Rx side is powered by the RxM so that&#8217;s a huge plus. I have a USB-TTL converter lying around somewhere but local stores do not carry the optocoupler model, so testing is going to have to wait. The material looks great: I&#8217;d love to add the article to TFC wiki (you&#8217;d get the credits naturally), if you don&#8217;t mind that is.</p>
<p>As for the trust on hardware, COTS has it&#8217;s risks, and functionality of optocoupler isn&#8217;t verifiable any way. I would imagine though that if the local electronics store that carries these components is infiltrated and adversary hands out IC with malicious logic, user is targeted to the extent one or another close access operation will get them in the end.</p>
<p>The only way to mitigate this is to make the original design work with a phototransistors that replaces PNA1801LS. A list of compatible LED-phototransistor pairs is really needed.</p>
<p>The paper by Jones et. al. gives following specs to phototransistor:</p>
<p>handles 20mA forward current at 15 volts<br />
collector current of at least 3mA at 500 Lux<br />
peak sensitivity near 800nm<br />
4μs response time</p>
<p>the LED would have to have</p>
<p>maximum current rating of 20mA<br />
2.2V nominal forward voltage drop<br />
Non-diffusing package</p>
<p>I&#8217;m not sure if the panasonic LN28RCPP and LN28CPP LEDs are still in stock somewhere.</p>
<p>The great thing about these simple components is it&#8217;s much harder to hide logic inside them so ordering from online store would be almost risk-free.</p>
<p>&#8220;Imagine to wait 3 minutes only to see “Failed, checksum error” on the receiving side.&#8221;</p>
<p>The latest version of TFC features Reed-Solomon erasure codes (used e.g. in CDs) so that should fix most of the transmission errors:<br />
<a href="https://github.com/maqp/tfc/blob/master/Rx.py#L4342" rel="nofollow ugc">https://github.com/maqp/tfc/blob/master/Rx.py#L4342</a></p>
<p>&#8220;I don’t know if @Markus Ottela ran into speed issues because of the converters, the coupler or whatever (USB, OS, TFC SW). It seems he didn’t see the proposal or doesn’t find the time to acknowledge.&#8221;</p>
<p>The issues were with optocoupler. The simple wire-based data diodes (<a>left-most</a>) have handled RS232&#8217;s 115200 bd/s fine.</p>
<p>&#8220;I guess any automated feedback would be a no go for a data diode as it would constitute an information channel back to the source&#8221;</p>
<p>I agree. I&#8217;d rather make all the retransmissions in the world than risk covert return channel.</p>
<hr />
<p>@Figureitout</p>
<p>&#8220;There <em>could</em> maybe be some kind of crazy attack there over powerlines thru a powersupply but not worth it IMO to fully prevent that.&#8221;</p>
<p>I pondered about this for some time. My threat model is mainly batteries dying on me when I&#8217;m demoing the system so it&#8217;s fine for me. Some users might consider the side channel risk too big. A DC connector leaves room for options from power supplies to large battery packs.</p>
<p>RE: <a href="https://www.adafruit.com/product/2107" rel="nofollow ugc">https://www.adafruit.com/product/2107</a> I wonder if shared ground loop was the reason I got so terrible readings with my scope when trying to analyze the bare output of USB-TTL adapter. Will have to investigate</p>
<p><a>&#8220;Have you experienced any errors yet?&#8221;</a></p>
<p>This question was directed to Sancho_P but I&#8217;ll just say that outside what bad Python code has caused, not really. The CNY75A works very reliably at 9600 bd/s and during testing where I sent packets together with their checksums, not even 19200 bd/s had any issues (hence the speedup in latest version). The reason I did not use faster speed since beginning was my scope displayed <a>slight latency in rising edges.</a>. Turns out it wasn&#8217;t a problem.</p>
<p>&#8220;You&#8217;d prefer silent fail?&#8221;</p>
<p>Unrecoverable transmission errors display warning to user: <a href="https://github.com/maqp/tfc/blob/master/Rx.py#L4343" rel="nofollow ugc">https://github.com/maqp/tfc/blob/master/Rx.py#L4343</a></p>
<hr />
<p>@Ratio</p>
<p>IIRC it was Frederic Jacobs who talked about pip using no authentication over downloaded packets.<br />
The SHA256 hashes might do the trick so I&#8217;ll have to re-investigate.</p>
<p>The hwrng.py docstring is incorrect, 768 is valid length for entropy queries (It really confuses when docstrings are out of date. This will be fixed).</p>
<p>I&#8217;ll have to dive deeper into the input validation check but huge thanks for pointing this out!</p>
<p>Duplicate code is a big issue. At some point the code is going to have to be rewritten from start into smaller packages. &#8220;Simple is better than complex&#8221; but having slightly different implementations of each function for different programs might be just bad design.</p>
<p>Global variables are a problem too, I&#8217;ve tried to keep the number at absolute minimum.</p>
<p>Again, thank you so much for taking the time to review the code! I&#8217;ve much to learn but it&#8217;ll get there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285891">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285891">
						October 25, 2016 12:00 AM					</a>

				</p>

				<p>@ Joshua Pritikin,</p>
<blockquote><p>Squid is loaded with cholesterol. Eat it at your peril</p></blockquote>
<p>It&#8217;s a complex ill understood subject at best&#8230; Not all lipids are the same, if you ask most doctors will tell you the HDL good LDL bad advice. The problem is the evidence behind the mantra is not as clear cut as many portray it. There is also good LDL as well as bad but the cost of the tests to differentiate is almost eye wateringly high.</p>
<p>Further have you ever asked how much dietary LDL cholesterol makes it across the gut barrier to directly become LDL blood cholesterol?</p>
<p>The answer is nowhere as much as many have tried to make you belive in the past (or currently). It turns out on investigation that the liver is responsible for most of the LDL in your body.</p>
<p>The liver manufactures and secretes LDL into the bloodstream, and does not require any dietary cholesterol to do so. What is not clear is what all the LDLs it produces are for&#8230;</p>
<p>Part of this is that there are receptors on your liver cells that can &#8220;monitor&#8221; and try to adjust the various LDL levels. If however, you have fewer liver cells (which some people do due to genetics), or if they do not function effectively, the various LDL levels may rise. But there may be other reasons for the rise in certain LDL production.</p>
<p>For reasons of &#8220;doctrine&#8221; and &#8220;funding sources&#8221; [1] few experiments were carried out in the past into what effect sugar has in the bodies reaction to it&#8217;s effects (the Keys &#8220;Sugar good, Fat bad&#8221; mantra). This is now changing and more balanced research is being carried out and steadily it is being found that whilst some LDL causes plaques in the arteries, it appears to be as a defence mechanism to other efects, some of which are caused by sugar&#8230;</p>
<p>We by no means have all the answers, but unlike the last fourty to fifty years we are now starting to do the research&#8230; So time will hopefully produce more answers. But one thing that is hard not to notice is the epidemic of heart attacks, strokes, TIAs, stones etc that have hit the western world, appear to be historicaly as a delayed consequence of our &#8220;sweet tooth&#8221; and &#8220;salty tongue&#8221; and excess calorific intake from simple carbohydrates.</p>
<p>One thing that is becoming recognised is that &#8220;sugar&#8221; triggers a response in the brain that unlike proteins does not sate our hunger / appetite. It&#8217;s been argued that this is a survival mechanism. The reason is that simple carbohydrates like sugars are only plentiful in late summer and early autumn in non equitorial regions. This is at a time when many animals lay down fat stores to see them through the winter months when all forms of plant foods are scarce, thus some even hibernate. It therefor appears logical to assume similar mechanisms are part of human survival.</p>
<p>[1] See history of &#8220;pure white and deadly&#8221; and other articles about Keys deliberate misreading of his own study and the funding sources from the &#8220;corn syrup&#8221; industry and the effects they had on what research was done.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285892">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285892">
						October 25, 2016 1:59 AM					</a>

				</p>

				<p>Markus Ottela</p>
<p>&#8220;Curve25519 is the weakest link&#8230;&#8221; &#8211; Of course, as is PK Crypto generally. For one the quality of numbers used, in particular of primes, often isn&#8217;t exactly ideal. Plus, of course, the sword of pq (I took the liberty of handing Damokles a post-crypto sword *g) is hanging over our PK crypto.</p>
<p>I&#8217;ve played with a &#8220;bandaid&#8221; idea for a while. &#8220;bandaid&#8221; because it doesn&#8217;t avoid the pq problem but makes it relatively cheap to use a &#8220;PK ratchet&#8221; (pardon my english).</p>
<p>The logic is this: When chosing the private key for Curve25519 ECDH, why not chose one that is prime and can serve as input for stage 2 (RSA)? If the price isn&#8217;t too high, we can at least protect ourselves against either one of them broken. The effectively used SK for sym crypto could then be, say hashed(SK 1) xor hashed(SK 2) (or whatever mangling recipe you like).</p>
<p>&#8220;Twofish, AES and SHA3-256-CTR&#8221; &#8211; luxury for later, not at all urgent. As you correctly stated, PK is the hot zone. The sym. algos are damn well analyzed and tested and deservedly well established.</p>
<p>&#8220;bcrypt, scrypt and argon2&#8221; &#8211; Argon2 was the winner in the contest and for good reason. <em>If</em> you want to have alternatives, have a look at the other finalists. Interesting and worth a good look anyway.</p>
<p>&#8220;I&#8217;ll take a look at the mypy when I find some time.&#8221; &#8211; Do yourself (and your project) a favour and find that time <em>soon</em>. MyPy is a very simple and comfortable way with next to 0 learning curve to have your python code (pseudo but checked) statically typed. Doing crypto with dyn. typing is just inviting trouble it seems to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285893">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285893">
						October 25, 2016 3:31 AM					</a>

				</p>

				<p>@Markus Ottela<br />
In my original Root of Trust design above, I did mention that keys are not exportable. Once the user enters the correct secrets into my smart card scheme, it turns into an encryptor assuming you don&#8217;t have a ton of things to encrypt since I assume the encrypted database would not be more than 300 KB ?</p>
<p>The smart card can also be doubled as a message encryptor like Project Vault which can be adapted to. The drawback is that smart cards are rather slow encryptors so they are mostly suited for signature checking and unwrapping the KEK.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285894">

			<div class="comment by-wesley-parish ">

				<p class="commentcredit">

					<span class="commenter">Wesley Parish</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285894">
						October 25, 2016 3:50 AM					</a>

				</p>

				<p>@Europe vs American Models</p>
<blockquote><p>People with conscience and morals used to run America. Now its tax dodging, profit minded Wall St backed corporations using big-data to crush competition.</p></blockquote>
<p>That&#8217;s rather an oversimplification, and plays right into the hands of the US. It&#8217;s interesting to examine what the others think of that:<br />
<a href="http://www.republicoflakotah.com/steps-to-sovereignty/158-year-stuggle-for-justice/" rel="nofollow ugc">http://www.republicoflakotah.com/steps-to-sovereignty/158-year-stuggle-for-justice/</a></p>
<p>The simple truth is that the US government never intruded on the rights of anyone who could fight back either in the courts or the battlefield unless they had overwhelming advantage; likewise US big business &#8211; you should read Norbert Wiener. In one of his books, in the preface or epilog (I&#8217;ve forgotten which one: I thought it was God &amp; Golem, but I&#8217;ve misplaced my copy) the person giving the biography tells about his former opposition to workers&#8217; rights and the change in mind occasioned by discovering just how petty, low and stupid the bosses actually were as compared with the dignity of the workers he met and came to like. A bit of US union history might work wonders: everybody&#8217;s taught that the unions established themselves through violence: what nobody ever acknowledges is that the bosses hit first and bloodiest. They only conceded when they were outfought.</p>
<p>Norbert Wiener?<br />
ht tps://archive.org/stream/NorbertWienerHumanUseOfHumanBeings/NorbertWienerHuman_use_of_human_beings_djvu.txt</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285895">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285895">
						October 25, 2016 10:48 AM					</a>

				</p>

				<p><b>Another root to an Android&#8217;s heart</b></p>
<p>It&#8217;s not been a good past few days for Android with the variation on RowHammer and now Dirty Cow,</p>
<p><a href="http://arstechnica.com/security/2016/10/android-phones-rooted-by-most-serious-linux-escalation-bug-ever/" rel="nofollow ugc">http://arstechnica.com/security/2016/10/android-phones-rooted-by-most-serious-linux-escalation-bug-ever/</a></p>
<p>As I&#8217;ve already indicated <a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html#c6736918" rel="nofollow ugc">above</a> I have mixed feelings on such exploits, but when all is said and done I come out on the right of &#8220;freedom to tinker&#8221; because that is what moves society out of the maws of the unproductive &#8220;rent seaking&#8221; wasteralls.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285896">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285896">
						October 25, 2016 2:49 PM					</a>

				</p>

				<p>@ab praeceptis</p>
<p>&#8220;When chosing the private key for Curve25519 ECDH, why not chose one that is prime&#8221;</p>
<p>Curve25519 ECDHE is nice as it takes any 256-bit value as valid private key. I&#8217;d rather not reduce the keyspace into just all the 256 bit primes (I wonder what the ratio is). The sad truth is equivalent amount of security for classical DHE has large enough keys to drive the user typing them insane. And while the QC qubit requirements are higher, they&#8217;re not outrageous. IANAC but if djb is fine with Curve25519, I think it&#8217;s good enough until QC comes. If QC is part of user&#8217;s threat model, PSK is the way to go.</p>
<p>RE: PHC finalists<br />
Good point. It would be interesting to see if there were performance over security tradeoffs made there like in the case of Rijndael vs Serpent during AES.</p>
<p>@Thoth</p>
<p>After the 256-bit local key is stored into the smart card the rest is free for the contacts. RxM side smart card needs to store two 256-bit keys for sending and receiving. The TxM side basically needs only 256-bit keys for sending, but I think it&#8217;s worth it to store a hash that can verify identities of parties during initial key exchange, e.g. SHA256(&#8220;fingerprint&#8221; + public key with smaller value + public key with larger value). The string &#8220;fingerprint&#8221; is just for domain separation. You said keys are not exportable. Is this by design or is it possible to control the exportability so that only the hash of public keys is exportable and not the symmetric keys.</p>
<p>In addition to keys each contact needs the hash ratchet counters (64 bits) plus a UID, for this purpose 12 bits.</p>
<p>(300 * 1000 * 8 &#8211; 256) / (512 + 64 + 64 + 12) = 3680 contacts that is slightly less than the 12 bit UID space (4096).</p>
<p>The XMPP account is somewhat public knowledge so storing mappings of UID and XMPP accounts on TxM/RxM isn&#8217;t a huge problem. As long as conversations are not logged on the smart card I don&#8217;t think there&#8217;s a problem with the limited space.</p>
<p>Smart cards may be slow but unlike TxM/RxM currently, they don&#8217;t have to re-encrypt the entire key database after every message. Just encrypt+sign/auth+decrypt 255-byte string, run the key once through SHA256 and update the hash ratchet counter. That&#8217;s all. Any idea what the performance numbers are on your ChaCha20(-Poly1305?) implementation or AES?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285897">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285897">
						October 25, 2016 3:41 PM					</a>

				</p>

				<p>Markus Ottela</p>
<p>You are right (prime size) but: It&#8217;s just a (reasonable) recommendation to use 2 roughly equal primes for modulus generation. It makes sense, no question but unless your opponent is a) extremely potent and b) already has cracked the ECC part, this is of rather little concern with my mechanism.</p>
<p>Again, my bandaid idea is an <em>addition</em>. The question of how (in)secure a (effectively, it is to be assumed) 512 bit RSA modulus is, is not that trivial because even 512 bit RSA moduli aren&#8217;t factored in seconds (it is a reasonable assumption that today a mid-size academic cooperation would need some weeks to do that; nsa might do it in days, maybe even hours if your stuff is important enough for them to throw all their resources at it). But again, that&#8217;s an additional or, worst case (ECC broken) an emergency security layer (512 bit is much less then 1K or 2K bit but <em>so much better than nothing</em>).</p>
<p>Moreover, the &#8220;use roughly same size primes&#8221; does not suggest that an RSA modulus of, say a 256 but and a 768 bit prime is as trivial to factor as a 512 bit modulus; it merely suggests that it&#8217;s simpler than a 512/512 modulus, which brings us into the grey area of not yet feasible or extremely expensive.</p>
<p>So, I still think that my bandaid mechanism might be useful, at least as an option.</p>
<p>But, of course, I&#8217;m not a vendor. You don&#8217;t like my mechanism, no problem. I merely like to think of ways for a poor man (compared to nsa or even a university) to defend himself well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285898">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285898">
						October 25, 2016 4:38 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>You are welcome, do whatever you want with that stuff, tell me in case you need more / something else.<br />
HCPL7723:<br />
In small quantities you will have to order that optocoupler from mouser, digikey, tme or so, even amazon have it listed (SMD only, shocking price).<br />
Make your electronic store (if there is any) order it for you, that’s easy in respect to tax and customs, plus there is another “isolator” between source and “target”.</p>
<p><i>”As for the trust on hardware, COTS has it&#8217;s risks, and functionality of optocoupler <b>isn&#8217;t verifiable any way</b>. I would imagine though that if the local electronics store that carries these components is infiltrated and adversary hands out IC with malicious logic, user is targeted to the extent one or another close access operation will get them in the end.”</i> (my emph.)</p>
<p>I’m not sure if I understood your concerns. First, they’d have either to infect ALL devices (very costly for a mass product plus with very high risk of unintended side effects and detection, do not underestimate competitors’ <i>curiosity</i>) or to have an agent at your local store.<br />
The latter is only feasible if you are a very valuable target.<br />
However, there is still hope:<br />
Also a simple optocoupler can be tested (230 VAC hint @Figureitout) and you will connect only one transmission line to the FT232.<br />
On the other hand, any <b>USB</b> / TTL converter is a soft target, so better use the RasPi’s UART lines directly.</p>
<p>Forget about the phototransistor if you want to transmit more than Morse code using your flashlight. No way for reliable + homemade kBps.</p>
<p>Re your discussion with @Figureitout:<br />
[adafruit adapter] <i>”I wonder if shared ground loop …”</i><br />
This is a USB to USB isolator, not USB-TTL, a completely different device.<br />
It’s intended to be completely transparent to all USB negotiations, commands and data. Of course you’d be free to connect GND of input and output, no problem.</p>
<p>Re: Reed-Solomon erasure code: Good!<br />
I love it (however, it’s probably over my head).</p>
<p>But:<br />
<i>”Unrecoverable transmission errors display warning to user: <a href="https://github.com/maqp/tfc/blob/master/Rx.py#L4343" rel="nofollow ugc">https://github.com/maqp/tfc/blob/master/Rx.py#L4343</a><br />
”</i><br />
 Exactly what I was talking about, this is crap, totally unacceptable in critical mission or security.<br />
Sorry.</p>
<p>I’ll try another simple analogy, this time from the as-famos-as-stupid car domain:<br />
Driving home you have to hit the brake in an emergency, but nada, zilch,<br />
a simple but true message comes up: “Brake failure!”.<br />
Waking up after 3 months in coma you are told “Brake fluid was gone”.<br />
Soooo…</p>
<p>Shouldn’t we have a warning before failure? In case someone has touched …?</p>
<p>But be aware: Real, true security isn’t digital, isn’t true or false.<br />
This is also why my example (the simple brake fluid level switch) is crap.<br />
That’s not security, that’s a farce.</p>
<p>pass …<br />
Good you didn’t invest time here yet 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285899">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285899">
						October 25, 2016 8:04 PM					</a>

				</p>

				<p>@Sancho_P</p>
<p>RE HCPL7723:</p>
<p>Will have to take a look. Ordering ICs online is asking for trouble, but using an electronics store as proxy might indeed help.</p>
<p>&#8220;On the other hand, any USB / TTL converter is a soft target, so better use the RasPi’s UART lines directly.&#8221;</p>
<p>This assumes all computers are RasPis.</p>
<p>&#8220;Forget about the phototransistor if you want to transmit more than Morse code using your flashlight. No way for reliable + homemade kBps.&#8221;</p>
<p>The paper by Jones et. al. says 1200 bd/s works reliably. This might be slow but that doesn&#8217;t mean it isn&#8217;t in the interest of many users who would rather have the assurance over the speed. Let the user decide.</p>
<p>&#8220;Exactly what I was talking about, this is crap, totally unacceptable in critical mission or security. Sorry.&#8221;</p>
<p>This is instant messaging we&#8217;re talking about, not delivering nuclear launch codes. As I said, I haven&#8217;t encountered any transmission errors with data diodes so far. The Reed-Solomon wasn&#8217;t added because it was needed, but because it&#8217;s good protocol design. Even if you had to re-send one message in a thousand, it&#8217;s like having to restart a car on a winter&#8217;s morning. Having an ACK channel leak the private keys from RxM &#8212; <em>that</em> is having the breaks fail; There&#8217;s no warning light.</p>
<p>If you have a trivial, provably secure way to verify transmissions, I&#8217;m willing to listen. Otherwise I see no reason to endanger security over nonexistent problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285900">

			<div class="comment by-sleepless-knights ">

				<p class="commentcredit">

					<span class="commenter">Sleepless Knights</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285900">
						October 25, 2016 8:49 PM					</a>

				</p>

				<p>Bingo.</p>
<p><a href="https://www.digitalbond.com/blog/2013/10/22/call-yourself-a-hacker-lose-your-4th-amendment-rights/" rel="nofollow ugc">https://www.digitalbond.com/blog/2013/10/22/call-yourself-a-hacker-lose-your-4th-amendment-rights/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285901">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285901">
						October 25, 2016 9:35 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>&#8220;but I think it&#8217;s worth it to store a hash that can verify identities of parties during initial key exchange, e.g. SHA256(&#8220;fingerprint&#8221; + public key with smaller value + public key with larger value)&#8221;</p>
<p>This can be done. Pretty easy.</p>
<p>&#8220;You said keys are not exportable. Is this by design or is it possible to control the exportability so that only the hash of public keys is exportable and not the symmetric keys.&#8221;</p>
<p>This depends on whoever write the applet codes. If the developer does not include a mechanism to export,  there is no way to extract it. If you include a method to export, it can be exported in secure or insecure fashion whichever the developer chooses.</p>
<p>&#8220;As long as conversations are not logged on the smart card I don&#8217;t think there&#8217;s a problem with the limited space.&#8221;</p>
<p>Most smart cards have 80 KB EEPROM and that includes the executable. Better to store non-cryptographic stuff or things that do not need smart card protection off the card and use a card&#8217;s key to wrap them if necessary.</p>
<p>&#8220;Smart cards may be slow but unlike TxM/RxM currently, they don&#8217;t have to re-encrypt the entire key database after every message. Just encrypt+sign/auth+decrypt 255-byte string, run the key once through SHA256 and update the hash ratchet counter. That&#8217;s all.&#8221;</p>
<p>Indeed there is no need to re-encrypt the key database since the smart card already is a secure environment that is also tamper resistant by itself. Hmmm&#8230; if you have to re-encrypt your database after every messsagem wouldn&#8217;t that mean that your TFC have a significant overhead everytime you send a message since you must re-encrypt key database  after every message ?</p>
<p>&#8220;Any idea what the performance numbers are on your ChaCha20(-Poly1305?) implementation or AES?&#8221;</p>
<p>ChaCha/Poly1305 will be slower than a snail crawling. Better not to go that direction. For AES-256 encryption including I/O to smart card over a 200 byte string, that will take somewhere between 70 to 90 ms. The ciphering is not the lagging part. It is the I/O that is slowing down portion of the scheme. Most ciphering will take from 2ms to 40ms at most and for Infineon chip via SLCOS (COS are the different types of Card Operating System) type cards, it does it around 2ms+ and for FTJCOS type cards it does it around 4+ ms for ciphering a 200+ byte string.</p>
<p>What kind of speed are you looking at and how much bytes you need to encrypt/decrypt/sign/auth/hash depends on the use cases.</p>
<p>Just an idea of the timing used, 1 second is 1000 ms and let&#8217;s assume the Smart Card I/O (both ways altogether calculated) + AES ciphering activity + SHA256 hashing takes 90ms which is 0.09 seconds done over a byte string of 200 bytes.</p>
<p>A cautionary note is getting smart cards to encrypt something like a PDF file, images or multimedia, the user might not be patient enough to wait for 345 KB PDF to de/encrypt and hash while thumbing their fingers and waiting for 2.5 minutes via AES-256-CBC-PKCS5-SHA256 scheme. Anything done on smart card should usually be completed within 3 I/O cycles (256 bytes * 3 cycles of I/O) otherwise the user probably would pull their hair out.</p>
<p>Do note that smart cards don&#8217;t support Curve25519 since it&#8217;s not NIST standardized. These cards usually support RSA-2048 and for the lucky few, RSA-4096 would be supported too if users are willing to pay cash for those kind of security. NIST ECC cruves are expected on most modern cards with key sizes usually up to 256 bits.</p>
<p>My recommendation is to use smart cards for their AES/SHA hardware and to use it to secure critical codes and data (i.e. integrity checksum comparisons for key databases) that you are worried that malwares might attempt to alter, deny or exflitrate since the only practical way into a smart card other than physical decaps and physical attacks is via it&#8217;s APDU logical protocol which is easily audited, open standards and controlled by the developer of the applet if you know where and what to look for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285902">

			<div class="comment by-0xc4 ">

				<p class="commentcredit">

					<span class="commenter">0xc4</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285902">
						October 25, 2016 10:42 PM					</a>

				</p>

				<blockquote><p>Going cold is a way that the average user can “air gap” our records, in a way that minimally interferes with our day-to-day rhythms, while treating special, sweeping requests as the sensitive events that they are.</p></blockquote>
<blockquote><p><b>Strong dark archives: people or institutions to stand guard over our lives’ data</b></p></blockquote>
<p>(shamir&#8217;s secret sharing?)</p>
<blockquote><p>Imagine if instead of simply storing digital documents in a manner which was readily recoverable, sensitive data at rest were encrypted with a key that is then broken into fragments, with each “horcrux” held by a fiduciary in a different jurisdiction.</p></blockquote>
<blockquote><p>No one trustee—nor the donor—could jump the gun and get to the data—but the right group of them can. This would also, in some cases, help mitigate the duress that a particular person could be put under to turn over a key, since only part of a key is held.</p></blockquote>
<p>All this talk of security and non-repudiation without any mention of kleptography or the vulnerability of endpoints? Uh-oh!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285903">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285903">
						October 25, 2016 11:05 PM					</a>

				</p>

				<p>@ Markus Ottela, Sancho_P,</p>
<blockquote><p>If you have a trivial, provably secure way to verify transmissions, I&#8217;m willing to listen. Otherwise I see no reason to endanger security over nonexistent problem.</p></blockquote>
<p>As Claude Shannon formalised and others before him demonstrated, no physical communications path is &#8220;100% reliable&#8221;. It boils down to,</p>
<p>1, What Bit Error Rate (BER) you can get on average.</p>
<p>2, How you detect any errors.</p>
<p>3, The higher level protection protocols you use to resolve them.</p>
<p>So lets assume the BER is low(ish) on average(1) and take a look at what methods there are to detecting errors(2).</p>
<p>The normal way to detect errors these days is with some kind of mathmatical function ranging from simple parity checks upwards. Each of them adds bits to the data sent and Richard Hamming was one of the first to show that some functions can also be used to correct errors.</p>
<p>This in turn gave rise to the notion of Forward Error Correction (FEC) codes. However all FEC&#8217;s have limits based on the BER of a given channel and other methods have to be used in high BER conditions all of which use a feed back channel which it&#8217;s self is subject to errors&#8230; So it is always possible for errors not to be detected or corrected.</p>
<p>The use of a simple feedback loop is one way to detect errors but is as prone to giving false errors as it is to detecting real errors due to having two equal length channels in the same environment. However it provides a logical starting place from which to work.</p>
<p>One thing a simple feedback loop can do is detect errors without leaking any other information from the receiver, which is desirable from a security perspective.</p>
<p>The way you do this is to chain the transmit path back to the the transmitters receive path at the receiver and the transmitter checks what you could call the &#8220;echo&#8221;.</p>
<p>So the total path would be, from the transmitter transmit pin to the TX opto-coupler input, from the TX opto-coupler output to the receiver receive pin, which is then tee&#8217;d off to the RX opto-coupler input, from the output of the RX opto-coupler to the receiver pin of the transmitter.</p>
<p>Provided the transmitter receives what it sent, either the bit was correctly delivered to the receiver receive input or there were an even number of coincidental errors in the total path. Over short data paths such errors most usually happen when a single element common to more than one segment of the path glitches. The usuall suspects are the likes of power supplies under electrical noise or common connectors/cables under mechanical noise.</p>
<p>The question then arises of how do you deal with errors that arise in that path as well as how you deal with errors beyond the receiver receive pin. these are standard questions and have standard answers under various different assumptions bassed on path reliability and the nature of the actuall transmission such as half or full duplex. When security of the transmitter is the major concern the usual option is not to have feedback from the subvertable parts of the receiver, thus half duplex operation is assumed. Which in turn means FEC and either accept that there will be errors or at some much higher part of the system a method of requesting a retransmission at some later point in time, be it in full or in part. Such higher level signaling protocols was addressed in an insecure way with the likes of Kermit and Z-Modem some thirty years ago and in very unreliable radio paths with very high BER by the likes of Automatic Repeate reQuest (ARQ) protocol systems like SiTOR and AmTOR some forty years ago, with later additional error detecting and correcting methods in PacTOR. These basic protocols can be augmented by better FEC and other codes, but the gain is not likely to be seen in anything other than unreliable and noisy channels.</p>
<p>I&#8217;ll stop at this point because all feedback from susceptible parts is a potential covert channel and that has a whole load of additional issues, that require other aspects to detect and correct such as voting protocols to detect &#8220;traitors&#8221; long time delays on errors etc to reduce the covert channel bandwidth and other issolation techniques.</p>
<p>Oh one last point, speaking of issolation techniques, if the receiver receive pin is not a true input pin but a general purpose software selectable I/O pin (GPIO) then it is subvertable. You can solve this by putting a buffer in to provide isolation between the tee point of the path and the receiver GPIO receive pin (nobody said &#8220;thinking hinky&#8221; was easy 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285904">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285904">
						October 25, 2016 11:12 PM					</a>

				</p>

				<p>&#8220;Better to store non-cryptographic stuff or things that do not need smart card protection off the card and use a card&#8217;s key to wrap them if necessary.&#8221;</p>
<p>That&#8217;s actually a lot better idea. To store all keys on TxM/RxM and to store one key encryption key on the smart card. The smart card authenticates whatever keys are input before decrypting and using them. More I/O but significantly less space requirements.</p>
<p>&#8220;wouldn&#8217;t that mean that your TFC have a significant overhead everytime you send a message since you must re-encrypt key database after every message ?&#8221;</p>
<p>At the moment yes, but by default we&#8217;re talking about less than 75kB of data per contact database, it&#8217;s so fast you barely notice it on gen 1 RPi &#8212; anything faster (e.g. $200 netbook) and it&#8217;s completely unnoticeable.</p>
<p>&#8220;What kind of speed are you looking at and how much bytes you need to encrypt/decrypt/sign/auth/hash depends on the use cases.&#8221;</p>
<p>This depends on how much data should leak to physical attacker compromising TxM/RxM. Each entry in RxM database has 11 fields that are all padded to 255 bytes prior to encryption, so if contacts are separated to independent files it&#8217;s 2.8kB per contact. If the number of entries is hidden by padding the entire database (by default 20 contacts), the database size is always 56kB.</p>
<p>So ~100ms for 255 byte message isn&#8217;t a problem but databases might.</p>
<p>Is the AES authenticated encryption (e.g. GCM), or is SHA256 MAC required?</p>
<p>RE: curves</p>
<p>This is a big problem. Typing 2k/4k RSA public keys isn&#8217;t practical, and <a>like Bruce</a>, I don&#8217;t think the P-curves are trustworthy. But threat models vary and not every nation state has access to the backdoor. Maybe. So it might be useful addition under some threat models. Hopefully Yubico etc. will build devices that use Curve 25519 for signing and key exchange.</p>
<p>&#8220;My recommendation is to use smart cards for their AES/SHA hardware and to use it to secure critical codes and data&#8221;</p>
<p>It is useful but if RxM is compromised, it might be that whatever native software is authenticating e.g. TFC software with the help of smartcard, might give false-positive answer. I think the best use for smart card under the threat model is to protect the keys and prevent impersonation. But again, the pin code needs a secure input channel and I&#8217;m not sure the tech exists yet.</p>
<p>One option would be to run TxM and RxM with Tails live distro from DVD, and store all persistent TFC files on something like <a>this</a> that has an alphanumeric password and overwriting features. With $400 price tag it&#8217;s not for the average user.</p>
<p>A less expensive alternative would be<br />
<a href="https://istorage-uk.com/product/datashur/" rel="nofollow ugc">https://istorage-uk.com/product/datashur/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285905">

			<div class="comment by-equation-group ">

				<p class="commentcredit">

					<span class="commenter">Equation Group</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285905">
						October 25, 2016 11:39 PM					</a>

				</p>

				<p>Live from Maryland, it&#8217;s tuesday night:</p>
<p><a href="https://news.slashdot.org/story/16/10/25/2319236/scientists-create-ai-program-that-can-predict-human-rights-trials-with-79-percent-accuracy" rel="nofollow ugc">https://news.slashdot.org/story/16/10/25/2319236/scientists-create-ai-program-that-can-predict-human-rights-trials-with-79-percent-accuracy</a></p>
<p>That&#8217;s right humans, from hence point forth the object of this game is out of bounds.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285906">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285906">
						October 26, 2016 12:13 AM					</a>

				</p>

				<p>@ Markus, Bruce,</p>
<p>On the same page you link to Bruce also <a href="https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1680014" rel="nofollow ugc">says,</a></p>
<ul><i>Clearly I need to write an essay about how to figure out what to trust in a world where you can&#8217;t trust anything.</i></ul>
<p>I don&#8217;t remember if that essay ever appeared?.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285907">

			<div class="comment by-re-porpoise ">

				<p class="commentcredit">

					<span class="commenter">RE: Porpoise</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285907">
						October 26, 2016 12:37 AM					</a>

				</p>

				<p>In sum, we&#8217;ve replaced judge and executioner with robots. What&#8217;s next? the jury too?? In all likely hoods, global warming will offset the chilling effect the reality of 1984 has had on us all and anyone even flirting with holding a picket sign will be identified flagged and tagged for removal through the remote sensing of your mood swings facial expressions and explitives. This will enable them [not us] to intervene on behalf of the greater good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285908">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285908">
						October 26, 2016 12:54 AM					</a>

				</p>

				<p>Clive Robinson</p>
<p>Slightly extending on your mentioning Shannon (hitting the nail), if I may.</p>
<p>I&#8217;m amazed over and over again at the grey zone where philosophy and physics touch each other. Following the rabbit hole (that&#8217;s a proper english phrase, no?) examined and researched by Shannon deeper, one finally(?) arrives at quants (and quarks, too, btw) which, if we haven&#8217;t gotten that completely wrong, prove and necessitate entropy and, more importantly, the absence of any reference (at least over any not insignificant amout of time (which opens another rabbit hole, but I&#8217;ll stay on path)).</p>
<p>In other words:</p>
<p>a) security is provably not achievable. What is achievable, and what all security is bound to be limited to, is an aproximation. Neither is &#8220;justified trust&#8221;, i.e. the certainty not to be failed.</p>
<p>b) security is, indeed, as many (like Bruce Schneier, you, and quite some of us) have so boringly (and correctly) repeated, no state but a process (which I would like to elaborate because that intimately and causally related to what we  see in sw and hw, but I&#8217;ll refrain).</p>
<p>c) we ask many questions around security, such as &#8220;against what?&#8221; but we tend to ignore an immensely important question: &#8220;Over what amount of time and when?&#8221;.</p>
<p>Gladly, and that&#8217;s where my approach differs from e.g. yours, we <em>can</em> achieve quite satisfyingly high levels of security, due in part to the fact that our opponents meet similar barriers as we do. Maybe now I can show better why I have such a pragmatic attitude (see also (d)).</p>
<p>d) Cost for security increases exponentially or near exponentially (which is funny because, on the other hand, we perceive mechanism a secure that drive our opponents cost up exponentially *g).</p>
<p>Praised be Shannon. That man&#8217;s work was indeed important and profound.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285909">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285909">
						October 26, 2016 12:55 AM					</a>

				</p>

				<p>@Markus Ottela, Figureitout, Clive Robinson, Nick P<br />
Please do not mention dataShur as a secure device. I remembered I have busted dataShur as INSECURE device on one of the posts somewhere.</p>
<p>You should start reading the dataShur Common Criteria paper and you will be appalled at how insecure it is. If you give the dataShur to @Figureitout, the dataShur becomes dataUnshur !!!</p>
<p>You have some technical backgrounds yourself and you should actually consider experimenting with defeating dataUnshur yourself if you have time and money. The security of dataUnshur is it has no tamper resistance at all. None. It relies on it&#8217;s USB microcontroller to accept a PIN and do the security operations and the USB microcontroller can be a PIC chip and there are tonnes of materials in the wild on how PIC chips are NOT security chips. What dataUnshur relies for security is just a bunch of tamper evident epoxy and that&#8217;s all.</p>
<p>Too bad I don&#8217;t have access to strong acid and all that as you need a chemist license to operate a lab in Singapore otherwise I would have decapped that thing long time ago. How dataUnshur works is PIN and crypto are all bunched into the PIC chip. If you enter the wrong PIN, the PIC chip acts as a hardware router that simply denies USB mounting. If you enter the correct PIN, the hardware based PIC chip router would allow USB mounting and the AES decryption would take place. The worst thing is the PIC chip (not even a security chip of any sorts)</p>
<p>In fact, dataUnshur does not own the technology. They simply licensed the patented technology from Clevx&#8217;s Datalock technology which by the way many other licensees of the Clevx Datalock technology (not just DataUnshur but includes Toshiba&#8217;s similar spin-off). All products (licensees) of the Datalock patent are vulnerable in the sense it is not truely tamper resistant but marketed as tamper resistant and who knows what other vulnerabilities lies inside including hacking the JTAG and what not.</p>
<p>So what if dataUnshur gets FIPS 140-2 Level 3 &#8230; it means nothing because the current FIPS 140-2 standards are considered outdated and easily bypassed. I think Ross Anderson would easily bypass many FIPS 140-2 &#8220;HSM&#8221; that are not HSMs in any form or way. Those are simply dishonest marketing and a security certification system that is totally busted by many experts and shown to be faulty. Heck, even CC EAL certification is pointless as most part of the CC process is not spent on actually decapping and micro-scoping the chips sent for &#8220;evaluation&#8221; but mostly spent on reading piles of reports that have to conform to CC certification.</p>
<p>If you want CC EAL 5+ chips, you put a bunch of metal shields and enclose it in epoxy, write a nice report and there you have it. A &#8220;smart card&#8221; or &#8220;secure element&#8221; chip. Yes, I am simplifying a ton of stuff here but I just want to put the point across that most secure element, HSMs and smart cards (including TPM) are mildly to moderately tamper resistant or even tamper resistant at all.</p>
<p>I made popular the idea of using smart cards because it separates actual state attackers from script kiddies and smart card are mildly tamper resistant but not strong enough if you are up against nation states. I have been developing a bunch of methodologies which I am finding time to release and write about in future to compensate the mild tamper resistance of these smart card chips. It simply makes attacking harder on the remote level and somewhat harder on the physical level but compared to dataUnshur that does not use any tamper resistant chips (even mildly), dataUnshur is a big door wide open. One other and highly important reason I push for smart card adoption is because of programmability. You can script your JavaCard, BasicCard, .NET Card, MULTOS C card &#8230; and in that instance you can obfuscate your codes and executables and for a smart card chip with limited RAM and EEPROM, it will be difficult to hide a malware that de-obfuscate and predicts your execution as the lag will be too apparent and easily detected. Smart cards are also highly available in market and almost every hardware security researcher will at least decap a smart card once and if stuff is hidden, someone would have caught something due to high availability of smart cards and because of it&#8217;s high availability, that means hidding backdoors that can be easily measured by researchers becomes harder and plus these smart cards are commodity products in a way where it can be used for virtually anything from payment to transit, governments &#8230; backdooring would require too much effort and too large of a scope and also introduces risk in the own governments having the same vulnerability as everyone thus my view the backdooring all the world&#8217;s smart cards is likely implausible in whatsoever form and thus my push for use of smart cards as Secure Execution Environments for very critical and weird use cases that the industry never have dreamt off to put them off their guards.</p>
<p>DataUnshur in no form or way is suitable even for HIPAA, FIPS, CC, HSPD, DOD, CESG, EMV, PCI DSS &#8230; whatever Government, Financial or Critical Infrastructural use, let alone protection of data security in my opinion due to it&#8217;s insecure chip design.</p>
<p>If they want to improve, they must move away from an insecure chip and use something like a smart card controller or a dedicated HSM chip even if it cost money.</p>
<p>Yubikey once used an insecure micrcontroller and was shown to be insecure (one of those old Blackhat of DEFCON videos somewhere in Youtube land) and after the exposure, Yubikeys are now equipped with NXP&#8217;s JCOP smart card controller. The Yubikey uses a JavaCard capable smart card chip with CC EAL 5+ rating and technically you can program a Yubikey like any smart card using the JavaCard language but they decide not to release the ISD keys (Card Manager keys) required to authenticate and authorize the programming of the NXP JCOP chip. I have not heard of anymore problems with Yubikeys once they switched to using NXP&#8217;s JCOP smart card as the heart of their Yubikey products.</p>
<p>Side Note: Do note that trying to bruteforce the ISD keys (2-Key TripleDES) more than three consecutive failed authentication into the Card Manager applet in any smart card may cause the card to permanently brick itself thus a good way of protecting unauthorized card programming 🙂 . You need to request the 16 bytes of TripleDES keymat into the ISD domain to authenticate and load the executable from whoever issues you the card.</p>
<p>Links:<br />
 &#8211; <a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1873.pdf" rel="nofollow ugc">http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1873.pdf</a><br />
 &#8211; <a href="http://www.clevx.com/datalock-fips.html" rel="nofollow ugc">http://www.clevx.com/datalock-fips.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285910">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285910">
						October 26, 2016 12:59 AM					</a>

				</p>

				<p>&#8220;French surveillance law is unconstitutional after all, highest court says&#8221;<br />
<a href="http://www.pcworld.com/article/3134476/french-surveillance-law-is-unconstitutional-after-all-highest-court-says.html" rel="nofollow ugc">http://www.pcworld.com/article/3134476/french-surveillance-law-is-unconstitutional-after-all-highest-court-says.html</a></p>
<p>&#8220;A key clause of last year&#8217;s Surveillance Law essentially allowed security agencies to monitor and control wireless communications without the usual oversight applied to wiretapping operations.&#8221;</p>
<p>&#8220;This is unconstitutional as the lack of oversight is likely to result in a disproportionate invasion of privacy, the council ruled Friday.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285911">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285911">
						October 26, 2016 1:02 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>One idea I&#8217;ve been playing in my head is an electromechanical system where the ACK signal is stored into a simple latch circuit, and the connectors reading and writing would be controlled by relay switches operated by TxM. The logic would prevent galvanic connection from NH to TxM at all times. Since there is only single bit that gets transferred, compromise of TxM should be practically impossible.</p>
<p>This of course does not work with NH delivering data to RxM because an adversary can in theory control both devices. So I don&#8217;t see a way to ensure transmissions over recipient&#8217;s (the more troublesome) data diode. One mitigation would be to change per-packet forward secrecy to per session one. Outside long trickle-connection based ones, the sessions in TFC are relatively short lived. (Moxie was right to wonder why OTR used round trip Diffie-Hellman rachets.) With per-session keys, NH could cache ciphertexts and replay them as per request of the user &#8212; based on some ID RxM would complain it didn&#8217;t receive. The command is easiest to send from TxM, as NH doesn&#8217;t have an input function.</p>
<p>Alternatively, RxM could cache previous keys and partial packets into RAM for limited time and wait for missing ciphertexts. But this is again, a risky solution to seemingly non-existent problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285912">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285912">
						October 26, 2016 1:03 AM					</a>

				</p>

				<p>Thoth<br />
&#8211;Not conclusive at all, I&#8217;d need one of those boards on my desk, smart card and all, be able to program firmware of the interface chip and java application at will, and probably a month or 2 working full-time on it to fully investigate.  Like I said I wouldn&#8217;t trust timing measurements that are purely software-based on non-DSP chips due to getting burned a bit in the past by software timing issues.  The scope sorted it out real quick, and I was able to zoom in on the problem real quick (have to know code base pretty well to do that).</p>
<p><i>What the timing measures is the total transaction time between the card and the desktop</i><br />
&#8211;That&#8217;s good, that&#8217;s part of what we want, but would take a bit of memory on a scope.  If anything, there&#8217;s likely tiny delays interspersed in the 200 or 256 byte payloads constantly sent out and back.  I don&#8217;t see that adding up to much above 2% of the time.</p>
<p>Regardless, I&#8217;d be willing to bet the problem isn&#8217;t the comm speeds, just not sure precisely where the main delay is happening.  You could put flags all over the timing test code, like when encryption starts and finishes, time that period, not sure.  It may be too much effort to speed it up.  If you could spin the performance issues to dealing w/ some timing attacks, but still if someone has a smaller doc to encrypt they&#8217;re going to want it done faster.</p>
<p>Markus Ottela<br />
<i>My threat model is mainly batteries dying on me when I&#8217;m demoing the system</i><br />
&#8211;Ha, yeah I&#8217;m not insane enough yet to run all my computers on a generator (or even better, a windmill) in the backyard.  Makes my eyes bleed thinking how to eliminate that threat, anything electrical is ill-advised at that point.  But if you power both your PC&#8217;s from in your home, that&#8217;s a connection, isolated by a bunch of transformers but still, ultimately it&#8217;s a connection between TX and RX.  There was a senior project at my school of a comms channel over powerlines.</p>
<p>RE: usb isolator<br />
&#8211;Man, we gotta use a TTL-RS232, then RS232-USB adapter; that&#8217;s the way to go!  But yeah, I was thinking if this would be nice before going into PC.  I know it passes USB data fine, I even used my USB sticks to test that some.  It&#8217;s just I got compelling evidence that the ground was changing when I plugged/unplugged other side of isolator.  Can&#8217;t expand on it.</p>
<p><i>The CNY75A works very reliably at 9600 bd/s and during testing where I sent packets together with their checksums</i><br />
&#8211;Ok, good to hear; hopefully it&#8217;s comparable to HCPL7723.  Have you done testing on the Reed-Solomon ECC&#8217;s, like intentionally inducing errors, to see they work, or have you never seen errors?</p>
<p>Sancho_P<br />
<i>Also a simple optocoupler can be tested (230 VAC hint @Figureitout)</i><br />
&#8211;OR a simple continuity test.  Continuity test is one of the simplest most powerful tests in electronics, I swear.  Play around w/ high enough voltage (current around 1-2amps?) to hurt you, or do a completely safe harmless test to check if something is electrically connected or not.  Hmm, tough choice.</p>
<p><i>Shouldn’t we have a warning before failure? In case someone has touched …?</i><br />
&#8211;So you want a warning of something before it&#8217;s happened?  Uhh, you listening to yourself?  You like crystal balls and fortune tellers and stuff like that?  Unless you can identify specific, repeatable conditions for an error.</p>
<p>Think you&#8217;ll be going down a rabbit hole of insanity looking for what you describe, doesn&#8217;t even look remotely technically possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285913">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285913">
						October 26, 2016 1:26 AM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>&#8220;That&#8217;s actually a lot better idea. To store all keys on TxM/RxM and to store one key encryption key on the smart card. The smart card authenticates whatever keys are input before decrypting and using them. More I/O but significantly less space requirements.&#8221;</p>
<p>This is how most smart cards applets do. They handle the tiny KEK and the rest is left to the host computer.</p>
<p>&#8220;So ~100ms for 255 byte message isn&#8217;t a problem but databases might.&#8221;</p>
<p>Good to know.</p>
<p>&#8220;Is the AES authenticated encryption (e.g. GCM), or is SHA256 MAC required?&#8221;</p>
<p>GCM is a very new cipher mode and thus not supported. It is not surprising considering most smart cards are simply tamper resisting legacy CPUs and never meant to be all too updated.</p>
<p>Current Cryptographic Algorithm list for you to select:<br />
 &#8211; AES_CBC_NOPAD (no padding literally)<br />
 &#8211; AES_ECB_NOPAD<br />
 &#8211; AES_CBC_PKCS5 (depends if supplier has PKCS5, currently working on PKCS5 to be hand coded by myself in case PKCS5 is not around)<br />
 &#8211; AES_ECB_PKCS5 (depends if supplier has PKCS5, currently working on PKCS5 to be hand coded by myself in case PKCS5 is not around)<br />
 &#8211; SHA_256<br />
 &#8211; HMAC-SHA_256 (depends on supplier but I have a working HMAC-SHA2 library I hand coded and suppose to work from SHA1 to SHA2 of any variant).<br />
 &#8211; RSA_NOPAD<br />
 &#8211; RSA_PKCS1 in Cipher.MODE_ENCRYPT and Cipher.MODE_DECRYPT<br />
 &#8211; RSA_SHA1_PKCS1 in Signature.MODE_SIGN and Signature.MODE_VERIFY<br />
 &#8211; RSA_SHA256_PKCS1 in Signature.MODE_SIGN and Signature.MODE_VERIFY (depends on supplier if the SHA256 based PKCS1 is supported but I too have a working hand coded variant)<br />
 &#8211; ECDH_NIST_P_PLAIN with DHC and DH mode (Allows flexibility of hashing of negotiated shared secret after ECDH event)<br />
 &#8211; ECDH_NIST_P_KDF_SHA1 with DHC and DH mode (Performs mandatory SHA1 of shared secret as the final secret material after ECDH event thus resulting in 20 byte secret material presented without flexibility).<br />
 &#8211; ECDSA_NIST_P with SHA1, SHA224 and SHA256 hash as typical offering. SHA384 and above hashes are more rare.</p>
<p>&#8220;This is a big problem. Typing 2k/4k RSA public keys isn&#8217;t practical, and like Bruce, I don&#8217;t think the P-curves are trustworthy. But threat models vary and not every nation state has access to the backdoor. Maybe. So it might be useful addition under some threat models. Hopefully Yubico etc. will build devices that use Curve 25519 for signing and key exchange&#8221;</p>
<p>Yubico uses NXP JCOP smart cards as it&#8217;s heart. The smart card industry are driven by NIST directives. Sadly, non-NISt curves are in high demands but for now the industry is still crapped up. Better to use symmetric crypto (AES) whenever possible.</p>
<p>One good thing is NXP&#8217;s JCOP includes it&#8217;s proprietary ECC Curve library where anyone signing an NDA with NXP would be able to implement their own ECC curves (including Curve25519) but the side effect is you won&#8217;t be able to port the codes to another platform and NDAs are horrible stuff. It will be nice if Yubico can use it&#8217;s relationship with NXP to utilize the ECC Curve library NXP supplies to it&#8217;s partners to create an open Curve25519 API but so far I have not heard any news of such initiatives yet. They need to be nudged 😀 .</p>
<p>&#8220;It is useful but if RxM is compromised, it might be that whatever native software is authenticating e.g. TFC software with the help of smartcard, might give false-positive answer. I think the best use for smart card under the threat model is to protect the keys and prevent impersonation. But again, the pin code needs a secure input channel and I&#8217;m not sure the tech exists yet.&#8221;</p>
<p>That would require a dedicated MCU if you are worried. More work but also more security. You can get a bunch of buttons, an OLED display and an STM32 to work on but that&#8217;s gonna spend a huge amount of time unless you are going to commit to TFC as your main project for many years to come and even spin a marketable variant for the sake of getting some income, you could consider this route.</p>
<p>You won&#8217;t need to spend USD$400 on dubious security stuff that you cannot audit and control by yourself. I would advise you to grab some Arduino, mount a OLED display, get a keypad or something to hook to the Arduino and then do some comms between the Arduino built secure PINpad to talk to your RPis. Also the Arduino can be equipped with an ISO7816 card reader module. I was just browsing a while ago and found a smart card module from Adafruit. You can use a USB module on the Arduino for a USB-CCID interface to the smart card as well and that solves the problem of needing dedicated ISO7816 language since there are tonnes of USB-CCID card readers on the market out there.</p>
<p>Links:<br />
 &#8211; <a href="https://www.adafruit.com/products/101" rel="nofollow ugc">https://www.adafruit.com/products/101</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285914">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285914">
						October 26, 2016 3:35 AM					</a>

				</p>

				<p>@Figureitout</p>
<p>&#8220;Have you done testing on the Reed-Solomon ECC&#8217;s, like intentionally inducing errors&#8221;</p>
<p>The unittest class for Reed Solomon encoding adds random errors to beginning of transmission and ensures the corrected string matches that of the original:</p>
<p><a href="https://github.com/maqp/tfc/blob/master/unittests/test_tx.py#L3229" rel="nofollow ugc">https://github.com/maqp/tfc/blob/master/unittests/test_tx.py#L3229</a></p>
<p>I should probably make the error placement random but other than that, the correction seems to work provided the e_correction_ratio value can handle the number of errors.</p>
<p>&#8220;So you want a warning of something before it&#8217;s happened?&#8221;</p>
<p>I think what was meant here was error would be detected before large packet is received. The packets in TFC are ~500 bytes long (it depends mainly on length of tx/rx XMPP addresses delivered to NH) so there won&#8217;t be long delays.</p>
<p>@Thoth</p>
<p>Re: Current Cryptographic Algorithm list</p>
<p>AES_CBC_NOPAD and HMAC-SHA256 are probably fine provided the plaintext is padded prior to uploading it to smartcard.</p>
<p>&#8220;&#8211;unless you are going to commit to TFC as your main project for many years to come and even spin a marketable variant for the sake of getting some income, you could consider this route.&#8221;</p>
<p>That&#8217;s unlikely to happen. Interdiction makes selling the system commercially too risky. I&#8217;d rather not deal with whatever NSLs are handed in this industry, or what compromised subcontractors deliver to storage. Decentralized project is much safer for all users, even with all the inconveniences.</p>
<p>RE: Arduino.</p>
<p>The assurance depends on whether it can be reprogrammed for pin stealing by RxM. Bidirectional I/O is required for key handling. I&#8217;d imagine the isolation of input is handled better by the proprietary security products that are FIPS certified.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285915">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285915">
						October 26, 2016 3:59 AM					</a>

				</p>

				<p>@ab praeceptis</p>
<p>Cost for security increases exponentially or near exponentially (which is funny because, on the other hand, we perceive mechanism a secure that drive our opponents cost up exponentially *g).</p>
<p>I&#8217;d imagine the costs are something like running cost of fundamental research of security, math, exploits. Then there&#8217;s the deployment cost of massive systems with maintaining costs (small compared to number of targets). As end-to-end encryption becomes the norm, governments move towards automated exploits; The running cost increases but the deployment costs go down (currently existing infrastructure like Quantum, FoxAcid etc. appear to work fine).</p>
<p>What troubles me is, there&#8217;s no exponential or possibly even linear increase in cost while exploit remains undiscovered. Research by Symantec showed the window of exposure for zero-days is 312 days on average. This number goes down as the number of targets goes up but the probability of losing the exploit it&#8217;s not linear. As less high value targets are added, their security practices go down and the risk increases logarithmically. If security experts and dissidents with infosec contacts/background can be filtered, the chances of getting caught are very low. Average citizens are not running Snort. Average citizens don&#8217;t blame NSA when their computer crashes. Average users don&#8217;t even understand the concept of vulnerability and exploit. They won&#8217;t report their suspicions.</p>
<p>To me it feels like TFC is the first one to kind of add linear increase in cost per user to break the system. Were I wrong, that would mean it&#8217;s cheap to compromise any system the user of which obtains security software online &#8212; at that point the protection computers can provide against the adversary is negligible.</p>
<p>@Thoth</p>
<p>RE: dataShur</p>
<p>Good to know they are not worth their salt. It saddens me to hear that the certifications aren&#8217;t obtained with active testing by third party (especially when it comes to CC EAL).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285916">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285916">
						October 26, 2016 5:16 AM					</a>

				</p>

				<p>@Markus Ottela<br />
Padding wouldn&#8217;t be a concern as I am already working on PKCS5 pads and I can make them work even with NOPAD modes. HMAC that I wrote should work across multiple platforms and so far the big providers work fine with my crypto library I created for smart cards so that should be fine.</p>
<p>Regarding Arduino based secure PINpads, you can control I/O and support only whichever external ports you want. You can even program the Arduino as an infra-red interface making exflitration much harder.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285917">

			<div class="comment by-wondering ">

				<p class="commentcredit">

					<span class="commenter">Wondering</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285917">
						October 26, 2016 5:20 AM					</a>

				</p>

				<p>Why does not someone develop and market things like a ~ $50 mobile/landline snap-on hardware encryption device for the common people, to be sold on ordinary store shelves? So much mass and targeted control, why so few effective and practical countermeasures?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285918">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285918">
						October 26, 2016 5:38 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<blockquote><p>OR a simple continuity test. Continuity test is one of the simplest most powerful tests in electronics, I swear.</p></blockquote>
<p>Yes and no, many components do not conduct untill after a certain voltage is reached. Think of a zenner diode it is designed to have minimal to nothing in the way of conduction below it&#8217;s knee voltage, and quite a low impedance afterwards.</p>
<p>It&#8217;s not just semicoductor devices but &#8220;gas tubes&#8221; as well, hence such nice test kit as the Megga, which will make your eyes light up if you hold the wrong things during testing 😉</p>
<p>I&#8217;ve got Hi-Pot test gear for testing of insulation and gap breakdown that pushes a nice 1500volt pulse to wake up the inatentive&#8230;</p>
<p>The thing Sancho_P left out of his primitive Hi-Pot test was a current limit resistance. Various scientific bodies (including medical) point out the old saying of &#8220;It&#8217;s the volts that jolt, but the mills that kill&#8221; is nearly right&#8230; Thus you need a series resistance that at the peak-peak voltage only allows 30mA maximum.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285919">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285919">
						October 26, 2016 6:01 AM					</a>

				</p>

				<p>@Wondering<br />
You are referring to JackPair (linked below) ?</p>
<p>You do realize that cryptography and personal security / privacy is frowned upon by &#8220;The Powers That Be&#8221; ?</p>
<p>Security appliances and equipments have a ton of red tapes on them and that includes both import and export control. Possessing security equipment can mean  nasty sentences in certain countries like the Middle East, Pakistan, India and so forth ?</p>
<p>Elites of the society cling onto power and these days we live in the world of digital communication which is a double edged sword. These elites of societies would not want to yield power and so by the means of force and resources, they attempt to deny the use by the commoners.</p>
<p>In the digital world, attacks are easier than defense (quote @Bruce Schneier) and so the defenders have to defend all corners while the attackers attack wherever and whenever they want which makes means you have to spread your defenses equally. Unlike physical battlefields where you have weather, terrain, morale of troops &#8230; digital resources are abundant and you can simply DDoS someone whenever and wherever they are as an example.</p>
<p>Link: <a href="https://www.kickstarter.com/projects/620001568/jackpair-safeguard-your-phone-conversation/updates" rel="nofollow ugc">https://www.kickstarter.com/projects/620001568/jackpair-safeguard-your-phone-conversation/updates</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285920">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285920">
						October 26, 2016 9:38 AM					</a>

				</p>

				<p>@Markus Ottela<br />
Basically your integration with smart card would need:<br />
 &#8211; KEK wrapping of keys<br />
 &#8211; Storing some hashes and comparing</p>
<p>For initializing the smart card state, users would first &#8220;register&#8221; a setup by supplying a hash of their password and the smart card would randomly generate a 256-bit key. The 256-bit smart card key would encrypt the password hash thus forming the master key via the product&#8217;s AES-256-CBC-NOPAD ciphering operation.</p>
<p>The SHA-256 hash of the master key would be stored in a secure PIN slot that will be actively wiped when tamper is detected by the smart card as like all PIN and Key type objects which are tamper protected. The hash of the master key is used as the authentication PIN into the smart card as well. The IV used will be 16 zeroes. The master key is never stored permanently but always derived from every logged in user session. The master key will be stored inside a temporary key slot which is a secured portion of the RAM that will very quickly lose the keys and sensitive temporary RAM objects when violations are detected. The master key is used for key wrapping and key sealing (a.k.a fanciful term for HMAC integrity operation).</p>
<p>After registration stage, a flag would be set into the hardware state preventing reverting to registration state unless the user authenticates and set the flag to a self-destruct / wipe state of the smart card which essentially securely destroys the internal CSPs via mechanisms provided by the smart card (including random byte overwriting and zeroizing on a hardware level).</p>
<p>Other finer details like enabling or disabling of self-destruct if too many failed attempts are detected and the setting of hardware protected retry counters are done at the registration stage too. Once all these information are set, it is permanent until card is wiped and reset again.</p>
<p>Op_HW_WRAP_AND_SEAL_SENSITIVE :: Key wrapping is done by the following procedure:</p>
<ol>
<li>Keymat or any sensitive materials are wrapped with sizes smaller or equals to 127 bytes.</li>
<li>16 bytes of random IV and 32 bytes of random AES-256 bit DEK are generated.</li>
<li>The sensitive material is padded with zeroes until it reaches 127 bytes if it is less than 127<br />
bytes.</li>
<li>1 byte indicating the length of the sensitive material is placed in front of the 127 bytes.</li>
<li>
<p>AES-CBC-NOPAD is applied to the padded material including the 1 byte of length indicator (total 128 bytes) with the random IV.</p>
</li>
<li>
<p>The random IV would be hashed and concatenated to derive another set of 16 byte IV which will be used by the Master Key to encrypt the DEK.</p>
</li>
<li>
<p>The original random IV, encrypted DEK and encrypted sensitive object would be HMAC-SHA-256 via the same Master Key and now this is a total of 200 bytes in all which would be exported.</p>
</li>
<li>
<p>When unwrapping, the 200 bytes of encrypted and sealed sensitive material would be imported and then authenticated and unwrapped and then release of the sensitive material that was wrapped and sealed inside.</p>
</li>
</ol>
<p>Op_HW_STORE_COMPARISON_OBJECT :: You store the attestation result of a plaintext object you are targetting. The comparison algorithm method (RSA2048_SHA1_PKCS1, RSA2048_SHA256_PKCS1, SHA1, SHA224, SHA256, HMAC-SHA1, HMAC-SHA224, HMAC-SHA256). Since you are unlikely to use RSA based comparison method, that would leave with the SHA hashing methods and the HMAC verification methods. HMAC methods would use the master key for to perform &#8220;signing&#8221; operation over the plaintext object and then store only the MAC result while for the SHA hash methods, it will hash and then store the hash result. A 2 byte OID would be assigned as the object handle and returned. Typically you can store as many objects within a 2 byte short type range but the card will not have that much space. It would be prudent to only store as much as necessary.</p>
<p>Op_HW_COMPARE_COMPARISON_OBJECT :: You simply keep feeding the plaintext until the operation is finalized with an indicating OID that was given when storing. The verification process would be done on card and a boolean result returned.</p>
<p>Op_HW_MANAGE_COMPARISON_OBJECT :: Do the Remove and List operations of objects stored for comparison purposes. UID is required when doing Remove operations. List objects would list out how many objects in total and all the OIDs and the accompanying MAC/hash results in plaintext.</p>
<p>If you need anymore, you can add or remove from those above.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285922">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285922">
						October 26, 2016 12:46 PM					</a>

				</p>

				<p>Markus Ottela</p>
<p>That&#8217;s difficult one. Of course, our minds like to play with what we know and to eternally enhance. Which in security leads to projects like yours. They are valuable from a research perspective (and a human one), &#8220;security out there&#8221;, however, might be quite different in terms of threat scenarios and needs.</p>
<p>I think it&#8217;s high time to return to planet earth and to understand that the enemy who really and everyday bring us into danger is not nsa &#8211; it&#8217;s us, it&#8217;s the developers who design and code carelessly and it&#8217;s, of course, the greasy profit driven management bots in companies who prefer to sell blunt crap in order to make 3 cents more profit.</p>
<p>Can mere mortals drive up costs exponentially for attackers? Certainly &#8211; but in 97 or 99 out of 100 cases they won&#8217;t. They&#8217;d rather click on a funny icon (opening yet another hole in their system).</p>
<p>And then there&#8217;s the politicians and society and its handlers. Some of us say &#8220;We can&#8217;t educate the user. We rather must create more secure systems&#8221;; and they are right. And not; because, just look: if the politicians (calling themselves &#8220;we&#8221; and &#8220;society&#8221;) really want something driven into Johns and Janes head then they <em>can</em>.</p>
<p>That&#8217;s one of the points that drive me nuts. Lies. Lots and lots of lies. politicians, and being at that, whole legions of marketing people <em>can</em> &#8220;educate&#8221; people; in fact they can even bend their minds and make them do crazy thing. If, however, say, Bruce Schneier wants to tell them, that there is big fact security monster right behind them, he usually fails. They just don&#8217;t care.</p>
<p>Why don&#8217;t they care? Because no &#8220;authority&#8221; told them to. <em>That&#8217;s</em> the ugly point.  Users are told to care, when it makes profits for corporations like symantec. They are, however, not told to care for the question whether those corporations sell crap and snake oil.</p>
<p>The way it is nsa is happy, corps are happy, users are happy (they installed CrapSec for 29.99! and got cute new icons) and politicians are happy; for one they have something to threateningly blabber and moreover the whole INsecure situation is a usefull &#8211; and plentifully used! &#8211; stage to justify more spending on cyber as well as on classical military.</p>
<p>Which, just btw also explains why costs don&#8217;t grow, let alone exponentially, for undiscovered exploits.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285923">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285923">
						October 26, 2016 6:09 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p><i>”This assumes all computers are RasPis.”</i></p>
<p>No. It assumes Tx and Rx are part of the TCB, not general consumer COTS machines. RasPi &amp; Co are good because of their diversity.<br />
But my point is:<br />
Be careful with USB in the TCB (similar to say USB can’t be part of the TCB).</p>
<p><i>”Let the user decide.”</i> Good, love it.</p>
<p><i>”This is instant messaging we&#8217;re talking about, not delivering nuclear launch codes.”</i><br />
So you are devoting your time to a complex “high assurance” messaging system, limited by design to chat with your mother? 😉</p>
<p><i>”As I said, I haven&#8217;t encountered any transmission errors with data diodes so far.”</i><br />
So what should I take from that? That you are good in soldering? Never had a damaged phototransistor, broken cable, loose connector? SW or timing problems in a complex, probably already compromised system?<br />
&#8211; Or that you have never searched for transmission problems in runtime?<br />
You know the saying ”The absence of proof is not proof of absence.”</p>
<p><i>”The Reed-Solomon was*** added **** because it&#8217;s good protocol design.”</i></p>
<p>That’s what I wanted to read, thanks!</p>
<p><i>”Even if you had to re-send one message in a thousand, it&#8217;s like having to restart a car on a winter&#8217;s morning.”</i></p>
<p>Now this is too close to @Figureitout, that’s not you.<br />
Nope, it’s not, on the contrary.<br />
Hopefully it’s not a problem to resend or to restart your car once (if it does start then).<br />
The problem is:<br />
You should have known before that your communication was on the brink to collapse, something bad was going on in your system, or likewise your car computer’s error log was already full of “low pressure from gas pump” or “low battery power” warnings since weeks (nice that your repair shop can read OBD logs but usually you can’t).</p>
<p>I think that’s what @Clive Robinson hinted to when saying: <i>”The big prob with most EC is it does not fail gracefully, that is it hangs onto the edge of a precipice by it&#8217;s finger nail before droping out of sight.”</i></p>
<p>No, we don’t need (and here can’t have) any machine feedback <b>[1]</b>.</p>
<p>That said, there is a “best praxis” solution, it’s trivial and simple, called “live zero”:</p>
<ul>
<li>On the Tx machine(s), after preparing the bitstream, flip some single bits depending on packet length, say in 10 Bytes or about 1% of the packet, whatever (at random or in fixed, known position, what would you suggest?).</li>
<li>On the receiving side add a counter + display for corrected bits (on status / settings screen).<br />
Rx has to “know” how many bits would be (normally) flipped (as a preset or transmitted by Tx, but that’s complicated, check it’s above a minimum,  …).<br />
The fixed error bit positions could be checked, but ….</li>
</ul>
<p>Is the correction rate below “known” (threshold 1 bit) display a critical warning “Receiving data error rate below minimum, system probably compromised”.<br />
Is it above (with threshold about +2%) but below 10% give a warning “Receiving data error rate extremely high, check connection / data diode”.<br />
Above 10% “Receiving data error rate critically high, check connection / data diode”.</p>
<p>The data diodes are your concept’s firewalls.<br />
Hope you are “willing” not only to listen 😉</p>
<p><b>[1]</b><br />
What would be the purpose of any feedback to the sender?<br />
Imagine a solar powered transmitter periodically sending data (RF) home. Why should I send back that I have problems to understand what it says? What would it do with that information? Apologize for snowfall?<br />
There’s a point in time where it needs a human action.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285924">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285924">
						October 26, 2016 6:12 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>At the end of your discussion with Thoth (25, 11:12 PM)<br />
you wrote <i>”It is useful but if RxM is compromised, …”</i><br />
and finally to store all persistent TFC files (???) on something like …</p>
<p>Later you wrote <i>”The assurance depends on whether it can be reprogrammed for pin stealing by RxM. Bidirectional I/O is required for key handling. I&#8217;d imagine the isolation of input is handled better by the proprietary security products that are FIPS certified.”</i></p>
<p>I’m a bit slow in thinking so I didn’t understand fully but I’m interested in the problem, probably I’ll come back to that thematic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285925">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285925">
						October 26, 2016 6:16 PM					</a>

				</p>

				<p>@Clive Robinson re high pot test</p>
<p>I wasn’t talking about testing live objects, you know a cow can be killed already by 10 mA (they are known to be more sensitive than humans) and some people survived several amperes through their limbs (seriously injured, of course).</p>
<p>My current limiter is the incandescent bulb with relatively low cold resistance but acting as a short circuit protection just in case. The voltage should be held for 1 minute to be enough to heat up any “leaks” in the IC package 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285926">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285926">
						October 26, 2016 9:51 PM					</a>

				</p>

				<p>@ab praeceptis</p>
<p>&#8220;I think it&#8217;s high time to return to planet earth and to understand that the enemy who really and everyday bring us into danger is not nsa &#8211; it&#8217;s us, it&#8217;s the developers who design and code carelessly and it&#8217;s, of course, the greasy profit driven management bots in companies who prefer to sell blunt crap in order to make 3 cents more profit.&#8221;</p>
<p>HSAs like NSA etc. represents mortal danger to whoever is labelled a terrorist by the political winds. I don&#8217;t symphatize with ISIS but there was a time MLK was the highest threat to national security. That&#8217;s what&#8217;s at stake here. Like Snowden said, &#8220;We are building the greatest weapon for oppression in the history of man, yet its directors exempt themselves from accountability.&#8221;</p>
<p>I don&#8217;t want to live in a society like that.</p>
<p>&#8220;Can mere mortals drive up costs exponentially for attackers? Certainly &#8211; but in 97 or 99 out of 100 cases they won&#8217;t.&#8221;</p>
<p>True. This isn&#8217;t about forcing everyone to change their way of life. It&#8217;s about giving those care about their human rights a fighting chance.</p>
<p>&#8220;Some of us say &#8220;We can&#8217;t educate the user. We rather must create more secure systems&#8221;; and they are right.&#8221;</p>
<p>We need both. Unless we have tech for strong end-to-end encryption, there won&#8217;t be a conversation with realistic expectation of privacy. Unless user is educated to the point they check public key fingerprints, it&#8217;s the same. Users can&#8217;t replace encryption with code words &#8212; tech can&#8217;t solve the issue of MITM without user verifying key authenticity.</p>
<p>&#8220;Users are told to care, when it makes profits for corporations like symantec&#8221;</p>
<p>What sickens me more is having proprietary security vendors lobby their proprietary products at crypto parties: VPN for those who need Tor. Really? Not understanding the threat models of audience is in some contexts risking their lives.</p>
<p>@Sancho_P</p>
<p>&#8220;So you are devoting your time to a complex “high assurance” messaging system, limited by design to chat with your mother? ;-)&#8221;</p>
<p>So you&#8217;re saying high assurance means we accept high risk of key exfiltration via ACK channel and guarantee the following theoretical inconvenience won&#8217;t ever happen: (1) Alice sends &#8220;I got transmission error with the last&#8221; and (2) Bob presses up arrow and enter to retransmit the message.</p>
<p>&#8220;Or that you have never searched for transmission problems in runtime?&#8221;</p>
<p>I already mentioned I ran a testing period that searched for transmission errors when upgrading baudrate to 19200. That testing wasn&#8217;t anything formal, so it only lasted for a few hours.</p>
<p>You know the saying ”The absence of proof is not proof of absence.”</p>
<p>Yet the world of information security lives by computational hardness assumptions. Not even companies like OWL who build certified data didoes have dared putting such features into production. If you can do this, I&#8217;m betting you have a ludicrous paycheck waiting for you there.</p>
<p>&#8220;That said, there is a “best praxis” solution, it’s trivial and simple, called “live zero”&#8211;&#8221;</p>
<p>So warn user about TFC having to do correct errors? Sure. It&#8217;ll take me a while to understand where in Reed-Solomon class I can see the number or errors, but that&#8217;ll be done. It won&#8217;t fix catastrophic transmission errors like if connector is loose but then again, nothing will.</p>
<p>&#8220;Receiving data error rate below minimum, system probably compromised&#8221;</p>
<p>I think a simple &#8220;Data diode is giving errors. Please check batteries and connections&#8221; is enough. Errors do not occur under normal use so even a single byte error should raise the warning.</p>
<p>&#8220;What would be the purpose of any feedback to the sender?&#8221;</p>
<p>I understood you meant delivery should be guaranteed, and that sender should be able to retransmit until it goes through. This requires a dangerous ACK channel that confirms no errors occurred. It can not be done, thus other ways to mitigate are need.</p>
<p>&#8220;I’m a bit slow in thinking so I didn’t understand fully but I’m interested in the problem&#8221;</p>
<p>The security design doesn&#8217;t differentiate between exploit capabilities. I&#8217;m assuming adversary has almost unlimited budget with exploit design. The capabilities of malware are</p>
<ol>
<li>Any path for data transmission can carry any type of malware and whatever information it has collected along the way</li>
<li>The malware has access to RAM and can run arbitrary code and commands as root</li>
<li>The malware can operate hardware freely to turn it into covert transmitter</li>
</ol>
<p>The axioms security is built on are</p>
<ol>
<li>Malware can&#8217;t cross data diode in opposite direction
</li>
<li>
<p>Malware can&#8217;t decrypt symmetric encryption without having acquired access to keys</p>
</li>
</ol>
<p>And now as per discussion with @Thoth:</p>
<ol>
<li>Malware can&#8217;t exfiltrate data from smart card without decapping it</li>
</ol>
<p>I admit the last one is a bit of a stretch but if any additional security is desired, it&#8217;s the best bet.</p>
<p>As the networker computer (NH) is connected to receiver computer (RxM) with data diode, malware can propagate from network to RxM. Malware on RxM can log every displayed message, display arbitrary messages, access keys in memory etc. But. It can&#8217;t send anything back as per security axiom 1. So, at this point we&#8217;ve already achieved security against remote exfiltration.</p>
<p>The next challenge is to provide as much protection from physical attacker as possible. Since FDE on RxM can be defeated with clever evil maid attack, the &#8220;evil servant&#8221; malware on RxM can hand master key it collected from memory to physical attacker. Note that the physical attack succeeds also against TxM, but since unlike RxM, this computer can not be remotely compromised. Compromising RxM FDE takes maybe two trips. TxM is a more trickly one and takes maybe three visits.</p>
<p>The &#8220;evil servant&#8221; on RxM can hand back all logs it has covertly recorded. But it can also hand over keys that can be used to impersonate the user. If security axiom 3 holds true, this can be prevented by storing a non-exfiltratable master key on the smart card, that then also runs all cryptographic decryption operations on behalf of TxM/RxM. The smart card can possibly be obtained by adversary but as long as guessing the PIN wrong thrice might destroy the master key, adversary won&#8217;t attempt gaining access to encrypted keys stored on TxM/RxM (smart card has very little memory).</p>
<p>This is where the PIN comes in. Where is it typed? If you use RxM keyboard, the &#8220;evil servant&#8221; can record it. If you use USB smart card interface with PIN pad, the security design is hard to audit, the evil servant might be able to propagate. If you use Arduino with built in tools, the entire MCU might be compromised. Whatever device is relaying ciphertexts and plaintexts from RxM to smart card, must be assumed to be compromised by malware. So therefore I&#8217;d rather have a secure, alternate input path to smart card&#8217;s crypto processor, and a smart card with integrated PIN pad would be ideal. An easy analogue would be the encrypted external drives: Unlike any TrueCrypt volume I mount on RxM, the password I type into the drive itself isn&#8217;t visible to the evil servant.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285927">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285927">
						October 26, 2016 10:01 PM					</a>

				</p>

				<p>@ Sancho_P,</p>
<blockquote><p>I wasn’t talking about testing live objects&#8230;</p></blockquote>
<p>I&#8217;m sufficiently knowledgeable &#8220;in the art&#8221; to infere that you were not.</p>
<p>However, in the UK there are sufficient &#8220;accidents&#8221; to indicate that there are a number of people who will &#8220;do things for fun&#8221;&#8230;</p>
<p>One classic of recent times was a manufacturer of battery powered electric razors. In an advert they showed it being semi immersed in a sink full of water and a person start shaving with it immediatly. Unfortunately it became clear that some people using other shaver products that ran off of the mains started immersing them because the advert indicated it was OK&#8230; As far as I&#8217;m aware nobody got hurt, but it did trip circuit breakers etc. The company pulled the advert shortly after they were made aware of the problem.</p>
<p>The problem with this blog is as with televison adverts that &#8220;you don&#8217;t know who&#8217;s watching&#8221; or &#8220;what message they will chose to take away&#8221; from it.</p>
<p>It&#8217;s one of the reasons I&#8217;m a little more cautious about some of the things I say technically since &#8220;stuxnet&#8221;, as I don&#8217;t want to have second guessing lawyers breathing down my neck. Especially with the UK legislation about terrorism, it&#8217;s worse than section 1201c of the DMCA for chilling research publication etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285928">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285928">
						October 26, 2016 11:18 PM					</a>

				</p>

				<p>Markus Ottela</p>
<p>&#8220;HSAs like NSA etc. represents mortal danger to whoever is labelled a terrorist&#8230;&#8221;</p>
<p>You are frighteningly right but we are not in contradiction. Because what I described is the basis for what you describe.</p>
<p>If there were some safe full stacks from a solid and actually practically usable OS and safe libs and languages and &#8230; &#8211; then we might succeed to also stop nsa and accomplices.</p>
<p>I remember wondering when linux became stronger and a usable alternative and neither state, nor deep state nor corp. world went against it. Somewat later, when forst tens of millions and then the first billions were thrown at linux, mysql, etc. the picture became clear. They <em>wanted</em> the open source movement (obviously for their own purposes). It was just perfect for them; they could control, manipulate, and poison and at the same time they could play the nice guys.</p>
<p>The final bang for me came with heartbleed. Not that I needed another wake up call, but it came anyway and there was little room for interpretation. Not only was the thousand eyes principle but a lie or at best a pipe dream but even worse, the second pair of eyes just treated the jewels of security like just any any other worthless project; it wasn&#8217;t worth his attention so he simply clicked it O.K.</p>
<p>The us agencies as well as the european agencies spent hundreds of millions upon hundreds of millions on academic research, yet rarely we &#8211; who pay for all that &#8211; see the fruits. In cases where something actually useful is produced typically a company is created and <em>payed by us</em> results are monetized, and not for small money at that. And what little is publicly available must usually be found in cumbersome searches and it is rarely easily installable and usable.</p>
<p>Short, someone (and someone very very mighty) <em>does not want</em> for us to have safe systems; not even a reasonable chance to have them.</p>
<p>Another hint: Whenever something very fast and reliable comes up, quite usually one will find banksters behind it. Just have a look at languages supporting the actor model. Formertimes you would have found big industry names (ibm, etc) and nowadays you&#8217;ll find fintech corps connected.</p>
<p>Finally, let&#8217;s not dream and hallucinate. We <em>know</em>, we bloody <em>know</em>, that the risks are enormous when creating important sw with C/C++, Java. We <em>know</em> that sw reliability would immensely increase if we started to use better languages. But we don&#8217;t.</p>
<p>Recently we had a discussion based on a blog post of our host here re. &#8220;educating the users&#8221;. Lot&#8217;s of discussion &#8211; yet we failed to understand that the very same problem concerns ourselves. Just try to preach proper software development &#8230;<br />
The vast majority of developers is no different from John and Jane who just do what everyone does (buy a cheap modem/router box and happily click whatever comes up on your screen).</p>
<p>I don&#8217;t see any tangible chance for us to achieve a more secure society (in terms of IT sec). The optimistic maximum is that by far less than 1 promille of the population can achieve at least a minimal level.<br />
Just look at your own project. There are optocouplers that easily do 100MHz but you use plain diodes and sensors. Why? Because you don&#8217;t trust them chips.</p>
<p>In other words: Unless we, the people, take the power back (if we ever had it), unless managers in corps must be seriously afraid of f*cking us nothing will change. You will continue to use old stuff because you can reasonably trust it and I will continue to build safe sw. Drops in the ocean.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285929">

			<div class="comment by-gordo ">

				<p class="commentcredit">

					<span class="commenter">gordo</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285929">
						October 27, 2016 12:36 AM					</a>

				</p>

				<p>Variation on &#8216;The Democratization of Cyberattack&#8217; theme:</p>
<p>[Free]World&#8217;s Largest Net:Mirai Botnet, Client, Echo Loader, CNC Source Code Release</p>
<p><a href="https://krebsonsecurity.com/wp-content/uploads/2016/10/mirai-hf-940x377.png" rel="nofollow ugc">https://krebsonsecurity.com/wp-content/uploads/2016/10/mirai-hf-940&#215;377.png</a></p>
<hr />
<p>Mirai (given name)<br />
Mirai (未来) is a Japanese given name, meaning &#8220;the future&#8221;.<br />
Also a Shona name (Zimbabwe) meaning wait .</p>
<p><a href="https://en.wikipedia.org/wiki/Mirai_(given_name)" rel="nofollow ugc">https://en.wikipedia.org/wiki/Mirai_(given_name)</a></p>
<hr />
<p>Mirai (acronyms)<br />
&#8211; Malicious internet routing attack infrastructure<br />
&#8211; Mainstream internet routing attack infrastructure<br />
&#8211; Militarized internet routing attack infrastructure</p>
<h2>&#8211; All of the above [?]</h2>
<p>IoT malware exploits DVRs, home cameras via default passwords<br />
Boing Boing / CORY DOCTOROW / MON SEP 12, 2016</p>
<p>Linux/Mirai is an ELF trojan targeting IoT devices, which Malware Must Die describes as the most successful ELF trojan. &#8230; .</p>
<p>[quotes Malware Must Die, from 8/31/2016:]</p>
<p>The moral of the story of this threat ; this is the example, on how a group of bad hackers can improve themselves.. if we let them still be freely doing their vandalism act out there. They keep on improving their threat and they have no care to aim anything that can be infected to expand their &#8220;botnets&#8221;.</p>
<p><a href="https://boingboing.net/2016/09/12/iot-malware-exploits-dvrs-hom.html" rel="nofollow ugc">https://boingboing.net/2016/09/12/iot-malware-exploits-dvrs-hom.html</a></p>
<hr />
<p>Attackers are now abusing exposed LDAP servers to amplify DDoS attacks<br />
<i>LDAP adds to the existing arsenal of DDoS reflection and amplification techniques that can generate massive attacks</i><br />
By Lucian Constantin | IDG News Service | Oct 26, 2016</p>
<p>Corero&#8217;s Larson believes that increasing numbers of insecure IoT devices combined with new amplification vectors could lead to multiterabit attacks over the next year and even attacks that reach 10Tbps in the future.</p>
<p><a href="http://www.csoonline.com/article/3135686/security/attackers-are-now-abusing-exposed-ldap-servers-to-amplify-ddos-attacks.html" rel="nofollow ugc">http://www.csoonline.com/article/3135686/security/attackers-are-now-abusing-exposed-ldap-servers-to-amplify-ddos-attacks.html</a></p>
<hr />
<p>Massive cyberattack poses policy dilemma, Stanford scholar says<br />
<i>Stanford cybersecurity expert Herb Lin says the Oct. 21 cyberattack that snarled traffic on major websites reveals weaknesses in the Internet of Things that need to be addressed. But stricter security requirements could slow innovation, cost more and be difficult to enforce.</i><br />
CLIFTON B. PARKER | Stanford News | OCTOBER 24, 2016</p>
<p>[Lin:] The primary policy recommendation is that we need policy that encourages – or mandates, depending on how strong you want to be about it – at least minimal security measures for devices that connect to the internet, even Internet of Things devices. How you actually promote, encourage or incentivize that without a legal mandate is problematic, however, because nobody quite knows what the market will accept. &#8230; .</p>
<p><a href="http://news.stanford.edu/2016/10/24/massive-cyberattack-poses-policy-dilemma-stanford-scholar-says/" rel="nofollow ugc">http://news.stanford.edu/2016/10/24/massive-cyberattack-poses-policy-dilemma-stanford-scholar-says/</a></p>
<p>See also:</p>
<p>FORD HAD A BETTER IDEA IN 1956, BUT IT FOUND THAT SAFETY DIDN&#8217;T SELL<br />
June 26, 1996 @ 12:01 am<br />
Diana T. Kurylko, Automotive News</p>
<p><a href="http://www.autonews.com/article/19960626/ANA/606260836/ford-had-a-better-idea-in-1956-but-it-found-that-safety-didnt-sell" rel="nofollow ugc">http://www.autonews.com/article/19960626/ANA/606260836/ford-had-a-better-idea-in-1956-but-it-found-that-safety-didnt-sell</a></p>
<hr />
<p>Regarding innovation:</p>
<p><a href="https://en.wikipedia.org/wiki/Innovation#Future_of_innovation" rel="nofollow ugc">https://en.wikipedia.org/wiki/Innovation#Future_of_innovation</a></p>
<p>and &#8230;</p>
<p>Innovation: A Conceptual History of an Anonymous Concept<br />
Benoît Godin<br />
Project on the Intellectual History of Innovation<br />
Working Paper No. 21<br />
2015</p>
<p>Ironically, these developments led to the transformation of the concept from a means to an end to an end in itself. Some words, Lewis suggests again, have nothing but a halo, a “mystique by which a whole society lives” (Lewis, 1960: 282). The word seeps into almost every sentence. Over the twentieth century, innovation has become quite a valuable buzzword, a magic word. Innovation is the panacea to every socioeconomic problem. One need not inquire into the society’s problems. Innovation is the <i>a priori</i> solution (p. 17).</p>
<p><a href="http://www.csiic.ca/PDF/WorkingPaper21.pdf" rel="nofollow ugc">http://www.csiic.ca/PDF/WorkingPaper21.pdf</a></p>
<hr />
<p>Innovation as we know it is not what&#8217;s called for. Repairing the infrastructures, whether, e.g., liberty, i.e., trust; utility, i.e., reliability; workmanship, i.e., craft; and so on. The current transformation is effectively global. The last time a basic communication technology radically changed the West a reformation followed and led to an enlightenment. May we be so lucky.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285930">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285930">
						October 27, 2016 1:24 AM					</a>

				</p>

				<p>Thoth RE: datashur<br />
&#8211;First thought was &#8220;Argh! Why buttons on USB stick?! Why do people keep doing this?!&#8221;, if you have to push them while it&#8217;s plugged in it&#8217;ll break your USB port.  I hate ports that get loose or wiggly, need them tight and crisp, just my OCD.  The best is VGA or DB9&#8217;s where you can screw them in nice and tight for a secured connection.  The worst is the latest mini/microUSB that can wiggle and lose connection, so flimsy&#8230;Then it has a battery in it and you push in pin while it&#8217;s not plugged in.  Ok, better but you now have code executing while the USB stick isn&#8217;t plugged in.  That&#8217;s a big &#8216;nope&#8217; for me.  I unplug the USB stick, I want it to die and no more code execution as soon as the last bit of charge dissipates from any power cap on board (had a crazy, not bug, well small hardware bug I guess, even surface mount caps <em>can</em> hold enough potential for a low power chip to operate longer than you&#8217;d think, a lot longer&#8230;so you kill power and expect chip to be off almost immediately?  Not so in some cases&#8230;huge security risk if your vulnerable RAM is remaining powered and ripe for picking, good to clear it, best to kill the power and lose the contents of it for sure).</p>
<p>And just b/c it&#8217;s a PIC chip doesn&#8217;t mean throw it out.  Your smart card reader had a very common HCS08 8 bit MCU (they&#8217;re a bit old now, but still all over the place), w/ a plastic case that didn&#8217;t destroy the circuit board when you took it off.  And no conformal coating at least to make it a slight pain to probe (usually just pierce thru it, but you have to press a little).  Can you actually easily exploit an MCU if I set lock bits and encrypt data in an internal eeprom?  W/o researching existing exploits, if there&#8217;s any easy ones documented.  Decap the epoxy then what?  You need a good microscope that can take pictures and to know what components look like in silicon.</p>
<p>Double-edged sword, designing tamper proofing for physical access (usually a death sentence in security field eh?).  There could be a nice hidden backdoor underneath all the tamper shielding, that I can&#8217;t get at before it destroys itself, and that backdoor remains lurking.</p>
<p>Markus Ottela<br />
&#8211;It&#8217;s sounding like there is few to no errors being experienced.  I&#8217;ll try some tests when I build Sancho&#8217;s USB data diode.  Something to try might be an electric drill held close to wire, best when you can see the sparks in it.  It generates a lot of crap RF.  Another common one is when smartphones do the initial negotiation for a 3G/4G data connection or wifi connection, noticeable burst of RF from that.  If it can hold up, basically unshielded from most annoying RF noise sources, that&#8217;s good.</p>
<p><i>I think what was meant here was error would be detected before large packet is received</i><br />
&#8211;I think he doesn&#8217;t know what he wants and is just kinda throwing things out there?  He wants warning of errors beforehand, but even things like sensors telling you to check your brakes and stuff, those can be attacked and disabled or reset&#8230;</p>
<p><i>If you use Arduino with built in tools, the entire MCU might be compromised.</i><br />
&#8211;And a raspi (which actually has a necessary binary blob we can&#8217;t see to run) or regular laptop PC w/ at least 5-6 separate MCUs (chips w/in chips now is normal) using python won&#8217;t be?  MCU&#8217;s win here in terms of attack space for usability, sorry.  And if MCU&#8217;s are compromised, then all PC&#8217;s w/ their huge CPU&#8217;s and microcode and all the OS&#8217;s and higher level languages running on top of them are as well.  No one here had an attack on the ready for my little nRF_Detekt, and that&#8217;s attaching a radio to a SPI port, take that away and it&#8217;s 99% to 100% esoteric attacks that aren&#8217;t really used or physical attacks that generally won&#8217;t happen.  Sounds like every smart card reader is going to have an MCU (probably even 32 bit, and a ton of unused flash) routing the comms to smart cards.  Something has to read the PIN pad, doesn&#8217;t just magically happen.  The cards themselves are usually MCU&#8217;s even&#8230;</p>
<p>Clive Robinson<br />
&#8211;True, but is there a zener diode in the optocoupler?  That would be a bit of a design flaw eh?  Why put a zener diode in an optocoupler?  I&#8217;ve burned enough protection diodes when I wasn&#8217;t meaning to&#8230; I suppose if you want to blow sh*t up like a crazy Spaniard (eh Sancho? :p), sure why not lol.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285931">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285931">
						October 27, 2016 1:51 AM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>&#8220;The smart card can possibly be obtained by adversary but as long as guessing the PIN wrong thrice might destroy the master key, adversary won&#8217;t attempt gaining access to encrypted keys stored on TxM/RxM (smart card has very little memory).&#8221;</p>
<p>Remember I previously said smart cards are mildly tamper resistant ? The reason I designed that the user&#8217;s password hash (hashing should be done on host computer to alleviate load off smart card) would be encrypted by a hardware AES key. It solves two problems using this method (also widely deployed in industry to strengthen security of hardwawre).</p>
<p>The first thing it prevents is decap. Imagine an attacker decaps the chip and finds an AES key that needs to be combined with a user password hash and he/she already spent one week to one month analyzing all the targetted chip and what comes out is a close to unusable AES key without a password hash.</p>
<p>The second thing it attempts prevent is backdoors to certain extend. Imagine if I have 20 AES key and I give them very weird names and now a backdoor in the card has to work through them all. Also, to include a backdoor inside such a confined space is going to be very challenging without seriously impacting the card&#8217;s performance and will with very high chances be caught even by causal home hobbyist with their acid baths and cheap USB microscopes since the cards are using legacy 200+ nm processes and maybe easier to view under affordable USB microscopes by hobbyists.</p>
<p>My current design is three wrong retries consecutively and there goes the card. It resets and wipes itself out. There is no such thing as &#8220;admin&#8221; or &#8220;backup&#8221; for the sake that someone actually wants to &#8220;self-destruct&#8221; the damn thing in a pinch without chances of recovery.</p>
<p>&#8220;This is where the PIN comes in. Where is it typed? If you use RxM keyboard, the &#8220;evil servant&#8221; can record it. If you use USB smart card interface with PIN pad, the security design is hard to audit, the evil servant might be able to propagate. If you use Arduino with built in tools, the entire MCU might be compromised. Whatever device is relaying ciphertexts and plaintexts from RxM to smart card, must be assumed to be compromised by malware. So therefore I&#8217;d rather have a secure, alternate input path to smart card&#8217;s crypto processor, and a smart card with integrated PIN pad would be ideal. An easy analogue would be the encrypted external drives: Unlike any TrueCrypt volume I mount on RxM, the password I type into the drive itself isn&#8217;t visible to the evil servant.&#8221;</p>
<p>You would need to verify the PINpad&#8217;s design and that will take more time than using a commodity Arduino hardware. The reason is Arduinos are general purpose hobbyist stuff and would be the least on any spy agencies list to backdoor it. Not to forget that adding backdoors will break a chip&#8217;s design or would add overhead. The best way is to choose a chip just fast and light enough with as much excluded features and with as little resource only enough for the job so now a backdoor becomes even more apparent due to high chances of performance degrades and weirdness.</p>
<p>There is the Ledger Nano S and Blue which are essentially &#8220;smart card based hardware with secure entry and display&#8221; but I figured you would call into question it&#8217;s design despite the entire Ledger design being almost open hardware including the firmware, OS and everything save for the ST31 smart card&#8217;s internal proprietary blobs (linked below).</p>
<p>Knowing that you would not want to go near these devices which in my opinion are more secure than most things out there (they are literally pocket HSMs) but you being more conservative, thus the best choices are things like $9 CHIP, Raspberry Pi, BananaPi, Arduino and so on which are easy to build around and the designs are mostly open for most of them except RaspberryPi which surprisingly has it&#8217;s Broadcom firmware blobs proprietary in nature while the AllWinner (Chinese made) are open firmware and can be found on the website of the Chinese manufacturer.</p>
<p>It seems the Chinese are more open in this aspect surprisingly.</p>
<p>Otherwise &#8230; another really bad choice is fully proprietary PINpads 😀 .</p>
<p>Links:<br />
 &#8211; <a href="https://github.com/LedgerHQ/" rel="nofollow ugc">https://github.com/LedgerHQ/</a><br />
 &#8211; <a href="https://www.ledgerwallet.com/products/12-ledger-nano-s" rel="nofollow ugc">https://www.ledgerwallet.com/products/12-ledger-nano-s</a><br />
 &#8211; <a href="https://www.ledgerwallet.com/products/9-ledger-blue" rel="nofollow ugc">https://www.ledgerwallet.com/products/9-ledger-blue</a><br />
 &#8211; <a href="http://www.acs.com.hk/en/products/34/acr83-pineasy-smart-card-reader/" rel="nofollow ugc">http://www.acs.com.hk/en/products/34/acr83-pineasy-smart-card-reader/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285932">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285932">
						October 27, 2016 2:19 AM					</a>

				</p>

				<p>@Figureitout</p>
<p>re: OCD<br />
Same here. I can&#8217;t stand ports that go lose.</p>
<p>re: VGA or DB9<br />
Those are depreciated but they are still used. Have you seen the Safenet HSM ? You will love the looks of the secure PINPad card reader. Uses screw in ports. Tight stuff. Linked below. The nasty thing is it&#8217;s heavy and bulky and looks so squarish and uncool looking. Designers need to make these Safenet Luna HSM PINpads more stylish as well as functional, tight and secure. Not to forget, the idea behind the Safenet Luna HSM is to assume hostile environment and uses a lot of military comms equipment and high durability methods to make the HSM extremely durable and resilient from environment and human factors partly because Safenet used to work (and may still be) with NSA to provide their security stuff. One famous relationship results in the famous Clipper Chip that Safenet built for NSA.</p>
<p>I do prefer Thales&#8217; build of their secure PINpad as Thales (well maybe I am bias) makes it more cool and stylish looking but also functional. A nice looking PINpad for smart cards with a USB connection cable. No more loose USB ports but these are under export controls by the way. Nasty paper works.</p>
<p>I almost forget one thing, anything related to security is export locked down in UK and an example is asking @Clive Robinson to send us a PIC chip with his custom coded firmware of DES encryption, @Clive Robinson would need to seek UK Custom&#8217;s agreement to release something insecure like a PIC chip with a lousy DES cipher.</p>
<p>re: PIC chips<br />
Note that those USB &#8220;secure&#8221; sticks are targeted for important appointments from NATO/UK/US Govt usage to diplomatic, healthcare, banks, finance &#8230; all the sensitive organs of society. If they were just selling it as personal security, I wouldn&#8217;t be all too critical but maybe I would.</p>
<p>How would you protect a NATO or government official with something not even tamper resistant ?</p>
<p>Linked below is NATO&#8217;s IA portal classifying the dataShur as it&#8217;s deserving UNCLASSIFIED category which means it can only transport unimportant stuff that wouldn&#8217;t be vital to NATO/US/UK decision making plans. To reach at least a RESTRICTED category in NATO, a smart card chip needs to be used and even then more stringent handling are required.</p>
<p>If a product is positioned for handling important documents including security classified documents and they label themselves as tamper proofed when they are only tamper evident, it is false marketing practices and companies like these can easily get away with false marketing and we always wondered why security is so laxed in Governments and around the world. The reason is as @ab praeceptis mentioned a few posts before, the result of greedy and dishonest entrepreneurship.</p>
<p>If someone markets a tamper resistant device, they better make sure it lives up to it otherwise when someone really use one of these mislabeled devices for sensitive stuff and gets into trouble, both the user and the seller would be in for serious consequences from legal and non-legal perspective.</p>
<p>The better way that dataShur should promote themselves should be malware resistance instead of tamper proof solution since they are more malware resistant and not even tamper resistant by any means. This would allow users to make better decisions on purchase.</p>
<p>Basically, do not pretend something is tamper resistant when it is only tamper evident just for the sake of marketing and cash. Dishonest business are bad businesses which will cost their unknowing customers not only trust but their lives as well in cases where lives matter (e.g. diplomats, journalists, military personnel, Govt officials &#8230;etc&#8230;).</p>
<p>Smart card readers are not meant to be secure anyway. The reader in any threat model are always considered compromised and thus any card developer must ensure card to host communication have a layer of logical encryption unless the card reader is provably secure and trusted thus the reason I asked @Markus Ottela to use Arduino to build a secure PINpad for card reading and PIN entry so that it is much more verifiable despite not with the highest security but better than those proprietary stuff out there which are total blackboxes.</p>
<p>Links:<br />
 &#8211; <a href="http://cloudhsm-safenet-docs.s3.amazonaws.com/007-011136-002_lunasa_5-1_webhelp_rev-a/Content/Resources/Images/dock2_connect_ped_600x367.png" rel="nofollow ugc">http://cloudhsm-safenet-docs.s3.amazonaws.com/007-011136-002_lunasa_5-1_webhelp_rev-a/Content/Resources/Images/dock2_connect_ped_600x367.png</a><br />
 &#8211; <a href="https://www.thales-esecurity.com/products-and-services/products-and-services/hardware-security-modules/general-purpose-hsms/nshield-remote-administration" rel="nofollow ugc">https://www.thales-esecurity.com/products-and-services/products-and-services/hardware-security-modules/general-purpose-hsms/nshield-remote-administration</a><br />
 &#8211; <a href="https://www.thales-esecurity.com/products-and-services/products-and-services/hardware-security-modules/general-purpose-hsms/~/media/Images/Thales%20e-Security/Global/Products/Remote%20HSM%20NEW/nShieldfrontUSB1JPG.JPG?h=133&#038;w=200" rel="nofollow ugc">https://www.thales-esecurity.com/products-and-services/products-and-services/hardware-security-modules/general-purpose-hsms/~/media/Images/Thales%20e-Security/Global/Products/Remote%20HSM%20NEW/nShieldfrontUSB1JPG.JPG?h=133&#038;w=200</a><br />
 &#8211; <a href="https://www.ia.nato.int/niapc/Product/iStorage-datAshur_462" rel="nofollow ugc">https://www.ia.nato.int/niapc/Product/iStorage-datAshur_462</a><br />
 &#8211; <a href="https://www.ia.nato.int/niapc/Product/iStorage-datAshur_462" rel="nofollow ugc">https://www.ia.nato.int/niapc/Product/iStorage-datAshur_462</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285933">

			<div class="comment by-czerno ">

				<p class="commentcredit">

					<span class="commenter">Czerno</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285933">
						October 27, 2016 4:27 AM					</a>

				</p>

				<p>ON topic :<br />
A Giant Squid in the Flying Bat</p>
<p><a href="http://apod.nasa.gov/apod/ap161027.html" rel="nofollow ugc">http://apod.nasa.gov/apod/ap161027.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285934">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285934">
						October 27, 2016 5:02 AM					</a>

				</p>

				<p><b>Another acoustic side channel</b></p>
<p>This time one that works at any earth spanning distance,</p>
<p><a href="https://arxiv.org/pdf/1609.09359.pdf" rel="nofollow ugc">https://arxiv.org/pdf/1609.09359.pdf</a></p>
<p>Put simply &#8220;don&#8217;t type while Skyping&#8221; unless you want your key strokes decoded along the way&#8230;</p>
<p>Acoustic side channels are so numerous finding a new one is like &#8220;Fishing for shopping trolleys in the Birmingham Canals&#8221;[1], you just dip your hook and wriggle. The real problem has always been how to exploit them remotely, in the past this has been done by exploiting the likes of on hook telephones with &#8220;infinity bugs&#8221; or RF tricks[2].</p>
<p>[1] Birmingham UK has claimed to have more miles of canal than Venice, more trees than Paris and one or two others such as the Rotunda&#8230; <a href="https://www.theguardian.com/commentisfree/2006/jun/23/comment.stuartjeffries" rel="nofollow ugc">https://www.theguardian.com/commentisfree/2006/jun/23/comment.stuartjeffries</a></p>
<p>[2] The infinity or harmonica bug was reputedly invented by the Mob for use against Law enforcment. The use of RF to jump the hook switch in old style carbon granual mic phones is given in the first half of Peter Wright&#8217;s &#8220;Spy Catcher&#8221; a book that intensely irritated UK PM of the time Margret Thatcher, so all in all was probably a good thing 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285935">

			<div class="comment by-black-luigi ">

				<p class="commentcredit">

					<span class="commenter">Black Luigi</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285935">
						October 27, 2016 9:55 AM					</a>

				</p>

				<p>@Clive</p>
<p>Emanuel &#8220;Manny&#8221; Mittelman, Blues Harmonica Legend &amp; One-Ring Hang-Up Artist. ^o^</p>
<p><a href="http://yarchive.net/phone/infinity_transmitter.html" rel="nofollow ugc">http://yarchive.net/phone/infinity_transmitter.html</a></p>
<p><em>Old</em> school, baby! Thanks for the memories.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285936">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285936">
						October 27, 2016 10:22 AM					</a>

				</p>

				<p>@ Markus Ottela,</p>
<blockquote><p>One idea I&#8217;ve been playing in my head is an electromechanical system where the ACK signal is stored into a simple latch circuit, and the connectors reading and writing would be controlled by relay switches operated by TxM. The logic would prevent galvanic connection from NH to TxM at all times. Since there is only single bit that gets transferred, compromise of TxM should be practically impossible.</p></blockquote>
<p>Unfortunatly, that idea / dream can keep waking you at night in a cold sweat&#8230;</p>
<p>The reason it could is it increases the attack surface significantly.</p>
<p>I will explain using a simplified device as it saves getting into too many specifics. So in effect what you have is a battery powered token which has the following IO,</p>
<p>1, A display (LCD).<br />
2, A keypad (4&#215;4 matrix).<br />
3, Three galvanicaly issolated contacts,<br />
3.a, An issloted common ground<br />
3.b, An issolated TX out.<br />
3.c, An isolated RX/DSR input.</p>
<p>All run by a single chip MCU.</p>
<p>In the case of normal embedded design you would have an inbuilt timer used to create background / foreground ticks to do the low level IO &#8220;bit banging&#8221;, &#8220;key debounce&#8221; and data buffering for the display and serial IO. With the likes of the LCD data control lines fed to an interupt, likewise the keypad lines would go to another interupt and the MCU input from the issolated RX/DSR input oh and a way to put the device into shutdown to conserve the battery.</p>
<p>Thus you would write a mini User Space OS with &#8220;Real Time&#8221; features, possibly including some level of multi-tasking. This could be done in assembler or C or Forth etc. For overall simplicity within the code a stack based approach would be simplest to get to run effectively especialy if trying to multitask.</p>
<p>Now lets view it from an attackers point of view. The only external connectivity is via the isolated TX and RX/DSR pins which are interupt driven. The RX/DSR connector is the only input the attacker can control.</p>
<p>However the software in the MCU is only written to read the RX/DSR &#8220;status&#8221; not to decode serial data etc. Now there are two ways that status could be pulled into the main body of the code, by connecting it to an interupt or by polling it. In the general run of things it would be connected to an interupt line and an interupt function.</p>
<p>Thus what advantage could an attacker gain from this status input?</p>
<p>Well if the state of the status line changes then in the ordinary run of events this would cause changes in the IO subs in the interupt functions. In turn this would give rise to timing differences in other parts of the software. Which would be a first step in getting the device to leak data of one form or another, unless considerable care has been taken to reduce or eliminate the possability. One way is to have a time based interupt poll the line and copy it&#8217;s status to an internal buffer or update a couple of addative counters (c1=c1+status, c2=c2+1). Which gives constant time irrespective of the status line value.</p>
<p>The second issue for an attacker is how to monitor any changes in timing characteristics. Back in the very late 1990&#8217;s Differential Power Analysis hit the smart card world with a bit of a thump. However in the early 1980&#8217;s I discovered just how susceptible a lot of digital electronics is to EM fields, and how the state of individual logic lines on a PCB could be detected by the way it&#8217;s resonant impedence changed. Thus serial data would cross modulate an RF carrier in a way that could be picked up at a sizable difference. As became known at a later date, the Russian&#8217;s had a similar system designed by Theramin which got called &#8220;The Great Seal Bug&#8221; and it had a range of atleast fifty meters. Which means that a handheld device such as the token described above could be targeted from well outside the building it is being used in.</p>
<p>So if the RX/DSR status line is not properly mittigated by the embedded software it could be used to cause the token to leak either plaintext or keymat.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285937">

			<div class="comment by-czerno ">

				<p class="commentcredit">

					<span class="commenter">Czerno</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285937">
						October 27, 2016 11:35 AM					</a>

				</p>

				<p>Did Google try to kill the Swiss encrypted webmail provider, Protonmail ?</p>
<p><a href="https://protonmail.com/blog/search-risk-google/" rel="nofollow ugc">https://protonmail.com/blog/search-risk-google/</a></p>
<p>&#8220;&#8230; for nearly a year, Google was hiding ProtonMail from search results for queries such as ‘secure email’ and ‘encrypted email’. This was highly suspicious because ProtonMail has long been the world’s largest encrypted email provider.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285938">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285938">
						October 27, 2016 11:59 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Another British attempt at nobbling the US election 😉</p>
<p>Harry Potter and The Curse of the Opmalumpa confirmation:</p>
<p><a href="http://newsthump.com/2016/10/27/destruction-of-walk-of-fame-star-leaves-donald-trump-down-to-his-last-six-horcruxes/" rel="nofollow ugc">http://newsthump.com/2016/10/27/destruction-of-walk-of-fame-star-leaves-donald-trump-down-to-his-last-six-horcruxes/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285939">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285939">
						October 27, 2016 12:11 PM					</a>

				</p>

				<p>&#8220;FCC imposes ISP privacy rules and takes aim at mandatory arbitration&#8221;<br />
<a href="http://arstechnica.com/information-technology/2016/10/isps-will-soon-have-to-ask-you-before-sharing-private-data-with-advertisers/" rel="nofollow ugc">http://arstechnica.com/information-technology/2016/10/isps-will-soon-have-to-ask-you-before-sharing-private-data-with-advertisers/</a></p>
<p>&#8220;The Federal Communications Commission today imposed new privacy rules on Internet service providers, and the Commission said it has begun working on rules that could limit the use of mandatory arbitration clauses in the contracts customers sign with ISPs.&#8221;</p>
<p>&#8220;It is the consumer&#8217;s information, it is not the information of the network the consumer hires to deliver that information,&#8221; Wheeler said. &#8220;What this item does is to say that the consumer has the right to make a decision about how her or his information is used.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285940">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285940">
						October 27, 2016 12:20 PM					</a>

				</p>

				<p>I am not familiar with this website, but supposedly, they want to make use of facial recognition in Germany.</p>
<p>&#8220;Germany planning facial recognition surveillance&#8221;<br />
<a href="http://www.dw.com/en/germany-planning-facial-recognition-surveillance/a-36163150" rel="nofollow ugc">http://www.dw.com/en/germany-planning-facial-recognition-surveillance/a-36163150</a></p>
<p>&#8220;Interior Minister Thomas de Maiziere wants to test video surveillance with facial recognition software in Germany&#8217;s train stations, a leaked parliamentary document has revealed. The technology is part of a wider plan to expand video surveillance across public spaces in Germany that was revealed on Wednesday in a draft law that the cabinet intends to rubberstamp in November.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285941">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285941">
						October 27, 2016 12:23 PM					</a>

				</p>

				<p>Complementary article to the one from Ars Technica above:</p>
<p>&#8220;The FCC just passed sweeping new rules to protect your online privacy&#8221;<br />
<a href="https://www.washingtonpost.com/news/the-switch/wp/2016/10/27/the-fcc-just-passed-sweeping-new-rules-to-protect-your-online-privacy/" rel="nofollow ugc">https://www.washingtonpost.com/news/the-switch/wp/2016/10/27/the-fcc-just-passed-sweeping-new-rules-to-protect-your-online-privacy/</a></p>
<p>&#8220;Federal regulators have approved unprecedented new rules to ensure broadband providers do not abuse their customers&#8217; app usage and browsing history, mobile location data and other sensitive personal information generated while using the Internet.&#8221;</p>
<p>&#8220;With its move, the FCC is seeking to bring Internet providers&#8217; conduct in line with that of traditional telephone companies that have historically obeyed strict prohibitions on the unauthorized use or sale of call data.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285942">

			<div class="comment by-ted ">

				<p class="commentcredit">

					<span class="commenter">Ted</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285942">
						October 27, 2016 3:47 PM					</a>

				</p>

				<p>NIST Releases Trustworthy Email Guidance (Sept 2016)</p>
<p>“<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-177.pdf" rel="nofollow ugc">NIST SP 800-177 Trustworthy Email&lt;/a href&gt; provides recommendations for deployment and configuration of state of the art email security technologies to detect and prevent phishing attacks and other malicious email messages…The guide is written for email administrators and for those developing security policies for enterprise email infrastructures.”</p>
<p>Table 3-1 Email-based Threats and Mitigations</p>
<p></a><a href="https://www.nist.gov/news-events/news/2016/09/nist-releases-trustworthy-email-guidance" rel="nofollow ugc">https://www.nist.gov/news-events/news/2016/09/nist-releases-trustworthy-email-guidance</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285943">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285943">
						October 27, 2016 4:52 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>Re my &#8220;Receiving data error rate below minimum, system probably compromised&#8221; warning:</p>
<p>Ouch!<br />
Your simple substitution:<br />
<i>”Data diode is giving errors. Please check batteries and connections”</i><br />
is completely wrong, misleading, a very bad conclusion / text.</p>
<p>When you deliberately add 5 error bits at the sender (called &#8220;Live Zero&#8221;) and the receiver only finds 3 (or less) then there is no way the data diode or it’s battery could have <b>improved</b> the process / corrected that errors.<br />
Obviously something else is wrong, either<br />
&#8211; at the sender’s software (changed? Compromised?)<br />
or<br />
&#8211; at the receiver’s FEC software (changed? Compromised?)<br />
or<br />
&#8211; the receiver didn’t receive the legit sender’s telegram (connection compromised?)</p>
<p>And please do not hint to check the batteries, probably there are none.<br />
&#8211; By al that tin foil around, if you do not consider malice, why think of TFC?</p>
<p>Re my “What would be the purpose of any feedback to the sender?”<br />
You wrote: <i>”I understood you meant delivery should be guaranteed, and that sender should be able to retransmit until it goes through. This requires a dangerous ACK channel that confirms no errors occurred. It can not be done, thus other ways to mitigate are need.”</i></p>
<p>What you understood is wrong in various aspects, but probably you were talking about the first (mis)understanding, so let me clarify:</p>
<p><i>”&#8230; you meant delivery should be guaranteed &#8230;”</i><br />
No, never, the diode makes it a one-way broadcast, it doesn’t matter if or who listens, the sender can’t care.</p>
<p><i>”… and … retransmit until it goes through.”</i><br />
No, on the contrary, you may have taken that from my example, the (here: accumulated water in snow) sensor is sending data periodically to the base station, but ‘periodically’ does not mean ‘retransmit’, it’s a new data point with a different timestamp.</p>
<p><i>”… requires a dangerous ACK channel …”</i><br />
No, my example’s sender / sensor neither can receive nor has the “intelligence” to repeat a missed data point, it doesn’t matter because a new data point is calculated and sent every thirty minutes. Plotting the received error rate over time the SW concludes which of the 20 to 30 sensors needs maintenance before it would completely fail (it’s hard, expensive and dangerous to get out there, so if one sensor fails you’d better also visit it’s neighbor if it already shows decreasing transmission quality).</p>
<p>Thanks for trying to explain the RxM trouble, it will take time, as part of your arguments are still confusing me, but I’ll sort that out.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285944">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285944">
						October 27, 2016 5:00 PM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Yep, regarding (UK&#8217;s and elsewhere’s) “terror legislation” (pun intended) I’m a bit concerned about my discussion with @Markus re TFC.<br />
It’s sad that even we old boyz (nothing to lose) feel the chilling effect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285945">

			<div class="comment by-krista-well-socialised-geekgirl ">

				<p class="commentcredit">

					<span class="commenter">Krista Well Socialised Geekgirl</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285945">
						October 27, 2016 6:20 PM					</a>

				</p>

				<p>OT<br />
@ Clive Robinson<br />
The quality of kindness is expressed through your writings.  While you are regularly and rightly commended for your OpSec contributions, I feel this tangential observation is valuable and appropriate.  As an aside, now that I think about it,  it can be noted that a few of the most admirable minds here have the same quality &#8211; Nick P, Thoth, Wael. Not that others don&#8217;t it&#8217;s just clearly apparent with some. Perhaps intellectual sophistication can, on occasion, foster emotional intelligence also. Or vice verca</p>
<p>re: Coffee OT but you were also making some correct and uncommon observations about cholesterol and erroneous mainstream perceptions of LDL and HDL etc.</p>
<p>The bullet proof coffee idea is essentially caffeine plus fat. The fat acts as a buffer to the insulin response of caffeine. So instead of a high followed by a slump 30 minutes later,  the blood levels of caffeine remain steady for as much as 8 hours.  The fat also acts as a crude drug delivery system for the caffeine and as a fuel for its thermogenic qualities.  Apparently its hugely popular in silicon valley, as cognitive function  in all its manifestations are vastly enhanced. It also greatly assists in weight loss especially when paired with the ketogenic diet.  I suppose the caffeine also delivers the high levels of quality fatty acids to where its needed</p>
<p>The originator followed the very califonian method of creating superflous commerical products around his concept, for maximum return  including special &#8221;mould free&#8217; &#8216;high altitude&#8217; coffee,  and a semi-toxic MCT (medium chain tryglericide) oil combo and and obnoxious infomercial &#8216;literature&#8217;. But as mentioned,  the DIY method is easy:  quality grass butter (quality meaning, pesticide free so chemicals are not stored in the fat)  with  or without quality virgin cold pressed organic coconut oil.  Some find the coconut oil too heavy, but it definitely tastes much better than one may imagine. Be bold.  Start with say one tablespoon total fat (butter and/without coconut oil) and slowly increase.  Blend or shake well into a lovely latte,  it doesn&#8217;t disperse with a spoon<br />
Or hey &#8211; have it with a Squid</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285946">

			<div class="comment by-the-fatness-known-as-kim ">

				<p class="commentcredit">

					<span class="commenter">The FATNess Known as KIM</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285946">
						October 27, 2016 7:23 PM					</a>

				</p>

				<p><b>Canadian police get cell-site data to text thousands near murder scene</b><br />
<a href="http://arstechnica.com/tech-policy/2016/10/canadian-police-get-cell-site-data-to-text-thousands-near-murder-scene/" rel="nofollow ugc">http://arstechnica.com/tech-policy/2016/10/canadian-police-get-cell-site-data-to-text-thousands-near-murder-scene/</a></p>
<p>Texting, police say, &#8220;is an evolution&#8221; of old-school, door-to-door canvassing.</p>
<p>The Ontario Provincial Police in Canada are planning to text about 7,500 mobile phones that were in the area where the body of a murdered man was discovered in December—all in a bid to find somebody who may have information about the crime.</p>
<p>Welcome to the modern, digital-age version of door-to-door police canvassing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285947">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285947">
						October 27, 2016 7:53 PM					</a>

				</p>

				<p>@Sancho_P, Markus Ottela</p>
<p>&#8220;So you are devoting your time to a complex “high assurance” messaging system, limited by design to chat with your mother? ;-)&#8221;</p>
<p>It is quite troubling to see a lack of respect for all the excellent and hard work @Markus Ottela have put into TFC. There might be disagreements on technical designs but not in a personally insulting manner like this.</p>
<p>@Markus Ottela delivers a real life design of high security assurance that actually works and exist in real life instead of just paper theories and thus deserves respects for his hardwork and willingness to spend time and money on a problem everyone of us here except him is willing to take a step out and make it a reality.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285948">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285948">
						October 27, 2016 7:59 PM					</a>

				</p>

				<p>@ Thoth, Markus,</p>
<p>It looks like the rumour of late Sept / Early Oct is true, Qualcomm is taking over NXP,</p>
<p><a href="http://www.reuters.com/article/us-nxpsemiconductors-m-a-qualcomm-idUSKCN12R1AW" rel="nofollow ugc">http://www.reuters.com/article/us-nxpsemiconductors-m-a-qualcomm-idUSKCN12R1AW</a></p>
<p>It&#8217;s known that Qualcom want to broaden their product base beyond Smart Phone chips as the market for smart phones is known to be decreasing. Thus Qualcom are most likely after the currently expanding automotive and IoT chip market.</p>
<p>As with all such mergers and acquisitions there will be &#8220;stream lining&#8221;. What product areas it will fall on is currently not stated only the 1/2billion of expected sayings.</p>
<p>NXP has some eclectic chip ranges as well as those where market share or profit are below what they could be, thus these are likely areas where the axe may fall.</p>
<p>I&#8217;m not sure if this will effect the smart card production, but it is an area which could easily be spun off or closed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285949">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285949">
						October 27, 2016 9:13 PM					</a>

				</p>

				<p>@ Krista Well Socialised Geekgirl,</p>
<p>With regards MCT&#8217;s I&#8217;ve done a little reading on them. Thay are found naturaly in some milks (mainly grass feeders) and both coconut and palm oils. Not sure which source the Bullet Proof Coffee uses.</p>
<p>It would appear MCTs have an interesting history within the medical industry, and are used in non-oral feeding systems, including by catheter line directly into the veinous system outside of the hepatic portal. They do however tend to cause Non Alcoholic Faty Liver Syndrom (NAFLS) when used this way. Which is in effect similar to Cirrhosis of the liver with it&#8217;s attached problems. However NAFLS does not occur when taken oraly provided there is not a moderate or high level of simple carbohydrates in the diet.</p>
<p>In normal oral consumption they can cross the GI barrier and go through the liver without requiring energy input thus oxygen consumption and provide natural &#8220;brain food&#8221;. The fact that they do not require the liver to use oxygen in theory means there is more oxygen available to the brain, thus you would not get the &#8220;post heavy meal fatigue&#8221;. However it is doubtful that they would improve sports performance. A further upside is that MCTs are also known to have certain &#8220;protective&#8221; abilities against various harmful processes caused by simple carbohydrates.</p>
<p>What is currently not clear is if MCTs have any part in arterial plaque formation. LCTs however there is evidence for, thus reducing LCT in your diet would be advisable. Coconut oil does have around 5% LCTs so the &#8211;not necessarily correct&#8211; standard advice is to use it sparingly  especially as it has no vitamin E content. The reason for the &#8220;not necessarily correct&#8221; is that the standard advice is changing, things like butter and cream are now getting recomended again and they have even higher LCT content.</p>
<p>With regards ketogenic diets it&#8217;s hard to find evidence about them as little research has been done outside of that for epilepsy control in children. It is known medically to be harmfull in certain conditions, but otherwise evidence is scant one way or the other, although anecdotaly a percentage of those on the Atkins diet did complain of headaches (which might as easily been caused by hydration issues). More recently there has been renewed intrest in research as high carb diets statisticaly show a correlation with early onset dementia and other neurological diseases as well as diabetes and inflamatory diseases that are now known to be the primary cause in CVD.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285950">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285950">
						October 27, 2016 10:18 PM					</a>

				</p>

				<p>@Clive Robinson<br />
I was planning to talk about this later in the day once I have gathered more information from my sources and friends in the industry but since you posted this agead of me, ai will just be direct that I am getting more worried about NXP if this deal goes through. Reason being now there will be lesser manufacturers of different types of IC chips and we are getting to a point where if his continues, there will be very few chip makers and backdoors becomes easier due to lesser varieties available and my scheme uses varieties of cards and chips as part of it&#8217;s security.</p>
<p>Smart cards are still somewhat hard to backdoor even after the merger of NXP and Qualcomm but it moves a step closer theoretically though but not provable as of yet.</p>
<p>As long as there are still varieties and smart card being used as a &#8220;commodity security device&#8221; of sorts, it is still somewhat hard to implement blanket backdoors without having both technical and practical issues.</p>
<p>There are still chips from Sony (Japan), Samsung (S.K.), Infineon (Germany), ST (France) and other small manufacturers like the Spyrus Rosetta (US), Atmel (US) and so on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285951">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285951">
						October 28, 2016 2:59 AM					</a>

				</p>

				<p>@ab praeceptis</p>
<p>&#8220;You are frighteningly right but we are not in contradiction.&#8221;</p>
<p>Agreed.</p>
<p>&#8220;second pair of eyes just treated the jewels of security like just any any other worthless project&#8221;</p>
<p>I&#8217;d imagine maintaining a library with legacy ciphers, legacy protocols quite meaningless, especially when you consider TLS mostly secure against everyday hackers, and fundamentally insecure against nation states with CA resources etc. I can&#8217;t be sure what happened with Heartbleed but I would imagine the project isn&#8217;t maintained out of passion. That&#8217;s when last minute pushes before the new year&#8217;s party happen. When you need to clear that table to relax.</p>
<p>&#8220;Short, someone (and someone very very mighty) <em>does not want</em> for us to have safe systems; not even a reasonable chance to have them.&#8221;</p>
<p>This is an interesting subject. I often wonder if the game rigged and if, to what extent.</p>
<p>@Figureitout</p>
<p>&#8220;-I think he doesn&#8217;t know what he wants and is just kinda throwing things out there?&#8221;</p>
<p>I finally got it. It&#8217;s about displaying warnings when first errors start happening when e.g. batteries (or one or more components) are dying. The forward error correction library should be able to tell how many errors where corrected. Receiver side software can then keep track of changes in performance.</p>
<p>So it&#8217;s not warnings of errors before they happen, but warnings when first recoverable errors start to occur.</p>
<p>&#8220;And a raspi or regular laptop PC w/ at least 5-6 separate MCUs using python won&#8217;t be?&#8221;</p>
<p>It absolutely can. That&#8217;s why the idea is to enter the PIN into smart card directly, not using the RxM keyboard.</p>
<p>&#8220;Something has to read the PIN pad, doesn&#8217;t just magically happen.&#8221;</p>
<p>I&#8217;m not sure how safe a standard USB smart card reader with pad is. I&#8217;d rather have external channel.</p>
<p>@Thoth:</p>
<p>Requiring a password doesn&#8217;t prevent decap, but rather expands the scale of required attack.</p>
<p>&#8220;My current design is three wrong retries consecutively and there goes the card. It resets and wipes itself out.&#8221;</p>
<p>That&#8217;s great to hear!</p>
<p>&#8220;The reason is Arduinos are general purpose hobbyist stuff and would be the least on any spy agencies list to backdoor it&#8221;</p>
<p>The question is not is it backdoored in advance. It&#8217;s, can you use whatever interface RxM would deliver encrypted keys via Arduino to smartcard, to infect the Arduino.</p>
<p>&#8220;Otherwise &#8230; another really bad choice is fully proprietary PINpads&#8221;</p>
<p>Agreed. The only thing I see good about them is, since RxM can&#8217;t leak information back to network, the choice of COTS hardware bought on cash won&#8217;t give adversary information about the hardware model used. Proprietary designs adds variance. Recommending use of systems featured in TFC Wiki reduces the complexity of malware that&#8217;s fed from NH to RxM.</p>
<p>@Clive Robinson<br />
EMSEC is out of scope here so if adversary is in close proximity with antenna, there&#8217;s very little that can be done against monitoring of keyboard/display cables. With no background in EE it&#8217;s really hard to follow along, sorry! If we can dumb it down for me a bit &#8212;</p>
<p>Let&#8217;s say TxM is a RasPi. The device first uses GPIO_1 to control a relay #1 that disconnects the latch memory circuit from TxM (state is read by GPIO_2). GPIO_3 controls second relay #2 and closes the circuit that allows NH to write reception status to it.</p>
<p>TxM then uses the UART/RS232 to send the ciphertext over the data diode. NH receives the data but FEC fails to correct errors in packet. So NH (also a RPI) stores bit &#8216;1&#8217; to latch circuit using it&#8217;s own GPIO pin. TxM times out, uses GPIO3 to control relay #2 that disconnects latch from NH. It then uses GPIO_1 to connect the latch to TxM. GPIO_2 then reads the &#8216;1&#8217; bit indicating error. The process is received over data diode until latch carries &#8216;0&#8217; to indicate success.</p>
<p>Tx.py software would loop ciphertext output and GPIO operation until delivery is successful. NH gets to time ciphertext output delays anyway (although constant time delays in trickle attempts to defeat it).</p>
<p>So what&#8217;s the risk here when NH gets to input single bit through this tiny transaction drawer only TxM has a handle for?</p>
<p>There&#8217;s been some research on covert channels that turn e.g. USB cabels into transmitters. I wonder if it&#8217;s possible to receive data in similar fashion.</p>
<p>@Sancho_P</p>
<p>&#8220;There is no way the data diode or it’s battery could have improved the process / corrected&#8221;</p>
<p>Remember Shannon&#8217;s maxim: Enemy knows the system. NH can be compromised at any point, thus it can adjust functionality on Rx-side. That would however be pointless as attacker most likely wants to stay hidden. Easiest path to DoS is not &#8220;packet transmission error&#8221; messages but preventing message delivery from XMPP server.</p>
<p>If TxM is compromised by malware during setup, it&#8217;s easy to set output to whatever user configures on that side when leaking keys.</p>
<p>The covert key exfiltration channel is going to be more clever than faulty bits &#8212; it&#8217;s most likely going to operate on lower level than TFC&#8217;s Python code, or use tiny differences in timings / voltage levels (data diode&#8217;s output current depends on brightness of LED).</p>
<p>FEC is for user&#8217;s convenience. It&#8217;s not a security feature.</p>
<p>&#8220;And please do not hint to check the batteries, probably there are none.&#8221;</p>
<p>That might be the case for data diode designs like yours. Not for the previous ones.</p>
<p>&#8220;- By al that tin foil around, if you do not consider malice, why think of TFC?&#8221;</p>
<p>I do consider it. I&#8217;m just not assuming adversary would choose different error rate for their output packets that what TFC would normally use.</p>
<p>&#8220;No, never, the diode makes it a one-way broadcast &#8212; sender can’t care.&#8221;</p>
<p>Great, we&#8217;re on the same page.</p>
<p>&#8220;part of your arguments are still confusing me, but I’ll sort that out.&#8221;</p>
<p>Language barrier is one problem. Also, many of us here often explain complex thing impartially when the detailed schema in our mind fills the missing parts. Also, there&#8217;s a lot of variance in tacit and explicit knowledge here. All this with non-real time discussion. Only thing that could make things harder would be 140 char limit for comments. Anyway, let me know if there&#8217;s anything you&#8217;d like me to clarify.</p>
<p>@Moderator</p>
<p>A possibility to edit posts would often be very useful. Has implementing such feature been discussed?</p>
<p>@Nick P</p>
<p>If you can find the time, I&#8217;d like to hear your thoughts on progress of TFC.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285952">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285952">
						October 28, 2016 3:56 AM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>&#8220;Requiring a password doesn&#8217;t prevent decap, but rather expands the scale of required attack.&#8221;</p>
<p>Indeed. It is to make someone who have decapped the chip become really frustrated to learn that what they have on hand is mostly useless as well.</p>
<p>&#8220;The question is not is it backdoored in advance. It&#8217;s, can you use whatever interface RxM would deliver encrypted keys via Arduino to smartcard, to infect the Arduino.&#8221;</p>
<p>You need control over the hardware via it&#8217;s firmware as the starting point. It acts like a data guard with very small and tight attack surfaces to minimize possibility of infection. Find those kits without any wireless interfaces of any sorts and then move to creating a an open and custom firmware image that makes infection very difficult by having very essential functions and easily inspected.</p>
<p>One example is like having your own ATMega or STM32 and you create a very specific OS to only handle card reading and PIN entry and if a malware tries to attack it has to find a flaw in your restrictive OS image and if you code it very tightly and make the OS very small and easy to debug (~ 2 to 3K LOC of codes), you should be fine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285953">

			<div class="comment by-ratio ">

				<p class="commentcredit">

					<span class="commenter">Ratio</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285953">
						October 28, 2016 5:08 AM					</a>

				</p>

				<p>@Markus Otella,</p>
<p>Instead of <i>if some_key in some_dict.keys()</i>, use <i>if some_key in some_dict</i>. The former checks if <i>some_key</i> is an element of the list of keys that <i>some_dict.keys()</i> returns, while the latter only performs a simple hash table lookup. It&#8217;s also slightly prettier. What&#8217;s not to like? 🙂</p>
<p>Anyway, I still haven&#8217;t read all of the code, but from what I&#8217;ve seen <b>the issue</b> in the large is that things are intertwined in all sorts of ways. Functions &#8220;do too much&#8221; and can&#8217;t be easily plugged together in some other way without changing their internals. The mutable global state doesn&#8217;t really help either. Fixing this, and getting rid of the code duplication, would be my highest priority on the software side of things.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285954">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285954">
						October 28, 2016 5:09 AM					</a>

				</p>

				<p>@Thoth</p>
<p>That makes sense. So minimize attack surface on PIN and password input and to store hash of master key on smart card. The smart card&#8217;s private key acts as salt so there&#8217;s no way to obtain master password without physical access to smart card.</p>
<p>However, as stated, all this provides diminishing returns. Preventing impersonation is important under some threat models but I simply can&#8217;t find the time to take on such complex concept at this point. I hope the community can use the existing code and expand on it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285955">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://askg.info' rel='external nofollow ugc' class='url'>Thoth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285955">
						October 28, 2016 5:23 AM					</a>

				</p>

				<p>@Markus Ottela<br />
No problem.</p>
<p>I guess if you really want to add smart card to the security model, the best way is to use password entry which is derived to a password hash to be fed into a smart card on the RaspberryPi computers themselves and not adapt a secure PINpad via an Arduino board until it becomes feasible with surplus time and resource on name.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285956">

			<div class="comment by-ratio ">

				<p class="commentcredit">

					<span class="commenter">Ratio</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285956">
						October 28, 2016 5:41 AM					</a>

				</p>

				<p>@Markus Ottela,</p>
<p>Oops, I misspelled your last name in my last comment. Sorry. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285957">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285957">
						October 28, 2016 8:27 AM					</a>

				</p>

				<p>@Ratio</p>
<p>RE: dict.keys()</p>
<p>That&#8217;s true and works as long as the dictionary isn&#8217;t being edited while iterating. That is the case in some of them, but I&#8217;ll have to check them through if there are some that use .keys() unnecessarily.</p>
<p>&#8220;Fixing this, and getting rid of the code duplication, would be my highest priority on the software side of things.&#8221;</p>
<p>@All, ratio</p>
<p>Now that the project is approximately feature complete, I can start looking at rewriting everything. Python 3 has better module structure so the language version will probably bump at the same time. Studies take more and more of my time so I don&#8217;t think there will be similar period like the past summer I can dedicate. If you have interest in contributing to the code, I welcome all audits, pull requests and discussion on any issues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285958">

			<div class="comment by-shallow-hal ">

				<p class="commentcredit">

					<span class="commenter">Shallow Hal</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285958">
						October 28, 2016 9:10 AM					</a>

				</p>

				<p><a href="http://arstechnica.co.uk/information-technology/2016/10/google-ai-neural-network-cryptography/" rel="nofollow ugc">http://arstechnica.co.uk/information-technology/2016/10/google-ai-neural-network-cryptography/</a></p>
<p>In b4 skynet 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285959">

			<div class="comment by-ted ">

				<p class="commentcredit">

					<span class="commenter">Ted</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285959">
						October 28, 2016 9:34 AM					</a>

				</p>

				<p><a href="https://www.fcc.gov/document/fcc-adopts-broadband-consumer-privacy-rules" rel="nofollow ugc">FCC Adopts Broadband Consumer Privacy Rules&lt;/a href&gt;<br />
 (News release, fact sheet, statements &#8211; released October 27)</p>
<p>Some info from the ‘</a><a href="http://transition.fcc.gov/Daily_Releases/Daily_Business/2016/db1027/DOC-341938A1.pdf" rel="nofollow ugc">Fact Sheet&lt;/a href&gt;’ (4 pages)</p>
<blockquote><p>Opt-In: ISPs will be required to obtain “opt-in” consent to use and share sensitive information. This includes precise geo-location (typically the real world location of a mobile phone or other device), children’s information, health information, financial information, social security numbers, web browsing history, app usage history, the content of communication</p></blockquote>
<blockquote><p>What the Rules Do NOT Do. 1) Do not regulate the privacy practices of websites or apps, like Twitter or Facebook, over which the Federal Trade Commission has authority. 2) Do not regulate other services of broadband providers, such as operation of a social media website. 3) Do not address issues such as government surveillance, encryption or law enforcement.</p></blockquote>
<p></a><a href="https://www.fcc.gov/ecfs/search/filings?proceedings_name=16-106&amp;sort=date_disseminated,DESC" rel="nofollow ugc">Docket 16-106 filings&lt;/a href&gt; (139 filings in last 30 days)</p>
<p>Filing from ‘Future of Privacy Forum’ (posted 10/25/16) includes:<br />
Ex Parte Notice Summary<br />
</a><a href="https://ecfsapi.fcc.gov/file/102429137507/FPF_Visual-Guide-to-Practical-Data-DeID.pdf" rel="nofollow ugc">A Visual Guide to Practical Data De-Identification</a><a href rel="nofollow ugc"> (pdf)</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285960">

			<div class="comment by-ted ">

				<p class="commentcredit">

					<span class="commenter">Ted</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285960">
						October 28, 2016 3:52 PM					</a>

				</p>

				<p>The FTC approves “good-faith security research” starting today.</p>
<p><a href="https://www.ftc.gov/news-events/blogs/techftc/2016/10/dmca-security-research-exemption-consumer-devices" rel="nofollow ugc">https://www.ftc.gov/news-events/blogs/techftc/2016/10/dmca-security-research-exemption-consumer-devices</a></p>
<p>In the online cybersecurity economics class that <a href="https://www.schneier.com/blog/archives/2016/10/free_online_cyb.html" rel="nofollow ugc">Bruce mentioned&lt;/a href&gt; earlier this month, Mr. Anderson discusses the need for practical research to properly inform policy makers. More than just certifications, he suggests that if you want evidence-based policy that is founded on more than theoretical models, then you&#8217;d better go out there and collect evidence. (section 1.5).</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285961">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285961">
						October 28, 2016 7:03 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p>You wrote @Figureitout:<br />
<i>”The forward error correction library should be able to tell how many errors where corrected. Receiver side software can then keep track of changes in performance.”</i><br />
Yup, only I’m not quite happy with the term “performance” here.<br />
The mentioned principle of “Live Zero” <b>[1]</b>, which is deliberately adding error bits, is not about performance but system integrity.</p>
<p>Your next sentence, ending with:<br />
<i>”… but warnings when first recoverable errors start to occur.”</i> also doesn’t fit exactly (it is the deviation from “normal” in recoverable errors that would be a concern) so I don’t know if we “finally got it”?</p>
<p>Yes, I’m extremely fixed to the wording, but the reason is experience, so please apologize, I spent years of my life only repairing what bad design papers / contracts / ideas / misunderstandings <b>before</b> coding had caused.</p>
<p>Your paragraph starting with language barrier is true, esp. discussion in text is difficult, but verbal is worse, believe me, because most details get lost.<br />
E.g. from your posting I can read your reply to me but I can’t understand, there are to many inconsistencies I’d have to “swallow” (which I probably would when we sit together at a beer 😉<br />
I only don’t know if you want (and have the time) to hear them and if this forum is the right place to discuss, not to overburden other users and our host’s hospitality.<br />
Please tell me what you think.</p>
<p><b>[1]</b><br />
The adding of “errors” could be done in a pseudo-random manner to “pair” a certain set of devices at commissioning. This fingerprint might “forever” identify the sending device to the receiver, to detect a device change by an “evil servant”. To further obscure this practice I could go on and explain more details here in public, but … 😉<br />
Plus:<br />
Exactly here, at the overall design, the treat model, the adversary, the purpose (to say it bluntly), the proposed HW / SW model and open source (love it) I’m still chewing on several (still diffuse) questions (keyboard, PIN pad, smart card, who has access, &#8230;).</p>
<p>Hopefully I can check your documents this weekend.<br />
If there is there more than at github please tell me, too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285962">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285962">
						October 30, 2016 10:04 AM					</a>

				</p>

				<p>Thoth<br />
&#8211;Yeah looks good.  I like square things lol.  It&#8217;d be good for workplace security but still for my personal stuff I&#8217;d prefer making my own keypad etc.  Reduced attack surface and being able to see things easier (rather than reverse-engineering the HSM keypad) is just personal preference.</p>
<p>RE: crypto export laws<br />
Legally one may need to do that, but that horse has left the barn and it&#8217;s impossible to enforce.</p>
<p><i>Smart card readers are not meant to be secure anyway</i><br />
&#8211;&#8230;What?  Well that&#8217;s where the attacks will come from.  Doesn&#8217;t have to be arduino, can be any 8 bit micro, but as you saw w/ qualcomm buying nxp which just acquired freescale there&#8217;s eventually going to be not much choice soon I bet.</p>
<p>Markus Ottela<br />
<i>I&#8217;d rather have external channel.</i><br />
&#8211;Yeah me too, that path is always going to have an MCU though.  How else you going to communicate w/ the card?  Not quite sure how a smartcard would be used with TFC anyway.</p>
<p>RE: feedback unit<br />
&#8211;You wouldn&#8217;t need the latch and relay for most MCU&#8217;s (I heard something about chip Pi uses, that you need to set bits to read/write GPIO), you can just poll a GPIO pin via an interrupt service routine.  Pretty standard thing to implement in embedded world so you&#8217;d have some choices.  Recently, I learned that some chips will advertise more GPIO but it&#8217;s not normal GPIO and we had to do something real funky to toggle the lines.  So watch out for things like that, incase you start running out of pins to use.  I was thinking similar thing, how a malware could attack an I/O pin that just either goes high or low, firmware reading it would only repeat a packet if high, else low just continue.  Only practical attack is DoS attack just constantly sending errors, unlikely (best way to stop would be to harden NH as much as possible) but if it happens it would be pretty terrible and basically shutdown your chat session.  Clive was saying that needs to same time no matter if we read an error or not.  So each read would need enough delay to cover how long it would take to read an error and probably right before it retransmits.  Easier said than done to get those timings.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285963">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285963">
						October 30, 2016 6:53 PM					</a>

				</p>

				<p>Just because the horse has left the building doesn&#8217;t mean that it can&#8217;t or wont be enforced. If they left the reigns on the horse or maybe installed GPS to it you never know what the future will or will not bring.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285964">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285964">
						October 31, 2016 1:00 AM					</a>

				</p>

				<p>Whens the last time you heard of export law for crypto being brought up?  The horse that left the barn in the 90&#8217;s is dead now, and was beat to death by people who have no experience w/ things moving around the globe.</p>
<p>:Addenum:</p>
<p>Markus Ottela<br />
&#8211;Actually, just a &#8220;DoS&#8221; attack on an error pin would matter depending on how you handle error.  Looks like you give a little text warning, and an attacker could fill your screen up w/ error messages but your conversation could still get thru (could externally verify via phone or radio).  Either way, bringing down NH is the surest DoS attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285965">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285965">
						October 31, 2016 7:58 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<blockquote><p>When&#8217;s the last time you heard of export law for crypto being brought up?</p></blockquote>
<p>Not that long ago depending on how you view May16, the US were trying to get the Wassenaar Arrangement on &#8220;Export Controls for Conventional Arms and Dual-Use Goods and Technologies&#8221; upgraded back in 2014, supposadly to prevent the likes of Syria&#8217;s Assad and other ME Tyrants spying on &#8220;their people&#8221;. However what got amended and how &#8211;post Ed Snowden revelations turning the US into world wide pariahs&#8211; was a little to rich for US exporters who were imagining an end to their lucrative export market. Thus the US ended up arguing about their own argument&#8230;</p>
<p><a href="http://arstechnica.com/tech-policy/2016/03/us-to-renegotiate-rules-on-exporting-intrusion-software-under-wassenaar-arrangement/" rel="nofollow ugc">http://arstechnica.com/tech-policy/2016/03/us-to-renegotiate-rules-on-exporting-intrusion-software-under-wassenaar-arrangement/</a></p>
<p>Apparently the thing is as the Wassenaar is an &#8220;arrangment&#8221; not an agreement or treaty, it has no legal binding (unlike the old ITAR) for either control or reporting of such technologies (crypto being &#8220;Dual-Use&#8221;).</p>
<p>So it&#8217;s backfired on US &#8220;self image&#8221; especially when BIS rather than just implement them &#8220;published for comment&#8221; jusy about all sides raised complaint&#8230;</p>
<p>However the &#8220;Corporate Elite&#8221; that act as a &#8220;shadow government&#8221; in the US &#8211;via the neo-cons / war-hawks&#8211; to protect their interests have other options available to them such as NSLs etc on any US based entities (think about MicroSoft&#8217;s protracted argument about the independence of their Irish Data Center). It&#8217;s even been said by some that the US corporates / government could use TTP tribunals to kill off any foreign company exporting where the US or other aligned Eye do not want it to go (not sure how but as they sit in secret&#8230;)&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285966">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285966">
						October 31, 2016 8:41 AM					</a>

				</p>

				<p>@FigureItOut,</p>
<p>Global or not, what happens at home has international ramifications over the means. NIST was a hollowed out corpse, OpenSSL is was and will always be a work of hart. We might not be able to stop the linear evolution of something leaking and spreading but complexity and resources are finite who&#8217;s going to release &gt;256bit block/stream ciphers? Who&#8217;s going to vet them? Who&#8217;s going to implement them?</p>
<p>Some of the giants we stand are aren&#8217;t giant&#8217;s at all, but trojan horses towering over us in all their welded glory.</p>
<p>64bit cyphers only lasted so long, where are we at with 128&#8217;s ? And the 256 ones?</p>
<p>Certain fields of science are fields of diminishing returns, theoretical mathematics is one of them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285967">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285967">
						October 31, 2016 8:52 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<p>I was a little premature&#8230; The latest appears to be this mouthfull of legalese from earlier this month,</p>
<p><a href="http://www.lexology.com/library/detail.aspx%3Fg%3D396daedc-5ab0-4148-a5d6-e931aad83895" rel="nofollow ugc">http://www.lexology.com/library/detail.aspx%3Fg%3D396daedc-5ab0-4148-a5d6-e931aad83895</a></p>
<p>(If you can make head and tail out of it without refering to a myriad of other documents&#8230; Your in the wrong proffession 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-mod odd alt thread-odd thread-alt depth-1" id="comment-285968">

			<div class="comment by-moderator official">

				<p class="commentcredit">

					<span class="commenter">Moderator</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285968">
						October 31, 2016 11:30 AM					</a>

				</p>

				<p>@Markus: Enabling comment editing would necessitate registration, which is not required for visitors to participate in discussions here. If you need to make a correction, you can either post a corrected comment, with a preliminary request to @Moderator to delete the incorrect one; or post a request to correct the error.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285969">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285969">
						October 31, 2016 11:45 AM					</a>

				</p>

				<p>r</p>
<p>&#8220;256bit block/stream ciphers? Who&#8217;s going to vet them? Who&#8217;s going to implement them?&#8221;</p>
<p>The usual suspects. They do both; they implement their algorithms and then they fight each others algorithms.<br />
Plus quite a few others out there.</p>
<p>&#8220;64bit cyphers only lasted so long, where are we at with 128&#8217;s ? And the 256 ones?</p>
<p>Certain fields of science are fields of diminishing returns, theoretical mathematics is one of them.&#8221;</p>
<p>Well, we have them. They have arrived (and not just yesterday). 256 bit is a decisive marker because there is a rough logic that says &#8220;post-quantum will half bits, so 256 bit algos will have only the effective strength of 128 bit algos. For the sake of being on the safe side 128 bits are desirable because that gives us, give or take some more bits due to successful weakening, the 80 bits we need for our current definition of mid-term security&#8221;.</p>
<p>As for your doubts: Sure, some crypto people have sold out, no doubt. A tenure here a problem solved there &#8230; et voila, you have tainted work. We <em>know</em> that nist is to be considered a department of nsa.</p>
<p>But, and I like that example, while I never trusted the rsa guys (which turned out to be well justified mistrust), the algorithm can be checked by everybody (well, by everybody with some knowledge and inclination).</p>
<p>I see no reason to mistrust <em>all</em> the crypto people and mathematicians. Btw. there are practical reasons, too. Assume someone found an algorithm that considerably speeded up, say, factoring. Woulkd he keep that secret? Could he? After all, those people usually don&#8217;t work in solitude; they use, for instance, computer arrays, they have secretaries, they communicate with each other. In other words, the chances are very, very small for such an evolution to stay secret (people working <em>within</em> nsa is another game, of course).</p>
<p>I feel well with current algorithms. Even with rsa. If there is pain then that&#8217;s in the PK corner. The known and widely used algo won&#8217;t survive PQ and the new ones aren&#8217;t properly tested or are way to big to be practically and economically usable or &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285970">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285970">
						October 31, 2016 12:04 PM					</a>

				</p>

				<p>@ab,</p>
<p>I don&#8217;t, if I did I wouldn&#8217;t be here gleaning and preppering would I?</p>
<p>I just like to think of those giant over-arching bay watching hercules&#8217; as salt&#8230; in the wound&#8230; in the future&#8230; It&#8217;s a shell game of trust isn&#8217;t it?</p>
<p>Where&#8217;s the 512bit transactions? 256 is &#8220;good enough&#8221; now with the Certificate Authorities I&#8217;m assuming and if the Wassenar is truly a gentle man&#8217;s agreement then it&#8217;s known to be politically unprosecutable (excluding proles, snivvies ofc). Which makes the whole encryption ordeal a non-issue as there&#8217;s something else behind the incomplete switch case block.</p>
<p>I really do believe, that even if global export of crypto is allowed at this point it doesn&#8217;t matter because even without the info the meta is still controlled and available. Make no mistake, THEY WILL know when you&#8217;re studying how to build a 8192bit public key transform. Make no mistake if you speak math like some people speak database or admin they&#8217;ve got a pidgeon trained on you.</p>
<p>Sure, &#8220;we&#8221; can check it. But will we be &#8220;allowed&#8221; to deploy it? As-is? Vis-a-vis? Likely implementation errors will be introduced, evoked, maybe the RNG will be poisoned, side-channels made available.</p>
<p>You pushing the whole hrc email thing should make that very clear, if they were encrypted [properly] things would be fine. There&#8217;s resistance to meeting these goals not only from the public, but from the unpublic, the government and other hentities. If encryption were a reality&#8230; scratch that, secure comms. If secure comms were a reality then you mathematicians could sleep at night, but then again &#8211; if god gave us math &#8211; and geometricians gave us the bomba &#8211; then who would want that?</p>
<p>You guys are the pride and joy of export restrictions, and we&#8217;re a country of poor us borders. Give us your sick, your disenfranchised we&#8217;ll put them to work building an economic and political weapon unmatched by any fully-closed source dictatorship. We will change the world a bit at a time.</p>
<p>I guess I trialed off, anyways you guys all know you should remain guarded&#8230; maybe you are&#8230; maybe you REALLY are guarded, I can&#8217;t check your originating hosts yanno? But it&#8217;s an open timeline and anyone can be subverted or put down. It&#8217;s a scary thought when the pressure from the plotus is concerned about preventative economic pressure to remain stable boiling it&#8217;s contents instead of figuring out how to properly cook the contents without charring the insides. They&#8217;re on fire and it&#8217;s not going to stop any time soon.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285971">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285971">
						October 31, 2016 12:39 PM					</a>

				</p>

				<p>r</p>
<p>I&#8217;m not sure I can follow you, but from what I understand you are mixing up some quite different if more or less losely connected matters.</p>
<p>Can we use, say 8192 bit rsa? Sure, besides a very unattractive cost-benefit ratio I don&#8217;t see any reason why we couldn&#8217;t.<br />
Can we export good crypto? Well, that&#8217;s somewhat more complicated and I&#8217;m strongly limited in my understanding as I lack legal training, From what I see, it&#8217;s two sided: On one hand probably some laws in some countries could prohibit that; it seems questionable, however, whether that could actually be enforced. On the other hand that cat is out of the bag and in the wild anyway. Maybe, if I happened to work for a major enterprise where the legal department has to be asked even before farting, I couldn&#8217;t; but then the major problem wouldn&#8217;t be the state anyway (but rather my employer wanting to have everything). If, on the other hand, I happened to be a math or compsci prof who has found and developed some something great I could almost certainly put that into the wild, and even if my state would prohibit it, they could hardly enforce it. After all there would be papers, discussions with colleagues all over the earth, etc.</p>
<p>So, yes, my take is that we <em>can</em> both check and develop/deploy crypto quite freely.</p>
<p>My worries concern mainly two issues: a) implementation and b) the dark zone (nsa, &#8230;).</p>
<p>a) is urgent and important. Virtually all &#8220;broken crypto&#8221; (besides ridiculous old shit) has <em>not</em> been broken crypto but broken <em>implementation</em>. To make it worse, there are probably hundreds of heartbleeds more lurking out there.</p>
<p>Another major pain in terms of implementation is how PK is actually implemented, particularly the CA problem is very, very frigthening. It basically comes down to being secure where you do not really need it (shopping at ebay or sending love letters, etc) and not being secure where you really need it (protection from gov. eavesdropping, etc.)</p>
<p>Yet another &#8211; widely ignored &#8211; PK <em>implementation</em> problem is that all those SSL/TLS servers (httpS, et al.) are basically attack vectors. Anyone can ask my httpS server to do a LOT more work (than http), hence even relatively small attacker can abuse SSL/TLS as (D)DOS attack vector.</p>
<p>The other factor (b), the &#8220;dark zone&#8221; is not merely nsa next to certainly working on ways to crack crypto using mathematics but mainly that they try that also in more sinister ways. Having every byte on major IXs is an ugly example of that.</p>
<p>However, what Snowden has shown us is clearly not to be adressed by better crypto alone. The really big issue there is politics and law (ignoring politicians and agencies).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285972">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285972">
						October 31, 2016 2:04 PM					</a>

				</p>

				<p>I meant, ignoring both the politicians and the politik[s] that we are all on somebody&#8217;s payroll.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285973">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285973">
						October 31, 2016 4:03 PM					</a>

				</p>

				<p>r<br />
<i>who&#8217;s going to release &gt;256bit block/stream ciphers? Who&#8217;s going to vet them? Who&#8217;s going to implement them?</i><br />
&#8211;Probably djb or the annointed few, and they&#8217;ll require lots of care and nurturing to get the security. I&#8217;m looking forward to crypto made for 100+ cores, will be sick.</p>
<p>Clive Robinson<br />
&#8211;That was intrusion software, not crypto, and what&#8217;s come from those rules if they&#8217;ve even made it out of committee: it&#8217;s never been easier to get all kinds of exploits online. Notice this quote too &#8220;<i>The same sort of rules once restricted the export of commercial-grade encryption</i>&#8220;. There isn&#8217;t even that much new crypto today, lots of similar algorithms.</p>
<p>And your other link returned error or corrupted (from you I&#8217;m guessing corrupted :p), so a broken link doesn&#8217;t help the case much either.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285974">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285974">
						October 31, 2016 4:23 PM					</a>

				</p>

				<p>@FigureItOut,</p>
<p>I look forward to ChaCha etc on ultrascale stuff, but it wont be the consumers who obtain it first. We tend to &#8216;buy the [server] farm&#8217; before we&#8217;re ever out of the gate.</p>
<p>There really are an annointed few, if we don&#8217;t get this education and awareness stuff down we will lose the race condition of &#8220;securely&#8221; creating mathematicians and cryptographers.</p>
<p>Can we create them faster than others can identify and exploit them?</p>
<p>It&#8217;s tragic, I was raised with an such idealistic view of humanity I can&#8217;t believe how thick I have been &#8211; it&#8217;s all cloak and dagger &#8211; to not be operating in such extremes is to leave a vacuum for others to fill.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285975">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285975">
						October 31, 2016 5:27 PM					</a>

				</p>

				<p>@ Figureitout,</p>
<blockquote><p>And your other link returned error or corrupted (from you I&#8217;m guessing corrupted :p), so a broken link doesn&#8217;t help the case much either.</p></blockquote>
<p>Try a google of,</p>
<ul>site : <a href="http://www.lexology.com" rel="nofollow ugc">http://www.lexology.com</a> Wassenaar Arrangement encryption</ul>
<p>And it should be in the top results (and people wonder why I don&#8217;t like giving anything other than simple links).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285976">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285976">
						October 31, 2016 10:37 PM					</a>

				</p>

				<p><b>Assange&#8217;s view on Googles head</b></p>
<p>As some of you may know during his spare time cooling his heals in London Julian Assange has been writing a book[1]. In essence it&#8217;s &#8220;beware the holder of the olive branch&#8221; on Googles head Eric  Schmidt and his less well known associates.</p>
<p>And there is a &#8220;taster&#8221; up on the wikileaks site,</p>
<p><a href="https://wikileaks.org/google-is-not-what-it-seems/" rel="nofollow ugc">https://wikileaks.org/google-is-not-what-it-seems/</a></p>
<p>What ever people may think of Julian as an individual or aid to whistleblowers, the piece is quite readable (if a little long for a single web page). As far as I can see the facts given are correct, but they are but the threads of a wider wholecloth julian has woven with them.</p>
<p>The taster is worth a read over a cup of coffee.</p>
<p>[1] <a href="http://www.orbooks.com/catalog/when-google-met-wikileaks/?utm_source=newsweek&#038;utm_medium=serial&#038;utm_campaign=google_met_wikileaks" rel="nofollow ugc">http://www.orbooks.com/catalog/when-google-met-wikileaks/?utm_source=newsweek&#038;utm_medium=serial&#038;utm_campaign=google_met_wikileaks</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285977">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285977">
						October 31, 2016 11:19 PM					</a>

				</p>

				<p>Clive Robinson<br />
&#8211;Yeah, &#8220;BIS Updates the EAR to Implement Wassenaar Changes to Encryption Controls and Others&#8221; on Oct. 20.  Had to do a little searching eh?  Looks like it &#8220;Notably, the rule eliminates Encryption Registration requirements&#8221;.  Not sure what exactly that means, don&#8217;t really care and won&#8217;t affect my purposes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285978">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285978">
						November 1, 2016 12:33 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<blockquote><p>Not sure what exactly that means&#8230;</p></blockquote>
<p>It&#8217;s something I&#8217;m still looking into, but from what has been said by others, it&#8217;s what looks like a change for the better, but is infact a change for the worse.</p>
<p>That is the old system had a reporting mechanism back to a state entity. The new system requires open self reporting available to all. Which puts a whole lot more information into the public domain than the old system ever did.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285979">

			<div class="comment by-markus-ottela ">

				<p class="commentcredit">

					<span class="commenter">Markus Ottela</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285979">
						November 1, 2016 8:00 AM					</a>

				</p>

				<p>@Sancho_P</p>
<p>&#8220;I only don’t know if you want (and have the time) to hear them and if this forum is the right place to discuss&#8221;</p>
<p>The design needs to be formalized eventually. The wording is quite important so I&#8217;d rather split the hairs before finalizing the design and restarting writing of white paper.</p>
<p>&#8220;This fingerprint might “forever” identify the sending device to the receiver.&#8221;</p>
<p>NH can be compromised from network. You can&#8217;t trust NH is able to authenticate TxM hasn&#8217;t got malware in it. TxM needs to be trusted implicitly. If that can be done, integrity checking isn&#8217;t necessary. TxM can be perhaps audited with external spectrum/logic analyzers, but I think that&#8217;s out of scope for most users.</p>
<p>RxM can be compromised from network through the data diode (via NH). Therefore both of these devices can lie about anything that gets displayed to user. You can&#8217;t trust any integrity verification mechanism in these systems. The only thing trust is built on is, it&#8217;s risky to show arbitrary messages on RxM if they&#8217;re out of context with what user and contact have previously sent from their trusted TxMs. It&#8217;s risky to compromise TxM installation procedure as it&#8217;s a finite set of network traffic and code that needs to be audited, once.</p>
<p>&#8220;to detect a device change by an “evil servant”&#8221;</p>
<p>You can&#8217;t detect it on any device. I&#8217;ve designed TFC so that as long as the security premises I listed previously hold true, it&#8217;s secure against remote attacks.</p>
<p>Also, I apologize the rant about insecure ACK channels. Reading the imgur&#8217;s data diode description showed me you agreed on that since the beginning.</p>
<p>&#8220;Hopefully I can check your documents this weekend.&#8221;</p>
<p>Yes. Definitely read the Threat model, FAQ, Security design and maybe protocol description. It&#8217;ll be much easier to understand why I designed the system the way I did after that. Plus I&#8217;d love to get feedback on what remains unclear to new pair of eyes.</p>
<p>&#8220;If there is there more than at github please tell me, too.&#8221;</p>
<p>I did my best to ensure all relevant data was there. Unfortunately I haven&#8217;t been able to go through all notes and posts and discussions here and in Reddit. So I might be missing something.</p>
<p>@Figureitout</p>
<p>&#8220;How else you going to communicate w/ the card? Not quite sure how a smartcard would be used with TFC anyway.&#8221;</p>
<p>It&#8217;s probably easier to design secure firewall configuration system through external management port than to add a device to network that logs in through the WAN port of that firewall.</p>
<p>&#8220;How else you going to communicate w/ the card? Not quite sure how a smartcard would be used with TFC anyway.&#8221;</p>
<p>So the point is to prevent master key from physical attacker. This doesn&#8217;t prevent malware from storing messages on RxM, but it prevents impersonation when the keys can not be accessed in their decrypted state.</p>
<p>&#8220;Either way, bringing down NH is the surest DoS attack.&#8221;</p>
<p>You&#8217;d have to masquerade it as bug in NH.py. I think it&#8217;s much easier to DoS the connection to XMPP server. But outside bricking Syria&#8217;s backbone routers, entities like NSA prefer to remain covert in their jobs.</p>
<p>@ Moderator<br />
That&#8217;s very kind of you. Some image boards etc. have solved editing of anonymous posts with cookies, but I&#8217;m actually more happy with the site not setting any. Keep up the good work!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285980">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285980">
						November 2, 2016 1:20 AM					</a>

				</p>

				<p>Clive Robinson<br />
<i>new system requires open self reporting available to all</i><br />
&#8211;Ah, self regulation lol.  Bet they don&#8217;t have enough resources to check every product in a timely manner (how could they know they just have a pre-made firmware made for them?).  And it&#8217;s good anyway to make the info public, it&#8217;s a hint but just saying crypto algo/scheme shouldn&#8217;t break your security.</p>
<p>Markus Ottela<br />
<i>design secure firewall configuration system</i><br />
&#8211;Using what?  Another large PC?  Larger MCU&#8217;s w/ more code?  Attack surface expansion right there.  So you want the smartcard to have it&#8217;s own connection too.</p>
<p><i>So the point is to prevent master key from physical attacker.</i><br />
&#8211;How do you detect a physical attack?  From my messed up life experiences, I can tell you that, if they don&#8217;t want you to know they&#8217;ve been there, it won&#8217;t be easy to detect.  My particular attackers messed up big time getting emotional and gave me all kinds of intel so I could study their methods.  Physical violation is the worst, and it&#8217;s where most of the security industry throws its arms up.  That was the point of my nRF_Detekt project (which is ongoing, I want timestamps logged to an SD card and you can plug that into any Windows/Linux/Mac PC and store that data for evidence later.  Super simple and can be implemented on any MCU; I was just trying to make something tricky for attackers that would reset dataloggers by hiding them, forcing them to search more and further risk detection).</p>
<p><i>You&#8217;d have to masquerade it as bug in NH.py</i><br />
&#8211;Not so sure about that, think they can blaze right on thru as long as PC is connected to internet (hence I think completely separate channels other than internet are needed, RF is only practical one in use today; we need more but doubt a usable global channel that isn&#8217;t internet or RF will come in my lifetime), but depends on your OPSEC and cleanliness.</p>
<p>Seen some highly suspected attacks like remote rebooting (imagine you&#8217;re really in the zone, finishing up an assignment or writing code and you get a reboot that deletes some of the code you just wrote; that happened to me at school on school network which is usually pretty secure, they take it very seriously, and I believe they even run VMware virtual machines on the computers so whatever students do is eliminated when you kill the VM (there&#8217;s different IT dept&#8217;s across the different schools, weird how they do it, I do know which one is best and which PC&#8217;s start acting a little strange&#8230;).  Yet didn&#8217;t happen to anyone in my school lab, odd eh?) and such (I still think somehow destroying SATA controller via software to point technicians recommended new motherboard was most epic attack I&#8217;ve ever seen, if it was so, before that it was cat&#8217;s meowing on every mouseclick so pretty good sign of silly malware there lol.  Other than that there is a potential microcode exploit I&#8217;m looking for loosely on this same PC which I use as a live system for internet surfing, that can infect my personal favorite fresh live systems (loads microcode &#8220;updates&#8221; on each boot&#8230;doesn&#8217;t do that on other PC&#8217;s.  I can&#8217;t beat that besides doing my usual if needed getting on other PC&#8217;s completely unrelated to me and different connections but I find that morally repulsive and weak running away from attacks which I want to defeat head-on).</p>
<p>Recently, not sure if I&#8217;m witnessing same attack vector on another PC or just coincidence and/or benign error (computer reboots and unable to find HDD at times, usually directly connected to internet when it happens, last time it was one of my gmail accounts; all I do is replug sata cable and it boots fine again, finds HDD, all my files uncorrupted&#8211;leading me to believe more benign error since it&#8217;s been much more repeatable and can ever so slightly start forming a pattern).</p>
<p>Other attacks, I&#8217;ve done tests trying to see if there&#8217;s just eavesdropping malware trying to remain completely hidden.  I don&#8217;t mind that as much b/c it doesn&#8217;t really matter watching me study or whatever when I open source much of what I do.  It&#8217;s the destructive malware that really will leave a sour taste in the mouth (and get you more interested in security).</p>
<p>So I know you know all this, getting malware pre-loaded in PC&#8217;s at the fab (possible, more likely just bugs in firmware) or when you put a new OS on computer, likely get that image from internet, that&#8217;s most likely way of infecting RxM or TxM especially.  But NH is just so uncomfortably vulnerable compared to rest of TFC system, just irritating to think about when rest of system, I&#8217;m happy w/ and I&#8217;m sure you are too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-285981">

			<div class="comment by-sancho_p ">

				<p class="commentcredit">

					<span class="commenter">Sancho_P</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285981">
						November 2, 2016 6:57 PM					</a>

				</p>

				<p>@Markus Ottela</p>
<p><i>”The wording is quite important so I&#8217;d …”</i><br />
OK, I’m on track, just having less time this weekend than I thought, as always …<br />
I understood your NH being vulnerable from the network, that’s unfortunately a basic property of standard computers / PCs for common use. We should keep that in mind for later discussion.<br />
But I’d challenge your <i>”RxM can be compromised from network through the data diode (via NH).”</i><br />
Please give me some time, I’ll be back with several points, hints and (unfortunately) some questions 😉</p>
<p>Again, I’m not happy with our communication channel because that’s far beyond the scope of this forum.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-285982">

			<div class="comment by-gordon-jenkins ">

				<p class="commentcredit">

					<span class="commenter">Gordon Jenkins</span> •

					<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/#comment-285982">
						January 18, 2019 7:14 PM					</a>

				</p>

				<p>SPECTRE HUAWEI i3MVnH<br />
<a href="https://upload.wikimedia.org/wikipedia/en/c/c6/SPECTRE_Logo.png" rel="nofollow ugc">https://upload.wikimedia.org/wikipedia/en/c/c6/SPECTRE_Logo.png</a><br />
<a href="https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/Huawei.svg/590px-Huawei.svg.png" rel="nofollow ugc">https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/Huawei.svg/590px-Huawei.svg.png</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2016/10/friday_squid_bl_549.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2016/10/friday_squid_bl_549.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F10%2Ffriday_squid_bl_549.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2016/10/friday_squid_bl_549.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='10837' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2016/10/privacy_makes_w.html" rel="prev">← Privacy Makes Workers More Productive</a>		<a href="https://www.schneier.com/blog/archives/2016/10/ddos_attacks_ag.html" rel="next">DDoS Attacks against Dyn →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
