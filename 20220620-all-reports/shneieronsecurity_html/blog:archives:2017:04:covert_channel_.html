<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Covert Channel via Two VMs - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Covert Channel via Two VMs Comments Feed" href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/11112" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=11112' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F04%2Fcovert_channel_.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F04%2Fcovert_channel_.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-11112 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-11112" class="post-11112 post type-post status-publish format-standard hentry category-uncategorized tag-amazon tag-side-channel-attacks tag-ssh">

	<div class="article">

		<h2 class="entry">Covert Channel via Two VMs</h2>
		<p>Researchers build a <a href="https://www.theregister.co.uk/2017/03/31/researchers_steal_data_from_shared_cache_of_two_cloud_vms/">covert</a> <a href="https://cmaurice.fr/pdf/ndss17_maurice.pdf">channel</a> between two virtual machines using a shared cache.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/amazon/" rel="tag">Amazon</a>, <a href="https://www.schneier.com/tag/side-channel-attacks/" rel="tag">side-channel attacks</a>, <a href="https://www.schneier.com/tag/ssh/" rel="tag">SSH</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html" rel="bookmark">Posted on April 18, 2017 at 5:58 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html#comments">23 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html" data-title="Covert Channel via Two VMs" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-298675">

			<div class="comment by-guy ">

				<p class="commentcredit">

					<span class="commenter">Guy</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298675">
						April 18, 2017 6:22 AM					</a>

				</p>

				<p>Isn&#8217;t this just yet another in a long list of ways to exfil data? Doesn&#8217;t a lot need to go wrong before it&#8217;s impactful?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298676">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298676">
						April 18, 2017 6:54 AM					</a>

				</p>

				<p>I remember articles from the very start of VM&#8217;s stating in no uncertain terms that VM&#8217;s are <em>not</em> secure and should not be used as if they were securely separated from each other.</p>
<p>So this does not come as a surprise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298677">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298677">
						April 18, 2017 7:07 AM					</a>

				</p>

				<p>No surprise, but still an impressive achievement.<br />
As our host likes to say: Attacks only get better over time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298678">

			<div class="comment by-wiredog ">

				<p class="commentcredit">

					<span class="commenter">wiredog</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298678">
						April 18, 2017 7:09 AM					</a>

				</p>

				<p>Huh.  I thought that was obvious.  I set up VMs so that they can communicate via shared folders just to make it easier to keep data synchronized where necessary.  Heck, VMWare makes it easy to do that while setting up a VM.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298679">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298679">
						April 18, 2017 7:44 AM					</a>

				</p>

				<p>@ wiredog,</p>
<p>No, it was not obvious.  Data exfiltration happens through a CPU cache covert channel.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298680">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298680">
						April 18, 2017 7:51 AM					</a>

				</p>

				<p>VM is nonsense in terms of security. Get physical. And separate hardware as good as possible&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298681">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298681">
						April 18, 2017 8:54 AM					</a>

				</p>

				<p>Hasn&#8217;t the CPU cache been implicated before in covert exfiltration?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298682">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298682">
						April 18, 2017 9:12 AM					</a>

				</p>

				<p>This is a burgeoning field. I found these blasts from the past:</p>
<p>Attack of the week: Cross-VM side-channel attacks<br />
<a href="https://blog.cryptographyengineering.com/2012/10/27/attack-of-week-cross-vm-timing-attacks/" rel="nofollow ugc">https://blog.cryptographyengineering.com/2012/10/27/attack-of-week-cross-vm-timing-attacks/</a></p>
<p>Wait a minute! A fast, Cross-VM attack on AES<br />
<a href="https://eprint.iacr.org/2014/435.pdf" rel="nofollow ugc">https://eprint.iacr.org/2014/435.pdf</a></p>
<p>EXPLOITING PROCESSOR SIDE CHANNELS TO ENABLE CROSS VM MALICIOUS CODE EXECUTION<br />
<a href="https://www.blackhat.com/docs/us-15/materials/us-15-DAntoine-Exploiting-Out-Of-Order-Execution-For-Covert-Cross-VM-Communication-wp.pdf" rel="nofollow ugc">https://www.blackhat.com/docs/us-15/materials/us-15-DAntoine-Exploiting-Out-Of-Order-Execution-For-Covert-Cross-VM-Communication-wp.pdf</a></p>
<p>However, the study referred in the original post is not about a side-channel, but about a full blown encrypted communication channel.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298683">

			<div class="comment by-john-galt ">

				<p class="commentcredit">

					<span class="commenter">John Galt</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298683">
						April 18, 2017 11:11 AM					</a>

				</p>

				<p>@ Schneier</p>
<p>VMBR</p>
<p>Virtual Machine Based Rootkits</p>
<p>Almost as nasty as a Microcode Based Rootkit.</p>
<p>Paid for by the public dole (psychopath black budget) and a little help from others.  Probably from the same budget line item that pays artists to create crucifixes in a jar of urine.</p>
<p>Source code included.</p>
<p><a href="http://web.eecs.umich.edu/~pmchen/papers/king06.pdf" rel="nofollow ugc">http://web.eecs.umich.edu/~pmchen/papers/king06.pdf</a></p>
<p><a href="http://windowsitpro.com/security/virtual-machine-based-rootkits" rel="nofollow ugc">http://windowsitpro.com/security/virtual-machine-based-rootkits</a></p>
<p>We thank the anonymous reviewers and our shep-<br />
herd, Steve Gribble, for suggestions that helped us im-<br />
prove this paper.   We thank Peter Biddle,  Brandon<br />
Baker, and Eric Traut for providing valuable insight<br />
and discussions about this topic. We would also like to<br />
thank Rick Rashid, Ted Wobber, Butler Lampson, and<br />
Paul Barham for providing feedback on early versions<br />
of this paper.  This research was supported in part by<br />
National Science Foundation grants CCR-0098229 and<br />
CCR-0219085, by ARDA grant NBCHC030104, by In-<br />
tel Corporation, and by Microsoft</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298685">

			<div class="comment by-buck-mcfly ">

				<p class="commentcredit">

					<span class="commenter">Buck McFly</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298685">
						April 18, 2017 11:35 AM					</a>

				</p>

				<p>Credit where it is due: <a href="https://media.defcon.org/DEF%20CON%2023/DEF%20CON%2023%20presentations/DEFCON-23-Etienne-Martineau-Inter-VM-Data-Exfiltration.pdf" rel="nofollow ugc">https://media.defcon.org/DEF%20CON%2023/DEF%20CON%2023%20presentations/DEFCON-23-Etienne-Martineau-Inter-VM-Data-Exfiltration.pdf</a>:</p>
<p>&#8220;&#8221;&#8221;<br />
At the end of this talk we will go over a working VM to VM reverse shell example as well as some surprising bandwidth measurement results. We will also cover the detection aspect and the potential countermeasure to defeat such a communication channel. The source code is going to be release at that time on &#8216;github&#8217;<br />
&#8220;&#8221;&#8221;</p>
<p>The talk is here: <a href="https://www.youtube.com/watch?v=7X772EBdvnM" rel="nofollow ugc">https://www.youtube.com/watch?v=7X772EBdvnM</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298686">

			<div class="comment by-ross-snider ">

				<p class="commentcredit">

					<span class="commenter">Ross Snider</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298686">
						April 18, 2017 2:07 PM					</a>

				</p>

				<p>@Winter</p>
<p>The last paper doesn&#8217;t seem to achieve remote code execution (I was hoping to see this) but instead a series of covert channel leakage (of keys, etc).</p>
<p>This isn&#8217;t to take away from the paper, just it&#8217;s misleading title. These attacks are incredibly neat, for sure, and in many cases have practical implications.</p>
<p>Also, pretty interesting paper won the NSA&#8217;s best security paper some years ago: an effective mitigation to many of these VM attacks is to shuffle the VMs around so that they are not co-resident with other VMs for too long! Pretty surprising and fairly easy to implement, as well as being easy to characterize in terms of performance costs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298687">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298687">
						April 18, 2017 2:23 PM					</a>

				</p>

				<p>@ wiredog</p>
<p><i>I set up VMs so that they can communicate via shared folders just to make it easier to keep data synchronized where necessary.</i></p>
<p>Doesn&#8217;t everbody? I&#8217;ve got an entire pool of VMs that (on demand) share both local and cloud storage with their host either over hgfs or sshfs. No separate (Dropbox-OneDrive-Google Drive-whatever) clients needed on the guest OS&#8217;es, which is especially practical for unsupported platforms.</p>
<p>The 45KBps covert channel these guys are talking about &#8211; even an SSH connection! &#8211; is something entirely different and not particularly good news for folks hosting their entire infrastructure in the cloud.</p>
<p>@ Ross Snider</p>
<p><i>&#8230; an effective mitigation to many of these VM attacks is to shuffle the VMs around so that they are not co-resident with other VMs for too long!</i></p>
<p>Yes and no. If the &#8216;evil&#8217; VM is moved around too it can attack others. I would be kinda interested in how to detect such an attack. So would most devops, I suppose.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298688">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298688">
						April 18, 2017 4:29 PM					</a>

				</p>

				<p>@ Anon</p>
<p>Sure.  I think this one is the problem you are talking about:</p>
<p><a href="http://www.daemonology.net/papers/htt.pdf" rel="nofollow ugc">http://www.daemonology.net/papers/htt.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298689">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298689">
						April 18, 2017 6:50 PM					</a>

				</p>

				<p>I guess it needs to be said that,</p>
<ul><i>Researchers build a covert channel between two virtual machines using a shared cache.</i></ul>
<p>That this is by no means a new idea, just another instance of a cache covert channel.</p>
<p>Which is a sub-class of the more general class of &#8220;shared resource side channel&#8221; communications.</p>
<p>To do this all you need is a shared resource and an ability to measure it in some way. For instance some years ago it was shown that the temprature inside a computer fractionaly changed the frequency of the crystal that controled it. Thus if the host was &#8220;dual-homed&#8221; or had multiple VM&#8217;s on it by measuring the network timing you could show that two network interfaces or to VMs shared the same crystal. Thus things like Honeynets could be found or an insecure service running on the same host as a much more secure service that is being targeted.</p>
<p>I&#8217;m mentioning this not to detract from the researchers work, but to make people aware of just how difficult it is to avoid being open to this class of attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298690">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter">Chris Abbott</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298690">
						April 19, 2017 12:47 AM					</a>

				</p>

				<p>I use Virtualbox (was just on my VMs connecting to my SSH/SFTP server a minute before I read this ironically). I usually disable use host I/O cache and have a different host and guest OS (I know this is CPU cache, but maybe it helps a bit security wise). I bet things can get through the drag and drop feature too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298691">

			<div class="comment by-gregw ">

				<p class="commentcredit">

					<span class="commenter">GregW</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298691">
						April 19, 2017 7:31 AM					</a>

				</p>

				<p>So, could one create a covert channel between two physical hosts if they shared the same network switch?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298692">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298692">
						April 19, 2017 7:58 AM					</a>

				</p>

				<p>@ GregW,</p>
<blockquote><p>So, could one create a covert channel between two physical hosts if they shared the same network switch?</p></blockquote>
<p>Providing a host has a way to measure the behaviour ot the switch then the answer is yes.</p>
<p>The only other question to ask is what the bandwidth would be?</p>
<p>As this paper has demonstrated, it may well be much higher than you would at first suspect.</p>
<p>Welcome to the world of covert channels by shared resources.</p>
<p>Oh and before people ask, I can see a way to do it via a shared UPS if it&#8217;s the online type.</p>
<p>Put simply most UPSs of that type like mechanical generators change the waveform they generate under load, some even the frequency. If you examine the way most audio inputs work on PCs these days they have insufficient analog components to remove &#8220;mains hum&#8221; caused by circulating currents in the PSU. Instead they use DSP tricks to remove the hum. If the audio chip can be accessed then the likely hood is that the filtering could be either turned off or changed in some way to make measurements much easier&#8230; To send data all the computer has to do is change it&#8217;s computing load which makes the load on the UPS rise.</p>
<p>I&#8217;ll leave it upto some students in an Israeli University to do the rest, as they have before.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298693">

			<div class="comment by-confused ">

				<p class="commentcredit">

					<span class="commenter">confused</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298693">
						April 19, 2017 8:20 AM					</a>

				</p>

				<p>I&#8217;m confused about how this is useful. Who&#8217;s doing the communication? If it&#8217;s between two VMs you control, why not go on the network? If one of the parties is malware on an infected VM, wouldn&#8217;t this make you very noisy and detectable? Or can this be hidden effectively from the host VM OS?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298694">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298694">
						April 20, 2017 12:04 PM					</a>

				</p>

				<p>Is this supposed to be news?  Nearly any shared resource can be used for a covert channel.  If you don&#8217;t like having a covert channel, don&#8217;t share;  otherwise, make a business risk decision.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298695">

			<div class="comment by-my-info ">

				<p class="commentcredit">

					<span class="commenter">My Info</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298695">
						April 20, 2017 12:12 PM					</a>

				</p>

				<p>@Mike &amp; Ike</p>
<blockquote><p>Is this supposed to be news? Nearly any shared resource can be used for a covert channel. If you don&#8217;t like having a covert channel, don&#8217;t share; otherwise, make a business risk decision. </p></blockquote>
<p>Think about checksums like CRC-32 that were designed to protect against the risk of &#8220;accident,&#8221; vs. one-way hashes like MD5, SHA1, SHA2, etc. that were designed to protect against the risk of murder.</p>
<p>Risk of arson isn&#8217;t the same thing as risk of accidental fire.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298696">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298696">
						April 20, 2017 1:29 PM					</a>

				</p>

				<p>@ Mike,</p>
<blockquote><p>If you don&#8217;t like having a covert channel, don&#8217;t share; otherwise, make a business risk decision.</p></blockquote>
<p>Oh if onky they would&#8230; But they don&#8217;t, msnagment make a decision based on the CapEx they will let you have, and if you not they are lucky then the organisation won&#8217;t get attacked before you find another slightly more reasonable managment to work for&#8230;</p>
<p>The thing is managment are generaly in it for the short term to boost &#8220;shareholder value&#8221; then like the rats they are jump ship before it sinks. They talk up what a success they were, and if the organisation carries on looking good they will claim it&#8217;s because of the good foundations they put in place. If however it goes t1ts up they claim that those that followed them were not upto following their initial good lead&#8230;</p>
<p>With mentalities like that they win you lose unless you are more fleet of foot than they are&#8230;</p>
<p>Thus it&#8217;s like the old joke about two friends in the woods being chased by a bear. When one stops to tie his boot lace the other says &#8220;you&#8217;ll never out run the bear like that!&#8221;. The lace tier replies &#8220;I don&#8217;t have to out run the bear, only you&#8221;.</p>
<p>So make sure your laces are well tied at all times and out run the rats.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-298697">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298697">
						April 20, 2017 1:53 PM					</a>

				</p>

				<p>@ My Info,</p>
<blockquote><p>Think about checksums like CRC-32 that were designed to protect against the risk of &#8220;accident,&#8221;</p></blockquote>
<p>Aghh, no that&#8217;s not what they were designed for. They were designed to detect errors caused by AWGN in an analog Shannon Channel, after the digital signal had been recovered (demodulated). If the noise sepctrum is not AWGN then they are less effective for a whole heap of reasons. AWGN whilst being random has the same energy/hz bandwidth whilst Pink Noise has the same energy per octave increase in frequency (in electronics this is known as &#8220;flicker noise&#8221;).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-298698">

			<div class="comment by-patriot-comsec ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.patriotcomsec.wordpress.com' rel='external nofollow ugc' class='url'>Patriot COMSEC</a></span> •

					<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/#comment-298698">
						April 20, 2017 8:44 PM					</a>

				</p>

				<p>Counter-intuitive, highly complex attacks such as this are not going to stop.  This example shows how state actors have the advantage in exploiting and nurturing weakened systems for collection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2017/04/covert_channel_.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2017/04/covert_channel_.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F04%2Fcovert_channel_.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2017/04/covert_channel_.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='11112' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2017/04/surveillance_an_2.html" rel="prev">← Surveillance and our Insecure Infrastructure</a>		<a href="https://www.schneier.com/blog/archives/2017/04/smart_tv_hack_v.html" rel="next">Smart TV Hack via the Broadcast Signal →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
