<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Proof that HMAC-DRBG has No Back Doors - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Proof that HMAC-DRBG has No Back Doors Comments Feed" href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/11289" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=11289' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F08%2Fproof_that_hmac.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F08%2Fproof_that_hmac.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-11289 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-11289" class="post-11289 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-backdoors tag-cryptography tag-random-numbers">

	<div class="article">

		<h2 class="entry">Proof that HMAC-DRBG has No Back Doors</h2>
		<p>New research: &#8220;<a href="http://www.cs.princeton.edu/~appel/papers/verified-hmac-drbg.pdf">Verified Correctness and Security of mbedTLS HMAC-DRBG</a>,&#8221; by Katherine Q. Ye, Matthew Green, Naphat Sanguansin, Lennart Beringer, Adam Petcher, and Andrew W. Appel.</p>
<blockquote><p><b>Abstract</b>: We have formalized the functional specification of HMAC-DRBG (NIST 800-90A), and we have proved its cryptographic security &#8212; that its output is pseudorandom &#8212; using a hybrid game-based proof. We have also proved that the mbedTLS implementation (C program) correctly implements this functional specification. That proof composes with an existing C compiler correctness proof to guarantee, end-to-end, that the machine language program gives strong pseudorandomness. All proofs (hybrid games, C program verification, compiler, and their composition) are machine-checked in the Coq proof assistant. Our proofs are modular: the hybrid game proof holds on any implementation of HMAC-DRBG that satisfies our functional specification. Therefore, our functional specification can serve as a high-assurance reference.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/random-numbers/" rel="tag">random numbers</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html" rel="bookmark">Posted on August 30, 2017 at 6:37 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html#comments">37 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html" data-title="Proof that HMAC-DRBG has No Back Doors" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-306777">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306777">
						August 30, 2017 12:02 PM					</a>

				</p>

				<p>Title appears to be clickbait, I don&#8217;t see anything about backdoors in abstract.</p>
<p>I don&#8217;t even see reason to believe that RSA(sequential numbers) wouldn&#8217;t pass the tests mentioned.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306778">

			<div class="comment by-moz ">

				<p class="commentcredit">

					<span class="commenter">moz</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306778">
						August 30, 2017 1:13 PM					</a>

				</p>

				<p>@wumpus</p>
<p>I&#8217;m not qualified to comment on whether the proofs prove what they claim to prove.  However the lack of backdoors is in this:</p>
<p>NIST SP 800-90A generates pseudorandom<br />
output, <em>assuming</em> that HMAC is a pseudorandom function</p>
<p>In other words this doesn&#8217;t prove that HMAC has no backdoors, it proves that HMAC-DRBG doesn&#8217;t add any backdoors to HMAC.</p>
<p>Aside from the question of whether the proof really prooves and the question of the safety of HMAC, the headline is correct and less misleading than most headlines you will see in the media today.  In fact, it&#8217;s really only our own ignorance of what HMAC-DRBG that leads us to be tricked at all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306779">

			<div class="comment by-moz ">

				<p class="commentcredit">

					<span class="commenter">moz</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306779">
						August 30, 2017 1:15 PM					</a>

				</p>

				<p>BTW; my emphasis in the quote.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306780">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306780">
						August 30, 2017 8:24 PM					</a>

				</p>

				<p>Ok, so while it is relatively limited, it at least limits any shenanigans to an algorithm which appears to be fairly well known.  I was also wondering about the &#8220;ideally random seeding&#8221; the proof requires, and how badly that works in practice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306781">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306781">
						August 30, 2017 9:21 PM					</a>

				</p>

				<p>@wumpus</p>
<p>As long as your computer isn&#8217;t compromised, and it has sufficient sources of randomness, and the system RNG has been seeded with enough of these random bits that the attacker can&#8217;t brute force it, then you probably don&#8217;t have much to worry about (and &#8220;probably don&#8217;t have much to worry about&#8221; is about as good as you can get when it comes to practical and not just theoretical). With a desktop, the time between keystrokes, mouse movements, as well as a plethora of activity from all of the applications provides more than enough unpredictable data.</p>
<p>Ideally, your system RNG will have a proof to show that once it achieves an unguessable state (i.e. it&#8217;s been properly seeded with at least 128-256 unpredictable bits that haven&#8217;t been leaked to anyone) then it will remain in an unguessable state regardless of what is used to reseed it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306782">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306782">
						August 31, 2017 3:28 AM					</a>

				</p>

				<p>@ Anura, wumpus,</p>
<blockquote><p>&#8230; and the system RNG has been seeded with enough of these random bits that the attacker can&#8217;t brute force it</p></blockquote>
<p>And thereby hangs the rub&#8230;</p>
<p>It&#8217;s been known for years that there is a &#8220;chicken and egg&#8221; problem with security, which showes up realy quite baddly in embedded devices.</p>
<p>1) Getting &#8220;enough&#8221; is a real problem especially with low entropy devices, thus it can take a very long time (hours or days in some cases).</p>
<p>2) The number of random bits at first turn on is usually zero and does not build untill the system is in use.</p>
<p>3) For a system to be in use it should be secure, but this requires a large amount of random bits to generate certificates etc.</p>
<p>It&#8217;s a problem SigInt agencies are more than happy to exploit.</p>
<p>But the problem gets worse&#8230;</p>
<p>Having had this failing made public a few years ago various embedded software engineers came up with various ideas based around the likes &#8220;pre-seeding&#8221; or &#8220;quick and chaotic&#8221;.</p>
<p>One such set of reasoning is,</p>
<ul>AES-CNT is a secure algorithm thus if we encrypt the unit&#8217;s serial number with AES that will be secure to use as the pre-seed value.</ul>
<p>I suspect you both know why that is just another form of &#8220;magic pixie dust&#8221; or &#8220;magic umbrella&#8221; reasoning.</p>
<p>Getting good and sufficient entropy at start up is actually a very very hard problem to solve.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306783">

			<div class="comment by-atn ">

				<p class="commentcredit">

					<span class="commenter">ATN</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306783">
						August 31, 2017 4:22 AM					</a>

				</p>

				<p>To follow the current conversation, and in short:<br />
Same devices should get enough random numbers, but should not get the same random numbers&#8230;<br />
IHMO devices should also keep their random numbers secret, attacks after the event are a lot easier if you know the exact list of random numbers generated by the random number generator.<br />
It may be difficult to detect that a secure application has read the random number generator 300 times, but the operating system service has been intercepted and the data has been stored in some unused portion of the 4 TerraBytes hard drive&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306784">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306784">
						August 31, 2017 5:07 AM					</a>

				</p>

				<p>Clive Robinson</p>
<p>Oh, how I love the random field. Unfortunately, most (even developers) do not understand the field at all. Neither do they understand that good random is one of the very cores of good crypto, nor do they understand the properties of crypto.</p>
<p>To offer a typical example: One can read it anywhere -&gt; &#8220;Do <em>not</em> use prngs but CSprngs!!&#8221;.</p>
<p>Unfortunately that often is simply stupid, the reason being that most csprngs do <em>not</em> offer good random properties. They are (somehow) secure, yes, which usually means highly unpredictable but random is so much more than being unpredictable. One desires, for example, a good distribution, a long cycle, etc.</p>
<p>Plus, of course, as you correctly mentioned, there usually is the hen and egg problem. After all, we <em>want</em> our systems to start up in a predictable way and to a predictable status. So, where is the unpredictable life cycle starter to come from? Usually from not very random sources like (typ. small) timing differences, cpu built in rngs (by definition prng), network traffic &#8220;hazard patterns&#8221; &#8211; plus lots of fairy magic.</p>
<p>So, let us be smart and buy a Trng &#8211; which, of course, is then connected to our system, say by usb &#8230; which pretty directly translates to visibility to opponents (i.a. thanks to intel amt and similar plunder).</p>
<p>Just lovely that whole field (if one likes to be at the mercy of unseen third parties).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306785">

			<div class="comment by-neil456 ">

				<p class="commentcredit">

					<span class="commenter">neil456</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306785">
						August 31, 2017 7:40 AM					</a>

				</p>

				<p>I try really hard to not be a conspiracy theorist, but its getting really hard.</p>
<p>The facts:</p>
<p>According to the research, &#8220;This research was supported in part by DARPA agreement FA8750-12-2-0293 and by NSF Grant CCF-1521602.&#8221;</p>
<p>Both of these agencies are part of the government that wants back doors.</p>
<p>In other areas, like medical and psychology research, universities routinely find the results they were paid to find in published research that is not reproducible. This primarily comes from the taught misuse of statistics. Search for &#8220;replication crisis&#8221;. Some of the top statistics professors think that 50% or more of the medical drug studies reach false conclusions about the effectiveness of the drug being studied.  They also think that as much as 80% of the psychology  research is not reproducible. The problem here is that the universities don&#8217;t care if the research is correct, don&#8217;t know how to assure the research&#8217;s correctness, or don&#8217;t make sure they hire people that can be trusted.  They turn a blind eye as long as they are getting paid.</p>
<p>The lone non-university author is from Oracle and they are a huge government contractor.</p>
<p>I could not find, in a quick reading, where the authors provide access to the research data and programs such that a third party could analyze and replicate the findings.</p>
<p>Opinion:</p>
<p>Today we live in an environment where politics and money invades everything.  You can no longer trust that people, companies, universities, or researchers will do the right thing. There is a lot of government power at stake based on back door tracking of information and a lot of money to be made by universities and companies providing support for that power.</p>
<p>I don&#8217;t think that anyone should believe this research as it stands.  Maybe it will prove to be true over time as the research is replicated, but maybe not.  It is time to ignore the sound bites (hey its secure, trust us) and insist on all of the details.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306786">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306786">
						August 31, 2017 7:41 AM					</a>

				</p>

				<p>@ ab praeceptis and the other &#8220;usual suspects,</p>
<blockquote><p>So, let us be smart and buy a Trng &#8211; which, of course, is then connected to our system, say by usb &#8230; which pretty directly translates to visibility to opponents (i.a. thanks to intel amt and similar plunder).</p></blockquote>
<p>Many years ago (think last century) I used to design TRNGs as there were no adequate ones around that did not need &#8220;a mortgage sized loan&#8221; to buy[1].</p>
<p>What I realised then is as,true now as it was then. People do not want TRNGs they are to abstract an idea for most to get their head around, What they realy want is a &#8220;push button&#8221; &#8220;Key / Certificate Generator&#8221; that &#8211;back then- you talk to via a serial port and terminal / computer.</p>
<p>Whilst the market is still small a device that you could put in your pocket that has two or three buttons and slots for uSD cards or Smart cards, that creates Certificates or Key files that get written to the root directory either in plain text or via an intetnaly held cert, as &#8220;An HSM or CA in your pocket&#8221; would have a market.</p>
<p>[1] The reason they were so expensive is an abject lesson in pricing by supply and demand. The actual demand for TRNGs is realy realy low, thus the price is inordinately high to recover design, production run and storage costs. Because you might make only a hundred and sell them over five to ten years. Hence you need to recover the upfront cost over five or six units.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306787">

			<div class="comment by-bob-paddock ">

				<p class="commentcredit">

					<span class="commenter">Bob Paddock</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306787">
						August 31, 2017 7:43 AM					</a>

				</p>

				<p>Anyone have any insights to Quantum Tunneling based Random Event Generators?</p>
<p>The devices sold by Psyleron are considered the &#8216;Gold Standard&#8217; in Parapsychology Research, where researchers are trying to &#8216;prove&#8217; the Mind can change the outcome.</p>
<p>Alas they never go into details of how exactly their devices work.<br />
Searching for &#8220;Quantum Tunneling Random Number&#8221; turns up many possible ways.</p>
<p>Are there any papers that discus a comparison between various hardware methodologies?<br />
Chua&#8217;s Chaotic circuit, Avalanche noise in reversed-biased p-n junctions, optical &#8216;noise&#8217;, thermal &#8216;noise&#8217; etc.</p>
<p>Isn&#8217;t any truly random event generator also going to be a really good thermometer?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306788">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306788">
						August 31, 2017 1:11 PM					</a>

				</p>

				<p>@Clive Robinson &#8220;It&#8217;s been known for years that there is a &#8220;chicken and egg&#8221; problem with security, which showes up realy quite baddly in embedded devices.&#8221;</p>
<p>I&#8217;ve seen enough updates around here to know that mistakes in random number generation are easy to make and hard to fix.  Some really nasty and overdue patches have been needed on widely trusted software.</p>
<p>Intel included a RNG that should have been enough, but we know that it can&#8217;t be trusted (I suspect that calling it 16 times and hashing the result via SHA256 <em>should</em> work, but would call it more and prefer adding entropy from other sources.</p>
<p>When I first encountered the problem, most PC motherboards already had microphone ports, I thought that placing a microphone near a fan would make a great source of random numbers (or a great bug, take your pick&#8230;).  The picture quality of nearly any phone camera implies a ton of entropy, but hashing across sufficient data might use more power than you want (and again, the privacy issue).</p>
<p>As far as a possible market for a fob capable of producing secure random numbers, that is simply the ideal example of a &#8220;lemon market&#8221; (textbooks will only use less ideal examples due to the theoretical difficulties in explaining this one).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306789">

			<div class="comment by-tyr ">

				<p class="commentcredit">

					<span class="commenter">tyr</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306789">
						August 31, 2017 5:46 PM					</a>

				</p>

				<p>Time to ask a dumb question because someone<br />
might know.</p>
<p>Many years ago I ran some computer programs<br />
which were seeding a random number generator<br />
from a keyboard entry. This generated a<br />
sequence that the program used. What I found<br />
strange was that if you ran the programs<br />
again with the same keyboard seeding you<br />
got identical results. My interpretation at<br />
the time was that what computers call random<br />
wasn&#8217;t random at all. It seemed to be a case<br />
of the language mutating until things became<br />
there opposite without anyone bothering to<br />
notice. The repeatability was too handy to<br />
discard so became embedded and coloured the<br />
concept.</p>
<p>Is this a valid viewpoint ? Does comp use a<br />
concept called random that is not random at<br />
all in the previous sense of non connected<br />
number series ?</p>
<p>If both send and recieve have a non connected<br />
series to use as a key which can not be made<br />
by any method. It would seem to be a lot more<br />
work to crack (you&#8217;d have to use side channel<br />
analysis to get any information at all).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306790">

			<div class="comment by-john-kelsey ">

				<p class="commentcredit">

					<span class="commenter">John Kelsey</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306790">
						August 31, 2017 6:38 PM					</a>

				</p>

				<p>wumpus:</p>
<p>Out of curiousity, how do you know that the Intel hardware RNG can&#8217;t be trusted?  It&#8217;s clearly <em>possible</em> for any hardware RNG to be backdoored in some hard-to-detect way, but your statement seems to suggest a lot more than acknowledging a possibility.</p>
<p>Software entropy sources based on collecting noise from the operating system are pretty hard to meaningfully evaluate, and we know some cases where they don&#8217;t get enough entropy (the <a href="https://factorable.net/weakkeys12.extended.pdf" rel="nofollow ugc">Minding your P&#8217;s and Q&#8217;s</a> paper shows a bunch of examples where this happened to appliance firewalls and such based on Linux).  A hardware RNG solves that problem, but leaves you with the possibility that the guy who designed the hardware RNG has backdoored it.  The combination of the two sources, though, works out well: use the hardware RNG to get  (say) 512 bits of entropy input for SHA256_HMAC_DRBG, then use the OS&#8217; random sources (interrupt timings, mostly) to collect some more bits, and feed them into the DRBG as well.  If the OS didn&#8217;t collect enough entropy, you&#8217;re still covered unless your hardware RNG was also buggered.  If the hardware RNG is buggered, but your OS sources collected enough entropy (more than a hundred bits or so, in practice), you&#8217;re covered.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306791">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306791">
						August 31, 2017 7:02 PM					</a>

				</p>

				<p>@ tyr,</p>
<blockquote><p>Does comp use a<br />
concept called random that is not random at<br />
all in the previous sense of non connected<br />
number series ?</p></blockquote>
<p>A computer is determanistic in operation not random. It works on the inputs it receives to produce output. Think of it if you want as a wheel spining, it will (Newton&#8217;s first law) remain spining at the same rate unless subject to a force. The force is in effect the input and the spin rate is the output.</p>
<p>Most RNGs are not real TRNGs due to the problems with the true entropy sources. So as our host once designed you have a block of memory the contents of which are changed by the TRNG randonly known as the &#8220;entropy pool&#8221;. However the entropy pool is also accessed by the output algorithm that gives the RNG output to your application etc. One of the reasons it&#8217;s  called a pool is that it &#8220;gets stired&#8221; by the output algorithm to &#8220;spread the entropy&#8221;. Put simplybit runs a hash or other crypto algorithm against the entropy pool to change the values. But this is a determanistic process. So without the TRNG entropy input the entropy pool becomes like the State Array (Sary) in a stream cipher. So you would expect exactly the same number sequence from the same initial state of the entropy pool.</p>
<p>The idea in general is that the output function that is acting as a stream cipher will have a long enough cycle time that the TRNG will update the entropy pool / Sary into sufficiently out of sequence state that even knowing the crypto algorithm and the Sary state an attacker can not gain sufficient information to be able to predict the output. As a rough rule of thumb you&#8217;ld be looking at having a RNG output rate to average TRNG input of not more than a 1000:1 to alow for future attacks on the crypto algorithm.</p>
<p>I hope that helps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306792">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306792">
						August 31, 2017 7:57 PM					</a>

				</p>

				<p>@ John Kelsey, wumpus,</p>
<blockquote><p>Out of curiousity, how do you know that the Intel hardware RNG can&#8217;t be trusted? </p></blockquote>
<p>The fact they chose to hide it behind the &#8220;magic pixe dust&#8221; of a hash algorithm says that they have something to hide&#8230;</p>
<p>Do you waste time trying to find out what or do you just move on to something you can actually test and verify?</p>
<p>It&#8217;s a complaint I have consistently raised since Intel first brought out their white paper on their on chip RNG.</p>
<p>Look at it as an addition to,</p>
<p>Q : What do chefs do with sauces,<br />
That lawyers do with words,<br />
Doctors do with dirt<br />
And Intel engineers do with hashes?</p>
<p>A : Cover up their mistakes.</p>
<p>Harsh maybe but in serious security &#8220;you take no chances&#8221;, as was joked about the CIA moto of &#8220;In God we trust&#8221; it realy means &#8220;all others we check&#8221;. And &#8220;If you can not check do not trust&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306793">

			<div class="comment by-large-mouth-bass ">

				<p class="commentcredit">

					<span class="commenter">Large Mouth Bass</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306793">
						August 31, 2017 10:54 PM					</a>

				</p>

				<p>I just don&#8217;t like the way these &#8220;proofs&#8221; are being presented.  Yes, the idea of an automated checker (Coq etc.) for a formal proof is helpful, but there is clearly no human-readable presentation of the main ideas and significance the formal proof that was allegedly passed by &#8220;Coq.&#8221;</p>
<p>We need a car analogy:</p>
<p>It&#8217;s like some of those Haynes manuals they sell at the auto parts store: they tell you how to use a micrometer to measure the races of the journal bearings in case you are completely overhauling the engine, but some of the mundane details about wiring, switches, tubes, and hoses outside the engine itself, or differences from model to model, are missing, incomplete, or incorrect in the manuals.  Almost as if the guy who wrote the manual rather resented doing so, in the hopes that &#8220;consumers&#8221; would be &#8220;encouraged&#8221; to hire a professional mechanic, rather than do it themselves.</p>
<p>The &#8220;guy.&#8221; It&#8217;s even worse for ladies.  You can&#8217;t even cut your own fingernails or toenails.  You have to hire a &#8220;professional&#8221; for that, too. And don&#8217;t even think about working on your car.</p>
<p>I just <i>hate</i> the New World Order service economy.  Guns are banned and they just don&#8217;t let you make anything or do anything anymore.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306794">

			<div class="comment by-coyne-tibbets ">

				<p class="commentcredit">

					<span class="commenter">COYNE TIBBETS</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306794">
						September 1, 2017 12:29 AM					</a>

				</p>

				<p>Is it possible to prove a negative?</p>
<p>The authors obviously think so. Clearly they never read, &#8220;Reflections on Trusting Trust.&#8221;</p>
<p>It seems to me to hardly be necessary to consider much beyond that thought.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306795">

			<div class="comment by-large-mouth-bass ">

				<p class="commentcredit">

					<span class="commenter">Large Mouth Bass</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306795">
						September 1, 2017 12:39 AM					</a>

				</p>

				<p>Bears repeating.</p>
<p>Guns are banned, people steal shit, they don&#8217;t let you make or do anything, they run you out of town from city to city and from state to state, they screw up your birth certificate so you can&#8217;t even get a fscking passport, they got that white nationalist hate thing going, you can&#8217;t fight city hall because some village elders are telling you you can&#8217;t do this or that or the other thing when they haven&#8217;t even heard the full story, and pretty soon it&#8217;s a freaking town council, and next thing you know they&#8217;re aldermen like it&#8217;s damned Chicago, all telling you the same old lies, fsck, dude, you&#8217;re mentally ill, and you &#8220;need&#8221; to be on medication.</p>
<p>Oh, can&#8217;t you just get a job and work in this country?  Oh, sure, they&#8217;d hire you on the spot if you got a haircut &mdash; ha, ha, fooled you.</p>
<p>/transgendered</p>
<p>@COYNE TIBBETS</p>
<p>Who knows what those authors are thinking? English doesn&#8217;t even sound like their first language, and they just have too many names on that damned paper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306796">

			<div class="comment by-gasche ">

				<p class="commentcredit">

					<span class="commenter">gasche</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306796">
						September 1, 2017 4:38 AM					</a>

				</p>

				<p>@neil456:</p>
<blockquote><p>
  I could not find, in a quick reading, where the<br />
  authors provide access to the research data and<br />
  programs such that a third party could analyze and<br />
  replicate the findings.
</p></blockquote>
<p>The correctness proof is expressed using a &#8220;proof assistant&#8221;, which is a program that checks the correctness of mathematical proofs expressed in a certain constrained way (rather similar to a program&#8217;s code in a programming language).</p>
<p>The proofs (the checkable code of the proofs) of this publication is is publicly available online:</p>
<p><a href="https://github.com/PrincetonUniversity/VST/tree/master/hmacdrbg" rel="nofollow ugc">https://github.com/PrincetonUniversity/VST/tree/master/hmacdrbg</a></p>
<p>For example, the claimed correctness specifications of the HMAC-DRBG functions are available in this form at</p>
<p><a href="https://github.com/PrincetonUniversity/VST/blob/master/hmacdrbg/drbg_protocol_specs.v" rel="nofollow ugc">https://github.com/PrincetonUniversity/VST/blob/master/hmacdrbg/drbg_protocol_specs.v</a></p>
<p>and the (machine-checkable) reasoning steps constituting the proofs are available at</p>
<p><a href="https://github.com/PrincetonUniversity/VST/blob/master/hmacdrbg/drbg_protocol_proofs.v" rel="nofollow ugc">https://github.com/PrincetonUniversity/VST/blob/master/hmacdrbg/drbg_protocol_proofs.v</a></p>
<p>Running the proof-assistant program they used (Coq, which is developed in the open as free software by an independent team : <a href="https://en.wikipedia.org/wiki/Coq_(proof_assistant)" rel="nofollow ugc">https://en.wikipedia.org/wiki/Coq_(proof_assistant)</a> ) constitutes a way of &#8220;reproducing&#8221; the result.</p>
<p>Of course, you do have to evaluate the proof in detail to make sure that the assumptions are as claimed, that there is no difference between what is claimed to be proven and what actually was proven. To be able to do this, you have to be knowledgeable in both cryptography and mechanized proof / proof assistants (including being familiar with the specific proof assistant (&#8220;proof language&#8221;) used, Coq, and the general framework/methodology of C verification by this research group, <a href="http://vst.cs.princeton.edu/" rel="nofollow ugc">http://vst.cs.princeton.edu/</a> ).</p>
<p>I believe that the reproducibility and self-verifiability status of this work are extremely high, probably among the very best in all of science. Not only do you have a publicly available full mathematical proof, but the proof was expressed in a high level of detail that makes it verifiable by a machine &#8212; in particular, no reasoning step is left to the deduction of the reader (as is common in mathematical proofs circulated on paper / in LaTeX), everything can be unfolded to the level of detail you would desire.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306797">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306797">
						September 1, 2017 6:31 AM					</a>

				</p>

				<p>@the usual suspects</p>
<p>Impressions from the paper:</p>
<p>I&#8217;m torn; On the one hand it&#8217;s highly laudable work and well done wrt academia standards and common practice.<br />
On the other hand I (personally, subjectively, and maybe wrongly) consider it next to worthless from a technical and pragmatical pov (I do see, however, many good sides such as e.g. an increasingly strong tendency to have sharp eyes on nsa/nist).</p>
<p>My major complaints:</p>
<ul>
<li>The title is misleading. What they did verify is a sha-256 based variant and not &#8220;HMAC-DRBG&#8221; (in general).</li>
<li>Too much was assumed (which I can understand but which is questionable and puts the proof on somewhat wobbly ground)</li>
<li>I&#8217;m not sure the whole chain has been properly verified and proven correct. Note that (already a positive assumption) &#8220;a is proven, b is proven, c is proven&#8221; does <em>not</em> necessarily mean &#8220;a -&gt; b -&gt; c is proven&#8221; (&#8216;-&gt;&#8217; indicating tool chain flow).</li>
<li>CompCert. Wonderful work, love it, but: Such proof is <em>not</em> of a general validity. It&#8217;s merely a statement about CompCert&#8217;s interpretation of C.</li>
<li>
<p>(more general version of above) C is not provable, period. It&#8217;s a &#8220;standard&#8221; that is ambiguous and leaves much (of which much may not be of concern in general app. dev. but <em>is</em> of great concern in crypto dev.) at the pleasure of an implementor.</p>
</li>
<li>
<p>The algorithm is largely simply assumed to be of good quality. It is, however, well known that most CSprng are <em>not</em> generally having good random properties. Many failed or performed poorly in, for instance, BigCrunch tests.</p>
</li>
<li>
<p>The authors do understand (they mention it explicitely) that frequent re-seeding (no further qualification) does not provide better attack resistance.</p>
</li>
</ul>
<p>I would like to add to the last point, which imo is of high importance, that we need more work done re. re-seeding and ideal actually used period fraction.</p>
<p>Reason: The relevant issue is which constellation gives Eve the best chance to attack. One tradeoff of major relevance is the following: The longer the actually used part of the algos period, the better for Eve (due to having a long series in the generators target domain). Re-seeding after, e.g. period/2 (let alone full period) provides a highly attractive situation for Eve. On the other hand, i.a. for reasons of practicality and performance, the other extreme of reseeding every 2^1 cycles is giving away next to nothing (provides no basis for series analysis to Eve) but highly increases the DOS attack surface, particularly with high cost CSprngs.<br />
Based on (very primitive, due to diverse personal limitations) research and analysis a number of cycles in the range of cube_root(period)/2 seems to be the sweet spot.<br />
Moreover I suggest to use ratchets with a high quality (non CS) prng offering excellent random properties driven by a CSprng for (re)seeding.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306798">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous++</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306798">
						September 1, 2017 10:06 AM					</a>

				</p>

				<blockquote><p>Of course, you do have to evaluate the proof in detail to make sure that the assumptions are as claimed, that there is no difference between what is claimed to be proven and what actually was proven.</p></blockquote>
<p>Right. That&#8217;s exactly what I&#8217;m really trying to get at.  A high-level <i>expository</i> write-up of exactly what, in human terms, you are attempting to prove, and how the mechanized formalization of that provable statement corresponds to what you say you are proving.</p>
<p><i>Not</i> a dump of technical details, and, &#8220;We proved [something] in Coq!&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306799">

			<div class="comment by-large-mouth-bass-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Large Mouth Bass (Anonymous++)</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306799">
						September 1, 2017 10:28 AM					</a>

				</p>

				<p>Interesting.  I had parked in a gravel lot for a long time, but I had my cell phone turned off.  No one came near or bothered me.  As soon as I turned my phone on, a man rode by in a bicycle, and then another man drove up in a pickup, made some sexual comments, and told me I was on private property.</p>
<p>Stalking with a sexual motivation. You can&#8217;t take my guns and my livelihood away for alleged &#8220;mental illness&#8221; and then tell me I&#8217;m on &#8220;private property&#8221; after tracking me down by the location of my cell phone.  You don&#8217;t own shit when you&#8217;re perpetrating a Holocaust.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306800">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306800">
						September 1, 2017 10:42 AM					</a>

				</p>

				<p>Anonymous++</p>
<p>Well, they kind of do offer that.</p>
<p>But as so often the trouble is in the details. One I mentioned already is that proving some property of &#8220;HMAC-DRBG&#8221; and of an sha-256 implementation is <em>not</em> really the same. On the other hand I understand that the authors had to chose; they could either limit themselves to HMAC-DRBG or they could examine a widely used implementation (of which they chose the latter).</p>
<p>Another issue I see (I didn&#8217;t mention yet) is the problem of proving a random generator. Just try to think about an approach in terms of a postcondition; what and how would you formulate that? To make it more difficult there is more than one relevant property, each of which is difficult to examine. So they chose a game theory approach. That has certain advantages, the major one being feasibility but it&#8217;s not a full proof in the strict sense.</p>
<p>So, does that work really &#8211; in the strict sense &#8211; deliver what its title promises? No, it does not. Is it worthless then? No, absolutely not. It does, for instance, contribute a lot in terms of understanding the problem field and to gain some more trust.</p>
<p>That said, do I personally now trust HMAC-DRBG any more? No, absolutely not. spotting &#8220;game theory&#8221; to me translates to &#8220;probability games&#8221; and &#8220;not trustworthy&#8221;.<br />
But I&#8217;m still glad that Bruce Schneier brought that work to our attention and I <em>do</em> quite some value in it (albeit not the advertised one).</p>
<p>As for the complaint: That field <em>is</em> difficult, even more so as that work actually combines multiple (albeit losely related) fields, each of which isn&#8217;t exactly simple. It&#8217;s next to impossible to make a sufficiently precise and correct statement that at the same time is Jane and Joe understandable (even if Jane and Joe are not at all stupid and seriously interested).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306801">

			<div class="comment by-john-kelsey ">

				<p class="commentcredit">

					<span class="commenter">John Kelsey</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306801">
						September 1, 2017 5:11 PM					</a>

				</p>

				<p>Clive Robinson:</p>
<p>First, the Intel RNG doesn&#8217;t use a hash function for cryptographic post-processing&#8211;they use a block cipher (AES).  (Maybe you&#8217;re thinking of the much older Intel HWRNG, from a couple decades ago, which did use SHA1 for postprocessing?)  The <a href="https://en.wikipedia.org/wiki/RdRand" rel="nofollow ugc">Wikipedia writeup</a> on the current RDRAND design is pretty decent.</p>
<p>Second, cryptographic post-processing is a way to guarantee that your outputs are good even when your source is imperfect.  This seems 100% reasonable as a design, and it&#8217;s very common in hardware RNGs.</p>
<p>The alternative is that you could have an entropy source that you read yourself, and then feed it into some cryptographic postprocessing later to get good statistical properties and such.  That gives the user of the thing one more job to do to use it, though, and I&#8217;m not sure how much it improves security.  It&#8217;s not clear to me that you could tell, from the outside, whether the entropy source you were looking at was really getting a lot of entropy, or was just doing some moderately complicated internal thing that gave good statistics.  For all you know, inside the black box, the entropy source is just a simulation with a fixed seed burned in at the factory.  How would you tell?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306802">

			<div class="comment by-john-kelsey ">

				<p class="commentcredit">

					<span class="commenter">John Kelsey</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306802">
						September 1, 2017 5:16 PM					</a>

				</p>

				<p>ad preceptis:</p>
<p>I just skimmed the paper, but as I understood it, they did two different kinds of proof:</p>
<p>a. A proof that assumes HMAC is a PRF (that is, a kind of ideal keyed function&#8211;if you don&#8217;t know the key, every new input gives you a random number as an output).  That proof shows that HMAC_DRBG is secure <em>given that assumption</em>.</p>
<p>HMAC being a PRF is a really common assumption in the world&#8211;it&#8217;s used all over the place in practical crypto protocols.  If you think SHA256 is a good hash function (which is seems to be), then you more-or-less should believe that HMAC-SHA256 is a PRF.</p>
<p>b. A proof that a particular implementation follows the specification of HMAC_DRBG using SHA256.</p>
<p>This proof guards against screw-ups in the implementation of the algorithm, but doesn&#8217;t say anything about the algorithm itself being secure.  You could do this kind of proof of a SHA1 implementation, and it would let you know that a given implementation of SHA1 had implemented the algorithm as specified, but it wouldn&#8217;t keep SHA1 from being a broken hash function!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306803">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306803">
						September 2, 2017 1:35 AM					</a>

				</p>

				<p>@ John Kelsey,</p>
<blockquote><p>Maybe you&#8217;re thinking of the much older Intel HWRNG, from a couple decades ago, which did use SHA1 for postprocessing?</p></blockquote>
<p>Yes it&#8217;s what I ment to convey with,</p>
<p><i></p>
<ul>It&#8217;s a complaint I have consistently raised since Intel first brought out their white paper on their on chip RNG.</ul>
<p></i></p>
<p>I was meaning the whitepaper they brought out with their first on chip TRNG line up.</p>
<p>But even though they now use AES the purpose is the same as the hash, which is to hide what is on the other side of the curtain.</p>
<p>Having designed all electronic TRNGs and a few electromechanical-electronic ones as well in the past I have a first hand knowledge of just what crud hides behind the curtain which is why in my designes I always made it avilable at a &#8220;test point&#8221; and often via a BNC connector on the front panel.</p>
<p>To see why I call it &#8220;magic pixe dust&#8221; or &#8220;magic umbrella thinking&#8221; a little thought experiment.</p>
<p>The output of the TRNG source such as thermal noise is amplified to a usable level and then &#8220;sampled&#8221; the sampling can be either &#8220;predictable&#8221; or &#8220;unpredictable&#8221;[1] the result is a stream of bits, that look like the ramblings of a mad oracle.</p>
<p>The ramblings may or may not be a message, some recognisable noise or something compleatly unrecognisable.</p>
<p>In a more practical view point all physical sources show bias, faux entropy and real entropy. Bias is something that is simply recognised and almost as simply removed by a &#8220;debias circuit&#8221;. The problem is faux entropy, as it&#8217;s often hard to recognise and harder still to remove.</p>
<p>For instance take two very very high stability oscillators square them up and put one into the D input of a D-Type latch the other into the CLK input. If you look at the Q output on an oscilloscope, close in it looks very random. However if you put it through an integrator, you will end up with a very high quality sine wave at the difference frequency of the two oscillators&#8230; So not random at all, hence that Q output signal is faux entropy. Likewise with a switch mode powersupply it produces a noise signal that looks random but is mainly not. That is the bulk of it is faux entropy with a tiny fraction being real entropy caused by quantum effects.</p>
<p>Thus the hard problem is getting the real entropy without the faux entropy. Why is this important well two reasons. Firstly an attacker may be able to use various techniques to lock onto[2] the faux entropy and thus to them it is close to being a fully determanistic system. Secondly due to insufficient protection they may well br able to inject their own faux entropy signal and thus make the supposed TRNG very much determanistic [3]. Either way it reduces the entropy to negligible amounts such that a simple value/range search becomes not just possible but trivial[3].</p>
<p>Which brings me to,</p>
<blockquote><p>Second, cryptographic post-processing is a way to guarantee that your outputs are good even when your source is imperfect. This seems 100% reasonable as a design, and it&#8217;s very common in hardware RNGs.</p></blockquote>
<p>This is a common belief and it is totaly wrong, hence &#8220;Magic Pixie Dust Thinking&#8221;.</p>
<p>To see why imagine that insted of chaotic rambings the oracle puts out a very clear plaintext message like reading out the entirety of the &#8220;Harry Potter&#8221; books. Once you have heard a few words you can very accurately predict the rest of the words. That is there is zero entropy in the plaintext message. Now we encrypt the message into ciphertext using AES. The message now appears to be random according to all the statistical tests. However we know it&#8217;s not random ay all, that is there has been no increase in real entropy what so ever in the message it&#8217;s just been subject to a fully reversable determanistic pocess. If you know he AES key then you can decrypt it to get the original zero entropy message.</p>
<p>As I occasionally say about &#8220;security myths&#8221;,</p>
<ul><i>If it looks like a duck, quacks like a duck and waddles like a duck, that does not mean it is not a goose.</i></ul>
<p>Hashing / encrypting an entropy source does not increase entropy all it does is smear it out a bit. To believe otherwise is to belive in pixes and magic dust. At best it&#8217;s security by obscurity, with an obscurity that can easily be stripped off.</p>
<p>Which is a point I suspect you realy know in your subconscious because you say,</p>
<blockquote><p>That gives the user of the thing one more job to do to use it, though, and I&#8217;m not sure how much it improves security.</p></blockquote>
<p>All it does is change the problem to one of &#8220;also knowing the encryption key&#8221;. Which could easily be leaked in a whole host of ways. For instance you could simply replace the MSB bit in each encryption output with a bit of the key. An attacker in the know would after having recovered the leaked key then have the most trivial of search spaces (ie 2) to get the supposed TRNG output back. If the TRNG is nothing but a couple of ring counters or high stability oscillators fed into a D-Type latch&#8230; Then it&#8217;s game over in it&#8217;s entirety.</p>
<p>My advice to people wanting to use a TRNG is &#8220;If you can not get at and test the actual noise source output, don&#8217;t waste your money&#8221;.</p>
<p>It&#8217;s not just that it might not be a noise source at all to make this a reguirment. It alowes you to continously &#8220;test the health&#8221; of the noise source. They are at the end of the day extreamly sensitive to interfereance or any failure within the unit such as a dry joint on a powersupply decoupling cap etc. And it&#8217;s not a stretch to say that a users wellbeing is critically reliant on the health of their TRNG, so they should require that they be able &#8220;to erl it&#8217;s pulse&#8221;.</p>
<p>[1] By this I mean from the point of an external observer. If the sampler is driven by a reasonable quality clock derived from an XTAL then it is predictable to the observer. However if the sampler is driven by an unstable or chaotic oscillator then it is  unpredictable to the observer. The reason for using an unpredictable oscillator is to try and hide the &#8220;Waggon Wheel Effect&#8221; you see in films and &#8220;stroboscopic timing&#8221;. One TRNG source favoured by chip makers is a &#8220;ring oscillator&#8221; in theory they &#8220;drift randomly&#8221; in practice they are very suceptable to &#8220;injection locking&#8221; from any signal of nearly the same frequency multiple or submultiple. The most well known &#8220;injection locked&#8221; oscillator used to be the NTSC or PAL &#8220;chroma oscillator&#8221; in the old analogue television signal.</p>
<p>[2] They could use TEMPEST techniques to passively listen for a signal such as the CPU clock the edges of which get phase modulated by the PSU noise. The same PSU noise that also gets into the TRNGs thermal noise source bias circuit and it&#8217;s amplifier prior to sampling.</p>
<p>[3] Although I&#8217;ve been waving a red flag about passive[2] and active EmSec attacks, especially the active &#8220;Fault Injection Attacks&#8221; for a very very long time &#8211;ie since the 1980s,&#8211; I&#8217;ve kind of been a lone voice in the wilderness. As far as the academic community was concerned there was no mileage in investigating it. Eventually a couple of grads at the UK Cambridge Computer Labs did their own experiment on a very high end commercial TRNG from IBM. By simply hitting it with an unmodulated RF signal they took the ouput entropy down from 2^32 down to less than 2^7&#8230; Which makes the search space for an attacker trivial.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306804">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306804">
						September 2, 2017 2:42 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<blockquote><p>Eventually a couple of grads at the UK Cambridge Computer Labs did their own experiment on a very high end commercial TRNG from IBM. By simply hitting it with an unmodulated RF signal they took the ouput entropy down from 2^32 down to less than 2^7</p></blockquote>
<p>I thought frequency injection attacks existed since a long time ago. I would also differentiate between fault injection attacks and frequency injection attacks, so perhaps my dates are off because of that&#8230;</p>
<p>Are you referencing this: <a href="https://www.cl.cam.ac.uk/~atm26/papers/markettos-ches2009-inject-trng.pdf" rel="nofollow ugc">paper</a> or its <a href="https://www.cl.cam.ac.uk/~atm26/papers/markettos-ches2009-inject-trng-slides.pdf" rel="nofollow ugc">slide deck presentation</a>? Although both are from Cambridge, I have a feeling you&#8217;re referencing older work. Would be nice to share a link.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306805">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306805">
						September 2, 2017 10:01 AM					</a>

				</p>

				<p>@ Wael,</p>
<blockquote><p>Are you referencing this: paper or its slide deck presentation? Although both are from Cambridge, I have a feeling you&#8217;re referencing older work.</p></blockquote>
<p>I&#8217;ve not seen that paper before, and from a quick scan it makes the point&#8217;s I&#8217;ve made here.</p>
<p>You are correct that I&#8217;m refrencing an earlier paper, i guess I&#8217;ll have to dig out the link. But I&#8217;m away from the cave this weekend as there is an SSB contest on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306806">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306806">
						September 2, 2017 10:13 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<blockquote><p>s I&#8217;ll have to dig out the link</p></blockquote>
<p>Wanted to see two things: the correlation between the incident RF frequency and the amount of entropy reduction, and the relationship between power and effectiveness. I also wanted to see how much advancement (at least publicly disclosed) in that field happened over the past 50 years or so.</p>
<p>There is more to say about RF frequency injection attacks, but perhaps this isn&#8217;t the right time&#8230;</p>
<blockquote><p>But I&#8217;m away from the cave this weekend as there is an SSB contest on.</p></blockquote>
<p>Upper sideband or lower? 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306807">

			<div class="comment by-rachel ">

				<p class="commentcredit">

					<span class="commenter">Rachel</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306807">
						September 2, 2017 10:19 AM					</a>

				</p>

				<p>Clive<br />
SSB contest &#8211; simplex side band radio?<br />
who can use skip/sun spot activity to broadcast the furthest?<br />
can&#8217;t wait for your response to 66535&#8217;s satellite query 😉   a teenager actually did that very thing to a nasa craft onced</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306808">

			<div class="comment by-ab-praeceptis ">

				<p class="commentcredit">

					<span class="commenter">ab praeceptis</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306808">
						September 2, 2017 10:32 AM					</a>

				</p>

				<p>Clive Robinson</p>
<p>Well and entertainingly put.</p>
<p>I&#8217;m sometimes under the impression that many problems stem from an unholy marriage between a darwinian/techno-religious world view, way too much trust in big names, and some carelessness thrown in.</p>
<p>For a start, we should always keep in mind what &#8220;random&#8221; is. The very definition of random (or hazard &#8211; but not coincidence) says it pretty clearly: random is what we can&#8217;t predict. Of course, science has worked on something more detailed and qualified, but in the end the basic definition is true and sufficient enough for general consideration.</p>
<p>Weather has been a classical example; one couldn&#8217;t predict it &#8211; but with an interesting twist: One <em>could</em> predict it over a <em>long</em> period (&gt;= 1 year) but only vaguely; One could also predict it over very short terms, say milliseconds but not for the very periods of the highest interest in between. The reason I like the weather example, however, is that it very nicely demonstrates the core of the issue: random is some kind of output of a mechanism of sufficiently high complexity so as to be unpredictable. As soon as we understand the mechanisms behind it, which we nowadays do to a degree wrt weather, the randomness vanishes (or considerably decreases).</p>
<p>What is the ultimate driver? Today we have reason to think that it&#8217;s the realm of quanta.</p>
<p>That&#8217;s one reason why I like what you elaborated. In a way you describe the underlaying problem in a practical and good way. We might assume that the source is &#8220;perfect random&#8221; (a wrong assumption but good enough for our purpose) but not at all optimal (understanding) and fumbling on the way to a product one can solder to a board brutally taints and often even subverts the whole thing and one ends up with something that isn&#8217;t &#8220;true random&#8221; at all.</p>
<p>While one might call this somewhat complicated or on the edge of philosophy and physics, the second element of the unholy marriage is almost obscenely simple. Chip and electronics manufacturers want to make money; <em>that</em> is their primary purpose and goal and the decisive factor for them is <em>not</em> whether their product is good but whether customers believe so (which usually is cheaper to achieve through marketing/PR, etc. than through technical facts).</p>
<p>There is some kind of unloved stepson of that marriage, too, namely the belief that a) a brand name indicates some kind of quality, and b) and worse, that knowledge and understanding can be bought in the form of chips or devices. While that might be the case sometimes, very often it is not. The well designed TRNG Fred is building in his basement hobby workshop might quite well offer far better random properties than some chip or part thereof.</p>
<p>And, of course, there is still the basic problem when dealing with quanta due their very nature. Plus, btw., the question whether quanta are the &#8220;final&#8221; source or whether they again are just a part of a mechanism that is delicate and complex enough to be considered (i.a.) a perfect random source (similar to a thousand years ago and the then most up to date understanding of the building blocks of matter which today we know and understand (oh well, to a degree)).</p>
<p>Another part of what you wrote which I liked was what I like to jokingly call (in a rothschild allusion) &#8220;let me set the voltage levels that define which analog signal your circuitry takes as 1 and which as 0 and I care not who your CEO is&#8221; *g<br />
But granted, many can&#8217;t know better with many books and teachers telling them that digital is &#8220;the other&#8221; electronics. Nevertheless we would be well advised to keep in mind that DE is but one part of analog electronics and a small one at that.</p>
<p>As for &#8220;spreading TRNG by crypto devices&#8221; I&#8217;m somewhat more tolerant than you. True, aes (symmetric!) is a questionable choice but (and the topic paper is about that, not aes) good crypto hash algos aren&#8217;t that bad due to irreversibily. Actually I think that hash algos generally get somewhat of a stepson treatment and are often undervalued (and badly or misunderstood). The problem I see (in agreement with you) anyway however is that the best hash algo will produce biased not-random if fed with poor quality &#8220;trng&#8221; as you described.<br />
One of the points some seem to get wrong is that &#8220;hash algo xyz produces pseudo random output&#8221; does <strong>not</strong> mean &#8220;throw in whatever and you&#8217;ll get good random&#8221;. It rather means that the (deterministic!) algorithm per se doesn&#8217;t introduce bias. Of course one could (and probably should) look closer at that for cases were really high quality pseudo random is needed. After all, &#8220;random&#8221; is a gem with many facets and the ruler along which hash algos&#8217; unbiasedness is measured is a simpler one than the one used for random algorithms.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306809">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306809">
						September 3, 2017 1:54 AM					</a>

				</p>

				<p>@ Wael,</p>
<blockquote><p>Upper sideband or lower?</p></blockquote>
<p>Depends on how high you go 0:)</p>
<p>@ Rachel,</p>
<blockquote><p>SSB contest &#8211; simplex side band radio?<br />
who can use skip/sun spot activity to broadcast the furthest? </p></blockquote>
<p>Yes you bounce HF &#8220;sky wave&#8221; signals off of the various layers of the ionosphere for long distance / DX contacts and use the &#8220;ground wave&#8221; to get local contacts. The various layers exist all the time, however as with the &#8220;northern lights&#8221; solar disturbances make things &#8220;interesting&#8221; however if we get a direct strike from a &#8220;solar ejector&#8221; it will quite litterly be the &#8220;worlds biggest EMP attack&#8221; and things will be quite a bit more disturbing than just &#8220;interesting&#8221;. And rather like big meteor impacts, Super Vulcanoes and major &#8220;ring of fire&#8221; earthquakes we are currently &#8220;long over due&#8221; for one. Whilst it would not be a &#8220;Mass Extinction&#8221; event for &#8220;organics&#8221; it might well be so for power grids and microchips semiconductors etc&#8230; Which begs the question of what we will do with all those effectively redundent &#8220;code cutters&#8221;, will there be enough ditches to be dug to keep them occupied 😉</p>
<p>As for SSB techhnically it&#8217;s &#8220;Single Side Band&#8221; to imagine it think of the frequency spectrum of an Amplitude modulated signal, it has two sidebands and a carrier. This is wasteful of both bandwidth and power, so you first remove the carrier so you get Double Side Band Suppressed Carrier (DSBSC), then you remove one or other of the side bands to give you SSB, hence &#8220;Upper Side Band&#8221; (USB) and &#8220;Lower Side Band&#8221; (LSB) @Wael was asking about (the conventon is LSB below 10MHz USB above, and as Wael appears to know is considered a bit contentious these days <a href="https://www.eham.net/articles/5913" rel="nofollow ugc">https://www.eham.net/articles/5913</a> ).</p>
<p>However having taken things out os AM to get SSB you have to add them back in, in the receive for most receivers. So to do it you inject a carrier back in with what is often called a Beat Frequency Oscillator (BFO) at the last &#8220;Intermediate Frequency&#8221; (IF) mixer and detect the result, in the usual way with a diode detector or better.</p>
<p>One side effect of this is you get &#8220;pitch shift&#8221; on the recovered audio if you are not correctly tuned in, so people can sound like they are breathing helium. As at one point somebody thought that sounded &#8220;groovy&#8221; the transmit and receive process became used as an audio &#8220;special effect&#8221;. It also was used in some early commercial &#8220;audio encryption&#8221; products as well for &#8220;band shifting encryption&#8221;. These were however not very secure because with languages like English the information content is in the signal envelope not it&#8217;s frequency/pitch. So what you would do is detect the audio signal envelope and use it to modulate another sound source. This technique also ended up in the music industry tool box as a VOCODA which most people will have heard clearly at the end of ELO&#8217;s &#8220;Mr Blue Sky&#8221; which was the last track of the LP A side which is why it says &#8220;Now Please Turn Me Over&#8221;.</p>
<p>These audio encryption techniques poor as they were carried on into early Video Encryption used by both cable companies and later satellite broadcasters. And it was these TV transponders in Satellites that used to be the easiest to hide a Direct Sequence Spread Spectrum Signal (DSSS) in.</p>
<p>Coincidentally you make a DSSS transmitter in almost exactly the same way you do an SSB transmitter. Though instead of just removing the carrier and upshifting the frequency using a Double Balenced Mixer as you do for SSB you modulate the upshift carrier frequency with the &#8220;chip code&#8221; usually by &#8220;phase reverse keying&#8221; in simple DSSS systems&#8230;</p>
<p>So now you see the &#8220;interconnectedness&#8221; of the apparently unrelated parts of your posted questions B-)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306810">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306810">
						September 3, 2017 2:02 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<blockquote><p>Depends on how high you go 0:)</p></blockquote>
<p>These days are over after the recent loss of my itchy foot apparel 😉 I need to find a new pair.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306811">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306811">
						September 3, 2017 2:23 AM					</a>

				</p>

				<p>@ Wael,</p>
<blockquote><p>I need to find a new pair.</p></blockquote>
<p>Well you could ask his brother &#8220;reefer sailor monkey footed primate&#8221; for assistance. After all rolling those hugh bags up whilst high up hanging on with your feet for dear life does give you a different perspective on life.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-306812">

			<div class="comment by-jim-lippard ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://lippard.blogspot.com/' rel='external nofollow ugc' class='url'>Jim Lippard</a></span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306812">
						September 7, 2017 2:56 PM					</a>

				</p>

				<p>@ COYNE TIBBETS:</p>
<p>Yes, it&#8217;s possible to prove a negative: <a href="https://departments.bloomu.edu/philosophy/pages/content/hales/articles/proveanegative.html" rel="nofollow ugc">https://departments.bloomu.edu/philosophy/pages/content/hales/articles/proveanegative.html</a></p>
<p>And there is a way to address the &#8220;Trusting Trust&#8221; problem:<br />
<a href="https://www.dwheeler.com/trusting-trust/" rel="nofollow ugc">https://www.dwheeler.com/trusting-trust/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-306813">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/#comment-306813">
						September 7, 2017 7:15 PM					</a>

				</p>

				<p>@ Jim Lippard,</p>
<blockquote><p>Yes, it&#8217;s possible to prove a negative:</p></blockquote>
<p>Oh dear Prof Steven D. Hales needs to adjust his thinking.</p>
<p>He has fallen for the trap of bivalent thinking, that is something is true or it is false. The real world does not work that way as it is in most cases multivalent.</p>
<p>The reason mathmaticians use the bivalent logic of Boole and his Victorian colleagues is because it&#8217;s a very handy tool because under bivalent systems it can only be True or False, thus if you prove one the other must be false, there are &#8220;no unknowns&#8221; to cause problems.</p>
<p>Life is by and large multivalent,<br />
especialy when time is considered. For instance take his argument about Unicorns and the fossil record. It&#8217;s easy to see why it is a strawman argument.</p>
<p>Firstly prior to the first fossil bones being found / recognised man kind was unaware of them. That is they existed but we did not know about them. Therefore according to the Profs argument dinosaurs &#8220;did not exist&#8221; because of his bivalent argument. We are now aware of &#8220;some but not all&#8221; dinosaur bones that is we can demonstrate the fossil record is &#8220;incompleate&#8221; by simple induction. Thus his argument fails again because we know that there are at least three states ie,</p>
<p>1, Known to exist and found.<br />
2, Known to exist but not found.<br />
3, Unknown.</p>
<p>Point three is important, every year we discover new species for which we have no reason to know they exist, thus they are not covered by points 1&amp;2.</p>
<p>Thus at best the Prof has created a &#8220;Strawman argument&#8221; based around a restricted version of &#8220;logic&#8221; or he genuinely does not understand that multivalent systems exist that can not be reduced to bivalent systems&#8230;</p>
<p>There is an old saw/truism that in the real world only three numbers make sense &#8220;zero, one and tends to infinity&#8221;. That is something does not exist, something is unique or there are an unknown multitude of equivalent things.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2017/08/proof_that_hmac.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2017/08/proof_that_hmac.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F08%2Fproof_that_hmac.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2017/08/proof_that_hmac.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='11289' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2017/08/the_nsas_2014_m.html" rel="prev">← The NSA&#039;s 2014 Media Engagement and Outreach Plan</a>		<a href="https://www.schneier.com/blog/archives/2017/08/a_framework_for.html" rel="next">A Framework for Cyber Security Insurance →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
