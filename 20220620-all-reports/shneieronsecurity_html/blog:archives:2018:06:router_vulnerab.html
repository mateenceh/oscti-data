<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Router Vulnerability and the VPNFilter Botnet - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Router Vulnerability and the VPNFilter Botnet Comments Feed" href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/11601" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=11601' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2018%2F06%2Frouter_vulnerab.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2018%2F06%2Frouter_vulnerab.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-11601 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-11601" class="post-11601 post type-post status-publish format-standard hentry category-uncategorized tag-botnets tag-essays tag-fbi tag-internet tag-malware tag-national-security-policy tag-network-security tag-russia">

	<div class="article">

		<h2 class="entry">Router Vulnerability and the VPNFilter Botnet</h2>
		<p>On May 25, the FBI asked us all to reboot our routers. The story behind this request is one of sophisticated malware and unsophisticated home-network security, and it&#8217;s a harbinger of the sorts of pervasive threats ­ from nation-states, criminals and hackers ­ that we should expect in coming years.</p>
<p>VPNFilter is a <a href="https://arstechnica.com/information-technology/2018/05/hackers-infect-500000-consumer-routers-all-over-the-world-with-malware/">sophisticated</a> <a href="https://www.wired.com/story/vpnfilter-router-malware-outbreak/">piece</a> of malware that infects mostly older home and small-office routers made by Linksys, MikroTik, Netgear, QNAP and TP-Link. (For a list of specific models, click <a href="https://www.symantec.com/s/threat-intelligence/vpnfilter-iot-malware">here</a>.) It&#8217;s an impressive piece of work. It can eavesdrop on traffic passing through the router ­ specifically, log-in credentials and SCADA traffic, which is a networking protocol that controls power plants, chemical plants and industrial systems ­ attack other targets on the Internet and destructively &#8220;kill&#8221; its infected device. It is one of a very few pieces of malware that can survive a reboot, even though that&#8217;s what the FBI has requested. It has a number of other capabilities, and it can be remotely updated to provide still others. More than 500,000 routers in at least 54 countries have been infected since 2016.</p>
<p>Because of the malware&#8217;s sophistication, VPNFilter is believed to be the work of a government. The FBI suggested the Russian government was involved for two circumstantial reasons. One, a piece of the code is identical to one found in another piece of malware, called <a href="https://usa.kaspersky.com/resource-center/threats/blackenergy">BlackEnergy</a>, that was used in the December 2015 attack against Ukraine&#8217;s power grid. Russia is believed to be behind that attack. And two, the majority of those 500,000 infections are in Ukraine and controlled by a separate command-and-control server. There might also be classified evidence, as an <a href="http://www.kingpin.cc/wp-content/uploads/2018/05/pawd-2.18-mj-00665-1.pdf">FBI affidavit</a> in this matter <a href="https://www.justice.gov/opa/pr/justice-department-announces-actions-disrupt-advanced-persistent-threat-28-botnet-infected">identifies</a> the group behind VPNFilter as Sofacy, also known as APT28 and Fancy Bear. That&#8217;s the group behind a long list of attacks, including the 2016 hack of the Democratic National Committee.</p>
<p>Two companies, <a href="https://.talosintelligence.com/2018/05/VPNFilter.html">Cisco</a> and Symantec, seem to have been working with the FBI during the past two years to track this malware as it infected ever more routers. The infection mechanism isn&#8217;t known, but we believe it targets known vulnerabilities in these older routers. Pretty much no one patches their routers, so the vulnerabilities have remained, even if they were fixed in new models from the same manufacturers.</p>
<p>On May 30, the FBI <a href="https://amp.thedailybeast.com/exclusive-fbi-seizes-control-of-russian-botnet">seized control</a> of toknowall.com, a critical VPNFilter command-and-control server. This is called &#8220;sinkholing,&#8221; and serves to disrupt a critical part of this system. When infected routers contact toknowall.com, they will no longer be contacting a server owned by the malware&#8217;s creators; instead, they&#8217;ll be contacting a server owned by the FBI. This doesn&#8217;t entirely neutralize the malware, though. It will stay on the infected routers through reboot, and the underlying vulnerabilities remain, making the routers susceptible to reinfection with a variant controlled by a different server.</p>
<p>If you want to make sure your router is no longer infected, you need to do more than reboot it, the FBI&#8217;s warning notwithstanding. You need to reset the router to its factory settings. That means you need to reconfigure it for your network, which can be a pain if you&#8217;re not sophisticated in these matters. If you want to make sure your router cannot be reinfected, you need to <a href="https://krebsonsecurity.com/2018/05/fbi-kindly-reboot-your-router-now-please/#more-44020">update the firmware</a> with any security patches from the manufacturer. This is harder to do and may strain your technical capabilities, though it&#8217;s ridiculous that routers don&#8217;t automatically download and install firmware updates on their own. Some of these models probably do not even have security patches available. Honestly, the best thing to do if you have one of the vulnerable models is to throw it away and get a new one. (Your ISP will probably send you a new one free if you claim that it&#8217;s not working properly. And you <i>should </i>have a new one, because if your current one is on the list, it&#8217;s at least 10 years old.)</p>
<p>So if it won&#8217;t clear out the malware, why is the FBI <a href="https://www.nytimes.com/2018/05/27/technology/router-fbi-reboot-malware.html">asking</a> <a href="https://www.ic3.gov/media/2018/180525.aspx">us</a> to reboot our routers? It&#8217;s mostly just to get a sense of how bad the problem is. The FBI now controls toknowall.com. When an infected router gets rebooted, it connects to that server to get fully reinfected, and when it does, the FBI will know. Rebooting will give it a better idea of how many devices out there are infected.</p>
<p><a href="https://www.cnet.com/how-to/the-fbi-says-you-should-reboot-your-router-should-you-explainer/">Should you do it</a>? It can&#8217;t hurt.</p>
<p>Internet of Things malware isn&#8217;t new. The 2016 Mirai botnet, for example, created by a lone hacker and not a government, targeted vulnerabilities in Internet-connected digital video recorders and webcams. Other malware has targeted Internet-connected thermostats. Lots of malware targets home routers. These devices are particularly vulnerable because they are often designed by ad hoc teams without a lot of security expertise, stay around in networks far longer than our computers and phones, and have no easy way to patch them.</p>
<p>It wouldn&#8217;t be surprising if the Russians targeted routers to build a network of infected computers for follow-on cyber operations. I&#8217;m sure many governments are doing the same. As long as we allow these insecure devices on the Internet ­ and short of security regulations, there&#8217;s no way to stop them ­ we&#8217;re going to be vulnerable to this kind of malware.</p>
<p>And next time, the command-and-control server won&#8217;t be so easy to disrupt.</p>
<p>This essay <a href="https://www.washingtonpost.com/news/posteverything/wp/2018/06/06/why-the-fbi-wants-you-to-reboot-your-router-and-why-that-wont-be-enough-next-time/">previously appeared</a> in the <i>Washington Post</i></p>
<p>EDITED TO ADD: The malware is <a href="https://arstechnica.com/information-technology/2018/06/vpnfilter-malware-infecting-50000-devices-is-worse-than-we-thought/">more capable</a> than we previously thought.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/botnets/" rel="tag">botnets</a>, <a href="https://www.schneier.com/tag/essays/" rel="tag">essays</a>, <a href="https://www.schneier.com/tag/fbi/" rel="tag">FBI</a>, <a href="https://www.schneier.com/tag/internet/" rel="tag">Internet</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/national-security-policy/" rel="tag">national security policy</a>, <a href="https://www.schneier.com/tag/network-security/" rel="tag">network security</a>, <a href="https://www.schneier.com/tag/russia/" rel="tag">Russia</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html" rel="bookmark">Posted on June 11, 2018 at 6:19 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html#comments">39 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html" data-title="Router Vulnerability and the VPNFilter Botnet" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-321849">

			<div class="comment by-tyson ">

				<p class="commentcredit">

					<span class="commenter">tyson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321849">
						June 11, 2018 7:10 AM					</a>

				</p>

				<p>For people that have a vulnerable model, perhaps loading 3rd party code such as OpenWrt/LEDE would be a better option, rather than throwing it out and filling up our landfills and oceans with yet more plastic..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321850">

			<div class="comment by-vesselin-bontchev ">

				<p class="commentcredit">

					<span class="commenter">Vesselin Bontchev</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321850">
						June 11, 2018 7:50 AM					</a>

				</p>

				<blockquote><p>One, a piece of the code is identical to one found in another piece of malware, called BlackEnergy,</p></blockquote>
<p>No, Bruce, it&#8217;s not &#8220;identical&#8221;. The similarly with BlackEnergy is that both have implementations of the RC4 cipher that are faulty in one and the same way. And while this, by itself, is suspicious, this flaw has been known since 2009 and just about anyone could have included it on purpose.</p>
<p>Of course, I&#8217;m not privy to any classified information regarding this issue, but the above, plus the fact that many of the compromised servers are in Ukraine seems pretty slim to me as attribution evidence. Maybe it was indeed Russia whodunit, but it&#8217;s not the publicly available evidence that shows it.</p>
<blockquote><p>This doesn&#8217;t entirely neutralize the malware, though. It will stay on the infected routers through reboot, and the underlying vulnerabilities remain, making the routers susceptible to reinfection with a variant controlled by a different server.</p></blockquote>
<p>&#8220;It&#8221; is a bit misleading here. The malware is modular and highly complex. The reboot <b>will</b> remove a part of the malware which is capable of bricking the device &#8211; which is why it is a very good idea to do it. It will <b>not</b> remove the part of the malware that talks to the C&amp;C server.</p>
<blockquote><p>If you want to make sure your router cannot be reinfected, you need to update the firmware with any security patches from the manufacturer.</p></blockquote>
<p>You can&#8217;t know that. Nobody knows how exactly the routers are infected. The malware found on them does not contain an infection module. Maybe it&#8217;s via some exploit &#8211; but we don&#8217;t know which one and we don&#8217;t know if the latest firmware version is free from the corresponding vulnerability.</p>
<blockquote><p>And you should have a new one, because if your current one is on the list, it&#8217;s at least 10 years old.</p></blockquote>
<p>That&#8217;s not always a good idea. Newer devices tend to be &#8220;smarter&#8221; &#8211; which means &#8220;more vulnerable&#8221; (google &#8220;Hypponen&#8217;s Law&#8221;). One of the routers I have is on the list of vulnerable brands &#8211; but it&#8217;s not a vulnerable <em>model</em>, because it&#8217;s too old. If I update the firmware of another one, the new version will disable a critical capability, which capability I need for proper implementation of our VPN.</p>
<blockquote><p>So if it won&#8217;t clear out the malware, why is the FBI asking us to reboot our routers? It&#8217;s mostly just to get a sense of how bad the problem is.</p></blockquote>
<p>Also in order to disable the self-destructing capability, as explained above.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321851">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321851">
						June 11, 2018 8:40 AM					</a>

				</p>

				<p>@schneier<br />
though it&#8217;s ridiculous that routers don&#8217;t automatically download and install firmware updates on their own</p>
<p>Be careful on what you ask! they might do it, and your router one year later might say &#8220;i&#8217;m not anymore supported so i&#8217;m going to brick myself, if you want to go in internet buy a new one&#8221;.<br />
i DON&#8217;T want that my router or any other thing update automatically.</p>
<p>also: they will do some dumb mistake so that people can abuse the auto update feature and push malware using the update process (see for example &#8220;evilgrade&#8221;, a software designed to do exactly that)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321852">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321852">
						June 11, 2018 8:50 AM					</a>

				</p>

				<p>there is also a problem with updates:<br />
-i have found a vulnerability in a router:ssh was enabled on ipv6 with admin,admin credential. while in the web config you could disable ssh, webpage disabled ssh only over ipv4.</p>
<p>-company fixed it in less than a month after my report (read very quickly)</p>
<p>-company gave me new firmware over http, without any kind of digital signature</p>
<p>-company never published the firmware on the website so i&#8217;m the only one who have this&#8230;.<br />
and it is not the first time since i had 1.02 (the most up to date according to the website) but after my report they gave me 1.06&#8230;</p>
<p>what should i do?<br />
-nothing?<br />
-public shaming?<br />
-publish the firmware myself?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321853">

			<div class="comment by-esteban ">

				<p class="commentcredit">

					<span class="commenter">esteban</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321853">
						June 11, 2018 9:55 AM					</a>

				</p>

				<p>@tyson</p>
<p>OpenWRT/LEDE do seem better about updates, in that they don&#8217;t stop releasing them so quickly. They&#8217;re not great: one still needs to download and flash an entire updated image, then reboot. I&#8217;d much prefer something like &#8216;apt&#8217; where it can automatically upgrade and restart individual services.</p>
<p>I&#8217;m concerned about the process of upgrading a potentially infected router. They only hardware-based way to do it is (almost always) JTAG. The web/ssh based upgraders and TFTP fallbacks are implemented in software that could have been compromised to backdoor each new image.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321854">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321854">
						June 11, 2018 10:17 AM					</a>

				</p>

				<p>Unfortunately, even the security-conscious can&#8217;t protect themselves.  I have the RT-N56U and have been waiting for a patch but the last one was on 2017/03/31:  <a href="https://www.asus.com/us/Networking/RTN56U/HelpDesk_BIOS/" rel="nofollow ugc">https://www.asus.com/us/Networking/RTN56U/HelpDesk_BIOS/</a></p>
<p>The product is otherwise working great, the industry seems to have a policy of ending support to force you to buy new products.</p>
<p>I guess I&#8217;ll have to install 3rd-party firmware and hope that addresses the vulnerabilities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321855">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321855">
						June 11, 2018 10:47 AM					</a>

				</p>

				<p>@ Bruce,</p>
<blockquote><p>Pretty much no one patches their routers, so the vulnerabilities have remained, even if they were fixed in new models from the same manufacturers.</p></blockquote>
<p>This is a problem that is difficult to fix. A lot of people do not have access to their outward facing router because their service providers do not want them to have access. This includes major ISPs that have outsourced the script reading support staff that frequently go through meaningless rituals with users just to run up support costs billable.</p>
<p>This however is of intetest,</p>
<blockquote><p>On May 30, the FBI seized control of toknowall.com, a critical VPNFilter command-and-control server. This is called &#8220;sinkholing,&#8221; and serves to disrupt a critical part of this system.</p></blockquote>
<p>I&#8217;m supprised this works&#8230; Some experts will tell you how the &#8220;bad guys&#8221; can get around this with relative easy (I&#8217;ve even described how in the past). It is known that certain State Level APT attackers already do this, including those of better provinance as being Russian&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321856">

			<div class="comment by-anondutch ">

				<p class="commentcredit">

					<span class="commenter">AnonDutch</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321856">
						June 11, 2018 12:22 PM					</a>

				</p>

				<p>Is it just me that feels like getting rid of my computer, cable box, smartphone and everything else that&#8217;s connected, after reading yet another story like this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321857">

			<div class="comment by-k-s ">

				<p class="commentcredit">

					<span class="commenter">K.S.</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321857">
						June 11, 2018 12:54 PM					</a>

				</p>

				<p>@me</p>
<p>Publish CVE.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321858">

			<div class="comment by-bauke-jan-douma ">

				<p class="commentcredit">

					<span class="commenter">Bauke Jan Douma</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321858">
						June 11, 2018 1:29 PM					</a>

				</p>

				<p>&#8220;<i>So if it won&#8217;t clear out the malware, why is the FBI asking us to reboot our routers? It&#8217;s mostly just to get a sense of how bad the problem is. The FBI now controls toknowall.com. When an infected router gets rebooted, it connects to that server to get fully reinfected, and when it does, the FBI will know. Rebooting will give it a better idea of how many devices out there are infected.</i>&#8221;</p>
<p>Is this Bruce, or a well-meaning spokesperson for the glorious FBI?<br />
Just wondering.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321859">

			<div class="comment by-richard-schwartz ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.poweroftheschwartz.com' rel='external nofollow ugc' class='url'>Richard Schwartz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321859">
						June 11, 2018 1:37 PM					</a>

				</p>

				<p>Re: &#8220;if your current one is on the list, it&#8217;s at least 10 years old&#8221;.  This is not true. Maybe 5, but not 10. The initial list was mostly older models, but the current list of infected models includes a fair number of models that should not in any way be considered obsolete and ready to be thrown away, and are definitely beyond a trivial expense for many people.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321860">

			<div class="comment by-justinacolmena ">

				<p class="commentcredit">

					<span class="commenter">justinacolmena</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321860">
						June 11, 2018 1:41 PM					</a>

				</p>

				<blockquote><p>When infected routers contact toknowall.com, they will no longer be contacting a server owned by the malware&#8217;s creators; instead, they&#8217;ll be contacting a server owned by the FBI.</p></blockquote>
<p>Oh. Much better. That&#8217;s what we all wanted to begin with, isn&#8217;t it? I understand Russia and North Korea are allies now that Trump is in office, but yes, now it is becoming quite obvious that the FBI and FSB are on much better terms and working much more closely with each other than they have heretofore let on for the public.</p>
<p>Be that as it may, with Snowden&#8217;s sudden (apparently prearranged) stranding and subsequent asylum in Russia, we do need to focus on preserving fundamental civil rights within the U.S. under the U.S. Constitution, which does enumerate a fundamental right, rather than a privilege, to bear arms. Or even elsewhere, what about the rights of the armed &#8220;little green men&#8221; in Ukraine who lack the official recognition of their Russsian fatherland?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321861">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">Tatütata</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321861">
						June 11, 2018 2:30 PM					</a>

				</p>

				<p>If I count correctly, there are eleven different brands of routers affected.</p>
<p>Did the malware use the same vulnerability in all of them? Then they&#8217;re either using all the same buggy code, and/or routers have degenerated into a kind of white goods business, where private labels are slapped on fairly generic designs with only a couple of bells and whistles for differentiation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321862">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">Tatütata</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321862">
						June 11, 2018 2:35 PM					</a>

				</p>

				<p>But if the G-men control the C&amp;C server, doesn&#8217;t that technically allow them to inject their own cr*p on the affected devices?</p>
<p>Foreign devices are fair game for all descriptions of US-TLAs, but is there a doctrine allowing them to do that to US residents and/or citizens?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321863">

			<div class="comment by-zaphod ">

				<p class="commentcredit">

					<span class="commenter">Zaphod</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321863">
						June 11, 2018 2:41 PM					</a>

				</p>

				<p>Perhaps the learned folk here (we know who you all are) could let us know what hardware/software they use as their ‘home router’?</p>
<p>Whilst not in the above cohort, here I go; I removed the ISP router and use a Buffalo 600 with the most up to date DD-WRT image.</p>
<p>Zaphod</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321865">

			<div class="comment by-ratio ">

				<p class="commentcredit">

					<span class="commenter">Ratio</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321865">
						June 11, 2018 3:00 PM					</a>

				</p>

				<p>@Tatütata,</p>
<blockquote><p>Did the malware use the same vulnerability in all of [the affected brands]?</p></blockquote>
<p>Sounds like it:</p>
<blockquote><p>There’s little doubt that whoever developed VPNFilter is an advanced group. Stage 1 infects <b>devices running Busybox- and Linux-based firmware and is compiled for several CPU architectures</b>. The primary purpose is to locate an attacker-controlled server on the Internet to receive a more fully featured second stage. Stage 1 locates the server by downloading an image from Photobucket.com and extracting an IP address from six integer values used for GPS latitude and longitude stored in the EXIF field. In the event the Photobucket download fails, stage 1 will try to download the image from toknowall[.]com.</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321866">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321866">
						June 11, 2018 4:16 PM					</a>

				</p>

				<p>@ justinacolmena,</p>
<blockquote><p>I understand Russia and North Korea are allies now that Trump is in office</p></blockquote>
<p>Either you have not said what you mean, or you have not studied history.</p>
<p>The North Korean&#8217;s have been allies of both Russia and China since before the end of WWII. In fact China would almost certainly not be a &#8220;Communist&#8221; state if it had not been for what is now North Korea sending thousands of train loads of food weapons and battle hardened troops to support them.</p>
<p>The Korean war actually started as  a push by Stalin against the US that were compleatly and uterly unprepared for what was to follow. The US might have had a chance if US politicos had alowed the commander in the field the nukes he demanded, but they did not. Even though the US killed atleast a third of what became North Korean citizens, the US was guarenteed to lose. As the Chinese leader at the time pointed out the standing Chinese army in 1950 actually outnumbered the number of US citizens. The US did not have the manpower or determination to win.</p>
<p>It&#8217;s a humiliation the US War Hawks have never been able to get over and in part it was responsable for the automated idiocy a decade or so later that gave rise to another humiliation the US it&#8217;s self and it&#8217;s citizens still can not come to terms with and that was the Vietnam war.</p>
<p>One of the few things both Russia and China agree on is that the North Korean problem the US Government has is very much of their own making.</p>
<p>It&#8217;s something that even US historians point out with little prompting. If left alone the North and South of Korea would have had some level of reunification two or more decades ago. Now what you might or might not agree on is what the result might or might not have been. But one thing is clear the North has man power and raw resources, the south the technology and importantly the scientific ability. If even only partial reunification happens the new Korea will be an economic power house that frightens not just the US, Japan and Taiwan but even Germany and Russia. China likewise is trying along with Russia to get some kind of benificial position with North Korea and even South Korea for their own economic protection.</p>
<p>It will be interesting to see what happens. Especially if as some economists believe that President Trumps tarrifs are just a gambit to get rid of tarrfis entirely.</p>
<p>If you are implying as many Western Newspapers are saying that Trump is cosying up to NK, personally I would say it&#8217;s been the first time in seventy years that the US has behaved as a &#8220;Rational Actor&#8221; towards Noeth Korea. The real question needs to be is why are the NK&#8217;s responding?</p>
<p>After all under the &#8220;Fool me once&#8230;&#8221; doctrine the NKs ought to be extreanly wary of anything the US Gov says, because past history shows the US will just reverse or rescind any agreement within six months&#8230;</p>
<p>Think on it if you like like Iran, the US set a series of conditions that they thought the Iranians would never agree to. Guess what Iran agreed and acted upon it, this was not the US game plan so instead the US State Dept and Gongress has thrown a hissy fit, and shown themselves up for what they realy are on the International Stage with the spot lights full on&#8230; Opps they&#8217;ve had their bluff called, and they have norhing to raise with&#8230;</p>
<p>As the ancient Chinese Curse has it for the US &#8220;May you live in interesting times&#8230;&#8221;</p>
<p>I would expect a whole lot more of this to follow&#8230; But as has been noted by others if either of the two original nominees had made it to the White House in all probability US citizens who are in uniform would be heading on mass back to the middle east on one pretext or another to become more cannon fodder&#8230; It appears that even the Israeli Defence Force recognise that would not be a good idea&#8230;</p>
<p>So yes &#8220;Interesting times&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321867">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321867">
						June 11, 2018 4:33 PM					</a>

				</p>

				<p>@ Bruce,</p>
<blockquote><p>It wouldn&#8217;t be surprising if the Russians targeted routers to build a network of infected computers for follow-on cyber operations. I&#8217;m sure many governments are doing the same.</p></blockquote>
<p>You know it is OK to say that the US, UK, Auz, Canadian and NZ Signals Inteligence entities are &#8220;known to be doing this&#8221;. Likewise you can add the Dutch, Finnish, French, German, Swedish SigInt entities &#8220;are also known to be doing this&#8221; and a whole bunch of other countries including India, Singapore and the wider Atlantic-Eyes and Pacific Eyes are at it as well and that most of it&#8217;s results ends up at the NSA to be turned from raw to refined Intel.</p>
<p>Much as some IC people would like the information to not be in the public domain, it is and you can not put the genie back in the bottle.</p>
<p>Which should be an object lesson to those in the State Governments about &#8220;Privacy&#8221; and &#8220;Golden Frontdoors&#8221; and other NOBUS type stupidity. As used to be said and they should have been mindfull of,</p>
<ul><i><b>You reap what you sow</b></i></ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321868">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321868">
						June 11, 2018 4:49 PM					</a>

				</p>

				<p>@ Zaphod,</p>
<p>Nice to hear from you. With regards,</p>
<blockquote><p>Perhaps the learned folk here (we know who you all are) could let us know what hardware/software they use as their ‘home router’?</p></blockquote>
<p>As I&#8217;ve mentioned before my personal development etc machines I use are not protected by a router hardware or software. Because they are not connected in anyway to external networks.</p>
<p>As for other machines I&#8217;ve mentioned the data diodes I&#8217;ve designed, developed and constructed. Also that they are in effect &#8220;energy gapped&#8221; being inside safes inside a locked RF cage used at other times for high power RF design in the 5KW and up range.</p>
<p>I&#8217;ve even described how people might go about designing their own SCIF and using security end points that are &#8220;energy gapped&#8221; from any machines that are used as communications end points.</p>
<p>Complicated as it sounds the OpSec rules for such systems are way way less than for other designs. And at the end of the day as the old saying of &#8220;Lose lips sink ships&#8221; indicates, it&#8217;s frequently supposedly easier to use systems that have nearly unworkable OpSec Rules where info haemorrhages into the waiting ears of adversaries.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321869">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321869">
						June 11, 2018 10:08 PM					</a>

				</p>

				<p>This post is somewhat confusing and causes even more questions as certain posters have noted below. Can some of this questions be answered in a better way?</p>
<p>Cost problem of throwing away routers that are possibly not infected:</p>
<p>&#8216;Re: &#8220;if your current one is on the list, it&#8217;s at least 10 years old&#8221;. This is not true. Maybe 5, but not 10. The initial list was mostly older models, but the current list of infected models includes a fair number of models that should not in any way be considered obsolete and ready to be thrown away, and are definitely beyond a trivial expense for many people.”&#8217; -Richard Schwartz</p>
<p>I agree with Richard schwarts that taking a person’s asset or small business owner’s asset and tossing it in the rubbish heap is not very cost effective.<br />
The list of 70+ routers and network attached devices have asset value it seems like a waste of money to the average Jane/Joe to junk:</p>
<pre><code>Asus RT-AC66U (new)
Asus RT-N10 (new)
Asus RT-N10E (new)
Asus RT-N10U (new)
Asus RT-N56U (new)
Asus RT-N66U (new)

D-Link DES-1210-08P (new)
D-Link DIR-300 (new)
D-Link DIR-300A (new)
D-Link DSR-250N (new)
D-Link DSR-500N (new)
D-Link DSR-1000 (new)
D-Link DSR-1000N (new)

Huawei HG8245 (new)

Linksys E1200
Linksys E2500
Linksys E3000 (new)
Linksys E3200 (new)
Linksys E4200 (new)
Linksys RV082 (new)
Linksys WRVS4400N

MikroTik CCR1009 (new)
MikroTik CCR1016
MikroTik CCR1036
MikroTik CCR1072
MikroTik CRS109 (new)
MikroTik CRS112 (new)
MikroTik CRS125 (new)
MikroTik RB411 (new)
MikroTik RB450 (new)
MikroTik RB750 (new)
MikroTik RB911 (new)
MikroTik RB921 (new)
MikroTik RB941 (new)
MikroTik RB951 (new)
MikroTik RB952 (new)
MikroTik RB960 (new)
MikroTik RB962 (new)
MikroTik RB1100 (new)
MikroTik RB1200 (new)
MikroTik RB2011 (new)
MikroTik RB3011 (new)
MikroTik RB Groove (new)
MikroTik RB Omnitik (new)
MikroTik STX5 (new)
</code></pre>
<p>Netgear DG834 (new)<br />
    Netgear DGN1000 (new)<br />
    Netgear DGN2200<br />
    Netgear DGN3500 (new)<br />
    Netgear FVS318N (new)<br />
    Netgear MBRN3000 (new)<br />
    Netgear R6400<br />
    Netgear R7000<br />
    Netgear R8000<br />
    Netgear WNR1000<br />
    Netgear WNR2000<br />
    Netgear WNR2200 (new)<br />
    Netgear WNR4000 (new)<br />
    Netgear WNDR3700 (new)<br />
    Netgear WNDR4000 (new)<br />
    Netgear WNDR4300 (new)<br />
    Netgear WNDR4300-TN (new)<br />
    Netgear UTM50 (new)</p>
<pre><code>QNAP TS251
QNAP TS439 Pro
Other QNAP NAS devices running QTS software

TP-Link R600VPN
TP-Link TL-WR741ND (new)
TP-Link TL-WR841N (new)

Ubiquiti NSM2 (new)
Ubiquiti PBE M5 (new)

Upvel Devices -unknown models (new)

ZTE Devices ZXHN H108N (new)
</code></pre>
<p>This is just the list of devices not the total number of devices from Symantec that is liked in the article. The number of devices could be quite high and costly to junk.</p>
<p>Soft-reset or hard reset question.</p>
<p>The FBI recommends a soft reboot. Symantec then explains to remove the malware a hard reset is necessary:</p>
<p>“Q: If Stage 1 of VPNFilter persists even after a reboot, is there any way of removing it?</p>
<p>&#8220;A: Yes. Performing a hard reset of the device, which restores factory settings, should wipe it clean and remove Stage 1. “-Symantec</p>
<p>&#8220;So if it won&#8217;t clear out the malware, why is the FBI asking us to reboot our routers? It&#8217;s mostly just to get a sense of how bad the problem is. The FBI now controls toknowall.com. When an infected router gets rebooted, it connects to that server to get fully reinfected, and when it does, the FBI will know. Rebooting will give it a better idea of how many devices out there are infected.&#8221; …”Is this Bruce, or a well-meaning spokesperson for the glorious FBI?”- Bauke Jan Douma</p>
<p>Why not just do a hard reset and get rid of stage one of VPNFilter since the device will only become reinfected and the FBI will just at your device to a list?</p>
<p>[From Wikipedia]</p>
<p>“Mitigation, Both Cisco and Symantec suggest that people who own affected devices do a factory reset. That is typically accomplished by using a small, pointed object, such as a straightened out paperclip, to push the small reset button on the back on the unit for 10 to 30 seconds (time varies by model). This will remove the malware, but also restores the router to all original settings.”-Wikipedia</p>
<p><a href="https://en.wikipedia.org/wiki/VPNFilter#Mitigation" rel="nofollow ugc">https://en.wikipedia.org/wiki/VPNFilter#Mitigation</a></p>
<p>or</p>
<p><a href="https://en.wikipedia.org/wiki/VPNFilter" rel="nofollow ugc">https://en.wikipedia.org/wiki/VPNFilter</a></p>
<p>Why not do it right the first time around rather than become a test subject of the FBI? Or, worse get reinfected with “ssler” as Cisco and Symantec note:</p>
<p>“A newly discovered (disclosed on June 6) Stage 3 module known as “ssler” is capable of intercepting all traffic going through the device via port 80, meaning the attackers can snoop on web traffic and also tamper with it to perform man-in-the-middle (MitM) attacks. Among its features is the capability to change HTTPS requests to ordinary HTTP requests, meaning data that is meant to be encrypted is sent insecurely. This can be used to harvest credentials and other sensitive information from the victim’s network. The discovery of this module is significant since it provides the attackers with a means of moving beyond the router and on to the victim’s network…. fourth Stage 3 module known as “dstr” (disclosed on June 6) adds a kill command to any Stage 2 module which lacks this feature. If executed, dstr will remove all traces of VPNFilter before bricking the device.”- Symantec blog</p>
<p><a href="https://www.symantec.com/blogs/threat-intelligence/vpnfilter-iot-malware" rel="nofollow ugc">https://www.symantec.com/blogs/threat-intelligence/vpnfilter-iot-malware</a></p>
<p>Could the FBI control your router?</p>
<p>“…if the G-men [slang for FBI men] control the C&amp;C server, doesn&#8217;t that technically allow them to inject their own cr*p on the affected devices? Foreign devices are fair game for all descriptions of US-TLAs, but is there a doctrine allowing them to do that to US residents and/or citizens?”- Tatütata</p>
<p>Given the FBI&#8217;s tainted status with a lot of people why trust the FBI at all?<br />
Does the so called domain “ToKnowAll[Dot]com” sinkhole really work to stop the malware?</p>
<p>‘This however is of intetest, “On May 30, the FBI seized control of toknowall.com, a critical VPNFilter command-and-control server. This is called &#8220;sinkholing,&#8221; and serves to disrupt a critical part of this system.”… I&#8217;m supprised this works&#8230; Some experts will tell you how the &#8220;bad guys&#8221; can get around this with relative easy (I&#8217;ve even described how in the past). It is known that certain State Level APT attackers already do this, including those of better provinance as being Russian&#8230;”-Clive Robinson</p>
<p>Clive Robinson makes a reasonable point. Will not the malware C&amp;C server be moved to a different or multiple domains?</p>
<p>Clive Robinson notes the problem on front facing router interfaces which only ISPs control:</p>
<p>“… A lot of people do not have access to their outward facing router because their service providers do not want them to have access. This includes major ISPs that have outsourced the script reading support staff that frequently go through meaningless rituals with users just to run up support costs billable.”- Clive Robinson</p>
<p>How does the average Jane/Joe go about securing the ISP facing and controlled interfaces without losing all internet connectivity?</p>
<p>Actual infection method maybe Busybox:</p>
<p>‘Sounds like it: “…little doubt that whoever developed VPNFilter is an advanced group. Stage 1 infects devices running Busybox- and Linux-based firmware and is compiled for several CPU architectures. The primary purpose is to locate an attacker-controlled server on the Internet to receive a more fully featured second stage. Stage 1 locates the server by downloading an image from Photobucket.com and extracting an IP address from six integer values used for GPS latitude and longitude stored in the EXIF field. In the event the Photobucket download fails, stage 1 will try to download the image from toknowall[.]com.”’-Ratio</p>
<p>See halfway down arstechnia:</p>
<p><a href="https://arstechnica.com/information-technology/2018/05/hackers-infect-500000-consumer-routers-all-over-the-world-with-malware/" rel="nofollow ugc">https://arstechnica.com/information-technology/2018/05/hackers-infect-500000-consumer-routers-all-over-the-world-with-malware/</a></p>
<p>If Busybox is the infection method why not ID it and get to work fixing the Busybox problem?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321870">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321870">
						June 12, 2018 2:20 AM					</a>

				</p>

				<p>@K.S.<br />
How do i publish cve?<br />
information security is my hobby not job. i have found some vulns but i reported them to vendor (when it&#8217;s possible to contact them).<br />
does anyone has a link that tell me what i should do?<br />
Thanks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321871">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321871">
						June 12, 2018 4:14 AM					</a>

				</p>

				<p>@ esteban,</p>
<blockquote><p>The web/ssh based upgraders and TFTP fallbacks are implemented in software that could have been compromised to backdoor each new image.</p></blockquote>
<p>The usuall solution to this was signed code boot loaders, much loved by the &#8220;Walled Garden&#8221; fraternity, for their enrichment and supposadly your safety.</p>
<p>However as many have found the walled garden model is less effective than the &#8220;many eyes squash all bugs&#8221; FOSS ideal for stopping malware.</p>
<p>If you look back far enough on this blog you will find a conversation that started between @Nick P and myself about the fact that code signing was not secure. A number of others joined in some saying that it was the way forward. I listed reasons why it was not, and the usuall &#8220;Not Invented Here&#8221; / &#8220;Golden Goose&#8221; reasoning came back.</p>
<p>This was some time prior to stuxnet, that should have proved the point, but no apparently that was an exception for some reason&#8230; Since then all app stores have been hit by rougue code and every failing I listed has now been exploited by even the lowest form and least technical of attackers.</p>
<p>It&#8217;s just one of the many reasons I do not think &#8220;Auto-update&#8221; of code or even &#8220;manual download&#8221; are the sensible way to go, they are all way way to vulnerable.</p>
<p>However that raises the question of what to do about it, to which the answer is we don&#8217;t have a way&#8230;</p>
<p>That said the best method so far we have stoped using&#8230;</p>
<p>It was the mass produced CD/DVD on the front of magazines. Provided you purchased them from random places you were fairly safe as lots of people used to get their images that way and problems used to show up fairly quickly.</p>
<p>Now anyone upstream of you can intercept your packets and give you a fake download.</p>
<p>It&#8217;s a problem that realy requires us to solve the secure key distribution issue first and like Hard AI that&#8217;s been just round the corner for as long as our host @Bruce has been around.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321872">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321872">
						June 12, 2018 5:14 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<blockquote><p><i>It was the mass produced CD/DVD on the front of magazines. Provided you purchased them from random places you were fairly safe as lots of people used to get their images that way and problems used to show up fairly quickly.</i></p></blockquote>
<p>If we cannot trust on signed updates downloaded from external sources to our devices, either manually or automatically, how can we trust on the sources used to build these mass produced CDs and DVDs?  People producing CDs for dead-tree magazines have no better chances to dump on them the right sources and binaries.</p>
<p>There had been cases in the past of mass produced CDs containing malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321873">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321873">
						June 12, 2018 5:17 AM					</a>

				</p>

				<p>Buying magazines on random places may help avoiding targeted surveillance, but as we know, the intelligence community is more interested in global surveillance these days.  Less work, better results.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321874">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321874">
						June 12, 2018 6:56 AM					</a>

				</p>

				<p>@Who?<br />
His point was not &#8220;you can&#8217;t backdoor mass produced cd&#8221;<br />
his point was: &#8220;if you do so, someone will notice and there is no plausible deniability&#8221;</p>
<blockquote><p>
  the intelligence community is more interested in global surveillance these days<br />
  True</p>
<p>  Less work, better results.<br />
  I don&#8217;t think so
</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321875">

			<div class="comment by-k-s ">

				<p class="commentcredit">

					<span class="commenter">K.S.</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321875">
						June 12, 2018 10:26 AM					</a>

				</p>

				<p>@me</p>
<p>See: <a href="https://security.stackexchange.com/questions/121044/how-can-i-report-a-new-vulnerability-to-cve-mitre-org-such-that-they-assign-a-cv" rel="nofollow ugc">https://security.stackexchange.com/questions/121044/how-can-i-report-a-new-vulnerability-to-cve-mitre-org-such-that-they-assign-a-cv</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321876">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321876">
						June 12, 2018 3:00 PM					</a>

				</p>

				<p>@ Who?, me,</p>
<blockquote><p>There had been cases in the past of mass produced CDs containing malware.</p></blockquote>
<p>Yes they have, which is why the Mags that still have front cover DVDs tend to be somewhat paranoid in their testing. Way more so than most of us, and more importantly unlike most individuals they have considerable more and better resources than most of us. Including in some cases attracting help of the actuall developers to check every thing is as it should be.</p>
<p>As I said, nobody has come even close to a good way of doing software updates when you analyze it. That said however, of what there was and still is, on balance I think the Front Cover CD/DVD was thr best of the &#8220;working&#8221; bunch.</p>
<p>If you can think of ways to improve on it, now would be a good time to outline it. Because it&#8217;s becoming clearer to more and more people that what we have &#8220;is just not cutting the mustard&#8221;, and any suggestions good or bad may give others something to think about to implement or improve. As the old saying has it &#8220;Rome was not built in a day&#8221;&#8230; mostly it was brick by brick over centuries. Whilst I hope finding a reliable way to do software updates takes a few days, I know it&#8217;s going to take longer but hopefully not centuries.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321877">

			<div class="comment by-bttb ">

				<p class="commentcredit">

					<span class="commenter">bttb</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321877">
						June 12, 2018 5:21 PM					</a>

				</p>

				<p>Somewhat OT, but malicious code signing and the Apple Macintosh:</p>
<p>&#8220;For almost 11 years, hackers have had an easy way to get macOS malware past the scrutiny of a host of third-party security tools by tricking them into believing the malicious wares were signed by Apple, researchers said Tuesday.<br />
[&#8230;]<br />
The technique worked using a binary format, alternatively known as a Fat or Universal file, that contained several files that were written for different CPUs used in Macs over the years, such as i386, x86_64, or PPC. Only the first so-called Mach-O file in the bundle had to be signed by Apple. At least eight third-party tools would show other non-signed executable code included in the same bundle as being signed by Apple, too. Affected third-party tools included VirusTotal, Google Santa, Facebook OSQuery, the Little Snitch Firewall, Yelp, OSXCollector, Carbon Black’s db Response, and several tools from Objective-See. Many companies and individuals rely on some of the tools to help implement whitelisting processes that permit only approved applications to be installed on a computer, while forbidding all others.<br />
[&#8230;]<br />
&#8216;To be clear, this is not a vulnerability or bug in Apple’s code&#8230; basically just unclear/confusing documentation that led to people using their API incorrectly,&#8217; Wardle told Ars. &#8216;Apple updated [its] documents to be more clear, and third-party developers just have to invoke the API with a more comprehensive flag (that was always available).'&#8221;<br />
<a href="https://arstechnica.com/information-technology/2018/06/simple-technique-bypassed-macos-signature-checks-by-third-party-tools/" rel="nofollow ugc">https://arstechnica.com/information-technology/2018/06/simple-technique-bypassed-macos-signature-checks-by-third-party-tools/</a></p>
<p>&amp; more in-depth info:<br />
<a href="https://www.okta.com/security-blog/2018/06/issues-around-third-party-apple-code-signing-checks/" rel="nofollow ugc">https://www.okta.com/security-blog/2018/06/issues-around-third-party-apple-code-signing-checks/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321878">

			<div class="comment by-ratio ">

				<p class="commentcredit">

					<span class="commenter">Ratio</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321878">
						June 12, 2018 6:00 PM					</a>

				</p>

				<p>@<i>(unsigned) ~0 &lt;&lt; 010 &lt;&lt; 010 ^ ~0</i>,</p>
<blockquote><p>Will not the malware C&amp;C server be moved to a different or multiple domains?</p></blockquote>
<p>From <i><a href="https://www.thedailybeast.com/exclusive-fbi-seizes-control-of-russian-botnet" rel="nofollow ugc">FBI Seizes Control of Russian Botnet</a></i> (<a href="https://www.schneier.com/blog/archives/2018/05/friday_squid_bl_625.html#c6775785" rel="nofollow ugc">three <i>Squid</i> posts ago</a>):</p>
<blockquote><p>If a victim reboots an infected router, the malicious plugins all disappear, and only the core malware code survives. That code is programmed to connect over the Internet to a command-and-control infrastructure set up by the hackers. First it checks for particular images hosted on Photobucket.com that held hidden information in the metadata. If it can’t find those images—which have indeed been removed from Photobucket—it turns to an emergency backup control point at the hard-coded web address ToKnowAll[.]com.</p></blockquote>
<p>So how do you get the current (Stage 1 / core) malware talking to the new C&amp;C infrastructure?</p>
<p>(I wouldn’t hold my breath waiting for an actual answer to this question from the Very Serious <cite>“I could do that drunk and blindfolded, in fact me and my mouth already have”</cite> People. Endless babble or soothing sounds of crickets are far more likely outcomes.)</p>
<blockquote><p>If Busybox is the infection method why not ID it and get to work fixing the Busybox problem?</p></blockquote>
<p>There are firmware updates available for some of the affected router models.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321879">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321879">
						June 13, 2018 2:07 AM					</a>

				</p>

				<p>@ 65535,</p>
<p>With regards the reboot, as long as there is core code on the infected device that executes then there would be the potential for it to establish a new C&amp;C server. It depends on how cleverly they coded it.</p>
<p>What the FBI appears to be assuming is that the reboot code is not sufficiently well coded thus falls back to a default hard coded host name.</p>
<p>I&#8217;ve not seen an analysis of the code, and for obvious reasons [1] no one should go looking for a copy of any malware code, no matter how good their credentials.</p>
<p>So you would have to look at how the code might function from descriptions or hyperthetically.</p>
<p>Back when I described the &#8220;headless C&amp;C&#8221; method years ago I indicated you would have to pick a service that was &#8220;To big to block&#8221; such as Google and it&#8217;s search engine, thus should always be visable to the malware.</p>
<p>Importantly the service has to have a database of messages that can be searched for by the service.</p>
<p>The trick involves your selection of what is a &#8220;one way function&#8221; to find a &#8220;control message&#8221; in a way that makes examination of the malware tell you nothing, and watching the malware execute as one instance will not tell you about what another instance will search for.</p>
<p>The other reason I picked Google was it alowed the botnet controlers to distance or decouple themselves from Google. That is some services go out and crawl the web. Thus the controler could post a comment on an open blog that Google would then put in it&#8217;s cache. There are sufficient open blogs out there that the controler would never have to use the same open blog twice. Which if the also used other well established practices would make them very difficult for even the Five Eyes to find but in effect impossible for just about everybody else.</p>
<p>Thus the part most likely that the malware writers have got wrong is being impatient or the equivalent of the one way function is unpredictable.</p>
<p>Oddly the first well known Worm written by the son of the senior NSA scientist suffered from &#8220;impatience&#8221; in that the replication rate was set to high, thus the chain reaction built up faster than the decay and the network got swamped out. Getting your K factor right without a feed back mechanism is actually very difficult. In the case of malware if you do add a feedback mechanism then the malware can be detected or defeted by it unless you put a lot of care into it. We saw another type of malware feedback mechanism fail badly when Marcus Hutchins found and registered a domain name.</p>
<p>The use of a fall back hardwired command server was such a mistake. It&#8217;s also a sign that the malware writers were &#8220;impatient&#8221;. They should not have done it. Now there is a clear indicator or big red flag available as to just which devices have malware. It was a big mistake to make&#8230;</p>
<p>It also suggests that there may have been other &#8220;preasures&#8221; on the malware writers in that there is say an important time line involved like the aniversary of a historical event to be &#8220;celebrated&#8221; for ideological reasons.</p>
<p>They might also have lacked confidence in their one way function for some reason. Getting them to work well also involves selecting the right K value without feedback. But also making the one way function effective is quite difficult. In effect you are designing a cryptographic system not to disimilar to a one way function with a trapdoor. The information to do it is in the public domain but you have to know about it and more importantly know how to &#8220;bolt the bits together so they fit&#8221;. It&#8217;s an area where there are PhDs to be earned for the right curious minds, but untill someone breaks ground it&#8217;s not likely to be investigated[2].</p>
<p>Or the FBI are just crossing their fingers and hoping there is a sufficient time delay between the reset and the controller establishing a new command message.</p>
<p>[1] See Marcy Wheeler&#8217;s comments about the FBI / DoJ on Marcus Hutchins,</p>
<p><a href="https://www.emptywheel.net/2018/06/06/to-pre-empt-an-ass-handing-the-government-lards-on-problematic-new-charges-against-malwaretech/" rel="nofollow ugc">https://www.emptywheel.net/2018/06/06/to-pre-empt-an-ass-handing-the-government-lards-on-problematic-new-charges-against-malwaretech/</a></p>
<p>Marcy has as @echo noted gone a little over the top with the naughty words, but I can understand why. Because it appears to be a rerun of the tactics used against Aaron Swartz that led to his suicide. Basically they have declared that if they decide you are guilty then they will keep throwing charges at you untill you run out of money and can nolonger defend yourself. It&#8217;s a legal game thats just one of the tricks of &#8220;Rights Stripping&#8221; and it&#8217;s one you can not win on the legal playing field. It&#8217;s the sort of thing you would expect of a tyrannical dictatorship trying to look like only a Police State. As I&#8217;ve said before you do not want to be a foreigner in the US when the FBI/DoJ decide to &#8220;show trial&#8221; you&#8230; As our host @Bruce noted many years ago, it&#8217;s counter productive. Because researchers will nolonger come to the US for conferences, thus academic conferences will move out or stay out of the US which will mean that in turn academic researchs and companies will move out of the US&#8230; Not smart but then the US legal system appears to be moving the &#8220;dumber and dumber&#8221; way these days. As my father pointed out to me many years ago &#8220;The place to be when there is trouble, is somewhere else&#8221;. The US is now &#8220;Trouble&#8221; for those involved with anything &#8220;cyber&#8221; and if you are &#8220;Jonny Foreigner&#8221; God help you.</p>
<p>[2] It&#8217;s the &#8220;Dark Arts taboo&#8221; issue. If you come up with the idea and publish a proof of concept, you are automatically evil. However once there is a &#8220;baddie&#8221; of sufficient evil intent we need &#8220;goodies&#8221; &#8220;To vanquish the evil doers and their works of evil&#8221;&#8230; So it&#8217;s OK to get into it once a &#8220;baddie&#8221; has appeared but not before.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321880">

			<div class="comment by-rondity ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://sci.uonbi.ac.ke' rel='external nofollow ugc' class='url'>rondity</a></span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321880">
						June 13, 2018 3:19 AM					</a>

				</p>

				<p>Malicious code is a big thing more so when running application with no secure nodes</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321881">

			<div class="comment by-petr-spacek ">

				<p class="commentcredit">

					<span class="commenter">Petr Špaček</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321881">
						June 13, 2018 3:26 AM					</a>

				</p>

				<p>Disclaimer: I work for CZ.NIC, i.e. the manufacturer of device advertised below. The following text contains advertisement for routers with automatic updates. Feel free to flag this post as spam and delete it if it is deemed inappropriate for this forum.</p>
<p>Most vendors of super cheap routers have no motivation to maintain operating system for these boxes, there it simply not enough money behind it.</p>
<p>If you really want automatic updates and are prepared to pay for it have a look at &#8220;Turris Omnia&#8221; or &#8220;Turris MOX&#8221; routers. Turris routers come with OS based on OpenWRT and have automatic updates (which can be turned off, if you want).</p>
<p>Turris MOX &#8211; modular router with automatic updates:<br />
<a href="https://www.indiegogo.com/projects/turris-mox-modular-open-source-router-security-computers#/" rel="nofollow ugc">https://www.indiegogo.com/projects/turris-mox-modular-open-source-router-security-computers#/</a></p>
<p>Turris Omnia &#8211; monolitic router with automatic updates:<br />
<a href="https://omnia.turris.cz/en/" rel="nofollow ugc">https://omnia.turris.cz/en/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321883">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321883">
						June 13, 2018 6:39 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;…regards the reboot, as long as there is core code on the infected device that executes then there would be the potential for it to establish a new C&amp;C server. It depends on how cleverly they coded it. What the FBI appears to be assuming is that the reboot code is not sufficiently well coded thus falls back to a default hard coded host name.”- Clive R.</p>
<p>I agree with that.</p>
<p>It would appear the FBI feels the code can re-infect a device and then supposedly the world friendly FBI will monitor the spread of refection &#8211; or possibly test some of their malware to see how good it works infecting routers and stripping SSL.</p>
<p>There could be many permutation of this senairo with unknown outcomes to the average Jane/Joe. I would guess domians and IP address can be changed or spoofed.</p>
<p>I would play it safe and do a hard reset and hope for the best [I don’t have one of the 70+ makes of routers/devices on the list which is of some comfort].</p>
<p>“[1] no one should go looking for a copy of any malware code, no matter how good their credentials… See Marcy Wheeler&#8217;s comments about the FBI / DoJ on Marcus Hutchins,”- Clive R</p>
<p>I cannot disagree. I have read Emptywheel’s post on this MH arrest and I am not  happy with how the FBI failed to turn on the recoder before his reading his rights and the charges. I am not liking the way the FBI keeps doubling down on their attempts to get a plea bargain. That is one of the reason’s I noted some people might view the FBI as tainted. I will say Brian Krebs feels the FBI has its man but who knows.</p>
<p>“…trick involves your selection of what is a &#8220;one way function&#8221; to find a &#8220;control message&#8221; in a way that makes examination of the malware tell you nothing, and watching the malware execute as one instance will not tell you about what another instance will search for. The other reason I picked Google was it alowed the botnet controlers to distance or decouple themselves from Google. That is some services go out and crawl the web…the controler could post a comment on an open blog that Google would then put in it&#8217;s cache.”-Clive R</p>
<p>That is a good trick. I think that there are a number of other ways of achieving the same goal. For example this could be just a test malware run by a powerful actor and the next strain of malware say, VPNFilter v2.01 could be much more effective and elusive.</p>
<p>“There are sufficient open blogs out there that the controler would never have to use the same open blog twice. Which if the also used other well established practices would make them very difficult for even the Five Eyes to find but in effect impossible for just about everybody else.”- Clive R</p>
<p>That is true. Further, there plenty of platforms that do similar things making the malware harder to stop. This method you describe could be mutated or multiplied in certain fashions. This also could up the malware game to a very unpleasant level.</p>
<p>“In effect you are designing a cryptographic system not to disimilar to a one way function with a trapdoor. The information to do it is in the public domain but you have to know about it and more importantly know how to &#8220;bolt the bits together so they fit&#8221;. It&#8217;s an area where there are PhDs to be earned for the right curious minds, but untill someone breaks ground it&#8217;s not likely to be investigated[2]&#8230; If you come up with the idea and publish a proof of concept, you are automatically evil. However once there is a &#8220;baddie&#8221; of sufficient evil intent we need &#8220;goodies&#8221; &#8220;To vanquish the evil doers and their works of evil&#8221;&#8230; So it&#8217;s OK to get into it once a &#8220;baddie&#8221; has appeared but not before.” -Clive</p>
<p>I concur. I hear you on the proof of concept and then getting automatically black listed.</p>
<p>Further, you have demonstrated how to mutated a system and probably have caused the other side to try and best you.</p>
<p>This is the problem somewhat like a double edged sword with both edges getting sharper. Now, add in some State actors, microprocessor maker with nasty code and more swords are better made and in the field. This malware game seems to continue to mushroom and grow.</p>
<p>Returning to the possible method of infection being BusyBox and Linux, are there any experts here that can comment on exact problem and how to mitigate it? Is it Busybox only or a fault in the chips used with Busybox?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321884">

			<div class="comment by-bttb ">

				<p class="commentcredit">

					<span class="commenter">bttb</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321884">
						June 13, 2018 8:54 AM					</a>

				</p>

				<p>From emptywheel regarding cyber sanctions:</p>
<p>&#8220;Even as Trump was working hard to get Russia admitted back into the G-7, Treasury was preparing new cyber sanctions against a number of “Russian” entities. This appears to be an effort to apply sanctions for activities exploiting routers and other network infrastructure (activities that the US and its partners engage in too) that US-CERT released a warning about in April.&#8221;<br />
<a href="https://www.emptywheel.net/2018/06/12/the-new-cyber-sanctions/" rel="nofollow ugc">https://www.emptywheel.net/2018/06/12/the-new-cyber-sanctions/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321885">

			<div class="comment by-bttb ">

				<p class="commentcredit">

					<span class="commenter">bttb</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321885">
						June 13, 2018 9:25 AM					</a>

				</p>

				<p>Clive, above, wrote: &#8220;Marcy has as @echo noted gone a little over the top with the naughty words&#8230;&#8221;</p>
<p>&#8216;Abundant tweets about civil liberties &amp; national security. &#8220;Has a longer memory than an elephant &amp; keeps more records than Jim Comey.” Legendary potty mouth.&#8217;<br />
<a href="https://mobile.twitter.com/emptywheel" rel="nofollow ugc">https://mobile.twitter.com/emptywheel</a></p>
<p>In addition, there may be some historical context that some readers may be missing, for example, afaik: <a href="https://www.emptywheel.net/2010/04/29/do-bloggers-suck-or-does-tradmed-just-suck-more/#comment-303850" rel="nofollow ugc">https://www.emptywheel.net/2010/04/29/do-bloggers-suck-or-does-tradmed-just-suck-more/#comment-303850</a><br />
or<br />
<a href="https://shadowproof.com/2009/07/13/marcy-wheeler-says-blowjob-on-msnbc/" rel="nofollow ugc">https://shadowproof.com/2009/07/13/marcy-wheeler-says-blowjob-on-msnbc/</a><br />
<a href="https://mobile.twitter.com/HowardKurtz/status/2619416491" rel="nofollow ugc">https://mobile.twitter.com/HowardKurtz/status/2619416491</a></p>
<p>Of course, nowadays actors say f?ck you on televised awards&#8217; shows.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321887">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321887">
						June 28, 2018 3:19 PM					</a>

				</p>

				<p>Thanks for sharing sublime information, But I do have some info that WiFi Bulwarked Access version 2 was ratified for public use. It took the WiFi Coalition more than 14-years to revise the wireless LAN standard encryption system, with version 3.0 of the WiFi Bulwarked Access has been green-lighted for public consumption. Here &#8211; <a href="https://www.infosecuritycenter.com/network-security/wifi-alliance-has-decided-wpa3-to-retire-the-circa-2004-wpa2-soon/" rel="nofollow ugc">https://www.infosecuritycenter.com/network-security/wifi-alliance-has-decided-wpa3-to-retire-the-circa-2004-wpa2-soon/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321888">

			<div class="comment by-asus-repair-center ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.asussupportnumber.com/asus-repair-service/' rel='external nofollow ugc' class='url'>Asus Repair Center</a></span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321888">
						August 7, 2018 6:51 AM					</a>

				</p>

				<p>I Appreciate the detailed. I went through this post and it&#8217;s quite amazing for the user. I use Asus router and its have great feature and The Asus repair center help me a lot to setting up my router with greatly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-321889">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321889">
						October 16, 2018 2:52 AM					</a>

				</p>

				<p>That is fore the court case in February,<br />
@ others don&#8217;t worry about the post</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-321890">

			<div class="comment by-emmajasmine ">

				<p class="commentcredit">

					<span class="commenter">Emmajasmine</span> •

					<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/#comment-321890">
						July 1, 2019 5:21 AM					</a>

				</p>

				<p><a href="www.thetelecomshop.com/au/cisco-887va-router-with-vdsl2-adsl2-over-pots-with-802-11n-etsi-compliant-c887va-w-e-k9-rf" rel="nofollow ugc">The Cisco 887VA router</a> with VDSL2/ADSL2+ over POTS with 802.11n ETSI Compliant C887VA-W-E-K9-RF is a Integrated Services Routers with high performance for broadband access in small offices and small branch-office or teleworker sites with performance required for concurrent services, including firewall, intrusion prevention, content filtering, and encryption for VPNs, optional 802.11g/n for mobility, and Quality-of-Service (QoS) features for optimizing voice and video applications. The Cisco 887 C887VA-K9-RF is a newer Cisco 880 Series which are fanless type providing a quiet, comfortable working environment in small offices.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2018/06/router_vulnerab.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2018/06/router_vulnerab.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2018%2F06%2Frouter_vulnerab.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2018/06/router_vulnerab.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='11601' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2018/06/friday_squid_bl_628.html" rel="prev">← Friday Squid Blogging: Extinct Relatives of Squid</a>		<a href="https://www.schneier.com/blog/archives/2018/06/new_iphone_os_m.html" rel="next">New iPhone OS May Include Device-Unlocking Security →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
