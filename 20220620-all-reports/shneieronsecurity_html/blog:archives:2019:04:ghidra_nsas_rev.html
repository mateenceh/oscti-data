<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Ghidra: NSA&#039;s Reverse-Engineering Tool - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Ghidra: NSA&#039;s Reverse-Engineering Tool Comments Feed" href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12009" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12009' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F04%2Fghidra_nsas_rev.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F04%2Fghidra_nsas_rev.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12009 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12009" class="post-12009 post type-post status-publish format-standard hentry category-uncategorized tag-cybersecurity tag-nsa tag-open-source tag-reverse-engineering">

	<div class="article">

		<h2 class="entry">Ghidra: NSA&#039;s Reverse-Engineering Tool</h2>
		<p>Last month, the NSA <a href="https://www.nsa.gov/resources/everyone/ghidra/">released</a> <a href="https://ghidra-sre.org/">Ghidra</a>, a software reverse-engineering tool. Early reactions are uniformly positive.</p>
<p><a href="https://www.zdnet.com/article/nsa-release-ghidra-a-free-software-reverse-engineering-toolkit/">Three</a> <a href="https://www.wired.com/story/nsa-ghidra-open-source-tool/">news</a> <a href="https://motherboard.vice.com/en_us/article/panvm7/nsa-releases-ghidra-for-free-game-changer">articles</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cybersecurity/" rel="tag">cybersecurity</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/open-source/" rel="tag">open source</a>, <a href="https://www.schneier.com/tag/reverse-engineering/" rel="tag">reverse engineering</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html" rel="bookmark">Posted on April 8, 2019 at 9:50 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html#comments">21 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html" data-title="Ghidra: NSA&#039;s Reverse-Engineering Tool" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-334639">

			<div class="comment by-vesselin-bontchev ">

				<p class="commentcredit">

					<span class="commenter">Vesselin Bontchev</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334639">
						April 8, 2019 11:18 AM					</a>

				</p>

				<p>Not sure what you mean by &#8220;uniformly positive&#8221;. I&#8217;m a long-time IDA user. I&#8217;ve played with Ghidra a bit and the only real way it can compete with IDA is by price &#8211; IDA is prohibitively expensive (I&#8217;m still using a decade-old version which our company licensed), while Ghidra is free.</p>
<p>Yes, Ghidra has some gimmicks that IDA doesn&#8217;t, like a synchronized display of the decompiled source with the disassembly, support of additional exotic CPU architectures, etc., but they aren&#8217;t a game changer, at least not for me.</p>
<p>Ghidra also has plenty of annoyances. Its developers have managed to design a user interface that&#8217;s even uglier than that of IDA; it&#8217;s like something from the early 90s. I&#8217;ve also found outright bugs &#8211; like Ghidra being unable to load and diassemble files that IDA can, because of some discrepancy between the virtual and the raw size of the code section.</p>
<p>Etc., etc.</p>
<p>To summarize &#8211; yes, it&#8217;s a very nice free tool that will help beginners but doesn&#8217;t threaten to put IDA out of business. What it <em>can</em> compete efficiently with is things like Binary Ninja or the horrible crap that is radare2 (even with a GUI add-on).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334640">

			<div class="comment by-martin ">

				<p class="commentcredit">

					<span class="commenter">Martin</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334640">
						April 8, 2019 1:31 PM					</a>

				</p>

				<p>Uniformly positive means that most people have been pleasantly surprised by it, both as far as no definitive NSA backdoors found so far and while not feature complete, still very useful. Just because you don&#8217;t like it, doesn&#8217;t mean it isn&#8217;t good. You say the only good thing  is it&#8217;s free. You could make that argument for R2 for years with R2 being free. But you say R2 is bad, when it simply isn&#8217;t (maybe because its not IDA and doesn&#8217;t hold your hand that you don&#8217;t like it?). Ghidra can compete with IDA flat out though.</p>
<p>The only thing you can specify that you don&#8217;t like about Ghidra is the GUI, but Ghidra is FOSS and you can just write your own GUI to your specifications&#8230; In fact, in the majority of reviews, the GUI has been a strength, saying it&#8217;s far superior to IDA&#8217;s. And the bugs, you can literally fix yourself because again, Ghidra is FOSS, something you can&#8217;t do with IDA.</p>
<p>Seems to more of fear of NSA or fear that your excessively overpriced software might be obsolete soon. Or fear of needing to adapt to new software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334641">

			<div class="comment by-markus ">

				<p class="commentcredit">

					<span class="commenter">Markus</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334641">
						April 8, 2019 2:20 PM					</a>

				</p>

				<p>Summarizing, IDA could probably make a little difference after spending a considerable amount of money in terms of Licensing and Support, while Ghidra is totally free. This is uniformly agreed and more than positive, in my opinion. Even NSA was probably a bit tired of IDA &#8220;leading position&#8221; on the market&#8230;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334642">

			<div class="comment by-faustus ">

				<p class="commentcredit">

					<span class="commenter">Faustus</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334642">
						April 8, 2019 5:49 PM					</a>

				</p>

				<p>What are the chances that Ghidra won&#8217;t tattle on you if you start using it for dubious purposes?  Copyright protection removal, for example.  Why else would the NSA want to make common a tool that makes dubious activities more financially viable for the average hacker?  Education, they say.  Hmm, I say.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334643">

			<div class="comment by-tony ">

				<p class="commentcredit">

					<span class="commenter">Tony</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334643">
						April 8, 2019 6:53 PM					</a>

				</p>

				<p>This would let relative novices to security figure out whether a Ken Thompson &#8220;Reflections on trusting trust&#8221; style exploit had been applied sometime in the history of their distribution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334644">

			<div class="comment by-wiley ">

				<p class="commentcredit">

					<span class="commenter">wiley</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334644">
						April 8, 2019 11:45 PM					</a>

				</p>

				<p>@Faustus</p>
<blockquote><p>
  Why else would the NSA want to make common a tool that makes dubious activities more financially viable for the average hacker?
</p></blockquote>
<p>The answer is actually quite obvious. They want more publicity. They want more people chatting about this &#8220;cool tool the guys at the NSA released&#8221; and more people talking positively about their organization. In fact, if you look at the README, you&#8217;ll see they&#8217;re trying to recruit people through Ghidra. Arguably nefarious given that they&#8217;re essentially trying to recruit people into their criminal organization, but far from some sort of stupid plan to spy on people through Ghidra.</p>
<p>If anything, putting a backdoor in something that they admit is theirs would be the stupidest thing they could conceivably do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334645">

			<div class="comment by-wak ">

				<p class="commentcredit">

					<span class="commenter">Wak</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334645">
						April 9, 2019 1:03 AM					</a>

				</p>

				<p>@Vesselin Bontchev</p>
<p>Ghidra isn&#8217;t meant to replace IDA Pro.  It&#8217;s meant to replace IDA Freeware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334646">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334646">
						April 9, 2019 2:56 AM					</a>

				</p>

				<p>But do you need structs unwound, or what some call to function does,no, if its running, you need snap shot, patch data ,regs and after go back to that point, if you are re , you need all that info as a large GUI map that ida tried to do, but when you write a asm program you realise that its 3-7 pages long tops, and no the human brain can&#8217;t chain regs that deep.</p>
<p>If I ever get back into it, I might look at the program.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334647">

			<div class="comment by-faustus ">

				<p class="commentcredit">

					<span class="commenter">Faustus</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334647">
						April 9, 2019 5:13 AM					</a>

				</p>

				<p>@ wiley</p>
<p>I know what they say it&#8217;s for.  Do you believe everything the NSA tells you?  Backdoors are designed for deniability.  We have bandied about quite a few backdoors connected to the NSA in this forum.  (Cue to Clive and his prodigious memory and typing ability!)</p>
<p>The software doesn&#8217;t even have to have a backdoor.  All it has to do is send back encrypted telemetry, like almost every product does these days (though not always encrypted).  Perhaps with the help of a some obscure functionality that the NSA has had placed in the JVM.</p>
<p>I am not that current on Java, which was a big security vulnerability back in the day.  I don&#8217;t think I&#8217;m the only one avoiding it.  <a href="https://en.wikipedia.org/wiki/Java_security#Potential_sources_of_security_vulnerabilities_in_Java_applications" rel="nofollow ugc">https://en.wikipedia.org/wiki/Java_security#Potential_sources_of_security_vulnerabilities_in_Java_applications</a></p>
<p>Golang gives me all the functionality I need with no need to install a bloated platform and keep it updated with a possibly subverted update system.</p>
<p>Yes, Java is a relatively easy way to create to GUI.  And the Trojan Horse was a thoughtful housewarming gift.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334648">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334648">
						April 9, 2019 3:24 PM					</a>

				</p>

				<p>@ Faustus, Wiley,</p>
<blockquote><p>We have bandied about quite a few backdoors connected to the NSA in this forum. (Cue to Clive and his prodigious memory and typing ability!)</p></blockquote>
<p>Hmmm not sure what to make of the later part of that from a person who has selected Faustus[1] as a handle 😉</p>
<p>But as you note potentially there is rather more to it than @Wiley&#8217;s,</p>
<blockquote><p>The answer is actually quite obvious. They want more publicity. They want more people chatting about this &#8220;cool tool the guys at the NSA released&#8221; and more people talking positively about their organization.</p></blockquote>
<p>Which to a playwrite or stage magician would be known as &#8220;misdirection&#8221; of directing the audience to see what you want them to see, not what you don&#8217;t.</p>
<p>As I&#8217;ve noted numerous times in the past the nature of &#8220;attack over defence&#8221; as an &#8220;operational defence strategy&#8221; which appears to be the NSA&#8217;s behaviour over the latter part of the last century and up untill the Ed Snowden revelations &#8211;the little we have seen&#8211; is actually not their prefered methods. It is with good reason that some say jokingly NSA stands for &#8220;Never Say Anything&#8221;. In the game of &#8220;smoke and mirrors&#8221; they want to remain hidden behind the mirror sight unseen blowing smoke if required as a distraction. Idealy they want to be not the fly on the wall, but the fly under the table, hearing all whilst out of sight. They are by nature where possible &#8220;passive observers&#8221; as are most SigInt agencies.</p>
<p>In the past prior to the formation of th NSA one trick was to have mechanical cipher machines that had both a small percentage of strong keys, with some very weak keys but about half breakable without &#8220;plaintext&#8221; by methods known to certain cryptographers only (a policy William Friedman continued with Crypto AG).</p>
<p>The assumption being that if the crypto mechanics were found via captured equipment or &#8220;given over to the enemy by traitors&#8221; then one of three things would happen.</p>
<p>1, The enemy would be wise to the issue, thus treat a traitor as a &#8220;dangle&#8221; or &#8220;double agent&#8221; thus treat them and any further information from them with deep suspicion, effectively neutralizing the traitor.</p>
<p>2, The enemy would learn little of the cryptograhers skills, thus would gain little knowledge about their methods.</p>
<p>3, The enemy if lacking sufficient crypto skills would copy the designs thus incorporate the weaknesses, thus make their own systems vulnerable.</p>
<p>This worked because the cryptographers who designed the weaknesses into the systems also issued the keying material, so did not issue weak keys unless there was a reason to.</p>
<p>Importantly breaking crypto is way way easier when you have more than just the ciphertext to work with. One such is &#8220;probable plaintext&#8221;, one thing the US learnt from Bletchly was the power of the card index library combined with traffic analysis. The result of which along with a few other tricks was good quality &#8220;probable plaintext&#8221; to form &#8220;cribs&#8221; etc. Without which even the &#8220;bombs&#8221; would not work effectively or at all.</p>
<p>In fact after WWII both Britain and the USA were way more concerned about the knowledge of &#8220;traffic analysis&#8221; becoming known than the already known &#8220;use of probable plaintex&#8221; as an aid in cryptanalysis. Plaintext tended to be depreciated by many of a &#8220;millitary mind&#8221; on the assumption of &#8220;If you know the plaintext why do you need to break the bl**dy code&#8221;&#8230; Which in these days of &#8220;collect it all&#8221; appears somewhat of a &#8220;quaint viewpoint&#8221;.</p>
<p>The upside trick of the weak and strong keys, is if your enemy don&#8217;t know it&#8217;s there then probability says they will use the weak keys as well as the strong as they don&#8217;t know the difference. Thus each weak key the enemy uses quickly gives plaintext that gets indexed into the library along with updating the traffic analysis information. Thus giving better probable plaintext to break other messages used under stronger or strong keys. Thus with say 80% of the enemy messages recovered most if not all of their &#8220;order of battle&#8221; is known.</p>
<p>When Robert Morris senior (father of the Morris Worm writer) retired from the NSA as part of his leaving speech he revealed that &#8220;plaintext&#8221; was what the NSA lived for and was their key mission  requirement. Whilst true it was also a bit disingenuous because it hid a greater truth with a lesser truth, which is just another part of &#8220;finessing&#8221;.</p>
<p>It&#8217;s been suggested more than once that Microsofts slightly odd behaviour in having a lot of static plaintext in known positions in their file formats is due to NSA influance. If it&#8217;s true or not it certainly would help against the majority of &#8220;homemade ciphers&#8221;. The sort of thing a criminal or terrorist boss might come up with or even a nation state where education and knowledge is not respected sufficiently for which ever of many reasons.</p>
<p>However as I pointed out last century here and other places plaintext alone is not enough. Thus if I was the NSA I would target both protocols and standards to introduce covert side channels. In part because you don&#8217;t need insiders or liaison with individual companies when you get at protocols and standards. Thus you in effect stay behind the mirror out of sight.</p>
<p>The NSA had a major advantage with their influance over NIST thus both protocols and standards. If you go back and look at the AES competition rules they were in effect &#8220;got at&#8221;. The NSA most definately knew about time based covert side channels though it was not widely known in the open community at the time. The rules were such that it was almost guarenteed that the worst code for such channels would get used by developers everywhere. Oh and the NSA have subsequently effectively &#8220;given the game away&#8221; if you look at things they make such as &#8220;In line Media Encryptors&#8221; you will see thay say that AES is clasified as sutable for &#8220;secret&#8221; material but only when the data is at rest&#8230;</p>
<p>Basically the reason is it&#8217;s the old &#8220;Efficiency-v-Security&#8221; trade off. Unless you realy know all the ways covert channels can be made &#8211;and the open community is still way behind on this&#8211; then making your implementation &#8220;more efficient&#8221; makes it have more side channels thus reduce security to virtually nothing. Thus &#8220;fast code&#8221; that was written into the AES competition rules was going to be likewise riddled with loop unroling and time imbalances on branching instructions etc. Which the NSA knew would be copied by developers of programs and code libraries, thus in turn riddling any program using AES with &#8220;time based side channels&#8221; that leak key information across the network for quite a distance. Which obviously allowed the NSA etc to stay behind the mirror and passive monitor traffic flowing across data networks. Thus the NSA and other clued-in SigInt agencies in the Five-Eyes ect to use extended TEMPEST techniques to be easily able to &#8220;recover keys&#8221; thus decrypt to get plaintext.</p>
<p>Why would we think the NSA did this? Well it&#8217;s an old established technique is one very good reason. We know from Peter Wrights &#8220;Spycatcher&#8221; book of the early 1980&#8217;s that MI5/GCHQ were using back as early as the 1950&#8217;s acoustic time based side channels against mechanical cipher systems. In amongst others the Egyption Embassy Cipher room that had a phone in the &#8220;cipher-cell&#8221;.</p>
<p>The book also talks of the &#8220;flooding device&#8221; which could be used to turn on the microphone on in a phone and thus &#8220;listen-in&#8221; to what was happening in such a cipher-cell even though the phone was &#8220;on-hook&#8221; (it used an MF oscillator in a bridge circuit to jump across the hook switch contacts that had a small capacitance, the microphone in the handset thus envelop/amplitude modulated the signal with the noises it picked up). It was almost certain that the trick was passed onto the US under the BRUSA later UKUSA agreement. So it was a racing certainty that one of the things the NSA/GCHQ would have encoraged William Friedman to get Crypto AG to have included in the crypto kit supplied to most countries, the UN and many commercial organisations.</p>
<p>The same accoustic side channels appeared along with electrical ones in electromechanical ciphers where relay pull in / drop back times would give away both inputs to an XOR gate used in One Time Tape Cipher machines that would be otherwise theoretically unbreakable. Hence the point people make that &#8220;mathmatical proofs&#8221; of security with regards algorithms are worth little in practice with regards implementations, which is what AES fell to by the design of the NSA through their &#8220;usefull idiots&#8221; NIST&#8230;</p>
<p>But we now also know through the Dual Eliptic Curve supposadly Crypto Secure Digital Random Bit Generator that NIST was finessed into standardising, that they attack Standards as well as implementations and protocols. They even went on to pay RSA to make the ineficient DRNG the default RNG to use, and then there was the interesting story of Juniper Networks routers somehow ending up with a weakened RNG in their products&#8230;</p>
<p>So now it&#8217;s accepted the NSA has done the &#8220;backdoor thing&#8221; on Plaintext, Protocols and Standards and put side channels in as much as they can before most of the rest of the world woke up you would think they were kind of happy with what it was getting them. Well they probably were, despite others ringing the bell quite loudly the world was not waking upto what was going on, thus the data which was mainly unencrypted at that point in time was firehosing off of the phone and Internet faster than they could store it away, so apart from the inability to handle the data back then &#8211;Utah was not yet built&#8211; it was kind of good times.</p>
<p>Then Ed Snowden did a runner with a still unknown quantity of Five-Eye secrets that he chose to give to journalists to disclose to the public. The result the world kind of woke up briefly and all of a sudden the good times were not as good, with &#8220;lets encrypt&#8221; and similar going on all of a sudden things got a lot lot more difficult, or did they?</p>
<p>Probably not as much as some people think. As I&#8217;ve pointed out in the past information security ultimately rests on Key Managment (KeyMan) specifically Key Generation (KeyGen), Key Distribution and importantly Key and plaintext destruction.</p>
<p>Poorly designed RNGs are a god-send to the Five-Eyes which I&#8217;ve mentioned in the past, embedded systems such as routers and any and all IoT devices, are virtually guaranteed to have &#8220;low entropy&#8221; on start up when they generate their asymetric keys. As I&#8217;ve mentioned before that is an area I would expect the NSA to have expended considerable resources. That 1024bit RSA key cracking system they had would easily be repurposed into chasing embedded systems PrivKeys.</p>
<p>But the NSA reputation of &#8220;hunting sysadmins&#8221; why break the encryption when you can break the accounts of the SysAdmin tasked with KeyMan as just another part of the job they could do without&#8230; As a matter of self interest, SysAdmins are just not going to do Key Destruction properly and are also likely to do Key Audit etc in flat files, that are at best CSV formated so they can be used flexibly, including hand rebuilding if they get a sys-crash or equivalent breaking them. Also just to be safe they will also be on backup tapes and all sorts of other places. All of which have the equivalent security strength of over boiled wet noodles. What&#8217;s the betting some SysAdmins have such a file on a USB key on their key chain along with their car and house keys?</p>
<p>The NSA again has a reputation not for hacking user machines or servers but routers. How often do SysAdmins check routers? Trick question that&#8217;s the NetAdmins job&#8230; As a general rule of thumb a SysAdmins security perimeter is &#8220;the box before&#8221; not the router or anything upstream of it. Thus the router is the NSAs mirror to hide behind&#8230; Few if any organisations &#8220;instrument&#8221; that no-mans-land between the organisational gateway router and their service providers upstream router. Thus will miss any nasty trafic coming down for their gateway router&#8230; As it&#8217;s the gateway, it does not get taken off line to be checked in ways that might reveal implants and malware. Which is why the NSA love them so much.</p>
<p>The thing is many of those side channel attacks can be seen from that gateway router thus some key-leakage is going to happen.</p>
<p>So the question remains of &#8220;Do the NSA and other Five-Eye SigInt agencies actually need exploits in user or server computers?&#8221;</p>
<p>The answer is not realy, it&#8217;s the network devices such as routers, bridges, data diodes, switches and IoT devices that are going to be their targets of choice.</p>
<p>So the question you have to ask is are security people investigating these devices with the likes of IDA Pro? Probably not as many as you would first think. It&#8217;s not the debug tool of choice for embeded systems device designers.</p>
<p>Thus how much real harm is the release of Ghidra going to be to the SigInt agencies missions?</p>
<p>Simple answer very little at all. Infact if the NSA is shifting it&#8217;s focus from &#8220;mindless attack&#8221; of certain War Hawk types to &#8220;thoughtful defence&#8221; then having other people mainly investigate user and server OS&#8217;s and their applications very benificial. It kind of helps the &#8220;thousand eyes&#8221; paradigm along where as IDA-Pro&#8217;s pricing and that of some other tools acts as real impediment to constructive thoughtful defence.</p>
<p>Thus I can see the less militaristic minds in the SigInt agencies actually welcoming more eyes on user machines and servers. Especially as everything is &#8220;moving onto the network&#8221;. Microsoft 365, Googles and many others are shifting their finance models from &#8220;one off licence fees&#8221; to &#8220;monthly rental&#8221; via &#8220;Cloud Services&#8221;.</p>
<p>It will probably not be more than a couple of years before what is currently happening with mobile phones and the cloud happens to user computers, and the only servers around will be the specialized ones of the cloud providers.</p>
<p>That is your user computing device will be little more than a slightly fat &#8220;thin client&#8221; with application &#8220;front ends&#8221; being web-based pulled into your local browser, but the backend data handeling for storage and similar will be a local very limited capacity mirror updated to the cloud with increasing frequency as the price of data communications makes even the cost of the lowest cost local storage comparatively prohibitively expensive. 100USD for an SSD in thirty user computers is a lot more than the cost of providing comms to a cloud service for them in the anual budget. There are also other cost saving benifits, such as non fixed location working those thirty workers won&#8217;t need thirty desks, floor space, heating and lighting or even toilets that you need now, maybe only fascilities for five or six. Add reliable comms and they can work anywhere, the notepad/tablet camera, mic, and keystroke sensor alowing the AI Office Manager to monitor time &#8220;at work&#8221;. It&#8217;s the view of the future for a number of entrepreneurs who aim to revolutionise the way software is produced by contract. Likewise other &#8220;knowledge workers&#8221; oh and students have been getting it for some time now not just with online exams but course work where background apps check for online searching or data uploading to spot plagiarism&#8230;</p>
<p>Such &#8220;network living&#8221; is a god-send to the SigInt agencies along with &#8220;walled garden&#8221; devices &#8220;being owned&#8221; not by the purchasor, but by who ever has a copy of the code signing key. But as with IoT the manufacturer forcing the user online just to use the device so the manufacturer can sell the user data&#8230; Thus the SigInt agencies just &#8220;free-ride&#8221; as the data goes by &#8220;on the networks they own&#8221;.</p>
<p>Thus in that near future model the better the defence from enemies the better, cyber-attacking is rapidly becoming &#8220;oh so yesterday&#8221; anyway as various people start to wake up to stronger defence.</p>
<p>It&#8217;s not &#8220;owning the apps&#8221; that interest the SigInt agencies it&#8217;s &#8220;owning the data&#8221;, it&#8217;s manufacturers that want to &#8220;own the apps, to own the data&#8221; and as long as the data flows across their network the SigInt agencies will be happy. Have a think back to CarrierIQ and mobile phones. CarrierIQ&#8217;s software was a &#8220;test harness&#8221; that recorded every action of the user and them &#8220;Phoned it back to the mothership&#8221; at the data center. All the NSA had to do to collect all of those users actions was sit on the otherside of the upstream router from the data center teeing the data off to be recorded in their systems for ever more. It&#8217;s bot even as though CarrierIQ used any real security protection&#8230;</p>
<p>That is the world we are moving into thus fixing apps on user computers and the servers the user data is stored in is in the NSA&#8217;s interests. After all if you think those apps are secure, &#8211;as we have seen with the supposadly secure messaging apps,&#8211; you will &#8220;over trust&#8221; and that&#8217;s in the NSA and corporate interests. You can be sure that if a corporate can access your data then the SigInt agencies will already have it&#8230;</p>
<p>[1] Strangely perhaps Dr Fsustus is the name of the protagonist in a play by Christopher Marlowe, his also known to have been involved in earky cryotography, the down fall of Queens and an untimely death by stabbing that might have been state sanctioned&#8230;</p>
<p>Some time in the 1590&#8217;s Christopher Marlowe wrote the play about Dr Faustus the necromancer, based on earlier German tales. Faustus was capable of summoning devils and the attention of Mephistophilis, a condemned soul pressed by the devil to close deals and collect souls on others. Part of Mephistophilis punishment was that he was allowed in fact encoraged to warn others of their fate before closing the bargin, few ever headed thus Mephistophilis had to further suffer the torment of collecting their souls for the bargins that actually were nothing.</p>
<p>In Act.1 Dr Fautus has a soliloquy, about the vanity of human science, having previously described himself as having mastered every piece of knowledge he has come across&#8230; Thus revealing himself to be both vain and egotistical to the audiance and thus setting the tone for his eventual fate via hubris and Mephistophilis&#8217;s administrations. Thus setting the required moral tones of the time. A time when an ill written word could lead to not just the author&#8217;s metaphorical downfall but literall downfall of their head from their shoulders on &#8220;Tower hill green&#8221;, when even Queen&#8217;s were not safe from such fates.</p>
<p>Indead it&#8217;s been suggested more than a few times that this fate happened to Christopher Marlowe. He was warranted to appear befor the Queen&#8217;s Privy councill but there is no record of him actually attending. Effectively on charges of atheism. Which at that time was a charge of such seriousness to be the equivalent of treason. This was because the previous English monarch Henry VIII after his reforms had made himself thus all subsequent English monarchs the head of the Church of England. So to be against the church was, to be against the monarch, ergo treason for which there could only be one fate &#8220;Death by the Monarchs command&#8221; or execution. As atheism is a charge easy to fabricate and well neigh impossible to defend against, it was also used as an effective way &#8220;to deal with the politically troublesome&#8221;.</p>
<p>But Marlowe&#8217;s story then gets very curious, just days later, a man of distinct ill repute one Ingram Frizer who&#8217;s &#8220;master&#8221; was Thomas Walsingham stabbed Christopher Marlowe to death in the home of Eleanor Bull. Also in attendance were Nicholas Skeres and Robert Poley, both of whom along with Christopher Marlowe and Thomas Walsinghan had been associated with Sir Francis Walsingham&#8217;s earlier intelligence operations that led to the execution of Mary Queen of Scots, by Queen Elizabeth the 1st of England. Of note is that Robert Poley was a member of the Privy Council and would certaibly have known of the warrant against Marlowe. More currious as &#8220;murder was done&#8221; nobody paid with their neck, in fact the Queen pardoned Frizer a short while later.</p>
<p>If the fatal stabbing was connected to Marlowe&#8217;s allegrd arrest warant remains unknown, however it has been pointed out that it might have been &#8220;Expedient for the Crown&#8221; to have him dealt with this way rather than by trial etc. Some believe Christopher Marlowe as both a philosopher-scientist and translator of some repute was also a member of what would have been Queen Elizabeth&#8217;s &#8220;black chamber&#8221; responsible for amongst other things cryptography. Thus he probably had a lot of secrets in his head that might easily come out at trial including what some have indicated was the fabrication of evidence and the setting up of Mary Queen of Scotts for her execution.</p>
<p>Here the story divides between two different theories, which depend on what Christopher Marlowe might have been upto. He along with a number of others including Sir Walter Raleigh were members of a group of what were later called &#8220;The School of Atheism&#8221; and also &#8220;The School of Night&#8221;. Was he there as friend or spy?</p>
<p>Why would Marlowe be suspected of talking? Well one theory is that Marlowe was &#8220;friend&#8221; to Sir Walter Raleigh had &#8220;fallen out of favour&#8221; with the Earl of Essex who was plotting Sir Walter&#8217;s down fall and it has been suggested Marlowe was aware of this and was going to warn Sir Walter. Thus the meeting at the house was to purswade Marlowe not to talk, it went failed and Marlowe was stabbed in the eye, whilst Friezr had very minor wounds, possibly as a cover story.</p>
<p>The other theory is Marlowe was &#8220;spy&#8221; thus had to &#8220;disappear&#8221; so that the others could be executed. Thus Marlowe&#8217;s death was faked and Marlowe assumed a new identity and became the oh so secretive William Shakespeare&#8230; Who in the Merry Wives of Windsor also writes of Mephistophilis.</p>
<p>Of interest both Marlowe and Shakespeare were both realy bad spellers of words, often using three different spellings of the same word on a single page&#8230; Not that anyone actually cared back in Elizabethan times where &#8220;the spoken word was King&#8221; as it were 😉</p>
<p>And people think history is &#8220;Oh so dull&#8221;, but the story pales in comparison to what followed, you should see the venomous behaviour between the two theory followers, it&#8217;s downright &#8220;Crossed words and pens at dawn&#8221; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334649">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334649">
						April 9, 2019 9:11 PM					</a>

				</p>

				<p>I have a fairly obvious question. Is Ghidra a Trojan in any way?</p>
<p>That would be from the initial download of the zip file to installing and using it. Has anyone seen any Indicators of Compromise (IOC)?</p>
<p>Has anybody done pcaps on it to see if there is something nasty entering or leaving their machine?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334650">

			<div class="comment by-wiley ">

				<p class="commentcredit">

					<span class="commenter">wiley</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334650">
						April 10, 2019 1:38 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>There very well may be more to it, but it&#8217;s almost certainly not backdoored. Are there extant bugs which were not fixed in the public release? Perhaps, but bugdoors of that sort can be a lot harder to exploit than the stereotypical network-based backdoors that everyone fantasizes about. You aren&#8217;t going to run Ghidra and suddenly see it scan your filesystem and upload everything it can to some Russian mailserver-turned-C2 pwnt by TAO. That kind of silly thinking is why people need to learn how to create less ridiculous threat models. The NSA (and anyone else in FVEY/SSEUR or involved in the greater IC) sure like dragnet surveillance, and they sure like targeted, precision attacks against their victims&#8217; networks, but they aren&#8217;t going to use all of the same exact techniques for both.</p>
<p>@65535</p>
<p>It&#8217;s too early to tell given that the source code was just released, but I&#8217;d wager that it is not. As I mentioned earlier, that would be downright silly for them to do that. You should be more worried about bugdoors in your system malloc or your router&#8217;s Netfilter implementation than you should be about some new FOSS disassembler. In 20 years, assuming Ghidra becomes the dominant FOSS disassembler, will join the ranks of SELinux (NSA), onion routing (Navy), and the computer mouse (DARPA) as having potentially ugly sources but no longer having any actual ties to them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334651">

			<div class="comment by-jonathan-wilson ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Wilson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334651">
						April 10, 2019 6:03 AM					</a>

				</p>

				<p>Just because its not as good as IDA pro right now doesn&#8217;t mean it can&#8217;t be as good as IDA pro in the future.<br />
With the full source code available, anyone with the skills can improve the UI or the decompiler or any other parts of the program and make their changes available for everyone to use.</p>
<p>If there is a feature in IDA that is keeping you from using Ghidra, write some code or submit a request. For example Ghidra doesn&#8217;t have a debugger right now but there is no reason someone can&#8217;t write one and contribute it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334652">

			<div class="comment by-mj ">

				<p class="commentcredit">

					<span class="commenter">MJ</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334652">
						April 10, 2019 9:08 PM					</a>

				</p>

				<p>The most significant feature that Ghidra brings to the table that IDA does not is collaboration.</p>
<p>Ghidra allows for multiple users to annotate and modify disassembled files and provides a way for them to version control the annotated disassembly.  That is a significant game changer that matters substantially when you have a team of reverse engineers working in a collaborative fashion to reverse a set of binaries from a target system.</p>
<p>Another key thing about the collaborative ability is that users can define and share struct information across binaries in the project and the struct stuff is also version controlled.</p>
<p>Another important thing is that Ghidra allows newcomers to the field (e.g. college students) to sharpen RE skills on a very powerful tool. One of the historic bottlenecks for newcomers is the barrier to entry being the cost of IDA Pro.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334653">

			<div class="comment by-faustus ">

				<p class="commentcredit">

					<span class="commenter">Faustus</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334653">
						April 11, 2019 12:46 PM					</a>

				</p>

				<p>@ wiley</p>
<blockquote><p>You aren&#8217;t going to run Ghidra and suddenly see it scan your filesystem and upload everything it can to some Russian mailserver-turned-C2 pwnt by TAO.</p></blockquote>
<p>Of course you won&#8217;t see an obvious scan from Ghidra.  That would be ineffective and unnecessary.  Number one, you are already loading into Ghidra a lot of what the NSA is looking for: whatever program you are trying to analyze, hack or subvert.  Besides that there are a million ways to surreptitiously gather information from a system.  Or perhaps subvert the effectiveness of encryption on that machine.  Or communicate with hardware or software implants through side channels. And, as we see often with malware, certainly most spying functionality would remain dormant until it was activated by the NSA&#8217;s targeting criteria.</p>
<p>The NSA has publicly stated that its goal is to gather everything.  From the Snowden incident we know that it lies to the American people and is unembarassed when those lies are revealed.  We also know it targeted sysadmins.  Targeting security researchers and hackers is an obvious extension of this.</p>
<p>I&#8217;m not sure if you are simply new to the game, resistant to learning or actually working for the NSA.</p>
<p>The NSA must have social media sock puppets.  Isn&#8217;t it likely they are among us?</p>
<p>In the first case you might want to check out the excellent cyber security classes from University of Maryland on Coursera.  The hardware security class includes really interesting material on hardwire backdoors.</p>
<p>If you think it is I that is resistant to learning perhaps you could flesh out your reasoning beyond saying it is silly for the NSA to do what it has already been caught doing many times?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334654">

			<div class="comment by-wiley ">

				<p class="commentcredit">

					<span class="commenter">wiley</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334654">
						April 12, 2019 3:43 PM					</a>

				</p>

				<p>@Faustus</p>
<p>I&#8217;m honored that you think I might be an NSA sock puppet. Sadly no one is paying me to post on security blogs. It&#8217;s all done in my free time.</p>
<p>I understand the intelligence community well (though perhaps not as well as Clive here), and I know how they operate. I also know that releasing malware in something with their name on it would be the most foolish thing they could possibly do. It would be safer for them to backdoor IDA (you think it would be hard for them to do that if they wanted?) than to release it in something that is open source with code that thousands of people are actively reading right now.</p>
<p>It&#8217;s for the same reason that you don&#8217;t have to fear a WebKit 0day while visiting nsa.gov nearly as much as when visiting some website you&#8217;ve visited a dozen times before with no affiliation to the IC.</p>
<p>The NSA is evil, and they make mistakes, but they&#8217;re not THAT stupid.</p>
<p>So tell me this: What could the NSA possibly gain by backdooring Ghidra (which people would notice quickly) that they could not gain by other more subtle, effective, and sustainable means?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334655">

			<div class="comment by-faustus ">

				<p class="commentcredit">

					<span class="commenter">Faustus</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334655">
						April 12, 2019 5:28 PM					</a>

				</p>

				<p>@ wiley</p>
<p>&#8220;What could the NSA possibly gain by backdooring Ghidra (which people would notice quickly) that they could not gain by other more subtle, effective, and sustainable means?&#8221;</p>
<p>You are not really asking what they could gain, right?  The same advantages they get from targeting sysadmins, for example.  Additionally they could get intelligence on copyright breakers, malware writers, and security researchers on the trail of NSA hacks, among other things.</p>
<p>So, I guess you are asking why not use other means?  I&#8217;m sure the NSA is using other means.  Why shouldn&#8217;t they use this means too?  It&#8217;s not like they haven&#8217;t been caught spying before with hardly a blush on their cheeks.</p>
<p>I don&#8217;t think you understand the subtlety of side channel exfiltration of data.  If you read this blog you must be aware that there are a million ways to surreptitiously gather data and extract it.  Quite possibly it would work in conjunction with other subverted software and hardware.  Just because you don&#8217;t know how to do it doesn&#8217;t mean it can&#8217;t be done.  Just because you can&#8217;t think of how to hide it doesn&#8217;t mean it can&#8217;t be hidden.</p>
<p>Java is particularly attractive because of its platform independence.  Here is a pdf that gives copious examples of how easy it is to make rootkit code look like perfectly innocent java code: <a href="https://www.blackhat.com/presentations/bh-usa-09/WILLIAMS/BHUSA09-Williams-EnterpriseJavaRootkits-PAPER.pdf" rel="nofollow ugc">https://www.blackhat.com/presentations/bh-usa-09/WILLIAMS/BHUSA09-Williams-EnterpriseJavaRootkits-PAPER.pdf</a></p>
<p>The real question is: Why install software from an organization dedicated to spying on you?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334656">

			<div class="comment by-wiley ">

				<p class="commentcredit">

					<span class="commenter">wiley</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334656">
						April 12, 2019 6:41 PM					</a>

				</p>

				<p>@Faustus</p>
<p>I am well acquainted with side-channel attacks and covert exfiltration.</p>
<p>Ghidra is open source. Many people are reading it. Massive, dragnet spying done by this software is impossible to do undetected. You must think the NSA is really, really stupid to intentionally backdoor FOSS software that they themselves authored. Either that, or you don&#8217;t understand how any entity in the intelligence community operates.</p>
<p>And right next to your keyboard as you type this is a device invented by DARPA. Who cares? What matters is the code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334657">

			<div class="comment by-faustus ">

				<p class="commentcredit">

					<span class="commenter">Faustus</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334657">
						April 13, 2019 10:58 AM					</a>

				</p>

				<p>@ wiley</p>
<p>You don&#8217;t talk like you are familiar with side-channel attacks and covert exfiltration.  Read the pdf.  I specifically did not say dragnet spying.  Read what I wrote.</p>
<p>There are many ways to subtly introduce java code that exfiltrates data.  I gave you a pdf on it.  You just repeat the &#8220;stupid&#8221; argument.  The NSA has already been caught doing similar things, so stupid or not, there is no reason to rule it out offhand, and every reason to think they will continue as they have previously.  All they have to say is &#8220;terrorist&#8221; and 90% of people will give them a pass whatever they do.</p>
<p>With Julian Assange in the news I think back to the &#8220;Collateral Murder&#8221; video.  If soldiers laughing while they gun down innocent people does not raise many eyebrows, the complicated technical shenanigans of the NSA is even less likely to.  Most people would say: &#8220;What would you expect running NSA software?&#8221;  Exactly.</p>
<p>Anyhow, I am not trying to convince you.  I am simply countering your argument to hopefully prevent some poor kid from being put in a can for five years for screwing around.  Anybody of significance knows enough not to install this code anywhere important, or to use it on anything they want to keep confidential.</p>
<p>I don&#8217;t think the NSA is evil.  I don&#8217;t think any of the players are evil.  I don&#8217;t think the helicopter crew in &#8220;Collateral Murder&#8221; is evil.  All sides do the same things that they condemn.  The &#8220;evil&#8221; argument is simply to fool people with poor reasoning skills by engaging their emotions and overriding any intellect they can muster.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334658">

			<div class="comment by-dennis ">

				<p class="commentcredit">

					<span class="commenter">Dennis</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334658">
						April 15, 2019 3:12 AM					</a>

				</p>

				<p>@wiley wrote, &#8220;Ghidra is open source. Many people are reading it. Massive, dragnet spying done by this software is impossible to do undetected. You must think the NSA is really, really stupid to intentionally backdoor FOSS software that they themselves authored.&#8221;</p>
<p>It&#8217;s quite possible they can do a combination of things thru the various OS automatic update processes where you install it on. The FOSS itself doesn&#8217;t have to do anything at all. This is a practice commonly done on multiple marketing platforms as well. The whole world is intertwined, everything is connected and related one way or other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334659">

			<div class="comment by-wiley ">

				<p class="commentcredit">

					<span class="commenter">wiley</span> •

					<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/#comment-334659">
						April 16, 2019 11:10 PM					</a>

				</p>

				<p>@Faustus</p>
<p>As someone acquainted with the intelligence community as well as operational threat modeling (both military and industry, with an emphasis on espionage), I&#8217;m afraid your current understanding and expectations are sorely lacking. If you genuinely think that the NSA is going to put malware in an open source product that they released under their own name, then your irrational paranoia is leading you to suspect harmless objects and completely gloss over the real, serious threats. Because you don&#8217;t understand cost-benefit analysis, you project that onto your adversaries. That is a foolish mistake that will at best cause you to waste your time pondering nonsense threat models, and at worst will lead to a complete loss of your digital assets if you are ever operating in an adversarial environment of this nature with such a naive viewpoint.</p>
<p>I&#8217;m not trying to be condescending when I put it this way. This is my genuine response as someone familiar with threat actors like the NSA and how they operate. You may be convinced that I&#8217;m just some kid who thinks the world is all rosy, or you may be convinced that I&#8217;ve been hired by some &#8220;deep state&#8221; agency to discredit you personally. Neither of those are true, but you&#8217;re free to accuse me of any malevolence you wish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2019/04/ghidra_nsas_rev.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2019/04/ghidra_nsas_rev.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F04%2Fghidra_nsas_rev.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2019/04/ghidra_nsas_rev.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12009' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2019/04/friday_squid_bl_671.html" rel="prev">← Friday Squid Blogging: Fried Squid Recipe</a>		<a href="https://www.schneier.com/blog/archives/2019/04/hey_secret_serv.html" rel="next">Hey Secret Service: Don&#039;t Plug Suspect USB Sticks into Random Computers →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
