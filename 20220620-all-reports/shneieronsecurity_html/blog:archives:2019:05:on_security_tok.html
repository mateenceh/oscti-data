<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>On Security Tokens - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; On Security Tokens Comments Feed" href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12036" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12036' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F05%2Fon_security_tok.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F05%2Fon_security_tok.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12036 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12036" class="post-12036 post type-post status-publish format-standard hentry category-uncategorized tag-backups tag-keys tag-security-tokens tag-two-factor-authentication">

	<div class="article">

		<h2 class="entry">On Security Tokens</h2>
		<p>Mark Risher of Google <a href="https://medium.com/@mrisher_2499/phishing-and-security-keys-b5c8e8e26931">extols the virtues</a> of security keys:</p>
<blockquote><p>I&#8217;ll say it again for the people in the back: with Security Keys, instead of the *user* needing to verify the site, the *site* has to prove itself to the key. Good security these days is about human factors; we have to take the onus off of the user as much as we can.</p>
<p>Furthermore, this &#8220;proof&#8221; from the site to the key is only permitted over close physical proximity (like USB, NFC, or Bluetooth). Unless the phisher is in the same room as the victim, they can&#8217;t gain access to the second factor.</p>
<p>This is why I keep using words like &#8220;transformative,&#8221; &#8220;revolutionary,&#8221; and &#8220;lit&#8221; (not so much anymore): SKs basically shrink your threat model from &#8220;anyone anywhere in the world who knows your password&#8221; to &#8220;people in the room with you right now.&#8221; Huge!</p></blockquote>
<p>Cory Doctorow makes a <a href="https://boingboing.net/2019/04/10/those-fallbacks-tho.html">critical point</a>, that the system is only as good as its backup system:</p>
<blockquote><p>I agree, but there&#8217;s an important caveat. Security keys usually have fallback mechanisms &#8212; some way to attach a new key to your account for when you lose or destroy your old key. These mechanisms may also rely on security keys, but chances are that they don&#8217;t (and somewhere down the line, there&#8217;s probably a fallback mechanism that uses SMS, or Google Authenticator, or an email confirmation loop, or a password, or an administrator who can be sweet talked by a social engineer).</p>
<p>So while the insight that traditional 2FA is really &#8220;something you know and something else you know, albeit only very recently,&#8221; security keys are &#8220;Something you know and something you have, which someone else can have, if they know something you know.&#8221;</p></blockquote>
<p>And just because there are vulnerabilities in cell phone-based two-factor authentication systems doesn&#8217;t mean that they are useless. They&#8217;re still much better than traditional password-only authentication systems.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/backups/" rel="tag">backups</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/security-tokens/" rel="tag">security tokens</a>, <a href="https://www.schneier.com/tag/two-factor-authentication/" rel="tag">two-factor authentication</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html" rel="bookmark">Posted on May 1, 2019 at 6:14 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html#comments">43 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html" data-title="On Security Tokens" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-335353">

			<div class="comment by-richard ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://ulrichard.ch/blog/index.php/2018/01/21/why-i-deactivated-tesla-app-access/' rel='external nofollow ugc' class='url'>Richard</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335353">
						May 1, 2019 6:33 AM					</a>

				</p>

				<p>What do you think about cars that are secured with only a password? And that password can be reset by anyone hwo can read the owner&#8217;s emails.<br />
<a href="https://ulrichard.ch/blog/index.php/2018/01/21/why-i-deactivated-tesla-app-access/" rel="nofollow ugc">https://ulrichard.ch/blog/index.php/2018/01/21/why-i-deactivated-tesla-app-access/</a><br />
How can we get them to secure the account with FIDO U2FA or something similar?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335354">

			<div class="comment by-chuck ">

				<p class="commentcredit">

					<span class="commenter">chuck</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335354">
						May 1, 2019 6:33 AM					</a>

				</p>

				<p>It looks like the era of SMS-verification is coming to an end! Especially outside the US.</p>
<p><a href="https://techcrunch.com/2019/04/30/developers-can-now-verify-mobile-app-users-over-whatsapp-instead-of-sms/" rel="nofollow ugc">https://techcrunch.com/2019/04/30/developers-can-now-verify-mobile-app-users-over-whatsapp-instead-of-sms/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335355">

			<div class="comment by-sed-contra ">

				<p class="commentcredit">

					<span class="commenter">Sed Contra</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335355">
						May 1, 2019 6:57 AM					</a>

				</p>

				<p>What I am trying to figure out is how lotsaGs is going to use this for surveillance capitalism.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335356">

			<div class="comment by-ergo-sum ">

				<p class="commentcredit">

					<span class="commenter">Ergo Sum</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335356">
						May 1, 2019 7:06 AM					</a>

				</p>

				<p>I tend agree with both, the virtues and caveats of 2FA. And yes, SMS is still better than just a password. On the other hand, even 2FA can be vulnerable to attacks&#8230;</p>
<p>The source of this issue is the malware-infected devices that had been with us for a long time and will continue in the near future. The bad news? The compromised host and/or client device enable cyber-criminals to bypass virtually every two-factor authentication system.</p>
<p>Based on history, securing the client devices and authentication servers is not likely to take place anytime soon. In which case, replacing password with other authentication methods may provide a seemingly marginal security improvement.</p>
<p>Do we really need to replace the password authentication method now, without addressing the system vulnerabilities first?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335357">

			<div class="comment by-doug-b ">

				<p class="commentcredit">

					<span class="commenter">Doug B</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335357">
						May 1, 2019 7:49 AM					</a>

				</p>

				<blockquote><p>And just because there are vulnerabilities in cell phone-based two-factor authentication systems doesn&#8217;t mean that they are useless. They&#8217;re still much better than traditional password-only authentication systems.</p></blockquote>
<p>Unless they actually provide a single-factor way to reset a password, no?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335358">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335358">
						May 1, 2019 7:50 AM					</a>

				</p>

				<p>If you use Google&#8217;s Advanced Protection for your Gmail account, the system won&#8217;t allow you have a weak fallback option.</p>
<p>You have to associate 2 keys with the account.  I think they recommend you keep the second key in your safe deposit box.  You can also print up a list of one time codes for the account, print it up, and keep that in your box as well.</p>
<p>Obviously a magic bullet that solves every security problem does not exist, and will never exist.  And I know that Gmail is just one account, and most people won&#8217;t do this stuff.</p>
<p>But Google, at least, is trying to work figure out solid systems that users can live with.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335360">

			<div class="comment by-mike-acker ">

				<p class="commentcredit">

					<span class="commenter">Mike Acker</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335360">
						May 1, 2019 8:00 AM					</a>

				</p>

				<p>this looks like a step in the right direction</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335362">

			<div class="comment by-anders ">

				<p class="commentcredit">

					<span class="commenter">Anders</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335362">
						May 1, 2019 8:04 AM					</a>

				</p>

				<p>Security tokens are not silver bullets.<br />
It&#8217;s only a matter of time when malware adds capability<br />
to emulate those tokens in software. Once they thought that<br />
HASP dongles are also secure&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335363">

			<div class="comment by-dave-aronson ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.Codosaur.us' rel='external nofollow ugc' class='url'>Dave Aronson</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335363">
						May 1, 2019 9:09 AM					</a>

				</p>

				<p>&#8220;something you know and something else you know&#8221;?  Idjits who implement what they <em>think</em> is 2FA often make it &#8220;something you know <i>or</i> something else you know&#8221;.  I call this half-factor authentication.  (Also applicable to when this is used for a password reset.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335364">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335364">
						May 1, 2019 9:11 AM					</a>

				</p>

				<p>Since SMS (and phone calls) can be compromised, and email can also be compromised, is the combination of the two for backup key recovery any better? That is, you need something from an SMS or voice mail sent to you <em>and</em> something in an email sent to you.</p>
<p>And would those ubiquitous security questions be any better if you could specify the question and the answer both?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335365">

			<div class="comment by-cassandra ">

				<p class="commentcredit">

					<span class="commenter">Cassandra</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335365">
						May 1, 2019 9:11 AM					</a>

				</p>

				<p>Security Tokens/Keys/Dongles need to be usable by your slightly bewildered aunt who doesn&#8217;t empty garment pockets before putting them through the wash, and isn&#8217;t entirely sure which day of the week it is. Passwords are easy to understand, easy to record and copy, and easy to keep in a (familiar to the user) safe place. If one is using a password manager, then the really important master password is the one which needs adequate security for the use case.</p>
<p>Technological solutions that are not accessible to the marginalised in society (the people living with reduced physical and mental capabilities) are a powerful force for inequality.</p>
<p>The day-to-day usability of tokens/keys/dongles needs to be much improved before they become adequate replacements for passwords for many people. How do you know when you can trust the device, how do you know it is working properly, how do you make a backup, how do you replace it, can you have more than one, can you allow your spouse/partner, brother, son, niece, neighbour, nurse, tradesman etc to use it in your presence, or remotely (i.e. can you lend it to someone?)? Obvious answers are there for those familiar with how the technology works, but for the average person for which it is just a magic box that allows them to make payments or read their emails, the answers are not obvious at all. People have all sorts of strange ideas about how technology works which don&#8217;t necessarily correlate with what is secure behaviour.</p>
<p>Cassandra</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335366">

			<div class="comment by-vesselin-bontchev ">

				<p class="commentcredit">

					<span class="commenter">Vesselin Bontchev</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335366">
						May 1, 2019 9:43 AM					</a>

				</p>

				<p>Many people (even infosec experts) seem to be confused about what &#8220;two-factor authentication&#8221; (2FA) really is.</p>
<p>Let me begin with some basics. There are 3 fundamentally different ways in which a human can authenticate themselves to a computer:</p>
<ul>
<li>With something they know (password, passphrase, PIN)</li>
<li>With something they have (e.g., a smartcard)</li>
<li>With something they are (biometrics &#8211; fingerprint, face scan, palm scan, etc.)</li>
</ul>
<p>Is authenticating via password and SMS send to your phone &#8220;2FA&#8221;? No, it is <em>not</em>! While the phone itself is &#8220;something you have&#8221;, it is not the phone that performs the authentication. It is you. You learn something (e.g., a number sent by SMS to this phone) and use this &#8220;something you now know&#8221; for authentication (together with your password). The correct term for this process is not &#8220;2FA&#8221; but &#8220;2SV&#8221; &#8211; &#8220;two-step verification&#8221;. You use two instances of the same factor (&#8220;something you know&#8221;) but obtained via different ways.</p>
<p>Why is this important? Because authentication based solely on a &#8220;something you know&#8221; factor(s) is vulnerable to phishing. If the attacker can con you that the page of his that you&#8217;re visiting is a legitimate login page, they can steal any &#8220;something you know&#8221; information that you enter for authentication purposes and use it themselves. The only inconvenience (to the attacker) that 2SV introduces is that the second step sent to the phone usually expires soon (in a few minutes) and is different each time, so it cannot be stored and used for a long time in the future. But this isn&#8217;t really the problem, because the attacker can easily automate the process of token stealing and immediate use.</p>
<p>Now, while most people are aware that SMS-based authentication is insecure because of this (and because of other flaws, like SS7, but let&#8217;s not get into this right now), they are usually quite surprised to learn that things like Google Authenticator running on your smart phone have exactly the same problem. The aren&#8217;t 2FA; they are 2SV and are vulnerable to phishing. Hardware tokens that display different numbers at the press of a button (like the RSA Token) suffer from exactly the same problem. Using them is not 2FA; it is 2SV.</p>
<p>This isn&#8217;t to say that a smart phone cannot be used properly for 2FA. However, for this purpose it is the device (the phone) that must perform the authentication &#8211; not the user. Such protocols are Apple Pay, SQRL, and others.</p>
<p>If you want to use real 2FA to authenticate yourself to web sites, use YubiKey or anything else that implements the U2F or FIDO protocol.</p>
<p>Note that contemporary &#8220;chip-and-pin&#8221; cards also use 2FA. The first factor (something you know) is the PIN and the second factor (something you have) is the chip on the card that performs the authentication.</p>
<p>Also note that the security even of proper 2FA depends very much on the threat model. For instance, proper 2FA would be authentication based on PIN (something you know) and a scan of your face (something you are). But this won&#8217;t withstand an attacker that can beat the PIN out of you and force you to look at the device for a face scan.</p>
<p>P.S. The 3 different authentication factors are also jokingly known as</p>
<ul>
<li>Something you forgot</li>
<li>Something you left in the taxi</li>
<li>Something that can be chopped off</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335367">

			<div class="comment by-justinacolmena ">

				<p class="commentcredit">

					<span class="commenter">justinacolmena</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335367">
						May 1, 2019 10:09 AM					</a>

				</p>

				<p>Two-Factor Authentication is a waste of time when the two factors are in cahoots with each other, which is always the case with proprietary dongles and tokens.</p>
<p><b>Engineered obsolescence</b> is the law enforced by owners and operators of every chip fab and foundry.</p>
<ol>
<li>You must play the game.
</li>
<li>You are not allowed to win.
</li>
<li>You are not allowed to break even.
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335368">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon====</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335368">
						May 1, 2019 10:13 AM					</a>

				</p>

				<blockquote>
<ul>
<li>Something you forgot
</li>
<li>Something you left in the taxi
</li>
<li>Something that can be chopped off</li>
</ul>
</blockquote>
<p>Do we need an iris or retina scan, too?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335369">

			<div class="comment by-mare ">

				<p class="commentcredit">

					<span class="commenter">mare</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335369">
						May 1, 2019 10:28 AM					</a>

				</p>

				<p>I can&#8217;t understand the resentments against security tokens, though.<br />
Sure they are not silverbullets. There are actually no silverbullets. Security is always and always will be a trade off (that can be improved over time).</p>
<p>But, in my humble opinion, security tokens are the best approximation we have found so far.</p>
<p>Because the tasks for tokens are very simple (basically only holding a key, encryption and decryption), security tokens can have very simple architectures, that can easily be peer reviewed, if wished. (Of course, not all of them have simple and peer reviewed architectures).</p>
<p>If you don&#8217;t trust any particular vendor you can combine different vendors (2FA-nFa) to gain more trust.</p>
<p>Our multi-purpose laptops (I dont trust my laptop, do you) can keep their complicated layered (and unsecurable by design) architectures which are the source of so many of todays security-nightmares. But only if we outsource all our encryption and authentication to security tokens and let the multi-purpose computers do the other tasks.</p>
<p>Best of all, the Metaphor of keys for a door lock work quite understandable and transparent on security tokens. For most people, even grandma.</p>
<p>Of course, they need to be supported much more by websites as they are now. And of course in a standarized way (e.g. FIDO2 and Webauthn).<br />
The standarization by the W3C seems to be very promising for the not very far future.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335370">

			<div class="comment by-leon ">

				<p class="commentcredit">

					<span class="commenter">Leon</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335370">
						May 1, 2019 10:34 AM					</a>

				</p>

				<p>To me the big problem is that we (as an IT industrie) seem to believe that we must fix the user. Because the user does not have to think for hem/her/&#8230;/ self.</p>
<p>Compare this to the lock on your frontdoor. Must people now nowadays what a good lock is and what isn’t. And that more security is more expensive. Sidenote: And of course there is a small group that would believe a “best lock for cheap” ad.</p>
<p>In the middle-ages people believed that a simple key was enough.</p>
<p>So it is about education. And Value for money.</p>
<p>Back to IT.</p>
<p>We should educate people (and site owners). Especially younger generations would easily grasp the concepts.<br />
And yes, there will always be a group that is not able to grasp it, just as with the doorlock. Please stop focussing on this group.<br />
We are moving from the “middle ages” to a digitized society, education should be part of this.</p>
<p>For your info: in my country (Netherlands) this IS done by campagains  like How to bank safely (“check three times”) and Safe Passwords use</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335371">

			<div class="comment by-leon ">

				<p class="commentcredit">

					<span class="commenter">Leon</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335371">
						May 1, 2019 11:06 AM					</a>

				</p>

				<p>Oh, and of course for Banking more advanced 2FA is needed than for a trivial site.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335372">

			<div class="comment by-sfa ">

				<p class="commentcredit">

					<span class="commenter">SFA</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335372">
						May 1, 2019 11:46 AM					</a>

				</p>

				<p>@bruce and others,</p>
<p>Are you aware that Google Titan Security Keys are not sold on the Google Store in Canada, and presumably many other countries? Yes, grey market resellers exist but this is not trustworthy.</p>
<p>Also, Google&#8217;s Advanced Protection Program requires Titan keys so presumably this is also not an option for people without a US address.</p>
<p>Any idea what the story is behind this?</p>
<p>Thanks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335373">

			<div class="comment by-anders ">

				<p class="commentcredit">

					<span class="commenter">Anders</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335373">
						May 1, 2019 1:11 PM					</a>

				</p>

				<p>@Vesselin Bontchev</p>
<p>You are forgotting fourth factor &#8211; location.<br />
This has been used also for ages. Some PDP-11 terminals<br />
could be privileged. Novell Netware allowed locking user<br />
login to specific workstation. Etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335374">

			<div class="comment by-petre-peter ">

				<p class="commentcredit">

					<span class="commenter">Petre Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335374">
						May 1, 2019 4:30 PM					</a>

				</p>

				<p>We have made progress. There is no  doubt that I am more secure with a password than I would&#8217;ve been without a password. Two factor vs two step authentication is something I didn&#8217;t pay attention to, especially if different channeles are used for different factors or steps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335375">

			<div class="comment by-q ">

				<p class="commentcredit">

					<span class="commenter">Q</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335375">
						May 1, 2019 4:30 PM					</a>

				</p>

				<p>You know, when I lock myself out of my house &amp; lose my key, a locksmith can let me back in and rekey my locks.  Mind you, he doesn&#8217;t want to go to jail for burglary.  So he&#8217;s going to want some verification that I am who I say I am.</p>
<p>We should find a way to reuse this model for Security Keys.  We really need the physical visit part, and government issued ID part.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335376">

			<div class="comment by-drone ">

				<p class="commentcredit">

					<span class="commenter">Drone</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335376">
						May 1, 2019 5:39 PM					</a>

				</p>

				<p>&#8220;Unless the phisher is in the same room as the victim, they can&#8217;t gain access to the second factor.&#8221;</p>
<p>You bet the enemy is in the same room with you, it&#8217;s living inside your computer just waiting for you to plug that &#8220;security&#8221; dongle in &#8211; so it can read it and mimic it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335377">

			<div class="comment by-anders ">

				<p class="commentcredit">

					<span class="commenter">Anders</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335377">
						May 1, 2019 5:54 PM					</a>

				</p>

				<p>@Drone</p>
<p>Sometimes it&#8217;s dead easy. Let&#8217;s take Estonian ID card into the consideration.<br />
As long as the the victim has ID card in the reader (lot of people<br />
keep it there constantly) and the reader is without physical keypad (again<br />
very common situation), all you need is RAT with keylogger capabilities.<br />
You capture ID card two PIN&#8217;s and game over.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335378">

			<div class="comment by-impossibly-stupid ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.impossiblystupid.com' rel='external nofollow ugc' class='url'>Impossibly Stupid</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335378">
						May 1, 2019 6:28 PM					</a>

				</p>

				<p>@Andrew</p>
<blockquote><p>And would those ubiquitous security questions be any better if you could specify the question and the answer both?</p></blockquote>
<p>Yes, to the extent that the number of bits each question represents as a challenge is much larger than the ~3 bits that are usually present for a pre-made list.  Regardless, your response to the challenge should <em>never</em> be some basic fact about your life that is easy to find and/or shared by many sites.  Always give them a random string with enough bits to satisfy your needs for security (e.g., a UUID).</p>
<p>@Vesselin Bontchev</p>
<blockquote><p>Many people (even infosec experts) seem to be confused about what &#8220;two-factor authentication&#8221; (2FA) really is.</p></blockquote>
<p>Worse, they use 2FA, or other protocols, in ways that completely negate their purpose.  The greatest sin, as the article points out, is that the second communication channel is collapsed into a single channel, and/or there is no unique challenge that prompts the response.  It&#8217;s simply too easy to sit in the middle of any authentication process that boils down to just sending information to an HTTP(S) server.</p>
<blockquote><p>Is authenticating via password and SMS send to your phone &#8220;2FA&#8221;? No, it is not!</p></blockquote>
<p>It <em>could</em> be if the protocol was more than just &#8220;now also send me the code I just texted you&#8221;.  Again, the real issue that needs to be addressed is that the server connection can be spoofed.</p>
<blockquote><p>You use two instances of the same factor (&#8220;something you know&#8221;) but obtained via different ways.</p></blockquote>
<p><em>All</em> factors reduce to &#8220;something you know&#8221; when they are used as nothing more than digitized information that is sent in one direction over one communications channel.  That&#8217;s why biometrics are such a silly choice for remote authentication.</p>
<blockquote><p>Also note that the security even of proper 2FA depends very much on the threat model.</p></blockquote>
<p>Indeed.  And I&#8217;m not even sure what threat Google thinks is significant enough to try to impose yet another dongle solution.  There are all sorts of approaches that implement &#8220;the <em>site</em> has to prove itself to the key&#8221; that don&#8217;t involve that added expense/complexity.  I&#8217;ve personally never been phished, mainly because my first step in registering an account with a site is to give them a unique email address (and, notably, one not controlled by Google).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335379">

			<div class="comment by-silent ">

				<p class="commentcredit">

					<span class="commenter">Silent</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335379">
						May 1, 2019 9:00 PM					</a>

				</p>

				<p>@SFA</p>
<p>Google&#8217;s Advanced Protection program may promote their Titan security keys but they do not require them. Any U2F/FIDO2 security can be used to secure your account.</p>
<p>@Drone</p>
<p>They way the security keys are setup, there should be nothing that can be read from the device via USB that would compromise the security of the system. The private keys remain inaccessible to whatever you plug the security key into.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335380">

			<div class="comment by-richard ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.linkedin.com/in/richardwestseattle/' rel='external nofollow ugc' class='url'>Richard</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335380">
						May 2, 2019 1:10 AM					</a>

				</p>

				<p>I like tokens, and other authentication factors like biometrics, smart cards, location-and behavior-based, etc. Passwords alone are mostly useless, and when passwords are replaced entirely with other factors, things will be much more well protected [and usable]. Until that happens, hopefully we can end password-reset links sent by email&#8230; and if were lucky, email too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335381">

			<div class="comment by-jon-doe ">

				<p class="commentcredit">

					<span class="commenter">Jon Doe</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335381">
						May 2, 2019 4:29 AM					</a>

				</p>

				<p>Well, I have a little story here about this, about 2FA, about Amazon.</p>
<p>I like many have an AWS account and I use it for my domain names and after the Linux kernel domain name hijack, where the owner had no 2FA configured, I decided it was high time I activated 2FA on my AWS account.</p>
<p>Now, your Amazon/AWS account can be the same account and for me they are.</p>
<p>I logged into my account and activated 2FA, with FreeOTP as my token generator.</p>
<p>Activation works, and I&#8217;m set.</p>
<p>Then to test the system, I log out, and log in.</p>
<p>Only, I can&#8217;t log in.</p>
<p>The 2FA code is not being accepted.</p>
<p>There&#8217;s then some text and a link indicating if this happens, you need to resynchronize.  You enter two successive codes, and then Amazon knows where you are and it all works again.</p>
<p>Well, that page wasn&#8217;t working.  I mean, <em>the page</em> wasn&#8217;t working; &#8220;internal error&#8221;.  I <em>couldn&#8217;t</em> use it.</p>
<p>The next option is a support request.  There&#8217;s a form you fill in but, crucially, you can&#8217;t send a message.  All you can do is submit the form, which indicates the 2FA device is unusable.</p>
<p>You then receive an email, telling you a couple of things which are useless, such as how to disable 2FA, as this  requires you to have a working 2FA in the first place, because you need to log into your account (the instructions were actually out of the date, too &#8211; if you searched manually on Amazon you found the correct instructions) and how to use the recovery process, which requires two forms of State ID (I only have one, a passport) and which also does not work, because it requires you to log into your account, and trying to do so brings up &#8220;internal error&#8221;, <em>and</em>, finally, if nothing else works, to phone Amazon.</p>
<p>I don&#8217;t keep a phone number.  I can&#8217;t phone them.</p>
<p>There&#8217;s no way to reply, because the email address is a no-reply address.</p>
<p>I contact customer support, normal customer support, and talk to them &#8211; who else can I talk to?</p>
<p>I eventually get an email address for the 2FA team.</p>
<p>These jokers tell me there&#8217;s nothing they can do, at all, flat out, unless I phone them.</p>
<p>At this point, activating 2FA has locked me out of my Amazon account, and there&#8217;s <em>no viable recovery mechanism</em>.</p>
<p>There&#8217;s no indication when you turn on 2FA of what you will need to recover if 2FA fails.</p>
<p>That&#8217;s interesting, compared to email based mechanisms.  With email based verification, <em>creating</em> the account is identical to <em>verifying and recovering</em> the account.  The mechanism in use is the same.  If you can receive the email to create the account, well, then you have working email and so you know (barring long term changes of email account) where the recovery mechanism is also based on email it will work.</p>
<p>This is not the case with 2FA.</p>
<p>The mechanism to activate 2FA, and to use 2FA, differ from the mechanism to recover from broken 2FA.  Three independent mechanisms.</p>
<p>It can be the first works, the second does not <em>and</em> the third does not &#8211; as was the case here.</p>
<p>When that happens, you are locked out of your account &#8211; by 2FA, which you now desperately regret ever having activated.  Death by 2FA.</p>
<p>In the end, I was able to recover &#8211; it turned out there are a second set of resynch pages on AWS, not on Amazon, <em>and they worked</em>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335382">

			<div class="comment by-michael ">

				<p class="commentcredit">

					<span class="commenter">Michael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335382">
						May 2, 2019 4:59 AM					</a>

				</p>

				<p>Correctly me if I&#8217;m wrong, this is like using a keyless entry fob for automobiles, except that we must buy this fob from a third party manufacturer, and then you gotta attach your online identity to this fob via some sort of activation process? How is this different from a cellphone sim card?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335383">

			<div class="comment by-dennis ">

				<p class="commentcredit">

					<span class="commenter">Dennis</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335383">
						May 2, 2019 5:37 AM					</a>

				</p>

				<p>@Jon Doe wrote, &#8220;The 2FA code is not being accepted.&#8221;</p>
<p>The 2FA/2SV code process is often coupled with some sort of analytical intelligence based on geography and many other factors, commonly seen in &#8220;anti-fraud&#8221; technology. Sites who employ this technique already filter your logins based on your location and other statistics. I&#8217;m not so sure if this is any less inconvenient.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335384">

			<div class="comment by-sfa ">

				<p class="commentcredit">

					<span class="commenter">SFA</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335384">
						May 2, 2019 6:58 AM					</a>

				</p>

				<p>Thank you @silent</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335385">

			<div class="comment by-vas-pup ">

				<p class="commentcredit">

					<span class="commenter">vas pup</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335385">
						May 2, 2019 11:17 AM					</a>

				</p>

				<p>Kind of related to the subject</p>
<p>Half a face enough for recognition technology:<br />
<a href="https://www.sciencedaily.com/releases/2019/05/190501114602.htm" rel="nofollow ugc">https://www.sciencedaily.com/releases/2019/05/190501114602.htm</a></p>
<p>&#8220;Using artificial intelligence techniques, the team achieved 100 per cent recognition rates for both three-quarter and half faces. The study, published in Future Generation Computer Systems, is the first to use machine learning to test the recognition rates for different parts of the face.&#8221;</p>
<p>&#8220;We&#8217;ve now shown that it&#8217;s possible to have very accurate facial recognition from images that only show part of a face and we&#8217;ve identified which parts are most useful. This opens up greater possibilities for the use of the technology for security or crime prevention.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335386">

			<div class="comment by-xyz_ ">

				<p class="commentcredit">

					<span class="commenter">xyz_</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335386">
						May 2, 2019 12:54 PM					</a>

				</p>

				<p>&#8220;with Security Keys, instead of the <em>user</em> needing to verify the site, the <em>site</em> has to prove itself to the key.&#8221;</p>
<p>Can anyone explain me how the site proves itself to yubikey with U2F?<br />
U2F is just typical challenge-response protocol. I receive phishing e-mail, there&#8217;s link to false login page. I click it. Phishing site uses MITM and connects to real page, takes real page challenge, forwards to me, my yubikey happily signs it, this is forwarded to phishing page and from there bad guys log in to real page with signed challenge. What i&#8217;m missing?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335387">

			<div class="comment by-xyz_ ">

				<p class="commentcredit">

					<span class="commenter">xyz_</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335387">
						May 2, 2019 1:43 PM					</a>

				</p>

				<p>I don&#8217;t see any protection here against MITM and that site somehow &#8220;proves&#8221; itself.</p>
<p><a href="https://developers.yubico.com/U2F/" rel="nofollow ugc">https://developers.yubico.com/U2F/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335388">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335388">
						May 2, 2019 3:29 PM					</a>

				</p>

				<p>@xyz_<br />
&#8220;What i&#8217;m missing?&#8221;</p>
<p>Um &#8230;httpS ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335389">

			<div class="comment by-xyz_ ">

				<p class="commentcredit">

					<span class="commenter">xyz_</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335389">
						May 2, 2019 4:14 PM					</a>

				</p>

				<p>@CallMeLateForSupper</p>
<p>What&#8217;s your point? That yubikey knows real server certificate?<br />
How?</p>
<p>There&#8217;s two completely separate https sessions:</p>
<ol>
<li>from my browser to fake login page</li>
<li>from fake login page to real server</li>
</ol>
<p>As long as there&#8217;s green padlock, noone really pays attention<br />
to the fake certificate minor spelling quirks. That&#8217;s the phishing<br />
purpose, making people to believe.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335390">

			<div class="comment by-erdem-memisyazici ">

				<p class="commentcredit">

					<span class="commenter">Erdem Memisyazici</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335390">
						May 2, 2019 7:47 PM					</a>

				</p>

				<p>Indeed, also don&#8217;t mistake using a YubiKey to partially complete a password with a lengthy random static string for &#8220;something you have&#8221;.  That&#8217;s still something you know, even though you don&#8217;t have it memorized and it&#8217;s in your token.</p>
<p>Speaking of YubiKey I have this guy installed on my laptop <a href="https://developers.yubico.com/pam-u2f/" rel="nofollow ugc">https://developers.yubico.com/pam-u2f/</a> and I very much enjoy it in a medium level security setup.  Keeps the people who peer over your shoulder to see your password away.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335391">

			<div class="comment by-mrc ">

				<p class="commentcredit">

					<span class="commenter">MrC</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335391">
						May 3, 2019 1:29 AM					</a>

				</p>

				<p>@ xyz_:<br />
TLS authenticates the webpage to the browser.<br />
The browser <em>tells</em> the yubikey what domain the request is from.<br />
The yubikey will only sign a request if the domain passed from the browser exactly matches the one previously passed by the browser at key generation time.</p>
<p>So, an ordinary phishing attempt using a lookalike url (e.g., g00gle.com instead of google.com) will fail, even if the bogus site has its own TLS certificate, because the browser will truthfully pass g00gle.com to the yubikey and the yubikey will say, &#8220;I don&#8217;t have a private key for g00gle.com -&gt; fail.&#8221;</p>
<p>An attacker can still subvert u2f if they can fool the browser by subverting TLS (plus subverting DNS or routing) or they can compromise the browser to make it lie to the yubikey. But that&#8217;s a huge step up from run-of-the-mill phishing attacks. (Also, the compromise-the-browser attack is probably a &#8220;you&#8217;re already screwed&#8221; situation, so it arguably doesn&#8217;t count.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335392">

			<div class="comment by-xyz_ ">

				<p class="commentcredit">

					<span class="commenter">xyz_</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335392">
						May 3, 2019 3:15 AM					</a>

				</p>

				<p>@MrC</p>
<p>So yubikey stores domain inside the key and this is<br />
associated with each different priv key? I thought this was<br />
FIDO2, where each site has it&#8217;s own private/public key pair?</p>
<p>But if something is possible to write to the inside of<br />
the key, it could be also altered.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335393">

			<div class="comment by-silent ">

				<p class="commentcredit">

					<span class="commenter">Silent</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335393">
						May 3, 2019 8:25 PM					</a>

				</p>

				<p>@xyz_</p>
<p>The key pairs are generated and used as needed on the security key itself. Thus the security key itself does not need any permanent storage for things like domains, keys, etc.</p>
<p>The reason it would be unable to be phished is that when the attacker retrieves the key information from the real login page, the domain the registration took place on is part what was used to generate the key pair used for authentication. The phisher&#8217;s site (the one visible to the user and sent from the browser to the security key) would not have the same information so the security key would be unable to use that key for a different site such as the phishing site.</p>
<p>More information, including very helpful diagrams, can be found here:<br />
<a href="https://developers.yubico.com/U2F/Protocol_details/Overview.html" rel="nofollow ugc">https://developers.yubico.com/U2F/Protocol_details/Overview.html</a><br />
<a href="https://developers.yubico.com/U2F/Protocol_details/Key_generation.html" rel="nofollow ugc">https://developers.yubico.com/U2F/Protocol_details/Key_generation.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335394">

			<div class="comment by-toms ">

				<p class="commentcredit">

					<span class="commenter">TomS.</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335394">
						May 16, 2019 9:05 PM					</a>

				</p>

				<p>Google Security Advisory: Bluetooth Low Energy Titan Security Key</p>
<p><a href="https://security.googleblog.com/2019/05/titan-keys-update.html" rel="nofollow ugc">https://security.googleblog.com/2019/05/titan-keys-update.html</a></p>
<p>&#8220;Due to a misconfiguration in the Titan Security Keys’ Bluetooth pairing protocols, it is possible for an attacker who is physically close to you at the moment you use your security key &#8212; within approximately 30 feet &#8212; to (a) communicate with your security key, or (b) communicate with the device to which your key is paired.&#8221;</p>
<p>&#8220;This issue affects the BLE version of Titan Security Keys. To determine if your key is affected, check the back of the key. If it has a “T1” or “T2” on the back of the key, your key is affected by the issue and is eligible for free replacement.&#8221;</p>
<p>Dark Reading links the Titan Security Key to FEITIAN Technologies<br />
<a href="https://www.darkreading.com/endpoint/google-to-replace-titan-security-keys-affected-by-bluetooth-bug/d/d-id/1334742" rel="nofollow ugc">https://www.darkreading.com/endpoint/google-to-replace-titan-security-keys-affected-by-bluetooth-bug/d/d-id/1334742</a><br />
<a href="https://www.ftsafe.com/replacement/" rel="nofollow ugc">https://www.ftsafe.com/replacement/</a></p>
<p>No CVE&#8217;s are given in any of the posts or websites.  Dark Reading&#8217;s report credits Microsoft with the original discovery.  I haven&#8217;t found any original research posted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335395">

			<div class="comment by-jeff-birks ">

				<p class="commentcredit">

					<span class="commenter">jeff birks</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335395">
						June 25, 2019 12:54 PM					</a>

				</p>

				<p>We always talk about the user authenticating himself to the site/app, and forget it is just a important that the site/app provides authentication too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-335396">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335396">
						June 25, 2019 1:44 PM					</a>

				</p>

				<p>@ jeff birks,</p>
<blockquote><p>We always talk about the user authenticating himself to the site/app, and forget it is just a important that the site/app provides authentication too.</p></blockquote>
<p>And people also forget that it&#8217;s each and every transaction that should be authenticated not just the communications channel.</p>
<p>Also the authentication must go borh ways through the user and the token must not communicate in any way except through the Hunan UI and that it should not be upgradable &#8220;in the field&#8221;.</p>
<p>I&#8217;ve been saying this from the last century, but people are only just taking it on board&#8230; A quater century and counting to do the basics of security right and still not being even close should tell you quite a lot about why the industry is a failure except when it comes to making profit&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-335397">

			<div class="comment by-sfa ">

				<p class="commentcredit">

					<span class="commenter">SFA</span> •

					<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/#comment-335397">
						August 13, 2019 8:42 PM					</a>

				</p>

				<p>As of July 31, Google&#8217;s Titan Security Keys are now available in Japan, France, UK, and Canada:<br />
<a href="https://gsuiteupdates.googleblog.com/2019/07/titan-security-key-expansion.html" rel="nofollow ugc">https://gsuiteupdates.googleblog.com/2019/07/titan-security-key-expansion.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2019/05/on_security_tok.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2019/05/on_security_tok.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F05%2Fon_security_tok.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2019/05/on_security_tok.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12036' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2019/04/defending_democ.html" rel="prev">← Defending Democracies Against Information Attacks</a>		<a href="https://www.schneier.com/blog/archives/2019/05/why_isnt_gdpr_b.html" rel="next">Why Isn&#039;t GDPR Being Enforced? →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
