<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Thangrycat: A Serious Cisco Vulnerability - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Thangrycat: A Serious Cisco Vulnerability Comments Feed" href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12074" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12074' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F05%2Fthangrycat_a_se.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F05%2Fthangrycat_a_se.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12074 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12074" class="post-12074 post type-post status-publish format-standard hentry category-uncategorized tag-cisco tag-hardware tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">Thangrycat: A Serious Cisco Vulnerability</h2>
		<p><a href="https://thrangrycat.com/">Summary</a>:</p>
<blockquote><p>Thangrycat is caused by a series of hardware design flaws within Cisco&#8217;s Trust Anchor module. First commercially introduced in 2013, Cisco Trust Anchor module (TAm) is a proprietary hardware security module used in a wide range of Cisco products, including enterprise routers, switches and firewalls. TAm is the root of trust that underpins all other Cisco security and trustworthy computing mechanisms in these devices. Thangrycat allows an attacker to make persistent modification to the Trust Anchor module via FPGA bitstream modification, thereby defeating the secure boot process and invalidating Cisco&#8217;s chain of trust at its root. While the flaws are based in hardware, Thangrycat can be exploited remotely without any need for physical access. Since the flaws reside within the hardware design, it is unlikely that any software security patch will fully resolve the fundamental security vulnerability.</p></blockquote>
<p>From a <a href="https://www.nytimes.com/2019/05/21/opinion/internet-security.html">news article</a>:</p>
<blockquote><p>Thrangrycat is awful for two reasons. First, if a hacker exploits this weakness, they can do whatever they want to your routers. Second, the attack can happen remotely Â­ it&#8217;s a software vulnerability. But the fix can only be applied at the hardware level. Like, physical router by physical router. In person. Yeesh.</p>
<p>That said, Thrangrycat only works once you have administrative access to the device. You need a two-step attack in order to get Thrangrycat working. Attack #1 gets you remote administrative access, Attack #2 is Thrangrycat. Attack #2 can&#8217;t happen without Attack #1. Cisco can protect you from Attack #1 by sending out a software update. If your I.T. people have your systems well secured and are applying updates and patches consistently and you&#8217;re not a regular target of nation-state actors, you&#8217;re relatively safe from Attack #1, and therefore, pretty safe from Thrangrycat.</p>
<p>Unfortunately, Attack #1 is a garden variety vulnerability. Many systems don&#8217;t even have administrative access configured correctly. There&#8217;s opportunity for Thrangrycat to be exploited.</p></blockquote>
<p>And from <a href="https://boingboing.net/2019/05/22/introspection-engines.html">Boing Boing</a>:</p>
<blockquote><p>Thangrycat relies on attackers being able to run processes as the system&#8217;s administrator, and Red Balloon, the security firm that disclosed the vulnerability, also revealed a defect that allows attackers to run code as admin.</p>
<p>It&#8217;s tempting to dismiss the attack on the trusted computing module as a ho-hum flourish: after all, once an attacker has root on your system, all bets are off. But the promise of trusted computing is that computers will be able to detect and undo this kind of compromise, by using a separate, isolated computer to investigate and report on the state of the main system (Huang and Snowden call this <a href="https://boingboing.net/2017/09/08/impaired-judgment-phones.html">an introspection engine</a>). Once this system is compromised, it can be forced to give false reports on the state of the system: for example, it might report that its OS has been successfully updated to patch a vulnerability when really the update has just been thrown away.</p>
<p>As Charlie Warzel and Sarah Jeong <a href="https://www.nytimes.com/2019/05/21/opinion/internet-security.html">discuss in the New York Times</a>, this is an attack that can be executed remotely, but can only be detected by someone physically in the presence of the affected system (and only then after a very careful inspection, and there may still be no way to do anything about it apart from replacing the system or at least the compromised component). </p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cisco/" rel="tag">Cisco</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html" rel="bookmark">Posted on May 23, 2019 at 11:52 AM</a>			â¢
			<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html#comments">27 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html" data-title="Thangrycat: A Serious Cisco Vulnerability" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-336533">

			<div class="comment by-steven-clark ">

				<p class="commentcredit">

					<span class="commenter">Steven Clark</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336533">
						May 23, 2019 12:13 PM					</a>

				</p>

				<p>An FPGA-based root of trust? Reading it&#8217;s bitstream from SPI flash?  Isn&#8217;t some bit of OTP at the base of the root of trust standard best practice?  I&#8217;d say I&#8217;m surprised but these are the people who hardwire SSH keys after all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336534">

			<div class="comment by-albert ">

				<p class="commentcredit">

					<span class="commenter">albert</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336534">
						May 23, 2019 3:33 PM					</a>

				</p>

				<p>Why not?</p>
<p>We already give users* the ability to remotely reprogram flash memory, why not make the FPGA available too? Let&#8217;s invite everyone to the party.</p>
<hr />
<p>*by users, I mean anyone who can get admin access.<br />
. .. . .. &#8212; &#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336535">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336535">
						May 23, 2019 4:30 PM					</a>

				</p>

				<p>Can anyone show that the Apple Secure Enclave is not exploitable in similar manner?</p>
<p>(I expect crickets)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336536">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336536">
						May 23, 2019 8:30 PM					</a>

				</p>

				<p>@ Bruce,</p>
<p>This &#8220;two step&#8221; approach is exactly the sort of thing I would do if I was putting a back door into a system as I&#8217;ve indicated in the past (back when Blumberg tride to do a number on Apple).</p>
<p>@ All,</p>
<p>For those discounting this attack, you have to realise just how far down it is in both the computing and security stacks. Thus the much greater ability the attack has to bubble up through the stacks, eliminating any gains that might have been made from top down security processes such as formal methods.</p>
<p>It&#8217;s nasty, it has significant scope and my &#8220;thinking hinky&#8221; gland is itching and in effect saying &#8220;to much deniability&#8221; to be &#8220;by accident&#8221; therefore without further evidence otherwise I would assume &#8220;by design&#8221;.</p>
<p>Oh and before people get all defensive ask yourself what you would think if it was found in a Chinese company product rather than a US company product.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336537">

			<div class="comment by-patriot ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://crypto.stackexchange.com/users/55560/patriot?tab=profile' rel='external nofollow ugc' class='url'>Patriot</a></span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336537">
						May 23, 2019 9:03 PM					</a>

				</p>

				<p>It almost does not matter what we do in the hopes of having an internet and devices which allow everyone to have confidentiality, anonymity, authentication, etc.</p>
<p>Somewhere there is a room full of smart people who are ordering take-out and getting paid well to get your data. They have the bandwidth to come up with stunningly clever ways to watch you.</p>
<p>It is not going to stop in the near future.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336538">

			<div class="comment by-realfakenews ">

				<p class="commentcredit">

					<span class="commenter">RealFakeNews</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336538">
						May 23, 2019 9:08 PM					</a>

				</p>

				<p>So the real reason Huawei are banned is because the home-grown stuff is terminally compromised by &#8220;bad design&#8221;, so to force people to buy it they will just block the competition?</p>
<p>Sounds fishy.</p>
<p>As Clive said, this seems just a little too basic to be an accident. This is worse than exposing private keys.</p>
<p>The device of ultimate trust can be compromised to give absolute control and access to the device it is supposed to be watching.</p>
<p>Nothing &#8220;Big Brother&#8221; about that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336539">

			<div class="comment by-ismar ">

				<p class="commentcredit">

					<span class="commenter">Ismar</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336539">
						May 23, 2019 9:37 PM					</a>

				</p>

				<p>Good time to ask why it is the case that it seems impossible to design any secure software that is independent on the underlying hardware to provide the basis of that security ?<br />
Has anyone tried doing this and what would be the (obvious) reasons for it not working ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336540">

			<div class="comment by-esteban ">

				<p class="commentcredit">

					<span class="commenter">Esteban</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336540">
						May 23, 2019 9:43 PM					</a>

				</p>

				<p>@SpaceLifeForm<br />
You managed to set up an impossible task.  Can anyone show that something is not exploitable?  If you have read this blog or been around at least a decade you obviously know the answer.  If not then you are just here to make a personal case against a company you do not like.  Come clean either way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336541">

			<div class="comment by-john-smith ">

				<p class="commentcredit">

					<span class="commenter">John Smith</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336541">
						May 23, 2019 9:46 PM					</a>

				</p>

				<p>I&#8217;ve worked with engineers who went on to work for Cisco. Extremely smart, and experts at everything they did.</p>
<p>This &#8220;series of hardware design flaws&#8221; doesn&#8217;t pass the smell test.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336542">

			<div class="comment by-patriot ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://crypto.stackexchange.com/users/55560/patriot?tab=profile' rel='external nofollow ugc' class='url'>Patriot</a></span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336542">
						May 24, 2019 12:17 AM					</a>

				</p>

				<p>This part of that article was especially striking:</p>
<p>&#8220;The takeaway here is that we have to start thinking about privacy as a collective, environmental problem, not something that hits individual people, and certainly not something where the onus is on the individual to protect themselves. Privacy is starting to look like a problem similar to climate change â and in past eras, something similar to food safety.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336543">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">steve</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336543">
						May 24, 2019 2:08 AM					</a>

				</p>

				<p>Ain&#8217;t no such thing as secure backdoor (aka vulnerability).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336544">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336544">
						May 24, 2019 1:18 PM					</a>

				</p>

				<p>@ Ismar,</p>
<blockquote><p>Good time to ask why it is the case that it seems impossible to design any secure software that is independent on the underlying hardware to provide the basis of that security ?</p></blockquote>
<p>The way computer architectures are currently it is not possible to write software that remains secure once it is on hardware that is not Fully Trusted (of which there is none of any use you can get).</p>
<p>The reason is obvious when you realise why and you will say &#8220;why did I miss that?&#8221;.</p>
<p>Software is indistinguishable from data, because both are just bits in memory with no way to distinguish them. That is a &#8220;bag of bits&#8221; is just another &#8220;bag of bits&#8221; all meaning comes from meta data that is not in the &#8220;bag of bits&#8221; as to get the full range such meta data would have to be &#8220;out of band&#8221;. Thus data can be instructions and instructions can be data and you can not distinguish them.</p>
<p>The big problem is that all these bits are stored in memory, which by general usage definition must be writable (ie the tape in a Turing machine).</p>
<p>Thus you have to ask a question that came up in the early days of computers,</p>
<ul>What happens if the bits stored in memory get changed whilst a program is running?</ul>
<p>In current architectures the answer ranges from nothing to total mayhem with points in between where the program will apparently behave as it should but in fact do one or more things differently. In essence it&#8217;s what some forms of malware do to gain privileges of some form.</p>
<p>Thus the next question is usually,</p>
<ul>What can change any bit in memory?</ul>
<p>And the answer is anything that can get access to the memory and this includes high field strength non-ionizing, ionizing radiation and high energy particles.</p>
<p>Likewise transients on power and signal busses and even in some extream cases mechanical vibration[1].</p>
<p>All of which are usually considered to be &#8220;random&#8221; even when they are determanistic, because they are not correlated with the functioning of the running program (the exception being active EM fault injection attacks).</p>
<p>But there are also other faults to consider, logic gates have issues around their input switching threshold that can and does result in &#8220;soft faults&#8221;[2] that fall under &#8220;metastability&#8221; concerns. Likrwise all electronics have other faults that can effect the contents of memory.</p>
<p>Are there ways to mitigate these &#8220;random&#8221; effects? Well yes we can increase the size of each memory word to contain extra bits. You then define various values that are considered good and those bad.</p>
<p>For instance we can add a single bit to a byte to store a parity bit. Thus with nine bits half the 512 values are valid, the others indicate a &#8220;parity error&#8221; in the memory. However that is only detected for odd numbers of bit errors such as 1,3,5,7,9 even numbers of bit errors such as 2,4,6,8 produce valid values from ibitialky valid content so such errors are not detected.</p>
<p>There are more complicated systems but at the end of the day, any changes in bit valies at any given memory location that produce valid but incorrect values will not be detected.</p>
<p>Likewise any process that writes entire new values directly to memory locations will go undetected. Such issues used to occure with badly programed Direct Memory Access (DMA) controlers used for large data transfers without ibterupting CPU functioning.</p>
<p>The point that many miss is the contents of any memory location are only detrcted at that level when a memory location is read. So any changes made can easily go undetected. Especially if they are not just below the CPU layer in the computing stack but below the MMU layer and even below the nemory interface level.</p>
<p>Most modern computer systems can not detect tampering with the memory unless other hardware such as Parity, ECC, etc hardware detects an invalid value and raises some kind of exception.</p>
<p>Thus it does not matter what &#8220;formal methords&#8221; you designed the software with such tools reach effectively ends at the ISA level just above the CPU level in the computing stack. The same is true for any &#8220;Top Down&#8221; security method, they are all in most current computer architectures susceptable to &#8220;Bottom up&#8221; attacks and current architectures provide no protections against these &#8220;bubbling up&#8221; attacks.</p>
<p>Which brings us to,</p>
<blockquote><p>Has anyone tried doing this and what would be the (obvious) reasons for it not working ?</p></blockquote>
<p>The answer is yes, I have and the reasons are as stated CPU and above security fails to CPU and below tampering with memory. I also started working on ways to mitigate the issues quite some time ago and I have found a number, that have been previously discussed on this blog.</p>
<p>[1] If you think about basic electrical components such as inductors and capacitors, their properties are defined by conductors held in a normally fixed mechanical arrangement. If however you can disturb that mechanical arrangment you change their electrical properties thus introduce an interfearing signal. Such behaviour is most frequently observed with &#8220;free running oscillators&#8221; and is lumped under a common term of &#8220;microphonics&#8221;.</p>
<p>[2] In reality there realy is no &#8220;digital electronics&#8221; it&#8217;s actually at heart &#8220;analog electronics&#8221; with very high gain and little or no negative feedback. If you look at early CMOS inverters you will find that you can treat them as analog amplifiers simply by biasing their inputs to their switching threshold which is in effect the middle of their analog gain chatecteristics. You can do similar with other logic family gates and the most common use you see for it, is for either XTAL or RC oscillators.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336545">

			<div class="comment by-lurker ">

				<p class="commentcredit">

					<span class="commenter">lurker</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336545">
						May 24, 2019 3:13 PM					</a>

				</p>

				<p>@ RealFakeNews</p>
<blockquote><p>So the real reason Huawei are banned is because the home-grown stuff is terminally compromised by &#8220;bad design&#8221;&#8230;</p></blockquote>
<p>So Cisco et al, all those given the nudge, nudge, wink, wink from On High, deliberately leave holes in their systems. On High is pissed off with Huawei because they won&#8217;t play that game. But Huawei could/should still be excluded because of their shoddy version control, and poor update procedures, leaving holes that anybody, anywhere, could find in their own good time and exploit for purposes beyond the control of On High. Ah, it&#8217;s not about trust, it&#8217;s about control.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336546">

			<div class="comment by-george ">

				<p class="commentcredit">

					<span class="commenter">George</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336546">
						May 24, 2019 11:39 PM					</a>

				</p>

				<p>@RealFakeNews wrote ,</p>
<p>&#8220;So the real reason Huawei are banned is because the home-grown stuff is terminally compromised by &#8220;bad design&#8221;, so to force people to buy it they will just block the competition?</p>
<p>Sounds fishy.&#8221;</p>
<p>If the first step is to design an unbreakable system, then the second step is to design one that can only be exploited by the designer and his delegates.</p>
<p>Cisco is undoubtedly run by &#8220;smart&#8221; folks, just as Huawei is. The trade war is looking more like a political stunt show designed to camouflage the real issues running at hand. China had grown too big technologically to pose a threat to US dominance in control systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336548">

			<div class="comment by-alext ">

				<p class="commentcredit">

					<span class="commenter">AlexT</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336548">
						May 25, 2019 6:01 AM					</a>

				</p>

				<p>So can we say that almost any Cisco equipment less than 10 years old should be trashed ASAP ?</p>
<p>Wow !</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336549">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">Jon</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336549">
						May 25, 2019 6:53 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<blockquote><p> &#8220;Software is indistinguishable from data, because both are just bits in memory with no way to distinguish them.&#8221;</p></blockquote>
<p>That&#8217;s not quite true in some microcontroller architectures, where the program is burned into non-volatile memory and the data kept separate in RAM.  For example, a buffer overrun on an Atmel (now Microchip) AVR will only corrupt other data, not the program itself.</p>
<p>But (you knew there was a but coming, huh?) there are certain instructions that will let an AVR modify the code itself, akin to what we have here &#8211; the FPGAs configuration stream being tampered with.</p>
<p>If you write the code without those instructions, however, nothing in the data area can ever be executed.  And there is nowhere to put any input except into the data area.</p>
<p>If you want a bootloader, you have to put those instructions in, and a corrupt bootloader image can program anything you want.  So don&#8217;t do that &#8211; but accept that you cannot update chips in the field except by replacing them.</p>
<p>If you don&#8217;t put those instructions into the code, the chips cannot execute any data.</p>
<p>Anyhow, just a minor thingy,</p>
<p>Jon</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336550">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336550">
						May 25, 2019 8:59 AM					</a>

				</p>

				<p>@ lurker,</p>
<blockquote><p>But Huawei could/should still be excluded because of their shoddy version control, and poor update procedures, leaving holes that anybody, anywhere, could find in their own good time and exploit&#8230;</p></blockquote>
<p>Those were the reasons given in a report by a UK Agency. Which is odd as that privious reports have been different. But now suddenly as the current US Administration is on it&#8217;s high horse trying to do a &#8220;5G our way or no way&#8221; routine suddenly the company is pronounced terrible by a little known UK agency&#8230; Coincidence?</p>
<p>Well maybe, maybe not. Remember the UK agency that produced the report is very strongly attached to a UK IC Agency better known as GCHQ.</p>
<p>Also remember that under &#8220;the special relationship&#8221; that the UK GCHQ IC agency gets payed by the US NSA IC agency to spy for them.</p>
<p>That is not just to spy on the UK and it&#8217;s citizens, but most European Nations and their Citizens, oh and on many other nations and their citizens as well. Why? Well because the UK for various reasons is where a lot of the worlds sub-sea communications cables come to shore. It is these cables that many commercial companies use in preference to geo-stationary satellites due to the shorter path times. Remember it is &#8220;commercial&#8221; &#8220;economic activity&#8221; companies that favour these shorter path lengths, so the spying is mostly on &#8220;commercial economic activity&#8221;&#8230; That&#8217;s hardly the sort of think the US claims it performs espionage on so you have to wonder why they pay others to do it for them&#8230;</p>
<p>Thus when the current US Administration started up their &#8220;this company must be evil&#8221; nonsense people realy should have asked the question of,</p>
<ul>How was the company being judged?</ul>
<p>That is was it against the rest of the industry? Or some esoteric or mythical ideal that somebody thought up for some altogether different and potentially corrupt reason?</p>
<p>The answer as anyone who works in the industry knows, is it was not against the rest of industry&#8230;</p>
<p>So the company was being judged against some mythical ideal that even in a perfect universe would not have be possible. So at best the report was a &#8220;Strawman argument&#8221; used for some altogether different reason. Or to put it another way some one in the &#8220;B-Team&#8221; tipped the playing field against the company, so far it was designed to &#8220;crush and bury&#8221; the company&#8230;</p>
<p>Lets put it this way if Huawei were judged against the realities of the very cut throat industry they would be up with the other &#8220;Leaders in Excellence&#8221;. As for Cisco, well I guess their CERT record might be a place to start, after all Cisco and their other brand name companies are the ones we keep hearing about for things like hard coded usernames and passwords etc. You would have to ask what Cisco&#8217;s &#8220;version control&#8221; and &#8220;update proceadures&#8221; are like to be fair&#8230; But all those CERT advisories, oh and also evidence of their equipment being tampered with by State Spying Entities, perhaps most could make an educated guess, that they are not as good as Huawei&#8230;</p>
<p>Or is it all just a &#8220;smoke screen&#8221; because Cisco are secretly funded by the US state so that all nations and their citizens who buy Cisco can be spyed upon?</p>
<p>It probably would cause some moral out rage in certain places if I ever consider asking the same of all US telecommunications companies as the US government asks of Chinese companies. But as they say &#8220;tough&#8221;, that&#8217;s exactly what I am asking people to do.</p>
<p>Why? Because if people want to play on a fair playing field and have a chance at privacy in their communications then the same questions and the same scrutiny must be asked and verified publically for all market entrants irrespective of what nation they originate from.</p>
<p>The fact that certain nation states are clearly not doing this and then get ruffled feathers when you mention it says where the real problem is and also gives a good indication of the honesty or not of their statments.</p>
<p>Which leads by a different path to almost the same conclusion you arrived at of,</p>
<blockquote><p>Ah, it&#8217;s not about trust, it&#8217;s about control.</p></blockquote>
<p>Let&#8217;s look at what &#8220;trust&#8221; realy means if your objective is privacy of your communications as a nation state. It does not mean holding a popularity contest and going for the people you think are least likely to betray your &#8220;blind faith&#8221; that&#8217;s the &#8220;teen school girl approach&#8221; at best, and we know how unreliable that can be. So &#8220;Trust&#8221; has to be achieved in more reliable ways.</p>
<p>There is the old truism about the CIA motto of &#8220;In God We Trust&#8221; because what it realy means is &#8220;every other bu99er we check&#8221;. That is they always try to establish trust rather than use blind faith.</p>
<p>That is the approach you have to take, if you want privacy in your communications, you assume that ALL entrants and their products will be malicious and act accordingly.</p>
<p>There was a lot of faux out rage noise when the UK Gov came out and said they were considering Huawei for use in 5G. Put more prosaicaly the US Administration orchistrated, no doubt by B-Team interests, to &#8220;throw the toys out the pram&#8221; and &#8220;have a major hissy fit&#8221; about the UK Gov decision.</p>
<p>Actually it was not just a faux &#8220;animated fit of peak&#8221; for the sake of publicity/spin. In essence there was genuine B-Team conniption at the fact that the &#8220;Special Relationship&#8221; was not the &#8220;Choker Chain dog lead&#8221; they thought it was, and as a result of their failing it came to be by implication a quite public slap in the face for the current US Administration[1].</p>
<p>In reality the UK GCHQ position is &#8220;We assume ALL &#8216;equipment&#8217; from all companies from all nations can and will be used to spy on us, therefore we take general mitigation activities based on that assumption&#8221;. It is a position they have taken for many years and it&#8217;s not ever been a secret.</p>
<p>However take care to note it is about the &#8216;equipment&#8217; not the companies or where they come from. That is GCHQ very well know that they, the NSA and many other national and private SigInt agencies around the world hack/implant any equipment they can &#8220;as a mater of policy&#8221;.</p>
<p>Most readers on this blog should know this from the &#8220;Greek Olympics&#8221; tragidy where the cavalier activities of a CIA operative led eventually to the suspicious death of an employee working for a Greek Cellular Network supplier and an international arrest warrent issued for the CIA operative. Likewise the tapping of the German Chancellor&#8217;s mobile phone etc etc.</p>
<p>Instead of joining in with the current US Administration nonsense people shold stop to ask why this common sense long held attitude by GCHQ has so afronted the US representatives? Because it says rather more about the current US Administration views and activities than it does about the UK, GCHQ, or the company in question.</p>
<p>The &#8220;technical&#8221; or &#8220;security&#8221; point people should take on board is,</p>
<ul>No commercial equipment is immune to the effects of State Level espionage.</ul>
<p>It&#8217;s a clear, simple, factual statment and it has no prejudice or ulterior motives or agendas behind it.</p>
<p>Thus from my perspective the GCHQ advice to the UK Gov of basically &#8220;We assume it&#8217;s all got implants no matter where it comes from&#8221; is assuming a level playing field. As is the follow through action of we &#8220;mitigate all&#8221;.</p>
<p>Which given the nature of modern commercial equipment markets, the &#8220;mitigate all&#8221; is the only sensible technical response to ensure National Security in all ways, not just with regards the privacy of communications.</p>
<p>There is however the thorny issue of a &#8220;political&#8221; point to consider.</p>
<p>Take the US Company which this thread is about &#8220;Cisco&#8221;. Who let&#8217;s face it are the ones who have had the embarrassment of pictures taken of US IC entities adding implants to their equipment appear in the press. Likewise the frequent vulnarabilities reported about their equipment, that alow not only State Level SigInt agencies, but near all other Cyber-ne&#8217;er-do-wells to abuse Cisco&#8217;s products at the expense of their products users world wide.</p>
<p>Cisco is one of a number of major manufacturers of telecommunications equipment in the world, thus they are like any other major manufacturers &#8220;a target of choice&#8221;. Put simply the ROI says every dollar you spend on perverting a big corp&#8217;s product the greater is the number of customers they have that then become your victims&#8230;</p>
<p>So as a general rule for Cyber-ne&#8217;er-do-wells is &#8220;it pays to attack big&#8221;. You may remember we saw that in play in the early days of PC malware when &#8220;Microsoft was the target of choice&#8221; and supposed security experts were telling people to &#8220;Buy Mac&#8217;s&#8221; to be secure&#8230;</p>
<p>Which importantly also means that big telco manufacturers are targets not just for the IC of the country their head office is in but all countries SigInt agencies etc. In the case of Cisco their home country is the US which has a policy of spying on the world and his dog, hence the photos were not exactly unexpected.</p>
<p>So,</p>
<p>1, We know that Cisco equipment arives at customers world wide with implants in or later it gets owned from software vulnerabilities.</p>
<p>2, We also happen to know that the US IC puts implants in Cisco equipment and also gains illegal entry and control of Cisco&#8217;s products.</p>
<p>Therefore,</p>
<p>3, Is US company Cisco to blaim for those US implants and US exploits?</p>
<p>Most would say no, but ask yourself what they would say if I changed &#8220;US&#8221; to &#8220;China&#8221; and &#8220;Cisco&#8221; to &#8220;Huawei&#8221;?</p>
<p>Well the current US Administration is indicating that if Huawei equipment is ever found to have implants you should blaim Huawei not the country or agencies who implanted or exploited&#8230;</p>
<p>So why should I or anybody else treat Cisco any differently?</p>
<p>Therefore under US Gov rules I should claim that Cisco is not just aware of what the US IC is doing to their equipment but that they are actively responsible or even colluding with them, therefor nobody should buy Cisco equipment anywhere in the world.</p>
<p>Do people in the US think that is a fair viewpoint?</p>
<p>At the end of the day the real point is, the current US Administration is effectively saying,</p>
<ul>One rule for the US Gov and US corps and a different rule for everyone else.</ul>
<p>Thus exhibiting just another form of US Exceptionalism.</p>
<p>So the current US Administration not only do not want a level playing field in their country, they also want to insist that every other country play on the same playing field that so favours the US&#8230;</p>
<p>What do non US people think of that?</p>
<p>Well it&#8217;s clear that the UK Government think the current US Administration view point is wrong, even though the US SigInt agency the NSA gives the UK SigInt agency GCHQ money and equipment to spy for them. It&#8217;s also clear that the UK Government reasoning is based on the common sense reasoning of it&#8217;s SigInt agency GCHQ, which has not realy changed in as long as many people can remember. It&#8217;s also reasoning based on fact abd not prejudice or hidden agendas etc.</p>
<p>Oh and to cap it off it appears the B-Team in the current US Administrarion are prepared to actually go to real kinetic war over it&#8230; No matter what the cost in body bags.</p>
<p>For those in the US ask yourself, do you realy want your loved ones and friends in body bags because the B-Team want a war any war to put their name in the history books?</p>
<p>[1] Actually when you consider how the information came out it might well have been designed &#8220;to yank the current US Administration&#8217;s chain&#8221; to remind them that &#8220;They do not set UK National Communications Policy&#8221;. However it came about because of a &#8220;leak&#8221; that arose from a UK NSC meeting, where GCHQ presented their view on how the UK should proceed with 5G under all asspects of &#8220;National Security&#8221;. The basics of that presentation were not secret or even confidential, and most people in the telecommunications industry know it as it&#8217;s based on &#8220;common sense&#8221; reasoning for atleast the last half century or so. Unfortunatly the MSM involved rather than say what the message was realy about decided that a &#8220;UK Minister being disloyal to PM over BREXIT differences&#8221; would make more sales etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336552">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336552">
						May 25, 2019 12:32 PM					</a>

				</p>

				<p>@ Jon,</p>
<blockquote><p>If you write the code without those instructions, however, nothing in the data area can ever be executed. And there is nowhere to put any input except into the data area.</p></blockquote>
<p>You know this is comming ð</p>
<p>The PIC architecture which Microchip started with is Harvard thus instructions on one bus into the instruction decode logic and data on the other bus into the ALU/Registers and I/O.</p>
<p>It does give an improved level of security except when the instructions form an interpreter for &#8220;code&#8221; in the data memory.</p>
<p>Some years back I wrote a very simple basic style interpreter for one of the PIC24 chips when developing a secure memory dongle. It enabled relatively fast design just using a VT52 terminal as a test instrument / control pannel. I finally replaced it with a variation of a Forth interpreter to get multi tasking/threading running on it as well as getting quite a lot of &#8220;code compression&#8221;.</p>
<p>Stack based interpreters are a trick that programmers who have to write multi-tasking embedded systems on SoC&#8217;s that don&#8217;t have MMU&#8217;s can find rather usefull. But few even hear of stack based interpreters after their college courses&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336553">

			<div class="comment by-lurker ">

				<p class="commentcredit">

					<span class="commenter">lurker</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336553">
						May 25, 2019 4:13 PM					</a>

				</p>

				<p>@ Clive Robinson<br />
thanks for fleshing out the detail between my meagre lines. Of course little weight should be attached to China&#8217;s claim that they do not seek global hegemony. It is in the nature of hegemons, particularly the current, that they are ever fearful of rivals. So they will never allow any outsider to replace their current lapdog, subject of this thread.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336554">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">Jon</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336554">
						May 25, 2019 10:40 PM					</a>

				</p>

				<p>@ Clive Robinson &#8211; Actually, I had in mind an AVR, which was bought by Microchip, not developed there.  But anyhow, you wrote:</p>
<blockquote><p>&#8220;It does give an improved level of security except when the instructions form an interpreter for &#8220;code&#8221; in the data memory.&#8221;</p></blockquote>
<p>I would call that a bootloader.  AVRs do contain the stack in the data memory, smashing that stack will lead to the program jumping around wildly but it won&#8217;t change &#8220;what to do when you get there&#8221;.  If there is nowhere in the program you can land that says &#8220;here we move information from data to program&#8221;, it cannot happen.</p>
<p>Which leads to an interesting thought that some AVR instructions occupy multiple locations, and jumping into the middle of one of them and using, say, the last byte of one and the first byte of the next opcode to construct the required opcode for modifying the program might work.  Tricky, that.</p>
<p>Aside from the above, my point was that unless you deliberately include instructions at the outset that permit moving of data from data to program (like, say, a self-programming bootloader), the data cannot write its own instructions &#8211; thus there is no data that can ever be executed.</p>
<p>You wrote a great deal more too, which I will read through more carefully later.  I think I kinda agree with you though &#8211; all this Huawei paranoia stuff is entirely hypocritical.</p>
<p>J.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336555">

			<div class="comment by-alext ">

				<p class="commentcredit">

					<span class="commenter">AlexT</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336555">
						May 26, 2019 2:13 AM					</a>

				</p>

				<p>I&#8217;m sorry to insist  but but am I correct in my understanding that<br />
1. This is a hardware design issue, most likely not &#8220;fixable&#8221; (I&#8217;m sure Cisco engineers are pulling their hairs to find mitigation)<br />
2. It can be exploited remotely</p>
<p>Given the prevalence of Cisco in the market I find the consequences nothing short of staggering.</p>
<p>There might or might not be active exploitation at the moment but as the host of this blog contends &#8220;attacks only get better&#8221;. Given the possible rewards this will be most definitely weponized.</p>
<p>Again, am I missing something or is this an absolute massive issue?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336556">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336556">
						May 26, 2019 5:24 AM					</a>

				</p>

				<p>@ lurker,</p>
<blockquote><p>thanks for fleshing out the detail between my meagre lines.</p></blockquote>
<p>That&#8217;s alright, it&#8217;s a subject that many readers might bot have thought about very much so a little back ground helps them catch up a bit or take fright and head for cover :-S</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336557">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336557">
						May 26, 2019 7:03 AM					</a>

				</p>

				<p>@ Jon,</p>
<blockquote><p>my point was that unless you deliberately include instructions at the outset that permit moving of data from data to program &#8230; the data cannot write its own instructions &#8211; thus there is no data that can ever be executed.</p></blockquote>
<p>There was an assumption some years ago that Harvard architectures were not just &#8220;more secure&#8221; but &#8220;secure&#8221; and many bought into the idea and to a certain extent still do.</p>
<p>However back in the late &#8220;naughties&#8221; strange things were happening and in 2007 a paper with the title &#8220;The Geometry of Innocent Flesh on the Bone&#8221; appeared which in academia kicked of Return Oriented Programing (ROP) that was talked about a lot for the next half decade, but because many assumed it was a &#8220;solved problem&#8221; you tend not to hear about it much.</p>
<p>But it&#8217;s not gone away[1] and the more subtle varients are still ripe for explotation even when the instructions can not be changed because they are in old fashioned ROM that has to be taken off board and reprogramed in some cases with a soldering iron (Rope and diode memory or reconecting the pins used for writing).</p>
<p>The point is that outside of some specialised software like state machine and DSP style programs, programs in general, especially those where the instructions were emmited from a compiler need RAM for their stacks and data on which branching decisions are made.</p>
<p>Thus if the program it&#8217;s self or the library code it is built on contains &#8220;useful code&#8221; then malicious activities are possible.</p>
<p>As you have realised and noted above that &#8220;useful code&#8221; may not be obvious. One of the weaknesses of the extended x86 instruction sets is that an instruction that takes say five bytes of ROM is also a potential four byte, three byte two byte or single byte instruction. And yes people have exploited this before (usually only as a single or sometimes two byte initial instruction).</p>
<p>However there is a new variation on ROP around which we will probably hear more about in the near future and it&#8217;s something I&#8217;m playing with currently.</p>
<p>As you have no doubt heard Intel had a little Xmas prezzie for everyone a couple of Xmas&#8217;s back. And it&#8217;s turned as I said at the time to be the &#8220;Xmass present that keeps on giving&#8221;, and probably will do for the next half decade or so. The problem is the &#8220;go faster stripes&#8221; around the CPU&#8217;s ALU and instruction decode units are actually more complex hardware wise than the core CPU functions.</p>
<p>Such complexity needs to be made highly efficient and as I have warned for well over a decade on this blog and prior to that in other places there is the problem of &#8220;Efficiency-v-Security&#8221; the more efficient you make things, then generally the more side channels you open up unless you realy know what you are doing[2].</p>
<p>Most though have assumed that &#8220;Efficiency-v-Security&#8221; means only &#8220;simple time based side channels&#8221; even though I warned there were other types. One of which is &#8220;system transparancy&#8221; from input to output was demonstrated by Matt Blaze and some of his students, and I&#8217;ve talked about the reverse direction getting back through data diodes, firewalls and other security measures using &#8220;error and exception&#8221; excercising tricks. But the majority have still not realised that what hit Intel AMD and ARM in the way of Meltdown and Spector were just a couple more on the &#8220;Efficiency-v-Security&#8221; list. Oh and that there are quite a lot of further ones that will appear to researchers when they think just a little bit further. Some I can promise you will be real doosies and will be down to hardware that&#8217;s become so entwined and critical to the system that they can be neither removed or mitigated without significant penalties. This problem Cisco is having is just one further&#8230;</p>
<p>To see why consider High Hardware complexity CPU systems such as the 64bit varients of the old x86. They are so complicated they have what are the basis of &#8220;Virtual Turing Engines&#8221; in them. For instance the more modern x86 varient memory control hardware has been demonstrated as being a virtual Turing compleate engine that can and has been made to function as such. It&#8217;s therefore possible to make a Turing Engine in such complexity, and it needs only the Data RAM to act as it&#8217;s tape.</p>
<p>This sort of thing is the future of malware&#8230;</p>
<p>[1] <a href="https://securityintelligence.com/return-oriented-programming-rop-contemporary-exploits/" rel="nofollow ugc">https://securityintelligence.com/return-oriented-programming-rop-contemporary-exploits/</a></p>
<p>[2] You can probably take it as read that nobody and I do mean nobody knows what they are doing in this respect. The reason is the &#8220;Known, Knowns&#8221; through &#8220;Unknown, Unknowns&#8221; proplem, that is what we know is quite a bit less than we will know at some future point. In general few designing high end CPU hardware are even aware of the &#8220;Known, Known&#8221; issues which is why Meltdown and the Spector varients exist. As for those that do, well the solutions to those problems as we know can have quite serious performance degredations. Anyone bringing it up in the &#8220;marketing advantage&#8221; or subsiquent &#8220;implementation&#8221; / &#8220;engineering&#8221; meetings is not only likely to not get invited back, they might find all their personal effects in a cardboard box in the security office supprisingly quickly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336558">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336558">
						May 26, 2019 7:58 AM					</a>

				</p>

				<p>@ All,</p>
<p>Just so you know Cisco should have absolutely no excuse for this problem.</p>
<p>Back in 2012 Cambridge University Computer labs presented a paper at CHES which showed that there were security issues with FPGA bitstream even in Mil-Grade high security parts,</p>
<p><a href="https://www.cl.cam.ac.uk/~sps32/ches2012-backdoor.pdf" rel="nofollow ugc">https://www.cl.cam.ac.uk/~sps32/ches2012-backdoor.pdf</a></p>
<p>If you read the paper you will see just how vulnerable FPGA&#8217;s are to this attacks on their &#8220;Field programing&#8221; methods. In a way this is the same as malware being able to overwrite Flash BIOS ROMs such that the old IBM/Microsoft &#8220;load I/O drivers at boot and make persistent&#8221; is excercised which is what Lenovo did to it&#8217;s consumer level laptops that created such an uproar a few years back, and what a malware researcher was trying to find when trying to figure out what we now call BadBIOS an idea of which was using inaudible to humans networking by high frequency audio signals that could happily cross traditional high security &#8220;air-gapps&#8221;.</p>
<p>It&#8217;s fairly certain that Cisco engineers and security practitioners would have read the CHES paper and be able to draw the required conclusions. Thus the only reason Cisco could have had not to make design changes back then was because they desided for &#8220;business reasons&#8221; not to bother. Likewise with the BadBIOS and Lenovo security issues that were not just well publicised but frequently analysed technically in excruciating detail (on this blog as well as many other places).</p>
<p>The most likely reason for those &#8220;business reasons&#8221; is not to give up some perceived &#8220;marketing advantage&#8221;. It&#8217;s why we had Meltdown and the Spector variations.</p>
<p>Usually &#8220;marketing advantage&#8221; is based around some notion of &#8220;desirable performance&#8221; which security wise almost always brings you smack into the middle of the &#8220;Efficiency-v-Security&#8221; domain of problems where all sorts of nasty side channel issues are just waiting to be brought to life then found by those who have an interest in finding them.</p>
<p>Expect to see a lot more security issues to come from the &#8220;Efficiency-v-Security&#8221; domain of problems. Contrary to what many think the domain is not just about leaking of information via time based side channels.</p>
<p>I&#8217;ve mentioned it on a number of occasions in the past in this blog and admittedly later than I expected the academic and open security communities are finally waking up to what it actually means&#8230;</p>
<p>That is not just in leaking information, but system transparancy, and fault and similar injection attacks via error control and signalling channels, as well as those for exceptions as well. As I&#8217;ve mentioned before you can establish a viable covert communications channel back through data diodes, firewalls, and similar security barriers many of which people mistakenly belive are &#8220;one way&#8221; so they take no security precautions.</p>
<p>Such lack of prepardness is going to keep biting and biting very hard for quite some time to come. As security engineers it&#8217;s upto you to make those above you aware of the issues. However you are not going to be at all popular with anyone else, so I&#8217;d do it as discreetly as possible, just to &#8220;Cover Your Arse&#8221; (CYA) when the brown stuff does hit the wall as it almost always does with security vulnerabilities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336559">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336559">
						May 26, 2019 12:05 PM					</a>

				</p>

				<p>@ Alex T,</p>
<blockquote><p>Again, am I missing something or is this an absolute massive issue?</p></blockquote>
<p>It depends on your view point to a certain extent, and right some people have their fingers in their ears whilst chanting &#8220;not listening&#8221; over and over or are chosing to look elsewhere. Whilst many others don&#8217;t yet see where this is going. Some of course will do as they did with Meltdown and the Spector varients, shrug their shoulders and hope things will sort themselves out&#8230;</p>
<p>So,</p>
<blockquote><p>1. This is a hardware design issue, most likely not &#8220;fixable&#8221;
</p></blockquote>
<p>Well firstly remember &#8220;All things man made man can fix or replace&#8221;, the question realy becomes one of resources and how best to utilise them. Have a think back to what happened with the Pentium maths bug as an example, I&#8217;m fairly certain that is going to be in the back of many of Cisco&#8217;s managers minds, or an equivalent like the Pinto Gas Tank.</p>
<p>From what&#8217;s been said by others it&#8217;s a fault that can not be fixed by software, and that does not surprise me in the slightest. Thing about modern PC BIOS chips, they are Electrically Erasable, and in many cases there is no hardware write protect, so you can change it without a lot of difficulty because you don&#8217;t have to open the case etc.</p>
<p>So there is a high probability this Cisco system is similar, which implies the only real fix is a replacment of the board or entire unit.</p>
<p>However also from what&#8217;s said you need certain software privileges which brings us to your second point</p>
<blockquote><p>2. It can be exploited remotely</p></blockquote>
<p>Only if you can get system privileges remotely.</p>
<p>Which means that although the actual hardware fault may not be fixable, keeping the required privileges away from remote attackers may be possible untill the hardware fault has been fixed.</p>
<p>I suspect that Cisco will issue some kind of software upgrade very soon if for no other reason than to buy themselves more time&#8230;</p>
<p>What we need now is more indepth information on the hardware to judge by.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-336560">

			<div class="comment by-alext ">

				<p class="commentcredit">

					<span class="commenter">AlexT</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336560">
						May 26, 2019 3:09 PM					</a>

				</p>

				<p>@Clive: Thanks for this detailed response.</p>
<p>I guess some restrain is indeed required here but this has the potential to turn into an aboslute catastrophe.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-336561">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">Jon</span> â¢

					<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/#comment-336561">
						May 28, 2019 10:59 AM					</a>

				</p>

				<p>@ Clive &#8211; Fascinating!  But I don&#8217;t think it applies to me right here right now.</p>
<p>Fortunately, I use highly cheap&#8217;n&#8217;cheerful 8-bit AVRs that don&#8217;t have &#8220;streamlining&#8221; around their ALUs, or any pretence of simultaneous threads.  There is no OS.  There is no shell.  There is one privileged escalation (&#8220;May I rewrite myself?&#8221;), and that requires some very specific opcodes, which I very rarely include.</p>
<p>Unless you byte-slice up opcodes, making the program jump around can only execute the opcodes that are there.</p>
<p>A denial of service seems doable &#8211; force some branch to incessantly branch to itself &#8211; or mixmastering up different ops from here and there to turn &#8220;Hello World&#8221; into an obscenity, but the program itself, unless* it includes self-modifying opcodes, cannot be forced into modifying itself.  On a restart, it will be as it was.</p>
<p>Most of the libraries I use I know pretty well because I wrote them.  Found a bug in one the other day.  Ouch.  So generally I&#8217;m not too worried about unexpected behaviour from libraries.</p>
<p>Pulling and soldering pins would be a bit tricky, given that the program ROM is inside the MCU itself, but if you wanted to decapsulate and fiddle about you probably could&#8230;</p>
<p>That&#8217;s actually a problem with FPGAs &#8211; The configuration ROM is often external to the chip, leaving intercepting that signal near trivial.  Xilinx, among others I suspect, claim their configuration data stream to be well-encrypted with a trade secret algorithm, but I dunno.</p>
<p>Fuse-based programmable logic doesn&#8217;t have that problem, but their density is often small enough that an exhaustive search isn&#8217;t very hard.</p>
<p>Anyhow, given my ruthless input validation (hehe) and the systems these chips operate, I&#8217;m not too worried.</p>
<p>Have fun!</p>
<p>J.</p>
<ul>
<li>See byte-slicing opcodes.</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2019/05/thangrycat_a_se.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2019/05/thangrycat_a_se.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F05%2Fthangrycat_a_se.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2019/05/thangrycat_a_se.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12074' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2019/05/visiting_the_ns.html" rel="prev">â Visiting the NSA</a>		<a href="https://www.schneier.com/blog/archives/2019/05/german_sg-41_en.html" rel="next">German SG-41 Encryption Machine Up for Auction â</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
