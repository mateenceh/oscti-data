<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>The NSA Warns of TLS Inspection - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; The NSA Warns of TLS Inspection Comments Feed" href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12306" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12306' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Fthe_nsa_warns_o.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Fthe_nsa_warns_o.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12306 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12306" class="post-12306 post type-post status-publish format-standard hentry category-uncategorized tag-certificates tag-cryptanalysis tag-encryption tag-man-in-the-middle-attacks tag-nsa tag-tls tag-traffic-analysis">

	<div class="article">

		<h2 class="entry">The NSA Warns of TLS Inspection</h2>
		<p>The NSA has released a <a href="https://media.defense.gov/2019/Nov/18/2002212783/-1/-1/0/MANAGING%20RISK%20FROM%20TLS%20INSPECTION_20191106.PDF">security advisory</a> warning of the dangers of TLS inspection:</p>
<blockquote><p>Transport Layer Security Inspection (TLSI), also known as TLS break and inspect, is a security process that allows enterprises to decrypt traffic, inspect the decrypted content for threats, and then re-encrypt the traffic before it enters or leaves the network. Introducing this capability into an enterprise enhances visibility within boundary security products, but introduces new risks. These risks, while not inconsequential, do have mitigations.</p>
<p>[&#8230;]</p>
<p>The primary risk involved with TLSI&#8217;s embedded CA is the potential abuse of the CA to issue unauthorized certificates trusted by the TLS clients. Abuse of a trusted CA can allow an adversary to sign malicious code to bypass host IDS/IPSs or to deploy malicious services that impersonate legitimate enterprise services to the hosts.</p>
<p>[&#8230;]</p>
<p>A further risk of introducing TLSI is that an adversary can focus their exploitation efforts on a single device where potential traffic of interest is decrypted, rather than try to exploit each location where the data is stored.Setting a policy to enforce that traffic is decrypted and inspected only as authorized, and ensuring that decrypted traffic is contained in an out-of-band, isolated segment of the network prevents unauthorized access to the decrypted traffic.</p>
<p>[&#8230;]</p>
<p>To minimize the risks described above, breaking and inspecting TLS traffic should only be conducted once within the enterprise network. Redundant TLSI, wherein a client-server traffic flow is decrypted, inspected, and re-encrypted by one forward proxy and is then forwarded to a second forward proxy for more of the same,should not be performed.Inspecting multiple times can greatly complicate diagnosing network issues with TLS traffic. Also, multi-inspection further obscures certificates when trying to ascertain whether a server should be trusted. In this case, the &#8220;outermost&#8221; proxy makes the decisions on what server certificates or CAs should be trusted and is the only location where certificate pinning can be performed.Finally, a single TLSI implementation is sufficient for detecting encrypted traffic threats; additional TLSI will have access to the same traffic. If the first TLSI implementation detected a threat, killed the session, and dropped the traffic, then additional TLSI implementations would be rendered useless since they would not even receive the dropped traffic for further inspection. Redundant TLSI increases the risk surface, provides additional opportunities for adversaries to gain unauthorized access to decrypted traffic, and offers no additional benefits.</p></blockquote>
<p>Nothing surprising or novel. No operational information about who might be implementing these attacks. No classified information revealed.</p>
<p>News <a href="https://www.bleepingcomputer.com/news/security/nsa-publishes-advisory-addressing-encrypted-traffic-inspection-risks/">article</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/certificates/" rel="tag">certificates</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/tls/" rel="tag">TLS</a>, <a href="https://www.schneier.com/tag/traffic-analysis/" rel="tag">traffic analysis</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html" rel="bookmark">Posted on November 22, 2019 at 6:16 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html#comments">46 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html" data-title="The NSA Warns of TLS Inspection" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-343675">

			<div class="comment by-uh-mike ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://xkcd.com/722' rel='external nofollow ugc' class='url'>uh, Mike</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343675">
						November 22, 2019 6:31 AM					</a>

				</p>

				<p>Is that person in the middle Trent, Alice or Mallory?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343676">

			<div class="comment by-benjamin-kaduk ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://datatracker.ietf.org/person/Benjamin%20Kaduk' rel='external nofollow ugc' class='url'>Benjamin Kaduk</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343676">
						November 22, 2019 7:22 AM					</a>

				</p>

				<p>It&#8217;s an interesting thought experiment to consider what safety would be provided by using a name-constrained X.509 CA certificate for the middlebox&#8217;s embedded CA.  (This is a thought experiment since I don&#8217;t know of any actual deployments that make use of such a scheme.)  With TLS 1.2 the middlebox could see the actual certificate being presented by the server and see if (all the names in) it is compatible with the name constraints and thus if the middlebox is allowed to break and inspect, but in TLS 1.3 the server certificate is encrypted and the middlebox would need to use the SNI value and some heuristics to guess whether or not it is allowed to break and inspect.  The encryption of the server certificate provides privacy improvements in the normal two-party case, and the ongoing work on encrypting SNI will provide further privacy improvements and effectively force such middleboxes to either break all connections or break none.  In cases where regulatory requirements prevent the middleboxes from breaking connections to (e.g.) banking or healthcare websites, it seems that this would force the &#8220;break none&#8221; case.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343677">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343677">
						November 22, 2019 8:03 AM					</a>

				</p>

				<p>&#8220;SSL added and removed here&#8221; ;^)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343678">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343678">
						November 22, 2019 8:19 AM					</a>

				</p>

				<p>Nothing new&#8230; but some clarifying comments are in order:</p>
<blockquote><p> To minimize the risks described above, breaking and inspecting TLS traffic should only be conducted once within the enterprise network.</p></blockquote>
<p><b>First:</b> Hmm! How does that bode with the buzzword: <b>ZeroTrust</b> &#8212; an old concept / principle that has been rebranded 😉</p>
<p><b>Second:</b>There are <i>TLS inspecting</i> solutions that operate on strong cypher (cipher) suites that provide FS / PFS in the cloud as well.</p>
<p><b>Third:</b> Payload encryption is recommended if TLS offloading happens by a less trusted entity or an entity that&#8217;s not under full and exclusive control by the <i>owners</i> &#8212; these are typically the session termination endpoints. Naturally payload encryption willt complicate TLSI and TLS deep packet inspections, but won&#8217;t fully eliminate it. So I hear.</p>
<p>@uh, Mike,</p>
<blockquote><p>Is that person in the middle <b>Trent</b>, <b>Alice</b> or <b>Mallory</b></p></blockquote>
<p>If video <i>inspecting</i> is the game, then <a href="https://www.schneier.com/blog/archives/2017/11/heart_size_yet_.html#c6785559" rel="nofollow ugc"> <b>Vohkinne</b></a> &#8220;the Voyeur&#8221; is the name!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343681">

			<div class="comment by-james ">

				<p class="commentcredit">

					<span class="commenter">James</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343681">
						November 22, 2019 11:01 AM					</a>

				</p>

				<p>It&#8217;s almost as if engineering a back door into an encryption system opens that system up for attack. Interesting advice coming from the same executive branch as Bill Barr.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343682">

			<div class="comment by-evilkiru ">

				<p class="commentcredit">

					<span class="commenter">EvilKiru</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343682">
						November 22, 2019 11:48 AM					</a>

				</p>

				<p>@Moderator: November 22, 2019 8:51 AM is offensive and not related to security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343683">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343683">
						November 22, 2019 11:51 AM					</a>

				</p>

				<p>I was shocked when I first heard of these security products that man-in-the-middle SSL. I was even more shocked when I found out that many/most IT departments think they are a necessity. It is hard enough to prevent man-in-the-middle from malicious software, it is really bad that we expect security software to do so.</p>
<p>Such products also prevent the use of client-certificates. While client certificates aren&#8217;t frequently used, they ought to be. They are a very good security feature in some circumstances.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343684">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343684">
						November 22, 2019 4:03 PM					</a>

				</p>

				<p>&#8220;Inspecting multiple times can greatly complicate diagnosing network issues with TLS traffic&#8221;</p>
<p>s/diagnosing network issues with/spying on/</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343685">

			<div class="comment by-cris-perdue ">

				<p class="commentcredit">

					<span class="commenter">Cris Perdue</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343685">
						November 22, 2019 8:31 PM					</a>

				</p>

				<p>So, is it wrong to believe that an ISP, such as Comcast just to pick an example, could unilaterally decide that all their customers are part of their &#8220;enterprise network&#8221; and inspect all customer HTTPS traffic?</p>
<p>It is not clear to me what is standing in the way of this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343686">

			<div class="comment by-its-only-a-paper-moon ">

				<p class="commentcredit">

					<span class="commenter">Its only a paper moon</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343686">
						November 22, 2019 11:48 PM					</a>

				</p>

				<p>May be of interest to see if someone is stuck in the middle with you</p>
<p><a href="https://www.grc.com/fingerprints.htm" rel="nofollow ugc">https://www.grc.com/fingerprints.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343687">

			<div class="comment by-john-other ">

				<p class="commentcredit">

					<span class="commenter">John Other</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343687">
						November 23, 2019 5:58 AM					</a>

				</p>

				<p>This has been a known issue since forever, but the big one I remember was in 2012 in an article at The Register titled &#8220;Trustwave admits crafting SSL snooping certificate&#8221; where Trustwave issued an intermediate ca for the * tld, to Bluecoat IIRC.  They were also pressured into revoking it.  This is one of the reasons that the certificate transparency (<a href="http://www.certificate-transparency.org" rel="nofollow ugc">http://www.certificate-transparency.org</a> ) exists.</p>
<p>Dan, these products don&#8217;t prevent the use of client certificates unless the destination web server validates your login and client certificate match.  Even then, there&#8217;s nothing preventing a company from purchasing a client certificate that simply identifies the company; after all, the company owns all of the the inboxes.<br />
After a short google search I can&#8217;t find any CA that advertises multi-email-address client certificates, but there&#8217;s nothing that would prevent a company from providing their users a document that directs them to comodo.com&#8217;s client cert page in order for the employee to create a client certificate, while at the same time running an automated script that does the same thing via a different CA.  In actuallity, each employee would have two digitial certificates, one stored locally on their computer and used to authenticate, and the other stored centrally (in an HSM?) to be used by the web proxies for the external connection.</p>
<p>This is why, if you&#8217;re using certificate authentication, that you should restrict it by signing CAs, and also validate the fields.</p>
<p>Also, these inspecting proxies are a requirement for some industries and are stipulated by the regulations under which they&#8217;re allowed to operate.   They&#8217;re also useful if you employ anyone who plans to break their employment contract and post your company&#8217;s data to pastebin.</p>
<p>On the other hand, they&#8217;re also great for e-book, music, and video piracy &#8212; if you&#8217;re an unscrupulous administrator.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343688">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343688">
						November 23, 2019 8:18 AM					</a>

				</p>

				<p>@ uh, Mike</p>
<blockquote><p><i>Is that person in the middle Trent, Alice or Mallory?</i></p></blockquote>
<p>In most cases he is Trent, our ISP acting in name of our Government.  Others he is Mallory.  Sometimes even Trent becomes Mallory if there is something tasty in our communications.</p>
<p>Thanks, Bruce, for sharing this NSA/CSS CSI.  I have been collecting these great documents for years, but have not looked for new ones in a month or so.  The NSA is doing a great job improving security with these documents full of good tips and [sometimes unusual] common sense.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343689">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343689">
						November 23, 2019 9:35 AM					</a>

				</p>

				<p>Is there any way to avoid the effective use TLSI?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343690">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343690">
						November 23, 2019 10:02 AM					</a>

				</p>

				<p>@Who?</p>
<blockquote><p> Is there any way to avoid the effective use TLSI?</p></blockquote>
<p><b>Long answer:</b> Depends on many factors and various design and architectural choices or constraints. Also depends on actors and owners (or delegated owners, such as a cloud provider) in control.</p>
<p><b>Short answer:</b> Strong cipher suites + Perfect Forward Secrecy + strong payload encryption and protected endpoints. But this won&#8217;t work in all flow configurations &#8212; see Long answer.</p>
<p>If you are in control of end points, then reduction of the attack surface to protocol-only (line of attack, rather than surface of attack) is your option. And that&#8217;s not easy to achieve. Think of it as a &#8220;Theoretical Max Protection design goal&#8221;. We briefly touched on that not too long ago.</p>
<p>If you&#8217;re just a consumer, and not a designer, then you need to operate under the assumption that TLS is not as secure as you&#8217;d like it to be.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343691">

			<div class="comment by-realfakenews ">

				<p class="commentcredit">

					<span class="commenter">RealFakeNews</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343691">
						November 23, 2019 11:44 AM					</a>

				</p>

				<p>Call me nïeve, uninformed, or whatever, but this is basically saying TLS can&#8217;t be considered remotely secure?</p>
<p>So why the hell are we still using it?</p>
<p>It&#8217;s bad enough that MITM occurs by WiFi providers and others, but this appears that TLS is designed to be MITM?</p>
<p>Just what the hell am I missing in all of this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343692">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343692">
						November 23, 2019 12:43 PM					</a>

				</p>

				<p>If you want to communicate securely in a corporate enterprise setting with friends and family, you can always download a browser like Firefox/Chrome yourself rather than using the preinstalled one on your workplace PC with the administratively installed certificates.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343693">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343693">
						November 23, 2019 1:34 PM					</a>

				</p>

				<p>@ Mike</p>
<p>You have completely missed the point.</p>
<p>It is the <em>traffic</em> that is being MITMed.</p>
<p>Whatever browser is used, does not matter.</p>
<p>Note that one of the main purposes of this MITM, is not to watch normal website traffic, but to watch email traffic.</p>
<p>Which could be browser based.  Or POP3 and/or IMAP.</p>
<p>@RealFakeNews</p>
<p>It&#8217;s not really SSL/TLS that is the problem.</p>
<p>It has much more to do with domain certificates.</p>
<p>DNS, CAs, all centralised.</p>
<p>Eliminating DNS and CAs would help.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343694">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343694">
						November 23, 2019 1:51 PM					</a>

				</p>

				<p>@SpaceLifeForm</p>
<p>TLS traffic security is in part based on the authenticity of installed certificates. As I said you could just download Firefox, which comes with its own certificates, and use it to communicate with friends and family without getting snooped on through MITM attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343695">

			<div class="comment by-jonathan-wilson ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Wilson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343695">
						November 23, 2019 3:27 PM					</a>

				</p>

				<p>If you tried to use an alternative browser without the MITM proxy&#8217;s special root certificate installed all you would see is a &#8220;hey, this is signed with a CA I dont recognize&#8221; error (pointing at the MITM proxy&#8217;s certificate).</p>
<p>ISPs like Comcast wouldn&#8217;t be able to get away with doing this since it would break so many things customers use. In a corporate environment they have more control and can avoid using devices that aren&#8217;t compatible with the MITM proxy or find other ways to ensure those devices can&#8217;t be used for the kind of things the MITM proxy is being used to detect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343696">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343696">
						November 23, 2019 6:09 PM					</a>

				</p>

				<p>@ Wael</p>
<p>Thanks for the detailed answer.  I will look at possible approaches but I agree with you, it will be hard to do right.  In some cases I am in control of both end points, but not in all cases.  Sometimes I need to use services provided by third parties from affected workstations.</p>
<p>I suspect there is some sort of inspection on TLS traffic at my University since last summer, as I am unable to log into a few servers that run OpenBSD and pf (using /etc/pf.os to allow access from other OpenBSD hosts only).  These machines reject access from my OpenBSD-based workstations at the University now, while other ones placed outside that network are allowed.  I suspect the University is using the FortiGates to inspect TLS traffic.</p>
<p>No one of these workstations have digital certificates owned by the University, but the problem looks deeper that just traffic normalization.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343697">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343697">
						November 23, 2019 7:32 PM					</a>

				</p>

				<p>@Dan: No shock, many organisations operate under regulatory requirements to monitor traffic in their facilities, financial institutions being an immediate example.  This is standard practice, there&#8217;s nothing shocking about it, they&#8217;ve been doing it for decades (long before SSL, e.g. with keystroke-level auditing of everything done on the banking mainframe).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343698">

			<div class="comment by-megalomaniac-corporate-boss ">

				<p class="commentcredit">

					<span class="commenter">Megalomaniac Corporate Boss</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343698">
						November 23, 2019 7:44 PM					</a>

				</p>

				<blockquote><p>Transport Layer Security Inspection (TLSI), also known as TLS break and inspect, is a security process that allows enterprises to decrypt traffic, inspect the decrypted content for threats, and then re-encrypt the traffic before it enters or leaves the network.</p></blockquote>
<p>Anyone with a corporate &#8220;management&#8221; level of clearance or higher has access to TLS-encrypted traffic on a &#8220;must have&#8221; basis without end-user or consumer permission.</p>
<p>This has always been the case since who knows how many x.509 root CAs are trusted by the average web browser by default.</p>
<p>It&#8217;s a bit like the town locksmith and municipal police department with access to all the local brick-and-mortar businesses as well as, nowadays, their video cameras and computerized inventory control systems.</p>
<p>But much, much worse, because hackers from around the world are always busy in the comfort and privacy of their own homes social-engineering and cracking into anything online.</p>
<p>They downgrade the security because guns are banned, hate speech is banned, marijuana&#8217;s legal, there&#8217;s plenty of peace and love to go around, and hackers are just experimenting, not harming your business like real skinhead crackers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343699">

			<div class="comment by-firefly ">

				<p class="commentcredit">

					<span class="commenter">Firefly</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343699">
						November 24, 2019 2:43 PM					</a>

				</p>

				<p>I understand the matter in focus are products like Blue Coat:<br />
<a href="https://www.symantec.com/products/proxy-sg-and-advanced-secure-gateway" rel="nofollow ugc">https://www.symantec.com/products/proxy-sg-and-advanced-secure-gateway</a></p>
<p>I work for a corporate where a &#8220;fake&#8221; root CA was distributed to and installed on all machines, making the browsers believe fake TLS certificates. These are created on the fly for various sites.</p>
<p>A user does not see any warning on his side. Only when inspecting the certificate, it is visible that it was created and signed by Blue Coat.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343700">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343700">
						November 25, 2019 2:19 AM					</a>

				</p>

				<p>What would be the difference between so called &#8220;TLS inspection&#8221; and hacking/cracking?</p>
<p>&#8216;TLS inspection&#8217; was quoted as being &#8220;a process&#8221;, which sounds awefully vague to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343701">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343701">
						November 25, 2019 2:22 AM					</a>

				</p>

				<p>To correct my former post:</p>
<p>&#8220;a security process&#8221; should have been the more correctly worded quotation from the original post at the top, in my post just above, not just the phrase &#8220;a process&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343702">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343702">
						November 25, 2019 11:16 AM					</a>

				</p>

				<p>@Firefly</p>
<p>As was pointed out in the comments, if you fear you&#8217;re being monitored in a corporate environment without any warning, then download a browser like Firefox that comes with its own certificates and browse familiar sites. If you get a popup that the certificate is not recognized then you know you&#8217;re being MITM&#8217;ed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343703">

			<div class="comment by-firefly ">

				<p class="commentcredit">

					<span class="commenter">Firefly</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343703">
						November 25, 2019 11:25 AM					</a>

				</p>

				<p>@joe,</p>
<p>Firefox, as well as chrome, are both respecting any customized CA installed on the OS level.<br />
It is a valid feature, abused by the corporate.</p>
<p>Personally I&#8217;m using my private phone for private transactions such as banking. Another habit is to peek on the certificate signature before forms submition.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343704">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">ME</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343704">
						November 26, 2019 4:14 AM					</a>

				</p>

				<p>@James</p>
<p>I wouldn&#8217;t call it a &#8220;backdoor&#8221;, TLS inspection is just a user friendly name for good &#8216;ol MITM attack. It more than doubles the amount of attack vectors. It adds one more TLS session with all its attack vectors and adds new attack vectors on inspection process and server/CPU/VM it&#8217;s running on.</p>
<p>&#8220;Playing with fire&#8221; fits perfectly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343705">

			<div class="comment by-pocono-chuck ">

				<p class="commentcredit">

					<span class="commenter">Pocono Chuck</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343705">
						November 26, 2019 6:53 AM					</a>

				</p>

				<p>So does TLSI break VPNs?  Or would that only work if the CA is faked?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343706">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343706">
						November 26, 2019 3:09 PM					</a>

				</p>

				<p>@ Curious</p>
<p>&#8220;What would be the difference between so called &#8220;TLS inspection&#8221; and hacking/cracking?&#8221;</p>
<p>Money, time, resources.</p>
<p>Big players have that.</p>
<p>Hackers, script kiddies, not so much.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343707">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343707">
						November 26, 2019 5:51 PM					</a>

				</p>

				<p>@ Pocono Chuck</p>
<p>Yes. And Yes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343708">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343708">
						November 26, 2019 10:48 PM					</a>

				</p>

				<p>@Pocono Chuck<br />
If they have the private key, they can decode the traffic from the handshake etc, if you are asking if someone is parrellel not actual mitm then you can as a attacker make them use you key, but if you are mitm and give the client and website your key, they will have to use other means to detect the tap, one send them wrong encryption data with TTL or number of hops before drop and if it disappears. Set the MTU max trimsion unit to a low value and see if the webserver asks to increase it, and also timing. If the webserver is under you control, you can set up a verification system, not necessary using know each public key. You can use the webserver selection of port number, well client to workout os</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343709">

			<div class="comment by-humdee ">

				<p class="commentcredit">

					<span class="commenter">Humdee</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343709">
						November 28, 2019 11:39 AM					</a>

				</p>

				<p>Uh, Mike</p>
<p>It is Mallory, of course, because she perfectly captures that DC Spirit.</p>
<p><a href="https://en.m.wikipedia.org/wiki/Mallory_Pugh" rel="nofollow ugc">https://en.m.wikipedia.org/wiki/Mallory_Pugh</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343710">

			<div class="comment by-ambrose-eslick ">

				<p class="commentcredit">

					<span class="commenter">Ambrose Eslick</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343710">
						November 28, 2019 11:57 AM					</a>

				</p>

				<p>There seems to be some misunderstanding about how TLSI works and the kind of impact / scalability we can expect.</p>
<p>Before panic runs wild: TLSI only works if someone (e.g. your company&#8217;s sysadmin) has installed the right kind of CA in your box. If your computer does not have the right CA, TLSI won&#8217;t work. No: an ISP can&#8217;t flick a switch and perform instant TLSI on all its customers.</p>
<p>In a nutshell: it&#8217;s basically the technology that Bluecoat have been selling for ages, and yes: using your own browser to circumvent the pre-configured CA will break the chain. In particular, Tor-Browser (ideally with a bridge) will do the trick nicely.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343711">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343711">
						November 28, 2019 12:14 PM					</a>

				</p>

				<p>@ Ambrose Eslick</p>
<p>Apparently you can&#8217;t use &#8220;your own&#8221; browser or just any browser. As you correctly mentioned the Tor bundled browser would work. But downloading any browser out there thinking it will bypass TLSI won&#8217;t work, as they respect the already installed OS level certificates.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343712">

			<div class="comment by-mxrip ">

				<p class="commentcredit">

					<span class="commenter">MxRip</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343712">
						November 28, 2019 2:34 PM					</a>

				</p>

				<p>An off-the-shelf installation of Firefox on a &#8220;compromised&#8221; OS wont bypass TLSI, but you will get a warning message (something along the lines of: unrecognized or misconfigured certificate, are you sure you want to continue?). The Tor browser would bypass TLSI.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343713">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343713">
						November 28, 2019 6:14 PM					</a>

				</p>

				<p>@ MxRip</p>
<p>Unfortunately you won&#8217;t even get a warning popup message if you install a regular browser on a &#8220;compromised&#8221; system. As was indicated earlier, these browsers respect the installed OS level certificates. You won&#8217;t be warned, but you can look at the certificate in the page padlock icon to see if there&#8217;s anything funny going on. The only other option is to use Tor browser.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343714">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343714">
						November 29, 2019 3:26 PM					</a>

				</p>

				<p>Do not use Tor in corp env.</p>
<p>Just don&#8217;t.</p>
<p>You will stand out like a sore thumb.</p>
<p>Only use corp VPN if off-site and doing actual work.</p>
<p>Otherwise, if off-site, you takes your chances.</p>
<p>But, I still say, no VPN or Tor.</p>
<p>Just be part of the noise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343715">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343715">
						November 30, 2019 2:30 AM					</a>

				</p>

				<p>@ SpaceLifeForm,</p>
<blockquote><p>But, I still say, no VPN or Tor. Just be part of the noise.</p></blockquote>
<p>&#8220;Hiding in the noise&#8221; is all we&#8217;ve got currently, and it&#8217;s no where near good enough.</p>
<p>Tor could be so much better but this century it&#8217;s pretty much been &#8220;to little to late&#8221;.</p>
<p>We know how to make things way better but&#8230;</p>
<p>I guess people should be asking &#8220;Why?&#8221; but they either don&#8217;t ask or they get ignored.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343716">

			<div class="comment by-charette ">

				<p class="commentcredit">

					<span class="commenter">Charette</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343716">
						December 1, 2019 9:46 AM					</a>

				</p>

				<p>@ SpaceLifeForm</p>
<p>I have been using tor in my workplace for over a decade. I guess I probably do stand out like a sore thumb to the IT guys, but I don&#8217;t care because I use tor for privacy, not to commit any illegal activity. If I ever had to do something nefarious more discretely (and for some bizarre reason I decided my office was the place to do it), it would probably be a different story.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343717">

			<div class="comment by-atastore ">

				<p class="commentcredit">

					<span class="commenter">AtAStore</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343717">
						December 1, 2019 4:58 PM					</a>

				</p>

				<p>@Charette, SpaceLifeForm</p>
<p>&#8220;&#8230; for privacy &#8230;&#8221;</p>
<p>You&#8217;ve probably already considered cameras, keystroke loggers, etc., and if you are in the USA, AFAIK, you have very little in the way of rights regarding employers&#8217; surveillance of their employees.</p>
<p>Anybody want to flesh out what etc. might include?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343718">

			<div class="comment by-trx ">

				<p class="commentcredit">

					<span class="commenter">TRX</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343718">
						December 3, 2019 11:05 AM					</a>

				</p>

				<h2>&gt; I, you can always download a browser like Firefox/Chrome yourself</h2>
<p>Except the ones preinstalled in Firefox in your fresh download are pwned and haXORed to start with.  Some of them are only &#8220;questionable.&#8221;</p>
<h2>&gt; Call me nïeve, uninformed, or whatever, but this is basically saying TLS can&#8217;t be considered remotely secure?</h2>
<p>The basic idea of TLS wasn&#8217;t too bad, but the system broke down due to lack of trust with the Certificate Authorities.</p>
<p>In practice, it&#8217;s like using an escrow account, except instead of using only a trusted bank or broker, you include any random crackhead who says he&#8217;s trustworthy.</p>
<p>TLS is better than nothing &#8211; at least it keeps casual snoopers at bay &#8211; but it would be unwise to have that as your only security if your data is important.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343719">

			<div class="comment by-b ">

				<p class="commentcredit">

					<span class="commenter">B</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343719">
						December 3, 2019 4:08 PM					</a>

				</p>

				<p><a href="https://blog.torproject.org/security-vulnerability-found-cyberoam-dpi-devices-cve-2012-3372" rel="nofollow ugc">https://blog.torproject.org/security-vulnerability-found-cyberoam-dpi-devices-cve-2012-3372</a><br />
Examination of a certificate chain generated by a Cyberoam DPI device shows that all such devices share the same CA certificate and hence the same private key. It is therefore possible to intercept traffic from any victim of a Cyberoam device with any other Cyberoam device &#8211; or to extract the key from the device and import it into other DPI devices, and use those for interception.</p>
<p>I&#8217;ve heard that Cyberoam (which is now Sophos, btw) is not the only proxy with this issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343720">

			<div class="comment by-jeffrey-deutsch ">

				<p class="commentcredit">

					<span class="commenter">Jeffrey Deutsch</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343720">
						December 8, 2019 12:54 PM					</a>

				</p>

				<p>How secure do you consider Gmail&#8217;s TLS? And what would you be willing to email over that?</p>
<p>Does it make a difference whether it&#8217;s on a laptop/desktop using Windows or a smartphone or tablet using Android?</p>
<p>(I&#8217;m talking about ordinary personal Gmail, not G Suite.)</p>
<p>PS: Thanks, RealFakeNews and TRX!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343721">

			<div class="comment by-matthijs-van-duin ">

				<p class="commentcredit">

					<span class="commenter">Matthijs van Duin</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343721">
						December 15, 2019 9:57 AM					</a>

				</p>

				<blockquote><p>Call me nïeve, uninformed, or whatever, but this is basically saying TLS can&#8217;t be considered remotely secure?</p></blockquote>
<p>You misunderstood. TLS interception requires that the client systems trust the key used by the TLS middlebox. System administrators that want to use TLS interception on their network have to install a custom* root CA on each client system whose TLS traffic they want to intercept.</p>
<blockquote><p>Is there any way to avoid the effective use TLSI?</p></blockquote>
<p>TLSI can&#8217;t be used against you unless the custom* root CA certificate for the TLSI middlebox is installed on your computer. This is typically only done on company-owned computers where the company wants to do TLSI.</p>
<p>Footnote:<br />
* TLSI using public roots has happened on rare occasion, but it tends to be detected quickly and to cause the certificate authority responsible to be distrusted by browsers, effectively revoking all certs issued directly or indirectly by that root. This is obviously not something any certificate authority wants to happen to them, considering the long and arduous process of getting trusted in the first place.</p>
<p>Chrome has also introduced a new way to protect against misbehaviour of certificate authorities (including TLSI) called &#8220;Certificate Transparency&#8221; (CT), which requires certificates to carry cryptographic proof that they&#8217;ve been submitted to public logs. Needless to say, this makes certificate misissuance especially risky since proof of it will forever be on public record.</p>
<p>Unfortunately, the CT requirement can currently still be worked around by backdating the certificate to make it appear to be issued before this requirement went into effect (30 April, 2018), but this will cease to be possible 1 June, 2021.</p>
<p>None of this applies to custom roots obviously.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343722">

			<div class="comment by-fabrizio ">

				<p class="commentcredit">

					<span class="commenter">Fabrizio</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/#comment-343722">
						January 15, 2020 12:55 AM					</a>

				</p>

				<p>Link to pdf changed:</p>
<p><a href="https://media.defense.gov/2019/Dec/16/2002225460/-1/-1/0/INFO%20SHEET%20%20MANAGING%20RISK%20FROM%20TRANSPORT%20LAYER%20SECURITY%20INSPECTION.PDF" rel="nofollow ugc">https://media.defense.gov/2019/Dec/16/2002225460/-1/-1/0/INFO%20SHEET%20%20MANAGING%20RISK%20FROM%20TRANSPORT%20LAYER%20SECURITY%20INSPECTION.PDF</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2019/11/the_nsa_warns_o.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2019/11/the_nsa_warns_o.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Fthe_nsa_warns_o.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2019/11/the_nsa_warns_o.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12306' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2019/11/gps_manipulatio.html" rel="prev">← GPS Manipulation</a>		<a href="https://www.schneier.com/blog/archives/2019/11/friday_squid_bl_704.html" rel="next">Friday Squid Blogging: T-Shirt →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
