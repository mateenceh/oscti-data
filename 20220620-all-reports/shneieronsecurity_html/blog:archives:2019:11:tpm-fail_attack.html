<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>TPM-Fail Attacks Against Cryptographic Coprocessors - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; TPM-Fail Attacks Against Cryptographic Coprocessors Comments Feed" href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12301" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12301' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Ftpm-fail_attack.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Ftpm-fail_attack.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12301 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12301" class="post-12301 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-cryptography tag-hardware tag-keys tag-tpm">

	<div class="article">

		<h2 class="entry">TPM-Fail Attacks Against Cryptographic Coprocessors</h2>
		<p>Really interesting research: <a href="http://tpm.fail/tpmfail.pdf">TPM-FAIL: TPM meets Timing and Lattice Attacks</a>, by Daniel Moghimi, Berk Sunar, Thomas Eisenbarth, and Nadia Heninger.</p>
<blockquote><p><b>Abstract:</b> Trusted Platform Module (TPM) serves as a hardware-based root of trust that protects cryptographic keys from privileged system and physical adversaries. In this work, we per-form a black-box timing analysis of TPM 2.0 devices deployed on commodity computers. Our analysis reveals that some of these devices feature secret-dependent execution times during signature generation based on elliptic curves. In particular, we discovered timing leakage on an Intel firmware-based TPM as well as a hardware TPM. We show how this information allows an attacker to apply lattice techniques to recover 256-bit private keys for ECDSA and ECSchnorr signatures. On Intel fTPM, our key recovery succeeds after about1,300 observations and in less than two minutes. Similarly, we extract the private ECDSA key from a hardware TPM manufactured by STMicroelectronics, which is certified at CommonCriteria (CC) EAL 4+, after fewer than 40,000 observations. We further highlight the impact of these vulnerabilities by demonstrating a remote attack against a StrongSwan IPsecVPN that uses a TPM to generate the digital signatures for authentication. In this attack, the remote client recovers the server&#8217;s private authentication key by timing only 45,000 authentication handshakes via a network connection.</p>
<p>The vulnerabilities we have uncovered emphasize the difficulty of correctly implementing known constant-time techniques, and show the importance of evolutionary testing and transparent evaluation of cryptographic implementations.Even certified devices that claim resistance against attacks require additional scrutiny by the community and industry, as we learn more about these attacks.</p></blockquote>
<p>These are real attacks, and take between 4-20 minutes to extract the key. Intel has a <a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00241.html">firmware update</a>.</p>
<p>Attack <a href="http://tpm.fail/">website</a>. <a href="https://www.zdnet.com/article/tpm-fail-vulnerabilities-impact-tpm-chips-in-desktops-laptops-servers/">News</a> <a href="https://www.bleepingcomputer.com/news/security/tpm-fail-security-flaws-impact-modern-devices-with-intel-cpus/">articles</a>. Boing Boing <a href="https://boingboing.net/2019/11/14/descartes-destroyed.html">post</a>. Slashdot <a href="https://it.slashdot.org/story/19/11/13/1837225/tpm-fail-vulnerabilities-impact-tpm-chips-in-desktops-laptops-servers">thread</a>. </p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/tpm/" rel="tag">TPM</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html" rel="bookmark">Posted on November 15, 2019 at 9:36 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html#comments">13 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html" data-title="TPM-Fail Attacks Against Cryptographic Coprocessors" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-343434">

			<div class="comment by-ross-snider ">

				<p class="commentcredit">

					<span class="commenter">Ross Snider</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343434">
						November 15, 2019 12:08 PM					</a>

				</p>

				<p>I&#8217;d really like to see implementation security considered a critical security feature for the selection criteria of contest ciphers.</p>
<p>Implementation security would measured assuming non-expert implementers will develop the most naive versions of the cryptographic codes (e.g. using look up tables for S-boxes, and failing to validate special cases like points in subgroups).</p>
<p>A good example are ed25519&#8217;s Edwards&#8217; Curves, whose default naive implementation is timing oracle free.</p>
<p>While the conventional wisdom is that only security experts should implement cryptography, the reality is that this is both unenforceable and unverifiable. Further, security experts implementing these systems under the review and assurance structures of multi-billion dollar organizations, checked and certified by industry bodies <em>still</em> make these kinds of mistakes.</p>
<p>There was some interesting research at NYU on leakage resistant cryptography I saw around 2011 (security model assumes a certain rate of private bit leakage through unspecified means), but I haven&#8217;t kept up with that. These kinds of lines of research to me seem promising.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343435">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343435">
						November 15, 2019 4:19 PM					</a>

				</p>

				<p>@ ALL,</p>
<p>From the article,</p>
<ul><i>Our analysis reveals that some of these devices feature secret-dependent execution times during signature generation based on elliptic curves. In particular, we discovered timing leakage on an Intel firmware-based TPM as well as a hardware TPM.</i></ul>
<p>In other words &#8220;A know implementation fault opening up time based side channels that leak keyMat&#8221;.</p>
<p>Such time based side channels havr been known about publically since the 1980&#8217;s when they became glaringly obvious in that French idea that became the &#8220;Smart Card&#8221; which later became the foundations of your mobile phone SIM and bank cards.</p>
<p>The AES contest was in effect rigged to make the code produced as side channel ridden as possible, and such side channels were in public crypto libraries that were still in use till faorly recently.</p>
<p>There realy is no excuse for Intel to be pushing out such obviously insecure dross. Thus the question arises as to,</p>
<ul>Who put these faults in? And why did nobody find them diring test etc.</ul>
<p>Put simply many will think this should not have happened without quite deliberate intent or collusion with the likes of the NSA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343436">

			<div class="comment by-steven-clark ">

				<p class="commentcredit">

					<span class="commenter">Steven Clark</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343436">
						November 15, 2019 5:06 PM					</a>

				</p>

				<p>That&#8217;s a lot of signatures to get out of a TPM key.  An attacker who can make this happen necessarily is already running commands or code on the host (unless a network daemon is providing a &#8220;free signatures&#8221; service).  So it&#8217;s not an in so much as a way to make a bad situation worse, like a supply chain attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343437">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343437">
						November 15, 2019 5:35 PM					</a>

				</p>

				<p>@Steven Clark</p>
<p>It leaks, you do not need local access.</p>
<p>A network server, (think web server), can leak the bits.   Slowly, and surely, it will reveal the private key.</p>
<p>It&#8217;s just a matter of traffic and time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343438">

			<div class="comment by-assembly-language ">

				<p class="commentcredit">

					<span class="commenter">Assembly Language</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343438">
						November 15, 2019 7:11 PM					</a>

				</p>

				<p><a href="https://www.felixcloutier.com/x86/cmovcc" rel="nofollow ugc">https://www.felixcloutier.com/x86/cmovcc</a><br />
<a href="https://mudongliang.github.io/x86/html/file_module_x86_id_34.html" rel="nofollow ugc">https://mudongliang.github.io/x86/html/file_module_x86_id_34.html</a><br />
<a href="https://stackoverflow.com/questions/30150274/purpose-of-cmove-instruction-in-x86-assembly" rel="nofollow ugc">https://stackoverflow.com/questions/30150274/purpose-of-cmove-instruction-in-x86-assembly</a></p>
<p>The &#8220;CMOVcc&#8221; instructions of the x86 architecture, e.g., appear to be intended (or at least ought to be able) to provide constant-time execution for algorithms designed free of key-dependent conditional branches.</p>
<p>The problem then becomes that of key-dependent fetches of S-box information and the like which may or may not be cached at any particular level by the microprocessor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343439">

			<div class="comment by-thoth ">

				<p class="commentcredit">

					<span class="commenter">Thoth</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343439">
						November 15, 2019 10:59 PM					</a>

				</p>

				<p>TPMs and smartcards are typically not immune to timing attacks. If you observe the Protection Profile for TPMs and Smartcards, it only mentions attacks on power lines (SPA and DPA) and fault injection attacks (SFA) for cards with higher level of certification. Timing attacks are omitted.</p>
<p>Its down to the security policies and their requirements because all manufacturers will only put in enough resources and R&amp;D to achieve whatever the Protection Profile requires them to do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343440">

			<div class="comment by-gunter-konigsmann ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.peterpall.de' rel='external nofollow ugc' class='url'>Gunter Königsmann</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343440">
						November 16, 2019 3:32 AM					</a>

				</p>

				<p>@Steven Clark: The problem is that your web browser and all of its plugins execute local code. And that the cloud services you might be using do the same, potentially for many clients on the same computer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343441">

			<div class="comment by-jonknowsnothing ">

				<p class="commentcredit">

					<span class="commenter">JonKnowsNothing</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343441">
						November 16, 2019 10:41 AM					</a>

				</p>

				<p>@Clive Robinson @All</p>
<p>@All</p>
<blockquote><p>a remote attack against a StrongSwan IPsecVPN that uses a TPM to generate the digital signatures for authentication. In this attack, the remote client recovers the server&#8217;s private authentication key by timing only 45,000 authentication handshakes via a network connection.   </p></blockquote>
<p>@Clive</p>
<blockquote><p>Put simply many will think this should not have happened without quite deliberate intent or collusion with the likes of the NSA. </p></blockquote>
<p>iirc</p>
<p>Snowden docs detailed how the NSA can crack a ridiculous amount of VPNs in a depressingly small amount of time.</p>
<p>I would hazard our insecurities both physical and psychological can be laid at the dirty feet of the NSA.  The Dirty Hands are the CIAs.</p>
<p>What about the Brits? Well&#8230; the NSA ran the show, the 5EY were useful (F)(T)ools.  They are so much easier to control now, all you have to do is wave a Bankrupt&#8217;s Golf Course at them&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343442">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343442">
						November 17, 2019 1:14 PM					</a>

				</p>

				<p>It is not clear to me&#8230; after applying the firmware upgrades &mdash;to these systems lucky enough to get the upgrades from the manufacturer&mdash; are the TPM coprocessors immune to timing and lattice attacks or is it just another hardware workaround against an specific implementation of an attack technique?</p>
<p>I do not care if these attacks are consequence of lazy development or the inner work of a intelligence agency (a north american, chinese or russian one, who cares?); discovering, and fixing, these side channels are great news.</p>
<p>Let me play devil&#8217;s advocate&#8230; I do not think this one is a backdoor introduced by the NSA; the U.S. Government has been requesting for years systems that include TPM chips.  It is a requirement to win a U.S. Government contract.  I think it is just a matter of lazy development techniques.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343443">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343443">
						November 17, 2019 1:59 PM					</a>

				</p>

				<p>@Who?</p>
<blockquote><p>are the TPM coprocessors immune to timing and lattice attacks</p></blockquote>
<p>Not all TPMs are created equal. Some have more measures of protection than others.</p>
<blockquote><p>I do not care if these attacks are consequence of lazy development</p></blockquote>
<p>One possibility, out of many. See the last response.</p>
<blockquote><p> the inner work of a intelligence agency (<b>a north american</b>, chinese or russian one, who cares?);</p></blockquote>
<p>Highly unlikely.</p>
<blockquote><p><b>I do not think</b> this one is a backdoor introduced by the NSA; </p></blockquote>
<p>Niether do I.</p>
<blockquote><p>Government has been requesting for years systems that include TPM chips. It is a requirement to win a U.S. Government contract</p></blockquote>
<p>Right.</p>
<blockquote><p> I think it is just a matter of lazy development techniques.</p></blockquote>
<p>Possible, plus some known reasons:</p>
<ul>
<li>HW TPMs are extremely limited in resources, and several optimizations result in some weaknesses</li>
<li>HW Manufacturers are under constant pressure to reduce cost and remain competitive, so they need to support additional features with more dwindling resources</li>
<li>Some time optimizations in generating RSA key-pairs resulted&#8211;without mentioning names&#8211;in weaknesses that subsequently made the manufacturer revert the optimizations</li>
</ul>
<p>Many moons ago, I was aware that some PC manufacturers had to use some optimization techniques (lack of resources and ROM space) that caused some weaknesses. These weaknesses were within the &#8220;acceptable risk appetite&#8221; for the use-case. They were not backdoors, by any means. And they could not have been used for backdoors.</p>
<p>Three things to keep in mind:</p>
<ol>
<li>Nothing is perfectly secure</li>
<li>TPMs were not designed to be HW crypto-processors or crypto accelerators</li>
<li>TPMs mainly introduce a HW (in case of HW TPMs, and some fTPM implementations) root of trust (RoT) that&#8217;s used as a primitive building block to facilitate the means to cryptographically prove to a challenger the state of the platform.</li>
</ol>
<p>Previous related  discussions: <a href="https://www.schneier.com/blog/archives/2016/03/possible_govern.html" rel="nofollow ugc">here</a>, and <a href="https://www.schneier.com/blog/archives/2015/01/friday_squid_bl_458.html" rel="nofollow ugc">there</a>. There were many others&#8230; this is sufficent, though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343444">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343444">
						November 18, 2019 1:57 PM					</a>

				</p>

				<p>Hi Wael.</p>
<p>Thanks a lot for the comments and the links to older threads.  Very instructive.  I like the second link a lot, and found valuable information on it.</p>
<p>Indeed, you are right.  First TPMs were used to store hashes of hardware and software configurations (BIOS, CMOS, NVRAM and SMBIOS) only; over the time it has become a sort of full-featured secure cryptographic processor.  You have a very good point about the limited resources available for these cryptoprocessors.  Lack of resources impact on its ability to do its work on a secure manner.</p>
<p>Optimizing performance on a limited resource cryptoprocessor usually means opening a door to serious timing-related attacks.  It is hard to explain to customers, but a cryptographic framework should do all cryptographic operations in the same amount of time.  It means making them as expensive as the slowest of these operations.  It is usually bad as is, but it becomes worse on a slow device.</p>
<p>Hope the industry will be able to close all these side channels, not just hide them, even if it makes TPMs slower.  I do not really care about performance when we are talking about security.</p>
<p>The example concerning VPNs is impressive.  It seems that we will need to protect the ends of a VPN in a way connections can only be established from other, trusted, end points.  By now I understand some networks whose end points cannot be fixed by a firmware upgrade will need to move to software-only VPN implementations.</p>
<p>At least we know a few more industry-wide vulnerabilities now, how fixing them (ok, iff a firmware upgrade is available) and we have some idea how certain supposedly secure VPNs can be breached.  This knowledge itself is a win for the security community.  Don&#8217;t you agree?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343445">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343445">
						November 18, 2019 9:07 PM					</a>

				</p>

				<p>@Who?</p>
<blockquote><p> This knowledge itself is a win for the security community. Don&#8217;t you agree?</p></blockquote>
<p>More than agree. It&#8217;s good for the security community, for hackers (crackers,) for spooks, &#8230; perhaps not so good for the manufacturers?</p>
<p>Then again, it may be bad for everyone 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343446">

			<div class="comment by-steven-clark ">

				<p class="commentcredit">

					<span class="commenter">Steven Clark</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/#comment-343446">
						November 21, 2019 6:42 PM					</a>

				</p>

				<p>@JonKnowsNothing et al. That&#8217;s 45000 signatures, over a presumably low-jitter connection, to an as-I-called-it &#8220;free signatures&#8221; service.  Using an HSM or TPM directly for a key getting used by a network service may turn out to also be a bad idea no matter what is implementing the engine.  I still have doubts about timing attacks run over the Internet instead of GbE.  Yes this is bad but the TPM implementers aren&#8217;t the only weak links in this chain, and there are some nice restrictions on the attack to slow this thing in the wild until people get patched.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2019/11/tpm-fail_attack.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2019/11/tpm-fail_attack.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Ftpm-fail_attack.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2019/11/tpm-fail_attack.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12301' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2019/11/upcoming_speaki_9.html" rel="prev">← Upcoming Speaking Engagements</a>		<a href="https://www.schneier.com/blog/archives/2019/11/friday_squid_bl_703.html" rel="next">Friday Squid Blogging: Planctotuethis Squid →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
