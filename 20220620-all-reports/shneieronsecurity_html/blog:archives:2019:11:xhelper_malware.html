<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>XHelper Malware for Android - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; xHelper Malware for Android Comments Feed" href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12292" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12292' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Fxhelper_malware.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Fxhelper_malware.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12292 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12292" class="post-12292 post type-post status-publish format-standard hentry category-uncategorized tag-advanced-persistent-threats tag-android tag-hacking tag-malware tag-operating-systems tag-symantec">

	<div class="article">

		<h2 class="entry">xHelper Malware for Android</h2>
		<p>xHelper is not interesting because of its infection mechanism; the user has to side-load an app onto his phone. It&#8217;s not interesting because of its payload; it seems to do nothing more than show unwanted ads. it&#8217;s interesting because of its <a href="https://www.zdnet.com/article/new-unremovable-xhelper-malware-has-infected-45000-android-devices/">persistence</a>:</p>
<blockquote><p>Furthermore, even if users spot the xHelper service in the Android operating system&#8217;s Apps section, removing it doesn&#8217;t work, as the trojan reinstalls itself every time, even after users perform a factory reset of the entire device.</p>
<p>How xHelper survives factory resets is still a mystery; however, both Malwarebytes and Symantec said xHelper doesn&#8217;t tamper with system services system apps. In addition, Symantec also said that it was &#8220;unlikely that Xhelper comes preinstalled on devices.&#8221;</p>
<p>In some cases, users said that even when they removed the xHelper service and then disabled the &#8220;Install apps from unknown sources&#8221; option, the setting kept turning itself back on, and the device was reinfected in a matter of minutes after being cleaned.</p></blockquote>
<p>From <a href="https://www.symantec.com/s/threat-intelligence/xhelper-android-malware">Symantec</a>:</p>
<blockquote><p>We first began seeing Xhelper apps in March 2019. Back then, the malware&#8217;s code was relatively simple, and its main function was visiting advertisement pages for monetization purposes. The code has changed over time. Initially, the malware&#8217;s ability to connect to a C&#038;C server was written directly into the malware itself, but later this functionality was moved to an encrypted payload, in an attempt to evade signature detection. Some older variants included empty classes that were not implemented at the time, but the functionality is now fully enabled. As described previously, Xhelper&#8217;s functionality has expanded drastically in recent times.</p>
<p>We strongly believe that the malware&#8217;s source code is still a work in progress.</p></blockquote>
<p>It&#8217;s a weird piece of malware. That level of persistence speaks to a nation-state actor. The continuous evolution of the malware implies an organized actor. But sending unwanted ads is far too noisy for any serious use. And the infection mechanism is pretty random. I just don&#8217;t know.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/advanced-persistent-threats/" rel="tag">advanced persistent threats</a>, <a href="https://www.schneier.com/tag/android/" rel="tag">Android</a>, <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/symantec/" rel="tag">Symantec</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html" rel="bookmark">Posted on November 8, 2019 at 6:10 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html#comments">84 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html" data-title="xHelper Malware for Android" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-343197">

			<div class="comment by-alejandro ">

				<p class="commentcredit">

					<span class="commenter">Alejandro</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343197">
						November 8, 2019 6:36 AM					</a>

				</p>

				<p>Maybe it&#8217;s just beta test tweaking to make sure it works until  the BIG DAY arrives to &#8230;I don&#8217;t know&#8230;brick, everyone?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343198">

			<div class="comment by-a-nony ">

				<p class="commentcredit">

					<span class="commenter">A Nony</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343198">
						November 8, 2019 6:41 AM					</a>

				</p>

				<p>Or this is a modern-day example of robinhood and friartuck, and that was written by folks a Motorola 30 years ago.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343199">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343199">
						November 8, 2019 7:03 AM					</a>

				</p>

				<p>@ Bruce, ALL,</p>
<blockquote><p> I just don&#8217;t know.</p></blockquote>
<p>Such is the joy or not of cyber-attribution.</p>
<p>I&#8217;m glad you and others are now feeling it&#8217;s safe to say.</p>
<p>It&#8217;s a sign the industry is starting to become more mature in it&#8217;s behaviours.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343200">

			<div class="comment by-victor-wagner ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://wagner.pp.ru/~vitus' rel='external nofollow ugc' class='url'>Victor Wagner</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343200">
						November 8, 2019 7:27 AM					</a>

				</p>

				<p>I suspect, that it is Google itself behind this malware. And main purpose of it is to scare users from installing apps from third party sites.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343201">

			<div class="comment by-k-s ">

				<p class="commentcredit">

					<span class="commenter">K.S.</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343201">
						November 8, 2019 8:10 AM					</a>

				</p>

				<p>@Victor Wagner</p>
<p>If we are doing paranoid conspiracies, a much better story would be if Apple is behind this malware to show how insecure the entire Android platform is. Such persistence should not be possible in a well-functioning OS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343202">

			<div class="comment by-h-e ">

				<p class="commentcredit">

					<span class="commenter">H. E.</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343202">
						November 8, 2019 9:26 AM					</a>

				</p>

				<p>So a somewhat smart random nobody is totally out of the question? This looks like someone got lucky and now (ab)uses one unique bit likely found by themselves or heard in some murky backwaterchannel. Probably just wrote a line in to unsecured factory reset code. Or another well known but hard to spot vulnerability.</p>
<p>But google does offer brickloads of money for persistence exploits, ought to be known by those holding them, likely they figure to make more money selling ads and owning devices. Google doesn&#8217;t earn much off of old devices, especially those only sideloading apps, bypassing playstore and so forth.</p>
<p>Plenty incentive to run something this nasty to justify making sideloading next to impossible 2020. Didn&#8217;t google sell ads?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343203">

			<div class="comment by-aaron-andrusko ">

				<p class="commentcredit">

					<span class="commenter">Aaron Andrusko</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343203">
						November 8, 2019 9:31 AM					</a>

				</p>

				<p>I suspect it&#8217;s replacing the recovery image with a compromised one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343204">

			<div class="comment by-michael ">

				<p class="commentcredit">

					<span class="commenter">Michael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343204">
						November 8, 2019 11:18 AM					</a>

				</p>

				<p>I read through some of the details online, particularly one Reddit thread provided some insights, and I have a hypothesis. The xHelper malware&#8217;s persistence seems to only affect certain devices which suggests this malware is not using a general Android exploit but rather some other exploit that only works on specific devices. From the Reddit thread, the HTC One X is definitely affected by the persistence while the Galaxy Note 9 is not.</p>
<p>Another user mentioned being able to prevent the malware from reappearing by performing a factory reset and then disabling system update mechanisms immediately afterwards. This suggests that the malware may be infecting the system update mechanism and so the device&#8217;s own update mechanism is simply downloading and installing the malware again after it&#8217;s uninstalled.</p>
<p>Keep in mind that a factory reset merely deletes user data, it doesn&#8217;t reinstall the OS or anything, so malware that infects the system/OS can easily survive a factory reset. One or two users on Reddit suggested that performing a system update can prevent the malware from reappearing, in which case it would be performing a fresh install of the OS and removing the source of the infection. Or perhaps a system update simply patches the exploit this malware is using.</p>
<p>However, the problem I see with my hypothesis is currently nobody actually knows how this malware survives a factory reset. I feel like if this were truly how the malware persists then it should be easy enough to detect but still nobody can explain it yet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343205">

			<div class="comment by-sed-contra ">

				<p class="commentcredit">

					<span class="commenter">Sed Contra</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343205">
						November 8, 2019 12:40 PM					</a>

				</p>

				<p>In view of this and also the current comments on another thread about reappearing messages, I think we have to consider rhe possibility of time travel playing a role.</p>
<p>“There is nothing wrong with your mobile handset. Do not attempt to perform a factory reset. We are controlling transmission &#8230; You&#8217;re travelling through another dimension, a dimension not only of touchscreen and SMS but of mind &#8230; There is a fifth dimension beyond that which is known to humankind. It is a dimension as vast as space and timeless as infinity.”</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343206">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343206">
						November 8, 2019 3:08 PM					</a>

				</p>

				<p>Haven&#8217;t we seen this kind of thing before?  One of the commentators on the ZDNet article mentioned that it affected their low end handset which was locked down (no root, no sideload capabilities, etc.).  This suggests that the malware came with the device already installed and that some OEMs may be collecting on the ad revenue <i>or</i> it&#8217;s a supply chain vulnerability affecting vendors who outsourced the creation of their &#8220;blobs&#8221; and didn&#8217;t adequately review the code.  Since this seems to be wasting a really good exploit on ad redirects, needs to be consciously installed outside of the normal process and that we know about it at all makes me think it;s a little sloppy for a state actor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343207">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343207">
						November 8, 2019 3:09 PM					</a>

				</p>

				<p>A test worth trying to glean info.</p>
<p>Pull SIM, do Factory Reset.</p>
<p>Leave SIM out.  Get on WIFI.</p>
<p>See what happens.</p>
<p>I&#8217;ll bet the problem comes back.</p>
<p>But, maybe not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343208">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343208">
						November 8, 2019 4:25 PM					</a>

				</p>

				<p>@Sed Contra</p>
<p>I would gladly give up the integrity of my Android device(s!) to get in on the Microsoft IPO or, heck, to see the Grateful Dead at the Capitol Theatre.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343209">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343209">
						November 8, 2019 4:55 PM					</a>

				</p>

				<p>@ K.S.,</p>
<blockquote><p>Such persistence should not be possible in a well-functioning OS.</p></blockquote>
<p>That is a mainly invalid assumption on your behalf.</p>
<p>One of the problems with commodity hardware is that there is little or no chance the OS can keep up with the latest hardware additions.</p>
<p>The solution to this was first realy seen at the end of the 1970&#8217;s in the Apple ][, the idea behind the I/O model was later in the 1980&#8217;s adopted by IBM for their Personal Computer range, which were the forerunner of nearly all commodity PC&#8217;s these days. Which is why commodity OS&#8217;s still follow the convention as do a number of other OS&#8217;s some of which are considered &#8220;secure OS&#8217;s&#8221; with formal proofs of security[1]&#8230;</p>
<p>The convention is that an I/O card carries a program ROM on it with the required I/O drivers written in a memory position independent way that will be identified at Boot time by the motherboard BIOS and loaded into known memory addresses in RAM. When the OS boots it clears or overwrites much of the RAM but importantly NOT the areas where I/O drivers are loaded. The OS then runs an initialisation sub routine for each I/O driver in RAM to add interupt and jump point information so the OS can use the I/O device.</p>
<p>If you think back to around the time of BadBIOS, myself and @RobertT pointed out this I/O driver mechanism was an ideal way to get malware persistance that would survive an OS wipe / reinstal on hard drive etc. Further that the use of Flash ROM on I/O devices and the motherboard, without &#8220;write protection&#8221; alowed malware to overwrite any code in the Flash ROMS on either the I/O cards or motherboard&#8230;</p>
<p>A little while later it was found that Chinese Company Lenovo, that had purchased IBM&#8217;s Laptop etc manufacturing, was infact using exactly this technique in the BIOS of their commodity laptops, to add in their own &#8220;marketing malware&#8221;.</p>
<p>Both Microsoft and Linux OS&#8217;s support this I/O Device convention. As Android is based on Linux, the convention or something similar is almost certainly there. Because Google is not going to willingly relinquish the rights to push in technology to support their PII and similar marketable information collection for profit.</p>
<p>[1] The fact an application has formal proofs of security, does not make it secure, it needs formal proofs in the OS, for the ISA, Microcode, RTL, and all layers on down to the physics of the chips&#8230; Otherwise an attack can be launched from a lower level in the computing stack and work it&#8217;s way up the stack, much like a bubble in a champagne glass it&#8217;s effect gets bigger as it rises. Hence the term &#8220;bubbling up attack&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343210">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343210">
						November 8, 2019 5:26 PM					</a>

				</p>

				<p>Right&#8230;</p>
<blockquote><p>However, the problem I see with my hypothesis is currently <b>nobody actually knows</b> how this malware survives a factory reset.</p></blockquote>
<p>Factory reset isn&#8217;t consistent across makes / models of devices. Without mentioning names, some device manufacturers use Integrity Metrics, SE Linux in enforcement mode and don&#8217;t compromise on security because they compete with other platform manufacturers. Some low-end devices only have the minimum level of security that they can get away with. Also, factory resets don&#8217;t delete SD or SIM data. Perhaps xHelper is hiding somewhere on the SD card?</p>
<blockquote><p>How xHelper survives factory resets is still a <b>mystery</b>; however, both Malwarebytes and Symantec said xHelper doesn&#8217;t tamper with system services system apps. In addition, Symantec also said that it was &#8220;unlikely that Xhelper comes preinstalled on devices.&#8221;</p></blockquote>
<p>Something fishy here. Very <i>phishy</i>&#8230; Obviously this news is comming from the marketing departments of these AV solution providers, for promotional purposes. So we&#8217;re supposed to believe that it&#8217;s a mystery &#8212; come on, there&#8217;re only few countable parameters to play with!</p>
<p>From what @Michael said:</p>
<blockquote><p>The xHelper malware&#8217;s persistence seems to only affect certain devices which suggests this malware is not using a general Android exploit but rather some other exploit that only works on specific devices.</p></blockquote>
<p>Yes, there&#8217;re differences in HW, SW, Drivers, etc. Also, there&#8217;re differences how different manufacturers perform factory resets (assuming they are <a href="https://source.android.com/compatibility/cdd" rel="nofollow ugc">CDD devices</a>.) And there could be exploitable weaknesses (backdoors included) on some devices.</p>
<p>Last thing I expected to hear from AV Solotion providers after six months is: &#8220;It&#8217;s a mystery&#8221;! Are you freaking kidding me? goddamnit, <b>@Vesselin Bontchev</b>: tell me <a href="https://www.youtube.com/watch?v=dmnJtU6S5lo" rel="nofollow ugc">something else!</a></p>
<p>I could do analyze it in my sleep! Mystrey, my ankle &#8212; or a little above.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343211">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343211">
						November 8, 2019 6:04 PM					</a>

				</p>

				<p>@Sed Contra,</p>
<blockquote><p> There is a fifth dimension beyond that &#8230;</p></blockquote>
<p>+1 <a href="https://youtu.be/If3SXJeZzMQ" rel="nofollow ugc">The Twilight Zone</a> &#8212; one of my favorite shows!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343212">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343212">
						November 8, 2019 6:17 PM					</a>

				</p>

				<p>@Wael</p>
<p>&#8220;Also, factory resets don&#8217;t delete SD or SIM data.&#8221;</p>
<p>Hmmm, maybe I should post this from my rooted device that has neither SIM or SD?</p>
<p>Not.</p>
<p>More testing please.</p>
<p>We need to find out if the exploit is going thru SS7/SIM or there is already a backdoor  that allows fileless exploit to be loaded via WIFI.</p>
<p>I have reasons to believe it is a fileless exploit.</p>
<p>More testing please.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343213">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343213">
						November 8, 2019 6:47 PM					</a>

				</p>

				<p>@SpaceLifeForm,</p>
<blockquote><p> We need to find out if the exploit is going thru SS7/SIM</p></blockquote>
<p>SS7? There goes my blood-pressure!<br />
SIM? Unlikely, but perhaps not impossible either.</p>
<blockquote><p> I have reasons to believe it is a <b>fileless</b> exploit.</p></blockquote>
<p>I don&#8217;t know which rock or asteroid you came from, but on this Unix planet, everything is a file.</p>
<blockquote><p>More testing please</p></blockquote>
<p>There&#8217;s enough information already. Elementary, my dear SpaceLife<i>Watson</i> 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343214">

			<div class="comment by-alyer-babtu ">

				<p class="commentcredit">

					<span class="commenter">Alyer Babtu</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343214">
						November 8, 2019 9:18 PM					</a>

				</p>

				<p>Could one use execution profiling to figure out what is going on ?</p>
<p>E.g., something like this</p>
<p><a href="https://www.alcf.anl.gov/files/slides%202018-02%20ALCF%20Dev%20Session%20John%20Mellor-Crummey%20HPCToolkit.pdf" rel="nofollow ugc">https://www.alcf.anl.gov/files/slides%202018-02%20ALCF%20Dev%20Session%20John%20Mellor-Crummey%20HPCToolkit.pdf</a></p>
<p>There would be a fair bit of upfront preparation but then one would have a general purpose tool.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343215">

			<div class="comment by-realfakenews ">

				<p class="commentcredit">

					<span class="commenter">RealFakeNews</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343215">
						November 8, 2019 10:40 PM					</a>

				</p>

				<p>Perform a factory reset, then dump the OS image and compare with a clean version?</p>
<p>Why is this so hard? I&#8217;m bored just thinking why they don&#8217;t already know.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343216">

			<div class="comment by-realfakenews ">

				<p class="commentcredit">

					<span class="commenter">RealFakeNews</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343216">
						November 8, 2019 10:43 PM					</a>

				</p>

				<p>Actually&#8230; I&#8217;m fed up with this attribution rubbish.</p>
<p>It&#8217;s always the same &#8211; lacking information and details, for what? A news piece? Do some proper research and just state ALL the facts. Don&#8217;t just look for &#8220;who might&#8217;uv dun it&#8221;.</p>
<p>Dump the BIOS, dump the OS, and compare against known clean copies. There can&#8217;t be many places it is hiding and it must hit the system at some point.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343217">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343217">
						November 9, 2019 1:00 AM					</a>

				</p>

				<p>Android has an interesting filesystem layout in the sense it has quite a few partitions, some writable by end users (i.e. where data and apps are stored) and some digitally signed and, theoretically, unwritable for anyone that does not have the right digital certificate.</p>
<p>Perhaps the author, not necessarily a state actor, has discovered a workaround to overcome this protection.</p>
<p>As I understand it, a factory reset just formats the user filesystems, not the system, cryptographically signed, ones.</p>
<p>My suggestion would be reinstalling the Android operating system from a factory image instead of just doing a factory reset.</p>
<p>There is no magic, just misused technology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343218">

			<div class="comment by-deepview ">

				<p class="commentcredit">

					<span class="commenter">deepview</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343218">
						November 9, 2019 1:20 AM					</a>

				</p>

				<p><b>What isn&#8217;t reset at factory reset?</b></p>
<ul>
<li>supply chain</li>
<li>DNS capture or other MITM</li>
<li>some submodule with its own software</li>
<li>baseband</li>
<li>some baseband 0day</li>
<li>other as yet (open-forensics-)unknown side channel</li>
<li>hardware side channel via THz management module or so, and ubiquitous kraken APs</li>
<li>like, did you look into <b>G.hn</b> homeplug routing technology?!</li>
<li>or something with a new BT or LoraWAN or similar.</li>
</ul>
<p>This obviously is a call to more thourough methods in forensics.</p>
<p>Ads could be a red herring regarding a mole@supplychain or so.</p>
<p>There may be too much complacency because of an illusion of &#8220;someone will do it&#8221; fostered by worldwide-access-induced we-will-ultimately-know-everything illusion. They menace to crack down on whistles so much that this might not be true any more.</p>
<p>Much of research depends on single individuals doing things. In other words, do free forensics, free minds in IT and free speech have enough redundancy?</p>
<p>The hardware supply chain has little redundancy these days, arriving at crazy levels even menacing the power systems of the usual suspects for world domination.</p>
<p>Why would this be different elsewhere? (Please prove me wrong on this last worry.)</p>
<p>We urgently need to replace divisiveness in the minds by <b>universal love</b>.<br />
We need to use tech for that purpose, otherwise it will disappear.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343220">

			<div class="comment by-deepview ">

				<p class="commentcredit">

					<span class="commenter">deepview</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343220">
						November 9, 2019 1:27 AM					</a>

				</p>

				<p>@Wael</p>
<blockquote><p>
  on this Unix planet, everything is a file
</p></blockquote>
<p>This is your weak spot.</p>
<p>An exploit residing in memory resides in a file (like: kmem), but this doesn&#8217;t mean anything because you don&#8217;t learn anything about getting to the root of the problem.</p>
<p>You need to listen better what the other side really wants to express.</p>
<p>As long as you don&#8217;t know everything, don&#8217;t be too sure about yourself.</p>
<p>Clearsightedness comes from humility.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343221">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343221">
						November 9, 2019 1:59 AM					</a>

				</p>

				<p>@ deepview</p>
<p>Wael, one of the most respected members of this forum, is right when he says everything in a Unix system is a file.  Standard files, devices (either block or character ones), domain sockets&#8230; anything from a printer, a keyboard or a framebuffer up to filesystems and disks themselves are files on a Unix system.</p>
<p>This one is the simplicity and beauty of Unix.</p>
<p>By the way, /dev/kmem itself is a file but I fear it does not work in the way you think.  It is a device that acts as an interface to the kernel virtual memory.  Whatever is stored on the smartphone/tablet memory is lost as soon as the device is restarted.</p>
<p>As I said there is not magic, just misused technology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343222">

			<div class="comment by-c-u-anon ">

				<p class="commentcredit">

					<span class="commenter">C U Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343222">
						November 9, 2019 2:15 AM					</a>

				</p>

				<p>@ deepview,</p>
<blockquote><p>An exploit residing in memory resides in a file (like: kmem), but this doesn&#8217;t mean anything because you don&#8217;t learn anything about getting to the root of the problem.</p></blockquote>
<p>Depending on your world view a file tells you precicely nothing but it&#8217;s binary contents. That is it is just another &#8220;bag of bits&#8221; data container.</p>
<p>To learn anything else you have to go to what is often a flat file database known as a &#8220;Directory&#8221; which contains file attribute information and a pointer to the data structure on the storage medium that has further pointers to the individual data blocks.</p>
<p>Now on looking at @Wael&#8217;s posting it was obviously ment to contain a degree of humour not terminological exactitude.</p>
<p>So as you say,</p>
<blockquote><p>You need to listen better [to] what the other side really wants to express.</p></blockquote>
<p>As for,</p>
<blockquote><p>As long as you don&#8217;t know everything, don&#8217;t be too sure about yourself.</p></blockquote>
<p>It&#8217;s not just logically impossible to &#8220;know everything&#8221; it&#8217;s easy enough to show that even the Universe can not store everything there is to know. Which whilst it might appear trite to many has significant implications in certain areas of science and philosophy, as well as practical implications in information security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343223">

			<div class="comment by-deepview ">

				<p class="commentcredit">

					<span class="commenter">deepview</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343223">
						November 9, 2019 2:26 AM					</a>

				</p>

				<p>@Who</p>
<p>The difference between kmem and other files is that certain files sit somewhere where you can observe changes when turning off the device hard.</p>
<p>kmem will be gone.</p>
<p>So mixing the two is relevant from a &#8220;how to read it&#8221; point of view, but is irrelevant here because there might be an observability problem.</p>
<p>So that&#8217;s why I said conflating the practical differences is a weak spot.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343224">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343224">
						November 9, 2019 3:30 AM					</a>

				</p>

				<p>@deepview,</p>
<blockquote><p> This is your weak spot.</p></blockquote>
<p>And your strong spot 😉</p>
<blockquote><p> <b>you don&#8217;t learn anything</b> about getting to the root of the problem.</p></blockquote>
<p>Speak for yourself. The fact that you don&#8217;t has nothing to do whatsoever with others ability to learn something about it.</p>
<blockquote><p> You need to listen better what the other side really wants to express.</p></blockquote>
<p>Repeating to myself: Listen better, other side! &#8230; [100 Times] &#8230; Listen better, other side&#8230; ummmm. myopic view.</p>
<blockquote><p> Clearsightedness comes from humility.</p></blockquote>
<p>I&#8217;m the most humble human on earth.</p>
<blockquote><p> but is irrelevant here because there might be an observability problem.</p></blockquote>
<p>Whiskey Tango Foxtrot are you talking about?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343225">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343225">
						November 9, 2019 5:13 AM					</a>

				</p>

				<p>Is Arm the same as x86 with rings,real/protected mode?</p>
<p>Kmem being virtual should only dump the ring your in, and it won&#8217;t be at the physical address, you&#8217;ll need to call some ram interrupts and copy that to storage, but be in real mode, which only ring 0 can do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343226">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343226">
						November 9, 2019 5:19 AM					</a>

				</p>

				<blockquote><p>
  That level of persistence speaks to a nation-state actor.
</p></blockquote>
<p>Or some kid who&#8217;s discovered an Android 0day that allows persistence.  If it was nation-state they&#8217;d keep something this powerful secret, if it was security researchers they&#8217;d notify Google or sell the exploit depending on their leanings.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343227">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343227">
						November 9, 2019 5:24 AM					</a>

				</p>

				<p>@KS: If we are doing paranoid conspiracies, a much better story would be if Apple is behind this malware</p>
<p>Naah, if we&#8217;re doing conspiracies it has to be the Illuminati.  The ads are just a cover for the fnords.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343228">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343228">
						November 9, 2019 5:49 AM					</a>

				</p>

				<p>Set the coredump to kernel, and crash the Os ,psec had a tool for windows, not sure on Linux.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343229">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343229">
						November 9, 2019 12:12 PM					</a>

				</p>

				<p>Fileless</p>
<p>Is a misnomer.</p>
<p>It&#8217;s means not written to a backing store, examples being spinning rust or flash.</p>
<p>It only exists in ram.</p>
<p>I did not come up the name, but I&#8217;ll bet someone decided that a name like</p>
<p>The-never-written-to-storage-exploit</p>
<p>was deemed too cumbersome.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343230">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343230">
						November 9, 2019 12:13 PM					</a>

				</p>

				<p>@Dave:</p>
<p>I don&#8217;t see any fnords</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343231">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343231">
						November 9, 2019 1:14 PM					</a>

				</p>

				<p>@ SpaceLifeForm. @C U Anon, @Who, @deepview, all</p>
<blockquote><p>Is a misnomer(Fileless.)</p></blockquote>
<p>I understood what you meant the first time. What we&#8217;re discussing here is how malware (adware, or whatever form malcontent takes) persists across Factory Reset cycles, right? Sweet.</p>
<p>@deepview mentioned kmem, observability issues, and:</p>
<blockquote><p>kmem<b> will be gone</b>.</p></blockquote>
<p>Ok, now that it&#8217;s gone: where did it come back from? If not from a <b>file</b> somewhere on local storage, or a <b>file</b> [1] somewhere on a CC server, then from where? It got recreated out of thin air? Sayng &#8220;kmem&#8221; without any further elaboration doesn&#8217;t really answer the &#8220;how does malware persist across Factory Reset cycles&#8221;, does it?</p>
<p>[1] There are other possibilities that I want to avoid in this discussion.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343232">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343232">
						November 9, 2019 2:52 PM					</a>

				</p>

				<p>@Wael</p>
<p>The easy answer, even if no SIM or SD card, is that the malware comes back in via the cell radio or WIFI.</p>
<p>That is, it truly is a fileless exploit.</p>
<p>It may have lots of steps.</p>
<p>But after an hour, it&#8217;s back.</p>
<p>It&#8217;s very important to remember, that even  sans SIM,  the cell radio still works.</p>
<p>This is how one can call 999/911 on an old phone that has no service.</p>
<p>So, testing scenarios is important.</p>
<p>Factory Reset, no WIFI.  Does it reappear?</p>
<p>I have reason to believe, it is a very deeply buried backdoor.   Very deeply buried in silicon.</p>
<p>The computer under the computer under the computer.</p>
<p>Wish I was joking, but I am not.</p>
<p>Turtles all the way down, buried in silicon.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343233">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343233">
						November 9, 2019 3:22 PM					</a>

				</p>

				<p>@Weather</p>
<p>&#8220;Is Arm the same as x86 with rings,real/protected mode?&#8221;</p>
<p>It&#8217;s exactly the same, but different.</p>
<p>ARM has Ring 0 (kernel), and Ring 3 (Userland)</p>
<p>Only your Hairdresser knows for sure what really happens in Ring 1 and Ring 2 on x86_64.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343234">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343234">
						November 9, 2019 3:34 PM					</a>

				</p>

				<p>@SpaceLifeForm,</p>
<blockquote><p>The easy answer, even if no SIM or SD card, is that the malware comes back in via the cell radio or WIFI.</p></blockquote>
<p>First of all, I have not read much about xHelper; I don&#8217;t have the time or desire to do so. What puzzles me is AV Solution providers who claim it&#8217;s a mystery, and I shared my opinion about this earlier. They have the binaries and the devices and made claims that (copied from @Bruce&#8217;s thread details:)</p>
<blockquote><p>however, both Malwarebytes and Symantec said xHelper <b>doesn&#8217;t tamper with</b> system services system apps. In addition, Symantec also said that it was <b>&#8220;unlikely</b> that Xhelper comes preinstalled on devices.&#8221;</p></blockquote>
<p>Why do they give us the impression that they have not gone through narrow-down tests like the ones you mention (and I am sure they have done so, and a lot more)? Several possibilities:</p>
<p><b>1:</b> Responsible disclosure. We&#8217;re basically giving them the benefit of the doubt<br />
<b>2:</b> News came from marketing departments that like to bring their name out for marketing purposes. a little FUD isn&#8217;t too bad for business. Keep in mind that often times Marketing folks do not consult with their technical counterparts before they &#8220;go public&#8221;<br />
<b>3:</b> They were coerced <a href="https://blog.close.com/stfu" rel="nofollow ugc">to take a sip</a><br />
<b>4:</b> They know exactly what&#8217;s going on, but are working on a &#8220;parallel construction&#8221; scenario to attribute the thing to rocket-man or some other boogie person.<br />
<b>5:</b> &#8230; a lot of other possibilities</p>
<p>But what&#8217;s not acceptable is: &#8220;It&#8217;s a mystery&#8221;.</p>
<blockquote><p>This is how one can call 999/911 on an old phone that has no service.</p></blockquote>
<p>Right&#8230; links to previous discussions on SIM-less topics omitted (for clarity.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343235">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343235">
						November 9, 2019 4:18 PM					</a>

				</p>

				<p>Hmmm&#8230;</p>
<blockquote><p>We <b>strongly believe</b> that the malware&#8217;s source code is still a work in progress.</p></blockquote>
<p>Strongly believe, eh? Is that what your scrum master told you in this PI session? And as I said previously:</p>
<blockquote><p><i>They know exactly what&#8217;s going on, but are working on a &#8220;parallel construction&#8221; scenario</i></p></blockquote>
<p>Bingo! A case in point where two departments are out of sync: script-writing and code-cutting departments are in dissonance. Script-writers are behind on the parallel-construction attribution details. And the code-cutters are still <i>scouring</i> stack-exchange, wikipedia, the dark web for missing components. Apparently some schmuck copied adware instead of the malicious payload and set the program back by a few sprints.</p>
<p>Case closed 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343236">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343236">
						November 9, 2019 4:24 PM					</a>

				</p>

				<p>@Wael</p>
<p>I&#8217;m going to do a test.</p>
<p>Because I can.  And will.</p>
<p>I will note results later.</p>
<p>Because it will take time.</p>
<p>First step done. Will take 24 hours before  further steps.</p>
<p>This will take at least 48 hours before I have any clues on the vector.</p>
<p>But, I&#8217;m very confident it exists.</p>
<p>So, my first test is to eliminate one of the possible vectors.</p>
<p>And, important to note.  I will not be surprised that my tests come up negative, only to reappear weeks from now.</p>
<p>But, I do have confidence that I will spot some &#8216;stuff&#8217; of interest.</p>
<p>I&#8217;ve been around a while.</p>
<p>You can observe a lot just by watching.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343237">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343237">
						November 9, 2019 4:28 PM					</a>

				</p>

				<p>@SpaceLifeForm,</p>
<p>If you share the analysis report before any of the AV boys, I&#8217;ll have a small gift for you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343238">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343238">
						November 9, 2019 4:40 PM					</a>

				</p>

				<p>One other thought.</p>
<p>Does &#8216;Airplane Mode&#8217; really mean the radio is off?  Totally doubtful.</p>
<p>Anyone have <em>ANY</em> proof that &#8216;Airplane Mode&#8217; really means that the cell radio is really off?</p>
<p>I do not believe that is reality.</p>
<p>Or does it really mean that you get no notifications?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343239">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343239">
						November 9, 2019 5:00 PM					</a>

				</p>

				<p>@SpaceLifeForm,</p>
<p>There are a few &#8220;radios&#8221;: WiFi, Cell, BT&#8230;</p>
<p>According to <a href="https://en.m.wikipedia.org/wiki/Airplane_mode" rel="nofollow ugc">FAA</a>, devices are prohibited from transmitting radio signals (more details in the link.)</p>
<p>I would imagine, in airplane mode, the RIL (Radio Interface Layer) that connects your MDM to your rich app ACPU is disabled. But I remember that MNOs can detect that your phone is in Airplane mode&#8230; whatever the case may be, run your tests in a shielded environment. Who knows what the regulations look like in different countries or what the differences between a &#8220;ranged phone&#8221; and &#8220;trade phones&#8221; are. Remove all assumptions from your test procedures.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343240">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343240">
						November 9, 2019 5:11 PM					</a>

				</p>

				<p>For this test, I&#8217;m going to intentionally mess up known WIFI passphrases of WIFI APs that it has seen.</p>
<p>This to make sure, that even in Airplane Mode,  in theory, it should not be able to connect to internet via WIFI.</p>
<p>In theory.</p>
<p>Theory fail.</p>
<p>On Android, you not remove an AP/SSID that is visible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343241">

			<div class="comment by-bong-smoking-primitive-monkey-brained-spook ">

				<p class="commentcredit">

					<span class="commenter">Bong-Smoking Primitive Monkey-Brained Spook</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343241">
						November 9, 2019 5:23 PM					</a>

				</p>

				<p>@SpaceLifeForm:</p>
<p><a href="https://kb.netgear.com/28440/How-to-remove-wireless-profiles-on-Android-phone-tablets" rel="nofollow ugc">https://kb.netgear.com/28440/How-to-remove-wireless-profiles-on-Android-phone-tablets</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343242">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343242">
						November 9, 2019 5:27 PM					</a>

				</p>

				<p>Android remembers AP/SSID that you have sucessfully connected to and will not let you &#8216;forget&#8217; them, if in range.  You can not change the passphrase or forget SSID until you are out range of the radio signal.</p>
<p>That be called &#8216;tracking&#8217; in my book.</p>
<p>Google probably calls it a User Experience feature.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343243">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343243">
						November 9, 2019 5:42 PM					</a>

				</p>

				<p>@Bong-Smoking Primitive Monkey-Brained Spook</p>
<p>These are WIFI APs that I am not admin for.<br />
I can get most to do what you note, but it will be easier to just move out of range.</p>
<p>The interesting point, is that you can temporarily &#8216;forget&#8217; AP/SSIDs that are visible, as long as you never connected to them.</p>
<p>Of course, they will re-appear.</p>
<p>Android is always scanning.</p>
<p>Recall the Google drive-by WIFI vehicles, the geo-locate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343244">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343244">
						November 9, 2019 7:40 PM					</a>

				</p>

				<p>My test is getting very interesting.</p>
<p>After changing locations, and having no valid WIFI (not connected over WIFI), the AP/SSID that I wanted to disappear/break, but could not due to being in range,  no longer appears in the list.</p>
<p>But, it has to still exist in storage somewhere at this point, because I can not see them to either change the passphrase or forget them.</p>
<p>It&#8217;s as though there is some kind of anchor tracking going on.</p>
<p>Thus, the WIFI user interface always wants you to have a least one working connection (likely would include cell), before you are allowed to manage the others.</p>
<p>Note:  this test involves no SIM, no SD card.</p>
<p>I&#8217;m certain, that if I go back to prior location, it will connect again.</p>
<p>So, my test is going to take much longer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343245">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343245">
						November 9, 2019 8:41 PM					</a>

				</p>

				<p>@spacelifeform<br />
Download a shell app, head 1gig of kmem,then hex search for a Ap that is known, repeat back here, to get the struct.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343246">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343246">
						November 9, 2019 8:52 PM					</a>

				</p>

				<p>Hex not string search, as 0x41 and 0x61 are the same thing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343247">

			<div class="comment by-potkorook ">

				<p class="commentcredit">

					<span class="commenter">Potkorook</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343247">
						November 10, 2019 1:33 AM					</a>

				</p>

				<p>This has some elements reminiscent of a piece of malware I played around with on an older friend&#8217;s WinXP PC one day. It had elements scattered around, but the most important one was a little file stuck into the middle of the root directory (C:\ on Windows boxen.). And that kept coming back whenever he got on the Internet.</p>
<p>So I deleted it once we were off the Internet and using the magic of Notepad, saved an empty file with its name then renamed it to an exe file. It never reappeared, giving me the time to go through and track down its other bits and peces, and wiping them off his PC.</p>
<p>I suspect one could do something of the sort with this xHelper, which I take is not relocatable? Symantec&#8217;s already shown us some disassembled routines. What could be done is reassemble the code minus the most offensive stuff &#8211; software patching systems do this all the time &#8211; including enough &#8220;functionality&#8221; that its makers won&#8217;t suspect a thing, including of course the &#8220;xHelper Phone Home&#8221; functionality but disable the update functionality so that they can send any payload they like and it&#8217;ll enjoy /dev/null where it wants to be. And include tracker traces so that the malware leads straight back home.</p>
<p>Oh and BTW, if Symantec have disassembled it, it&#8217;s not &#8220;file-less&#8221; because you disassemble files &#8211; binary generally &#8211; but you can&#8217;t disassemble a non-file.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343248">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343248">
						November 10, 2019 2:00 AM					</a>

				</p>

				<p>@ SpaceLifeForm, BS PM BS, C U Anon, deepview, Wael, Weather, Who?, and interested readers,</p>
<blockquote><p>I&#8217;m going to do a test. Because I can. And will. I will note results later. Because it will take time.</p></blockquote>
<p>May I urge a little caution for all before people leap in.</p>
<p>Firstly go read the history of &#8220;BadBIOS&#8221; and the researcher looking for it. Their reputation got tarnished baddly by journalists who played the &#8220;Mystery&#8221; card, and for a bit of sensationalism pushed the researcher into what sounded to nearly everyone else as &#8220;wild speculation&#8221; and &#8220;fantastical imaginings&#8221; all &#8220;driven by wild paranoia&#8221;.</p>
<p>Further look up how the &#8220;usuall suspects&#8221; of the time on this blog had already done all that BadBIOS allegedly did, years befor hand and accurately described here what you had to do to get it to work.</p>
<p>That is,</p>
<p>1, We had made high frequency audio communications work during the 1980&#8217;s/90&#8217;s.</p>
<p>2, We correctly diagnosed why modern laptop speakers and microphones would work better.</p>
<p>3, We pointed out the old I/O Driver software in ROM mechanism, and described how it worked and why it was there and would give malware persistance beyond hard drive wipping and replacing with brand new hard drives.</p>
<p>4, We had also pointed out at that time and others that the Software Industry appears to not remember or learn it&#8217;s own history. Which is why attacks from the 1980&#8217;s/90&#8217;s were &#8220;finding new life&#8221; around a quater of a century later.</p>
<p>Which few people even on this blo believed,, untill a couple of young Uni researchers did what we had said, and put two laptops in a corridor and then wrote it up&#8230; (moral you are not the inventor/discoverer unless you&#8217;ve &#8220;published a paper&#8221;, the honour belongs to those with a paper even though they&#8217;ve only copied your work&#8230;)</p>
<p>But whilst what appears as &#8220;wild speculation&#8221; to many may actually be true, it&#8217;s best to show documentation based on the laws of physics or other &#8220;known work&#8221;.</p>
<p>Also watch out for the &#8220;William of Ockham&#8217;s Razor trap&#8221;. Occam&#8217;s razor realy only applies to thought experiments where the subjects involved are inanimate or can have no free will. Where however subjects have free will or concious thought their behaviours become to complex due to what can be called &#8220;Hidden variables&#8221;. Obviously when dealing with malware writers their aim is longevity of covertness of method, thus one or possibly two &#8220;tricks&#8221; will be used that are disguised or hidden from plain sight, but the rest of the code will follow the usual rules.</p>
<p>Thus alow for one or at most two &#8220;fantastical sounding&#8221; methods but don&#8217;t make the mistake of thinking the whole thing will be a &#8220;mystery&#8221; because it will not.</p>
<p>Also keep in mind the &#8220;delivery payload&#8221; relationship. That is remember there is no necessity for the &#8220;payload you find&#8221; to have the &#8220;delivery method inside&#8221;. Even when the malware has replication involved, a delivery mechanism can have what are in effect two or three payloads that chain. That is the one that causes the user problems needs no persistance or replication methods, the one responsible for ensuring persistance needs no replication nor problem payloads just knowledge of how to check for the problem payload, and where to get a replacment from. The replication method is only needed for propergation of the malware and once it has successfully reproduced on another computer it can then put the peristence payload in place then &#8220;self destruct&#8221;.</p>
<p>That way investigators get effectively trapped at the wrong end of a one way tunnel. Not being able to work backwards they have to use other methords to try and catch the replication or even persistance payloads. Which can take a long time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343249">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343249">
						November 10, 2019 3:26 AM					</a>

				</p>

				<p>@Clive Robinson, @SpaceLifeForm, BS PM BS, C U Anon, deepview, Weather, Who?, Potkorook , and interested readers,</p>
<p>BadBIOS! That was some time ago. Two threads, if the cobweb in my skull is right.</p>
<blockquote><p> (moral you are not the inventor/discoverer unless you&#8217;ve &#8220;published a paper&#8221;, the honour belongs to those with a paper even though they&#8217;ve only copied your work&#8230;)</p></blockquote>
<p>Honesty is a faint whisper, in the midst of an lintegrity-lessness and  plagiarism dull cacophony.</p>
<p>I have my earplugs in.</p>
<blockquote><p> Oh and BTW, if Symantec have disassembled it, it&#8217;s not &#8220;file-less&#8221; because you disassemble files &#8211; binary generally &#8211; but you can&#8217;t disassemble a non-file.</p></blockquote>
<p>That&#8217;s tight! You dump it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343250">

			<div class="comment by-tds ">

				<p class="commentcredit">

					<span class="commenter">tds</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343250">
						November 10, 2019 4:31 AM					</a>

				</p>

				<p>Late to the party, but might the above be a reason  to consider new, used, or Apple&#8217;s factory refurbished hardware?  For example, iOS devices.   OT, but, of course, Macintosh computers readily run other Unix, Linux and Windows, too, AFAIK.</p>
<p><a href="https://www.apple.com/shop/refurbished" rel="nofollow ugc">https://www.apple.com/shop/refurbished</a> ; iPhone 7 $399 &amp; up</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343252">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343252">
						November 10, 2019 11:27 AM					</a>

				</p>

				<p>My test plan will not work.</p>
<p>I can not cage WIFI/BT and leave radio non-caged.  Or the reverse.</p>
<p>And, as expected, even if you can remove an SSID from the list,  it does not really forget.</p>
<p>Once you move back into range, it will connect again. (assuming passphrase has not changed in the meantime)</p>
<p>It&#8217;s very subtle how it works, but sure looks like a good way to do geotracking.</p>
<p>Even if in Airplane Mode or sans SIM.</p>
<p>And there are so many WIFI enabled printers around!   That become fixed points of reference.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343253">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343253">
						November 10, 2019 1:40 PM					</a>

				</p>

				<p>@Weather</p>
<p>I&#8217;d like to dump kmem, but I have a catch-22.</p>
<p>For some magical reason, about 2 years ago, my  microSD card was no longer visible.</p>
<p>The card is fine.  I verified elsewhere.</p>
<p>So, on this rooted device, I no longer had my /usr/local, which really ticked me off, because I could no longer access my toolchain.</p>
<p>I was actuallly native compiling on this device.  I designed for that.  In theory, I could load the toolchain into ram, but ram is limited, so a 100MB toolchain was best left on sdcard since mostly readonly.</p>
<p>Yes, builds were slow, but worked.</p>
<p>So, the only way I can dump kmem is to get my wifi setup going again, where I can ssh/telnet in, and dump it over wifi to pc.</p>
<p>Alas, time is limited currently.</p>
<p>After reading thru the various forums, and based upon my observations for years, I think what we are looking at is:</p>
<p>A built-in backdoor in Android using the core OS (no need to modify /system),  <em>AND</em> the channel to the builtin backdoor via Chrome.</p>
<p>The problem:  If you think your backdoor is locked tight, it may not be.</p>
<p>The hinges could be on the wrong side of the frame.</p>
<p>If someone has discovered the exploit path, and is <em>IN POSITION</em> on net, then, &#8216;Houston, we have a problem&#8217;</p>
<p>I have to agree with @Alejandro on this.</p>
<p>I do not believe the route matters.  WIFI or CELL will both work for exploit purposes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343254">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343254">
						November 10, 2019 2:08 PM					</a>

				</p>

				<p>@Clive nails it.</p>
<p>That is remember there is no necessity for the &#8220;payload you find&#8221; to have the &#8220;delivery method inside&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343255">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343255">
						November 10, 2019 2:13 PM					</a>

				</p>

				<p>You can use pipes and std redirects,<br />
Head /dev/kmem ) grep syntax + 100 bytes ) file.DMP</p>
<p>You can get file timestamps, diff usages like they reverse patch&#8217;s, plus if you find the code, the entry point will be close by or vice Verser.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343256">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343256">
						November 10, 2019 6:01 PM					</a>

				</p>

				<p>Maybe there is no backddor.</p>
<p>Maybe it a just a Glitch.</p>
<p>(rowhammer attack via javascript)</p>
<p>https[:]//www.vusec.net/projects/glitch/</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343257">

			<div class="comment by-gordon ">

				<p class="commentcredit">

					<span class="commenter">Gordon</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343257">
						November 10, 2019 6:27 PM					</a>

				</p>

				<p>State sponsored actor and being noisy are not mutually exclusive in all cases.  The first case that came to mind is that there are pariah states where monetizing malware has higher than normal value.  More obliquely, there are cases where observation of response could be the reward. This may be sufficiently low value in the state arsenal to merit using as a response yardstick.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343258">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343258">
						November 10, 2019 11:23 PM					</a>

				</p>

				<p>@SpaceLifeForm,</p>
<blockquote><p> Maybe it a just a Glitch.</p></blockquote>
<p>Hmmm. Interesting! GLitch [1]</p>
<p><i></p>
<blockquote><p> Our PoC heavily relies on the insights we recovered by reverse engineering the architecture of our target systems: the Snapdragon 800 and 801. This means that our PoC works only on phones  such as the LG Nexus 5, HTC One M8 or LG G2.</p></blockquote>
<p></i></p>
<p>May explain why some devices are not affected. Still doesn&#8217;t (fully) explain persistence across Factory Reset. Did you try using browsers in your test?</p>
<p>[1] The technique is named GLitch with first two letters capitalized because it uses a widely used browser-based graphics code library known as WebGL for rendering graphics to trigger a known glitch in DDR3 and DDR4 memory chips &#8212; <a href="https://thehackernews.com/2018/05/rowhammer-android-hacking.html?m=1" rel="nofollow ugc">https://thehackernews.com/2018/05/rowhammer-android-hacking.html?m=1</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343259">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343259">
						November 11, 2019 5:26 AM					</a>

				</p>

				<p>As far as I can tell (and google), factory reset does not erase SIM and data on SD card. Perhaps the xHelper leaves some specially crafted &#8220;landmines&#8221; on SD card. I mean, executing arbitrary code by viewing a picture is not unheard of.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343260">

			<div class="comment by-at ">

				<p class="commentcredit">

					<span class="commenter">AT</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343260">
						November 11, 2019 12:43 PM					</a>

				</p>

				<p>You don&#8217;t need a nation-state to develop persistence against faculty resets &#8211; you just need to read the security literature.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343261">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343261">
						November 11, 2019 1:24 PM					</a>

				</p>

				<p>@Wael, @me</p>
<p>I&#8217;m thinking there is no true persistence.</p>
<p>I&#8217;m thinking, the user, after factory reset, get&#8217;s online, and is re-infected once online.</p>
<p>It may be a Javascript rowhammer attack to get root.   Or a different exploit path.</p>
<p>But, the rowhammer attack looks good.</p>
<p>And, if that is really it, then they need to disable Javascript.</p>
<p>What is really interesting, is that why would the attackers (if they really got root), why would they make the xHelper app visible to some users, and not others?</p>
<p>And be obnoxious about it, via pop-up ad-sites?</p>
<p>I can agree, this is a work-in-progress.</p>
<p>And, the reason to be obnoxious?</p>
<p>Because, the attacker will be able to track that the attack actually worked.</p>
<p>This then leads to the question:</p>
<p>Who is <em>IN POSITION</em> to serve the Javascript rowhammer attack to the users browser?</p>
<p>Is it only old Firefox or Chrome versions that are exploitable?</p>
<p>Or, is the Javascript rowhammer attack possible on any device, just easier on some?</p>
<p>I suspect that it is feasible on any device, but that it is easier on small ram devices, because ASLR is constrained.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343262">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343262">
						November 11, 2019 2:40 PM					</a>

				</p>

				<p>@SpaceLifeForm, @me,</p>
<blockquote><p>I&#8217;m thinking there is no true persistence.</p></blockquote>
<p>Either that or the thing is preinstalled, despite what the AV boys are saying.</p>
<blockquote><p>I&#8217;m thinking, the user, after factory reset, get&#8217;s online, and is re-infected once online</p></blockquote>
<p>There&#8217;s an initial prerequisite that the user side-loads this app. There&#8217;re no reported incidents of devices affected before that initial step. The question is then: what did side-loading the app install that keeps triggering infection through an online channel? There must be something that persists on the device after that initial side-loading flow.</p>
<blockquote><p>It may be a <b>Javascript rowhammer</b> attack to <b>get root</b>. Or a different exploit path.</p></blockquote>
<ol>
<li>Did the user need to use the browser? Perhaps that&#8217;s a test you can run, right?</li>
<li>Were there any reports on devices being rooted?</li>
</ol>
<blockquote><p>But, the rowhammer attack looks good.</p></blockquote>
<p>Could be one of the steps. I don&#8217;t know.</p>
<blockquote><p>Who is *IN POSITION* to serve the Javascript rowhammer attack to the users browser?</p></blockquote>
<p>We have to establish that this is the method!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343263">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343263">
						November 11, 2019 3:20 PM					</a>

				</p>

				<p>@all<br />
If Android has anything like the windows registry, getting a key the can open a door, like google automatic OS update, or Puk of the Sim, it could be a huge list.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343264">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343264">
						November 11, 2019 5:15 PM					</a>

				</p>

				<p>@Clive nails it.</p>
<p>That is remember there is no necessity for the &#8220;payload you find&#8221; to have the &#8220;delivery method inside&#8221;.</p>
<p>@Wael</p>
<p>&#8220;There&#8217;s an initial prerequisite that the user side-loads this app. There&#8217;re no reported incidents of devices affected before that initial step&#8221;</p>
<p>No &#8220;REPORTED&#8221; incidents.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343265">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343265">
						November 11, 2019 5:29 PM					</a>

				</p>

				<p>@Wael</p>
<p>I&#8217;m 99.99% certain it is Javascript rowhammer</p>
<p>No sideloading required.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343266">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343266">
						November 11, 2019 5:59 PM					</a>

				</p>

				<p>@SpaceLifeForm,</p>
<blockquote><p> No sideloading required.</p></blockquote>
<p>So xHelper gets installed without users installing it? Not what the reports say!</p>
<blockquote><p> I&#8217;m <b>99.99</b>% certain it is Javascript rowhammer</p></blockquote>
<p>4 nines!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343267">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343267">
						November 11, 2019 6:21 PM					</a>

				</p>

				<p>@Wael</p>
<p>&#8220;4 nines!&#8221;</p>
<p>Yep. Seen this movie before.</p>
<p>Reparse what @Clive was saying.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343268">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343268">
						November 12, 2019 7:57 AM					</a>

				</p>

				<p>Does it infect Sailfish OS? Just saying&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343269">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343269">
						November 12, 2019 8:02 AM					</a>

				</p>

				<p>&#8230;and if you can&#8217;t make sense of the story:</p>
<p><a href="https://www.youtube.com/watch?v=Gak9xiU4cpA" rel="nofollow ugc">https://www.youtube.com/watch?v=Gak9xiU4cpA</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-343270">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343270">
						November 12, 2019 9:01 AM					</a>

				</p>

				<p>@Clive Robinson:</p>
<p>&#8220;I&#8217;m glad you and others are now feeling it&#8217;s safe to say.&#8221;</p>
<p>Do you think there has been a change? I don&#8217;t think there is. There has always been a bell curve of attribution styles, from optimistic to conservative. I don&#8217;t even think the standards of attribution have changed very much, if at all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343271">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343271">
						November 12, 2019 1:59 PM					</a>

				</p>

				<p>@Wael</p>
<p>&#8220;Did the user need to use the browser? Perhaps that&#8217;s a test you can run, right?&#8221;</p>
<p>Like I said, I&#8217;ve seen this movie before.</p>
<p>The attack will want to launch (one of) your browser(s).</p>
<p>If you do not have multiple browsers, then it will just immediately proceed to launch your builtin browser, to display a web site page.</p>
<p>&#8220;Were there any reports on devices being rooted?&#8221;</p>
<p>The user will never know that an attacker got root.   It will never become a rooted device where the user can login as root, or &#8216;su&#8217;, etc.</p>
<p>The attack is temporary root, to install the payload.</p>
<p>And, because the xHelper app is now &#8216;installed&#8217; (to /data), the app is now persistent across reboots.</p>
<p>Until next &#8216;factory reset&#8217; which wipes /data</p>
<p>And, so as long as the xHelper app can function, three things are accomplished:</p>
<p>The xHelper app can call home, and reveal to the attacker that the attack worked.</p>
<p>Via tracking, the attacker no longer has to inject the javascript rowhammer. Which, may be semi-visible to the user due to unresposiveness, raising suspicions.</p>
<p>And, the obvious, it can talk to the C2 for further instructions.</p>
<p>The xHelper app certainly does not run as root.   The permissions model of Android requires that the app gets it&#8217;s own userid, different from other installed apps.</p>
<p>But that does not mean that the app can never get temporary root later.</p>
<p>And then exfiltrate back to C2.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343272">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343272">
						November 12, 2019 5:25 PM					</a>

				</p>

				<p>@keiner</p>
<p>Sailfish browser still has a Javascript interpreter.</p>
<p>They can all be crafted via Javascript to carry out a Rowhammer attack.</p>
<p>The attack will have to be crafted for the Javascript engine and the hardware platform combination.</p>
<p>So, it takes work.</p>
<p>xHelper may just be a POC on easilly attackable platforms at this point in time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343273">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343273">
						November 12, 2019 9:18 PM					</a>

				</p>

				<p>@keiner,</p>
<blockquote><p> &#8230;and if you can&#8217;t make sense of the story:</p></blockquote>
<p>Non-linear war, confusion,.. all makes sense. The only thing I don&#8217;t get is why he doesn&#8217;t move his right arm in his distinctive stride. But it ain&#8217;t no mystery:)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343274">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343274">
						November 13, 2019 11:11 AM					</a>

				</p>

				<p>&#8220;xHelper may just be a POC on easilly attackable platforms at this point in time.&#8221;</p>
<p>&#8230;this whole thing is so 100% Putin-joke-pattern&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343275">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343275">
						November 13, 2019 12:47 PM					</a>

				</p>

				<p>@Wael, @me</p>
<p>&#8220;This means that our PoC works only on phones such as the LG Nexus 5, HTC One M8 or LG G2.&#8221;</p>
<p>It&#8217;s not sdcard, because the LG Nexus 5 does not have sdcard.</p>
<p>What they have in common:</p>
<p>2GB ram<br />
GPU Adreno 330<br />
Older Android</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343276">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343276">
						November 13, 2019 2:57 PM					</a>

				</p>

				<p>@ Bruce,</p>
<blockquote><p>Do you think there has been a change?</p></blockquote>
<p>Yes I do, atleast outside of the US MSM (which thanks to EU legislation is now not accessable on equitable terms).</p>
<p>The change is from unquestioning acceptance to more nuanced questioning or care to ensure that the consumers of the news are warned that it is at best unverified.</p>
<p>Further,</p>
<blockquote><p>I don&#8217;t even think the standards of attribution have changed very much, if at all.</p></blockquote>
<p>Whilst I would agree that the &#8220;methods&#8221; have not changed even those publishing the results are becoming more cautious about what the attribution means. But perhaps more importantly those outside the process but with an interest in it are begining to understand just how hard non HumInt attribution is.</p>
<p>Whilst some may not like me asking the &#8220;Does it meet primary evidence for a criminal court?&#8221; test, the simple fact is more people are realising that unless it does it is at best &#8220;opinion&#8221; if not &#8220;hearsay&#8221;. Thus they are gaining insight into the &#8220;Politics of Attribution&#8221; and how policy can be sought on very shaky ground.</p>
<p>The simple fact is at the end of the day attribution has been used as a football and kicked from pillar to post by those with their own agendas political, business, or otherwise. People are waking up to that and are thus trying to seperate method from agenda.</p>
<p>What has partialy helped in this change, is one nation actually going &#8220;kinetic&#8221; on cyber-crime.</p>
<p>In the back of increasing numbers of peoples minds in many parts of the world is the realisation that their neighbours child up in the back bedroom of the house next door could bring hellfire missiles down on their heads. And for all the propaganda about smart weapons collateral damage happens&#8230; Thus the usually nebulous nature of cyber-attribution is not going to make such collateral damage any the less, more probably the opposit.</p>
<p>But those only a fraction closer to the attribution problem know, it&#8217;s not that difficult to set up a cyber-crime launch point anywhere you care to. All it needs is a seat, laptop and network connection all available around the corner in your local coffee shop, (and even the seat is optional. Or likewise even a car and a neighbours insecurely configured WiFi router. The pictures last year of the Russian&#8217;s picked up in a car park adjacent to the Organisation for the Prevention of the use of Chemical Weapons (OPCW) by the Dutch authorities made lurid if technically inacurate reading in many MSM outlets[1]. Whilst the technical errors are forgotten, the lurid personal details are remembered as is the apparent ease of attack.</p>
<p>These are the practical realities of life and they are slowly but surely instilling themselves in peoples thinking.</p>
<p>Which I hope as others do will take much of the self interested rhetoric out of what is a complex issues, that are over due to be resolved by thoughtfull international treaty, before more nations progress down the balkanisation of the Internet[2].</p>
<p>[1] <a href="https://www.dailymail.co.uk/sciencetech/article-6239745/Russian-GRU-hackers-used-budget-mobile-phones-high-grade-Wi-Fi-equipment.html" rel="nofollow ugc">https://www.dailymail.co.uk/sciencetech/article-6239745/Russian-GRU-hackers-used-budget-mobile-phones-high-grade-Wi-Fi-equipment.html</a></p>
<p>[2] <a href="https://www.independent.co.uk/life-style/gadgets-and-tech/news/russia-internet-disconnect-experiment-isp-cyber-war-putin-data-a8773961.html" rel="nofollow ugc">https://www.independent.co.uk/life-style/gadgets-and-tech/news/russia-internet-disconnect-experiment-isp-cyber-war-putin-data-a8773961.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343277">

			<div class="comment by-nix ">

				<p class="commentcredit">

					<span class="commenter">Nix</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343277">
						November 14, 2019 9:15 AM					</a>

				</p>

				<blockquote><p>
The convention is that an I/O card carries a program ROM on it with the required I/O drivers written in a memory position independent way that will be identified at Boot time by the motherboard BIOS and loaded into known memory addresses in RAM. When the OS boots it clears or overwrites much of the RAM but importantly NOT the areas where I/O drivers are loaded. The OS then runs an initialisation sub routine for each I/O driver in RAM to add interupt and jump point information so the OS can use the I/O device.
</p></blockquote>
<p>This is more or less accurate of ISA cards but is highly inaccurate for PCI, so you&#8217;re only thirty years or so out of date. PCI cards can still have option ROMs, but only a few do, and in most cases all that is actually used from there is data tables. (UEFI systems can have arbitrary per-device PXEs on there, too, and can contribute runtime services, but those are fairly nailed down.)</p>
<blockquote><p>
Both Microsoft and Linux OS&#8217;s support this I/O Device convention.
</p></blockquote>
<p>Honestly&#8230; no. Those option ROMs that contain code at all almost always contain either x86 real mode code (seriously) or x86 PE binaries for UEFI, and outside a few network cards (used only for PXE booting over the net) and the inevitable hellzone of graphics cards nobody does that at all. They do <em>not</em> contain ARM code, and while UEFI in theory supports an interpreted non-x86 portable machine language specifically for this reason it is as far as I know entirely unused by anyone. If an ARM platform wants to execute code out of option ROMs, it has to use an x86 interpreter to do it. In practice this is so inconvenient that such devices are simply unsupported on ARM. (Those graphics devices that are supported are usually either ARM-specific and wired in via IP blocks, or contain specialized device-specific arch-independent tables that the OS&#8217;s driver knows how to interpret, like Radeon video cards.)</p>
<p>What <em>is</em> widely used and provided by the device are ACPI tables, but you can&#8217;t practically spread malware that way as far as I know.</p>
<p>But this is all academic anyway because mobile phones do not ever boot using UEFI (they usually use u-boot), do not support expansion cards at all, neither PCI nor (ha ha) ISA, and I&#8217;ve never heard of a phone supporting ACPI: that&#8217;s a server-side thing in the ARM world. They have hardwired tables (look up &#8216;device tree&#8217;) instead. No option ROMs, no executable code provided by a potentially hostile user-provided devices on cards, no ability to add user-provided devices on cards, nothing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343278">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343278">
						November 14, 2019 2:54 PM					</a>

				</p>

				<p>@Nix</p>
<p>&#8220;No option ROMs, no executable code provided by a potentially hostile user-provided devices on cards, no ability to add user-provided devices on cards, nothing.&#8221;</p>
<p>All good points.  Until the user hooks up their phone to their potentially hostile user-provided device, their PC.</p>
<p>Are you sure there are not issues with charging cables?   USB/Lightning?</p>
<p>Cellebrite can get in, and dump.</p>
<p>I&#8217;ll just note, that, oh, about 2 decades ago, Microsoft wrote their own AML compiler, instead of using the Intel AML compiler.</p>
<p>So, I would not want to safely conclude that backdoors can not be planted into ACPI.</p>
<p>Backdoors in Silicon.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343279">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343279">
						November 14, 2019 6:21 PM					</a>

				</p>

				<p>@ Nix,</p>
<blockquote><p>This is more or less accurate of ISA cards but is highly inaccurate for PCI,</p></blockquote>
<p>Actually what they put in place for PCI was the use of a Forth interpreter (IEEE 1275-1994 &#8220;Open Firmware&#8221;). The advantage of this was not only CPU ISA independence, but &#8220;tighter code&#8221; which back in thr 1990&#8217;s was still an important consideration.</p>
<p>But you go on to say,</p>
<blockquote><p>PCI cards can still have option ROMs, but only a few do</p></blockquote>
<p>Which means you acknowledge that what was being discussed which was &#8220;the mechanism in the OS&#8221; is still there (called EFI byte code or EBC it&#8217;s analogous to &#8220;Open Firmware&#8221;, but due to UEFI only supporting little-endian CPU&#8217;s a lesser equal).</p>
<p>But then we know the BIOS ROM was still there as well because of Lenovo using it to get persistant malware well into this century. So your comment of,</p>
<blockquote><p>so you&#8217;re only thirty years or so out of date.</p></blockquote>
<p>Is not true is it?</p>
<p>But my intention was to give the history of why OS&#8217;s have these holes in them even to this day all be it by &#8220;binary blobs in Flash ROM&#8221;. Apple recognised the Hardware I/O problem, probably before you were born back in the mid 1970&#8217;s getting on for half a century ago. And we still have the same hardware issue in Android devices irespective of the CPU ISA, even though the hardware is mostly not on easily removable I/O cards. Google lets manufacturers put in persistsnt code in various forms, the manufacturers for production reasons use Flash ROM that can be overwritten at any time. Thus the security implications of such issues still exist in modern commodity OS&#8217;s even if they might be marginally more dificult to exploit[1].</p>
<p>I could go through your other comments point by point, but it would be fairly pointless. Because it&#8217;s obvious you did not read and take on board @K.S.&#8217;s comment of</p>
<ul><i>Such persistence should not be possible in a well-functioning OS.</i></ul>
<p>And my concluding paragraph of,</p>
<ul><i>Both Microsoft and Linux OS&#8217;s support this I/O Device convention. As Android is based on Linux, the convention or something similar is almost certainly there. Because Google is not going to willingly relinquish the rights to push in technology to support their PII and similar marketable information collection for profit.</i></ul>
<p>Now if you disagree with the fact I think Google or it&#8217;s employees have in effect &#8220;backdoored&#8221; Android in several ways, then please feel free to argue against that. But I suspect if we wait long enough someone will find such a backdoor, after all they have with most of their upgrades to the Chrome browser put more and more code to fascilitate their business model of &#8220;steal it all&#8221; with regards to users PII and habits etc. In effect just like Facebook has done to it&#8217;s users and Microsoft are now doing with their invasive &#8220;telemetry&#8221; and god alone knows how many application writers for Android and Apple platforms. Oh and increasingly all those IoT devices built in China but designed by the likes of Amazon[2]&#8230;</p>
<p>[1] As I&#8217;ve pointed out in the past &#8220;code signing&#8221; means next to nothing other than &#8220;A person with access to the private key hashed a &#8220;bag of bits&#8221; and then encrypted the resulting hash with the private key&#8221;. That is it attests to nothing about the contents of that &#8220;bag of bits&#8221;. As has been proved on a number of occasions, the process can be subverted, by just a few people, despite the best efforts of the many&#8230; It&#8217;s also a good example of why &#8220;golden keys&#8221; that those in Law Enforcment argue for are a very bad idea.</p>
<p>[2] Amazon have realised that there is a lot of money to be made by selling access to your &#8220;home security&#8221; devices, and apparently they have not had trouble finding customers for that access. Likewise the manufacturers of Smart Meters are looking to make money on access to your utility usage&#8230; Mad as it first sounds, a Japanese company has found a way to sell &#8220;electronic toilets&#8221; to &#8220;the worried well&#8221; it has a camera that views your motions and makes some rudimentry analysis on them (see &#8220;Bristol Stool Scale&#8221;). Connecting such a device to a communications network such as the Internet or GSM network would no doubt be of great interest to US Health Care Insurance Companies who would probably salivate at the opportunity to use it to make adjustments to your premiums to their benifit, just as they tried to do with the apparently now ill fated Fitbit and similar &#8220;Internet connected health lifestyle wareables&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343280">

			<div class="comment by-zt3phan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://trasiga.st' rel='external nofollow ugc' class='url'>zt3phan</a></span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343280">
						November 27, 2019 5:24 AM					</a>

				</p>

				<p><a href="https://www.spywareremove.com/removexhelper.html" rel="nofollow ugc">https://www.spywareremove.com/removexhelper.html</a></p>
<p>&#8211;</p>
<p>Says its done via an obfuscated .jar-file &#8211; true/false?<br />
And that it seemingly can be removed w/ the app mentioned.</p>
<p>Regards!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-343281">

			<div class="comment by-nix ">

				<p class="commentcredit">

					<span class="commenter">Nix</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343281">
						November 27, 2019 6:13 AM					</a>

				</p>

				<p>@Clive Robinson, you&#8217;re moving the goalposts. You were talking exclusively about option ROMs and how they could be used to attack mobile devices running Android because obviously Android devices have the same thing (hint: they don&#8217;t), but now you suddenly claim you were talking about the BIOS as an explanation for why your stuff about option ROMs wasn&#8217;t decades out of date. BIOSes might have gone away rather later in the PC world, but Android devices have <em>never had a BIOS</em> so this is irrelevant to your main argument. Nor do they use UEFI.</p>
<p>As an analogy to Android devices this isn&#8217;t very good either. They do have flashable firmware, but this firmware is much better protected than a PC BIOS ever was (the only bit of a PC that is remotely well-protected against reflashing by hostile code running as root is the ME on Intel platforms and possibly the BMC if you&#8217;re very lucky), and crucial parts of it (e.g. the bootloader) are often nailed in place with e-fuses that if they can be attacked at all take voltage-slamming attacks etc to get past &#8212; not the sort of thing that can be done undetectably, or on a mass scale.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-343282">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/#comment-343282">
						November 27, 2019 7:12 AM					</a>

				</p>

				<p>@ NIX,</p>
<blockquote><p>you&#8217;re moving the goalposts</p></blockquote>
<p>Not realy as I said,</p>
<ul>But my intention was to give the history of why OS&#8217;s have these holes in them even to this day all be it by &#8220;binary blobs in Flash ROM&#8221;.</ul>
<p>My intention was to give more background, because of the comments you had made, that were shally we say &#8220;overly selective&#8221;</p>
<p>Thus I also said,</p>
<ul>I could go through your other comments point by point, but it would be fairly pointless. Because it&#8217;s obvious you did not read and take on board @K.S.&#8217;s comment</ul>
<p>Which you still have not done. All you appear to be trying to do is maintain a thoroughly blinkered viewpoint that does not look at that you don&#8217;t wish to see.</p>
<p>There have been past failry famous observations about the difficulty of getting a person to see a point of view when their salary depends on them not doing so&#8230;</p>
<p>Your choice of where you go from here, but don&#8217;t expect others to follow on your quest what ever it may be.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2019/11/xhelper_malware.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2019/11/xhelper_malware.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F11%2Fxhelper_malware.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2019/11/xhelper_malware.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12292' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2019/11/eavesdropping_o_8.html" rel="prev">← Eavesdropping on SMS Messages inside Telco Networks</a>		<a href="https://www.schneier.com/blog/archives/2019/11/friday_squid_bl_702.html" rel="next">Friday Squid Blogging: 80-Foot Steel Kraken Deliberately Sunk →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
