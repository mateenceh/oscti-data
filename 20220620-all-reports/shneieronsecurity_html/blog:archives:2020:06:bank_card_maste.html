<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Bank Card "Master Key" Stolen - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Bank Card &quot;Master Key&quot; Stolen Comments Feed" href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12515" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12515' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F06%2Fbank_card_maste.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F06%2Fbank_card_maste.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12515 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12515" class="post-12515 post type-post status-publish format-standard hentry category-uncategorized tag-banking tag-breaches tag-data-protection tag-keys tag-pins tag-theft">

	<div class="article">

		<h2 class="entry">Bank Card "Master Key" Stolen</h2>
		<p>South Africa&#8217;s Postbank experienced a <a href="https://www.timeslive.co.za/sunday-times/news/2020-06-14-postbank-forced-to-replace-12-million-bank-cards-after-employees-steal-master-key/">catastrophic security failure</a>. The bank&#8217;s master PIN key was stolen, forcing it to cancel and replace 12 million bank cards.</p>
<blockquote><p>The breach resulted from the printing of the bank&#8217;s encrypted master key in plain, unencrypted digital language at the Postbank&#8217;s old data centre in the Pretoria city centre.</p>
<p>According to a number of internal Postbank reports, which the <i>Sunday Times</i> obtained, the master key was then stolen by employees.</p>
<p>One of the reports said that the cards would cost about R1bn to replace. The master key, a 36-digit code, allows anyone who has it to gain unfettered access to the bank&#8217;s systems, and allows them to read and rewrite account balances, and change information and data on any of the bank&#8217;s 12-million cards.</p></blockquote>
<p>The bank lost <a href="https://www.zdnet.com/article/south-african-bank-to-replace-12m-cards-after-employees-stole-master-key/">$3.2 million</a> in fraudulent transactions before the theft was discovered. Replacing all the cards will cost an estimated $58 million.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/banking/" rel="tag">banking</a>, <a href="https://www.schneier.com/tag/breaches/" rel="tag">breaches</a>, <a href="https://www.schneier.com/tag/data-protection/" rel="tag">data protection</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/pins/" rel="tag">PINs</a>, <a href="https://www.schneier.com/tag/theft/" rel="tag">theft</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html" rel="bookmark">Posted on June 17, 2020 at 6:21 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html#comments">20 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html" data-title="Bank Card &quot;Master Key&quot; Stolen" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-351512">

			<div class="comment by-leon ">

				<p class="commentcredit">

					<span class="commenter">Léon</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351512">
						June 17, 2020 6:41 AM					</a>

				</p>

				<p>When the architecture of a system depends so heavily on a single master key for everything, an accident like this is bound to happen.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351513">

			<div class="comment by-grima-s ">

				<p class="commentcredit">

					<span class="commenter">Grima S</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351513">
						June 17, 2020 7:29 AM					</a>

				</p>

				<p>You beat me to it. I was going to phrase that slightly differently, asking if it is at all prudent to have a single key that affords access to <em>everything</em> in such a system, but, yes, you have exactly identified the problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351514">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351514">
						June 17, 2020 7:44 AM					</a>

				</p>

				<p>Why $58 mln? Price for issuing 1 card = $2-3.<br />
12*3=36.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351515">

			<div class="comment by-scot ">

				<p class="commentcredit">

					<span class="commenter">scot</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351515">
						June 17, 2020 8:17 AM					</a>

				</p>

				<p>If the bank is using ICC cards (and everyone in Africa should be) and online PIN verification, this should not require replacement of all of the cards.  The compromised key can be blocked by the issuer, a new PIN verification key (PVK) can be generated, and customers can be required to go to a branch to have a teller verify their identity and issue them a new random PIN (or sent via mail or SMS to a verified address).  The PVK is assigned an index, so a new key would have a new index, and all PIN transactions include the index used, so it&#8217;s easy to tell if the old or new PVK is being used.</p>
<p>The way PINs work is that you take the card number (PAN) as a salt, do a cryptographic hash with the two halves of the PVK (a double length TDES key), and grab the first N decimal digits of the result (if there aren&#8217;t enough decimal digits, subtract 10 from the A-F values to get decimals).  This gives you the PVV, or PIN verification value.  This value is encoded, along with the PVK index, in the magnetic stripe and the chip and stored in the issuer&#8217;s database.  The issuer is forbidden by Payment Card Industry (PCI) rules from storing the PIN itself, they can only store the PVV (this is why a PIN leak should be impossible).  When the encrypted PIN comes in from the terminal (in an encrypted block of data), the clear PIN entered by the user is decrypted, hashed, and compared to the PVV from the card data or the database.</p>
<p>There&#8217;s nothing that can be done about the PVV encoded on the magnetic stripe&#8211;it&#8217;s going to be bad, but the deprecated PVK index will let the issuer know that it should not trust that card for magstripe transactions.  The PIN value and PVK index stored in the card&#8217;s cip can be updated by pushing an issuer script to the card, and of course the PVVs and PVK indexes in the database can be set when a new PIN is issued.</p>
<p>Of course, that all assumes that the bank is doing things right.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351516">

			<div class="comment by-scot ">

				<p class="commentcredit">

					<span class="commenter">scot</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351516">
						June 17, 2020 8:19 AM					</a>

				</p>

				<p>(Also, if anyone wants to see how the algorithms work, there is a tool here <a href="https://github.com/fluzwup/Cryptonomicon" rel="nofollow ugc">https://github.com/fluzwup/Cryptonomicon</a> that performs most of the chip card cryptographic functions.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351517">

			<div class="comment by-zboot ">

				<p class="commentcredit">

					<span class="commenter">zboot</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351517">
						June 17, 2020 10:09 AM					</a>

				</p>

				<p>@Scott -If the bank can communicate a new PIN to the customer, that means they are capable of generating it, which means they have all the information necessary to impersonate the customer, which means whomever stole the banks master keys also has that information.</p>
<p>So, all the cards have to be replaced because the bank essentially needs to destroy all existing information that they have which could let them change the PIN information on existing cards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351518">

			<div class="comment by-atn ">

				<p class="commentcredit">

					<span class="commenter">ATN</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351518">
						June 17, 2020 10:45 AM					</a>

				</p>

				<p>Interesting that this breach has been made public, I would have thought that considering $3.2 million is below $58 million, the bank managers would have hidden the fact and kept their yearly bonus&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351519">

			<div class="comment by-sue-donim ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://iamnotthemessiah.com' rel='external nofollow ugc' class='url'>Sue d&#039;Onim</a></span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351519">
						June 17, 2020 11:18 AM					</a>

				</p>

				<p>&#8220;allows them to &#8230; rewrite account balances&#8221;! This sounds like every crook&#8217;s dream. Did that actually happen? Could the bank do anything about it if it did?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351520">

			<div class="comment by-raul ">

				<p class="commentcredit">

					<span class="commenter">raul</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351520">
						June 17, 2020 11:44 AM					</a>

				</p>

				<p>The key was copied, not stolen. Had it been stolen, the bank would have noticed it immediately, because they wouldn&#8217;t have been able to process their customers&#8217; legitimate transactions. This might happen if, for example, a rogue but stupid employee walked out with the hardware security module.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351521">

			<div class="comment by-wiredog ">

				<p class="commentcredit">

					<span class="commenter">wiredog</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351521">
						June 17, 2020 11:51 AM					</a>

				</p>

				<p>Someone needs to forward this to the FBI with a little note about how this shows why having a master key to backdoor communications is a bad thing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351522">

			<div class="comment by-scot ">

				<p class="commentcredit">

					<span class="commenter">scot</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351522">
						June 17, 2020 12:49 PM					</a>

				</p>

				<p>@zboot The bank can already impersonate the customer, all they have to do is create a new card linked to the customer&#8217;s account.  Or just change some numbers in the database to move the money to a different account.  There are many ways for &#8220;the bank&#8221; to do such things, but all of them <em>should</em> involve more than one person.  By keeping the entire key stored in a single location, they bank broke the rules, and let a single person exploit succeed.</p>
<p>For example, when symmetric keys are exchanged between organizations, the key is generated inside the originating organization&#8217;s HSM along with two random numbers of the same length.  The random numbers are XORed with the key, and the result, along with the random numbers, are physically mailed, in tamper-evident packaging, on different days, by different carriers, to different individuals at the destination organization.  When all components arrive, the three individuals then open their packages, enter their components into their HSM one at a time, where the key is reassembled inside the HSM by XORing the three components.  No one person ever has access to more than one component, and if any of the three components are compromised, the key is discarded and the process is repeated.</p>
<p>I do wonder how the fraud was committed with the PVK, though.  Sure, you can reverse engineer the PIN from the PVV and PVK, but that only helps you in PIN based transactions, which are by necessity card-present transactions.  That leaves you with the problem of generating physical cards; not technically challenging if you&#8217;re just creating magstripe cards (just need card stock and a stripe writer), but you need many additional keys to create chip cards (the issuer master RSA key to match the CA signed certificate, the master derivation key, card verification key).  Of more use would be the CVK, which is used to generate the CVV, iCVV, and CVV2 values.  With a list of PANs, expiration dates, and the CVK, you could generate the CVV2 values (that&#8217;s the 3 digit code printed on the back of the card) and perform card-not-present fraud.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351523">

			<div class="comment by-globaltel ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://globaltel.com/international-jail-call.aspx' rel='external nofollow ugc' class='url'>Globaltel</a></span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351523">
						June 17, 2020 9:43 PM					</a>

				</p>

				<p>There are lots of bank hackers in India and Africa. Imagine replacing all bank cards is pretty expensive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351524">

			<div class="comment by-lurker ">

				<p class="commentcredit">

					<span class="commenter">lurker</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351524">
						June 18, 2020 12:26 AM					</a>

				</p>

				<p>@Andrew:<br />
this is Africa, price of replacing a card = $2-3 + (Bantu word for baksheesh|squeeze|gratuité).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351525">

			<div class="comment by-bobby-joe ">

				<p class="commentcredit">

					<span class="commenter">Bobby Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351525">
						June 18, 2020 12:46 AM					</a>

				</p>

				<p>You would think basic access controls like least privilege, split knowledge, dual control, etc are child&#8217;s play. But when it&#8217;s the employees(aka the bank) committing the fraud, all those mean nothing due to massive collusion. Maybe there shouldn&#8217;t be employee direct access to such codes but some kind of ERP access to an API. Talk of zero trust.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351526">

			<div class="comment by-ross-anderson ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.cl.cam.ac.uk/~rja14' rel='external nofollow ugc' class='url'>Ross Anderson</a></span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351526">
						June 18, 2020 1:46 AM					</a>

				</p>

				<p>My Security Engineering textbook explains in detail how both mag stripe and chip card PIN systems work. See chapter 12 of: <a href="https://www.cl.cam.ac.uk/~rja14/book.html" rel="nofollow ugc">https://www.cl.cam.ac.uk/~rja14/book.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351527">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351527">
						June 18, 2020 4:08 AM					</a>

				</p>

				<p>Why is there a Single Master PIN Key?</p>
<p>I would expect to have to combine 2 or more keys held by different employees to be allowed to do Master PIN Key stuff. With the actual master key only available in secured memory during actual transactions and never stored.</p>
<p>Or was that the case and was the Master Key dumped from memory?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351528">

			<div class="comment by-scot ">

				<p class="commentcredit">

					<span class="commenter">scot</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351528">
						June 18, 2020 9:16 AM					</a>

				</p>

				<p>@Winter  The PIN verification key is actually a pair of single length DES keys, used in a TDES-like hash function (encrypted with key A, decrypt with B, encrypt again with A).  The card also encodes a single digit PVK index, allowing 10 potential PVK pairs to be chosen.  Of course each bank has its own key set, and could potentially have different key sets for different card ranges, specified by certain digits of the card numbers.</p>
<p>The question here is why was the key on paper in the clear?</p>
<p>If the bank shared their PVK with, say, Visa (allowing Visa to do stand-in PIN validation), then the keys would have been shared in three parts that had to be XORed together (see my earlier comment).  No single person should ever see or have possession of more than one compoment, and the components should be securely stored until the key ceremony.  During the key ceremony, the components are combined in the hardware security module (HSM), and that is the only place the complete key should ever come together.  The only keys typically shared this way are transport keys, which are keys used to encrypt other keys.  A PVK exchange between organizations would involve exchanging the PVK under a previously established transport key.</p>
<p>Keys do have to be backed up, of course, in case of an HSM failure.  HSMs, at least the ones I&#8217;ve worked with, store the keys encrypted with a master key.  A PVK backup, then, would only have needed to be a backup of the encrypted key.  To restore or upgrade an HSM, you would set the master key, and then load all the encrypted keys.  Modern HSMs back up their master key in a secure fashion that protects against compromise or loss, such as writing it across a set of smart cards, where you need at least N of M cards to assemble the full key (N being a minimum of 2, and M &gt; N).  Data security standards call for storing those keys in separate safes, ideally at separate physical locations (as a loss prevention measure), with no person having access to more than one safe.</p>
<p>The last possible route to compromise is the transport keys.  If an individual had HSM access, and knew the clear key value of a transport key, then the PVK could have been exported under the compromised transport key, and decrypted elsewhere.  The only way to inject a key into a locked down HSM is through a key ceremony, and the interface for that should require two administrator passwords to unlock.</p>
<p>In short, either multiple people with privileged access where involved, or there were some serious breakdowns in Payment Card Industry Data Security Standards compliance at the bank.  I&#8217;d bet on the latter.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351529">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">Tatütata</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351529">
						June 18, 2020 10:30 AM					</a>

				</p>

				<p><i>The master key, a 36-digit code,</i></p>
<p>Cryptologically speaking, isn&#8217;t that a bit short for any sort of security?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-351530">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">Tatütata</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351530">
						June 18, 2020 10:31 AM					</a>

				</p>

				<p>Ooops, brain runs at 10% capacity. I read &#8220;bit&#8221; instead of &#8220;digit&#8221;. Please disregard/delete previous nonsense.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-351531">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/#comment-351531">
						June 18, 2020 11:32 AM					</a>

				</p>

				<p>@ Tatütata,</p>
<blockquote><p>I read &#8220;bit&#8221; instead of &#8220;digit&#8221;. Please disregard/delete previous </p></blockquote>
<p>Let&#8217;s see 36 &#8220;digits&#8221; is assumed to be decimal unless otherwise stated so 10^36 which is about, 2^120 (1.329228e36)&#8230;</p>
<p>So as 256 bits is prefered with a stronger algorithm than 3DES and 128 is considered a bare minimum.</p>
<p>Then,</p>
<blockquote><p>&#8230; isn&#8217;t that a bit short for any sort of security?</p></blockquote>
<p>Is not wrong 😉</p>
<p>Treat &#8220;your gut&#8221; to something it enjoys as it&#8217;s &#8220;fealing / hunch&#8221; was close enough. As for the brain it obviously needs a couple of weeks somewhere relaxing, I would normally recomend a beach somewhere with a well stocked &#8220;on the beach&#8221; café and bar 🙂 But sadly most of those are compleatly unavailable currently 🙁</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2020/06/bank_card_maste.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2020/06/bank_card_maste.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F06%2Fbank_card_maste.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2020/06/bank_card_maste.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12515' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2020/06/eavesdropping_o_9.html" rel="prev">← Eavesdropping on Sound Using Variations in Light Bulbs</a>		<a href="https://www.schneier.com/blog/archives/2020/06/zoom_will_be_en.html" rel="next">Zoom Will Be End-to-End Encrypted for All Users →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
