<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Exploiting Spectre Over the Internet - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Exploiting Spectre Over the Internet Comments Feed" href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/62092" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=62092' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F03%2Fexploiting-spectre-over-the-internet.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F03%2Fexploiting-spectre-over-the-internet.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-62092 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-62092" class="post-62092 post type-post status-publish format-standard hentry category-uncategorized tag-exploits tag-google tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">Exploiting Spectre Over the Internet</h2>
		<p>Google has <a href="https://security.googleblog.com/2021/03/a-spectre-proof-of-concept-for-spectre.html">demonstrated</a> exploiting the <a href="https://www.schneier.com/blog/archives/2018/01/spectre_and_mel.html">Spectre CPU attack</a> remotely over the web:</p>
<blockquote><p>Today, we&#8217;re sharing proof-of-concept (PoC) code that confirms the practicality of Spectre exploits against JavaScript engines. We use Google Chrome to demonstrate our attack, but these issues are not specific to Chrome, and we expect that other modern browsers are similarly vulnerable to this exploitation vector. We have developed an interactive demonstration of the attack available at <a href="https://leaky.page">https://leaky.page/ </a>; the code and a more detailed writeup are published on Github <a href="https://github.com/google/security-research-pocs/tree/master/spectre.js">here</a>. </p>
<p>The demonstration website can leak data at a speed of 1kB/s when running on Chrome 88 on an Intel Skylake CPU. Note that the code will likely require minor modifications to apply to other CPUs or browser versions; however, in our tests the attack was successful on several other processors, including the Apple M1 ARM CPU, without any major changes.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/exploits/" rel="tag">exploits</a>, <a href="https://www.schneier.com/tag/google/" rel="tag">Google</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html" rel="bookmark">Posted on March 18, 2021 at 6:17 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html#comments">16 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html" data-title="Exploiting Spectre Over the Internet" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-371012">

			<div class="comment by-metaschima ">

				<p class="commentcredit">

					<span class="commenter">metaschima</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371012">
						March 18, 2021 10:02 AM					</a>

				</p>

				<p>It seems to work on my Intel i5 laptop, but fails on my Android phone. I suppose ARM processors are more resistant to this attack? Although I see the Apple M1 ARM is susceptible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371050">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371050">
						March 18, 2021 4:47 PM					</a>

				</p>

				<p>@ ALL,</p>
<p>Am I the only one thinking,</p>
<p>&#8220;Why has it taken so long to come up with an exploit&#8221;?</p>
<p>The fact that all time based side channels can be exploited in one way or another to leak either secrets or identification of the system or user, you would have thought would have encoraged students and similar to develop POC code and publish a paper.</p>
<p>As a time line the first big example of using the cache to leak the AES key across the network just a couple of weeks after the finalist was finalised would have woken people up a bit.</p>
<p>Then the research involving identifing that different host interfaces in a system by TCP timeing and the system clock drift. Again you would have thought would also wake people up.</p>
<p>We&#8217;ve been &#8220;Sleepwalking&#8221; into this problem and to be honest I get the feeling the industry has become almost entirely apathetic about it.</p>
<p>After all it&#8217;s not a problem that can be solved by an application. Becsuse the root cause is way further down the computing stack than the CPU layer let alone it&#8217;s ISA layer.</p>
<p>Like all &#8220;bubbling up attacks&#8221; it can not be solved by top down coding, it needs appropriate hardware in place. But Intel have made it brutally clear they care not a jot in real secure hardware design, because it would make those &#8220;oh so important specs look bad&#8221;.</p>
<p>As I&#8217;ve indicated for more than a decade or so these hardware securiry issues and their solution have been known for many decades and they were not that difficult to implement even back in the 1960&#8217;s.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-371053">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371053">
						March 18, 2021 5:09 PM					</a>

				</p>

				<p>One program I wrote on x86 used a asm instruction to read a clock tick of the CPU, maybe if you read the clock then did ror24 then read the clock it would tell you a aes was at what point, if it was quick, you would know there wasn&#8217;t many LSB , but the people don&#8217;t have the skills Clive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371054">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371054">
						March 18, 2021 5:15 PM					</a>

				</p>

				<p>@ metaschima, kai, Clive</p>
<p>Silicon Turtles</p>
<p>READ. LEARN. UNDERSTAND.</p>
<blockquote><p>Note that the code will likely require minor modifications to apply to other CPUs or browser versions</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-371061">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371061">
						March 19, 2021 1:27 AM					</a>

				</p>

				<p>Windows allocate the seq/ack numbers in the TCP header by the clock instruction, maybe a leakage.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371064">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371064">
						March 19, 2021 2:09 AM					</a>

				</p>

				<p>Unsigned int vedx,veax<br />
Asm(&#8220;rdtsc&#8221;)<br />
Asm(&#8220;mov vedx edx&#8221;)<br />
Asm(&#8220;mov veax eax&#8221;)<br />
Asm(&#8220;ror esi 24&#8221;)<br />
Asm(&#8220;rdtsc&#8221;)<br />
Asm(&#8220;mov vedx1 edx&#8221;)<br />
Asm(&#8220;mov veax1 eax&#8221;)<br />
Printf(&#8220;%8x%8x&#8221;,vedx1-vedx,veax1-veax)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-371065">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371065">
						March 19, 2021 3:05 AM					</a>

				</p>

				<p>@ Weather</p>
<p>Better than leakage.  MITM. Watch for 429.</p>
<p><a href="https://www.thegeekstuff.com/2012/01/tcp-sequence-number-attacks/" rel="nofollow ugc">https://www.thegeekstuff.com/2012/01/tcp-sequence-number-attacks/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371066">

			<div class="comment by-xcv ">

				<p class="commentcredit">

					<span class="commenter">xcv</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371066">
						March 19, 2021 3:07 AM					</a>

				</p>

				<p>@ Weather • March 19, 2021 2:09 AM</p>
<blockquote><p>
  Unsigned int vedx,veax<br />
  Asm(“rdtsc”)<br />
  Asm(“mov vedx edx”)<br />
  Asm(“mov veax eax”)<br />
  Asm(“ror esi 24”)<br />
  Asm(“rdtsc”)<br />
  Asm(“mov vedx1 edx”)<br />
  Asm(“mov veax1 eax”)<br />
  Printf(“%8x%8x”,vedx1-vedx,veax1-veax)
</p></blockquote>
<p>Read Time Stamp Counter.<br />
Move the results out to memory.<br />
Do a rotate instruction on an unrelated (?) register.<br />
Read Time Stamp Counter again.<br />
Move the results out to memory, assuming variables vedx1 and veax1 have been declared.<br />
Subtract and print out the number of clock cycles required to execute one rdtsc instruction, two double word writes to memory, and one ror instruction.</p>
<p>Of course the moves to memory, (assuming Intel notation,) do not have to be completed in order for the rdtsc instruction to be executed for the second time.</p>
<p>The moves to memory only have to be completed in time for a subsequent fetch to compute the arguments in preparation for the call to printf; if not, the processor&#8217;s pipeline will stall, and there will be a few clock cycles&#8217; delay; if there is a memory cache miss, there will be a much longer delay until the cache is flushed and written out to main memory; but that only delays the call to printf, not the computation of the time delay between the two executions of rdtsc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-371068">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371068">
						March 19, 2021 3:36 AM					</a>

				</p>

				<p>@ xcv, Weather</p>
<p>&#8220;if not, the processor’s pipeline will stall, and there will be a few clock cycles’ delay; if there is a memory cache miss, there will be a much longer delay until the cache is flushed and written out to main memory; &#8221;</p>
<p>You just do what Weather coded, twice, back to back.  Everything should be in cache on the second pass.</p>
<p>It is extremely doubtful that would not be the case.  Extremely doubtful.</p>
<p>I seriously can not envision a scenario where I could bury a core and interrupt it enough to cause cache misses every time.</p>
<p>In theory, yes I could with carefully planned workload.  As an attacker?  They would not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371069">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371069">
						March 19, 2021 5:27 AM					</a>

				</p>

				<p>@ ALL,</p>
<p>With regards my earlier comment of,</p>
<blockquote><p><i>&#8220;Then the research involving identifing that different host interfaces in a system by TCP timeing and the system clock drift.&#8221;</i></p></blockquote>
<p>First came up on this blog back in early March 2005,</p>
<p><a href="https://www.schneier.com/blog/archives/2005/03/remote_physical.html/#comment-3050" rel="nofollow ugc">https://www.schneier.com/blog/archives/2005/03/remote_physical.html/#comment-3050</a></p>
<p>Then at the begining of September 2006 a year and half later, Steven J. Murdoch over at the Cambridge Computer labs, came up with,</p>
<p>&#8220;Hot or Not: Revealing Hidden Services by their Clock Skew&#8221;,</p>
<p><a href="https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/" rel="nofollow ugc">https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/</a></p>
<p>Whilst Steven used it to demonstrate finding services hidden behind Tor, I&#8217;d been thinking about to me a more interesting attack.</p>
<p>If you are a high end researcher into zero-day vulnerabilities you will know how valuable they can be in terms of time and other resources invested in finding new ones. You will also know that one of the ways such zero-day attacks become &#8220;Known and Negated&#8221; back then was &#8220;Honey Pots&#8221;.</p>
<p>So as an attacker how do you find out if the IP address range you are just about to go and &#8220;tap up&#8221; is actually real individual machines, or just one machine pretending to be a network of machines and is in fact a &#8220;Honey Pot&#8221; part of the &#8220;Honeynet Project&#8221; aimed at capturing things like freshly minted zero-days?</p>
<p>Well the problem for a &#8220;honey pot&#8221; is no matter how many hosts it fakes it still has only one master CPU clock&#8230; Thus measuring the clock drift is one good way to do it.</p>
<p>However Steve Murdoch&#8217;s original system was both very noisy and inefficient. He used many many probes across a given time period which would show up in the Honey Pot logs. Also as any comms engineer who knows what an &#8220;eye diagram&#8221; is will tell you all the timing information is in the clock edges. Which translates to when the TCP time stamp rolls over in the attack. So any proabs not at that time are wasted as they provide no usefull information &#8211;out side of initial syncing&#8211; and fill the logs up.</p>
<p>So by using a two stage approach of first &#8220;halve the difference&#8221; to obtain sync then just a few probes across the time of the expected TCP time stamp transition will give you an effective tracking loop (as are used in many Spread Spectrum and data receivers).</p>
<p>This still will leave traces in the Honey Pot log though&#8230; How to deal with that?</p>
<p>Well you can not stop them getting logged, so make them hide in amongst &#8220;expected traffic&#8221; and use the Honey Pot operators assumptions work against them. In short a little bit of &#8220;social engineering&#8221;. The way I chose to prototype this was to make the attack look like &#8220;A brain dead Script Kiddy Attack&#8221; which were very numerous back then.</p>
<p>The result is the chances were that the Honey Pot logs like todays IDS log watching processes would &#8220;note, classify, filter and ignore&#8221;. Thus as an attacker with a nice shiny new zero-day you would find the Honey Pot and thus ignore it thus your zero-day would be like the butterfly that escapes the lepidopterists net, fomalin jar, and being pined to a cork on public display.</p>
<p>But there is another use for the time stamp attack, which brings us back to cache attacks.</p>
<p>Mad as it might first appear from a security perspective people share computers in data centers to reduce costs of running an Internet connected service. Most such shared services are just like the Honey Pot machines but rented out from server farms and some Cloud Servers&#8230;</p>
<p>Many cache attacks require a probe on the machine they are trying to detect secrets such as AES keys etc leaking from via time based side channels.</p>
<p>Using a TCP Time Stamp attack would give information about what other services share the machine of interest, thus increase your chances of finding a way to mount a probe.</p>
<p>All of this was either known or easily worked out more than a decade and a half ago.</p>
<p>In times past I used to find that attacks I thought up would take about eight years to becoming found in the wild&#8230;</p>
<p>So &#8220;Why So Long?&#8221; this time&#8230;</p>
<p>Is it because the entire ICTsec industry has slowed down? Become inefectual? Lacks investment? Has become filled with snake oil salesmen?</p>
<p>I have commented on a number of occasions that in ICTsec &#8220;We fail to learn from our history&#8221; with attack methods and even attacks getting &#8220;re-cycled&#8221; every few years, so that &#8220;What was old is new again&#8221; like skinny leg jeans.</p>
<p>I&#8217;ve also noted that due to the failures of the big corporates our consumer grade Hardware, OS&#8217;s and Apps have more holes than &#8220;moth eaten string ubderpants&#8221; thus in the process of letting everyone down make the entire LAN, WAN, and Internet connrcted structure a very very &#8220;target rich environment&#8221; for attackers.</p>
<p>Thus is it just that modern attackers are so few in comparison that they are in effect &#8220;living off the fat of the land&#8221; with low hanging fruit and windfalls, thus have no real need to strive? To inovate? To learn, grow and evolve?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-371070">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371070">
						March 19, 2021 5:40 AM					</a>

				</p>

				<p>@Xcv slf<br />
The esi was example of another core doing a instruction and the CPU not doing the other core instruction again if the same.<br />
The mov plus ror is the number of cycle the CPU takes to process it. It should be 3 I think?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371126">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371126">
						March 19, 2021 5:46 PM					</a>

				</p>

				<p>@ Weather</p>
<p>I do not see another core in use.  Another ALU yes.</p>
<p>As to the cycles between the clock reads, it may be near 1.</p>
<p>The two MOVs possibly may be done together in one cycle.</p>
<p><a href="https://www.agner.org/optimize/#manual_instr_tab" rel="nofollow ugc">https://www.agner.org/optimize/#manual_instr_tab</a></p>
<p>The number of cycles to read the clock is the heavy load.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-371128">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371128">
						March 19, 2021 6:24 PM					</a>

				</p>

				<p>@slf<br />
Assuming the compiler doesn&#8217;t change it to movd etc.<br />
If you have two program&#8217;s the share the l2 cache on the CPU, say one program is just a loop of rotate, the second program runs the same instruction that happens to match the same value, if program is running or not&#8230; It doesn&#8217;t matter how long rdtsc takes, and you only get one arithmetic unit per core that I remember?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371129">

			<div class="comment by-weather ">

				<p class="commentcredit">

					<span class="commenter">Weather</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371129">
						March 19, 2021 7:10 PM					</a>

				</p>

				<p>@xcv slf<br />
When my computer is free I&#8217;ll write a poc, has I&#8217;m having trouble explain it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-371132">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371132">
						March 19, 2021 7:41 PM					</a>

				</p>

				<p>@ Weather</p>
<p>ALUs per core vary.  Newer processors may have more than two.  But your program is stuck in one core.</p>
<p>Just as an experiment, try doing your clock reads and saves THREE times in a row.<br />
Then FOUR times, and ignore the first result.  printf the results after finishing all of the clock reads.  See if you notice anything.  Next, duplicate the number of MOVs at each step.  I.E., make them redundant.  Try tripling the redundant MOVs.  Maybe more. Keep them alternating between eax and edx.</p>
<p>With enough effort, you will be able to discern a lot as to the cycles per instruction.</p>
<p>You should be able to figure out the cycles for the MOVs, and the RDTSC instruction for the machine that you are testing on.  Very accurately with enough testing.</p>
<p><a href="https://stackoverflow.com/questions/58893726/do-single-threaded-programs-execute-in-parallel-in-a-cpu" rel="nofollow ugc">https://stackoverflow.com/questions/58893726/do-single-threaded-programs-execute-in-parallel-in-a-cpu</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-371167">

			<div class="comment by-trx ">

				<p class="commentcredit">

					<span class="commenter">TRX</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/#comment-371167">
						March 20, 2021 11:45 AM					</a>

				</p>

				<blockquote><p>
  “Why has it taken so long to come up with an exploit”?
</p></blockquote>
<p>What would a working exploit be worth, to the right agency or organization?  It&#8217;s possible the market is now mostly saturated.</p>
<p>That&#8217;s just the first exploit someone chose to publicize and take credit for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2021/03/exploiting-spectre-over-the-internet.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2021/03/exploiting-spectre-over-the-internet.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F03%2Fexploiting-spectre-over-the-internet.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2021/03/exploiting-spectre-over-the-internet.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='62092' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html" rel="prev">← Illegal Content and the Blockchain</a>		<a href="https://www.schneier.com/blog/archives/2021/03/easy-sms-hijacking.html" rel="next">Easy SMS Hijacking →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
<!--
	generated 56 seconds ago
	generated in 0.264 seconds
	served from batcache in 0.001 seconds
	expires in 244 seconds
-->
