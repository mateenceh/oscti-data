<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Metadata Left in Security Agency PDFs - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Metadata Left in Security Agency PDFs Comments Feed" href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/62047" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=62047' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F03%2Fmetadata-left-in-security-agency-pdfs.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F03%2Fmetadata-left-in-security-agency-pdfs.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-62047 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-62047" class="post-62047 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-metadata tag-security-analysis">

	<div class="article">

		<h2 class="entry">Metadata Left in Security Agency PDFs</h2>
		<p>Really interesting <a href="https://arxiv.org/abs/2103.02707">research</a>:</p>
<blockquote><p>&#8220;Exploitation and Sanitization of Hidden Data in PDF Files&#8221;</p>
<p><b>Abstract:</b> Organizations publish and share more and more electronic documents like PDF files. Unfortunately, most organizations are unaware that these documents can compromise sensitive information like authors names, details on the information system and architecture. All these information can be exploited easily by attackers to footprint and later attack an organization. In this paper, we analyze hidden data found in the PDF files published by an organization. We gathered a corpus of 39664 PDF files published by 75 security agencies from 47 countries. We have been able to measure the quality and quantity of information exposed in these PDF files. It can be effectively used to find weak links in an organization: employees who are running outdated software. We have also measured the adoption of PDF files sanitization by security agencies. We identified only 7 security agencies which sanitize few of their PDF files before publishing. Unfortunately, we were still able to find sensitive information within 65% of these sanitized PDF files. Some agencies are using weak sanitization techniques: it requires to remove all the hidden sensitive information from the file and not just to remove the data at the surface. Security agencies need to change their sanitization methods. </p></blockquote>
<p>Short summary: no one is doing great.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/metadata/" rel="tag">metadata</a>, <a href="https://www.schneier.com/tag/security-analysis/" rel="tag">security analysis</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html" rel="bookmark">Posted on March 12, 2021 at 6:03 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html#comments">22 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html" data-title="Metadata Left in Security Agency PDFs" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-370672">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370672">
						March 12, 2021 7:51 AM					</a>

				</p>

				<p>@ Bruce, ALL,</p>
<blockquote><p>Short summary: no one is doing great.</p></blockquote>
<p>Well maybe,</p>
<p>&#8220;Paper, Paper, NEVER Data&#8221;</p>
<p>Should be the way to go. Print the doc out manually redact it, then scan the result back in as an image file, and then encapsulate that in a PDF.</p>
<p>That way the only meta-data is from the final stage  publishing process, which can be done by unclasified processes and staff in an external commercial staff agency.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370673">

			<div class="comment by-aanon ">

				<p class="commentcredit">

					<span class="commenter">a'anon</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370673">
						March 12, 2021 7:57 AM					</a>

				</p>

				<p>I use <a href="https://en.wikipedia.org/wiki/ExifTool" rel="nofollow ugc">ExifTool</a> to remove metadata from PDF files (and pictures) before distributing them; <i>i.e.</i>, posting to the &#8216;net, sending via e-mail, <i>etc.</i>.</p>
<p>It produces a warning that data may be recovered.</p>
<blockquote><p><b>$</b> exiftool -all= *.pdf<br />
Warning: [minor] ExifTool PDF edits are reversible. Deleted tags may be recovered! &#8211; <i>filename</i>.pdf<br />
1 image files updated<br />
<b>$</b></p></blockquote>
<p>I do not get this warning with .jpg and .png files.</p>
<p>Are there any recommendations for a better alternative?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370674">

			<div class="comment by-david-rudling ">

				<p class="commentcredit">

					<span class="commenter">David Rudling</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370674">
						March 12, 2021 7:59 AM					</a>

				</p>

				<p>This is somewhat surprising.  It isn&#8217;t as if there are no tools publicly available to do the job, eg:-</p>
<p>ht tps://kbpdfstudio.qoppa.com/sanitize-pdf-tool-to-remove-sensitive-data/</p>
<p>although I don&#8217;t know how good a job it does.</p>
<p>Security Agencies, if no one else,  could and should have access to tools certified to their Agency standards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370677">

			<div class="comment by-cdrjameson ">

				<p class="commentcredit">

					<span class="commenter">CdrJameson</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370677">
						March 12, 2021 10:06 AM					</a>

				</p>

				<p>So, copy and paste it into notepad then make a new PDF from that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370678">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370678">
						March 12, 2021 11:06 AM					</a>

				</p>

				<p>@Clive Robinson,CdrJameson</p>
<p>If you did that, the article would still rate you as failing. Re-scanning the pdf or generating the pdf on a non-secure computer would still leave meta-data.</p>
<p>They have no way of knowing whether the metadata is describing a secure box with access to important documents or some junk machine whose only purpose is to generate pdfs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370680">

			<div class="comment by-lurker ">

				<p class="commentcredit">

					<span class="commenter">lurker</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370680">
						March 12, 2021 12:19 PM					</a>

				</p>

				<p>@CdrJameson, All<br />
How much metadata does Notepad remove from Word files?  It&#8217;s so long ago I can&#8217;t remember when I first started reading the internals of Word files to get more information than the face value.</p>
<p>Since the PDF format is published, any app can create .pdf files by any method, and include as much or as little of its own metadata as it chooses, as well as adding pdf relevant metadata. From the paper:</p>
<blockquote><p>The issue is that popular PDF producing tools are keeping <b>metata by default</b> with many other data while creating a PDF file. They provide no option for sanitization or it can only be achieved by following a complex procedure. Software producing PDF files need to enforce <b>sanitization by default</b>. The user should be able to add metadata only as an option.</p></blockquote>
<p>and</p>
<blockquote><p>We observed that if <i>exiftool</i> is used to sanitize a PDF file, it is still possible to recover all the metadata.</p></blockquote>
<p>bold in original</p>
<p>The authors mention the use of <i>grep</i> to locate juicy bits, but it&#8217;s often useful to look at the context around each nugget of info.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370682">

			<div class="comment by-my2cents ">

				<p class="commentcredit">

					<span class="commenter">my2cents</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370682">
						March 12, 2021 1:09 PM					</a>

				</p>

				<p>Why waste paper ? Just make screenshots you put in a newly, securly created .pdf.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370683">

			<div class="comment by-mk ">

				<p class="commentcredit">

					<span class="commenter">MK</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370683">
						March 12, 2021 1:30 PM					</a>

				</p>

				<p>There are meta-steps in the redaction process. Otherwise one can analyze the blank or redacted areas to reconstruct text. Even printing, blacking and refrying to PDF is not sufficient:</p>
<p>ht tps://www.octantus.associates/redacting-documents-correctly-a-failure-case-study/</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370684">

			<div class="comment by-kurt-seifried ">

				<p class="commentcredit">

					<span class="commenter">Kurt Seifried</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370684">
						March 12, 2021 2:15 PM					</a>

				</p>

				<p>This is why I just take a screenshot of the page if I&#8217;m feeling paranoid, you&#8217;d get metadata but it&#8217;s now just time/my workstation, there&#8217;s no undo button/worrying about if I flattened all the levels, etc.</p>
<p>I&#8217;m always shocked that places don&#8217;t &#8220;virtual&#8221; scan (e.g. display and take an automated screenshot and repack them all into a PDF) in order to ensure what is displayed is all that gets released. It&#8217;s a scripted activity on any modern system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370686">

			<div class="comment by-wandanon ">

				<p class="commentcredit">

					<span class="commenter">Wand'anon</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370686">
						March 12, 2021 3:29 PM					</a>

				</p>

				<p><b>&gt;</b> &#8220;<i>Ana Above is the wicked witch from the north yet again under another handle…</i>&#8221;</p>
<p>Who’s been messing up everything?<br />
It’s been Ana all along!</p>
<p>Who’s been pulling every evil string?<br />
It’s been Ana all along!</p>
<p>She’s insidious<br />
(Ha-ha!)</p>
<p>So perfidious<br />
That you haven’t even noticed</p>
<p>And the pity is<br />
(The pity is, pity pity pity pity)</p>
<p>It’s too late to fix anything<br />
Now that everything has gone wrong</p>
<p>Thanks to Ana<br />
(Ha!)</p>
<p>Naughty Ana!<br />
It’s been Ana all along!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370689">

			<div class="comment by-socraticgadfly ">

				<p class="commentcredit">

					<span class="commenter">SocraticGadfly</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370689">
						March 12, 2021 4:05 PM					</a>

				</p>

				<p>Er, what about a screengrab as a PNG? Low resolution, true, but certainly avoids PDF issues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370690">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370690">
						March 12, 2021 4:12 PM					</a>

				</p>

				<p>@ MK,</p>
<blockquote><p>There are meta-steps in the redaction process.</p></blockquote>
<p>I,gave the &#8220;octantus&#8221; article you provided a quick scan.</p>
<p>I did not see it mention the &#8220;Hard hyphen&#8221; issue&#8230;</p>
<p>In many documents you have made in standard WordProc software the &#8220;word wrap&#8221; only works with words upto some character length before it &#8220;soft hyphenates&#8221; longer words.</p>
<p>The person typing a document can put in their own &#8220;hard hyphens&#8221; if they do not like how the document works.</p>
<p>The problem is &#8220;marmalade&#8221; stay &#8220;marmalade&#8221; with soft hyphens so gets picked up in word searches. However with hard hyphens it can become two words such as &#8220;marm-&#8221; and &#8220;alade&#8221; which is actually what the user typed in&#8230;</p>
<p>I found this out when looking for &#8220;Digital watermarks&#8221; in a document for someone&#8230; And low and behold a *nix &#8220;pipe&#8221; filter I had writen some years ago found after a cut and paste, short nonsense words ended in hyphens and other short nonsense words that looked like common word endings a hard hyphenated &#8220;Skiing&#8221; whilst &#8220;Sk-&#8221; might be the result of somebody typing in a bit of a maths equation &#8220;iing&#8221; did not make sense on it&#8217;s own.</p>
<p>Another anoyance is the multiplicity of apostrophes in some charecter sets they might look the same on a printed page to a casual glance but they are not the same charecter</p>
<p>@ ALL</p>
<p>So if you are cut-n-pasting use an itermediate that only has &#8220;7-bit ASCII&#8221; as opposed to one, four or more bytes per character&#8230;</p>
<p>Some people use such things to not just watermark a document but put a unique serial number in a printed page&#8230; Something Whistleblowers need to be aware of.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370693">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370693">
						March 12, 2021 5:13 PM					</a>

				</p>

				<p>@MK, Clive:</p>
<p>Nothing I saw in the octantus article suggests that blackout-print-scan is not a fully effective technique for the redaction of selected content.</p>
<p>What it <em>does</em> warn about is that if the process of selecting content to be redacted is lazy or sloppy, you&#8217;ll likely let sensitive content go through.  <em>That</em> problem is not primarily a technical one.</p>
<p>Where security is critical, assurance levels must be kept very high.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370704">

			<div class="comment by-apokrif ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://en.wikipedia.org/wiki/Sanitization_(classified_information)' rel='external nofollow ugc' class='url'>Apokrif</a></span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370704">
						March 12, 2021 9:06 PM					</a>

				</p>

				<p>@my2cents: perhaps one is never sure that some user name, file path (which might include sensitive info), or information about the computer environement, cannot appear in the resulting file? Intellipedia pages (on theblackvault.com) released by the Department of Defense seemed to have been printed on paper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370715">

			<div class="comment by-my2cents ">

				<p class="commentcredit">

					<span class="commenter">my2cents</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370715">
						March 13, 2021 12:46 AM					</a>

				</p>

				<p>@Apokrif: the same applies to scans. It always depends on how secure your environment (OS, software, hidden cameras in you living room (;-)), &#8230;) is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370727">

			<div class="comment by-david-leppik ">

				<p class="commentcredit">

					<span class="commenter">David Leppik</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370727">
						March 13, 2021 12:11 PM					</a>

				</p>

				<p>If you print and scan, you&#8217;re just replacing old metadata with new metadata from your scanning app, which might be just as bad. What you really want is a tool specifically designed to remove metadata.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370730">

			<div class="comment by-lurker ">

				<p class="commentcredit">

					<span class="commenter">lurker</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370730">
						March 13, 2021 1:06 PM					</a>

				</p>

				<p>@David Leppik<br />
What I want is tools that don&#8217;t embed metadata in the first place. Unfortunately once filesystems start requiring filename, creation/modification date and type, then you&#8217;re off down the slippery slope with extra pockets for fob watch, cigar cutter, &amp;c.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370744">

			<div class="comment by-jonknowsnothing ">

				<p class="commentcredit">

					<span class="commenter">JonKnowsNothing</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370744">
						March 13, 2021 3:01 PM					</a>

				</p>

				<p>@lurker @David @All</p>
<p>re: <i>tools that don’t embed metadata in the first place.</i></p>
<p>Don&#8217;t forget about Undo-Redo&#8230;</p>
<p>Long ago those audit trails were fingered as security issues.</p>
<p>Along with &#8220;Group Edit / Approval&#8221; features that generate even bigger audit breadcrumbs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370754">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370754">
						March 13, 2021 4:34 PM					</a>

				</p>

				<p>@ David Leppik, ALL,</p>
<blockquote><p>If you print and scan, you’re just replacing old metadata with new metadata from your scanning app</p></blockquote>
<p>Not exactly. You are if you do it right, replacing the old &#8220;confidential metadata&#8221; with the new &#8220;unclasified metadata&#8221;.</p>
<p>Part of this is to use a scaned image format from last century. Back then many image formats did not contain meta-data. A PDF file will always contain considerable meta-data it is &#8220;built in&#8221; to the specification that Adobe appear to augment as fast as possible, so you will not be able to keep up with &#8220;what to strip out or make neutral&#8221;.</p>
<p>Personally I would not use PDF but simplified hand built Office Open XML document[1] that Microsoft Word since 2007 calls a .DOCX file.</p>
<p>Or even simpler to create, just create a folder with a main.html that has &#8220;./&#8221; links to the other files in the folder use touch to correct the dates and other file meta-data and build a zip archive.</p>
<p>If the recipient claims to be a technical numb-nuts just write a simple shell script to extract the file(s).</p>
<p>These ways you can control the meta-data going into the file. Building a shell script or simple C program to do the grunt work is not difficult. And if in a standard format like DOCX passes the &#8220;electronic discovery&#8221; nonsense, which is usually not about the document contents but getting their hands on meta-data, which you most definately want to stop as hard and as brutally as you can.</p>
<p>[1] OOXML is standardized by both the ISO and IEC (as ISO/IEC 29500 in later versions). Originally developed by Microsoft at the insistance of the US Government. Basically it&#8217;s a zipped XML-based file format. Where the zip is a standard zip archive and the XML a manifest and build of the container contents. You can download and read the whole four part specification but at just over 7000 pages for the EMCA version you might want to settle for just Part 2 or one of a number of online guides telling you how to build compatable files. A simplified one that will give you a feeling for what&#8217;s involved is,</p>
<p><a href="https://docs.fileformat.com/word-processing/docx/" rel="nofollow ugc">https://docs.fileformat.com/word-processing/docx/</a></p>
<p>To experiment use word to create a .DOCX file with just a couple of gifs in it use zip to open it as an archive to view the contents. This will give you further info to fairly simply reverse engineer things to your own &#8220;controled meta-data&#8221; requirments.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370760">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370760">
						March 13, 2021 5:53 PM					</a>

				</p>

				<p>@ Clive, David Leppik</p>
<blockquote><p> Not exactly. You are if you do it right, replacing the old “confidential metadata” with the new “unclasified metadata”.</p></blockquote>
<p>I doubt the yellow dots are &#8220;unclassified&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-370778">

			<div class="comment by-ollie-jones ">

				<p class="commentcredit">

					<span class="commenter">Ollie Jones</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370778">
						March 14, 2021 9:08 AM					</a>

				</p>

				<p>This kind of information leak damages all kinds of users, not just security agencies.</p>
<p>Let&#8217;s hope the developers / publishers of PDF software and PDF print drivers take this article as a call to action.</p>
<p>How about this?  A checkbox on print-to-PDF dialogs saying</p>
<blockquote><p>
   [ ]  include document metadata (this may be insecure)
</p></blockquote>
<p>along with a popup warning when a user checks it</p>
<blockquote><p>
   People may be able to determine your identity or<br />
   other information from metadata in your PDF files. </p>
<p>   Do you really want to include document metadata?</p>
<p>    Don&#8217;t ask me again [ ]             Yes    No
</p></blockquote>
<p>This would probably handle the most common use cases. And, it would raise awareness of the metadata problem among overworked and underpaid knowledge workers.</p>
<p>Furthermore, Adobe should open-source and publish a freely available utility program to do what Acrobat does when one of their customers sanitizes a PDF. (Acrobat does a decent job of sanitizing when you remember to use that feature.)</p>
<p>And maybe the popular content management systems (Google docs, WordPress, etc) should gain code to check for the presence of metadata in uploaded documents.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-370780">

			<div class="comment by-jonknowsnothing ">

				<p class="commentcredit">

					<span class="commenter">JonKnowsNothing</span> •

					<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/#comment-370780">
						March 14, 2021 10:25 AM					</a>

				</p>

				<p>@Ollie Jones @All</p>
<p>re: <i>How about this? A checkbox on print-to-PDF dialogs&#8230;</i></p>
<p>Check box is nice but how do you know what the publishers will really do with the excised MetaData?</p>
<p>Some one knowledgeable might be able to verify that the metadata didn&#8217;t leave your PC/System and that there are no hidden codes to tag your PDF as a &#8220;suspicious document&#8221; as  it makes it&#8217;s way across the digital highway.</p>
<p>In the USA we have LEAs that have the authority to demand companies do their bidding, called National Security Letters (NSL).  With a NSL demand, the publisher can flag the extracted metadata and send it via any of the many telemetry feeds to a &#8220;safe innocuous collector site&#8221; that in turn feeds into other sites. Once any point on the telemetry feed has been hacked the bad sites will get the data too.</p>
<p>Some LEAs define &#8220;relevant&#8221; to mean &#8220;all&#8221; and have the ability to store all the data they want, forever and ever and ever.</p>
<p>This is the polite method.  Other countries do not have to go down the polite path.</p>
<p>Recently, Firefox decided to &#8220;update&#8221; their printing panel. The old panel worked fine. Afaik they added no new functionality, just rearranged the layout and updated the UI to have that Box Look that takes up so much space they needed  Spandex-V drop down boxes resulting in about 10 extra clicks to access all the primary print options.</p>
<p>There are more print options than most people ever look at after they set things up.  If the tick box is set way down into the depths of the 2-3-4th layers of Spandex-V options will anyone find it much less use it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F03%2Fmetadata-left-in-security-agency-pdfs.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2021/03/metadata-left-in-security-agency-pdfs.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='62047' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2021/03/fast-random-bit-generation.html" rel="prev">← Fast Random Bit Generation</a>		<a href="https://www.schneier.com/blog/archives/2021/03/friday-squid-blogging-on-squids.html" rel="next">Friday Squid Blogging: On SQUIDS →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
<!--
	generated in 0.240 seconds
	49089 bytes batcached for 300 seconds
-->
