<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/" /><link rel="alternate" hreflang="nl-nl" href="https://news.sophos.com/nl-nl/2015/07/21/a-closer-look-at-the-angler-exploit-kit/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>A closer look at the Angler exploit kit &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; A closer look at the Angler exploit kit Comments Feed" href="https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615321555' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/29134" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/" />
<link rel='shortlink' href='https://news.sophos.com/?p=29134' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2015%2F07%2F21%2Fa-closer-look-at-the-angler-exploit-kit%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2015%2F07%2F21%2Fa-closer-look-at-the-angler-exploit-kit%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><!-- There is no amphtml version available for this URL. -->
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="A closer look at the Angler exploit kit" />
<meta property="og:url" content="https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/" />
<meta property="og:description" content="An in-depth look at one of the more notorious exploit kits used to facilitate drive-by downloads" />
<meta property="article:published_time" content="2015-07-21T10:55:24+00:00" />
<meta property="article:modified_time" content="2019-04-10T17:37:40+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2016/01/ransomeware-exploit-kit.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2016/01/ransomeware-exploit-kit.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="405" />
<meta property="og:image:alt" content="ransomeware exploit kit" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="A closer look at the Angler exploit kit" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2016/01/ransomeware-exploit-kit.jpg?w=640" />
<meta name="twitter:image:alt" content="ransomeware exploit kit" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template post-template-templates post-template-full-width-title-excerpt-image post-template-templatesfull-width-title-excerpt-image-php single single-post postid-29134 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

		<div id="primary" class="content-area">
			<main id="main" class="site-main" role="main">

			
				<article id="post-29134" class="post-29134 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs category-sophoslabs-uncut tag-angler tag-drive-by-downloads tag-exploit-kits region-en-us region-nl-nl">

				<header class="entry-header">

					<h1 class="entry-title">A closer look at the Angler exploit kit</h1>
											<div class="entry-categories">
				<a href="https://news.sophos.com/en-us/category/sophoslabs/">SophosLabs</a>&bull;<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/angler/">Angler</a>&bull;<a href="https://news.sophos.com/en-us/tag/drive-by-downloads/">Drive-by downloads</a>&bull;<a href="https://news.sophos.com/en-us/tag/exploit-kits/">Exploit kits</a>						</div>
					
					<div class="entry-excerpt">
						<p>An in-depth look at one of the more notorious exploit kits used to facilitate drive-by downloads</p>
					</div>

											<div class="entry-meta">
							<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/fraser-howard/" title="Posts by Fraser Howard" class="author url fn" rel="author">Fraser Howard</a></span></span>							<span class="posted-on"><a href="https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/" rel="bookmark">21 July 2015</a></span>						</div><!-- .entry-meta -->
									</header><!-- .entry-header -->

					<div class="entry-featured-image">
		<img width="640" height="405" src="https://news.sophos.com/wp-content/uploads/2016/01/ransomeware-exploit-kit.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="ransomeware exploit kit" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2016/01/ransomeware-exploit-kit.jpg 640w, https://news.sophos.com/wp-content/uploads/2016/01/ransomeware-exploit-kit.jpg?resize=300,190 300w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
									<div class="entry-social">
						
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				17			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=A%20closer%20look%20at%20the%20Angler%20exploit%20kit%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D29134" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=29134&#038;title=A%20closer%20look%20at%20the%20Angler%20exploit%20kit" data-title="A closer look at the Angler exploit kit" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/"
				data-title="A closer look at the Angler exploit kit"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

						</div><!-- .entry-social -->
				
					<div class="entry-content">
						<p>Over the past few years exploit kits have been widely adopted by criminals looking to infect users with malware. They are used in a process known as a <em><a href="http://blogs.sophos.com/2014/03/26/how-malware-works-anatomy-of-a-drive-by-download-web-attack-infographic/">drive-by download</a></em>, which invisibly directs a user&#8217;s browser to a malicious website that hosts an exploit kit.</p>
<p>The exploit kit then proceeds to exploit security holes, known as vulnerabilities, in order to infect the user with malware. The entire process can occur completely invisibly, requiring no user action.</p>
<p>In this research article we will take a closer look at one of the more notorious exploit kits used to facilitate drive-by downloads &#8211; a kit known as <em>Angler exploit kit</em> (Angler hereafter).</p>
<p><strong>1 Introduction</strong></p>
<p>Angler first appeared in late 2013, and since then has significantly grown in popularity in the cyberunderworld. Its aggressive tactics for evading detection by security products have resulted in numerous variations of the various components it uses (HTML, JavaScript, Flash, Silverlight, Java and more). Angler is also extremely prevalent. For example, in May 2015, we uncovered thousands of new web pages booby-trapped with Angler – so-called <em>landing pages</em> – every day.</p>
<p>The weekly volume of Angler related detections since mid-2014 shows a burst of activity in late 2014, followed by a slight lull, and then increased activity from March 2015 onwards:</p>
<figure id="attachment_29156" aria-describedby="caption-attachment-29156" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-29156 size-full" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-1-angler-ek-growth.png" alt="fig-1-angler-ek-growth" width="640" height="260" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-1-angler-ek-growth.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-1-angler-ek-growth.png?resize=300,122 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29156" class="wp-caption-text">Figure 1: Growth of Angler exploit kit measured by weekly detection volume.</figcaption></figure>
<p>Since the demise of the <a href="https://nakedsecurity.sophos.com/2013/10/08/assessing-the-impact-of-the-blackhole-arrests/">Blackhole exploit kit</a> in October 2013, when its alleged operators were arrested, other exploit kits have certainly flourished and shared the marketplace, but Angler has begun to dominate. To show Angler&#8217;s prevalence against other exploit kits, we analyzed a snapshot of activity for three different periods (September 2014, January 2015 and May 2015):</p>
<figure id="attachment_29161" aria-describedby="caption-attachment-29161" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29161" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-2-ek-distribution.png" alt="Figure 2: Distribution of exploit kit activity as measured by detection telemetry based on a week’s worth of data in September 2014, January 2015 and May 2015." width="640" height="541" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-2-ek-distribution.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-2-ek-distribution.png?resize=300,254 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29161" class="wp-caption-text">Figure 2: Distribution of exploit kit activity as measured by detection telemetry based on a week’s worth of data in September 2014, January 2015 and May 2015.</figcaption></figure>
<p><strong>2 Traffic Control</strong></p>
<p>Clearly, the success of any exploit kit lies in its ability to exploit its target computers and successfully install malware. But exploits kits also need a good volume of incoming traffic in order to have a steady stream of potential victims to infect. For most drive-by downloads, this is achieved by hacking into legitimate websites and injecting malicious HTML or JavaScript into their content. The higher the profile and popularity of the victim web site, the greater the volume of traffic that will be fed to the exploit kit.</p>
<p>We have seen a variety of tricks used to send user web traffic to Angler. Many of them involve simple <a href="https://en.wikipedia.org/wiki/HTML_element#Frames" rel="nofollow">IFRAME</a> (inline HTML frame) injection using added HTML or JavaScript, and are not particularly interesting. However, some of the redirection methods used with Angler are a bit more unusual and warrant a mention here.</p>
<p><strong>2.1 HTTP POST redirection</strong></p>
<p>Above, I indicated that typical redirections are invisible to the user. Actually this is not always the case, as illustrated with the first example, taken from May 2014. We saw a huge number of legitimate sites injected with a combination of JavaScript and HTML, as shown below. In contrast to typical injections, this one involved the addition of FORM and DIV elements in addition to some JavaScript:</p>
<figure id="attachment_29160" aria-describedby="caption-attachment-29160" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29160" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-3-injected-javascript.png" alt="Figure 3: Injected JavaScript and HTML (detected as Troj/JSRedir-OA)" width="640" height="530" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-3-injected-javascript.png 685w, https://news.sophos.com/wp-content/uploads/2015/07/fig-3-injected-javascript.png?resize=300,248 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29160" class="wp-caption-text">Figure 3: Injected JavaScript and HTML (detected as Troj/JSRedir-OA)</figcaption></figure>
<p>Upon loading the page, the user is presented with a dialog box, prompting them to click either &#8220;Yes&#8221; or &#8220;Cancel&#8221;. As evident from the injected Javascript, whichever is clicked, the <tt>Go()</tt> function is run, which removes the popup, adds an IFRAME placeholder, and then submits the form:</p>
<figure id="attachment_29159" aria-describedby="caption-attachment-29159" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-29159 size-full" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-4-popup.png" alt="fig-4-popup" width="640" height="215" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-4-popup.png 666w, https://news.sophos.com/wp-content/uploads/2015/07/fig-4-popup.png?resize=300,101 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29159" class="wp-caption-text">Figure 4: Popup displayed when user browses site injected with Troj/JSRedir-OA.</figcaption></figure>
<p>The data sent in the form submission includes three values (encoded), presumably to assist the criminals managing this redirection mechanism:</p>
<ul>
<li>IP address</li>
<li>User-Agent string</li>
<li>URL</li>
</ul>
<p>The response to the form POST is further HTML and Javascript (loaded into the IFRAME placeholder), which redirects the user: .</p>
<figure id="attachment_29158" aria-describedby="caption-attachment-29158" style="width: 625px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29158" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-5-http-post-response.jpg" alt="Figure 5: Response from the HTTP POST containing JavaScript to initiate the redirect." width="625" height="71" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-5-http-post-response.jpg 625w, https://news.sophos.com/wp-content/uploads/2015/07/fig-5-http-post-response.jpg?resize=300,34 300w" sizes="(max-width: 625px) 100vw, 625px" /><figcaption id="caption-attachment-29158" class="wp-caption-text">Figure 5: Response from the HTTP POST containing JavaScript to initiate the redirect.</figcaption></figure>
<p>A few months later we saw a similar technique being used, but this time with a Flash component. The compromised web pages were modified to include HTML that loaded a malicious Flash file from yet another compromised site.</p>
<p>ActionScript within the Flash file would then retrieve the various parameters and issue the HTTP POST request.</p>
<figure id="attachment_29157" aria-describedby="caption-attachment-29157" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29157" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-6-actionscript.png" alt="Figure 6: ActionScript used in Flash version of Troj/JSRedir-OA." width="640" height="233" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-6-actionscript.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-6-actionscript.png?resize=300,109 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29157" class="wp-caption-text">Figure 6: ActionScript used in Flash version of Troj/JSRedir-OA.</figcaption></figure>
<p>The response to the HTTP POST was like before (Figure 5), with HTML and JavaScript sent back to redirect the user. Interestingly, in early 2015 we saw this latter redirection technique also being used to send traffic to the Nuclear exploit kit.</p>
<p><strong>2.2 Domain generation algorithm</strong></p>
<p>Another trick we have seen used in Angler redirects is the use of domain generation algorithms (DGAs). In 2014, many legitimate web pages were injected with JavaScript that added a script element to load content from a remote site with a hostname that was computer based on a hash of the current date. The idea is that the domain name changes every day, but the malicious script does not need to contain a long list of future names. These DGA redirects were seen using both .EU and .PW domain names.</p>
<figure id="attachment_29155" aria-describedby="caption-attachment-29155" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29155" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-7-snippet.png" alt="Figure 7: Snippet of code from injected JavaScript redirect using DGA (Troj/JSRedir-OE)." width="640" height="159" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-7-snippet.png 675w, https://news.sophos.com/wp-content/uploads/2015/07/fig-7-snippet.png?resize=300,75 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29155" class="wp-caption-text">Figure 7: Snippet of code from injected JavaScript redirect using DGA (Troj/JSRedir-OE).</figcaption></figure>
<p>The downside of this type of redirect is that once the algorithm is known, the security community can predict the target hostname on any particular date, and can blocklist it, effectively shutting down the attack.</p>
<p><strong>2.3 HTTP redirects</strong></p>
<p>The final example included in this section illustrates the use of web redirects using the HTTP response code 302, commonly used on legitimate sites to divert visitors elsewhere. This involves straightforward content injection, but with an additional link in the redirect chain. In late April 2015, we noticed that users browsing the <em>eHow</em> web site were being redirected to Angler. Analysis of the traffic revealed the redirection steps illustrated in Figure 8.</p>
<p>JavaScript had been inserted into one of the legitimate libraries on ehowcdn.com to load content from what looked to be an <em>Optimizely</em> server. (Optimizely provides website analytics services, frequently used to assess web advertising effectiveness.) However, note the additional &#8220;s&#8221; at the end of the hostname to give optimizelys.com instead of the legitimate optimizely.com.</p>
<figure id="attachment_29154" aria-describedby="caption-attachment-29154" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29154" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-8-overview-redirect-optimizely.png" alt="Figure 8: Overview of recent redirection masquerading as Optimizely hack. 1: web page on eHow site, 2: script on ehowcdn.com which loads script from optimizelys.com, 3: script adds malicious iframe, 4: 302 bounce to the Angler landing page." width="640" height="440" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-8-overview-redirect-optimizely.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-8-overview-redirect-optimizely.png?resize=300,206 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29154" class="wp-caption-text">Figure 8: Overview of recent redirection masquerading as Optimizely hack.<br />1: web page on eHow site, 2: script on ehowcdn.com which loads script from optimizelys.com, 3: script adds malicious iframe, 4: 302 bounce to the Angler landing page.</figcaption></figure>
<p>Within days of observing this, we received <a href="https://twitter.com/kafeine/status/595708836314484737">other reports</a> of identical redirection (cdn3.optimizelys.com again) being used from other sites &#8211; this time the final target being the Nuclear exploit kit.</p>
<p><strong>3 Exploit Kit</strong></p>
<p><strong>3.1 Landing page</strong></p>
<p>The landing page is the starting point for the exploit kit code. Typically it uses a mixture of HTML and JavaScript content to identify the visitor&#8217;s browser and the plugins installed, so that the exploit kit can choose the attack most likely to result in a drive-by download.</p>
<p>A variety of obfuscation techniques have been used in the Angler landing pages since the first appearance of the kit. Aside from making analysis more awkward, these techniques make it easier for the criminals to dynamically build unique content on each request, in an attempt to evade detection by security products. For the past year or so, Angler has been encoding its main script functionality as data strings stored in the parent HTML. This content is then retrieved and decoded when the landing page is loaded by the browser. This is a common and well established <a href="https://www.sophos.com/en-us/why-sophos/our-people/technical-papers/malware-with-your-mocha.aspx">anti-emulation technique</a> used by numerous malicious threats.</p>
<p>Decoding the outermost obfuscation layer reveals the next trick used by Angler – anti-sandbox checks. It uses the <a href="https://soroush.secproject.com/blog/2013/04/microsoft-xmldom-in-ie-can-divulge-information-of-local-drivenetwork-in-error-messages/">XMLDOM functionality</a> in Internet Explorer to determine information about files present on the local system. It does this in order to detect the presence of various security tools and virtualization products:</p>
<figure id="attachment_29153" aria-describedby="caption-attachment-29153" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29153" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-9-snippet-angler.png" alt="Figure 9: Snippet of code from Angler landing page showing code to check for the presence of various security products and virtualization solutions." width="640" height="319" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-9-snippet-angler.png 660w, https://news.sophos.com/wp-content/uploads/2015/07/fig-9-snippet-angler.png?resize=300,150 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29153" class="wp-caption-text">Figure 9: Snippet of code from Angler landing page showing code to check for the presence of various security tools and virtualization products.</figcaption></figure>
<p>Beneath the anti-sandbox checks is a second obfuscation layer. A function is called to convert several long strings into Unicode (double-byte) data, some of which is actually script content later added to the page. In most cases, this will be more JavaScript, but sometimes (specifically when <a href="https://nakedsecurity.sophos.com/2013/05/14/may-patch-tuesday-critical-for-users-of-internet-explorer-and-web-based-services/">CVE-2013-2551</a> is targeted) there will be VBScript content as well:</p>
<figure id="attachment_29152" aria-describedby="caption-attachment-29152" style="width: 571px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29152" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-10-second-obfuscation-layer.png" alt="Figure 10: Second obfuscation layer, hiding shellcode data and additional script content that is added to the page (in this case CVE-2013-2551 is targeted, so both JS and VBS content is added)." width="571" height="458" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-10-second-obfuscation-layer.png 571w, https://news.sophos.com/wp-content/uploads/2015/07/fig-10-second-obfuscation-layer.png?resize=300,241 300w" sizes="(max-width: 571px) 100vw, 571px" /><figcaption id="caption-attachment-29152" class="wp-caption-text">Figure 10: Second obfuscation layer, hiding shellcode data and additional script content that is added to the page (in this case CVE-2013-2551 is targeted, so both JS and VBS content is added).</figcaption></figure>
<p>The added script content will be specific to the particular vulnerabilities targeted in any version of the landing page. In all cases however, the added scripts will contain code to:</p>
<ul>
<li>Dynamically construct shellcode.</li>
<li>Retrieve data from an array in the Angler landing page (see below).</li>
</ul>
<p>Angler landing pages contain an array of encoded strings, each of which is decoded by a simple substitution cipher provided by a JavaScript function in the decoded page. (Occasionally the encoded strings are stored in a sequence of variables, but an array is more common.) The key used in the cipher is typically the first member of that array (<tt>uhBNwdr[0]</tt> below):</p>
<figure id="attachment_29151" aria-describedby="caption-attachment-29151" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29151" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-11-substitution-cipher.png" alt="Figure 11: Substitution cipher used in Angler landing page." width="640" height="118" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-11-substitution-cipher.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-11-substitution-cipher.png?resize=300,55 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29151" class="wp-caption-text">Figure 11: Substitution cipher used in Angler landing page.</figcaption></figure>
<p>The size and content of this array will vary according to the vulnerabilities targeted in that version of the kit. Examples of the data stored in the array include:</p>
<ul>
<li>The name of the server hosting the exploit kit.</li>
<li>Folder used to locate Silverlight content</li>
<li>Folder used to locate Flash content</li>
<li>Payload URLs.</li>
<li>Flash payload string (encoded shellcode or URL data).</li>
</ul>
<p>This data is retrieved and decoded as necessary. Here, you can see the relevant payload string being incorporated into the dynamically generated shellcode:</p>
<figure id="attachment_29150" aria-describedby="caption-attachment-29150" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29150" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-12-javascript-function.png" alt="Figure 12: JavaScript function to build unicode string later decoded by shellcode upon exploitation of CVE-2014-6332. The function includes the payload URL and payload decryption key." width="640" height="363" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-12-javascript-function.png 644w, https://news.sophos.com/wp-content/uploads/2015/07/fig-12-javascript-function.png?resize=300,170 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29150" class="wp-caption-text">Figure 12: JavaScript function to build unicode string later decoded by shellcode upon exploitation of CVE-2014-6332. The function includes the payload URL and payload decryption key.</figcaption></figure>
<p>The code to load the malicious Flash component is straightforward. Assuming the anti-sandbox checks are passed, three characteristically named (<tt>get*</tt>) functions are used to retrieve and decode strings from the landing page. These are then used to build the HTML object element, which is added to the document:</p>
<figure id="attachment_29149" aria-describedby="caption-attachment-29149" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29149" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-13-angler-landing.png" alt="Figure 13: Angler landing page code that is used to load malicious Flash content." width="640" height="450" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-13-angler-landing.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-13-angler-landing.png?resize=300,211 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29149" class="wp-caption-text">Figure 13: Angler landing page code that is used to load malicious Flash content.</figcaption></figure>
<p><strong>3.2 Flash content</strong></p>
<p>Angler&#8217;s Flash content has varied considerably over the past year. The samples are routinely obfuscated using various techniques, including:</p>
<ul>
<li>ActionScript string obfuscation techniques.</li>
<li>Base64 encoding.</li>
<li>RC4 encryption.</li>
<li>Commercial Flash obfuscation/protection tools (e.g. <em><a href="http://www.doswf.org/">DoSWF</a></em> and <em><a href="http://www.kindi.com/actionscript-obfuscator.php">secureSWF</a></em>).</li>
</ul>
<p>An additional complication is Angler using embedded Flash objects. The initial Flash loaded from the landing page is fairly innocuous, serving merely as a loader to deliver the exploit via an inner Flash. The inner Flash may be carried as a <tt>binaryData</tt> object or encoded as a string within the ActionScript. In either case, the data will be encrypted using RC4. An example from January 2015 looks like this:</p>
<figure id="attachment_29148" aria-describedby="caption-attachment-29148" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29148" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-14-outermost-swf.png" alt="" width="640" height="401" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-14-outermost-swf.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-14-outermost-swf.png?resize=300,188 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29148" class="wp-caption-text">Figure 14: Outermost Flash carries inner Flash encrypted with RC4 and Base64 encoded.</figcaption></figure>
<p>Data is passed from the landing page to Flash via the use of a FlashVars parameter in the landing page HTML &#8211; a common technique in recent exploit kits.</p>
<p>This is easily accessible from ActionScript via the parameters property of the <tt><a href="https://helpx.adobe.com/flash/kb/pass-variables-swfs-flashvars.html">loaderInfo</a></tt> object. This mechanism has been well used in many exploit kits in order to:</p>
<ul>
<li>Pass in payload URL data.</li>
<li>Pass in shellcode.</li>
</ul>
<p>This flexibility enables dynamic customization of shellcode without having to recompile the Flash itself.</p>
<p>Figure 15 shows snippets of the ActionScript used in recent Angler Flash objects to retrieve the encoded data from the landing page (&#8220;exec&#8221; variable). Additionally, you can see the use of control flow obfuscation in some of the functions involved, complicating analysis:</p>
<figure id="attachment_29147" aria-describedby="caption-attachment-29147" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29147" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-15-retrieving-encoded-data.png" alt="Figure 15: Retrieving encoded data from the landing page (“exec” variable) which is then decoded by an ActionScript function. Notice the use of control flow obfuscation to complicate analysis." width="640" height="620" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-15-retrieving-encoded-data.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-15-retrieving-encoded-data.png?resize=300,291 300w, https://news.sophos.com/wp-content/uploads/2015/07/fig-15-retrieving-encoded-data.png?resize=32,32 32w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29147" class="wp-caption-text">Figure 15: Retrieving encoded data from the landing page (&#8220;exec&#8221; variable) which is then decoded by an ActionScript function.</figcaption></figure>
<p>In early 2015, there was a succession of <a href="http://malware.dontneedcoffee.com/2015/01/unpatched-vulnerability-0day-in-flash.html">zero-day vulnerabilities</a> (including CVE-2015-0310, <a href="http://malware.dontneedcoffee.com/2015/01/cve-2015-0311-flash-up-to-1600287.html">CVE-2015-0311</a>, <a href="http://malware.dontneedcoffee.com/2015/02/cve-2015-0313-flash-up-to-1600296-and.html">CVE-2015-0313</a>, CVE-2015-0315, <a href="http://malware.dontneedcoffee.com/2015/03/cve-2015-0336-flash-up-to-1600305-and.html">CVE-2015-0336</a>, <a href="http://malware.dontneedcoffee.com/2015/04/cve-2015-0359-flash-up-to-1700134-and.html">CVE-2015-0359</a>) in Adobe Flash Player, which were quickly targeted by Angler. The targeting of these vulnerabilities by Angler (and other exploit kits) has been well described elsewhere.</p>
<p>This flurry of Flash activity supports the trend away from Java exploitation over the past 18 months, a change that was kickstarted when Oracle blocked the use of unsigned browser applets by default in <a href="http://java.com/en/download/faq/release7_changes.xml">Java 7 update 51</a>.</p>
<p><strong>3.3 Shellcode analysis</strong></p>
<p>As noted above, the shellcode is dynamically generated within the script when the landing page is loaded by the browser. The exact contents of the shellcode will vary according to the vulnerability being targeted, but in all cases the encoding and structure is similar. The analysis below describes the shellcode that is used in exploiting CVE-2014-6332.</p>
<p>On first sight it was evident that the shellcode data (<tt>shellcode_part1</tt>, <tt>shellcode_part2</tt> and <tt>shellcode_part3</tt> in Figures 10 and 12) did not seem to contain valid code. Closer inspection revealed why &#8211; additional code is added to the start of the shellcode from the VBScript component. The JavaScript <tt>build_shellcode()</tt> function in Figure 12 is actually called from the VBScript (Figure 16).</p>
<figure id="attachment_29146" aria-describedby="caption-attachment-29146" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29146" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-16-snippet-vbscript.png" alt="Figure 16: Snippet of the VBScript code used to construct the shellcode used in CVE-2014-6332 exploitation." width="640" height="206" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-16-snippet-vbscript.png 645w, https://news.sophos.com/wp-content/uploads/2015/07/fig-16-snippet-vbscript.png?resize=300,97 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29146" class="wp-caption-text">Figure 16: Snippet of the VBScript code used to construct the shellcode<br />used in CVE-2014-6332 exploitation.</figcaption></figure>
<p>Sure enough, analysis of the additional Unicode data provided from the VBScript (<tt>buildshell1</tt> in Figure 16) confirms it is executable code, and actually contains a small decryption loop to decrypt the bytes contained in remainder of the shellcode, which includes the payload URL and decryption key. This decryption loop reverses the <tt>encData()</tt> function referenced in Figure 12, where the payload URL and payload key were encrypted.</p>
<figure id="attachment_29145" aria-describedby="caption-attachment-29145" style="width: 393px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29145" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-17-snippet-shellcode.png" alt="Figure 17: Snippet of shellcode illustrating the decryption loop provided by the VBScript." width="393" height="139" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-17-snippet-shellcode.png 393w, https://news.sophos.com/wp-content/uploads/2015/07/fig-17-snippet-shellcode.png?resize=300,106 300w" sizes="(max-width: 393px) 100vw, 393px" /><figcaption id="caption-attachment-29145" class="wp-caption-text">Figure 17: Snippet of shellcode illustrating the decryption loop provided by the VBScript.</figcaption></figure>
<p>Inspection of another landing page sample, this time one targeting CVE-2013-2551, shows the same technique, but this time, the decryption loop is added within the JavaScript:</p>
<figure id="attachment_29144" aria-describedby="caption-attachment-29144" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29144" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-18-snippet-javascript.png" alt="Figure 18: Snippet of JavaScript showing the same shellcode decryption loop as in Figure 17." width="640" height="165" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-18-snippet-javascript.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-18-snippet-javascript.png?resize=300,77 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29144" class="wp-caption-text">Figure 18: Snippet of JavaScript showing the same shellcode decryption loop as in Figure 17.</figcaption></figure>
<p>After this loop completes, the main shellcode body is decoded and can be analyzed.</p>
<p>After resolving the base address for kernel32, the shellcode parses the export address table to find the functions it requires (identified by hash). It then uses <tt>LoadLibraryA</tt> API to load winhttp.dll, and parses those exports to find the functions it needs:</p>
<table>
<tbody>
<tr>
<td width="99"><strong>Module</strong></td>
<td width="333"><strong>Functions (imported by hash reference)</strong></td>
</tr>
<tr>
<td width="99">kernel32.dll</td>
<td width="333">CreateThread, WaitForSingleObject, LoadLibraryA, VirtualAlloc, CreateProcessInternalW, GetTempPathW, GetTempFileNameW, WriteFile, CreateFile, CloseHandle</td>
</tr>
<tr>
<td width="99">winhttp.dll</td>
<td width="333">WinHttpOpen, WinHttpConnect, WinHttpOpenRequest, WinHttpSendRequest, WinHttpReceiveResponse, WinHttpQueryDataAvailable, WinHttpReadData, WinHttpCrackUrl, WinHttpQueryHeaders, WinHttpGetIeProxyConfigForCurrentUser, WinHttpGetProxyForUrl, winHttpSetOption, WinHttpCloseHandle</td>
</tr>
</tbody>
</table>
<p>If the exploit works, then the payload is downloaded and decrypted by the shellcode, using the aforementioned key. Angler uses different keys according to the exploitation path (Internet Explorer, Flash, Silverlight &#8211; at least two keys for each are currently known).</p>
<p>After decrypting the payload, the shellcode checks the header to identify if the payload is yet more shellcode (which starts with do-nothing NOP instructions at the start) or a Windows program (which starts with the identifying text string &#8220;MZ&#8221; at the start):</p>
<figure id="attachment_29143" aria-describedby="caption-attachment-29143" style="width: 539px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29143" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-19-logic-shellcode.png" alt="Figure 19: Logic in shellcode to check decrypted payload to confirm if EXE, DLL or second-stage shellcode." width="539" height="463" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-19-logic-shellcode.png 539w, https://news.sophos.com/wp-content/uploads/2015/07/fig-19-logic-shellcode.png?resize=300,258 300w" sizes="(max-width: 539px) 100vw, 539px" /><figcaption id="caption-attachment-29143" class="wp-caption-text">Figure 19: Logic in shellcode to check payload type.</figcaption></figure>
<p>If the decrypted payload is a program, it will be saved and run. If it is a second stage of shellcode, the final executable payload is embedded within the body of the shellcode (sometimes in both 32-bit and 64-bit versions).</p>
<p>When the second-stage shellcode runs, the payload is inserted directly into memory in the process of the exploited application, without first being written to disk. This <a href="http://malware.dontneedcoffee.com/2014/08/angler-ek-now-capable-of-fileless.html">&#8220;no-file&#8221; characteristic</a> is responsible for some of the notoriety that Angler has recently gained. This mechanism has been used to infect users with malware from the Bedep family, which itself provides the ability for an attacker to download yet more malwares.</p>
<p><strong>4 Network Perspective</strong></p>
<p>In this section, we will switch focus from content analysis to a look at Angler activity from a network perspective.</p>
<p><strong>4.1 Fresh registrations</strong></p>
<p>As with most web attacks, Angler makes liberal use of fresh domain registrations.</p>
<p>As is typical for drive-by downloads, we usually see a flurry of registrations that resolve to the same IP number for a short period.</p>
<p>Occasionally, Angler has used <a href="https://nakedsecurity.sophos.com/exploring-the-blackhole-exploit-kit-17/">free dynamic DNS services</a>, a tactic widely used by exploit kits for years.</p>
<p><strong>4.2 Domain shadowing</strong></p>
<p>Angler has made aggressive use of <a href="https://nakedsecurity.sophos.com/2012/11/23/hacked-go-daddy-ransomware/">hacked DNS records</a> as well, a technique used by attackers for several years that is becoming popular once again. The criminals update the DNS records of legitimate domains, adding multiple sub-domains that direct to the malicious exploit kit &#8211; a technique sometimes called <em><a href="http://blogs.cisco.com/security/talos/angler-domain-shadowing">domain shadowing</a></em>.</p>
<p>An example is shown in Figure 20, based on some activity seen in May 2015. In these attacks, a 2-level technique is used, where the DNS records have been updated to include wildcard entries (*.foo.example.com, *.bar.example.com). So in this attack, the records were updates with entries including:</p>
<ul>
<li>*.bro.directorsinstitute.net</li>
<li>*.fer.directorsinstitute.org</li>
</ul>
<p>This enables the attackers to resolve their shadowed domains to the malicious IP, a computer hosted in Russia at the time of writing. As you can see, the specific sub-sub-domains used in the Angler redirects appear to be six-character strings, presumably chosen to let the attackers track and attribute incoming traffic (most likely for statistics and payment).</p>
<figure id="attachment_29180" aria-describedby="caption-attachment-29180" style="width: 536px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-29180 size-full" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-21-domain-shadowing1.png" alt="" width="536" height="357" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-21-domain-shadowing1.png 536w, https://news.sophos.com/wp-content/uploads/2015/07/fig-21-domain-shadowing1.png?resize=300,200 300w" sizes="(max-width: 536px) 100vw, 536px" /><figcaption id="caption-attachment-29180" class="wp-caption-text">Figure 20: Domain shadowing (two-level sub-domains) used by Angler (May 2015).</figcaption></figure>
<p>In other cases, we have seen Angler using single-level DNS hacks:</p>
<figure id="attachment_29140" aria-describedby="caption-attachment-29140" style="width: 504px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29140" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-22-domain-shadowing-single-level.png" alt="Figure 21: Domain shadowing (single-level sub-domains) used by Angler (May 2015)." width="504" height="352" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-22-domain-shadowing-single-level.png 504w, https://news.sophos.com/wp-content/uploads/2015/07/fig-22-domain-shadowing-single-level.png?resize=300,210 300w" sizes="(max-width: 504px) 100vw, 504px" /><figcaption id="caption-attachment-29140" class="wp-caption-text">Figure 21: Domain shadowing (single-level sub-domains) used by Angler (May 2015).</figcaption></figure>
<p>In some cases the string used in the sub-domain appears to have some relevance to the domain name being shadowed. This suggests human involvement, rather than random text generated by a program.</p>
<p>Domain shadowing relies on the criminals being able to modify legitimate DNS records, which is most likely due to stolen credentials. Site owners do not necessarily understand the critical nature of their DNS records, so it is concerning that many of the providers/registrars do not guard the DNS configuration more closely.</p>
<p>Most site owners will rarely need to update the records, so any updates should ideally be protected by more than user credentials. Suggestions to improve this situation include:</p>
<ul>
<li>Implement two-factor authentication.</li>
<li>Send email notifications after DNS changes.</li>
</ul>
<p>Thanks to collaboration with researchers at <em><a href="http://www.nominet.org.uk/">Nominet</a></em>, we have been able to look more closely into the domain shadowing activity used in Angler attacks. The intention was to reveal the timeline of events upon a DNS record being hacked. We focused on the DNS query activity for a number of domains associated with a single compromised user account where attackers were using two-level domain shadowing (as in Figure 20).</p>
<p>Figure 22 illustrates a snapshot of DNS query activity for 26 February 2015. Data for three domains (all within the same compromised user account) is included. Green circles show the overall query volume; purple squares highlight above-average query volumes; and the white circles denote periods of sharply-increased query volume, when the attackers started actively using these domains for Angler traffic.</p>
<figure id="attachment_29139" aria-describedby="caption-attachment-29139" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29139" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-23-timeline.png" alt="" width="640" height="346" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-23-timeline.png 700w, https://news.sophos.com/wp-content/uploads/2015/07/fig-23-timeline.png?resize=300,162 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-29139" class="wp-caption-text">Figure 22: Timeline of DNS query activity on Feb 26th 2015 for three domains.</figcaption></figure>
<p>This data reveals two stages in the attack. First, the criminals tested the hacked DNS records with a modest number of queries at 10am. These queries were for the single-level sub-domain, (foo.domain.co.uk), and were all from the same source.</p>
<p>Once the criminals are happy their newly-stolen domain names are resolving reliably, we see bursts of malicious Angler traffic using the two-level sub-domain. In figure 22 you can visualize the attackers cycling through the different domains, with each one being active only for a short period. This correlates nicely with our detection telemetry, where we see similar bursts of activity per hostname.</p>
<p>This information gives us a better impression of the infrastructure and management used to control user web traffic for the purpose of redirecting it to malicious sites.</p>
<p><strong>4.3 URL structure</strong></p>
<p>The URL structure used for the various components of a drive-by attack can often be useful in identifying malicious activity in amongst user web traffic. Historically, certain exploit kits have used predictable URL structure for different components, making it easier for security providers to detect and block content. Some examples from the Nuclear and Blackhole exploit kits include:</p>
<ul>
<li>Timestamps as filenames.</li>
<li>Hashes used in file and folder names.</li>
<li>Characteristic text in the query part of URLs.</li>
</ul>
<p>Similar weakness were present in early versions of Angler as well, but the kit has evolved significantly since then, taking steps to remove any Achilles heel that might have been easy to spot in the URLs used for its various components.</p>
<p><strong>5 Payloads</strong></p>
<p>The final section of this article aims to provide an overview of the actual malware being installed through Angler. To investigate this, we analyzed payloads for a 4-week period during April 2015.</p>
<p>As you can see, all the payloads collected during this period were delivered by exploits against Internet Explorer (59%) or Flash (41%):</p>
<figure id="attachment_29138" aria-describedby="caption-attachment-29138" style="width: 509px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29138" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-24-exploitation-breakdown.png" alt="" width="509" height="317" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-24-exploitation-breakdown.png 509w, https://news.sophos.com/wp-content/uploads/2015/07/fig-24-exploitation-breakdown.png?resize=300,187 300w" sizes="(max-width: 509px) 100vw, 509px" /><figcaption id="caption-attachment-29138" class="wp-caption-text">Figure 23: Exploits used to deliver Angler payloads during April 2015.</figcaption></figure>
<p>This matches our data for recent Angler landing pages, where we have not seen exploits against Silverlight or Java. However, these results are determined as much by the victims&#8217; computer configurations as by Angler itself, because Angler avoids trying exploits against components that are not installed.</p>
<p>The malware families installed in these drive-by downloads were as follows:</p>
<figure id="attachment_29137" aria-describedby="caption-attachment-29137" style="width: 635px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-29137" src="https://news.sophos.com/wp-content/uploads/2015/07/fig-25-breakdown-malware-families.png" alt="" width="635" height="395" srcset="https://news.sophos.com/wp-content/uploads/2015/07/fig-25-breakdown-malware-families.png 635w, https://news.sophos.com/wp-content/uploads/2015/07/fig-25-breakdown-malware-families.png?resize=300,187 300w" sizes="(max-width: 635px) 100vw, 635px" /><figcaption id="caption-attachment-29137" class="wp-caption-text">Figure 24: Malware families installed by Angler in April 2015.</figcaption></figure>
<p>Clearly there is a ransomware focus here &#8211; the names tagged with asterisks are ransomware families, and account for more than 50% of the malware attacks. The most common ransomware was <a href="https://nakedsecurity.sophos.com/2015/03/16/teslacrypt-ransomware-attacks-gamers-all-your-files-are-belong-to-us/">Teslacrypt</a>.</p>
<p><strong>6 Summary</strong></p>
<p>In this research article we have taken a top-to-bottom look at the Angler exploit kit, highlighting some of the methods used to ramp up traffic to Angler-infected web pages.</p>
<p>Understanding this behavior end-to-end is vital when providing protection. Angler attempts to evade detection at every level. To evade reputation filtering it switches hostnames and IP numbers rapidly, as well as using domain shadowing to piggyback on legitimate domains. To evade content detection, the components involved in Angler are dynamically generated for each potential victim, using a variety of encoding and encryption techniques. Finally, Angler uses obfuscation and anti-sandbox tricks to frustrate the collection and analysis of samples.</p>
<p>As illustrated above, Angler has risen above its competitors in recent months. This could be down to many factors: higher traffic to Angler-infected pages; exploits with a better hit-rate in delivering malware; slicker marketing amongst the criminal fraternity; more attractive pricing &#8211; in other words, good returns for the criminals who are buying &#8220;pay-per-install&#8221; malware services from the team behind Angler.</p>
<p>One thing is clear: Angler has a serious impact on anyone browsing the web today.</p>
<p><strong>7 Acknowledgments</strong></p>
<p>We commend the work done by everyone in the security community to track exploit kit activity. In preparing this article, however, we would like to give individual hat-tips to <a href="https://twitter.com/kafeine">@kafeine</a> and <a href="https://twitter.com/EKwatcher">@EKwatcher</a>.</p>
<p>Thanks also to Richard Cohen and Andrew O’Donnell of SophosLabs for their work on the shellcode components.</p>
<p>Thanks to Ben Taylor, Sion Lloyd and Roy Arends of Nominet for their insights into DNS domain shadowing.</p>
<aside id="sophos_ad-17" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a data-ga-label="Intercept X - DEEP LEARNING FOR DEEPER CYBERSECURITY (Watch Video)" href="https://www.sophos.com/en-us/products/intercept-x.aspx?cmp=26103" class="s-ad-intercept-x__link-wrapper"> <div class="s-ad-intercept-x"> <div class="s-ad-intercept-x__content"> <div class="s-ad-intercept-x__sophos-logo"> <div class="s-ad-intercept-x__sophos-logo-svg"></div></div><div class="s-ad-intercept-x__x-logo"> <div class="s-ad-intercept-x__x-logo-img"></div></div><div class="s-ad-intercept-x__title"> DEEP LEARNING <span class="s-ad-intercept-x__dead">FOR DEEPER CYBERSECURITY</span> </div><div class="s-ad-intercept-x__action"> <span class="s-button s-button--small s-button--orange">Watch Video</span> </div></div></div></a></div>
			</aside>
											</div><!-- .entry-content -->

				</article><!-- #post-## -->

				 			<div class="related-articles">
					
					<div id="second-article-wrapper" class="article-wrapper">
						<h3 class="widget-title">
							You might also enjoy...						</h3>
											</div>
	 			</div>

	 			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/8e69986cae5972e972239f0c176287fc?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/fraser-howard/" title="Posts by Fraser Howard" class="author url fn" rel="author">Fraser Howard</a></h3>

					
					<div class="author-bio">
						<p>Fraser is one of the Principal Threat Researchers in SophosLabs. He has been working for Sophos since 2006. His main interest is in dynamic analysis &amp; protection, and is at his happiest when adding behavioral protections to thwart today's cyber attacks.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>
			
				
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>17</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-2654" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2015-07-21T15:33-04:00" itemprop="datePublished"><a href="#comment-2654" itemprop="url">21 July 2015 at 3:33 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>A very interesting read, as well as a good break down on the many ways of compromise with the particular exploit.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2654#respond' data-commentid="2654" data-postid="29134" data-belowelement="comment-2654" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-2656" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2015-07-21T19:19-04:00" itemprop="datePublished"><a href="#comment-2656" itemprop="url">21 July 2015 at 7:19 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I&#8217;ve had the box &#8220;Stop running this script?&#8221; appear on my Facebook page, and sometimes when i log in to my computer i get a similar flash onto my screen and disappear really quickly. I thought i was imagining it to be honest, but maybe i&#8217;m not. Does this mean i&#8217;ve been hacked, if so what do i do about it?????? I haven&#8217;t seen anything unusual on my Facebook page and none of my friends have either, because they would have told me. I have a MCAfee security program and i scan my computer with your free program, although i don&#8217;t do it as often as i should.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2656#respond' data-commentid="2656" data-postid="29134" data-belowelement="comment-2656" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-fraserhoward bypostauthor even depth-2 parent bystaff" id="comment-2681" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/8e69986cae5972e972239f0c176287fc?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e69986cae5972e972239f0c176287fc?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Fraser Howard											</h2>
					<time class="comment-meta-item" datetime="2015-07-23T03:42-04:00" itemprop="datePublished"><a href="#comment-2681" itemprop="url">23 July 2015 at 3:42 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I suspect the &#8216;Stop running&#8230;&#8217; dialog is appearing because the running JavaScript is hitting a timeout imposed by your browser. (e.g. for Google Chrome, see here: https://support.google.com/chrome/answer/96804?hl=en-GB)</p>
<p>This is a pretty common scenario for many JavaScript-heavy sites nowadays, particularly when browsing on older or less powerful devices.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2681#respond' data-commentid="2681" data-postid="29134" data-belowelement="comment-2681" data-respondelement="respond" data-replyto="Reply to Fraser Howard" aria-label='Reply to Fraser Howard'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment odd alt depth-3 parent " id="comment-2829" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Shri Ganesh											</h2>
					<time class="comment-meta-item" datetime="2015-08-04T05:19-04:00" itemprop="datePublished"><a href="#comment-2829" itemprop="url">04 August 2015 at 5:19 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Seriously? Can&#8217;t you find the difference between a web based window and native window???</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2829#respond' data-commentid="2829" data-postid="29134" data-belowelement="comment-2829" data-respondelement="respond" data-replyto="Reply to Shri Ganesh" aria-label='Reply to Shri Ganesh'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment even depth-4  " id="comment-2911" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2015-08-10T07:43-04:00" itemprop="datePublished"><a href="#comment-2911" itemprop="url">10 August 2015 at 7:43 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Not being an expert on computers i guess i can&#8217;t find the difference between a web based window and a native window, sorry for being so ignorant, but i taught myself how to use a computer and being an older person i have never used a computer before which you may have. Seriously, we can&#8217;t all be as knowledgeable as you seem to be as much as we would like to be.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2911#respond' data-commentid="2911" data-postid="29134" data-belowelement="comment-2911" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a>				</div>
			</div>

	</article></section></article></section></article></section></article>
		<article class="comment odd alt thread-even depth-1  " id="comment-2661" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Mexxy											</h2>
					<time class="comment-meta-item" datetime="2015-07-21T23:34-04:00" itemprop="datePublished"><a href="#comment-2661" itemprop="url">21 July 2015 at 11:34 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great work, super interesting read. Thanks for your work</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2661#respond' data-commentid="2661" data-postid="29134" data-belowelement="comment-2661" data-respondelement="respond" data-replyto="Reply to Mexxy" aria-label='Reply to Mexxy'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-2665" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Snappa											</h2>
					<time class="comment-meta-item" datetime="2015-07-22T02:59-04:00" itemprop="datePublished"><a href="#comment-2665" itemprop="url">22 July 2015 at 2:59 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Very Illuminating</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2665#respond' data-commentid="2665" data-postid="29134" data-belowelement="comment-2665" data-respondelement="respond" data-replyto="Reply to Snappa" aria-label='Reply to Snappa'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-2669" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://testing75476755.wordpress.com" itemprop="author">Gabor</a>
											</h2>
					<time class="comment-meta-item" datetime="2015-07-22T08:26-04:00" itemprop="datePublished"><a href="#comment-2669" itemprop="url">22 July 2015 at 8:26 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>This is a very informative entry. So what we can do to beside removing flash and keeping IE updated? Can anti-exploit tools protect us?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2669#respond' data-commentid="2669" data-postid="29134" data-belowelement="comment-2669" data-respondelement="respond" data-replyto="Reply to Gabor" aria-label='Reply to Gabor'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-fraserhoward bypostauthor even depth-2 parent bystaff" id="comment-2682" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/8e69986cae5972e972239f0c176287fc?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e69986cae5972e972239f0c176287fc?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Fraser Howard											</h2>
					<time class="comment-meta-item" datetime="2015-07-23T03:54-04:00" itemprop="datePublished"><a href="#comment-2682" itemprop="url">23 July 2015 at 3:54 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks Gabor. There are three key things a user can do in order to reduce their risk of infection by Angler. </p>
<p>You have got the first &#8211; reduce the attack surface by removing software the exploit kit targets (Flash, Silverlight etc). If removing is not practical, consider controlling its usage (e.g. Flash click-to-play).</p>
<p>The second is to patch software. As soon as security updates become available, install them. Allow software (programs and OS) to automatically check for and install updates. Granted, this will not help when zero-day vulnerabilities are being used, but even so, it is an important mitigation. Why risk being hit by something for which a patch is already available?</p>
<p>Finally, use decent security software. This should include technologies to filter inbound web content (through combination of content scanning and reputation filtering). It should also provide runtime protection (often termed HIPs) in order to provide protection even when previous protection layers have been breached.</p>
<p>Anti-exploit tools often do provide protection yes, but this can vary according to the vulnerability being exploited. It is not a silver bullet install and forget solution.</p>
<p>Hope this helps.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2682#respond' data-commentid="2682" data-postid="29134" data-belowelement="comment-2682" data-respondelement="respond" data-replyto="Reply to Fraser Howard" aria-label='Reply to Fraser Howard'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment odd alt depth-3  " id="comment-50124" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Mashhoor Gulati											</h2>
					<time class="comment-meta-item" datetime="2018-05-06T01:47-04:00" itemprop="datePublished"><a href="#comment-50124" itemprop="url">06 May 2018 at 1:47 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Least privilege&#8230;I mean no admin rights should be the first I guess.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=50124#respond' data-commentid="50124" data-postid="29134" data-belowelement="comment-50124" data-respondelement="respond" data-replyto="Reply to Mashhoor Gulati" aria-label='Reply to Mashhoor Gulati'>Reply</a>				</div>
			</div>

	</article></section></article></section></article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-2830" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2015-08-04T05:20-04:00" itemprop="datePublished"><a href="#comment-2830" itemprop="url">04 August 2015 at 5:20 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>A very detailed and amazing report !!! Thank you!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2830#respond' data-commentid="2830" data-postid="29134" data-belowelement="comment-2830" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-2995" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://Spambot" itemprop="author">Joe</a>
											</h2>
					<time class="comment-meta-item" datetime="2015-08-18T12:58-04:00" itemprop="datePublished"><a href="#comment-2995" itemprop="url">18 August 2015 at 12:58 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Can we create any fake sandbox or virtualization artifacts on our computers to fool Angler into not running?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=2995#respond' data-commentid="2995" data-postid="29134" data-belowelement="comment-2995" data-respondelement="respond" data-replyto="Reply to Joe" aria-label='Reply to Joe'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-3937" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													lexiconkaleidoscope											</h2>
					<time class="comment-meta-item" datetime="2015-10-16T05:39-04:00" itemprop="datePublished"><a href="#comment-3937" itemprop="url">16 October 2015 at 5:39 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Nice post! The most amazing thing is Angler&#8217;s ability to use Domain Shadowing to redirect traffic back in time to servers in the USSR! (Figure 20) ;P</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=3937#respond' data-commentid="3937" data-postid="29134" data-belowelement="comment-3937" data-respondelement="respond" data-replyto="Reply to lexiconkaleidoscope" aria-label='Reply to lexiconkaleidoscope'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-5230" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Marcus Vinicius											</h2>
					<time class="comment-meta-item" datetime="2015-12-22T11:01-05:00" itemprop="datePublished"><a href="#comment-5230" itemprop="url">22 December 2015 at 11:01 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I&#8217;d been lost in some moment.. When the shellcode pass from javascript engine (interpreter) to OS memory (to find mapped DLL functions and effectively run itself) ? [Sorry for bad english]</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=5230#respond' data-commentid="5230" data-postid="29134" data-belowelement="comment-5230" data-respondelement="respond" data-replyto="Reply to Marcus Vinicius" aria-label='Reply to Marcus Vinicius'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-7748" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Andrew											</h2>
					<time class="comment-meta-item" datetime="2016-04-17T16:38-04:00" itemprop="datePublished"><a href="#comment-7748" itemprop="url">17 April 2016 at 4:38 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Excuse me, but is this capable of infecting via Firefox, or on Macintosh or Linux desktops?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=7748#respond' data-commentid="7748" data-postid="29134" data-belowelement="comment-7748" data-respondelement="respond" data-replyto="Reply to Andrew" aria-label='Reply to Andrew'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-15352" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Jack Li											</h2>
					<time class="comment-meta-item" datetime="2017-04-21T01:38-04:00" itemprop="datePublished"><a href="#comment-15352" itemprop="url">21 April 2017 at 1:38 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Its a very good article..I love it.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=15352#respond' data-commentid="15352" data-postid="29134" data-belowelement="comment-15352" data-respondelement="respond" data-replyto="Reply to Jack Li" aria-label='Reply to Jack Li'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-180552" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Akram khan Achakzai											</h2>
					<time class="comment-meta-item" datetime="2020-04-04T14:01-04:00" itemprop="datePublished"><a href="#comment-180552" itemprop="url">04 April 2020 at 2:01 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>how can I find vulnerabilities of my own PC/ Laptop.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/?replytocom=180552#respond' data-commentid="180552" data-postid="29134" data-belowelement="comment-180552" data-respondelement="respond" data-replyto="Reply to Akram khan Achakzai" aria-label='Reply to Akram khan Achakzai'>Reply</a>				</div>
			</div>

	</article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2015/07/21/a-closer-look-at-the-angler-exploit-kit/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='29134' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="27d9b5b022" /></p><input type="hidden" id="ak_js" name="ak_js" value="37"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

			
			</main><!-- #main -->
		</div><!-- #primary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IQGY2T8ZHMcjqxkaBUHD69mKWJR48jKSX/v2+NqlYAtPeJXBJpBEQSJAPoycHC7HmKM9iolIF8rMB9mx4w2UJ+BrwiQ5i1w7tYwUNrxQV7efXiOdkbL2lFQZlBlctBhWTg1jtDapa+WabZJy2uQda34pYFrAIwb45GvcPKi3gHfrf+XYZMws2D8aRULMhhCRuxRUPH7GwV7zITranRrZtN30AbTfKEQ=='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'29134',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '29134' ]);
</script>
</body>
</html>
