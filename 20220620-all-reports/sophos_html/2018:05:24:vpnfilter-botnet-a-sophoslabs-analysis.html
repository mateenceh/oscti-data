<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>VPNFilter botnet: a SophosLabs analysis &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; VPNFilter botnet: a SophosLabs analysis Comments Feed" href="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615321555' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/47838" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/" />
<link rel='shortlink' href='https://news.sophos.com/?p=47838' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2018%2F05%2F24%2Fvpnfilter-botnet-a-sophoslabs-analysis%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2018%2F05%2F24%2Fvpnfilter-botnet-a-sophoslabs-analysis%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="VPNFilter botnet: a SophosLabs analysis" />
<meta property="og:url" content="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/" />
<meta property="og:description" content="A technical investigation of the malicious components involved in the attack that infected over 500,000 routers and network storage devices." />
<meta property="article:published_time" content="2018-05-24T12:31:12+00:00" />
<meta property="article:modified_time" content="2018-05-29T10:39:24+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="336" />
<meta property="og:image:alt" content="SophosLabs Uncut" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="VPNFilter botnet: a SophosLabs analysis" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" />
<meta name="twitter:image:alt" content="SophosLabs Uncut" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-47838 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-47838" class="post-47838 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-sophoslabs tag-vpnfilter region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">VPNFilter botnet: a SophosLabs analysis</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophoslabs/">SophosLabs</a>&bull;<a href="https://news.sophos.com/en-us/tag/vpnfilter/">VPNFilter</a>		</div>

					<div class="entry-excerpt">
				<p>A technical investigation of the malicious components involved in the attack that infected over 500,000 routers and network storage devices.</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/" rel="bookmark">24 May 2018</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				4			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=VPNFilter%20botnet%3A%20a%20SophosLabs%20analysis%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D47838" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=47838&#038;title=VPNFilter%20botnet:%20a%20SophosLabs%20analysis" data-title="VPNFilter botnet: a SophosLabs analysis" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/"
				data-title="VPNFilter botnet: a SophosLabs analysis"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="336" src="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="SophosLabs Uncut" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png 1200w, https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?resize=300,158 300w, https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?resize=768,403 768w, https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?resize=1024,538 1024w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/shevchenkosergei/" title="Posts by Sergei Shevchenko" class="author url fn" rel="author">Sergei Shevchenko</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>Thanks to the <a href="https://www.cyberthreatalliance.org/" rel="nofollow">Cyber Threat Alliance</a>, SophosLabs researchers were provided early access to malware samples collected by Cisco TALOS team in their research of the <a href="https://blog.talosintelligence.com/2018/05/VPNFilter.html">VPNFilter botnet</a> activity. Besides updating our protection data, we also had a chance to take a closer look at the attack components and the 3 stages of the attack. Here is our findings.</p>
<h2>1st stage implant</h2>
<p>The 1st stage implant <code>0e0094d9bd396a6594da8e21911a3982cd737b445f591581560d766755097d92</code> is compiled as a x86 ELF executable.</p>
<p>This executable was first submitted to VirusTotal on 12 June 2017, from a user in Taiwan. According to VirusTotal, the submitted file has a filename:</p>
<pre>C:\Users\chli\Documents\qsync.php</pre>
<p>Possibly, the file was fetched from a remotely hosted script called <code>qsync.php</code>, using a Windows system. However, it&#8217;s not clear how this sample was used to compromise the devices.</p>
<p>When run, the implant schedules itself to be executed periodically, by modifying crontab (cron table) file.</p>
<p>The <a href="https://www.ibm.com/support/knowledgecenter/SSEPGG_9.5.0/com.ibm.db2.luw.sql.rtn.doc/doc/c0054381.html" rel="nofollow">cron format</a> has five time and date fields: minute, hour, day of month, month, and day of week.<br />
If a value is specified as <code>*/step</code>, execution takes place at every interval of step through the unrestricted range.</p>
<p>By appending the schedule argument <code>*/5 * * * *</code> to the crontab, the implant is scheduled to be activated every 5 minutes:</p>
<pre>fd = open_file("/etc/config/crontab", "a");
_fd = fd;
if (fd)
{
    format_sys_write(fd, "*/5 * * * * %s\n", (int)&amp;fname);
    fd = close(_fd);
}</pre>
<p>The implant keeps its critical strings encrypted. For that, it relies on a modified RC4 algorithm. In a normal RC4 implementation, the RC4 initialisation routine calculates an index into the state table, using the key. Next, 2 bytes in the state table are swapped in place, where the first byte is pointed by the incremented index <code>i</code>, and the second one &#8211; by the newly calculated index <code>index2</code>, as shown below:</p>
<pre>#define swap_byte(a, b) {swapByte = a; a = b; b = swapByte;}

for (i = 0; i &lt; 256; i++)state[i] = i;
key_index = 0;
index2 = 0;
for (i = 0; i &lt; 256; i++)
{
    index2 = (key[key_index] + state[i] + index2) &amp; 0xFF;
    swap_byte(state[i], state[index2]);
    if (++key_index == key_size)key_index = 0;
}</pre>
<p>The implant however, initialises the state table differently. Instead of permutating the state table by swapping the bytes in it, it simply applies XOR to the state table, using the same RC4 key.</p>
<p>Apparently, this flavour of RC4 initialisation is known to be used by <a href="https://www.secureworks.com/research/blackenergy2" rel="nofollow">BlackEnergy</a>.</p>
<pre>for (i = 0; i &lt; 256; i++)state[i] = i;
key_index = 0;
for (i = 0; i &lt; 256; i++)
{
    state[i] ^= key[key_index];
    if(++key_index == key_size)key_index = 0;
}</pre>
<p>The RC4 key is a 4-character string hard-coded as <code>%^:d</code>. The rest of the RC4 implementation is identical to the standard algorithm.</p>
<p>In total, the body of the implant contains 12 encrypted strings. Each encrypted string is stored as a string length that takes 1 byte, followed with the encrypted string itself.</p>
<p>Once decrypted these strings become:</p>
<ul>
<li><code>/var/run/client.crt</code></li>
<li><code>/var/run/client.key</code></li>
<li><code>/var/run/client_ca.crt</code></li>
<li><code>0.3.9qa</code></li>
<li><code>/var/run/msvf.pid</code></li>
<li><code>http[://]toknowall.com/manage/content/update.php</code></li>
<li><code>/var/vpnfilter</code></li>
<li><code>/update/test</code></li>
<li><code>http[://]photobucket.com/user/nikkireed11/library</code></li>
<li><code>http[://]photobucket.com/user/kmila302/library</code></li>
<li><code>http[://]photobucket.com/user/lisabraun87/library</code></li>
<li><code>http[://]photobucket.com/user/katyperry45/library</code></li>
</ul>
<p>The first 3 strings are the filenames where the implant saves 3 client certificates, hard-coded within its own body. These client-side SSL certificates are used for authenticated requests to the C2 server, over HTTPS (port 443).</p>
<p>The version number <code>0.3.9qa</code> is saved into the file <code>/var/run/msvf.pid</code>.</p>
<p>The <code>/var/vpnfilter</code> is used as a temporary filename for the downloaded files.</p>
<p>The implant relies either on hard-coded Photobucket URLs or Toknowall C2 website to fetch the images. The images are used to extract a 2nd stage server IP from the images&#8217; EXIF metadata.</p>
<p>Next, a payload module is fetched from the 2nd stage server, using a URL path <code>/update/test</code>. The downloaded module is saved as <code>/var/vpnfilter</code>, assigned execution permission with the <code>chmod(511)</code> command, then executed with the <code>sys_execve()</code> system call.</p>
<h2>2nd stage payload: a backdoor trojan</h2>
<p>The 2nd stage payload fetched by the implant <code>8a20dc9538d639623878a3d3d18d88da8b635ea52e5e2d0c2cce4a8c5a703db1</code> is a backdoor trojan compiled as x86 ELF executable.</p>
<p>Just like the 1st stage implant, its critical strings are encrypted using the same method. The RC4 key is different this time: <code>g&amp;*kdj$dg0_@@7'x</code>.</p>
<p>The decrypted strings expose backdoor commands, IP addresses of C2, and some other configuration parameters.</p>
<p>For example, the backdoor is able to accept and execute the following remote commands:</p>
<ul>
<li><code>download</code> &#8211; download remote file, save it as <code>/var/tmp/vpn.tmp</code></li>
<li><code>reboot</code> &#8211; terminate current process with <code>sys_exit()</code> system call</li>
<li><code>restart</code> &#8211; reboot the device with <code>sys_reboot()</code> system call;</li>
<li><code>delay</code> &#8211; appears to invoke delayed reboot</li>
<li><code>copy</code> &#8211; read local file contents</li>
<li><code>exec</code> &#8211; execute command or another plugin, using <code>sys_execve()</code> system call with the following shells:
<ul>
<li><code>/bin/sh</code></li>
<li><code>/bin/ash</code></li>
<li><code>/bin/bash</code></li>
<li><code>/bin/shell</code></li>
</ul>
</li>
<li><code>kill</code> &#8211; terminate process(es) with the <code>sys_kill()</code> system call, delete own files and directories, such as:
<ul>
<li><code>/var/run/tord</code></li>
<li><code>/var/run/</code></li>
<li><code>/var/run/vpn.pid</code></li>
<li><code>/var/tmp/vpn.tmp</code></li>
<li><code>etc.</code></li>
</ul>
</li>
<li><code>pxs</code> &#8211; set C2 proxy, i.e. the module contains 2 hard-coded proxies in it:
<ul>
<li><code>217.12.202.40</code></li>
<li><code>91.121.109.209</code></li>
</ul>
</li>
<li><code>port</code> &#8211; set proxy port</li>
<li><code>tr, mds, tor, me</code> &#8211; set other configuration parameters</li>
</ul>
<p>In its communications, the backdoor relies on a user agent string randomly selected from a list of 9 strings:</p>
<pre>user_agent = user_agents[PRNG() % 9];</pre>
<p>where <code>user_agents</code> table consists of:</p>
<ul>
<li><code>Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0</code></li>
<li><code>Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0</code></li>
<li><code>curl/7.47.0</code></li>
<li><code>Wget/1.17.1 (linux-gnu)</code></li>
<li><code>git/2.7.4</code></li>
<li><code>Google Chrome/64.0.3282.140 Windows</code></li>
<li><code>Google Chrome/64.0.3282.140 Linux</code></li>
<li><code>Lynx/2.8.8pre.4 libwww-FM/2.14</code></li>
<li><code>python-requests/2.18.4</code></li>
</ul>
<p>Just like the implant, the backdoor communicates with its proxies via a SSL connection, relying on client-side SSL certificates.</p>
<p>The module tries to determine the presence of TOR by parsing socket info from <code>/proc/net/tcp</code>. For each enumerated socket descriptor, it then tries to find a file descriptor (<a href="https://stackoverflow.com/questions/3319521/how-can-i-match-each-proc-net-tcp-entry-to-each-opened-socket" rel="nofollow">by using a method described here</a>) to a socket that has open connection on port 9050, that is used by TOR.</p>
<p>With the TOR module installed as a 3rd stage plugin, the communication will take place via the following .onion domains:</p>
<ul>
<li><code>6b57dcnonk2edf5a.onion/bin32/update.php</code></li>
<li><code>tljmmy4vmkqbdof4.onion/bin32/update.php</code></li>
</ul>
<p>Backdoor modules built for different platforms are almost identical in their functionality. The strings are encrypted using the same key.</p>
<p>A subtle difference exists in the internal platform ID parameters. For example, x86 module uses IDs:</p>
<ul>
<li><code>pDJOSERi686QNAPX86</code> or <code>pPRXi686QNAPX86</code></li>
<li><code>i686</code></li>
</ul>
<p>Backdoor module built for ARM CPU may have these parameters set to:</p>
<ul>
<li><code>pDJOSERarmv5lQNAP_ARM</code></li>
<li><code>armv5l</code></li>
</ul>
<p>Backdoor compiled for MIPS:</p>
<ul>
<li><code>pDJOSERmipsDGN2200V4</code></li>
<li><code>mips</code></li>
</ul>
<h2>3rd stage plugin</h2>
<p>A 3rd stage plugin <code>afd281639e26a717aead65b1886f98d6d6c258736016023b4e59de30b7348719</code> is a <a href="https://people.torproject.org/~nickm/tor-auto/doxygen/microdesc_8c_source.html" rel="nofollow">TOR client</a>. Compiled as x86 ELF executable, it shares the same code as known open-source TOR client <a href="https://github.com/kaist-ina/SGX-Tor/" rel="nofollow">implementations</a>.</p>
<p>Another 3rd stage plugin is built for MIPS architecture <code>f8286e29faa67ec765ae0244862f6b7914fcdde10423f96595cb84ad5cc6b344</code>. The plugin represents itself a sniffer that looks for several interesting traffic patterns, such as:</p>
<ul>
<li><code>/tmUnblock.cgi</code> &#8211; a vulnerable CGI script in some Cisco/Linksys router firmware; this executable is linked to several exploits and malicious executables, such as <a href="https://isc.sans.edu/forums/diary/Whatever+Happened+to+tmUnblockcgi+Moon+Worm/19999/" rel="nofollow">Moon Worm</a>, a malicious Bitcoin miner that has infected Linksys routers in the past</li>
<li><code>*modbus*\n%s:%uh-&gt;%s:%hu</code> &#8211; a packet used in Modbus, a standard communication protocol, commonly used for connecting industrial electronic devices, such as PLC</li>
<li><code>Basic Og==</code> &#8211; part of HTTP authentication packet, that <a href="https://chromium.googlesource.com/chromium/src/net/+/master/http/http_auth_handler_basic_unittest.cc" rel="nofollow">means</a> &#8220;Empty username and empty password&#8221;</li>
</ul>
<p>Other patterns related to HTTP authentication packets:</p>
<ul>
<li><code>Password required</code></li>
<li><code>Authorization: Basic</code></li>
<li><code>User=</code></li>
<li><code>user=</code></li>
<li><code>Name=</code></li>
<li><code>name=</code></li>
<li><code>Usr=</code></li>
<li><code>usr=</code></li>
<li><code>Login=</code></li>
<li><code>login=</code></li>
<li><code>Pass=</code></li>
<li><code>pass=</code></li>
<li><code>Password=</code></li>
<li><code>password=</code></li>
<li><code>Passwd=</code></li>
<li><code>passwd=</code></li>
</ul>
<p>The intercepted data is stacked into the files, formatted as:</p>
<pre>%DIR%/rep_%NUMBER%.bin</pre>
<p>where <code>%DIR%</code> is a working directory, such as <code>/var/run/vpnfilterw</code>.</p>
<h2>Conclusion</h2>
<p>VPNFilter malware is another clear demonstration of rather philosophical paradigm: the more IoT devices we have helping us out in our daily lives, the more advanced the CPUs become, driving our routers, cars, or refrigerators (you name it), the bigger an attack surface becomes.</p>
<p>The type of CPU during the grunt work within all those devices, whether it’s ARM or MIPS or Intel x86, don’t matter much, as long as they are powerful enough, and they are becoming more powerful each day. That’s the whole gist of the evolution, and this process won’t stop.</p>
<p>VPNFilter also demonstrates how the cybercriminals achieve a high degree of portability by building their code so that it targets different architectures.</p>
<p>What’s still interesting in this case however, is the very possibility for an organization or a home to become compromised by allowing a backdoor access via one of the least suspicious devices in its possession: a little black box quietly sitting on a shelf, blinking with its friendly green eyes.</p>
<p>VPNFilter isn’t the first zombie malware to target everyday devices on everyone’s network, and it won’t be the last.</p>
<p>For more information read <a href="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/">part 2</a> of our VPNFilter botnet analysis.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2018/05/21/crn-honors-leadership-and-vision-of-sophos-women/" rel="prev">CRN honors leadership and vision of Sophos women</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2018/05/25/gdpr-is-here-how-sophos-protects-your-data/" rel="next">GDPR is here – how Sophos protects your data</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/41304abfe857c08aed7293c24a6c93fb?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/shevchenkosergei/" title="Posts by Sergei Shevchenko" class="author url fn" rel="author">Sergei Shevchenko</a></h3>

					
					<div class="author-bio">
											</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>4</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1 parent " id="comment-51243" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Victor Pereira											</h2>
					<time class="comment-meta-item" datetime="2018-05-24T12:40-04:00" itemprop="datePublished"><a href="#comment-51243" itemprop="url">24 May 2018 at 12:40 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Interesting and does it search on its own? What does it search for? </p>
<p>Having so many infected routers it&#8217;s for DDoS or to make it look like it and target someone secretly?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/?replytocom=51243#respond' data-commentid="51243" data-postid="47838" data-belowelement="comment-51243" data-respondelement="respond" data-replyto="Reply to Victor Pereira" aria-label='Reply to Victor Pereira'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment odd alt depth-2  " id="comment-51331" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2018-05-25T17:58-04:00" itemprop="datePublished"><a href="#comment-51331" itemprop="url">25 May 2018 at 5:58 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>no</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/?replytocom=51331#respond' data-commentid="51331" data-postid="47838" data-belowelement="comment-51331" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment byuser comment-author-shevchenkosergei bypostauthor even depth-2  " id="comment-51565" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/41304abfe857c08aed7293c24a6c93fb?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/41304abfe857c08aed7293c24a6c93fb?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Sergei Shevchenko											</h2>
					<time class="comment-meta-item" datetime="2018-05-28T16:51-04:00" itemprop="datePublished"><a href="#comment-51565" itemprop="url">28 May 2018 at 4:51 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thank you &#8211; we have addressed your questions in the second part of our research. Please check it out.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/?replytocom=51565#respond' data-commentid="51565" data-postid="47838" data-belowelement="comment-51565" data-respondelement="respond" data-replyto="Reply to Sergei Shevchenko" aria-label='Reply to Sergei Shevchenko'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-51370" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Heino Fecht											</h2>
					<time class="comment-meta-item" datetime="2018-05-26T12:23-04:00" itemprop="datePublished"><a href="#comment-51370" itemprop="url">26 May 2018 at 12:23 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Very detailed written. Thanks</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/?replytocom=51370#respond' data-commentid="51370" data-postid="47838" data-belowelement="comment-51370" data-respondelement="respond" data-replyto="Reply to Heino Fecht" aria-label='Reply to Heino Fecht'>Reply</a>				</div>
			</div>

	</article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='47838' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="314e4311eb" /></p><input type="hidden" id="ak_js" name="ak_js" value="219"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-47901" class="second-featured post-47901 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate category-sophoslabs category-sophoslabs-uncut tag-sophoslabs tag-sophoslabs-uncut region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">27</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a> &bull; <a href="https://news.sophos.com/en-us/category/sophoslabs/">SophosLabs</a> &bull; <a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/" rel="bookmark">VPNFilter botnet: a SophosLabs analysis, part 2</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IQGY2T8ZHMcjqxkaBUHD69mKWJR48jKSX/v2+NqlYAtPeJXBJpBEQSJAPoycHC7HmKM9iolIF8rMB9mx4w2UJ+BrwiQ5i1w7tYwUNrxQV7efXiOdkbL2lFQZlBlctBhWTg1jtDapa+WabZJy2uQda34pYFrAIwb45GvcPKi3gHfrf+XYZMws2D8aRULMhhCRuxRUPH7GwV7zITranRrZtN30AbTfKEQ=='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'47838',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '47838' ]);
</script>
</body>
</html>
