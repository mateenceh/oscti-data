<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>VPNFilter botnet: a SophosLabs analysis, part 2 &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; VPNFilter botnet: a SophosLabs analysis, part 2 Comments Feed" href="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1616171106' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqUUWAK9KIh0='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/47901" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/" />
<link rel='shortlink' href='https://news.sophos.com/?p=47901' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2018%2F05%2F27%2Fvpnfilter-botnet-a-sophoslabs-analysis-part-2%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2018%2F05%2F27%2Fvpnfilter-botnet-a-sophoslabs-analysis-part-2%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="VPNFilter botnet: a SophosLabs analysis, part 2" />
<meta property="og:url" content="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/" />
<meta property="og:description" content="The second part of our technical investigation of the malicious components involved in the attack that infected over 500,000 routers and network storage devices." />
<meta property="article:published_time" content="2018-05-27T20:42:17+00:00" />
<meta property="article:modified_time" content="2018-07-29T23:42:07+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="336" />
<meta property="og:image:alt" content="SophosLabs Uncut" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="VPNFilter botnet: a SophosLabs analysis, part 2" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" />
<meta name="twitter:image:alt" content="SophosLabs Uncut" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-47901 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-47901" class="post-47901 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate category-sophoslabs category-sophoslabs-uncut tag-sophoslabs tag-sophoslabs-uncut region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">VPNFilter botnet: a SophosLabs analysis, part 2</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophoslabs/">SophosLabs</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophoslabs-uncut/">SophosLabs Uncut</a>		</div>

					<div class="entry-excerpt">
				<p>The second part of our technical investigation of the malicious components involved in the attack that infected over 500,000 routers and network storage devices.</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/" rel="bookmark">27 May 2018</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				1			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=VPNFilter%20botnet%3A%20a%20SophosLabs%20analysis%2C%20part%202%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D47901" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=47901&#038;title=VPNFilter%20botnet:%20a%20SophosLabs%20analysis,%20part%202" data-title="VPNFilter botnet: a SophosLabs analysis, part 2" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/"
				data-title="VPNFilter botnet: a SophosLabs analysis, part 2"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="336" src="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="SophosLabs Uncut" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png 1200w, https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?resize=300,158 300w, https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?resize=768,403 768w, https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?resize=1024,538 1024w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/sergei-shevchenko/" title="Posts by Sergei Shevchenko" class="author url fn" rel="author">Sergei Shevchenko</a></span><span class="author vcard"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>As mentioned in our previous report about <a href="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/">VPNFilter malware</a>, the 1st stage implant relies on connecting either to one of twelve hardcoded Photobucket URLs, or the Toknowall website, to fetch an image that had been specially crafted to contain an encoded form of the command-and-control server’s IP address. The stage 1 sample extracts the address from the image’s EXIF metadata.</p>
<p>Using samples provided by the <a href="https://www.cyberthreatalliance.org/" rel="nofollow">Cyber Threat Alliance</a>, we infected a router that has network-attached storage features with the VPNFilter malware, and observed its behavior and network traffic over several days. The device we infected was not on the list of affected devices published by Cisco Systems in their report, but behaved in ways that Cisco’s original report accurately described.</p>
<p>When performing this and subsequent HTTP requests, the malware used one of a variety of hardcoded User-Agent strings that do not accurately reflect the operating system or application origin of the request (which is coming from the network device itself), and potentially may be misleading to investigators.</p>
<p>It then begins querying Photobucket and/or Toknowall for the image files. During our observations, the infected router attempted to perform an HTTP HEAD request to different Photobucket galleries at random intervals. We also observed one of the provided samples only query <code>ipify.org</code> and then delete itself from the device.</p>
<p>Curiously, it seemed like the samples we ran have a propensity to query certain URLs on Photobucket more frequently than others. Most of the Photobucket galleries used by the malware authors were named after famous female entertainers, such as Jennifer Aniston, Monica Bellucci, Amanda Seyfried, or Eva Green, though in some cases the names were slightly misspelled. After 48 hours of continuous operation, nearly 15% of the more than 440 queries made by the samples we ran attempted to connect to the <code>eva_green1</code> Photobucket gallery; queries to the rest of the galleries were distributed more evenly. Admittedly, this may just be a consequence of the specific samples that ran in the environment we used for testing, the nature of the pseudo-random algorithm, or maybe our malware author just really has a thing for this French actress who portrayed the Vanessa Ives character in the series <em>Penny Dreadful</em>.</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47902" src="https://news.sophos.com/wp-content/uploads/2018/05/wireshark-urls-requested.png" alt="" width="640" height="446" srcset="https://news.sophos.com/wp-content/uploads/2018/05/wireshark-urls-requested.png 684w, https://news.sophos.com/wp-content/uploads/2018/05/wireshark-urls-requested.png?resize=300,209 300w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>The malware code indicated that it should query for its command-and-control server address every 10 to 19 seconds, but we observed that it performed a HTTP HEAD request against various pages on Photobucket at a much slower rate, with a random delay of 2 to 20 minutes between the attempts. If the Photobucket URLs fail, it tries to reach Toknowall C2 website, as shown below:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47906" src="https://news.sophos.com/wp-content/uploads/2018/05/image2.png" alt="" width="640" height="356" srcset="https://news.sophos.com/wp-content/uploads/2018/05/image2.png 640w, https://news.sophos.com/wp-content/uploads/2018/05/image2.png?resize=300,167 300w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><em>(NOTE: the domain request above was redirected to the live C2 IP 188.165.218.31.)</em></p>
<p>The returned JPEG contains 6 numbers as GPS coordinates within its EXIF header. The example above highlights these numbers: 0x67, 0x18, 0xFFFFFF4b, 0x0E, 0x08, and 0xFFFFFF66. The implant takes them as decimal numbers and groups into 2 strings:</p>
<ul>
<li><code>latitude: “103 24 -181”</code></li>
<li><code>longitude: “14 8 -154”</code></li>
</ul>
<p>These strings are then scanned into integer values and used to calculate full IP address:</p>
<pre>sscanf(latitude, "%d %d %d", &amp;delta1, &amp;oct1, &amp;oct2);
sscanf(longitude, "%d %d %d", &amp;delta2, &amp;oct3, &amp;num);
oct4 = num + delta2 + 180;
delta1 += 90;
delta2 += 180;
sprintf(IP, "%u.%u.%u.%u", oct1 + delta1, oct2 + delta1, oct3 + delta2, oct4);</pre>
<p>The numbers above will convert into <code>217.12.202.40</code>. As shown in the traffic snapshot above, this IP is then immediately probed on port 443.</p>
<p>During the investigation, we have collected a number of images from live Photobucket URLs and Toknowall C2 website. All of these messages contain a hidden IP address in them, such as <code>91.200.13.76</code>, <code>91.121.109.209</code>, <code>94.242.222.68</code>, and the aforementioned <code>217.12.202.40</code>:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47907" src="https://news.sophos.com/wp-content/uploads/2018/05/image3.png" alt="" width="640" height="366" srcset="https://news.sophos.com/wp-content/uploads/2018/05/image3.png 640w, https://news.sophos.com/wp-content/uploads/2018/05/image3.png?resize=300,172 300w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>If the malware is unable to contact either the Photobucket URLs or the Toknowall C2 website (all of which are offline as we write this), the implant resorts to a backup method, explained below.</p>
<h2>Listening socket</h2>
<p>VPNFilter calls all socket functions by using <code></code> <a href="https://www.cs.cmu.edu/afs/cs.cmu.edu/academic/class/15213-f03/www/ftrace/syscallent.h" rel="nofollow">system call</a>, which is invoked using int <code>0x80</code> interrupt:</p>
<pre>sys_socketcall  proc  near
                ...
                mov   eax, 102 ; "socketcall"
                int   80h</pre>
<p>The <code>sys_socketcall()</code> accepts a parameter that specifies what socket function needs to be called. For example, to <a href="https://github.com/torvalds/linux/blob/master/include/uapi/linux/net.h" rel="nofollow">receive data</a> , <code>sys_socketcall()</code> is passed <code>SYS_RECVFROM (12)</code>. To create a <a href="https://elixir.bootlin.com/linux/v4.3/source/net/socket.c#L2345" rel="nofollow">socket</a> , <code>sys_socketcall()</code> is called with an argument of <code>SYS_SOCKET (1)</code>:</p>
<pre>sys_socket      proc  near
                ... 
                push  1 ; SYS_SOCKET
                call  sys_socketcall</pre>
<p>VPNFilter first creates a packet socket listener that can sniff all Ethernet frames, which include all kinds of IP packets:</p>
<pre>sock_raw = sys_socket(PF_PACKET, SOCK_RAW, htons(ETH_P_ALL));</pre>
<p>where:</p>
<ul>
<li><code>PF_PACKET</code> and <code>SOCK_RAW</code> specify a &#8220;packet&#8221; socket type &#8211; a very <a href="https://yusufonlinux.blogspot.com/2010/11/data-link-access-and-zero-copy.html" rel="nofollow">powerful feature</a> in Linux that bypasses the kernel network stack</li>
<li>the Ethernet frame type to accept is set to <code>ETH_P_ALL</code>, meaning that all protocol packets will be received</li>
</ul>
<p>This means that VPNFilter can act like the <a href="https://www.wireshark.org/" rel="nofollow">WireShark</a> network packet recording software &#8211; a global network tap for any traffic that flows through a compromised device.</p>
<p>The bot obtains the external IP from:</p>
<pre>http://api.ipify.org?format=json</pre>
<p><img loading="lazy" class="aligncenter size-full wp-image-47908" src="https://news.sophos.com/wp-content/uploads/2018/05/image4.png" alt="" width="447" height="350" srcset="https://news.sophos.com/wp-content/uploads/2018/05/image4.png 447w, https://news.sophos.com/wp-content/uploads/2018/05/image4.png?resize=300,235 300w" sizes="(max-width: 447px) 100vw, 447px" /></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47909" src="https://news.sophos.com/wp-content/uploads/2018/05/image5.png" alt="" width="640" height="269" srcset="https://news.sophos.com/wp-content/uploads/2018/05/image5.png 860w, https://news.sophos.com/wp-content/uploads/2018/05/image5.png?resize=300,126 300w, https://news.sophos.com/wp-content/uploads/2018/05/image5.png?resize=768,323 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>In this screenshot, the VPNFilter malware (labeled “sample_06”) is seen running in the process list of an infected router, while, at the same time, a network socket is opened to <code>api.ipify.com (50.19.229.252)</code>.</p>
<p>After this, it sets a future time, defined as a random period from 5 to 10 hours from the current time:</p>
<pre>random = PRNG();
future_time = sys_time(0) + random % 18000 + 18000;</pre>
<p>Once the time defined above comes, the malware will receive data on a listening socket into a 1,500-byte long buffer:</p>
<pre>num = sys_recvfrom(sock_raw, buf_1500, 1500, 0, 0, 0);</pre>
<p>The received data is scanned to make sure it contains the same IP address that it retrieved using the <code>api.ipify.org</code> website. Next it checks to make sure this data contains the marker <code>0x2B22150C</code>, as described in the <a href="https://blog.talosintelligence.com/2018/05/VPNFilter.html" rel="nofollow">original report</a> from Cisco.</p>
<p>Once the sanity checks are done, the malware retrieves the 2nd stage C2 IP.</p>
<p>If the 2nd stage payload is successfully retrieved, the malware closes the listening socket, and the implant executes the payload. Otherwise, it will stay in the listening state, thus blocking the code flow until new data arrives.</p>
<h2>Certificate Authority Root certificates</h2>
<p>We also observed that some of the malware samples contained at least two embedded Certificate Authority Root certificates. The certificates, with unusually long 10-year validity periods, were not legitimately issued by a certificate authority and are, appropriately, labeled as untrusted when viewed in an operating system.</p>
<p>The fake CA root certificate embedded in the samples falsely claims that it was issued by Microsoft:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47968" src="https://news.sophos.com/wp-content/uploads/2018/05/certificates.jpg" alt="" width="630" height="391" srcset="https://news.sophos.com/wp-content/uploads/2018/05/certificates.jpg 630w, https://news.sophos.com/wp-content/uploads/2018/05/certificates.jpg?resize=300,186 300w" sizes="(max-width: 630px) 100vw, 630px" /></p>
<p>So why embed CA root certificates?</p>
<p>The most likely reason is that the malware could, in theory, use these certificates to perform man-in-the-middle decryption of SSL or TLS traffic flowing through the infected device. When you consider that the malware has capabilities of recording all network traffic, it seems reasonable to presume that the malware operators would want to MITM sensitive traffic and not just plain HTTP.</p>
<h2>Potentially destructive payload</h2>
<p>The original Cisco report, echoed in a public <a href="https://www.ic3.gov/media/2018/180525.aspx" rel="nofollow">FBI notification</a> about the malware, mentions a potentially destructive payload that is able to “brick” infected devices, effectively rendering small office and home office routers inoperable. But in our analysis, we came to a different conclusion.</p>
<p>We believe that the “kill” command found in the samples we analysed is designed not to kill the router, but to uninstall the malware itself (though it is possible that the previously-described router bricking functionality may have been present in some earlier samples of VPNFilter).</p>
<p>That said, the samples of VPNFilter we analysed do contain a different functionality (not related to the “kill” command) that manipulates MTD (Memory Technology Devices) <a href="https://opensourceforu.com/2012/01/working-with-mtd-devices/" rel="nofollow">devices</a>, which are special NAND- or NOR-based flash memory chips used to store non-volatile data, such as boot images. This functionality, however, does not appear to be used.</p>
<p>Given it is present in the malware sample, it is still important to understand what exactly the attackers were planning to do with this function.</p>
<p>The code of this function obtains the list of MTD, by reading <code>/proc/mtd</code> file. The output will list the MTD partitions, which act as independent devices, such as:</p>
<pre>cat /proc/mtd 
    dev:    size   erasesize  name
    mtd0: 00030000 00010000 "u-boot"
    mtd1: 00010000 00010000 "factory"
    mtd2: 01fb0000 00010000 "firmware"
    mtd3: 0011115b 00010000 "kernel"
    mtd4: 01e9eea5 00010000 "rootfs"</pre>
<p>Next, the malware parses the list, looking for those partitions that have a name with one of the following strings in it:</p>
<ul>
<li><code>"linux"</code></li>
<li><code>"kernel"</code></li>
<li><code>"rootfs"</code></li>
</ul>
<p>If it finds such MTD partition, it builds a device name, such as &#8220;<code>/dev/mtd3</code>&#8220;.</p>
<p>Next, it opens the MTD device with <code>sys_open()</code> call, and obtains its memory information with the kernel IOCTL system call <code>sys_ioctl()</code>, using parameter <code>MEMGETINFO (0x80204D01)</code>. The original content of MTD is saved into a temporary buffer.</p>
<p>The MTD segments are then repeatedly unlocked with <code>MEMUNLOCK(0x40084D06)</code>, and erased with <code>MEMERASE (0x40084D02)</code> <a href="https://elixir.bootlin.com/linux/v4.9/source/include/uapi/mtd/mtd-abi.h#L159" rel="nofollow">parameters</a> of IOCTL system calls, doing it in the same fashion as described in <a href="https://opensourceforu.com/2012/01/working-with-mtd-devices/" rel="nofollow">this article</a>.</p>
<p>Finally, the MTD device is overwritten with an arbitrary block of data, using <code>sys_write()</code> system call. The block of data it overwrites MTD with consists of original data, patched with the supplied buffer of data from the end. That is, if the supplied buffer of data has the size of MTD, it will overwrite the entire MTD. If its size is only a quarter of MTD, only the last quarter of MTD will be overwritten with it.</p>
<p>If the supplied block of data is large enough and consists of zeroes, the MTD partition will be erased, potentially &#8220;bricking&#8221; the device. Depending on the data provided, the firmware can effectively be re-flashed.</p>
<p>Hence, this function was likely designed to re-flash the compromised device with new firmware, giving it new functionality such as hidden backdoors. At the same time, whether intentionally or not, it may wipe-out critical MTD partitions, rendering the compromised device inoperable.</p>
<p>It’s not clear why this unused function is present in the malware body. It could potentially be in a testing, soon-to-be-released phase. Or, this block of code could have been un-plugged from the rest of the code due to its instability or uselessness.</p>
<h2>So, how did the attack get started?</h2>
<p>Short answer: we don’t know.</p>
<p>Nevertheless, as mentioned in the previous post, the 1st stage dropper was submitted to VirusTotal on 12 June 2017, from a user in Taiwan. The file submitted by this Patient Zero had a filename <code>qsync.php</code>.</p>
<p>At about the same time the first sample was submitted, multiple users from around the world reported <a href="https://www.reddit.com/r/qnap/comments/6dypon/malware_removal/" rel="nofollow">strange behaviour</a> happening with their network-attached storage (NAS) devices.</p>
<p>The victims identified 2 offensive processes found on NAS: <code>qsync.php</code> and <code>vpnfilter</code>:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47912" src="https://news.sophos.com/wp-content/uploads/2018/05/image8.png" alt="" width="640" height="55" srcset="https://news.sophos.com/wp-content/uploads/2018/05/image8.png 975w, https://news.sophos.com/wp-content/uploads/2018/05/image8.png?resize=300,26 300w, https://news.sophos.com/wp-content/uploads/2018/05/image8.png?resize=768,66 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>One forum user seeking tech support advice posted a screenshot of his NAS user interface, saying “I have unknown user login every time when reboot NAS.”:</p>
<p><img class="aligncenter size-full wp-image-47913" src="https://news.sophos.com/wp-content/uploads/2018/05/image9.png" alt="" width="800" srcset="https://news.sophos.com/wp-content/uploads/2018/05/image9.png 1278w, https://news.sophos.com/wp-content/uploads/2018/05/image9.png?resize=300,55 300w, https://news.sophos.com/wp-content/uploads/2018/05/image9.png?resize=768,140 768w, https://news.sophos.com/wp-content/uploads/2018/05/image9.png?resize=1024,187 1024w" sizes="(max-width: 1278px) 100vw, 1278px" /></p>
<p>The IP shown in the logs is <code>222.186.56.233</code>, which is located in China. Multiple users have <a href="https://www.abuseipdb.com/check/222.186.56.233" rel="nofollow">reported complaints</a> about attempted brute-force logins to their NAS devices originating from this IP, back in December, 2017 :</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47914" src="https://news.sophos.com/wp-content/uploads/2018/05/image10.png" alt="" width="640" height="146" srcset="https://news.sophos.com/wp-content/uploads/2018/05/image10.png 1356w, https://news.sophos.com/wp-content/uploads/2018/05/image10.png?resize=300,68 300w, https://news.sophos.com/wp-content/uploads/2018/05/image10.png?resize=768,175 768w, https://news.sophos.com/wp-content/uploads/2018/05/image10.png?resize=1024,233 1024w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>It’s evident from these reports that the attackers attempted to log in with admin account. Some reports mention <a href="https://download.qnap.com/dev/API_QNAP_QTS_Authentication.pdf" rel="nofollow">authentication page</a> located at <code>/cgi-bin/authLogin.cgi</code>, also <a href="https://www.fireeye.com/blog/threat-research/2014/10/the-shellshock-aftershock-for-nas-administrators.html" rel="nofollow">known</a> to be used in a wide-spread <a href="https://www.us-cert.gov/ncas/alerts/TA14-268A" rel="nofollow">Shellshock</a> <a href="https://www.sophos.com/en-us/lp/bash-shellshock.aspx" rel="nofollow">attack</a> from 2014.</p>
<p>Same page was involved in another, more recent <a href="https://blogs.securiteam.com/index.php/archives/3565" rel="nofollow">exploit</a> (CVE-2017-17033). This particular one is based on unbounded <code>sprintf()</code> call with user-supplied input within <code>authLogin.cgi</code>. Since it was only reported on 11 December 2017, this could have been a zero-day exploit at the time of an alleged attack.</p>
<p>With thousands of NAS devices exposing their login panels to Shodan, the attackers have a quick way to discover their targets:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47969" src="https://news.sophos.com/wp-content/uploads/2018/05/login.png" alt="" width="400" height="343" srcset="https://news.sophos.com/wp-content/uploads/2018/05/login.png 400w, https://news.sophos.com/wp-content/uploads/2018/05/login.png?resize=300,257 300w" sizes="(max-width: 400px) 100vw, 400px" /></p>
<p>With the targets identified, the attackers may have undertaken a simple credentials’ brute-forcing attack, or a craftier attack that involved a well-known exploit, such as Shellshock, or a different exploit that at the time of attack was zero-day or stays zero-day up until today.</p>
<h2>Recommendations</h2>
<ul>
<li>Regardless of whether you think your device has been hacked, power cycle the device, flash the latest firmware over the top of whatever’s on there, and perform a factory reset on the firmware (this shouldn’t result in file loss on NAS devices, just a reset of all configured settings, which you’ll have to redo)</li>
<li>Change the default passwords for ALL administrator accounts to something complex and unique before reconnecting it to the network. Use a password manager to keep track of them</li>
<li>Never put a NAS device on the DMZ of your network, where it can be reached from the public Internet</li>
</ul>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2018/05/25/gdpr-is-here-how-sophos-protects-your-data/" rel="prev">GDPR is here – how Sophos protects your data</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2018/05/29/sophos-and-the-rsa-conference-2019/" rel="next">Sophos and the RSA Conference 2019</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Authors			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/41304abfe857c08aed7293c24a6c93fb?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/sergei-shevchenko/" title="Posts by Sergei Shevchenko" class="author url fn" rel="author">Sergei Shevchenko</a></h3>

					
					<div class="author-bio">
						<p>Sergei Shevchenko has 20 years of professional experience reverse engineering malware and is a recognized expert in his field. His analysis of high-profile malware attacks, including previous years' Bangladesh Bank heist, attacks on other banks, cyber espionage within managed service providers and ransomware attacks affecting thousands of vital service organizations globally, is the go-to information source for risk and technology officers and their teams around the world. He manages our threat research team in Sydney.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></h3>

					
					<div class="author-bio">
						<p>Andrew Brandt is a Principal Researcher for Sophos, specializing in security analytics and the forensic, retrospective analysis of malware infections and cyberattacks. In brief, he does whatever it takes to make life and business difficult for cybercriminals, spies, and other Internet miscreants. </p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>1</span> Comment		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-58467" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													John											</h2>
					<time class="comment-meta-item" datetime="2018-07-25T05:10-04:00" itemprop="datePublished"><a href="#comment-58467" itemprop="url">25 July 2018 at 5:10 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Is it possible to get a sample for one of the jpg images? I want to dynamically analyse the stage 1 sample but the C&amp;C servers are down and I can&#8217;t get the malware to download the picture. I want to simulate my own server for that. thanks :)</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/?replytocom=58467#respond' data-commentid="58467" data-postid="47901" data-belowelement="comment-58467" data-respondelement="respond" data-replyto="Reply to John" aria-label='Reply to John'>Reply</a>				</div>
			</div>

	</article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2018/05/27/vpnfilter-botnet-a-sophoslabs-analysis-part-2/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='47901' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="7902686887" /></p><input type="hidden" id="ak_js" name="ak_js" value="46"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-47838" class="second-featured post-47838 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-sophoslabs tag-vpnfilter region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">24</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2018/05/24/vpnfilter-botnet-a-sophoslabs-analysis/" rel="bookmark">VPNFilter botnet: a SophosLabs analysis</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkEEOwiAQRS8kIF20K+NRDLZjS8sAYcDq7R3TNHHhomTY8Hnvk4xao+iDz+CzyhMgkKIQp0AeVhLNWXdqJj4MhcWCeDaykZoDuQVyppM61NGHVEHDKydDx/ktkiVbV2/1BqOxo68Wo0nZQ6r2RlOtfLNdsr53ZQDa1orIBSJBdG+J1v+D+Ap4h+H3ff8Zi4iujNaTMoslhKxu7KpHSMjsFS+65em0PrfzB20wygw='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'47901',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '47901' ]);
</script>
</body>
</html>
