<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>How I learned to stop worrying and love &#8216;grey hat&#8217; tools &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; How I learned to stop worrying and love &#8216;grey hat&#8217; tools Comments Feed" href="https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615460090' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqXEWAK9AIhg='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/64417" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/" />
<link rel='shortlink' href='https://news.sophos.com/?p=64417' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F02%2F25%2Fhow-i-learned-to-stop-worrying-and-love-grey-hat-tools%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F02%2F25%2Fhow-i-learned-to-stop-worrying-and-love-grey-hat-tools%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="How I learned to stop worrying and love &#8216;grey hat&#8217; tools" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/" />
<meta property="og:description" content="A comprehensive security solution needs a sense of subtlety: not all machine code lends itself to be classified easily as malicious. As with most things in life, there&#8217;s a grey area in malwarâ€¦" />
<meta property="article:published_time" content="2020-02-25T13:45:19+00:00" />
<meta property="article:modified_time" content="2020-02-25T14:38:42+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?w=250" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="How I learned to stop worrying and love &#8216;grey hat&#8217; tools" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-64417 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-64417" class="post-64417 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-cobalt-strike tag-empire tag-evasion tag-hercules tag-hydra-thc tag-kali tag-koadic tag-metasploit tag-nishang tag-phantom tag-powershell tag-shelter tag-thefatrat tag-veilevasion region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">How I learned to stop worrying and love &#8216;grey hat&#8217; tools</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/cobalt-strike/">cobalt strike</a>&bull;<a href="https://news.sophos.com/en-us/tag/empire/">Empire</a>&bull;<a href="https://news.sophos.com/en-us/tag/evasion/">evasion</a>&bull;<a href="https://news.sophos.com/en-us/tag/hercules/">hercules</a>&bull;<a href="https://news.sophos.com/en-us/tag/hydra-thc/">hydra thc</a>&bull;<a href="https://news.sophos.com/en-us/tag/kali/">kali</a>&bull;<a href="https://news.sophos.com/en-us/tag/koadic/">koadic</a>&bull;<a href="https://news.sophos.com/en-us/tag/metasploit/">metasploit</a>&bull;<a href="https://news.sophos.com/en-us/tag/nishang/">nishang</a>&bull;<a href="https://news.sophos.com/en-us/tag/phantom/">Phantom</a>&bull;<a href="https://news.sophos.com/en-us/tag/powershell/">Powershell</a>&bull;<a href="https://news.sophos.com/en-us/tag/shelter/">shelter</a>&bull;<a href="https://news.sophos.com/en-us/tag/thefatrat/">thefatrat</a>&bull;<a href="https://news.sophos.com/en-us/tag/veilevasion/">veilevasion</a>		</div>

		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/" rel="bookmark">25 February 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=How%20I%20learned%20to%20stop%20worrying%20and%20love%20%26%238216%3Bgrey%20hat%26%238217%3B%20tools%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D64417" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=64417&#038;title=How%20I%20learned%20to%20stop%20worrying%20and%20love%20&#8216;grey%20hat&#8217;%20tools" data-title="How I learned to stop worrying and love &#8216;grey hat&#8217; tools" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/"
				data-title="How I learned to stop worrying and love &#8216;grey hat&#8217; tools"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="250" height="250" src="https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?w=250" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg 250w, https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2013/07/blackhat.jpg?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/tad-heppner/" title="Posts by Tad Heppner" class="author url fn" rel="author">Tad Heppner</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>A comprehensive security solution needs a sense of subtlety: not all machine code lends itself to be classified easily as malicious. As with most things in life, there&#8217;s a grey area in malware detection that includes hacking tools, poorly designed or easily exploitable applications, or borderline adware that provides little benefit to the unfortunate user of the machine running it.</p>
<p>Many applications that fall into this grey area don&#8217;t directly cause harm to a system or user, but the mere presence of these files on a computer can weaken the overall security posture, which can facilitate other attacks. Some tools open additional communication sockets, provide unintended backdoors, or make it easier for someone with malicious intent to download and execute modules from untrusted sources, or introduce new exploitable software bugs.</p>
<p>Many anti-virus solutions warn users when they detect files that fall into this grey area. Sometimes, your security software may allow you to suppress the detection if an admin determines the associated risk acceptable.</p>
<p>In this post we are looking at a more specific subset of tools within this grey area.</p>
<h3>What are grey hat tools?</h3>
<p>Grey hat tools are software kits often used by penetration testers and red teams to generate attacks with benign payloads, for the purposes of testing computer and network security.</p>
<p>The majority of grey hat tools attempt to obfuscate a given executable, shellcode, or scripting language payload for the purposes of evading detection by anti-virus software.</p>
<p>Other grey hat tools may provide library code containing common exploitation methods, keylogging, anti-debugging techniques, or code to detect the presence of a sandbox, virtual environment, or instruction emulation.</p>
<p>Some tools simply help with facilitating communication to a command and control server, by providing a framework for client-server communication with a given attack target.</p>
<p>Most of these kits are freely available, and published on community source control repositories like GitHub and SourceForge.Â Other kits are commercially available for a price and marketed to professional pentesters with the same intended use of conducting security audits. These types of tools often include disclaimers about how the code should only be used for testing computer or network security, by someone authorized to perform that task by the owner of the computer or network, and that the authors takes no responsibility for any potential unlawful uses of their creation.</p>
<h3>These tools are adopted by criminals as well</h3>
<p>Of course, there&#8217;s no way to prevent criminal users, with nefarious intentions, from using these kits to produce or enable malware. While a lot of mediocre malware may use these grey hat tools unmodified, &#8220;out of the box,&#8221; the more creative malware authors will often further modify a given grey hat tool in attempt to further expand its capabilities or make it more difficult for security software to detect.</p>
<p>These types of users generally have little respect for the various license agreements, intellectual property laws, or the aforementioned requests from the author not to use their software for illegal purposes. Your license agreement ends here.</p>
<h3>We aim to stop these payloads as well as we do with malware</h3>
<p>It&#8217;s pretty important that computer security solutions protect systems from the attacks these tools facilitate, because they get used in a lot of attacks. It&#8217;s also increasingly important for security products not only to identify the specific attacks employed by the original tool kit, but also to develop more comprehensive detection that can generically identify the methods or techniques used in the attack chain. That way, an analyst can build a way to detect the variations of the methods that inevitably follow, once criminals begin using a given grey hat tool.</p>
<h2>Core grey hat tools</h2>
<p>In our efforts to track the usage of grey hat tools, we found that the majority of grey hat tools employ one of the very few core tools to generate the initial shellcode, payload, or component that would then be further processed by a secondary tool. This creates a dependency chain in which tool A is a prerequisite for tool B.</p>
<p>Some grey hat tools install an entire suite of other grey hat tools for the purpose of chaining various methods together or layering different types of code obfuscation. These common prerequisite components we call <strong><em>core tools</em></strong>.</p>
<p>The following chart shows the three most popular core tools we followed in 2019 and the percentage of core tool detections in customer environments containing signature elements of having been generated with or inspired by that tool.</p>
<p><img loading="lazy" class="alignnone wp-image-64428" src="https://news.sophos.com/wp-content/uploads/2020/02/image1-1.png" alt="" width="649" height="486" srcset="https://news.sophos.com/wp-content/uploads/2020/02/image1-1.png 615w, https://news.sophos.com/wp-content/uploads/2020/02/image1-1.png?resize=300,224 300w" sizes="(max-width: 649px) 100vw, 649px" /></p>
<h3>Metasploit</h3>
<p>Of the core tools, various components that originated as part of the Metasploit framework are, by far, the most common tool in the grey hat toolbox, used in 73% of the incidents in which we detected and interdicted the use of any kind of grey hat tool during an infection. Perhaps it would be better to characterize them as<span lang="en-GB"> Metasploit-inspired tools, as the numbers for <em>core tools</em> also include samples that contain a core tool payload, or connect to a core tool C2 server. Not all the things we identified as part of the Metasploit Framework are &#8216;vanilla&#8217; Metasploit &#8211; some just contain Metasplot components.</span></p>
<p>Some of the reasons for its popularity are:</p>
<ul>
<li>It is freely available, and pre-installed, in Kali Linux distributions.</li>
<li>It contains SDK like component (MSFVenom) that can be called by other tools to facilitate the generation of customized shellcode.</li>
<li>It contains a modular Meterpeter component that can be packaged into other tools, and allow attackers to use Metaspoit itself as a C2 server.</li>
</ul>
<h3>Cobalt Strike</h3>
<p>Cobalt Strike is the third most popular core tool with many of similar features to Metasploit. We see Cobaltâ€™s components used in real-world malware as well, but because it is not open source and sold only to the pen-testing community directly, it may be more difficult for grey hat tool publishers to employ its components in derivative works.</p>
<p>We do see Cobaltâ€™s components used in the real-world attacks. Some examples of this include <a href="https://news.sophos.com/en-us/2019/05/03/megacortex-ransomware-wants-to-be-the-one" target="_blank" rel="noopener noreferrer">the MegaCortex ransomware</a> which contains a beacon which is used to connect back to a Cobalt Strike server with a reverse shell.</p>
<p>These types of reverse shell connections to the victim machine are common with many Grey hat tools. Attackers use the tool&#8217;s ability to remotely access a system in situations where the target resides behind NAT gateways and firewalls (which, to be fair, is most of them).</p>
<p>This connection can also be established using only a small block of shellcode (often less than 100 bytes in size).</p>
<p>The <a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection" target="_blank" rel="noopener noreferrer">Snatch ransomware</a> is another real-world example of malware using a grey hat tool component in a malicious attack.Â  Like MegaCortex, Snatch also uses Cobalt Strike to facilitate a reverse shell connection to the target system. Once the reverse shell connection has connected back to a Cobalt Strike listener the attacker can use Cobalt Strike to remotely control the infected system.</p>
<h3>PowerShell Empire</h3>
<p>We consider PowerShell Empire a core tool due to it being the source of many malicious PowerShell scripting techniques used in other grey hat tools.</p>
<p>PowerShell Empire is not necessarily used in the same way as many of the other tools. The attack framework contains a large collection of template methods that are copied and used in other tools. Although PowerShell Empire may not have initial been the initial origin for all the script sources that it contains, we still consider it a core tool due to its popularity in the communities.</p>
<h2>Secondary stage and less popular grey hat tools</h2>
<p>Many grey hat tools use payloads or listeners from the core tools above. The following chart includes detections for secondary stage grey hat tools as well.</p>
<p>Secondary stage tools often incorporate shellcode or other components generated by one of the core tools, but will add other layers of obfuscation or functionality.</p>
<p>It is important to note that, in some cases, attackers use more than one tool. This can cause some inaccuracies in our tracking, as we only associate the sample with the kit features that were used in the last layer of processing in the build chain.</p>
<p>The following charts show both the core tools and secondary stage tool detections we have seen in all of 2019</p>
<p><img loading="lazy" class="alignnone wp-image-64429" src="https://news.sophos.com/wp-content/uploads/2020/02/image2.png" alt="" width="651" height="555" srcset="https://news.sophos.com/wp-content/uploads/2020/02/image2.png 799w, https://news.sophos.com/wp-content/uploads/2020/02/image2.png?resize=300,256 300w, https://news.sophos.com/wp-content/uploads/2020/02/image2.png?resize=768,656 768w" sizes="(max-width: 651px) 100vw, 651px" /></p>
<p>It is often difficult to determine what percentage of the detections are internal security audits as opposed to a malicious attack in these numbers.Â  When we look at the detections over time, we see audits being conducted in close time proximity, with the same tool(s) and in the same network or customer environment.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-64430" src="https://news.sophos.com/wp-content/uploads/2020/02/image3.png" alt="" width="640" height="434" srcset="https://news.sophos.com/wp-content/uploads/2020/02/image3.png 975w, https://news.sophos.com/wp-content/uploads/2020/02/image3.png?resize=300,203 300w, https://news.sophos.com/wp-content/uploads/2020/02/image3.png?resize=768,521 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>Often, significant spikes in detections can be indicative of penetration testers conducting audits. But that can vary between toolkits. Some are more popular in the malware authoring community, while others are more popular with red teams</p>
<h2>Moving forward</h2>
<p>Understanding the usage of grey hat tool in both the penetration testing communities and the adaptations of these tools as used in malware helps us better understand trends in the threat landscape.</p>
<p>It also helps us better predict what new methods and payloads that are likely to be popular in the future.</p>
<p>Moving into 2020 we expect the use of powershell evasion techniques to remain popular as well as using WMI and other unconventional methods of achieving persistence. We also expect to see new and improved methods for encoding shellcode payloads as well as attempts to evade in-memory detection of the various C2 call-back agents.</p>
<h3>Acknowledgments</h3>
<p>The author would like to thank fellow researchers <span lang="en-GB">Andrew O&#8217;Donnell and </span><span lang="en-GB">Gabor Szappanos for their contributions to this research.<br />
</span></p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/02/25/harden-your-public-cloud-environment-against-apt-style-attacks/" rel="prev">Harden your public cloud environment against APT-style attacks</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/02/25/new-sophos-central-management-and-reporting-for-xg-firewall/" rel="next">New Sophos Central management and reporting for XG Firewall</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="145" src="https://news.sophos.com/wp-content/uploads/2020/01/tad-heppner.jpg?w=145" class="avatar avatar-145 photo wp-post-image" alt="Tad Heppner" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/tad-heppner/" title="Posts by Tad Heppner" class="author url fn" rel="author">Tad Heppner</a></h3>

					
					<div class="author-bio">
						<p>Tad Heppner is a threat researcher at SophosLabs working primarily with malware analysis, developing detection, and grey hat malware toolkits.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/02/25/how-i-learned-to-stop-worrying-and-love-grey-hat-tools/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='64417' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="5ad28227e0" /></p><input type="hidden" id="ak_js" name="ak_js" value="232"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-63980" class="second-featured post-63980 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs category-sophoslabs-uncut tag-gdrv-sys tag-gigabyte tag-mikhail tag-robbinhood tag-robnhold region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/02/robbinhood-graphic.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">06</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/">SophosLabs</a> &bull; <a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/02/06/living-off-another-land-ransomware-borrows-vulnerable-driver-to-remove-security-software/" rel="bookmark">Living off another land: Ransomware borrows vulnerable driver to remove security software</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-62404" class="second-featured post-62404 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-ransomware tag-snatch region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2019/12/snatch-featured.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">09</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/" rel="bookmark">Snatch ransomware reboots PCs into Safe Mode to bypass protection</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-60589" class="second-featured post-60589 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-sophoslabs category-sophoslabs-uncut tag-cryptojacking tag-cryptomining tag-eternalblue tag-fileless tag-lemon_duck tag-powershell tag-smb region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2019/02/iot-devices-apps.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">01</span>
				<span class="month">Oct</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/sophoslabs/">SophosLabs</a> &bull; <a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2019/10/01/lemon_duck-powershell-malware-cryptojacks-enterprise-networks/" rel="bookmark">Lemon_Duck PowerShell malware cryptojacks enterprise networks</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-54751" class="second-featured post-54751 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-ransomware tag-samsam tag-targeted-attacks region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">29</span>
				<span class="month">Nov</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2018/11/29/how-a-samsam-like-attack-happens-and-what-you-can-do-about-it/" rel="bookmark">How a SamSam-like attack happens, and what you can do about it</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IYCw648H4KAZZ3ZgUCAWnby9mWeLBw0h66d/va5OKOTDtXQKXRBoBgQT5MHpyMBNrG3kUE5UqkH8YYM+Wt1yWgC8Bn2gnNu3QPlbQ8EpR0XZ+iXhOxtZbWmFQZnDVYlAxOYjV3qCqlW+2SsZpm3ug5a2IZQGLEOybo3H/oNIC3qD/na+XMbNg82AcCfUwhJDEtbji7iMW9oJn2cnDvmuaUzN9AG09yg4='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'64417',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '64417' ]);
</script>
</body>
</html>
