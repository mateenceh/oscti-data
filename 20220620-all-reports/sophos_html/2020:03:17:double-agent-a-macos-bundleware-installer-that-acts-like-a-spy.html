<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>&#8220;Double agent&#8221;: a MacOS bundleware installer that acts like a spy &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; &#8220;Double agent&#8221;: a MacOS bundleware installer that acts like a spy Comments Feed" href="https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615460519' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpmWEWAK8/Ihc='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/54118" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/" />
<link rel='shortlink' href='https://news.sophos.com/?p=54118' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F03%2F17%2Fdouble-agent-a-macos-bundleware-installer-that-acts-like-a-spy%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F03%2F17%2Fdouble-agent-a-macos-bundleware-installer-that-acts-like-a-spy%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="&#8220;Double agent&#8221;: a MacOS bundleware installer that acts like a spy" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/" />
<meta property="og:description" content="Security software frequently blocks “bundleware” installers &#8211; software distribution tools that bundle their advertised applications with (usually undesired) additional software &#8211; as pot…" />
<meta property="article:published_time" content="2020-03-17T08:00:58+00:00" />
<meta property="article:modified_time" content="2020-04-16T09:37:01+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="384" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="&#8220;Double agent&#8221;: a MacOS bundleware installer that acts like a spy" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-54118 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-54118" class="post-54118 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate category-sophoslabs category-sophoslabs-uncut region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">&#8220;Double agent&#8221;: a MacOS bundleware installer that acts like a spy</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>&bull;<a href="https://news.sophos.com/en-us/category/sophoslabs/">SophosLabs</a>&bull;<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>		</div>

		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/" rel="bookmark">17 March 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=%26%238220%3BDouble%20agent%26%238221%3B%3A%20a%20MacOS%20bundleware%20installer%20that%20acts%20like%20a%20spy%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D54118" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=54118&#038;title=&#8220;Double%20agent&#8221;:%20a%20MacOS%20bundleware%20installer%20that%20acts%20like%20a%20spy" data-title="&#8220;Double agent&#8221;: a MacOS bundleware installer that acts like a spy" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/"
				data-title="&#8220;Double agent&#8221;: a MacOS bundleware installer that acts like a spy"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="384" src="https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg 1300w, https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg?resize=300,180 300w, https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg?resize=768,461 768w, https://news.sophos.com/wp-content/uploads/2020/03/stierlitz.jpg?resize=1024,614 1024w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/sergei-shevchenko/" title="Posts by Sergei Shevchenko" class="author url fn" rel="author">Sergei Shevchenko</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>Security software frequently blocks “bundleware” installers &#8211; software distribution tools that bundle their advertised applications with (usually undesired) additional software &#8211; as potentially undesirable applications. But one widely-used software distribution tool for MacOS applications goes to great lengths to avoid being blocked as “bundleware” &#8211; using a number of anti-forensics techniques that are more common in malware code. The installer is from a legitimate company, which claims to reach over 1 billion users per month with its various downloaders and adware platforms.</p>
<p>This software attempts to evade blocking by endpoint protection systems with anti-debugging code, strings and API encryption, runtime decompression and virtual machine detection. Its developers went as far as to embed a full backdoor-like component into the installer that allows remote injection of new code into the installer &#8211; granting it capabilities that extend far beyond what one might expect from a piece of installation software.</p>
<p>This particular bundleware has potential access to a large number of Macs around the world. The power given to the installer practically enables full control over the target system. Even if this was done so that the company behind it would have &#8216;advanced analytics&#8217; or the ability to push any third-party software it wants, given the amount of power it aggregates, what happens if this power is abused?</p>
<p>We&#8217;re not naming the company or the installer here because of its wide distribution; this research is entirely focused on technical aspects of the reverse-engineered software. The developers have been contacted by researchers, but have shown no interest in changing what they see as a feature of their installer, as long as it allows them to monetize the installations of their software.</p>
<h3>The allure of bundleware</h3>
<p>MacOS application developers use third-party installers for a number of reasons. One of the reasons often given is the desire to improve the overall &#8220;user experience&#8221; of software installation. Many developers turn to application installation platforms because they promise enhanced installation analytics, an optimized footprint, and a guaranteed smoothness of installation.</p>
<p>But these installers offer another attraction that is more important to many developers: the promise of monetization. Developers or websites distributing freeware (such as free games) or software based on open source components may not be able to charge for the applications, but they can capture some revenue by teaming with a third-party installation tool.</p>
<p>Some of these application installation platforms bundle the title application with third-party software such as adware or browser toolbars, leading to a setup that the end-user might find unwanted. Once the target application is installed, users often encounter undesirable consequences, such as installed browser hijackers that modify the search engine for their web browser. In some cases, these inject messages for &#8220;scare-ware&#8221; removers that prompt the user to pay for the removal of non-exist threats.</p>
<p>Apple actively combats these types of unethical applications, which the company labels as &#8221; <a href="https://developer.apple.com/support/protecting-users-from-suspicious-software/">suspicious software</a> .&#8221; In 2019, starting with macOS 10.14.5 (Mojave), Apple began requiring application developers to submit their code for &#8221; <a href="https://developer.apple.com/news/?id=04102019a">notarization</a> &#8220;, and blocking applications without notarisation or with revoked developer signatures by macOS&#8217;s <a href="https://support.apple.com/en-us/HT202491">Gatekeeper</a> . Apple can revoke notarisation and the developer accounts associated with applications that are found to be abusive. But bundleware installers may not get flagged as &#8220;suspicious&#8221; in the notarization process.</p>
<p>Detecting bundleware is almost never a problem for endpoint protection systems &#8211; it&#8217;s a much more simplistic breed, so to speak, than malware. But the bundleware package we examine here, already blocked by a number of endpoint protection tools as a potentially unwanted application, adopts many anti-forensics and counter-detection techniques that have in the past been found mostly in malware.</p>
<h3>The Application</h3>
<p>The bundleware described in this post is a Cocoa application &#8211; an application built with the <a href="https://developer.apple.com/documentation/appkit">AppKit</a> framework, and is distributed as an <a href="https://developer.apple.com/library/archive/documentation/CoreFoundation/Conceptual/CFBundles/AboutBundles/AboutBundles.html">application bundle</a> . From sample to sample, the name of the main executable varies. For example, it can be named as <code>radiosurgical</code>or <code>Herculid</code>.</p>
<p>The digital signature used to sign the app varies, as this is generated by the developer packaging the application with the installer. Some observed installers are signed by “Owen Bell”. Some other installers were found to be signed by “RuiQing Software Technology Beijing Inc.” or “AVSoftware EOOD”.</p>
<h3>The main executable</h3>
<p>Compiled as Mach-O (the native executable file format for macOS), the main executable relies on Objective-C runtime <code>libobjc.dylib</code>. When the kernel first loads the main executable, it makes sure that the executable is a valid Mach-O file, and then examines its <code>mach_header</code>structure.</p>
<p>Next, it loads the dynamic linker to load all the shared libraries that the main executable links against. The dynamic linker then initializes the Objective-C runtime, and then calls the program&#8217;s <em>main ()</em> function.</p>
<p>However, the main executable&#8217;s entry point starts from garbage bytes &#8211; that is, it has no valid code to execute:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em;">__text: 0000000100001150 <span style="color: white">04 </span>     <span style="color: yellow">start</span>     db     <span style="color: cyan">4</span>  
__text: 0000000100001151 <span style="color: white">4A</span>                db     <span style="color: cyan">4Ah</span> ; J 
__text: 0000000100001152 <span style="color: white">3E</span>                db     <span style="color: cyan">3Eh</span> ; &gt;</pre>
<p>With no valid code at the entry point, how does it run without crashing? The answer lays in Objective-C&#8217;s concept of <em>non-lazy</em> (&#8216;eager&#8217;) and <em>lazy</em> (&#8216;on-demand&#8217;) implementation of classes.</p>
<p><em>Non-lazy</em> classes are realized when the program starts up. These classes will always implement <em>+ load</em> method. Contrary to that, <em>lazy</em> classes (classes without <em>+ load</em> method) do not have to be realized immediately, but only when they receive a message for the first time (hence the term &#8216;lazy&#8217;).</p>
<p>Let&#8217;s check out Objective-C Runtime&#8217;s own <a href="https://opensource.apple.com/source/objc4/objc4-532/runtime/objc-runtime-new.mm">source,</a> found in <code>objc-runtime-new.mm</code> file. The snippet below realizes the <em>non-lazy</em> classes, retrieved with <em>_getObjc2NonlazyClassList ()</em> call:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em"><span style="color: #008000">// Realize non-lazy classes (for + load methods and static instances) </span>
<span style="color: #0000ff">for</span> (EACH_HEADER) {
     <span style="color: #2b91af">classref_t</span> * classlist = _getObjc2NonlazyClassList (hi, &amp; count);
    <span style="color: #0000ff">for</span> (i = 0; i &lt;count; i ++) { 
        realizeClass (remapClass (classlist [i])); 
    } 
}
</pre>
<p>Looking at the Objective-C Runtime&#8217;s <a href="https://github.com/opensource-apple/objc4/blob/master/runtime/objc-file.mm">source</a> in <code>objc-file.mm</code>, one can see that <em>_getObjc2NonlazyClassList ()</em> function collects <em>non-lazy</em> classes from the <code>__objc_nlclslist</code>data section:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">GETSECT (_getObjc2NonlazyClassList,    <span style="color: #008000">// function name </span>
         <span style="color: #2b91af">classref_t</span> ,                  <span style="color: #008000">// content type </span>
         <span style="color: #a31515">"__objc_nlclslist"</span> );         <span style="color: #008000">// section name - 'nl' stands for non-lazy</span>
</pre>
<p>In the case of our bundleware executable, the <code>__objc_nlclslist</code>data section of the main binary is very small. It enlists only two <em>non-lazy</em> classes: <code>ListedUpaithric</code>and <code>__ARCLite__</code>:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em">__objc_nlclslist: 0001000692C8     <span style="color: yellow">__objc_nlclslist segment para public 'DATA' use64</span>  
__objc_nlclslist: 0001000692C8 dq offset <span style="color: yellow">_OBJC_CLASS _ $ _ ListedUpaithric</span>  
__objc_nlclslist: 0001000692D0 dq offset <span style="color: yellow">_OBJC_CLASS _ $ ___ ARCLite__</span>  
__objc_nlclslist: 0001000692D0     <span style="color: yellow">__objc_nlclslist ends</span></pre>
<p>The <code>ListedUpaithric</code>name, like many of the other class names in the executable, is random. For example, in another sample this class is called <code>HoundingHusky</code>.</p>
<p>These two non-lazy classes will be called in the order they&#8217;re listed, realized by their <em>+ load </em> method.  However, at first glance the <em>+ load</em> method of the <code>__ARCLite__</code>class contains no valid code, because it is located within the <code>__text</code>section of the executable &#8211; which is encrypted.</p>
<h3>Finding a secret agent</h3>
<p>The <em>+ load</em> method of the <code>ListedUpaithric</code>class is physically located in a section of the executable that has a random name, such as <code>__amorpha</code>or <code>__mottled</code>. Once run, the <em>+ load</em> method will take a 32-byte XOR key hard-coded in the body and then use that key to decrypt the <code>__text</code>section (around 15KB in size) of the executable, including the <em>+ load</em> method of the <code>__ARCLite__</code>class.</p>
<p>The decryption routine relies on a special anchor stored in the <code>__text</code>section. The virtual address of this anchor is used to describe the virtual address and virtual size of the encrypted <code>__text</code>section.</p>
<p>For example, in this particular sample, the anchor can be located at the virtual address <code>0x100001CF0</code>, as shown below:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em">__text: 000100001CF0 23        <span style="color: yellow">anchor </span>      <span style="color: cyan">db 23h</span> ; #      <span style="color: cyan">; DATA XREF: decrypt_code + 101</span>  
__text: 000100001CF1 2B                     <span style="color: cyan">db 2Bh</span> ; + 
...</pre>
<p>The decryptor uses the address of the anchor to describe the parameters of the <code>__text</code> section. In the snippet below, the decryptor makes the <code>__text</code> section writable and executable, by assigning a new protection to it. To do that, it takes the address of the anchor <code>0x100001CF0</code> and subtracts <code>0xBA0</code> from it to locate the start of the <code>__text</code> section &#8211; <code>0x100001150</code>:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">vm_protect (mach_task_self (),          <span style="color: #008000">// decoded stings: 'vm_protect', 'mach_task_self_'</span>  
            ( <span style="color: #2b91af">char</span> *) &amp; anchor - 0xBA0,    <span style="color: #008000">// 0x100001150 -&gt; start of the __text section</span>  
            0x37F2,                    <span style="color: #008000">// size of the entire __text section: 14,322 bytes</span> 
            0 , 
            VM_PROT_ALL)               <span style="color: #008000">// assign read, write, and execute access rights</span>
</pre>
<p>Once the entire <code>__text</code>section is decrypted, the anchor shown above gets decrypted into the following text:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em">__text: 000100001CF0 MaximMaximovicIsayev db ' <span style="color: #00ff00">Maxim Maximovich Isayev</span> ', <span style="color: #00ff00">0</span></pre>
<p>The resulting text is the same across all the samples we&#8217;ve looked at, and is quite interesting by itself. Maxim Maximovich Isayev (Максим Максимович Исаев) is the Russian name of Max Otto von Stierlitz, the lead <a href="https://en.wikipedia.org/wiki/Stierlitz">character</a> in a popular Russian book series written in the 1960s, and of the most popular Soviet television series ever, <em>Seventeen Moments of Spring</em> .</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2018/11/image1.jpeg"><img loading="lazy" class="alignnone size-medium wp-image-54150" src="https://news.sophos.com/wp-content/uploads/2018/11/image1.jpeg?w=300" alt="" width="300" height="223" srcset="https://news.sophos.com/wp-content/uploads/2018/11/image1.jpeg 640w, https://news.sophos.com/wp-content/uploads/2018/11/image1.jpeg?resize=300,223 300w" sizes="(max-width: 300px) 100vw, 300px" /></a>A Soviet James <a href="http://www.bbc.com/news/magazine-39862225">Bond</a> , Stierlitz takes a key role in SS Reich Main Security Office in Berlin during World War II. Working as a deep undercover agent within SS, he diverts the German nuclear &#8220;Vengeance Weapon&#8221; research program into a fruitless dead-end.</p>
<p>Leaving a hidden marker like that could indicate an intentionally planted false flag. Regardless of the intention, this marker stays constant across the entire family of this bundleware.</p>
<p>After the <code>ListedUpaithric</code> class is called and decrypts the text, being next in line, the <em>+ load</em> method of the <code>__ARCLite__</code> <em>non-lazy</em> class is called to perform further initialization. The decrypted <code>__text</code> section is quite small &#8211; it&#8217;s a valid code section containing a valid entry point in it, and it consists of another layer of decryptor and decompressor:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em">__text: 0000000100001150             <span style="color: yellow">public start</span>  
__text: 0000000100001150      <span style="color: yellow">start proc near</span>  
__text: 0000000100001150 push    <span style="color: cyan">0</span> 
__text: 0000000100001152 mov rbp, rsp 
__text: 0000000100001155 and rsp, <span style="color: cyan">0FFFFFFFFFFFFFFF0h</span>  
__text: 0000000100001159 mov rdi, [rbp + <span style="color: cyan">8</span> ]</pre>
<p>With both <em>non-lazy</em> classes realized, the entry point above receives control. From there, the <em>main ()</em> function of the executable is called, followed with <em>_exit ()</em> .</p>
<h3>The main () function</h3>
<p>Once the entry point within <code>__text</code>section is called, the <em>main ()</em> function that follows it will read an internal chunk of data with the size of ~ 300KB.</p>
<p>This encrypted data is stored in a separate section of the executable.</p>
<p>The data will be read, its CRC32-based hash validated, then decrypted and further decompressed into a buffer, allocated with <em>vm_allocate ()</em> function.</p>
<p>The decompression is achieved by dynamically loading <code>libz.1.dylib</code> library, and calling <em>uncompress ()</em> API from it.</p>
<p>The decompressed data has a size of ~ 800Kb, having a format of Mach-O executable ( <code>MH_BUNDLE</code> type). This data is loaded from memory as a plugin with the help of <em>NSCreateObjectFileImageFromMemory ()</em> and <em>NSLinkModule ()</em> APIs.</p>
<p>This method is equivalent to dynamic DLL loading on Windows. It is described on macOS man <a href="http://mirror.informatimago.com/next/developer.apple.com/documentation/Darwin/Reference/ManPages/man3/NSModule.3.html">page</a> as a way to programmatically load <a href="http://mirror.informatimago.com/next/developer.apple.com/documentation/Darwin/Reference/ManPages/man3/NSObjectFileImage.3.html">plugins</a> after a program starts executing.</p>
<h3>The Engine</h3>
<p>The loaded module represents itself an engine driven by the JavaScript files.</p>
<p>Some of the scripts reside in the app&#8217;s Resources directory in an encrypted form, forming an SDK. Other JavaScript files are fetched from a remote server as tasks (internally called &#8216;offers&#8217; as they are designed to offer / advertise other products).</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2018/11/engine_schema.png"><img loading="lazy" class="alignnone size-full wp-image-63212" src="https://news.sophos.com/wp-content/uploads/2018/11/engine_schema.png" alt="" width="640" height="242" srcset="https://news.sophos.com/wp-content/uploads/2018/11/engine_schema.png 1720w, https://news.sophos.com/wp-content/uploads/2018/11/engine_schema.png?resize=300,113 300w, https://news.sophos.com/wp-content/uploads/2018/11/engine_schema.png?resize=768,290 768w, https://news.sophos.com/wp-content/uploads/2018/11/engine_schema.png?resize=1024,387 1024w, https://news.sophos.com/wp-content/uploads/2018/11/engine_schema.png?resize=1536,580 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The downloaded tasks rely on high-level function calls from the SDK. This allows composing tasks with a very flexible logic.</p>
<p>There are several classes exposed by the engine to the SDK, such as:</p>
<ul>
<li>System controller</li>
<li>Install</li>
<li>Screenshot controller</li>
<li>Task manager</li>
<li>Collector info system</li>
<li>Event reporter</li>
<li>Application manager</li>
<li>File downloader</li>
</ul>
<p>The engine itself is executed on macOS platform natively.</p>
<p>For example, a JavaScript task may attempt to elevate the privilege level with the following call:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">function relaunchWithRoot () { 
    installer.relaunchingWithRoot = true; 
    var successR = installer.elevatePrivilegedTask ();</pre>
<p>The <em>elevatePrivilegedTask ()</em> call in JavaScript has a corresponding method in the engine&#8217;s class, such as <code>tr54jds23</code>. The engine exposes this method to JavaScript code so that it can be called directly from the engine.</p>
<p>When <code>tr54jds23</code> -&gt; <em>elevatePrivilegedTask ()</em> is executed, the engine calls another method: <code>ICTaskManager</code> -&gt; <em>elevatePrivilegedTask ()</em> .</p>
<p>That will, in turn, create a task <code>ICTaskManager</code>-&gt; <em>root_Task</em> . The task will then create an authorization with the <code>system.privilege.admin</code>flag. Next, the task is executed with the <em>AuthorizationExecuteWithPrivileges ()</em> call.</p>
<p>In practice, this may invoke a dialog asking for admin password so that the task can be executed as root.</p>
<h3>String / API Encryption</h3>
<p>The engine module stores the names of all critical functions and most critical strings encoded. In one of the analyzed samples, there are 1,228 encoded strings, decoded with 1,055 different functions. That is, some strings are decoded with the same function.</p>
<p>All the string decoding functions use different keys, but they implement one of the following 3 algorithms:</p>
<ul>
<li>Simple XOR key</li>
<li>Simple key subtraction</li>
<li>Auto-incremented XOR key</li>
</ul>
<p>One of the string decryption routines can be demonstrated with the anti-debugging trick explained in the next section.</p>
<h3>Anti-debugging Trick</h3>
<p>An attempt to attach to or run the bundleware app under a debugger produces the following error:</p>
<pre style="background-color: #27292c;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em"><span style="color: cyan">mac: / user $ sudo lldb /Users/user/Installer/Installer.app
(lldb) target create "/Users/user/Installer/Installer.app"
Current executable set to '/Users/user/Installer/Installer.app' (x86_64).
(lldb) r
Process 1280 launched:
'/Users/user/Installer/Installer.app/Contents/MacOS/radiosurgical' (x86_64)
<span style="color: yellow">Process 1280 exited with status = 45 (0x0000002d)</span></span></pre>
<p>The anti-debugging defense is provided with <em>ptrace ()</em> request named <code>PT_DENY_ATTACH</code>( <code>0x1F</code>), called from the function below:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em"><span style="color: cyan">ptrace = 0x515D5A5D;                       <span style="color: #00ff00">// encrypted 'ptrace' string: 5D 5A 5D 51 
<span style="color: cyan">ptrace_plus_4 = 0x5752;                    <span style="color: #00ff00">// 52 57 
<span style="color: cyan">ptrace_plus_6 = 0x33;                      <span style="color: #00ff00">// 33 
<span style="color: cyan">ptrace [0] = <span style="color: white">add_2D_xor (0x5D, 0);           <span style="color: #00ff00">// decrypt 1st char (5D ^ (2D + 0)) 
<span style="color: cyan">i = 1;                                     <span style="color: #00ff00">// start loop from the 2nd char
do
{                                           <span style="color: #00ff00">// decrypt the rest 
    <span style="color: cyan">ptrace [ <span style="color: cyan">i ] = <span style="color: white">add_2D_xor ( <span style="color: cyan">ptrace [ <span style="color: cyan">i ], <span style="color: cyan">i );  <span style="color: #00ff00">// ptrace [i] ^ = 2D + i 
    <span style="color: cyan">i ++;
}
while ( <span style="color: cyan">i ! = 6);                            <span style="color: #00ff00">// 6 characters from the 2nd char, including / 0 
<span style="color: cyan">fn_ptrace = <span style="color: cyan">dlsym (RTLD_NEXT, &amp; <span style="color: cyan">ptrace );     <span style="color: #00ff00">// get proc address from the linked dylibs 
return <span style="color: cyan">fn_ptrace ( <span style="color: yellow">PT_DENY_ATTACH , 0, 0, 0); <span style="color: #00ff00">// call ptrace () by pointer, deny tracing</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>If the process is being debugged, as defined in man <a href="http://mirror.informatimago.com/next/developer.apple.com/documentation/Darwin/Reference/ManPages/man2/ptrace.2.html"><code>ptrace</code></a>, it will exit with the exit status of <code>ENOTSUP</code>( <code>45</code>), <em>&#8216;error, not supported&#8217;</em> . Otherwise, it sets a flag that denies future traces &#8211; an attempt to debug it with this flag set will result in a segmentation violation exception.</p>
<p>By stepping over a call into the function that denies tracing (or NOP-ing the 5 bytes of the call), the anti-debugging trick above can be easily circumvented:</p>
<pre style="background-color: #27292c;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em">-&gt;   <span style="color: orange">0x103dd1ff5 &lt;+25&gt;: callq 0x103e30cd3                ; </span>call the function with ptrace ()
    0x103dd1ffa &lt;+30&gt;: callq 0x103de03aa; ICCrashLogger :: sharedLogger ()
    0x103dd1fff &lt;+35&gt;: movq% rax,% rdi
(lldb) <span style="color: yellow">re w pc `$ pc + 5`       <span style="color: #00ff00">; </span>step over the call by adding 5 bytes to $ pc 
(lldb) <span style="color: yellow">x / 2i $ pc              <span style="color: #00ff00">; </span>now $ pc (pseudo-name for RIP) points to the next instruction
-&gt; 0x103dd1ffa: e8 ab e3 00 00 callq 0x103de03aa; </span>ICCrashLogger :: sharedLogger ()
    0x103dd1fff: 48 89 c7 movq% rax,% rdi</span></pre>
<h3>Obfuscation Variations</h3>
<p>Some samples of this bundleware family contain variations in the string encryption algorithm.</p>
<p>For example, a hard-coded integer number <code>6</code>within a decryption function can be encoded with a separate function, as shown below:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em"><span style="color: yellow">get_6 proc near
        push rbp
        mov rbp, rsp
        mov al, <span style="color: cyan">3          <span style="color: #00ff00">; </span>al = 3 
        shl al, <span style="color: cyan">2          <span style="color: #00ff00">; </span>al = 12 
        movsx ecx, al        <span style="color: #00ff00">; </span>ecx = 12 
        mov eax, <span style="color: cyan">65        <span style="color: #00ff00">; </span>eax = 65 
        xor edx, edx       <span style="color: #00ff00">; </span>edx = 0 
        idiv ecx            <span style="color: #00ff00">; </span>65/12, eax = 5 
        mul cl             <span style="color: #00ff00">; </span>eax = 60 
        mov cl, <span style="color: cyan">65         <span style="color: #00ff00">; </span>cl = 65 
        sub cl, al         <span style="color: #00ff00">; </span>cl = 65 - 60 = 5 
        inc cl             <span style="color: #00ff00">; </span>cl = 6 
        movsx eax, cl        <span style="color: #00ff00">; </span>result = 6
        pop rbp
        retn
<span style="color: yellow">get_6 endp</span></span></span></span></span></span></pre>
<p>The same function is collapsed by the Hex-Rays Decompiler into:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">signed __int64 get_6 ()
{
    return 6;
}</pre>
<h3>VM Evasion</h3>
<p>Because of their advertising-based business model, the developers of this bundleware installer go to great lengths to prevent fraud by those looking to pump up the monetization of their apps using large numbers of virtual machine installs. The engine is able to detect the presence of a virtual environment through the method <em>checkPossibleFraud ()</em> . This method is exposed to JavaScript, where it can be called as:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">var isVm = system.checkPossibleFraud ()&gt; 0? 1: 0;</pre>
<p>To achieve that, the engine compiles a so called &#8216;fraud&#8217; report that consists of the following details:</p>
<ul>
<li><code>MAC_L</code><br />
MAC and IP addresses for all network interfaces, to recognize sandboxes that rely on a common network setup.</li>
<li><code>vmVendor</code><br />
The engine checks if the MAC address starts from an address that is common for a given VM manufacturer. For example, if the MAC address starts from <code>00:1C:42</code>, the installer determines that it&#8217;s running under a <em>Parallels</em> VM.<br />
Using this trick for over 35 known MAC prefixes, it reports the following VM vendors (the vendor names are shown exactly as the installer reports them):</p>
<ul>
<li>Parallels ID.</li>
<li>Egenera, Inc.</li>
<li>First Virtual Corporation</li>
<li>linux kernal virtual machine (kvm)</li>
<li>Virtual Iron Software, Inc. (was: Katana Technology)</li>
<li>Paravirtual Corporation (was: Accenia, Inc.)</li>
<li>Virtual Conexions</li>
<li>Virtual Computer Inc.</li>
<li>virtual access, ltd.</li>
<li>Virtual Instruments</li>
<li>Virtualtek. Co. Ltd</li>
<li>VMware, Inc.</li>
<li>Microsoft Corporation (was: Connectix)</li>
<li>Microsoft Corp.</li>
<li>Microsoft Network Load Balancing Service Heartbeat</li>
<li>Microsoft XCG</li>
<li>Oracle Corporation (was: Virtual Iron Software)</li>
<li>Oracle Corporation (was: Xsigo Systems, Inc.)</li>
<li>Oracle Corporation (was: Sun Microsystems, Inc)</li>
<li>CADMUS COMPUTER SYSTEMS</li>
</ul>
</li>
<li><code>Host UUID</code><br />
Reported by <em>gethostuuid ()</em> , to recognise common sandboxes.</li>
<li><code>hddName</code><br />
The engine collects data reported by <em>DADiskCreateFromBSDName ()</em> for <code>/dev/disk0</code>device, to recognise HDD presumably common for some sandbox installations.</li>
<li><code>usbFraud</code><br />
A list of USB devices, presumably common for certain VMs, as reported by calling:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">ioreg -l | grep -e 'USB Vendor Name'</pre>
</li>
<li><code>dispRats</code><br />
Report display ratio, to recognize display ratios used in common sandboxes.</li>
<li><code>lastMove</code><br />
Report mouse position since the last mouse movement event, to see if a VM was restored from a clean snapshot.</li>
<li><code>lastRbt</code><br />
Gets system up-time, since last reboot, to recognize a VM restored from a snapshot.</li>
<li><code>dmgLoc</code>, <code>fromDMG</code><br />
Gets full path filename of the DMG file, in case it&#8217;s executed by a sandbox under a generic name, such as using file hash.</li>
<li><code>wndPos</code><br />
Gets position and size of the app&#8217;s window.</li>
<li><code>msePos</code><br />
Gets mouse position, to see if mouse is in use.</li>
</ul>
<h3>Crash Logger</h3>
<p>The crash logger in the samples we examined sends a GET request to a remote script, disguised as a PNG file:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">http [: //] ec2-54-191-37-103.us-west-2.compute.amazonaws [.] com / black.png</pre>
<p>The stats it submits to the remote script are encoded as URL parameters:</p>
<ul>
<li><code>crash=1</code></li>
<li><code>os=mac</code></li>
<li><code>appkit=%APP_KIT%</code></li>
<li><code>ver=%VERSION%</code></li>
<li><code>ldebug=%LIVE_DEBUG%</code></li>
<li><code>backtrace=%CALL_BACKTRACE%</code></li>
</ul>
<h3>Configuration</h3>
<p>The installer uses two configuration files. The first one is dynamically extracted from an unused cavity of the installer&#8217;s own DMG file. This configuration is written into the DMG file (a process internally called &#8216;injection&#8217;) after the DMG file is built, and is encrypted with AES-128 algorithm.</p>
<p>To locate the encrypted config within the DMG file, the installer module parses the contents of the file. For each pair of bytes, it subtracts one byte from another, until if locates the following signature that consists of 7 64-bit integers, such as:</p>
<pre style="background-color: #000064;line-height: 125%;color: silver;padding-top: 1em;padding-bottom: 1em">__const: 0000000103E51C40    <span style="color: white">signature    dq <span style="color: cyan">0Fh , <span style="color: cyan">9 , <span style="color: cyan">3Eh , <span style="color: cyan">23h , <span style="color: cyan">7 , <span style="color: cyan">86h , <span style="color: cyan">0Ch</span></span></span></span></span></span></span></span></pre>
<p>Once located, the config is then extracted and decrypted. As shown in the example below, the extracted configuration specifies the URL of an application to download and install:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em"><span style="color: #900"><strong>PRODUCT_TITLE</strong></span> = Duolingo% 202017
<span style="color: #900"><strong> PRODUCT_DESCRIPTION</strong></span> = To% 20install% 20Duolingo% 202017% 20for% 20Mac% 20click% 20Continue.
<span style="color: #900"><strong>PRODUCT_VERSION</strong></span> = Mac
<span style="color: #900"><strong> PRODUCT_PUBLIC_DATE</strong></span> = 2017
<span style="color: #900"><strong> PRODUCT_FILE_NAME</strong></span> = Duolingo% 20% 20Setup
<span style="color: #900"><strong> PRODUCT_FILE_SIZE</strong></span> = 260.8% 20MB
<span style="color: #900"><strong> CHNL</strong></span> = download7-Duolingo
<span style="color: #900"><strong> DOWNLOAD_URL</strong></span> = http% 3A% 2F% 2Fcdn.downloadfree2.com% 2Fmacsoftware% 2FBlueStacks Installer.dmg
<span style="color: #900"><strong> PRODUCT_LOGO_URL</strong></span> = http% 3A% 2F% 2Fwww.download7.co% 2Fgamegraphics% 2F90.png
<span style="color: #900"><strong> ROOT_IF_INSTALLED</strong></span> = com.bluestacks.BlueStacks
<span style="color: #900"><strong> APP_NAME</strong></span> = BlueStacks
<span style="color: #900"><strong> TOS_URL</strong></span> = http% 3A% 2F% 2Fwww.download7.co% 2Feula.html
<span style="color: #900"><strong>TYP</strong></span> = http% 3A% 2F% 2Fpiroga.space% 2Fpages% 2FDM% 2FDMTYP.html% 3Foffers% 3D
<span style="color: #900"><strong> EXIT_PAGE_URL</strong></span> = http% 3A% 2F% 2Fpiroga.space% 2Fpages% 2FDM% 2FDMInter.html
<span style="color: #900"><strong> PRIVACY_URL</strong></span> = http% 3A% 2F% 2Fwww.download7.co% 2Fprivacy.html
<span style="color: #900"><strong> ISPBROWSER</strong></span> = ch
<span style="color: #900"><strong> % 40REPORT_ADD_PARAMS</strong></span> = IRONBRO_ID% 253D9309% 2526INST_GUID% 253D4136ef6c-c79c-49b3 -...
<span style="color: #900"><strong> INST_GUID</strong></span> = 4136ef6c3e -794</pre>
<p>The 2nd configuration file is provided as a JavaScript file, and is decrypted with the other SDK files from the app&#8217;s Resources directory.</p>
<p>This configuration defines multiple operational parameters, such as report and ad servers:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em"><span style="color: #0000ff">var appInfo = {
    report: <span style="color: #a31515">'http: // rp. [REMOVED] .com' ,
    ad_url: <span style="color: #a31515">’http://os.[REMOVED].com/MacDarwenDLM/?v=5.0’</span>,
    requires_root: <span style="color: #0000ff">false</span>,
    root_if_installed: [<span style="color: #a31515">’’</span>],
    skip_vm_check: <span style="color: #0000ff">false</span>,
    ...
</span></span></pre>
<h3>Report Server</h3>
<p>The report server from the configuration is used to receive posted reports.</p>
<p>The example below demonstrates what data is posted to the report server:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em"><span style="color: #900"><strong>AC</strong></span> = DarwenDLM
<span style="color: #900"><strong>PrID</strong></span> = MacDarwenDLM
<span style="color: #900"><strong>PrSub</strong></span> = MacDarwenDLM
<span style="color: #900"><strong>RS</strong></span> = Q
<span style="color: #900"><strong>IRVER</strong></span> = 106.1712
<span style="color: #900"><strong>CHNL</strong></span> = download7-Duolingo
<span style="color: #900"><strong>PROD_TITLE</strong></span> = Duolingo 2017
<span style="color: #900"><strong>schemeName</strong></span> = MacDarwenDLM
<span style="color: #900"><strong>OSName</strong></span> = OSX
<span style="color: #900"><strong>OSVer</strong></span> = 10.12
<span style="color: #900"><strong>OSLang</strong></span> = en
<span style="color: #900"><strong>_makeDate</strong></span> = 201711091722
<span style="color: #900"><strong>SDT</strong></span> = 20181004195204931
<span style="color: #900"><strong>UID</strong></span> = 9C0C266E-266D-4D98-B83C-BCB2A3018EB7
<span style="color: #900"><strong>BRW</strong></span> = Safari
<span style="color: #900"><strong>OSPlat</strong></span> = 2
<span style="color: #900"><strong>MAC_L</strong></span> = [REMOVED]000000000000%3A127.0.0.1%3A24%3A0
<span style="color: #900"><strong>hddSize</strong></span> = 107374182400
<span style="color: #900"><strong>_makerver</strong></span> = total20171107115116
<span style="color: #900"><strong>Isuseradmin</strong></span> = 1
<span style="color: #900"><strong>isVmDef</strong></span> = 1
<span style="color: #900"><strong>inst_flv</strong></span> = no_injection_106.1712
<span style="color: #900"><strong>dwa.SrcNo</strong></span> = 1
<span style="color: #900"><strong>QuitPage</strong></span> = welcomePage
<span style="color: #900"><strong>RepCnt</strong></span> = 1
<span style="color: #900"><strong>ofrClPrm</strong></span> = 266E-266D-4D98-B83C-BCB2A3018EB7</pre>
<p>As seen in the example, the data it posts contains basic system information, such as macOS version number (<code>OSVer</code>), language (<code>OSLang</code>), MAC and IP addresses for all network interfaces (<code>MAC_L</code>), default browser name (<code>BRW</code>), HDD size, whether a VM was detected or not (<code>isVmDef</code>), whether user is admin (<code>isuseradmin</code>), and some other parameters.</p>
<p>The collected data is assembled into a text, then encrypted with AES-128, and posted to the server:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2018/11/image3.png"><img loading="lazy" class="alignnone size-large wp-image-54175" src="https://news.sophos.com/wp-content/uploads/2018/11/image3.png?w=640" alt="" width="640" height="171" srcset="https://news.sophos.com/wp-content/uploads/2018/11/image3.png 661w, https://news.sophos.com/wp-content/uploads/2018/11/image3.png?resize=300,80 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h3>Tasks</h3>
<p>Remote tasks are received encrypted from the ad server, as shown below:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">POST <span style="color: #05b">os.[REMOVED].com/MacDarwenDLM/?v=5.0</span>
USER-AGENT: <span style="color: #05b">ICMAC</span>
Response:
    Header: X-ICSCT-SERVER-NAME: <span style="color: #05b">ads-slave-1111-production-us-west-2-i-07e9c6437616f3e49</span>
    Data: 85,368 bytes binary [<span style="color: #d04000">6c ec 6c 99...</span>]</pre>
<p>When the received task is decrypted, its data is split into named sections. Each section is surrounded with the following comments:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em"><span style="color: #05b">var</span> namestartstr = ’<span style="color: #d04000">&lt;!--SECTION NAME="</span>’;
<span style="color: #05b">var</span> nameendstr = ’<span style="color: #d04000">"--&gt;</span>’;
<span style="color: #05b">var</span> sectionendstr = ’&lt;<span style="color: #d04070">!--/SECTION--&gt;</span>’;</pre>
<p>The parser extracts JavaScript code from those sections. That code will then rely on APIs exposed by the SDK, to drive the engine that exposes its own API interface to the SDK.</p>
<p>The nature of the received tasks may depend on the presence of VM (a condition, internally called ’fraud’).</p>
<p>An analysis of the tasks received from the ad server reveals no malicious activity.</p>
<h3>Engine Capabilities</h3>
<p>The bundleware’s engine consists of the several components, capable of doing the following:</p>
<ul>
<li style="list-style-type: none">
<ul>
<li>Browser manager
<ul style="list-style-type: square">
<li>detects supported browsers, such as Safari, Google Chrome, Firefox</li>
<li>terminates browser process</li>
<li>sets new home page</li>
<li>reads Chrome preferences</li>
<li>clears Chrome cache</li>
<li>reads Firefox preferences</li>
</ul>
</li>
<li>Logger
<ul style="list-style-type: square">
<li>takes full screen snapshot</li>
<li>takes installer window’s snapshot</li>
<li>submits ’live debug’ information to the remote server</li>
</ul>
</li>
<li>Screenshot controller
<ul style="list-style-type: square">
<li>takes full screen snapshot with the mouse location</li>
<li>collects a set of screenshots</li>
<li>takes snapshot of a given window</li>
</ul>
</li>
<li>Task manager
<ul style="list-style-type: square">
<li>downloads and execute new tasks
<ul style="list-style-type: circle">
<li>submits task execution output</li>
<li>runs tasks with the privilege level elevated to root</li>
</ul>
</li>
<li>creates authorisation for tasks, using given credentials</li>
</ul>
</li>
<li>System controller
<ul style="list-style-type: square">
<li>collects system OS version</li>
<li>collects mac address and IP for all interfaces</li>
<li>collects all cookies from Safari, Google Chrome, Firefox</li>
<li>collects the list of all installed applications</li>
<li>collects the list of running applications</li>
<li>checks the presence of VM</li>
<li>gets home page for all supported browsers</li>
<li>gets system default browser</li>
<li>adds/removes applications to/from dock</li>
<li>adds applications to dock</li>
<li>checks if user is admin</li>
<li>checks if a given process runs as admin</li>
<li>gets user name</li>
<li>gets user locale/language</li>
<li>gets free space of start-up volume</li>
<li>gets info about connected iOS devices:
<ul style="list-style-type: circle">
<li>device class (iPod/iPad/iPhone)</li>
<li>device identifier</li>
<li>device serial number</li>
</ul>
</li>
<li>builds ’fraud’ report (info about detected VM)</li>
<li>collects the following lists:
<ul style="list-style-type: circle">
<li>running processes</li>
<li>keyboard input sources</li>
<li>graphics card names</li>
<li>USB devices</li>
<li>apps launched automatically on login</li>
<li>launch daemons and agents</li>
<li>user launch agents</li>
<li>Google Chrome extension names</li>
<li>Safari extension names</li>
<li>Firefox extension names</li>
</ul>
</li>
<li>searches for files in the specified directory</li>
<li>checks if the specified application is running</li>
<li>terminates specified applications</li>
<li>encrypts/decrypts data</li>
<li>gets user paths, such as local applications, download paths</li>
<li>checks if an application is installed by the specified name</li>
<li>reads key values from user defaults</li>
<li>gets default apps for all available extensions</li>
<li>adds an app to dock as persistent item</li>
<li>removes all persistent apps from dock for specified path</li>
<li>reads text files</li>
<li>copies given directory to a new location</li>
<li>deletes the specified directory</li>
<li>run specified script with <code>’/bin/sh’</code>, as root</li>
<li>checks if the specified file exists</li>
<li>gets detailed HDD information</li>
<li>collects network information</li>
<li>downloads files</li>
<li>reads/sets window title for running apps</li>
<li>reads mouse position</li>
<li>displays alerts</li>
<li>launches tasks/applications as root</li>
<li>copies/moves files</li>
<li>opens URLs</li>
<li>saves data to files</li>
<li>checks if path is writable</li>
<li>creates/deletes directories</li>
<li>gets specified file size/attributes</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>CI/CD pipeline</h3>
<p>The authors of the bundleware have apparently adopted <a href="https://jenkins.io/">Jenkins</a>, an open source tool for building Continuous Integration and Continuous Delivery (CI/CD) pipelines.</p>
<p>This fact is evident from the full path names of the source files that are still visible in the compiled engine module, such as:</p>
<pre style="background-color: white;line-height: 125%;padding-top: 1em;padding-bottom: 1em">/Users/[REMOVED]-ai/jenkins/workspace/AI_Mac_Release_Production/continuous-integration/mac_team_repo/Sources/[REMOVED]Utils.mm</pre>
<p>With Continuous Integration in place, every commit made to the source code in the Git repository is pulled and built automatically. If it results in a bug, the developers can quickly identify the responsible commit.</p>
<p>Continuous Integration pipeline also allows automated testing and deployment. Apart from reducing the length of time it takes to release new PUA builds, it also allows to increase their quality.</p>
<h3>Conclusion</h3>
<p>Being a legitimate distribution platform, the techniques employed by this popular bundleware product conceal a very powerful engine.</p>
<p>When viewed from a certain angle, this engine resembles a backdoor as it unlocks full access to the system.</p>
<p>The sheer power of the engine is made covert with the wisely engineered trickery. Some of its methods, such as loading code from memory, are known from the “The Mac Hacker’s <a href="https://www.amazon.com/Mac-Hackers-Handbook-Charlie-Miller/dp/0470395362">Handbook</a>”, and rightly belong to the world of malware.</p>
<p>Given that the engine is driven by symmetrically encrypted remote tasks, any researcher who pays attention to detail couldn’t help but wonder what would happen if the control of its engine was intercepted.</p>
<p>Careful analysis of these techniques also demonstrates a disturbing trend we’re witnessing – the continued ’spill’ of the traditional <em>Windows</em> malicious techniques, such as run-time packing, strings/API obfuscation, memory injection into the <em>Mac</em> world.</p>
<p>Even though the installer itself is legitimate, an analysis of state-of-art code where these techniques are honed to perfection is vitally important for the researchers to understand what opportunities exist on the <em>macOS</em> platform, to be better prepared for the challenges that lay ahead of us.</p>
<p><em>This report is based on research <a href="https://www.virusbulletin.com/conference/vb2019/abstracts/never-had-stierlitz-been-so-close-failure">previously presented at Virus Bulletin&#8217;s VB2019 conference</a> .</em></p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/03/14/non-stop-sophos-protection-during-the-coronavirus-pandemic/" rel="prev">Non-stop Sophos protection during the coronavirus pandemic</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/03/17/facilitating-remote-working-with-sophos-xg-firewall/" rel="next">Facilitating remote working with Sophos XG Firewall</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/41304abfe857c08aed7293c24a6c93fb?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/sergei-shevchenko/" title="Posts by Sergei Shevchenko" class="author url fn" rel="author">Sergei Shevchenko</a></h3>

					
					<div class="author-bio">
						<p>Sergei Shevchenko has 20 years of professional experience reverse engineering malware and is a recognized expert in his field. His analysis of high-profile malware attacks, including previous years' Bangladesh Bank heist, attacks on other banks, cyber espionage within managed service providers and ransomware attacks affecting thousands of vital service organizations globally, is the go-to information source for risk and technology officers and their teams around the world. He manages our threat research team in Sydney.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/03/17/double-agent-a-macos-bundleware-installer-that-acts-like-a-spy/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='54118' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="226a69e8a2" /></p><input type="hidden" id="ak_js" name="ak_js" value="157"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IYCxuxoPxUQyyurFRIJQ5fXsxyxIPHkbSS/9+X5tULIFp7xK4JNIACCTIh8GTg4VYXcmTGClXhvxkgD1rXnOZA74GfKSD2LVD+1hAwytFRfv5NeJzMrbc0gqDMr0rFoOKyUEs9npVrHyzTTJO27kDWt+KmBewCMG+ORr3D8ot4B263/l2GWcW7NwbR0JNhhCSuGVXPHzEzF7xIlvZHNuqkefxA21LyhQ='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'54118',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '54118' ]);
</script>
</body>
</html>
