<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>LockBit ransomware borrows tricks to keep up with REvil and Maze &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; LockBit ransomware borrows tricks to keep up with REvil and Maze Comments Feed" href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615460090' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqXEWAK9AIhg='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/65814" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" />
<link rel='shortlink' href='https://news.sophos.com/?p=65814' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F04%2F24%2Flockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F04%2F24%2Flockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="LockBit ransomware borrows tricks to keep up with REvil and Maze" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" />
<meta property="og:description" content="Recently-adopted techniques advance LockBit to a major ransomware player&#8230;for now." />
<meta property="article:published_time" content="2020-04-24T13:03:38+00:00" />
<meta property="article:modified_time" content="2020-04-24T13:28:38+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="425" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="LockBit ransomware borrows tricks to keep up with REvil and Maze" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-65814 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-65814" class="post-65814 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-data-breach tag-exfiltration tag-i-o-completion-ports tag-iocp tag-lockbit-ransomware tag-uac-bypass tag-user-account-control region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">LockBit ransomware borrows tricks to keep up with REvil and Maze</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/data-breach/">data breach</a>&bull;<a href="https://news.sophos.com/en-us/tag/exfiltration/">exfiltration</a>&bull;<a href="https://news.sophos.com/en-us/tag/i-o-completion-ports/">I/O Completion Ports</a>&bull;<a href="https://news.sophos.com/en-us/tag/iocp/">IOCP</a>&bull;<a href="https://news.sophos.com/en-us/tag/lockbit-ransomware/">LockBit Ransomware</a>&bull;<a href="https://news.sophos.com/en-us/tag/uac-bypass/">UAC Bypass</a>&bull;<a href="https://news.sophos.com/en-us/tag/user-account-control/">User Account Control</a>		</div>

					<div class="entry-excerpt">
				<p>Recently-adopted techniques advance LockBit to a major ransomware player&#8230;for now.</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" rel="bookmark">24 April 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				6			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=LockBit%20ransomware%20borrows%20tricks%20to%20keep%20up%20with%20REvil%20and%20Maze%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D65814" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=65814&#038;title=LockBit%20ransomware%20borrows%20tricks%20to%20keep%20up%20with%20REvil%20and%20Maze" data-title="LockBit ransomware borrows tricks to keep up with REvil and Maze" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/"
				data-title="LockBit ransomware borrows tricks to keep up with REvil and Maze"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="425" src="https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg 800w, https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?resize=300,199 300w, https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?resize=768,510 768w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/albert-zsigovits/" title="Posts by Albert Zsigovits" class="author url fn" rel="author">Albert Zsigovits</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>Ransomware operators are always on the lookout for a way to take their ransomware to the next level. That&#8217;s particularly true of the gang behind LockBit. Following the lead of the Maze and REvil ransomware crime rings, LockBit&#8217;s operators are now threatening to leak the data of their victims in order to extort payment. And the ransomware itself also includes a number of technical improvements that show LockBit&#8217;s developers are climbing the ransomware learning curve—and have developed an interesting technique to circumvent Windows&#8217; User Account Control (UAC).</p>
<p>Because of recent dynamics in the ransomware world, we suspect that this privilege-escalation technique will pop up in other ransomware families in the future. We&#8217;ve seen a surge in “imposter&#8221; ransomware that are essentially rebranded variants of already-existing ransomware. Not a single day goes by where a new brand of ransomware does not come out. It has become surprisingly easy to clone ransomware and release it, with small modifications, under a different umbrella.</p>
<h3>The Ransomware Learning Curve</h3>
<p>Before we jump into the synopsis of LockBit, let’s take a moment to look at how ransomware is developed, in general. Many families follow a common timeline when it comes to the techniques and procedures ransomware developers implement at each stage. This appears to stem from the learning curve involved in creating ransomware, and the iteration of the malware as the developer builds his or her related knowledge of the malware craft.</p>
<p>Each ransomware seems to have an “infancy phase,” where the developer implements TTPs hastily just so the “product” can come out and start gaining its reputation. In this phase, the simplest ideas are implemented first, strings are usually plain text, the encryption is implemented in a way that only a single-thread is used, and LanguageID checks are in place to avoid encrypting computers in <a href="https://worldpopulationreview.com/countries/cis-countries/" target="_blank" rel="noopener noreferrer">CIS countries.</a> and avoid attracting unwanted attention from CIS law enforcement agencies.</p>
<p>After about 2 months into the ransomware operation, the developer starts implementing more sophisticated elements. They may introduce multi-threading, establish a presence in underground forums, obfuscate or encrypt strings in the binary, and there is usually a skip list/kill list for services and processes.</p>
<p>Around 4 months into the ransomware’s life, we start seeing things get more serious. The business model may now switch to Ransomware as a Service (RaaS), putting an Affiliate program in place. Oftentimes, binaries are cryptographically signed with valid, stolen certificates. There is a possibility that the ransomware developer starts implementing UAC bypasses at this stage. This appears to be the stage the LockBit group is entering.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-matrix.jpg"><img loading="lazy" class="wp-image-65952 size-large alignnone" src="https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-matrix.jpg?w=640" alt="" width="640" height="584" srcset="https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-matrix.jpg 768w, https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-matrix.jpg?resize=300,274 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h3>Advertising the goods</h3>
<p>As with most ransomware, LockBit maintains a forum topic on a well-known underground web board to promote their product. Ransomware operators maintain a forum presence mainly to advertise the ransomware, discuss customer inquiries and bugs, and to advertise an affiliate program through which other criminals can lease components of the ransomware code to build their own ransomware and infrastructure.</p>
<p>In January, LockBit&#8217;s operators created a new thread in the web board&#8217;s marketplace forum, announcing the &#8220;LockBit Cryptolocker Affiliate Program&#8221; and advertising the capabilities of their malware. The post claims that the new version had been in development since September of 2019, and emphasizes the performance of the encryptor and its lower use of system resources to prevent its detection.</p>
<figure id="attachment_65951" aria-describedby="caption-attachment-65951" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/LockBit_affiliate_post.png"><img loading="lazy" class="wp-image-65951 size-large" src="https://news.sophos.com/wp-content/uploads/2020/04/LockBit_affiliate_post.png?w=640" alt="" width="640" height="399" srcset="https://news.sophos.com/wp-content/uploads/2020/04/LockBit_affiliate_post.png 651w, https://news.sophos.com/wp-content/uploads/2020/04/LockBit_affiliate_post.png?resize=300,187 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65951" class="wp-caption-text">A forum post announcing LockBit&#8217;s affiliate program.</figcaption></figure>
<p>LockBit&#8217;s post indicates that &#8220;we do not work in the CIS,&#8221; meaning that the ransomware will not target victims in Russia and other Commonwealth of Independent States countries. This comes as no surprise—as we have seen previously, CIS authorities don&#8217;t bother investigating these groups unless they are operating against targets in their area of jurisdiction.</p>
<p>That does not mean that the LockBit group won&#8217;t do business with other CIS-based gangs. In fact, they won&#8217;t work with English-speaking developers without a Russian-speaking &#8220;guarantor&#8221; to vouch for them.</p>
<h3>Escalating the extortion</h3>
<p>In this most recent evolution of LockBit, the malware now drops a ransom note that threatens to leak data the malware has stolen from victims: <em>&#8220;!!! We also download huge amount of your private data, including finance information, clients personal info, network diagrams, passwords and so on. Don&#8217;t forget about GDPR.&#8221;</em></p>
<figure id="attachment_65946" aria-describedby="caption-attachment-65946" style="width: 640px" class="wp-caption alignnone"><a style="font-size: 1em" href="https://news.sophos.com/wp-content/uploads/2020/04/note.png"><img loading="lazy" class="wp-image-65946 size-large" src="https://news.sophos.com/wp-content/uploads/2020/04/note.png?w=640" alt="" width="640" height="142" srcset="https://news.sophos.com/wp-content/uploads/2020/04/note.png 1455w, https://news.sophos.com/wp-content/uploads/2020/04/note.png?resize=300,67 300w, https://news.sophos.com/wp-content/uploads/2020/04/note.png?resize=768,170 768w, https://news.sophos.com/wp-content/uploads/2020/04/note.png?resize=1024,227 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65946" class="wp-caption-text">LockBit ransom note</figcaption></figure>
<p>If the threat were to be carried out, it might result in real-world sanctions against the ransomware victims from regulators or privacy authorities—for example, for violating the European Union&#8217;s General Data Privacy Rules (GDPR) that make companies responsible for securing sensitive customer data in their possession.</p>
<p>An increasing number of ransomware gangs use extortion that threatens the release of private data, which might include sensitive customer information, trade secrets, or embarrassing correspondence to incentivize victims to pay the ransom, even if they have backups that prevented data loss. The data leak threat has become a signature of the <a href="https://nakedsecurity.sophos.com/2020/03/23/stolen-data-of-company-that-refused-revil-ransom-payment-now-on-sale/">REvil </a>and Maze ransomware gangs; the Maze group has gone as far as to publicly publish chunks of data from victims who fail to pay by the deadline, taking down the dumps when they are finally paid.</p>
<h2>Picking through LockBit&#8217;s code</h2>
<p>From a first glance at the recent LockBit sample with a reverse-engineering tool, we can tell that the program was written primarily in C++ with some additions made using Assembler. For example, a few anti-debug techniques employ the <strong>fs:30h</strong> function call to manually check the <strong>PEB</strong> (Process Environment Block) for the <strong>BeingDebugged</strong> flag, instead of using <strong>IsDebuggerPresent()</strong>.</p>
<p>The first thing the ransomware does at execution is to check whether the sample was executed with any parameters added from the command line. Usually, this is done to check for whether the sample is being executed in a sandbox environment. Contemporary malware often requires that the command to run the malware use specific parameters to prevent the malware from being analyzed by an automated sandbox, which often execute samples without parameters. But the LockBit sample we examined doesn&#8217;t do that—it won&#8217;t execute if there is <em>any</em> parameter entered from the command line. If there are no arguments in the command that executes it, Lockbit hides its console output, where the malware prints debug messages, and proceeds to do its job.</p>
<figure id="attachment_65953" aria-describedby="caption-attachment-65953" style="width: 513px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/check.png"><img loading="lazy" class="size-large wp-image-65953" src="https://news.sophos.com/wp-content/uploads/2020/04/check.png?w=513" alt="" width="513" height="309" srcset="https://news.sophos.com/wp-content/uploads/2020/04/check.png 513w, https://news.sophos.com/wp-content/uploads/2020/04/check.png?resize=300,181 300w" sizes="(max-width: 513px) 100vw, 513px" /></a><figcaption id="caption-attachment-65953" class="wp-caption-text">The command-line parameter checker in LockBit halts the ransomware if there&#8217;s any parameter passed.</figcaption></figure>
<p>This could be intended to detect if the sample was executed in a sandbox environment. But it&#8217;s possible that either the malware author made a mistake in the implementation of the check (and wanted to check the other way around), or that this behavior is just a placeholder, and future versions will introduce different logic.</p>
<h3>Hiding strings</h3>
<p>LockBit&#8217;s author also used several techniques to make it more difficult to reconstruct the code behind it. The Portable Executable (PE) binary shows signs of being heavily optimized, as well as some efforts by the group to cover their coding tracks—or at least get rid of some of the low-hanging fruit that reverse engineering tools look for, such as unencrypted text strings.</p>
<div>Those heavy optimizations also increase LockBit&#8217;s performance. The binary makes heavy use of Intel&#8217;s SSE instruction set and architecture-specific features to boost its performance. That includes the use of multiple XMM registers used to store and decrypt the service names, process names and other strings used to interact with the operating system that are unique to the ransomware.</div>
<figure id="attachment_65826" aria-describedby="caption-attachment-65826" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/xmmword_registers.png"><img loading="lazy" class="wp-image-65826 size-large" src="https://news.sophos.com/wp-content/uploads/2020/04/xmmword_registers.png?w=640" alt="" width="640" height="133" srcset="https://news.sophos.com/wp-content/uploads/2020/04/xmmword_registers.png 872w, https://news.sophos.com/wp-content/uploads/2020/04/xmmword_registers.png?resize=300,62 300w, https://news.sophos.com/wp-content/uploads/2020/04/xmmword_registers.png?resize=768,159 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65826" class="wp-caption-text">Xmmword registers<strong> store encrypted LockBit strings</strong></figcaption></figure>
<p>These string variables get decrypted on the fly with a 1-byte XOR key unique to each string: the first hex byte of every variable.</p>
<p>Almost all the functions contain a small routine that loops around and is in charge of decrypting hidden strings. In this case, we can see that how the original <strong>MSSQLServerADHelper100</strong> service name gets de-obfuscated: the malware leverages a one-byte “0A” XOR key to decrypt the plaintext service name.</p>
<figure id="attachment_65844" aria-describedby="caption-attachment-65844" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/service_names_deobfuscated.png"><img loading="lazy" class="size-large wp-image-65844" src="https://news.sophos.com/wp-content/uploads/2020/04/service_names_deobfuscated.png?w=640" alt="" width="640" height="773" srcset="https://news.sophos.com/wp-content/uploads/2020/04/service_names_deobfuscated.png 666w, https://news.sophos.com/wp-content/uploads/2020/04/service_names_deobfuscated.png?resize=249,300 249w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65844" class="wp-caption-text">Deobfuscating service names in the source</figcaption></figure>
<h3>Check your privilege</h3>
<p>To ensure that it can do the most damage possible, LockBit has a procedure to check whether its process has Administrator privileges. And if it doesn&#8217;t, it uses a technique that is growing in popularity among malware developers: a Windows User Account Control (UAC) bypass.</p>
<p>Leveraging <strong>OpenProcessToken</strong>, it queries the current process via a TOKEN_QUERY access mask. After that, it calls <strong>CreateWellKnownSid</strong> to create a user security identifier (SID) that matches the administrator group (<strong>WinBuiltinAdministratorsSid</strong>), so now the malware has a reference it can use for comparisons. Finally, it checks whether the current process privileges are sufficient for Administrator rights, with a call to <strong>CheckTokenMembership</strong>.</p>
<figure id="attachment_65851" aria-describedby="caption-attachment-65851" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/checking_admin_SID.png"><img loading="lazy" class="size-large wp-image-65851" src="https://news.sophos.com/wp-content/uploads/2020/04/checking_admin_SID.png?w=640" alt="" width="640" height="422" srcset="https://news.sophos.com/wp-content/uploads/2020/04/checking_admin_SID.png 697w, https://news.sophos.com/wp-content/uploads/2020/04/checking_admin_SID.png?resize=300,198 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65851" class="wp-caption-text">Checking Administrator SID against the current process’ SID</figcaption></figure>
<p>If the current process does not have Admin privileges, the ransomware tries to sidestep Windows UAC with a bypass. In order for that to succeed, a Windows COM object needs to auto-elevate to Admin-level access first.</p>
<p>To make this possible, LockBit calls a procedure called <strong>supMasqueradeProcess</strong> upon process initialization. Using supMasqueradeProcess allows LockBit to conceal its process&#8217; information by injecting into a process running in a trusted directory. And what better target is there for that than explorer.exe?</p>
<p>The source code for the masquerade procedure can be found in <a href="https://github.com/hfiref0x/UACME/blob/master/Source/Akagi/sup.c" target="_blank" rel="noopener noreferrer">a Github repository.</a></p>
<figure id="attachment_65852" aria-describedby="caption-attachment-65852" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/masquerade_explorer_exe.png"><img loading="lazy" class="size-large wp-image-65852" src="https://news.sophos.com/wp-content/uploads/2020/04/masquerade_explorer_exe.png?w=640" alt="" width="640" height="378" srcset="https://news.sophos.com/wp-content/uploads/2020/04/masquerade_explorer_exe.png 845w, https://news.sophos.com/wp-content/uploads/2020/04/masquerade_explorer_exe.png?resize=300,177 300w, https://news.sophos.com/wp-content/uploads/2020/04/masquerade_explorer_exe.png?resize=768,454 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65852" class="wp-caption-text">LockBit &#8220;masquerades&#8221; as explorer.exe</figcaption></figure>
<p>With the use of IDA Pro&#8217;s COM helper tool, we see two CLSIDs—globally unique identifiers that identify COM class object—that LockBit&#8217;s code references. CLSIDs, represented as 128-bit hexadecimal numbers within a pair of curly braces, are stored in the Registry path <strong>HKEY_LOCAL_MACHINE\Software\Classes\CLSID</strong>.</p>
<figure id="attachment_65853" aria-describedby="caption-attachment-65853" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/clsids-recognized-by-IDA.png"><img loading="lazy" class="size-large wp-image-65853" src="https://news.sophos.com/wp-content/uploads/2020/04/clsids-recognized-by-IDA.png?w=640" alt="" width="640" height="190" srcset="https://news.sophos.com/wp-content/uploads/2020/04/clsids-recognized-by-IDA.png 735w, https://news.sophos.com/wp-content/uploads/2020/04/clsids-recognized-by-IDA.png?resize=300,89 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65853" class="wp-caption-text">CLSIDs recognized by IDA.</figcaption></figure>
<p>Looking up these reveals that the two CSLIDS belong to <strong>IColorDataProxy</strong> and <strong>ICMLuaUtil</strong>—both undocumented COM interfaces that are <a href="https://github.com/hfiref0x/UACME/blob/master/Source/Akagi/methods/hybrids.c" target="_blank" rel="noopener noreferrer">prone to UAC bypass</a>.</p>
<table>
<tbody>
<tr>
<td width="150"><strong>Name</strong></td>
<td width="306"><strong>CLSID</strong></td>
<td width="168"><strong>DLL</strong></td>
</tr>
<tr>
<td width="150">CMSTPLUA</td>
<td width="306">{3E5FC7F9-9A51-4367-9063-A120244FBEC7}</td>
<td width="168">..\system32\cmstplua.dll</td>
</tr>
<tr>
<td width="150">Color Management</td>
<td width="306">{D2E7041B-2927-42fb-8E9F-7CE93B6DC937}</td>
<td width="168">..\system32\colorui.dll</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Masquerading as explorer.exe, LockBit calls <strong>CoInitializeEx</strong> to initialize the COM library, with <strong>COINIT_MULTITHREADED</strong> and <strong>COINIT_DISABLE_OLE1DDE</strong> flags to set the concurrency model. The hex values here (CLSIDs) are then moved and aligned into the stack segment register, and the next function call (<strong>lockbit.413980</strong>) will further use them.</p>
<figure id="attachment_65855" aria-describedby="caption-attachment-65855" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/UACBypass1.png"><img loading="lazy" class="size-large wp-image-65855" src="https://news.sophos.com/wp-content/uploads/2020/04/UACBypass1.png?w=640" alt="" width="640" height="262" srcset="https://news.sophos.com/wp-content/uploads/2020/04/UACBypass1.png 954w, https://news.sophos.com/wp-content/uploads/2020/04/UACBypass1.png?resize=300,123 300w, https://news.sophos.com/wp-content/uploads/2020/04/UACBypass1.png?resize=768,315 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65855" class="wp-caption-text">UAC bypass step 1</figcaption></figure>
<p>&nbsp;</p>
<figure id="attachment_65856" aria-describedby="caption-attachment-65856" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/UACBypass2.png"><img loading="lazy" class="size-large wp-image-65856" src="https://news.sophos.com/wp-content/uploads/2020/04/UACBypass2.png?w=640" alt="" width="640" height="279" srcset="https://news.sophos.com/wp-content/uploads/2020/04/UACBypass2.png 912w, https://news.sophos.com/wp-content/uploads/2020/04/UACBypass2.png?resize=300,131 300w, https://news.sophos.com/wp-content/uploads/2020/04/UACBypass2.png?resize=768,334 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65856" class="wp-caption-text">UAC bypass step 2</figcaption></figure>
<p>&nbsp;</p>
<p><strong>Lockbit.413980</strong> hosts the COM elevation moniker, which allows applications that are running under user account control (UAC) to activate COM classes (via the following format: <em>Elevation:Administrator!new:{guid} </em>) with elevated privileges.</p>
<p>The malware adds the 2 previously seen CLSIDs to the moniker and executes them.</p>
<figure id="attachment_65866" aria-describedby="caption-attachment-65866" style="width: 562px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/ComElevationMoniker.png"><img loading="lazy" class="size-large wp-image-65866" src="https://news.sophos.com/wp-content/uploads/2020/04/ComElevationMoniker.png?w=562" alt="" width="562" height="520" srcset="https://news.sophos.com/wp-content/uploads/2020/04/ComElevationMoniker.png 562w, https://news.sophos.com/wp-content/uploads/2020/04/ComElevationMoniker.png?resize=300,278 300w" sizes="(max-width: 562px) 100vw, 562px" /></a><figcaption id="caption-attachment-65866" class="wp-caption-text">The COM Elevation Moniker in use.</figcaption></figure>
<p>&nbsp;</p>
<p>Now, the privilege has been successfully elevated with the UAC bypass and the control flow is passed back to the ransomware. We also notice two events and a registry key change during the execution:</p>
<table style="height: 143px" width="560">
<tbody>
<tr>
<td width="532">C:\WINDOWS\SysWOW64\DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}</td>
</tr>
<tr>
<td width="532">C:\WINDOWS\SysWOW64\DllHost.exe /Processid:{D2E7041B-2927-42fb-8E9F-7CE93B6DC937}</td>
</tr>
</tbody>
</table>
<table style="height: 90px" width="558">
<tbody>
<tr>
<td width="532">Key: Software\Microsoft\Windows NT\CurrentVersion\ICM\Calibration</td>
</tr>
<tr>
<td width="532">Value: <strong>DisplayCalibrator</strong></td>
</tr>
</tbody>
</table>
<h3>Kill or skip</h3>
<p>LockBit enumerates the currently running processes and started services via the API calls <strong>CreateToolhelp32Snapshot</strong>, <strong>Process32First</strong>, <strong>Process32Next</strong> and finally <strong>OpenProcess</strong>, and compares the names against an internal service and process list. If one process matches with one on the list, LockBit will attempt to terminate it via <strong>TerminateProcess</strong>.</p>
<p>The procedure to kill a service is a bit different. The malware will first connect to the Service Control Manager via <strong>OpenSCManagerA</strong>. It then attempts to check whether a service from the list exists via <strong>OpenServiceA</strong>. If the targeted service is present, it then tries to determine its state by calling to <strong>QueryServiceStatusEx</strong>. Based on the status returned, it will call <strong>ControlService </strong>with the parameter<strong> SERVICE_CONTROL_STOP (0x00000001) </strong>on the specific service to stop it. But before that, another function (0x40F310) will cycle through all dependent services in conjunction with the target service, so dependencies are stopped too. The malware will initiate calls to <strong>EnumDependentServicesA</strong> to achieve this.</p>
<figure id="attachment_65845" aria-describedby="caption-attachment-65845" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/Hardcoded_service_names.png"><img loading="lazy" class="size-large wp-image-65845" src="https://news.sophos.com/wp-content/uploads/2020/04/Hardcoded_service_names.png?w=640" alt="" width="640" height="274" srcset="https://news.sophos.com/wp-content/uploads/2020/04/Hardcoded_service_names.png 954w, https://news.sophos.com/wp-content/uploads/2020/04/Hardcoded_service_names.png?resize=300,128 300w, https://news.sophos.com/wp-content/uploads/2020/04/Hardcoded_service_names.png?resize=768,328 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65845" class="wp-caption-text">Hardcoded service names being checked against running services</figcaption></figure>
<p>The services that the malware tries to stop include anti-virus software (to avoid detection) and backup solution services. (Sophos is not affected by this attempt.) Other services are stopped because they might lock files on the disk, and might make it more difficult for the ransomware to easily acquire handles to files—stopping them improves LockBit&#8217;s effectiveness.</p>
<p>Some of the services of note that the ransomware attempts to stop, in the order they are coded into the ransomware, are:</p>
<table>
<tbody>
<tr>
<td width="210">DefWatch</td>
<td width="324">Symantec Defwatch</td>
</tr>
<tr>
<td width="210">ccEvtMgr</td>
<td width="324">Norton AntiVirus Event Manager Service</td>
</tr>
<tr>
<td width="210">ccSetMgr</td>
<td width="324">Symantec Common Client Settings Manager Service</td>
</tr>
<tr>
<td width="210">SavRoam</td>
<td width="324">Symantec AntiVirus suite</td>
</tr>
<tr>
<td width="210">RTVscan</td>
<td width="324">Symantec AntiVirus</td>
</tr>
<tr>
<td width="210">QBFCService</td>
<td width="324">QuickBooks is an accounting software</td>
</tr>
<tr>
<td width="210">QBIDPService</td>
<td width="324">QuickBooks for Windows by Intuit, Inc..</td>
</tr>
<tr>
<td width="210">Intuit.QuickBooks.FCS</td>
<td width="324">QuickBooks for Windows by Intuit, Inc..</td>
</tr>
<tr>
<td width="210">QBCFMonitorService</td>
<td width="324">QuickBooks for Windows by Intuit, Inc..</td>
</tr>
<tr>
<td width="210">YooBackup</td>
<td width="324">Wooxo Backup</td>
</tr>
<tr>
<td width="210">YooIT</td>
<td width="324">Wooxo Backup</td>
</tr>
<tr>
<td width="210">zhudongfangyu</td>
<td width="324">360 by Qihoo 360 Deep Scan</td>
</tr>
<tr>
<td width="210">sophos</td>
<td width="324">Sophos</td>
</tr>
<tr>
<td width="210">stc_raw_agent</td>
<td width="324">STC Raw Backup Agent</td>
</tr>
<tr>
<td width="210">VSNAPVSS</td>
<td width="324">StorageCraft Volume Snapshot VSS Provider</td>
</tr>
<tr>
<td width="210">VeeamTransportSvc</td>
<td width="324">Veeam Backup Transport Service</td>
</tr>
<tr>
<td width="210">VeeamDeploymentService</td>
<td width="324">Veeam Deployment Service</td>
</tr>
<tr>
<td width="210">VeeamNFSSvc</td>
<td width="324">Veeam Backup and Replication Service</td>
</tr>
<tr>
<td width="210">veeam</td>
<td width="324">Veeam</td>
</tr>
<tr>
<td width="210">PDVFSService</td>
<td width="324">Veritas Backup Exec PureDisk Filesystem</td>
</tr>
<tr>
<td width="210">BackupExecVSSProvider</td>
<td width="324">Veritas Backup Exec VSS Provider</td>
</tr>
<tr>
<td width="210">BackupExecAgentAccelerator</td>
<td width="324">Veritas Backup Exec Agent Accelerator</td>
</tr>
<tr>
<td width="210">BackupExecAgentBrowser</td>
<td width="324">Veritas Backup Exec Agent Browser</td>
</tr>
<tr>
<td width="210">BackupExecDiveciMediaService</td>
<td width="324">Veritas Backup Exec Media Service</td>
</tr>
<tr>
<td width="210">BackupExecJobEngine</td>
<td width="324">Veritas Backup Exec Job Engine</td>
</tr>
<tr>
<td width="210">BackupExecManagementService</td>
<td width="324">Veritas Backup Exec Management Service</td>
</tr>
<tr>
<td width="210">BackupExecRPCService</td>
<td width="324">Veritas Backup Exec RPC Service</td>
</tr>
<tr>
<td width="210">AcrSch2Svc</td>
<td width="324">Acronis Scheduler Service</td>
</tr>
<tr>
<td width="210">AcronisAgent</td>
<td width="324">Acronis Agent</td>
</tr>
<tr>
<td width="210">CASAD2DWebSvc</td>
<td width="324">Arcserve UDP Agent service</td>
</tr>
<tr>
<td width="210">CAARCUpdateSvc</td>
<td width="324">Arcserve UDP Update service</td>
</tr>
</tbody>
</table>
<h3></h3>
<p>In addition to the list of services to kill, LockBit also carries a list of things not to encrypt, including certain folders, specific files and files with certain extensions that are important to the operating system—since disabling the operating system would make it difficult for the victim to receive and act upon the ransom note. These are stored in obfuscated lists within the code (shown below), A function within LockBit uses the <strong>FindFirstFileExW</strong> and <strong>FindNextFileW</strong> API calls to read through the file names and folder names on the targeted disk, and then a simple <strong>lstrcmpiW</strong> function is called to compare the hardcoded list with those names.</p>
<p class="jetpack-slideshow-noscript robots-nocontent">This slideshow requires JavaScript.</p><div id="gallery-65814-1-slideshow" class="slideshow-window jetpack-slideshow slideshow-black" data-trans="fade" data-autostart="1" data-gallery="[{&quot;src&quot;:&quot;https:\/\/news.sophos.com\/wp-content\/uploads\/2020\/04\/hardcoded_skip-list-1.png?w=402&quot;,&quot;id&quot;:&quot;65848&quot;,&quot;title&quot;:&quot;hardcoded_skip-list-1&quot;,&quot;alt&quot;:&quot;&quot;,&quot;caption&quot;:&quot;Lockbit ransomware omite el cifrado de ciertas carpetas para mayor eficiencia&quot;,&quot;itemprop&quot;:&quot;image&quot;},{&quot;src&quot;:&quot;https:\/\/news.sophos.com\/wp-content\/uploads\/2020\/04\/hardcoded_skip-list.png?w=429&quot;,&quot;id&quot;:&quot;65849&quot;,&quot;title&quot;:&quot;hardcoded_skip-list&quot;,&quot;alt&quot;:&quot;&quot;,&quot;caption&quot;:&quot;Hardcoded skip-list of file extensions&quot;,&quot;itemprop&quot;:&quot;image&quot;}]" itemscope itemtype="https://schema.org/ImageGallery"></div>
<h3>Accelerating file encryption</h3>
<p>Recently, we have seen ransomware groups taking more advanced concepts and applying it to their craft. One of these advanced concepts applied in LockBit is the use of <strong>Input/Output Completion Ports </strong>(<strong>IOCPs</strong>).</p>
<p>IOCPs are a model for creating a queue to efficient threads to process multiple asynchronous I/O requests. They allow processes to handle many concurrent asynchronous I/O more quickly and efficiently without having to create new threads each time they get an I/O request.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-port-op.jpg"><img loading="lazy" class="alignnone wp-image-66053 size-large" src="https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-port-op.jpg?w=640" alt="" width="640" height="574" srcset="https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-port-op.jpg 671w, https://news.sophos.com/wp-content/uploads/2020/04/SophosLabs-LockBit-port-op.jpg?resize=300,269 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>That capability makes them well-suited to ransomware. The sole purpose of ransomware is to encrypt as many delicate files as possible, rendering the user’s data useless. <strong>REvil</strong> (<strong>Sodinokibi</strong>) ransomware also uses IOCPs to achieve higher encryption performance.</p>
<p>LockBit’s aim was to be much faster than any other multi-threaded locker. The group behind the ransomware claims to have used the following methods to boost the performance of their file encryption:</p>
<ul>
<li><em>Open files with the FILE_FLAG_NO_BUFFERING flag, write by sector size</em></li>
<li><em>Transfer work with files to Native API</em></li>
<li><em>Use asynchronous file I/O</em></li>
<li><em>Use I/O port completion</em></li>
<li><em>Pass control to the kernel yourself, google KiFastSystemCall</em></li>
</ul>
<p>Once a file is marked for encryption—meaning, it did not match entries on the skip-list—a LockBit routine checks whether the file already has a <strong>.lockbit</strong> extension. If it does not, it encrypts the file and appends the .lockbit extension to the end of the filename.</p>
<p>Lockbit relies on <strong>LoadLibraryA</strong> and <strong>GetProcAddress</strong> to load <strong>bcrypt.dll</strong> and import the <strong>BCryptGenRandom</strong> function. If the malware successfully imports that DLL, it uses <strong>BCRYPT_USE_SYSTEM_PREFERRED_RNG</strong> which means <em>use the system-preferred random number generator algorithm</em>. If the malware was unsuccessful calling bcrypt.dll, it invokes <strong>CryptAcquireContextW</strong> and<strong> CryptGenRandom</strong> to invoke the Microsoft Base Cryptographic Provider v1.0 and generates 32 bytes of random data to use as a seed.</p>
<figure id="attachment_65869" aria-describedby="caption-attachment-65869" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/BCryptGenRandom_in_use.png"><img loading="lazy" class="wp-image-65869 size-large" src="https://news.sophos.com/wp-content/uploads/2020/04/BCryptGenRandom_in_use.png?w=640" alt="" width="640" height="364" srcset="https://news.sophos.com/wp-content/uploads/2020/04/BCryptGenRandom_in_use.png 843w, https://news.sophos.com/wp-content/uploads/2020/04/BCryptGenRandom_in_use.png?resize=300,170 300w, https://news.sophos.com/wp-content/uploads/2020/04/BCryptGenRandom_in_use.png?resize=768,436 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65869" class="wp-caption-text">BCryptGenRandom in use</figcaption></figure>
<p>Also, at this stage, the hardcoded ransom note, <strong>Restore-My-Files.txt</strong>, gets de-obfuscated and the ransomware drops the .txt file in every directory that contains at least one encrypted file.</p>
<h3>Victim ID</h3>
<p>LockBit creates 2 registry keys with key blobs as values under the following registry hive: <strong>HKEY_CURRENT_USER\Software\LockBit</strong></p>
<p>The two registry keys are:</p>
<p><strong>LockBit\full<br />
LockBit\Public</strong></p>
<p>These registry keys correlate with the Victim ID, file markers, and the unique TOR URL ID that LockBit builds for each system it takes down.</p>
<p>Let’s take the unique TOR URL from the ransom note:</p>
<figure id="attachment_65874" aria-describedby="caption-attachment-65874" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/tor-ransom-note.png"><img loading="lazy" class="size-large wp-image-65874" src="https://news.sophos.com/wp-content/uploads/2020/04/tor-ransom-note.png?w=640" alt="" width="640" height="111" srcset="https://news.sophos.com/wp-content/uploads/2020/04/tor-ransom-note.png 779w, https://news.sophos.com/wp-content/uploads/2020/04/tor-ransom-note.png?resize=300,52 300w, https://news.sophos.com/wp-content/uploads/2020/04/tor-ransom-note.png?resize=768,133 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65874" class="wp-caption-text">LockBit ransom note</figcaption></figure>
<p>In this example, the 16 byte long unique ID is at the end of the URL, http://lockbitks2tvnmwk[.]onion/?A0C155001DD0CB01AE0692717A2DB14A :</p>
<ul>
<li>The first 8 bytes used here (A0C155001DD0CB01)is the first 8 bytes of the file marker that is present in every encrypted file’s end .
<p><figure id="attachment_65875" aria-describedby="caption-attachment-65875" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/filemarkeratendofencryptedfile.png"><img loading="lazy" class="size-large wp-image-65875" src="https://news.sophos.com/wp-content/uploads/2020/04/filemarkeratendofencryptedfile.png?w=640" alt="" width="640" height="39" srcset="https://news.sophos.com/wp-content/uploads/2020/04/filemarkeratendofencryptedfile.png 827w, https://news.sophos.com/wp-content/uploads/2020/04/filemarkeratendofencryptedfile.png?resize=300,18 300w, https://news.sophos.com/wp-content/uploads/2020/04/filemarkeratendofencryptedfile.png?resize=768,46 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65875" class="wp-caption-text">File marker at end of encrypted file.</figcaption></figure></li>
<li>The last 8 bytes (AE0692717A2DB14A) is the first 8 bytes of the Public registry key.</li>
</ul>
<p>The file marker (0x10 long) is divided into 2 sections:</p>
<p>A0C155001DD0CB01</p>
<p>The first 8 bytes of the file marker and the first 8 bytes of the TOR unique URL ID.</p>
<p>D4EA7A79A0835006</p>
<p>The second 8 bytes are same for all encrypted files in a given run</p>
<p>Also, the value of the <strong>full</strong> registry key (0x500 long, starting as 1A443C7179498278B40DC082FCF8DE26… in this example) is also present in every encrypted file, just before the file marker.</p>
<figure id="attachment_65876" aria-describedby="caption-attachment-65876" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/lockBit-registry-keys-full-and-public.png"><img loading="lazy" class="size-large wp-image-65876" src="https://news.sophos.com/wp-content/uploads/2020/04/lockBit-registry-keys-full-and-public.png?w=640" alt="" width="640" height="310" srcset="https://news.sophos.com/wp-content/uploads/2020/04/lockBit-registry-keys-full-and-public.png 664w, https://news.sophos.com/wp-content/uploads/2020/04/lockBit-registry-keys-full-and-public.png?resize=300,145 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65876" class="wp-caption-text">LockBit registry keys (full and Public) that are related to the victim machine.</figcaption></figure>
<h3>Share enumeration</h3>
<p>For a successful ransomware hit and run, the goal is to encrypt as many files as possible. So naturally, LockBit scans for network shares and other attached drives with the help of the following API calls.</p>
<p>First, the malware enumerates the available drive letters with a call to <strong>GetLogicalDrives</strong>, then it cycles through the found drives and uses a call to <strong>GetDriveTypeW </strong>to determine whether the drive letters it finds are network shares by comparing the result with 0x4 (<em>DRIVE_REMOTE</em>).</p>
<p>Once it finds a networked drive, it calls <strong>WNetGetConnectionW</strong> to get the name of the share, then recursively enumerates all the folders and files on the share using the <strong>WNetOpenEnumW</strong>, <strong>WNetEnumResourceW</strong> API calls.</p>
<p>The ransomware can also enter network shares that might require user credentials. LockBit uses the <strong>WNetAddConnection2W</strong> API call with parameters <em>lpUserName</em> = 0 and <em>lpPassword</em> = 0, which (counterintuitively) transmits the username and password of the current, logged in user to connect to the given share. Then it can enumerate the share using the <strong>NetShareEnum</strong> API call.</p>
<figure id="attachment_65879" aria-describedby="caption-attachment-65879" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/enumeration-of-attached-drives.png"><img loading="lazy" class="size-large wp-image-65879" src="https://news.sophos.com/wp-content/uploads/2020/04/enumeration-of-attached-drives.png?w=640" alt="" width="640" height="378" srcset="https://news.sophos.com/wp-content/uploads/2020/04/enumeration-of-attached-drives.png 827w, https://news.sophos.com/wp-content/uploads/2020/04/enumeration-of-attached-drives.png?resize=300,177 300w, https://news.sophos.com/wp-content/uploads/2020/04/enumeration-of-attached-drives.png?resize=768,454 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65879" class="wp-caption-text">Enumeration of attached, remote drives</figcaption></figure>
<h3>Don’t quit just yet</h3>
<p>I an attempt to ensure that LockBit would not be kept from finishing its job by a system shutdown, the developers of this ransomware implemented a small routine that uses a call to <strong>ShutdownBlockReasonCreate</strong>.</p>
<p>The developers didn&#8217;t try to conceal the ransomware as the cause of the shutdown block: the ransomware sets the message for blocking shutdown as <strong>LockBit Ransom.</strong> Computer users would also see the message LockBit Ransom under the process’ name.</p>
<p><strong>SetProcessShutdownParameters</strong> is also called to set the shutdown order level of the ransomware’s process to 0, the lowest level, so that the ransomware’s parent process will be active as long as it can, before a shutdown terminates the process.</p>
<p>If the system is shut down, the malware also has capability to persist after a reboot. LockBit creates a registry key to restart itself under HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\, called <strong>XO1XADpO01</strong>.</p>
<figure id="attachment_65880" aria-describedby="caption-attachment-65880" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/placing-a-persistence-Run-key.png"><img loading="lazy" class="size-large wp-image-65880" src="https://news.sophos.com/wp-content/uploads/2020/04/placing-a-persistence-Run-key.png?w=640" alt="" width="640" height="133" srcset="https://news.sophos.com/wp-content/uploads/2020/04/placing-a-persistence-Run-key.png 879w, https://news.sophos.com/wp-content/uploads/2020/04/placing-a-persistence-Run-key.png?resize=300,62 300w, https://news.sophos.com/wp-content/uploads/2020/04/placing-a-persistence-Run-key.png?resize=768,160 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65880" class="wp-caption-text">Placing a persistence Run key in registry</figcaption></figure>
<h3>Stop me if you&#8217;ve heard this before</h3>
<p>LockBit prevents multiple ransomware instances on a single system by way of a hardcoded mutex: Global\<strong style="font-size: 1em">{BEF590BE-11A6-442A-A85B-656C1081E04C}. </strong><span style="font-size: 1em">Before LockBit starts encrypting, the ransomware checks that the mutex does not already exist by calling </span><strong style="font-size: 1em">OpenMutexA<em>,</em></strong><span style="font-size: 1em"> and calls </span><strong style="font-size: 1em">ExitProcess</strong> if it does<span style="font-size: 1em">.</span></p>
<p>As soon as the ransomware is mapped into memory and the encryption process finishes, the sample will execute the following command to maintain a stealthy operation:</p>
<ul>
<li><strong>exe /C ping 1.1.1.1 -n 22 &gt; Nul &amp; \&#8221;%s\&#8221;</strong> <em>(earlier version of LockBit)</em></li>
<li><strong>exe /C ping 127.0.0.7 -n 3 &gt; Nul &amp; fsutil file setZeroData offset=0 length=524288 &#8220;%s&#8221; &amp; Del /f /q &#8220;%s&#8221;</strong> <em>(recent version of LockBit)</em></li>
</ul>
<p>The ping command at the front is used because the sample can’t delete itself, due to the fact that it is locked. Once <em>ping</em> terminates, the command can delete the executable.</p>
<p>We clearly see an evolution to the applied technique here: in the earlier versions, the sample was missing a <strong>Del</strong> procedure at the end, so the ransomware would not delete itself.</p>
<p>In the recent version, the crooks had decided to use <strong>fsutil</strong> to basically zero out the initial binary to perhaps throw off forensic analysis efforts. After the file is zeroed out, the now null-file is deleted also, making double-sure the malware is not forensically recoverable.</p>
<h3>Language matters</h3>
<p>As we noted earlier, LockBit&#8217;s developers wanted to avoid having their ransomware hit victims in Commonwealth of Independent States (CIS) countries. The mechanism used by the ransomware to achieve this calls <strong>GetUserDefaultLangID</strong> and looks for specific language identifier constants in the region format setting for the current user. If the current user’s language setting matches any of the values below, the ransomware exits and does not start the encryption routine.</p>
<figure id="attachment_65881" aria-describedby="caption-attachment-65881" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/Set-of-UserDefaulLangIDs-to-avoid.png"><img loading="lazy" class="size-large wp-image-65881" src="https://news.sophos.com/wp-content/uploads/2020/04/Set-of-UserDefaulLangIDs-to-avoid.png?w=640" alt="" width="640" height="353" srcset="https://news.sophos.com/wp-content/uploads/2020/04/Set-of-UserDefaulLangIDs-to-avoid.png 725w, https://news.sophos.com/wp-content/uploads/2020/04/Set-of-UserDefaulLangIDs-to-avoid.png?resize=300,166 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65881" class="wp-caption-text">If your computer&#8217;s <strong>UserDefaultLangId</strong> is set to one of these values, LockBit does no damage</figcaption></figure>
<h3>Changing the wallpaper</h3>
<p>To get the affected user’s attention, the malware (as is typical) creates and displays a ransom note wallpaper. A set of API calls are involved in this process, listed below.</p>
<p>The created wallpaper gets stored under <em>%APPDATA%\Local\Temp\A7D8.tmp.bmp</em>.</p>
<p>In the meantime, the malware also sets a few registry keys so that the wallpaper is not tiled, and the image is stretched out to fill the screen:</p>
<p>HKEY_CURRENT_USER\Control Panel\<strong>Desktop</strong></p>
<ul>
<li><strong>TileWallpaper</strong>=0 &#8211; (No tile)</li>
<li><strong>WallpaperStyle</strong>=2 &#8211; (Stretch and fill)</li>
</ul>
<figure id="attachment_65882" aria-describedby="caption-attachment-65882" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/wallpaper-.png"><img loading="lazy" class="size-large wp-image-65882" src="https://news.sophos.com/wp-content/uploads/2020/04/wallpaper-.png?w=640" alt="" width="640" height="52" srcset="https://news.sophos.com/wp-content/uploads/2020/04/wallpaper-.png 820w, https://news.sophos.com/wp-content/uploads/2020/04/wallpaper-.png?resize=300,24 300w, https://news.sophos.com/wp-content/uploads/2020/04/wallpaper-.png?resize=768,62 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65882" class="wp-caption-text">Wallpaper used by a previous version of LockBit</figcaption></figure>
<figure id="attachment_65883" aria-describedby="caption-attachment-65883" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/new-lockbit-wallpaper.png"><img loading="lazy" class="size-large wp-image-65883" src="https://news.sophos.com/wp-content/uploads/2020/04/new-lockbit-wallpaper.png?w=640" alt="" width="640" height="100" srcset="https://news.sophos.com/wp-content/uploads/2020/04/new-lockbit-wallpaper.png 770w, https://news.sophos.com/wp-content/uploads/2020/04/new-lockbit-wallpaper.png?resize=300,47 300w, https://news.sophos.com/wp-content/uploads/2020/04/new-lockbit-wallpaper.png?resize=768,120 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-65883" class="wp-caption-text">Wallpaper set by a recent version of LockBit</figcaption></figure>
<h3>Stack Exchange for crooks</h3>
<p>LockBit leverages a very similar service-list to MedusaLocker ransomware. It comes as no surprise that crooks copy these lists, so they don’t have to reinvent the wheel.</p>
<p>The unique Registry run key and ransom note filename that was written by LockBit—<strong>XO1XADpO01</strong> and <strong>Restore-My-Files.txt</strong> — were also seen being used by Phobos, <a href="https://twitter.com/malwrhunterteam/status/1187781545328807937">and by a Phobos imposter ransomware</a>. This would suggest that there is a connection between these families, but without further evidence that is hard to justify.<a href="https://news.sophos.com/wp-content/uploads/2020/04/malwarehunterteamtweet.png"><img loading="lazy" class="size-large wp-image-65884 alignnone" src="https://news.sophos.com/wp-content/uploads/2020/04/malwarehunterteamtweet.png?w=639" alt="" width="639" height="341" srcset="https://news.sophos.com/wp-content/uploads/2020/04/malwarehunterteamtweet.png 639w, https://news.sophos.com/wp-content/uploads/2020/04/malwarehunterteamtweet.png?resize=300,160 300w" sizes="(max-width: 639px) 100vw, 639px" /></a></p>
<h3>The future for LockBit</h3>
<p>A recent Twitter post demonstrates what the future looks like for LockBit. In a recent LockBit attack, the MBR was overwritten with roughly 2000 bytes; The infected machine would not boot up unless a password is supplied. The hash of this sample is currently not known.</p>
<figure id="attachment_65887" aria-describedby="caption-attachment-65887" style="width: 625px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/04/spacetraintweet.png"><img loading="lazy" class="wp-image-65887 size-large" src="https://news.sophos.com/wp-content/uploads/2020/04/spacetraintweet.png?w=625" alt="" width="625" height="683" srcset="https://news.sophos.com/wp-content/uploads/2020/04/spacetraintweet.png 625w, https://news.sophos.com/wp-content/uploads/2020/04/spacetraintweet.png?resize=275,300 275w" sizes="(max-width: 625px) 100vw, 625px" /></a><figcaption id="caption-attachment-65887" class="wp-caption-text">https://twitter.com/spacetrain31/status/1232296412378955776</figcaption></figure>
<p>The e-mail used for extortion <a href="mailto:ondrugs@firemail.cc">ondrugs@firemail.cc</a> was also seen with STOP ransomware—an uncanny connection. The group behind might be related.</p>
<p>There is also speculation that application Diskcryptor was combined with the ransomware to add this extra lockdown layer. The MAMBA ransomware was also using this technique, leveraging Diskcryptor to lock the victim machine. DiskCryptor is currently being detected as <strong>AppC/DCrpt-Gen</strong> by Sophos Anti-Virus.</p>
<p>A list of the indicators of compromise (IoCs) for this post have been published to <a href="https://github.com/sophoslabs/IoCs/blob/master/Ransomware-LockBit" target="_blank" rel="noopener noreferrer">the SophosLabs Github</a>.</p>
<h2>Acknowledgments</h2>
<h2>The author would like to acknowledge the public contributions of <a href="https://twitter.com/demonslay335">@demonslay335</a> and <a href="https://twitter.com/hfiref0x">@hfiref0x</a>.</h2>
<h2></h2>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/04/22/following-the-sextortion-money/" rel="prev">Following the money in a massive &quot;sextortion&quot; spam scheme</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/04/24/protecting-the-cloud-securing-windows-virtual-desktop/" rel="next">Protecting the Cloud: Securing Windows Virtual Desktop</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="145" src="https://news.sophos.com/wp-content/uploads/2019/08/albi.jpg?w=145" class="avatar avatar-145 photo wp-post-image" alt="Albert Zsigovits" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/albert-zsigovits/" title="Posts by Albert Zsigovits" class="author url fn" rel="author">Albert Zsigovits</a></h3>

					
					<div class="author-bio">
						<p>Albert works as a Threat Researcher at Sophos.</p>
<p>He joins us from a traditional blue team background, kickstarting his cyber career analyzing security events as an IDS analyst, and later investigating breaches as an incident responder for a Fortune 50 company.</p>
<p>His specialities include threat hunting, memory forensics and signature development. In his spare-time he enjoys reverse engineering malware and diving deep into deep-web territories, connecting the dots between criminals leveraging threat intelligence and open source intelligence techniques.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>6</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-183546" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-29T10:55-04:00" itemprop="datePublished"><a href="#comment-183546" itemprop="url">29 April 2020 at 10:55 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>good article. Finally there is any possibility to find out the encryption key and then decrypt the files ?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/?replytocom=183546#respond' data-commentid="183546" data-postid="65814" data-belowelement="comment-183546" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-183846" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sophos.com" itemprop="author">Anonymous</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-05-01T13:03-04:00" itemprop="datePublished"><a href="#comment-183846" itemprop="url">01 May 2020 at 1:03 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Can you expound on the portion of the malware that is responsible for uploading the user&#8217;s data to the attacker or is it simply an empty threat at the end of their .txt instructions file?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/?replytocom=183846#respond' data-commentid="183846" data-postid="65814" data-belowelement="comment-183846" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm even depth-2  bystaff" id="comment-184363" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-05-04T10:08-04:00" itemprop="datePublished"><a href="#comment-184363" itemprop="url">04 May 2020 at 10:08 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>We haven&#8217;t observed any exfiltration of data as of yet</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/?replytocom=184363#respond' data-commentid="184363" data-postid="65814" data-belowelement="comment-184363" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-even depth-1  " id="comment-189665" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-06-04T15:54-04:00" itemprop="datePublished"><a href="#comment-189665" itemprop="url">04 June 2020 at 3:54 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Is there a possibility to send lockbit-Testfile or more (lockbit-regkeys) to sophos für investigation and maybe decryption acceleration?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/?replytocom=189665#respond' data-commentid="189665" data-postid="65814" data-belowelement="comment-189665" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-190097" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													S Webb											</h2>
					<time class="comment-meta-item" datetime="2020-06-08T20:38-04:00" itemprop="datePublished"><a href="#comment-190097" itemprop="url">08 June 2020 at 8:38 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Can the hash of the sample(s) analyzed in this write-up be shared?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/?replytocom=190097#respond' data-commentid="190097" data-postid="65814" data-belowelement="comment-190097" data-respondelement="respond" data-replyto="Reply to S Webb" aria-label='Reply to S Webb'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-201344" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													nassermahmood											</h2>
					<time class="comment-meta-item" datetime="2020-08-11T14:25-04:00" itemprop="datePublished"><a href="#comment-201344" itemprop="url">11 August 2020 at 2:25 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>is there any tool to kill lockbit ? easus recovery tool dos not work correctly with restoring video files &#8230; only some of them i have restored yet &#8230;.thanks</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/?replytocom=201344#respond' data-commentid="201344" data-postid="65814" data-belowelement="comment-201344" data-respondelement="respond" data-replyto="Reply to nassermahmood" aria-label='Reply to nassermahmood'>Reply</a>				</div>
			</div>

	</article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='65814' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="6677c7dbf2" /></p><input type="hidden" id="ak_js" name="ak_js" value="208"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/wp-content/mu-plugins/jetpack-9.5/modules/shortcodes/css/slideshow-shortcode.css?m=1614194692g' type='text/css' media='all' />
<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script id='jetpack-slideshow-js-extra'>
var jetpackSlideshowSettings = {"spinner":"https:\/\/news.sophos.com\/wp-content\/mu-plugins\/jetpack-9.5\/modules\/shortcodes\/img\/slideshow-loader.gif","speed":"4000","label_prev":"Previous Slide","label_stop":"Pause Slideshow","label_next":"Next Slide"};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkFtuwyAQRTdUwLbyUD6qLqUieGpjMwxhIK53XyI3UVVVapD4gMu5hxFqCcKQT+CTSiMgsGIKI7GHhUXXtEc1cVkFotmCuHayk20J5BbIiV/UUw5DsYKGzxQ1P89vkczJuvqW0Ri0HXx1MeiYPMTq3qCrK7fsXrLeuNwDb9+KWAQiQnCrROv/gsoR8Az9z/v7y5hFcHmwvpCQgjazOMm9Quqzu000UkyGvkXTJUNcpVmNgwrZexlGnbN1/S8fO1t2Iy3ikf+j1bNlhLQpPyhiYd/wtT20+92haU7N9AWdbQdG'></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'65814',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '65814' ]);
</script>
</body>
</html>
