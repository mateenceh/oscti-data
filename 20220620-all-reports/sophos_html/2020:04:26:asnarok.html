<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/04/26/asnarok/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>&#8220;Asnarök&#8221; Trojan targets firewalls &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; &#8220;Asnarök&#8221; Trojan targets firewalls Comments Feed" href="https://news.sophos.com/en-us/2020/04/26/asnarok/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1616171106' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqUUWAK9KIh0='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/66159" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/04/26/asnarok/" />
<link rel='shortlink' href='https://news.sophos.com/?p=66159' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F04%2F26%2Fasnarok%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F04%2F26%2Fasnarok%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/04/26/asnarok/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="&#8220;Asnarök&#8221; Trojan targets firewalls" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/04/26/asnarok/" />
<meta property="og:description" content="Customized malware used to compromise physical and virtual firewalls" />
<meta property="article:published_time" content="2020-04-27T01:26:19+00:00" />
<meta property="article:modified_time" content="2020-05-01T14:46:48+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="427" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="&#8220;Asnarök&#8221; Trojan targets firewalls" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-66159 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-66159" class="post-66159 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-asnarok tag-elf tag-firewall tag-malware tag-shell-script region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">&#8220;Asnarök&#8221; Trojan targets firewalls</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/asnarok/">Asnarok</a>&bull;<a href="https://news.sophos.com/en-us/tag/elf/">ELF</a>&bull;<a href="https://news.sophos.com/en-us/tag/firewall/">Firewall</a>&bull;<a href="https://news.sophos.com/en-us/tag/malware/">malware</a>&bull;<a href="https://news.sophos.com/en-us/tag/shell-script/">shell script</a>		</div>

					<div class="entry-excerpt">
				<p>Customized malware used to compromise physical and virtual firewalls</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/04/26/asnarok/" rel="bookmark">26 April 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				23			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=%26%238220%3BAsnar%C3%B6k%26%238221%3B%20Trojan%20targets%20firewalls%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D66159" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=66159&#038;title=&#8220;Asnarök&#8221;%20Trojan%20targets%20firewalls" data-title="&#8220;Asnarök&#8221; Trojan targets firewalls" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/04/26/asnarok/"
				data-title="&#8220;Asnarök&#8221; Trojan targets firewalls"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="427" src="https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg 960w, https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg?resize=300,200 300w, https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg?resize=768,512 768w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/sophos/" title="Posts by Sophos" class="author url fn" rel="author">Sophos</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p><em>Editor&#8217;s note (2020-04-30): As we learn more from our ongoing investigation, we will issue updates at the end of this article.</em></p>
<p>As we described last week in this <a href="https://community.sophos.com/kb/en-us/135412">KBA</a>, Sophos and its customers were the victims of a coordinated attack by an unknown adversary. This attack revealed a previously unknown SQL injection vulnerability that led to remote code execution on some of our firewall products. As described in the KBA, the vulnerability has since been remediated.</p>
<p>This post is the result of many hours of research and reverse-engineering by SophosLabs and Sophos internal security teams, working in conjunction with product management to coordinate a hotfix and global response within two days of discovering this attack. In the spirit of transparency, we want to describe the nature of the attack and a detailed analysis of the malware based on our investigation and current understanding.</p>
<p>There was significant orchestration involved in the execution of the attack, using a chain of Linux shell scripts that eventually downloaded ELF binary executable malware compiled for a firewall operating system. This attack targeted Sophos products and apparently was intended to steal sensitive information from the firewall.</p>
<h3>How the attack began</h3>
<p>The infection process started when an attacker discovered, and exploited, a zero-day SQL injection remote code execution vulnerability. The exploit of this vulnerability resulted in the attacker being able to insert a one-line command into a database table.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-66162" src="https://news.sophos.com/wp-content/uploads/2020/04/image1.png" alt="" width="640" height="43" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image1.png 967w, https://news.sophos.com/wp-content/uploads/2020/04/image1.png?resize=300,20 300w, https://news.sophos.com/wp-content/uploads/2020/04/image1.png?resize=768,52 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>This initial injected command triggered an affected device to download a Linux shell script named <strong>Install.sh</strong> from a remote server on the malicious domain <strong>sophosfirewallupdate[.]com</strong>. The command also wrote this shell script to the /tmp directory on the device, used the chmod program to designate the file as executable, and executed it.</p>
<p>The script (written to the appliance as <strong>x.sh</strong>) ran a series of SQL commands and dropped additional files into the virtual file system to lay the groundwork for the rest of the attack.</p>
<p>The Install.sh script, initially, ran a number of Postgres SQL commands to modify or zero out the values of certain tables in the database, one of which normally displays the administrative IP address of the device itself. It appears that this was an attempt to conceal the attack, but it backfired: On some appliances, the shell script&#8217;s activity resulted in the attacker&#8217;s own injected SQL command line being displayed on the user interface of the firewall&#8217;s administrative panel. In place of what should have been an address, it showed a line of shell commands.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/image2.png"><img loading="lazy" class="alignnone size-full wp-image-66163" src="https://news.sophos.com/wp-content/uploads/2020/04/image2.png" alt="" width="640" height="198" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image2.png 1082w, https://news.sophos.com/wp-content/uploads/2020/04/image2.png?resize=300,93 300w, https://news.sophos.com/wp-content/uploads/2020/04/image2.png?resize=768,238 768w, https://news.sophos.com/wp-content/uploads/2020/04/image2.png?resize=1024,317 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>This script also dropped at least two other shell scripts into the /tmp directory, and modified at least one shell script that is part of the firewall&#8217;s operating system to add a set of commands to the end of the script. This last script, in particular, is relevant because the malware modified services to ensure it ran every time the firewall booted up; it served as a roundabout persistence mechanism for the malware.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg"><img loading="lazy" class="alignnone size-full wp-image-66190" src="https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg" alt="" width="640" height="717" srcset="https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg 3146w, https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg?resize=268,300 268w, https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg?resize=768,861 768w, https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg?resize=914,1024 914w, https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg?resize=1371,1536 1371w, https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg?resize=1828,2048 1828w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h3>The three shell ELF game</h3>
<p>The installer script, x.sh, dropped two completely new shell scripts, and modified an existing script that is part of the operating system.</p>
<p>One of the dropped shell scripts was named <strong>.lp.sh </strong>and its primary function was to connect to the malicious <em>sophosfirewallupdate</em> site, and download a Linux ELF executable file compiled to run on the firewall operating system named <strong>lp</strong>. The script wrote that downloaded file to /tmp with a filename of just <strong>b</strong>.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-66165" src="https://news.sophos.com/wp-content/uploads/2020/04/image4.png" alt="" width="554" height="294" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image4.png 554w, https://news.sophos.com/wp-content/uploads/2020/04/image4.png?resize=300,159 300w" sizes="(max-width: 554px) 100vw, 554px" /></p>
<p>The <em>b</em> program, when run, deleted itself from the filesystem of the device, so it was only present in memory. It appeared in the process list as a program whose name, <strong>cssconf.bin</strong>, is one character off from a legitimate process that normally runs on a firewall, <em>cscconf.bin</em>. The highlighted process list below shows the malicious program as it would have appeared running on an infected firewall. It is also notable that it listed its parent process ID as 1, which the legitimate <em>cscconf.bin</em> would never have done.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/image5.png"><img loading="lazy" class="alignnone size-full wp-image-66167" src="https://news.sophos.com/wp-content/uploads/2020/04/image5.png" alt="" width="640" height="163" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image5.png 975w, https://news.sophos.com/wp-content/uploads/2020/04/image5.png?resize=300,76 300w, https://news.sophos.com/wp-content/uploads/2020/04/image5.png?resize=768,195 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>While <em>b</em> was in memory, it repeated a series of tasks every 3 to 6 hours &#8212; a delay interval chosen at random the first time it ran, and reused thereafter.</p>
<p>First, <em>b</em> checked to see if it could make a connection to a machine with the IP address of <strong>43.229.55.44</strong>. If the ELF couldn&#8217;t make a connection to that IP address, it attempted to resolve the IP address for the malicious domain <strong>sophosproductupdate[.]com</strong>.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/image6.jpg"><img loading="lazy" class="alignnone size-full wp-image-66168" src="https://news.sophos.com/wp-content/uploads/2020/04/image6.jpg" alt="" width="640" height="501" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image6.jpg 716w, https://news.sophos.com/wp-content/uploads/2020/04/image6.jpg?resize=300,235 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>If it resolved the IP for that domain, and DNS <em>did not</em> return a value of 127.0.0.1 as a result, then it downloaded another Linux ELF executable called <em>Sophos.dat</em>, which we&#8217;ll discuss in the next section.</p>
<p>Shell script number two dropped by the <em>Install.sh/x.sh</em> script was written to the /tmp directory with a filename of <strong>.pg.sh. </strong>Its main purpose was to download a second, different ELF executable, which was called <strong>bk</strong> on the webserver and was written to the filesystem with the name <strong>.</strong><strong>post_MI.</strong></p>
<p>Earlier we mentioned that Install.sh, the first stage dropper, ran a number of Postgres SQL commands. One of these commands modified a specific service value entry so that .post_MI executed whenever that service executed; this provided persistence by starting the malware at every reboot.</p>
<p>This executable had limited functionality: It checked to see whether a file named <strong>.a.PGSQL</strong> (more on this in a minute) had been written to the /tmp directory, and if it didn&#8217;t find it, it attempted to download a shell script from the web server hosted at <strong>ragnarokfromasgard.com</strong>, called <em>patch.sh</em>. At the time we performed the analysis of the attack, this server wasn&#8217;t responding.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/image7.jpg"><img loading="lazy" class="alignnone size-full wp-image-66170" src="https://news.sophos.com/wp-content/uploads/2020/04/image7.jpg" alt="" width="640" height="194" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image7.jpg 955w, https://news.sophos.com/wp-content/uploads/2020/04/image7.jpg?resize=300,91 300w, https://news.sophos.com/wp-content/uploads/2020/04/image7.jpg?resize=768,233 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The third shell script is a modification of a shell script that is already part of the firewall&#8217;s internal operating system, named <em>generate_curl_ca_bundle.sh</em>. The <em>Install.sh/x.sh</em> script made a backup copy of the original (prepending a dot to the filename, <strong>.generate_curl_ca_bundle.sh</strong>) before it modified the original script to append code to the file. That code wrote out and dropped yet another shell script, <strong>/tmp/I</strong> (just a capital letter <em>i</em>).</p>
<p>The <em>I</em> script had two primary functions. First, it performed a &#8220;touch&#8221; of the <strong>/tmp/.a.PGSQL</strong> file (an act that, if the file did <em>not</em> exist, created it in the /tmp directory). The previously-mentioned <em><strong>.</strong>post_MI</em> ELF executable checked to see if .a.PGSQL existed as part of its execution.</p>
<p>The <em>I</em> script then retrieved a shell script file named <em>lc</em> from the <em>sophosfirewallupdate</em> domain, and wrote that to the /tmp directory as <strong>.n.sh </strong>and executed<span style="font-size: 1em"> it. This script replicated the same behavior as the .lp.sh script (mentioned above), and attempted to download and execute the </span><em style="font-size: 1em">b</em><span style="font-size: 1em"> ELF executable from the malicious <em>sophosfirewallupdate</em> website. This download of </span><em style="font-size: 1em">b</em><span style="font-size: 1em"> was the persistence mechanism, given that the </span><em style="font-size: 1em">b</em><span style="font-size: 1em"> process deleted itself off disk as one of its first actions.</span></p>
<h3>Data exfiltration process</h3>
<p>Note: This section describes our understanding of the data exfiltration capabilities of the malware at the time of publication of this article, but we have not discovered any evidence that the data collected had been successfully exfiltrated.</p>
<p>The steps involving the shell scripts and ELF binary executables apparently were done in order to bring the attack to the point where the malware downloaded and executed a file that had been named <em>Sophos.dat</em> on the remote server, saved to the filesystem as <strong>2own</strong>.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/image8.jpg"><img loading="lazy" class="alignnone size-full wp-image-66172" src="https://news.sophos.com/wp-content/uploads/2020/04/image8.jpg" alt="" width="640" height="294" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image8.jpg 955w, https://news.sophos.com/wp-content/uploads/2020/04/image8.jpg?resize=300,138 300w, https://news.sophos.com/wp-content/uploads/2020/04/image8.jpg?resize=768,353 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>This malware&#8217;s primary task appeared to be data theft, which it could perform by retrieving the contents of various database tables stored in the firewall, as well as by running some operating system commands. At each step, the malware collected information and then concatenated it to a file it stored temporarily on the firewall with the name <strong>Info.</strong><strong>xg.</strong></p>
<p>First, the binary attempted to retrieve the public-facing IP address where the firewall was installed. It did this first by querying the website <strong>ifconfig.me</strong>, and if that site was not reachable for some reason, it tried to do the same by contacting <strong>checkip.dyndns.org</strong>.</p>
<p>Next, it queried a number of data storage areas on the firewall to retrieve information about the firewall and its users.</p>
<p>This diagram below shows the capability of the malware to exfiltrate data.  As of the date of publication, we have not discovered any evidence that the data collected had been successfully exfiltrated.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/image9.jpeg"><img loading="lazy" class="alignnone size-full wp-image-66173" src="https://news.sophos.com/wp-content/uploads/2020/04/image9.jpeg" alt="" width="640" height="723" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image9.jpeg 1430w, https://news.sophos.com/wp-content/uploads/2020/04/image9.jpeg?resize=265,300 265w, https://news.sophos.com/wp-content/uploads/2020/04/image9.jpeg?resize=768,868 768w, https://news.sophos.com/wp-content/uploads/2020/04/image9.jpeg?resize=906,1024 906w, https://news.sophos.com/wp-content/uploads/2020/04/image9.jpeg?resize=1359,1536 1359w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The malware demonstrated the capability to retrieve only firewall resident information, which may have included:</p>
<ul>
<li>The firewall&#8217;s license and serial number</li>
<li>A list of the email addresses of user accounts that were stored on the device, followed by the primary email belonging to the firewall&#8217;s administrator account</li>
<li>Firewall users&#8217; names, usernames, the encrypted form of the passwords, and the salted SHA256 hash of the administrator account&#8217;s password. Passwords were not stored in plain text.</li>
<li>A list of the user IDs permitted to use the firewall for SSL VPN and accounts that were permitted to use a &#8220;clientless&#8221; VPN connection.</li>
</ul>
<p>The malware then queried an internal database of the firewall to retrieve a list of the IP address allocation permissions for the users of the firewall, as well as information about the appliance itself: What version of the operating system was running, what type of CPU and amount of memory was present on the device; how long it had been operational since the last reboot (the &#8216;uptime&#8217;); and the output of the ifconfig and ARP tables.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/image10.jpg"><img loading="lazy" class="alignnone size-full wp-image-66174" src="https://news.sophos.com/wp-content/uploads/2020/04/image10.jpg" alt="" width="640" height="168" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image10.jpg 973w, https://news.sophos.com/wp-content/uploads/2020/04/image10.jpg?resize=300,79 300w, https://news.sophos.com/wp-content/uploads/2020/04/image10.jpg?resize=768,202 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Once the malware wrote all this information to<em> Info.xg</em>, it then compressed it using the tar compression tool, and then used OpenSSL to encrypt the archive file. The attacker used the Triple-DES algorithm to encrypt the file, and for a pass phrase, the word &#8220;<strong>GUCCI</strong>&#8221; in all capital letters. The malware then intended to upload the encrypted file to a machine at the IP address <strong>38.27.99.69</strong>, and then cleaned up its tracks by deleting the files temporarily created while it collected the information.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-66175" src="https://news.sophos.com/wp-content/uploads/2020/04/image11.png" alt="" width="550" height="69" srcset="https://news.sophos.com/wp-content/uploads/2020/04/image11.png 550w, https://news.sophos.com/wp-content/uploads/2020/04/image11.png?resize=300,38 300w" sizes="(max-width: 550px) 100vw, 550px" /></p>
<h2>Remediation and response</h2>
<p>Files associated with this attack have been added to the definition <strong>Linux/Agnt-G</strong> and domains and IP addresses have been flagged as malicious in the SophosXL domain reputation service.</p>
<p>A hotfix update has already been released to Sophos customers to patch the vulnerability used by the attackers to access the firewalls. If you don&#8217;t have automatic updates enabled on the firewall, please <a href="https://community.sophos.com/kb/en-us/135415">follow these instructions</a> to enable them.</p>
<p>Since the attack was discovered, Sophos has taken a number of steps, which we can summarize as follows: SophosLabs blocked domains found in initial forensic analysis of the attack, and later identified and blocked additional domains and IP addresses associated with the attack. We notified customers about mitigation steps. We issued a telemetry update to firewalls; and we designed, developed, and tested a hotfix to mitigate the SQL injection and this attack, and then pushed the hotfix to supported devices. Sophos also has submitted a request for a CVE, and will add the CVE number to the knowledge base article once available. We have also taken additional actions that fall outside the scope of this article.</p>
<p>There are a few steps Sophos customers can take to harden their environments and remediate an affected firewall appliance. These steps are kept up to date and outlined in <a href="https://community.sophos.com/kb/en-us/135412">the Sophos knowledge base entry</a> on this issue.</p>
<h2>Updated information</h2>
<h4>2020-04-30:</h4>
<ul>
<li>We’ve since received a report that network activity to the 38[.]27[.]99[.]69 server was observed from multiple targeted firewalls during the attack. Again, we urge customers with impacted firewalls to reset passwords and to follow the remediation instructions contained in <a href="https://community.sophos.com/kb/en-us/135412" target="_blank" rel="noopener noreferrer">KBA135412</a>.</li>
<li>In addition to the SHA-256 form, an MD5 hash of the admin password was also stored on the firewall for the purposes of backward compatibility. A recently-issued hotfix to the firewall removed the additional hash.</li>
</ul>
<h2>Indicators of Compromise (IoCs)</h2>
<h2></h2>
<h3>File indicators</h3>
<table width="623">
<tbody>
<tr>
<td width="152"><strong>File Name</strong></td>
<td width="249"><strong>SHA256</strong></td>
<td width="102"><strong>FileType</strong></td>
<td width="119"><strong>Functionality</strong></td>
</tr>
<tr>
<td rowspan="2" width="152">Install.sh [/tmp/x.sh]</td>
<td rowspan="2" width="249">736da16da96222d3dfbb864376cafd58239344b536c75841805c661f220072e5</td>
<td width="102">Bash</td>
<td rowspan="2" width="119">Main install script. Compromised firewall settings, dropped two files and modified a third.</td>
</tr>
<tr>
<td width="102">Shell script</td>
</tr>
<tr>
<td rowspan="3" width="152">lc [/tmp/.n.sh]</td>
<td rowspan="3" width="249">a226c6a641291ef2916118b048d508554afe0966974c5ca241619e8a375b8c6b</td>
<td width="102">Bash</td>
<td rowspan="3" width="119">Downloaded lp (ELF dropper)</td>
</tr>
<tr>
<td width="102">Shell script</td>
</tr>
<tr>
<td width="102"></td>
</tr>
<tr>
<td rowspan="2" width="152">bk [/var/newdb/global/.post_MI]</td>
<td rowspan="2" width="249">4de3258ebba1ef3638642a011020a004b4cd4dbe8cd42613e24edf37e6cf9d71</td>
<td width="102">ELF</td>
<td rowspan="2" width="119">Downloaded patch.sh</td>
</tr>
<tr>
<td width="102">X86 binary</td>
</tr>
<tr>
<td rowspan="2" width="152">lp [/tmp/b]</td>
<td rowspan="2" width="249">9650563aa660ccbfd91c0efc2318cf98bfe9092b4a2abcd98c7fc44aad265fda</td>
<td width="102">ELF</td>
<td rowspan="2" width="119">Main dropper. Downloaded 2own (data exfiltration) module</td>
</tr>
<tr>
<td width="102">X86 binary</td>
</tr>
<tr>
<td rowspan="2" width="152">in.s_h</td>
<td rowspan="2" width="249">8e9965c2bb0964fde7c1aa0e8b5d74158e37443d857fc227c1883aa74858e985</td>
<td width="102">Bash</td>
<td rowspan="2" width="119">Slightly modified form of install.sh</td>
</tr>
<tr>
<td width="102">Shell script</td>
</tr>
<tr>
<td rowspan="2" width="152">2own</td>
<td rowspan="2" width="249">31e43ecd203860ba208c668a0e881a260ceb24cb1025262d42e03209aed77fe4</td>
<td width="102">ELF</td>
<td rowspan="2" width="119">Data theft module. Exfiltrates to 38.27.99.69</td>
</tr>
<tr>
<td width="102">X86 script</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3>Network indicators</h3>
<h4>URLs</h4>
<pre>hxxps://sophosfirewallupdate.com/sp/Install.sh
hxxp://sophosfirewallupdate.com/sh_guard/lc
hxxps://sophosfirewallupdate.com/bk
hxxps://sophosfirewallupdate.com/sp/lp
hxxps://ragnarokfromasgard.com/sp/patch.sh
hxxps://sophosfirewallupdate.com/sp/sophos.dat
hxxps://sophosfirewallupdate.com/in_exit
hxxps://sophosfirewallupdate.com/sp/lpin
hxxp://sophosfirewallupdate.com/bkin
hxxp://filedownloaderservers.com/bkin
hxxps://sophosfirewallupdate.com/sp/p.sh
hxxps://sophosfirewallupdate.com/sp/ae.sh</pre>
<h4>Domains</h4>
<pre>sophosfirewallupdate.com
filedownloaderservers.com
ragnarokfromasgard.com
sophosenterprisecenter.com
sophoswarehouse.com
sophosproductupdate.com
sophostraining.org</pre>
<h4>Additional suspicious domains</h4>
<pre>filedownloaderserverx.com
filedownloaderserver.com
updatefileservercross.com</pre>
<h3>IPs</h3>
<pre>43.229.55.44
38.27.99.69</pre>
<h3>Filesystem paths</h3>
<pre>/tmp/x.sh
/var/newdb/global/.post_MI
/scripts/vpn/ipsec/generate_curl_ca_bundle.sh (modified)
/scripts/vpn/ipsec/.generate_curl_ca_bundle.sh (original)
/tmp/I
/tmp/.a.PGSQL
/tmp/.n.sh
/tmp/.pg.sh
/tmp/.lp.sh
/tmp/b
/tmp/2own
/tmp/Info.xg
/tmp/%s_.xg.rel
/tmp/%s_.xg.salt
/tmp/ip (result of http://checkip.dyndns.org/ip_dyn)
/tmp/ip_dyn (result of https://ifconfig.me/ip)</pre>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/04/24/protecting-the-cloud-securing-windows-virtual-desktop/" rel="prev">Protecting the Cloud: Securing Windows Virtual Desktop</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/04/28/how-to-remove-unused-devices-from-sophos-central/" rel="next">How to remove unused devices from Sophos Central</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/sophos/" title="Posts by Sophos" class="author url fn" rel="author">Sophos</a></h3>

					
					<div class="author-bio">
											</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>23</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-183157" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://sophos.com" itemprop="author">Dhiren Velari</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T01:52-04:00" itemprop="datePublished"><a href="#comment-183157" itemprop="url">27 April 2020 at 1:52 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>This is a swift and comprehensive response. Great job!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183157#respond' data-commentid="183157" data-postid="66159" data-belowelement="comment-183157" data-respondelement="respond" data-replyto="Reply to Dhiren Velari" aria-label='Reply to Dhiren Velari'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-183184" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T05:18-04:00" itemprop="datePublished"><a href="#comment-183184" itemprop="url">27 April 2020 at 5:18 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Well Done!!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183184#respond' data-commentid="183184" data-postid="66159" data-belowelement="comment-183184" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-183196" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.cryptoconseil.com" itemprop="author">CEDRIC BELPAIRE</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T05:57-04:00" itemprop="datePublished"><a href="#comment-183196" itemprop="url">27 April 2020 at 5:57 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Hi,<br />
I have tested today the IP address 38.27.99.69 which seems to be online with ssh. So it&#8217;s possible to know which data were exfiltrated if there are always stored on this machine?<br />
Sophos will be able to decrypt this data and communicate exactly the kind of content.</p>
<p>I want to know if VPN preshared key were exfiltrated too?</p>
<p>I&#8217;m selling regularly Sophos Firewall to my customers and I&#8217;m realy in a bad position to explain them the kind of data exfiltrated.<br />
It&#8217;s not a good press for Sophos and my custumers are now afraid.<br />
When is the next zero day attack ?<br />
Best,</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183196#respond' data-commentid="183196" data-postid="66159" data-belowelement="comment-183196" data-respondelement="respond" data-replyto="Reply to CEDRIC BELPAIRE" aria-label='Reply to CEDRIC BELPAIRE'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-183227" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T09:28-04:00" itemprop="datePublished"><a href="#comment-183227" itemprop="url">27 April 2020 at 9:28 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Once of the best breakdowns I&#8217;ve read. Great work and thank you for acting as quickly as you did.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183227#respond' data-commentid="183227" data-postid="66159" data-belowelement="comment-183227" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-183235" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T10:34-04:00" itemprop="datePublished"><a href="#comment-183235" itemprop="url">27 April 2020 at 10:34 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Nice write up but it doesn&#8217;t have details of what the SQL injection vulnerability was. SQL injections are a known issue so I wonder why the OS didn&#8217;t filter this one out.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183235#respond' data-commentid="183235" data-postid="66159" data-belowelement="comment-183235" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-183237" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T10:50-04:00" itemprop="datePublished"><a href="#comment-183237" itemprop="url">27 April 2020 at 10:50 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Well done Guys</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183237#respond' data-commentid="183237" data-postid="66159" data-belowelement="comment-183237" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-183238" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T11:24-04:00" itemprop="datePublished"><a href="#comment-183238" itemprop="url">27 April 2020 at 11:24 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Cool analysis !</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183238#respond' data-commentid="183238" data-postid="66159" data-belowelement="comment-183238" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-183239" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/e769870127c1a027cb16e53ae5f92f88?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/e769870127c1a027cb16e53ae5f92f88?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anon											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T11:29-04:00" itemprop="datePublished"><a href="#comment-183239" itemprop="url">27 April 2020 at 11:29 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>What significance is the license key &#8211; except perhaps to exploit support access?  Was there any impact to support access in this attack?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183239#respond' data-commentid="183239" data-postid="66159" data-belowelement="comment-183239" data-respondelement="respond" data-replyto="Reply to Anon" aria-label='Reply to Anon'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment even depth-2  " id="comment-183241" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T11:41-04:00" itemprop="datePublished"><a href="#comment-183241" itemprop="url">27 April 2020 at 11:41 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Except perhaps the registration of new Sophos Central/CFM accounts by the attacker to attempt to achieve control of the device (highly unlikely), as that would have to happen from inside the Sophos ecosystem, would be extremely short-lived and there are several protections against that. That&#8217;s why that particular piece catches my eye.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183241#respond' data-commentid="183241" data-postid="66159" data-belowelement="comment-183241" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-even depth-1  " id="comment-183240" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/e769870127c1a027cb16e53ae5f92f88?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/e769870127c1a027cb16e53ae5f92f88?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Eric											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T11:32-04:00" itemprop="datePublished"><a href="#comment-183240" itemprop="url">27 April 2020 at 11:32 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183240#respond' data-commentid="183240" data-postid="66159" data-belowelement="comment-183240" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-183248" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T13:27-04:00" itemprop="datePublished"><a href="#comment-183248" itemprop="url">27 April 2020 at 1:27 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great job! or Well Done!!<br />
REALLY? That bug is a huge problem with XG Firewall credit !!!<br />
This clearly shows how bad the security concept of the whole XG Firewall is, which the developers could not handle such a trivial problem as checking the format of the data inserted into the login fields !!!<br />
There really is nothing to be proud of.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183248#respond' data-commentid="183248" data-postid="66159" data-belowelement="comment-183248" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-183261" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.kpj.com" itemprop="author">Tito</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T16:00-04:00" itemprop="datePublished"><a href="#comment-183261" itemprop="url">27 April 2020 at 4:00 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Sophos needs to do better job with this. This is firewall not some other product. I didn&#8217;t follow up, but if SFOS kernel is based on Linux kernel, we can see more of these type of attacs. Other vendors are utilizing BSD kernel</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183261#respond' data-commentid="183261" data-postid="66159" data-belowelement="comment-183261" data-respondelement="respond" data-replyto="Reply to Tito" aria-label='Reply to Tito'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-183268" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.firatmeray.com" itemprop="author">Fırat Meray</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T17:02-04:00" itemprop="datePublished"><a href="#comment-183268" itemprop="url">27 April 2020 at 5:02 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thank you for taking quick action.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183268#respond' data-commentid="183268" data-postid="66159" data-belowelement="comment-183268" data-respondelement="respond" data-replyto="Reply to Fırat Meray" aria-label='Reply to Fırat Meray'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-183269" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://tuendumconsulting.com" itemprop="author">info</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T17:11-04:00" itemprop="datePublished"><a href="#comment-183269" itemprop="url">27 April 2020 at 5:11 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Very Proud of Sophos Labs team!!! Amazig!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183269#respond' data-commentid="183269" data-postid="66159" data-belowelement="comment-183269" data-respondelement="respond" data-replyto="Reply to info" aria-label='Reply to info'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-183283" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/586bb3793b7bc80dd662d8e6c65cd00c?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/586bb3793b7bc80dd662d8e6c65cd00c?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Jan Peterson											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T19:07-04:00" itemprop="datePublished"><a href="#comment-183283" itemprop="url">27 April 2020 at 7:07 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great and detailed analysis.  Thank you.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183283#respond' data-commentid="183283" data-postid="66159" data-belowelement="comment-183283" data-respondelement="respond" data-replyto="Reply to Jan Peterson" aria-label='Reply to Jan Peterson'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-183300" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Soudaki Abderrahmane											</h2>
					<time class="comment-meta-item" datetime="2020-04-27T20:43-04:00" itemprop="datePublished"><a href="#comment-183300" itemprop="url">27 April 2020 at 8:43 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183300#respond' data-commentid="183300" data-postid="66159" data-belowelement="comment-183300" data-respondelement="respond" data-replyto="Reply to Soudaki Abderrahmane" aria-label='Reply to Soudaki Abderrahmane'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-183341" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Jabbie											</h2>
					<time class="comment-meta-item" datetime="2020-04-28T03:06-04:00" itemprop="datePublished"><a href="#comment-183341" itemprop="url">28 April 2020 at 3:06 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great Job Team SOPHOS</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183341#respond' data-commentid="183341" data-postid="66159" data-belowelement="comment-183341" data-respondelement="respond" data-replyto="Reply to Jabbie" aria-label='Reply to Jabbie'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-183366" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													2own											</h2>
					<time class="comment-meta-item" datetime="2020-04-28T06:05-04:00" itemprop="datePublished"><a href="#comment-183366" itemprop="url">28 April 2020 at 6:05 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>I read many compliments, but honestly I am more worried about what has not been said in this analysis, for example:<br />
2020-04-22 20:29 Sophos receives report of a suspicious field value in an XG Firewall management interface</p>
<p>Ok someone reported, but how many months had the attack been running?</p>
<p>&#8220;But we found no evidence that the collected data was successfully exfiltrated.&#8221;</p>
<p>I don&#8217;t know what other proof we need there is a data upload!</p>
<p>What can we know further about these two points, sophos does security, cannot be good at remedying, it MUST NOT happen, sql injection is a threat that should be obsolete by now &#8230;<br />
Thanks</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183366#respond' data-commentid="183366" data-postid="66159" data-belowelement="comment-183366" data-respondelement="respond" data-replyto="Reply to 2own" aria-label='Reply to 2own'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment even depth-2  " id="comment-183440" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-04-28T20:22-04:00" itemprop="datePublished"><a href="#comment-183440" itemprop="url">28 April 2020 at 8:22 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The domains were registered on the 28th March if that helps with your question so thats when the attacker was starting to put infrastructure in place.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=183440#respond' data-commentid="183440" data-postid="66159" data-belowelement="comment-183440" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-184440" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Martin											</h2>
					<time class="comment-meta-item" datetime="2020-05-05T02:44-04:00" itemprop="datePublished"><a href="#comment-184440" itemprop="url">05 May 2020 at 2:44 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Very interesting reading and the pictures supplemented the text in a good way. Thanks!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=184440#respond' data-commentid="184440" data-postid="66159" data-belowelement="comment-184440" data-respondelement="respond" data-replyto="Reply to Martin" aria-label='Reply to Martin'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-187097" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-05-20T04:01-04:00" itemprop="datePublished"><a href="#comment-187097" itemprop="url">20 May 2020 at 4:01 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Well written, clear, and detailed description of events. Thanks for your transparency on this!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=187097#respond' data-commentid="187097" data-postid="66159" data-belowelement="comment-187097" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-192982" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/81f091b8ca26ec8f77b9c6a312c697a1?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/81f091b8ca26ec8f77b9c6a312c697a1?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="https://joancross.net" itemprop="author">James Olorunosebi</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-06-29T19:14-04:00" itemprop="datePublished"><a href="#comment-192982" itemprop="url">29 June 2020 at 7:14 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>It is no surprise to me that the attackers began selling Sophos software users data in June 2020. I got an email from an unknown sender advertising for sale access to a list of people who use Sophos software. That was a red flag, as at the time I had not yet read this piece. Now that I have its clearer now. THis also goes to say to administrators to be careful of  co-hosting services to be WAN-facing on the same port as other important services.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=192982#respond' data-commentid="192982" data-postid="66159" data-belowelement="comment-192982" data-respondelement="respond" data-replyto="Reply to James Olorunosebi" aria-label='Reply to James Olorunosebi'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-andrewbrandt even depth-2  bystaff" id="comment-193118" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Andrew Brandt											</h2>
					<time class="comment-meta-item" datetime="2020-06-30T18:54-04:00" itemprop="datePublished"><a href="#comment-193118" itemprop="url">30 June 2020 at 6:54 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Hi there. Spammers who claim to collect and aggregate data about customers of various products or services, and then try to resell those customer lists, are not new and what you described is almost certainly not related to this incident. It is, unfortunately, quite common. Even I get random spammers who try to sell me lists of people who they claim are Sophos customers! </p>
<p>-=A</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/04/26/asnarok/?replytocom=193118#respond' data-commentid="193118" data-postid="66159" data-belowelement="comment-193118" data-respondelement="respond" data-replyto="Reply to Andrew Brandt" aria-label='Reply to Andrew Brandt'>Reply</a>				</div>
			</div>

	</article></section></article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/04/26/asnarok/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/04/26/asnarok/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='66159' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="58accc4c62" /></p><input type="hidden" id="ak_js" name="ak_js" value="20"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-65814" class="second-featured post-65814 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-data-breach tag-exfiltration tag-i-o-completion-ports tag-iocp tag-lockbit-ransomware tag-uac-bypass tag-user-account-control region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">24</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" rel="bookmark">LockBit ransomware borrows tricks to keep up with REvil and Maze</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-65083" class="second-featured post-65083 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/04/top_image_sextortion.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">22</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/22/following-the-sextortion-money/" rel="bookmark">Following the money in a massive &#8220;sextortion&#8221; spam scheme</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-65135" class="second-featured post-65135 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-coronavirus tag-covid-19 tag-malware tag-patch-tuesday tag-phishing tag-ransomware tag-scams tag-spam region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/03/coronav.jpeg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">14</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/14/covidmalware/" rel="bookmark">Facing down the myriad threats tied to COVID-19</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-64302" class="second-featured post-64302 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-fleeceware tag-free-trial-app tag-ios tag-iphone tag-subscription-scam tag-trial-apps region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/04/fleeceware-ios-banner-featured.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">08</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/08/iphone-fleeceware/" rel="bookmark">Don&#8217;t let fleeceware sneak into your iPhone</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkEEOwiAQRS8kIF20K+NRDLZjS8sAYcDq7R3TNHHhomTY8Hnvk4xao+iDz+CzyhMgkKIQp0AeVhLNWXdqJj4MhcWCeDaykZoDuQVyppM61NGHVEHDKydDx/ktkiVbV2/1BqOxo68Wo0nZQ6r2RlOtfLNdsr53ZQDa1orIBSJBdG+J1v+D+Ap4h+H3ff8Zi4iujNaTMoslhKxu7KpHSMjsFS+65em0PrfzB20wygw='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'66159',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '66159' ]);
</script>
</body>
</html>
