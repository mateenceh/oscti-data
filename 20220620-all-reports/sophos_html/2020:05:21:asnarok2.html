<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/05/21/asnarok2/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>Asnarök attackers twice modified attack midstream &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Asnarök attackers twice modified attack midstream Comments Feed" href="https://news.sophos.com/en-us/2020/05/21/asnarok2/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615460519' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpmWEWAK8/Ihc='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/66804" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/05/21/asnarok2/" />
<link rel='shortlink' href='https://news.sophos.com/?p=66804' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F05%2F21%2Fasnarok2%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F05%2F21%2Fasnarok2%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/05/21/asnarok2/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Asnarök attackers twice modified attack midstream" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/05/21/asnarok2/" />
<meta property="og:description" content="Ransomware payload added after hotfixes blocked new attacks" />
<meta property="article:published_time" content="2020-05-21T15:16:27+00:00" />
<meta property="article:modified_time" content="2020-05-21T15:19:33+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/05/Machicolations.png?w=340" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/05/Machicolations.png?w=340" />
<meta property="og:image:width" content="340" />
<meta property="og:image:height" content="366" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Asnarök attackers twice modified attack midstream" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/05/Machicolations.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-66804 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-66804" class="post-66804 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-asnarok tag-notrobin tag-ragnarok tag-ragnarokfromasgard tag-ransomware tag-xg-firewall region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">Asnarök attackers twice modified attack midstream</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/asnarok/">Asnarok</a>&bull;<a href="https://news.sophos.com/en-us/tag/notrobin/">notrobin</a>&bull;<a href="https://news.sophos.com/en-us/tag/ragnarok/">Ragnarok</a>&bull;<a href="https://news.sophos.com/en-us/tag/ragnarokfromasgard/">ragnarokfromasgard</a>&bull;<a href="https://news.sophos.com/en-us/tag/ransomware/">Ransomware</a>&bull;<a href="https://news.sophos.com/en-us/tag/xg-firewall/">XG Firewall</a>		</div>

					<div class="entry-excerpt">
				<p>Ransomware payload added after hotfixes blocked new attacks</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/05/21/asnarok2/" rel="bookmark">21 May 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=Asnar%C3%B6k%20attackers%20twice%20modified%20attack%20midstream%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D66804" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=66804&#038;title=Asnarök%20attackers%20twice%20modified%20attack%20midstream" data-title="Asnarök attackers twice modified attack midstream" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/05/21/asnarok2/"
				data-title="Asnarök attackers twice modified attack midstream"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="340" height="366" src="https://news.sophos.com/wp-content/uploads/2020/05/Machicolations.png?w=340" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/05/Machicolations.png 340w, https://news.sophos.com/wp-content/uploads/2020/05/Machicolations.png?resize=279,300 279w" sizes="(max-width: 340px) 100vw, 340px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/sophos/" title="Posts by Sophos" class="author url fn" rel="author">Sophos</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>In the hours after Sophos issued hotfixes that secured firewalls targeted by unknown threat actors, the attackers pivoted to a new phase of the attack, adding new components—including files intended to spread ransomware to unpatched Windows machines inside the network. Unfortunately for the threat actors, the hotfixes also prevented the subsequent attempted attacks.</p>
<p>Since we published <a href="https://news.sophos.com/en-us/2020/04/26/asnarok/">our first report</a>, the attackers first modified their attack to attempt to use what we previously described as the “backup channel.” This was a Linux shell script that served as a <em>dead man switch</em>—a portion of the attack intended to trigger only under certain circumstances; in this case, if a specific file the attackers created during the attack gets deleted. For example, this would have happened if a firewall that hadn’t been remediated by the Sophos hotfixes had been rebooted or power-cycled. If the file did get deleted, the new use of the backup channel was intended to initiate a ransomware attack at an indeterminate time in the future.</p>
<p>The Sophos hotfixes closed off the SQL injection vulnerability to subsequent exploitation, and removed the malicious scripts and applications, without having to reboot the firewall. Possibly realizing that their ransomware download was not being initiated by the dead man switch, perhaps due to the lack of a reboot , the attackers then appear to have reacted by changing some of the shell scripts delivered during an <em>earlier</em> stage of the attack, including replacing the <em>2own</em> data-stealing module with the ransomware payload.</p>
<p>At that point, the attackers intended to deliver the ransomware without requiring the firewall to reboot—but Sophos had already taken additional steps to intervene that disrupted this phase of the attack. The following is a description of the threat actors’ attempts to modify their attack in reaction to Sophos’ response.</p>
<h2>New ELF and shell script malware</h2>
<p>During our initial analysis of the attack, Sophos identified a web domain that the attackers had registered prior to the earliest phase of the attack. At the time we began our investigation, the URLs on that domain were not functional and were not serving any malicious code.</p>
<p>This attack element, characterized as a &#8220;backup channel&#8221; in the infographic we used in the previous post, was only activated by the attacker after we began to respond to the incident by issuing hotfixes to firewalls.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/04/flow-diagram-2nd-version.jpg"><img loading="lazy" class="alignnone wp-image-66807 size-full" src="https://news.sophos.com/wp-content/uploads/2020/05/image1.jpg" alt="" width="640" height="276" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image1.jpg 903w, https://news.sophos.com/wp-content/uploads/2020/05/image1.jpg?resize=300,130 300w, https://news.sophos.com/wp-content/uploads/2020/05/image1.jpg?resize=768,332 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>As <a href="https://news.sophos.com/en-us/2020/04/26/asnarok/">we previously reported</a>, the attack began when the attackers leveraged a previously-unknown SQL injection vulnerability to insert a single line of Linux code into a database; the effect being that a shell script named <strong>Install.sh</strong> was downloaded to, and executed, on the firewall.</p>
<p>That script, in one of the defining behaviors of the attack, downloaded three additional shell scripts, one of which (named <strong>.pg.sh</strong>) leads to the backup channel. The .pg.sh script then, in turn, downloaded a Linux ELF binary that was written to the filesystem as <strong>.post_MI</strong>, which we know performed two functions.</p>
<p>First, .post_MI would check to see whether another file, named <strong>.a.PGSQL</strong> had been written to the /tmp/ directory on the firewall&#8217;s internal storage. As a different, earlier fork of the attack chain always created that zero-byte file in that location, we observed no additional behavior from .post_MI, but we did know that it would have activated its secondary command – to download and execute another shell script named <strong>patch.sh</strong>—only if the .a.PGSQL file was not where it was supposed to be.</p>
<p>And there was a good explanation for that: The firewall always clears the contents of the /tmp/ directory when it reboots or when an administrator power-cycles the firewall. This link on the attack chain would have activated if an admin triggered the firewall to reboot (or cycled the power).</p>
<p>The patch.sh script was unavailable from the attacker&#8217;s infrastructure until it suddenly appeared a few days after the attack began.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image2.png"><img loading="lazy" class="alignnone size-full wp-image-66808" src="https://news.sophos.com/wp-content/uploads/2020/05/image2.png" alt="" width="640" height="643" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image2.png 1484w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=298,300 298w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=768,772 768w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=1019,1024 1019w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2020/05/image2.png?resize=128,128 128w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h3>patch.sh leads to Ragnarok ransomware</h3>
<p>If someone rebooted or power-cycled a successfully-attacked firewall (or happened to delete the .a.PGSQL file from the /tmp directory some other way), .post_MI activated and downloaded patch.sh from the website <strong>ragnarokfromasgard[.]com</strong>. Again, this website only began serving content several days after the attack began.  Sophos was able to take control of this domain through legal process.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image3.png"><img loading="lazy" class="alignnone size-full wp-image-66809" src="https://news.sophos.com/wp-content/uploads/2020/05/image3.png" alt="" width="640" height="188" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image3.png 1003w, https://news.sophos.com/wp-content/uploads/2020/05/image3.png?resize=300,88 300w, https://news.sophos.com/wp-content/uploads/2020/05/image3.png?resize=768,226 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The ragnarokfromasgard domain shared hosting with two other domains. One of those domains (<strong>updatefileservercross[.]com</strong>, also now in Sophos&#8217; control) had also been hosted from a second IP address that, in turn, led to other similarly-named domains registered on the same day, with the same registrar, using the same private WHOIS service to mask the registrant&#8217;s details.</p>
<p>In the previous post, we listed several domains we considered suspicious; we were led to one of them by an alternate &#8220;installer&#8221; shell script, which pointed at a file named <strong>in.sh</strong> that had been hosted on the domain <strong>filedownloaderservers[.]com</strong>, also now in Sophos&#8217; control. This domain was hosted on an IP that was not shared with the other domains (23.234.10[.]122), but falls under the jurisdiction of the same company, Internet Keeper Global out of Hong Kong, on the same /24 subnet range.</p>
<p>The  .post_MI file wrote out the patch.sh file into the /tmp/ directory as <strong>.psqlck.sh</strong> and executed it. That script had one job: Download yet another file from a web server and execute it.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image4.png"><img loading="lazy" class="alignnone size-full wp-image-66810" src="https://news.sophos.com/wp-content/uploads/2020/05/image4.png" alt="" width="427" height="125" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image4.png 427w, https://news.sophos.com/wp-content/uploads/2020/05/image4.png?resize=300,88 300w" sizes="(max-width: 427px) 100vw, 427px" /></a></p>
<p>Rather than use a domain name, the attackers decided to point this at the IP address where the payload file, named <strong>s</strong>, was hosted (on the nonstandard web server port of 81/tcp). The script wrote out the downloaded file to /tmp/ as a file deceptively named <strong>hotfix</strong>, and executed it.</p>
<p>The attacker&#8217;s &#8220;hotfix&#8221; file is an ELF binary application, an executable file for Unix operating systems like Linux. One of its tasks was to parse the contents of the firewall&#8217;s ARP cache; the ARP cache keeps track of the (internal) IP and MAC addresses of every host on the local network segment. It then uses this list of internal IP addresses to scan port 445/tcp on each computer to determine if those computers were running Windows, and if they were reachable. (An ARP cache may contain the IP address(es) of computer(s) that have been powered off or are not available for other reasons.)</p>
<p>This Linux application contained two embedded Windows DLLs, one built for 32-bit (x86) architecture, one for 64-bit (x64), as well as a series of hardcoded SMB commands.</p>
<p>During the attack, the attacker&#8217;s <em>hotfix</em> application used those commands to initiate an SMB transaction to each of the computers listed in the ARP cache. Executing this command triggers an error, which the attacker&#8217;s <em>hotfix</em> file used to determine if the targeted computer was running 32-bit or 64-bit Windows.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image5.png"><img loading="lazy" class="alignnone size-full wp-image-66811" src="https://news.sophos.com/wp-content/uploads/2020/05/image5.png" alt="" width="640" height="172" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image5.png 1093w, https://news.sophos.com/wp-content/uploads/2020/05/image5.png?resize=300,80 300w, https://news.sophos.com/wp-content/uploads/2020/05/image5.png?resize=768,206 768w, https://news.sophos.com/wp-content/uploads/2020/05/image5.png?resize=1024,275 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Based on the result of that test, the attacker&#8217;s <em>hotfix</em> application would have attempted to leverage the EternalBlue network-level remote code execution exploit and DoublePulsar kernel- and user-land shellcode, to deliver, inject, and execute the architecture-appropriate DLL directly into the memory of the Windows explorer.exe process on the targeted computer.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image6.png"><img loading="lazy" class="alignnone size-full wp-image-66812" src="https://news.sophos.com/wp-content/uploads/2020/05/image6.png" alt="" width="450" height="498" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image6.png 450w, https://news.sophos.com/wp-content/uploads/2020/05/image6.png?resize=271,300 271w" sizes="(max-width: 450px) 100vw, 450px" /></a></p>
<p>The DLL, once loaded into explorer.exe, would have used the Windows <em>certutil.exe </em>tool to download an executable payload from the <strong>9sg[.]me</strong> domain (previously hosted on the same IP address that hosted the attacker’s <em>hotfix</em> ELF, now controlled by Sophos) to the computer, using the nonstandard HTTP port 81/tcp.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image7.png"><img loading="lazy" class="alignnone wp-image-66813" src="https://news.sophos.com/wp-content/uploads/2020/05/image7.png" alt="" width="451" height="378" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image7.png 665w, https://news.sophos.com/wp-content/uploads/2020/05/image7.png?resize=300,252 300w" sizes="(max-width: 451px) 100vw, 451px" /></a></p>
<p>The commands were nearly identical on either platform, and as it turns out, even though there was a unique URL used for each architecture, the payload executable it attempted to download (named either <strong>patch32</strong> or <strong>patch64</strong>) was identical.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image8.png"><img loading="lazy" class="alignnone size-full wp-image-66814" src="https://news.sophos.com/wp-content/uploads/2020/05/image8.png" alt="" width="640" height="298" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image8.png 1010w, https://news.sophos.com/wp-content/uploads/2020/05/image8.png?resize=300,140 300w, https://news.sophos.com/wp-content/uploads/2020/05/image8.png?resize=768,357 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The script waited for 60 seconds after it had completed the download, executed the payload, then deleted the static payload data off of storage, a common behavior that attackers employ to remove evidence and complicate the forensic analysis of affected devices.</p>
<p>The IP address hosting the <em>9sg </em>domain was the same location that served the <em>hotfix</em> payload, and is implicated in attacks going back to 2018, according to VirusTotal and FireEye, who<a href="https://github.com/citrix/ioc-scanner-CVE-2019-19781/blob/master/scanners/shell-history.sh"> included the IP in a block list</a> of IoCs the company associates with a threat they call <a href="https://www.fireeye.com/blog/threat-research/2020/01/vigilante-deploying-mitigation-for-citrix-netscaler-vulnerability-while-maintaining-backdoor.html">NOTROBIN</a>, used to target Citrix servers.</p>
<h3>Moving ransomware up in the attack sequence</h3>
<p>A short time after the attackers enabled the so-called <em>dead man switch</em>, it appears they did not detect the response they were expecting and made other modifications to the killchain.</p>
<p>The logic the attackers initially built into the attack chain meant the ransomware payload would be delivered if something (or someone) cleaned up the persistence mechanism employed in the <em>generate_curl_ca_bundle.sh</em> file, but also <em>did not</em> clean up the .post_MI persistence method. If you cleaned up both, as the Sophos hotfix did, it didn&#8217;t run.</p>
<p>After both of those channels failed to deliver the desired result, the attackers then replaced the script hosted at /sh_guard/lc so that it pointed at a download link to the ELF that downloads the ransomware, instead of the exfiltration tool <em>2own</em>.</p>
<h3>Ransomware payload</h3>
<p>The attacker&#8217;s so-called “hotfix” is a Windows ransomware called Ragnarok. This ransomware is now connected to at least two attack campaigns targeting networked devices. <a href="https://www.bleepingcomputer.com/news/security/ragnarok-ransomware-targets-citrix-adc-disables-windows-defender/">The earlier attack targeted Citrix ADC servers</a>.</p>
<p>Ragnarok ransomware contains an embedded JSON file that contains configuration data that defines how it will behave; decoding this JSON file reveals virtually everything about the malware&#8217;s instructions. The JSON, for example, defines the file extensions of files it will encrypt (in this case, .doc, .txt, .xls, .ppt, .sql, and.pdf were the only files it would have encrypted), and the file types it will not.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image9.png"><img loading="lazy" class="alignnone size-full wp-image-66815" src="https://news.sophos.com/wp-content/uploads/2020/05/image9.png" alt="" width="174" height="331" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image9.png 174w, https://news.sophos.com/wp-content/uploads/2020/05/image9.png?resize=158,300 158w" sizes="(max-width: 174px) 100vw, 174px" /></a></p>
<p>The Ragnarok JSON also contains Windows Registry key paths that indicate the ransomware may attempt to disable the Windows Defender antimalware tool.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image10.png"><img loading="lazy" class="alignnone size-full wp-image-66816" src="https://news.sophos.com/wp-content/uploads/2020/05/image10.png" alt="" width="640" height="263" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image10.png 736w, https://news.sophos.com/wp-content/uploads/2020/05/image10.png?resize=300,124 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The ransomware drops a text file ransom note (the content of which also is defined in the JSON configuration data) that contains several email addresses.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image11.png"><img loading="lazy" class="alignnone size-full wp-image-66817" src="https://news.sophos.com/wp-content/uploads/2020/05/image11.png" alt="" width="640" height="219" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image11.png 1664w, https://news.sophos.com/wp-content/uploads/2020/05/image11.png?resize=300,103 300w, https://news.sophos.com/wp-content/uploads/2020/05/image11.png?resize=768,263 768w, https://news.sophos.com/wp-content/uploads/2020/05/image11.png?resize=1024,350 1024w, https://news.sophos.com/wp-content/uploads/2020/05/image11.png?resize=1536,525 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The ransom note does not include a bitcoin wallet or make a specific financial demand, requesting that the owner of the infected device contact the attackers to negotiate a ransom. The JSON does, however, include a C2 address (pointing back to the same IP where <strong>9sg</strong> was hosted), as well as a folder location on the target system that includes a folder (familiarly) named <em>veryhotfix</em>.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/image12.png"><img loading="lazy" class="alignnone size-full wp-image-66818" src="https://news.sophos.com/wp-content/uploads/2020/05/image12.png" alt="" width="640" height="163" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image12.png 1294w, https://news.sophos.com/wp-content/uploads/2020/05/image12.png?resize=300,77 300w, https://news.sophos.com/wp-content/uploads/2020/05/image12.png?resize=768,196 768w, https://news.sophos.com/wp-content/uploads/2020/05/image12.png?resize=1024,261 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>It&#8217;s common for criminals to avoid running malware in countries where they reside, presumably to avoid attention from local law enforcement. One way they do that is to use the language or localization settings on the target computer to make the decision.</p>
<p>The Ragnarok JSON contains its localization-based exclusion policy, which includes Russia and the CIS countries, but also Israel, Spain, and language settings representing four regional dialects used in China (Simplified Chinese, Uyghur, Yi, and Tibetan).</p>
<p>The following table lists the specific Installed Language ID (LCID) values and their corresponding localization codes and language/country pairs that make up the exclusion list.</p>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<td width="156"><strong>LCID &#8211; HEX</strong></td>
<td width="156"><strong>LCID &#8211; DEC</strong></td>
<td width="156"><strong>Country code</strong></td>
<td width="156"><strong>Language Name</strong></td>
</tr>
<tr>
<td width="156">0x040A</td>
<td width="156">1034</td>
<td width="156">es-ES_tradnl</td>
<td width="156">Spanish &#8211; Spain</td>
</tr>
<tr>
<td width="156">0x040D</td>
<td width="156">1037</td>
<td width="156">he-IL</td>
<td width="156">Hebrew &#8211; Israel</td>
</tr>
<tr>
<td width="156">0x0419</td>
<td width="156">1049</td>
<td width="156">ru-RU</td>
<td width="156">Russian &#8211; Russia</td>
</tr>
<tr>
<td width="156">0x0422</td>
<td width="156">1058</td>
<td width="156">uk-UA</td>
<td width="156">Ukrainian &#8211; Ukraine</td>
</tr>
<tr>
<td width="156">0x0423</td>
<td width="156">1059</td>
<td width="156">be-BY</td>
<td width="156">Belarusian &#8211; Belarus</td>
</tr>
<tr>
<td width="156">0x0428</td>
<td width="156">1064</td>
<td width="156">tg-Cyrl-TJ</td>
<td width="156">Tajik (Cyrillic) &#8211; Tajikistan</td>
</tr>
<tr>
<td width="156">0x042B</td>
<td width="156">1067</td>
<td width="156">hy-AM</td>
<td width="156">Armenian &#8211; Armenia</td>
</tr>
<tr>
<td width="156">0x042C</td>
<td width="156">1068</td>
<td width="156">az-Latn-AZ</td>
<td width="156">Azeri (Latin) &#8211; Azerbaijan</td>
</tr>
<tr>
<td width="156">0x043F</td>
<td width="156">1087</td>
<td width="156">kk-KZ</td>
<td width="156">Kazakh &#8211; Kazakhstan</td>
</tr>
<tr>
<td width="156">0x0440</td>
<td width="156">1088</td>
<td width="156">ky-KG</td>
<td width="156">Kyrgyz &#8211; Kyrgyzstan</td>
</tr>
<tr>
<td width="156">0x0442</td>
<td width="156">1090</td>
<td width="156">tk-TM</td>
<td width="156">Turkmen &#8211; Turkmenistan</td>
</tr>
<tr>
<td width="156">0x0443</td>
<td width="156">1091</td>
<td width="156">uz-Latn-UZ</td>
<td width="156">Uzbek (Latin) &#8211; Uzbekistan</td>
</tr>
<tr>
<td width="156">0x0451</td>
<td width="156">1105</td>
<td width="156">bo-CN</td>
<td width="156">Tibetan &#8211; China</td>
</tr>
<tr>
<td width="156">0x0478</td>
<td width="156">1144</td>
<td width="156">ii-CN</td>
<td width="156">Yi &#8211; China</td>
</tr>
<tr>
<td width="156">0x0480</td>
<td width="156">1152</td>
<td width="156">ug-CN</td>
<td width="156">Uyghur &#8211; China</td>
</tr>
<tr>
<td width="156">0x0804</td>
<td width="156">2052</td>
<td width="156">zh-CN</td>
<td width="156">Chinese (Simplified) &#8211; China</td>
</tr>
<tr>
<td width="156">0x0819</td>
<td width="156">2073</td>
<td width="156">ru-MO</td>
<td width="156">Russian &#8211; Moldova</td>
</tr>
<tr>
<td width="156">0x082C</td>
<td width="156">2092</td>
<td width="156">az-Cyrl-AZ</td>
<td width="156">Azeri (Cyrillic) &#8211; Azerbaijan</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<figure id="attachment_66819" aria-describedby="caption-attachment-66819" style="width: 397px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/05/image13.png"><img loading="lazy" class="size-full wp-image-66819" src="https://news.sophos.com/wp-content/uploads/2020/05/image13.png" alt="" width="397" height="797" srcset="https://news.sophos.com/wp-content/uploads/2020/05/image13.png 397w, https://news.sophos.com/wp-content/uploads/2020/05/image13.png?resize=149,300 149w" sizes="(max-width: 397px) 100vw, 397px" /></a><figcaption id="caption-attachment-66819" class="wp-caption-text">LCID values taken from the Ragnarok JSON configuration file</figcaption></figure>
<h3>Protection available</h3>
<p>Sophos XG firewall administrators with questions should refer to the guidance from <a href="https://community.sophos.com/kb/en-us/135412">the Knowledge Base entry</a> on this topic.</p>
<p>The EternalBlue exploit, as implemented by the attackers in this attack, cannot infect computers running Windows 8.1 or Windows 10. The attack only succeeds against computers running older, unpatched versions of Windows 7. As a matter of course, Sophos urges everyone to patch any vulnerable machines on their network.</p>
<p>Additionally, if any infected device attempts to spread the ransomware to a vulnerable (e.g., unpatched) Windows 7 computer that is running a current version of Sophos Antivirus with Intercept X, it will display a notification on the lower right corner of the desktop with the following message: &#8220;Ransomware blocked in C:\Users\Public\hotfix.exe&#8221;</p>
<p>Intercept X has two components which will prevent infection:</p>
<ul>
<li>APCViolation – prevents process injection from kernel and userland via an asynchronous procedure call (APC) or the global atom table</li>
<li>CryptoGuard – behavior-driven ransomware protection based on zero trust security principles</li>
</ul>
<p>Users who have Sophos Antivirus with Intercept X were and are protected from Ragnarok and the Linux-based files used in the attack by the following definitions updates.</p>
<ul>
<li>Linux/Agnt-G (ELF binaries and bash scripts)</li>
<li>Troj/DownLd-BU or Troj/DownLd-BT (Windows DLL downloader components)</li>
<li>Troj/Ransom-FXR or Troj/Ransom-FXQ or HPmal/Ragrok-A (Ragnarok ransomware)</li>
</ul>
<h2>Conclusion</h2>
<p>Ragnarok is a less common threat than other ransomware, and it appears that this threat actor&#8217;s <em>modus operandi</em> – and the tooling they employ to deliver this ransomware—is quite different from those of many other threat actors. It was a rare and notable event to observe a Linux ELF application being used to try to spread malware across platforms to Windows computers.</p>
<p>This incident highlights the necessity of keeping machines inside the firewall perimeter up to date, and serves as a reminder that any IOT device could be abused as a foothold to reach Windows machines. It&#8217;s also important for the industry and law enforcement to keep an eye on this group, because of the potentially outsized impact of an attack against always-on networked devices.</p>
<p>&nbsp;</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/" rel="prev">Ragnar Locker ransomware deploys virtual machine to dodge security</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/05/27/netwalker-ransomware-tools-give-insight-into-threat-actor/" rel="next">Netwalker ransomware tools give insight into threat actor</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/sophos/" title="Posts by Sophos" class="author url fn" rel="author">Sophos</a></h3>

					
					<div class="author-bio">
											</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/05/21/asnarok2/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/05/21/asnarok2/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='66804' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="48fb91dad0" /></p><input type="hidden" id="ak_js" name="ak_js" value="138"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-66338" class="second-featured post-66338 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-maze-ransomware region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/05/Longleat_maze.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">12</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/05/12/maze-ransomware-1-year-counting/" rel="bookmark">Maze ransomware: extorting victims for 1 year and counting</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-66159" class="second-featured post-66159 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-asnarok tag-elf tag-firewall tag-malware tag-shell-script region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2018/08/firewall.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">26</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/26/asnarok/" rel="bookmark">&#8220;Asnarök&#8221; Trojan targets firewalls</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-65083" class="second-featured post-65083 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/04/top_image_sextortion.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">22</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/22/following-the-sextortion-money/" rel="bookmark">Following the money in a massive &#8220;sextortion&#8221; spam scheme</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IYCxuxoPxUQyyurFRIJQ5fXsxyxIPHkbSS/9+X5tULIFp7xK4JNIACCTIh8GTg4VYXcmTGClXhvxkgD1rXnOZA74GfKSD2LVD+1hAwytFRfv5NeJzMrbc0gqDMr0rFoOKyUEs9npVrHyzTTJO27kDWt+KmBewCMG+ORr3D8ot4B263/l2GWcW7NwbR0JNhhCSuGVXPHzEzF7xIlvZHNuqkefxA21LyhQ='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'66804',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '66804' ]);
</script>
</body>
</html>
