<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>Color by numbers: inside a Dharma ransomware-as-a-service attack &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Color by numbers: inside a Dharma ransomware-as-a-service attack Comments Feed" href="https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1616171106' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqUUWAK9KIh0='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/68392" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/" />
<link rel='shortlink' href='https://news.sophos.com/?p=68392' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F08%2F12%2Fcolor-by-numbers-inside-a-dharma-ransomware-as-a-service-attack%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F08%2F12%2Fcolor-by-numbers-inside-a-dharma-ransomware-as-a-service-attack%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Color by numbers: inside a Dharma ransomware-as-a-service attack" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/" />
<meta property="og:description" content="Dharma, a family of ransomware first spotted in 2016, continues to be a threat to many organizations—especially small and medium-sized businesses. Part of the reason for its longevity is that its v…" />
<meta property="article:published_time" content="2020-08-12T12:30:45+00:00" />
<meta property="article:modified_time" content="2020-08-14T14:49:11+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/08/ransomwarebynumbers.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/08/ransomwarebynumbers.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="301" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Color by numbers: inside a Dharma ransomware-as-a-service attack" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/08/ransomwarebynumbers.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-68392 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-68392" class="post-68392 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">Color by numbers: inside a Dharma ransomware-as-a-service attack</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>		</div>

		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/" rel="bookmark">12 August 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=Color%20by%20numbers%3A%20inside%20a%20Dharma%20ransomware-as-a-service%20attack%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D68392" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=68392&#038;title=Color%20by%20numbers:%20inside%20a%20Dharma%20ransomware-as-a-service%20attack" data-title="Color by numbers: inside a Dharma ransomware-as-a-service attack" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/"
				data-title="Color by numbers: inside a Dharma ransomware-as-a-service attack"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="301" src="https://news.sophos.com/wp-content/uploads/2020/08/ransomwarebynumbers.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/08/ransomwarebynumbers.png 855w, https://news.sophos.com/wp-content/uploads/2020/08/ransomwarebynumbers.png?resize=300,141 300w, https://news.sophos.com/wp-content/uploads/2020/08/ransomwarebynumbers.png?resize=768,361 768w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>Dharma, a family of ransomware first spotted in 2016, continues to be a threat to many organizations—especially small and medium-sized businesses. Part of the reason for its longevity is that its variants have become the basis for ransomware-as-a-service (RaaS) operations—the fast-food franchise of cybercrime. Three recent attacks documented by SophosLabs and Sophos MTR have revealed a toolset used by Dharma &#8220;affliliates&#8221; that explains why attacks from so many different Dharma actors seem so identical, down to the tools and commands they use.</p>
<p>While other, newer ransomware families have grabbed recent headlines with high-profile victims and multi-million-dollar demands, Dharma has continued to be among the most profitable.  In part that&#8217;s because actors with access to the source code continue to innovate around delivering the ransomware as a packaged business for less-sophisticated criminal operators. The Dharma RaaS we&#8217;ve investigated is targeted at entry-level cyber-criminals, and provides a paint-by-the-numbers approach to penetrating victims&#8217; networks and launching ransomware attacks.</p>
<p>The actors using this particular RaaS are equipped with a package of pre-built scripts and &#8220;grey hat&#8221; tools that requires relatively little skill to operate. The Dharma operations we&#8217;ve documented use a combination of internal Windows tools, legitimate third-party &#8220;freeware&#8221; software, well-known security tools and  publicly-available exploits, integrated together through bespoke PowerShell, batch, and <a href="https://www.autoitscript.com/site/">AutoIT</a> scripts. This pre-packaged toolkit, combined with back-end technical support, significantly extends the reach of the Dharma RaaS operators, allowing them to profit while their afililates do the hands-on-keyboard work of breaching networks, dropping ransomware, and managing &#8220;customer service&#8221; with the victims.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/Attack-killchain-mitre-template-Read-Only.png"><img loading="lazy" class="alignnone size-large wp-image-68622" src="https://news.sophos.com/wp-content/uploads/2020/08/Attack-killchain-mitre-template-Read-Only.png?w=640" alt="" width="640" height="360" srcset="https://news.sophos.com/wp-content/uploads/2020/08/Attack-killchain-mitre-template-Read-Only.png 1024w, https://news.sophos.com/wp-content/uploads/2020/08/Attack-killchain-mitre-template-Read-Only.png?resize=300,169 300w, https://news.sophos.com/wp-content/uploads/2020/08/Attack-killchain-mitre-template-Read-Only.png?resize=768,432 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>&nbsp;</p>
<h3>Ransomware economics</h3>
<p>Dharma, formerly known as CrySis, has many variants, due to the sale and modification of its source code to multiple malware developers. Those transfers aren&#8217;t necessarily from the malware&#8217;s original authors, either—in March, a collection of source code for one variant of Dharma <a href="https://nakedsecurity.sophos.com/2020/03/31/dharma-ransomware-source-code-on-sale-for-2000/">was offered for sale</a> on Russian-language crime forums for $2000 through an intermediary.</p>
<figure id="attachment_68483" aria-describedby="caption-attachment-68483" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/dharmasource_sale.png"><img loading="lazy" class="size-large wp-image-68483" src="https://news.sophos.com/wp-content/uploads/2020/08/dharmasource_sale.png?w=640" alt="" width="640" height="281" srcset="https://news.sophos.com/wp-content/uploads/2020/08/dharmasource_sale.png 937w, https://news.sophos.com/wp-content/uploads/2020/08/dharmasource_sale.png?resize=300,132 300w, https://news.sophos.com/wp-content/uploads/2020/08/dharmasource_sale.png?resize=768,337 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-68483" class="wp-caption-text">A forum post from March 2020 offering the Dharma ransomware sourcecode for $2000.</figcaption></figure>
<p>Because of its availability, Dharma has become the center of a criminal ecosystem based on a &#8220;syndication&#8221; business model. Dharma RaaS providers offer the technical expertise and support, operating the back-end systems that support ransomware attacks. &#8220;Affiliates&#8221; (often entry-level cybercriminals) pay for the use of the RaaS, and carry out the targeted attacks themselves, using a standard toolkit. Other actors provide stolen credentials and other tools on criminal forums that enable the Remote Desktop Protocol attacks that are the predominant means of initial compromise for Dharma actors. (RDP attacks are the root cause of about 85 percent of Dharma attacks, based on <a href="https://www.coveware.com/dharma-ransomware-payment">statistics provided by Coveware</a>.)</p>
<figure id="attachment_68524" aria-describedby="caption-attachment-68524" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/RDP_for_sale.png"><img loading="lazy" class="size-large wp-image-68524" src="https://news.sophos.com/wp-content/uploads/2020/08/RDP_for_sale.png?w=640" alt="" width="640" height="404" srcset="https://news.sophos.com/wp-content/uploads/2020/08/RDP_for_sale.png 1279w, https://news.sophos.com/wp-content/uploads/2020/08/RDP_for_sale.png?resize=300,190 300w, https://news.sophos.com/wp-content/uploads/2020/08/RDP_for_sale.png?resize=768,485 768w, https://news.sophos.com/wp-content/uploads/2020/08/RDP_for_sale.png?resize=1024,647 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-68524" class="wp-caption-text">A dark web site selling RDP credentials, including some with administrative privileges. These marketplaces in some cases allow buyers to verify the accounts work before they buy them.</figcaption></figure>
<p>Ransom demands from Dharma actors trend below those of the other major types of targeted ransomware over the past year. In December of 2019, when the average ransomware demand had surged to $191,000, the average Dharma ransom demand was only $8,620. That&#8217;s in part due to the types of targets hit by Dharma (mostly small and medium businesses), and in part because of the skills, experience and location of the affiliates running the attacks. In any case, Dharma operators make up for the lower ransom demands with volume—Dharma remains one of the most profitable ransomware families, according to Coveware.</p>
<p>Dharma uses a complicated two-stage decryption process that partitions the affiliate actors from the actual key retrieval process. Victims who contact the attackers are given a first-stage tool that extracts information about the files that were encrypted into a text file. That text file gets cut-and-pasted into email and is sent back to the affiliates—who then have to submit that data through a portal for the RaaS to obtain the actual keys. This keeps the affiliates dependent on the RaaS, and it keeps them paying for service.</p>
<p>Just how well the decryption process works depends greatly on the expertise and the moods of the affiliates. Occasionally an actor will hold back some of the keys with additional demands. And there&#8217;s constant &#8220;churn&#8221; among the front-end actors, as the &#8220;subscriptions&#8221; of some to RaaS services expire and others with less experience take their place, resulting in occasional misfires.</p>
<h3>The Dharma playbook</h3>
<p>Most Dharma operators don&#8217;t make significant changes to the source. But Dharma RaaS operators appear to package together a number of tools and best practices for their &#8220;affiliates&#8221; to use once they&#8217;ve gotten onto a victim&#8217;s network.</p>
<p>These tools aren&#8217;t completely automated, as every attack does not follow the same exact steps. However, they do follow something amounting to step-by-step instructions, akin to a telemarketer&#8217;s script, allowing some room for improvisation. And one of those tools is a menu-driven PowerShell script that installs and launches the components required to spread ransomware across the network.</p>
<p>After getting an RDP connection,  the attacker maps a directory containing the RaaS toolkit on their local drive  as a network drive accessible from the remote desktop.  The contents of this directory include a number of applications previously identified as potentially unwanted applications (such as the Mimikatz password extraction tool), customized hacking tools,  and freeware versions of a variety of legitimate system utilities.  (A full list of the files is included in the<a href="https://github.com/sophoslabs/IoCs/blob/master/Ransomware-Dharma-RaaS.csv"> indicators of compromise file on SophosLabs&#8217; GitHub page</a>. )</p>
<p>The kit also includes the Dharma ransomware executable, and a collection of PowerShell scripts, most of which we were unable to recover for analysis. However, we did recover a master script from console logs. Called toolbelt.ps1, the  menu-driven console script automates the use of the tools, allowing attackers to simply type in the number associated with each pre-scripted element.</p>
<p>When executed, it identifies itself in the console frame as &#8220;Toolbox,&#8221; and if executed with administrative privileges, advises the user/attacker, &#8220;Have fun, bro!&#8221;</p>
<figure id="attachment_68417" aria-describedby="caption-attachment-68417" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/startscreen.png"><img loading="lazy" class="wp-image-68417 size-large" src="https://news.sophos.com/wp-content/uploads/2020/08/startscreen.png?w=640" alt="" width="640" height="556" srcset="https://news.sophos.com/wp-content/uploads/2020/08/startscreen.png 852w, https://news.sophos.com/wp-content/uploads/2020/08/startscreen.png?resize=300,261 300w, https://news.sophos.com/wp-content/uploads/2020/08/startscreen.png?resize=768,667 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-68417" class="wp-caption-text">The startup screen for toolbelt.ps1</figcaption></figure>
<p>The &#8220;menu&#8221;  selections in Toolbox aren&#8217;t displayed as a menu by the script as it executes, though they are largely documented in the script itself.  Tools are downloaded to the remote computer by the script as needed,  executed, and in many cases deleted after use.</p>
<p>The menu commands we identified, by the numbers and symbols they are called by, were as follows:</p>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th>&#8220;Menu&#8221; entry</th>
<th>Triggered function</th>
</tr>
<tr>
<td valign="top">+</td>
<td>Executes Start-Tor.ps1, a script that launches a Tor network connection.</td>
</tr>
<tr>
<td valign="top">.</td>
<td valign="top">Executes Email-Screenshot.ps1, which creates a screenshot from the remote system and sends to the email address (provided by the operator at a prompt in the script).</td>
</tr>
<tr>
<td valign="top">1</td>
<td valign="top">Runs LaPass.ps1, a &#8220;User changer&#8221; script. (We could not recover the script itself.)</td>
</tr>
<tr>
<td valign="top">2</td>
<td valign="top">Starts lusrmgr.msc, the Windows local user management plug-in.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/2.png"><img loading="lazy" class="size-large wp-image-68408" src="https://news.sophos.com/wp-content/uploads/2020/08/2.png?w=640" alt="" width="640" height="368" srcset="https://news.sophos.com/wp-content/uploads/2020/08/2.png 956w, https://news.sophos.com/wp-content/uploads/2020/08/2.png?resize=300,173 300w, https://news.sophos.com/wp-content/uploads/2020/08/2.png?resize=768,442 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">3</td>
<td valign="top">Executes lubrute.ps1, a PowerShell script that attempts to get passwords to local user accounts through a brute force attack.</td>
</tr>
<tr>
<td valign="top">4</td>
<td valign="top">Copies and launches Mimikatz password extraction tools, dumping results to a text file.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/4.png"><img loading="lazy" class="size-large wp-image-68405" src="https://news.sophos.com/wp-content/uploads/2020/08/4.png?w=640" alt="" width="640" height="604" srcset="https://news.sophos.com/wp-content/uploads/2020/08/4.png 886w, https://news.sophos.com/wp-content/uploads/2020/08/4.png?resize=300,283 300w, https://news.sophos.com/wp-content/uploads/2020/08/4.png?resize=768,725 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">5</td>
<td valign="top">Executes Find-Pass.ps1, a PowerShell script.  (We were unable to recover this script for analysis.)</td>
</tr>
<tr>
<td valign="top">6</td>
<td valign="top">Copies  password viewers from a shared directory on the initially compromised machine to %temp%, and then opens a File Explorer window on that directory.</p>
<p><figure id="attachment_68397" aria-describedby="caption-attachment-68397" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/6.png"><img loading="lazy" class="size-large wp-image-68397" src="https://news.sophos.com/wp-content/uploads/2020/08/6.png?w=640" alt="" width="640" height="682" srcset="https://news.sophos.com/wp-content/uploads/2020/08/6.png 852w, https://news.sophos.com/wp-content/uploads/2020/08/6.png?resize=281,300 281w, https://news.sophos.com/wp-content/uploads/2020/08/6.png?resize=768,818 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-68397" class="wp-caption-text">6</figcaption></figure></td>
</tr>
<tr>
<td valign="top">7</td>
<td valign="top">Copies and and executes the NirSoft <a href="https://www.nirsoft.net/utils/remote_desktop_password.html">Remote Desktop PassView</a> password viewer tool.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/7.png"><img loading="lazy" class="size-large wp-image-68396" src="https://news.sophos.com/wp-content/uploads/2020/08/7.png?w=640" alt="" width="640" height="554" srcset="https://news.sophos.com/wp-content/uploads/2020/08/7.png 850w, https://news.sophos.com/wp-content/uploads/2020/08/7.png?resize=300,260 300w, https://news.sophos.com/wp-content/uploads/2020/08/7.png?resize=768,665 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">8</td>
<td valign="top">Copies and executes LaZagne.exe,  the Windows executable version of the <a href="https://github.com/AlessandroZ/LaZagne">LaZagne</a> password scraper.</td>
</tr>
<tr>
<td valign="top">9</td>
<td valign="top">Copies and executes Hash Suite Tools Free edition&#8217;s Hash Dump utility, and opens the website dropmefiles[.]com—potentially to exfiltrate the password hashes for remote matching attempts.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/9.png"><img loading="lazy" class="size-large wp-image-68394" src="https://news.sophos.com/wp-content/uploads/2020/08/9.png?w=640" alt="" width="640" height="623" srcset="https://news.sophos.com/wp-content/uploads/2020/08/9.png 894w, https://news.sophos.com/wp-content/uploads/2020/08/9.png?resize=300,292 300w, https://news.sophos.com/wp-content/uploads/2020/08/9.png?resize=768,747 768w, https://news.sophos.com/wp-content/uploads/2020/08/9.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2020/08/9.png?resize=50,50 50w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">10</td>
<td valign="top">Runs the script Delete-AVServices.ps1, which searches a list of malware protection related Windows services and partial service names to search for and kill.</td>
</tr>
<tr>
<td valign="top">11</td>
<td valign="top"> Launches appwiz.cpl , the Add/Remove Programs Windows control panel.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/11.png"><img loading="lazy" class="size-large wp-image-68416" src="https://news.sophos.com/wp-content/uploads/2020/08/11.png?w=640" alt="" width="640" height="372" srcset="https://news.sophos.com/wp-content/uploads/2020/08/11.png 1680w, https://news.sophos.com/wp-content/uploads/2020/08/11.png?resize=300,174 300w, https://news.sophos.com/wp-content/uploads/2020/08/11.png?resize=768,446 768w, https://news.sophos.com/wp-content/uploads/2020/08/11.png?resize=1024,595 1024w, https://news.sophos.com/wp-content/uploads/2020/08/11.png?resize=1536,892 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">12</td>
<td valign="top">Copies and executes the PC Hunter system diagnostics tool.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/12.png"><img loading="lazy" class="size-large wp-image-68415" src="https://news.sophos.com/wp-content/uploads/2020/08/12.png?w=640" alt="" width="640" height="451" srcset="https://news.sophos.com/wp-content/uploads/2020/08/12.png 1296w, https://news.sophos.com/wp-content/uploads/2020/08/12.png?resize=300,212 300w, https://news.sophos.com/wp-content/uploads/2020/08/12.png?resize=768,542 768w, https://news.sophos.com/wp-content/uploads/2020/08/12.png?resize=1024,722 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">13</td>
<td valign="top">Copies, installs and executes ProcessHacker:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/13a.png"><img loading="lazy" class="size-large wp-image-68414" src="https://news.sophos.com/wp-content/uploads/2020/08/13a.png?w=640" alt="" width="640" height="552" srcset="https://news.sophos.com/wp-content/uploads/2020/08/13a.png 858w, https://news.sophos.com/wp-content/uploads/2020/08/13a.png?resize=300,259 300w, https://news.sophos.com/wp-content/uploads/2020/08/13a.png?resize=768,662 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/13b-1.png"><img loading="lazy" class="alignnone wp-image-68492 size-large" src="https://news.sophos.com/wp-content/uploads/2020/08/13b-1.png?w=640" alt="" width="640" height="486" srcset="https://news.sophos.com/wp-content/uploads/2020/08/13b-1.png 1202w, https://news.sophos.com/wp-content/uploads/2020/08/13b-1.png?resize=300,228 300w, https://news.sophos.com/wp-content/uploads/2020/08/13b-1.png?resize=768,583 768w, https://news.sophos.com/wp-content/uploads/2020/08/13b-1.png?resize=1024,777 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">14</td>
<td valign="top">Copies, installs and executes IOBit Unlocker, a utility for removing file locks that would prevent deletion or encryption,</p>
<p><a style="font-family: inherit;font-size: inherit" href="https://news.sophos.com/wp-content/uploads/2020/08/14a.png"><img loading="lazy" class="size-large wp-image-68412" src="https://news.sophos.com/wp-content/uploads/2020/08/14a.png?w=640" alt="" width="640" height="556" srcset="https://news.sophos.com/wp-content/uploads/2020/08/14a.png 852w, https://news.sophos.com/wp-content/uploads/2020/08/14a.png?resize=300,261 300w, https://news.sophos.com/wp-content/uploads/2020/08/14a.png?resize=768,667 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/14b.png"><img loading="lazy" class="size-large wp-image-68411" src="https://news.sophos.com/wp-content/uploads/2020/08/14b.png?w=640" alt="" width="640" height="554" srcset="https://news.sophos.com/wp-content/uploads/2020/08/14b.png 848w, https://news.sophos.com/wp-content/uploads/2020/08/14b.png?resize=300,260 300w, https://news.sophos.com/wp-content/uploads/2020/08/14b.png?resize=768,665 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/14c.png"><img loading="lazy" class="size-large wp-image-68410" src="https://news.sophos.com/wp-content/uploads/2020/08/14c.png?w=640" alt="" width="640" height="555" srcset="https://news.sophos.com/wp-content/uploads/2020/08/14c.png 848w, https://news.sophos.com/wp-content/uploads/2020/08/14c.png?resize=300,260 300w, https://news.sophos.com/wp-content/uploads/2020/08/14c.png?resize=768,667 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">15</td>
<td valign="top">Copies and executes<a href="http://www.gmer.net/"> GMER</a>, a &#8220;rootkit detector&#8221; used to reveal hidden processes.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/15.png"><img loading="lazy" class="size-large wp-image-68409" src="https://news.sophos.com/wp-content/uploads/2020/08/15.png?w=640" alt="" width="640" height="690" srcset="https://news.sophos.com/wp-content/uploads/2020/08/15.png 846w, https://news.sophos.com/wp-content/uploads/2020/08/15.png?resize=278,300 278w, https://news.sophos.com/wp-content/uploads/2020/08/15.png?resize=768,828 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">16</td>
<td valign="top">Copies and executes a freeware version of <a href="https://www.revouninstaller.com/revo-uninstaller-free-download/">Revo Uninstaller</a>, a tool for uninstalling Windows software and cleaning up files left over from an uninstall.</td>
</tr>
<tr>
<td valign="top">17</td>
<td valign="top">Copies and  executes <a href="https://www.iobit.com/en/advanceduninstaller.php">IOBit Uninstaller</a>, another software uninstaller tool.</td>
</tr>
<tr>
<td valign="top">18</td>
<td valign="top">Executes a PowerShell script, &#8220;Disable-WinDefend.ps1 /t&#8221; .</td>
</tr>
<tr>
<td valign="top">20</td>
<td valign="top">Executes a PowerShell script, &#8220;purgeMemory.ps1/&#8221; .</td>
</tr>
<tr>
<td valign="top">21</td>
<td valign="top">Executes takeaway.exe , the payload package that drops the ransomware.</td>
</tr>
<tr>
<td valign="top">22</td>
<td valign="top">Stops the winhost.exe process (the Dharma ransomware executable)</td>
</tr>
<tr>
<td valign="top">23</td>
<td valign="top">Executes a PowerShell script, winhostok.ps1.</td>
</tr>
<tr>
<td valign="top">25</td>
<td valign="top">Calls a function of the script called &#8220;Infect&#8221;, which deploys a file called javsecc.exe — called a &#8220;zombie&#8221; by the Dharma developers.</p>
<figure id="attachment_68475" aria-describedby="caption-attachment-68475" style="width: 415px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/dharma-javsecc.png"><img loading="lazy" class="size-large wp-image-68475" src="https://news.sophos.com/wp-content/uploads/2020/08/dharma-javsecc.png?w=415" alt="" width="415" height="197" srcset="https://news.sophos.com/wp-content/uploads/2020/08/dharma-javsecc.png 415w, https://news.sophos.com/wp-content/uploads/2020/08/dharma-javsecc.png?resize=300,142 300w" sizes="(max-width: 415px) 100vw, 415px" /></a><figcaption id="caption-attachment-68475" class="wp-caption-text">Message box from javsecc.exe</figcaption></figure>
<p>Upon execution, a message box pops up (the window name translates as &#8220;Zombification&#8221;). The message reads:</p>
<p><em>This build is able to destroy the working files of the “zombie”. Continue, when build process is finished. Continue?</em></p>
<p>Clicking &#8220;OK&#8221; executes an AutoIT process that:</p>
<ul>
<li>obtains the external IP address of the system it runs on by calling multiple remote services:
<div> LOCAL $AGETIPURL = [ &#8220;https://api.ipify.org&#8221; , &#8220;http://checkip.dyndns.org&#8221; , &#8220;http://www.myexternalip.com/raw&#8221; , &#8220;http://bot.whatismyipaddress.com&#8221; ]</div>
</li>
<li>downloads and installs a Tor network client (tor.exe) ;</li>
<li>checks install of Tor by pinging the local host address, then deletes temporary files;</li>
<li>collects system information and user account data, and sends to a remote .onion (Tor) server.</li>
<li>sleeps and waits for timer events.</li>
</ul>
<p>&nbsp;</td>
</tr>
<tr>
<td valign="top">30</td>
<td valign="top">Executes  a PowerShell script described as &#8220;Local Network Computer Listing&#8221; by the console output, called  NetPC.ps1.</td>
</tr>
<tr>
<td valign="top">31</td>
<td valign="top">Executes  the PowerShell script NetSubPC.ps1, another network computer name browser.</td>
</tr>
<tr>
<td valign="top">32</td>
<td valign="top">Launches mstsc.exe, the Remote Desktop Connection (RDP) client.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/32.png"><img loading="lazy" class="size-large wp-image-68407" src="https://news.sophos.com/wp-content/uploads/2020/08/32.png?w=640" alt="" width="640" height="560" srcset="https://news.sophos.com/wp-content/uploads/2020/08/32.png 848w, https://news.sophos.com/wp-content/uploads/2020/08/32.png?resize=300,263 300w, https://news.sophos.com/wp-content/uploads/2020/08/32.png?resize=768,672 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">33</td>
<td valign="top">Copies  and starts ns2.exe, a known PUA. The executable can scan for network shares and local unmounted volumes.</td>
</tr>
<tr>
<td valign="top">34</td>
<td valign="top">Copies and starts <a href="https://www.advanced-ip-scanner.com/"> Advanced IP Scanner</a> (IPScan2.exe),  a commercial freeware tool that can identify and access shared network folders, control other computers on the network via RDP and Radmin remote control software, and execute remote shutdowns.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/34.png"><img loading="lazy" class="size-large wp-image-68406" src="https://news.sophos.com/wp-content/uploads/2020/08/34.png?w=640" alt="" width="640" height="372" srcset="https://news.sophos.com/wp-content/uploads/2020/08/34.png 1680w, https://news.sophos.com/wp-content/uploads/2020/08/34.png?resize=300,174 300w, https://news.sophos.com/wp-content/uploads/2020/08/34.png?resize=768,446 768w, https://news.sophos.com/wp-content/uploads/2020/08/34.png?resize=1024,595 1024w, https://news.sophos.com/wp-content/uploads/2020/08/34.png?resize=1536,892 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">40</td>
<td valign="top">Retrieves a list of computers from Active Directory by running NetADPC.ps1.</td>
</tr>
<tr>
<td valign="top">41</td>
<td valign="top">Executes a PowerShell script named adbrute.ps1 (likely another Mimikatz scripted brute force attack on Active Directory accounts).</td>
</tr>
<tr>
<td valign="top">42</td>
<td valign="top">Copies and executes a PowerShell script named 2sys.ps1.</td>
</tr>
<tr>
<td valign="top">43</td>
<td valign="top">Launches the Windows Active Directory management snap-in (dsa.msc).</td>
</tr>
<tr>
<td valign="top">44</td>
<td valign="top">Launches  the Group Policy Management Console snapin (gpmc.msc).</td>
</tr>
<tr>
<td valign="top">45</td>
<td valign="top">Runs &#8220;Mimi NL,&#8221; a more automated version of the Mimikatz password hacking tool. This tool appears to have been developed by the Dharma RaaS developers.</p>
<p><a style="font-family: inherit;font-size: inherit" href="https://news.sophos.com/wp-content/uploads/2020/08/45.png"><img loading="lazy" class="size-large wp-image-68404" src="https://news.sophos.com/wp-content/uploads/2020/08/45.png?w=640" alt="" width="640" height="559" srcset="https://news.sophos.com/wp-content/uploads/2020/08/45.png 850w, https://news.sophos.com/wp-content/uploads/2020/08/45.png?resize=300,262 300w, https://news.sophos.com/wp-content/uploads/2020/08/45.png?resize=768,670 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>&nbsp;</td>
</tr>
<tr>
<td valign="top">50</td>
<td valign="top">Opens the %TEMP% directory in a Windows file explorer window.</p>
<p><figure id="attachment_68403" aria-describedby="caption-attachment-68403" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/50.png"><img loading="lazy" class="size-large wp-image-68403" src="https://news.sophos.com/wp-content/uploads/2020/08/50.png?w=640" alt="" width="640" height="604" srcset="https://news.sophos.com/wp-content/uploads/2020/08/50.png 848w, https://news.sophos.com/wp-content/uploads/2020/08/50.png?resize=300,283 300w, https://news.sophos.com/wp-content/uploads/2020/08/50.png?resize=768,725 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-68403" class="wp-caption-text">50</figcaption></figure></td>
</tr>
<tr>
<td valign="top">51</td>
<td valign="top">Launches Windows Task Manager.</p>
<p><figure id="attachment_68402" aria-describedby="caption-attachment-68402" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/51.png"><img loading="lazy" class="size-large wp-image-68402" src="https://news.sophos.com/wp-content/uploads/2020/08/51.png?w=640" alt="" width="640" height="554" srcset="https://news.sophos.com/wp-content/uploads/2020/08/51.png 850w, https://news.sophos.com/wp-content/uploads/2020/08/51.png?resize=300,260 300w, https://news.sophos.com/wp-content/uploads/2020/08/51.png?resize=768,665 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-68402" class="wp-caption-text">51</figcaption></figure></td>
</tr>
<tr>
<td valign="top">52</td>
<td valign="top">Opens a PowerShell shell.</p>
<p><figure id="attachment_68401" aria-describedby="caption-attachment-68401" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/08/52.png"><img loading="lazy" class="size-large wp-image-68401" src="https://news.sophos.com/wp-content/uploads/2020/08/52.png?w=640" alt="" width="640" height="400" srcset="https://news.sophos.com/wp-content/uploads/2020/08/52.png 848w, https://news.sophos.com/wp-content/uploads/2020/08/52.png?resize=300,188 300w, https://news.sophos.com/wp-content/uploads/2020/08/52.png?resize=768,480 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-68401" class="wp-caption-text">52</figcaption></figure></td>
</tr>
<tr>
<td valign="top">53</td>
<td valign="top">Opens a command shell.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/53.png"><img loading="lazy" class="size-large wp-image-68400" src="https://news.sophos.com/wp-content/uploads/2020/08/53.png?w=640" alt="" width="640" height="387" srcset="https://news.sophos.com/wp-content/uploads/2020/08/53.png 850w, https://news.sophos.com/wp-content/uploads/2020/08/53.png?resize=300,181 300w, https://news.sophos.com/wp-content/uploads/2020/08/53.png?resize=768,464 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">54</td>
<td valign="top">Runs rdclip.exe, the Remote Desktop shared clipboard.</td>
</tr>
<tr>
<td valign="top">55</td>
<td valign="top">Reboots the computer.</td>
</tr>
<tr>
<td valign="top">56</td>
<td valign="top">Copies and executes ClearLock.exe, a screen locker.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/56a.png"><img loading="lazy" class="size-large wp-image-68399" src="https://news.sophos.com/wp-content/uploads/2020/08/56a.png?w=640" alt="" width="640" height="556" srcset="https://news.sophos.com/wp-content/uploads/2020/08/56a.png 850w, https://news.sophos.com/wp-content/uploads/2020/08/56a.png?resize=300,260 300w, https://news.sophos.com/wp-content/uploads/2020/08/56a.png?resize=768,667 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/56b.png"><img loading="lazy" class="size-large wp-image-68398" src="https://news.sophos.com/wp-content/uploads/2020/08/56b.png?w=640" alt="" width="640" height="557" srcset="https://news.sophos.com/wp-content/uploads/2020/08/56b.png 846w, https://news.sophos.com/wp-content/uploads/2020/08/56b.png?resize=300,261 300w, https://news.sophos.com/wp-content/uploads/2020/08/56b.png?resize=768,668 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">57</td>
<td valign="top">Executes a PowerShell script called  wallet.ps1.</td>
</tr>
<tr>
<td valign="top">60</td>
<td valign="top">Copies and executes a batch script, addSupport.bat.</td>
</tr>
<tr>
<td valign="top">61</td>
<td valign="top">Copies and executes a published proof-of-concept privilege escalation exploit (CVE-2018-8120) —either the 32-bit (x86.exe) or 64-bit (x64.exe) version.</td>
</tr>
<tr>
<td valign="top">99</td>
<td valign="top">Starts toolbelt1.ps1  (which could be updated version of toolbelt).</td>
</tr>
<tr>
<td valign="top">88</td>
<td valign="top">Enables WinRM remote management using the WS-Management protocol, This allows administrative commands to be sent to the computer via an HTTP request from any IP address.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/08/88.png"><img loading="lazy" class="size-large wp-image-68395" src="https://news.sophos.com/wp-content/uploads/2020/08/88.png?w=640" alt="" width="640" height="555" srcset="https://news.sophos.com/wp-content/uploads/2020/08/88.png 848w, https://news.sophos.com/wp-content/uploads/2020/08/88.png?resize=300,260 300w, https://news.sophos.com/wp-content/uploads/2020/08/88.png?resize=768,667 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></td>
</tr>
<tr>
<td valign="top">101</td>
<td valign="top">Copies and executes a program called SafeMode, launched with a batch script called AsAdmin.bat. (We did not recover these files for analysis.)</td>
</tr>
<tr>
<td valign="top">155</td>
<td valign="top">Copies and executes <a href="https://registry-finder.com/">Registry Finder,</a> a tool for editing Windows&#8217; Registry.</td>
</tr>
<tr>
<td valign="top">211</td>
<td valign="top">Copies and executes the Dharma payload package from the  path mapped to the attacker&#8217;s computer: $tsclient\x\1\Takeaway.exe.</td>
</tr>
<tr>
<td valign="top">212</td>
<td valign="top">Copies and executes the Dharma payload package from the path $tsclient\x\2\Takeaway.exe.</td>
</tr>
<tr>
<td valign="top">213</td>
<td valign="top">Copies and executes the  Dharpayload package from the path $tsclient\x\3\Takeaway.exe.</td>
</tr>
<tr>
<td valign="top">214</td>
<td valign="top">Copies and executes payload package from the path $tsclient\x\4\Takeaway.exe.</td>
</tr>
<tr>
<td valign="top">222</td>
<td valign="top">Copies  and executes javsec.exe, another automated Mimikatz password cracking tool built with AutoIT. The executable runs mimikatz.exe and a disguised version of the NL Brute utility named postgresqlapi.exe (a network login brute force tool).</td>
</tr>
<tr>
<td valign="top">223</td>
<td valign="top">Opens the directories $env\temp\$guid and $env\appdata\PostgreSQL\API\$guid (probably for temporary storage)</td>
</tr>
<tr>
<td valign="top">224</td>
<td valign="top">Performs &#8220;cleanup&#8221; by deleting processes tor, torque, and PostGreSQLapi.exe, and clears the directories $envtemp\$guid and $env\appdata\PostgreSQL\API\$guid.</td>
</tr>
<tr>
<td valign="top">300</td>
<td valign="top">Unpacks and executes the contents of the package LBru4v4.zip</td>
</tr>
<tr>
<td valign="top">401</td>
<td valign="top">Copies a directory called &#8220;WMIDomain&#8221; from the toolset share and executes a PowerShell script called GetHosts.ps1.</td>
</tr>
<tr>
<td valign="top">600</td>
<td valign="top">Kills all processes except for PowerShell and unnamed windows.</td>
</tr>
<tr>
<td valign="top">666</td>
<td valign="top">Executes a PowerShell command that writes a new script called &#8220;sample.ps1&#8221; from the contents of the Windows clipboard. That script is then executed in opens a command shell with the permissions of an account passed to the script with an environmental variable and a password encoded into the command opening the PowerShell shell (2qaz!QAZ).</p>
<pre>{try {Add-Type -AssemblyName PresentationCore`
$clip = [Windows.Clipboard]::GetText()`
$clip | Out-File $destination\sample.ps1}`
catch {RedAlert Failed to copy vicious code. Try 52, then right click...}`
start  $PsHome\powershell.exe " -NoProfile -ExecutionPolicy Bypass -File $destination\sample.ps1" -Verb RunAs }`
- {start -FilePath cmd.exe -ArgumentList "/c net user $env:USERNAME 2qaz!QAZ &amp; pause"}`</pre>
<p>The pasted code executes Takeaway.exe, the Dharma payload. If the code creation fails, the script advises the attacker to use menu entry 52 to respawn PowerShell.</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>The order of the use of the toolbelt.ps1 script varies, but we have observed common patterns among Dharma attackers. In one typical attack, we saw the operators follow the following steps:</p>
<ul>
<li>The attacker launched the toolbelt script (toolbelt.ps1 -it 1)</li>
<li><span style="font-size: 1em">10: delete-avservices.ps1</span></li>
<li>15: GMER (gamer.exe)</li>
<li>13: installing and launching ProcessHacker
<ul>
<li>executing processhacker-2.39-setup.exe</li>
<li>executing processhacker.exe</li>
</ul>
</li>
<li>222: javsec.exe (Mimikatz /NL Brute wrapper)</li>
<li>34: ipscan2.exe (Advanced IP Scanner)</li>
<li>32: mstsc.exe</li>
<li><span style="font-size: 1em">21: takeaway.exe (ransomware package) </span>
<ul>
<li><span style="font-size: 1em">executes</span> winhost.exe (Dharma)</li>
<li>executes purgememory.ps1</li>
</ul>
</li>
<li><span style="font-size: 1em">33: ns2.exe (network scan)</span></li>
</ul>
<h3>Playing by the book</h3>
<p>While the toolbelt.ps1 script is somewhat self-documenting, it&#8217;s clear that the end users of the script—the Dharma affiliates—are also operating from some other form of documentation.  The &#8220;toolbelt&#8221; gives them all the access they need to move laterally across the network, exploiting domain administrator level credentials that they either steal or create through elevated privileges, but it&#8217;s not clear how fully automated some of the steps of that process are. Those steps are likely detailed in a how-to document created by the Dharma RaaS operators.</p>
<p>The ease with which Dharma attackers are able to take these tools and effectively spread ransomware on victims&#8217; networks demonstrates the risks posed by both grey hat and legitimate but potentially unwanted administrative tools. And it underlines the risks associated with improperly secured RDP servers, the major vector for most targeted ransomware attacks.  Given that many of these attacks are made with stolen credentials purchased in forums, the Dharma attacks may be just one of many intrusions onto victims&#8217; networks.</p>
<p>The majority of these Dharma affiliate attacks can be blunted by ensuring  RDP servers are patched and secured behind a VPN with multi-factor authentication. Organizations need to remain vigilant about credential theft through phishing, particularly as they adjust to having more employees working remotely. And attention needs to be paid to access given to to service providers and other third parties for business purposes.</p>
<p>Sophos detects the tools mentioned in this report as malware or PUAs. And data collected by Sophos MTR helps continuously improve detections of Dharma attacks. A full list of indicators of compromise, including detection names for the tools and malware mentioned in this report, can be found on <a href="https://github.com/sophoslabs/IoCs/blob/master/Ransomware-Dharma-RaaS.csv">SophosLabs&#8217; GitHub page here</a>.</p>
<h2>SophosLabs would like to acknowledge the contributions of Anand  Ajjan, Andrew O&#8217;Donnell and Gabor Szappanos of SophosLabs, and  Syed Shahram Ahmed and Peter Mackenzie of the Sophos MTR Incident Response team to this report.</h2>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/08/11/demo-find-open-rdp-sessions-using-sophos-live-discover/" rel="prev">Demo: Find open RDP sessions using Sophos Live Discover</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/08/17/new-sophos-support-portal-now-available/" rel="next">New Sophos Support Portal now available</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="145" src="https://news.sophos.com/wp-content/uploads/2020/02/sean-gallagher.jpg?w=145" class="avatar avatar-145 photo wp-post-image" alt="Sean Gallagher" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a></h3>

					
					<div class="author-bio">
						<p>Sean Gallagher is a Senior Threat Researcher at Sophos. </p>
<p>Previously, Gallagher was IT and National Security Editor at Ars Technica, where he focused on information security and digital privacy issues, cybercrime, cyber espionage and cyber warfare. He has been a security researcher, technology journalist and information technology practitioner for over 20 years.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/08/12/color-by-numbers-inside-a-dharma-ransomware-as-a-service-attack/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='68392' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0c63304ebb" /></p><input type="hidden" id="ak_js" name="ak_js" value="68"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkEEOwiAQRS8kIF20K+NRDLZjS8sAYcDq7R3TNHHhomTY8Hnvk4xao+iDz+CzyhMgkKIQp0AeVhLNWXdqJj4MhcWCeDaykZoDuQVyppM61NGHVEHDKydDx/ktkiVbV2/1BqOxo68Wo0nZQ6r2RlOtfLNdsr53ZQDa1orIBSJBdG+J1v+D+Ap4h+H3ff8Zi4iujNaTMoslhKxu7KpHSMjsFS+65em0PrfzB20wygw='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'68392',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '68392' ]);
</script>
</body>
</html>
