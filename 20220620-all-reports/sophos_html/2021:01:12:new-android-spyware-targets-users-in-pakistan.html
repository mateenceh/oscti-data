<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>New Android spyware targets users in Pakistan &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; New Android spyware targets users in Pakistan Comments Feed" href="https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615460519' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpmWEWAK8/Ihc='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/70449" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/" />
<link rel='shortlink' href='https://news.sophos.com/?p=70449' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F01%2F12%2Fnew-android-spyware-targets-users-in-pakistan%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F01%2F12%2Fnew-android-spyware-targets-users-in-pakistan%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="New Android spyware targets users in Pakistan" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/" />
<meta property="og:description" content="The apps seem focused on stealing sensitive data from the phones of Pakistani residents" />
<meta property="article:published_time" content="2021-01-12T14:00:07+00:00" />
<meta property="article:modified_time" content="2021-01-12T16:42:32+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="358" />
<meta property="og:image:alt" content="spy stands in front of badshahi-mosque-lahore-pakistan" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="New Android spyware targets users in Pakistan" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?w=640" />
<meta name="twitter:image:alt" content="spy stands in front of badshahi-mosque-lahore-pakistan" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-70449 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-70449" class="post-70449 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-android-malware tag-fake-app tag-pakistan tag-pakistan-citizen-portal tag-pmdu tag-prime-ministers-delivery-unit tag-spyware region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">New Android spyware targets users in Pakistan</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/android-malware/">Android malware</a>&bull;<a href="https://news.sophos.com/en-us/tag/fake-app/">Fake App</a>&bull;<a href="https://news.sophos.com/en-us/tag/pakistan/">Pakistan</a>&bull;<a href="https://news.sophos.com/en-us/tag/pakistan-citizen-portal/">Pakistan Citizen Portal</a>&bull;<a href="https://news.sophos.com/en-us/tag/pmdu/">PMDU</a>&bull;<a href="https://news.sophos.com/en-us/tag/prime-ministers-delivery-unit/">Prime Minister's Delivery Unit</a>&bull;<a href="https://news.sophos.com/en-us/tag/spyware/">spyware</a>		</div>

					<div class="entry-excerpt">
				<p>The apps seem focused on stealing sensitive data from the phones of Pakistani residents</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/" rel="bookmark">12 January 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				1			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=New%20Android%20spyware%20targets%20users%20in%20Pakistan%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D70449" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=70449&#038;title=New%20Android%20spyware%20targets%20users%20in%20Pakistan" data-title="New Android spyware targets users in Pakistan" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/"
				data-title="New Android spyware targets users in Pakistan"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="358" src="https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="spy stands in front of badshahi-mosque-lahore-pakistan" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png 1805w, https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?resize=300,168 300w, https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?resize=768,430 768w, https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?resize=1024,573 1024w, https://news.sophos.com/wp-content/uploads/2020/12/featured-image-30pct.png?resize=1536,859 1536w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/pankaj-kohli/" title="Posts by Pankaj Kohli" class="author url fn" rel="author">Pankaj Kohli</a></span><span class="author vcard"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>SophosLabs has discovered a small cluster of Trojanized versions of Android apps, mainly marketed to people who live in Pakistan. Someone has modified these otherwise legitimate apps (clean versions are available for download on the Google Play Store) to add malicious features that seem completely focused on covert surveillance and espionage.</p>
<p>The modified apps look identical to their legitimate counterparts, and even perform their normal functions, but are designed to, initially, profile the phone, and then download a payload in the form of an Android Dalvik executable (DEX) file. The DEX payload contains most of the malicious features, which include the ability to covertly exfiltrate sensitive data like the user&#8217;s contact list and the full contents of SMS messages. The app then sends this information to one of a small number of command-and-control websites hosted on servers located in eastern Europe.</p>
<p>The selection of apps is highly peculiar, as they are neither the most popular, nor particularly unique, apps. There&#8217;s no indication that the publishers of the original apps are aware that these Trojanized versions even exist. The highest-profile app Trojanized in this way is the Pakistan Citizen Portal app, published by the government of Pakistan, but the Trojanized version never appeared in any legitimate market, as far as we know. (SophosLabs made multiple attempts to disclose this information to the government of Pakistan, the publisher of the app, prior to publication.)</p>
<figure id="attachment_70453" aria-describedby="caption-attachment-70453" style="width: 633px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-70453" style="font-size: 1em;" src="https://news.sophos.com/wp-content/uploads/2020/10/citizenportalgp.png" alt="The Pakistan Citizen Portal Google Play Store listing" width="633" height="523" srcset="https://news.sophos.com/wp-content/uploads/2020/10/citizenportalgp.png 677w, https://news.sophos.com/wp-content/uploads/2020/10/citizenportalgp.png?resize=300,248 300w" sizes="(max-width: 633px) 100vw, 633px" /><figcaption id="caption-attachment-70453" class="wp-caption-text">We found several maliciously modified versions of the official Pakistan Citizen Portal app, whose Google Play listing is shown here.</figcaption></figure>
<p><a href="https://www.virustotal.com/gui/file/0785e57d59fe9651ac7452ec9c4b04dec2185dfcefad10ce9b0fa077c4aaac02/relations" target="_blank" rel="noopener">Virustotal records</a> indicated that at least one of the malware samples had been hosted at the website <strong>pmdu.info</strong>, a domain registered for the first time in early August of this year. A TLS certificate was issued to the site on August 9th. The site appears to be a very good mimicry of a Google Play Store page blended with elements from the real Pakistan Citizen Portal page hosted by the Pakistani government. It isn&#8217;t perfect, though: its banner image at the top of the page is broken, cutting off the right edge of some text.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/12/fake-pmdu-info-domain-page.png"><img loading="lazy" class="alignnone size-full wp-image-71762" src="https://news.sophos.com/wp-content/uploads/2020/12/fake-pmdu-info-domain-page.png" alt="" width="640" height="460" srcset="https://news.sophos.com/wp-content/uploads/2020/12/fake-pmdu-info-domain-page.png 984w, https://news.sophos.com/wp-content/uploads/2020/12/fake-pmdu-info-domain-page.png?resize=300,216 300w, https://news.sophos.com/wp-content/uploads/2020/12/fake-pmdu-info-domain-page.png?resize=768,552 768w" sizes="(max-width: 640px) 100vw, 640px" /></a>And the website has an interesting take on copyright.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/01/copyright-notice-pmdu-info-detail-highlight.png"><img loading="lazy" class="alignnone size-full wp-image-71931" src="https://news.sophos.com/wp-content/uploads/2021/01/copyright-notice-pmdu-info-detail-highlight.png" alt="" width="428" height="166" srcset="https://news.sophos.com/wp-content/uploads/2021/01/copyright-notice-pmdu-info-detail-highlight.png 428w, https://news.sophos.com/wp-content/uploads/2021/01/copyright-notice-pmdu-info-detail-highlight.png?resize=300,116 300w" sizes="(max-width: 428px) 100vw, 428px" /></a>The Pakistan Citizen Portal app was created in 2019 by a government agency called the PMDU, but its real website falls under the <strong>.gov.pk</strong> domain, hosted on its own territory. This site was hosted on the IP address 5.2.78.240, an IP address that geolocates to the Netherlands.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/12/site-source-code.png"><img loading="lazy" class="alignnone size-full wp-image-71764" src="https://news.sophos.com/wp-content/uploads/2020/12/site-source-code.png" alt="" width="640" height="179" srcset="https://news.sophos.com/wp-content/uploads/2020/12/site-source-code.png 990w, https://news.sophos.com/wp-content/uploads/2020/12/site-source-code.png?resize=300,84 300w, https://news.sophos.com/wp-content/uploads/2020/12/site-source-code.png?resize=768,215 768w" sizes="(max-width: 640px) 100vw, 640px" /></a>The .info page has two buttons, labeled <em>Google Play</em> and <em>Download App</em>, but the source code for the site reveals that no matter which link you click, you get the same APK file hosted on the .info domain &#8211; <a href="https://www.virustotal.com/gui/file/0785e57d59fe9651ac7452ec9c4b04dec2185dfcefad10ce9b0fa077c4aaac02/detection" target="_blank" rel="noopener">the malicious version</a>.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/12/ITW-URLs.png"><img loading="lazy" class="alignnone size-full wp-image-71643" src="https://news.sophos.com/wp-content/uploads/2020/12/ITW-URLs.png" alt="" width="640" height="92" srcset="https://news.sophos.com/wp-content/uploads/2020/12/ITW-URLs.png 785w, https://news.sophos.com/wp-content/uploads/2020/12/ITW-URLs.png?resize=300,43 300w, https://news.sophos.com/wp-content/uploads/2020/12/ITW-URLs.png?resize=768,111 768w" sizes="(max-width: 640px) 100vw, 640px" /></a>While digging around for links to the .info version of the domain, we stumbled upon a reference to the domain hosting the malware in a surprising location: Atop the page for an official Pakistani governmental department, the Trading Corporation of Pakistan (or TCP).</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-1.png"><img loading="lazy" class="alignnone wp-image-71646 size-full" src="https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-1.png" alt="" width="1918" height="602" srcset="https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-1.png 1918w, https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-1.png?resize=300,94 300w, https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-1.png?resize=768,241 768w, https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-1.png?resize=1024,321 1024w, https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-1.png?resize=1536,482 1536w" sizes="(max-width: 1918px) 100vw, 1918px" /></a>This banner appeared atop the TCP website for several weeks.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-crop.png"><img loading="lazy" class="alignnone size-full wp-image-71645" src="https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-crop.png" alt="" width="425" height="175" srcset="https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-crop.png 425w, https://news.sophos.com/wp-content/uploads/2020/12/pakistan-citizen-portal-reference-to-faux-domain-crop.png?resize=300,124 300w" sizes="(max-width: 425px) 100vw, 425px" /></a>The text of the domain name hosting the malicious Android app was prominently displayed in one of a series of rotating banners atop the web page for this division of the country&#8217;s Ministry of Commerce. The link was not clickable, as the entire thing is one large static image.</p>
<p>Targets of the malware may have received links via SMS messages or email instructing them to download the app from the fake Pakistan Citizen Portal webpage. Why someone would then deface a web page to add the bogus domain is harder to understand.</p>
<p>Complicating matters, on January 10, 2021, as we prepared to publish this story, the TCP webpage was replaced with just a single line of text: <em>Hacked by 9bandz</em></p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/01/tcp-website-defacement_clean-with-logo.png"><img loading="lazy" class="alignnone size-full wp-image-71926" src="https://news.sophos.com/wp-content/uploads/2021/01/tcp-website-defacement_clean-with-logo.png" alt="" width="430" height="186" srcset="https://news.sophos.com/wp-content/uploads/2021/01/tcp-website-defacement_clean-with-logo.png 430w, https://news.sophos.com/wp-content/uploads/2021/01/tcp-website-defacement_clean-with-logo.png?resize=300,130 300w" sizes="(max-width: 430px) 100vw, 430px" /></a>A cursory search for this name revealed at least 93 websites that have been identically defaced, their contents replaced with a similar message since October, 2020. A user of a crimeware forum with a user with the same name also posted this advertisement for &#8220;selling government web shells with full access to directories and files&#8221; in December.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/01/9bandz-shell-with-logo-name-blanked-out.png"><img loading="lazy" class="alignnone wp-image-71928 size-full" src="https://news.sophos.com/wp-content/uploads/2021/01/9bandz-shell-with-logo-name-blanked-out.png" alt="" width="925" height="511" srcset="https://news.sophos.com/wp-content/uploads/2021/01/9bandz-shell-with-logo-name-blanked-out.png 925w, https://news.sophos.com/wp-content/uploads/2021/01/9bandz-shell-with-logo-name-blanked-out.png?resize=300,166 300w, https://news.sophos.com/wp-content/uploads/2021/01/9bandz-shell-with-logo-name-blanked-out.png?resize=768,424 768w" sizes="(max-width: 925px) 100vw, 925px" /></a>While there&#8217;s no evidence tying this action to the person who claimed the defacement, it&#8217;s hard to ignore the correlation.</p>
<h3>More Trojanized apps</h3>
<p>In addition to the official Pakistan Citizen Portal (<a href="https://play.google.com/store/apps/details?id=com.govpk.citizensportal&amp;hl=en_US&amp;gl=US" target="_blank" rel="noopener">com.govpk.citizensportal</a>) app, we also found modified versions of a muslim prayer-clock app called Pakistan Salat Time (<a href="https://play.google.com/store/apps/details?id=com.tos.salattime.pakistan&amp;hl=en_US&amp;gl=US" target="_blank" rel="noopener">com.tos.salattime.pakistan</a>); an app used to price-compare mobile phone plans called Mobile Packages Pakistan (<a href="https://play.google.com/store/apps/details?id=com.blogspot.istcpublishers.mobilepackagespakistan&amp;hl=en_US&amp;gl=US" target="_blank" rel="noopener">com.blogspot.istcpublishers.mobilepackagespakistan</a>); a utility that can check a phone&#8217;s SIM card for validity called Registered SIMs Checker (<a href="https://play.google.com/store/apps/details?id=com.siminformation.checker&amp;hl=en_US&amp;gl=US" target="_blank" rel="noopener">com.siminformation.checker</a>), and a maliciously modified version of the app published by TPL Insurance (<a href="https://play.google.com/store/apps/details?id=com.tpl.insuranceapp&amp;hl=en_US&amp;gl=US" target="_blank" rel="noopener">com.tpl.insuranceapp</a>), a company that describes itself as &#8220;the first insurance company in Pakistan to sell general insurance products directly to the consumer.&#8221;</p>
<p>One anomalous app we could find no specific benign analogue of called itself Pakistan Chat (com.PakistanChatMessenger). This app appears to leverage the API of an otherwise legitimate chat service called ChatGum, and connects to a ChatGum server, but also conducts covert surveillance and exfiltration of data from the user&#8217;s phone.</p>
<figure id="attachment_71398" aria-describedby="caption-attachment-71398" style="width: 352px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/12/tplinsurance_permissions.png"><img loading="lazy" class="wp-image-71398" src="https://news.sophos.com/wp-content/uploads/2020/12/tplinsurance_permissions.png" alt="Malicious android app permissions list" width="352" height="625" srcset="https://news.sophos.com/wp-content/uploads/2020/12/tplinsurance_permissions.png 1080w, https://news.sophos.com/wp-content/uploads/2020/12/tplinsurance_permissions.png?resize=169,300 169w, https://news.sophos.com/wp-content/uploads/2020/12/tplinsurance_permissions.png?resize=768,1365 768w, https://news.sophos.com/wp-content/uploads/2020/12/tplinsurance_permissions.png?resize=576,1024 576w, https://news.sophos.com/wp-content/uploads/2020/12/tplinsurance_permissions.png?resize=864,1536 864w" sizes="(max-width: 352px) 100vw, 352px" /></a><figcaption id="caption-attachment-71398" class="wp-caption-text">The malicious insurance app requires users to give the app virtually full control over any sensitive data stored on the device. The benign version of the app does not request the same permissions.</figcaption></figure>
<p>The apps all feature, as their primary set of functions, code that appears to be focused on espionage and covert data exfiltration: When run, the apps initially send the device&#8217;s unique IMEI identifier and a timestamp along with a username and password combination (<strong>a#</strong> and <strong>def</strong>, respectively), to a command-and-control (C2) server by means of an HTTP POST request to the server.</p>
<p>Immediately after submitting this information, the app retrieves a<a href="https://source.android.com/devices/tech/dalvik/dex-format" target="_blank" rel="noopener"> DEX</a> payload, then begins in earnest to HTTP POST a series of data bursts. In most cases the payload was named <strong>class.dex</strong>, but the Trojanized TPL Insurance app, retrieves a payload named <strong>class_tpl.dex</strong>.</p>
<p>After the app loads the DEX file payload, it begins a series of uploads of data to its C2. The malware sends detailed profile information about the phone, location information, the user&#8217;s full contact list, the contents of text messages, call logs, and the full directory listing of any internal or SD card storage on the device.</p>
<p>We left the Pakistan Salat Time running on a test device for several days, but did not interact with the phone during that time; Four days after installing the app, when we unlocked the phone, the app began exfiltrating at a rapid pace, transmitting not only the contents of messages, but every one of a directory full of screenshots created in the course of this research.</p>
<p>The Pakistan Citizen Portal app prompts the user to enter their national ID credentials, such as their national identity card (CNIC) number, their passport details, and the username and password for Facebook and other accounts. In tests, this information was exfiltrated along with the rest.</p>
<div id='gallery-1' class='gallery galleryid-70449 gallery-columns-3 gallery-size-large'><figure class='gallery-item'>
			<div class='gallery-icon portrait'>
				<img width="576" height="1024" src="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-111622.png?w=576" class="attachment-large size-large" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-111622.png 1080w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-111622.png?resize=169,300 169w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-111622.png?resize=768,1365 768w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-111622.png?resize=576,1024 576w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-111622.png?resize=864,1536 864w" sizes="(max-width: 576px) 100vw, 576px" />
			</div></figure><figure class='gallery-item'>
			<div class='gallery-icon portrait'>
				<img width="576" height="1024" src="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112136.png?w=576" class="attachment-large size-large" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112136.png 1080w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112136.png?resize=169,300 169w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112136.png?resize=768,1365 768w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112136.png?resize=576,1024 576w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112136.png?resize=864,1536 864w" sizes="(max-width: 576px) 100vw, 576px" />
			</div></figure><figure class='gallery-item'>
			<div class='gallery-icon portrait'>
				<img width="576" height="1024" src="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112416.png?w=576" class="attachment-large size-large" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112416.png 1080w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112416.png?resize=169,300 169w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112416.png?resize=768,1365 768w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112416.png?resize=576,1024 576w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112416.png?resize=864,1536 864w" sizes="(max-width: 576px) 100vw, 576px" />
			</div></figure><figure class='gallery-item'>
			<div class='gallery-icon portrait'>
				<img width="576" height="1024" src="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112546.png?w=576" class="attachment-large size-large" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112546.png 1080w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112546.png?resize=169,300 169w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112546.png?resize=768,1365 768w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112546.png?resize=576,1024 576w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112546.png?resize=864,1536 864w" sizes="(max-width: 576px) 100vw, 576px" />
			</div></figure><figure class='gallery-item'>
			<div class='gallery-icon portrait'>
				<img width="576" height="1024" src="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112755.png?w=576" class="attachment-large size-large" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112755.png 1080w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112755.png?resize=169,300 169w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112755.png?resize=768,1365 768w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112755.png?resize=576,1024 576w, https://news.sophos.com/wp-content/uploads/2020/10/Screenshot_20201030-112755.png?resize=864,1536 864w" sizes="(max-width: 576px) 100vw, 576px" />
			</div></figure>
		</div>

<p>In each sample we ran, when we first installed the spyware, it hints at its intentions by requesting some fairly privacy-invasive permissions, such as the ability to read SMS messages and contact lists, that allow it to read the relevant data on a victim&#8217;s device.</p>
<figure id="attachment_71541" aria-describedby="caption-attachment-71541" style="width: 541px" class="wp-caption alignnone"><a style="font-size: 1em;" href="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_sms_exfil_submit_s.png"><img loading="lazy" class="wp-image-71541" src="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_sms_exfil_submit_s.png" alt="A packet capture of the malware stealing SMS messages" width="541" height="554" srcset="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_sms_exfil_submit_s.png 774w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_sms_exfil_submit_s.png?resize=293,300 293w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_sms_exfil_submit_s.png?resize=768,786 768w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_sms_exfil_submit_s.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_sms_exfil_submit_s.png?resize=50,50 50w" sizes="(max-width: 541px) 100vw, 541px" /></a><figcaption id="caption-attachment-71541" class="wp-caption-text">The Pakistan Salat Time app was caught exfiltrating the contents of SMS text messages, and all the photos on the infected phone, to its C2 server</figcaption></figure>
<p>While a few of these permissions might be appropriate under limited circumstances, depending on the app, the sheer number of them in apps that seemingly have no reason to ask for them &#8212; for instance, in the Salat Time (muslim prayer clock) app shown below &#8212; may tip the threat actor&#8217;s hand and make it easier for an attentive user to notice the excessive permissions requests, and cancel the installation.</p>
<figure id="attachment_71396" aria-describedby="caption-attachment-71396" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png"><img loading="lazy" class="size-full wp-image-71396" src="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png" alt="Android permissions comparison between benign and malicious apps" width="640" height="456" srcset="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png 2136w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png?resize=300,214 300w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png?resize=768,548 768w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png?resize=1024,730 1024w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png?resize=1536,1095 1536w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime-permissions-comparison.png?resize=2048,1460 2048w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-71396" class="wp-caption-text">The intrusive permissions requested by the malicious versions of the apps hinted at the apps&#8217; intentions. By comparison, the benign (left) version of <em>Pakistan Salat Time</em> requires no special permissions at installation in order to work.</figcaption></figure>
<h3>Under the hood</h3>
<p>The AndroidManifest.xml file in an app declares things like the names of services and receivers. In these spyware apps, the manifest file listed several additional services and receivers that appear to reference a section of the malicious code that we couldn&#8217;t find. We suspect these might be reserved for features that have yet to be implemented. The service names &#8220;SoundRecordService&#8221; and &#8220;CallRecordService&#8221; seem to be in character with the espionage focus of the app.</p>
<figure id="attachment_70554" aria-describedby="caption-attachment-70554" style="width: 453px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-70554" src="https://news.sophos.com/wp-content/uploads/2020/11/axml.png" alt="" width="453" height="45" srcset="https://news.sophos.com/wp-content/uploads/2020/11/axml.png 453w, https://news.sophos.com/wp-content/uploads/2020/11/axml.png?resize=300,30 300w" sizes="(max-width: 453px) 100vw, 453px" /><figcaption id="caption-attachment-70554" class="wp-caption-text">Additional services and receiver in AndroidManifest.xml</figcaption></figure>
<p>In the course of uploading the data from a phone, the malware received a JSON-format configuration in plain text that references these features.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_config-from-c2.png"><img loading="lazy" class="alignnone size-full wp-image-71539" src="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_config-from-c2.png" alt="" width="640" height="84" srcset="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_config-from-c2.png 907w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_config-from-c2.png?resize=300,39 300w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_salattime_config-from-c2.png?resize=768,101 768w" sizes="(max-width: 640px) 100vw, 640px" /></a>The spyware components take the form of one of two additional packages compiled into the final app. In the malicious apps, these are named <strong>com.android.volley</strong> or <strong>com.android.update</strong>. This may be an attempt to disguise the contents of the libraries; there&#8217;s a completely benign <a href="https://developer.android.com/training/volley" target="_blank" rel="noopener noreferrer">HTTP library package named com.android.volley</a> made by Google and, well, the presence of an Android update package comes across as completely innocuous, unless you look under the hood.</p>
<div id='gallery-2' class='gallery galleryid-70449 gallery-columns-2 gallery-size-full'><figure class='gallery-item'>
			<div class='gallery-icon landscape'>
				<img width="308" height="307" src="https://news.sophos.com/wp-content/uploads/2020/12/classes1.png" class="attachment-full size-full" alt="pakchat-android.volley-library" loading="lazy" aria-describedby="gallery-2-71399" srcset="https://news.sophos.com/wp-content/uploads/2020/12/classes1.png 308w, https://news.sophos.com/wp-content/uploads/2020/12/classes1.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2020/12/classes1.png?resize=300,300 300w, https://news.sophos.com/wp-content/uploads/2020/12/classes1.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2020/12/classes1.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2020/12/classes1.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2020/12/classes1.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2020/12/classes1.png?resize=128,128 128w" sizes="(max-width: 308px) 100vw, 308px" />
			</div>
				<figcaption class='wp-caption-text gallery-caption' id='gallery-2-71399'>
				The android.valley library
				</figcaption></figure><figure class='gallery-item'>
			<div class='gallery-icon portrait'>
				<img width="231" height="305" src="https://news.sophos.com/wp-content/uploads/2020/12/classes2.png" class="attachment-full size-full" alt="pakchat-android.update-library" loading="lazy" aria-describedby="gallery-2-71400" srcset="https://news.sophos.com/wp-content/uploads/2020/12/classes2.png 231w, https://news.sophos.com/wp-content/uploads/2020/12/classes2.png?resize=227,300 227w" sizes="(max-width: 231px) 100vw, 231px" />
			</div>
				<figcaption class='wp-caption-text gallery-caption' id='gallery-2-71400'>
				The android.update library
				</figcaption></figure>
		</div>

<h3>Designed for stealth</h3>
<p>The creators of this app are fixated on concealment and stealth; Not only do they mimic legitimate apps, and disguise their malicious code as legitimate libraries, but they also encrypt sensitive strings using AES and a hardcoded key. The strings include the command-and-control (C2) server addresses, and the URL paths used by the spyware to exfiltrate data and request instructions.</p>
<figure id="attachment_70515" aria-describedby="caption-attachment-70515" style="width: 533px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-70515" src="https://news.sophos.com/wp-content/uploads/2020/11/constants.png" alt="" width="533" height="77" srcset="https://news.sophos.com/wp-content/uploads/2020/11/constants.png 533w, https://news.sophos.com/wp-content/uploads/2020/11/constants.png?resize=300,43 300w" sizes="(max-width: 533px) 100vw, 533px" /><figcaption id="caption-attachment-70515" class="wp-caption-text">The plaintext C2 addresses and paths the bot uses have been encrypted using AES and a key hardcoded into the malware</figcaption></figure>
<p>To remain stealthy, many of the samples contained minimal spying functionality initially. That comes later, when the malware APK quietly downloads and runs a compiled .dex Android binary hosted on the C2 server. This .dex file contains most of the spying and exfiltration code the malware uses, which means this code doesn&#8217;t get swept up in initial scans of the apps. This downloadable .dex method also enables the author(s) to seamlessly update the functionalities in the spyware.</p>
<figure id="attachment_71402" aria-describedby="caption-attachment-71402" style="width: 542px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/12/pakchat-data-upload.png"><img loading="lazy" class="wp-image-71402 size-full" src="https://news.sophos.com/wp-content/uploads/2020/12/pakchat-data-upload.png" alt="uploaded pakchat data" width="542" height="466" srcset="https://news.sophos.com/wp-content/uploads/2020/12/pakchat-data-upload.png 542w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat-data-upload.png?resize=300,258 300w" sizes="(max-width: 542px) 100vw, 542px" /></a><figcaption id="caption-attachment-71402" class="wp-caption-text">The malware encodes the exfiltrated data (highlighted in blue) before upload</figcaption></figure>
<p>In keeping with the stealthy theme, the spyware XORs most of the data it transmits back to the C2 server. Upon exfiltrating the collected data, the apps may display a dialog box or warning message that says something like &#8220;The system is under necessary maintenance, please try later.&#8221;</p>
<figure id="attachment_70567" aria-describedby="caption-attachment-70567" style="width: 611px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-70567" src="https://news.sophos.com/wp-content/uploads/2020/11/request.png" alt="" width="611" height="782" srcset="https://news.sophos.com/wp-content/uploads/2020/11/request.png 611w, https://news.sophos.com/wp-content/uploads/2020/11/request.png?resize=234,300 234w" sizes="(max-width: 611px) 100vw, 611px" /><figcaption id="caption-attachment-70567" class="wp-caption-text">Spyware exfiltrating the SD card directory listing (in the form of an HTTP POST submission in clear text, in this case)</figcaption></figure>
<p>The operators of this malicious network also registered domain names that seem to correlate with the apps they mimic. The Pakistan Chat app (as well as a few others) connect to the domain <strong>pakchat.online</strong>, hosted on a server in Latvia, while the fake TPL Insurance app uploads its stolen data to, and retrieves the DEX file from, the domain <strong>tplinsurance.xyz</strong>, hosted on a server in Bulgaria. The Pakistan Salat Time app, unusually, used a hostname from a dynamic DNS service, <strong>kv33.zapto.org</strong>, as its C2. That domain resolved to an IP address based in the USA.</p>
<figure id="attachment_71405" aria-describedby="caption-attachment-71405" style="width: 570px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_urls_branded.png"><img loading="lazy" class="wp-image-71405 size-full" src="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_urls_branded.png" alt="" width="570" height="420" srcset="https://news.sophos.com/wp-content/uploads/2020/12/pakchat_urls_branded.png 570w, https://news.sophos.com/wp-content/uploads/2020/12/pakchat_urls_branded.png?resize=300,221 300w" sizes="(max-width: 570px) 100vw, 570px" /></a><figcaption id="caption-attachment-71405" class="wp-caption-text">URLs used for payload delivery and data exfiltration, and the IP addresses they use.</figcaption></figure>
<h3>Watch where you get your apps</h3>
<p>This spyware is under active development. In the course of pursuing this research, SophosLabs also found what appeared to be test versions of the spyware, presumably used by the malware author(s) to test before they merged the code with clean apps.</p>
<p>In the current Android ecosystem, apps are cryptographically signed as a way to certify the code originates with a legitimate source, tying the app to its developer. However, Android doesn&#8217;t do a good job exposing to the end user when a signed app&#8217;s certificate isn&#8217;t legitimate or doesn&#8217;t validate. As such, users have no easy way of knowing if an app was indeed published by its genuine developer.</p>
<p>This allows threat actors to develop and publish fake versions of popular apps. The existence of a large number of app stores, and the freedom of users to install an app from practically anywhere makes it even harder to combat such threats.</p>
<p>To avoid falling prey to such malicious apps, users should only install apps from trusted sources such as Google Play. Developers of popular apps often have a web site, which directs the users to the genuine app. Users should verify if the app was developed by its genuine developer. We also advise users to consider installing an antivirus app on their mobile device such as Sophos Intercept X for Mobile that defends their device and data from such threats.</p>
<p>Sophos Intercept X for Mobile detects this spyware as <strong>Andr/Spy-BDD</strong>. SophosLabs has <a href="https://github.com/sophoslabs/IoCs/blob/master/Android-pakchat.csv" target="_blank" rel="noopener">published indicators of compromise</a> on its Github page.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/12/21/how-sunburst-malware-does-defense-evasion/" rel="prev">How SunBurst malware does defense evasion</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2021/01/12/first-patch-tuesday-of-2021-brings-fix-to-windows-defender-bug-already-being-exploited/" rel="next">First Patch Tuesday of 2021 brings fix to Windows Defender bug already being exploited</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Authors			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/91945758cb69cb6d59cdc227ba8abdaa?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/pankaj-kohli/" title="Posts by Pankaj Kohli" class="author url fn" rel="author">Pankaj Kohli</a></h3>

					
					<div class="author-bio">
						<p>I am a threat researcher at SophosLabs in Sydney, where I reverse engineer and uncover Android threats on a daily basis. I hold a Master's degree in Computer Science from IIIT-Hyderabad, India. During my free time, I like to explore wilderness and go on nature walks around Sydney.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></h3>

					
					<div class="author-bio">
						<p>Andrew Brandt is a Principal Researcher for Sophos, specializing in security analytics and the forensic, retrospective analysis of malware infections and cyberattacks. In brief, he does whatever it takes to make life and business difficult for cybercriminals, spies, and other Internet miscreants. </p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>1</span> Comment		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-229737" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/2f327504b693cfc467d27c67764dfd16?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/2f327504b693cfc467d27c67764dfd16?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Babar Khan Javed											</h2>
					<time class="comment-meta-item" datetime="2021-01-13T18:01-05:00" itemprop="datePublished"><a href="#comment-229737" itemprop="url">13 January 2021 at 6:01 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Holy shit, great catch.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/?replytocom=229737#respond' data-commentid="229737" data-postid="70449" data-belowelement="comment-229737" data-respondelement="respond" data-replyto="Reply to Babar Khan Javed" aria-label='Reply to Babar Khan Javed'>Reply</a>				</div>
			</div>

	</article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/01/12/new-android-spyware-targets-users-in-pakistan/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='70449' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="9ae64b2261" /></p><input type="hidden" id="ak_js" name="ak_js" value="128"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-71584" class="second-featured post-71584 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-android tag-anticovid tag-cerberus tag-contact-tracing tag-france tag-malware tag-mobile tag-rat tag-tousanticovid region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/tuna-mask.png?w=600');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">18</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/18/fishy-french-covid-contact-tracing-app-is-a-data-thief-pest/" rel="bookmark">Fishy French COVID contact tracing app is a data thief pest</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-66070" class="second-featured post-66070 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-android-scam tag-fleeceware region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/06/fleeceware_icon-ConvertImage.png?w=298');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Aug</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/08/19/truth-in-advertising-policy-fails-to-curb-fleeceware/" rel="bookmark">Truth-in-advertising policy fails to curb fleeceware</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-64302" class="second-featured post-64302 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-fleeceware tag-free-trial-app tag-ios tag-iphone tag-subscription-scam tag-trial-apps region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/04/fleeceware-ios-banner-featured.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">08</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/08/iphone-fleeceware/" rel="bookmark">Don&#8217;t let fleeceware sneak into your iPhone</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-50837" class="second-featured post-50837 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs category-sophoslabs-uncut tag-advertising tag-android tag-android-malware tag-clickfraud tag-google-play tag-ios tag-iphone tag-mobile-apps tag-sophos-mobile region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2018/04/sophoslabs-uncut.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">06</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/">SophosLabs</a> &bull; <a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2018/12/06/android-clickfraud-fake-iphone/" rel="bookmark">Sophisticated Android clickfraud apps pose as iPhone apps and devices</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IYCxuxoPxUQyyurFRIJQ5fXsxyxIPHkbSS/9+X5tULIFp7xK4JNIACCTIh8GTg4VYXcmTGClXhvxkgD1rXnOZA74GfKSD2LVD+1hAwytFRfv5NeJzMrbc0gqDMr0rFoOKyUEs9npVrHyzTTJO27kDWt+KmBewCMG+ORr3D8ot4B263/l2GWcW7NwbR0JNhhCSuGVXPHzEzF7xIlvZHNuqkefxA21LyhQ='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'70449',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '70449' ]);
</script>
</body>
</html>
