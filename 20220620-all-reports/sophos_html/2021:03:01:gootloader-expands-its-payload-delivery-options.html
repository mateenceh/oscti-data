<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>&#8220;Gootloader&#8221; expands its payload delivery options &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; &#8220;Gootloader&#8221; expands its payload delivery options Comments Feed" href="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1616171106' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqUUWAK9KIh0='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/72967" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/" />
<link rel='shortlink' href='https://news.sophos.com/?p=72967' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F01%2Fgootloader-expands-its-payload-delivery-options%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F01%2Fgootloader-expands-its-payload-delivery-options%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="&#8220;Gootloader&#8221; expands its payload delivery options" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/" />
<meta property="og:description" content="The Javascript-based infection framework for the Gootkit RAT increasingly delivers a wider variety of malware, including ransomware payloads, filelessly" />
<meta property="article:published_time" content="2021-03-01T13:30:42+00:00" />
<meta property="article:modified_time" content="2021-03-01T16:59:16+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2021/03/banner.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2021/03/banner.png?w=640" />
<meta property="og:image:width" content="1116" />
<meta property="og:image:height" content="782" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="&#8220;Gootloader&#8221; expands its payload delivery options" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2021/03/banner.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-72967 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-72967" class="post-72967 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-cobalt-strike tag-gootkit tag-gootloader tag-kronos tag-revil region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">&#8220;Gootloader&#8221; expands its payload delivery options</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/cobalt-strike/">cobalt strike</a>&bull;<a href="https://news.sophos.com/en-us/tag/gootkit/">Gootkit</a>&bull;<a href="https://news.sophos.com/en-us/tag/gootloader/">Gootloader</a>&bull;<a href="https://news.sophos.com/en-us/tag/kronos/">Kronos</a>&bull;<a href="https://news.sophos.com/en-us/tag/revil/">REvil</a>		</div>

					<div class="entry-excerpt">
				<p>The Javascript-based infection framework for the Gootkit RAT increasingly delivers a wider variety of malware, including ransomware payloads, filelessly</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/" rel="bookmark">1 March 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				1			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=%26%238220%3BGootloader%26%238221%3B%20expands%20its%20payload%20delivery%20options%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D72967" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=72967&#038;title=&#8220;Gootloader&#8221;%20expands%20its%20payload%20delivery%20options" data-title="&#8220;Gootloader&#8221; expands its payload delivery options" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/"
				data-title="&#8220;Gootloader&#8221; expands its payload delivery options"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="129" src="https://news.sophos.com/wp-content/uploads/2021/03/banner.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2021/03/banner.png 964w, https://news.sophos.com/wp-content/uploads/2021/03/banner.png?resize=300,61 300w, https://news.sophos.com/wp-content/uploads/2021/03/banner.png?resize=768,155 768w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/gabor-szappanos/" title="Posts by Gabor Szappanos" class="author url fn" rel="author">Gabor Szappanos</a></span><span class="author vcard"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>The malware delivery method pioneered by the threat actors behind the REvil ransomware and the Gootkit banking Trojan has been enjoying a renaissance of late, as telemetry indicates that criminals are using the method to deploy an array of malware payloads in <a href="https://asec.ahnlab.com/en/17211/">South Korea</a>, <a href="https://blog.malwarebytes.com/threat-analysis/2020/11/german-users-targeted-with-gootkit-banker-or-revil-ransomware/">Germany</a>, <a href="https://0x90909090.blogspot.com/2020/05/when-ransomware-does-seo.html">France</a>, and across North America.</p>
<p>The Gootkit malware family has been around more than half a decade – a mature Trojan with functionality centered around banking credential theft. In recent years, almost as much effort has gone into improvement of its delivery method as has gone into the NodeJS-based malware itself.</p>
<p>In the past, Sophos and other security experts have bundled the discussion of the malware itself with analysis of the delivery mechanism, but as this method has been adopted to deliver a wider range of malicious code, we assert that this mechanism deserves scrutiny (and its own name), distinct from its payload, which is why we&#8217;ve decided to call it <strong>Gootloader</strong>.</p>
<p>In addition to the REvil and Gootkit payloads, Gootloader has been used most recently to deliver the Kronos trojan and Cobalt Strike.</p>
<p>In its latest attempts to evade detection by endpoint security tools, Gootloader has moved as much of its infection infrastructure to a &#8220;fileless&#8221; methodology as possible. While it isn&#8217;t completely fileless, these techniques are effective at evading detection over a network – right up to the point where the malicious activity trips over behavioral detection rules.</p>
<p><span id="more-72967"></span></p>
<h3>Search engine <em>deoptimization</em> as root cause</h3>
<p>Gootloader uses malicious search engine optimization (SEO) techniques to squirm into Google search results. The way it accomplishes this task deserves some discussion, because it centers as much around technology as human psychology.</p>
<figure id="attachment_72994" aria-describedby="caption-attachment-72994" style="width: 1248px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-search-results-are-valid.png"><img loading="lazy" class="wp-image-72994 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-search-results-are-valid.png" alt="" width="1248" height="530" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-search-results-are-valid.png 1248w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-search-results-are-valid.png?resize=300,127 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-search-results-are-valid.png?resize=768,326 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-search-results-are-valid.png?resize=1024,435 1024w" sizes="(max-width: 1248px) 100vw, 1248px" /></a><figcaption id="caption-attachment-72994" class="wp-caption-text">A malicious result that delivers Gootloader appears legitimate, even to Google</figcaption></figure>
<p>To accomplish this phase of the attack, the operators of Gootloader must maintain a network of servers hosting hacked, legitimate websites (we estimate roughly 400 such servers are in operation at any given time). The example shown above belongs to a legitimate business, a neonatal medical practice based in Canada. None of the site&#8217;s legitimate content has anything to do with real estate transactions – its doctors deliver babies – and yet it is the first result to appear in a query about a very narrowly defined type of real estate agreement. Google itself indicates the result is not an ad, and they have known about the site for nearly seven years. To the end user, the entire thing looks on the up-and-up.</p>
<p>When the visitor clicks through the link in this search result, they&#8217;re presented with another, very specific page that seems to deliver the answer to their exact question, using precisely the same wording as the search query (which sometimes comes across quite awkwardly).</p>
<figure id="attachment_72995" aria-describedby="caption-attachment-72995" style="width: 1018px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-party-wall.png"><img loading="lazy" class="wp-image-72995 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-party-wall.png" alt="" width="1018" height="719" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-party-wall.png 1018w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-party-wall.png?resize=300,212 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-party-wall.png?resize=768,542 768w" sizes="(max-width: 1018px) 100vw, 1018px" /></a><figcaption id="caption-attachment-72995" class="wp-caption-text">These fake &#8220;message board&#8221; pages generated by Gootloader awkwardly repeat the search query verbatim in multiple places on the page</figcaption></figure>
<p>And if that same site visitor clicks the &#8220;direct download link&#8221; provided on this page, they receive a .zip archive file with a filename that exactly matches the search query terms used in the initial search, which itself contains <em>another</em> file named in precisely the same way. This .js file is the initial infector, and the only stage of the infection at which a malicious file is written to the filesystem. Everything that happens after the target double-clicks this script runs entirely in memory, out of the reach of traditional endpoint protection tools.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/party-wall-agreement-gootloader.png"><img loading="lazy" class="alignnone size-full wp-image-72996" src="https://news.sophos.com/wp-content/uploads/2021/03/party-wall-agreement-gootloader.png" alt="" width="359" height="189" srcset="https://news.sophos.com/wp-content/uploads/2021/03/party-wall-agreement-gootloader.png 359w, https://news.sophos.com/wp-content/uploads/2021/03/party-wall-agreement-gootloader.png?resize=300,158 300w" sizes="(max-width: 359px) 100vw, 359px" /></a></p>
<p>In our experience, many of these hacked sites serving the fake message board are running a well-known content management system, to which the threat actors make modifications that subtly rewrite how the contents of the website are presented to certain visitors, based on characteristics of the individual visitors (including how they arrive on the hacked site).</p>
<p>It isn&#8217;t clear how the threat actors gain access to the backend of these sites, but historically, these kinds of website compromises may be the result of any of a number of methods: The attackers may simply obtain the sites&#8217; passwords from the Gootkit malware itself, or from any of a number of criminal markets that trade in stolen credentials, or by leveraging any of a number of security exploits in the plugins or add-ons of the CMS software. The operators of the websites seem not to know their sites are being abused in this way.</p>
<p>Regardless of how the attackers access the websites, what they do next is to insert a few additional lines of code into the body of the web page. The elements where the attackers inject the code could be within one of the following div tags.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injection-targets.png"><img loading="lazy" class="alignnone wp-image-72997" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injection-targets.png" alt="" width="337" height="114" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injection-targets.png 594w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injection-targets.png?resize=300,102 300w" sizes="(max-width: 337px) 100vw, 337px" /></a></p>
<p>The modified code is a simple script tag that looks like this:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-script.png"><img loading="lazy" class="alignnone wp-image-72998" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-script.png" alt="" width="503" height="29" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-script.png 973w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-script.png?resize=300,18 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-script.png?resize=768,45 768w" sizes="(max-width: 503px) 100vw, 503px" /></a></p>
<p>The server checks to see whether the conditions in which the page gets loaded meet the criteria Gootloader has been looking for. Notably, the script appears to inspect the User-Agent string in the GET request header information to determine whether the visitor&#8217;s computer is running an operating system with the specific language/localization preferences that the attackers have been targeting. It may also be using IP geolocation to determine whether the person browsing the site is doing so from within the territory the attackers are targeting.</p>
<p>Server side, the attacker also checks whether the Referrer: header in the request indicates the page was loaded after the victim clicked a Google search result. (Our tests indicated that other search engines were not targeted, or were not targeted as frequently – or successfully – as Google&#8217;s.) These kinds of checks make it more difficult for a website owner to identify the problem with their own site.</p>
<p>In cases where the criteria is not met, the browser simply displays a normal-looking (but forged) web page, such as this blog post that starts out well, but spins into mostly-unintelligible word salad near the end:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-word-salad.png"><img loading="lazy" class="alignnone size-full wp-image-72999" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-word-salad.png" alt="" width="640" height="248" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-word-salad.png 1494w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-word-salad.png?resize=300,116 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-word-salad.png?resize=768,297 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-word-salad.png?resize=1024,396 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>If the right conditions are met (and there have been no previous visits to the website from the visitor&#8217;s IP address), the malicious code running server-side redraws the page to give the visitor the appearance that they have stumbled into a message board or blog comments area in which people are discussing precisely the same topic, using exactly the same terms the victim used in their search.</p>
<p>These fake forum posts include what appears to be an authoritative post from a site administrator offering a download of a document that purportedly gives the answer to the question raised by the search terms.</p>
<p>Interestingly, these fake comments/message boards all share an identical appearance.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-fake-englist-forum-plus-source-code.png"><img loading="lazy" class="alignnone size-full wp-image-73000" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-fake-englist-forum-plus-source-code.png" alt="" width="640" height="348" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-fake-englist-forum-plus-source-code.png 1520w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-fake-englist-forum-plus-source-code.png?resize=300,163 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-fake-englist-forum-plus-source-code.png?resize=768,417 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-fake-englist-forum-plus-source-code.png?resize=1024,556 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>In these modified webpages, the page&#8217;s source code will contain a link to a file download on another website. This download usually appears as a .zip archive that contains a single (malicious Javascript) document, which the visitor must unzip and then double-click before the rest of the infection process may take place.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-on-page_h.png"><img loading="lazy" class="alignnone size-full wp-image-73001" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-on-page_h.png" alt="" width="640" height="197" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-on-page_h.png 922w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-on-page_h.png?resize=300,92 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-injected-code-on-page_h.png?resize=768,237 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The parameter of the request also contains the search terms that led to the fake forum page, which the download site uses to construct a payload, on the fly, with a file name that matches the original search terms. A quick survey of the filenames of samples we&#8217;ve collected give an indication of what the targets might have been searching for when they stumbled into Gootloader&#8217;s malicious SEO trap.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-english-filenames.png"><img loading="lazy" class="alignnone wp-image-73002" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-english-filenames.png" alt="" width="509" height="141" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-english-filenames.png 744w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-english-filenames.png?resize=300,83 300w" sizes="(max-width: 509px) 100vw, 509px" /></a></p>
<p>In addition to the English-language payloads (targeting users in North America), malware repositories contain a lot of Gootloader samples with filenames in German, French, and Korean, which appear to correspond to well-publicized campaigns targeting those countries. For instance, here&#8217;s a variant of the fake forum targeting German-language speakers:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/german-fake-forum.png"><img loading="lazy" class="alignnone wp-image-73004" src="https://news.sophos.com/wp-content/uploads/2021/03/german-fake-forum.png" alt="" width="468" height="380" srcset="https://news.sophos.com/wp-content/uploads/2021/03/german-fake-forum.png 1370w, https://news.sophos.com/wp-content/uploads/2021/03/german-fake-forum.png?resize=300,244 300w, https://news.sophos.com/wp-content/uploads/2021/03/german-fake-forum.png?resize=768,624 768w, https://news.sophos.com/wp-content/uploads/2021/03/german-fake-forum.png?resize=1024,832 1024w" sizes="(max-width: 468px) 100vw, 468px" /></a></p>
<p>And another example, in French, in which the search term <em>exemple de dédicace à une amie</em> (&#8220;example of dedication to a friend&#8221;) has been leveraged in both the title of the post and the link to the Gootloader payload. Note that this &#8220;French&#8221; website uses English words as labels for menu items and other elements. The fake page header typically displays the phrase &#8220;Questions And Answers.&#8221;</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/french-fake-forum.png"><img loading="lazy" class="alignnone wp-image-73005" src="https://news.sophos.com/wp-content/uploads/2021/03/french-fake-forum.png" alt="" width="540" height="334" srcset="https://news.sophos.com/wp-content/uploads/2021/03/french-fake-forum.png 1347w, https://news.sophos.com/wp-content/uploads/2021/03/french-fake-forum.png?resize=300,186 300w, https://news.sophos.com/wp-content/uploads/2021/03/french-fake-forum.png?resize=768,476 768w, https://news.sophos.com/wp-content/uploads/2021/03/french-fake-forum.png?resize=1024,634 1024w" sizes="(max-width: 540px) 100vw, 540px" /></a></p>
<p>And still another, in Korean. The Hangul translation reads &#8220;here is the download link&#8221; with the URL pointing to the same domain hosting Gootloader payloads that also target French and German speakers.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/fake-korean-forum.png"><img loading="lazy" class="alignnone wp-image-73006" src="https://news.sophos.com/wp-content/uploads/2021/03/fake-korean-forum.png" alt="" width="463" height="389" srcset="https://news.sophos.com/wp-content/uploads/2021/03/fake-korean-forum.png 1576w, https://news.sophos.com/wp-content/uploads/2021/03/fake-korean-forum.png?resize=300,252 300w, https://news.sophos.com/wp-content/uploads/2021/03/fake-korean-forum.png?resize=768,644 768w, https://news.sophos.com/wp-content/uploads/2021/03/fake-korean-forum.png?resize=1024,859 1024w, https://news.sophos.com/wp-content/uploads/2021/03/fake-korean-forum.png?resize=1536,1288 1536w" sizes="(max-width: 463px) 100vw, 463px" /></a></p>
<p>The similarity between the pages is unmistakable; All languages feature a &#8220;forum post&#8221; by a new user with a five-petal flower as their user icon, and a reply from an account called Admin that uses an hourglass icon. The text of the Google search query is repeated at the top of the page and within the fake &#8220;message board&#8221; posts.</p>
<p>Needless to say, it would be best if you avoid downloading files from pages that look identical to these.</p>
<h3>First stage payloads: twice obfuscated</h3>
<p>Gootloader&#8217;s initial payload is a .zip archive containing a file with a .js extension. Files with the .js extension normally invoke the Windows Scripting Host (wscript.exe) when run.</p>
<p>This &#8220;first stage&#8221; script is the only component of the attack written to the filesystem. Because it&#8217;s the only one exposed to conventional AV scanning methods, the author has obfuscated the script and added two layers of encryption to strings and data blobs related to the next stage of the attack.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-first-stage.png"><img loading="lazy" class="alignnone wp-image-73007" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-first-stage.png" alt="" width="501" height="364" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-first-stage.png 1798w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-first-stage.png?resize=300,218 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-first-stage.png?resize=768,558 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-first-stage.png?resize=1024,744 1024w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-first-stage.png?resize=1536,1116 1536w" sizes="(max-width: 501px) 100vw, 501px" /></a></p>
<p>Gootloader randomly generates variable names, and splits its decryption code into several small component functions. The first two lines of the code shown above, for example, perform two very minor tasks: one is a simple addition, the other is a string split function. Splitting them in this unexpected and unnecessary way complicates static analysis of the script file.</p>
<p>This stage runs a block of data through the first decryption method, which outputs a second form of the data block that itself is obfuscated and encrypted, and contains embedded functions to decrypt itself. Only after it runs through this second decryption routine does the script reveal its final instructions.</p>
<p>The obfuscation techniques have evolved over time. In the example shown above, the variables are formed of random alphanumeric strings. Newer versions name the variables from randomly selected dictionary words, and may even include word-salad code &#8220;comments.&#8221;</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-random-dictionary-comments.png"><img loading="lazy" class="alignnone size-full wp-image-73008" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-random-dictionary-comments.png" alt="" width="640" height="137" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-random-dictionary-comments.png 1101w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-random-dictionary-comments.png?resize=300,64 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-random-dictionary-comments.png?resize=768,164 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-random-dictionary-comments.png?resize=1024,219 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The first stage script only exists to fetch the second stage code, cycling through three different hardcoded web domains if necessary.</p>
<figure id="attachment_73009" aria-describedby="caption-attachment-73009" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-decoded-initial-C2-script.png"><img loading="lazy" class="size-full wp-image-73009" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-decoded-initial-C2-script.png" alt="" width="640" height="338" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-decoded-initial-C2-script.png 924w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-decoded-initial-C2-script.png?resize=300,158 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-decoded-initial-C2-script.png?resize=768,406 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-73009" class="wp-caption-text">The decoded Gootloader Javascript taken from the initial file.</figcaption></figure>
<p>Gootloader even adds complications to the URL that retrieves the second stage: It appends a unique parameter of random-looking characters (highlighted in yellow, above) and a random long number to the URL query string. The script shown above designates a &#8220;sleep&#8221; period of more than 22 seconds between some steps to slow down the process. And some Gootloader scripts attempt to resolve the domain name(s) hosting the payloads from DNS before attempting to contact their C2, possibly as an anti-sandboxing measure.</p>
<h3>Second-stage payload: Registry stuffing</h3>
<p>If the first stage successfully contacts a C2, it receives a long string of numbers as a reply. These numbers are the decimal (numeric) values that represent ASCII text characters, which the first stage loads directly into memory, leaving no trace on the filesystem.</p>
<p>This stage contains a large blob of data that it, first, decodes from its numeric value into text, then writes directly into a series of keys in the Windows Registry, under the HKCU\Software hive. The key name varies from sample to sample.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-keys.png"><img loading="lazy" class="alignnone size-full wp-image-73010" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-keys.png" alt="" width="640" height="269" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-keys.png 1126w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-keys.png?resize=300,126 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-keys.png?resize=768,323 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-keys.png?resize=1024,431 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Next, this stage creates an autorun entry for a PowerShell script. This script, when run (at every subsequent boot), decodes the contents of the Registry keys it wrote out in the previous step. (It also names this autorun entry after the same string of random-looking text it used as a Registry key name.)</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registers-powershell-script.png"><img loading="lazy" class="alignnone size-full wp-image-73011" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registers-powershell-script.png" alt="" width="640" height="226" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registers-powershell-script.png 1256w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registers-powershell-script.png?resize=300,106 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registers-powershell-script.png?resize=768,271 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registers-powershell-script.png?resize=1024,362 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Because this next stage doesn&#8217;t completely execute until the next time the computer reboots, the target may not actually discover the infection until some hours or even days later – whenever they fully reboot Windows.</p>
<h3>After a reboot: the final dominoes fall</h3>
<p>Once the computer reboots, it triggers the PowerShell script to run, which starts a sequence of events culminating in Gootloader attempting to download its final payload. But Gootloader is not finished with its complications.</p>
<p>The current generation of Gootloader samples actually stores not one, but a pair of payloads in the Registry: a small C# executable, and a second executable that the first one decodes from the weird way it has been stored in the Registry.</p>
<p>Here&#8217;s the first payload, the C# executable, identifiable by its use of Windows &#8220;MZ&#8221; header (hexadecimal <strong><em>4d5a</em></strong>) as the first two bytes.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-loader.png"><img loading="lazy" class="alignnone size-full wp-image-73012" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-loader.png" alt="" width="640" height="266" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-loader.png 1076w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-loader.png?resize=300,125 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-loader.png?resize=768,320 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-registry-loader.png?resize=1024,426 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Here&#8217;s the second, and final, payload – counterintuitively, from its appearance, <em>also</em> an executable. In this case, the creator has encoded the numbers that make up the hexadecimal ASCII values as sequences of letters.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-payload-registry.png"><img loading="lazy" class="alignnone size-full wp-image-73013" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-payload-registry.png" alt="" width="640" height="267" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-payload-registry.png 1078w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-payload-registry.png?resize=300,125 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-payload-registry.png?resize=768,321 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-payload-registry.png?resize=1024,427 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The secret decoder ring to parse this blob of data looks like this. The script runs the data in the Registry keys through this substitution script, ends up with a hexadecimal representation of the second executable, then executes it (also directly into memory). Not all characters are substituted, so the first four bytes shown above, <strong><em>ydua</em></strong>, represent the <em>4d5a</em> of the MZ header.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-decoder-ring.png"><img loading="lazy" class="alignnone size-full wp-image-73014" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-decoder-ring.png" alt="" width="640" height="112" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-decoder-ring.png 1025w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-decoder-ring.png?resize=300,53 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-asciihex-decoder-ring.png?resize=768,135 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The script then executes the payload and, to give itself persistence after reboot, creates a Registry run key that will execute the payload on the next startup (with the help of a PowerShell command):</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootkit-powershell-autorun.png"><img loading="lazy" class="alignnone size-full wp-image-73015" src="https://news.sophos.com/wp-content/uploads/2021/03/gootkit-powershell-autorun.png" alt="" width="640" height="172" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootkit-powershell-autorun.png 1099w, https://news.sophos.com/wp-content/uploads/2021/03/gootkit-powershell-autorun.png?resize=300,81 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootkit-powershell-autorun.png?resize=768,207 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootkit-powershell-autorun.png?resize=1024,276 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>This is the command registered by the registry loader. It serves as a failsafe mechanism for the Gootloader infection process to survive a reboot.</p>
<h3>dotNET injector with a twist</h3>
<p>The final stage of the elaborate infection plan involves a dotNet injector. Executed either by the registry loader or the failsafe PowerShell script, the result is the same: a simple .NET loader that contains the next stage, a Delphi-based loader malware, in the form of a data blob. Over time, this part of the infection process has evolved.</p>
<p>At first, the dotNET component simply decrypted the Delphi executable, which dropped and executed the eventual payload. Eventually, the attackers switched up the attack and added an intermediate step: The dotNET component would launch a benign application called <strong>ImagingDevices.exe</strong>, an innocent system component installed by default on Windows operating systems, then injected the Delphi executable into it using a process hollowing technique.</p>
<p>The most recent versions of the attack now involve the dotNET component writing out a different, benign executable that belongs to a commercial software package called the Embarcadero External Translation Manager to the file system (using as its filename the username of the currently logged-in user). It then performs a process hollowing on that executable to load the Delphi component.</p>
<p>It performs this function by holding a copy of both the benign and the malicious payload inside of itself.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-dotnet-two-embedded.png"><img loading="lazy" class="alignnone size-full wp-image-73016" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-dotnet-two-embedded.png" alt="" width="640" height="381" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-dotnet-two-embedded.png 1572w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-dotnet-two-embedded.png?resize=300,179 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-dotnet-two-embedded.png?resize=768,457 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-dotnet-two-embedded.png?resize=1024,610 1024w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-dotnet-two-embedded.png?resize=1536,915 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The first one (stored in the variable <em>text2</em>) is the benign application, digitally signed by its publisher. If the user of an infected computer suspects foul play, and investigates a program that&#8217;s causing suspicious network traffic and/or high CPU load in the system, they would see what Windows considers a trusted application.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-embarcadero-procexp-details.png"><img loading="lazy" class="alignnone wp-image-73017" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-embarcadero-procexp-details.png" alt="" width="367" height="434" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-embarcadero-procexp-details.png 513w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-embarcadero-procexp-details.png?resize=254,300 254w" sizes="(max-width: 367px) 100vw, 367px" /></a></p>
<p>It drops and executes this clean application, then replaces the code in memory using process hollowing techniques with the contents of the second PE file (stored in the variable <em>text3</em>).</p>
<p>The Delphi loader contains the final payload – Kronos, REvil, Gootkit, or Cobalt Strike – in encrypted form. In those cases, the loader decrypts the payload, then uses its own PE loader to execute the payload in memory.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-delphi-injector-loadlibrary.png"><img loading="lazy" class="alignnone wp-image-73018" src="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-delphi-injector-loadlibrary.png" alt="" width="413" height="289" srcset="https://news.sophos.com/wp-content/uploads/2021/03/gootloader-delphi-injector-loadlibrary.png 1116w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-delphi-injector-loadlibrary.png?resize=300,210 300w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-delphi-injector-loadlibrary.png?resize=768,538 768w, https://news.sophos.com/wp-content/uploads/2021/03/gootloader-delphi-injector-loadlibrary.png?resize=1024,718 1024w" sizes="(max-width: 413px) 100vw, 413px" /></a></p>
<p>Throughout the infection process, none of the malicious code is written to disk, maintaining the fileless execution scheme right up to the end.</p>
<h3>Cause and effect</h3>
<p>What does all this obfuscation, leaping from one scripting platform to another, and the most absurdly, <a href="https://www.imdb.com/title/tt0093779/characters/nm0001728">Vizzini-grade</a> complications of almost any malware distribution platform achieve?</p>
<p>If you&#8217;re an analyst, it might cost you a few hours of work to fully unpack and understand each stage of the attack. We haven&#8217;t even covered in this blog post all the possible variations we&#8217;ve observed Gootloader using as final payload delivery methods, since it also might deliver .net or Delphi-based code-injector executables, additional PowerShell scripts, or Cobalt Strike modules.</p>
<p>But a criminal, ultimately, is just trying to buy a few minutes-to-hours of time remaining undetected to permit the attack to proceed without interference from endpoint protection software. Instead of actively attacking the endpoint tools, as some malware distributors do, the creators of Gootloader have traded the more aggressive approach for a technique that&#8217;s closer to a massive setup of dominoes that conceal the end result.</p>
<p>At several points, it&#8217;s possible for end users to avoid the infection, if they recognize the signs. The problem is that, even trained people can easily be fooled by the chain of social engineering tricks Gootloader&#8217;s creators use. Script blockers like NoScript for Firefox could help a cautious web surfer remain safe by preventing the initial replacement of the hacked web page to happen, but not everyone uses those tools (or finds them convenient or even intuitive). Even attentive users who are aware of the trick involving the fake forum page might not recognize it until it&#8217;s too late.</p>
<p>In the end, it&#8217;s up to the search engines, whose algorithm the malware games to get a high search result, to address the initial attack vector. Users can be trained to do things like enable visible file suffixes in Windows, so they can see they&#8217;re clicking a file with a .js extension, but they can&#8217;t choose which search results appear near the top of the list or how those sites get manipulated by threat actors.</p>
<h2>Protection and indicators-of-compromise</h2>
<p>Sophos Intercept X protects users by detecting undesirable actions and behaviors by malware like Gootloader, such as the delivery of Cobalt Strike, or the use of its process hollowing techniques to inject malware onto a running system. Malicious javascript files may be detected as <strong>AMSI/GootLdr-A</strong>, while the PowerShell components may be detected as <strong>AMSI/Reflect-H </strong>or<strong> Exec_12a. </strong>Other behavioral detection rules may also block the infection in the middle stages, before the final payload gets delivered.</p>
<p>Indicators of compromise for this analysis, including <a href="https://github.com/sophoslabs/IoCs/blob/master/Troj-gootloader.yara" target="_blank" rel="noopener">a Yara threat hunting rule</a> that can help incident responders find similar Javascript files, have been posted to the <a href="https://www.github.com/sophoslabs/">SophosLabs Github</a>. Analysts who wish to execute samples of Gootkit or other Trojans in a test environment may wish to consider using <a href="https://www.github.com/felixweyne/imaginaryC2">imaginaryC2</a>, a Python tool created by Felix Weyne to simulate the command-and-control communications responses that malware (including Gootkit) expect to receive, without letting the malware reach the live internet.</p>
<h2>Acknowledgments</h2>
<p>SophosLabs acknowledges the research contributions of Fraser Howard, Mark Loman, Peter Mackenzie, Vikas Singh, and Feliz Weyne to this analysis and to the detection of Gootloader.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2021/03/01/remote-workforce-offer-secure-connectivity-from-any-location/" rel="prev">Remote workforce? Offer secure connectivity from any location</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2021/03/03/securing-your-supply-chain-from-third-party-risk/" rel="next">Securing your supply chain from third party risk</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Authors			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/040a829707237b26ea3984dfc4621217?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/gabor-szappanos/" title="Posts by Gabor Szappanos" class="author url fn" rel="author">Gabor Szappanos</a></h3>

					
					<div class="author-bio">
						<p>Gabor graduated from the Eotvos Lorand University of Budapest with a degree in physics. His first job was in the Computer and Automation Research Institute, developing diagnostic software and hardware for nuclear power plants. He started antivirus work in 1995, and began developing freeware antivirus solutions in his spare time. Gabor joined VirusBuster in 2001 where he was responsible for taking care of macro virus and script malware and became head of the virus lab in 2002. In 2008 he became a member of the Board of Directors in AMTSO (Anti Malware Testing Standards Organization) and, in 2012, joined Sophos as a Principal Malware Researcher.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></h3>

					
					<div class="author-bio">
						<p>Andrew Brandt is a Principal Researcher for Sophos, specializing in security analytics and the forensic, retrospective analysis of malware infections and cyberattacks. In brief, he does whatever it takes to make life and business difficult for cybercriminals, spies, and other Internet miscreants. </p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>1</span> Comment		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-240556" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Sean Khumalo											</h2>
					<time class="comment-meta-item" datetime="2021-03-08T02:54-05:00" itemprop="datePublished"><a href="#comment-240556" itemprop="url">08 March 2021 at 2:54 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>great article</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/?replytocom=240556#respond' data-commentid="240556" data-postid="72967" data-belowelement="comment-240556" data-respondelement="respond" data-replyto="Reply to Sean Khumalo" aria-label='Reply to Sean Khumalo'>Reply</a>				</div>
			</div>

	</article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='72967' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="1fb8558aab" /></p><input type="hidden" id="ak_js" name="ak_js" value="152"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkEEOwiAQRS8kIF20K+NRDLZjS8sAYcDq7R3TNHHhomTY8Hnvk4xao+iDz+CzyhMgkKIQp0AeVhLNWXdqJj4MhcWCeDaykZoDuQVyppM61NGHVEHDKydDx/ktkiVbV2/1BqOxo68Wo0nZQ6r2RlOtfLNdsr53ZQDa1orIBSJBdG+J1v+D+Ap4h+H3ff8Zi4iujNaTMoslhKxu7KpHSMjsFS+65em0PrfzB20wygw='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'72967',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '72967' ]);
</script>
</body>
</html>
