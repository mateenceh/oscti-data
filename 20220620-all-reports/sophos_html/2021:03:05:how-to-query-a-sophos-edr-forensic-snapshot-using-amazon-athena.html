<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>How to query a Sophos EDR forensic snapshot using Amazon Athena &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; How to query a Sophos EDR forensic snapshot using Amazon Athena Comments Feed" href="https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615321555' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/73177" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/" />
<link rel='shortlink' href='https://news.sophos.com/?p=73177' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F05%2Fhow-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F05%2Fhow-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="How to query a Sophos EDR forensic snapshot using Amazon Athena" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/" />
<meta property="og:description" content="Sophos EDR can generate incredibly detailed and valuable data, enabling you to investigate suspicious signals and threats. This article takes you through the steps to analyze your Sophos EDR forens…" />
<meta property="article:published_time" content="2021-03-05T10:49:14+00:00" />
<meta property="article:modified_time" content="2021-03-05T10:51:12+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="304" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="How to query a Sophos EDR forensic snapshot using Amazon Athena" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-73177 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-73177" class="post-73177 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate tag-amazon-athena tag-sophos-central tag-sophos-edr tag-threat-hunting region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">How to query a Sophos EDR forensic snapshot using Amazon Athena</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>&bull;<a href="https://news.sophos.com/en-us/tag/amazon-athena/">amazon athena</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophos-central/">Sophos Central</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophos-edr/">Sophos EDR</a>&bull;<a href="https://news.sophos.com/en-us/tag/threat-hunting/">threat-hunting</a>		</div>

					<div class="entry-excerpt">
				<p>Sophos EDR can generate incredibly detailed and valuable data, enabling you to investigate suspicious signals and threats. This article takes you through the steps to analyze your Sophos EDR forensic snapshots in bulk using the Amazon Athena query service.</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/" rel="bookmark">5 March 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=How%20to%20query%20a%20Sophos%20EDR%20forensic%20snapshot%20using%20Amazon%20Athena%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D73177" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=73177&#038;title=How%20to%20query%20a%20Sophos%20EDR%20forensic%20snapshot%20using%20Amazon%20Athena" data-title="How to query a Sophos EDR forensic snapshot using Amazon Athena" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/"
				data-title="How to query a Sophos EDR forensic snapshot using Amazon Athena"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="304" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png 1362w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png?resize=300,143 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png?resize=768,365 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.21.18.png?resize=1024,487 1024w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/stephen-oleary/" title="Posts by Stephen O&#039;Leary" class="author url fn" rel="author">Stephen O&#039;Leary</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>Sometimes during an investigation, you might end up with multiple forensic snapshots to analyze for IOCs. These can often be very large and querying them individually can take a long time as they can often be multiple gigabytes in size. Logging on to multiple machines to run the queries may also be an issue both from the view of ease of access, if they are distributed globally, and from preserving forensic integrity.</p>
<p>Wouldn’t it be great if you could just copy them all to a single location and query everything in one go?</p>
<p>This is where Amazon Athena comes in.  Amazon Athena is a serverless, interactive query service that allows you to analyze data in Amazon S3 using standard SQL queries. All you need to do is upload your data, configure a schema and then start running queries.</p>
<p>So how do we do this?</p>
<p>There are a few steps required which we will take you through, these are:</p>
<ul>
<li>Generate a forensic snapshot</li>
<li>Convert the snapshot to JSON format</li>
<li>Upload the JSON snapshot to an S3 bucket</li>
<li>Create the schema in Amazon Athena</li>
<li>Query!</li>
</ul>
<p>The first two steps we will assume you are already familiar with, if not there is a useful article available <a href="https://support.sophos.com/support/s/article/KB-000038358?language=en_US">here</a> which explains how to generate a snapshot and then convert it into the required JSON format.</p>
<p>Unfortunately, as the snapshot needs to be converted into JSON format in order to run advanced queries on it, you can’t use the auto upload to S3 feature of EDR and the converted snapshot will have to be uploaded a different way. You could do this manually through the AWS web UI, via a script or any other method you choose for uploading data to S3.</p>
<p>All that matters is that all your snapshots end up in the same folder and have a naming convention that allows you to identify which machine it came from. The importance of this will become apparent later.</p>
<p>Once you have all your snapshots converted to JSON and uploaded into your S3 bucket, you should have something that looks a bit like this…<a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-14.59.06.png"><img loading="lazy" class="aligncenter wp-image-73178 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-14.59.06.png" alt="" width="1140" height="540" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-14.59.06.png 1140w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-14.59.06.png?resize=300,142 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-14.59.06.png?resize=768,364 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-14.59.06.png?resize=1024,485 1024w" sizes="(max-width: 1140px) 100vw, 1140px" /></a></p>
<p>I recommend creating a separate folder to store your snapshots in, as Athena tries to query everything in the location you point it to, you can’t limit it to just one type of file, so to avoid errors or issues, make sure you put all your snapshots into one folder and use this for snapshot data only.</p>
<p>Now we have our data, we need to tell Amazon Athena how to query it by creating a schema.</p>
<p>There is a <a href="https://support.sophos.com/support/s/article/KB-000038810?language=en_US">published schema</a> for a JSON formatted snapshot available here, what we are going to do is re-create this schema in Athena so we can query each available data type using standard SQL commands.</p>
<p>To do this, we need to open the Amazon Athena console and then ensure you are setting up Athena in the same region as the one you created your S3 bucket in, this is important as Athena can’t access buckets across regions.</p>
<p>To get you started we have created a set of SQL queries in this <a href="https://github.com/sophos-cybersecurity/edr-snapshot-athena">Github repository</a> to help you create an Athena schema that matches the snapshot schema defined in the documentation.</p>
<p>To start with, we create a database using the create_database.sql file from the repo, this contains the simple statement:</p>
<p>CREATE DATABASE interceptx_edr;</p>
<p>You can name this database whatever you like, but just remember that all the queries in the repo will reference this database name, so if you want to change it, you will need to amend all the other queries with the same name.</p>
<figure id="attachment_73179" aria-describedby="caption-attachment-73179" style="width: 1138px" class="wp-caption aligncenter"><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.00.13.png"><img loading="lazy" class="wp-image-73179 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.00.13.png" alt="" width="1138" height="400" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.00.13.png 1138w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.00.13.png?resize=300,105 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.00.13.png?resize=768,270 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.00.13.png?resize=1024,360 1024w" sizes="(max-width: 1138px) 100vw, 1138px" /></a><figcaption id="caption-attachment-73179" class="wp-caption-text">Click to enlarge</figcaption></figure>
<p>Copy the query into the query editor and run it (don’t worry about the database dropdown on the left for now), you should see at the bottom it say “Query successful”:</p>
<p>&nbsp;</p>
<p>*Note, if Athena at any point complains about not having a location set for query results to be saved, simply create a new folder in your bucket called QueryResults and point it there.</p>
<p>Now we have our database, this will be a container for all our tables and views that make us our schema.  Firstly we need to create a table.</p>
<p>In Athena, the table defines where the data is stored, what columns should be created and what format Athena should expect the data to be in.  We will create one big, wide table will all available columns and then use views to split this up into the different data types available in the snapshot.</p>
<p>Let’s create the table using the create_table.sql file in the repo.  You will need to make a change here to ensure that you are pointing to the correct location in S3 where you have saved your snapshots, the part you need to change is right at the bottom.</p>
<figure id="attachment_73180" aria-describedby="caption-attachment-73180" style="width: 1146px" class="wp-caption aligncenter"><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.01.22.png"><img loading="lazy" class="wp-image-73180 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.01.22.png" alt="" width="1146" height="490" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.01.22.png 1146w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.01.22.png?resize=300,128 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.01.22.png?resize=768,328 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.01.22.png?resize=1024,438 1024w" sizes="(max-width: 1146px) 100vw, 1146px" /></a><figcaption id="caption-attachment-73180" class="wp-caption-text">Click to enlarge</figcaption></figure>
<p>As my snapshots are saved in the bucket “athena-edr-snapshots” in a folder called “Snapshots” I alter the location as shown in the screenshot below (the trailing / is required) and then run it:</p>
<p>If you got the location correct, you should see that it says “Query successful” and an “exported_snapshot” table appears in your database intercept_edr.</p>
<p>At this point your snapshots are now actually queryable using Athena, however to make things a bit easier, we have provided some views which allows you to query each category of data more easily without having to know all of the column names that relate to each data type.</p>
<p>To create these, use the create_views.sql file in the repo and copy out each of the views that you require. You may want all of them, or you may only be interested in a couple of data types such as DNS or Process data for example.  Unfortunately Athena doesn’t let you run multiple queries in one window so you will need to create each view individually.</p>
<p>In the below example I will create the Process view and show how to query it.</p>
<p>Firstly copy the create view statement from the create_views.sql file in the Github repo:<a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.02.50.png"><img loading="lazy" class="aligncenter wp-image-73181 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.02.50.png" alt="" width="1136" height="712" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.02.50.png 1136w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.02.50.png?resize=300,188 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.02.50.png?resize=768,481 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.02.50.png?resize=1024,642 1024w" sizes="(max-width: 1136px) 100vw, 1136px" /></a></p>
<figure id="attachment_73182" aria-describedby="caption-attachment-73182" style="width: 1138px" class="wp-caption aligncenter"><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.03.35.png"><img loading="lazy" class="wp-image-73182 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.03.35.png" alt="" width="1138" height="484" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.03.35.png 1138w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.03.35.png?resize=300,128 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.03.35.png?resize=768,327 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.03.35.png?resize=1024,436 1024w" sizes="(max-width: 1138px) 100vw, 1138px" /></a><figcaption id="caption-attachment-73182" class="wp-caption-text">Click to enlarge</figcaption></figure>
<p>Then paste it into the Athena query editor and run it:</p>
<p>You should see the “Query successful” message and the “process” view appear on the sidebar on the left.</p>
<p>Notice in the view definition the first line of the select statement:</p>
<p>&#8220;$path&#8221; AS data_source</p>
<p>What this does is take the file path of the snapshot file in S3 and put it into a column called “data_source”. This ensures that when you are querying snapshots from different machines, you can identify which one of them it came from.  This is the reason we mentioned having a good naming convention for each of your snapshot files. If you can’t tell which machine they are from by looking at the name, any queries you run are going to be of limited use.</p>
<figure id="attachment_73183" aria-describedby="caption-attachment-73183" style="width: 1160px" class="wp-caption aligncenter"><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.04.33.png"><img loading="lazy" class="wp-image-73183 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.04.33.png" alt="" width="1160" height="470" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.04.33.png 1160w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.04.33.png?resize=300,122 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.04.33.png?resize=768,311 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.04.33.png?resize=1024,415 1024w" sizes="(max-width: 1160px) 100vw, 1160px" /></a><figcaption id="caption-attachment-73183" class="wp-caption-text">Click to enlarge</figcaption></figure>
<p>Now let’s run a quick test query and see what we get…</p>
<p>Not the most useful of queries, but as a demonstration it works well, we can see the number of distinct process names in each of our forensic snapshots, using the data_source field, we can identify which server each of these came from and check out the run time and data scanned…</p>
<p>Almost 70Gb of snapshot files scanned in less than 13 seconds.  The good thing about this is that each time you re-run the query, it will run across all of the data that is in the bucket each time, so even if you upload 10 more snapshots, you don’t need to change your queries, just re-run them and they will pick up all the latest data.</p>
<p>So, what can I actually use this for?</p>
<p>The test query before was not particularly useful, but there is a lot of threat hunting you can perform with this data, such as:</p>
<ul>
<li>Looking for known bad/suspicious processes and checking the command line (Process view)</li>
<li>Any IOCs on the machine such as registry keys or hashes in the file section (File and Registry views)</li>
<li>Logon events (WinAuthEvent view)</li>
<li>Any domain IOCs (Dns and Url views)</li>
<li>Checking for connections to IP addresses (IpV4Address view)</li>
</ul>
<p>All the threat hunting you could do with this data is out of the scope of this blog post, but I’m sure you can imagine how useful it is to be able to quickly query all this data from a single location.</p>
<figure id="attachment_73184" aria-describedby="caption-attachment-73184" style="width: 1126px" class="wp-caption aligncenter"><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.05.41.png"><img loading="lazy" class="wp-image-73184 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.05.41.png" alt="" width="1126" height="466" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.05.41.png 1126w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.05.41.png?resize=300,124 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.05.41.png?resize=768,318 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-04-at-15.05.41.png?resize=1024,424 1024w" sizes="(max-width: 1126px) 100vw, 1126px" /></a><figcaption id="caption-attachment-73184" class="wp-caption-text">Click to enlarge</figcaption></figure>
<p>A short example query could be looking for connections to a known IP address, in this example the IP address is benign, but if you had a C2 address and wanted to check if anything had been calling out to it, you could use the following to identify the first time a machine connected to that IP, the last time it was recorded and the count of how many times each machine had connected.  The data_source field will show which machine it was that initiated the connection:</p>
<p>This is also a process that’s ripe for automation, converting and uploading snapshots as needed, then running queries over the data periodically looking for known IOCs from threat lists or your own threat data that you have collected.</p>
<h2>Try Sophos EDR for yourself</h2>
<p><a href="https://www.sophos.com/en-us/products/endpoint-antivirus/edr.aspx">Visit our website</a> for more information on Sophos EDR and to start a no-obligation 30 day free trial.</p>
<p>If you’re already running Sophos Central you can active a trial directly within your console – no forms required.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2021/03/04/stopping-gootloader-with-sophos-intercept-x/" rel="prev">Stopping Gootloader with Sophos Intercept X</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/" rel="next">HAFNIUM: Advice about the new nation-state attack</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="109" height="145" src="https://news.sophos.com/wp-content/uploads/2021/03/me.jpg?w=109" class="avatar avatar-145 photo wp-post-image" alt="" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/stephen-oleary/" title="Posts by Stephen O&#039;Leary" class="author url fn" rel="author">Stephen O&#039;Leary</a></h3>

					
					<div class="author-bio">
						<p>Stephen is a senior information security engineer who has been with Sophos for over 13 years. He has held various positions during this time including Technical Support Engineer supporting customers deploying and maintaining encryption software, SQL Server Database Administrator in the internal IT department and now works in the security team managing the SIEM platform and data analysis tools</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/03/05/how-to-query-a-sophos-edr-forensic-snapshot-using-amazon-athena/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='73177' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="35fa3856d0" /></p><input type="hidden" id="ak_js" name="ak_js" value="127"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IQGY2T8ZHMcjqxkaBUHD69mKWJR48jKSX/v2+NqlYAtPeJXBJpBEQSJAPoycHC7HmKM9iolIF8rMB9mx4w2UJ+BrwiQ5i1w7tYwUNrxQV7efXiOdkbL2lFQZlBlctBhWTg1jtDapa+WabZJy2uQda34pYFrAIwb45GvcPKi3gHfrf+XYZMws2D8aRULMhhCRuxRUPH7GwV7zITranRrZtN30AbTfKEQ=='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'73177',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '73177' ]);
</script>
</body>
</html>
