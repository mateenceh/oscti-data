<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>IOC Hunting: Leverage MISP threat intel with Sophos Central Live Discover &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; IOC Hunting: Leverage MISP threat intel with Sophos Central Live Discover Comments Feed" href="https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615460090' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqXEWAK9AIhg='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/73567" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/" />
<link rel='shortlink' href='https://news.sophos.com/?p=73567' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F16%2Fioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F03%2F16%2Fioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="IOC Hunting: Leverage MISP threat intel with Sophos Central Live Discover" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/" />
<meta property="og:description" content="Quickly identify hosts with IOCs using Sophos Central Live Discover API. Having an ear to the ground just got a little easier." />
<meta property="article:published_time" content="2021-03-16T14:17:49+00:00" />
<meta property="article:modified_time" content="2021-03-17T09:10:01+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="334" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="IOC Hunting: Leverage MISP threat intel with Sophos Central Live Discover" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-73567 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-73567" class="post-73567 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate tag-human-led-threat-hunting tag-ioc-hunting tag-security-tips-2 tag-sophos-central tag-sophos-central-api tag-sophos-security-team region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">IOC Hunting: Leverage MISP threat intel with Sophos Central Live Discover</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>&bull;<a href="https://news.sophos.com/en-us/tag/human-led-threat-hunting/">human-led threat hunting</a>&bull;<a href="https://news.sophos.com/en-us/tag/ioc-hunting/">IOC Hunting</a>&bull;<a href="https://news.sophos.com/en-us/tag/security-tips-2/">security tips</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophos-central/">Sophos Central</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophos-central-api/">Sophos Central API</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophos-security-team/">Sophos Security Team</a>		</div>

					<div class="entry-excerpt">
				<p>Quickly identify hosts with IOCs using Sophos Central Live Discover API. Having an ear to the ground just got a little easier.</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/" rel="bookmark">16 March 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=IOC%20Hunting%3A%20Leverage%20MISP%20threat%20intel%20with%20Sophos%20Central%20Live%20Discover%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D73567" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=73567&#038;title=IOC%20Hunting:%20Leverage%20MISP%20threat%20intel%20with%20Sophos%20Central%20Live%20Discover" data-title="IOC Hunting: Leverage MISP threat intel with Sophos Central Live Discover" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/"
				data-title="IOC Hunting: Leverage MISP threat intel with Sophos Central Live Discover"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="334" src="https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg 1207w, https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg?resize=300,157 300w, https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg?resize=768,401 768w, https://news.sophos.com/wp-content/uploads/2018/12/cybermenaces.jpg?resize=1024,534 1024w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/mark-lanczak-faulds/" title="Posts by Mark Lanczak-Faulds" class="author url fn" rel="author">Mark Lanczak-Faulds</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>When the security team first learnt that the Live Discover API was available, we knew this was going to deliver game changing capabilities which could not easily be executed through the Sophos Central UI.</p>
<p>We started to think about the security use cases we could expand upon. One of those at the top of the list was the ability to search the estate for IOCs during investigations on the fly.</p>
<p>Not only would this help us investigate at speed to quickly identify systems of interest, but also track across multiple Sophos Central tenants.</p>
<p>Internally we utilise <a href="https://www.misp-project.org">MISP</a>, an open source threat intelligence platform. During investigations and research, we collate findings under event ids and apply tags to our findings.</p>
<p>We then thought, wouldn’t it be great if we could pull attributes from MISP and have Live Discover API check the estate to see whether any have been sighted? This is where IOC Hunter can help.</p>
<p>Even if you are not using MISP, IOC Hunter allows you to pass IOC data you are interested in, in JSON format directly in the arguments.</p>
<h2>Time to kit up, we’re going hunting</h2>
<p>To start hunting using IOC Hunter, follow these 6 easy steps.</p>
<h3>1. Install Sophos Central API Connector</h3>
<p>First things first, make sure you have installed the latest version of the Sophos Central API Connector. The easiest method to get started is to follow the <a href="https://github.com/sophos-cybersecurity/sophos-central-API-connector#quick-start">quick start guide</a>.</p>
<h3>2. Create the IOC Hunting query on your tenants</h3>
<p>Add the ‘ioc_hunter.sql’ file as a saved custom search to your tenants by following these <a href="https://docs.sophos.com/central/Customer/help/en-us/central/Customer/learningContents/LiveDiscover.html#id_e5z_5v1_2lb">instructions</a>. You can find the query on our team <a href="https://github.com/sophos-cybersecurity/sophos-central-api-connector">GitHub</a>.</p>
<p>Create your variable names and types as:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.38.32.png"><img loading="lazy" class="aligncenter wp-image-73569 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.38.32.png" alt="" width="1044" height="252" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.38.32.png 1044w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.38.32.png?resize=300,72 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.38.32.png?resize=768,185 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.38.32.png?resize=1024,247 1024w" sizes="(max-width: 1044px) 100vw, 1044px" /></a></p>
<p>Remember the name you gave your custom query when you saved it as you will need it later when running ioc_hunter.py when setting arguments.</p>
<p>Another important thing to note is that you need to give your query the same name across all your tenants–the API will need to determine the query id, and this is done by searching for the query name.</p>
<p>We recommend putting some default values in these variables. Not only will this help with testing your setup, if no variables are passed these will be the ones that are used during the posting of the query using IOC Hunter.</p>
<h3>3. Set MISP Configuration</h3>
<p>Not using MISP? You can skip this step.</p>
<p>If you are not using the AWS Secrets Manager to store your API key, simply define your MISP instance URL in the `misp_config.ini` file under the misp_instance section.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.42.35.png"><img loading="lazy" class="aligncenter wp-image-73571 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.42.35.png" alt="" width="1044" height="138" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.42.35.png 1044w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.42.35.png?resize=300,40 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.42.35.png?resize=768,102 768w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.42.35.png?resize=1024,135 1024w" sizes="(max-width: 1044px) 100vw, 1044px" /></a></p>
<p>To find both your API key and instance URL, login to your MISP instance and go to:</p>
<p>Home &gt; Automation</p>
<p>If you are utilizing AWS Secrets Manager to store your API key and are unfamiliar with the steps, follow this <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html#tutorial-basic-step1">AWS tutorial</a> to help you set that up.</p>
<p>Once you have stored your API key you will need to edit the ‘misp_config.ini’ file with the relevant information of where to obtain your key from:</p>
<ul>
<li>secret_name: &lt;secret_name&gt;</li>
<li>region_name: &lt;aws_region&gt;</li>
<li>API_key: &lt;specified_key_name&gt;</li>
</ul>
<p>If no AWS data is provided and you have set the MISP flag in the arguments, the ioc_hunter.py file will prompt you for the relevant data when run.</p>
<h3>4. Construct your query filter to strategically cast your net across the estate</h3>
<p>The aim of the IOC Hunter is not to blanket search your estate each time but rather to focus on a group of systems that could potentially have the IOCs you are querying for.</p>
<p>The API searches themselves have a 600 second automatic termination threshold, so reducing the scope of where the query will be run will help ensure that the search is able to complete in all locations and provide enough results for you to analyse.</p>
<p>To help we prefill the required elements to run the queries as much as possible. The API allows for granular filtering for your query and can have multiple filters in the array. The API details on posting a run provides a useful tool to help build out your <a href="https://developer.sophos.com/docs/live-discover-v1/1/routes/queries/runs/post">filters</a>.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.49.46.png"><img loading="lazy" class="aligncenter wp-image-73572 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.49.46.png" alt="" width="454" height="378" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.49.46.png 454w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.49.46.png?resize=300,250 300w" sizes="(max-width: 454px) 100vw, 454px" /></a></p>
<p>&nbsp;</p>
<p>For example, if you wanted to run the query on all Windows endpoints you can pre-build the filter and copy the details between the filters square brackets to be used in your filter argument:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.50.50.png"><img loading="lazy" class="aligncenter wp-image-73573 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.50.50.png" alt="" width="948" height="660" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.50.50.png 948w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.50.50.png?resize=300,209 300w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.50.50.png?resize=768,535 768w" sizes="(max-width: 948px) 100vw, 948px" /></a></p>
<h3>5. Set query variable data</h3>
<p>Now we have the means to search for IOCs we want to specify what exactly those IOCs are and in what timeframe.</p>
<p>The three variables are:</p>
<ol>
<li>IOC JSON</li>
</ol>
<p>As we alluded to earlier, you don’t need to have MISP to search for IOCs across your estate. You can specify RAW JSON data for IOCs. This needs to follow a certain schema as shown below to be parsed correctly in the Live Discover query:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.52.44.png"><img loading="lazy" class="aligncenter wp-image-73574 size-full" src="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.52.44.png" alt="" width="508" height="364" srcset="https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.52.44.png 508w, https://news.sophos.com/wp-content/uploads/2021/03/Screenshot-2021-03-15-at-10.52.44.png?resize=300,215 300w" sizes="(max-width: 508px) 100vw, 508px" /></a></p>
<p>Valid ‘indicator_type’ entries are:</p>
<ul>
<li>ip</li>
<li>url</li>
<li>domain</li>
<li>port</li>
<li>sha256</li>
<li>filename, file_path, file_path_name, pathname</li>
</ul>
<p>The data is a string value and can contain wildcards ‘%’. There will be some examples below for various scenarios.</p>
<p>2. Number of Hours of activity to search</p>
<p>This is the span of hours to search on each asset. Its recommended to search no more than 48hrs. However, this depends on the amount of data your assets collect. You can tweak this as needed depending on the results.</p>
<p>3. Start Search From</p>
<p>This is the starting point of when the data will be searched and is in the format of: %Y-%m-%dT%H:%M:%S.</p>
<p>For example, if you want to search since the start of March 2021, you will pass the variable: 2021-03-01T00:00:00. The query will then search from this point for the number of hours passed in the second variable.</p>
<p>An important thing to note is that the variables have a max size limit of 5Kb. We do verify the size during the construction of the variables at runtime.</p>
<h3>6. Hunt</h3>
<p>Now we have done the groundwork we can now start hunting! Below are some examples using ioc_hunter.py for given scenarios.</p>
<p>IOCs from MISP event id:</p>
<p><strong>Aim:</strong> Search all Windows computers for IOCs related to MISP Event ID 1 over a 24hr period since 1<sup>st</sup> March 2021.</p>
<p>By breaking this down we can build the arguments we need to run on ioc_hunter.py:</p>
<pre>--search_type = saved

--search_input = IOC_Hunter

--filter = “{  \"os\": [    {      \"platform\": \"windows\",      \"type\": \"computer\"    }  ]}”</pre>
<ul>
<li>N.B. we need to escape the quotes to wrap the filter in quotes and be parsed correctly</li>
</ul>
<pre>--variables:</pre>
<ul>
<li>Number of Hours of activity to search = 24</li>
<li>IOC JSON = % (We add the wildcard here as this will be replaced with the relevant IOC data from MISP)</li>
<li>Start Search From = 2021-03-01T00:00:00 (following the format in variable information above)</li>
</ul>
<pre>--misp = true

--misp_type = eventid

--misp_val = 1</pre>
<p>Putting this together we get:</p>
<p><textarea rows="3">&#8211;search_type saved &#8211;search_input IOC_Hunter &#8211;filter “{&nbsp; \&#8221;os\&#8221;: [&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&#8221;platform\&#8221;: \&#8221;windows\&#8221;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&#8221;type\&#8221;: \&#8221;computer\&#8221;&nbsp;&nbsp;&nbsp; }&nbsp; ]}” &nbsp;&#8211;variables 24 % 2021-03-01T00:00:00 &#8211;misp true &#8211;misp_type eventid &#8211;misp_val 1</textarea></p>
<p>Further examples using the same process as above.</p>
<p>IOCs from MISP tags:</p>
<p><textarea rows="3">&#8211;search_type saved &#8211;search_input IOC_Hunter &#8211;filter “{\&#8221;os\&#8221;: [{\&#8221;platform\&#8221;: \&#8221;windows\&#8221;, \&#8221;type\&#8221;: \&#8221;computer\&#8221;}]}&#8221; &#8211;variables 24 % 2021-03-01T00:00:00 &#8211;misp true &#8211;misp_type tag &#8211;misp_val HAFNIUM</textarea></p>
<p>IOCs from RAW JSON:</p>
<p><textarea rows="5">&#8211;search_type saved &#8211;search_input IOC_Hunter &#8211;filter “{\&#8221;os\&#8221;: [{\&#8221;platform\&#8221;: \&#8221;windows\&#8221;, \&#8221;type\&#8221;: \&#8221;computer\&#8221;}]}&#8221; &#8211;variables 24 &#8220;{&nbsp;&nbsp; \&#8221;ioc_data\&#8221;: [&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&#8221;indicator_type\&#8221;: \&#8221;url\&#8221;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&#8221;data\&#8221;: \&#8221;%&lt;badurl&gt;.com%\&#8221;&nbsp;&nbsp;&nbsp;&nbsp; },&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&#8221;indicator_type\&#8221;: \&#8221;ip\&#8221;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&#8221;data\&#8221;: \&#8221;%&lt;badip&gt;%\&#8221;&nbsp;&nbsp;&nbsp;&nbsp; },&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&#8221;indicator_type\&#8221;: \&#8221;filename\&#8221;,&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;\&#8221;data\&#8221;: \&#8221;&lt;filename&gt;\&#8221;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp; ] }&#8221; 2021-03-01T00:00:00</textarea></p>
<p>No variables passed:</p>
<p><textarea rows="2">&#8211;search_type saved &#8211;search_input IOC_Hunter &#8211;filter “{\&#8221;os\&#8221;: [{\&#8221;platform\&#8221;: \&#8221;windows\&#8221;, \&#8221;type\&#8221;: \&#8221;computer\&#8221;}]}&#8221;</textarea></p>
<h2>Output</h2>
<p>Once the searches have completed three JSON files will be created in the tmp folder located:</p>
<p>&lt;path_to_folder&gt;\sophos_central_api_connector\tmp\</p>
<ul>
<li>endpoint_data.json</li>
</ul>
<p>This contains details on the endpoints that the query was run on, this will allow you to check which endpoints failed to run the query so they can be re-queried at a later point.</p>
<ul>
<li>result_data.json</li>
</ul>
<p>This contains any hits on the IOCs or provides details on the outcome of the saved search run. It will also clarify where no results were found on a tenant</p>
<ul>
<li>search_data.json</li>
</ul>
<p>This contains details on the search run and on which tenants. It contains information on the overall outcome of the search.</p>
<h2>So, what&#8217;s next?</h2>
<p>We certainly hope this helps streamline your IOC hunting in your Sophos Central estate and proves to be a valuable tool in your arsenal.</p>
<p>The Sophos Central Live Discover API is extremely powerful and will allow us to expand in many directions. Be sure to star the project on our <a href="https://github.com/sophos-cybersecurity/sophos-central-api-connector">GitHub page</a> to keep track of upcoming changes.</p>
<p>We have several ideas which are being worked on to integrate with IOC Hunter. Keep an eye out for future updates.</p>
<p>In the meantime, happy hunting!</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2021/03/16/installing-mtr-on-the-run-to-keep-up-with-netwalker/" rel="prev">Installing MTR on the run to keep up with Netwalker</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2021/03/17/mtr-in-real-time-exchange-proxylogon-edition/" rel="next">MTR in Real-Time: Exchange ProxyLogon Edition</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="145" src="https://news.sophos.com/wp-content/uploads/2018/11/mark-lanczak-faulds.jpg?w=145" class="avatar avatar-145 photo wp-post-image" alt="Mark-Lanczak-Faulds" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/mark-lanczak-faulds/" title="Posts by Mark Lanczak-Faulds" class="author url fn" rel="author">Mark Lanczak-Faulds</a></h3>

					
					<div class="author-bio">
						<p>Mark is a Senior Information Security Engineer at Sophos. He has worked at Sophos for 13 years in various roles, starting in Tech Support (Windows, Mac and Encryption), IT (Internal Product Implementation Specialist) and currently in the Security Engineering team focusing on detections, automation and SIEM.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/03/16/ioc-hunting-leverage-misp-threat-intel-with-sophos-central-live-discover/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='73567' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="014be982b9" /></p><input type="hidden" id="ak_js" name="ak_js" value="224"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IYCw648H4KAZZ3ZgUCAWnby9mWeLBw0h66d/va5OKOTDtXQKXRBoBgQT5MHpyMBNrG3kUE5UqkH8YYM+Wt1yWgC8Bn2gnNu3QPlbQ8EpR0XZ+iXhOxtZbWmFQZnDVYlAxOYjV3qCqlW+2SsZpm3ug5a2IZQGLEOybo3H/oNIC3qD/na+XMbNg82AcCfUwhJDEtbji7iMW9oJn2cnDvmuaUzN9AG09yg4='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'73567',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '73567' ]);
</script>
</body>
</html>
