<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>IPs that Are Malicious Together, Stay Together &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; IPs that Are Malicious Together, Stay Together Comments Feed" href="https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.7/css/jetpack.css?m=1620864031' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZkYGFmYmBsWEWAK9NIhc='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/75202" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/" />
<link rel='shortlink' href='https://news.sophos.com/?p=75202' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F05%2F13%2Fips-that-are-malicious-together-stay-together%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F05%2F13%2Fips-that-are-malicious-together-stay-together%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
		<link rel="amphtml" href="https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="IPs that Are Malicious Together, Stay Together" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/" />
<meta property="og:description" content="While the threat landscape is extremely sophisticated and diverse, almost all threats involve communication with the internet at some stage of their attack. This communication could include attacke…" />
<meta property="article:published_time" content="2021-05-13T13:00:40+00:00" />
<meta property="article:modified_time" content="2021-05-13T06:46:38+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png" />
<meta property="og:image:width" content="1313" />
<meta property="og:image:height" content="760" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="IPs that Are Malicious Together, Stay Together" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-75202 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-75202" class="post-75202 post type-post status-publish format-standard hentry category-corporate tag-ip-detection tag-network-prefix tag-sophos-ai region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">IPs that Are Malicious Together, Stay Together</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>&bull;<a href="https://news.sophos.com/en-us/tag/ip-detection/">IP detection</a>&bull;<a href="https://news.sophos.com/en-us/tag/network-prefix/">Network Prefix</a>&bull;<a href="https://news.sophos.com/en-us/tag/sophos-ai/">Sophos AI</a>		</div>

		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/" rel="bookmark">13 May 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=IPs%20that%20Are%20Malicious%20Together%2C%20Stay%20Together%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D75202" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=75202&#038;title=IPs%20that%20Are%20Malicious%20Together,%20Stay%20Together" data-title="IPs that Are Malicious Together, Stay Together" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/"
				data-title="IPs that Are Malicious Together, Stay Together"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/madeline-schiappa/" title="Posts by Madeline Schiappa" class="author url fn" rel="author">Madeline Schiappa</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>While the threat landscape is extremely sophisticated and diverse, almost all threats involve communication with the internet at some stage of their attack. This communication could include attackers transmitting malicious payloads for initial access, ransomware communicating with command and control to exchange encryption keys, or espionage tools exfiltrating sensitive information to sharing sites.</p>
<p>These communications either start with a hostname that needs to be resolved to an IP address, or with an IP address directly, but in all cases, an IP address is ultimately the identifier of communication. In simple terms, an IP address is a numerical label assigned to each device connected to a network that uses the internet. Like an address to your home, an IP address provides information that helps routing protocols on the internet find destinations.</p>
<p>Obviously not all communications with the internet are malicious, including for example, your favorite social media websites. A social media site is hosted on an IP address where you can browse different individual’s profiles and interact with them. News articles you click on from a friend’s post resolve and redirect to an IP serving content from a different site. Some IP addresses run multiple concurrent services or can serve content for multiple different sites from entirely different content owners. Some identical content can get served from multiple different IP addresses. These dynamics make differentiating between IP addresses that are up to no good versus IP addresses that are harmless a daunting task that all security vendors take-on.</p>
<h2>The Anatomy of an IP</h2>
<p>The beginning of an IP address is the location of the destination network, called the <em>Network Prefix</em>, and the end is the location of the device on that network, called the <em>Host ID</em>. The network prefixes are written in a format that uses a slash (“/”) character followed by a decimal number to indicate how many bits refer to the network prefix. For example, 198.51.100.0/24 has 24 bits allocated for the network prefix and the remaining 8 bits reserved for host addressing resulting in the range 198.51.100.0 to 198.51.100.255 addresses belonging to this network. A subnet is a division of the larger network to smaller ones. To find the destination of a smaller network, a <em>subnet mask</em> divides the IP address into a network address and host address. In the example in Figure 1, the subnet-mask indicates a packet should first route to the network address <em>172.16.2.0</em> and then route to the host address <em>0.0.0.15</em>.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-6.png"><img loading="lazy" class="alignnone wp-image-75203" src="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-6.png?w=300" alt="" width="912" height="225" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-6.png 979w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-6.png?resize=300,74 300w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-6.png?resize=768,189 768w" sizes="(max-width: 912px) 100vw, 912px" /></a></p>
<p style="text-align: center"><em>Figure 1. IP Address breakdown.</em></p>
<p>IP addresses are often tied to physical infrastructure related to their host or provider, more specifically <em>Internet Service Providers</em> (ISPs). ISPs are the organizations that manage a given range of network prefixes. Some ISPs might spend a lot of effort maintaining a high reputation for security, while others, like “bulletproof hosting” providers, might openly welcome customers that want to host malicious content. Understanding the variety of threat levels that occur between ISPs is often overlooked but is an area SophosAI has applied to their IP detection framework.</p>
<h2>Challenges with IP Detection</h2>
<p>Despite the age and simplicity of this technique, block-lists at the IP/Domain level are still a very popular method of defense against malicious internet traffic.  However, they are difficult to maintain and are easy to evade because the IP space is very large and very active.  An example of block-list evasion is when an IP that routes to a malicious location can temporarily or conditionally route to benign content while a different IP from the same infrastructure routes to the original malicious content. This temporary change is called a “cool-down” period which often results in security vendors reversing the IP reputation from malicious to benign, allowing it to be used again for malicious activity in the future.</p>
<p>SophosAI wants to deviate from the traditional reputation-based systems to an approach that is easier to maintain, learns quickly, and classifies an IP regardless of any “cool-down” periods. To do this, they trained a model on a novel representation of IP addresses with additional information that can be found either in public registration information or from additional AI methods that use an IP’s neighborhood to fill in the gaps.</p>
<h2>The New Approach</h2>
<p style="text-align: left">SophosAI collected over 450,000 IP addresses hosting web-content labeled either malicious or benign using internal telemetry tools. They also collected over 400,000 IPs related to e-mail campaigns from existing anti-spam lists. Tamás Vörös, a data scientist in SophosAI, used existing knowledge of how IP address space is allocated to Internet Service Providers (ISPs) to generate a heat map visualizing web and spam activity where blue points represent benign activity and red malicious. For more details on how these plots were generated, please read the more in-depth <a href="https://ai.sophos.com/using-ai-to-detect-malicious-ip-addresses-clusters/">SophosAI blog post</a>.<a href="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png"><img loading="lazy" class="alignnone wp-image-75204" src="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?w=300" alt="" width="889" height="889" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png 1100w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=300,300 300w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=768,768 768w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=1024,1024 1024w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-7.png?resize=128,128 128w" sizes="(max-width: 889px) 100vw, 889px" /></a><em>Figure 2. S Web-based IP addresses organized by ISP defined blocks. Blue dots indicate an IP address that engaged in benign activity while red dots indicate malicious activity.</em></p>
<p style="text-align: center"><a href="https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png"><img loading="lazy" class="alignnone wp-image-75205" src="https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?w=300" alt="" width="899" height="899" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png 1100w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=300,300 300w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=768,768 768w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=1024,1024 1024w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-2.png?resize=128,128 128w" sizes="(max-width: 899px) 100vw, 899px" /></a><em>Figure 3. Spam-based IP addresses organized by ISP defined blocks. Blue dots indicate an IP address that engaged in benign activity while red dots indicate malicious activity.</em></p>
<p>Vörös observed that there were distinct clusters of malicious activity and that some ISPs have contributions to the malicious landscape that are disproportionate to the size of the IP space they own.</p>
<p>The next challenge is using this information in a way that an AI model can understand. With this challenge in mind, SophosAI developed a new representation for IPs that allows the model to efficiently evaluate both the IP address itself as well as all the subnets that could potentially be generated from that IP address.  These subnets can map to the high-level structure of the internet, indicating which collections of related IP addresses are controlled by a single organization.  To further the use of physical infrastructure associated with an IP address, information about Internet Service Providers (ISPs) was added to the feature set that was fed to a detection model. By observing a high cluster of malicious activity in one segment of the IP space, a model can learn how to determine if different segments owned by the same ISP are also malicious. A challenge with using ISP for this task, however, is that we do not always have this information at detection time. To address this issue, a model was trained to map IPs to ISPs and the output was used an additional feature to train an IP detection model, improving results compared to using IP address alone. Figure 2 shows the model&#8217;s understanding of the IP space where each IP address is colored based on their respective ISP. Prior to training, the model does not differentiate well between IPs from one ISP versus another, but after training, you see a more distinct separation.</p>
<p>&nbsp;</p>
<p style="text-align: center"><img loading="lazy" class="alignnone wp-image-75206" src="https://news.sophos.com/wp-content/uploads/2021/05/Picture-3.png?w=300" alt="" width="903" height="443" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Picture-3.png 1430w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-3.png?resize=300,147 300w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-3.png?resize=768,377 768w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-3.png?resize=1024,503 1024w" sizes="(max-width: 903px) 100vw, 903px" /><em>Figure 4. A visualization of IPs and their respective ISPs after model training. Each dot represents an IP address and the dot’s color indicates which ISP the IP belongs too. Before training, there is no real differentiation between the model’s understanding of the ISP space in terms of IP. However, after training, there are distinct clusters of IP addresses based on the ISP they belong to.</em></p>
<p>Using these models, they visualized the IP space more clearly and found groups of malicious IPs, regardless of any “cool-down” periods over time. Using a data-driven AI model to assign these IPs to a cluster of either benign or malicious activity allows better detection of never-before-seen IPs.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png"><img loading="lazy" class="alignnone wp-image-75207" src="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png?w=300" alt="" width="898" height="521" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png 1313w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png?resize=300,174 300w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png?resize=768,445 768w, https://news.sophos.com/wp-content/uploads/2021/05/Picture-1-8.png?resize=1024,593 1024w" sizes="(max-width: 898px) 100vw, 898px" /></a></p>
<p style="text-align: center"><em>Figure 5. Model detections on IP address. The scores are based on how likely an IP is to be malicious.</em></p>
<h2>Bringing It All Together</h2>
<p>With Vörös’ research, SophosAI can better understand malicious activity distributed across the IP space, both in web and e-mail traffic. Not only did Vörös find clusters of malicious activity based on physical infrastructure of network traffic, but he also mapped IPs to their physical infrastructure when unknown, allowing detection of a never-before-seen IP. Integrating these findings with other tools enhances protection for organizations from potentially devastating ransomware attacks, targeted financial cybercrime, and cyber-espionage attacks stemming from malicious web-based or email-based campaigns.</p>
<p><u>For more information about this topic, please read Vörös’ <a href="https://ai.sophos.com/using-ai-to-detect-malicious-ip-addresses-clusters/">technical post</a> on </u><a href="https://ai.sophos.com/">SophosAI</a><u>.</u></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2021/05/12/us-government-cybersecurity-challenges-and-opportunities/" rel="prev">US Government Cybersecurity Challenges and Opportunities</a>
						   			</div>
	   			<div class="nav-next">
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="109" src="https://news.sophos.com/wp-content/uploads/2018/07/Maddy-Schiappa.jpg?w=145" class="avatar avatar-145 photo wp-post-image" alt="" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/madeline-schiappa/" title="Posts by Madeline Schiappa" class="author url fn" rel="author">Madeline Schiappa</a></h3>

					
					<div class="author-bio">
						<p>Madeline Schiappa is a PhD student studying deep learning at the University of Central Florida's Center of Research in Computer Vision Lab, and is a SophosLabs Alumni.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/05/13/ips-that-are-malicious-together-stay-together/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='75202' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="c3e1b8bbcf" /></p><input type="hidden" id="ak_js" name="ak_js" value="117"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IYEMzvRgfxSCrG5MCoeD07cUsSzx4GEkv/ft9bVIxB6a9S+CSSCMgkCAfRk8OZmKyaY9iolIF8g8D7Cm55G0J+BLwiXZi0w7tYwUNrxQVbeeXiOdkbL2lFQZlBlctBhWTg1jtDapa+WarZJy2uQda3opYFrAIwb45GvcPKi3gDfrf+XoZMws2D8aRUA9DCElciyvuPmJhL3huO9mcukOzl9MHbUDKDg=='></script>
<script src='https://stats.wp.com/e-202119.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'166161023',post:'75202',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '75202' ]);
</script>
</body>
</html>
