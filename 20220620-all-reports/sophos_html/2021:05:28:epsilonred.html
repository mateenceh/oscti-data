<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/05/28/epsilonred/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>A new ransomware enters the fray: Epsilon Red &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; A new ransomware enters the fray: Epsilon Red Comments Feed" href="https://news.sophos.com/en-us/2021/05/28/epsilonred/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.7/css/jetpack.css?m=1621958629' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZkYGFmYmBsUUWAK9bIh4='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/75686" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/05/28/epsilonred/" />
<link rel='shortlink' href='https://news.sophos.com/?p=75686' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F05%2F28%2Fepsilonred%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F05%2F28%2Fepsilonred%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
		<link rel="amphtml" href="https://news.sophos.com/en-us/2021/05/28/epsilonred/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="A new ransomware enters the fray: Epsilon Red" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/05/28/epsilonred/" />
<meta property="og:description" content="A bare-bones ransomware offloads most of its functionality to a cache of PowerShell scripts" />
<meta property="article:published_time" content="2021-05-28T12:30:31+00:00" />
<meta property="article:modified_time" content="2021-05-28T17:15:00+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2021/05/Epsilon-Red-Marvel-Comics-Wolverine-cosmonaut-h1.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2021/05/Epsilon-Red-Marvel-Comics-Wolverine-cosmonaut-h1.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="380" />
<meta property="og:image:alt" content="Epsilon Red as he appeared in comic books" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="A new ransomware enters the fray: Epsilon Red" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2021/05/Epsilon-Red-Marvel-Comics-Wolverine-cosmonaut-h1.jpg?w=640" />
<meta name="twitter:image:alt" content="Epsilon Red as he appeared in comic books" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-75686 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-75686" class="post-75686 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-epsilon-red tag-epsilonred tag-exchange tag-powershell tag-proxylogon tag-ransomware tag-wmi region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">A new ransomware enters the fray: Epsilon Red</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/epsilon-red/">Epsilon Red</a>&bull;<a href="https://news.sophos.com/en-us/tag/epsilonred/">EpsilonRed</a>&bull;<a href="https://news.sophos.com/en-us/tag/exchange/">Exchange</a>&bull;<a href="https://news.sophos.com/en-us/tag/powershell/">Powershell</a>&bull;<a href="https://news.sophos.com/en-us/tag/proxylogon/">ProxyLogon</a>&bull;<a href="https://news.sophos.com/en-us/tag/ransomware/">Ransomware</a>&bull;<a href="https://news.sophos.com/en-us/tag/wmi/">WMI</a>		</div>

					<div class="entry-excerpt">
				<p>A bare-bones ransomware offloads most of its functionality to a cache of PowerShell scripts</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/05/28/epsilonred/" rel="bookmark">28 May 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=A%20new%20ransomware%20enters%20the%20fray%3A%20Epsilon%20Red%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D75686" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=75686&#038;title=A%20new%20ransomware%20enters%20the%20fray:%20Epsilon%20Red" data-title="A new ransomware enters the fray: Epsilon Red" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/05/28/epsilonred/"
				data-title="A new ransomware enters the fray: Epsilon Red"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="380" src="https://news.sophos.com/wp-content/uploads/2021/05/Epsilon-Red-Marvel-Comics-Wolverine-cosmonaut-h1.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Epsilon Red as he appeared in comic books" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Epsilon-Red-Marvel-Comics-Wolverine-cosmonaut-h1.jpg 725w, https://news.sophos.com/wp-content/uploads/2021/05/Epsilon-Red-Marvel-Comics-Wolverine-cosmonaut-h1.jpg?resize=300,178 300w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p><span data-contrast="auto">In the past week, Sophos analysts uncovered a new ransomware written in the Go programming language that calls itself <strong>Epsilon Red</strong>. The malware was delivered as the final executable payload in a hand-controlled attack against a US-based business in the hospitality industry in which every other early-stage component was a PowerShell script. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">Based on the cryptocurrency address provided by the attackers, it appears that at least one of their victims paid a ransom of 4.29BTC on May 15</span><span data-contrast="auto">th</span><span data-contrast="auto"> (valued at roughly $210,000 on that date).</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><img loading="lazy" class="alignnone wp-image-75703" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-payment-transaction-obfuscated.png" alt="" width="854" height="124" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-payment-transaction-obfuscated.png 1506w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-payment-transaction-obfuscated.png?resize=300,44 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-payment-transaction-obfuscated.png?resize=768,112 768w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-payment-transaction-obfuscated.png?resize=1024,149 1024w" sizes="(max-width: 854px) 100vw, 854px" /></p>
<p><span data-contrast="auto">While the name and the tooling were unique to this attacker, the ransom note left behind on infected computers resembles the note left behind by </span><span data-contrast="auto">REvil </span><span data-contrast="auto">ransomware, but adds a few minor grammatical corrections. There were no other obvious similarities between the Epsilon Red ransomware and </span><span data-contrast="auto">REvil</span><span data-contrast="auto">.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">It appears that an enterprise Microsoft Exchange server was the initial point of entry by the attackers into the enterprise network. It isn’t clear whether this was enabled by the ProxyLogon exploit or another vulnerability, but it seems likely that the root cause was an unpatched server. From that machine, the attackers used WMI to install other software onto machines inside the network that they could reach from the Exchange server.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">The name Epsilon Red, like many coined by ransomware threat actors, is a reference to pop culture. The character Epsilon Red was a relatively obscure adversary of some of the X-Men in the Marvel extended universe, a &#8220;super soldier&#8221; alleged to be of Russian origin, sporting four mechanical tentacles and a bad attitude.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h3><span data-contrast="none">Laying the groundwork using PowerShell</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">During the attack, the threat actors launched a series of PowerShell scripts, numbered <strong>1.ps1</strong> through <strong>12.ps1</strong> (as well as some that just were named with a single letter from the alphabet), that prepared the attacked machines for the final ransomware payload and, ultimately delivered and initiated it. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><img loading="lazy" class="alignnone wp-image-75697" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-files-in-folder.png" alt="" width="421" height="485" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-files-in-folder.png 357w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-files-in-folder.png?resize=261,300 261w" sizes="(max-width: 421px) 100vw, 421px" /></p>
<p><span data-contrast="auto">The PowerShell orchestration was, itself, created and triggered by a PowerShell script named <strong>RED.ps1</strong> that was executed on the target machines using WMI. The script retrieves and unpacks into the </span><i><span data-contrast="auto">system32 </span></i><span data-contrast="auto">folder a .7z archive file that contains the rest of the PowerShell scripts, the ransomware executable, and another executable. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p>It also sets up Scheduled Tasks that run the scripts numbered 1 through 12 but skips 7 and 8, it also creates tasks for scripts named “S” and “C.”</p>
<div><span data-contrast="auto">A typical Scheduled Task command looked like:</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></div>
<pre><span data-contrast="none">C:\Windows\system32\schtasks.exe /create /tn Microsoft\Windows\TASK12 /tr "powershell -file c:\windows\system32\RED\12.ps1" /sc minute /mo 2 /ru SYSTEM /f</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></pre>
<p><span data-contrast="auto">For example, when attackers ran the 2.ps1 script on a machine, it executed a command that deleted the Volume Shadow Copies from the computer. This is an important precursor to the attack, as these files could be used to recover some or all of the files encrypted by the attackers.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">A PowerShell script named <strong>c.ps1</strong> appears to be a clone of an open source tool called </span><a href="https://github.com/samratashok/nishang/blob/master/Gather/Copy-VSS.ps1" target="_blank" rel="noopener"><span data-contrast="auto">Copy-VSS</span></a><span data-contrast="auto">, part of a suite of penetration tester tools named <em>Nishang</em>. The Copy-VSS script permits an attacker to copy the SAM file, which an attacker could use to retrieve and crack passwords saved on the computer.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h3><span data-contrast="none">Obscured&#8230;Just Enough</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">The PowerShell scripts also use a rudimentary form of obfuscation in which the threat actors appear to have added in some square brackets and braces at random into the script, breaking up the lines of PowerShell script code, and then use a command that strips out those brackets.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><img loading="lazy" class="alignnone wp-image-75698" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-powershell-obfuscation-logo.png" alt="" width="851" height="117" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-powershell-obfuscation-logo.png 965w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-powershell-obfuscation-logo.png?resize=300,41 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-powershell-obfuscation-logo.png?resize=768,105 768w" sizes="(max-width: 851px) 100vw, 851px" /></p>
<p><span data-contrast="auto">While this technique doesn’t have much of an effect on our ability to analyze the files after the fact, it might be just good enough to evade the detection of an anti-malware tool that’s scanning the files on the hard drive for a few minutes, which is all the attackers really need.</span></p>
<p><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}">We were able to use the same rules the attackers set up to craft <a href="http://bit.ly/epsilonred-cleanup" target="_blank" rel="noopener">a recipe using CyberChef</a> that strips out the extraneous characters and renders the script human-readable.<br />
</span></p>
<h3><span data-contrast="none">Blocked firewall ports and cleaning up tracks</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">The red.ps1 script unpacks RED.7z into the %SYSTEM%\RED directory, then creates scheduled tasks that run the unpacked scripts. But then it waits one hour, and executes commands that modify the Windows Firewall rules such that the firewall blocks inbound connections on all TCP ports <em>except</em> the Remote Desktop Protocol’s <strong>3389/tcp</strong> and the communications port used by <a href="https://www.remoteutilities.com/" target="_blank" rel="noopener">a commercial tool called Remote Utilities</a>, <strong>5650/tcp.</strong></span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75699" aria-describedby="caption-attachment-75699" style="width: 747px" class="wp-caption alignnone"><img loading="lazy" class=" wp-image-75699" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewall-commands-logo.png" alt="" width="747" height="252" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewall-commands-logo.png 955w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewall-commands-logo.png?resize=300,101 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewall-commands-logo.png?resize=768,260 768w" sizes="(max-width: 747px) 100vw, 747px" /><figcaption id="caption-attachment-75699" class="wp-caption-text">Firewall rules modified by the RED.ps1 script</figcaption></figure>
<p><span data-contrast="auto">Oddly, it does this by first blocking inbound traffic to ports 80 and 443, then redundantly blocks entire large ranges of ports that include 80 and 443, but also exclude the RDP and Remote Utilities ports: 1-3388, 3390-5649, and 5651-65352.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75700" aria-describedby="caption-attachment-75700" style="width: 712px" class="wp-caption alignnone"><img loading="lazy" class=" wp-image-75700" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewallrules-logo.png" alt="" width="712" height="169" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewallrules-logo.png 1332w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewallrules-logo.png?resize=300,71 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewallrules-logo.png?resize=768,182 768w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewallrules-logo.png?resize=1024,243 1024w" sizes="(max-width: 712px) 100vw, 712px" /><figcaption id="caption-attachment-75700" class="wp-caption-text">Epsilon Red firewall rules appear in the Windows Firewall UI</figcaption></figure>
<p><span data-contrast="auto">Upon closer inspection, one of the first things the attackers did after gaining access to the target&#8217;s network was to download and install a copy of Remote Utilities and the Tor Browser, so this seems like a way to reassure themselves they will have an alternate foothold if the initial access point gets locked down.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h3><span data-contrast="auto">An unusual commercial remote access tool</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">The commercial Remote Utilities software, used by the criminals, has several features they might find helpful. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">For one thing, they can use it for free. Anyone can submit an email address through the company’s website and receive a free license key by email that allows them to use the full capability of the product on up to 10 machines, in perpetuity.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><img loading="lazy" class="alignnone size-full wp-image-75701" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-remoteutilities-exemaker-logo.png" alt="" width="640" height="258" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-remoteutilities-exemaker-logo.png 728w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-remoteutilities-exemaker-logo.png?resize=300,121 300w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><span data-contrast="auto">The company’s “Viewer” software includes the ability for a licensed user to generate a digitally signed executable installer, pre-configured with a password and other preferences embedded into the .exe. Users choose their options, which get transmitted back to the company via the application to generate a unique “One-Click package&#8221; executable the program then downloads. The threat actor can then deploy this installer, which runs unattended, and automatically synchronizes to their Remote Utilities Viewer console.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">The console also serves as a Remote Desktop client utility, as a convenience.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75702" aria-describedby="caption-attachment-75702" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-75702 size-full" src="https://news.sophos.com/wp-content/uploads/2021/05/rutserv-digital-signature-logo.png" alt="" width="640" height="368" srcset="https://news.sophos.com/wp-content/uploads/2021/05/rutserv-digital-signature-logo.png 851w, https://news.sophos.com/wp-content/uploads/2021/05/rutserv-digital-signature-logo.png?resize=300,172 300w, https://news.sophos.com/wp-content/uploads/2021/05/rutserv-digital-signature-logo.png?resize=768,441 768w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75702" class="wp-caption-text">Both rutserv.exe samples are digitally signed with Remote Utilities&#8217; certificate</figcaption></figure>
<p><span data-contrast="auto">We found that the attackers had generated at least two of these “One-Click installer” executables, which they downloaded to several machines on the target’s network and ran. The installer was named <strong>rutserv.exe</strong> and the attackers stored it in different filesystem locations on different machines they downloaded it to.</span></p>
<p><img loading="lazy" class="alignnone size-full wp-image-75709" src="https://news.sophos.com/wp-content/uploads/2021/05/locations-where-rutserv-was-stored.png" alt="" width="446" height="124" srcset="https://news.sophos.com/wp-content/uploads/2021/05/locations-where-rutserv-was-stored.png 446w, https://news.sophos.com/wp-content/uploads/2021/05/locations-where-rutserv-was-stored.png?resize=300,83 300w" sizes="(max-width: 446px) 100vw, 446px" /></p>
<h3><span data-contrast="none">Running down the orchestration scripts</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p>Initially, the malware runs the scripts numbered 9 and 12, this is followed by a 180 second delay, before then creating the tasks for 1 through 6, 10, 11, and S.ps1 and C.ps1. By default, the attackers extracted these ﬁles to a folder named RED under the %SYSTEM% path. Each of these scripts accomplishes a speciﬁc task the threat actors use to prepare the system prior to launching the ransomware. Many of these tasks involve hindering security or backup tools, but also involve disabling or killing processes that, if they were running, might prevent a complete encryption of the valuable data on the hard drive.</p>
<figure id="attachment_75706" aria-describedby="caption-attachment-75706" style="width: 793px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-75706" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-redps1-schtasks-logo.png" alt="" width="793" height="327" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-redps1-schtasks-logo.png 1062w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-redps1-schtasks-logo.png?resize=300,124 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-redps1-schtasks-logo.png?resize=768,317 768w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-redps1-schtasks-logo.png?resize=1024,422 1024w" sizes="(max-width: 793px) 100vw, 793px" /><figcaption id="caption-attachment-75706" class="wp-caption-text">The RED.ps1 script executes 12 of the 14 PowerShell scripts by adding them to the Task Scheduler</figcaption></figure>
<p><span data-contrast="auto">It isn’t clear whether the attackers were just being thorough or if they weren’t sure they could do what they set out to do, but in several cases the scripts issue redundant commands to accomplish the same goal using slightly different methods.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">For instance, the <strong>1.ps1</strong> file looks for processes that contain any of the following strings in their process name, and attempts to kill them</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}">:</span></p>
<pre style="padding-left: 40px;">'sql','Sql','SQL','BASup','Titan','SBAM','sbam','vipre','Vipre','Cylance','cylance','Senti','senti','sql','backup','veeam','outlook','word','excel','office','ocomm','dbsnmp','onenote','firefox','xfssvccon','infopath','wordpa','isqlplussvc','sql','dbeng50','mspub','mydesktopqos','ocautoupds','thunderbird','encsvc','oracle','mydesktopservice','thebat','agntsvc','steam','ocssd','tbirdconfig','synctime','visio','sqbcoreservice','winword','msaccess','powerpnt','mepocs','memtas','svc$','vss','sophos','crm','quickbooks','pos','qb','sage','SQL','prc','w3wp','java','store','ax32','dbs','wordpad','VeeamAgent','Backup','Cloud','Mbae','MB3','WRSA','rsa','wrsa'</pre>
<p><span data-contrast="auto">These strings indicate the attackers are not only trying to shut down security tools, but also database services, backup programs, office applications, email clients, QuickBooks, and even Steam, the gaming platform. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto"><strong>2.ps1</strong> deletes all the Volume Shadow Copies on the system by running a single command (vssadmin.exe delete shadows /all /quiet), while <strong>3.ps1</strong> disables automatic repairs that Windows might try to run upon a reboot.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto"><strong>4.ps1</strong> then attempts to delete the Volume Shadow Copies using a different method:</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p style="padding-left: 40px;"><span data-contrast="auto">wmic shadowcopy delete /nointeractive</span><br />
<span data-contrast="auto">Get-WmiObject Win32_ShadowCopy | % { $_.Delete() }</span><br />
<span data-contrast="auto">Get-WmiObject Win32_ShadowCopy | Remove-WmiObject</span><br />
<span data-contrast="auto">Get-WmiObject Win32_Shadowcopy | ForEach-Object { $_Delete(); }</span><br />
<span data-contrast="auto">Get-CimInstance Win32_ShadowCopy | Remove-CimInstance</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto"><strong>5.ps1</strong> executes two commands that, between them, delete Windows Event Logs, which would hinder an investigation.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">Similarly to 1.ps1, <strong>6.ps1</strong> attempts to kill not processes but services, based on a list of strings that may appear in the services’ names: </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p style="padding-left: 40px;"><span data-contrast="auto">&#8216;sql&#8217;,&#8217;Sql&#8217;,&#8217;SQL&#8217;,&#8217;BASup&#8217;,&#8217;Titan&#8217;,&#8217;Cylance&#8217;,&#8217;cylance&#8217;,&#8217;Defend&#8217;,&#8217;NisSvc&#8217;,&#8217;Veeam&#8217;,&#8217;veeam&#8217;,&#8217;backup&#8217;,&#8217;Backup&#8217;,&#8217;rsa&#8217;,&#8217;wrsa&#8217;,&#8217;WRSA&#8217;,&#8217;RSA&#8217;</span></p>
<p><span data-contrast="auto">It also disables Windows defender by setting the following Windows Registry key: </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p style="padding-left: 40px;"><span data-contrast="auto">reg add &#8220;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender&#8221; /f /v DisableAntiSpyware /t REG_DWORD /d<br />
</span></p>
<p><strong>9.ps1</strong>, which is executed ﬁrst, attempts to invoke the Uninstaller for security software from Sophos, Trend Micro, Cylance, MalwareBytes, Sentinel One, Vipre, Webroot, and several cloud backup agents</p>
<p><span data-contrast="auto"><strong>10.ps1</strong> then, redundantly, runs the dropped <strong>p.exe</strong> executable, which suspends the processes that contain the following strings, and clears their logs:</span></p>
<pre style="padding-left: 40px;">'MpCmd','MsMp','Senti','senti','sql','backup','veeam','outlook','word','excel','office','ocomm','dbsnmp','onenote','firefox','xfssvccon','infopath','wordpa','isqlplussvc','sql','dbeng50','mspub','mydesktopqos','ocautoupds','thunderbird','encsvc','oracle','mydesktopservice','thebat','agntsvc','steam','ocssd','tbirdconfig','synctime','visio','sqbcoreservice','winword','msaccess','powerpnt','mepocs','memtas','svc$','vss','sophos','crm','quickbooks','pos','qb','sage','SQL','prc','w3wp','java','store','ax32','dbs','wordpad','VeeamAgent','Backup','Cloud','Mbae','MB3'</pre>
<p><span data-contrast="auto">And <strong>11.ps1</strong> adds yet another layer of redundancy, executing the following commands that delete Volume Shadow Copies (again, for the third time!) as well as changing recovery options and clearing event logs in yet another way.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p style="padding-left: 40px;"><span data-contrast="auto">&#8216;vssadmin.exe Delete Shadows /All /Quiet&#8217;,</span><br />
<span data-contrast="auto">&#8216;bcdedit /set {default} recoveryenabled no&#8217;,</span><br />
<span data-contrast="auto">&#8216;wmic shadowcopy delete&#8217;,</span><br />
<span data-contrast="auto">&#8216;wbadmin delete backup&#8217;,</span><br />
<span data-contrast="auto">&#8216;wbadmin delete systemstatebackup -keepversions:0&#8217;,</span><br />
<span data-contrast="auto">&#8216;bcdedit /set {default} bootstatuspolicy ignoreallfailures&#8217;,</span><br />
<span data-contrast="auto">&#8216;bcdedit /set {default} recoveryenabled no&#8217;,</span><br />
<span data-contrast="auto">&#8216;wevtutil.exe clear-log Application&#8217;,</span><br />
<span data-contrast="auto">&#8216;wevtutil.exe clear-log Security&#8217;,</span><br />
<span data-contrast="auto">&#8216;wevtutil.exe clear-log System&#8217;,</span><br />
<span data-contrast="auto">&#8216;wbadmin delete systemstatebackup&#8217;,</span><br />
<span data-contrast="auto">&#8216;wbadmin delete catalog -quiet&#8217;,</span><br />
<span data-contrast="auto">&#8216;bootstatuspolicy ignoreallfailures&#8217;</span></p>
<p><span data-contrast="auto">This level of redundancy may be an indication that this threat actor is unsure of their own tools’ capabilities, but aren’t willing to take any chances.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><strong>12.ps1</strong> grants the “Everyone” group access permissions to every drive letter that might exist on the machine to  ensure as many ﬁles are encrypted as possible.</p>
<figure id="attachment_75707" aria-describedby="caption-attachment-75707" style="width: 812px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-75707" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-taskscheduler-logo.png" alt="" width="812" height="425" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-taskscheduler-logo.png 1511w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-taskscheduler-logo.png?resize=300,157 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-taskscheduler-logo.png?resize=768,403 768w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-taskscheduler-logo.png?resize=1024,537 1024w" sizes="(max-width: 812px) 100vw, 812px" /><figcaption id="caption-attachment-75707" class="wp-caption-text">Scheduled Tasks set up by the RED.ps1 script</figcaption></figure>
<p><span data-contrast="auto">The red.ps1 script also deletes itself, the .7z archive, and the local copy of 7zip from the system when it runs, removing key evidence.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">In addition to the ransomware executable itself, Labs recovered and analyzed another ancillary executable that the attackers deployed on the target machines. The file, just called p.exe, appears to be a custom-compiled version of an open source tool called </span><a href="https://github.com/QAX-A-Team/EventCleaner" target="_blank" rel="noopener"><span data-contrast="none">EventCleaner</span></a><span data-contrast="auto">, which was created to erase or manipulate the contents of Windows event logs. The attackers used the p.exe component to clean up evidence of what they had done.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p>We also mentioned that there were other PowerShell scripts delivered in the .7z archive the attackers dropped on targeted machines. While we saw no evidence they were executed in the context of this attack, the scripts numbered 7, 8, and 9 serve important purposes. <strong>7.ps1</strong> logs off practically all open sessions on the computer; <strong>8.ps1</strong> is a redundant copy of the same firewall rules script included in RED.ps1.</p>
<h3><span data-contrast="none">Bare-bones ransomware</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">The ransomware itself, called <strong>RED.exe</strong>, is a 64-bit Windows executable programmed in the </span><span data-contrast="auto">Go </span><span data-contrast="auto">language, compiled using a tool called MinGW, and packed with a modified version of the runtime packer UPX.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">The executable contains some code taken from <a href="https://github.com/karrick/godirwalk" target="_blank" rel="noopener">an open source project called godirwalk</a>, which gives it the ability to scan the hard drive on which it’s running for directory paths and compile them into a list. The ransomware then spawns a new child process that encrypts each subfolder separately, which after a short amount of time results in a lot of copies of the ransomware process running simultaneously.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75704" aria-describedby="caption-attachment-75704" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-75704 size-full" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png" alt="" width="640" height="640" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png 1004w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=300,300 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=768,768 768w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-rootcause-redexe-logo.png?resize=128,128 128w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75704" class="wp-caption-text">In this root cause analysis diagram, each instance of the red.exe ransomware encrypting a single folder appears as a unique process</figcaption></figure>
<p><span data-contrast="auto">The ransomware itself is quite small as it only really is used to perform the encryption of the files on the targeted system. It makes no network connections, and because functions like killing processes or deleting the Volume Shadow Copies have been outsourced to the PowerShell scripts, it’s really quite a simple program. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">In the sample we’ve seen, it doesn’t even contain a list of targeted file types or file extensions. In fact, it will encrypt everything inside the folders it decides to encrypt, including other executables and DLLs, which can render programs or the entire system nonfunctional, if the ransomware decides to encrypt the wrong folder path. After it encrypts each file, it appends a file suffix of “<strong>.epsilonred</strong>” to the files, and drops a ransom note in each folder. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">Strangely enough, the ransom note closely resembles the note used by REvil, a much more widely used ransomware. But where the REvil note is typically riddled with spelling and grammatical errors, the note delivered by Epsilon Red has gone through a few edits to make its text more readable to an audience of native English speakers.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75696" aria-describedby="caption-attachment-75696" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75696" src="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-ransomnote-logo.png" alt="" width="640" height="448" srcset="https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-ransomnote-logo.png 1035w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-ransomnote-logo.png?resize=300,210 300w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-ransomnote-logo.png?resize=768,537 768w, https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-ransomnote-logo.png?resize=1024,716 1024w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75696" class="wp-caption-text">The Epsilon Red ransom note</figcaption></figure>
<p><span data-contrast="auto">Victims are encouraged to visit a special URL on a website operated on the normal web (<strong>epsilons</strong>[<strong>.</strong>]<strong>red</strong>) to engage with the attackers.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h3><span data-contrast="auto">Detections</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">Sophos endpoint products, such as <em>Intercept X</em>, will behaviorally detect several of the actions taken by the PowerShell scripts or the ransomware payload. The act of attempting to encrypt files is blocked by the <em>CryptoGuard </em>feature. As the ingress point for this attack appears to have been an Exchange server vulnerable to the ProxyLogon exploit chain, customers are urged to patch internet-facing Exchange servers as quickly as possible. Sophos endpoint products can protect Exchange servers as well as Domain Controllers or workstations.</span></p>
<p>Indicators of compromise for this threat can be found <a href="https://github.com/sophoslabs/IoCs/blob/master/Ransomware-EpsilonRed.csv" target="_blank" rel="noopener">on the SophosLabs Github</a>.</p>
<h3>Acknowledgments</h3>
<p>SophosLabs acknowledges the work of <strong>Anand Ajjan, Richard Cohen, Fraser Howard, Elida Leite</strong>, <strong>Mark</strong> <strong>Loman, Andrew Ludgate, Peter Mackenzie, Nirav Parekh, </strong>and <strong>Gabor Szappanos</strong> in producing a comprehensive analysis of the threat, and improving our ability to detect and block malware like Epsilon Red in the future.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2021/05/27/top-10-security-misperceptions/" rel="prev">Top 10 security misperceptions</a>
						   			</div>
	   			<div class="nav-next">
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></h3>

					
					<div class="author-bio">
						<p>Andrew Brandt is a Principal Researcher for Sophos, specializing in security analytics and the forensic, retrospective analysis of malware infections and cyberattacks. In brief, he does whatever it takes to make life and business difficult for cybercriminals, spies, and other Internet miscreants. </p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/05/28/epsilonred/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/05/28/epsilonred/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='75686' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="6c391a5312" /></p><input type="hidden" id="ak_js" name="ak_js" value="220"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-75410" class="second-featured post-75410 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-encryption tag-mtr tag-ransomware tag-security tag-sidebar tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-2.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">24</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/" rel="bookmark">What to expect when you’ve been hit with Avaddon ransomware</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-75225" class="second-featured post-75225 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate tag-healthcare tag-ransomware tag-the-state-of-ransomware region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/Copy-of-Copy-of-Copy-of-Copy-of-Supply-Chain-Sophos-News-banners-2.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/17/the-state-of-ransomware-in-healthcare-2021/" rel="bookmark">The State of Ransomware in Healthcare 2021</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-75114" class="second-featured post-75114 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-cobalt-strike tag-darkside tag-mega tag-pcloud tag-ransomware tag-systembc region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/portrait-of-the-dark-side-man.jpg?w=615');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">11</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/11/a-defenders-view-inside-a-darkside-ransomware-attack/" rel="bookmark">A defender&#8217;s view inside a DarkSide ransomware attack</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-65814" class="second-featured post-65814 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-data-breach tag-exfiltration tag-i-o-completion-ports tag-iocp tag-lockbit-ransomware tag-uac-bypass tag-user-account-control region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/04/800px-5-digit_Wordlock_locked_with_combination_Basin_and_hardened_shackle-e1587590702609.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">24</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" rel="bookmark">LockBit ransomware borrows tricks to keep up with REvil and Maze</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IQEic7mB8FIOsbswVCAWnby9mWeLBw0h66d/va5OKOTDjXQKXRBoAgQT5MHhyMBNTe3kUI5UqkH9YYE/FFZcl4EvAR9qJTTuMjxU0vFLUtJ1fIp6TneotozFo27tqMeiYHMRqr9fVyjdbJevMlDug5a2IZQGLEKY3R+v+QaUFvEH3O18vY2Zhyr11JPTDEkIS1+KKu49Y2AueZaNkezg1qh0/bYDKHw=='></script>
<script src='https://stats.wp.com/e-202121.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'166161023',post:'75686',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '75686' ]);
</script>
</body>
</html>
