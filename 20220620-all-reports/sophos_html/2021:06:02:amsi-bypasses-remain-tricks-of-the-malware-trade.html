<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>AMSI bypasses remain tricks of the malware trade &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; AMSI bypasses remain tricks of the malware trade Comments Feed" href="https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.7/css/jetpack.css?m=1621958629' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZkYGFmYmBsUUWAK9bIh4='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/75513" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/" />
<link rel='shortlink' href='https://news.sophos.com/?p=75513' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F06%2F02%2Famsi-bypasses-remain-tricks-of-the-malware-trade%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F06%2F02%2Famsi-bypasses-remain-tricks-of-the-malware-trade%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
		<link rel="amphtml" href="https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="AMSI bypasses remain tricks of the malware trade" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/" />
<meta property="og:description" content="Malware developers continue to try to sabotage or evade Microsoft&#8217;s Anti-Malware Software Interface in &#8220;fileless&#8221; and living-off-land attacks." />
<meta property="article:published_time" content="2021-06-02T12:30:35+00:00" />
<meta property="article:modified_time" content="2021-05-27T13:33:39+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="428" />
<meta property="og:image:alt" content="Altered detour sign" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="AMSI bypasses remain tricks of the malware trade" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?w=640" />
<meta name="twitter:image:alt" content="Altered detour sign" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-75513 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-75513" class="post-75513 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-agent-tesla tag-amsi-bypass tag-amsi-protection tag-meterpreter tag-wannamine region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">AMSI bypasses remain tricks of the malware trade</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/agent-tesla/">Agent Tesla</a>&bull;<a href="https://news.sophos.com/en-us/tag/amsi-bypass/">AMSI bypass</a>&bull;<a href="https://news.sophos.com/en-us/tag/amsi-protection/">AMSI Protection</a>&bull;<a href="https://news.sophos.com/en-us/tag/meterpreter/">Meterpreter</a>&bull;<a href="https://news.sophos.com/en-us/tag/wannamine/">WannaMine</a>		</div>

					<div class="entry-excerpt">
				<p>Malware developers continue to try to sabotage or evade Microsoft&#8217;s Anti-Malware Software Interface in &#8220;fileless&#8221; and living-off-land attacks.</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/" rel="bookmark">2 June 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=AMSI%20bypasses%20remain%20tricks%20of%20the%20malware%20trade%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D75513" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=75513&#038;title=AMSI%20bypasses%20remain%20tricks%20of%20the%20malware%20trade" data-title="AMSI bypasses remain tricks of the malware trade" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/"
				data-title="AMSI bypasses remain tricks of the malware trade"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="428" src="https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Altered detour sign" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg 1920w, https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?resize=300,200 300w, https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?resize=768,513 768w, https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?resize=1024,684 1024w, https://news.sophos.com/wp-content/uploads/2021/06/amsi-bypass.jpg?resize=1536,1026 1536w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>&nbsp;</p>
<p>Malware developers are eternally looking for a way to evade detection by their targets&#8217; defenses. One way is to beat the scanners—using obfuscation, encryption, steganography and other techniques to make it harder for antivirus software to figure out what the intent of the payload is. Another is to completely avoid having your malware scanned in the first place.</p>
<p>As Windows 10 and the latest generation of Windows Server platforms have risen to prominence, malware developers and other malicious actors have increasingly aimed to evade detection by taking out those platforms&#8217; anti-malware traffic cop: Microsoft&#8217;s Antimalware Scan Interface. AMSI, introduced in 2015, provides a way for software to talk to security products, requesting scans of files, memory, or streams for malicious payloads in a vendor-agnostic way.</p>
<p>AMSI gives antimalware software visibility into Microsoft components and applications, including into Windows&#8217; PowerShell engine and script hosts (wscript.exe and cscript.exe), Office document macros, the current .NET Framework (version 4.8), and Windows Management Instrumentation (WMI)—components frequently used in &#8220;living off the land&#8221; (LOL) tactics by adversaries and in the execution of &#8220;fileless&#8221; malware. Windows third-party developers can leverage AMSI with their own applications as well, to allow anti-malware software to check for content passed to them that could turn their applications into &#8220;LOLbins&#8221; (living off the land binaries)—applications abused for malicious purposes by malware or network intruders.</p>
<p>For those reasons, AMSI is a very attractive target for malware developers. Almost since the day AMSI was introduced, attackers (and security researchers) have created tools to attempt to bypass or disable AMSI. Microsoft and security software providers have taken steps to block some of the approaches used for AMSI bypass and evasion, but attackers continue to adjust—using automated tools in some cases to obfuscate their attack code and probing defenses until they find one that sticks, and finding other ways to avoid AMSI altogether.</p>
<p>In this report, we will examine the most commonly encountered AMSI bypass methods in use, and examine how they are used by malware we&#8217;ve observed to attempt to evade defenses on Windows systems.</p>
<h3>Fly the fail flag</h3>
<p>In May of 2016, PowerShell hacker <a href="https://twitter.com/mattifestation">Matt Graeber</a> published a one-line AMSI evasion in a tweet:</p>
<figure id="attachment_75514" aria-describedby="caption-attachment-75514" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2021/05/mattifestation.png"><img loading="lazy" class="size-full wp-image-75514" src="https://news.sophos.com/wp-content/uploads/2021/05/mattifestation.png" alt="Screenshot of tweet by @mattifestation" width="640" height="332" srcset="https://news.sophos.com/wp-content/uploads/2021/05/mattifestation.png 974w, https://news.sophos.com/wp-content/uploads/2021/05/mattifestation.png?resize=300,156 300w, https://news.sophos.com/wp-content/uploads/2021/05/mattifestation.png?resize=768,399 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-75514" class="wp-caption-text">Matt Graeber&#8217;s one-line AMSI bypass.</figcaption></figure>
<p>&nbsp;</p>
<p>Graeber&#8217;s single line of PowerShell code flips the flag on an attribute for PowerShell&#8217;s AMSI integration—amsiInitFailed— to &#8220;true&#8221;, which then causes the current PowerShell process to stop requesting scans. With that achieved, a malicious PowerShell script can (in theory) execute whatever badness it is intended to without triggering a scan by antimalware software.</p>
<p>This bypass is now widely detected and blocked as malicious content (as any 5-year-old public exploit should be). However, malware actors still use versions of it that have been obfuscated in an attempt to evade signature-based scans. And the amsiInitFailed bypass still accounts for about 1 percent of detections, based on a 90-day chunk of telemetry data from February to May of 2021.</p>
<p>Most of these detections appear to be post-exploitation manual attempts at lateral movement or penetration testing, as the IP addresses associated with delivering the packages related to those detections were from a local network. For example, this recently-spotted version of the bypass method attempts to retrieve a PowerShell backdoor from a secure web server inside the network&#8217;s private IP address space:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/05/AMSI-BYPASS_A_PENTEST.png"><img loading="lazy" class="alignnone size-full wp-image-75568" src="https://news.sophos.com/wp-content/uploads/2021/05/AMSI-BYPASS_A_PENTEST.png" alt="code screenshot" width="640" height="189" srcset="https://news.sophos.com/wp-content/uploads/2021/05/AMSI-BYPASS_A_PENTEST.png 806w, https://news.sophos.com/wp-content/uploads/2021/05/AMSI-BYPASS_A_PENTEST.png?resize=300,89 300w, https://news.sophos.com/wp-content/uploads/2021/05/AMSI-BYPASS_A_PENTEST.png?resize=768,227 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>However, we did detect a recent use of the same bypass that connected to a remote server to obtain a PowerShell-based malware downloader. This one appears to have been part of a Proxy Logon-based attack that attempted to load a Meterpreter backdoor DLL from a server in Russia:<br />
<a href="https://news.sophos.com/wp-content/uploads/2021/05/amsi-bypass-A-chart.jpg"><img loading="lazy" class="alignnone size-full wp-image-75564" src="https://news.sophos.com/wp-content/uploads/2021/05/amsi-bypass-A-chart.jpg" alt="" width="640" height="854" srcset="https://news.sophos.com/wp-content/uploads/2021/05/amsi-bypass-A-chart.jpg 1280w, https://news.sophos.com/wp-content/uploads/2021/05/amsi-bypass-A-chart.jpg?resize=225,300 225w, https://news.sophos.com/wp-content/uploads/2021/05/amsi-bypass-A-chart.jpg?resize=768,1024 768w, https://news.sophos.com/wp-content/uploads/2021/05/amsi-bypass-A-chart.jpg?resize=1152,1536 1152w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Using the web worker process to execute shell commands, the malicious actor sent this command to PowerShell.exe:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-24-at-4.34.16-PM.png"><img loading="lazy" class="alignnone size-full wp-image-75563" src="https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-24-at-4.34.16-PM.png" alt="" width="640" height="104" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-24-at-4.34.16-PM.png 1650w, https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-24-at-4.34.16-PM.png?resize=300,49 300w, https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-24-at-4.34.16-PM.png?resize=768,125 768w, https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-24-at-4.34.16-PM.png?resize=1024,166 1024w, https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-24-at-4.34.16-PM.png?resize=1536,249 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a> The second URL in that string references a PowerShell script that is normally identified by Windows Defender as &#8220;Ploty-C&#8221; and blocked from execution. However, the first script block executed is an obfuscated version of the AMSI bypass, base64-encoded and GZip-compressed in an attempt to evade detection.</p>
<p>Another way to achieve the same exploit uses <a href="https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-3/">reflection</a> to invoke the same commands through the .NET framework from PowerShell. In one recently-detected intrusion using this variant, the actor (possibly a penetration tester, but likely someone attempting lateral movement within an already-penetrated network) was using an offensive security and exploitation tool called <a href="https://github.com/GhostPack/Seatbelt">Seatbelt</a>. In this case, the PowerShell script creates a delegate process that uses reflection to access the .NET interfaces for AmsiUtils, using string obfuscation to attempt to evade being detected:</p>
<figure id="attachment_75566" aria-describedby="caption-attachment-75566" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2021/05/reflectiveAmsiBypass-H.png"><img loading="lazy" class="size-full wp-image-75566" src="https://news.sophos.com/wp-content/uploads/2021/05/reflectiveAmsiBypass-H.png" alt="screenshot of code" width="640" height="161" srcset="https://news.sophos.com/wp-content/uploads/2021/05/reflectiveAmsiBypass-H.png 842w, https://news.sophos.com/wp-content/uploads/2021/05/reflectiveAmsiBypass-H.png?resize=300,76 300w, https://news.sophos.com/wp-content/uploads/2021/05/reflectiveAmsiBypass-H.png?resize=768,193 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-75566" class="wp-caption-text">A reflective version of the AmsiUtils bypass.</figcaption></figure>
<h3>Altered memory</h3>
<p>While manipulation of the properties of the AmsiUtils interface is still a common method of attempting AMSI bypass, over 98 percent of the bypass attempts we see in recent telemetry focus on a different approach: tampering with the code of the AMSI library itsef. already loaded into memory to make scan requests fail. In this attack, the malware locates the library AmsiScanBuffer in memory, and then overwrites the instructions at that address with new ones that redirect to an error message. An implementation of this attack in PowerShell, unobfuscated, would look like this:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-25-at-11.07.29-AM.png"><img loading="lazy" class="alignnone size-full wp-image-75583" src="https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-25-at-11.07.29-AM.png" alt="AMSI/Bypass-B" width="640" height="169" srcset="https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-25-at-11.07.29-AM.png 1144w, https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-25-at-11.07.29-AM.png?resize=300,79 300w, https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-25-at-11.07.29-AM.png?resize=768,203 768w, https://news.sophos.com/wp-content/uploads/2021/05/Screen-Shot-2021-05-25-at-11.07.29-AM.png?resize=1024,270 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a>Alternative versions of this attack modify the memory storing the code for returning the result of a buffer scan, causing a scan failure.</p>
<p>The memory patch technique has been integrated into the commercial offensive security platform Cobalt Strike as an option <a href="https://www.cobaltstrike.com/help-malleable-postex">called amsi_disable.</a> It has also been seen in a number of malware families, including in a <a href="https://news.sophos.com/en-us/2021/02/02/agent-tesla-amps-up-information-stealing-attacks/">downloader for the Agent Tesla remote access tool (RAT) malware</a> we recently analyzed, in <a href="https://support.sophos.com/support/s/article/KB-000037977?language=en_US">WannaMine crypto-jacking malware</a> installations, and in <a href="https://news.sophos.com/en-us/2021/05/05/intervention-halts-a-proxylogon-enabled-attack/">recent ProxyLogon-based intrusions</a> dropping PowerShell-based RATs.</p>
<p>In March, we detected repeated attempts to install a WannaMine payload on a customer&#8217;s systems. One unprotected Windows system had become infected, and while Sophos blocked execution on protected systems, we continued to see attempts by the cryptojacking worm to spread to those systems; those attempts peaked at over 300 a day for each system that provided AMSI telemetry.</p>
<p>On systems running versions of Windows with with AMSI support, WannaMine executes a command line that invokes a remote script based on whether the system is running 32-bit or 64-bit Windows:<a href="https://news.sophos.com/wp-content/uploads/2021/05/WannaMiner_stage1_command.png"><img loading="lazy" class="size-full wp-image-75585" src="https://news.sophos.com/wp-content/uploads/2021/05/WannaMiner_stage1_command.png" alt="WannaMiner injection code" width="640" height="65" srcset="https://news.sophos.com/wp-content/uploads/2021/05/WannaMiner_stage1_command.png 827w, https://news.sophos.com/wp-content/uploads/2021/05/WannaMiner_stage1_command.png?resize=300,30 300w, https://news.sophos.com/wp-content/uploads/2021/05/WannaMiner_stage1_command.png?resize=768,78 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><span style="font-size: 1em">The remote script object is heavily obfuscated:</span></p>
<figure id="attachment_75601" aria-describedby="caption-attachment-75601" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2021/05/wannamine1.png"><img loading="lazy" class="size-full wp-image-75601" src="https://news.sophos.com/wp-content/uploads/2021/05/wannamine1.png" alt="" width="640" height="361" srcset="https://news.sophos.com/wp-content/uploads/2021/05/wannamine1.png 834w, https://news.sophos.com/wp-content/uploads/2021/05/wannamine1.png?resize=300,169 300w, https://news.sophos.com/wp-content/uploads/2021/05/wannamine1.png?resize=768,434 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-75601" class="wp-caption-text">A 16-megabyte obfuscated script invoked in PowerShell to execute WannaMiner&#8217;s second-stage install on 64-bit systems.</figcaption></figure>
<p>After unpacking the obfuscated commands, the remote script attempts to patch amsi.dll with the appropriate code for the version of Windows detected.</p>
<figure id="attachment_75605" aria-describedby="caption-attachment-75605" style="width: 1097px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2021/05/wannamine-amsi.png"><img loading="lazy" class="wp-image-75605 size-full" src="https://news.sophos.com/wp-content/uploads/2021/05/wannamine-amsi-e1621992938885.png" alt="" width="1097" height="441" srcset="https://news.sophos.com/wp-content/uploads/2021/05/wannamine-amsi-e1621992938885.png 1097w, https://news.sophos.com/wp-content/uploads/2021/05/wannamine-amsi-e1621992938885.png?resize=300,121 300w, https://news.sophos.com/wp-content/uploads/2021/05/wannamine-amsi-e1621992938885.png?resize=768,309 768w, https://news.sophos.com/wp-content/uploads/2021/05/wannamine-amsi-e1621992938885.png?resize=1024,412 1024w" sizes="(max-width: 1097px) 100vw, 1097px" /></a><figcaption id="caption-attachment-75605" class="wp-caption-text">The deobfuscated AMSI evasion script in the 32-bit version of WannaMine&#8217;s remote code block.</figcaption></figure>
<p>Sophos blocks the execution of this AMSI evasion, as well as the other attempts made by WannaMine&#8217;s scripts to spread to other systems and install its cryptominer. But the infection of a single unprotected system on the network can lead to continued attacks across the network.</p>
<h3>Fake it (the DLL) until you make it</h3>
<p>Another well-worn method of bypassing AMSI is based on a <a href="https://cn33liz.blogspot.com/2016/05/bypassing-amsi-using-powershell-5-dll.html">method revealed by Cornelis de Plaa</a> in 2016 that fools PowerShell into loading a counterfeit version of amsi.dll. It&#8217;s fairly straightforward in its original implementation:</p>
<ul>
<li>Create an empty DLL named &#8220;amsi.dll&#8221; in a target directory;</li>
<li>Copy PowerShell.exe to the same directory;</li>
<li>Launch evil PowerShell script, and AMSI scans attempted by the PowerShell.exe copy will fail because the fake DLL is loaded first.</li>
</ul>
<p>However, Microsoft has since made changes to PowerShell&#8217;s code that cause it to crash if the proper interfaces aren&#8217;t available in amsi.dll. In order for a DLL hijack of this type to work, the attacker now has to <a href="https://sensepost.com/blog/2020/resurrecting-an-old-amsi-bypass/">provide a counterfeit DLL with the required interfaces defined</a>.</p>
<h3>Detouring around AMSI</h3>
<p>Other techniques of evading AMSI generally involve either downgrading scripting engines to versions from before AMSI was available or otherwise staying away from processes that interact with AMSI altogether.  On systems that still have PowerShell version 2 installed, an attacker may switch versions of PowerShell used by scripts  (by executing PowerShell from the command line with the parameter<strong> -Version 2.</strong></p>
<pre class="prettyprint prettyprinted"><span class="pln">powershell</span><span class="pun">.</span><span class="pln">exe </span><span class="pun">-</span><span class="typ">Version</span> <span class="lit">2</span></pre>
<p>Another way to evade AMSI is to bring along a scripting engine that doesn&#8217;t support it. While AMSI will detect anything leveraging the .NET framework, some malicious actors have brought along their own scripting host (such as a NodeJS engine), or have used compiled executables built from other scripting languages (such as Python).</p>
<p>In extreme cases, we&#8217;ve seen attackers bring along entire virtual machines to conceal their scripts from detection.  <a href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/">Ragnar Locker,</a> for example, deployed a VirtualBox virtual machine as part of a ransomware attack, concealing its processes from malware scanners entirely.</p>
<h3>Defense in depth</h3>
<p>AMSI is intended to provide a defense against LOL tactics that leverage Microsoft components, and to provide application developers a way to harden their own tools against exploitation by malicious scripts and code. Given how prevalent those tactics have become, particularly in ransomware operator intrusions, AMSI can play a particularly important role in keeping Windows 10 and Windows Server systems from being compromised. But AMSI is not a panacea. And while Microsoft&#8217;s Windows Defender provides some protection against AMSI bypasses, attackers are continuously finding ways to obfuscate and conceal malicious content from anti-malware signature detections.</p>
<p>Sophos and other anti-malware providers offer guards against AMSI bypasses that go beyond signature-based detection. But malicious actors are not standing still in their efforts to step around AMSI defenses. And too frequently, inconsistent deployment of defenses and security patches leave some systems vulnerable to even less advanced attacks&#8211;giving malware an opportunity to gain a foothold to step partially or completely around AMSI-based defenses. A defense in depth, leveraging a blend of detections at the endpoint and on the network, is critical in blunting many of these intrusions before they can do damage.</p>
<p>&nbsp;</p>
<h4>SophosLabs would like to acknowledge the contributions of Rajesh Nataraj and Michael Wood to this report</h4>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2021/06/01/sophos-techvids-discover-our-extensive-library-of-support-videos/" rel="prev">Sophos TechVids: Discover our extensive library of support videos</a>
						   			</div>
	   			<div class="nav-next">
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="145" src="https://news.sophos.com/wp-content/uploads/2020/02/sean-gallagher.jpg?w=145" class="avatar avatar-145 photo wp-post-image" alt="Sean Gallagher" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a></h3>

					
					<div class="author-bio">
						<p>Sean Gallagher is a Senior Threat Researcher at Sophos. </p>
<p>Previously, Gallagher was IT and National Security Editor at Ars Technica, where he focused on information security and digital privacy issues, cybercrime, cyber espionage and cyber warfare. He has been a security researcher, technology journalist and information technology practitioner for over 20 years.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/06/02/amsi-bypasses-remain-tricks-of-the-malware-trade/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='75513' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="004b5af809" /></p><input type="hidden" id="ak_js" name="ak_js" value="188"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-75410" class="second-featured post-75410 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-encryption tag-mtr tag-ransomware tag-security tag-sidebar tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-2.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">24</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/" rel="bookmark">What to expect when you’ve been hit with Avaddon ransomware</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-75301" class="second-featured post-75301 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate tag-intercept-x tag-sidebar tag-sophos-edr tag-sophos-xdr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-edr-news-blog-image-838x440px@2x.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/19/whats-new-in-sophos-edr-4-0/" rel="bookmark">What&#8217;s New in Sophos EDR 4.0</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-75396" class="second-featured post-75396 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-sophos-xdr tag-xdr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-xdr.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/19/sophos-xdr-driven-by-data/" rel="bookmark">Sophos XDR: Driven by data</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-75064" class="second-featured post-75064 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-ransomware tag-sidebar tag-sophos-edr tag-sophos-managed-threat-response-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/AA-Playbook-1200x628px-v2.jpeg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">18</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/18/the-active-adversary-playbook-2021/" rel="bookmark">The Active Adversary Playbook 2021</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IQEic7mB8FIOsbswVCAWnby9mWeLBw0h66d/va5OKOTDjXQKXRBoAgQT5MHhyMBNTe3kUI5UqkH9YYE/FFZcl4EvAR9qJTTuMjxU0vFLUtJ1fIp6TneotozFo27tqMeiYHMRqr9fVyjdbJevMlDug5a2IZQGLEKY3R+v+QaUFvEH3O18vY2Zhyr11JPTDEkIS1+KKu49Y2AueZaNkezg1qh0/bYDKHw=='></script>
<script src='https://stats.wp.com/e-202122.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'166161023',post:'75513',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '75513' ]);
</script>
</body>
</html>
