<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>Relentless REvil, revealed: RaaS as variable as the criminals who use it &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Relentless REvil, revealed: RaaS as variable as the criminals who use it Comments Feed" href="https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.8/css/jetpack.css?m=1623241328' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZkYGFmYmBiVEWAK9SIhk='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/75918" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/" />
<link rel='shortlink' href='https://news.sophos.com/?p=75918' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F06%2F11%2Frelentless-revil-revealed%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2021%2F06%2F11%2Frelentless-revil-revealed%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
		<link rel="amphtml" href="https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Relentless REvil, revealed: RaaS as variable as the criminals who use it" />
<meta property="og:url" content="https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/" />
<meta property="og:description" content="No two criminal groups deploy the ransomware-as-a-service, also known as Sodinokibi, in exactly the same way" />
<meta property="article:published_time" content="2021-06-11T13:00:54+00:00" />
<meta property="article:modified_time" content="2021-06-11T16:06:52+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="335" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Relentless REvil, revealed: RaaS as variable as the criminals who use it" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-75918 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-75918" class="post-75918 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-raas tag-ransomware tag-ransomware-as-a-service tag-revil tag-sodinokibi region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">Relentless REvil, revealed: RaaS as variable as the criminals who use it</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/raas/">Raas</a>&bull;<a href="https://news.sophos.com/en-us/tag/ransomware/">Ransomware</a>&bull;<a href="https://news.sophos.com/en-us/tag/ransomware-as-a-service/">ransomware as a service</a>&bull;<a href="https://news.sophos.com/en-us/tag/revil/">REvil</a>&bull;<a href="https://news.sophos.com/en-us/tag/sodinokibi/">Sodinokibi</a>		</div>

					<div class="entry-excerpt">
				<p>No two criminal groups deploy the ransomware-as-a-service, also known as Sodinokibi, in exactly the same way</p>
			</div>
		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/" rel="bookmark">11 June 2021</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=Relentless%20REvil%2C%20revealed%3A%20RaaS%20as%20variable%20as%20the%20criminals%20who%20use%20it%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D75918" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=75918&#038;title=Relentless%20REvil,%20revealed:%20RaaS%20as%20variable%20as%20the%20criminals%20who%20use%20it" data-title="Relentless REvil, revealed: RaaS as variable as the criminals who use it" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/"
				data-title="Relentless REvil, revealed: RaaS as variable as the criminals who use it"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="335" src="https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png 1200w, https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png?resize=300,157 300w, https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png?resize=768,402 768w, https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-3-copy.png?resize=1024,536 1024w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p><span data-contrast="auto">The transition to a <em>service model</em> of doing business transformed ransomware, giving its developers the ability to focus on features, and leaving the harder part – the break-in and deployment to the target&#8217;s computers – to its customers, threat actors who employ a wide range of attack styles, software, and expertise to the task. </span></p>
<p><span data-contrast="auto">One of the ransomware-as-a-service (RaaS) we encounter most frequently, known alternately as Sodinokibi or REvil, is as conventional a ransomware as we&#8217;ve seen: Its routines, configuration, and behavior what we&#8217;ve come to expect from a mature family that&#8217;s, obviously, well used in the criminal underground.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-text-file.png"><img loading="lazy" class="alignnone size-full wp-image-75923" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-text-file-cropped-upper-half.png" alt="The REvil ransom note" width="640" height="216" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-text-file-cropped-upper-half.png 1028w, https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-text-file-cropped-upper-half.png?resize=300,101 300w, https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-text-file-cropped-upper-half.png?resize=768,259 768w, https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-text-file-cropped-upper-half.png?resize=1024,346 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a><span data-contrast="auto">Unsurprisingly, Sophos has devoted significant effort to combat this everyday menace. In addition to tamper protection features that prevent a script from disabling endpoint protection features, we use behavioral detection rules that identify the core activities ransomware must engage in, and a feature called CryptoGuard that prevents the ransomware from encrypting data.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">As attacks involving RaaS malware, including REvil, increasingly have generated public attention and news coverage, SophosLabs wanted to pull together a common body of our knowledge about the ransomware itself, and the variety we observe in attack methods employed by the criminals who lease the software and handle the break-ins. </span></p>
<p><span data-contrast="auto">In addition, we reviewed reports produced by Sophos Rapid Response about attacks involving Sodinokibi/REvil where the MTR team were hired to provide incident response and cleanup. From these detailed analyses, we were able to develop a picture of a common malware being deployed in myriad ways by a large base of criminal customers.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h2 aria-level="2"><span data-contrast="none">Signs of an impending attack</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h2>
<p><span data-contrast="auto">The deployment of ransomware usually happens at the very end of a much larger, and more elaborate, set of precursor actions that a criminal attacker will take during what might be a significantly long time before anyone in a targeted organization logs on to find a ransom note on their desktop. So while we will discuss the internals and typical characteristics of Sodinokibi/REvil, it makes more sense to describe these precursor actions first. If a defender or network owner can discover and quickly act on these behaviors while the attacker is still laying the groundwork for the final ransomware payload, it&#8217;s possible to cut off the attackers&#8217; access before any harm comes to the target&#8217;s computers.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">Attackers themselves appear to use a combination of scripting (sometimes hosted on file repositories like Github or Pastebin) and manual control (sometimes via the console, other times through Windows Remote Desktop or commercial remote access tools).</span></p>
<figure id="attachment_75925" aria-describedby="caption-attachment-75925" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75925" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-use-of-github-hosted-scripts.png" alt="A list of scripts on Github" width="640" height="537" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-use-of-github-hosted-scripts.png 958w, https://news.sophos.com/wp-content/uploads/2021/06/revil-use-of-github-hosted-scripts.png?resize=300,252 300w, https://news.sophos.com/wp-content/uploads/2021/06/revil-use-of-github-hosted-scripts.png?resize=768,645 768w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75925" class="wp-caption-text">One REvil attacker used scripts taken directly from a repository of penetration tester tools on Github</figcaption></figure>
<p><span data-contrast="auto">We&#8217;ve broken a typical attack into the following phases: Penetration and initial access; Credential harvesting and privilege escalation; Tilling the field; and deployment of the ransomware. Often (but not always, because it is attacker-dependent), there&#8217;s a phase where the attackers use their newfound credentials to hunt for and exfiltrate sensitive organizational data in the hours-to-weeks before delivering the payload. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h3 aria-level="3"><span data-contrast="none">Penetrating the network</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">Breaking in is, perhaps unsurprisingly, not all that hard to do if it&#8217;s what you do, all day long. But it&#8217;s possible to boil down the initial access methods employed by a variety of criminals who attacked using Sodinokibi/REvil into a few types: Brute-force attacks against known internet-facing services like VPNs, RDP, desktop remote management tools like VNC, and even some cloud-based management systems; The abuse of previously-obtained credentials or access (either retrieved from other malware or phishing) of legitimate accounts that didn&#8217;t require the use of multi-factor authentication; or, in some cases, piggybacking as a payload from other malware present on the target&#8217;s network.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">Brute-force attacks are, unfortunately, a large part of the traffic that almost any internet-facing service sees on an hour-to-hour basis. The attacks cost so little to the attackers it pays just to throw the kitchen sink at a login screen, which is why multi-factor authentication is so incredibly important (though not necessarily a panacea). Attackers are just as able to use tools like Shodan or Censys, which reveal open ports leading to common services, as defenders. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">In one of the recent attacks, the organization logged a massive volume of failed inbound RDP login attempts targeting the server which eventually because a point of access for the attackers. On a typical server, the log that stores failed attempts to login to services like RDP rolls over, overwriting the oldest data, over a period of from several days to weeks depending on how many failed attempts were made. In this attack, the volume of failed RDP login events caused the log files to completely overwrite themselves with new entries every five minutes. The data collected from that server showed approximately 35,000 failed login attempts over a five minute period, originating from 349 unique IP addresses around the world. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75926" aria-describedby="caption-attachment-75926" style="width: 472px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75926" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-35k-logins-usernames-used.png" alt="" width="472" height="324" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-35k-logins-usernames-used.png 472w, https://news.sophos.com/wp-content/uploads/2021/06/revil-35k-logins-usernames-used.png?resize=300,206 300w" sizes="(max-width: 472px) 100vw, 472px" /><figcaption id="caption-attachment-75926" class="wp-caption-text">Among the 35,000 brute-force login attempts made every five minutes, these were the most common usernames the attackers tried to use</figcaption></figure>
<p><span data-contrast="auto">RDP was implicated as one of the most common methods of breaching a network in cases we were called in to investigate, which is why shutting off the outside world&#8217;s access to RDP is one of the most effective defenses an IT admin can take. But RDP was not the only culprit: attackers also gained initial access through other internet-facing services they were able to brute-force or to launch an exploit against a known vulnerability that gave them some access. In one case, the attacker targeted a bug in a specific VPN server software to gain initial access, then exploited a bug on a five-year-old version of Apache Tomcat on the same server that let the attacker create a new admin account on the server.  </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">In at least two different cases involving different target organizations, the initial point of access was something left in place by some <em>other</em> threat actor, who we later discovered had previously struck those organizations with ransomware weeks to months prior to our involvement, victimizing them twice. </span></p>
<p><span data-contrast="auto">In one of those cases, we discovered a remnant of Cobalt Strike, a commercial penetration testing toolset frequently abused by criminals to provide themselves with remote access to a computer. The Cobalt Strike artifact had been left in place by a (presumably, different) threat actor who deployed a ransomware called <strong>Le Chiffre</strong>. </span></p>
<p><span data-contrast="auto">In another, the attacker appeared to have brute-forced RDP on a machine that had been previously implicated as the initial foothold of an attack by a different type of ransomware just three weeks prior to the REvil attack. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75927" aria-describedby="caption-attachment-75927" style="width: 768px" class="wp-caption alignnone"><img loading="lazy" class=" wp-image-75927" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-mitre-attack-techniques.png" alt="" width="768" height="144" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-mitre-attack-techniques.png 1504w, https://news.sophos.com/wp-content/uploads/2021/06/revil-mitre-attack-techniques.png?resize=300,56 300w, https://news.sophos.com/wp-content/uploads/2021/06/revil-mitre-attack-techniques.png?resize=768,145 768w, https://news.sophos.com/wp-content/uploads/2021/06/revil-mitre-attack-techniques.png?resize=1024,193 1024w" sizes="(max-width: 768px) 100vw, 768px" /><figcaption id="caption-attachment-75927" class="wp-caption-text">The MITRE ATT&amp;CK techniques used in one of the REvil ransomware attacks we investigated</figcaption></figure>
<h3 aria-level="3"><span data-contrast="none">Credential harvesting and privilege escalation</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">Ransomware threat actors prefer to use internal tools like Domain Controllers to deploy the payload; If they haven&#8217;t bought a stolen or phished credential, they&#8217;ll often quietly monitor the network where the computer on which they gained an initial foothold is located. The attackers may use freely-available, not-inherently-malicious utilities to extract saved passwords from the hard drive, and/or more advanced tools such as Mimikatz to obtain the credentials of a domain administrator account. This takes a lot of patience on the part of the attacker, because there&#8217;s no guarantee they&#8217;ll pick up a credential in any given set of time. But once they have what they need, they act fast.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h3 aria-level="3"><span data-contrast="none">Tilling the field: Laying the groundwork </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}">for the attack</span></h3>
<p><span data-contrast="auto">Preparing an enterprise network for a ransomware attack takes a surprising amount of work. The attackers need to establish a list of internal targets, give themselves domain admin privileges, and use those privileges to shut down or otherwise hobble anything that might impede their attack: Windows Defender is usually the first to go, but often the attackers will spend some time trying to determine what endpoint protection tools are running on the computers, and may run one or more customized scripts that combine an attempt to kill any running protection process or services, and also to remove any persistence those processes or services might have.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75928" aria-describedby="caption-attachment-75928" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75928" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-stopping-and-uninstalling-sophos.png" alt="" width="640" height="365" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-stopping-and-uninstalling-sophos.png 738w, https://news.sophos.com/wp-content/uploads/2021/06/revil-stopping-and-uninstalling-sophos.png?resize=300,171 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75928" class="wp-caption-text">One REvil attacker built a customized script to terminate Sophos services and processes and even tries to uninstall the software. The attempt was prevented by tamper protection features in the product.</figcaption></figure>
<p><span data-contrast="auto">In a at least one case involving Sodinokibi, the attackers went so far as to determine that the target&#8217;s network was using a Sophos firewall and managing their endpoint protection through <a href="https://www.sophos.com/en-us/products/sophos-central.aspx" target="_blank" rel="noopener">Sophos Central</a>. The attacker diligently worked at obtaining the credentials of IT staff and methodically tried those credentials until they found one with permissions to access the Sophos Central control panel, where they used that access to shut down any features that would have blocked the ransomware from executing.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75929" aria-describedby="caption-attachment-75929" style="width: 490px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75929" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-delete-shadow-copy.png" alt="" width="490" height="551" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-delete-shadow-copy.png 490w, https://news.sophos.com/wp-content/uploads/2021/06/revil-delete-shadow-copy.png?resize=267,300 267w" sizes="(max-width: 490px) 100vw, 490px" /><figcaption id="caption-attachment-75929" class="wp-caption-text">Deleting the Volume Shadow Copy has become a time-honored ransomware tradition at this point.</figcaption></figure>
<p><span data-contrast="auto">Routinely, we encounter PowerShell scripts, batch files, or other &#8220;laying the groundwork&#8221; code attackers deploy to disable a variety of protective features. One example is the Volume Shadow Copy, which attackers typically delete as the Volume Shadow could assist in the recovery of deleted or encrypted data. </span></p>
<p><span data-contrast="auto">The number of different commands they can use to execute the same tasks is somewhat limited, but the sequence and thoroughness varies greatly from threat actor to threat actor. We also discovered that some threat actors simply number their scripts sequentially, or give them benign-looking names, others have used files with profane or hateful references in the filenames, sometimes in combination with the word Sophos.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<h3 aria-level="3"><span data-contrast="none">Large uploads of stolen data (exfil)</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">In only about half of the incidents involving Sodinokibi/REvil analyzed for this report did the attackers conduct an exfiltration of significant volumes of private, sensitive, or valuable data from the target organizations. In theory, these types of uploads should be detectable, but in practice, that never happened in the cases we investigated.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">Practically speaking, once they had obtained the permissions they needed, the attackers typically spent a few days looking through file servers, collecting large amounts of documents and bundling them into one or more compressed files on a machine inside the network. Once they had collected everything they wanted to steal in one place, they would begin an upload that, depending on the network speed and the amount of data, could take from hours to more than a day to complete.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">Threat actors have used a variety of cloud storage services to hold this stuff in the past, but appear to prefer a few over others. Mega.nz, the cloud storage provider run by <a href="https://en.wikipedia.org/wiki/Kim_Dotcom" target="_blank" rel="noopener">Kim Dotcom</a>, seems to be in favor among some criminals who engage in ransomware attacks we&#8217;ve investigated. Among the incidents where Sodinokibi was eventually deployed after a large exfiltration and an attempted extortion, roughly three-quarters used Mega.nz as a (temporary) repository for that stolen data. </span></p>
<p><span data-contrast="auto">Mega uses its own client application to speed uploads, which were found left behind by the attackers in cases where they didn&#8217;t clean up after themselves. A small number of attackers used other methods, such as installing a portable copy of the FTP client FileZilla that they used to upload data to a staging server outside the target&#8217;s network perimeter.</span></p>
<p>Conventional wisdom about how to respond to data leak extortion attempts has shifted away from advice to make the payment. The criminals claim they will delete their copies of the data if you pay the ransom demands, but that&#8217;s widely viewed as an unreliable promise. There&#8217;s no assurance other than the word of people who are extorting you that they&#8217;ll hold up their end of the bargain.</p>
<h3 aria-level="3"><span data-contrast="none">The final insult: deployment</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h3>
<p><span data-contrast="auto">Attackers have launched the ransomware payload using a wide variety of methods. They may push out copies to individual machines from a domain controller, or use administrative commands with WMIC or PsExec to run the malware directly from another server or workstation they control over the internal network of the target organization. </span></p>
<p><span data-contrast="auto">Sodinokibi/REvil has a few additional options that its operators may take advantage of by launching the malware with special command flags. One of the ways we’ve observed ransomware attempt to work around endpoint protection tools is to reboot the computer into Safe Mode, and then begin the encryption operation. A computer in Safe Mode boots to a diagnostic form of Windows in which third-party drivers and services are not running, but the ransomware adds itself to the (very short) list of applications that run in Safe Mode. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}">REvil has a Safe Mode flag attackers could use.</span></p>
<p><span data-contrast="auto">In one instance, we observed a threat actor attempt to bypass security software by delivering and installing a full copy of VirtualBox and a virtual disk file, running the ransomware within a Windows 10 virtual machine guest copied to the targeted host computer, executing the encryption commands from the guest to target the host. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75943" aria-describedby="caption-attachment-75943" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75943" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-service-that-starts-encryption.png" alt="" width="640" height="239" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-service-that-starts-encryption.png 1118w, https://news.sophos.com/wp-content/uploads/2021/06/revil-service-that-starts-encryption.png?resize=300,112 300w, https://news.sophos.com/wp-content/uploads/2021/06/revil-service-that-starts-encryption.png?resize=768,287 768w, https://news.sophos.com/wp-content/uploads/2021/06/revil-service-that-starts-encryption.png?resize=1024,383 1024w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75943" class="wp-caption-text">The long, encoded command string that requires you to know a lot about the machine in order to decode it</figcaption></figure>
<p>In others, we&#8217;ve observed the threat actor using WMI to create service entries on the machines they target for encryption. The entries contain a long, encoded command string that is impossible to decode unless you know the specific variables it was looking for. These variables included information such as the machine name, IP address, domain, and username. If you didn’t know all of these for the computer the service had been installed on, then decoding the final layers was impossible.</p>
<h2 aria-level="2"><span data-contrast="none">How the ransomware, itself, works</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h2>
<p><span data-contrast="auto">Sodinokibi arrives as a packed, encrypted executable that has several anti-analysis features designed to frustrate researchers. The binary files are compiled with the unique configuration and ransom note text hardcoded into the application.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75938" aria-describedby="caption-attachment-75938" style="width: 873px" class="wp-caption alignnone"><img loading="lazy" class=" wp-image-75938" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-deletes-windows-defender-definitions.png" alt="" width="873" height="45" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-deletes-windows-defender-definitions.png 1140w, https://news.sophos.com/wp-content/uploads/2021/06/revil-deletes-windows-defender-definitions.png?resize=300,15 300w, https://news.sophos.com/wp-content/uploads/2021/06/revil-deletes-windows-defender-definitions.png?resize=768,39 768w, https://news.sophos.com/wp-content/uploads/2021/06/revil-deletes-windows-defender-definitions.png?resize=1024,52 1024w" sizes="(max-width: 873px) 100vw, 873px" /><figcaption id="caption-attachment-75938" class="wp-caption-text">A subroutine for deleting the Windows Defender definitions file in REvil</figcaption></figure>
<p><span data-contrast="auto">When first executed, the malware profiles the target machine, enumerates a list of the running processes, and deletes the Volume Shadow Copy, the virus definition database used by Windows Defender, and temporary or backup files used by a number of different third-party programs that may be installed on the machine. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75930" aria-describedby="caption-attachment-75930" style="width: 276px" class="wp-caption alignnone"><img loading="lazy" class=" wp-image-75930" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-files-ignored-for-encryption.png" alt="" width="276" height="282" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-files-ignored-for-encryption.png 379w, https://news.sophos.com/wp-content/uploads/2021/06/revil-files-ignored-for-encryption.png?resize=294,300 294w, https://news.sophos.com/wp-content/uploads/2021/06/revil-files-ignored-for-encryption.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2021/06/revil-files-ignored-for-encryption.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2021/06/revil-files-ignored-for-encryption.png?resize=64,64 64w" sizes="(max-width: 276px) 100vw, 276px" /><figcaption id="caption-attachment-75930" class="wp-caption-text">Files ignored by REvil</figcaption></figure>
<p><span data-contrast="auto">It searches the list of running processes for any matches to a list of process names encoded into the configuration, and then attempts to kill those processes. Among the 30-odd process names are included various database services, office applications, email clients, backup utilities, and the Firefox browser (but, oddly, no others). </span></p>
<figure id="attachment_75931" aria-describedby="caption-attachment-75931" style="width: 308px" class="wp-caption alignnone"><img loading="lazy" class=" wp-image-75931" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-processes-to-kill.png" alt="" width="308" height="580" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-processes-to-kill.png 377w, https://news.sophos.com/wp-content/uploads/2021/06/revil-processes-to-kill.png?resize=159,300 159w" sizes="(max-width: 308px) 100vw, 308px" /><figcaption id="caption-attachment-75931" class="wp-caption-text">Part of the list of processes REvil tries to kill before it begins encrypting</figcaption></figure>
<p><span data-contrast="auto">It then enumerates the list of installed services and, at least in the case of some of the samples we received, it attempts to disable the Sophos service (these attempts routinely fail, due to tamper protection) as well as those of seven other commercial software tools.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<figure id="attachment_75932" aria-describedby="caption-attachment-75932" style="width: 592px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75932" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-note-embedded-in-binary.png" alt="" width="592" height="287" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-note-embedded-in-binary.png 592w, https://news.sophos.com/wp-content/uploads/2021/06/revil-ransom-note-embedded-in-binary.png?resize=300,145 300w" sizes="(max-width: 592px) 100vw, 592px" /><figcaption id="caption-attachment-75932" class="wp-caption-text">The REvil ransom note, decrypted inside of the ransomware binary</figcaption></figure>
<p><span data-contrast="auto">Next, the ransomware decodes and writes out the ransom note to the root of the C: drive. The note lists a Tor website address and includes instructions on how to contact the attackers using either the Tor Browser, or with a a conventional browser on a Tor gateway website, as well as a long key that the attackers use in the decryption utility.</span></p>
<figure id="attachment_75933" aria-describedby="caption-attachment-75933" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75933" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-notification-banner.png" alt="" width="640" height="76" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-notification-banner.png 1090w, https://news.sophos.com/wp-content/uploads/2021/06/revil-notification-banner.png?resize=300,36 300w, https://news.sophos.com/wp-content/uploads/2021/06/revil-notification-banner.png?resize=768,91 768w, https://news.sophos.com/wp-content/uploads/2021/06/revil-notification-banner.png?resize=1024,121 1024w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75933" class="wp-caption-text">The ransom note notification banner</figcaption></figure>
<p><span data-contrast="auto">Embedded within the configuration is an encoded .bmp image file, which the ransomware writes to the <em>%AppData%\Local\Temp</em> folder and sets as the desktop image on the infected computer. The graphic says &#8220;<em>All of your files </em></span><em>are</em><span data-contrast="auto"><em> encrypted! Find [name of the ransom note] for more instuctions.</em>&#8220;</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span><span data-contrast="auto">The ransom note filename starts with the same eight-random-character string the ransomware appends to the filename of every file it encrypts. </span></p>
<figure id="attachment_75934" aria-describedby="caption-attachment-75934" style="width: 308px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75934" src="https://news.sophos.com/wp-content/uploads/2021/06/how-salsa20-works.png" alt="" width="308" height="183" srcset="https://news.sophos.com/wp-content/uploads/2021/06/how-salsa20-works.png 308w, https://news.sophos.com/wp-content/uploads/2021/06/how-salsa20-works.png?resize=300,178 300w" sizes="(max-width: 308px) 100vw, 308px" /><figcaption id="caption-attachment-75934" class="wp-caption-text">How the Salsa20 algorithm is used</figcaption></figure>
<p><span data-contrast="auto">Sodinokibi/REvil uses the <a href="https://en.wikipedia.org/wiki/Curve25519" target="_blank" rel="noopener">curve25519</a>/<a href="https://en.wikipedia.org/wiki/Salsa20" target="_blank" rel="noopener">salsa20</a> algorithm to encrypt files. The built in configuration contains a long list of folders, file types, and specific filenames that it won&#8217;t encrypt (to maintain stability of the affected computer) rather than a list of targeted filetypes.</span></p>
<figure id="attachment_75935" aria-describedby="caption-attachment-75935" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="size-full wp-image-75935" src="https://news.sophos.com/wp-content/uploads/2021/06/salsa20-example.png" alt="" width="640" height="157" srcset="https://news.sophos.com/wp-content/uploads/2021/06/salsa20-example.png 650w, https://news.sophos.com/wp-content/uploads/2021/06/salsa20-example.png?resize=300,73 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-75935" class="wp-caption-text">A partially encrypted file example showing how Salsa20 &#8220;steps&#8221; through a file (note the position of &#8220;expand 32-byte k&#8221;)</figcaption></figure>
<p><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span><span data-contrast="auto">The ransomware does some housekeeping tasks while running. The embedded configuration contains a list of internet domain names; It sends statistics about the infection process back to the operators of the ransomware at one or more of these domains. These domains serve as strong indicators of compromise. </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p>REvil/Sodinokibi also has switched to using the Monero cryptocurrency as its exclusive payment method. As Monero has additional privacy features that Bitcoin does not have, it&#8217;s unlikely that we&#8217;ll see a recovery of the ransom paid to a threat actor who deployed this ransomware, as the FBI was able to accomplish with the DarkSide ransomware attack against Colonial Pipeline.</p>
<h2 aria-level="2"><span data-contrast="none">Guidance for IT professionals</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:40,&quot;335559739&quot;:0,&quot;335559740&quot;:259}"> </span></h2>
<p><span data-contrast="auto">Sophos products detect various forms of Sodinokibi/REvil as <strong>Troj/Sodino-*</strong>, <strong>Mem/Sodino-*</strong>, and <strong>HPMal/Sodino-A</strong>.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<p><span data-contrast="auto">While not an exhaustive list, these recommendations are more important than ever.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></p>
<ul>
<li><span data-contrast="auto"><strong>Monitor and respond to alerts</strong> – Ensure the appropriate tools, processes, and resources (people) are available to monitor and respond to threats seen in the environment. It is crucial to ensure that, when a security alert or event happens, someone investigates and responds in a timely manner. Ransomware attackers may time their strike during off-peak hours, weekends, or holidays, working on the assumption that few or no staff are watching.</span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></li>
<li><span data-contrast="auto"><strong>Strong passwords</strong> – Strong passwords serve as one of the first lines of defense. As a minimum use a complex password of at least twelve characters. Password managers will help users maintain complex passwords that are unique to individual accounts. Don&#8217;t reuse passwords anywhere. </span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></li>
<li><span data-contrast="auto"><strong>Multi Factor Authentication (MFA)</strong> – Even strong passwords can be compromised. At a minimum, any form of multifactor authentication is better than none for securing access to critical resources such as e-mail, remote management tools, and network assets. <a href="https://en.wikipedia.org/wiki/Time-based_One-Time_Password" target="_blank" rel="noopener">TOTP MFA</a> apps on smartphones may be safer than email or SMS-based MFA systems in the long run; In a situation where the attacker is already on the network, email may already be compromised, and SIM swapping, while rare, could compromise text message MFA codes. But d</span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}">on&#8217;t let the perfect be the enemy of the good. MFA of any kind can save your bacon.</span></li>
<li><span data-contrast="auto"><strong>Lock down accessible services</strong> – Perform scans of your organization&#8217;s network from outside the network, and identify and lock down the ports commonly used by VNC, RDP, or other remote access tools. If a machine needs to be reachable using a remote management tool, put access to that tool behind a VPN that uses MFA as part of its login and segmented into its own VLAN away from other machines.</span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></li>
<li><span data-contrast="auto"><strong>Segmentation and Zero-Trust</strong> – At the very minimum, separate critical servers from each other and from workstations by putting them into separate VLANs as you <a href="https://home.sophos.com/en-us/security-news/2021/what-is-zero-trust.aspx" target="_blank" rel="noopener">work towards a zero-trust network model</a>. </span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></li>
<li><span data-contrast="auto"><strong>Inventory your assets and accounts</strong> – Unprotected and unpatched devices in the network increase risk, and create a situation where malicious activities could pass unnoticed. It is vital to protect every device on your network, and the only way to do that is to have a current inventory of all connected computers and IOT devices. Use network scans and physical checks to locate and catalog them. </span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></li>
<li><span data-contrast="auto"><strong>Product configuration</strong> – Ensure that security products are configured following best practices guidance. Check policy configurations and exclusions on a regular basis. New features may not be enabled automatically. </span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></li>
<li><span data-contrast="auto"><strong>Active Directory (AD)</strong> – Conduct regular audits on all accounts in AD, ensuring that no accounts have more access than is needed for their purpose. Disable accounts for departing employees as soon as they leave the company. </span><span data-ccp-props="{&quot;134233279&quot;:true,&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> </span></li>
<li><strong>Patch everything</strong> &#8211; keep Windows and other software up to date. Validate that patches have been installed for critical systems like internet-facing machines or domain controllers.</li>
</ul>
<p><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:259}"> Users of <a href="https://docs.sophos.com/central/Customer/help/en-us/central/Customer/learningContents/LiveDiscover.html" target="_blank" rel="noopener">Sophos LiveDiscover</a> can run SQL queries like the ones in this table to interrogate telemetry from devices on their managed network, and hunt for unusual or unexpected behavior on their managed devices.<br />
</span></p>
<p><img loading="lazy" class="alignnone wp-image-75936" src="https://news.sophos.com/wp-content/uploads/2021/06/revil-livediscover-queries-that-can-threat-hunt.png" alt="" width="869" height="311" srcset="https://news.sophos.com/wp-content/uploads/2021/06/revil-livediscover-queries-that-can-threat-hunt.png 1664w, https://news.sophos.com/wp-content/uploads/2021/06/revil-livediscover-queries-that-can-threat-hunt.png?resize=300,107 300w, https://news.sophos.com/wp-content/uploads/2021/06/revil-livediscover-queries-that-can-threat-hunt.png?resize=768,275 768w, https://news.sophos.com/wp-content/uploads/2021/06/revil-livediscover-queries-that-can-threat-hunt.png?resize=1024,367 1024w, https://news.sophos.com/wp-content/uploads/2021/06/revil-livediscover-queries-that-can-threat-hunt.png?resize=1536,550 1536w" sizes="(max-width: 869px) 100vw, 869px" /></p>
<h2>Acknowledgments</h2>
<p>SophosLabs researchers Anand Ajjan, Hajnalka Kope, and Mark Loman and Rapid Response manager Peter Mackenzie contributed to our understanding of REvil attacks and the malware&#8217;s behavior.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2021/06/08/six-in-the-wild-exploits-patched-in-microsofts-june-security-fix-release/" rel="prev">Six in-the-wild exploits patched in Microsoft&#039;s June security fix release</a>
						   			</div>
	   			<div class="nav-next">
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://secure.gravatar.com/avatar/216532880604c8cf0600f4bc964cf01d?s=145&#038;d=blank&#038;r=g' class='avatar avatar-145 photo' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/andrew-brandt/" title="Posts by Andrew Brandt" class="author url fn" rel="author">Andrew Brandt</a></h3>

					
					<div class="author-bio">
						<p>SophosLabs Principal Researcher Andrew Brandt blends a 20-year journalism background with deep, retrospective analysis of malware infections, ransomware, and cyberattacks as the editor of SophosLabs Uncut. His work with the Labs team helps Sophos protect its global customers, and alerts the world about notable criminal behavior and activity, whether it's normal or novel. Follow him at @threatresearch on Twitter for up-to-the-minute news about all things malicious.</p>
<p>He is also:</p>
<p>Operator of the world's first fully solar-powered malware research lab.</p>
<p>A honeypot wrangler.</p>
<p>Threat actor disruption specialist.</p>
<p>Retromalware hobbyist.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2021/06/11/relentless-revil-revealed/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='75918' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="a349cdf2f0" /></p><input type="hidden" id="ak_js" name="ak_js" value="227"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-75686" class="second-featured post-75686 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-epsilon-red tag-epsilonred tag-exchange tag-powershell tag-proxylogon tag-ransomware tag-wmi region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/Epsilon-Red-Marvel-Comics-Wolverine-cosmonaut-h1.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">28</span>
				<span class="month">May</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/05/28/epsilonred/" rel="bookmark">A new ransomware enters the fray: Epsilon Red</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-74669" class="second-featured post-74669 post type-post status-publish format-standard has-post-thumbnail hentry category-corporate tag-intercept-x tag-ransomware region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/04/State-of-Ransomware-Sophos-News.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">27</span>
				<span class="month">Apr</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/corporate/">Corporate</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/04/27/the-state-of-ransomware-2021/" rel="bookmark">The State of Ransomware 2021</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72561" class="second-featured post-72561 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-conti tag-ransomware tag-rapid-response tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/Screenshot-2021-02-10-at-10.58.02.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">16</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/16/what-to-expect-when-youve-been-hit-with-conti-ransomware/" rel="bookmark">What to expect when you’ve been hit with Conti ransomware</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-68189" class="second-featured post-68189 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-sidebar tag-the-realities-of-ransomware region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/header-image-2.jpg?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">04</span>
				<span class="month">Aug</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/08/04/the-realities-of-ransomware-five-signs-youre-about-to-be-attacked/" rel="bookmark">The realities of ransomware: Five signs you’re about to be attacked</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkN0KwjAMRl/I/qyg4oX4KFK7uHU2bWlap29vZQy88GKF3OTLOQlEzJGZ4DP4LPIICCQoxDGQh5mYkt1RTFSrQuFhgT0VV7yrAV8CPtFObNphQmqg4ZWTpu38EvGSrWu3jMao7eCbxahT9pCavUE3K99slaw3rvRAy1sR6wKWILo3R+v/QbUFvEH/O18vY2HRlcF6EvphCSGLa3XFPSSs7AXP3UF1JyX3Uk4fbSrKCA=='></script>
<script src='https://stats.wp.com/e-202123.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.8.1',blog:'166161023',post:'75918',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '75918' ]);
</script>
</body>
</html>
