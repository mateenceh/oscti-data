





<!DOCTYPE html>
<html class="no-js" lang="en-US">
<head>


<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || []; w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        }); var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-54M2ZJN');</script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow" />
<meta name="rights" content="Â© Copyright Trustwave 2020" />
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ed1a3d">
<meta name="msvalidate.01" content="B5B6397DC5AEABDCC2BD2A5D1872960D" />
<title>ModSecurity Advanced Topic of the Week: HMAC Token Protection | Trustwave | SpiderLabs | Trustwave</title>
<meta name="description" content="This blog post presents a powerful feature of ModSecurity v2.7 that has been highly under-utilized by most users: HMAC Token Protection. There was a previous blog post written that outlined some usage examples here, however we did not properly demonstrate...">

<link rel="alternate" href="/en-us/resources/blogs/spiderlabs-blog/modsecurity-advanced-topic-of-the-week-hmac-token-protection/" hreflang="x-default"/>

<link rel="canonical" href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/modsecurity-advanced-topic-of-the-week-hmac-token-protection/" />
<meta property="og:url" content="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/modsecurity-advanced-topic-of-the-week-hmac-token-protection/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Trustwave" />
<meta property="og:image" content="https://trustwave.azureedge.net/media/15281/generic-default-image.jpg?rnd=131897043920000000" />
<meta property="og:title" content="ModSecurity Advanced Topic of the Week: HMAC Token Protection" />
<meta property="og:description" content="This blog post presents a powerful feature of ModSecurity v2.7 that has been highly under-utilized by most users: HMAC Token Protection. There was a previous blog post written that outlined some usage examples here, however we did not properly demonstrate..." />
<link type="text/css" rel="stylesheet" href="//fast.fonts.net/cssapi/9c85e15b-99ed-40a4-929d-2262f9ed2706.css" />
<!-- CSS & JS -->
<link rel="stylesheet" type="text/css" href="/dist/css/styles.min.css?v=33sa">

<!--[if lt IE 9]>
  <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
<script type='text/javascript'>
    var appInsights = window.appInsights || function (config) {
        function r(config) { t[config] = function () { var i = arguments; t.queue.push(function () { t[config].apply(t, i) }) } }
        var t = { config: config }, u = document, e = window, o = 'script', s = u.createElement(o), i, f; for (s.src = config.url || '//az416426.vo.msecnd.net/scripts/a/ai.0.js', u.getElementsByTagName(o)[0].parentNode.appendChild(s), t.cookie = u.cookie, t.queue = [], i = ['Event', 'Exception', 'Metric', 'PageView', 'Trace', 'Ajax']; i.length;)r('track' + i.pop()); return r('setAuthenticatedUserContext'), r('clearAuthenticatedUserContext'), config.disableExceptionTracking || (i = 'onerror', r('_' + i), f = e[i], e[i] = function (config, r, u, e, o) { var s = f && f(config, r, u, e, o); return s !== !0 && t['_' + i](config, r, u, e, o), s }), t
    }({
        instrumentationKey: "d8139253-6e32-4606-9657-fe02425cfe56"
    });

    window.appInsights = appInsights;
    appInsights.trackPageView();
</script>
<script src='https://www.google.com/recaptcha/api.js'></script>
<script src='https://www.google.com/recaptcha/api.js?render=6LdMtIkUAAAAAP7FCbfNuAv_bvJRl7vsAjPIyOWc'></script>

            <link rel="amphtml" href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/modsecurity-advanced-topic-of-the-week-hmac-token-protection/?amp=1">


    <script>
var SThreshold = 0.5;var globalmktoid = 0;var globalpartnerform = false;var globalfooterform = true;

    </script>

</head>
<body  class="site-wrapper site-header-light">

    <!--[if lte IE 9]>
      <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
    <![endif]-->
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-54M2ZJN"
                height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->




<header class="site-header" itemscope itemtype="http://www.schema.org/SiteNavigationElement">	
	<div class="site-header-container-mobile">
		<div class="site-header-content-mobile">
            <nav>
                <button class="site-header-toggle-drawer-open"><i class="material-icons">menu</i></button>
                <div class="site-header-brand-wrapper-mobile">
                    <a href="/en-us/" class="site-header-brand-mobile"><span>Trustwave</span></a>
                </div>
                
                <a href="/en-us/search/" class="site-header-toggle-search-open"><i class="material-icons">search</i></a>
            </nav>
		</div>
	</div>
	<div class="site-header-container-backdrop"></div>
	<div class="site-header-container">
		<div class="site-header-brand-wrapper-drawer">
			<a href="/en-us/" class="site-header-brand-drawer"><span>Trustwave</span></a>
			<button class="site-header-toggle-drawer-close"><i class="material-icons">close</i></button>
		</div>
        <div class="site-header-content">
            <div class="site-header-content-top">
                <nav>
                                    <div class="site-header-alert">
                                        <p>
                                                <i class="material-icons">error_outline</i>
                                            

                                            <a href="/en-us/covid-19/" data-ga-hittype="event" data-ga-action="Click" data-ga-category="Alert Bar" data-ga-label="COVID-19 Pandemic - Alert Bar">COVID-19 and Your Cybersecurity</a>
                                        </p>
                                    </div>

                    <ul>
                        <li><a href="/en-us/company/contact/">Contact</a></li>
                        <li><a href="/en-us/company/support/">Support</a></li>
                        <li>
                            <div class="site-header-content-top-backdrop"></div>
                            <button data-toggle="#drawer-login">Login</button>
                            <div class="site-header-content-top-dropdown" id="dropdown-login">
                                <nav>
                                    <h4>Login to your Trustwave Fusion Platform Account</h4>
                                    <p><a href="https://fusion.trustwave.com" target="_blank" class="btn btn-primary btn-block">Fusion Platform</a></p>
                                    <ul>
                                        <li><a href="/en-us/company/about-us/trustwave-fusion-platform/">What is the Trustwave Fusion Platform?</a></li>
                                        <li><a href="https://segconsole.trustwave.com/" target="_blank">Login to SEG Cloud Portal</a></li>
                                        <li><a href="https://login.trustwave.com/portal-core/home" target="_blank">Legacy TrustKeeper Login</a></li>
                                    </ul>
                                </nav>
                            </div>
                        </li>
                        <li>
                            <div class="site-header-content-top-backdrop"></div>
                            <button data-toggle="#drawer-language"><i class="material-icons">language</i> English</button>
                            <div class="site-header-content-top-dropdown" id="dropdown-language">
                                <nav>
                                    <ul class="langpicker">
                                        <li><a href="/de-de/" data-loc="/de-de/" data-lang="de-de" value="de-de">German (Deutsche)</a></li>
                                        <li><a href="/ja-jp/" data-loc="/ja-jp/" data-lang="ja-jp" value="ja-jp">Japanese (æ¥æ¬èª)</a></li>
                                    </ul>
                                </nav>
                            </div>
                        </li>
                        <li>
                            <div class="site-header-content-top-backdrop"></div>
                            <span><button class="btn btn-sm btn-primary btn-block" data-toggle="#drawer-ir">Incident Response</button></span>
                            <div class="site-header-content-top-dropdown" id="dropdown-ir">
                                <nav>
                                    <h4>Experiencing a security breach?</h4>
                                    <p>Get access to immediate incident response assistance.</p>
                                    <h2>24 Hour Hotlines</h2>
                                    <ul>
                                        <li><h5>Americas</h5><h4>+1 (312) 598-1431</h4></li>
                                        <li><h5>EMEA</h5><h4>+44 175 477-2059</h4></li>
                                        <li><h5>Australia</h5><h4>1800 401 792</h4></li>
                                        <li><h5>Singapore</h5><h4>800 101 3355</h4></li>
                                    </ul>
                                    <div style="padding: 0 60px;">
                                        <a href="/en-us/company/contact/security-breach/" class="btn btn-primary btn-block">Recommended Actions</a>
                                    </div>
                                </nav>
                            </div>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="site-header-content-top-drawer" id="drawer-login">
                <nav>
                    <button><i class="material-icons">chevron_left</i> Back</button>
                    <div>
                        <h4>Login to your Trustwave Fusion Platform Account</h4>
                        <p><a href="https://fusion.trustwave.com" target="_blank" class="btn btn-primary btn-block">Fusion Platform</a></p>
                        <ul>
                            <li><a href="/en-us/company/about-us/trustwave-fusion-platform/">What is the Trustwave Fusion Platform?</a></li>
                            <li><a href="https://segconsole.trustwave.com/" target="_blank">Login to SEG Cloud Portal</a></li>
                            <li><a href="https://login.trustwave.com/portal-core/home" target="_blank">Legacy TrustKeeper Login</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
            <div class="site-header-content-top-drawer" id="drawer-language">
                <nav>
                    <button><i class="material-icons">chevron_left</i> Back</button>
                    <div>
                        <ul class="langpicker">
                            <li><a href="/de-de/" data-loc="/de-de/" data-lang="de-de" value="de-de">DE - German (Deutsche)</a></li>
                            <li><a href="/ja-jp/" data-loc="/ja-jp/" data-lang="ja-jp" value="ja-jp">JP - Japanese (æ¥æ¬èª)</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
            <div class="site-header-content-top-drawer" id="drawer-ir">
                <nav>
                    <button><i class="material-icons">chevron_left</i> Back</button>
                    <div>
                        <h4>Experiencing a security breach?</h4>
                        <p>Get access to immediate incident response assistance.</p>
                        <h2>24 Hour Hotlines</h2>
                        <ul>
                            <li><h5>Americas</h5><h4>+1 (312) 598-1431</h4></li>
                            <li><h5>EMEA</h5><h4>+44 175 477-2059</h4></li>
                            <li><h5>Australia</h5><h4>1800 401 792</h4></li>
                            <li><h5>Singapore</h5><h4>800 101 3355</h4></li>
                        </ul>
                        <div style="padding: 0 15px;">
                            <a href="/en-us/company/contact/security-breach/" class="btn btn-primary btn-block">Recommended Actions</a>
                        </div>
                    </div>
                </nav>
            </div>
            <div class="site-header-content-main">
                <nav>
                    <div class="site-header-brand-wrapper-desktop">
                        <a href="/en-us/" class="site-header-brand-desktop"><span>Trustwave</span></a>
                    </div>
                    <ul>
                        <li><a href="/en-us/services/">Services</a><button data-toggle="#dropdown-services"><i class="material-icons">chevron_right</i></button></li>
                        <li><a href="/en-us/capabilities/">Capabilities</a><button data-toggle="#dropdown-capabilites"><i class="material-icons">chevron_right</i></button></li>
                        <li><a href="/en-us/resources/">Resources</a><button data-toggle="#dropdown-resources"><i class="material-icons">chevron_right</i></button></li>
                        <li><a href="/en-us/company/">Company</a><button data-toggle="#dropdown-company"><i class="material-icons">chevron_right</i></button></li>
                    </ul>
                    
                    <a href="/en-us/search/" class="site-header-toggle-search-open"><i class="material-icons">search</i></a>
                </nav>
            </div>
            <div class="site-header-content-dropdown" id="dropdown-services">
                <div class="site-header-content-dropdown-container">
                    <nav>
                        <button><i class="material-icons">chevron_left</i> Back</button>
                        <a href="/en-us/services/">Services</a>
                        <ul>
                            <li><a itemprop="url" href="/en-us/services/managed-security/"><span itemprop="name">Managed Security</span></a><button data-toggle="#services-tab-content-1"><i class="material-icons">chevron_right</i></button></li>
                            <li><a itemprop="url" href="/en-us/services/security-testing/"><span itemprop="name">Security Testing</span></a><button data-toggle="#services-tab-content-2"><i class="material-icons">chevron_right</i></button></li>
                            <li><a itemprop="url" href="/en-us/services/technology/"><span itemprop="name">Technology</span></a><button data-toggle="#services-tab-content-3"><i class="material-icons">chevron_right</i></button></li>
                            <li><a itemprop="url" href="/en-us/services/consulting/"><span itemprop="name">Consulting</span></a><button data-toggle="#services-tab-content-4"><i class="material-icons">chevron_right</i></button></li>
                            <li><a itemprop="url" href="/en-us/services/education/"><span itemprop="name">Education</span></a><button data-toggle="#services-tab-content-5"><i class="material-icons">chevron_right</i></button></li>
                        </ul>
                        <section>
                            <nav id="services-tab-content-1">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/services/managed-security/">Managed Security</a>
                                <ul class="two-thirds">
                                    <li><a itemprop="url" href="/en-us/services/managed-security/managed-threat-detection-and-response/"><span itemprop="name">Managed Threat Detection &amp; Response</span><span>Proactively hunt for, investigate and eradicate cyberthreats, 24x7.</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/managed-security/proactive-threat-hunting/"><span itemprop="name">Proactive Threat Hunting</span><span>Identify existing attackers in your environment and reduce dwell time</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/managed-security/security-technology/"><span itemprop="name">Security Technology Management</span><span>An arrangement to handle the day-to-day management of your infosec</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/managed-security/security-and-compliance-bundles/"><span itemprop="name">Security and Compliance Bundles</span><span>Solution packages to address needs from validation to full network security</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/managed-security/managed-web-application-firewall/"><span itemprop="name">Managed Web Application Firewall</span><span>Keep your mission critical web applications secure with a Managed WAF</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/managed-security/application-control/"><span itemprop="name">Managed Application Control</span> <span>Endpoint allowlisting with real-time threat intelligence and monitoring</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/managed-security/telco-security/"><span itemprop="name">Telco Security</span><span>DDOS & broadband protection for APAC businesses and delivered by Singtel</span></a></li>
                                </ul>
                                <aside class="one-third">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/library/documents/the-forrester-wave-global-managed-security-services-providers-q3-2020/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TheForresterWaveGlobalManagedSecurityServicesProvidersQ" data-ga-value="1">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/16992/reprint_the-forrester-wave_global-managed-security-services-providers_q3-2020-cover.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132404200250000000);"></span>
                    </a>
                </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Jul 28, 2020</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/library/documents/the-forrester-wave-global-managed-security-services-providers-q3-2020/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TheForresterWaveGlobalManagedSecurityServicesProvidersQ" data-ga-value="1">The Forrester Waveâ¢: Global Managed Security Services Providers, Q3 2020</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Analyst Report</span>
            </div>
        </div>

                                </aside>
                            </nav>
                            <nav id="services-tab-content-2">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/services/security-testing/">Security Testing</a>
                                <ul class="two-thirds">
                                    <li><a itemprop="url" href="/en-us/services/security-testing/security-testing-suite/"><span itemprop="name">Security Testing Services </span><span>Comprehensive suite of security testing capabilities managed within a unified portal</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/consulting/spiderlabs-consulting/"><span itemprop="name">Trustwave SpiderLabs</span><span>An elite group of researchers, penetration testers and incident responders</span></a></li>
                                </ul>
                                <aside class="one-third">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/library/documents/once-and-future-threats-what-security-testing-is-and-will-be/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="OnceandFutureThreatsWhatSecurityTestingIsandWillBe" data-ga-value="1">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/16795/once-future-cover-image.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132344863110000000);"></span>
                    </a>
                </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">May 20, 2020</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/library/documents/once-and-future-threats-what-security-testing-is-and-will-be/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="OnceandFutureThreatsWhatSecurityTestingIsandWillBe" data-ga-value="1">Once and Future Threats: What Security Testing Is and Will Be</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Ebook</span>
            </div>
        </div>

                                </aside>
                            </nav>
                            <nav id="services-tab-content-3">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/services/technology/">Technology</a>
                                <ul class="two-thirds">
                                    <li><a itemprop="url" href="/en-us/services/technology/dbprotect/"><span itemprop="name">DbProtect </span><span>Scalable enterprise platform to monitor & protect databases and big data stores</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/technology/appdetectivepro/"><span itemprop="name">AppDetectivePRO </span><span>Database and big data scanner to find weaknesses that could lead to compromise</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/technology/secure-email-gateway/"><span itemprop="name">Secure Email Gateway </span><span>Full protection against email threats and sensitive data from exiting</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/technology/secure-web-gateway/"><span itemprop="name">Secure Web Gateway </span><span>Flexible solution to guard in real time against internet-borne threats </span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/technology/intrusion-detection-and-prevention/"><span itemprop="name">Intrusion Detection &amp; Prevention </span><span>A high-speed solution that monitors your network & helps fortify the perimeter </span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/technology/next-generation-firewall/"><span itemprop="name">Next Generation Firewall </span><span>Comprehensive network security with a low total cost of ownership</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/partner-ecosystem/global-solution-partners/"><span itemprop="name">Technology Partners </span><span>Key Partners who augment the broad portfolio of security services</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/consulting/technology-and-implementation-services/"><span itemprop="name">Technology &amp; Implementation </span><span>Experts help determine the right assortment of technologies for your business</span></a></li>
                                </ul>
                                <aside class="one-third">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/library/documents/the-underground-economy/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TheUndergroundEconomy" data-ga-value="1">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/16254/the-underground-economy-cover.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132094902880000000);"></span>
                    </a>
                </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Aug 05, 2019</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/library/documents/the-underground-economy/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TheUndergroundEconomy" data-ga-value="1">The Underground Economy</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Ebook</span>
            </div>
        </div>

                                </aside>
                            </nav>
                            <nav id="services-tab-content-4">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/services/consulting/">Consulting</a>
                                <ul class="two-thirds">
                                    <li><a itemprop="url" href="/en-us/services/consulting/digital-forensics-and-incident-response/"><span itemprop="name">Digital Forensics &amp; IR </span><span>Service that provides breach training and immediate response to incidents </span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/consulting/threat-detection-and-response-consulting/"><span itemprop="name">Threat Detection &amp; Response Consulting </span><span>Advisory, transformation, and operations enablement consulting services</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/consulting/data-protection-consulting/"><span itemprop="name">Data Protection </span><span>Complete lifecycle management services for database security</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/consulting/cybersecurity-and-risk/"><span itemprop="name">Cybersecurity &amp; Risk </span><span>Advisors determine your security gaps and risk appetite to make better decisions </span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/consulting/spiderlabs-consulting/"><span itemprop="name">Trustwave SpiderLabs </span><span>An elite group of researchers, penetration testers and incident responders</span></a></li>
                                    <li><a itemprop="url" href="http://www.securitycolony.com/" target="_blank"><span itemprop="name">Security Colony </span><span>Big or small â your problem has been faced before. Like a CISO in your pocket</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/consulting/technology-and-implementation-services/"><span itemprop="name">Technology &amp; Implementation </span><span>Experts help determine the right assortment of technologies for your business</span></a></li>
                                </ul>
                                <aside class="one-third">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/library/documents/cyber-resiliency-in-the-multi-cloud-era/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="CyberResiliencyintheMultiCloudEra" data-ga-value="1">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/16414/cyber-multicloud-ebook-cover-image.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132176020710000000);"></span>
                    </a>
                </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Nov 07, 2019</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/library/documents/cyber-resiliency-in-the-multi-cloud-era/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="CyberResiliencyintheMultiCloudEra" data-ga-value="1">Cyber Resiliency in the Multi-Cloud Era</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Ebook</span>
            </div>
        </div>

                                </aside>
                            </nav>
                            <nav id="services-tab-content-5">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/services/education/">Education</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="/en-us/services/education/executive-training-programs-and-services/"><span itemprop="name">Executive Training Programs </span><span>Programs and services to help senior leaders make risk-based security decisions</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/education/cybersecurity-awareness-training/"><span itemprop="name">Cybersecurity Awareness Training </span><span>Industry-leading course content for general employees and developers</span></a></li>
                                    <li><a itemprop="url" href="/en-us/services/education/tactical-training-programs-and-services/"><span itemprop="name">Tactical Training Programs </span><span>Instruction for building attack defense and response that excels in the real world</span></a></li>
                                </ul>
                                <aside class="two-thirds">
                                    <div class="row card-list">

                                                <div class="col-lg-6 card-list-item">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/library/documents/the-complete-guide-to-building-a-security-culture/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TheCompleteGuidetoBuildingaSecurityCulture" data-ga-value="1">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15106/ierr37pw.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131992175790000000);"></span>
                    </a>
                </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Oct 30, 2017</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/library/documents/the-complete-guide-to-building-a-security-culture/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TheCompleteGuidetoBuildingaSecurityCulture" data-ga-value="1">The Complete Guide to Building a Security Culture</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Ebook</span>
            </div>
        </div>

                                                </div>
                                                <div class="col-lg-6 card-list-item">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/blogs/trustwave-blog/9-ways-to-create-a-security-awareness-program-people-won-t-hate/">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/7356/7145.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131644845120000000);" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="WaystoCreateaSecurityAwarenessProgramPeopleWontHate" data-ga-value="1"></span>
                    </a>
                </div>
            <div class="card-body card-body-overflow" style="height: 160px;">
                    <p class="mbx">Oct 07, 2015</p>
                <h4 class="mbn"><a href="/en-us/resources/blogs/trustwave-blog/9-ways-to-create-a-security-awareness-program-people-won-t-hate/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="WaystoCreateaSecurityAwarenessProgramPeopleWontHate" data-ga-value="1">9 Ways to Create a Security Awareness Program People Wonât Hate</a></h4>
            </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">Tips &amp; Tricks</span></div>
        </div>

                                                </div>

                                    </div>
                                </aside>
                            </nav>
                        </section>
                    </nav>
                </div>
            </div>
            <div class="site-header-content-dropdown" id="dropdown-capabilites">
                <div class="site-header-content-dropdown-container">
                    <nav>
                        <button><i class="material-icons">chevron_left</i> Back</button>
                        <a href="/en-us/capabilities/">Capabilites</a>
                        <ul>
                            <li><a itemprop="url" href="/en-us/capabilities/by-topic/"><span itemprop="name">By Topic</span></a><button data-toggle="#capabilities-tab-content-3"><i class="material-icons">chevron_right</i></button></li>
                            <li><a itemprop="url" href="/en-us/capabilities/by-industry/"><span itemprop="name">By Industry</span></a><button data-toggle="#capabilities-tab-content-1"><i class="material-icons">chevron_right</i></button></li>
                            <li><a itemprop="url" href="/en-us/capabilities/by-mandate/"><span itemprop="name">By Mandate</span></a><button data-toggle="#capabilities-tab-content-2"><i class="material-icons">chevron_right</i></button></li>
                        </ul>
                        <section>
                            <nav id="capabilities-tab-content-3">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/capabilities/by-topic/">By Topic</a>
                                <ul class="two-thirds">

<li><a itemprop='url' href='/en-us/capabilities/by-topic/securing-data/' target='_self' data-ga-hittype="event" data-ga-category="menu_link" data-ga-action="click" data-ga-label="SecuringData" data-ga-value="1"><span itemprop='name'>Securing Data</span><span>Protect data. Secure databases. Sustain compliance.</span></a></li>
<li><a itemprop='url' href='/en-us/covid-19/' target='_self' data-ga-hittype="event" data-ga-category="menu_link" data-ga-action="click" data-ga-label="COVIDPandemic" data-ga-value="1"><span itemprop='name'>COVID-19 Pandemic</span><span>Security resources, recommendations and strategies that offer you help and guidance</span></a></li>
<li><a itemprop='url' href='/en-us/capabilities/by-topic/rapidly-secure-temporary-infrastructures/' target='_self' data-ga-hittype="event" data-ga-category="menu_link" data-ga-action="click" data-ga-label="RapidlySecureNewEnvironments" data-ga-value="1"><span itemprop='name'>Rapidly Secure New Environments</span><span>Secure new environments in rapid response situations</span></a></li>

                                    <li><a itemprop="url" href="/en-us/capabilities/by-topic/detecting-and-responding-to-threats/"><span itemprop="name">Detecting &amp; Responding to Threats </span><span>Monitor, proactively hunt for, investigate and remediate cyberthreats, 24x7</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-topic/securing-email-and-web-gateways/"><span itemprop="name">Securing Email &amp; Web Gateways </span><span>Protect against threats that strike when users encounter malicious content</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-topic/cloud-security/"><span itemprop="name">Securing the Cloud </span><span>Safely navigate to and stay protected in the cloud</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-topic/scanning-and-testing-for-vulnerabilities/"><span itemprop="name">Scanning &amp; Testing </span><span>Get insights on your risk exposure</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-topic/securing-the-iot-landscape/"><span itemprop="name">Securing the IoT Landscape</span><span>Test, monitor and secure everyday objects connected to your companyâs network</span></a></li>
                                </ul>
                                <aside class="one-third">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/library/documents/gartner-report-ask-these-critical-questions-and-consider-these-risks-when-selecting-an-mdr-provider/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="GartnerReportAskTheseCriticalQuestionsandConsiderTheseRisksWhenSelectinganMDRProvider" data-ga-value="1">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/16657/gartner-mdr-cover.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132308413190000000);"></span>
                    </a>
                </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Apr 08, 2020</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/library/documents/gartner-report-ask-these-critical-questions-and-consider-these-risks-when-selecting-an-mdr-provider/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="GartnerReportAskTheseCriticalQuestionsandConsiderTheseRisksWhenSelectinganMDRProvider" data-ga-value="1">Gartner Report: Ask These Critical Questions and Consider These Risks When Selecting an MDR Provider</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Analyst Report</span>
            </div>
        </div>

                                </aside>
                            </nav>
                            <nav id="capabilities-tab-content-1">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/capabilities/by-industry/">By Industry</a>
                                <ul>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/education/"><span itemprop="name">Education </span><span>Enterprise-grade security designed to fill gaps in K-12 & higher ed</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/financial-sector/"><span itemprop="name">Financial Sector </span><span>Tech and services for protecting the worldâs most asset-heavy sector</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/government/"><span itemprop="name">Government </span><span>Services to help federal, state & local overcome resource shortages</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/healthcare/"><span itemprop="name">Health Care </span><span>Solutions for health care to protect infrastructure and ensure compliance </span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/hotels/"><span itemprop="name">Hotels </span><span>Solutions & service packages for the customer-facing lodging industry</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/legal/"><span itemprop="name">Legal </span><span>A solution set designed for a client-driven industry & hot target</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/payment-services/"><span itemprop="name">Payment Services </span><span>Digital protection across an evolving, complex & heavily targeted space</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/restaurants/"><span itemprop="name">Restaurants </span><span>Order up data protection through managed security bundles </span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-industry/retail/"><span itemprop="name">Retail </span><span>Convenient packages to prevent, detect & respond, and address PCI</span></a></li>
                                </ul>
                            </nav>
                            <nav id="capabilities-tab-content-2">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/capabilities/by-mandate/">By Mandate</a>
                                <ul>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/data-privacy/"><span itemprop="name">Data Privacy </span><span>Data protection and breach notification laws have become universal</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/fisma/"><span itemprop="name">FISMA </span><span>Federal agencies must get up to speed on securing IT systems</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/gdpr/"><span itemprop="name">GDPR </span><span>Flagship law out of the EU is a wake-up call to businesses everywhere</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/glba/"><span itemprop="name">GLBA </span><span>Federal law forces financial firms to act on information security</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/hipaa/"><span itemprop="name">HIPAA </span><span>Regulations to protect patient data & prevent health care threats</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/iso/"><span itemprop="name">ISO </span><span>Satisfy the 27000 series of standards & keep data assets protected</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/popi/"><span itemprop="name">POPI </span><span>South Africaâs new regulation addresses personal data processing</span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/pci/"><span itemprop="name">PCI </span><span>The most prescriptive security standard requires constant vigilance </span></a></li>
                                    <li><a itemprop="url" href="/en-us/capabilities/by-mandate/sox/"><span itemprop="name">SOX </span><span>Publicly traded firms must show accountability, including around security</span></a></li>
                                </ul>
                            </nav>
                        </section>
                    </nav>
                </div>
            </div>
            <div class="site-header-content-dropdown" id="dropdown-resources">
                <div class="site-header-content-dropdown-container">
                    <nav>
                        <button><i class="material-icons">chevron_left</i> Back</button>
                        <a href="/en-us/resources/">Resources</a>
                        <ul>
                            <li><a itemprop="url" href="/en-us/resources/blogs/"><span itemprop="name">Blogs &amp; Stories</span></a><button data-toggle="#resources-tab-content-1"></button></li>
                            <li><a itemprop="url" href="/en-us/resources/library/"><span itemprop="name">Resource Library</span></a><button data-toggle="#resources-tab-content-2"></button></li>
                            <li><a itemprop="url" href="/en-us/resources/security-resources/"><span itemprop="name">Security Resources</span></a><button data-toggle="#resources-tab-content-3"></button></li>
                            <li><a itemprop="url" href="/en-us/resources/upcoming/"><span itemprop="name">Events &amp; Live Webinars</span></a><button data-toggle="#resources-tab-content-4"></button></li>
                        </ul>
                        <section>
                            <nav id="resources-tab-content-1">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/resources/blogs/">Blogs &amp; Stories</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="/en-us/resources/blogs/trustwave-blog/"><span itemprop="name">Trustwave Blog </span><span>A collection of tips and perspective on security hot topics that matter to you</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/blogs/spiderlabs-blog/"><span itemprop="name">SpiderLabs Blog </span><span>Researchers & ethical hackers deliver malware analysis and vulnerability insight </span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/trustwave-stories/"><span itemprop="name">Trustwave Stories </span><span>A set of stories about how Trustwave is changing the way you do security</span></a></li>
                                </ul>
                                <aside class="two-thirds">
                                    <div class="row card-list">

                                                <div class="col-lg-6 card-list-item">

            <div class="card">
                        <div class="card-media">
                            <a href="/en-us/resources/blogs/spiderlabs-blog/evasive-urls-in-spam/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="EvasiveURLsinSpam" data-ga-value="1">
                                <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15279/sl-blog-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897042940000000);"></span>
                            </a>
                        </div>
                <div class="card-body card-body-overflow" style="height: 160px;">
                        <p class="mbx">Sep 17, 2020</p>
                    <h4 class="mbn"><a href="/en-us/resources/blogs/spiderlabs-blog/evasive-urls-in-spam/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="EvasiveURLsinSpam" data-ga-value="1">Evasive URLs in Spam</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">SpiderLabs Blog</span></div>
            </div>

                                                </div>
                                                <div class="col-lg-6 card-list-item">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/blogs/trustwave-blog/when-should-organizations-consider-digital-forensic-services/">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/17184/digitalforensics-blog-header.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132448344490000000);" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="WhenShouldOrganizationsConsiderDigitalForensicServices" data-ga-value="1"></span>
                    </a>
                </div>
            <div class="card-body card-body-overflow" style="height: 160px;">
                    <p class="mbx">Sep 17, 2020</p>
                <h4 class="mbn"><a href="/en-us/resources/blogs/trustwave-blog/when-should-organizations-consider-digital-forensic-services/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="WhenShouldOrganizationsConsiderDigitalForensicServices" data-ga-value="1">When Should Organizations Consider Digital Forensic Services?</a></h4>
            </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">Perspectives</span></div>
        </div>

                                                </div>
                                    </div>
                                </aside>
                            </nav>
                            <nav id="resources-tab-content-2">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/resources/library/">Resource Library</a>
                                <ul class="two-thirds">
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=doc&topics=&categories=&tags=&vidcats=&sort=Newest"><span itemprop="name">Documents </span><span>White papers, e-books, infographics and other practical resources.</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=webinar&topics=&categories=&tags=&vidcats=&sort=Newest"><span itemprop="name">Webinars </span><span>Webinar replays around the hottest cybersecurity topics today</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=video&topics=&categories=&tags=&vidcats=&sort=Newest"><span itemprop="name">Videos </span><span>A library of informative and engaging videos on various security subjects</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=doc&topics=&categories=Case%20Study&tags=&vidcats=&sort=Newest"><span itemprop="name">Case Studies </span><span>Stories of our customersâ infosec challenges and how they overcame them</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=doc&topics=&categories=Infographic&tags=&vidcats=&sort=Newest"><span itemprop="name">Infographics </span><span>Illustrative storytelling helping you more easily digest security trends and topics</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=doc&topics=&categories=Research%20Report&tags=gsr&vidcats=&sort=Newest"><span itemprop="name">Global Security Reports </span><span>The industry's most comprehensive account of cyberthreat and attack data</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=doc&topics=&categories=Analyst%20Report&tags=&vidcats=&sort=Newest"><span itemprop="name">Analyst Reports </span><span>As a market leader, experts regularly assess our services and technologies</span></a></li>
                                </ul>
                                <aside class="one-third">

        <div class="card">
                <div class="card-media">
                    <a href="/en-us/resources/library/documents/trustwave-threat-detection-and-response-services-for-microsoft-azure/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TrustwaveCoManagedSOCServicesforMicrosoftAzureSentinel" data-ga-value="1">
                        <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/17183/co-managed-soc-services-azure-sentinel_cover.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132447487100000000);"></span>
                    </a>
                </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Sep 16, 2020</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/library/documents/trustwave-threat-detection-and-response-services-for-microsoft-azure/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TrustwaveCoManagedSOCServicesforMicrosoftAzureSentinel" data-ga-value="1">Trustwave Co-Managed SOC Services for Microsoft Azure Sentinel</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Data Sheet</span>
            </div>
        </div>

                                </aside>
                            </nav>
                            <nav id="resources-tab-content-3">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/resources/security-resources/">Security Resources</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="/en-us/resources/security-resources/security-advisories/"><span itemprop="name">Security Advisories </span><span>An archive of vulnerability discoveries and details from Trustwave SpiderLabs</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/security-resources/software-updates/"><span itemprop="name">Software Updates </span><span>The latest updates to our products and services all in one place</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/security-resources/security-statistics/"><span itemprop="name">Security Statistics </span><span>The ultimate list of security facts and figures based on breach investigations</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/security-resources/special-offers/"><span itemprop="name">Special Offers </span><span>Trial software, subscriptions and tools to make smart security investments</span></a></li>
                                </ul>
                                <aside class="two-thirds">
                                    <div class="row card-list">

                                                <div class="col-lg-6 card-list-item">

        <div class="card">
                    <div class="card-media">
                        <a href="/en-us/resources/security-resources/special-offers/appdetectivepro-trial/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="AppDetectivePROTrialLimitedTimeFullLicense" data-ga-value="1">
                            <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/17186/adp-softwave_cover.png?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132448500440000000);"></span>
                        </a>
                    </div>

            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Apr 09, 2020</p>
                <h4 class="mbn">
                    <a href="/en-us/resources/security-resources/special-offers/appdetectivepro-trial/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="AppDetectivePROTrialLimitedTimeFullLicense" data-ga-value="1">AppDetectivePRO Trial Limited-Time Full License</a>
                </h4>
            </div>
            <div class="card-footer">
                <span class="text-sm text-uppercase text-muted">Special Offer</span>
            </div>
        </div>

                                                </div>

                                    </div>
                                </aside>
                            </nav>
                            <nav id="resources-tab-content-4">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/resources/upcoming/">Events &amp; Live Webinars</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="/en-us/resources/upcoming/webinars/"><span itemprop="name">Upcoming Webinars </span><span>Join the conversation by participating in live informative security webinars</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/upcoming/events/"><span itemprop="name">Upcoming Events </span><span>Where in the world is Trustwave? Extensive list of upcoming events</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/library/?type=webinar"><span itemprop="name">Webinar Replays </span><span>Webinar replays around the hottest cybersecurity topics today</span></a></li>
                                </ul>
                                <aside class="two-thirds">
                                    <div class="row card-list">

                                                <div class="col-lg-6 card-list-item">

        <div class="card">
            <div class="card-media">
                <a href="/en-us/resources/upcoming/events/cisoonline-chicago-1/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="CISOonlineChicago" data-ga-value="1">
                    <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/17152/ciso-chicago-socialmeta.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132435812960000000);"></span>
                </a>
            </div>
            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Sep 24, 2020</p>
                <h4 class="mbn"><a href="/en-us/resources/upcoming/events/cisoonline-chicago-1/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="CISOonlineChicago" data-ga-value="1">CISOonline Chicago</a></h4>
            </div>
            <div class="card-footer"><span class="text-sm text-uppercase text-muted">Upcoming Event</span></div>
        </div>

                                                </div>
                                                <div class="col-lg-6 card-list-item">

        <div class="card">
            <div class="card-media">
                <a href="/en-us/resources/upcoming/events/cisoonline-atlanta/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="CISOonlineAtlanta" data-ga-value="1">
                    <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/17151/ciso-alanta-sector-socialmeta.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=132435811490000000);"></span>
                </a>
            </div>
            <div class="card-body card-body-overflow" style="height: 160px;">
                <p class="mbx">Sep 22, 2020</p>
                <h4 class="mbn"><a href="/en-us/resources/upcoming/events/cisoonline-atlanta/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="CISOonlineAtlanta" data-ga-value="1">CISOonline Atlanta</a></h4>
            </div>
            <div class="card-footer"><span class="text-sm text-uppercase text-muted">Upcoming Event</span></div>
        </div>

                                                </div>
                                    </div>
                                </aside>
                            </nav>

                        </section>
                    </nav>
                </div>
            </div>
            <div class="site-header-content-dropdown" id="dropdown-company">
                <div class="site-header-content-dropdown-container">
                    <nav>
                        <button><i class="material-icons">chevron_left</i> Back</button>
                        <a href="/en-us/company/">Company</a>
                        <ul>
                            <li><a itemprop="url" href="/en-us/company/about-us/"><span itemprop="name">About Trustwave</span></a><button data-toggle="#company-tab-content-1"></button></li>
                            <li><a itemprop="url" href="https://jobs.jobvite.com/trustwave" target="_blank"><span itemprop="name">Careers</span></a><button data-toggle="#company-tab-content-2"></button></li>
                            <li><a itemprop="url" href="/en-us/partnerone/"><span itemprop="name">Partners</span></a><button data-toggle="#company-tab-content-3"></button></li>
                            <li><a itemprop="url" href="/en-us/company/newsroom/"><span itemprop="name">Newsroom</span></a><button data-toggle="#company-tab-content-4"></button></li>
                            <li><a itemprop="url" href="/en-us/company/contact/"><span itemprop="name">Contact</span></a><button data-toggle="#company-tab-content-5"></button></li>
                        </ul>
                        <section>
                            <nav id="company-tab-content-1">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/company/about-us/">About Trustwave</a>
                                <ul class="two-thirds">
                                    <li><a itemprop="url" href="/en-us/company/about-us/"><span itemprop="name">Our Story </span><span>Our focus is on threat detection and response. This is our story</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/about-us/our-history/"><span itemprop="name">Our History </span><span>Explore the major milestones of Trustwave and see how the company has evolved</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/about-us/trustwave-fusion-platform/"><span itemprop="name">Trustwave Fusion Platform </span><span>Cloud-native platform that gives enterprises unprecedented visibility and control over their security resources</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/about-us/spiderlabs-fusion-center/"><span itemprop="name">SpiderLabs Fusion Center </span><span>The epicenter - a cybersecurity command center in the heart of Chicago</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/about-us/advanced-security-operations-centers/"><span itemprop="name">Security Operations Centers </span><span>Distributed worldwide nodes defend our customers from the latest advanced threats </span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/about-us/spiderlabs/"><span itemprop="name">SpiderLabs </span><span>An elite security team of more than 250 researchers, ethical hackers and incident responders</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/about-us/leadership/"><span itemprop="name">Leadership </span><span>Experienced and impassioned experts make up our executive team</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/about-us/accolades/"><span itemprop="name">Accolades </span><span>Trustwave is honored to be recognized for some of the industryâs biggest awards</span></a></li>
                                </ul>
                                <aside class="one-third">
                                    <h5><small>Part of the</small> <br />Singtel group of companies</h5>
                                    <div class="card mbm">
                                        <div class="card-media">
                                            <a href="https://www.singtel.com/business" target="_blank">
                                                <span class="card-img" style="background-color:#ed1a3d; padding: 42px 0;">
                                                    <img src="/img/logo/Singtel Logo.svg" style="width: 120px;" class="img-responsive center-block" width="120" height="65" alt="Singtel Logo" />
                                                </span>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="card mbn">
                                        <div class="card-media">
                                            <a href="https://www.optus.com.au/business/" target="_blank">
                                                <span class="card-img" style="background-color: #00a3ad; padding: 63px 0;">
                                                    <img src="/img/logo/Optus Logo.svg" style="width: 120px;" class="img-responsive center-block" width="120" height="24" alt="Optus Logo" />
                                                </span>
                                            </a>
                                        </div>
                                    </div>
                                </aside>
                            </nav>
                            <nav id="company-tab-content-2">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="https://jobs.jobvite.com/trustwave" target="_blank">Careers</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="https://jobs.jobvite.com/trustwave/jobs" target="_blank"><span itemprop="name">All Opportunities </span><span>Trustwave is ready to challenge and inspire you</span></a></li>
                                    <li><a itemprop="url" href="https://jobs.jobvite.com/trustwave/p/paths" target="_blank"><span itemprop="name">Career Paths </span><span>Find your path. Or carve your own</span></a></li>
                                    <li><a itemprop="url" href="https://jobs.jobvite.com/trustwave/p/globe" target="_blank"><span itemprop="name">Around the Globe </span><span>We're looking for extraordinary people to join us</span></a></li>
                                    <li><a itemprop="url" href="https://jobs.jobvite.com/trustwave/p/why" target="_blank"><span itemprop="name">Why Trustwave? </span><span>We think youâll love working at Trustwave. This is why</span></a></li>
                                </ul>
                                <aside class="two-thirds"></aside>
                            </nav>
                            <nav id="company-tab-content-3">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/partnerone/">Partners</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="/en-us/partnerone/"><span itemprop="name">PartnerOne Program </span><span>Join forces with Trustwave to protect against the most advance cybersecurity threats</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/partner-ecosystem/global-solution-partners/"><span itemprop="name">Technology Partners </span><span>Key partners who augment our broad portfolio of security services</span></a></li>
                                </ul>
                                <aside class="two-thirds">

                                    <h4>Trustwave PartnerOne</h4>
                                    <p class="text-lg mbl">Our program helps partners enhance their go-to-market strategies, drive sales and build their brands. We provide a comprehensive suite of integrated and customizable digital marketing campaigns, sales enablement, and support and training courses.</p>
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <p><a href="https://trustwave.ziftone.com/" target="_blank" class="btn btn-primary btn-block">Partner Login</a></p>
                                        </div>
                                        <div class="col-lg-6">
                                            <p><a href="https://trustwave.ziftone.com/#/page/reg" target="_blank" class="btn btn-default btn-block">Register Now</a></p>
                                        </div>
                                    </div>
                                </aside>
                            </nav>
                            <nav id="company-tab-content-4">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/company/newsroom/">Newsroom</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="/en-us/company/newsroom/news/"><span itemprop="name">News Releases </span><span>Written newsworthy announcements from our communications team</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/newsroom/media/"><span itemprop="name">Media Coverage </span><span>News and activity around the world focusing and highlighting Trustwave</span></a></li>
                                    <li><a itemprop="url" href="/en-us/resources/blogs/"><span itemprop="name">Blogs </span><span>Security advice, research and more â all meant to help you do your job better</span></a></li>
                                </ul>
                                <aside class="two-thirds">
                                    <div class="row card-list">
                                                <div class="col-lg-6 card-list-item">

            <div class="card">
        
                    <div class="card-media">
                        <a href="/en-us/company/newsroom/news/trustwave-launches-advanced-threat-detection-and-response-for-us-government-agencies/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TrustwaveLaunchesAdvancedThreatDetectionandResponseforUSGovernmentAgencies" data-ga-value="1">
                            <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15280/news-release-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897043050000000);"></span>
                        </a>
                    </div>

                <div class="card-body card-body-overflow" style="height: 160px;">
                    <p class="mbx">Sep 16, 2020</p>
                    <h4 class="mbn"><a href="/en-us/company/newsroom/news/trustwave-launches-advanced-threat-detection-and-response-for-us-government-agencies/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TrustwaveLaunchesAdvancedThreatDetectionandResponseforUSGovernmentAgencies" data-ga-value="1">Trustwave Launches Advanced Threat Detection and Response for U.S. Government Agencies</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">News Release</span></div>
            </div>

                                                </div>
                                                <div class="col-lg-6 card-list-item">

            <div class="card">
        
                    <div class="card-media">
                        <a href="/en-us/company/newsroom/news/trustwave-named-a-leader-in-idc-marketscape-for-worldwide-managed-security-services/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TrustwaveNamedaLeaderinIDCMarketScapeforWorldwideManagedSecurityServices" data-ga-value="1">
                            <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15280/news-release-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897043050000000);"></span>
                        </a>
                    </div>

                <div class="card-body card-body-overflow" style="height: 160px;">
                    <p class="mbx">Sep 15, 2020</p>
                    <h4 class="mbn"><a href="/en-us/company/newsroom/news/trustwave-named-a-leader-in-idc-marketscape-for-worldwide-managed-security-services/" data-ga-hittype="event" data-ga-category="cta_menu_asset" data-ga-action="click" data-ga-label="TrustwaveNamedaLeaderinIDCMarketScapeforWorldwideManagedSecurityServices" data-ga-value="1">Trustwave Named a Leader in IDC MarketScape for Worldwide Managed Security Services</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">News Release</span></div>
            </div>

                                                </div>
                                    </div>
                                </aside>
                            </nav>
                            <nav id="company-tab-content-5">
                                <button><i class="material-icons">chevron_left</i> Back</button>
                                <a href="/en-us/company/contact/">Contact</a>
                                <ul class="one-third">
                                    <li><a itemprop="url" href="/en-us/company/contact/"><span itemprop="name">Global Contact </span><span>Have a question? Letâs get in touch. </span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/global-locations/"><span itemprop="name">Global Locations </span><span>A directory of our global offices and contact information</span></a></li>
                                    <li><a itemprop="url" href="/en-us/company/support/"><span itemprop="name">Support </span><span>Support for Trustwave services and solutions</span></a></li>
                                </ul>
                                <aside class="two-thirds global-contact-us">
                                    <div style="border-bottom: 1px solid rgba(0,0,0,.25); padding-bottom: 30px;">
                                        <h5 class="text-uppercase mbx">Experiencing a Security Breach?</h5>
                                        <p class="text-sm mbs">Access to immediate incident response assistance.</p>
                                        <h4 class="mbx"><span class="text-primary">24 Hour Hotline:</span> +1 (866) 659-9097 <small>Option 5</small></h4>
                                        <p class="mbs">International: +1 (312) 873-7500 <span class="text-sm">Option 4</span></p>
                                        <p class="mbn"><a href="/en-us/company/contact/security-breach/" class="btn btn-primary btn-sm">Recommended Actions</a></p>
                                    </div>
                                    <div class="row" style="padding-top: 30px;">
                                        <div class="col-sm-6" style="height: 170px;">
                                            <h5 class="mbx">General</h5>
                                            <p class="text-sm mbs">To speak to a Trustwave representative.</p>
                                            <h4 class="mbx">+1 (312) 873-7500</h4>
                                            <p class="mbn">Monday - Friday <br>8:00 AM - 6:00 PM CT (UTC -6)</p>
                                        </div>
                                        <div class="col-sm-6" style="height: 170px; border-left: 1px solid rgba(0,0,0,.25); padding-left: 30px;">
                                            <h5 class="mbx">Sales</h5>
                                            <p class="text-sm mbs">Contact a Trustwave solution specialist.</p>
                                            <h4 class="mbx">+1 (888) 878-7817</h4>
                                            <p class="mbn">Monday - Friday <br>8:00 AM - 6:00 PM CT (UTC -6)</p>
                                        </div>
                                    </div>

                                </aside>
                            </nav>
                        </section>
                    </nav>
                </div>
            </div>
        </div>
		
	</div>
</header>

<div class="loading-indicator">
    <div class="loading-content">
        <span class="loading-graphic"></span>
        <span class="loading-text">Loading...</span>
    </div>
</div>


    <main class="site-content">

        

<section class="section bg-brand-secondary bg-gradient-horizontal section-padding-top-none section-padding-bottom-none angle-bottom angle-bottom-gray-lightest angle-bottom-front">
    <span class="angle-top-placeholder"></span><span class="angle-bottom-placeholder"></span>
    <div class="page-intro">
        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
                    <h5 class="page-intro-type">Blogs &amp; Stories</h5>
                    <h1 class="page-intro-title">SpiderLabs Blog</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
                    <p class="page-intro-description">Attracting more than a half-million annual readers, this is the security community&#39;s go-to destination for technical breakdowns of the latest threats, critical vulnerability disclosures and cutting-edge research.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section bg-gray-lightest">
    <span class="angle-top-placeholder"></span><span class="angle-bottom-placeholder"></span>
    <div class="container">

        <div class="row">
            <div class="col-lg-10 col-lg-offset-1">
                <div class="blog-post-single">
                    <article class="blog-post" itemscope itemtype="http://schema.org/Blog">
                        <div class="card">
                            <div class="card-body">
                                <div class="blog-post-header">
                                        <h1 class="blog-post-title mbm" itemprop="name">ModSecurity Advanced Topic of the Week: HMAC Token Protection</h1>
                                    <div class="blog-post-meta">
                                            <div class="blog-post-date"><i class="material-icons">access_time</i><span itemprop="datePublished">January 24, 2014</span></div>
                                                                                    <div class="blog-post-author" itemprop="creator" itemscope itemtype="http://schema.org/Person"><i class="material-icons">person_outline</i><span itemprop="name">Ryan Barnett</span></div>
                                        <div class="blog-post-share">
                                            <i class="material-icons">share</i>
                                            <div class="addthis_toolbox pull-left">
                                                <ul class="share-icons custom_images">
                                                    <li><a data-toggle="tooltip" title="Tweet on Twitter" class="addthis_button_twitter"><img src="/img/icon/social/svg/dark/twitter.svg" alt="Twitter" /></a></li>
                                                    <li><a data-toggle="tooltip" title="Share on LinkedIn" class="addthis_button_linkedin"><img src="/img/icon/social/svg/dark/linkedin.svg" alt="LinkedIn" /></a></li>
                                                    <li><a data-toggle="tooltip" title="Share on Facebook" class="addthis_button_facebook"><img src="/img/icon/social/svg/dark/facebook.svg" alt="Facebook" /></a></li>
                                                    <li><a data-toggle="tooltip" title="Share through email" class="addthis_button_email"><i class="material-icons">email</i></a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="blog-post-content">
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/8a926cc9-3221-44ee-91a1-9a27142e6935.jpeg" style="float: right;"><img alt="6a00e551318e8a8833017d428831f4970c-120wi" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a3fca1993b970b img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/15cd28ae-5657-4741-8f2d-28aacffa1b48.jpeg?v=0.0.1" style="margin: 0px 0px 5px 5px;" title="6a00e551318e8a8833017d428831f4970c-120wi"></a>This blog post presents a powerful feature of ModSecurity v2.7 that has been highly under-utilized by most users: <em><strong>HMAC Token Protection</strong></em>.  There was a previous blog post written that outlined some usage examples <a href="http://blog.spiderlabs.com/2012/07/reducing-web-apps-attack-surface.html" target="_self">here</a>, however we did not properly demonstrate the protection coverage gained by its usage.  Specifically, by using the HMAC Token Protection capabilities of ModSecurity, you can reduce the attack surface of the following attacks/vulnerabilities:</p>
<ul><li>Forceful Browsing of Website Content</li><li>Automated Botnet Attacks</li><li>Manipulation of Query String Parameters</li><li>Reflected Cross-Site Scripting</li><li>Cross-Site Request Forgery (CSRF) Protection</li></ul>
<div>Excerpts of this blog post will discuss <strong><em>Recipe 1-2: Preventing Data Manipulation with Cryptographic Hash Tokens </em></strong>from my book &quot;<a href="http://www.amazon.com/Web-Application-Defenders-Cookbook-Protecting/dp/1118362187" target="_self">Web Application Defender's Cookbook: Battling Hackers and Protecting Users</a>&quot;.  </div>
<h3>Recipe 1-2: Preventing Data Manipulation With Cryptographic Hash Tokens</h3>
<p>This recipe will show you how to use ModSecurity to implement additional hash tokens to outbound html data in order to prevent data manipulation attacks.  At the time of writing this book, the capabilities outlined in this recipe are available in ModSecurity version 2.7.  Future versions may have different or extended functionality.</p>
<p><strong><span style="text-decoration-line: underline;">Ingredients</span></strong></p>
<ul><li>ModSecurity version 2.7.1 or higher</li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecDisableBackendCompression" target="_self">SecDisableBackendCompression Directive</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecContentInjection" target="_self">SecContentInjection Directive</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecStreamOutBodyInspection" target="_self">SecStreamOutBodyInspection Directive</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecHashEngine" target="_self">SecHashEngine Directive</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecHashKey" target="_self">SecHashKey Directive</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecHashParam" target="_self">SecHashParam Directive</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecHashMethodRx" target="_self">SecHashMethodRx Directive</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-ctl" target="_self">ctl:hashEnforcement Action</a></li></ul>
<h4>Background</h4>
<p>Web developers cannot rely upon web browser security mechanisms to prevent data manipulation.  With this being the case, how can we implement an external method of verifying that outbound data has not been manipulated when returned in a follow-up request?  One technique that can be used is to parse the outbound html response body data, calculate digest hashes for content and then inject additional token data into select locations.  The data that we are injecting are called request parameter validation tokens and are essentially cryptographic hashes of select html page elements.  The hashes enable us to detect if the client attempts to tamper with the data.  </p>
<h4>Example Configuration</h4>
<p>Here are some example ModSecurity directives and rules that implements basic hashing protections:</p>
<pre>SecDisableBackendCompression On<br>SecContentInjection On<br>SecStreamOutBodyInspection On<br>SecHashEngine On<br>SecHashKey rand <br>SecHashParam &quot;hmac&quot;<br>SecHashMethodrx &quot;HashHref&quot; &quot;\.(aspx?|php)&quot;<br>SecHashMethodrx &quot;HashFormAction&quot; &quot;\.(aspx?|php)&quot;<br>SecRule REQUEST_URI &quot;@validateHash \.(aspx?|php)&quot; &quot;phase:2,id:1000,t:none,block,msg:'Hash Validation Violation.',ctl:hashEnforcement=On,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-%{matched_var_name}=%{matched_var}&quot;</pre>
<p>The first directive called <em><strong>SecDiableBackendCompression</strong></em> is only needed in a reverse proxy setup and is used if the web application is compressing response data in the gzip format.  This is needed so that we can parse the response html data and modify it.  ModSecurity's default configuration is to only make copies of transactional data in memory and inspect them while buffering the real connection.  The next two directives are used together, however, to be able to modify and fully replace the original buffered response body with the new one.  The next four SecHash directives configure the basic settings.  In this configuration, ModSecurity will use a random encryption key as the hash salt value and will also use the REMOTE_ADDR of the client as an additional item in the hash calculation. It will then hash HTML  HREF and Form Action components that match the defined regular expression.  In this example, we are only applying these protections to web pages with .php, .asp and .aspx file extensions.  The final SecRule is used for validation and enforcement of the hash tokens. </p>
<h4>A Practical Example Walk-Through</h4>
<p>For our example web application, we will be using the public demo web application <a href="http://testphp.vulnweb.com/" target="_self">Acuart</a>.  When a client requests the main webpage through ModSecurity with the Hash token protections, this is what the debug log shows when processing the returned HTML data to the client:</p>
<pre>Starting phase RESPONSE_HEADERS.<br>This phase consists of 8 rule(s).<br>Content Injection: Nothing to inject.<br>Output filter: Bucket type TRANSIENT contains 1251 bytes.<br>Output filter: Receiving output (f 10a803d38, r 10a8020a0).<br>Output filter: Bucket type TRANSIENT contains 2845 bytes.<br>Output filter: Receiving output (f 10a803d38, r 10a8020a0).<br>Output filter: Bucket type EOS contains 0 bytes.<br>Output filter: Completed receiving response body (buffered full - 4096 bytes).<br>init_response_body_html_parser: assuming ISO-8859-1.<br>init_response_body_html_parser: Successfully html parser generated.<br><span style="background-color: #ffff00;"><strong>Signing data [privacy.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [AJAX/index.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [guestbook.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [userinfo.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [login.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [cart.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [artists.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [categories.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [AJAX/index.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [guestbook.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [cart.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [disclaimer.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [artists.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [categories.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [index.php]</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [search.php?test=query]</strong></span><br><span style="background-color: #ffff00;"><strong>hash_response_body_links: Processed [0] iframe src, [0] hashed.</strong></span><br><span style="background-color: #ffff00;"><strong>hash_response_body_links: Processed [0] frame src, [0] hashed.</strong></span><br><span style="background-color: #ffff00;"><strong>hash_response_body_links: Processed [1] form actions, [1] hashed.</strong></span><br><span style="background-color: #ffff00;"><strong>hash_response_body_links: Processed [23] links, [15] hashed.</strong></span><br>inject_hashed_response_body: Detected encoding type [ISO-8859-1].<br>inject_hashed_response_body: Using content-type [ISO-8859-1].<br>inject_hashed_response_body: Copying XML tree from CONV to stream buffer [4733] bytes.<br>inject_hashed_response_body: Setting new content value 4733<br>inject_hashed_response_body: Stream buffer [4733]. Done<br>Hash completed in 3215 usec.</pre>
<p>As you can see from this logging output, ModSecurity dynamically inserted hmac hashes for 15 HREF links and 1 Form action in the web page.  Here is how this appears to the user when they mouse over links in the web page:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/67dff2d7-917d-4f45-b54f-d64ee45e11ec.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 2.17.30 PM" border="0" class="asset  asset-image at-xid-6a00e551318e8a883301a3fca51923970b image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/96e2df86-f7aa-4d0e-9275-7df231ef0c7f.png?v=0.0.1" style="border: 2px solid #000000;" title="Screen Shot 2014-01-23 at 2.17.30 PM"></a></p>
<p>Notice the link now has a new &quot;hmac&quot; parameter value appended to the end.  When the client makes subsequent requests, ModSecurity will ensure the following:</p>
<ol><li><strong>HMAC Token Exists</strong> - the request includes an hmac parameter token value.  If the hmac token is missing, an attacker be attempting to bypass the protections by stripping out the token altogether.</li><li><strong>HMAC Token Mismatch</strong> - That the hmac value submitted in the requests matches the re-calculated server-side value within ModSecurity when it analyzes the live HTTP request data. </li></ol>
<p>If either of these scenarios happen, then ModSecurity will generate alerts.  Let's look at the real-world attack scenarios listed at the beginning of the blog post to see how this works.</p>
<h3>Forceful Browsing Attacks</h3>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/8425e386-8c83-4fe1-b421-569e493e1c91.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 2.34.10 PM" border="0" class="asset  asset-image at-xid-6a00e551318e8a883301a3fca519e2970b image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/a9e71a17-bf07-4707-b02f-1972bfe65cdb.png?v=0.0.1" style="border: 2px solid #000000;" title="Screen Shot 2014-01-23 at 2.34.10 PM"></a></p>
<p>In the Acuart demo website, there is a Forceful Browsing attack/vulnerability with the &quot;showimage.php&quot; resource.  Under normal circumstances, this is how the resources is accessed:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/d64b7c3a-e736-471f-8018-1dd5f0d31c52.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 2.37.13 PM" border="0" class="asset  asset-image at-xid-6a00e551318e8a883301a73d6034fb970d image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/39243a9c-97e8-4c39-8d39-add7ad6e55b8.png?v=0.0.1" style="border: 2px solid #000000;" title="Screen Shot 2014-01-23 at 2.37.13 PM"></a></p>
<p>The resource has one parameter called &quot;file&quot; and it is supposed to be used to access image files.  The attacker, however, is able to change the data in the &quot;file&quot; parameter to access other files such as the Database Connection config file:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/2d42c14a-8f99-4df3-8718-eefeb6fd3a95.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 2.44.11 PM" border="0" class="asset  asset-image at-xid-6a00e551318e8a883301a3fca51a96970b image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/7af7badc-4e12-46c5-8d08-4b6ddce763ac.png?v=0.0.1" style="border: 2px solid #000000;" title="Screen Shot 2014-01-23 at 2.44.11 PM"></a></p>
<p>If an attacker attempts to send that specific request, ModSecurity will generate the following event:</p>
<pre>Rule 10094a408: SecRule &quot;REQUEST_URI&quot; &quot;@validateHash \\.(aspx?|php)&quot; &quot;phase:2,log,tag:%{request_headers.host},id:1000,t:none,block,msg:'Hash Validation Violation.',ctl:hashEnforcement=On,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.msg=%{rule.msg},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-%{matched_var_name}=%{matched_var}&quot;<br>Transformation completed in 1 usec.<br><span style="background-color: #ffff00;"><strong>Executing operator &quot;validateHash&quot; with param &quot;\\.(aspx?|php)&quot; against REQUEST_URI.</strong></span><br><span style="background-color: #ffff00;"><strong>Target value: &quot;/showimage.php?file=./database_connect.php&quot;</strong></span><br><span style="background-color: #ffff00;"><strong>Request URI without hash parameter [/showimage.php?file=./database_connect.php]</strong></span><br>Operator completed in 83 usec.<br>Ctl: Set HashEnforcement to On.<br>Setting variable: tx.anomaly_score=+%{tx.critical_anomaly_score}<br>Recorded original collection variable: tx.anomaly_score = &quot;0&quot;<br>Resolved macro %{tx.critical_anomaly_score} to: 5<br>Relative change: anomaly_score=0+5<br>Set variable &quot;tx.anomaly_score&quot; to &quot;5&quot;.<br>Setting variable: tx.msg=%{rule.msg}<br>Resolved macro %{rule.msg} to: Hash Validation Violation.<br>Set variable &quot;tx.msg&quot; to &quot;Hash Validation Violation.&quot;.<br>Setting variable: tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-%{matched_var_name}=%{matched_var}<br>Resolved macro %{rule.id} to: 1000<br>Resolved macro %{matched_var_name} to: REQUEST_URI<br>Resolved macro %{matched_var} to: /showimage.php?file=./database_connect.php<br>Set variable &quot;tx.1000-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-REQUEST_URI&quot; to &quot;/showimage.php?file=./database_connect.php&quot;.<br>Resolved macro %{request_headers.host} to: testphp.vulnweb.com<br><span style="background-color: #ffff00;"><strong>Warning. Request URI matched &quot;\\.(aspx?|php)&quot; at REQUEST_URI. No Hash parameter</strong></span> [file &quot;/usr/local/apache/conf/crs/base_rules/REQUEST-00.conf&quot;] [line &quot;10&quot;] [id &quot;1000&quot;] [msg &quot;Hash Validation Violation.&quot;] [tag &quot;testphp.vulnweb.com&quot;]</pre>
<p>The attacker attempted to to simply remove the hmac token parameter altogether and this is a violation.  In the event that the attacker includes an hmac token, it would generate the following event data:</p>
<pre>Rule 10094a438: SecRule &quot;REQUEST_URI&quot; &quot;@validateHash \\.(aspx?|php)&quot; &quot;phase:2,log,tag:%{request_headers.host},id:1000,t:none,block,msg:'Hash Validation Violation.',ctl:hashEnforcement=On,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.msg=%{rule.msg},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-%{matched_var_name}=%{matched_var}&quot;<br>Transformation completed in 0 usec.<br><span style="background-color: #ffff00;"><strong>Executing operator &quot;validateHash&quot; with param &quot;\\.(aspx?|php)&quot; against REQUEST_URI.</strong></span><br><span style="background-color: #ffff00;"><strong>Target value: &quot;/showimage.php?file=./database_connect.php&amp;hmac=c7857949531753f07f692db8cb446d6233ed5a5d&quot;</strong></span><br><span style="background-color: #ffff00;"><strong>Validating URI /showimage.php?file=./database_connect.php size 42</strong></span><br><span style="background-color: #ffff00;"><strong>Signing data [showimage.php?file=./database_connect.php]</strong></span><br>Operator completed in 160 usec.<br>Ctl: Set HashEnforcement to On.<br>Setting variable: tx.anomaly_score=+%{tx.critical_anomaly_score}<br>Recorded original collection variable: tx.anomaly_score = &quot;0&quot;<br>Resolved macro %{tx.critical_anomaly_score} to: 5<br>Relative change: anomaly_score=0+5<br>Set variable &quot;tx.anomaly_score&quot; to &quot;5&quot;.<br>Setting variable: tx.msg=%{rule.msg}<br>Resolved macro %{rule.msg} to: Hash Validation Violation.<br>Set variable &quot;tx.msg&quot; to &quot;Hash Validation Violation.&quot;.<br>Setting variable: tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-%{matched_var_name}=%{matched_var}<br>Resolved macro %{rule.id} to: 1000<br>Resolved macro %{matched_var_name} to: REQUEST_URI<br>Resolved macro %{matched_var} to: /showimage.php?file=./database_connect.php&amp;hmac=c7857949531753f07f692db8cb446d6233ed5a5d<br>Set variable &quot;tx.1000-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-REQUEST_URI&quot; to &quot;/showimage.php?file=./database_connect.php&amp;hmac=c7857949531753f07f692db8cb446d6233ed5a5d&quot;.<br>Resolved macro %{request_headers.host} to: testphp.vulnweb.com<br><span style="background-color: #ffff00;"><strong>Warning. Request URI matched &quot;\\.(aspx?|php)&quot; at REQUEST_URI. Hash parameter hash value = [c7857949531753f07f692db8cb446d6233ed5a5d] Requested URI hash value = [6c1ee35d09112aba381a4aae49eed9620585f2b2]</strong></span> [file &quot;/usr/local/apache/conf/crs/base_rules/REQUEST-00.conf&quot;] [line &quot;10&quot;] [id &quot;1000&quot;] [msg &quot;Hash Validation Violation.&quot;] [tag &quot;testphp.vulnweb.com&quot;]</pre>
<p>This event shows that ModSecurity identified a mismatch between the hmac token hash submitted vs. the one that it calculates based on the actual request data.  </p>
<h4>Forceful Browsing Using Automation</h4>
<p>If an attacker tries to use tools to automate the enumeration of resources on the site, this activity can also be blocked.  For example, if an attacker tries to use a tool such as the <a href="https://code.google.com/p/zaproxy/" target="_self">OWASP Zed Attack Proxy's (ZAP)</a><a href="https://code.google.com/p/zaproxy/wiki/HelpUiTabsBruteforce" target="_self">&quot;Forced Browse&quot; Plugin</a>, these requests will be denied as the tool is not following URL links that the web application provided to the end user and are thus missing hmac tokens.  Here is an example screenshot of ZAP's Forced Browse session where the requests were blocked by ModSecurity's Hash Token engine:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/0085176f-42d5-4096-a9f4-0bdd75a5226e.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 4.52.55 PM" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a511529078970c image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/0229c83f-bd6d-4bc9-86bc-abef5af87711.png?v=0.0.1" title="Screen Shot 2014-01-23 at 4.52.55 PM"></a></p>
<h3>Automated Botnet Attacks</h3>
<p>In a <a href="http://blog.spiderlabs.com/2013/03/the-life-cycle-of-web-server-botnet-recruitment.html" target="_self">previous blog post</a>, I outlined the typical Botnet recuitement lifecycle:</p>
<p><a href="http://a4.typepad.com/6a00e551318e8a883301a73d607e34970d-pi"><img alt="6a0133f264aa62970b017c375c802c970b" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/b5bf4080-a948-4d05-9868-b0ce0f0aee1e.png?v=0.0.1" title="6a0133f264aa62970b017c375c802c970b"></a></p>
<p>In Step2 2, the Botnet client conducts Search Engine queries to try and identify websites that might be vulnerable to specific, widespread vulnerabilities.  Based on those results, the Botnet client will then send pre-crafted attack payloads to the target website.  Here is an example of some attack code functions found within a typical perl-based IRC Botnet client that send PHP code injection payloads:</p>
<p><a href="http://blog.spiderlabs.com/.a/6a0133f264aa62970b01a73d608450970d-pi"><img alt="Screen Shot 2014-01-24 at 12.18.36 PM" border="0" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/dae7f4d3-66d9-4473-ac18-2e45f6f17f32.png?v=0.0.1" title="Screen Shot 2014-01-24 at 12.18.36 PM"></a></p>
<p>The highlighted sections of code show that the Botnet client is sending these attack payloads directly to the URL returned from the Search Enginer results for a target site.  If a Botnet client blindly sends attacks at URLs they will blocked by the ModSecurity Hash Token protections due to missing hmac tokens.  </p>
<h3>Query String Injection Attacks</h3>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/b5f2d03e-328e-4bd0-8c18-0198062340bc.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 5.10.18 PM" border="0" class="asset  asset-image at-xid-6a00e551318e8a883301a3fca51c9c970b image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/aa149a8e-ffee-402e-b74b-26321556a86d.png?v=0.0.1" style="border: 2px solid #000000;" title="Screen Shot 2014-01-23 at 5.10.18 PM"></a></p>
<h4>SQLi in Query String Parameter</h4>
<p>The Acuart &quot;artists.php&quot; resource has an SQL Injection vulnerability.  The following screenshot shows an SQLi attack in the &quot;artists&quot; parameter that successfully enumerates the DB user:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/38e9211e-e8e0-4f9f-aac0-d857e54ae561.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 5.08.13 PM" border="0" class="asset  asset-image at-xid-6a00e551318e8a883301a73d6037b3970d image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/f09778cf-4662-41bc-9989-e4c7ad9f6ef7.png?v=0.0.1" style="border: 2px solid #000000;" title="Screen Shot 2014-01-23 at 5.08.13 PM"></a></p>
<p>This is how the normal HREF link to this page looks in the HTML:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/5d171ce5-b12c-454b-ae59-492deb9b8958.png" style="display: inline;"><img alt="Screen Shot 2014-01-24 at 9.30.55 AM" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a3fca51f0d970b image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/97822fc4-2c1b-42d1-8194-0023b99a210d.png?v=0.0.1" title="Screen Shot 2014-01-24 at 9.30.55 AM"></a></p>
<p>As you can see, the HREF link already includes the parameter &quot;artists=1&quot; data.  When the user clicks on the link, it sends that parameter to the web app.  In this case, that parameter is used, insecurely, within a back-end SQL query.  With the ModSecurity HMAC token protection in place, however, that same HTML now looks like this:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/fc72935f-ba38-4f7c-a619-97c6f68487bd.png" style="display: inline;"><img alt="Screenshot" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a511548cd6970c image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/34a1c387-df1a-4c35-9068-2794f77d2f76.png?v=0.0.1" title="Screenshot"></a></p>
<p>If an attacker tries to tamper with the artists data and send this same SQLi request through ModSecurity with the hmac token protections, it will be blocked.  This event will be generated if they do not supply an hmac token:</p>
<pre>[Thu Jan 23 17:07:04.692542 2014] [:error] [pid 38405:tid 4453466112] [client 127.0.0.1] <span style="background-color: #ffff00;"><strong>ModSecurity: Access denied with code 403 (phase 2). Request URI matched &quot;\\\\.(aspx?|php)&quot; at REQUEST_URI. No Hash parameter</strong></span>[file &quot;/usr/local/apache/conf/crs/base_rules/REQUEST-00.conf&quot;] [line &quot;10&quot;] [id &quot;1000&quot;] [msg &quot;Hash Validation Violation.&quot;] [tag &quot;testphp.vulnweb.com&quot;] [hostname &quot;testphp.vulnweb.com&quot;] [uri &quot;http://testphp.vulnweb.com/artists.php?artist=0+div+1+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1%2C2%2Ccurrent_user&quot;] [unique_id &quot;UuGSh8CoAWcAAJYF7zQAAADT&quot;]</pre>
<p>This is an event if they have an hmac but try and inject the SQLi payload into the &quot;artists&quot; parameter value:</p>
<pre>[Thu Jan 23 17:14:53.335440 2014] [:error] [pid 38405:tid 4447563776] [client 127.0.0.1] <span style="background-color: #ffff00;"><strong>ModSecurity: Access denied with code 403 (phase 2). Request URI matched &quot;\\\\.(aspx?|php)&quot; at REQUEST_URI. Hash parameter hash value = [a5e6d5e6653b8cefa4681ed86fd6f4ef71701d45] Requested URI hash value = [663886560b52de38ca40323c27c2ebd6545474cf]</strong></span> [file &quot;/usr/local/apache/conf/crs/base_rules/REQUEST-00.conf&quot;] [line &quot;10&quot;] [id &quot;1000&quot;] [msg &quot;Hash Validation Violation.&quot;] [tag &quot;testphp.vulnweb.com&quot;] [hostname &quot;testphp.vulnweb.com&quot;] [uri &quot;http://testphp.vulnweb.com/artists.php?artist=+div+0+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1%2C2%2Ccurrent_user&amp;hmac=a5e6d5e6653b8cefa4681ed86fd6f4ef71701d45&quot;] [unique_id &quot;UuGUXMCoAWcAAJYF7zgAAADI&quot;]</pre>
<p>It is important to note that this defense is aimed at <em><strong>reducing the attack surface</strong></em> of pre-populated query_string parameter data and won't protect against all injection point vectors (such as those sent in POST payload parameter fields).</p>
<h4>Cross-Site Scripting (XSS)</h4>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/6b74552f-0f0d-4f5d-9e4c-b52afffb2642.png" style="display: inline;"><img alt="Screen Shot 2014-01-23 at 5.47.43 PM" border="0" class="asset  asset-image at-xid-6a00e551318e8a883301a3fca52319970b image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/6f554d4d-bbe7-4369-b420-02035249e2c4.png?v=0.0.1" style="border: 2px solid #000000;" title="Screen Shot 2014-01-23 at 5.47.43 PM"></a></p>
<p>The Acuart demo app has a number of XSS flaws including one in the &quot;searchFor&quot; parameter of the &quot;search.php&quot; page:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/1fc807df-be1b-4b13-9abc-8206a1af08a7.png" style="display: inline;"><img alt="Screen Shot 2014-01-24 at 10.30.29 AM" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a51154a3ec970c image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/20af48b6-2584-470e-85fb-6bb4f26984d5.png?v=0.0.1" title="Screen Shot 2014-01-24 at 10.30.29 AM"></a></p>
<p>When an attacker (or victim) sends a request such as this to the search page, the data is refected back within the response executes the JS code:</p>
<p><a class="asset-img-link" href="/images/FFFFFF-0.png" style="display: inline;"><img alt="Screen Shot 2014-01-24 at 10.31.00 AM" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a3fca53900970b image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/694cbf32-18d8-49a2-b0c6-7789c50485eb.png?v=0.0.1" title="Screen Shot 2014-01-24 at 10.31.00 AM"></a></p>
<p>Since this XSS vector occurs over a POST request, an attacker could create the following HTML code on a different site/page to auto-submit this data:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/e0da35a7-8d0a-44c9-9a11-e8d710c564bf.png" style="display: inline;"><img alt="Screen Shot 2014-01-24 at 10.47.07 AM" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a51154ab80970c image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/4d4af09a-5e9f-4630-801d-58b02637b05e.png?v=0.0.1" title="Screen Shot 2014-01-24 at 10.47.07 AM"></a></p>
<p><strong>How can the ModSecurity HMAC Token mechanism protect against this attack vector?</strong></p>
<p>Notice the HTML Form &quot;action&quot; data highlighted in red?  This is the location where the form will POST data to.  <em><strong>This is important.</strong></em>  One of the key requirements of this attack is that the target URL must be idempotent.  This means that the attacker must know what URL location to use ahead of time to send the XSS payload to.  This is where the Hash Token defense comes into play.  </p>
<h3>Non-Idempotent (Unique) URLs</h3>
<p>When the <strong><code>SecHashMethodrx &quot;HashFormAction&quot; &quot;\.(aspx?|php)&quot;</code></strong> directive is used, the search Form action data is updated to include the hmac token:</p>
<p><a class="asset-img-link" href="/images/slblog-03-02-2018-10-57-10/spiderlabs/071d2dd1-45b5-4a38-a48c-ac85518815f1.png" style="display: inline;"><img alt="Screen Shot 2014-01-24 at 10.53.26 AM" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01a51154ae60970c image-full img-responsive" src="/images/slblog-03-02-2018-10-57-10/spiderlabs/8db97a42-f2d2-43a2-bf65-cba44a899c2b.png?v=0.0.1" title="Screen Shot 2014-01-24 at 10.53.26 AM"></a></p>
<p> In order to defeat these types of Reflected XSS attacks, we can modify our SecHashKey directive settings to include additional data such as the client's IP Address or the current applicaton SessionID data: <strong><code>SecHashKey rand SessionID</code></strong>.</p>
<pre>SecDisableBackendCompression On<br>SecContentInjection On<br>SecStreamOutBodyInspection On<br>SecHashEngine On<br><span style="background-color: #ffff00;"><strong>SecHashKey rand SessionID</strong></span><br>SecHashParam &quot;hmac&quot;<br>SecHashMethodrx &quot;HashHref&quot; &quot;\.(aspx?|php)&quot;<br>SecHashMethodrx &quot;HashFormAction&quot; &quot;\.(aspx?|php)&quot;<br>SecRule REQUEST_URI &quot;@validateHash \.(aspx?|php)&quot; &quot;phase:2,id:1000,t:none,block,msg:'Hash Validation Violation.',ctl:hashEnforcement=On,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/PARAM_MANIPULATION-%{matched_var_name}=%{matched_var}&quot;</pre>
<p>With this updated configurtion - <em><strong>every hmac is unique for each user/session</strong></em>.  Here is how the updated debug log processing looks:</p>
<pre>Starting phase RESPONSE_HEADERS.<br>This phase consists of 8 rule(s).<br>Content Injection: Nothing to inject.<br>Output filter: Bucket type TRANSIENT contains 1251 bytes.<br>Output filter: Receiving output (f 10a803d38, r 10a8020a0).<br>Output filter: Bucket type TRANSIENT contains 2845 bytes.<br>Output filter: Receiving output (f 10a803d38, r 10a8020a0).<br>Output filter: Bucket type EOS contains 0 bytes.<br>Output filter: Completed receiving response body (buffered full - 4096 bytes).<br>init_response_body_html_parser: assuming ISO-8859-1.<br>init_response_body_html_parser: Successfully html parser generated.<br>Signing data [privacy.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [AJAX/index.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [guestbook.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [userinfo.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [login.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [cart.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [artists.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [categories.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [AJAX/index.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [guestbook.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [cart.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [disclaimer.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [artists.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [categories.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [index.php]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>Signing data [search.php?test=query]<br><strong>Using session id [wecm5b45fsznvm552hzoz3bl]</strong><br>hash_response_body_links: Processed [0] iframe src, [0] hashed.<br>hash_response_body_links: Processed [0] frame src, [0] hashed.<br>hash_response_body_links: Processed [1] form actions, [1] hashed.<br>hash_response_body_links: Processed [23] links, [15] hashed.<br>inject_hashed_response_body: Detected encoding type [ISO-8859-1].<br>inject_hashed_response_body: Using content-type [ISO-8859-1].<br>inject_hashed_response_body: Copying XML tree from CONV to stream buffer [4733] bytes.<br>inject_hashed_response_body: Setting new content value 4733<br>inject_hashed_response_body: Stream buffer [4733]. Done<br>Hash completed in 3215 usec. </pre>
<p>In essence, what this means is that an attacker can no longer copy/paste attack code including an hmac token and force another user to use it.  This means that this defense can also help to prevent Cross-Site Request Forgery (CSRF) attacks as the hmac tokens function similarly to anti-CSRF tokens.</p>
<h3>Conclusion</h3>
<p>Hopefully this blog post has demonstrated the power provided by the HMAC Token protections in ModSecurity WAF.  By deploying these configurations, you can significantly reduce your attack surface for a number of issues.  If you have any feedback or questions, please contact the <a href="http://www.modsecurity.org/contact/" target="_self">ModSecurity Project Team</a>.</p>
                                </div>
                            </div>

                        </div>
                    </article>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section bg-brand-secondary angle-bottom angle-bottom-gray-lighter angle-top angle-top-gray-lightest">
    <div class="angle-top-placeholder"></div>
    <div class="angle-bottom-placeholder"></div>



<div class="container">

        <h2 class="text-center text-white">Recent SpiderLabs Blog Posts</h2>
    <ul class="slick-filter nav nav-tabs">

    </ul>
    <div class="row card-list card-list-slick-resources slick-uninitialized" data-slick='{"autoplay":false}'>
                    <div class="col-sm-6 col-md-4 col-lg-3 card-list-item blogs" data-tags="blogs">
            <div class="card">
                        <div class="card-media">
                            <a href="/en-us/resources/blogs/spiderlabs-blog/evasive-urls-in-spam/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="EvasiveURLsinSpam" data-ga-value="1">
                                <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15279/sl-blog-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897042940000000);"></span>
                            </a>
                        </div>
                <div class="card-body card-body-overflow" style="height: 160px;">
                        <p class="mbx">Sep 17, 2020</p>
                    <h4 class="mbn"><a href="/en-us/resources/blogs/spiderlabs-blog/evasive-urls-in-spam/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="EvasiveURLsinSpam" data-ga-value="1">Evasive URLs in Spam</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">SpiderLabs Blog</span></div>
            </div>

                    </div>
                    <div class="col-sm-6 col-md-4 col-lg-3 card-list-item blogs" data-tags="blogs">
            <div class="card">
                        <div class="card-media">
                            <a href="/en-us/resources/blogs/spiderlabs-blog/hijacking-a-domain-controller-with-netlogon-rpc-aka-zerologon-cve-2020-1472/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="HijackingaDomainControllerwithNetlogonRPCakaZerologonCVE" data-ga-value="1">
                                <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15279/sl-blog-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897042940000000);"></span>
                            </a>
                        </div>
                <div class="card-body card-body-overflow" style="height: 160px;">
                        <p class="mbx">Sep 17, 2020</p>
                    <h4 class="mbn"><a href="/en-us/resources/blogs/spiderlabs-blog/hijacking-a-domain-controller-with-netlogon-rpc-aka-zerologon-cve-2020-1472/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="HijackingaDomainControllerwithNetlogonRPCakaZerologonCVE" data-ga-value="1">Hijacking a Domain Controller with Netlogon RPC (aka Zerologon: CVE-2020-1472)</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">SpiderLabs Blog</span></div>
            </div>

                    </div>
                    <div class="col-sm-6 col-md-4 col-lg-3 card-list-item blogs" data-tags="blogs">
            <div class="card">
                        <div class="card-media">
                            <a href="/en-us/resources/blogs/spiderlabs-blog/modsecurity-regular-expressions-and-disputed-cve-2020-15598/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="ModSecurityRegularExpressionsandDisputedCVE" data-ga-value="1">
                                <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15279/sl-blog-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897042940000000);"></span>
                            </a>
                        </div>
                <div class="card-body card-body-overflow" style="height: 160px;">
                        <p class="mbx">Sep 14, 2020</p>
                    <h4 class="mbn"><a href="/en-us/resources/blogs/spiderlabs-blog/modsecurity-regular-expressions-and-disputed-cve-2020-15598/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="ModSecurityRegularExpressionsandDisputedCVE" data-ga-value="1">ModSecurity, Regular Expressions and Disputed CVE-2020-15598</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">SpiderLabs Blog</span></div>
            </div>

                    </div>

    </div>
</div>

</section>

    </main>


<footer class="site-footer">
    <section class="section bg-primary bg-gradient-horizontal section-padding-bottom-none angle-top angle-top-gray-lighter">
        <div class="angle-top-placeholder"></div>
        <div class="angle-bottom-placeholder"></div>


        <div class="container">
            <div class="row">
                <div class="col-sm-7 col-md-8 col-lg-9">
                    <span class="site-footer-brand">
                        <img src="/img/logo/logo-trustwave-white.svg" alt="Trustwave" class="footer-logo">
                    </span>
                </div>
                <div class="col-xs-10 col-sm-5 col-md-4 col-lg-3 mbs">
                    <ul class="social-icons">
                        <li><a href="https://www.linkedin.com/company/trustwave" target="_blank"><img src="/img/icon/social/svg/light/linkedin.svg" alt="LinkedIn"></a></li>
                        <li><a href="https://twitter.com/Trustwave" target="_blank"><img src="/img/icon/social/svg/light/twitter.svg" alt="Twitter"></a></li>
                        <li><a href="https://www.facebook.com/Trustwave/" target="_blank"><img src="/img/icon/social/svg/light/facebook.svg" alt="Facebook"></a></li>
                        <li><a href="https://www.youtube.com/channel/UC2CCqdrAxD9-Fv83NOdjhqA" target="_blank"><img src="/img/icon/social/svg/light/youtube.svg" alt="YouTube"></a></li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8 mbm">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="row">
                                <div class="col-xs-6">
                                    <h5 class="mbx">
                                        <a href="/en-us/services/">Services</a>
                                    </h5>
                                    <ul class="list-unstyled">
                                        <li><a href="/en-us/services/managed-security/">Managed Security</a></li>
                                        <li><a href="/en-us/services/security-testing/">Security Testing</a></li>
                                        <li><a href="/en-us/services/technology/">Technology</a></li>
                                        <li><a href="/en-us/services/consulting/">Consulting</a></li>
                                        <li><a href="/en-us/services/education/">Education</a></li>
                                    </ul>
                                </div>
                                <div class="col-xs-6">
                                    <h5 class="mbx">
                                        <a href="/en-us/capabilities/">Capabilities</a>
                                    </h5>
                                    <ul class="list-unstyled">
                                        <li><a href="/en-us/capabilities/by-topic/">By Topic</a></li>
                                        <li><a href="/en-us/capabilities/by-industry/">By Industry</a></li>
                                        <li><a href="/en-us/capabilities/by-mandate/">By Mandate</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="row">
                                <div class="col-xs-6">
                                    <h5 class="mbx">
                                        <a href="/en-us/resources/">Resources</a>
                                    </h5>
                                    <ul class="list-unstyled">
                                        <li><a href="/en-us/resources/blogs/">Blogs &amp; Stories</a></li>
                                        <li><a href="/en-us/resources/library/">Resource Library</a></li>
                                        <li><a href="/en-us/resources/security-resources/">Security Resources</a></li>
                                        <li><a href="/en-us/resources/upcoming/">Events &amp; Webinars</a></li>
                                    </ul>
                                </div>
                                <div class="col-xs-6">
                                    <h5 class="mbx">
                                        <a href="/en-us/company/">Company</a>
                                    </h5>
                                    <ul class="list-unstyled">
                                        <li><a href="/en-us/company/about-us/">About Trustwave</a></li>
                                        <li><a href="https://jobs.jobvite.com/trustwave" target="_blank">Careers</a></li>
                                        <li><a href="/en-us/company/newsroom/">Newsroom</a></li>
                                        <li><a href="/en-us/company/contact/">Contact</a></li>
                                        <li><a href="/en-us/company/support/">Support</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-sm-9 col-md-4">
                    <h5 class="text-white mbx">Stay Informed</h5>
                    <p class="text-white">
                        Sign up to receive the latest security news
                        and trends from Trustwave.
                    </p>
                    <form method="get" target="_blank" action="https://www2.trustwave.com/Subscription-Center-Subscribe.html">
                        <div class="form-group">
                            <div class="input-group">
                                <input type="text" class="form-control" name="Email" placeholder="email@example.com" style="
                                background-color: rgba(0, 0, 0, 0.15);
                                /* -webkit-border-radius: 50%; */
                                border-radius: 25px;
                                border: 0 none;
                                border-top-right-radius: 0;
                                border-bottom-right-radius: 0;
">
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="submit" style="border-top-right-radius: 25px;border-bottom-right-radius: 25px;">
                                        Subscribe
                                    </button>
                                </span>
                            </div><!-- /input-group -->
                            <p class="text-white text-sm mts">No spam, unsubscribe at any time.</p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="site-footer-base">
            <div class="container">
                <div class="row">
                    <div class="col-md-9">
                        <ul class="site-footer-legal">
                            <li><a href="/en-us/legal-documents/">Legal</a></li>
                            <li><a href="/en-us/legal-documents/terms-of-use/">Terms of Use</a></li>
                            <li><a href="/en-us/legal-documents/privacy-policy/">Privacy Policy</a></li>
                        </ul>


<div class="site-footer-language">
    <div class="site-language-select">
        <select id="LangSelector">
            <option data-loc="/en-us/" data-lang="en-us" value="en-us">English</option>
            <option data-loc="/de-de/" data-lang="de-de" value="de-de">German (Deutsche)</option>
            <option data-loc="/ja-jp/" data-lang="ja=jp" value="ja-jp">Japanese (æ¥æ¬èª)</option>
        </select>
    </div>
</div>

                        <div class="site-footer-copyright">
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear())</script> Trustwave Holdings, Inc. <br class="visible-xs">All rights reserved.
                        </div>
                    </div>
                    <div class="col-md-3">

                    </div>
                </div>

            </div>
        </div>
    </section>
</footer>

<!-- Trustwave Modal and Loading Divs -->
<div class="loading" style="display: none;">Loading</div>

<div class="modal" id="modal"></div>

<div class="modal mktomodal card card-lightbox mfp-hide">
    
    <div class="card-body">


        <div class="botchallenge" style="display: none;">
            <h2 class="text-center">Help Us Stop the Robot Uprising</h2>

            <p class="text-center text-xl mbx">This is a bot-free zone. Please check the box to let us know you&#39;re human.</p>

            <div class="captcha-box">

            </div>
        </div>



        <div class="successdoc" style="display: none;">
            <h2 class="text-center">Thank You</h2>

            <p class="text-center">
                <a target="_blank" href="#" class="dllinkdoc btn btn-primary mtl" rel="nofollow">Download Now</a>
            </p>
            <hr class="hr-bar">

            <p class="text-center text-lg">Read complimentary reports and insightful stories in the <br><a href="/en-us/resources/">Trustwave Resource Center</a></p>
        </div>



        <div class="success" style="display: none;">
            <h2 class="text-center">Thank You</h2>

            <p class="text-center text-xl mbx">One of our sales specialists will be in touch shortly.</p>

            <hr class="hr-bar">

            <p class="text-center text-lg">Read complimentary reports and insightful stories in the <br><a href="/en-us/resources/">Trustwave Resource Center</a></p>
        </div>
        <form></form>
    </div>
    
</div>

<!-- Javascripts -->
    <script src="https://player.vimeo.com/api/player.js"></script>
        <script src="/dist/js/scripts.min.js?v=v34sa"></script>
        <script src="//www.atmrum.net/rum.js"></script>
        <script>rum.start("602cc9bb0a513db2b327299487211347");</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5286e9523a723348"></script>
    <script type="text/javascript" async="" src="//munchkin.marketo.net/154/munchkin.js"></script>
    <script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https://www.trustwave.com/",
        "potentialAction": {
        "@type": "SearchAction",
        "target": "https://www.trustwave.com/en-us/search/?q={search_term_string}",
        "query-input": "required name=search_term_string"
        }
        }

        {
        "@context": "http://schema.org",
        "@type": "Organization",
        "url": "https://www.trustwave.com/",
        "logo": "https://www.trustwave.com/img/logo/TW-logo-color.png"
        }
    </script>

            <script src="https://cookie-cdn.cookiepro.com/langswitch/5142c8f1-532c-427b-a545-0bcfe1f6f4ea.js" type="text/javascript" charset="UTF-8"></script>
            <script type="text/javascript">
                function OptanonWrapper() { }
            </script>

</body>
</html>