<!DOCTYPE html><html lang="en"><head>
  <!-- OneTrust Cookies Consent Notice start -->
  <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="301196e0-93ad-473e-a572-975514574496"></script>
  <script type="text/javascript">
  function OptanonWrapper() { }
  </script>
  <!-- OneTrust Cookies Consent Notice end -->
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KF7XWD');</script>
  <!-- End Google Tag Manager -->
  <meta charset="utf-8">
  <title>Duqu 2.0: Reemergence of an aggressive cyberespionage threat | Symantec Blogs</title>
  <base href="/blogs/">  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="QpS_7p7oPyNjksYmiXtMfTJDLRKiviv1FJaQOUGPnt0">
  <meta name="google-site-verification" content="Phaks0EaD7hDs8gJnbzabqgvae8ar_dbX2uUTiqhB2Y">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="assets/favicon/site.webmanifest">
  <link rel="mask-icon" href="assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#cd2031">
  <meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="styles.cd3528d4d93891573cb5.css"><style ng-transition="symantec-blogs">[_nghost-sc0]{display:block}</style><style ng-transition="symantec-blogs"></style><style ng-transition="symantec-blogs">.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-background{display:none}}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:'';display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2s infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2s infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after{animation:none;transition:none}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.70173,.49582);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.30244,.38135,.55,.95635);transform:translateX(83.67142%)}100%{transform:translateX(200.61106%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(.08)}36.65%{animation-timing-function:cubic-bezier(.33473,.12482,.78584,1);transform:scaleX(.08)}69.15%{animation-timing-function:cubic-bezier(.06,.11,.6,1);transform:scaleX(.66148)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:translateX(37.65191%)}48.35%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:translateX(84.38617%)}100%{transform:translateX(160.27778%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:scaleX(.08)}19.15%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:scaleX(.4571)}44.15%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:scaleX(.72796)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}</style><link title="Symantec Blogs" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Threat Intelligence" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/221" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Feature Stories" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/211" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Expert Perspectives" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/251" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Product Insights" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/231" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Election Security" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/4841" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Korean" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11321" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - America Latina" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/10401" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - PortuguÃªs" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/10411" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Japanese" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11291" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Chinese, Simplified" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11301" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Chinese, Traditional" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11311" rel="alternate" type="application/rss+xml"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@symantec"><meta name="twitter:creator" content="@symantec"><meta name="twitter:title" content="Duqu 2.0: Reemergence of an aggressive cyberespionage threat"><meta name="twitter:description" content="Malware used in a number of attack campaigns against a European telecoms operator, a North African telecoms operator, and a South East Asian electronic equipment manufacturer. "><meta name="twitter:domain" content="symantec.com"><meta property="og:type" content="article"><meta property="og:url" content=""><meta property="og:title" content="Duqu 2.0: Reemergence of an aggressive cyberespionage threat"><meta property="og:description" content="Malware used in a number of attack campaigns against a European telecoms operator, a North African telecoms operator, and a South East Asian electronic equipment manufacturer. "><meta name="twitter:image" content="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/social_media_meta/public/2020-06/8.jpg?h=62bc044e&amp;itok=yUWhaOR2"><meta property="og:image" content="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/social_media_meta/public/2020-06/8.jpg?h=62bc044e&amp;itok=yUWhaOR2"><style ng-transition="symantec-blogs">[_nghost-sc1]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc11]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc9]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc20]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc29]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc10]{display:block}</style></head>
<body>
  <app-root ng-version="8.2.14"><app-loader _nghost-sc0=""><!----></app-loader><div><header class="header" role="banner"><div class="header-primary"><a class="header-link" rel="home" routerlink="/" title="Symantec Blogs" href="/blogs/"><img alt="Broadcom" class="header-logo" src="assets/logo.svg"><span class="header-text">Symantec Enterprise Blogs</span></a><!----><div class="header-breadcrumb"><app-breadcrumbs _nghost-sc1=""><!----><ul _ngcontent-sc1="" class="header-breadcrumb__list"><!----><li _ngcontent-sc1="" class="header-breadcrumb__item"><!----><a _ngcontent-sc1="" class="header-breadcrumb__link" href="/blogs/threat-intelligence">Threat Intelligence</a><!----></li></ul></app-breadcrumbs></div><div class="header-navigation"><button aria-hidden="true" class="nav-toggle"><span><em>Menu</em></span></button><a class="search-icon" routerlink="/search" href="/blogs/search"><i class="fa fa-search"></i></a><app-blogs-menu _nghost-sc2=""><nav _ngcontent-sc2="" aria-labelledby="primary-menu" class="nav-menu" role="navigation"><div _ngcontent-sc2="" class="inner"><header _ngcontent-sc2=""><h2 _ngcontent-sc2="">Main menu</h2></header><ul _ngcontent-sc2="" class="nav-menu__list"><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/" href="/blogs/"><i _ngcontent-sc2="" class="fa fa-home"></i>Blogs Home</a></li><!----><!----><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/threat-intelligence">Threat Intelligence</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/feature-stories">Feature Stories</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/expert-perspectives">Expert Perspectives</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/product-insights">Product Insights</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/election-security">Election Security</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/search" href="/blogs/search"><i _ngcontent-sc2="" class="fa fa-search"></i>Search</a></li><li _ngcontent-sc2="" class="nav-menu__item external"><a _ngcontent-sc2="" class="nav-menu__link" href="https://www.broadcom.com" rel="noopener" target="_blank"><i _ngcontent-sc2="" class="fa fa-globe"></i>Broadcom Home</a></li></ul></div></nav></app-blogs-menu></div></div></header><!----><router-outlet></router-outlet><app-blog-post><div class="blog-id--221" classname="blog-id--221"><!----><app-hero _nghost-sc11=""><div _ngcontent-sc11="" class="hero"><figure _ngcontent-sc11="" app-picture="" class="hero__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_extra_wide/public/2020-06/8.jpg?h=62bc044e&amp;itok=XmujJVNs 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_extra_wide_2x/public/2020-06/8.jpg?h=62bc044e&amp;itok=G0ZSJ_mM 2x" media="(min-width: 1900px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_wide/public/2020-06/8.jpg?h=62bc044e&amp;itok=qMy091FF 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_wide_2x/public/2020-06/8.jpg?h=62bc044e&amp;itok=teqoZ6J- 2x" media="(min-width: 1400px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_large/public/2020-06/8.jpg?h=62bc044e&amp;itok=NmClNsqt 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_large_2x/public/2020-06/8.jpg?h=62bc044e&amp;itok=Csattqys 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_medium/public/2020-06/8.jpg?h=62bc044e&amp;itok=mKwbECnd 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_medium_2x/public/2020-06/8.jpg?h=62bc044e&amp;itok=cv9bAQvh 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_small/public/2020-06/8.jpg?h=62bc044e&amp;itok=pm8BZ7R0 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_small_2x/public/2020-06/8.jpg?h=62bc044e&amp;itok=-oXtUfzS 2x" media="(min-width: 420px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny/public/2020-06/8.jpg?h=62bc044e&amp;itok=GqeJxRR9 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny_2x/public/2020-06/8.jpg?h=62bc044e&amp;itok=OgSRjd_Q 2x" media=""><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny/public/2020-06/8.jpg?h=62bc044e&amp;itok=GqeJxRR9" alt=""></picture><!----></figure></div></app-hero><div class="page-container"><main class="main" role="main"><a id="main-content"></a><article class="node blog-post" role="article"><div class="blog-post__aside"><!----><div class="blog-post__author-wrapper"><!----><app-author class="author" _nghost-sc9=""><!----><figure _ngcontent-sc9="" app-picture="" class="author__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=yMcB1DYB 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=H2VWJd8e 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=yMcB1DYB" alt=""></picture><!----></figure><div _ngcontent-sc9="" class="author__content"><span _ngcontent-sc9="" class="author__name">Threat Hunter Team</span><span _ngcontent-sc9="" class="author__title">Symantec</span></div></app-author></div><!----></div><div class="blog-post__content"><!----><header class="blog-post__header"><div class="row"><div class="column column--first"><div class="meta"><span class="meta__date"><!---->Posted: <time>10 Jun, 2015</time></span><span class="meta__time-to-read">3 <!---->Min Read</span><!----><span class="meta__tag"><a href="/blogs/threat-intelligence">Threat Intelligence</a></span></div><!----></div><div class="column column--last"><div class="social-list__wrapper"><app-subscribe-button _nghost-sc4=""><button _ngcontent-sc4="" class="subscribe-email"><i _ngcontent-sc4="" class="fa fa-envelope"></i> Subscribe</button></app-subscribe-button></div></div></div><h1 class="blog-post__title" id="page-title">Duqu 2.0: Reemergence of an aggressive cyberespionage threat</h1><h2 class="blog-post__subtitle">Malware used in a number of attack campaigns against a European telecoms operator, a North African telecoms operator, and a South East Asian electronic equipment manufacturer. </h2></header><!----><span><!----><app-paragraph-rte _nghost-sc14=""><div _ngcontent-sc14=""><p>Duqu 2.0, the cyberespionage tool that was used to compromise security firm Kaspersky Lab, has also been used in a number of other attack campaigns against a range of targets, including several telecoms firms. Analysis by Symantec concurs with&nbsp;<a href="https://securelist.com/blog/research/70504/the-mystery-of-duqu-2-0-a-sophisticated-cyberespionage-actor-returns/">Kasperskyâs assessment today</a>&nbsp;that Duqu 2.0 (detected by Symantec as&nbsp;W32.Duqu.B) is an evolution of the&nbsp;older Duqu worm, which was&nbsp;<a href="https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=933c68f1-6ee7-473e-9eb6-6c8459f790f2&amp;CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&amp;tab=librarydocuments">used in a number of intelligence-gathering attacks against a range of industrial targets before it was exposed in 2011</a>. Although their functionalities were different, the original Duqu worm&nbsp;had many similarities with the Stuxnet worm&nbsp;used to sabotage the Iranian nuclear development program.&nbsp;</p>

<h2><strong>New attacks</strong></h2>

<p>Symantec has found evidence that Duqu has been used in a number of different attack campaigns against a small number of selected targets.&nbsp;Among the organizations targeted were a European telecoms operator, a North African telecoms operator, and a South East Asian electronic equipment manufacturer. Infections were also found on computers located in the US, UK, Sweden, India, and Hong Kong.&nbsp;</p>

<p>In addition to the attack against itself, Kaspersky believes Duqu was used to target countries involved in international negotiations surrounding Iranâs nuclear program. Given the diversity of targets, Symantec believes that the Duqu attackers have been involved in multiple cyberespionage campaigns. Some organizations may not be the ultimate targets of the groupâs operations, but rather stepping stones towards the final target. The groupâs interest in telecoms operators could be related to attempts to monitor communications by individuals using their networks.&nbsp;</p>

<p>Symantec has found no evidence to suggest that it has been affected by attacks using this malware.</p>

<h2><strong>Duqu 2.0 in operation</strong></h2>

<p>This new version of Duqu is stealthy and resides solely in the computerâs memory, with no files written to disk. It comes in two variants. The first is a basic back door that appears to be used to gain a persistent foothold inside the targeted entity by infecting multiple computers.</p>

<p>The second variant is more complex. It has the same structure as the first, but contains several modules that provide a range of functionality to the malware, such as gathering information on the infected computer, stealing data, network discovery, network infection, and communication with command-and-control (C&amp;C) servers. This variant appears to be deployed to computers deemed to be targets of interest by the attackers.&nbsp;</p>

<h2><strong>Common code and code flow</strong></h2>

<p>Duqu and Duqu 2.0 share large amounts of code, in addition to similarities in how that code is organized. The shared code includes a number of helper functions. For example, as shown in Figure 1, there is a âgen_randomâ function (as labelled by an engineer) that is shared between Duqu and Duqu 2.0.&nbsp;</p>

<p>Not only is that gen_random code shared, but the code that calls that function is also organized almost identically. Such similarities in how code is called is repeated in several other locations throughout Duqu 2.0, including in how C&amp;C IP addresses are formatted, how network messages are generated, and how files are encrypted and decrypted.&nbsp;</p>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><span><!----><!----><!----><!----><!----><!----><!----><app-paragraph-image-inline _nghost-sc20=""><div _ngcontent-sc20="" class="paragraph paragraph-image-inline"><!----><figure _ngcontent-sc20="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_medium/public/2020-06/1.png?itok=TNsr-wo5 1x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2020-06/1.png?itok=bR7MciU5 1x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2020-06/1.png?itok=bR7MciU5" alt="Figure 1.  Duqu vs Duqu 2.0 code flow"></picture><!----><figcaption>Figure 1.  Duqu vs Duqu 2.0 code flow</figcaption></figure></div></app-paragraph-image-inline><!----><!----><!----><!----><!----><!----><!----></span><span><!----><app-paragraph-rte _nghost-sc14=""><div _ngcontent-sc14=""><p>When a program needs to store data, the program author will design structures to store that data in a logical and easily accessible manner. Duqu and Duqu 2.0 share a number of these data structures.&nbsp;</p>

<h2><strong>Network communications</strong></h2>

<p>Another shared feature between the two variants, as shown in Figure 1, is the use of a cookie header with a hardcoded string and a random string when sending messages to a C&amp;C server. For example:&nbsp;</p>

<ul>
	<li>Duqu: Cookie: PHPSESSID=&lt;random_str_0x1A_size&gt;</li>
	<li>Duqu 2.0: Cookie: COUNTRY=&lt;random_str_0x1A_size&gt;</li>
</ul>

<p>A second shared feature in the network communications code is to connect to a number of Microsoft URLs to retrieve a proxy address, as shown in Figure 2.&nbsp;</p>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><span><!----><!----><!----><!----><!----><!----><!----><app-paragraph-image-inline _nghost-sc20=""><div _ngcontent-sc20="" class="paragraph paragraph-image-inline"><!----><figure _ngcontent-sc20="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_medium/public/2020-06/2.png?itok=6fM2yLTE 1x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2020-06/2.png?itok=GETjKhdW 1x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2020-06/2.png?itok=GETjKhdW" alt="Figure 2. Duqu vs Duqu 2.0 network code"></picture><!----><figcaption>Figure 2. Duqu vs Duqu 2.0 network code</figcaption></figure></div></app-paragraph-image-inline><!----><!----><!----><!----><!----><!----><!----></span><span><!----><app-paragraph-rte _nghost-sc14=""><div _ngcontent-sc14=""><p>The list of Microsoft URLs connected to, by both variants, is identical.&nbsp;</p>

<p>Finally, for network communications, when Duqu uses HTTP, it will use image names in the âContent-Dispositionâ header. For Duqu, the value âDSC00001.jpgâ was used, whereas for Duqu 2.0, the value â%05d.gifâ is used.&nbsp;</p>

<h2><strong>Conclusion</strong></h2>

<p>Based on our analysis, Symantec believes that Duqu 2.0 is an evolution of the original threat, created by the same group of attackers. Duqu 2.0 is a fully featured information-stealing tool that is designed to maintain a long term, low profile presence on the targetâs network. Its creators have likely used it as one of their main tools in multiple intelligence gathering campaigns.&nbsp;</p>

<p>Given that activity surrounding the original version of Duqu dropped off following its discovery, it is likely that the group may now retreat before re-emerging with new malware.&nbsp;</p>

<h2><strong>Protection</strong></h2>

<p>Symantec and Norton products detect this threat as:</p>

<ul>
	<li>W32.Duqu.B</li>
</ul>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><!----><!----><div class="blog-post__about-author-wrapper"><!----><app-blog-author class="blog-author" _nghost-sc29=""><div _ngcontent-sc29="" class="blog-author__inner"><div _ngcontent-sc29="" class="blog-author__image"><!----><div _ngcontent-sc29="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_large/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=0czhl3gL 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_large_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=e65lX9T7 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=w8Rg1PQZ 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=ElOaN5mG 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=w8Rg1PQZ" alt=""></picture><!----></div><div _ngcontent-sc29="" class="ellipse"><svg _ngcontent-sc29="" height="500" viewBox="0 0 46 500" width="46"><path _ngcontent-sc29="" d="M0 0h46c-29.758 83.007-44.113 169.773-43.064 260.295 1.049 90.525 15.404 170.425 43.064 239.705h-46v-500z" fill="#213c60"></path></svg></div></div><div _ngcontent-sc29="" class="blog-author__content"><header _ngcontent-sc29=""><h2 _ngcontent-sc29="" class="blog-author__title">About the Author</h2><h3 _ngcontent-sc29="" class="blog-author__name">Threat Hunter Team</h3><!----><h4 _ngcontent-sc29="" class="blog-author__position">Symantec</h4></header><!----><p _ngcontent-sc29="">The Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis that helps customers respond to attacks.</p></div></div></app-blog-author></div><!----><div class="blog-post__comment"><header><h2 class="blog-post__comment-title"><i aria-hidden="true" class="fa fa-share-alt"></i>Want to comment on this post?</h2></header><p>We encourage you to share your thoughts on your favorite social platform.</p><!----><div class="social-list"><!----></div></div></div></article></main></div><!----><div class="related-blog-posts related-blog-posts__blog-post"><div class="inner"><header><h2 class="related-blog-posts__title"><i aria-hidden="true" class="fa fa-compass"></i>Related Blog Posts</h2></header><div class="related-blog-posts__list"><!----><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/elfin-indictments-iran-espionage"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-09/GettyImages-507072286.jpg?h=d1757362&amp;itok=-Hv266ZT 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-09/GettyImages-507072286.jpg?h=d1757362&amp;itok=mMLbBxnb 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-09/GettyImages-507072286.jpg?h=d1757362&amp;itok=Zhn709Uz 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-09/GettyImages-507072286.jpg?h=d1757362&amp;itok=1WDtQEMN 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-09/GettyImages-507072286.jpg?h=d1757362&amp;itok=Y_x_8BUE 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-09/GettyImages-507072286.jpg?h=d1757362&amp;itok=8E80iz1k 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-09/GettyImages-507072286.jpg?h=d1757362&amp;itok=Y_x_8BUE" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">18 Sep, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">4 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">Elfin: Latest U.S. Indictments Appear to Target Iranian Espionage Group</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/apt41-indictments-china-espionage"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-09/8.jpg?h=62bc044e&amp;itok=lw3Fq-c6 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-09/8.jpg?h=62bc044e&amp;itok=iqPy6IlT 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-09/8.jpg?h=62bc044e&amp;itok=QUFtTm5l 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-09/8.jpg?h=62bc044e&amp;itok=4zoNf6FT 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-09/8.jpg?h=62bc044e&amp;itok=gzHYQrq- 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-09/8.jpg?h=62bc044e&amp;itok=vHD0WNpz 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-09/8.jpg?h=62bc044e&amp;itok=gzHYQrq-" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">17 Sep, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">3 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">APT41: Indictments Put Chinese Espionage Group in the Spotlight</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/threat-landscape-trends-q2-2020"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-08/94505630_XL_Trends_Cover_1.jpg?h=367cf052&amp;itok=F8X2WzUZ 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-08/94505630_XL_Trends_Cover_1.jpg?h=367cf052&amp;itok=FD4-djKu 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-08/94505630_XL_Trends_Cover_1.jpg?h=367cf052&amp;itok=qIQwuhgR 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-08/94505630_XL_Trends_Cover_1.jpg?h=367cf052&amp;itok=NzBk95LK 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-08/94505630_XL_Trends_Cover_1.jpg?h=367cf052&amp;itok=Cz5SD2DN 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-08/94505630_XL_Trends_Cover_1.jpg?h=367cf052&amp;itok=q1aVwSiF 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-08/94505630_XL_Trends_Cover_1.jpg?h=367cf052&amp;itok=Cz5SD2DN" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">24 Aug, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">4 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">Threat Landscape Trends â Q2 2020</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/wastedlocker-ransomware-us"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-06/4_1.jpg?h=62bc044e&amp;itok=9njgtp6S 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-06/4_1.jpg?h=62bc044e&amp;itok=wE-3lCaK 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-06/4_1.jpg?h=62bc044e&amp;itok=l9u_lPYU 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-06/4_1.jpg?h=62bc044e&amp;itok=2KVwZkUP 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-06/4_1.jpg?h=62bc044e&amp;itok=6DI_xNks 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-06/4_1.jpg?h=62bc044e&amp;itok=iIx7OMgI 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-06/4_1.jpg?h=62bc044e&amp;itok=6DI_xNks" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">25 Jun, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">5 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">WastedLocker: Symantec Identifies Wave of Attacks Against U.S. Organizations</h3><!----><div _ngcontent-sc10="" class="blog-teaser__media"><!----><span _ngcontent-sc10="" class="blog-teaser__media-video"><i _ngcontent-sc10="" aria-hidden="true" class="fa fa-youtube-play"></i>Video</span><!----><!----></div></a></app-related-blog-posts></div></div></div></div></app-blog-post><footer class="footer"><div class="footer-inner"><div class="footer-column footer-column__first"><a class="footer-logo" href="https://www.broadcom.com" rel="home noopener" target="_blank" title="Broadcom"><img alt="Broadcom" src="assets/logo--white.svg"><span class="footer-text">Symantec Enterprise Blogs</span></a><app-subscribe-button class="subscribe-email__wrapper" _nghost-sc4=""><button _ngcontent-sc4="" class="subscribe-email"><i _ngcontent-sc4="" class="fa fa-envelope"></i> Subscribe</button></app-subscribe-button></div><div class="footer-column footer-column__last"><ul class="footer-menu__list"><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/privacy-policy" rel="noopener" target="_blank">Privacy Policy</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/cookie-policy" rel="noopener" target="_blank">Cookie Policy</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/ca/data-transfers" rel="noopener" target="_blank">Data Processing and Data Transfers</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/citizenship/supplier-responsibility" rel="noopener" target="_blank">Supplier Responsibility</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/terms-of-use/" rel="noopener" target="_blank">Terms of Use</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/sitemap" rel="noopener" target="_blank">Sitemap</a></li></ul><div class="footer-copyright">Copyright Â© 2005-2020 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div><app-subscribe-form-modal _nghost-sc5=""><div _ngcontent-sc5="" class="modal"><div _ngcontent-sc5="" class="modal__inner"><!----><div _ngcontent-sc5="" class="modal__content"><i _ngcontent-sc5="" class="fa fa-envelope modal__icon"></i><h2 _ngcontent-sc5="" class="modal__title">Get Symantec's Latest Blog Posts <em _ngcontent-sc5="">In Your Inbox</em></h2><form _ngcontent-sc5="" class="subscribe-form ng-untouched ng-pristine ng-invalid" novalidate=""><!----><div _ngcontent-sc5="" class="form-fields"><!----><!----><div _ngcontent-sc5="" class="form-item subscribe-form-tos"><input _ngcontent-sc5="" name="termsAccept" type="checkbox"> I accept the <a _ngcontent-sc5="" target="_self" href="https://www.broadcom.com/company/legal/terms-of-use/">Terms of Use</a>. Your privacy is important to us. Please see our <a _ngcontent-sc5="" target="_self" href="https://www.broadcom.com/company/legal/privacy-policy">Privacy Policy</a> for more information. </div><div _ngcontent-sc5="" class="form-item"><input _ngcontent-sc5="" class="subscribe-form__email ng-untouched ng-pristine ng-valid" formcontrolname="subscriberEmail" maxlength="255" name="subscribe" placeholder="Enter your email address" size="20" title="Enter your email address" type="email" value=""></div><!----><div _ngcontent-sc5="" class="form-item"><re-captcha _ngcontent-sc5="" formcontrolname="recaptcha" id="ngrecaptcha-9552" class="ng-untouched ng-pristine ng-invalid"></re-captcha></div><button _ngcontent-sc5="" class="form-submit" disabled=""><i _ngcontent-sc5="" class="fa fa-envelope"></i> Subscribe</button><button _ngcontent-sc5="" class="form-submit form-submit__submitted hidden"><i _ngcontent-sc5="" class="fa fa-check"></i> Submitted</button></div></form><button _ngcontent-sc5="" class="modal__close"><span _ngcontent-sc5="">Close</span></button></div></div></div></app-subscribe-form-modal></app-root>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KF7XWD"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
<script src="runtime-es2015.da0a6e8d67e0e9164a4b.js" type="module"></script><script src="runtime-es5.da0a6e8d67e0e9164a4b.js" nomodule="" defer=""></script><script src="polyfills-es5.304c50711c869a9ad3f0.js" nomodule="" defer=""></script><script src="polyfills-es2015.b4a3bdae6bcd059f26dd.js" type="module"></script><script src="main-es2015.4b580e7d1bd14f30f498.js" type="module"></script><script src="main-es5.4b580e7d1bd14f30f498.js" nomodule="" defer=""></script>

</body></html>