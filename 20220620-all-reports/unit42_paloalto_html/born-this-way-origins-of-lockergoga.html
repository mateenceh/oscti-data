
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Born This Way? Origins of LockerGoga</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/born-this-way-origins-of-lockergoga/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/born-this-way-origins-of-lockergoga/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/born-this-way-origins-of-lockergoga/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Born This Way? Origins of LockerGoga" />
<meta property="og:description" content="A Unit 42 analysis of LockerGoga ransomware samples reveals that its developers have added new features to the malware, which was used in a string of attacks on industrial firms." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/born-this-way-origins-of-lockergoga/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="LockerGoga" />
<meta property="article:tag" content="ransomware" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2019-03-26T13:00:03+00:00" />
<meta property="article:modified_time" content="2020-07-03T00:06:09+00:00" />
<meta property="og:updated_time" content="2020-07-03T00:06:09+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="A Unit 42 analysis of LockerGoga ransomware samples reveals that its developers have added new features to the malware, which was used in a string of attacks on industrial firms." />
<meta name="twitter:title" content="Born This Way? Origins of LockerGoga" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Born This Way? Origins of LockerGoga Comments Feed" href="https://unit42.paloaltonetworks.com/born-this-way-origins-of-lockergoga/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="35,632"/>
<meta property="og:date_created" content="March 26, 2019 at 6:00 AM"/>
<meta property="og:post_length" content="2813"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Mike Harbison"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/mike-harbison/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware-380x184.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Born This Way? Origins of LockerGoga","name":"Born This Way? Origins of LockerGoga","description":"A Unit 42 analysis of LockerGoga ransomware samples reveals that its developers have added new features to the malware, which was used in a string of attacks on industrial firms. ","url":"https:\/\/unit42.paloaltonetworks.com\/born-this-way-origins-of-lockergoga\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/born-this-way-origins-of-lockergoga\/","datePublished":"March 26, 2019","articleBody":"This Unit 42 blog provides insights into the ransomware attacks referred to as LockerGoga.\r\n\r\nThe LockerGoga ransomware was first publicly reported in January by Bleeping Computer, which tied the malware to an attack against French engineering company Altran Technologies. Several variants have since been found in the wild, where they were used in attacks against Norwegian aluminum manufacturer Norsk Hydro and two chemical companies: Hexion and Momentive. Unit 42 reviewed malware samples from these attacks and found evidence that caused us to question the origin of the threat name. \u00a0\u201cLockerGoga\u201d was taken from a string that did not exist anywhere in the code used in the original attack on Altran.\u00a0 Bleeping Computer reported that the name came from this source code path discovered by MalwareHunterTeam:\r\n\r\nX:\\work\\Projects\\LockerGoga\\cl-src-last\\cryptopp\\src\\rijndael_simd.cpp for SHA256 bdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f\r\n\r\nWe were able to find this string referenced in earlier ransomware variants identified as Ransom.GoGalocker by Symantec, but not in the sample identified in Bleeping Computer\u2019s report. To avoid confusion, we will continue to use the LockerGoga name to refence the initial variant and its predecessors. Palo Alto Networks has identified 31 ransomware samples that are similar in behavior and code to the initial variant. In this report we will attempt to trace back to the origin of these samples, discuss their evolution, then expose some of their inner working capabilities and even faults.\r\nFirst LockerGoga Sample\r\nThe earliest known sample of LockerGoga (SHA256: bdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f) we found was submitted to VirusTotal on January 24. We believe this sample was used in the attack on Altran.\u00a0 We do not know how the ransomware infected Altran\u2019s networks or propagated once there.\r\nPropagation\r\nCurrently LockerGoga does not support any worm-like capabilities that would allow it to self-propagate by infecting additional hosts on a target network.\u00a0 We have observed LockerGoga moving around a network via the server message block (SMB) protocol, which indicates the actors simply manually copy files from computer to computer.\r\nLockerGoga Characteristics\r\nThis sample requires administrative privileges in order to successfully execute, though the specific mechanism for initial code execution is unknown. \u00a0Once it executes it seeks to\u00a0encrypt files on the infected computer and any attached hard drives.\u00a0 Once it\u2019s fully executed, it leaves a ransom note on the user\u2019s desktop containing an email address to contact presumably for decryption and payment options.\r\n\r\nThe initial sample was written in the C++ programming language and employs publicly available libraries such as Boost, Cryptopp and regex.\u00a0 This sample includes a denylist that excludes the following files and directories from encryption:\r\n\r\n \treadme-now.txt\r\n \tfiles starting with ntsuser or usrclass\r\n \tFile extensions: .dll, .lnk, .sys, .locked\r\n \tMicrosoft\\Windows\\burn\r\n \tdat\r\n \tlog\r\n\r\nThe malware does not support any self-propagating code to infect other hosts on the network and is signed by a certificate issued in the name MIKL LIMITED, which has been revoked.\u00a0 The following command line arguments are also supported:\r\n\r\n\r\n\r\nCommand Line\r\nDescription\r\n\r\n\r\n-w\r\nWork:\u00a0 This is the default command line parameter and encrypts all files on the host.\u00a0 It also wipes all free space by creating the following file c:\\wipe and filling it with random data the size of the free space available on the drive.\u00a0 The file is then deleted.\u00a0 This parameter can also be used to encrypt a single file i.e. -w filename.exe\r\n\r\n\r\n-r\r\nDry Run:\u00a0 Does not encrypt any files on the host.\r\n\r\n\r\n-l\r\nLog:\u00a0 Creates a log file off the root drive named cl.log.\r\n\r\n\r\n-f\r\nFile:\u00a0 Used to encrypt a single file.\r\n\r\n\r\n\r\nTable 1. Supported command line arguments\r\n\r\nEncryption\r\nLockerGoga uses the Cryptopp library to implement RSA, as implementing RSA from scratch would be very time consuming and error prone.\u00a0 To encrypt files, (Strong RSA) RSA-OAEP MGF1(SHA-1) is used.\u00a0 The RSA public key found in this sample is:\r\n\r\n\r\n\r\n00000000\u00a0\u00a0 4D 49 47 64 4D 41 30 47\u00a0 43 53 71 47 53 49 62 33\u00a0\u00a0 MIGdMA0GCSqGSIb3\r\n\r\n00000016\u00a0\u00a0 44 51 45 42 41 51 55 41\u00a0 41 34 47 4C 41 44 43 42\u00a0\u00a0 DQEBAQUAA4GLADCB\r\n\r\n00000032\u00a0\u00a0 68 77 4B 42 67 51 43 46\u00a0 66 33 43 54 59 79 41 79\u00a0\u00a0 hwKBgQCFf3CTYyAy\r\n\r\n00000048\u00a0\u00a0 6F 79 5A 71 52 33 6E 48\u00a0 63 4C 4A 2B 49 2F 71 69 \u00a0\u00a0oyZqR3nHcLJ+I\/qi\r\n\r\n00000064\u00a0\u00a0 2F 50 57 77 57 54 75 6C\u00a0 20 6C 4D 69 4E 32 54 47\u00a0\u00a0 \/PWwWTul lMiN2TG\r\n\r\n00000080\u00a0\u00a0 4D 41 4D 62 34 39 75 58\u00a0 51 32 79 43 34 4D 5A 76\u00a0\u00a0 MAMb49uXQ2yC4MZv\r\n\r\n00000096\u00a0\u00a0 5A 76 4B 53 50 55 44 6F\u00a0 33 61 4D 67 5A 4A 71 30\u00a0\u00a0 ZvKSPUDo3aMgZJq0\r\n\r\n00000112\u00a0\u00a0 78 75 52 53 42 34 58 6F\u00a0 73 6D 73 30 5A 39 51 4B\u00a0\u00a0 xuRSB4Xosms0Z9QK\r\n\r\n00000128\u00a0\u00a0 70 76 47 6C 6A 4E 48 36\u00a0 79 34 50 59 4E 39 38 2F\u00a0\u00a0 pvGljNH6y4PYN98\/\r\n\r\n00000144\u00a0\u00a0 76 20 79 31 7A 4F 6B 34\u00a0 70 45 69 53 68 43 32 49\u00a0\u00a0 v y1zOk4pEiShC2I\r\n\r\n00000160\u00a0\u00a0 47 46 50 4A 32 47 71 33\u00a0 4F 63 2B 41 78 4F 37 57\u00a0\u00a0 GFPJ2Gq3Oc+AxO7W\r\n\r\n00000176\u00a0\u00a0 6F 2F 62 42 76 35 34 32\u00a0 52 51 30 67 50 55 77 7A\u00a0\u00a0 o\/bBv542RQ0gPUwz\r\n\r\n00000192\u00a0\u00a0 79 54 53 66 71 6A 44 47\u00a0 35 33 35 73 38 57 73 76\u00a0\u00a0 yTSfqjDG535s8Wsv\r\n\r\n00000208\u00a0\u00a0 4B 73 79 77 49 42 45 51\u00a0 3D 3D\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 KsywIBEQ==\r\n\r\n\r\n\r\nTable 2. RSA Public key found in initial LockerGoga sample\r\nAlthough RSA-OAEP MGF1 has features that make it more secure, the added computational overhead causes encryption to take longer and has difficulty handling large files.\u00a0 To mitigate this, the developers launch multiple child processes that work in parallel to maximize encryption speed.\u00a0 To overcome large files, the developers decided to encrypt chunks of a file every 80,000 bytes and skip the next 80,000 bytes of a file. \u00a0Example:\r\nFigure 1. Data encrypted in 80,000 byte chunks\r\nBecause of this, partial recovery of large files might be possible even without the decryption key.\r\n\r\nAlthough the developers attempt to use a denylist of files and directories to skip, it was observed encrypting core Windows operating system files, which caused the operating system to become unstable and crash. This was observed when running the ransomware on a Windows 2012 machine.\r\nEarly Development\r\nBased on our analysis, we believe this variant is an early release of LockerGoga ransomware. The developers left behind command line parameters such as -r which allows the malware to run without encrypting anything.\u00a0 This can be used in conjunction with -l (log) to test how the ransomware behaves.\u00a0 Both of these parameters are suggestive of an initial, or test, build.\u00a0 The -r specifically was not observed in later variants.\r\n\r\nAccording to the Bleeping Computer report, the ransomware appeared to encrypt only the following specific file extensions: doc|dot|wbk|docx|dotx|docb|xlm|xlsx|xltx|xlsb|xlw|ppt|pot|pps|pptx|potx|ppsx|sldx|pdf.\r\n\r\nOur analysis found that the malware does not use the code block that checks for specific file extensions.\u00a0 Instead, we observed that the malware encrypts all files except those in the denylist. It also has issues with large files, which is addressed in later variants.\r\nDevelopment Cycle\r\nLike other active software projects, the LockerGoga ransomware is under constant development with new variants being developed and used to attack victims.\u00a0 All these variants share similar characteristics and just like other professional development, each release contains improvements or new capabilities.\r\n\r\nTo counter this ongoing development cycle, security researchers have to focus on identifying new variants.\r\n\r\nTo that end, we highlight some of the evolutionary changes we have observed since the malware surfaced in January:\r\n\r\n \tDropped the -r and -f command line arguments\r\n \tLog file renamed from cl.log to .log\r\n \tRansomware note is no longer encoded in the binary\r\n \tRansomware note renamed from README_NOW.txt to README_LOCKED.TXT\r\n \tAdded the following command line parameters:\r\n\r\n\r\n\r\n\r\nParameter\r\nDescription\r\n\r\n\r\n-i\r\nInter process communication (IPC)\r\n\r\n\r\n-s\r\nSlave (child process)\r\n\r\n\r\n-m\r\nMaster Process\r\n\r\n\r\n\r\n\r\n \tBegan using mutexes (example: SM-zzbdrimp) to identify processes for inter-process communication.\r\n \tStopped using svch0st[numeric value].exe as a process name and began using distinct hard-coded names for each sample.\r\n \tUses undocumented Windows API calls (for example NtQuerySection)\r\n \tChanges administrator password to HuHuHUHoHo283283@dJD\r\n \tStopped creating a wipe file to erase free space and instead uses Windows cipher.exe with command parameter \/w to wipe free space on the host\r\n \tAdded importation of WS2_32.dll, possibly to support network communications\r\n \tChanged the format and collection of data recorded in the log file\r\n \tUpdated encryption of files and directories. No longer encrypts all files on the host: instead targets specific file extensions and directories\r\n \tCalls into Windows Restart Manager session for possible token elevation to overwrite trusted installer files\r\n \tUses the following digital signers:\r\n\r\n \tALISA LTD\r\n \tKITTY'S LTD\r\n \tMIKL LIMITED\r\n\r\n\r\n \tLogs off the current user\r\n \tThe inclusion of the word \u201cGoga\u201d in the binary and encrypted files\r\n\r\nConclusion\r\nLockerGoga\u2019s developers continue to add capabilities and launch new attacks.\u00a0 The addition of WS2_32.dll and use of undocumented Windows API calls indicates a level of sophistication beyond typical ransomware authors. The former could lead to the eventual inclusion of C2 communication or automated propagation, and the latter requires some working knowledge of Windows internals.\r\n\r\nThese features raise more questions about the actor\u2019s intent as ransomware is typically one of the least advanced forms of malware:\u00a0 Are they motivated by profits or something else? Has the motive change over time?\u00a0 Why would developers put such effort into their work only to partially encrypt files. Why do they include an email address and not seek payment through more frequently used cryptocurrencies?\r\n\r\nWe do not know if any of the victims have paid the ransom and were able to successfully retrieve their data. We do know that this ransomware has caused significant harm. The damage could increase significantly if \u00a0the attackers continue to refine this ransomware. Unit 42 will continue to monitor LockerGoga and report on new activity.\r\n\r\nWildFire properly identifies all of the malware samples listed in this report as malicious. Traps prevents execution of LockerGoga samples and AutoFocus customers can view LockerGoga samples using the LockerGoga tag.\r\n\r\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit www.cyberthreatalliance.org.\r\nIndicators of Compromise\r\nLockerGoga Samples\r\nae7e9839b7fb750128147a9227d3733dde2faacd13c478e8f4d8d6c6c2fc1a55\r\n\r\nf474a8c0f66dee3d504fff1e49342ee70dd6f402c3fa0687b15ea9d0dd15613a\r\n\r\nffab69deafa647e2b54d8daf8c740b559a7982c3c7c1506ac6efc8de30c37fd5\r\n\r\nc1670e190409619b5a541706976e5a649bef75c75b4b82caf00e9d85afc91881\r\n\r\n65d5dd067e5550867b532f4e52af47b320bd31bc906d7bf5db889d0ff3f73041\r\n\r\n31fdce53ee34dbc8e7a9f57b30a0fbb416ab1b3e0c145edd28b65bd6794047c1\r\n\r\n32d959169ab8ad7e9d4bd046cdb585036c71380d9c45e7bb9513935cd1e225b5\r\n\r\ne00a36f4295bb3ba17d36d75ee27f7d2c20646b6e0352e6d765b7ac738ebe5ee\r\n\r\n6d8f1a20dc0b67eb1c3393c6c7fc859f99a12abbca9c45dcbc0efd4dc712fb7c\r\n\r\n79c11575f0495a3daaf93392bc8134c652360c5561e6f32d002209bc41471a07\r\n\r\n050b4028b76cd907aabce3d07ebd9f38e56c48c991378d1c65442f9f5628aa9e\r\n\r\n1f9b5fa30fd8835815270f7951f624698529332931725c1e17c41fd3dd040afe\r\n\r\n276104ba67006897630a7bdaa22343944983d9397a538504935f2ec7ac10b534\r\n\r\n88d149f3e47dc337695d76da52b25660e3a454768af0d7e59c913995af496a0f\r\n\r\nc97d9bbc80b573bdeeda3812f4d00e5183493dd0d5805e2508728f65977dda15\r\n\r\n06e3924a863f12f57e903ae565052271740c4096bd4b47c38a9604951383bcd1\r\n\r\na845c34b0f675827444d6c502c0c461ed4445a00d83b31d5769646b88d7bbedf\r\n\r\n7bcd69b3085126f7e97406889f78ab74e87230c11812b79406d723a80c08dd26\r\n\r\nba15c27f26265f4b063b65654e9d7c248d0d651919fafb68cb4765d1e057f93f\r\n\r\neda26a1cd80aac1c42cdbba9af813d9c4bc81f6052080bc33435d1e076e75aa0\r\n\r\n7852b47e7a9e3f792755395584c64dd81b68ab3cbcdf82f60e50dc5fa7385125\r\n\r\n14e8a8095426245633cd6c3440afc5b29d0c8cd4acefd10e16f82eb3295077ca\r\n\r\n47f5a231f7cd0e36508ca6ff8c21c08a7248f0f2bd79c1e772b73443597b09b4\r\n\r\nf3c58f6de17d2ef3e894c09bc68c0afcce23254916c182e44056db3cad710192\r\n\r\n9128e1c56463b3ce7d4578ef14ccdfdba15ccc2d73545cb541ea3e80344b173c\r\n\r\nc3d334cb7f6007c9ebee1a68c4f3f72eac9b3c102461d39f2a0a4b32a053843a\r\n\r\n6e69548b1ae61d951452b65db15716a5ee2f9373be05011e897c61118c239a77\r\n\r\n8cfbd38855d2d6033847142fdfa74710b796daf465ab94216fbbbe85971aee29\r\n\r\nbdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f\r\n\r\n5b0b972713cd8611b04e4673676cdff70345ac7301b2c23173cdfeaff564225c\r\n\r\nc7a69dcfb6a3fe433a52a71d85a7e90df25b1db1bc843a541eb08ea2fd1052a4\r\nAppendix\r\nThe latest variant of LockerGoga uses memory mapped files to communicate between processes.\u00a0 To illustrate this, we captured the memory of a section created by a child process.\r\n\r\n\r\n\r\n00000000\u00a0\u00a0 02 00 00 00 00 00 00 00\u00a0 00 00 00 00 01 00 00 00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\r\n00000016\u00a0\u00a0 D0 02 01 00 CC 02 01 00\u00a0 C8 02 01 00 30 00 00 00\u00a0\u00a0 \u00d0\u00a0\u00a0 \u00cc\u00a0\u00a0 \u00c8\u00a0\u00a0 0\u00a0\u00a0\r\n\r\n00000032\u00a0\u00a0 80 02 01 00 F8 FF 0F 00\u00a0 00 00 00 00 00 00 00 00\u00a0\u00a0 \u20ac\u00a0\u00a0 \u00f8\u00ff\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\r\n00000048\u00a0\u00a0 FF FF FF FF 00 00 00 00\u00a0 01 00 00 00 24 00 00 00\u00a0\u00a0 \u00ff\u00ff\u00ff\u00ff\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 $\u00a0\u00a0\r\n\r\n00000064\u00a0\u00a0 20 00 00 00 1C 00 00 00\u00a0 00 00 00 00 01 00 00 00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\r\n00000080\u00a0\u00a0 FC FF FF FF F8 FF FF FF\u00a0 F4 FF 01 00 0B 20 00 C0\u00a0\u00a0 \u00fc\u00ff\u00ff\u00ff\u00f8\u00ff\u00ff\u00ff\u00f4\u00ff\u00a0\u00a0\u00a0\u00a0 \u00c0\r\n\r\n00000096\u00a0\u00a0 DE FF FF FF 01 00 00 00\u00a0 01 00 00 00 38 00 01 00\u00a0\u00a0 \u00de\u00ff\u00ff\u00ff\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 8\u00a0\u00a0\r\n\r\n00000112\u00a0\u00a0 01 00 04 21 10 01 00 00\u00a0 00 00 00 00 00 7A 70 63\u00a0\u00a0\u00a0\u00a0\u00a0 !\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 zpc\r\n\r\n00000128\u00a0\u00a0 55 48 4A 76 5A 33 4A 68\u00a0 62 53 42 47 61 57 78 6C\u00a0\u00a0 UHJvZ3JhbSBGaWxl\r\n\r\n00000144\u00a0\u00a0 63 31 78 57 54 58 64 68\u00a0 63 6D 56 63 56 6B 31 33\u00a0\u00a0 c1xWTXdhcmVcVk13\r\n\r\n00000160\u00a0\u00a0 59 58 4A 6C 49 46 52 76\u00a0 62 32 78 7A 58 47 64 73\u00a0\u00a0 YXJlIFRvb2xzXGds\r\n\r\n00000176\u00a0\u00a0 61 57 49 74 4D 69 34 77\u00a0 4C 6D 52 73 62 41 3D 3D\u00a0\u00a0 aWItMi4wLmRsbA==\r\n\r\n00000192\u00a0\u00a0 64 48 42 6A 63 48 4D 75\u00a0 5A 47 78 73 63 6D 56 7A\u00a0\u00a0 dHBjcHMuZGxscmVz\r\n\r\n00000208\u00a0\u00a0 65 43 35 6B 62 47 77 75\u00a0 62 58 56 70 4E 46 39 66\u00a0\u00a0 eC5kbGwubXVpNF9f\r\n\r\n00000224\u00a0\u00a0 4F 48 64 6C 61 33 6C 69\u00a0 4D 32 51 34 59 6D 4A 33\u00a0\u00a0 OHdla3liM2Q4YmJ3\r\n\r\n00000240\u00a0\u00a0 5A 54 68 68 5A 44 46 68\u00a0 4E 7A 51 77 4C 54 52 68\u00a0\u00a0 ZThhZDFhNzQwLTRh\r\n\r\n00000256\u00a0\u00a0 4E 32 59 74 4E 47 45 78\u00a0 59 53 30 35 4F 54 45 78\u00a0\u00a0 N2YtNGExYS05OTEx\r\n\r\n00000272\u00a0\u00a0 4C 54 51 79 4D 57 51 30\u00a0 4D 6A 49 34 4D 7A 52 6C\u00a0\u00a0 LTQyMWQ0MjI4MzRl\r\n\r\n00000288\u00a0\u00a0 5A 46 78 42 63 33 4E 6C\u00a0 64 48 4E 63 55 6D 56 7A\u00a0\u00a0 ZFxBc3NldHNcUmVz\r\n\r\n00000304\u00a0\u00a0 62 33 56 79 59 32 56 7A\u00a0 58 46 4A 6C 63 58 56 70\u00a0\u00a0 b3VyY2VzXFJlcXVp\r\n\r\n00000320\u00a0\u00a0 63 6D 56 6B 55 48 4A 70\u00a0 62 6E 52 44 59 58 42 68\u00a0\u00a0 cmVkUHJpbnRDYXBh\r\n\r\n00000336\u00a0\u00a0 59 6D 6C 73 61 58 52 70\u00a0 5A 58 4D 75 65 47 31 73\u00a0\u00a0 YmlsaXRpZXMueG1s\r\n\r\n00000352\u00a0\u00a0 65 6D 55 74 4E 44 68 66\u00a0 59 57 78 30 5A 6D 39 79\u00a0\u00a0 emUtNDhfYWx0Zm9y\r\n\r\n00000368\u00a0\u00a0 62 53 31 31 62 6E 42 73\u00a0 59 58 52 6C 5A 43 35 77\u00a0\u00a0 bS11bnBsYXRlZC5w\r\n\r\n00000384\u00a0\u00a0 62 6D 63 3D 62 53 31 31\u00a0 62 6E 42 73 59 58 52 6C\u00a0\u00a0 bmc=bS11bnBsYXRl\r\n\r\n00000400\u00a0\u00a0 5A 43 35 77 62 6D 63 3D\u00a0 00 00 00 00 00 00 00 00\u00a0\u00a0 ZC5wbmc=\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\r\n\r\n\r\nTable 3. Child process mapped file\r\nThe 1st byte (02) instructs the master process to process the data below. The data is base64 encoded in three parts and decodes to the following:\r\n\r\nPart 1:\r\n\r\nUnknown value\r\n\r\nPart 2:\r\n\r\ntpcps.dllresx.dll.mui4__8wekyb3d8bbwe8ad1a740-4a7f-4a1a-9911-421d422834ed\\Assets\\Resources\\RequiredPrintCapabilities.xmlze-48_altform-unplated.png\r\n\r\nPart 3:\r\n\r\nm-unplated.png\r\n\r\nExample of initial variant of LockerGoga running on a host:\r\n\r\n\r\nFigure\u00a0 2. Initial LockerGoga running\r\nInitial LockerGoga Ransom Note:\r\n\r\n\r\n\r\nGreetings!\r\n\r\n&nbsp;\r\n\r\nThere was a significant flaw in the security system of your company.\r\n\r\nYou should be thankful that the flaw was exploited by serious people and not some rookies.\r\n\r\nThey would have damaged all of your data by mistake or for fun.\r\n\r\n&nbsp;\r\n\r\nYour files are encrypted with the strongest military algorithms RSA4096 and AES-256.\r\n\r\nWithout our special decoder it is impossible to restore the data.\r\n\r\nAttempts to restore your data with third party software as Photorec, RannohDecryptor etc.\r\n\r\nwill lead to irreversible destruction of your data.\r\n\r\n&nbsp;\r\n\r\nTo confirm our honest intentions.\r\n\r\nSend us 2-3 different random files and you will get them decrypted.\r\n\r\nIt can be from different computers on your network to be sure that our decoder decrypts everything.\r\n\r\nSample files we unlock for free (files should not be related to any kind of backups).\r\n\r\n&nbsp;\r\n\r\nWe exclusively have decryption software for your situation\r\n\r\n&nbsp;\r\n\r\nDO NOT RESET OR SHUTDOWN - files may be damaged.\r\n\r\nDO NOT RENAME the encrypted files.\r\n\r\nDO NOT MOVE the encrypted files.\r\n\r\nThis may lead to the impossibility of recovery of the certain files.\r\n\r\n&nbsp;\r\n\r\nTo get information on the price of the decoder contact us at:\r\n\r\nCottleAkela@protonmail.com;QyavauZehyco1994@o2.pl\r\n\r\nThe payment has to be made in Bitcoins.\r\n\r\nThe final price depends on how fast you contact us.\r\n\r\nAs soon as we receive the payment you will get the decryption tool and\r\n\r\ninstructions on how to improve your systems security\r\n\r\n\r\n\r\nFigure 3. Initial LockerGoga ransom note\r\n&nbsp;\r\n\r\nLatest LockerGoga Ransom Note:\r\n\r\n\r\n\r\nGreetings!\r\n\r\n&nbsp;\r\n\r\nThere was a significant flaw in the security system of your company.\r\n\r\nYou should be thankful that the flaw was exploited by serious people and not some rookies.\r\n\r\nThey would have damaged all of your data by mistake or for fun.\r\n\r\n&nbsp;\r\n\r\nYour files are encrypted with the strongest military algorithms RSA4096 and AES-256.\r\n\r\nWithout our special decoder it is impossible to restore the data.\r\n\r\nAttempts to restore your data with third party software as Photorec, RannohDecryptor etc.\r\n\r\nwill lead to irreversible destruction of your data.\r\n\r\n&nbsp;\r\n\r\nTo confirm our honest intentions.\r\n\r\nSend us 2-3 different random files and you will get them decrypted.\r\n\r\nIt can be from different computers on your network to be sure that our decoder decrypts everything.\r\n\r\nSample files we unlock for free (files should not be related to any kind of backups).\r\n\r\n&nbsp;\r\n\r\nWe exclusively have decryption software for your situation\r\n\r\n&nbsp;\r\n\r\nDO NOT RESET OR SHUTDOWN - files may be damaged.\r\n\r\nDO NOT RENAME the encrypted files.\r\n\r\nDO NOT MOVE the encrypted files.\r\n\r\nThis may lead to the impossibility of recovery of the certain files.\r\n\r\n&nbsp;\r\n\r\nThe payment has to be made in Bitcoins.\r\n\r\nThe final price depends on how fast you contact us.\r\n\r\nAs soon as we receive the payment you will get the decryption tool and\r\n\r\ninstructions on how to improve your systems security\r\n\r\n&nbsp;\r\n\r\nTo get information on the price of the decoder contact us at:\r\n\r\n&nbsp;\r\n\r\nMayarChenot@protonmail.com\r\n\r\nQicifomuEjijika@o2.pl\r\n\r\n\r\n\r\nFigure 4. Latest LockerGoga ransom note","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Mike Harbison"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"96522","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=96522' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fborn-this-way-origins-of-lockergoga%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fborn-this-way-origins-of-lockergoga%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-96522 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Born This Way? Origins of LockerGoga</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-96522 entry-meta">
			
			
			<span class="post-views-count">35,632</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'96522','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fborn-this-way-origins-of-lockergoga%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fborn-this-way-origins-of-lockergoga%2F+-+Born+This+Way%3F+Origins+of+LockerGoga" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fborn-this-way-origins-of-lockergoga%2F&title=Born+This+Way%3F+Origins+of+LockerGoga&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/born-this-way-origins-of-lockergoga/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/mike-harbison/" title="Posts by Mike Harbison" class="author url fn" rel="author">Mike Harbison</a>        </p>
        <p><time datetime="2019-03-26T13:00:03+00:00">March 26, 2019 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/lockergoga/" rel="tag">LockerGoga</a>, <a href="https://unit42.paloaltonetworks.com/tag/ransomware/" rel="tag">ransomware</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware-900x450.png" class="attachment-single size-single" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware-900x450.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware-300x150.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware-768x384.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware-1024x512.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware-370x185.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Ransomware.png 2001w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/born-this-way-origins-of-lockergoga/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>This Unit 42 blog provides insights into the ransomware attacks referred to as LockerGoga.</p>
<p>The LockerGoga ransomware was first publicly reported in January by Bleeping Computer, which tied the malware to an attack against French engineering company Altran Technologies. Several variants have since been found in the wild, where they were used in attacks against Norwegian aluminum manufacturer <a href="https://doublepulsar.com/how-lockergoga-took-down-hydro-ransomware-used-in-targeted-attacks-aimed-at-big-business-c666551f5880" target="_blank" rel="noopener noreferrer">Norsk Hydro</a> and two chemical companies: <a href="https://www.wired.com/story/lockergoga-ransomware-crippling-industrial-firms/" target="_blank" rel="noopener noreferrer">Hexion and Momentive</a>. Unit 42 reviewed malware samples from these attacks and found evidence that caused us to question the origin of the threat name.  “LockerGoga” was taken from a string that did not exist anywhere in the code used in the original attack on Altran.  Bleeping Computer reported that the name came from this source code path discovered by MalwareHunterTeam:</p>
<p><span style="font-family: 'courier new', courier, monospace;"><em>X:\work\Projects\LockerGoga\cl-src-last\cryptopp\src\rijndael_simd.cpp </em>for SHA256 bdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f</span></p>
<p>We were able to find this string referenced in earlier ransomware variants identified as <a href="https://www.virustotal.com/gui/file/c7a69dcfb6a3fe433a52a71d85a7e90df25b1db1bc843a541eb08ea2fd1052a4">Ransom.GoGalocker</a> by Symantec, but not in the sample identified in Bleeping Computer’s report. To avoid confusion, we will continue to use the LockerGoga name to refence the initial variant and its predecessors. Palo Alto Networks has identified 31 ransomware samples that are similar in behavior and code to the initial variant. In this report we will attempt to trace back to the origin of these samples, discuss their evolution, then expose some of their inner working capabilities and even faults.</p>
<h2>First LockerGoga Sample</h2>
<p>The earliest known sample of LockerGoga (SHA256: <span style="font-family: 'courier new', courier, monospace; font-size: 12pt;">bdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f</span>) we found was submitted to VirusTotal on January 24. We believe this sample was used in the attack on Altran.  We do not know how the ransomware infected Altran’s networks or propagated once there.</p>
<h2>Propagation</h2>
<p>Currently LockerGoga does not support any worm-like capabilities that would allow it to self-propagate by infecting additional hosts on a target network.  We have observed LockerGoga moving around a network via the server message block (SMB) protocol, which indicates the actors simply manually copy files from computer to computer.</p>
<h2>LockerGoga Characteristics</h2>
<p>This sample requires administrative privileges in order to successfully execute, though the specific mechanism for initial code execution is unknown.  Once it executes it seeks to encrypt files on the infected computer and any attached hard drives.  Once it’s fully executed, it leaves a ransom note on the user’s desktop containing an email address to contact presumably for decryption and payment options.</p>
<p>The initial sample was written in the C++ programming language and employs publicly available libraries such as Boost, Cryptopp and regex.  This sample includes a denylist that excludes the following files and directories from encryption:</p>
<ul>
<li>readme-now.txt</li>
<li>files starting with ntsuser or usrclass</li>
<li>File extensions: .dll, .lnk, .sys, .locked</li>
<li>Microsoft\Windows\burn</li>
<li>dat</li>
<li>log</li>
</ul>
<p>The malware does not support any self-propagating code to infect other hosts on the network and is signed by a certificate issued in the name MIKL LIMITED, which has been revoked.  The following command line arguments are also supported:</p>
<table style="width: 804px;" width="623">
<tbody>
<tr>
<td style="width: 276px;">Command Line</td>
<td style="width: 513.6px;">Description</td>
</tr>
<tr>
<td style="width: 276px;">-w</td>
<td style="width: 513.6px;">Work:  This is the default command line parameter and encrypts all files on the host.  It also wipes all free space by creating the following file c:\wipe and filling it with random data the size of the free space available on the drive.  The file is then deleted.  This parameter can also be used to encrypt a single file i.e. -w filename.exe</td>
</tr>
<tr>
<td style="width: 276px;">-r</td>
<td style="width: 513.6px;">Dry Run:  Does not encrypt any files on the host.</td>
</tr>
<tr>
<td style="width: 276px;">-l</td>
<td style="width: 513.6px;">Log:  Creates a log file off the root drive named cl.log.</td>
</tr>
<tr>
<td style="width: 276px;">-f</td>
<td style="width: 513.6px;">File:  Used to encrypt a single file.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 1. Supported command line arguments</em></span></p>
<h2>Encryption</h2>
<p>LockerGoga uses the Cryptopp library to implement RSA, as implementing RSA from scratch would be very time consuming and error prone.  To encrypt files, (Strong RSA) RSA-OAEP MGF1(SHA-1) is used.  The RSA public key found in this sample is:</p>
<table style="width: 779px;" width="623">
<tbody>
<tr>
<td style="width: 769.6px;"><span style="font-family: 'courier new', courier, monospace;">00000000   4D 49 47 64 4D 41 30 47  43 53 71 47 53 49 62 33   MIGdMA0GCSqGSIb3</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000016   44 51 45 42 41 51 55 41  41 34 47 4C 41 44 43 42   DQEBAQUAA4GLADCB</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000032   68 77 4B 42 67 51 43 46  66 33 43 54 59 79 41 79   hwKBgQCFf3CTYyAy</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000048   6F 79 5A 71 52 33 6E 48  63 4C 4A 2B 49 2F 71 69   oyZqR3nHcLJ+I/qi</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000064   2F 50 57 77 57 54 75 6C  20 6C 4D 69 4E 32 54 47   /PWwWTul lMiN2TG</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000080   4D 41 4D 62 34 39 75 58  51 32 79 43 34 4D 5A 76   MAMb49uXQ2yC4MZv</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000096   5A 76 4B 53 50 55 44 6F  33 61 4D 67 5A 4A 71 30   ZvKSPUDo3aMgZJq0</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000112   78 75 52 53 42 34 58 6F  73 6D 73 30 5A 39 51 4B   xuRSB4Xosms0Z9QK</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000128   70 76 47 6C 6A 4E 48 36  79 34 50 59 4E 39 38 2F   pvGljNH6y4PYN98/</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000144   76 20 79 31 7A 4F 6B 34  70 45 69 53 68 43 32 49   v y1zOk4pEiShC2I</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000160   47 46 50 4A 32 47 71 33  4F 63 2B 41 78 4F 37 57   GFPJ2Gq3Oc+AxO7W</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000176   6F 2F 62 42 76 35 34 32  52 51 30 67 50 55 77 7A   o/bBv542RQ0gPUwz</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000192   79 54 53 66 71 6A 44 47  35 33 35 73 38 57 73 76   yTSfqjDG535s8Wsv</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000208   4B 73 79 77 49 42 45 51  3D 3D                     KsywIBEQ==</span></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 2. RSA Public key found in initial LockerGoga sample</em></span></p>
<p>Although RSA-OAEP MGF1 has features that make it more secure, the added computational overhead causes encryption to take longer and has difficulty handling large files.  To mitigate this, the developers launch multiple child processes that work in parallel to maximize encryption speed.  To overcome large files, the developers decided to encrypt chunks of a file every 80,000 bytes and skip the next 80,000 bytes of a file.  Example:</p>
<p style="text-align: center;"><em><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96523" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks.png" alt="" width="1657" height="839" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks.png 1657w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks-900x456.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks-300x152.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks-768x389.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks-1024x518.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1Data-Encrypted-in-80000-byte-chunks-370x187.png 370w" sizes="(max-width: 1657px) 100vw, 1657px" /></a><span style="font-size: 10pt;">Figure 1. Data encrypted in 80,000 byte chunks</span></em></p>
<p>Because of this, partial recovery of large files might be possible even without the decryption key.</p>
<p>Although the developers attempt to use a denylist of files and directories to skip, it was observed encrypting core Windows operating system files, which caused the operating system to become unstable and crash. This was observed when running the ransomware on a Windows 2012 machine.</p>
<h2>Early Development</h2>
<p>Based on our analysis, we believe this variant is an early release of LockerGoga ransomware. The developers left behind command line parameters such as -r which allows the malware to run without encrypting anything.  This can be used in conjunction with -l (log) to test how the ransomware behaves.  Both of these parameters are suggestive of an initial, or test, build.  The -r specifically was not observed in later variants.</p>
<p>According to the Bleeping Computer report, the ransomware appeared to encrypt only the following specific file extensions: doc|dot|wbk|docx|dotx|docb|xlm|xlsx|xltx|xlsb|xlw|ppt|pot|pps|pptx|potx|ppsx|sldx|pdf.</p>
<p>Our analysis found that the malware does not use the code block that checks for specific file extensions.  Instead, we observed that the malware encrypts all files except those in the denylist. It also has issues with large files, which is addressed in later variants.</p>
<h2>Development Cycle</h2>
<p>Like other active software projects, the LockerGoga ransomware is under constant development with new variants being developed and used to attack victims.  All these variants share similar characteristics and just like other professional development, each release contains improvements or new capabilities.</p>
<p>To counter this ongoing development cycle, security researchers have to focus on identifying new variants.</p>
<p>To that end, we highlight some of the evolutionary changes we have observed since the malware surfaced in January:</p>
<ul>
<li>Dropped the -r and -f command line arguments</li>
<li>Log file renamed from cl.log to .log</li>
<li>Ransomware note is no longer encoded in the binary</li>
<li>Ransomware note renamed from README_NOW.txt to README_LOCKED.TXT</li>
<li>Added the following command line parameters:</li>
</ul>
<table width="354">
<tbody>
<tr>
<td width="102">Parameter</td>
<td width="252">Description</td>
</tr>
<tr>
<td width="102">-i</td>
<td width="252">Inter process communication (IPC)</td>
</tr>
<tr>
<td width="102">-s</td>
<td width="252">Slave (child process)</td>
</tr>
<tr>
<td width="102">-m</td>
<td width="252">Master Process</td>
</tr>
</tbody>
</table>
<ul>
<li>Began using mutexes (example: SM-zzbdrimp) to identify processes for inter-process communication.</li>
<li>Stopped using svch0st[numeric value].exe as a process name and began using distinct hard-coded names for each sample.</li>
<li>Uses undocumented Windows API calls (for example NtQuerySection)</li>
<li>Changes administrator password to HuHuHUHoHo283283@dJD</li>
<li>Stopped creating a wipe file to erase free space and instead uses Windows cipher.exe with command parameter /w to wipe free space on the host</li>
<li>Added importation of WS2_32.dll, possibly to support network communications</li>
<li>Changed the format and collection of data recorded in the log file</li>
<li>Updated encryption of files and directories. No longer encrypts all files on the host: instead targets specific file extensions and directories</li>
<li>Calls into Windows Restart Manager session for possible token elevation to overwrite trusted installer files</li>
<li>Uses the following digital signers:
<ul>
<li>ALISA LTD</li>
<li>KITTY&#8217;S LTD</li>
<li>MIKL LIMITED</li>
</ul>
</li>
<li>Logs off the current user</li>
<li>The inclusion of the word “Goga” in the binary and encrypted files</li>
</ul>
<h2>Conclusion</h2>
<p>LockerGoga’s developers continue to add capabilities and launch new attacks.  The addition of WS2_32.dll and use of undocumented Windows API calls indicates a level of sophistication beyond typical ransomware authors. The former could lead to the eventual inclusion of C2 communication or automated propagation, and the latter requires some working knowledge of Windows internals.</p>
<p>These features raise more questions about the actor’s intent as ransomware is typically one of the least advanced forms of malware:  Are they motivated by profits or something else? Has the motive change over time?  Why would developers put such effort into their work only to partially encrypt files. Why do they include an email address and not seek payment through more frequently used cryptocurrencies?</p>
<p>We do not know if any of the victims have paid the ransom and were able to successfully retrieve their data. We do know that this ransomware has caused significant harm. The damage could increase significantly if  the attackers continue to refine this ransomware. Unit 42 will continue to monitor LockerGoga and report on new activity.</p>
<p>WildFire properly identifies all of the malware samples listed in this report as malicious. Traps prevents execution of LockerGoga samples and AutoFocus customers can view LockerGoga samples using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.LockerGoga">LockerGoga</a> tag.</p>
<p><span style="font-size: 10pt;">Palo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit <a href="http://www.cyberthreatalliance.org" target="_blank" rel="noopener noreferrer">www.cyberthreatalliance.org</a>.</span></p>
<h2>Indicators of Compromise</h2>
<h3>LockerGoga Samples</h3>
<p><span style="font-family: 'courier new', courier, monospace;">ae7e9839b7fb750128147a9227d3733dde2faacd13c478e8f4d8d6c6c2fc1a55</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">f474a8c0f66dee3d504fff1e49342ee70dd6f402c3fa0687b15ea9d0dd15613a</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">ffab69deafa647e2b54d8daf8c740b559a7982c3c7c1506ac6efc8de30c37fd5</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">c1670e190409619b5a541706976e5a649bef75c75b4b82caf00e9d85afc91881</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">65d5dd067e5550867b532f4e52af47b320bd31bc906d7bf5db889d0ff3f73041</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">31fdce53ee34dbc8e7a9f57b30a0fbb416ab1b3e0c145edd28b65bd6794047c1</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">32d959169ab8ad7e9d4bd046cdb585036c71380d9c45e7bb9513935cd1e225b5</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">e00a36f4295bb3ba17d36d75ee27f7d2c20646b6e0352e6d765b7ac738ebe5ee</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">6d8f1a20dc0b67eb1c3393c6c7fc859f99a12abbca9c45dcbc0efd4dc712fb7c</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">79c11575f0495a3daaf93392bc8134c652360c5561e6f32d002209bc41471a07</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">050b4028b76cd907aabce3d07ebd9f38e56c48c991378d1c65442f9f5628aa9e</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">1f9b5fa30fd8835815270f7951f624698529332931725c1e17c41fd3dd040afe</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">276104ba67006897630a7bdaa22343944983d9397a538504935f2ec7ac10b534</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">88d149f3e47dc337695d76da52b25660e3a454768af0d7e59c913995af496a0f</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">c97d9bbc80b573bdeeda3812f4d00e5183493dd0d5805e2508728f65977dda15</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">06e3924a863f12f57e903ae565052271740c4096bd4b47c38a9604951383bcd1</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">a845c34b0f675827444d6c502c0c461ed4445a00d83b31d5769646b88d7bbedf</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">7bcd69b3085126f7e97406889f78ab74e87230c11812b79406d723a80c08dd26</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">ba15c27f26265f4b063b65654e9d7c248d0d651919fafb68cb4765d1e057f93f</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">eda26a1cd80aac1c42cdbba9af813d9c4bc81f6052080bc33435d1e076e75aa0</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">7852b47e7a9e3f792755395584c64dd81b68ab3cbcdf82f60e50dc5fa7385125</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">14e8a8095426245633cd6c3440afc5b29d0c8cd4acefd10e16f82eb3295077ca</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">47f5a231f7cd0e36508ca6ff8c21c08a7248f0f2bd79c1e772b73443597b09b4</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">f3c58f6de17d2ef3e894c09bc68c0afcce23254916c182e44056db3cad710192</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">9128e1c56463b3ce7d4578ef14ccdfdba15ccc2d73545cb541ea3e80344b173c</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">c3d334cb7f6007c9ebee1a68c4f3f72eac9b3c102461d39f2a0a4b32a053843a</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">6e69548b1ae61d951452b65db15716a5ee2f9373be05011e897c61118c239a77</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">8cfbd38855d2d6033847142fdfa74710b796daf465ab94216fbbbe85971aee29</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">bdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">5b0b972713cd8611b04e4673676cdff70345ac7301b2c23173cdfeaff564225c</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">c7a69dcfb6a3fe433a52a71d85a7e90df25b1db1bc843a541eb08ea2fd1052a4</span></p>
<h2>Appendix</h2>
<p>The latest variant of LockerGoga uses memory mapped files to communicate between processes.  To illustrate this, we captured the memory of a section created by a child process.</p>
<table style="width: 785px;" width="623">
<tbody>
<tr>
<td style="width: 776px;"><span style="font-family: 'courier new', courier, monospace;">00000000   02 00 00 00 00 00 00 00  00 00 00 00 01 00 00 00                  </span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000016   D0 02 01 00 CC 02 01 00  C8 02 01 00 30 00 00 00   Ð   Ì   È   0  </span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000032   80 02 01 00 F8 FF 0F 00  00 00 00 00 00 00 00 00   €   øÿ         </span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000048   FF FF FF FF 00 00 00 00  01 00 00 00 24 00 00 00   ÿÿÿÿ        $  </span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000064   20 00 00 00 1C 00 00 00  00 00 00 00 01 00 00 00                  </span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000080   FC FF FF FF F8 FF FF FF  F4 FF 01 00 0B 20 00 C0   üÿÿÿøÿÿÿôÿ     À</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000096   DE FF FF FF 01 00 00 00  01 00 00 00 38 00 01 00   Þÿÿÿ        8  </span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000112   01 00 04 21 10 01 00 00  00 00 00 00 00 7A 70 63      !         zpc</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000128   55 48 4A 76 5A 33 4A 68  62 53 42 47 61 57 78 6C   UHJvZ3JhbSBGaWxl</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000144   63 31 78 57 54 58 64 68  63 6D 56 63 56 6B 31 33   c1xWTXdhcmVcVk13</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000160   59 58 4A 6C 49 46 52 76  62 32 78 7A 58 47 64 73   YXJlIFRvb2xzXGds</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000176   61 57 49 74 4D 69 34 77  4C 6D 52 73 62 41 3D 3D   aWItMi4wLmRsbA==</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000192   64 48 42 6A 63 48 4D 75  5A 47 78 73 63 6D 56 7A   dHBjcHMuZGxscmVz</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000208   65 43 35 6B 62 47 77 75  62 58 56 70 4E 46 39 66   eC5kbGwubXVpNF9f</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000224   4F 48 64 6C 61 33 6C 69  4D 32 51 34 59 6D 4A 33   OHdla3liM2Q4YmJ3</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000240   5A 54 68 68 5A 44 46 68  4E 7A 51 77 4C 54 52 68   ZThhZDFhNzQwLTRh</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000256   4E 32 59 74 4E 47 45 78  59 53 30 35 4F 54 45 78   N2YtNGExYS05OTEx</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000272   4C 54 51 79 4D 57 51 30  4D 6A 49 34 4D 7A 52 6C   LTQyMWQ0MjI4MzRl</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000288   5A 46 78 42 63 33 4E 6C  64 48 4E 63 55 6D 56 7A   ZFxBc3NldHNcUmVz</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000304   62 33 56 79 59 32 56 7A  58 46 4A 6C 63 58 56 70   b3VyY2VzXFJlcXVp</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000320   63 6D 56 6B 55 48 4A 70  62 6E 52 44 59 58 42 68   cmVkUHJpbnRDYXBh</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000336   59 6D 6C 73 61 58 52 70  5A 58 4D 75 65 47 31 73   YmlsaXRpZXMueG1s</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000352   65 6D 55 74 4E 44 68 66  59 57 78 30 5A 6D 39 79   emUtNDhfYWx0Zm9y</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000368   62 53 31 31 62 6E 42 73  59 58 52 6C 5A 43 35 77   bS11bnBsYXRlZC5w</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000384   62 6D 63 3D 62 53 31 31  62 6E 42 73 59 58 52 6C   bmc=bS11bnBsYXRl</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">00000400   5A 43 35 77 62 6D 63 3D  00 00 00 00 00 00 00 00   ZC5wbmc=       </span></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 3. Child process mapped file</em></span></p>
<p>The 1<sup>st</sup> byte (02) instructs the master process to process the data below. The data is base64 encoded in three parts and decodes to the following:</p>
<p>Part 1:</p>
<p><span style="font-family: 'courier new', courier, monospace;">Unknown value</span></p>
<p>Part 2:</p>
<p><span style="font-family: 'courier new', courier, monospace;">tpcps.dllresx.dll.mui4__8wekyb3d8bbwe8ad1a740-4a7f-4a1a-9911-421d422834ed\Assets\Resources\RequiredPrintCapabilities.xmlze-48_altform-unplated.png</span></p>
<p>Part 3:</p>
<p><span style="font-family: 'courier new', courier, monospace;">m-unplated.png</span></p>
<p>Example of initial variant of LockerGoga running on a host:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96527" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running.png" alt="" width="1555" height="401" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running.png 1555w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running-900x232.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running-300x77.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running-768x198.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running-1024x264.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2-Initial-LockerGoga-Running-370x95.png 370w" sizes="(max-width: 1555px) 100vw, 1555px" /></a></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure  2. Initial LockerGoga running</em></span></p>
<p>Initial LockerGoga Ransom Note:</p>
<table width="623">
<tbody>
<tr>
<td width="623">Greetings!</p>
<p>&nbsp;</p>
<p>There was a significant flaw in the security system of your company.</p>
<p>You should be thankful that the flaw was exploited by serious people and not some rookies.</p>
<p>They would have damaged all of your data by mistake or for fun.</p>
<p>&nbsp;</p>
<p>Your files are encrypted with the strongest military algorithms RSA4096 and AES-256.</p>
<p>Without our special decoder it is impossible to restore the data.</p>
<p>Attempts to restore your data with third party software as Photorec, RannohDecryptor etc.</p>
<p>will lead to irreversible destruction of your data.</p>
<p>&nbsp;</p>
<p>To confirm our honest intentions.</p>
<p>Send us 2-3 different random files and you will get them decrypted.</p>
<p>It can be from different computers on your network to be sure that our decoder decrypts everything.</p>
<p>Sample files we unlock for free (files should not be related to any kind of backups).</p>
<p>&nbsp;</p>
<p>We exclusively have decryption software for your situation</p>
<p>&nbsp;</p>
<p>DO NOT RESET OR SHUTDOWN &#8211; files may be damaged.</p>
<p>DO NOT RENAME the encrypted files.</p>
<p>DO NOT MOVE the encrypted files.</p>
<p>This may lead to the impossibility of recovery of the certain files.</p>
<p>&nbsp;</p>
<p>To get information on the price of the decoder contact us at:</p>
<p>CottleAkela@protonmail.com;QyavauZehyco1994@o2.pl</p>
<p>The payment has to be made in Bitcoins.</p>
<p>The final price depends on how fast you contact us.</p>
<p>As soon as we receive the payment you will get the decryption tool and</p>
<p>instructions on how to improve your systems security</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 3. Initial LockerGoga ransom note</em></span></p>
<p>&nbsp;</p>
<p>Latest LockerGoga Ransom Note:</p>
<table width="623">
<tbody>
<tr>
<td width="623">Greetings!</p>
<p>&nbsp;</p>
<p>There was a significant flaw in the security system of your company.</p>
<p>You should be thankful that the flaw was exploited by serious people and not some rookies.</p>
<p>They would have damaged all of your data by mistake or for fun.</p>
<p>&nbsp;</p>
<p>Your files are encrypted with the strongest military algorithms RSA4096 and AES-256.</p>
<p>Without our special decoder it is impossible to restore the data.</p>
<p>Attempts to restore your data with third party software as Photorec, RannohDecryptor etc.</p>
<p>will lead to irreversible destruction of your data.</p>
<p>&nbsp;</p>
<p>To confirm our honest intentions.</p>
<p>Send us 2-3 different random files and you will get them decrypted.</p>
<p>It can be from different computers on your network to be sure that our decoder decrypts everything.</p>
<p>Sample files we unlock for free (files should not be related to any kind of backups).</p>
<p>&nbsp;</p>
<p>We exclusively have decryption software for your situation</p>
<p>&nbsp;</p>
<p>DO NOT RESET OR SHUTDOWN &#8211; files may be damaged.</p>
<p>DO NOT RENAME the encrypted files.</p>
<p>DO NOT MOVE the encrypted files.</p>
<p>This may lead to the impossibility of recovery of the certain files.</p>
<p>&nbsp;</p>
<p>The payment has to be made in Bitcoins.</p>
<p>The final price depends on how fast you contact us.</p>
<p>As soon as we receive the payment you will get the decryption tool and</p>
<p>instructions on how to improve your systems security</p>
<p>&nbsp;</p>
<p>To get information on the price of the decoder contact us at:</p>
<p>&nbsp;</p>
<p>MayarChenot@protonmail.com</p>
<p>QicifomuEjijika@o2.pl</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 4. Latest LockerGoga ransom note</em></span></p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
