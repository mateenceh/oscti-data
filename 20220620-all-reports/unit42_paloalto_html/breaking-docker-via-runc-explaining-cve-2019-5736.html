
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Breaking out of Docker via runC – Explaining CVE-2019-5736</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/breaking-docker-via-runc-explaining-cve-2019-5736/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Breaking out of Docker via runC – Explaining CVE-2019-5736" />
<meta property="og:description" content="This post is also available in: 日本語 (Japanese)Last week (2019-02-11) a new vulnerability in runC was reported by its maintainers, originally found by Adam Iwaniuk and Borys Poplawski. Dubbed CVE-2019-5736, it affects Docker containers running in default settings and can be used by an attacker to gain root-level access on the host. Aleksa Sarai, one..." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Cloud" />
<meta property="article:tag" content="container breakout" />
<meta property="article:tag" content="container escape" />
<meta property="article:tag" content="containers" />
<meta property="article:tag" content="CVE-2019-5736" />
<meta property="article:tag" content="Docker" />
<meta property="article:tag" content="exploit" />
<meta property="article:tag" content="runC" />
<meta property="article:tag" content="vulnerability" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2019-02-21T14:55:07+00:00" />
<meta property="article:modified_time" content="2020-01-16T21:12:42+00:00" />
<meta property="og:updated_time" content="2020-01-16T21:12:42+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger.jpg" />
<meta property="og:image:width" content="900" />
<meta property="og:image:height" content="362" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="This post is also available in: 日本語 (Japanese)Last week (2019-02-11) a new vulnerability in runC was reported by its maintainers, originally found by Adam Iwaniuk and Borys Poplawski. Dubbed CVE-2019-5736, it affects Docker containers running in default settings and can be used by an attacker to gain root-level access on the host. Aleksa Sarai, one..." />
<meta name="twitter:title" content="Breaking out of Docker via runC – Explaining CVE-2019-5736" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Breaking out of Docker via runC – Explaining CVE-2019-5736 Comments Feed" href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/feed/" />
<meta property="og:likes" content="21"/>
<meta property="og:readtime" content="11"/>
<meta property="og:views" content="17,425"/>
<meta property="og:date_created" content="February 21, 2019 at 6:55 AM"/>
<meta property="og:post_length" content="2972"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Yuval Avrahami"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Breaking out of Docker via runC \u2013 Explaining CVE-2019-5736","name":"Breaking out of Docker via runC \u2013 Explaining CVE-2019-5736","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)Last week (2019-02-11) a new vulnerability in runC was reported by its maintainers, originally found by Adam Iwaniuk and Borys Poplawski. Dubbed CVE-2019-5736, it affects Docker containers running in default settings and can be used by an attacker to gain root-level access on the host. Aleksa Sarai, one...","url":"https:\/\/unit42.paloaltonetworks.com\/breaking-docker-via-runc-explaining-cve-2019-5736\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/breaking-docker-via-runc-explaining-cve-2019-5736\/","datePublished":"February 21, 2019","articleBody":"Last week (2019-02-11) a new vulnerability in runC was reported by its maintainers, originally found by Adam Iwaniuk and Borys Poplawski. Dubbed CVE-2019-5736, it affects Docker containers running in default settings and can be used by an attacker to gain root-level access on the host.\r\nAleksa Sarai, one of runC\u2019s maintainers, found that the same fundamental flaw exists in LXC. As opposed to Docker though, only privileged LXC containers are vulnerable. Both runC and LXC were patched and new versions were released.\r\n\r\nThe vulnerability gained a lot of traction and numerous technology sites and commercial companies addressed it in dedicated posts. Here at Twistlock, our CTO John Morello wrote an excellent piece with all the relevant details and the mitigations offered by the Twistlock platform.\r\n\r\nInitially, the official exploit code wasn\u2019t to be released publicly until 2019-02-18, in order to prevent malicious parties from weaponizing it before users have had some time to update. In the following days though, several people decided to release their own exploit code. That led the runC team to eventually release their exploit code earlier (2019-02-13) since \u2013 as they put it \u2013 \u201cthe cat was out of the bag\u201d.\r\n\r\nThis post aims to be a comprehensive technical deep dive into the vulnerability and it\u2019s various exploitation methods.\r\nSo What Is runC?\r\nRunC is a container runtime originally developed as part of Docker and later extracted out as a separate open source tool and library. As a \u201clow level\u201d container runtime, runC is mainly used by \u201chigh level\u201d container runtimes (e.g. Docker) to spawn and run containers, although it can be used as a stand-alone tool.\r\n\u201cHigh level\u201d container runtimes like Docker will normally implement functionalities such as image creation and management and will use runC to handle tasks related to running containers \u2013 creating a container, attaching a process to an existing container (docker exec) and so on.\r\nProcfs\r\nTo understand the vulnerability, we need to go over some procfs basics. The proc filesystem is a virtual filesystem in Linux that presents information primarily about processes, typically mounted to \/proc. It is virtual in a sense that it does not exist on disk. Instead, the kernel creates it in memory. It can be thought of as an interface to system data that the kernel exposes as a filesystem. Each process has its own directory in procfs, at \/proc\/[pid]:\r\n\r\n\r\nAs shown in the image above, \/proc\/self is a symbolic link to the directory of the currently running process (in this case pid 177). Each process\u2019s directory contains several files and directories with information on the process. For the vulnerability, the relevant ones are:\r\n\r\n \t\/proc\/self\/exe \u2013 a symbolic link to the executable file the process is running, and ;\r\n \t\/proc\/self\/fd \u2013 a directory containing the file descriptors open by the process.\r\n\r\nFor example, by listing the files under \/proc\/self using ls \/proc\/self one can see that \/proc\/self\/exe points to the \u2018ls\u2019 executable.\r\n\r\n\r\nThat makes sense as the one accessing \/proc\/self is the \u2018ls\u2019 process that our shell spawned.\r\nThe Vulnerability\r\nLet\u2019s go over the vulnerability overview given by the runC team:\r\n\r\nThe vulnerability allows a malicious container to (with minimal user interaction) overwrite the host runc binary and thus gain root-level code execution on the host. The level of user interaction is being able to run any command ... as root within a container in either of these contexts:\r\n\r\n \tCreating a new container using an attacker-controlled image.\r\n \tAttaching (docker exec) into an existing container which the attacker had previous write access to.\r\n\r\nThose two scenarios might seem different, but both require runC to spin up a new process in a container and are implemented similarly. In both cases, runC is tasked with running a user-defined binary in the container. In Docker, this binary is either the image\u2019s entry point when starting a new container, or docker exec\u2019s argument when attaching to an existing container.\r\n\r\nWhen this user binary is run, it must already be confined and restricted inside the container, or it can jeopardize the host. In order to accomplish that, runC creates a \u2018runC init\u2019 subprocess which places all needed restrictions on itself (such as entering or setting up namespaces) and effectively places itself in the container. Then, the runC init process, now in the container, calls the execve syscall to overwrite itself with the user requested binary.\r\n\r\n\r\n\r\nThis is the method used by runC both for creating new containers and for attaching a process to an existing container.\r\n\r\n\r\n\r\nThe researchers who revealed the vulnerability discovered that an attacker can trick runC into executing itself by asking it to run \/proc\/self\/exe, which is a symbolic link to the runC binary on the host.\r\n\r\n\r\nAn attacker with root access in the container can then use \/proc\/[runc-pid]\/exe as a reference to the runC binary on the host and overwrite it. Root access in the container is required to perform this attack as the runC binary is owned by root.\r\nThe next time runC is executed, the attacker will achieve code execution on the host. Since runC is normally run as root (e.g. by the Docker daemon), the attacker will gain root access on the host.\r\nWhy not runC init?\r\nThe image above might mislead some to believe the vulnerability (i.e. tricking runC into executing itself) is redundant. That is, why can\u2019t an attacker simply overwrite \/proc\/[runc-init-pid]\/exe instead?\r\nA patch for a similar runC vulnerability, CVE-2016-9962, mitigates this kind of attack.\r\nCVE-2016-9962 revealed that the runC init process possessed open file descriptors from the host which could be used by an attacker in the container to traverse the host\u2019s filesystem and thus break out of the container. Part of the patch for this flaw was setting the runc init process as \u2018non-dumpable\u2019 before it entering the container.\r\n\r\nIn the context of CVE-2019-5736, the \u2018non-dumpable\u2019 flag denies other processes from dereferencing \/proc\/[pid]\/exe, and therefore mitigates overwriting the runC binary through \/proc\/[runc-init-pid]\/exe [1]. Calling execve drops this flag though, and hence the new runC process\u2019 \/proc\/[runc-pid]\/exe is accessible.\r\nThe Symlink Problem\r\nThe vulnerability may appear to contradict the way symbolic links are implemented in Linux.\r\nSymbolic links simply hold the path to their target. For a runC process, \/proc\/self\/exe should contain something like \/usr\/sbin\/runc.\r\nWhen a symlink is accessed by a process, the kernel uses the path present in the link to find the target under the root of the accessing process.\r\nThat begs the question \u2013 when a process in the container opens the symbolic link to the runC binary, why doesn\u2019t the kernel searches for the runC path inside the container root?\r\n\r\nThe answer is that \/proc\/[pid]\/exe does not follow the normal semantics for symbolic links. Technically this might count as a violation of POSIX, but as I mentioned earlier procfs is a special filesystem. When a process opens \/proc\/[pid]\/exe, there is none of the normal procedure of reading and following the contents of a symlink. Instead, the kernel just gives you access to the open file entry directly.\r\nExploitation\r\nSoon after the vulnerability was reported, when no POCs were publicly released yet, I attempted to develop my own POC based on the detailed description of the vulnerability given in the LXC patch addressing it. You can find the complete POC code here.\r\n\r\nLet\u2019s break down LXC\u2019s description of the vulnerability:\r\nwhen runC attaches to a container the attacker can trick it into executing itself. This could be done by replacing the target binary inside the container with a custom binary pointing back at the runC binary itself. As an example, if the target binary was \/bin\/bash, this could be replaced with an executable script specifying the interpreter path #!\/proc\/self\/exe\r\nThe \u2018#!\u2019 syntax is called shebang and is used in scripts to specify an interpreter. When the Linux loader encounters the shebang, it runs the interpreter instead of the executable.\r\n\r\nAs seen in the video, the program finally executed by the loader is:\r\n interpreter [optional-arg] executable-path \r\n\r\nWhen the user runs something like docker exec container-name \/bin\/bash, the loader will recognize the shebang in the modified bash and execute the interpreter we specified \u2013 \/proc\/self\/exe, which is a symlink to the runC binary.\r\nWe can proceed to overwrite the runC binary from a separate process in the container through \/proc\/[runc-pid]\/exe.\r\n\r\n\r\nThe attacker can then proceed to write to the target of \/proc\/self\/exe to try and overwrite the runC binary on the host. However in general, this will not succeed as the kernel will not permit it to be overwritten whilst runC is executing.\r\nBasically, we cannot overwrite the runC binary while a process is running it. On the other hand, if the runC process exits, \/proc\/[runc-pid]\/exe will vanish and we will lose the reference to the runC binary. To overcome this, we open \/proc\/[runc-pid]\/exe for reading in our process, which creates a file descriptor at \/proc\/[our-pid]\/fd\/3.\r\nWe then wait for the runC process to exit, and proceed to open \/proc\/[our-pid]\/fd\/3 for writing, and overwrite runC.\r\nHere is the code for overwrite_runc, shortened for brevity:\r\n\r\n\r\n\r\nLet\u2019s see some action! The exploit output shows the steps taken to overwrite runC. You can see that the runC process is running as pid 20054. The video can also be seen here.\r\n\r\nThis method has one setback though \u2013 it requires an additional process to run the attacker code. Since containers are started with only one process (i.e. the Docker\u2019s image entry point), this approach couldn\u2019t be used to create a malicious image that will compromise the host when run.\r\nSome other POCs you might have seen that implement a similar approach are Frichetten\u2019s and feexd\u2019s.\r\nShared Libraries Approach\r\nA different exploitation method is used in the official POC released by runC\u2019s maintainers and is superior to POCs similar to mine since it can be implemented to compromise the host through two separate methods:\r\n\r\n \tWhen a user execs a command into an existing attacker controlled container\r\n \tWhen a user runs a malicious image\r\n\r\nWe\u2019ll now look into building a malicious image since the previous POC already demonstrated the first scenario. The POC I wrote for this method is heavily based on q3k\u2019s POC, which, to the best of my knowledge, was the first published malicious image POC. You can view the full POC code here.\r\n\r\nLet\u2019s go over the Dockerfile used to build the malicious image. First, the entry point of the image is set to \/proc\/self\/exe in order to trick runC into executing itself when the image is run.\r\n# Create a symbolic link to \/proc\/self\/exe and set it as the image entrypoint\r\nRUN set -e -x ;\\\r\n   ln -s \/proc\/self\/exe \/entrypoint\r\nENTRYPOINT [ \"\/entrypoint\" ]\r\nRunC is dynamically linked to several shared libraries at run time, which can be listed using the ldd command.\r\n\r\n\r\n\r\nWhen the runC process is executed in the container, those libraries are loaded into the runC process by the dynamic linker. It is possible to substitute one of those libraries with a malicious version, that will overwrite the runC binary upon being loaded into the runC process.\r\nOur Dockerfile builds a malicious version of the libseccomp library:\r\n\r\n# Append the run_at_link function to the libseccomp-2.3.1\/src\/api.c file and build libseccomp\r\nADD run_at_link.c \/root\/run_at_link.c\r\nRUN set -e -x ;\\\r\n   cd \/root\/libseccomp-2.3.1 ;\\\r\n   cat \/root\/run_at_link.c &gt;&gt; src\/api.c ;\\\r\n   DEB_BUILD_OPTIONS=nocheck dpkg-buildpackage -b -uc -us ;\\\r\n   dpkg -i \/root\/*.deb\r\n\r\nThe Dockerfile appends the content of run_at_link.c to one of libsecomp\u2019s source files. Subsequently, the malicious libsecomp is built.\r\n\r\n\r\n\r\nThe constructor attribute (a GCC-specific syntax) indicates that the run_at_link function is to be executed as an initialization function [2] for libseccomp after the dynamic linker loads the library into the runC process. Since run_at_link will be executed by the runC process, it can access the runC binary at \/proc\/self\/exe.\r\nThe runC process must exit for the runC binary to be writable though. To enforce the exit, run_at_link calls the execve syscall to execute overwrite_runc.\r\n\r\nSince execve doesn\u2019t affect the file descriptors open by the process, the same file descriptor trick from the previous POC can be used:\r\n\r\n \tThe runC process loads the libseccomp library and transfers execution to the run_at_link function.\r\n \trun_at_link opens the runC binary for reading through \/proc\/self\/exe. This creates a file descriptor at \/proc\/self\/fd\/${runc_fd_read}.\r\n \trun_at_link calls execve to execute overwrite_runc.\r\n \tThe process is no longer running the runC binary, overwrite_runc opens \/proc\/self\/fd\/runc_fd_read for writing and overwrites the runC binary.\r\n\r\nFor the following video, I built a malicious image that overwrites the runC binary with a simple script that spawns a reverse shell at port 2345. \r\n\r\nThe docker run command executes runC twice. Once to create and run the container, which executes the POC to overwrite runC, and then again to stop the container using runc delete [3].\r\nThe second time runC is executed, it is already overwritten, and hence the reverse shell script is executed instead.\r\nThe Fix\r\nRunC and LXC were both patched using the same approach, which is described clearly in the LXC patch commit:\r\nTo prevent this attack, LXC has been patched to create a temporary copy of the calling binary itself when it starts or attaches to containers. To do this LXC creates an anonymous, in-memory file using the memfd_create() system call and copies itself into the temporary in-memory file, which is then sealed to prevent further modifications. LXC then executes this sealed, in-memory file instead of the original on-disk binary. Any compromising write operations from a privileged container to the host LXC binary will then write to the temporary in-memory binary and not to the host binary on-disk, preserving the integrity of the host LXC binary. Also as the temporary, in-memory LXC binary is sealed, writes to this will also fail.\r\nRunC has been patched using the same method. It re-executes from a temporary copy of itself when it starts or attaches to containers. Consequently, \/proc\/[runc-pid]\/exe now points to the temporary file, and the runC binary can\u2019t be reached from within the container.\r\nThe temporary file is also sealed to block writing to it, although overwriting it shouldn\u2019t compromise the host.\r\n\r\nThis patch introduced some issues though. The temporary runC copy is created in-memory after the runc init process has already applied the container\u2019s cgroup memory constraints on itself. For containers running with a relatively low memory limit (e.g 10Mb), this can cause processes in the container to be oom-killed (Out Of Memory killed) by the kernel when the runC init process attaches to the container.\r\n\r\nIf you are interested, an issue regarding this complication was created and contains a discussion about alternative fixes that might not introduce the same problem.\r\nCVE-2019-5736 and Privileged Containers\r\nAs a general rule of thumb, privileged containers (of a given container runtime) are less secure then unprivileged containers (of the same runtime).\r\nEarlier I stated that the vulnerability affects all Docker containers but only LXC\u2019s privileged containers. So why are Docker unprivileged containers vulnerable while LXC unprivileged containers aren\u2019t? Well, it\u2019s because LXC and Docker define privileged containers differently. In fact, Docker unprivileged containers are considered privileged according to LXC philosophy.\r\nPrivileged containers are defined as any container where the container uid 0 is mapped to the host's uid 0.\r\nThe main difference is that LXC runs unprivileged containers in a separate user namespace by default, while Docker doesn\u2019t.\r\nUser namespaces are a feature of Linux that can be used to separate the container root from the host root. The root inside the container, as well as all other users, are mapped to unprivileged users on the host. In other words, a process can have root access for operations inside the container but is unprivileged for operations outside it. If you would like a more in-depth explanation, I recommend LWN\u2019s namespace series\r\n\r\nImage from kinvolk.\r\nSo how does running the container in a user namespace mitigate this vulnerability?\r\nThe attacker is root inside the container but is mapped to an unprivileged user on the host. Therefore, when the attacker tries to open the host\u2019s runC binary for writing, he is denied by the kernel.\r\n\r\nYou might wonder why Docker doesn\u2019t run containers in a separate user namespace by default. It\u2019s because user namespaces do have some drawbacks in the context of containers, which are a bit out of the scope of this post. If you are interested, Docker and rkt (another container runtime) both list the limitations of running containers in user namespaces.\r\nEnding Note\r\nI hope this post gave you a bit of insight into the different aspects of this vulnerability. If you are using either runC, Docker, or LXC, don\u2019t forget to update to the patched version.\r\nFeel free to reach out with any questions you may have through email or @TwistlockLabs.\r\n\r\n\r\n\r\n&nbsp;\r\n[1] As a side note, privileged Docker containers (before the new patch) could use the \/proc\/pid\/exe of the runc init process to overwrite the runC binary. To be exact, the specific privileges required are SYS_CAP_PTRACE and disabling AppArmor.\r\n[2] For those familiar with Windows DLLs, it resembles DllMain.\r\n[3] The container is stopped after overwrite_runc exits, since overwrite_runc was executed as the init process (PID 1) of the container.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2019\/02\/yuvaloger-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Yuval Avrahami"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"100308","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=100308' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbreaking-docker-via-runc-explaining-cve-2019-5736%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbreaking-docker-via-runc-explaining-cve-2019-5736%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-100308 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Breaking out of Docker via runC – Explaining CVE-2019-5736</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-100308 entry-meta">
			
			
			<span class="post-views-count">17,425</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'100308','like')"><i class="ui ui-2"></i><span class="ml-5">21</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 11</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbreaking-docker-via-runc-explaining-cve-2019-5736%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbreaking-docker-via-runc-explaining-cve-2019-5736%2F+-+Breaking+out+of+Docker+via+runC+%E2%80%93+Explaining+CVE-2019-5736" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbreaking-docker-via-runc-explaining-cve-2019-5736%2F&title=Breaking+out+of+Docker+via+runC+%E2%80%93+Explaining+CVE-2019-5736&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/yuval-avrahami/" title="Posts by Yuval Avrahami" class="author url fn" rel="author">Yuval Avrahami</a>        </p>
        <p><time datetime="2019-02-21T14:55:07+00:00">February 21, 2019 at 6:55 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/cloud/" rel="tag">Cloud</a>, <a href="https://unit42.paloaltonetworks.com/tag/container-breakout/" rel="tag">container breakout</a>, <a href="https://unit42.paloaltonetworks.com/tag/container-escape/" rel="tag">container escape</a>, <a href="https://unit42.paloaltonetworks.com/tag/containers/" rel="tag">containers</a>, <a href="https://unit42.paloaltonetworks.com/tag/cve-2019-5736/" rel="tag">CVE-2019-5736</a>, <a href="https://unit42.paloaltonetworks.com/tag/docker/" rel="tag">Docker</a>, <a href="https://unit42.paloaltonetworks.com/tag/exploit/" rel="tag">exploit</a>, <a href="https://unit42.paloaltonetworks.com/tag/runc/" rel="tag">runC</a>, <a href="https://unit42.paloaltonetworks.com/tag/vulnerability/" rel="tag">vulnerability</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="362" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger-900x362.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger.jpg 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger-300x121.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger-768x309.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/yuvaloger-370x149.jpg 370w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/breaking-docker-via-runc-explaining-cve-2019-5736/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>Last week (2019-02-11) a new vulnerability in runC was <a href="https://www.openwall.com/lists/oss-security/2019/02/11/2" target="_blank" rel="noopener noreferrer">reported</a> by its maintainers, originally found by Adam Iwaniuk and Borys Poplawski. Dubbed CVE-2019-5736, it affects Docker containers running in default settings and can be used by an attacker to gain root-level access on the host.<br />
Aleksa Sarai, one of runC’s maintainers, found that the same fundamental flaw exists in LXC. As opposed to Docker though, only privileged LXC containers are vulnerable. Both <a href="https://github.com/opencontainers/runc/commit/6635b4f0c6af3810594d2770f662f34ddc15b40d" target="_blank" rel="noopener noreferrer">runC</a> and <a href="https://github.com/lxc/lxc/commit/6400238d08cdf1ca20d49bafb85f4e224348bf9d" target="_blank" rel="noopener noreferrer">LXC</a> were patched and new versions were released.</p>
<p>The vulnerability gained a lot of traction and numerous technology sites and commercial companies addressed it in dedicated posts. Here at Twistlock, our CTO John Morello wrote an <a href="https://www.twistlock.com/2019/02/11/how-to-mitigate-cve-2019-5736-in-runc-and-docker/" target="_blank" rel="noopener noreferrer">excellent piece</a> with all the relevant details and the mitigations offered by the Twistlock platform.</p>
<p>Initially, the official exploit code wasn’t to be released publicly until 2019-02-18, in order to prevent malicious parties from weaponizing it before users have had some time to update. In the following days though, several people decided to release their own exploit code. That led the runC team to eventually <a href="https://www.openwall.com/lists/oss-security/2019/02/13/3" target="_blank" rel="noopener noreferrer">release their exploit code</a> earlier (2019-02-13) since – as they put it – “the cat was out of the bag”.</p>
<p>This post aims to be a comprehensive technical deep dive into the vulnerability and it’s various exploitation methods.</p>
<h4>So What Is runC?</h4>
<p>RunC is a container runtime originally developed as part of Docker and later extracted out as a separate open source tool and library. As a “low level” container runtime, runC is mainly used by “high level” container runtimes (e.g. Docker) to spawn and run containers, although it can be used as a stand-alone tool.<br />
“High level” container runtimes like Docker will normally implement functionalities such as image creation and management and will use runC to handle tasks related to running containers – creating a container, attaching a process to an existing container (docker exec) and so on.</p>
<h4>Procfs</h4>
<p>To understand the vulnerability, we need to go over some procfs basics. The proc filesystem is a virtual filesystem in Linux that presents information primarily about processes, typically mounted to /proc. It is virtual in a sense that it does not exist on disk. Instead, the kernel creates it in memory. It can be thought of as an interface to system data that the kernel exposes as a filesystem. Each process has its own directory in procfs, at /proc/[pid]:</p>
<p><img class="size-full wp-image-9482 aligncenter" src="https://www.twistlock.com/wp-content/uploads/2019/03/procfs1-1.jpg" alt="" width="512" height="194" /><br />
As shown in the image above, /proc/self is a symbolic link to the directory of the currently running process (in this case pid 177). Each process’s directory contains several files and directories with information on the process. For the vulnerability, the relevant ones are:</p>
<ul style="padding-left: 50px;">
<li>/proc/self/exe – a symbolic link to the executable file the process is running, and ;</li>
<li>/proc/self/fd – a directory containing the file descriptors open by the process.</li>
</ul>
<p>For example, by listing the files under /proc/self using <tt style="background-color: aliceblue;">ls /proc/self</tt> one can see that /proc/self/exe points to the ‘ls’ executable.</p>
<p><img class="size-full wp-image-9483 aligncenter" src="https://www.twistlock.com/wp-content/uploads/2019/03/procfs2.jpg" alt="" width="530" height="45" /><br />
That makes sense as the one accessing /proc/self is the ‘ls’ process that our shell spawned.</p>
<h2>The Vulnerability</h2>
<p>Let’s go over the vulnerability overview given by the runC team:</p>
<p><tt>The vulnerability allows a malicious container to (with minimal user interaction) overwrite the host runc binary and thus gain root-level code execution on the host. The level of user interaction is being able to run any command ... as root within a container in either of these contexts:</tt></p>
<ul style="padding-left: 50px;">
<li><tt>Creating a new container using an attacker-controlled image.</tt></li>
<li><tt>Attaching (docker exec) into an existing container which the attacker had previous write access to.</tt></li>
</ul>
<p>Those two scenarios might seem different, but both require runC to spin up a new process in a container and are implemented similarly. In both cases, runC is tasked with running a user-defined binary in the container. In Docker, this binary is either the image’s entry point when starting a new container, or docker exec’s argument when attaching to an existing container.</p>
<p>When this user binary is run, it must already be confined and restricted inside the container, or it can jeopardize the host. In order to accomplish that, runC creates a ‘runC init’ subprocess which places all needed restrictions on itself (such as entering or setting up namespaces) and effectively places itself in the container. Then, the runC init process, now in the container, <a href="https://github.com/opencontainers/runc/blob/751f18de2af90495e9c5665b95bfc7adf66ddd57/libcontainer/standard_init_linux.go#L206" target="_blank" rel="noopener noreferrer">calls</a> the execve syscall to overwrite itself with the user requested binary.</p>
<p><img class="alignnone size-full wp-image-9487" src="https://www.twistlock.com/wp-content/uploads/2019/03/execve1-1.jpg" alt="" width="800" height="83" /></p>
<p>This is the method used by runC both for creating new containers and for attaching a process to an existing container.</p>
<p><img class="alignnone size-full wp-image-9485" src="https://www.twistlock.com/wp-content/uploads/2019/03/runc_init1.jpg" alt="" width="1183" height="398" /></p>
<p>The researchers who revealed the vulnerability discovered that an attacker can trick runC into executing itself by asking it to run /proc/self/exe, which is a symbolic link to the runC binary on the host.</p>
<p><img class="alignnone size-full wp-image-9486" src="https://www.twistlock.com/wp-content/uploads/2019/03/runc_init2.jpg" alt="" width="1183" height="398" /><br />
An attacker with root access in the container can then use /proc/[runc-pid]/exe as a reference to the runC binary on <strong>the host</strong> and overwrite it. Root access in the container is required to perform this attack as the runC binary is owned by root.<br />
The next time runC is executed, the attacker will achieve code execution on the host. Since runC is normally run as root (e.g. by the Docker daemon), the attacker will gain root access on the host.</p>
<h4>Why not runC init?</h4>
<p>The image above might mislead some to believe the vulnerability (i.e. tricking runC into executing itself) is redundant. That is, why can’t an attacker simply overwrite /proc/[<b>runc-init-pid</b>]/exe instead?<br />
A patch for a similar runC vulnerability, <a href="https://bugzilla.suse.com/show_bug.cgi?id=1012568" target="_blank" rel="noopener noreferrer">CVE-2016-9962</a>, mitigates this kind of attack.<br />
CVE-2016-9962 revealed that the runC init process possessed open file descriptors from the host which could be used by an attacker in the container to traverse the host’s filesystem and thus break out of the container. Part of the patch for this flaw was setting the runc init process as ‘non-dumpable’ before it entering the container.</p>
<p>In the context of CVE-2019-5736, the ‘non-dumpable’ flag denies other processes from dereferencing /proc/[pid]/exe, and therefore mitigates overwriting the runC binary through /proc/[runc-init-pid]/exe <a id="back1" href="#footnote1" rel="noopener noreferrer">[1]</a>. Calling execve drops this flag though, and hence the new runC process’ /proc/[runc-pid]/exe is accessible.</p>
<h4>The Symlink Problem</h4>
<p>The vulnerability may appear to contradict the way symbolic links are implemented in Linux.<br />
Symbolic links simply hold the path to their target. For a runC process, /proc/self/exe should contain something like /usr/sbin/runc.<br />
When a symlink is accessed by a process, the kernel uses the path present in the link to find the target under the root of the accessing process.<br />
That begs the question – <b>when a process in the container opens the symbolic link to the runC binary, why doesn’t the kernel searches for the runC path inside the container root?</b></p>
<p>The answer is that /proc/[pid]/exe does not follow the normal semantics for symbolic links. Technically this might count as a violation of <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_381" target="_blank" rel="noopener noreferrer">POSIX</a>, but as I mentioned earlier procfs is a special filesystem. When a process opens /proc/[pid]/exe, there is none of the normal procedure of reading and following the contents of a symlink. Instead, the kernel just gives you access to the open file entry directly.</p>
<h2>Exploitation</h2>
<p>Soon after the vulnerability was reported, when no POCs were publicly released yet, I attempted to develop my own POC based on the detailed description of the vulnerability given in the <a href="https://github.com/lxc/lxc/commit/6400238d08cdf1ca20d49bafb85f4e224348bf9d" target="_blank" rel="noopener noreferrer">LXC patch</a> addressing it. You can find the complete POC code <a href="https://github.com/twistlock/RunC-CVE-2019-5736/tree/master/exec_POC" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>Let’s break down LXC’s description of the vulnerability:</p>
<p style="background-color: whitesmoke;"><tt>when runC attaches to a container the attacker can trick it into executing itself. This could be done by replacing the target binary inside the container with a custom binary pointing back at the runC binary itself. As an example, if the target binary was /bin/bash, this could be replaced with an executable script specifying the interpreter path #!/proc/self/exe</tt></p>
<p>The ‘#!’ syntax is called shebang and is used in scripts to specify an interpreter. When the Linux loader encounters the shebang, it runs the interpreter instead of the executable.<script id="asciicast-228389" src="https://asciinema.org/a/228389.js" async="" data-player="[object HTMLDivElement]"></script></p>
<div id="asciicast-container-228389" class="asciicast" style="display: block; float: none; overflow: hidden; padding: 0px; margin: 20px 0px;"><iframe style="overflow: hidden; margin: 0px; border: 0px; display: inline-block; width: 817px; float: none; visibility: visible; height: 643px;" src="https://asciinema.org/a/228389/embed?" id="asciicast-iframe-228389" name="asciicast-iframe-228389" scrolling="no" allowfullscreen="allowfullscreen"></iframe></div>
<p>As seen in the <a href="https://asciinema.org/a/228389" target="_blank" rel="noopener noreferrer">video</a>, the program finally executed by the loader is:<br />
<code class="prettyprint prettyprinted"><span class="pln"> interpreter </span><span class="pun">[</span><span class="pln">optional</span><span class="pun">-</span><span class="pln">arg</span><span class="pun">]</span><span class="pln"> executable</span><span class="pun">-</span><span class="pln">path </span></code></p>
<p>When the user runs something like <tt style="background-color: aliceblue;">docker exec container-name /bin/bash</tt>, the loader will recognize the shebang in the modified bash and execute the interpreter we specified – <tt>/proc/self/exe</tt>, which is a symlink to the runC binary.<br />
We can proceed to overwrite the runC binary from a separate process in the container through <tt>/proc/[runc-pid]/exe</tt>.</p>
<p><img class="size-full wp-image-9505 aligncenter" src="https://www.twistlock.com/wp-content/uploads/2019/03/replace-sh-new.jpg" alt="" width="791" height="252" /></p>
<p style="background-color: whitesmoke;"><tt>The attacker can then proceed to write to the target of /proc/self/exe to try and overwrite the runC binary on the host. However in general, this will not succeed as the kernel will not permit it to be overwritten whilst runC is executing.</tt></p>
<p>Basically, we cannot overwrite the runC binary while a process is running it. On the other hand, if the runC process exits, /proc/[runc-pid]/exe will vanish and we will lose the reference to the runC binary. To overcome this, we open /proc/[runc-pid]/exe for reading in our process, which creates a file descriptor at /proc/[our-pid]/fd/3.<br />
We then wait for the runC process to exit, and proceed to open /proc/[our-pid]/fd/3 for writing, and overwrite runC.<br />
Here is the code for overwrite_runc, shortened for brevity:</p>
<p><img class="size-full wp-image-9504 aligncenter" src="https://www.twistlock.com/wp-content/uploads/2019/03/overwrite_runc-c-new.jpg" alt="" width="691" height="467" /></p>
<p>Let’s see some action! The exploit output shows the steps taken to overwrite runC. You can see that the runC process is running as pid 20054. The video can also be seen <a href="https://asciinema.org/a/228632" target="_blank" rel="noopener noreferrer">here</a>.<script id="asciicast-228632" src="https://asciinema.org/a/228632.js" async="" data-player="[object HTMLDivElement]"></script></p>
<div id="asciicast-container-228632" class="asciicast" style="display: block; float: none; overflow: hidden; padding: 0px; margin: 20px 0px;"><iframe style="overflow: hidden; margin: 0px; border: 0px; display: inline-block; width: 817px; float: none; visibility: visible; height: 643px;" src="https://asciinema.org/a/228632/embed?" id="asciicast-iframe-228632" name="asciicast-iframe-228632" scrolling="no" allowfullscreen="allowfullscreen"></iframe></div>
<p>This method has one setback though – it requires an additional process to run the attacker code. Since containers are started with only one process (i.e. the Docker’s image entry point), this approach couldn’t be used to create a malicious image that will compromise the host when run.<br />
Some other POCs you might have seen that implement a similar approach are <a href="https://github.com/Frichetten/CVE-2019-5736-PoC/blob/master/main.go" target="_blank" rel="noopener noreferrer">Frichetten’s</a> and <a href="https://github.com/feexd/pocs/tree/master/CVE-2019-5736" target="_blank" rel="noopener noreferrer">feexd’s</a>.</p>
<h2>Shared Libraries Approach</h2>
<p>A different exploitation method is used in the official POC released by runC’s maintainers and is superior to POCs similar to mine since it can be implemented to compromise the host through two separate methods:</p>
<ol style="padding-left: 50px;">
<li>When a user execs a command into an existing attacker controlled container</li>
<li>When a user runs a malicious image</li>
</ol>
<p>We’ll now look into building a malicious image since the previous POC already demonstrated the first scenario. The POC I wrote for this method is heavily based on <a href="https://github.com/q3k/cve-2019-5736-poc" target="_blank" rel="noopener noreferrer">q3k’s POC</a>, which, to the best of my knowledge, was the first published malicious image POC. You can view the full POC code <a href="https://github.com/twistlock/RunC-CVE-2019-5736/tree/master/malicious_image_POC" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>Let’s go over the Dockerfile used to build the malicious image. First, the entry point of the image is set to /proc/self/exe in order to trick runC into executing itself when the image is run.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692891341f7831002606" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Create a symbolic link to /proc/self/exe and set it as the image entrypoint
RUN set -e -x ;\
   ln -s /proc/self/exe /entrypoint
ENTRYPOINT [ "/entrypoint" ]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692891341f7831002606-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692891341f7831002606-2">2</div><div class="crayon-num" data-line="crayon-5f692891341f7831002606-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692891341f7831002606-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692891341f7831002606-1"><span class="crayon-p"># Create a symbolic link to /proc/self/exe and set it as the image entrypoint</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692891341f7831002606-2"><span class="crayon-e">RUN </span><span class="crayon-v">set</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5f692891341f7831002606-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">ln</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">proc</span><span class="crayon-o">/</span><span class="crayon-r">self</span><span class="crayon-o">/</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">entrypoint</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692891341f7831002606-4"><span class="crayon-i">ENTRYPOINT</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-s">"/entrypoint"</span><span class="crayon-h"> </span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>RunC is <a href="https://www.ibm.com/developerworks/library/l-dynamic-libraries/index.html" target="_blank" rel="noopener noreferrer">dynamically linked</a> to several shared libraries at run time, which can be listed using the ldd command.</p>
<p><img class="size-full wp-image-9497 aligncenter" src="https://www.twistlock.com/wp-content/uploads/2019/03/runc-shared-libraries.jpg" alt="" width="777" height="126" /></p>
<p>When the runC process is executed in the container, those libraries are loaded into the runC process by the dynamic linker. It is possible to substitute one of those libraries with a malicious version, that will overwrite the runC binary upon being loaded into the runC process.<br />
Our Dockerfile builds a malicious version of the libseccomp library:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69289134202235050522" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">

# Append the run_at_link function to the libseccomp-2.3.1/src/api.c file and build libseccomp
ADD run_at_link.c /root/run_at_link.c
RUN set -e -x ;\
   cd /root/libseccomp-2.3.1 ;\
   cat /root/run_at_link.c &amp;gt;&amp;gt; src/api.c ;\
   DEB_BUILD_OPTIONS=nocheck dpkg-buildpackage -b -uc -us ;\
   dpkg -i /root/*.deb
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69289134202235050522-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69289134202235050522-2">2</div><div class="crayon-num" data-line="crayon-5f69289134202235050522-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69289134202235050522-4">4</div><div class="crayon-num" data-line="crayon-5f69289134202235050522-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69289134202235050522-6">6</div><div class="crayon-num" data-line="crayon-5f69289134202235050522-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69289134202235050522-8">8</div><div class="crayon-num" data-line="crayon-5f69289134202235050522-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69289134202235050522-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f69289134202235050522-2"><span class="crayon-p"># Append the run_at_link function to the libseccomp-2.3.1/src/api.c file and build libseccomp</span></div><div class="crayon-line" id="crayon-5f69289134202235050522-3"><span class="crayon-e">ADD </span><span class="crayon-v">run_at_link</span><span class="crayon-sy">.</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">root</span><span class="crayon-o">/</span><span class="crayon-v">run_at_link</span><span class="crayon-sy">.</span><span class="crayon-i">c</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69289134202235050522-4"><span class="crayon-e">RUN </span><span class="crayon-v">set</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5f69289134202235050522-5"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">cd</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">root</span><span class="crayon-o">/</span><span class="crayon-v">libseccomp</span><span class="crayon-o">-</span><span class="crayon-cn">2.3.1</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69289134202235050522-6"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">cat</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">root</span><span class="crayon-o">/</span><span class="crayon-v">run_at_link</span><span class="crayon-sy">.</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">src</span><span class="crayon-o">/</span><span class="crayon-v">api</span><span class="crayon-sy">.</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5f69289134202235050522-7"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">DEB_BUILD_OPTIONS</span><span class="crayon-o">=</span><span class="crayon-e">nocheck </span><span class="crayon-v">dpkg</span><span class="crayon-o">-</span><span class="crayon-v">buildpackage</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">uc</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">us</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69289134202235050522-8"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">dpkg</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">root</span><span class="crayon-o">/</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-i">deb</span></div><div class="crayon-line" id="crayon-5f69289134202235050522-9">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>The Dockerfile appends the content of run_at_link.c to one of libsecomp’s source files. Subsequently, the malicious libsecomp is built.</p>
<p><img class="alignnone size-full wp-image-9506" src="https://www.twistlock.com/wp-content/uploads/2019/02/run_at_linc-c-new.png" sizes="(max-width: 927px) 100vw, 927px" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/10/run_at_linc-c-new.png 927w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/10/run_at_linc-c-new-300x174.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/10/run_at_linc-c-new-768x446.png 768w" alt="" width="927" height="538" /></p>
<p>The constructor attribute (a GCC-specific syntax) indicates that the run_at_link function is to be executed as an initialization function <a id="back2" href="#footnote2" rel="noopener noreferrer">[2]</a> for libseccomp after the dynamic linker loads the library into the runC process. Since run_at_link will be executed by the runC process, it can access the runC binary at /proc/self/exe.<br />
The runC process must exit for the runC binary to be writable though. To enforce the exit, run_at_link calls the execve syscall to execute overwrite_runc.</p>
<p>Since execve doesn’t affect the file descriptors open by the process, the same file descriptor trick from the previous POC can be used:</p>
<ol style="padding-left: 50px;">
<li>The runC process loads the libseccomp library and transfers execution to the run_at_link function.</li>
<li>run_at_link opens the runC binary for reading through /proc/self/exe. This creates a file descriptor at /proc/self/fd/${runc_fd_read}.</li>
<li>run_at_link calls execve to execute overwrite_runc.</li>
<li>The process is no longer running the runC binary, overwrite_runc opens /proc/self/fd/runc_fd_read for writing and overwrites the runC binary.</li>
</ol>
<p>For the following <a href="https://asciinema.org/a/228625" target="_blank" rel="noopener noreferrer">video</a>, I built a malicious image that overwrites the runC binary with a simple script that spawns a reverse shell at port 2345. <script id="asciicast-228625" src="https://asciinema.org/a/228625.js" async="" data-player="[object HTMLDivElement]"></script></p>
<div id="asciicast-container-228625" class="asciicast" style="display: block; float: none; overflow: hidden; padding: 0px; margin: 20px 0px;"><iframe style="overflow: hidden; margin: 0px; border: 0px; display: inline-block; width: 817px; float: none; visibility: visible; height: 643px;" src="https://asciinema.org/a/228625/embed?" id="asciicast-iframe-228625" name="asciicast-iframe-228625" scrolling="no" allowfullscreen="allowfullscreen"></iframe></div>
<p>The <tt style="background-color: aliceblue;">docker run</tt> command executes runC twice. Once to create and run the container, which executes the POC to overwrite runC, and then again to stop the container using <tt style="background-color: aliceblue;">runc delete</tt> <a id="back3" href="#footnote3" rel="noopener noreferrer">[3]</a>.<br />
The second time runC is executed, it is already overwritten, and hence the reverse shell script is executed instead.</p>
<h2>The Fix</h2>
<p>RunC and LXC were both patched using the same approach, which is described clearly in the LXC patch commit:</p>
<p style="background-color: whitesmoke;"><tt>To prevent this attack, LXC has been patched to create a temporary copy of the calling binary itself when it starts or attaches to containers. To do this LXC creates an anonymous, in-memory file using the memfd_create() system call and copies itself into the temporary in-memory file, which is then sealed to prevent further modifications. LXC then executes this sealed, in-memory file instead of the original on-disk binary. Any compromising write operations from a privileged container to the host LXC binary will then write to the temporary in-memory binary and not to the host binary on-disk, preserving the integrity of the host LXC binary. Also as the temporary, in-memory LXC binary is sealed, writes to this will also fail.</tt></p>
<p>RunC has been patched using the same method. It re-executes from a temporary copy of itself when it starts or attaches to containers. Consequently, /proc/[runc-pid]/exe now points to the temporary file, and the runC binary can’t be reached from within the container.<br />
The temporary file is also <a href="https://manpages.courier-mta.org/htmlman2/memfd_create.2.html" target="_blank" rel="noopener noreferrer">sealed</a> to block writing to it, although overwriting it shouldn’t compromise the host.</p>
<p>This patch introduced some issues though. The temporary runC copy is created in-memory after the runc init process has already applied the container’s cgroup <a href="https://docs.docker.com/config/containers/resource_constraints/" target="_blank" rel="noopener noreferrer">memory constraints</a> on itself. For containers running with a relatively low memory limit (e.g 10Mb), this can cause processes in the container to be oom-killed (Out Of Memory killed) by the kernel when the runC init process attaches to the container.</p>
<p>If you are interested, an <a href="https://github.com/opencontainers/runc/issues/1980" target="_blank" rel="noopener noreferrer">issue</a> regarding this complication was created and contains a discussion about alternative fixes that might not introduce the same problem.</p>
<h2>CVE-2019-5736 and Privileged Containers</h2>
<p>As a general rule of thumb, privileged containers (of a given container runtime) are less secure then unprivileged containers (of the same runtime).<br />
Earlier I stated that the vulnerability affects all Docker containers but only LXC’s privileged containers. So why are Docker unprivileged containers vulnerable while LXC unprivileged containers aren’t? Well, it’s because LXC and Docker define privileged containers differently. In fact, Docker unprivileged containers are considered privileged according to <a href="https://linuxcontainers.org/lxc/security/#privileged-containers" target="_blank" rel="noopener noreferrer">LXC philosophy</a>.</p>
<p style="background-color: whitesmoke;"><tt>Privileged containers are defined as any container where the container uid 0 is mapped to the host's uid 0.</tt></p>
<p>The main difference is that LXC runs unprivileged containers in a separate user namespace by default, while Docker doesn’t.<br />
User namespaces are a feature of Linux that can be used to separate the container root from the host root. The root inside the container, as well as all other users, are mapped to unprivileged users on the host. In other words, a process can have root access for operations inside the container but is unprivileged for operations outside it. If you would like a more in-depth explanation, I recommend LWN’s <a href="https://lwn.net/Articles/531114/" target="_blank" rel="noopener noreferrer">namespace series</a><br />
<img class="size-full wp-image-9498 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/10/unprivileged-builds-userns1.svg" alt="" width="700" height="130" /><br />
<cite style="padding-left: 10px;">Image from <a href="https://kinvolk.io/blog/2018/04/towards-unprivileged-container-builds/#uid-mappings" target="_blank" rel="noopener noreferrer"><i>kinvolk</i></a>.</cite><br />
So how does running the container in a user namespace mitigate this vulnerability?<br />
The attacker is root inside the container but is mapped to an unprivileged user on the host. Therefore, when the attacker tries to open the host’s runC binary for writing, he is denied by the kernel.</p>
<p>You might wonder why Docker doesn’t run containers in a separate user namespace by default. It’s because user namespaces do have some drawbacks in the context of containers, which are a bit out of the scope of this post. If you are interested, <a href="https://docs.docker.com/engine/security/userns-remap/#user-namespace-known-limitations" target="_blank" rel="noopener noreferrer">Docker</a> and <a href="https://coreos.com/rkt/docs/latest/devel/user-namespaces.html" target="_blank" rel="noopener noreferrer">rkt</a> (another container runtime) both list the limitations of running containers in user namespaces.</p>
<h2>Ending Note</h2>
<p>I hope this post gave you a bit of insight into the different aspects of this vulnerability. If you are using either runC, Docker, or LXC, don’t forget to update to the patched version.<br />
Feel free to reach out with any questions you may have through email or <a href="https://twitter.com/TwistlockLabs" target="_blank" rel="noopener noreferrer">@TwistlockLabs</a>.</p>
<hr />
<p>&nbsp;</p>
<p id="footnote1" style="padding-left: 10px;"><a href="#back1" rel="noopener noreferrer">[1]</a> As a side note, privileged Docker containers (before the new patch) could use the /proc/pid/exe of the runc init process to overwrite the runC binary. To be exact, the specific privileges required are SYS_CAP_PTRACE and disabling AppArmor.</p>
<p id="footnote2" style="padding-left: 10px;"><a href="#back2" rel="noopener noreferrer">[2]</a> For those familiar with Windows DLLs, it resembles <tt style="background-color: aliceblue;">DllMain</tt>.</p>
<p id="footnote3" style="padding-left: 10px;"><a href="#back3" rel="noopener noreferrer">[3]</a> The container is stopped after overwrite_runc exits, since overwrite_runc was executed as the init process (PID 1) of the container.</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
