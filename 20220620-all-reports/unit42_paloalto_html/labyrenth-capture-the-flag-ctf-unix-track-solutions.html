
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>LabyREnth Capture the Flag (CTF): Unix Track Solutions</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/labyrenth-capture-the-flag-ctf-unix-track-solutions/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/labyrenth-capture-the-flag-ctf-unix-track-solutions/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Now that LabyREnth Capture the Flag (CTF) challenge is closed, we’ll roll out the solutions for one challenge track per week. This week, the Unix track."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/labyrenth-capture-the-flag-ctf-unix-track-solutions/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="LabyREnth Capture the Flag (CTF): Unix Track Solutions" />
<meta property="og:description" content="Now that LabyREnth Capture the Flag (CTF) challenge is closed, we’ll roll out the solutions for one challenge track per week. This week, the Unix track." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/labyrenth-capture-the-flag-ctf-unix-track-solutions/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="CTF" />
<meta property="article:tag" content="LabyREnth" />
<meta property="article:tag" content="Unix" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2016-08-26T00:00:37+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_1-1-230x282.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Now that LabyREnth Capture the Flag (CTF) challenge is closed, we’ll roll out the solutions for one challenge track per week. This week, the Unix track." />
<meta name="twitter:title" content="LabyREnth Capture the Flag (CTF): Unix Track Solutions" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_1-1-230x282.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; LabyREnth Capture the Flag (CTF): Unix Track Solutions Comments Feed" href="https://unit42.paloaltonetworks.com/labyrenth-capture-the-flag-ctf-unix-track-solutions/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="15,375"/>
<meta property="og:date_created" content="August 25, 2016 at 5:00 PM"/>
<meta property="og:post_length" content="3023"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Richard Wartell"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/richard-wartell/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"LabyREnth Capture the Flag (CTF): Unix Track Solutions","name":"LabyREnth Capture the Flag (CTF): Unix Track Solutions","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)Thanks to the incredibly talented community of threat researchers that participated in LabyREnth, the Unit 42 Capture the Flag (CTF)\u00a0challenge. Now that the challenge is closed, we can finally reveal the solutions of each challenge track. We\u2019ll be rolling out the solutions for one challenge track per week....","url":"https:\/\/unit42.paloaltonetworks.com\/labyrenth-capture-the-flag-ctf-unix-track-solutions\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/labyrenth-capture-the-flag-ctf-unix-track-solutions\/","datePublished":"August 25, 2016","articleBody":"Thanks to the incredibly talented community of threat researchers that participated in LabyREnth, the Unit 42 Capture the Flag (CTF)\u00a0challenge. Now that the challenge is closed, we can finally reveal the solutions of each challenge track. We\u2019ll be rolling out the solutions for one challenge track per week. Next up, the Unix track.\nUnix 1 Challenge: Layers upon layers of _____s of wisdom.\nChallenge Created By: Richard Wartell @wartortell\n\nWe are given a perl script that when executed tells us we are doing a thing and then says stahp.\n\n$perl bowie.pl\nYou're doing a thing...\nAAAA\nstahp\n\nIf we look at the script source, we can see that it has a series of nested if else conditions.\u00a0 At each layer, the script requests user input which it uses for the next if condition.\u00a0 If the if conditions are true, an additional base64 chunk is decoded and appended to the $a variable.\n\nprint \"You're doing a thing...\\n\";\nmy $input = &lt;STDIN&gt;;\n$input = trim($input);\nif ($input eq (chr(5156 - 5035) . chr(-4615 - -4716) . chr(3162 - 3047))) {\n$a = $a . MIME::Base64::decode(\"\u2026\u201d)\n\nThis repeats many times until the last if condition which evals a base64 block.\n\neval MIME::Base64::decode(\"\u2026\u201d)\n\nWe can use python to base64 decode each of these blocks ourselves.\u00a0 When we decode the eval block it has a block that is decoded and appended to the \u2018$a\u2019 variable and another block that is eval\u2019d.\u00a0 This repeats over and over many times.\u00a0 If we grab each block that appends to the \u2018$a\u2019 variable, decode them, and write them to a file, we find that it is a jpg and contains the key.\n\nfrom base64 import b64de\n\na = b64decode(\"R0lGODlh2\na = a + b64decode(\"KmZRg\n\u2026\na = a + b64decode(\"7w3jz\nf = open(\"out.gif\", \"w\")\nf.write(a)\n\nWhen I was working the challenge, I manually kept decoding each block and writing it until I got enough of the picture for the key.\n\n\nJeff White solved the entire solution with a bash one liner that is a thing of beauty.\n\ncp bowie.pl bowie_1 &amp;&amp; for i in $(seq 1 50); do grep -E \"\\$a|eval\" bowie_$i |cut -d\"\\\"\" -f2 |base64 -D &gt; bowie_`expr $i + 1` ; done &amp;&amp; for i in $(grep \"\\$a\" bowie_1 |cut -d\"\\\"\" -f2); do echo $i |base64 -D &gt;&gt; bowie.gif; done &amp;&amp; for i in $(find . -size +2k -ls |cut -d\"\/\" -f2 |grep -vE \"bowie_1$|bowie.pl\" |sort -t _ -k 2 -n); do grep \"\\$a\" $i |cut -d\"\\\"\" -f2 |base64 -D &gt;&gt; bowie.gif; done &amp;&amp; rm bowie_* &amp;&amp; open bowie.gif &amp;&amp; echo \"D4rkCryst4lz\"\nUnix 2 Challenge: Melted cowboys and space wrestling; this isn't the Ninth Wonder of the\u00a0World. Maybe because we're all a little rusty.\nChallenge Created By: Anthony Kasza @anthonykasza\n\nWe are given a 64bit ELF challenge binary.\n\n$file challenge\nchallenge: ELF 64-bit LSB\u00a0 shared object, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU\/Linux 2.6.32, BuildID[sha1]=4570af615de39c4912c17a09f9fbf8419368572b, not stripped\n\nWe start off by running it and see a message that says, \u201cLet\u2019s party like it\u2019s 1999!\u201d and then the html contents of example.com.\n.\/challenge\nLet's party like it's 1999!!\n&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Example Domain&lt;\/title&gt;\n\n    &lt;meta charset=\"utf-8\" \/&gt;\n    &lt;meta http-equiv=\"Content-type\" content=\"text\/html; charset=utf-8\" \/&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" \/&gt;\n    &lt;style type=\"text\/css\"&gt;\n    body {\n        background-color: #f0f0f2;\n        margin: 0;\n        padding: 0;\n        font-family: \"Open Sans\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n\n    }\n    div {\n        width: 600px;\n        margin: 5em auto;\n        padding: 50px;\n        background-color: #fff;\n        border-radius: 1em;\n    }\n    a:link, a:visited {\n        color: #38488f;\n        text-decoration: none;\n    }\n    @media (max-width: 700px) {\n        body {\n            background-color: #fff;\n        }\n        div {\n            width: auto;\n            margin: 0 auto;\n            border-radius: 0;\n            padding: 1em;\n        }\n    }\n    &lt;\/style&gt;\n&lt;\/head&gt;\n\n&lt;body&gt;\n&lt;div&gt;\n    &lt;h1&gt;Example Domain&lt;\/h1&gt;\n    &lt;p&gt;This domain is established to be used for illustrative examples in documents. You may use this\n    domain in examples without prior coordination or asking for permission.&lt;\/p&gt;\n    &lt;p&gt;&lt;a href=\"http:\/\/www.iana.org\/domains\/example\"&gt;More information...&lt;\/a&gt;&lt;\/p&gt;\n&lt;\/div&gt;\n&lt;\/body&gt;\n&lt;\/html&gt;\n\nI perform stings on the binary and see some interesting ones related to dates, example.com, and rust.\n\n\u2026\nhttp:\/\/www.example.com\nstream did not contain valid UTF-8\n1\/1\/1999%d\/%m\/%Y\nThis system is obviously not a 90's kid.1\/1\/2000Possible Y2K issue.\nWhat year is it?!\n%a, %d %b %Y %H:%M:%S GMT\nThat Date isn't RFC compliant\nThat response was not OK\nLet's party like it's 1999!!\n\u2026\nrust_builtin.c\nrust_begin_unwind\nrust_eh_personality\nrust_eh_personality_catch\n\u2026\n\nNext we open it up and look at it in IDA and after demangling the names, we can see a pretty large main function.\u00a0 We can start by using IDA\u2019s cross references on some of those interesting date strings we found earlier.\u00a0 We see that an http request is made to www.example.com and the headers are checked for the date.\u00a0 This gives us a pretty good idea of what we can try to fiddle with.\n\n\n\nI setup an Ubuntu virtual machine on a private virtual network and then created another linked clone to have a server.\u00a0 I changed the hosts file on the client system to point www.example.com to the other server system.\u00a0 I also installed nginx on the server system to have an easy http listener.\n\n\n\nI tried to run the program with the current date and it printed out the nginx response and then I changed the date back to 1999 like the challenge asks and it printed out the key.\n\nPAN{ThaddeusVenture}\n\n\nUnix 3 Challenge: Far above the world sitting in your tin can the stars look very different today\nChallenge Created By: Tyler Halfpop @0xtyh\n\nWe are given an ELF file and when it runs, it draws a nice cat.\n\n$.\/odd8_v1\u00a0\n\nWhen we open it in IDA and go to graph mode in the main function, we can see the key drawn by the nodes.\n\n\n\nThe binary was constructed using the REpsych framework by @xoreaxeaxeax.\nUnix 4 Challenge: Sometimes you find treasure in the oddest of places...\nChallenge Created By: karttoon @noottrak\n\nWe receive this beautiful image to start with.\n\n\n\nI opened the image with my favorite hex editor, 010Editor, and I could see there is a large blob at the end of the image after the FF D9 ending of the jpg.\n\n\n\nI extracted the blob and divided the sections that were separated by tags. There was a coppertunnel, goldtunnel, silvertunnel, and a crystal tunnel. Each section looked like base64, but the padding was at the beginning with the =. I used 010Editor\u2019s built in Ascii reverse script to reverse the text and then 010Editor\u2019s decode base64 script.\u00a0 It looked like I had backwards base64 again, so I repeated this step several times until I got a PK zip header. I did this procedure for each tunnel getting to the file before the zip file and then I used python to write the final file.\n\nfrom base64 import b64decode\n\nci = open(\"coppertunnel.txt\", \"rb\").read()\nco = open(\"copperout.zip\", \"w\")\nco.write(b64decode(ci))\n\nsi = open(\"silvertunnel.txt\", \"rb\").read()\nso = open(\"silverout.zip\", \"w\")\nso.write(b64decode(ci))\n\ngi = open(\"goldtunnel.txt\", \"rb\").read()\ngo = open(\"goldout.zip\", \"w\")\ngo.write(b64decode(ci))\n\ncri = open(\"crystaltunnel.txt\", \"rb\").read()\ncro = open(\"crystalout.zip\", \"w\")\ncro.write(b64decode(ci))\n\nI unzipped the files and saw that I had 4 parts of a Par archive.\n\ntreasure.vol306+306 2.par2\ntreasure.vol306+306 3.par2\ntreasure.vol306+306 4.par2\ntreasure.vol306+306.par2\n\nI did some Googling and found MultiPar to work with the files. I was able to use the Repair function to restore a chest.zip file.\n\n\n\nChest.zip was an encrypted zip file, so I started to look for the password in the original image. I tried steghide and it outputted bards_song, which was a text file with excellent instructions that would have been helpful earlier on, and the password for the zip file.\n\nsteghide.exe extract -sf labyrinth_entrance.jpg\nEnter passphrase:\nwrote extracted data to \"bards_song\".\n\nOver the hills and through the grass\nBy dawn of light in the mountain pass\nThe goblins treasure awaits the steadfast\nWalking in REVerse, the eye opens as you go past\nA smell leads you onward, luring you to follow\nAt the end of each tunnel, a PARt of treasure in the hollow\nCombine them to find a door hidden by rhyme\nOpened once with the words \"aintnobodygottime\"\n\nI was then able to unzip the chest.zip, which gave me a MachO called jareths_maze. I ran it in a VM and I was greeted with this horrifying ascii art.\n\n\n\nI couldn\u2019t let the clowns win, so I had to open the file in IDA. I decompiled main and there were more clowns, but the message was different.\n\n\n\nThen I saw this demoralizing string of function names and I started to get a little freaked out.\n\n\n\nThe program printed the ascii art after going through these functions. I knew that the beginning message wasn\u2019t correct and the ending message wasn\u2019t correct. Each function was overwriting a character in the message and the a group of functions was being overwritten by what the b group of functions was writing.\n\n\n\nI used IDA to jump into each function and grab the ordinal of the character that the message was supposed to be with the a functions and then I used python to convert the ordinal to the character to obtain the key.\n\nPAN{D4nKkry5t4l}\nUnix 5 Challenge: All your filez are belongz to us.\nChallenge Created By: Tyler Halfpop @0xtyh\n\nWe are given a binary called krypto.danger, and if we run file on it, we can see that it is a 64bit Mach-O.\n\nfile krypto.danger\nkrypto.danger: Mach-O 64-bit executable x86_64\n\nA good first step when examining a Mach-O is to check it out in osxreverser\u2019s branch of MachOView to examine the various Mach-O header information and strings, much like you would with a PE file.\n\n\n\nThe next step is to run the binary to get a better understanding of what it does. We should run untrusted binaries in a virtual machine, but we are too busy looking at pictures of Mr. Bigglesworth to be bothered by that. When we run it, our picture of Mr. Bigglesworth gets encrypted and a .laby extension is appended. A menacing narwhal also pops up that ironically tells us \u201cCongratulations! All your pngs are belong to us Pay us all the moneyz \u2013 PANW GSRT\u201d.\u00a0 Not Mr. Bigglesworth! This is war.\n\n\n\nWhen we open the binary in IDA we can see all the ugly mangled Swift names.\n\n\n\nWe can use an IDA Script called SwiftDemang to demangle the Swift names to make it easier to read. After running the script, it is a little easier to look at the function names.\n\n\n\nAfter demangling the functions, we can see some interesting functions like krypto_dkrypt and krypto_ekrypt. Krypto_dkrypt gets called if there is a dekrypt argument. Let\u2019s try to use that to see if we can get Mr. Bigglesworth back.\n\n\n\nNow that we have Mr. Bigglesworth with us again, we can get back to solving the challenge.\u00a0 The dkrypt and ekrypt functions both call an interesting looking function called get_pw that returns a string we can tell from the comment added by SwiftDemang.\n\n\n\nWhen we look at the get_pw we see an interesting looking string highlighted below and calls to RNCryptor. If we Google RNCryptor, we can find an open source Swift version of AES-256, which is being used to encrypt the password that is then used to encrypt or decrypt the files.\n\n\n\nIf we setup remote debugging with IDA and break on the return from get_pw, we can see the key to the challenge in the string pointed to by the return value in RAX at 0x100608101.\n\n\nUnix 6 Challenge: Go forth good language.\nChallenge Created By: Richard Wartell (@wartortell)\n\nFor this challenge, you\u2019re given a server and a client binary, both Mach.O files. If we run the client binary, we can see that it\u2019s asking for a four token key in order to get the \u201cprize\u201d.\n\n\n\nThankfully, these binaries haven\u2019t had their symbols stripped so it\u2019s easy to find interesting functions in the binary. From a quick look at the client library, we can see the strings that were shown above, as well as the client library sending the four tokens you enter to a server:\n\n\n\nSo we need to look into how the server checks the tokens that are sent. When we open up the server in IDA Pro, we can easily see the functions main_check_key1, main_check_key2, main_check_key3, and main_check_key4 being called in a row. If we following them, there is a check which leads to where the real key would be if this was the actual server:\n\n\n\nFrom here, all we need to do is figure out what each token needs to be. From digging through each of the four functions, we can find the tokens that will get us the key:\n\n \tChecks the first message character by character, the token is \u201c3at\u201d\n \tChecks the second message, the length must be 11, and each character is pairwise compared with each one, the differences can be used to determine the characters. The token is \"chInch1ll@z\".\n \tPerforms specific checks on the token against another 4 byte string. The token is \u201cH1gh\u201d.\n \tCompares characters from the token against the string \u201cFromunda\u201d and the number 183. The token is \u201cF183r\u201d\n\nWe know we\u2019ve got the right tokens because we can run the server and client locally, and we get this:\n\n\n\nWhen we connect instead to the IP contained in the directions file and provide the 4 tokens, we get the key:\n\nPAN{th@Nk5_m4r1ha_U_s0_n1c3}\nUnix 7 Challenge: Crack the codes to get the Apple\nChallenge Created By: Tyler Halfpop (@0xtyh)\n\nThis time I was handed an OSX compiled application called RedDelicious. First, I simply ran it (not smart, but I never claimed to be), and got the following window popup:\n\n\n\nSo I entered some text into the window and clicked Submit, which gave me the message \u201cTry harder\u2026\u201d From this I assumed that I would have to submit the right key in order to get a success message and hopefully the key for the challenge. So, now I wanted to disassemble the binary and see what happens when I click \u201cSubmit\u201d.\n\nIn IDA, the first thing I noticed is that most functions start with \u201c__T\u201d, which tells me I\u2019m dealing with a Swift compiled binary, since that is the prefix for all symbols in Swift. Swift is great at making ugly, huge function names, so rather than messing around with demangling them or anything too ugly, I had one lead of the \u201cTry harder\u2026\u201d string from when I entered a wrong key. I looked in the strings window and found references to that function and went back from there:\n\n\n\nThen I saw the same function both referencing the strings \u201cTry harder\u2026\u201d and \u201cC0ngr4tz!\u201d, so I knew I was on the right track. The function that references them looks like this:\n\n\n\nAt the bottom where the code flow splits in two, each path has the same code with a different string reference, so I knew I was in the key check function. Now to figure out how to make it say \u201cC0ngr4tz!\u201d\n\nSwift\u2019s compiler treats variables very similar to C++, passing a reference to \u201cthis\u201d as an argument to functions, and then using it to find other class references. The class jump table for this class is NSViewController, found at 0x100008090. We\u2019ll need this in order to fix up the calls used in the function. After cleaning up all of Swift\u2019s object oriented code and Automatic Reference Counting (ARC), we can dumb this function down into some simpler pseudocode:\n\n&nbsp;\ncheck_key:\n    a = entered_key\n    a = bb64(a)\n    a = xxor(a, \"av9vex8pocs4id2\")\n    a = bb64(a)\n    a = xxor(a, \" abracadabra\")\n    a = bb64(a)\n    if a == \" LyY8TiwwJighJzRSNycvJyU3LzQ1GTc0JlA2ACcGBTcuUSc3JBkZLSoaS1EzUwotBwsDDTQbEiY3Mw0SNDcZVjcLKywjCTpKPApWTw==\":\n        label = \"C0ngr4tz!\"\n    else:\n        \"Try harder...\"\n\nThis gives us a pretty clear idea of what\u2019s going on, but we\u2019ll have to check each of these functions to figure out what they do. After analysis, we find that they do the following different functions:\n\n \tbb64 \u2013 Base64 encode the passed in argument\n \txxor \u2013 XOR the passed string with the provided key\n\nSo, if we write a quick little python script, we can get the key:\nimport base64\n\ndef xxor(plain, key):\n    enc = \"\"\n    for i in range(len(plain)):\n        enc += chr(ord(plain[i]) ^ ord(key[i % len(key)]))\n    return enc\n\na = \"LyY8TiwwJighJzRSNycvJyU3LzQ1GTc0JlA2ACcGBTcuUSc3JBkZLSoaS1EzUwotBwsDDTQbEiY3Mw0SNDcZVjcLKywjCTpKPApWTw==\"\na = base64.b64decode(a)\na = xxor(a, \"abracadabra\")\na = base64.b64decode(a)\na = xxor(a, \"av9vex8pocs4id2\")\na = base64.b64decode(a)\nprint a\n\n\n\n\nAnd the key is: PAN{My_m0th3r_told_m3_2b3_w4ry_of_F@uns}\n\nLeave a comment below to share your thoughts about the Unix track challenges. Be sure to also check out how other threat researchers solved these challenges:\n\nUnix Challenge 1\n\n \thttps:\/\/irq5.io\/2016\/08\/17\/labyrenth-2016-write-up-bowie-pl\/\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-unix-1.py\n\nUnix Challenge 3\n\n \thttp:\/\/www.ghettoforensics.com\/2016\/08\/running-labyrenth-unit-42-ctf.html\n\nUnix Challenge 5\n\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-unix-5.txt\n\nUnix Challenge 6\n\n \thttp:\/\/www.ghettoforensics.com\/2016\/08\/running-labyrenth-unit-42-ctf.html\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-unix-6.py\n\nUnix Challenge 7\n\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-unix-7.txt\n\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Richard Wartell"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"17680","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=17680' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flabyrenth-capture-the-flag-ctf-unix-track-solutions%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flabyrenth-capture-the-flag-ctf-unix-track-solutions%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-17680 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">LabyREnth Capture the Flag (CTF): Unix Track Solutions</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-17680 entry-meta">
			
			
			<span class="post-views-count">15,375</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'17680','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Flabyrenth-capture-the-flag-ctf-unix-track-solutions%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Flabyrenth-capture-the-flag-ctf-unix-track-solutions%2F+-+LabyREnth+Capture+the+Flag+%28CTF%29%3A+Unix+Track+Solutions" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flabyrenth-capture-the-flag-ctf-unix-track-solutions%2F&title=LabyREnth+Capture+the+Flag+%28CTF%29%3A+Unix+Track+Solutions&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/labyrenth-capture-the-flag-ctf-unix-track-solutions/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/richard-wartell/" title="Posts by Richard Wartell" class="author url fn" rel="author">Richard Wartell</a>        </p>
        <p><time datetime="2016-08-26T00:00:37+00:00">August 25, 2016 at 5:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/ctf/" rel="tag">CTF</a>, <a href="https://unit42.paloaltonetworks.com/tag/labyrenth/" rel="tag">LabyREnth</a>, <a href="https://unit42.paloaltonetworks.com/tag/unix/" rel="tag">Unix</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/labyrenth-capture-the-flag-ctf-unix-track-solutions/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>Thanks to the incredibly talented community of threat researchers that participated in <a href="http://researchcenter.paloaltonetworks.com/2016/07/unit42-announcing-the-labyrenth-capture-the-flag-ctf-challenge/" target="_blank">LabyREnth, the Unit 42 Capture the Flag (CTF)</a> challenge. Now that the challenge is closed, we can finally reveal the solutions of each challenge track. We’ll be rolling out the <a href="http://researchcenter.paloaltonetworks.com/tag/ctf/" target="_blank">solutions</a> for one challenge track per week. Next up, the Unix track.<span id="more-17680"></span></p>
<h3>Unix 1 Challenge: Layers upon layers of _____s of wisdom.</h3>
<p><em>Challenge Created By: Richard Wartell <a href="https://twitter.com/wartortell" target="_blank">@wartortell</a></em></p>
<p>We are given a perl script that when executed tells us we are doing a thing and then says stahp.</p>
<p>$perl bowie.pl<br />
You&#8217;re doing a thing&#8230;<br />
AAAA<br />
stahp</p>
<p>If we look at the script source, we can see that it has a series of nested if else conditions.  At each layer, the script requests user input which it uses for the next if condition.  If the if conditions are true, an additional base64 chunk is decoded and appended to the $a variable.</p>
<p>print &#8220;You&#8217;re doing a thing&#8230;\n&#8221;;<br />
my $input = &lt;STDIN&gt;;<br />
$input = trim($input);<br />
if ($input eq (chr(5156 &#8211; 5035) . chr(-4615 &#8211; -4716) . chr(3162 &#8211; 3047))) {<br />
$a = $a . MIME::Base64::decode(&#8220;…”)</p>
<p>This repeats many times until the last if condition which evals a base64 block.</p>
<p>eval MIME::Base64::decode(&#8220;…”)</p>
<p>We can use python to base64 decode each of these blocks ourselves.  When we decode the eval block it has a block that is decoded and appended to the ‘$a’ variable and another block that is eval’d.  This repeats over and over many times.  If we grab each block that appends to the ‘$a’ variable, decode them, and write them to a file, we find that it is a jpg and contains the key.</p>
<p>from base64 import b64de</p>
<p>a = b64decode(&#8220;R0lGODlh2<br />
a = a + b64decode(&#8220;KmZRg<br />
…<br />
a = a + b64decode(&#8220;7w3jz<br />
f = open(&#8220;out.gif&#8221;, &#8220;w&#8221;)<br />
f.write(a)</p>
<p>When I was working the challenge, I manually kept decoding each block and writing it until I got enough of the picture for the key.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_1-1.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17800 size-medium" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_1-1-230x282.png" alt="CTF2_1" width="230" height="282" /></a><br />
Jeff White solved the entire solution with a bash one liner that is a thing of beauty.</p>
<p>cp bowie.pl bowie_1 &amp;&amp; for i in $(seq 1 50); do grep -E &#8220;\$a|eval&#8221; bowie_$i |cut -d&#8221;\&#8221;&#8221; -f2 |base64 -D &gt; bowie_<code>expr $i + 1</code> ; done &amp;&amp; for i in $(grep &#8220;\$a&#8221; bowie_1 |cut -d&#8221;\&#8221;&#8221; -f2); do echo $i |base64 -D &gt;&gt; bowie.gif; done &amp;&amp; for i in $(find . -size +2k -ls |cut -d&#8221;/&#8221; -f2 |grep -vE &#8220;bowie_1$|bowie.pl&#8221; |sort -t _ -k 2 -n); do grep &#8220;\$a&#8221; $i |cut -d&#8221;\&#8221;&#8221; -f2 |base64 -D &gt;&gt; bowie.gif; done &amp;&amp; rm bowie_* &amp;&amp; open bowie.gif &amp;&amp; echo &#8220;D4rkCryst4lz&#8221;</p>
<h3>Unix 2 Challenge: Melted cowboys and space wrestling; this isn&#8217;t the Ninth Wonder of the World. Maybe because we&#8217;re all a little rusty.</h3>
<p><em>Challenge Created By: Anthony Kasza <a href="https://twitter.com/anthonykasza" target="_blank">@anthonykasza</a></em></p>
<p>We are given a 64bit ELF challenge binary.</p>
<p>$file challenge<br />
challenge: ELF 64-bit LSB  shared object, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=4570af615de39c4912c17a09f9fbf8419368572b, not stripped</p>
<p>We start off by running it and see a message that says, “Let’s party like it’s 1999!” and then the html contents of example.com.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692870dda56331549679" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
./challenge
Let's party like it's 1999!!
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Example Domain&lt;/title&gt;

    &lt;meta charset="utf-8" /&gt;
    &lt;meta http-equiv="Content-type" content="text/html; charset=utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;
    &lt;style type="text/css"&gt;
    body {
        background-color: #f0f0f2;
        margin: 0;
        padding: 0;
        font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;

    }
    div {
        width: 600px;
        margin: 5em auto;
        padding: 50px;
        background-color: #fff;
        border-radius: 1em;
    }
    a:link, a:visited {
        color: #38488f;
        text-decoration: none;
    }
    @media (max-width: 700px) {
        body {
            background-color: #fff;
        }
        div {
            width: auto;
            margin: 0 auto;
            border-radius: 0;
            padding: 1em;
        }
    }
    &lt;/style&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;div&gt;
    &lt;h1&gt;Example Domain&lt;/h1&gt;
    &lt;p&gt;This domain is established to be used for illustrative examples in documents. You may use this
    domain in examples without prior coordination or asking for permission.&lt;/p&gt;
    &lt;p&gt;&lt;a href="http://www.iana.org/domains/example"&gt;More information...&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692870dda56331549679-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-2">2</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-4">4</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-6">6</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-8">8</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-10">10</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-12">12</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-14">14</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-16">16</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-18">18</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-20">20</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-22">22</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-24">24</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-26">26</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-28">28</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-30">30</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-32">32</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-34">34</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-36">36</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-38">38</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-40">40</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-42">42</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-44">44</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-46">46</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-48">48</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-50">50</div><div class="crayon-num" data-line="crayon-5f692870dda56331549679-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda56331549679-52">52</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692870dda56331549679-1"><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-e">challenge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-2"><span class="crayon-i">Let</span><span class="crayon-s">'s party like it'</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-cn">1999</span><span class="crayon-o">!</span><span class="crayon-o">!</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-3"><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-e">doctype </span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-4"><span class="crayon-o">&lt;</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-5"><span class="crayon-o">&lt;</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span><span class="crayon-e">Example </span><span class="crayon-v">Domain</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">meta </span><span class="crayon-v">charset</span><span class="crayon-o">=</span><span class="crayon-s">"utf-8"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">meta </span><span class="crayon-v">http</span><span class="crayon-o">-</span><span class="crayon-v">equiv</span><span class="crayon-o">=</span><span class="crayon-s">"Content-type"</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-o">=</span><span class="crayon-s">"text/html; charset=utf-8"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">meta </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"viewport"</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-o">=</span><span class="crayon-s">"width=device-width, initial-scale=1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;style </span><span class="crayon-e ">type</span><span class="crayon-k ">="text/css"&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-12"><span class="crayon-k ">&nbsp;&nbsp;&nbsp;&nbsp;body </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">background-color</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">#f0f0f2</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">margin</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">padding</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">font-family</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Open Sans"</span><span class="crayon-i ">,</span><span class="crayon-h"> </span><span class="crayon-s">"Helvetica Neue"</span><span class="crayon-i ">,</span><span class="crayon-h"> </span><span class="crayon-i ">Helvetica,</span><span class="crayon-h"> </span><span class="crayon-i ">Arial,</span><span class="crayon-h"> </span><span class="crayon-i ">sans-serif</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">div </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">width</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">600px</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">margin</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">5em</span><span class="crayon-h"> </span><span class="crayon-i ">auto</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">padding</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">50px</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">background-color</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">#fff</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">border-radius</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">1em</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">a:link, a:visited </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">color</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">#38488f</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">text-decoration</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">none</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-n">@media (max-width: 700px) </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">body </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">background-color</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">#fff</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">div </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">width</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">auto</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">margin</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">0</span><span class="crayon-h"> </span><span class="crayon-i ">auto</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">border-radius</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">padding</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i ">1em</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;/style&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-42"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-44"><span class="crayon-o">&lt;</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-45"><span class="crayon-o">&lt;</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">h1</span><span class="crayon-o">&gt;</span><span class="crayon-e">Example </span><span class="crayon-v">Domain</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">h1</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span><span class="crayon-r">This</span><span class="crayon-h"> </span><span class="crayon-e">domain </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">established </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">be </span><span class="crayon-e">used </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">illustrative </span><span class="crayon-e">examples </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">documents</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">You </span><span class="crayon-e">may </span><span class="crayon-st">use</span><span class="crayon-h"> </span><span class="crayon-r">this</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">domain </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">examples </span><span class="crayon-e">without </span><span class="crayon-e">prior </span><span class="crayon-e">coordination </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">asking </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">permission</span><span class="crayon-sy">.</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"http://www.iana.org/domains/example"</span><span class="crayon-o">&gt;</span><span class="crayon-e">More </span><span class="crayon-v">information</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">a</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-50"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692870dda56331549679-51"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda56331549679-52"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>I perform stings on the binary and see some interesting ones related to dates, example.com, and rust.</p>
<p>…<br />
http://www.example.com<br />
stream did not contain valid UTF-8<br />
1/1/1999%d/%m/%Y<br />
This system is obviously not a 90&#8217;s kid.1/1/2000Possible Y2K issue.<br />
What year is it?!<br />
%a, %d %b %Y %H:%M:%S GMT<br />
That Date isn&#8217;t RFC compliant<br />
That response was not OK<br />
Let&#8217;s party like it&#8217;s 1999!!<br />
…<br />
rust_builtin.c<br />
rust_begin_unwind<br />
rust_eh_personality<br />
rust_eh_personality_catch<br />
…</p>
<p>Next we open it up and look at it in IDA and after demangling the names, we can see a pretty large main function.  We can start by using IDA’s cross references on some of those interesting date strings we found earlier.  We see that an http request is made to <a href="http://www.example.com" target="_blank">www.example.com</a> and the headers are checked for the date.  This gives us a pretty good idea of what we can try to fiddle with.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_2.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17695" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_2-230x459.png" alt="CTF2_2" width="260" height="519" /></a></p>
<p>I setup an Ubuntu virtual machine on a private virtual network and then created another linked clone to have a server.  I changed the hosts file on the client system to point <a href="http://www.example.com" target="_blank">www.example.com</a> to the other server system.  I also installed nginx on the server system to have an easy http listener.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_3.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17698" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_3-230x58.png" alt="CTF2_3" width="325" height="82" /></a></p>
<p>I tried to run the program with the current date and it printed out the nginx response and then I changed the date back to 1999 like the challenge asks and it printed out the key.</p>
<p>PAN{ThaddeusVenture}</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_4.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17701" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_4-230x208.png" alt="CTF2_4" width="302" height="273" /></a></p>
<h3>Unix 3 Challenge: Far above the world sitting in your tin can the stars look very different today</h3>
<p><em>Challenge Created By: Tyler Halfpop <a href="https://twitter.com/0xtyh" target="_blank">@0xtyh</a></em></p>
<p>We are given an ELF file and when it runs, it draws a nice cat.</p>
<p>$./odd8_v1 <a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/Screen-Shot-2016-08-25-at-2.58.05-PM-copy.jpg" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17713" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/Screen-Shot-2016-08-25-at-2.58.05-PM-copy-230x198.jpg" alt="Screen Shot 2016-08-25 at 2.58.05 PM copy" width="400" height="344" /></a></p>
<p>When we open it in IDA and go to graph mode in the main function, we can see the key drawn by the nodes.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_5.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17707" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_5-230x129.png" alt="CTF2_5" width="453" height="254" /></a></p>
<p>The binary was constructed using the <a href="https://github.com/xoreaxeaxeax/REpsych" target="_blank">REpsych</a> framework by <a href="https://twitter.com/xoreaxeaxeax" target="_blank">@xoreaxeaxeax</a>.</p>
<h3>Unix 4 Challenge: Sometimes you find treasure in the oddest of places&#8230;</h3>
<p><em>Challenge Created By: karttoon <a href="https://twitter.com/noottrak" target="_blank">@noottrak</a></em></p>
<p>We receive this beautiful image to start with.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_6.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17716" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_6-230x140.png" alt="CTF2_6" width="422" height="257" /></a></p>
<p>I opened the image with my favorite hex editor, 010Editor, and I could see there is a large blob at the end of the image after the FF D9 ending of the jpg.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_7.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17719" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_7-230x107.png" alt="CTF2_7" width="399" height="186" /></a></p>
<p>I extracted the blob and divided the sections that were separated by tags. There was a coppertunnel, goldtunnel, silvertunnel, and a crystal tunnel. Each section looked like base64, but the padding was at the beginning with the =. I used 010Editor’s built in Ascii reverse script to reverse the text and then 010Editor’s decode base64 script.  It looked like I had backwards base64 again, so I repeated this step several times until I got a PK zip header. I did this procedure for each tunnel getting to the file before the zip file and then I used python to write the final file.</p>
<p>from base64 import b64decode</p>
<p>ci = open(&#8220;coppertunnel.txt&#8221;, &#8220;rb&#8221;).read()<br />
co = open(&#8220;copperout.zip&#8221;, &#8220;w&#8221;)<br />
co.write(b64decode(ci))</p>
<p>si = open(&#8220;silvertunnel.txt&#8221;, &#8220;rb&#8221;).read()<br />
so = open(&#8220;silverout.zip&#8221;, &#8220;w&#8221;)<br />
so.write(b64decode(ci))</p>
<p>gi = open(&#8220;goldtunnel.txt&#8221;, &#8220;rb&#8221;).read()<br />
go = open(&#8220;goldout.zip&#8221;, &#8220;w&#8221;)<br />
go.write(b64decode(ci))</p>
<p>cri = open(&#8220;crystaltunnel.txt&#8221;, &#8220;rb&#8221;).read()<br />
cro = open(&#8220;crystalout.zip&#8221;, &#8220;w&#8221;)<br />
cro.write(b64decode(ci))</p>
<p>I unzipped the files and saw that I had 4 parts of a Par archive.</p>
<p>treasure.vol306+306 2.par2<br />
treasure.vol306+306 3.par2<br />
treasure.vol306+306 4.par2<br />
treasure.vol306+306.par2</p>
<p>I did some Googling and found MultiPar to work with the files. I was able to use the Repair function to restore a chest.zip file.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTf2_8.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17725" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTf2_8-230x147.png" alt="CTf2_8" width="410" height="262" /></a></p>
<p>Chest.zip was an encrypted zip file, so I started to look for the password in the original image. I tried steghide and it outputted bards_song, which was a text file with excellent instructions that would have been helpful earlier on, and the password for the zip file.</p>
<p>steghide.exe extract -sf labyrinth_entrance.jpg<br />
Enter passphrase:<br />
wrote extracted data to &#8220;bards_song&#8221;.</p>
<p>Over the hills and through the grass<br />
By dawn of light in the mountain pass<br />
The goblins treasure awaits the steadfast<br />
Walking in REVerse, the eye opens as you go past<br />
A smell leads you onward, luring you to follow<br />
At the end of each tunnel, a PARt of treasure in the hollow<br />
Combine them to find a door hidden by rhyme<br />
Opened once with the words &#8220;aintnobodygottime&#8221;</p>
<p>I was then able to unzip the chest.zip, which gave me a MachO called jareths_maze. I ran it in a VM and I was greeted with this horrifying ascii art.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_9.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17731" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/CTF2_9-230x197.png" alt="CTF2_9" width="453" height="388" /></a></p>
<p>I couldn’t let the clowns win, so I had to open the file in IDA. I decompiled main and there were more clowns, but the message was different.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/10.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17734" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/10-230x106.png" alt="10" width="431" height="199" /></a></p>
<p>Then I saw this demoralizing string of function names and I started to get a little freaked out.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/11.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17737 size-medium" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/11-230x731.png" alt="11" width="230" height="731" /></a></p>
<p>The program printed the ascii art after going through these functions. I knew that the beginning message wasn’t correct and the ending message wasn’t correct. Each function was overwriting a character in the message and the a group of functions was being overwritten by what the b group of functions was writing.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/12.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17740" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/12-230x189.png" alt="12" width="297" height="244" /></a></p>
<p>I used IDA to jump into each function and grab the ordinal of the character that the message was supposed to be with the a functions and then I used python to convert the ordinal to the character to obtain the key.</p>
<p>PAN{D4nKkry5t4l}</p>
<h3>Unix 5 Challenge: All your filez are belongz to us.</h3>
<p><em>Challenge Created By: Tyler Halfpop <a href="https://twitter.com/0xtyh" target="_blank">@0xtyh</a></em></p>
<p>We are given a binary called krypto.danger, and if we run file on it, we can see that it is a 64bit Mach-O.</p>
<p>file krypto.danger<br />
krypto.danger: Mach-O 64-bit executable x86_64</p>
<p>A good first step when examining a Mach-O is to check it out in <a href="https://github.com/gdbinit/MachOView" target="_blank">osxreverser’s branch of MachOView</a> to examine the various Mach-O header information and strings, much like you would with a PE file.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/13.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17743" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/13-230x189.png" alt="13" width="402" height="330" /></a></p>
<p>The next step is to run the binary to get a better understanding of what it does. We should run untrusted binaries in a virtual machine, but we are too busy looking at pictures of Mr. Bigglesworth to be bothered by that. When we run it, our picture of Mr. Bigglesworth gets encrypted and a .laby extension is appended. A menacing narwhal also pops up that ironically tells us “Congratulations! All your pngs are belong to us Pay us all the moneyz – PANW GSRT”.  Not Mr. Bigglesworth! This is war.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/Picture14.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17746" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/Picture14-230x129.png" alt="Picture14" width="445" height="250" /></a></p>
<p>When we open the binary in IDA we can see all the ugly mangled Swift names.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/15.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17788" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/15-230x225.png" alt="15" width="398" height="390" /></a></p>
<p>We can use an IDA Script called <a href="https://github.com/0xtyh/SwiftDemang" target="_blank">SwiftDemang</a> to demangle the Swift names to make it easier to read. After running the script, it is a little easier to look at the function names.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/16.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17785" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/16-230x292.png" alt="16" width="344" height="437" /></a></p>
<p>After demangling the functions, we can see some interesting functions like krypto_dkrypt and krypto_ekrypt. Krypto_dkrypt gets called if there is a dekrypt argument. Let’s try to use that to see if we can get Mr. Bigglesworth back.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/17.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17782" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/17-230x172.png" alt="17" width="325" height="243" /></a></p>
<p>Now that we have Mr. Bigglesworth with us again, we can get back to solving the challenge.  The dkrypt and ekrypt functions both call an interesting looking function called get_pw that returns a string we can tell from the comment added by SwiftDemang.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/18.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17779" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/18-230x187.png" alt="18" width="303" height="246" /></a></p>
<p>When we look at the get_pw we see an interesting looking string highlighted below and calls to RNCryptor. If we Google RNCryptor, we can find an <a href="https://github.com/RNCryptor/RNCryptor" target="_blank">open source Swift version of AES-256</a>, which is being used to encrypt the password that is then used to encrypt or decrypt the files.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/19.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17776" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/19-230x165.png" alt="19" width="314" height="226" /></a></p>
<p>If we setup remote debugging with IDA and break on the return from get_pw, we can see the key to the challenge in the string pointed to by the return value in RAX at 0x100608101.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/20.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17773" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/20-230x104.png" alt="20" width="354" height="160" /></a></p>
<h3>Unix 6 Challenge: Go forth good language.</h3>
<p><em>Challenge Created By: Richard Wartell (<a href="https://twitter.com/wartortell" target="_blank">@wartortell</a>)</em></p>
<p>For this challenge, you’re given a server and a client binary, both Mach.O files. If we run the client binary, we can see that it’s asking for a four token key in order to get the “prize”.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/21.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17770" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/21-230x275.png" alt="21" width="256" height="306" /></a></p>
<p>Thankfully, these binaries haven’t had their symbols stripped so it’s easy to find interesting functions in the binary. From a quick look at the client library, we can see the strings that were shown above, as well as the client library sending the four tokens you enter to a server:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/22.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17767" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/22-230x387.png" alt="22" width="278" height="468" /></a></p>
<p>So we need to look into how the server checks the tokens that are sent. When we open up the server in IDA Pro, we can easily see the functions main_check_key1, main_check_key2, main_check_key3, and main_check_key4 being called in a row. If we following them, there is a check which leads to where the real key would be if this was the actual server:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/23.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17764" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/23-230x142.png" alt="23" width="308" height="190" /></a></p>
<p>From here, all we need to do is figure out what each token needs to be. From digging through each of the four functions, we can find the tokens that will get us the key:</p>
<ol>
<li>Checks the first message character by character, the token is “3at”</li>
<li>Checks the second message, the length must be 11, and each character is pairwise compared with each one, the differences can be used to determine the characters. The token is &#8220;chInch1ll@z&#8221;.</li>
<li>Performs specific checks on the token against another 4 byte string. The token is “H1gh”.</li>
<li>Compares characters from the token against the string “Fromunda” and the number 183. The token is “F183r”</li>
</ol>
<p>We know we’ve got the right tokens because we can run the server and client locally, and we get this:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/24.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17761" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/24-230x111.png" alt="24" width="310" height="150" /></a></p>
<p>When we connect instead to the IP contained in the directions file and provide the 4 tokens, we get the key:</p>
<p>PAN{th@Nk5_m4r1ha_U_s0_n1c3}</p>
<h3>Unix 7 Challenge: Crack the codes to get the Apple</h3>
<p><em>Challenge Created By: Tyler Halfpop (<a href="https://twitter.com/0xtyh" target="_blank">@0xtyh</a>)</em></p>
<p>This time I was handed an OSX compiled application called RedDelicious. First, I simply ran it (not smart, but I never claimed to be), and got the following window popup:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/25.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17758" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/25-230x72.png" alt="25" width="323" height="101" /></a></p>
<p>So I entered some text into the window and clicked Submit, which gave me the message “Try harder…” From this I assumed that I would have to submit the right key in order to get a success message and hopefully the key for the challenge. So, now I wanted to disassemble the binary and see what happens when I click “Submit”.</p>
<p>In IDA, the first thing I noticed is that most functions start with “__T”, which tells me I’m dealing with a Swift compiled binary, since that is the prefix for all symbols in Swift. Swift is great at making ugly, huge function names, so rather than messing around with demangling them or anything too ugly, I had one lead of the “Try harder…” string from when I entered a wrong key. I looked in the strings window and found references to that function and went back from there:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/26.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17755" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/26-230x12.png" alt="26" width="536" height="28" /></a></p>
<p>Then I saw the same function both referencing the strings “Try harder…” and “C0ngr4tz!”, so I knew I was on the right track. The function that references them looks like this:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/27.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17752 size-medium" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/27-230x435.png" alt="27" width="230" height="435" /></a></p>
<p>At the bottom where the code flow splits in two, each path has the same code with a different string reference, so I knew I was in the key check function. Now to figure out how to make it say “C0ngr4tz!”</p>
<p>Swift’s compiler treats variables very similar to C++, passing a reference to “this” as an argument to functions, and then using it to find other class references. The class jump table for this class is NSViewController, found at 0x100008090. We’ll need this in order to fix up the calls used in the function. After cleaning up all of Swift’s object oriented code and Automatic Reference Counting (ARC), we can dumb this function down into some simpler pseudocode:</p>
<p>&nbsp;</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692870dda6a854366530" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
check_key:
    a = entered_key
    a = bb64(a)
    a = xxor(a, "av9vex8pocs4id2")
    a = bb64(a)
    a = xxor(a, " abracadabra")
    a = bb64(a)
    if a == " LyY8TiwwJighJzRSNycvJyU3LzQ1GTc0JlA2ACcGBTcuUSc3JBkZLSoaS1EzUwotBwsDDTQbEiY3Mw0SNDcZVjcLKywjCTpKPApWTw==":
        label = "C0ngr4tz!"
    else:
        "Try harder..."</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692870dda6a854366530-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda6a854366530-2">2</div><div class="crayon-num" data-line="crayon-5f692870dda6a854366530-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda6a854366530-4">4</div><div class="crayon-num" data-line="crayon-5f692870dda6a854366530-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda6a854366530-6">6</div><div class="crayon-num" data-line="crayon-5f692870dda6a854366530-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda6a854366530-8">8</div><div class="crayon-num" data-line="crayon-5f692870dda6a854366530-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda6a854366530-10">10</div><div class="crayon-num" data-line="crayon-5f692870dda6a854366530-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692870dda6a854366530-1"><span class="crayon-v">check_key</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda6a854366530-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">entered</span><span class="crayon-sy">_</span>key</div><div class="crayon-line" id="crayon-5f692870dda6a854366530-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bb64</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda6a854366530-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">xxor</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"av9vex8pocs4id2"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f692870dda6a854366530-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bb64</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda6a854366530-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">xxor</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">" abracadabra"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f692870dda6a854366530-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bb64</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda6a854366530-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">" LyY8TiwwJighJzRSNycvJyU3LzQ1GTc0JlA2ACcGBTcuUSc3JBkZLSoaS1EzUwotBwsDDTQbEiY3Mw0SNDcZVjcLKywjCTpKPApWTw=="</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f692870dda6a854366530-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"C0ngr4tz!"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda6a854366530-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f692870dda6a854366530-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Try harder..."</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>This gives us a pretty clear idea of what’s going on, but we’ll have to check each of these functions to figure out what they do. After analysis, we find that they do the following different functions:</p>
<ul>
<li>bb64 – Base64 encode the passed in argument</li>
<li>xxor – XOR the passed string with the provided key</li>
</ul>
<p>So, if we write a quick little python script, we can get the key:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692870dda71316238370" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import base64

def xxor(plain, key):
    enc = ""
    for i in range(len(plain)):
        enc += chr(ord(plain[i]) ^ ord(key[i % len(key)]))
    return enc

a = "LyY8TiwwJighJzRSNycvJyU3LzQ1GTc0JlA2ACcGBTcuUSc3JBkZLSoaS1EzUwotBwsDDTQbEiY3Mw0SNDcZVjcLKywjCTpKPApWTw=="
a = base64.b64decode(a)
a = xxor(a, "abracadabra")
a = base64.b64decode(a)
a = xxor(a, "av9vex8pocs4id2")
a = base64.b64decode(a)
print a</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692870dda71316238370-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda71316238370-2">2</div><div class="crayon-num" data-line="crayon-5f692870dda71316238370-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda71316238370-4">4</div><div class="crayon-num" data-line="crayon-5f692870dda71316238370-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda71316238370-6">6</div><div class="crayon-num" data-line="crayon-5f692870dda71316238370-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda71316238370-8">8</div><div class="crayon-num" data-line="crayon-5f692870dda71316238370-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda71316238370-10">10</div><div class="crayon-num" data-line="crayon-5f692870dda71316238370-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda71316238370-12">12</div><div class="crayon-num" data-line="crayon-5f692870dda71316238370-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692870dda71316238370-14">14</div><div class="crayon-num" data-line="crayon-5f692870dda71316238370-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692870dda71316238370-1"><span class="crayon-e">import </span><span class="crayon-e">base64</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda71316238370-2">&nbsp;</div><div class="crayon-line" id="crayon-5f692870dda71316238370-3"><span class="crayon-e">def </span><span class="crayon-e">xxor</span><span class="crayon-sy">(</span><span class="crayon-v">plain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda71316238370-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">enc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f692870dda71316238370-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">plain</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda71316238370-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">enc</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">plain</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f692870dda71316238370-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">enc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda71316238370-8">&nbsp;</div><div class="crayon-line" id="crayon-5f692870dda71316238370-9"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"LyY8TiwwJighJzRSNycvJyU3LzQ1GTc0JlA2ACcGBTcuUSc3JBkZLSoaS1EzUwotBwsDDTQbEiY3Mw0SNDcZVjcLKywjCTpKPApWTw=="</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda71316238370-10"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f692870dda71316238370-11"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">xxor</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"abracadabra"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda71316238370-12"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f692870dda71316238370-13"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">xxor</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"av9vex8pocs4id2"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692870dda71316238370-14"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f692870dda71316238370-15"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-v">a</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/28.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-17749" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/08/28-230x28.png" alt="28" width="279" height="34" /></a></p>
<p>And the key is: PAN{My_m0th3r_told_m3_2b3_w4ry_of_F@uns}</p>
<p>Leave a comment below to share your thoughts about the Unix track challenges. Be sure to also check out how other threat researchers solved these challenges:</p>
<p><strong>Unix Challenge 1</strong></p>
<ul>
<li><a href="https://irq5.io/2016/08/17/labyrenth-2016-write-up-bowie-pl/" target="_blank">https://irq5.io/2016/08/17/labyrenth-2016-write-up-bowie-pl/</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-1.py" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-1.py</a></li>
</ul>
<p><strong>Unix Challenge 3</strong></p>
<ul>
<li><a href="http://www.ghettoforensics.com/2016/08/running-labyrenth-unit-42-ctf.html" target="_blank">http://www.ghettoforensics.com/2016/08/running-labyrenth-unit-42-ctf.html</a></li>
</ul>
<p><strong>Unix Challenge 5</strong></p>
<ul>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-5.txt" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-5.txt</a></li>
</ul>
<p><strong>Unix Challenge 6</strong></p>
<ul>
<li><a href="http://www.ghettoforensics.com/2016/08/running-labyrenth-unit-42-ctf.html" target="_blank">http://www.ghettoforensics.com/2016/08/running-labyrenth-unit-42-ctf.html</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-6.py" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-6.py</a></li>
</ul>
<p><strong>Unix Challenge 7</strong></p>
<ul>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-7.txt" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-unix-7.txt</a></li>
</ul>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
