
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/pgminer-postgresql-cryptocurrency-mining-botnet/" />

	<!-- This site is optimized with the Yoast SEO plugin v15.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>PGMiner: New Cryptocurrency Mining Botnet Delivered via PostgreSQL</title>
	<meta name="description" content="PGMiner is a novel Linux-based cryptocurrency mining botnet that exploits a disputed PostgreSQL remote code execution vulnerability." />
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="PGMiner: New Cryptocurrency Mining Botnet Delivered via PostgreSQL" />
	<meta property="og:description" content="PGMiner is a novel Linux-based cryptocurrency mining botnet that exploits a disputed PostgreSQL remote code execution vulnerability." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/" />
	<meta property="og:site_name" content="Unit42" />
	<meta property="article:published_time" content="2020-12-10T14:00:00+00:00" />
	<meta property="article:modified_time" content="2020-12-09T21:24:10+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/Cryptojacking-r3d3.png" />
	<meta property="og:image:width" content="2001" />
	<meta property="og:image:height" content="1001" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Xiao Zhang">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="11 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://unit42.paloaltonetworks.jp/#website","url":"https://unit42.paloaltonetworks.jp/","name":"Unit42","description":"Palo Alto Networks","potentialAction":[{"@type":"SearchAction","target":"https://unit42.paloaltonetworks.jp/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/#primaryimage","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/Cryptojacking-r3d3.png","width":2001,"height":1001,"caption":"Cryptojacking is conceptually illustrated here. The category includes PGMiner, a new cryptocurrency mining botnet delivered via PostgreSQL."},{"@type":"WebPage","@id":"https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/#webpage","url":"https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/","name":"PGMiner: New Cryptocurrency Mining Botnet Delivered via PostgreSQL","isPartOf":{"@id":"https://unit42.paloaltonetworks.jp/#website"},"primaryImageOfPage":{"@id":"https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/#primaryimage"},"datePublished":"2020-12-10T14:00:00+00:00","dateModified":"2020-12-09T21:24:10+00:00","author":{"@id":"https://unit42.paloaltonetworks.jp/#/schema/person/5b5f9963240752a65b90ba01d28b8981"},"description":"PGMiner is a novel Linux-based cryptocurrency mining botnet that exploits a disputed PostgreSQL remote code execution vulnerability.","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/"]}]},{"@type":"Person","@id":"https://unit42.paloaltonetworks.jp/#/schema/person/5b5f9963240752a65b90ba01d28b8981","name":"Xiao Zhang","image":{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.jp/#personlogo","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg","caption":"Xiao Zhang"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; PGMiner: New Cryptocurrency Mining Botnet Delivered via PostgreSQL Comments Feed" href="https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/feed/" />
<meta property="og:likes" content="5"/>
<meta property="og:readtime" content="9"/>
<meta property="og:views" content="3,577"/>
<meta property="og:date_created" content="December 10, 2020 at 6:00 AM"/>
<meta property="og:post_length" content="2747"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Xiao Zhang"/>
<meta property="og:author" content="Yang Ji"/>
<meta property="og:author" content="Jim Fitzgerald"/>
<meta property="og:author" content="Yue Chen"/>
<meta property="og:author" content="Claud Xiao"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/xiao/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/yang-ji/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/yue-chen/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/claud-xiao/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/Cryptojacking-r3d3.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"PGMiner: New Cryptocurrency Mining Botnet Delivered via PostgreSQL","name":"PGMiner: New Cryptocurrency Mining Botnet Delivered via PostgreSQL","description":"PGMiner is a novel Linux-based cryptocurrency mining botnet that exploits a disputed PostgreSQL remote code execution vulnerability.","url":"https:\/\/unit42.paloaltonetworks.com\/pgminer-postgresql-cryptocurrency-mining-botnet\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/pgminer-postgresql-cryptocurrency-mining-botnet\/","datePublished":"December 10, 2020","articleBody":"\r\n \t\r\n\r\nExecutive Summary\r\nCryptojacking (or simply malicious coin mining) is a common way for malware authors to monetize their operations. While the underlying mining protocols and techniques remain fairly standard, malware actors tend to seek out and find smarter ways to hack into a victim's machines. Recently, Unit 42 researchers uncovered a novel Linux-based cryptocurrency mining botnet that exploits a disputed PostgreSQL remote code execution (RCE) vulnerability that compromises database servers for cryptojacking. We named the cryptocurrency mining botnet \"PGMiner\" after its delivery channel and mining behavior. At its core, PGMiner attempts to connect to the mining pool for Monero mining. Because the mining pool is not active anymore, we could not recover information about the actual profit of this malware family.\r\n\r\nPostgreSQL, also known as Postgres, is among the most-used open source relational database management systems (RDBMS) for production environments. According to DB-Engines, PostgreSQL ranks fourth among all database management systems (DBMS) as of November 2020 and has seen a steady increase in popularity since 2013. In particular, PostgreSQL was named database of the year in 2017 and 2018 by DB-Engines.\r\n\r\nThe feature in PostgreSQL under exploitation is \"copy from program,\" which was introduced in version 9.3 on Sept. 9, 2013. In 2018, CVE-2019-9193 was linked to this feature, naming it as a \"vulnerability.\" However, the PostgreSQL community challenged this assignment, and the CVE has been labeled as \"disputed.\"\r\n\r\nWe believe PGMiner is the first cryptocurrency mining botnet that is delivered via PostgreSQL. It is notable that malware actors have started to weaponize not only confirmed CVEs, but also disputed ones.\r\n\r\nPalo Alto Networks Next-Generation Firewall customers are protected from PGMiner with the WildFire and Threat Prevention security subscriptions.\r\n\r\nAt the time of this writing, none of the vendors on VirusTotal detect PGMiner. WildFire, a cloud-based malware analysis platform, detects it by dynamic analysis with the observation of self-deletion and process impersonation. Besides the delivery channel, PGMiner\u2019s coin mining codebase reassembles some of the characteristics from the the SystemdMiner family and its variants 1, 2 and 3, but with the following notable changes:\r\n\r\n \tDelete the PostgreSQL table right after code launch to achieve fileless execution.\r\n \tCollect system information and send it to the command and control (C2) server for victim identification.\r\n \tEmploy traditional and novel approaches to download curl binary in case the command is not available on the victim\u2019s machine.\r\n \tImpersonate the \"tracepath\" process to hide its presence.\r\n \tAttempt to kill competitor programs for better monetization.\r\n\r\nAttack Process Overview\r\nA high-level overview of PGMiner\u2019s execution flow is depicted in Figure 1. As explained before, the malicious payload is delivered via PostgreSQL, which communicates to the backend C2 servers through SOCKS5 proxies. After that, it downloads the coin mining payloads based on the system architecture.\r\n\r\n[caption id=\"attachment_109782\" align=\"aligncenter\" width=\"900\"] Figure 1. Structure of PGMiner exploiting a disputed PostgreSQL RCE vulnerability.[\/caption]\r\n\r\nDuring our analysis, we found that PGMiner constantly reproduces itself by recursively downloading certain modules. To better illustrate this process, we show the payload relationship in Figure 2. Each box links to a sample identified in the infection chain. The record contains filename, abbreviated SHA256 value and file type information. Note that whenever the architecture information is in the filename, we iterate through all other possible architectures and add the samples in the graph if successfully downloaded. The abbreviated C2 for each stage is marked with dark green. Also, the samples in light blue boxes have been extensively studied in previous research work (SystemdMiner and its variants 1, 2 and 3). Here, we\u2019ll focus on the samples that appear in light red boxes and provide a summary of the rest.\r\n\r\n[caption id=\"attachment_109800\" align=\"aligncenter\" width=\"630\"] Figure 2. PGMiner payload relationship.[\/caption]\r\nInitial Compromise via PostgreSQL Exploit\r\nThe root sample that triggered our investigation is 55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b, which is an AARCH64 ELF file that is static linked and stripped. At the time of this writing, none of the vendors on VirusTotal is able to detect this malware, as shown in Figure 3.\r\n\r\n[caption id=\"attachment_109786\" align=\"aligncenter\" width=\"900\"] Figure 3. None of the vendors on VirusTotal detect PGMiner.[\/caption]\r\n\r\nThe sample above works as an exploit tool that attempts to exploit a controversial feature in PostgreSQL that allows RCE on the server\u2019s operating system (OS). By reverse engineering the binary as shown in Figure 4, we found the sample has the libpq postgresql client library statically linked. This is used for communicating with the target database servers. The attacker scans port 5432 (0x1538), used by PostgreSQLql of the hosts in the private\/local network (i.e., 172.16.0.0, 192.168.0.0 and 10.0.0.0 subnets). The malware randomly picks a public network range (e.g., 190.0.0.0, 66.0.0.0) in an attempt to perform RCE on the PostgreSQL server. With the user \"postgres\", which is the default user of the database, the attacker performs a brute-force attack iterating over a built-in list of popular passwords such as \"112233\" and \"1q2w3e4r\" to crack the database authentication.\r\n\r\n[caption id=\"attachment_109788\" align=\"aligncenter\" width=\"835\"] Figure 4. PostgreSQL exploit code flow in PGMiner.[\/caption]\r\n\r\nOnce the malware successfully breaks into the database, it uses the PostgreSQL \"copy from program\" feature to download and launch the coin mining scripts. The \"copy from program\" feature has been controversial since its debut in PostgreSQL 9.3. The feature allows the local or remote superuser to run shell script directly on the server, which has raised wide security concerns. In 2019, a CVE-2019-9193 was assigned to this feature, naming it as a \"vulnerability.\" However, the PostgreSQL community challenged this assignment, and the CVE has been labeled as \"disputed.\" The main argument against defining the feature as a vulnerability is that the feature itself does not impose a risk as long as the superuser privilege is not granted to remote or untrusted users and the access control and authentication system works well. On the other side, security researchers worry that this feature indeed makes PostgreSQL a stepping stone for remote exploit and code execution directly on the server\u2019s OS beyond the PostgreSQL software, if the attacker manages to own the superuser privilege by brute-forcing password or SQL injection.\r\n\r\n[caption id=\"attachment_109790\" align=\"aligncenter\" width=\"900\"] Figure 5. PGMiner\u2019s exploit content to PostgreSQL.[\/caption]\r\n\r\nWhile this CVE is still being disputed, malware authors apparently have started to use it to stay under the detection radar by making the attack payload fileless. The actual exploit content from PGMiner is shown in Figure 5, which can be broken down to the following steps:\r\n\r\n\r\n\r\nStep\r\nSQL command\r\n\r\n\r\nClear the \u201cabroxu\u201d table if it exists.\r\nDROP TABLE IF EXISTS abroxu;\r\n\r\n\r\nCreate the table with a text column.\r\nCREATE TABLE abroxu(cmd_output text);\r\n\r\n\r\nSave the malicious payload to table \"abroxu\".\r\nCOPY abroxu FROM PROGRAM \u201cshell command\u201d;\r\n\r\n\r\nExecute the payload on the PostgreSQL server.\r\nSELECT * FROM cmd_exec;\r\n\r\n\r\nClear the created table.\r\nDROP TABLE IF EXISTS abroxu;\r\n\r\n\r\n\r\nThe malicious script payload saved in the \"abroxu\" table reassembles some of the characteristics from the known SystemdMiner malware family and its variants. Here we only highlight the major ways that PGMiner evolves from SystemdMiner, as well as overlooked functionalities. We have also added annotation to the script shown in the figures below to make this clear.\r\nDownloading Curl\r\nIn the case that the curl command is not available on the victim\u2019s machine, the malicious script tries multiple approaches (see Figure 6) to download the curl binary and add it to the execution paths:\r\n\r\n \tDirect installation from official package management utilities like apt-get and yum.\r\n \tDownload static curl binary from GitHub.\r\n \tDownload using \/dev\/tcp in case the normal ways don\u2019t work.\r\n\r\n[caption id=\"attachment_109792\" align=\"aligncenter\" width=\"900\"] Figure 6. PGMiner\u2019s multiple attempts to download curl binaries.[\/caption]\r\n\r\nWhile the first two approaches are well-known, the third one is quite unique. What\u2019s more interesting is the target IP address: 94[.]237[.]85[.]89. It is connected to the domain newt[.]keetup[.]com. While its parent domain, keepup[.]com, seems like a legitimate business website, this particular subdomain is redirecting port 80 to 443, which is used to host a couchdb named newt. Although port 8080 is not open to the public, we believe it has been configured to allow Cross-Origin Resource Sharing (CORS), as shown in Figure 7.\r\n\r\n[caption id=\"attachment_109794\" align=\"aligncenter\" width=\"900\"] Figure 7. newt[.]keetup[.]com is hosting a couchdb for curl binary downloading.[\/caption]\r\nResolving SOCKS5\/TOR Relay Server Name\r\nThe C2 host name has been updated to nssnkct6udyyx6zlv4l6jhqr5jdf643shyerk246fs27ksrdehl2z3qd[.]onion. PGMiner also utilizes the SOCKS5 proxy technique to communicate with the C2, as described in this SystemdMiner variant. However, as shown in Figure 8, the DNS server list has been expanded.\r\n\r\n[caption id=\"attachment_109796\" align=\"aligncenter\" width=\"900\"] Figure 8. Updated C2 and expanded DNS server list observed in PGMiner.[\/caption]\r\nFetch Payloads From C2 and Launch PGMiner\r\nAfter resolving the SOCKS5 proxy server IP address, PGMiner rotates through a list of folders to find the first one that allows permission to create a new file and update its attributes. This ensures the downloaded malicious payload can successfully execute on the victim\u2019s machine. This function has been observed in the previous research on the SystemdMiner variant, but the author of the research did not provide an explanation of its purpose.\r\n\r\nThe malware family also evolves with client tracking functionality. It concatenates the IP address, username, architecture, hostname and md5 of all inet IP ranges, as well as the base64 encoding of the crontab content, to formulate the client\u2019s unique identifier, which it reports to the C2 server. The code snippet is highlighted in Figure 9.\r\n\r\n[caption id=\"attachment_109798\" align=\"aligncenter\" width=\"900\"] Figure 9. PGMiner featches payloads from C2 and executes them.[\/caption]\r\nMulti-Architecture Payloads\r\nWith different architectures supplied to the C2 server mentioned above, we were able to recover the following list of payloads. The downloads for other architectures failed.\r\n\r\n \ta935d364622ebefbee659caaa9d0af5828952ab9501591c935cf1f919e2a38ff pg.aarch64: Shell Script\r\n \ta935d364622ebefbee659caaa9d0af5828952ab9501591c935cf1f919e2a38ff pg.armv7l: Shell Script\r\n \t6d296648fdbc693e604f6375eaf7e28b87a73b8405dc8cd3147663b5e8b96ff0 pg.x86_64: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header\r\n\r\nInterestingly, the payload for x86_64 is an ELF executable, while for aarch64 and armv7l, the payload is an identical shell script.\r\nx86_64 ELF Payload\r\nThe x86_64 ELF payload shares the majority of behaviors seen in the previous SystemdMiner variant, yet evolves with additional capabilities:\r\n\r\n \tEnvironment Preparation:\r\n\r\n \tDownload and install curl binary as explained above.\r\n \tInstall crontab.\r\n \tRemove cloud security monitor tools such as Aegis, and Qcloud monitor utilities such as Yunjing.\r\n\r\n\r\n \tVirtual Machine Checking: PGMiner checks the existence of VBoxGuestAdditions to infer whether it is being analyzed in a virtual environment.\r\n \tCompetitors Removal:\r\n\r\n \tRemove other known miner scripts, processes and crontab records.\r\n \tKill miner cleanup processes.\r\n \tKill all other CPU intensive processes such as ddg, system updates and so on.\r\n \tKill processes connected to known mining IP addresses.\r\n\r\n\r\n\r\narmv7l\/aarch64 Shell Script Payload\r\nFrom the x86_64 ELF payload, we were able to recover the CPU file from C2 jk5zra7b3yq32timb27n4qj5udk4w2l5kqn5ulhnugdscelttfhtoyd[.]onion, which is the coin mining module for PGMiner. However, the other cmd and bot modules are unavailable from the C2. Here, the armv7l\/aarch64 shell script connects to a different C2, reambusweduybcp[.]onion. It also attempts to download the cmd file. This time, it succeeds. This indicates that the C2 server for this malware family is constantly updating. Different modules are distributed across different C2s.\r\n\r\nThe cmd module first attempts to kill the tracepath process. Then, it downloads additional payload from the same C2 address. The downloaded malware impersonates the tracepath process to hide its presence. After analyzing the aarch64 payload, we recovered the same shell script initially used to run on PostgreSQL servers, which completes the analysis.\r\nMitigations and Recommendations\r\nPalo Alto Networks Next-Generation Firewall customers are protected against PGMiner via the WildFire and Threat Prevention security subscriptions. At the same time, we urge PostgreSQL users to remove the \u201cpg_execute_server_program\u201d privilege from untrusted users, which makes the exploit impossible. Moreover, we continue to recommend that users download software from trusted sources, manage strong and secure passwords and apply patches in a timely manner.\r\n\r\nTo remove the impact of PGMiner on the PostgreSQL server, the user can search and kill the \u201ctracepath\u201d process, which this malware impersonates, and kill the processes whose process IDs (PIDs) have been tracked by the malware in \u201c\/tmp\/.X11-unix\/\u201d.\r\nConclusion\r\nIn this research, we unveiled PGMiner, a new cryptocurrency mining botnet delivered via a disputed PostgreSQL RCE vulnerability. The fact that PGMiner is exploiting a disputed vulnerability helped it remain unnoticed until we recently uncovered it at Palo Alto Networks.\r\n\r\nPGMiner can potentially be disruptive, as PostgreSQL is widely adopted in PDMS. With additional effort, the malware could target all major operating systems. For example, PostgreSQL is available for all major platforms, including macOS, Windows and Linux. Theoretically, the malware actors could implement another version of PGMiner by targeting a new platform, such as Windows, and deliver it using PostgreSQL.\r\n\r\nDuring our analysis, we observed new techniques, such as embedding victim identification in the request, impersonating a trusted process name, downloading curl binary via multiple approaches and more and aggressively killing all competitor programs. We also analyzed how the malware seeks to better track victims, execute, hide itself and monetize. Other traits, such as the malware recursively downloading itself and frequently changing C2 addresses, also indicate PGMiner is still rapidly evolving.\r\nAdditional Information on Cryptojacking\r\n\r\n \tHighlights from the Unit 42 Cloud Threat Report, 2H 2020\r\n \tBlack-T: New Cryptojacking Variant from TeamTnT\r\n \tCetus: Cryptojacking Worm Targeting Docker Daemons\r\n\r\nIndicator of Compromise (IOCs)\r\nSample and payload identification as a tuple of filename, SHA256 and file type:\r\n\r\n \troot.bin, 55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b, ELF 64-bit LSB executable, ARM aarch64, version 1 (SYSV), statically linked, stripped\r\n \tpg.x86_64, 6d296648fdbc693e604f6375eaf7e28b87a73b8405dc8cd3147663b5e8b96ff0, ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header\r\n \tint.x86_64, 6984a04d7e435499ff267cfaf913d51e8644f6c08db8069c56f9247f1e18ba71, ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header\r\n \tcpu, fef1a83ba6aba160116a8251462dd842f68464a5f767b2e3194820d62fef23b1, ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header\r\n \tpg.aarch64 \/ pg.armv7l, a935d364622ebefbee659caaa9d0af5828952ab9501591c935cf1f919e2a38ff, Shell Script\r\n \tcmd, 864ece624b7069b929385f9cf741355a371e844aa3726d340f91549562e2c604, Shell Script\r\n \tdream.aarch64, d8c46be19ff3ea5b2c12f050f226a199aaa5f76cc1731c868e29eea6c68b6801, ELF 64-bit LSB executable, ARM aarch64, version 1 (SYSV), statically linked, no section header\r\n \tdream.armv7l, 8d44fbbefa0c59a65e21b0d1598ff7c51487ea1cede544d1c3f56d5db0ea7807, ELF 32-bit LSB executable, ARM, EABI5 version 1 (GNU\/Linux), statically linked, no section header\r\n \tdream.mips, 41ef5c6b0cdd068f117902e59233991082a4ecb4877a1fb16016e756412f06ea, ELF 32-bit LSB executable, MIPS, MIPS-I version 1 (SYSV), statically linked, no section header\r\n\r\nAdditional samples related to the 55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b:\r\n\r\n \t1b1d6d5f01b26e4ccf6fff8f2626f9318084dc1123ac67ed7d02f955b72a1432\r\n \t0fc1332d2b20ea43d3c3fea50a48bb1991522bc6c79d518ba9b68a763ef2ad58\r\n \t8a13c3fe815f15a5600fda30d132dfbd4bb54d9c766da164060dd1d66b12e9e4\r\n \t6d95b593f0b5e3cc1985635ad2b943acb083833fea8123e7ac3f88f68e04edd6\r\n \t101ccbad7732fb185d51b91d31a67ff058cac3bc31ec36cec05094065a97d6fd\r\n \td4cf8cfb4dc9cc3101b8c850369a71af70f11e67df7e41e9af98624ebe54ff4a\r\n \t47d56fcbf5d90b9c513d8d38a2c00e4bad6ea4e1d17b05dd37feb4d63b2856e1\r\n \te3c5abe56964ddb3b4f0b3c434a9af145efca558307c65d30e8acc5aed45bedc\r\n \t524cce2cf615809bc08ca80facf95f2be7c5071c4cb3eac38c20a1f0ed39ce1f\r\n\r\nC2:\r\n\r\n \tnssnkct6udyyx6zlv4l6jhqr5jdf643shyerk246fs27ksrdehl2z3qd[.]onion\r\n \tojk5zra7b3yq32timb27n4qj5udk4w2l5kqn5ulhnugdscelttfhtoyd[.]onion\r\n \tdreambusweduybcp[.]onion\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2020\/12\/Cryptojacking-r3d3.png","width":150,"height":75},"author":[{"@type":"Person","name":"Xiao Zhang"},{"@type":"Person","name":"Yang Ji"},{"@type":"Person","name":"Jim Fitzgerald"},{"@type":"Person","name":"Yue Chen"},{"@type":"Person","name":"Claud Xiao"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.2.4' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='application/json' id="wpp-json">
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":109776,"token":"ea2e54daf5","lang":0,"debug":0}
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp.min.js?ver=5.2.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.4.3'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=109776' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpgminer-postgresql-cryptocurrency-mining-botnet%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpgminer-postgresql-cryptocurrency-mining-botnet%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.4.3 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-109776 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">PGMiner: New Cryptocurrency Mining Botnet Delivered via PostgreSQL</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-109776 entry-meta">
				
				
				<span class="post-views-count">3,577</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'109776','like')"><i class="ui ui-2"></i><span class="ml-5">5</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 9</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpgminer-postgresql-cryptocurrency-mining-botnet%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpgminer-postgresql-cryptocurrency-mining-botnet%2F+-+PGMiner%3A+New+Cryptocurrency+Mining+Botnet+Delivered+via+PostgreSQL" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpgminer-postgresql-cryptocurrency-mining-botnet%2F&title=PGMiner%3A+New+Cryptocurrency+Mining+Botnet+Delivered+via+PostgreSQL&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/pgminer-postgresql-cryptocurrency-mining-botnet/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/xiao/" title="Posts by Xiao Zhang" class="author url fn" rel="author">Xiao Zhang</a>, <a href="https://unit42.paloaltonetworks.com/author/yang-ji/" title="Posts by Yang Ji" class="author url fn" rel="author">Yang Ji</a>, <a href="https://unit42.paloaltonetworks.com/author/jim-fitzgerald/" title="Posts by Jim Fitzgerald" class="author url fn" rel="author">Jim Fitzgerald</a>, <a href="https://unit42.paloaltonetworks.com/author/yue-chen/" title="Posts by Yue Chen" class="author url fn" rel="author">Yue Chen</a> and <a href="https://unit42.paloaltonetworks.com/author/claud-xiao/" title="Posts by Claud Xiao" class="author url fn" rel="author">Claud Xiao</a>        </p>
        <p><time datetime="2020-12-10T14:00:00+00:00">December 10, 2020 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/coin-miner/" rel="tag">coin miner</a>, <a href="https://unit42.paloaltonetworks.com/tag/coin-mining/" rel="tag">coin mining</a>, <a href="https://unit42.paloaltonetworks.com/tag/cryptojacking/" rel="tag">cryptojacking</a>, <a href="https://unit42.paloaltonetworks.com/tag/exploit/" rel="tag">exploit</a>, <a href="https://unit42.paloaltonetworks.com/tag/malware/" rel="tag">malware</a>, <a href="https://unit42.paloaltonetworks.com/tag/postgresql/" rel="tag">PostgreSQL</a>, <a href="https://unit42.paloaltonetworks.com/tag/vulnerability/" rel="tag">vulnerability</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/Cryptojacking-r3d3.png" class="attachment-single size-single" alt="Cryptojacking is conceptually illustrated here. The category includes PGMiner, a new cryptocurrency mining botnet delivered via PostgreSQL." />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/pgminer-postgresql-cryptocurrency-mining-botnet/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><ul>
<li style="list-style-type: none;"></li>
</ul>
<h2><a id="post-109776-_5u1hdvavi1kl"></a>Executive Summary</h2>
<p>Cryptojacking (or simply malicious coin mining) is a common way for malware authors to monetize their operations. While the underlying mining protocols and techniques remain fairly standard, malware actors tend to seek out and find smarter ways to hack into a victim&#8217;s machines. Recently, Unit 42 researchers uncovered a novel Linux-based cryptocurrency mining botnet that exploits a disputed PostgreSQL remote code execution (RCE) vulnerability that compromises database servers for cryptojacking. We named the cryptocurrency mining botnet &#8220;PGMiner&#8221; after its delivery channel and mining behavior. At its core, PGMiner attempts to connect to the mining pool for Monero mining. Because the mining pool is not active anymore, we could not recover information about the actual profit of this malware family.</p>
<p>PostgreSQL, also known as Postgres, is among the most-used open source relational database management systems (RDBMS) for production environments. According to <a href="https://db-engines.com/en/ranking">DB-Engines</a>, PostgreSQL ranks fourth among all database management systems (DBMS) as of November 2020 and has seen a steady increase in popularity since 2013. In particular, PostgreSQL was named database of the year in <a href="https://db-engines.com/en/blog_post/76">2017</a> and <a href="https://db-engines.com/en/blog_post/79">2018</a> by DB-Engines.</p>
<p>The feature in PostgreSQL under exploitation is &#8220;copy from program,&#8221; which was introduced in version 9.3 on Sept. 9, 2013. In 2018, <a href="https://www.postgresql.org/about/news/cve-2019-9193-not-a-security-vulnerability-1935/">CVE-2019-9193</a> was linked to this feature, naming it as a &#8220;vulnerability.&#8221; However, the PostgreSQL community challenged this assignment, and the CVE has been labeled as &#8220;disputed.&#8221;</p>
<p>We believe PGMiner is the first cryptocurrency mining botnet that is delivered via PostgreSQL. It is notable that malware actors have started to weaponize not only confirmed CVEs, but also disputed ones.</p>
<p>Palo Alto Networks <a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall">Next-Generation Firewall</a> customers are protected from PGMiner with the <a href="https://www.paloaltonetworks.com/products/secure-the-network/wildfire">WildFire</a> and <a href="https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention">Threat Prevention</a> security subscriptions.</p>
<p>At the time of this writing, none of the vendors on <a href="https://www.virustotal.com/gui/file/55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b/detection">VirusTotal</a> detect PGMiner. WildFire, a cloud-based malware analysis platform, detects it by dynamic analysis with the observation of self-deletion and process impersonation. Besides the delivery channel, PGMiner’s coin mining codebase reassembles some of the characteristics from the the <a href="https://blog.netlab.360.com/systemdminer-when-a-botnet-borrows-another-botnets-infrastructure/">SystemdMiner</a> family and its variants <a href="https://zhuanlan.kanxue.com/article-10818.htm">1</a>, <a href="https://cloud.tencent.com/developer/article/1587201">2</a> and<a href="https://s.tencent.com/research/report/900.html"> 3</a>, but with the following notable changes:</p>
<ul>
<li>Delete the PostgreSQL table right after code launch to achieve fileless execution.</li>
<li>Collect system information and send it to the command and control (C2) server for victim identification.</li>
<li>Employ traditional and novel approaches to download curl binary in case the command is not available on the victim’s machine.</li>
<li>Impersonate the &#8220;tracepath&#8221; process to hide its presence.</li>
<li>Attempt to kill competitor programs for better monetization.</li>
</ul>
<h2><a id="post-109776-_dut6oy2rc2vj"></a>Attack Process Overview</h2>
<p>A high-level overview of PGMiner’s execution flow is depicted in Figure 1. As explained before, the malicious payload is delivered via PostgreSQL, which communicates to the backend C2 servers through SOCKS5 proxies. After that, it downloads the coin mining payloads based on the system architecture.</p>
<figure id="attachment_109782" aria-describedby="caption-attachment-109782" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109782" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-32.png" alt="The image shows the process by which PGMiner exploits a disputed PostgreSQL RCE vulnerability. After initial compromise, the malicious payload is delivered via PostgreSQL, which communicates to the backend C2 servers through SOCKS5 proxies. After that, it downloads the coin mining payloads based on the system architecture. " width="900" height="560" /><figcaption id="caption-attachment-109782" class="wp-caption-text">Figure 1. Structure of PGMiner exploiting a disputed PostgreSQL RCE vulnerability.</figcaption></figure>
<p>During our analysis, we found that PGMiner constantly reproduces itself by recursively downloading certain modules. To better illustrate this process, we show the payload relationship in Figure 2. Each box links to a sample identified in the infection chain. The record contains filename, abbreviated SHA256 value and file type information. Note that whenever the architecture information is in the filename, we iterate through all other possible architectures and add the samples in the graph if successfully downloaded. The abbreviated C2 for each stage is marked with dark green. Also, the samples in light blue boxes have been extensively studied in previous research work (<a href="https://blog.netlab.360.com/systemdminer-when-a-botnet-borrows-another-botnets-infrastructure/">SystemdMiner</a> and its variants <a href="https://zhuanlan.kanxue.com/article-10818.htm">1</a>, <a href="https://zhuanlan.kanxue.com/article-10818.htm">2</a> and<a href="https://zhuanlan.kanxue.com/article-10818.htm"> 3</a>). Here, we’ll focus on the samples that appear in light red boxes and provide a summary of the rest.</p>
<figure id="attachment_109800" aria-describedby="caption-attachment-109800" style="width: 630px" class="wp-caption aligncenter"><img class="wp-image-109800 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/image7.png" alt="This figure shows the PGMiner payload relationship. Each box links to a sample identified in the infection chain. The record contains filename, abbreviated SHA256 value and file type information. Note that whenever the architecture information is in the filename, we iterate through all other possible architectures and add the samples in the graph if successfully downloaded. The abbreviated C2 for each stage is marked with dark green. Also, the samples in light blue boxes have been extensively studied in previous research work (SystemdMiner and its variants 1, 2 and 3). Here, we’ll focus on the samples that appear in light red boxes and provide a summary of the rest." width="630" height="306" /><figcaption id="caption-attachment-109800" class="wp-caption-text">Figure 2. PGMiner payload relationship.</figcaption></figure>
<h2><a id="post-109776-_9a8toc1ukw6s"></a>Initial Compromise via PostgreSQL Exploit</h2>
<p>The root sample that triggered our investigation is <span style="font-family: 'courier new', courier, monospace;">55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b</span>, which is an AARCH64 ELF file that is static linked and stripped. At the time of this writing, none of the vendors on <a href="https://www.virustotal.com/gui/file/55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b/detection">VirusTotal</a> is able to detect this malware, as shown in Figure 3.</p>
<figure id="attachment_109786" aria-describedby="caption-attachment-109786" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109786" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-34.png" alt="This shows how, at the time this blog was written, none of the vendors on VirusTotal detect PGMiner. " width="900" height="236" /><figcaption id="caption-attachment-109786" class="wp-caption-text">Figure 3. None of the vendors on VirusTotal detect PGMiner.</figcaption></figure>
<p>The sample above works as an exploit tool that attempts to exploit a controversial feature in PostgreSQL that allows RCE on the server’s operating system (OS). By reverse engineering the binary as shown in Figure 4, we found the sample has the <em>libpq</em> postgresql client library statically linked. This is used for communicating with the target database servers. The attacker scans port 5432 (<span style="font-family: 'courier new', courier, monospace;">0x1538</span>), used by PostgreSQLql of the hosts in the private/local network (i.e., <span style="font-family: 'courier new', courier, monospace;">172.16.0.0, 192.168.0.0</span> and <span style="font-family: 'courier new', courier, monospace;">10.0.0.0</span> subnets). The malware randomly picks a public network range (e.g., <span style="font-family: 'courier new', courier, monospace;">190.0.0.0, 66.0.0.0</span>) in an attempt to perform RCE on the PostgreSQL server. With the user &#8220;postgres&#8221;, which is the default user of the database, the attacker performs a brute-force attack iterating over a built-in list of popular passwords such as <em>&#8220;</em><span style="font-family: 'courier new', courier, monospace;">112233</span><em>&#8220;</em> and <em>&#8220;</em><span style="font-family: 'courier new', courier, monospace;">1q2w3e4r</span><em>&#8220;</em> to crack the database authentication.</p>
<figure id="attachment_109788" aria-describedby="caption-attachment-109788" style="width: 835px" class="wp-caption aligncenter"><img class="wp-image-109788" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-35.png" alt="By reverse engineering the binary as shown here, we found the sample has the libpq postgresql client library statically linked. " width="835" height="542" /><figcaption id="caption-attachment-109788" class="wp-caption-text">Figure 4. PostgreSQL exploit code flow in PGMiner.</figcaption></figure>
<p>Once the malware successfully breaks into the database, it uses the PostgreSQL &#8220;copy from program&#8221; feature to download and launch the coin mining scripts. The &#8220;copy from program&#8221; feature has been controversial since its debut in PostgreSQL 9.3. The feature allows the local or remote superuser to run shell script directly on the server, which has raised wide security concerns. In 2019, a CVE-2019-9193 was assigned to this feature, naming it as a &#8220;vulnerability.&#8221; However, the PostgreSQL community challenged this assignment, and the CVE has been labeled as &#8220;disputed.&#8221; The main argument against defining the feature as a vulnerability is that the feature itself does not impose a risk as long as the superuser privilege is not granted to remote or untrusted users and the access control and authentication system works well. On the other side, security researchers worry that this feature indeed makes PostgreSQL a stepping stone for remote exploit and code execution directly on the server’s OS beyond the PostgreSQL software, if the attacker manages to own the superuser privilege by brute-forcing password or SQL injection.</p>
<figure id="attachment_109790" aria-describedby="caption-attachment-109790" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109790" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-36.png" alt="This shows the actual exploit content from PGMiner, which can be broken down to the following steps: clear the &quot;abroxu&quot; table if it exists, create the table with a text column, save the malicious payload to table &quot;abroxu&quot;, execute the payload on the PostgreSQL server, clear the created table. " width="900" height="750" /><figcaption id="caption-attachment-109790" class="wp-caption-text">Figure 5. PGMiner’s exploit content to PostgreSQL.</figcaption></figure>
<p>While this CVE is still being disputed, malware authors apparently have started to use it to stay under the detection radar by making the attack payload fileless. The actual exploit content from PGMiner is shown in Figure 5, which can be broken down to the following steps:</p>
<table style="width: 99.4843%;">
<tbody>
<tr>
<td style="width: 47.1751%;"><strong>Step</strong></td>
<td style="width: 177.825%;"><strong>SQL command</strong></td>
</tr>
<tr>
<td style="width: 47.1751%;">Clear the “abroxu” table if it exists.</td>
<td style="width: 177.825%;">DROP TABLE IF EXISTS abroxu;</td>
</tr>
<tr>
<td style="width: 47.1751%;">Create the table with a text column.</td>
<td style="width: 177.825%;">CREATE TABLE abroxu(cmd_output text)<em>;</em></td>
</tr>
<tr>
<td style="width: 47.1751%;">Save the malicious payload to table &#8220;abroxu&#8221;.</td>
<td style="width: 177.825%;">COPY abroxu FROM PROGRAM “<em>shell command</em>”;</td>
</tr>
<tr>
<td style="width: 47.1751%;">Execute the payload on the PostgreSQL server.</td>
<td style="width: 177.825%;">SELECT * FROM cmd_exec;</td>
</tr>
<tr>
<td style="width: 47.1751%;">Clear the created table.</td>
<td style="width: 177.825%;">DROP TABLE IF EXISTS abroxu;</td>
</tr>
</tbody>
</table>
<p>The malicious script payload saved in the &#8220;abroxu&#8221; table reassembles some of the characteristics from the known SystemdMiner malware family and its variants. Here we only highlight the major ways that PGMiner evolves from SystemdMiner, as well as overlooked functionalities. We have also added annotation to the script shown in the figures below to make this clear.</p>
<h4><a id="post-109776-_5ct12oeuaasy"></a><strong>Downloading Curl</strong></h4>
<p>In the case that the curl command is not available on the victim’s machine, the malicious script tries multiple approaches (see Figure 6) to download the curl binary and add it to the execution paths:</p>
<ul>
<li>Direct installation from official package management utilities like <span style="font-family: 'courier new', courier, monospace;">apt-get</span> and <span style="font-family: 'courier new', courier, monospace;">yum</span><em>.</em></li>
<li>Download static curl binary from GitHub.</li>
<li>Download using <span style="font-family: 'courier new', courier, monospace;">/dev/tcp</span> in case the normal ways don’t work.</li>
</ul>
<figure id="attachment_109792" aria-describedby="caption-attachment-109792" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109792" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-37.png" alt="In case the curl command is not available on the victim's machine, the malicious script tries multiple approaches to download the curl binary and add it to the execution paths, including: direct installation from official package management utilities like apt-get and yum; download the static curl binary from GitHub, dowload using /dev/tcp in case the normal ways don't work. " width="900" height="668" /><figcaption id="caption-attachment-109792" class="wp-caption-text">Figure 6. PGMiner’s multiple attempts to download curl binaries.</figcaption></figure>
<p>While the first two approaches are well-known, the third one is quite unique. What’s more interesting is the target IP address: <span style="font-family: 'courier new', courier, monospace;">94[.]237[.]85[.]89</span>. It is connected to the domain <span style="font-family: 'courier new', courier, monospace;">newt[.]keetup[.]com</span>. While its parent domain, <span style="font-family: 'courier new', courier, monospace;">keepup[.]com</span>, seems like a legitimate business website, this particular subdomain is redirecting port 80 to 443<em>,</em> which is used to host a <a href="https://couchdb.apache.org/">couchdb</a> named newt. Although port 8080 is not open to the public, we believe it has been configured to allow Cross-Origin Resource Sharing (<a href="https://docs.couchdb.org/en/latest/config/http.html#cors/origins">CORS</a>), as shown in Figure 7.</p>
<figure id="attachment_109794" aria-describedby="caption-attachment-109794" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109794" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-38.png" alt="Although port 8080 is not open to the public, we believe it has been configured to allow Cross-Origin Resource Sharing (CORS). " width="900" height="225" /><figcaption id="caption-attachment-109794" class="wp-caption-text">Figure 7. newt[.]keetup[.]com is hosting a couchdb for curl binary downloading.</figcaption></figure>
<h4><a id="post-109776-_evzhsfn7ixmv"></a><strong>Resolving SOCKS5/TOR Relay Server Name</strong></h4>
<p>The C2 host name has been updated to <span style="font-family: 'courier new', courier, monospace;">nssnkct6udyyx6zlv4l6jhqr5jdf643shyerk246fs27ksrdehl2z3qd[.]onion</span>. PGMiner also utilizes the SOCKS5 proxy technique to communicate with the C2, as described in this <a href="https://zhuanlan.kanxue.com/article-10818.htm">SystemdMiner variant</a>. However, as shown in Figure 8, the DNS server list has been expanded.</p>
<figure id="attachment_109796" aria-describedby="caption-attachment-109796" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109796" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-39.png" alt="The code from PGMiner shown here illustrates how the C2 host name has been updated and the DNS server list expanded. " width="900" height="435" /><figcaption id="caption-attachment-109796" class="wp-caption-text">Figure 8. Updated C2 and expanded DNS server list observed in PGMiner.</figcaption></figure>
<h4><a id="post-109776-_dwmjgualw298"></a><strong>Fetch Payloads From C2 and Launch PGMiner</strong></h4>
<p>After resolving the SOCKS5 proxy server IP address, PGMiner rotates through a list of folders to find the first one that allows permission to create a new file and update its attributes. This ensures the downloaded malicious payload can successfully execute on the victim’s machine. This function has been observed in the previous research on the <a href="https://zhuanlan.kanxue.com/article-10818.htm">SystemdMiner variant</a>, but the author of the research did not provide an explanation of its purpose.</p>
<p>The malware family also evolves with client tracking functionality. It concatenates the IP address, username, architecture, hostname and md5 of all inet IP ranges, as well as the base64 encoding of the crontab content, to formulate the client’s unique identifier, which it reports to the C2 server. The code snippet is highlighted in Figure 9.</p>
<figure id="attachment_109798" aria-describedby="caption-attachment-109798" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109798" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/12/word-image-40.png" alt="The code snippet highlighted here shows how the malware family evolves with client tracking functionality. It concatenates the IP address, username, architecture, hostname and md5 of all inet IP ranges, as well as the base64 encoding of the crontab content, to formulate the client’s unique identifier, which it reports to the C2 server. " width="900" height="810" /><figcaption id="caption-attachment-109798" class="wp-caption-text">Figure 9. PGMiner featches payloads from C2 and executes them.</figcaption></figure>
<h2><a id="post-109776-_ywtmwxe0et2k"></a>Multi-Architecture Payloads</h2>
<p>With different architectures supplied to the C2 server mentioned above, we were able to recover the following list of payloads. The downloads for other architectures failed.</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">a935d364622ebefbee659caaa9d0af5828952ab9501591c935cf1f919e2a38ff</span> pg.aarch64: Shell Script</li>
<li><span style="font-family: 'courier new', courier, monospace;">a935d364622ebefbee659caaa9d0af5828952ab9501591c935cf1f919e2a38ff</span> pg.armv7l: Shell Script</li>
<li><span style="font-family: 'courier new', courier, monospace;">6d296648fdbc693e604f6375eaf7e28b87a73b8405dc8cd3147663b5e8b96ff0</span> pg.x86_64: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header</li>
</ul>
<p>Interestingly, the payload for x86_64 is an ELF executable, while for aarch64 and armv7l, the payload is an identical shell script.</p>
<h4><a id="post-109776-_4u1js48jv43"></a><strong>x86_64 ELF Payload</strong></h4>
<p>The x86_64 ELF payload shares the majority of behaviors seen in the previous <a href="https://zhuanlan.kanxue.com/article-10818.htm">SystemdMiner variant</a>, yet evolves with additional capabilities:</p>
<ul>
<li>Environment Preparation:
<ul>
<li>Download and install curl binary as explained above.</li>
<li>Install crontab.</li>
<li>Remove cloud security monitor tools such as Aegis, and Qcloud monitor utilities such as Yunjing.</li>
</ul>
</li>
<li>Virtual Machine Checking: PGMiner checks the existence of VBoxGuestAdditions to infer whether it is being analyzed in a virtual environment.</li>
<li>Competitors Removal:
<ul>
<li>Remove other known miner scripts, processes and crontab records.</li>
<li>Kill miner cleanup processes.</li>
<li>Kill all other CPU intensive processes such as ddg, system updates and so on.</li>
<li>Kill processes connected to known mining IP addresses.</li>
</ul>
</li>
</ul>
<h2><a id="post-109776-_rvd8igdhxrx5"></a>armv7l/aarch64 Shell Script Payload</h2>
<p>From the x86_64 ELF payload, we were able to recover the CPU file from C2 <span style="font-family: 'courier new', courier, monospace;">jk5zra7b3yq32timb27n4qj5udk4w2l5kqn5ulhnugdscelttfhtoyd[.]onion</span>, which is the coin mining module for PGMiner. However, the other cmd and bot modules are unavailable from the C2. Here, the armv7l/aarch64 shell script connects to a different C2, <span style="font-family: 'courier new', courier, monospace;">reambusweduybcp[.]onion</span>. It also attempts to download the cmd file. This time, it succeeds. This indicates that the C2 server for this malware family is constantly updating. Different modules are distributed across different C2s.</p>
<p>The cmd module first attempts to kill the tracepath process. Then, it downloads additional payload from the same C2 address. The downloaded malware impersonates the tracepath process to hide its presence. After analyzing the aarch64 payload, we recovered the same shell script initially used to run on PostgreSQL servers, which completes the analysis.</p>
<h2><a id="post-109776-_mojyf959lq2"></a>Mitigations and Recommendations</h2>
<p>Palo Alto Networks Next-Generation Firewall customers are protected against PGMiner via the WildFire and Threat Prevention security subscriptions. At the same time, we urge PostgreSQL users to remove the “<span style="font-family: 'courier new', courier, monospace;">pg_execute_server_program</span>” privilege from untrusted users, which makes the exploit impossible. Moreover, we continue to recommend that users download software from trusted sources, manage strong and secure passwords and apply patches in a timely manner.</p>
<p>To remove the impact of PGMiner on the PostgreSQL server, the user can search and kill the “tracepath” process, which this malware impersonates, and kill the processes whose process IDs (PIDs) have been tracked by the malware in “<span style="font-family: 'courier new', courier, monospace;">/tmp/.X11-unix/</span>”.</p>
<h2><a id="post-109776-_g6ho2bsi9tp"></a>Conclusion</h2>
<p>In this research, we unveiled PGMiner, a new cryptocurrency mining botnet delivered via a disputed PostgreSQL RCE vulnerability. The fact that PGMiner is exploiting a disputed vulnerability helped it remain unnoticed until we recently uncovered it at Palo Alto Networks.</p>
<p>PGMiner can potentially be disruptive, as PostgreSQL is widely adopted in PDMS. With additional effort, the malware could target all major operating systems. For example, PostgreSQL is available for all major platforms, including macOS, Windows and Linux. Theoretically, the malware actors could implement another version of PGMiner by targeting a new platform, such as Windows, and deliver it using PostgreSQL.</p>
<p>During our analysis, we observed new techniques, such as embedding victim identification in the request, impersonating a trusted process name, downloading curl binary via multiple approaches and more and aggressively killing all competitor programs. We also analyzed how the malware seeks to better track victims, execute, hide itself and monetize. Other traits, such as the malware recursively downloading itself and frequently changing C2 addresses, also indicate PGMiner is still rapidly evolving.</p>
<h2><a id="post-109776-_hyuqjx7e872g"></a>Additional Information on Cryptojacking</h2>
<ul>
<li><a href="https://unit42.paloaltonetworks.com/highlight-cloud-threat-report-iam/">Highlights from the Unit 42 Cloud Threat Report, 2H 2020</a></li>
<li><a href="https://unit42.paloaltonetworks.com/black-t-cryptojacking-variant/">Black-T: New Cryptojacking Variant from TeamTnT</a></li>
<li>Cetus: Cryptojacking Worm Targeting Docker Daemons</li>
</ul>
<h2><a id="post-109776-_wnf5mmgk0r5j"></a>Indicator of Compromise (IOCs)</h2>
<p>Sample and payload identification as a tuple of filename, SHA256 and file type:</p>
<ul>
<li>root.bin, <span style="font-family: 'courier new', courier, monospace;">55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b</span>, ELF 64-bit LSB executable, ARM aarch64, version 1 (SYSV), statically linked, stripped</li>
<li>pg.x86_64, <span style="font-family: 'courier new', courier, monospace;">6d296648fdbc693e604f6375eaf7e28b87a73b8405dc8cd3147663b5e8b96ff0</span>, ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header</li>
<li>int.x86_64, <span style="font-family: 'courier new', courier, monospace;">6984a04d7e435499ff267cfaf913d51e8644f6c08db8069c56f9247f1e18ba71</span>, ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header</li>
<li>cpu, <span style="font-family: 'courier new', courier, monospace;">fef1a83ba6aba160116a8251462dd842f68464a5f767b2e3194820d62fef23b1</span>, ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header</li>
<li>pg.aarch64 / pg.armv7l, <span style="font-family: 'courier new', courier, monospace;">a935d364622ebefbee659caaa9d0af5828952ab9501591c935cf1f919e2a38ff</span>, Shell Script</li>
<li>cmd, <span style="font-family: 'courier new', courier, monospace;">864ece624b7069b929385f9cf741355a371e844aa3726d340f91549562e2c604</span>, Shell Script</li>
<li>dream.aarch64, <span style="font-family: 'courier new', courier, monospace;">d8c46be19ff3ea5b2c12f050f226a199aaa5f76cc1731c868e29eea6c68b6801</span>, ELF 64-bit LSB executable, ARM aarch64, version 1 (SYSV), statically linked, no section header</li>
<li>dream.armv7l, <span style="font-family: 'courier new', courier, monospace;">8d44fbbefa0c59a65e21b0d1598ff7c51487ea1cede544d1c3f56d5db0ea7807</span>, ELF 32-bit LSB executable, ARM, EABI5 version 1 (GNU/Linux), statically linked, no section header</li>
<li>dream.mips, <span style="font-family: 'courier new', courier, monospace;">41ef5c6b0cdd068f117902e59233991082a4ecb4877a1fb16016e756412f06ea</span>, ELF 32-bit LSB executable, MIPS, MIPS-I version 1 (SYSV), statically linked, no section header</li>
</ul>
<p>Additional samples related to the <span style="font-family: 'courier new', courier, monospace;">55698654f0fbcf5a6d52f3f44bc0f2257e06835e76fb7142d449a2d1641d7e4b:</span></p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">1b1d6d5f01b26e4ccf6fff8f2626f9318084dc1123ac67ed7d02f955b72a1432</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">0fc1332d2b20ea43d3c3fea50a48bb1991522bc6c79d518ba9b68a763ef2ad58</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">8a13c3fe815f15a5600fda30d132dfbd4bb54d9c766da164060dd1d66b12e9e4</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">6d95b593f0b5e3cc1985635ad2b943acb083833fea8123e7ac3f88f68e04edd6</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">101ccbad7732fb185d51b91d31a67ff058cac3bc31ec36cec05094065a97d6fd</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">d4cf8cfb4dc9cc3101b8c850369a71af70f11e67df7e41e9af98624ebe54ff4a</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">47d56fcbf5d90b9c513d8d38a2c00e4bad6ea4e1d17b05dd37feb4d63b2856e1</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">e3c5abe56964ddb3b4f0b3c434a9af145efca558307c65d30e8acc5aed45bedc</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">524cce2cf615809bc08ca80facf95f2be7c5071c4cb3eac38c20a1f0ed39ce1f</span></li>
</ul>
<p>C2:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">nssnkct6udyyx6zlv4l6jhqr5jdf643shyerk246fs27ksrdehl2z3qd[.]onion</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">ojk5zra7b3yq32timb27n4qj5udk4w2l5kqn5ulhnugdscelttfhtoyd[.]onion</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">dreambusweduybcp[.]onion</span></li>
</ul>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","enable_video_popuping":"enable","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
