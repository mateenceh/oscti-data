
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Tracking OceanLotus’ new Downloader, KerrDown</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/tracking-oceanlotus-new-downloader-kerrdown/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Tracking OceanLotus’ new Downloader, KerrDown" />
<meta property="og:description" content="OceanLotus (AKA APT32) is a threat actor group known to be one of the most sophisticated threat actors originating out of south east Asia. 
This blog will cover a new custom downloader malware family we’ve named “KerrDown” which OceanLotus have been actively using since at least early 2018." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="KerrDown" />
<meta property="article:tag" content="OceanLotus" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2019-02-01T14:00:44+00:00" />
<meta property="article:modified_time" content="2019-03-14T18:55:41+00:00" />
<meta property="og:updated_time" content="2019-03-14T18:55:41+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="OceanLotus (AKA APT32) is a threat actor group known to be one of the most sophisticated threat actors originating out of south east Asia.  This blog will cover a new custom downloader malware family we’ve named “KerrDown” which OceanLotus have been actively using since at least early 2018." />
<meta name="twitter:title" content="Tracking OceanLotus’ new Downloader, KerrDown" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Tracking OceanLotus’ new Downloader, KerrDown Comments Feed" href="https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="7"/>
<meta property="og:views" content="37,607"/>
<meta property="og:date_created" content="February 1, 2019 at 6:00 AM"/>
<meta property="og:post_length" content="2999"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Vicky Ray"/>
<meta property="og:author" content="Kaoru Hayashi"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/vicky-khan/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/khayashi/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Tracking OceanLotus\u2019 new Downloader, KerrDown","name":"Tracking OceanLotus\u2019 new Downloader, KerrDown","description":"OceanLotus\u00a0(AKA APT32)\u00a0is a threat actor group known to be one of the most sophisticated threat actors\u00a0originating out of south east\u00a0Asia.\u00a0\r\nThis blog will cover a new custom downloader malware family\u00a0we\u2019ve named \u201cKerrDown\u201d\u00a0which\u00a0OceanLotus\u00a0have been actively using since at least\u00a0early\u00a02018.","url":"https:\/\/unit42.paloaltonetworks.com\/tracking-oceanlotus-new-downloader-kerrdown\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/tracking-oceanlotus-new-downloader-kerrdown\/","datePublished":"February 1, 2019","articleBody":"OceanLotus\u00a0(AKA APT32)\u00a0is a threat actor group known to be one of the most sophisticated threat actors\u00a0originating out of south east\u00a0Asia.\u00a0Multiple attack campaigns\u00a0have been\u00a0reported\u00a0by number of security organizations in the last couple of years,\u00a0documenting\u00a0the tools and tactics used by the threat actor.\u00a0While\u00a0OceanLotus\u2019 targets are global, their operations are mostly active within the APAC region which encompasses targeting private sectors across multiple industries, foreign governments, activists,\u00a0and\u00a0dissidents connected to Vietnam.\u00a0\r\n\r\nThis blog will cover a new custom downloader malware family\u00a0we\u2019ve named \u201cKerrDown\u201d\u00a0which\u00a0OceanLotus\u00a0have been actively using since at least\u00a0early\u00a02018.\u00a0We also show\u00a0how the\u00a0jaccard-index\u00a0algorithm\u00a0was used to quickly find similarities\u00a0between the new\u00a0KerrDown\u00a0malware family within our datasets.\u00a0This method has proven to be very useful to extract similarities from large sample datasets and\u00a0connecting attack campaigns\u00a0together.\u00a0Given the\u00a0large number of\u00a0\u201cKerrDown\u201d\u00a0samples\u00a0found,\u00a0we were also able to\u00a0discern possible patterns in\u00a0OceanLotus\u2019\u00a0working hours\u00a0and days of a week which is discussed in the later sections\u00a0of this blog.\u00a0\r\n\r\nWe identified\u00a0two methods to deliver\u00a0the\u00a0KerrDown\u00a0downloader\u00a0to targets. One is using the Microsoft Office Document with\u00a0a\u00a0malicious macro\u00a0and the other is\u00a0RAR\u00a0archive\u00a0which\u00a0contains\u00a0a\u00a0legitimate program with\u00a0DLL side-loading.\u00a0For\u00a0RAR archive files, the file names used\u00a0to trick targets are\u00a0all\u00a0in Vietnamese\u00a0as shown in Figure 11.\u00a0Our analysis shows that the primary targets of the ongoing campaign discussed in this blog are either in Vietnam or Vietnamese speaking individuals.\u00a0\u00a0\r\nMalicious\u00a0Document\r\nOur analysis began with an active mime document, something we've seen OceanLotus use before but this time involving a new payload, KerrDown.\u00a0The lure hash is\u00a0\r\n\r\n(SHA256:89e19df797481ae2d2c895bcf030fe19e581976d2aef90c89bd6b3408579bfc3)\u00a0\r\n\r\nFigure 1 below shows\u00a0a\u00a0snapshot of the lure file. Once the victim opens the lure document,\u00a0which includes an image file with a message in Vietnamese\u00a0which\u00a0that\u00a0asks the victim to enable macros to view the contents of the file.\u00a0At first glance\u00a0the document may look like there\u00a0is\u00a0no other content other than the notification to enable macros. However,\u00a0a\u00a0closer look reveals two different\u00a0base64\u00a0blobs inserted in the page in separate tables and the font size has been changed to 1 which may deceive victims to overlook the content. Another reason for this technique may\u00a0be that many automated tools are able to detect the presence of an embedded binary within the streams of such files and this technique may allow them to go undetected.\u00a0\u00a0\r\nDelivery\u00a0Document\u00a0Analysis\r\n\r\n\u00a0\u00a0Figure\u00a01:\u00a0Lure document\r\nOnce we increase the font size, the\u00a0base64\u00a0blobs are visible in two different tables. Once decoded you can see the MZ header of the\u00a0PE\u00a0DLL\u00a0at the beginning of each table, as shown in\u00a0Figure 2.\u00a0\u00a0\u00a0\r\n\r\n\r\nFigure\u00a02:\u00a0Base64\u00a0encoded\u00a0pedll\u00a0files\u00a0embedded as text in the document.\u00a0\r\nFigure 3 shows a code excerpt from the embedded macro that checks which\u00a0base64\u00a0blob should be decoded based on the\u00a0iCheck\u00a0variable, a\u00a0Boolean value\u00a0which is\u00a0set to true if the\u00a0victim system is running on a 64-bit system\u00a0and false on a 32-bit system.\u00a0If the system is found to be 64-bit, the\u00a0base64\u00a0encoded blob on\u00a0the left\u00a0is decoded\u00a0otherwise\u00a0the\u00a0base64\u00a0encoded blob on\u00a0the right is decoded.\u00a0\r\n\r\n\r\nFigure\u00a03:\u00a0Base64\u00a0blob selection based on system check\u00a0\r\nWe also noticed that the\u00a0actors reused the\u00a0VBS decode function\u00a0published by\u00a0Motobit. Figure 4 shows the comparison between the\u00a0base64\u00a0function used in the macro code and the VBS\u00a0base64\u00a0decoder function published by\u00a0Motobit.\u00a0\r\n\r\n\u00a0\r\nFigure\u00a04:\u00a0Base64\u00a0decoder comparison\u00a0\r\n\r\nSimilarity\u00a0Analysis\u00a0of\u00a0KerrDown\u00a0Samples\u00a0using Jaccard-Index\u00a0\r\nOnce we decoded and extracted both\u00a0DLL\u00a0files from the document we\u00a0used\u00a0a similarity analysis algorithm\u00a0using\u00a0the\u00a0Jaccard index\u00a0to\u00a0check the binaries against known set of malware families used by\u00a0OceanLotus\u00a0\u00a0which yielded no matches with any previous\u00a0OceanLotus\u00a0malware families.\u00a0However, we were able to find multiple other samples in our datasets using\u00a0the\u00a0imphash\u00a0value\u00a0of the\u00a0KerrDown\u00a0samples\u00a0and\u00a0the accompanying\u00a0C2\u00a0domains. Given the\u00a0high\u00a0number of samples found, we\u00a0again\u00a0used\u00a0a\u00a0similarity analysis algorithm using\u00a0Jaccard Index\u00a0to extract similarities between all the samples found.\u00a0At this stage we were not sure if the\u00a0DLL\u00a0files were a backdoor or had\u00a0any other functionality. Hence, we included\u00a0a\u00a0few other\u00a0known\u00a0OceanLotus\u00a0malware family samples\u00a0used no earlier than 2017\u00a0to our similarity test,\u00a0and in\u00a0most cases samples which were final payloads\u00a0dropped in victim machines.\u00a0\u00a0One of the main objectives\u00a0was to quickly discern\u00a0if\u00a0KerrDown\u00a0could have been variants of the known malware families we have been tracking or was\u00a0OceanLotus\u00a0employing a new malware family in their playbooks and in the recent campaigns. Plotting the\u00a0Jaccard index results using\u00a0networkx\u00a0we can quickly visualize the similarities extracted. As you can see from Figure 5, there is a thick cluster of samples at the top right of the\u00a0networkx\u00a0graph which did not have any similarities with the other known\u00a0OceanLotus\u00a0malware family samples.\u00a0Therefore, this observation was helpful for us to\u00a0understand that the samples we were looking into were likely a new malware family being employed by the\u00a0OceanLotus\u00a0group\u00a0at the time of analysis,\u00a0which we\u00a0have now named\u00a0KerrDown.\r\nFigure\u00a05: Similarity analysis using Jaccard Index\u00a0\r\n\r\nKerrDown\u00a0to\u00a0Cobalt\u00a0Strike\u00a0Beacon\u00a0\r\nAs discussed in the delivery document\u00a0analysis above,\u00a0depending on the OS architecture either of the embedded\u00a0KerrDown\u00a0DLLs\u00a0will be dropped in the victim machine. The\u00a0DLL\u00a0is dropped in the directory location \u2018Users\\Administrator\\AppData\\Roaming\\\u2019\u00a0as \u2018main_background.png\u2019.\u00a0The DLL retrieves the payload from\u00a0the\u00a0URL, decrypts it by using DES algorithm and\u00a0execute it\u00a0in\u00a0the\u00a0memory. Therefore, it is observed that only the\u00a0KerrDown\u00a0DLL\u00a0downloader is saved in the system and the payload directly gets executed in the memory without being written in the system. Table\u00a01\u00a0shows the\u00a0URL\u00a0the downloader will attempt to download the payload from depending on the\u00a0OS architecture of the victim machine.\u00a0\r\n\r\n\r\n\r\nOS\u00a0Architecture\u00a0\r\nURL\u00a0\r\nUser Agent\u00a0\r\n\r\n\r\n32\u00a0bit\u00a0\r\nhttps:\/\/syn.servebbs[.]com\/kuss32.gif\u00a0\r\nMozilla\/5.0 (Windows NT 10.0; Win32; x32; rv:60.0)\u00a0\r\n\r\n\r\n64\u00a0bit\u00a0\r\nhttps:\/\/syn.servebbs[.]com\/kuss64.gif\u00a0\r\nMozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:60.0)\u00a0\r\n\r\n\r\n\r\nTable\u00a01\u00a0:\u00a0Payload\u00a0DLL\u00a0selection based on architecture\u00a0\r\nThe link to the final payload of\u00a0KerrDown\u00a0was still active during the time of analysis and hence we were able to download a copy which turned out to be a variant of Cobalt\u00a0Strike\u00a0Beacon. Cybereason also\u00a0published\u00a0previously on\u00a0OceanLotus\u00a0using Cobalt\u00a0Strike in their campaigns\u00a0and\u00a0it is interesting to see the use of a new downloader malware family being used to\u00a0still\u00a0deliver the final payload of Cobalt\u00a0Strike. As we can see in this case, the purpose of the malware is to download and execute the Cobalt\u00a0Strike Beacon payload in memory. Though Cobalt\u00a0Strike is a commercial penetration testing tool,\u00a0various threat actors\u00a0are\u00a0known to have used it in their campaigns.\u00a0\u00a0\r\nRAR\u00a0Archives with\u00a0KerrDown\u00a0\r\nWhile investigating\u00a0KerrDown\u00a0we found multiple\u00a0RAR\u00a0files containing\u00a0a variant of the\u00a0malware.\u00a0We haven\u2019t\u00a0yet\u00a0identified\u00a0the\u00a0delivery\u00a0method\u00a0or\u00a0targets of\u00a0this\u00a0variant.\u00a0The attacker changed\u00a0the downloader code by adding more\u00a0stages\u00a0and\u00a0hiding\u00a0each stage by compression and encryption. They also\u00a0changed\u00a0the way\u00a0to execute the malicious code from\u00a0an\u00a0Office\u00a0macro to the\u00a0DLL\u00a0side-loading technique through\u00a0a\u00a0legitimate program.\u00a0\u00a0\r\n\r\nThe\u00a0RAR\u00a0archive\r\n\r\n(SHA256:040abac56542a2e0f384adf37c8f95b2b6e6ce3a0ff969e3c1d572e6b4053ff3)\r\n\r\nhas\u00a0the\u00a0Vietnamese file name\u00a0\u2018Don\u00a0khieu\u00a0nai.rar\u2019\u00a0which\u00a0translates to\u00a0'Complaint letter' in English. The archive contains\u00a0a\u00a0legitimate\u00a0older version of Microsoft Word (Microsoft Word 2007)\u00a0executable file\u00a0that\u00a0is\u00a0named\u00a0\u2018Noi\u00a0dung chi\u00a0tiet\u00a0don\u00a0khieu\u00a0nai\u00a0gui\u00a0cong\u00a0ty.exe\u2019\u00a0which\u00a0translates to\u00a0\u2018Learn more about how to use your company\u2019\u00a0in English. The attacker used\u00a0the DLL side loading technique to load a malicious DLL by the older\u00a0version of Microsoft Word.\u00a0When opening the executable file in the archive, it\u00a0loads\u00a0the\u00a0malicious DLL in the same directory. The DLL\u00a0executes multi-stage shellcodes\u00a0and each shellcode employs various technique to hide the next stage.\u00a0The overall\u00a0installation\u00a0steps are\u00a0below:\u00a0\r\n\r\n \tThe Microsoft Word exe loads wwlib.dll in the same directory and executes \u2018FMain\u2019 function of the DLL.\r\n \tThe DLL decodes\u00a0base64\u00a0encoded shellcode in the body and executes it.\u00a0\r\n \tThe shellcode decompresses the second shellcode which is compressed with\u00a0the open source compression code UCL\u00a0and execute it.\u00a0\r\n \tThe second shellcode decrypts the third shellcode with AES.\u00a0\r\n \tThe third shellcode retrieves the shellcode from\u00a0the\u00a0following remote location and executes it:\u00a0https:\/\/cortanasyn[.]com\/Avcv\u00a0\r\n \tThe fourth shellcode\u00a0loads\u00a0the embedded Cobalt\u00a0Strike Beacon DLL\u00a0in memory and executes it.\u00a0\r\n\r\n\r\nFigure\u00a06:\u00a0Execution flow of sideloaded malicious downloader\u00a0\r\nLooking at the compile timestamps of\u00a0all the\u00a0KerrDown\u00a0samples\u00a0in our datasets\u00a0we were able to discern\u00a0a\u00a0couple of observations:\u00a0\r\n\r\n \tOceanLotus\u00a0has been\u00a0using the new downloader in their campaigns since at least March 2018 and continues to actively use it in their campaigns. Figure\u00a07\u00a0shows the timeline of the\u00a0KerrDown\u00a0samples:\u00a0\r\n\r\n\r\nFigure\u00a07:\u00a0Downloader DLL compile time lines\u00a0\r\n\r\n\r\n \tWhile it is already widely\u00a0believed\u00a0that the\u00a0OceanLotus\u00a0group may originate from Vietnam, we wanted to find possible working hour patterns from the samples in our datasets.\u00a0We plotted the compile times based on GMT +7 and found a clear pattern of the possible working hours of the group. The\u00a0OceanLotus\u00a0group has a typical 9 AM to 6 PM working pattern\u00a0with most samples compiled during this period of the day.\u00a0Figure\u00a08\u00a0shows the malware compilation timestamps in GMT +7\u00a0for each unique sample found in our dataset.\u00a0\r\n\r\n\r\nFigure\u00a08:\u00a0Malware compilation times in GMT +7\u00a0\r\n\r\n\r\n \t\u00a0We also observed all the samples were compiled during the weekdays\u00a0- between Monday to Friday. Therefore, it is clear that the\u00a0OceanLotus\u00a0group works\u00a0during weekdays and takes\u00a0a break during the weekends. Figure\u00a09\u00a0shows the samples compiled during the week.\u00a0\r\n\r\n\r\nFigure\u00a09:\u00a0Malware compilation during weekdays\u00a0\r\n\r\nConclusion\u00a0\r\nOceanLotus\u00a0has been an active\u00a0threat actor\u00a0group for a number of years and remains one of the most sophisticated threat actors in the APAC region. As we have seen\u00a0with the new\u00a0KerrDown\u00a0downloader being used in their recent campaigns,\u00a0the group continues to build and employ new tools and techniques in their overall operations and playbooks.\u00a0It is therefore imperative to understand and keep a track of the group\u2019s ongoing operations and capability to better defend against such\u00a0threats.\u00a0Given the high number of samples observed, we were also able to\u00a0discern possible working hour patterns which shows us that the group likely has formal working hours and operating out of a region which\u00a0is\u00a0like Vietnam\u00a0or nearby countries.\u00a0While most of the targeting observed\u00a0is\u00a0towards Vietnamese speaking victims, given the known broader geographic and industry wide target base of\u00a0OceanLotus, the group may use similar tools and playbooks\u00a0against\u00a0other targets.\u00a0\u00a0\r\n\r\n\u00a0Palo Alto Networks customers are already protected via:\u00a0\r\n\r\n \t\u00a0All samples in this report have a malicious verdict in WildFire\u00a0\r\n \tDomains have been classified as malicious\u00a0\r\n \tAutoFocus tags are available for additional context:\u00a0OceanLotus\u00a0and\u00a0KerrDown.\u00a0\r\n\r\nIndicators of Compromise:\u00a0\r\nLure Docs:\u00a0\r\n\u00a073dcbcc47d6bd95dcf031ebbd34ac42301a20ee1143ac130b405e79b4ba40fc8\u00a0\r\n\r\n89e19df797481ae2d2c895bcf030fe19e581976d2aef90c89bd6b3408579bfc3\u00a0\r\n\r\na4a066341b4172d2cb752de4b938bf678ceb627ecb72594730b78bd05a2fad9d\u00a0\r\n\r\n8bf22202e4fd4c005afde2266413cba9d1b749b1a2d75deac0c35728b5eb3af8\u00a0\r\n\r\ndf8210d20c5eb80d44ba8fa4c41c26c8421dcb20168e4f796e4955e01ebc9e13\u00a0\r\n\r\n94fab926b73a6a5bc71d655c8d611b40e80464da9f1134bfce7b930e23e273ab\u00a0\r\n\r\n4321a9f95901a77b4acfbaef3596cf681712345e1cbd764873c6643fe9da7331\u00a0\r\nKerrDown\u00a0DLLs:\u00a0\r\n\u00a04a0309d8043e8acd7cb5c7cfca95223afe9c15a1c34578643b49ded4b786506b\u00a0\r\n\r\n4b431af677041dae3c988fcc901ac8ec6e74c6e1467787bf099c4abd658be5be\u00a0\r\n\r\n4bc00f7d638e042da764e8648c03c0db46700599dd4f08d117e3e9e8b538519b\u00a0\r\n\r\n4e2f8f104e6cd07508c5b7d49737a1db5eeba910adfdb4c19442a7699dc78cfc\u00a0\r\n\r\n4e791f2511c9bd3c63c8e37aa6625d8b590054de9e1cca13a7be2630bc2af9ce\u00a0\r\n\r\n539e8a53db3f858914cfe0d2132f11de34a691391ba71673a8b1e61367a963c7\u00a0\r\n\r\n53cd92f37ffd0822cc644717363ba239d75c6d9af0fa305339eaf34077edd22d\u00a0\r\n\r\n53efaac9244c24fab58216a907783748d48cb32dbdc2f1f6fb672bd49f12be4c\u00a0\r\n\r\n5c18c3e6f7ac0d0ac2b5fa9a6435ee90d6bd77995f85bed9e948097891d42ca2\u00a0\r\n\r\n5cda7d8294a8804d09108359dd2d96cdf4fdcf22ec9c00f0182d005afff76743\u00a0\r\n\r\n5f0db8216314da1f128b883b918e5ac722202a2ae0c4d0bf1c5da5914a66778e\u00a0\r\n\r\n6010d44cdca58cdec4559040e08798e7b28b9434bda940da0a670c93c84e33cd\u00a0\r\n\r\n60b65ebb921dca4762aef427181775d10bbffc30617d777102762ab7913a5aa1\u00a0\r\n\r\n6146aedfe47597606fb4b05458ec4b99d4e1042da7dc974fa33a57e282cd7349\u00a0\r\n\r\n6245b74b1cc830ed95cb630192c704da66600b90a331d9e6db70210acb6c7dfa\u00a0\r\n\r\n67cd191eb2322bf8b0f04a63a9e7cb7bc52fb4a4444fcb8fed2963884aede3aa\u00a0\r\n\r\n68f77119eae5e9d2404376f2d87e71e4ab554c026e362c57313e5881005ae79e\u00a0\r\n\r\n69e679daaaff3832c39671bf2b813b5530a70fb763d381f9a6e22e3bc493c8a9\u00a0\r\n\r\n6faa7deb1e1e0c3a7c62c2bb0ecdfa56b6e3ba4fe16971ec4572267ac70b9177\u00a0\r\n\r\n6fb397e90f72783adec279434fe805c732ddb7d1d6aa72f19e91a1bf585e1ea5\u00a0\r\n\r\n70db041fb5aadb63c1b8ae57ba2699baa0086e9b011219dcebcccbf632017992\u00a0\r\n\r\n7673f5468ba3cf01500f6bb6a19ce7208c8b6fc24f1a3a388eca491bc25cd9cd\u00a0\r\n\r\n77805a46f73e118ae2428f8c22ba28f79f7c60aeb6305d41c0bf3ebb9ce70f94\u00a0\r\n\r\n788265447391189ffc1956ebfec990dc051b56f506402d43cd1d4de96709c082\u00a0\r\n\r\n7be613237b57fbc3cb83d001efadeed9936a2f519c514ab80de8285bdc5a666c\u00a0\r\n\r\n7dbb7fab4782f5e3b0c416c05114f2a51f12643805d5f3d0cd80d32272f2731a\u00a0\r\n\r\n7ec77e643d8d7cc18cc67c123feceed91d10db1cc9fa0c49164cba35bb1da987\u00a0\r\n\r\n860f165c2240f2a83eb30c412755e5a025e25961ce4633683f5bc22f6a24ddb6\u00a0\r\n\r\n868ed69533fac80354a101410d3dd0a66f444385c6611cc85c5b0be49db2d6fd\u00a0\r\n\r\n89759e56d5c23085e47d2be2ce4ad4484dfdd4204044a78671ed434cec19b693\u00a0\r\n\r\n8b7fb1cd5c09f7ec57ccc0c4261c0b4df0604962556a1d401b9cbfd750df60ba\u00a0\r\n\r\n8d6e31c95d649c08cdc2f82085298173d03c03afe02f0dacb66dd3560149184f\u00a0\r\n\r\n942d763604d0aefdff10ce095f806195f351124a8433c96f5590d89d809a562f\u00a0\r\n\r\n98a5f30699564e6d9f74e737a611246262907b9e91b90348f7de53eb4cf32665\u00a0\r\n\r\n9e6011d6380207e2bf5105cde3d48e412db565b92cdc1b3c6aa15bd7bd4b099f\u00a0\r\n\r\na106e0a6b7cc30b161e5ea0b1ec0f28ab89c2e1eb7ba2d5d409ddbabc3b037e6\u00a0\r\n\r\na2b905c26e2b92e63de85d83e280249258cb21f300d8c4a3a6bdb488676e9bcf\u00a0\r\n\r\na4a86e96f95f395fcf0ceb6a74a2564f4ba7adbe1b40cc702b054427327a0399\u00a0\r\n\r\na8192656dd1db0be4cec9d03b4d10e0529d9c52c899eda8d8e72698acfb61419\u00a0\r\n\r\na8f776bd3a9593e963b567ce790033fec2804ea0afb40a92d40e21d8f33d066f\u00a0\r\n\r\nb4966f8febdba6b2d674afffc65b1df11e7565acbd4517f1e5b9b36a8c6a16ed\u00a0\r\n\r\nbb25f1a73d095d57b2c8c9ac6780e4d412ddf3d9eef84a54903cc8e4eaefc335\u00a0\r\n\r\nbc82bce004afb6424e9d9f9fc04a84f58edf859c4029eda08f7309dbeec67696\u00a0\r\n\r\nc30198e0b0e470d4ac8821bd14bb754466e7974f1c20be8b300961e9e89ed1ea\u00a0\r\n\r\ncaabc45e59820a4349db13f337063eddede8a0847ae313d89a800f241d8556c8\u00a0\r\n\r\nd3ef6643ad529d43a7ec313b52c8396dc52c4daad688360eb207ee91a1caf7b2\u00a0\r\n\r\ne3c818052237bb4bb061290ab5e2a55c3852c8a3fef16436b1197e8b17de2e18\u00a0\r\n\r\ne56ffcf5df2afd6b151c24ddfe7cd450f9208f59b5731991b926af0dce24285a\u00a0\r\n\r\ne8704bf6525c90e0f5664f400c3bf8ff5da565080a52126e0e6a62869157dfe3\u00a0\r\n\r\ne8a454cd8b57a243f0abeec6945c9b10616cfdcc4abfb4c618bfc469d026d537\u00a0\r\n\r\neac776c3c83c9db1a770ffaf6df9e94611c8293cbd41cb9257148603b8f2be0b\u00a0\r\n\r\nead0f3e6f0ca16b283f09526d09e8e8cba687dab642f0e102e5487cb565bf475\u00a0\r\n\r\nf011a136996fa53fdbde944da0908da446b9532307a35c44ed08241b5e602cc9\u00a0\r\n\r\nf2a2f4fa2ed5b2a94720a4661937da97ab21aa198a5f8c83bb6895aa2c398d22\u00a0\r\n\r\nf62f21ee7e642f272b881827b45ceb643c999a742e1d3eac13d1ba014d1e7f67\u00a0\r\n\r\nf9f0973dc74716b75291f5a9b2d59b08500882563011d1def2b8d0b1b9bbb8ae\u00a0\r\nC2:\u00a0\r\n\u00a0theme[[.]]blogsite[.]org\u00a0\r\n\r\ncortana[.]homelinux[.]com\u00a0\r\n\r\nword[.]webhop[.]info\u00a0\r\n\r\nwork[.]windownoffice[.]com\u00a0\r\n\r\ncortanasyn[.]com\u00a0\r\n\r\ne[.]browsersyn[.]com\u00a0\r\n\r\nsyn[.]servebbs[.]com\u00a0\r\n\r\nservice[.]windown-update[.]com\u00a0\r\n\r\ncheck[.]homeip[.]net\u00a0\r\n\r\noutlook[.]updateoffices[.]net\u00a0\r\n\r\nmail[.]fptservice[.]net\u00a0\r\n\r\noffice[.]windown-update[.]com\u00a0\r\n\r\ncortanazone[.]com\u00a0\r\n\r\nbeta[.]officopedia[.]com\u00a0\r\n\r\nvideos[.]dyndns[.]org\u00a0\r\n\r\nservice[.]serveftp[.]org\u00a0\r\n\r\nsyn[.]browserstime[.]com\u00a0\r\n\r\ncheck[.]webhop[.]org\u00a0\r\n\r\nristineho[.]com\u00a0\r\n\u00a0Appendix A:\u00a0\r\nCobalt Strike Beacon contains the hard-coded configuration data in its body. JPCERT published an article about the structure of the configuration. The sample we obtained has the following configuration (Figure\u00a010) and connects to\u00a0the C2 server, https:\/\/\u00a0b.cortanazone[.]com.\u00a0\r\n\r\n\r\nFigure\u00a010:\u00a0Cobalt Strike Beacon configuration\u00a0\r\n\r\nAppendix B:\u00a0\r\nFigure\u00a011\u00a0shows some of the contents of the individual RAR files. All the .exe files are copies of Windows Word and the associated \u2018wwlib.dll\u2019 file is the malicious downloader DLL\u00a0KerrDown, which is sideloaded when the .exe file gets executed.\u00a0\r\n\r\n\r\nFigure\u00a011:\u00a0RAR archives with malicious DLL for sideloading","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Vicky Ray"},{"@type":"Person","name":"Kaoru Hayashi"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"96246","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=96246' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ftracking-oceanlotus-new-downloader-kerrdown%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ftracking-oceanlotus-new-downloader-kerrdown%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-96246 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Tracking OceanLotus’ new Downloader, KerrDown</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-96246 entry-meta">
			
			
			<span class="post-views-count">37,607</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'96246','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 7</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Ftracking-oceanlotus-new-downloader-kerrdown%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Ftracking-oceanlotus-new-downloader-kerrdown%2F+-+Tracking+OceanLotus%E2%80%99+new+Downloader%2C+KerrDown" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ftracking-oceanlotus-new-downloader-kerrdown%2F&title=Tracking+OceanLotus%E2%80%99+new+Downloader%2C+KerrDown&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/vicky-khan/" title="Posts by Vicky Ray" class="author url fn" rel="author">Vicky Ray</a> and <a href="https://unit42.paloaltonetworks.com/author/khayashi/" title="Posts by Kaoru Hayashi" class="author url fn" rel="author">Kaoru Hayashi</a>        </p>
        <p><time datetime="2019-02-01T14:00:44+00:00">February 1, 2019 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/kerrdown/" rel="tag">KerrDown</a>, <a href="https://unit42.paloaltonetworks.com/tag/oceanlotus/" rel="tag">OceanLotus</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/tracking-oceanlotus-new-downloader-kerrdown/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>OceanLotus (AKA APT32) is a threat actor group known to be one of the most sophisticated threat actors originating out of south east Asia. <a href="http://blogs.360.cn/post/oceanlotus-apt.html" target="_blank" rel="noopener">Multiple attack campaigns</a> have been <a href="https://www.welivesecurity.com/2018/11/20/oceanlotus-new-watering-hole-attack-southeast-asia/" target="_blank" rel="noopener">reported</a> by number of security organizations in the last couple of years, <a href="https://www.cybereason.com/blog/operation-cobalt-kitty-apt" target="_blank" rel="noopener">documenting</a> the tools and tactics used by the threat actor. While OceanLotus’ targets are global, their operations are mostly active within the APAC region which encompasses targeting private sectors across multiple industries, foreign governments, activists, and dissidents connected to Vietnam.<span data-ccp-props="{}"> </span></p>
<p>This blog will cover a new custom downloader malware family we’ve named “KerrDown” which OceanLotus have been actively using since at least early 2018. We also show how the <a href="https://en.wikipedia.org/wiki/Jaccard_index" target="_blank" rel="noopener">jaccard-index</a> algorithm was used to quickly find similarities between the new KerrDown malware family within our datasets. This method has proven to be very useful to extract similarities from large sample datasets and connecting attack campaigns together. Given the large number of “KerrDown” samples found, we were also able to discern possible patterns in OceanLotus’ working hours and days of a week which is discussed in the later sections of this blog.<span data-ccp-props="{}"> </span></p>
<p>We identified two methods to deliver the KerrDown downloader to targets. One is using the Microsoft Office Document with a malicious macro and the other is RAR archive which contains a legitimate program with <a href="https://attack.mitre.org/techniques/T1073/" target="_blank" rel="noopener">DLL side-loading</a>. For RAR archive files, the file names used to trick targets are all in Vietnamese as shown in Figure 11. Our analysis shows that the primary targets of the ongoing campaign discussed in this blog are either in Vietnam or Vietnamese speaking individuals. <span data-ccp-props="{}"> </span></p>
<h3>Malicious Document</h3>
<p>Our analysis began with an active mime document, something we&#8217;ve seen OceanLotus use before but this time involving a new payload, KerrDown. The lure hash is<span data-ccp-props="{}"> </span></p>
<p>(SHA256:89e19df797481ae2d2c895bcf030fe19e581976d2aef90c89bd6b3408579bfc3)<span data-ccp-props="{}"> </span></p>
<p>Figure 1 below shows a snapshot of the lure file. Once the victim opens the lure document, which includes an image file with a message in Vietnamese which that asks the victim to enable macros to view the contents of the file. At first glance the document may look like there is no other content other than the notification to enable macros. However, a closer look reveals two different base64 blobs inserted in the page in separate tables and the font size has been changed to 1 which may deceive victims to overlook the content. Another reason for this technique may be that many automated tools are able to detect the presence of an embedded binary within the streams of such files and this technique may allow them to go undetected. <span data-ccp-props="{}"> </span></p>
<h2>Delivery Document Analysis</h2>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document.png" rel="wpdevart_lightbox"><img class="size-full wp-image-96252 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document.png" alt="" width="1093" height="711" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document.png 1093w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document-900x585.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document-300x195.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document-768x500.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document-1024x666.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document-370x241.png 370w" sizes="(max-width: 1093px) 100vw, 1093px" /></a></p>
<p style="text-align: center;"><span data-ccp-props="{}"> </span><span data-ccp-props="{}"> </span><i>Figure </i><i>1:</i><i> Lure document</i></p>
<p>Once we increase the font size, the base64 blobs are visible in two different tables. Once decoded you can see the MZ header of the PE DLL at the beginning of each table, as shown in Figure 2.  <span data-ccp-props="{}"> </span></p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-2-Base64-encoded-pedll-files-embedded-as-text-in-the-document..png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96253" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-2-Base64-encoded-pedll-files-embedded-as-text-in-the-document..png" alt="" width="784" height="545" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-2-Base64-encoded-pedll-files-embedded-as-text-in-the-document..png 784w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-2-Base64-encoded-pedll-files-embedded-as-text-in-the-document.-300x209.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-2-Base64-encoded-pedll-files-embedded-as-text-in-the-document.-768x534.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-2-Base64-encoded-pedll-files-embedded-as-text-in-the-document.-370x257.png 370w" sizes="(max-width: 784px) 100vw, 784px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>2</i><i>: </i><i>Base64</i><i> encoded </i><i>pedll</i><i> files</i><i> embedded as text in the document.</i><span data-ccp-props="{&quot;335559685&quot;:1440,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<p>Figure 3 shows a code excerpt from the embedded macro that checks which base64 blob should be decoded based on the iCheck variable, a Boolean value which is set to true if the victim system is running on a 64-bit system and false on a 32-bit system. If the system is found to be 64-bit, the base64 encoded blob on the left is decoded otherwise the base64 encoded blob on the right is decoded.<span data-ccp-props="{}"> </span></p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-3-Base64-blob-selection-based-on-system-check.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96254" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-3-Base64-blob-selection-based-on-system-check.png" alt="" width="567" height="275" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-3-Base64-blob-selection-based-on-system-check.png 567w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-3-Base64-blob-selection-based-on-system-check-380x184.png 380w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-3-Base64-blob-selection-based-on-system-check-300x146.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-3-Base64-blob-selection-based-on-system-check-370x179.png 370w" sizes="(max-width: 567px) 100vw, 567px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>3</i><i>: </i><i>Base64</i><i> blob selection based on system check</i><span data-ccp-props="{&quot;335559685&quot;:1440,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<p>We also noticed that the actors reused the VBS decode function published by <a href="https://www.motobit.com/tips/detpg_Base64/" target="_blank" rel="noopener">Motobit</a>. Figure 4 shows the comparison between the base64 function used in the macro code and the VBS base64 decoder function published by Motobit.<span data-ccp-props="{}"> </span></p>
<p><span data-ccp-props="{}"> <a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96255" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison.png" alt="" width="1332" height="812" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison.png 1332w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison-900x549.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison-300x183.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison-768x468.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison-1024x624.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-4-Base64-decoder-comparison-370x226.png 370w" sizes="(max-width: 1332px) 100vw, 1332px" /></a></span></p>
<p style="text-align: center;"><i>Figure </i><i>4</i><i>: </i><i>Base64</i><i> decoder comparison</i><span data-ccp-props="{&quot;335559685&quot;:2880,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<h2>Similarity Analysis of KerrDown Samples using Jaccard-Index<span data-ccp-props="{&quot;335559738&quot;:40}"> </span></h2>
<p>Once we decoded and extracted both DLL files from the document we used a similarity analysis algorithm using the <a href="https://en.wikipedia.org/wiki/Jaccard_index" target="_blank" rel="noopener">Jaccard index</a> to check the binaries against known set of malware families used by OceanLotus  which yielded no matches with any previous OceanLotus malware families. However, we were able to find multiple other samples in our datasets using the imphash value of the KerrDown samples and the accompanying C2 domains. Given the high number of samples found, we again used a similarity analysis algorithm using <a href="https://en.wikipedia.org/wiki/Jaccard_index" target="_blank" rel="noopener">Jaccard Index</a> to extract similarities between all the samples found. At this stage we were not sure if the DLL files were a backdoor or had any other functionality. Hence, we included a few other known OceanLotus malware family samples used no earlier than 2017 to our similarity test, and in most cases samples which were final payloads dropped in victim machines.  One of the main objectives was to quickly discern if KerrDown could have been variants of the known malware families we have been tracking or was OceanLotus employing a new malware family in their playbooks and in the recent campaigns. Plotting the Jaccard index results using <a href="https://pypi.org/project/networkx/" target="_blank" rel="noopener">networkx</a> we can quickly visualize the similarities extracted. As you can see from Figure 5, there is a thick cluster of samples at the top right of the networkx graph which did not have any similarities with the other known OceanLotus malware family samples. Therefore, this observation was helpful for us to understand that the samples we were looking into were likely a new malware family being employed by the OceanLotus group at the time of analysis, which we have now named KerrDown.</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96256" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index.png" alt="" width="1169" height="1054" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index.png 1169w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index-900x811.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index-300x270.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index-768x692.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index-1024x923.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-5-Similarity-analysis-using-Jaccard-Index-370x334.png 370w" sizes="(max-width: 1169px) 100vw, 1169px" /></a><i>Figure </i><i>5</i><i>: Similarity analysis using Jacc</i><i>a</i><i>rd Index</i><span data-ccp-props="{&quot;335559685&quot;:2160,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<h2 style="text-align: left;">KerrDown to Cobalt Strike Beacon<span data-ccp-props="{&quot;335559738&quot;:40}"> </span></h2>
<p>As discussed in the delivery document analysis above, depending on the OS architecture either of the embedded KerrDown DLLs will be dropped in the victim machine. The DLL is dropped in the directory location ‘Users\Administrator\AppData\Roaming\’ as ‘main_background.png’. The DLL retrieves the payload from the URL, decrypts it by using DES algorithm and execute it in the memory. Therefore, it is observed that only the KerrDown DLL downloader is saved in the system and the payload directly gets executed in the memory without being written in the system. Table 1 shows the URL the downloader will attempt to download the payload from depending on the OS architecture of the victim machine.<span data-ccp-props="{}"> </span></p>
<table class=" aligncenter" data-tablestyle="Custom" data-tablelook="0">
<tbody>
<tr>
<td style="width: 188.8px;" data-celllook="4369"><b>OS </b><b>A</b><b>rchitecture</b><span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
<td style="width: 276.8px;" data-celllook="273"><b>URL</b><span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
<td style="width: 387.2px;" data-celllook="273"><b>User Agent</b><span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
</tr>
<tr>
<td style="width: 188.8px;" data-celllook="4368">32 bit<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
<td style="width: 276.8px;" data-celllook="272">https://syn.servebbs[.]com/kuss32.gif<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
<td style="width: 387.2px;" data-celllook="272">Mozilla/5.0 (Windows NT 10.0; Win32; x32; rv:60.0)<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
</tr>
<tr>
<td style="width: 188.8px;" data-celllook="4368">64 bit<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
<td style="width: 276.8px;" data-celllook="272">https://syn.servebbs[.]com/kuss64.gif<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
<td style="width: 387.2px;" data-celllook="272">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0)<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><i>Table </i><i>1</i><i> : </i><i>Payload </i><i>DLL </i><i>selection based on architecture</i><span data-ccp-props="{&quot;335559685&quot;:1440,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<p>The link to the final payload of KerrDown was still active during the time of analysis and hence we were able to download a copy which turned out to be a variant of Cobalt Strike Beacon. Cybereason also <a href="https://www.cybereason.com/blog/operation-cobalt-kitty-apt" target="_blank" rel="noopener">published</a> previously on OceanLotus using Cobalt Strike in their campaigns and it is interesting to see the use of a new downloader malware family being used to still deliver the final payload of Cobalt Strike. As we can see in this case, the purpose of the malware is to download and execute the Cobalt Strike Beacon payload in memory. Though Cobalt Strike is a commercial penetration testing tool, <a href="https://unit42.paloaltonetworks.com/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/" target="_blank" rel="noopener">various threat actors</a> are known to have used it in their campaigns. <span data-ccp-props="{&quot;335559739&quot;:120}"> </span></p>
<h2 aria-level="1">RAR Archives with KerrDown<span data-ccp-props="{&quot;335559738&quot;:240}"> </span></h2>
<p>While investigating KerrDown we found multiple RAR files containing a variant of the malware. We haven’t yet identified the delivery method or targets of this variant. The attacker changed the downloader code by adding more stages and hiding each stage by compression and encryption. They also changed the way to execute the malicious code from an Office macro to the DLL side-loading technique through a legitimate program. <span data-ccp-props="{&quot;335559739&quot;:120}"> </span></p>
<p>The RAR archive</p>
<p>(SHA256:040abac56542a2e0f384adf37c8f95b2b6e6ce3a0ff969e3c1d572e6b4053ff3)</p>
<p>has the Vietnamese file name ‘Don khieu nai.rar’ which translates to &#8216;Complaint letter&#8217; in English. The archive contains a legitimate older version of Microsoft Word (Microsoft Word 2007) executable file that is named ‘Noi dung chi tiet don khieu nai gui cong ty.exe’ which translates to ‘Learn more about how to use your company’ in English. The attacker used the DLL side loading technique to load a malicious DLL by the older version of Microsoft Word. When opening the executable file in the archive, it loads the malicious DLL in the same directory. The DLL executes multi-stage shellcodes and each shellcode employs various technique to hide the next stage. The overall installation steps are below:<span data-ccp-props="{&quot;335559739&quot;:120}"> </span></p>
<ol>
<li data-leveltext="%1." data-font="" data-listid="1" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1">The Microsoft Word exe loads wwlib.dll in the same directory and executes ‘FMain’ function of the DLL.</li>
<li data-leveltext="%1." data-font="" data-listid="1" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1">The DLL decodes base64 encoded shellcode in the body and executes it.<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></li>
<li data-leveltext="%1." data-font="" data-listid="1" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1">The shellcode decompresses the second shellcode which is compressed with <a href="http://www.oberhumer.com/opensource/ucl/" target="_blank" rel="noopener">the open source compression code UCL</a> and execute it.<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></li>
<li data-leveltext="%1." data-font="" data-listid="1" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1">The second shellcode decrypts the third shellcode with AES.<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></li>
<li data-leveltext="%1." data-font="" data-listid="1" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1">The third shellcode retrieves the shellcode from the following remote location and executes it: https://cortanasyn[.]com/Avcv<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></li>
<li data-leveltext="%1." data-font="" data-listid="1" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1">The fourth shellcode loads the embedded Cobalt Strike Beacon DLL in memory and executes it.<span data-ccp-props="{&quot;335559738&quot;:36,&quot;335559739&quot;:36}"> </span></li>
</ol>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-6-Execution-flow-of-sideloaded-malicious-downloader.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96257" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-6-Execution-flow-of-sideloaded-malicious-downloader.png" alt="" width="647" height="604" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-6-Execution-flow-of-sideloaded-malicious-downloader.png 647w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-6-Execution-flow-of-sideloaded-malicious-downloader-300x280.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-6-Execution-flow-of-sideloaded-malicious-downloader-370x345.png 370w" sizes="(max-width: 647px) 100vw, 647px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>6</i><i>: </i><i>Execution flow of sideloaded malicious downloader</i><span data-ccp-props="{&quot;335559685&quot;:1440,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<p>Looking at the compile timestamps of all the KerrDown samples in our datasets we were able to discern a couple of observations:<span data-ccp-props="{}"> </span></p>
<ul>
<li>OceanLotus has been using the new downloader in their campaigns since at least March 2018 and continues to actively use it in their campaigns. Figure 7 shows the timeline of the KerrDown samples:<span data-ccp-props="{&quot;134233279&quot;:true}"> </span></li>
</ul>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96258" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines.png" alt="" width="1418" height="851" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines.png 1418w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines-900x540.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines-300x180.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines-768x461.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines-1024x615.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-7-Downloader-DLL-compile-time-lines-370x222.png 370w" sizes="(max-width: 1418px) 100vw, 1418px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>7</i><i>: </i><i>Downloader DLL compile time lines</i><span data-ccp-props="{&quot;335559685&quot;:2160,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<ul>
<li>While it is already widely believed that the <a href="https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/" target="_blank" rel="noopener">OceanLotus group may originate from Vietnam</a>, we wanted to find possible working hour patterns from the samples in our datasets. We plotted the compile times based on GMT +7 and found a clear pattern of the possible working hours of the group. The OceanLotus group has a typical 9 AM to 6 PM working pattern with most samples compiled during this period of the day. Figure 8 shows the malware compilation timestamps in GMT +7 for each unique sample found in our dataset.<span data-ccp-props="{&quot;134233279&quot;:true}"> </span></li>
</ul>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96259" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7.png" alt="" width="1376" height="826" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7.png 1376w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7-900x540.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7-300x180.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7-768x461.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7-1024x615.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-8-Malware-compilation-times-in-GMT-7-370x222.png 370w" sizes="(max-width: 1376px) 100vw, 1376px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>8</i><i>: </i><i>Malware compilation times in GMT +7</i><span data-ccp-props="{&quot;335559685&quot;:2160,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<ul>
<li><span data-ccp-props="{}"> </span>We also observed all the samples were compiled during the weekdays &#8211; between Monday to Friday. Therefore, it is clear that the OceanLotus group works during weekdays and takes a break during the weekends. Figure 9 shows the samples compiled during the week.<span data-ccp-props="{&quot;134233279&quot;:true}"> </span></li>
</ul>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96260" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays.png" alt="" width="1063" height="638" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays.png 1063w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays-900x540.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays-300x180.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays-768x461.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays-1024x615.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-9-Malware-compilation-during-weekdays-370x222.png 370w" sizes="(max-width: 1063px) 100vw, 1063px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>9</i><i>: </i><i>Malware compilation during weekdays</i><span data-ccp-props="{&quot;335559685&quot;:2160,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<h2 style="text-align: left;">Conclusion<span data-ccp-props="{&quot;335559738&quot;:240}"> </span></h2>
<p>OceanLotus has been an active threat actor group for a number of years and remains one of the most sophisticated threat actors in the APAC region. As we have seen with the new KerrDown downloader being used in their recent campaigns, the group continues to build and employ new tools and techniques in their overall operations and playbooks. It is therefore imperative to understand and keep a track of the group’s ongoing operations and capability to better defend against such threats. Given the high number of samples observed, we were also able to discern possible working hour patterns which shows us that the group likely has formal working hours and operating out of a region which is like Vietnam or nearby countries. While most of the targeting observed is towards Vietnamese speaking victims, given the known broader geographic and industry wide target base of OceanLotus, the group may use similar tools and playbooks against other targets. <span data-ccp-props="{}"> </span></p>
<p><span data-ccp-props="{}"> </span>Palo Alto Networks customers are already protected via:<span data-ccp-props="{}"> </span></p>
<ul>
<li><span data-ccp-props="{}"> </span>All samples in this report have a malicious verdict in WildFire<span data-ccp-props="{&quot;134233279&quot;:true}"> </span></li>
<li data-leveltext="" data-font="Symbol" data-listid="7" aria-setsize="-1" data-aria-posinset="2" data-aria-level="1">Domains have been classified as malicious<span data-ccp-props="{&quot;134233279&quot;:true}"> </span></li>
<li data-leveltext="" data-font="Symbol" data-listid="7" aria-setsize="-1" data-aria-posinset="3" data-aria-level="1">AutoFocus tags are available for additional context: <a href="https://autofocus.paloaltonetworks.com/">OceanLotus</a> and <a href="https://autofocus.paloaltonetworks.com/">KerrDown</a>.<span data-ccp-props="{&quot;134233279&quot;:true}"> </span></li>
</ul>
<h2><a id="IOC"></a>Indicators of Compromise:<span data-ccp-props="{&quot;335559738&quot;:240}"> </span></h2>
<h3>Lure Docs:<span data-ccp-props="{}"> </span></h3>
<p><span data-ccp-props="{}"> </span>73dcbcc47d6bd95dcf031ebbd34ac42301a20ee1143ac130b405e79b4ba40fc8<span data-ccp-props="{}"> </span></p>
<p>89e19df797481ae2d2c895bcf030fe19e581976d2aef90c89bd6b3408579bfc3<span data-ccp-props="{}"> </span></p>
<p>a4a066341b4172d2cb752de4b938bf678ceb627ecb72594730b78bd05a2fad9d<span data-ccp-props="{}"> </span></p>
<p>8bf22202e4fd4c005afde2266413cba9d1b749b1a2d75deac0c35728b5eb3af8<span data-ccp-props="{}"> </span></p>
<p>df8210d20c5eb80d44ba8fa4c41c26c8421dcb20168e4f796e4955e01ebc9e13<span data-ccp-props="{}"> </span></p>
<p>94fab926b73a6a5bc71d655c8d611b40e80464da9f1134bfce7b930e23e273ab<span data-ccp-props="{}"> </span></p>
<p>4321a9f95901a77b4acfbaef3596cf681712345e1cbd764873c6643fe9da7331<span data-ccp-props="{}"> </span></p>
<h3>KerrDown DLLs:<span data-ccp-props="{}"> </span></h3>
<p><span data-ccp-props="{}"> </span>4a0309d8043e8acd7cb5c7cfca95223afe9c15a1c34578643b49ded4b786506b<span data-ccp-props="{}"> </span></p>
<p>4b431af677041dae3c988fcc901ac8ec6e74c6e1467787bf099c4abd658be5be<span data-ccp-props="{}"> </span></p>
<p>4bc00f7d638e042da764e8648c03c0db46700599dd4f08d117e3e9e8b538519b<span data-ccp-props="{}"> </span></p>
<p>4e2f8f104e6cd07508c5b7d49737a1db5eeba910adfdb4c19442a7699dc78cfc<span data-ccp-props="{}"> </span></p>
<p>4e791f2511c9bd3c63c8e37aa6625d8b590054de9e1cca13a7be2630bc2af9ce<span data-ccp-props="{}"> </span></p>
<p>539e8a53db3f858914cfe0d2132f11de34a691391ba71673a8b1e61367a963c7<span data-ccp-props="{}"> </span></p>
<p>53cd92f37ffd0822cc644717363ba239d75c6d9af0fa305339eaf34077edd22d<span data-ccp-props="{}"> </span></p>
<p>53efaac9244c24fab58216a907783748d48cb32dbdc2f1f6fb672bd49f12be4c<span data-ccp-props="{}"> </span></p>
<p>5c18c3e6f7ac0d0ac2b5fa9a6435ee90d6bd77995f85bed9e948097891d42ca2<span data-ccp-props="{}"> </span></p>
<p>5cda7d8294a8804d09108359dd2d96cdf4fdcf22ec9c00f0182d005afff76743<span data-ccp-props="{}"> </span></p>
<p>5f0db8216314da1f128b883b918e5ac722202a2ae0c4d0bf1c5da5914a66778e<span data-ccp-props="{}"> </span></p>
<p>6010d44cdca58cdec4559040e08798e7b28b9434bda940da0a670c93c84e33cd<span data-ccp-props="{}"> </span></p>
<p>60b65ebb921dca4762aef427181775d10bbffc30617d777102762ab7913a5aa1<span data-ccp-props="{}"> </span></p>
<p>6146aedfe47597606fb4b05458ec4b99d4e1042da7dc974fa33a57e282cd7349<span data-ccp-props="{}"> </span></p>
<p>6245b74b1cc830ed95cb630192c704da66600b90a331d9e6db70210acb6c7dfa<span data-ccp-props="{}"> </span></p>
<p>67cd191eb2322bf8b0f04a63a9e7cb7bc52fb4a4444fcb8fed2963884aede3aa<span data-ccp-props="{}"> </span></p>
<p>68f77119eae5e9d2404376f2d87e71e4ab554c026e362c57313e5881005ae79e<span data-ccp-props="{}"> </span></p>
<p>69e679daaaff3832c39671bf2b813b5530a70fb763d381f9a6e22e3bc493c8a9<span data-ccp-props="{}"> </span></p>
<p>6faa7deb1e1e0c3a7c62c2bb0ecdfa56b6e3ba4fe16971ec4572267ac70b9177<span data-ccp-props="{}"> </span></p>
<p>6fb397e90f72783adec279434fe805c732ddb7d1d6aa72f19e91a1bf585e1ea5<span data-ccp-props="{}"> </span></p>
<p>70db041fb5aadb63c1b8ae57ba2699baa0086e9b011219dcebcccbf632017992<span data-ccp-props="{}"> </span></p>
<p>7673f5468ba3cf01500f6bb6a19ce7208c8b6fc24f1a3a388eca491bc25cd9cd<span data-ccp-props="{}"> </span></p>
<p>77805a46f73e118ae2428f8c22ba28f79f7c60aeb6305d41c0bf3ebb9ce70f94<span data-ccp-props="{}"> </span></p>
<p>788265447391189ffc1956ebfec990dc051b56f506402d43cd1d4de96709c082<span data-ccp-props="{}"> </span></p>
<p>7be613237b57fbc3cb83d001efadeed9936a2f519c514ab80de8285bdc5a666c<span data-ccp-props="{}"> </span></p>
<p>7dbb7fab4782f5e3b0c416c05114f2a51f12643805d5f3d0cd80d32272f2731a<span data-ccp-props="{}"> </span></p>
<p>7ec77e643d8d7cc18cc67c123feceed91d10db1cc9fa0c49164cba35bb1da987<span data-ccp-props="{}"> </span></p>
<p>860f165c2240f2a83eb30c412755e5a025e25961ce4633683f5bc22f6a24ddb6<span data-ccp-props="{}"> </span></p>
<p>868ed69533fac80354a101410d3dd0a66f444385c6611cc85c5b0be49db2d6fd<span data-ccp-props="{}"> </span></p>
<p>89759e56d5c23085e47d2be2ce4ad4484dfdd4204044a78671ed434cec19b693<span data-ccp-props="{}"> </span></p>
<p>8b7fb1cd5c09f7ec57ccc0c4261c0b4df0604962556a1d401b9cbfd750df60ba<span data-ccp-props="{}"> </span></p>
<p>8d6e31c95d649c08cdc2f82085298173d03c03afe02f0dacb66dd3560149184f<span data-ccp-props="{}"> </span></p>
<p>942d763604d0aefdff10ce095f806195f351124a8433c96f5590d89d809a562f<span data-ccp-props="{}"> </span></p>
<p>98a5f30699564e6d9f74e737a611246262907b9e91b90348f7de53eb4cf32665<span data-ccp-props="{}"> </span></p>
<p>9e6011d6380207e2bf5105cde3d48e412db565b92cdc1b3c6aa15bd7bd4b099f<span data-ccp-props="{}"> </span></p>
<p>a106e0a6b7cc30b161e5ea0b1ec0f28ab89c2e1eb7ba2d5d409ddbabc3b037e6<span data-ccp-props="{}"> </span></p>
<p>a2b905c26e2b92e63de85d83e280249258cb21f300d8c4a3a6bdb488676e9bcf<span data-ccp-props="{}"> </span></p>
<p>a4a86e96f95f395fcf0ceb6a74a2564f4ba7adbe1b40cc702b054427327a0399<span data-ccp-props="{}"> </span></p>
<p>a8192656dd1db0be4cec9d03b4d10e0529d9c52c899eda8d8e72698acfb61419<span data-ccp-props="{}"> </span></p>
<p>a8f776bd3a9593e963b567ce790033fec2804ea0afb40a92d40e21d8f33d066f<span data-ccp-props="{}"> </span></p>
<p>b4966f8febdba6b2d674afffc65b1df11e7565acbd4517f1e5b9b36a8c6a16ed<span data-ccp-props="{}"> </span></p>
<p>bb25f1a73d095d57b2c8c9ac6780e4d412ddf3d9eef84a54903cc8e4eaefc335<span data-ccp-props="{}"> </span></p>
<p>bc82bce004afb6424e9d9f9fc04a84f58edf859c4029eda08f7309dbeec67696<span data-ccp-props="{}"> </span></p>
<p>c30198e0b0e470d4ac8821bd14bb754466e7974f1c20be8b300961e9e89ed1ea<span data-ccp-props="{}"> </span></p>
<p>caabc45e59820a4349db13f337063eddede8a0847ae313d89a800f241d8556c8<span data-ccp-props="{}"> </span></p>
<p>d3ef6643ad529d43a7ec313b52c8396dc52c4daad688360eb207ee91a1caf7b2<span data-ccp-props="{}"> </span></p>
<p>e3c818052237bb4bb061290ab5e2a55c3852c8a3fef16436b1197e8b17de2e18<span data-ccp-props="{}"> </span></p>
<p>e56ffcf5df2afd6b151c24ddfe7cd450f9208f59b5731991b926af0dce24285a<span data-ccp-props="{}"> </span></p>
<p>e8704bf6525c90e0f5664f400c3bf8ff5da565080a52126e0e6a62869157dfe3<span data-ccp-props="{}"> </span></p>
<p>e8a454cd8b57a243f0abeec6945c9b10616cfdcc4abfb4c618bfc469d026d537<span data-ccp-props="{}"> </span></p>
<p>eac776c3c83c9db1a770ffaf6df9e94611c8293cbd41cb9257148603b8f2be0b<span data-ccp-props="{}"> </span></p>
<p>ead0f3e6f0ca16b283f09526d09e8e8cba687dab642f0e102e5487cb565bf475<span data-ccp-props="{}"> </span></p>
<p>f011a136996fa53fdbde944da0908da446b9532307a35c44ed08241b5e602cc9<span data-ccp-props="{}"> </span></p>
<p>f2a2f4fa2ed5b2a94720a4661937da97ab21aa198a5f8c83bb6895aa2c398d22<span data-ccp-props="{}"> </span></p>
<p>f62f21ee7e642f272b881827b45ceb643c999a742e1d3eac13d1ba014d1e7f67<span data-ccp-props="{}"> </span></p>
<p>f9f0973dc74716b75291f5a9b2d59b08500882563011d1def2b8d0b1b9bbb8ae<span data-ccp-props="{}"> </span></p>
<h3>C2:<span data-ccp-props="{}"> </span></h3>
<p><span data-ccp-props="{}"> </span>theme[[.]]blogsite[.]org<span data-ccp-props="{}"> </span></p>
<p>cortana[.]homelinux[.]com<span data-ccp-props="{}"> </span></p>
<p>word[.]webhop[.]info<span data-ccp-props="{}"> </span></p>
<p>work[.]windownoffice[.]com<span data-ccp-props="{}"> </span></p>
<p>cortanasyn[.]com<span data-ccp-props="{}"> </span></p>
<p>e[.]browsersyn[.]com<span data-ccp-props="{}"> </span></p>
<p>syn[.]servebbs[.]com<span data-ccp-props="{}"> </span></p>
<p>service[.]windown-update[.]com<span data-ccp-props="{}"> </span></p>
<p>check[.]homeip[.]net<span data-ccp-props="{}"> </span></p>
<p>outlook[.]updateoffices[.]net<span data-ccp-props="{}"> </span></p>
<p>mail[.]fptservice[.]net<span data-ccp-props="{}"> </span></p>
<p>office[.]windown-update[.]com<span data-ccp-props="{}"> </span></p>
<p>cortanazone[.]com<span data-ccp-props="{}"> </span></p>
<p>beta[.]officopedia[.]com<span data-ccp-props="{}"> </span></p>
<p>videos[.]dyndns[.]org<span data-ccp-props="{}"> </span></p>
<p>service[.]serveftp[.]org<span data-ccp-props="{}"> </span></p>
<p>syn[.]browserstime[.]com<span data-ccp-props="{}"> </span></p>
<p>check[.]webhop[.]org<span data-ccp-props="{}"> </span></p>
<p>ristineho[.]com<span data-ccp-props="{}"> </span></p>
<h2><span data-ccp-props="{}"> </span>Appendix A:<span data-ccp-props="{}"> </span></h2>
<p>Cobalt Strike Beacon contains the hard-coded configuration data in its body. JPCERT published an article about the structure of the configuration. The sample we obtained has the following configuration (Figure 10) and connects to the C2 server, https:// b.cortanazone[.]com.<span data-ccp-props="{&quot;335559739&quot;:120}"> </span></p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-10-Cobalt-Strike-Beacon-configuration.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96261" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-10-Cobalt-Strike-Beacon-configuration.png" alt="" width="820" height="721" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-10-Cobalt-Strike-Beacon-configuration.png 820w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-10-Cobalt-Strike-Beacon-configuration-300x264.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-10-Cobalt-Strike-Beacon-configuration-768x675.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-10-Cobalt-Strike-Beacon-configuration-370x325.png 370w" sizes="(max-width: 820px) 100vw, 820px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>10</i><i>: </i><i>Cobalt Strike Beacon configuration</i><span data-ccp-props="{&quot;335559685&quot;:2160,&quot;335559731&quot;:720,&quot;335559739&quot;:200}"> </span></p>
<h2 style="text-align: left;">Appendix B:<span data-ccp-props="{}"> </span></h2>
<p>Figure 11 shows some of the contents of the individual RAR files. All the .exe files are copies of Windows Word and the associated ‘wwlib.dll’ file is the malicious downloader DLL KerrDown, which is sideloaded when the .exe file gets executed.<span data-ccp-props="{}"> </span></p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96262" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading.png" alt="" width="980" height="1221" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading.png 980w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading-900x1121.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading-241x300.png 241w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading-768x957.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading-822x1024.png 822w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-11-RAR-archives-with-malicious-DLL-for-sideloading-370x461.png 370w" sizes="(max-width: 980px) 100vw, 980px" /></a></p>
<p style="text-align: center;"><i>Figure </i><i>11</i><i>: </i><i>RAR archives with malicious DLL for sideloading</i></p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
