
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Understanding Flash Exploitation and the Alleged CVE-2015-0359 Exploit</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Understanding Flash exploitation and the alleged CVE-2015-0359 exploit."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Understanding Flash Exploitation and the Alleged CVE-2015-0359 Exploit" />
<meta property="og:description" content="Understanding Flash exploitation and the alleged CVE-2015-0359 exploit." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Adobe Flash Player" />
<meta property="article:tag" content="Advanced Endpoint Protection" />
<meta property="article:tag" content="Angler Exploit" />
<meta property="article:tag" content="ByteArray" />
<meta property="article:tag" content="ByteArrayObject" />
<meta property="article:tag" content="Flash" />
<meta property="article:tag" content="Traps" />
<meta property="article:section" content="Endpoint" />
<meta property="article:published_time" content="2015-06-01T20:20:15+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_1-500x178.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Understanding Flash exploitation and the alleged CVE-2015-0359 exploit." />
<meta name="twitter:title" content="Understanding Flash Exploitation and the Alleged CVE-2015-0359 Exploit" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_1-500x178.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Understanding Flash Exploitation and the Alleged CVE-2015-0359 Exploit Comments Feed" href="https://unit42.paloaltonetworks.com/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="15"/>
<meta property="og:views" content="15,455"/>
<meta property="og:date_created" content="June 1, 2015 at 1:20 PM"/>
<meta property="og:post_length" content="3430"/>
<meta property="og:category" content="Endpoint"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/endpoint-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Palo Alto Networks"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/palo-alto-networks-staff/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Understanding Flash Exploitation and the Alleged CVE-2015-0359 Exploit","name":"Understanding Flash Exploitation and the Alleged CVE-2015-0359 Exploit","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)What follows is a\u00a0detailed analysis of the root cause of a vulnerability we call CVE-2015-X, as well as a step-by-step explanation of how to trigger it. For more on Flash vulnerabilities, we also invite you to read &#8220;The Latest UAF Vulnerabilities in Exploit Kits,&#8221; published May 28 by...","url":"https:\/\/unit42.paloaltonetworks.com\/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit\/","datePublished":"June 1, 2015","articleBody":"What follows is a\u00a0detailed analysis of the root cause of a vulnerability we call CVE-2015-X, as well as a step-by-step explanation of how to trigger it. For more on Flash vulnerabilities, we also invite you to read \"The Latest UAF Vulnerabilities in Exploit Kits,\" published May 28 by Tao Yan.\u00a0\n\nNot too long ago we came across a sample from the Angler Exploit kit (MD5: 049ff69bc23f36a78d86bbf1356c2f63c), which allegedly exploits CVE-2015-0359. The obfuscated SWF contains an encoded SWF (MD5: d45808cfa6f3cbfb343fdea269fdc375), which is later decoded and loaded into Flash, without getting saved on disk. Here\u2019s a somewhat beautified example of this process:\n\n\n\nThe embedded SWF is heavily obfuscated, but the code has much in common with the source code for Angler EK\u2019s CVE-2015-0313 exploit.\n\nThe first thing to do is determine whether the exploit is indeed for CVE-2015-0359. Some researchers think that it\u2019s not. The embedded SWF contains a function we named CheckEnvironment, which eventually does this:\n\n\n\nWe note that playerVerOk is true if the Flash player\u2019s version is at least 13.0.0.250, but older than 13.0.0.269, or if the player\u2019s version is at least 15.0.0.189, but older than 16.0.0.305. However, the function returns true for any of the aforementioned versions, plus versions 13.0.0.277 and 17.0.0.134.\n\nWe can see that if none of those versions is present, no exploitation occurs:\n\n\n\nWhat\u2019s more interesting, though, is that the exact exploit (vulnerability triggering) is chosen based on the version of Flash, like so:\n\n\n\nFor Flash versions 13.0.0.250 and above, but older than 13.0.0.269, and for Flash versions 15.0.0.189 and above, but older than 16.0.0.305, CVE-2015-0313 is used. The description of CVE-2015-0313 states the following:\n\n\u201cUse-after-free vulnerability in Adobe Flash Player before 13.0.0.269 and 14.x through 16.x before 16.0.0.305 on Windows \u2026\u201d\n\nIf the Flash version is 13.0.0.277 or 17.0.0.134, a different exploit (trigger) is used. This is the only line where the exploitation paths differ from each other, so if it had indeed been CVE-2015-0359, we would expect its description to look like the one for CVE-2015-0313. However, this is the description that appears instead:\n\n\u201cDouble free vulnerability in Adobe Flash Player before 13.0.0.281 and 14.x through 17.x before 17.0.0.169 on Windows \u2026\u201d\n\nWe can say with confidence that this not CVE-2015-0359. This is probably a use-after-free (UAF) vulnerability, and not a double-free vulnerability (see the Technical Analysis section for actual proof). We therefore call this vulnerability CVE-2015-X.\n\nThis is the timeline of events for CVE-2015-X:\n\n\tFebruary 2: CVE-2015-0313 is discovered as a 0-day exploited in the wild.\n\tFeburary 4\/5: Adobe releases patched versions for CVE-2015-0313 for automatic\/manual download. The patched version is 16.0.0.305, and it also stops CVE-2015-X.\n\tFebruary 25: A fully working exploit code for CVE-2015-0313 is published. A change of only a handful of code lines would create CVE-2015-X.\n\tMarch 12: Flash Player 17.0.0.134 is released. It is vulnerable to CVE-2015-X.\n\tApril 14: Flash Player 17.0.0.169 is released, fixing both CVE-2015-0359 and CVE-2015-X.\n\nThis timeline suggests that attackers had a whole month to easily create and use CVE-2015-X against Flash Player 17.0.0.134, as a 0-day exploit. Both the attacks on CVE-2015-0313 and on CVE-2015-X were stopped by Palo Alto Networks Traps at the early exploitation stages, without causing any harm to the machine or to the organization. Prevention occurred without having any prior knowledge on the vulnerabilities or the attacks.\n\nHaving understood the gravity of the situation, and since there are at least a couple of almost-identical exploits that trigger \u201cdifferent\u201d vulnerabilities, we would now like to understand the root cause of these vulnerabilities. Read on for a deep technical analysis, showing the root cause of these vulnerabilities and the vulnerability triggering flow.\nTechnical Analysis\nFor this technical analysis we use the Flash 16.0.0.287 ActiveX control. The analysis is also correlated with the Actionscript Virtual Machine (AVM) source code.\n\nThe exploits for CVE-2015-0313 and CVE-2015-X both use a Flash ByteArray object, coupled with domainMemory, which performs the actual use of the dangling pointer. We would like to detail how achieving such a use-after-free situation is possible, and show a major flaw in the design of the ByteArray class.\n\nWe first need to make an important distinction between the class names exposed by Flash, and the class names that appear in the AVM. For example, the Flash ByteArray class is represented by the ByteArrayObject class in the AVM source code, and is not to be confused with the AVM ByteArray class, which is the internal representation of the byte array implementation. For the remainder of this research post, we\u2019ll be using only the class names appearing in the AVM.\n\nThe AVM is written in C++. As opposed to how other languages are used, there are two ways to create an object: \u201cstatically\u201d (where you would get back the actual object), and dynamically (where you would use the new operator and get back a pointer (reference) to the object). The classes concerning the representation of a byte array use both creation methods for their member variables.\n\nHere are the member variables of ByteArrayObject:\n\n\n\nm_byteArray is a static allocation of a ByteArray object. Its offset in the ByteArrayObject object is 0x18, for the tested version of Flash.\n\nThe ByteArray class inherits both from DataInput and DataOutput, and thus implicitly contains a representation of their objects. We note that the offset of the DataOutput object within the ByteArray object is 0x8.\n\nHere are the member variables of ByteArray:\n\n\n\nThere are 3 interesting fields here:\n\n\tm_buffer: An object of a class with one field. The field points to an object of the ByteArray::Buffer class, which eventually leads to the actual array of bytes. In memory this field will be preceded by an additional field for the virtual function table pointer for the FixedHeapRef class. m_buffer is located at offset 0x24 in the ByteArray class, and so the interesting field is at offset 0x28.\n\tm_isShareable: This tells us whether the byte array may be shared between workers (Flash\u2019s \u201cthreads\u201d). Among other things, this has implications for the class\u2019s copy constructor, because when the byte array is shared, there\u2019s no need to copy the data, but rather to point to the exact same ByteArray::Buffer object m_buffer points to. The field can be found at offset 0x2C.\n\tm_subscribers: This is an object containing a pointer to a ListData object, which holds information about entities that should be notified when the byte array is reallocated\/freed (i.e., its place in memory changes), or even simply when its size changes. Since byte arrays can be dynamically extended or cleared, this feature is important, though it is relevant only for entities holding a direct pointer to the actual byte array data, such as domainMemory. The field that has the pointer to the ListData object resides at offset 0x18 in the ByteArray object.\n\nThe ByteArray::Buffer object, reachable from m_buffer, has the following interesting fields:\n\n\tarray (offset 0x8): A pointer to the actual array of bytes holding the data.\n\tcapacity (offset 0xC): The maximum number of bytes the array can hold (actual allocation).\n\tlength (offset 0x10): The number of array bytes currently \u201cin use\u201d by the program. If the program wants to use more bytes than are allocated (determined by the capacity field), the byte array must be reallocated, meaning that the array pointer will be changed to point to a different address in memory.\n\nFinally, the ListData object reachable from m_subscribers has the following relevant field:\n\n\tlen (offset 0x4): The number of subscribers that should be notified when the actual byte array buffer is reallocated (thereby changing its location in memory).\n\nHere\u2019s a graphical illustration of the objects and fields relevant to CVE-2015-X, for the examined Flash version:\n\n\nRoot Cause\nThe root cause of CVE-2015-X lies in the way the ByteArray\u2019s equivalent of a copy constructor handles shareable byte arrays. If the byte array is shareable, the copy constructor uses the exact same reference to the ByteArray::Buffer object, but \u201cforgets\u201d about all of that byte array\u2019s subscribers. This leads to an easy use-after-free situation, where the pointer to the actual byte array is changed (the old byte array is freed), but no subscribers are notified of that, and one of them later tries to use the dangling pointer.\n\nThere are actually two \u201ccopy constructors,\u201d and both of them exhibit the same flaw in logic. Let\u2019s look at the constructor that is used with workers:\n\n\n\nWe can see that m_subscribers is going to be initialized to an empty subscribers list, effectively \u201cforgetting\u201d that there may be subscribers that need to receive change notifications for the ByteaArray::Buffer object\u2019s array member. It is important to note that although the figure above may make it seem as if this can only happen with workers, the other \u201ccopy constructor\u201d also behaves in much of the same way, and may allow triggering of a similar bug in situations that don\u2019t involve workers.\n\nSo, to trigger the bug, we must have a subscriber to a byte array, use a \u201ccopy constructor\u201d to get a new byte array without subscribers, and make the \u201ccopied\u201d byte array change its array pointer (e.g., add data to the byte array beyond its capacity) without notifying the original subscriber. Then, we can have the subscriber reference the freed buffer.\nWorkers\nThe in-the-wild exploits for both CVE-2015-0313 and CVE-2015-X used workers. The comments in the \u201ccopy constructor\u201d shown above give us a hint as to why, but we still need to see how we can even get to running the vulnerable code. Before diving into the triggering code, let\u2019s first examine carefully what happens when we create and run a new worker. Consider these two lines of ActionScript 3 (AS3) code:\n\n\n\nWe can find a hint of what\u2019s to come in the following comment in the AVM source code:\n\n\n\nWe will later see how important this distinction between a worker and an actual light-weight thread is.\n\nThe documentation for the Worker class says that a worker is created from a byte array. This brings us here:\n\n\n\nThe initialization gets us here:\n\n\n\nAnd we can see that a new Isolate object is created for the worker. Let\u2019s drill down just one more time:\n\n\n\nAnd we see that the isolate associated with the worker is of type ShellIsolate (which inherits from Isolate).\n\nWhen we ask the worker to start running using the start method, it simply calls the following function:\n\n\n\nThis creates a new thread and starts it, like so:\n\n\n\nWe note that Isolate inherits from Runnable, and so the VMThread constructor saves the pointer to the ShellIsolate object (via Runnable*) in m_runnable:\n\n\n\nRunning the VMThread\u2019s start method brings us here:\n\n\n\nSo a native (i.e., platform-specific) thread is created with startInternal as the function it should run. The function gets the VMThread object as a parameter, and invokes the run method from the associated isolate:\n\n\n\nWe get a run of yet another internal function:\n\n\n\nAnd now we\u2019re getting to the interesting part:\n\n\n\nWe can see here that a new TopLevel object is created for the worker\u2019s isolate. The setup function contains these lines:\n\n\n\nTo understand why this is important, let\u2019s see what is this TopLevel class. Quoting Adobe:\n\n\u201cThe top level contains the core ActionScript classes and global functions.\u201d\n\nAs such, we expect an object of the TopLevel class to exist only once, and this is indeed true, so long as you have just the main thread (\u201cprimordial worker\u201d). However, when you create a new (\u201cbackground\u201d) worker, it is created using a new isolate, which creates a new TopLevel object. Recall the comment that we quoted earlier: When you create a worker, it creates a separate instance of a big part of the environment.\n\nThe fact that a new TopLevel object is created for the worker is key for exploitation. More specifically, the new TopLevel object contains an empty _isolateInternedObjects table, which will consequently allow us to reach the vulnerable code, as we will later see.\nVulnerability Triggering\nHaving understood some of the mechanics of worker objects, we are now ready to show a detailed step-by-step example of triggering the CVE-2015-X vulnerability.\n\nStep 1: Create a shareable Flash ByteArray object, and assign it to domainMemory.\n\n\n\nLooking at the AVM sources, we see the effects of this assignment:\n\n\n\nWhere DomainEnv::globalMemorySubscribe generates a call to ByteArray::addSubscriber, which should add domainMemory (current domain) as a subscriber, to be notified of any changes in the underlying buffer holding the actual data for the object ba:\n\n\n\nDebugging that with Windbg, and breaking on ByteArray::addSubscriber (offset 0x66B210), gives us the following:\n\n\n\nThe ecx register holds the this pointer, pointing to the ByteArray object (ba) that is adding a new subscriber (the current domain). Recalling the interesting fields in a ByteArray object, we get:\n\n\tThe relevant ByteArray::Buffer object is on address 0x79D7230 (offset 0x28).\n\tThe byte array is shareable (offset 0x2C).\n\tThe subscriber information is on address 0x83050D0 (offset 0x18).\n\nExamining the ByteArray::Buffer object we get:\n\n\n\nSo the actual array of bytes resides in memory on address 0x8317000 (offset 0x8), and its capacity (offset 0xC) and length (offset 0x10) are 0x1000 (4096 bytes).\n\nFinally, looking at the subscribers ListData object, we get:\n\n\n\nWe can see that the length is 0 (offset 0x4), meaning there are no subscribers yet. We expect having a new subscriber at the end of the addSubscriber function, and indeed:\n\n\n\nStep 2: Still in the main thread, create a worker, set the shareable byte array to be a property shared with the worker, and start the worker thread.\n\n\n\nLet\u2019s follow the code for setting the shared property:\n\n\n\nAs explained in Dion Blazakis\u2019s seminal paper, atoms are actually tagged pointers. The channel item is created according to the object\u2019s type, like so:\n\n\n\nWe get that the appropriate member function of the ByteArrayObject class is called:\n\n\n\nSince our byte array is shareable, we get that the channel item that is stored as a shared property saves the pointer to the ByteArray::Buffer object (recall that this object holds the pointer to the actual array data, the capacity and the length, among other things), and the fact that the byte array is shareable.\n\nOne other important thing to note is the use of the intern function. Let\u2019s see what it does:\n\n\n\nm_value is the ByteArray::Buffer object we\u2019ve just saved as part of the ChannelItem object. It is sent to the function internObject in the TopLevel object, along with the pointer to the ByteArrayObject object associated with (i.e., \u201cholding\u201d) that Buffer object. This association is then saved internally by the TopLevel object, like so:\n\n\n\nSo the key is the reference to the Buffer object, and the value is the reference to the ByteArrayObject object. This means that when you set a shared property of a byte array for a worker, the array\u2019s ByteArray::Buffer reference can be used as a key to retrieve the corresponding ByteArrayObject reference via the TopLevel object. However, the only things that are saved in the channel item are the reference to the Buffer object, and the notion of whether this is a shareable byte array or not. Moreover, recall that the TopLevel object is unique per worker. Therefore, this association is only relevant to the current worker (which in this case is the primordial worker).\n\nStep 3: In the worker thread, get the shared byte array property.\n\n\n\nIf we track the AVM source code at this point, we get to the root cause of the vulnerability. We start with getting the shared property:\n\n\n\nWhich leads us to Isolate::getSharedProperty, where we find this piece of code:\n\n\n\nSo the string \u201cba\u201d is used as a key to fetch the corresponding reference to the ChannelItem object that we have saved on Step 2. Then, we use the function getAtom to convert the ChannelItem to an Atom, passing as an argument the TopLevel reference we got as a parameter ourselves (see previous code piece).\n\nThe function getAtom is the precursor to the vulnerability. This is how the function begins:\n\n\n\nm_value is a reference to a ByteArray::Buffer object we got from the ChannelItem object, and we\u2019re trying to find its associated ByteArrayObject object:\n\n\n\nAlthough we put the relevant association in the _isolateInternedObjects table in Step 2, it was in the context of the primordial worker. Now, we\u2019re in the context of a background worker, which has its own TopLevel object, with an empty _isolateInternedObjects table. This means that getInternedObject is going to return NULL. Had we issued the exact same call in the primordial worker, we would have gotten the exact same ByteArrayObject object that was put as a shared property, which also has a valid subscribers list.\n\nGetting back to getAtom, we can clearly see the vulnerable \u201ccopy constructor\u201d being called:\n\n\n\nSo we should get that the background worker has a reference to a new ByteArrayObject object, with no subscribers, that references the exact same ByteArray::Buffer object as the original ByteArrayObject object does in the primordial worker. We will see that this is indeed the case in the next step.\n\nStep 4: In the worker thread, add bytes to the shared byte array, to force it to pass its capacity and reallocate the underlying buffer.\n\n\n\nExecution of the writeBytes command will cause the freeing of the pointer (so as to allocate a larger array), without any notification to domainMemory. Before we examine the state of the byte array prior to executing the function, let\u2019s remind ourselves of the values we saw in the primordial worker, after setting domainMemory to the byte array:\n\n\tThe ByteArray object is at address 0x7A8F938.\n\tThe ByteArray::Buffer object is at address 0x79D7230.\n\tThe byte array is shareable.\n\tThe object describing the subscribers is at address 0x83050D0.\n\tThere is 1 subscriber (the current domain).\n\nWe now return to the writeBytes call in the background worker that will cause the \u201cfree\u201d part of the UAF vulnerability. ByteArrayObject::writeBytes calls DataOutput::WriteByteArray, which later calls ByteArray::Write. We break on DataOutput::WriteByteArray (offset 0x6A1F10), though any other function we\u2019ve just mentioned will do:\n\n\n\nThe ecx register holds the this pointer, which in this case points to a DataOutput object inside a ByteArray object (at offset 0x8). Comparing to the original values, we get:\n\n\tThe ByteArray object is at address 0x8B0FF10 (0x8B0FF18 \u2013 0x8).\n\tThe ByteArray::Buffer object is at address 0x79D7230 (see offset 0x20 from DataOutput).\n\tThe byte array is shareable (offset 0x24).\n\tThe object describing the subscribers is at address 0x8BE2280 (offset 0x10).\n\nSo we get that this is a new ByteArray object, pointing to a new subscribers list, but sharing the same Buffer as the original ByteArray object in the primordial worker. This is what we anticipated during the analysis of Step 3.\n\nLet\u2019s see how many subscribers we have:\n\n\n\nSo there are no subscribers (offset 0x4) for the new ByteArray object, although domainMemory has raw access to the actual byte array pointed at by this object (through the Buffer object). This means that when we use the writeBytes method to write beyond the capacity of the buffer, forcing a reallocation and changing of position in memory, domainMemory will not be notified about that, and will keep on holding a pointer to an already-freed byte array.\n\nHere is the code that actually gets called, but does not notify the relevant domain\u2019s domainMemory due to the empty subscribers list (length returns 0):\n\n\nSummary\nThe above is a detailed analysis of the root cause of the CVE-2015-X vulnerability, as well as a step-by-step explanation of how to trigger it. More importantly, we shared insights on workers, and suggested that there might be other paths leading to vulnerabilities of similar nature.\n\nWe note that the patches and code changes that prevented CVE-2015-0313 from being exploited did not actually address the root cause itself, which is exactly the same as in CVE-2015-X: deleting the subscribers\u2019 information from the worker\u2019s view of the byte array. This left the path open for exploitation of CVE-2015-X, a vulnerability based on the exact same bug. This exploitation indeed soon revealed itself.\n\nLikewise, there may be similar vulnerabilities still lurking out there, perhaps even having to do with the exact same root cause. Deploying Palo Alto Networks Traps in your organization protects you from existing and future exploitation of applications, including in Flash.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Palo Alto Networks"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"9240","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=9240' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funderstanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funderstanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-9240 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Understanding Flash Exploitation and the Alleged CVE-2015-0359 Exploit</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-9240 entry-meta">
			
			
			<span class="post-views-count">15,455</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'9240','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 15</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funderstanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funderstanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit%2F+-+Understanding+Flash+Exploitation+and+the+Alleged+CVE-2015-0359+Exploit" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funderstanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit%2F&title=Understanding+Flash+Exploitation+and+the+Alleged+CVE-2015-0359+Exploit&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/palo-alto-networks-staff/" title="Posts by Palo Alto Networks" class="author url fn" rel="author">Palo Alto Networks</a>        </p>
        <p><time datetime="2015-06-01T20:20:15+00:00">June 1, 2015 at 1:20 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/endpoint-2/" rel="category tag">Endpoint</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/adobe-flash-player/" rel="tag">Adobe Flash Player</a>, <a href="https://unit42.paloaltonetworks.com/tag/advanced-endpoint-protection/" rel="tag">Advanced Endpoint Protection</a>, <a href="https://unit42.paloaltonetworks.com/tag/angler-exploit/" rel="tag">Angler Exploit</a>, <a href="https://unit42.paloaltonetworks.com/tag/bytearray/" rel="tag">ByteArray</a>, <a href="https://unit42.paloaltonetworks.com/tag/bytearrayobject/" rel="tag">ByteArrayObject</a>, <a href="https://unit42.paloaltonetworks.com/tag/flash/" rel="tag">Flash</a>, <a href="https://unit42.paloaltonetworks.com/tag/traps/" rel="tag">Traps</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/understanding-flash-exploitation-and-the-alleged-cve-2015-0359-exploit/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><em>What follows is a detailed analysis of the root cause of a vulnerability we call CVE-2015-X, as well as a step-by-step explanation of how to trigger it. For more on Flash vulnerabilities, we also invite you to read &#8220;<a href="http://researchcenter.paloaltonetworks.com/2015/05/the-latest-flash-uaf-vulnerabilities-in-exploit-kits/">The Latest UAF Vulnerabilities in Exploit Kits</a>,&#8221; published May 28 by Tao Yan. </em></p>
<p>Not too long ago we came across a sample from the Angler Exploit kit (MD5: 049ff69bc23f36a78d86bbf1356c2f63c), <a href="https://www.fireeye.com/blog/threat-research/2015/04/angler_ek_exploiting.html" target="_blank">which allegedly exploits CVE-2015-0359</a>. The obfuscated SWF contains an encoded SWF (MD5: d45808cfa6f3cbfb343fdea269fdc375), which is later decoded and loaded into Flash, without getting saved on disk. Here’s a somewhat beautified example of this process:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_1.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9241" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_1-500x178.png" alt="gal_1" width="500" height="178" /></a></p>
<p>The embedded SWF is heavily obfuscated, but the code has much in common with the <a href="https://github.com/SecurityObscurity/cve-2015-0313" target="_blank">source code for Angler EK’s CVE-2015-0313 exploit</a>.</p>
<p>The first thing to do is determine whether the exploit is indeed for CVE-2015-0359. Some researchers <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/latest-flash-exploit-in-angler-ek-might-not-really-be-cve-2015-0359/" target="_blank">think that it’s not</a>. The embedded SWF contains a function we named <em>CheckEnvironment</em>, which eventually does this:<span id="more-9240"></span></p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_2.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9242" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_2-500x36.png" alt="gal_2" width="500" height="36" /></a></p>
<p>We note that <em>playerVerOk</em> is <em>true</em> if the Flash player’s version is at least 13.0.0.250, but older than 13.0.0.269, or if the player’s version is at least 15.0.0.189, but older than 16.0.0.305. However, the function returns <em>true</em> for any of the aforementioned versions, plus versions 13.0.0.277 and 17.0.0.134.</p>
<p>We can see that if none of those versions is present, no exploitation occurs:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_3.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9243" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_3-500x191.png" alt="gal_3" width="500" height="191" /></a></p>
<p>What’s more interesting, though, is that the exact exploit (vulnerability triggering) is chosen based on the version of Flash, like so:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_4.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9244" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_4-500x176.png" alt="gal_4" width="500" height="176" /></a></p>
<p>For Flash versions 13.0.0.250 and above, but older than 13.0.0.269, and for Flash versions 15.0.0.189 and above, but older than 16.0.0.305, <a href="https://blog.coresecurity.com/2015/04/13/analysis-of-adobe-flash-player-shared-bytearray-use-after-free-vulnerability/" target="_blank">CVE-2015-0313 is used</a>. <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0313" target="_blank">The description of CVE-2015-0313</a> states the following:</p>
<p><em>“Use-after-free vulnerability in Adobe Flash Player before 13.0.0.269 and 14.x through 16.x before 16.0.0.305 on Windows …”</em></p>
<p>If the Flash version is 13.0.0.277 or 17.0.0.134, a different exploit (trigger) is used. This is the only line where the exploitation paths differ from each other, so if it had indeed been CVE-2015-0359, we would expect <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0359" target="_blank">its description</a> to look like the one for CVE-2015-0313. However, this is the description that appears instead:</p>
<p><em>“Double free vulnerability in Adobe Flash Player before 13.0.0.281 and 14.x through 17.x before 17.0.0.169 on Windows …”</em></p>
<p>We can say with confidence that this not CVE-2015-0359. This is probably a <a href="http://researchcenter.paloaltonetworks.com/2015/05/the-latest-flash-uaf-vulnerabilities-in-exploit-kits/" target="_blank">use-after-free (UAF) vulnerability</a>, and not a double-free vulnerability (see the Technical Analysis section for actual proof). We therefore call this vulnerability CVE-2015-X.</p>
<p>This is the timeline of events for CVE-2015-X:</p>
<ol>
<li><strong>February 2</strong>: <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/trend-micro-discovers-new-adobe-flash-zero-day-exploit-used-in-malvertisements/" target="_blank">CVE-2015-0313 is discovered</a> as a 0-day exploited in the wild.</li>
<li><strong>Feburary 4/5</strong>: <a href="https://helpx.adobe.com/security/products/flash-player/apsa15-02.html" target="_blank">Adobe releases patched versions for CVE-2015-0313</a> for automatic/manual download. The patched version is 16.0.0.305, and <span style="text-decoration: underline;">it also stops CVE-2015-X</span>.</li>
<li><strong>February 25</strong>: A fully working <a href="http://hacklab.kr/?p=305" target="_blank">exploit code for CVE-2015-0313</a> is published. A change of <span style="text-decoration: underline;">only a handful of code lines</span> would create CVE-2015-X.</li>
<li><strong>March 12</strong>: <a href="https://helpx.adobe.com/flash-player/release-note/fp_17_air_17_release_notes.html" target="_blank">Flash Player 17.0.0.134 is released</a>. It is <span style="text-decoration: underline;">vulnerable to CVE-2015-X</span>.</li>
<li><strong>April 14</strong>: Flash Player 17.0.0.169 is released, <a href="https://helpx.adobe.com/security/products/flash-player/apsb15-06.html" target="_blank">fixing both CVE-2015-0359 and CVE-2015-X</a>.</li>
</ol>
<p>This timeline suggests that attackers had a whole month to easily create and use CVE-2015-X against Flash Player 17.0.0.134, <span style="text-decoration: underline;">as a 0-day exploit</span>. Both the attacks on CVE-2015-0313 and on CVE-2015-X were stopped by <a href="https://www.paloaltonetworks.com/products/endpoint-security.html" target="_blank">Palo Alto Networks Traps</a> at the early exploitation stages, without causing any harm to the machine or to the organization. Prevention occurred without having any prior knowledge on the vulnerabilities or the attacks.</p>
<p>Having understood the gravity of the situation, and since there are at least a couple of almost-identical exploits that trigger “different” vulnerabilities, we would now like to understand the root cause of these vulnerabilities. Read on for a deep technical analysis, showing the root cause of these vulnerabilities and the vulnerability triggering flow.</p>
<h3>Technical Analysis</h3>
<p>For this technical analysis we use the <a href="http://download.macromedia.com/pub/flashplayer/installers/archive/fp_16.0.0.287_archive.zip" target="_blank">Flash 16.0.0.287 ActiveX control</a>. The analysis is also correlated with the <a href="https://github.com/adobe-flash/avmplus" target="_blank">Actionscript Virtual Machine (AVM) source code</a>.</p>
<p>The exploits for CVE-2015-0313 and CVE-2015-X both use a Flash ByteArray object, coupled with <em>domainMemory</em>, which performs the actual use of the dangling pointer. We would like to detail how achieving such a use-after-free situation is possible, and show a major flaw in the design of the ByteArray class.</p>
<p>We first need to make an important distinction between the class names exposed by Flash, and the class names that appear in the AVM. For example, the Flash ByteArray class is represented by the ByteArrayObject class in the AVM source code, and is not to be confused with the AVM ByteArray class, which is the internal representation of the byte array implementation. For the remainder of this research post, we’ll be using only the class names appearing in the AVM.</p>
<p>The AVM is written in C++. As opposed to how other languages are used, there are two ways to create an object: “statically” (where you would get back the actual object), and dynamically (where you would use the <em>new</em> operator and get back a pointer (reference) to the object). The classes concerning the representation of a byte array use both creation methods for their member variables.</p>
<p>Here are the member variables of ByteArrayObject:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_5.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9245" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_5-500x100.png" alt="gal_5" width="500" height="100" /></a></p>
<p><em>m_byteArray</em> is a static allocation of a ByteArray object. Its offset in the ByteArrayObject object is 0x18, for the tested version of Flash.</p>
<p>The ByteArray class inherits both from DataInput and DataOutput, and thus implicitly contains a representation of their objects. We note that the offset of the DataOutput object within the ByteArray object is 0x8.</p>
<p>Here are the member variables of ByteArray:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_6.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9246" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_6.png" alt="gal_6" width="477" height="230" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_6.png 477w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_6-380x184.png 380w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_6-300x145.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_6-370x178.png 370w" sizes="(max-width: 477px) 100vw, 477px" /></a></p>
<p>There are 3 interesting fields here:</p>
<ol>
<li><strong>m_buffer</strong>: An object of a class with one field. The field points to an object of the ByteArray::Buffer class, which eventually leads to the actual array of bytes. In memory this field will be preceded by an additional field for the virtual function table pointer for the FixedHeapRef class. <em>m_buffer</em> is located at offset 0x24 in the ByteArray class, and so the interesting field is at offset 0x28.</li>
<li><strong>m_isShareable</strong>: This tells us whether the byte array may be shared between workers (Flash’s “threads”). Among other things, this has implications for the class’s copy constructor, because when the byte array is shared, there’s no need to copy the data, but rather to point to the exact same ByteArray::Buffer object <em>m_buffer</em> points to. The field can be found at offset 0x2C.</li>
<li><strong>m_subscribers</strong>: This is an object containing a pointer to a ListData object, which holds information about entities that should be notified when the byte array is reallocated/freed (i.e., its place in memory changes), or even simply when its size changes. Since byte arrays can be dynamically extended or cleared, this feature is important, though it is relevant only for entities holding a direct pointer to the actual byte array data, such as <em>domainMemory</em>. The field that has the pointer to the ListData object resides at offset 0x18 in the ByteArray object.</li>
</ol>
<p>The ByteArray::Buffer object, reachable from <em>m_buffer</em>, has the following interesting fields:</p>
<ul>
<li><strong>array</strong> (offset 0x8): A pointer to the actual array of bytes holding the data.</li>
<li><strong>capacity</strong> (offset 0xC): The maximum number of bytes the array can hold (actual allocation).</li>
<li><strong>length</strong> (offset 0x10): The number of array bytes currently “in use” by the program. If the program wants to use more bytes than are allocated (determined by the <em>capacity</em> field), the byte array must be reallocated, meaning that the <em>array</em> pointer will be changed to point to a different address in memory.</li>
</ul>
<p>Finally, the ListData object reachable from <em>m_subscribers</em> has the following relevant field:</p>
<ul>
<li><strong>len</strong> (offset 0x4): The number of subscribers that should be notified when the actual byte array buffer is reallocated (thereby changing its location in memory).</li>
</ul>
<p>Here’s a graphical illustration of the objects and fields relevant to CVE-2015-X, for the examined Flash version:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_7.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9247" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_7-500x280.png" alt="gal_7" width="500" height="280" /></a></p>
<h3>Root Cause</h3>
<p>The root cause of CVE-2015-X lies in the way the ByteArray’s equivalent of a copy constructor handles shareable byte arrays. If the byte array is shareable, the copy constructor uses the exact same reference to the ByteArray::Buffer object, but “forgets” about all of that byte array’s subscribers. This leads to an easy use-after-free situation, where the pointer to the actual byte array is changed (the old byte array is freed), but no subscribers are notified of that, and one of them later tries to use the dangling pointer.</p>
<p>There are actually two “copy constructors,” and both of them exhibit the same flaw in logic. Let’s look at the constructor that is used with workers:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_8.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9248" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_8-500x256.png" alt="gal_8" width="500" height="256" /></a></p>
<p>We can see that <em>m_subscribers</em> is going to be initialized to an empty subscribers list, effectively “forgetting” that there may be subscribers that need to receive change notifications for the ByteaArray::Buffer object’s <em>array</em> member. It is important to note that although the figure above may make it seem as if this can only happen with workers, the other “copy constructor” also behaves in much of the same way, and may allow triggering of a similar bug in situations that don’t involve workers.</p>
<p>So, to trigger the bug, we must have a subscriber to a byte array, use a “copy constructor” to get a new byte array without subscribers, and make the “copied” byte array change its <em>array</em> pointer (e.g., add data to the byte array beyond its capacity) without notifying the original subscriber. Then, we can have the subscriber reference the freed buffer.</p>
<h3>Workers</h3>
<p>The in-the-wild exploits for both CVE-2015-0313 and CVE-2015-X used workers. The comments in the “copy constructor” shown above give us a hint as to why, but we still need to see how we can even get to running the vulnerable code. Before diving into the triggering code, let’s first examine carefully what happens when we create and run a new worker. Consider these two lines of ActionScript 3 (AS3) code:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_9.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9249" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_9-500x31.png" alt="gal_9" width="500" height="31" /></a></p>
<p>We can find a hint of what’s to come in the following comment in the AVM source code:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_10.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9250" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_10-500x46.png" alt="gal_10" width="500" height="46" /></a></p>
<p>We will later see how important this distinction between a worker and an actual light-weight thread is.</p>
<p>The <a href="http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/Worker.html" target="_blank">documentation for the Worker class</a> says that a worker is created from a byte array. This brings us here:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_11.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9251" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_11-500x52.png" alt="gal_11" width="500" height="52" /></a></p>
<p>The initialization gets us here:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_12.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9252" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_12-500x211.png" alt="gal_12" width="500" height="211" /></a></p>
<p>And we can see that a new Isolate object is created for the worker. Let’s drill down just one more time:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_13.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9253" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_13-500x103.png" alt="gal_13" width="500" height="103" /></a></p>
<p>And we see that the isolate associated with the worker is of type ShellIsolate (which inherits from Isolate).</p>
<p>When we ask the worker to start running using the <em>start</em> method, it simply calls the following function:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_14.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9255" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_14.png" alt="gal_14" width="495" height="205" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_14.png 495w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_14-300x124.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_14-370x153.png 370w" sizes="(max-width: 495px) 100vw, 495px" /></a></p>
<p>This creates a new thread and starts it, like so:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_15.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9257" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_15-500x336.png" alt="gal_15" width="500" height="336" /></a></p>
<p>We note that Isolate inherits from Runnable, and so the VMThread constructor saves the pointer to the ShellIsolate object (via Runnable*) in <em>m_runnable</em>:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_16.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9258" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_16.png" alt="gal_16" width="382" height="158" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_16.png 382w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_16-380x158.png 380w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_16-300x124.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_16-370x153.png 370w" sizes="(max-width: 382px) 100vw, 382px" /></a></p>
<p>Running the VMThread’s <em>start</em> method brings us here:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_17.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9259" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_17-500x136.png" alt="gal_17" width="500" height="136" /></a></p>
<p>So a native (i.e., platform-specific) thread is created with <em>startInternal</em> as the function it should run. The function gets the VMThread object as a parameter, and invokes the <em>run</em> method from the associated isolate:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_18.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9260" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_18-500x158.png" alt="gal_18" width="500" height="158" /></a></p>
<p>We get a run of yet another internal function:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_19.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9261" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_19-500x229.png" alt="gal_19" width="500" height="229" /></a></p>
<p>And now we’re getting to the interesting part:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_20.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9262" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_20-500x378.png" alt="gal_20" width="500" height="378" /></a></p>
<p>We can see here that a new TopLevel object is created for the worker’s isolate. The <em>setup</em> function contains these lines:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_21.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9263" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_21.png" alt="gal_21" width="395" height="68" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_21.png 395w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_21-300x52.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_21-370x64.png 370w" sizes="(max-width: 395px) 100vw, 395px" /></a></p>
<p>To understand why this is important, let’s see what is this TopLevel class. Quoting <a href="http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/package-detail.html" target="_blank">Adobe</a>:</p>
<p><em>“The top level contains the core ActionScript classes and global functions.”</em></p>
<p>As such, we expect an object of the TopLevel class to exist only once, and this is indeed true, so long as you have just the main thread (“primordial worker”). However, when you create a new (“background”) worker, it is created using a new isolate, which creates a new TopLevel object. Recall the comment that we quoted earlier: When you create a worker, it creates a separate instance of a big part of the environment.</p>
<p>The fact that a new TopLevel object is created for the worker <strong>is key for exploitation</strong>. More specifically, the new TopLevel object contains an empty <em>_isolateInternedObjects</em> table, which will consequently allow us to reach the vulnerable code, as we will later see.</p>
<h3>Vulnerability Triggering</h3>
<p>Having understood some of the mechanics of worker objects, we are now ready to show a detailed step-by-step example of triggering the CVE-2015-X vulnerability.</p>
<p><strong>Step 1</strong>: Create a shareable Flash ByteArray object, and assign it to <em>domainMemory</em>.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_22.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9264" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_22-500x147.png" alt="gal_22" width="500" height="147" /></a></p>
<p>Looking at the AVM sources, we see the effects of this assignment:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_23.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9265" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_23-500x298.png" alt="gal_23" width="500" height="298" /></a></p>
<p>Where DomainEnv::globalMemorySubscribe generates a call to ByteArray::addSubscriber, which should add <em>domainMemory</em> (current domain) as a subscriber, to be notified of any changes in the underlying buffer holding the actual data for the object <em>ba</em>:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_24.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9266" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_24-500x63.png" alt="gal_24" width="500" height="63" /></a></p>
<p>Debugging that with Windbg, and breaking on ByteArray::addSubscriber (offset 0x66B210), gives us the following:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_25.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9267" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_25-500x233.png" alt="gal_25" width="500" height="233" /></a></p>
<p>The <em>ecx</em> register holds the <em>this</em> pointer, pointing to the ByteArray object (<em>ba</em>) that is adding a new subscriber (the current domain). Recalling the interesting fields in a ByteArray object, we get:</p>
<ol>
<li>The relevant ByteArray::Buffer object is on address 0x79D7230 (offset 0x28).</li>
<li>The byte array is shareable (offset 0x2C).</li>
<li>The subscriber information is on address 0x83050D0 (offset 0x18).</li>
</ol>
<p>Examining the ByteArray::Buffer object we get:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_26.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9268" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_26.png" alt="gal_26" width="456" height="203" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_26.png 456w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_26-300x134.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_26-370x165.png 370w" sizes="(max-width: 456px) 100vw, 456px" /></a></p>
<p>So the actual array of bytes resides in memory on address 0x8317000 (offset 0x8), and its capacity (offset 0xC) and length (offset 0x10) are 0x1000 (4096 bytes).</p>
<p>Finally, looking at the subscribers ListData object, we get:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_27.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9269" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_27.png" alt="gal_27" width="456" height="204" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_27.png 456w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_27-300x134.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_27-370x166.png 370w" sizes="(max-width: 456px) 100vw, 456px" /></a></p>
<p>We can see that the length is 0 (offset 0x4), meaning there are no subscribers yet. We expect having a new subscriber at the end of the addSubscriber function, and indeed:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_28.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9270" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_28-500x203.png" alt="gal_28" width="500" height="203" /></a></p>
<p><strong>Step 2</strong>: Still in the main thread, create a worker, set the shareable byte array to be a property shared with the worker, and start the worker thread.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_29.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9271" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_29-500x64.png" alt="gal_29" width="500" height="64" /></a></p>
<p>Let’s follow the code for setting the shared property:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_30.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9272" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_30-500x138.png" alt="gal_30" width="500" height="138" /></a></p>
<p>As explained in <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf" target="_blank">Dion Blazakis’s seminal paper</a>, atoms are actually tagged pointers. The channel item is created according to the object’s type, like so:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_31.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9273" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_31-500x196.png" alt="gal_31" width="500" height="196" /></a></p>
<p>We get that the appropriate member function of the ByteArrayObject class is called:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_32.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9274" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_32-500x280.png" alt="gal_32" width="500" height="280" /></a></p>
<p>Since our byte array is shareable, we get that the channel item that is stored as a shared property saves the pointer to the ByteArray::Buffer object (recall that this object holds the pointer to the actual array data, the capacity and the length, among other things), and the fact that the byte array is shareable.</p>
<p>One other important thing to note is the use of the <em>intern</em> function. Let’s see what it does:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_33.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9275" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_33.png" alt="gal_33" width="386" height="109" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_33.png 386w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_33-300x85.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_33-370x104.png 370w" sizes="(max-width: 386px) 100vw, 386px" /></a></p>
<p><em>m_value</em> is the ByteArray::Buffer object we’ve just saved as part of the ChannelItem object. It is sent to the function <em>internObject</em> in the TopLevel object, along with the pointer to the ByteArrayObject object associated with (i.e., “holding”) that Buffer object. This association is then saved internally by the TopLevel object, like so:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_34.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9276" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_34-500x121.png" alt="gal_34" width="500" height="121" /></a></p>
<p>So the key is the reference to the Buffer object, and the value is the reference to the ByteArrayObject object. This means that when you set a shared property of a byte array for a worker, the array’s ByteArray::Buffer reference can be used as a key to retrieve the corresponding ByteArrayObject reference via the TopLevel object. However, the only things that are saved in the channel item are the reference to the Buffer object, and the notion of whether this is a shareable byte array or not. Moreover, recall that <span style="text-decoration: underline;">the TopLevel object is unique per worker</span>. Therefore, this association is only relevant to the current worker (which in this case is the primordial worker).</p>
<p><strong>Step 3</strong>: In the worker thread, get the shared byte array property.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_35.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9277" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_35-500x88.png" alt="gal_35" width="500" height="88" /></a></p>
<p>If we track the AVM source code at this point, we get to the root cause of the vulnerability. We start with getting the shared property:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_36.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9278" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_36-500x190.png" alt="gal_36" width="500" height="190" /></a></p>
<p>Which leads us to Isolate::getSharedProperty, where we find this piece of code:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_37.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9280" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_37-500x193.png" alt="gal_37" width="500" height="193" /></a></p>
<p>So the string “ba” is used as a key to fetch the corresponding reference to the ChannelItem object that we have saved on Step 2. Then, we use the function <em>getAtom</em> to convert the ChannelItem to an Atom, passing as an argument the TopLevel reference we got as a parameter ourselves (see previous code piece).</p>
<p>The function <em>getAtom</em> is the precursor to the vulnerability. This is how the function begins:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_38.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9281" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_38-500x44.png" alt="gal_38" width="500" height="44" /></a></p>
<p><em>m_value</em> is a reference to a ByteArray::Buffer object we got from the ChannelItem object, and we’re trying to find its associated ByteArrayObject object:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_39.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9282" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_39-500x177.png" alt="gal_39" width="500" height="177" /></a></p>
<p>Although we put the relevant association in the <em>_isolateInternedObjects</em> table in Step 2, it was in the context of the primordial worker. Now, we’re in the context of a background worker, which has its own TopLevel object, with an empty <em>_isolateInternedObjects</em> table. This means that <em>getInternedObject</em> is going to return NULL. Had we issued the exact same call in the primordial worker, we would have gotten the exact same ByteArrayObject object that was put as a shared property, which also has a valid subscribers list.</p>
<p>Getting back to <em>getAtom</em>, we can clearly see the vulnerable “copy constructor” being called:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_40.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9283" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_40-500x114.png" alt="gal_40" width="500" height="114" /></a></p>
<p>So we should get that the background worker has a reference to a <span style="text-decoration: underline;">new</span> ByteArrayObject object, with <span style="text-decoration: underline;">no subscribers</span>, that references <span style="text-decoration: underline;">the exact same</span> ByteArray::Buffer object as the original ByteArrayObject object does in the primordial worker. We will see that this is indeed the case in the next step.</p>
<p><strong>Step 4</strong>: In the worker thread, add bytes to the shared byte array, to force it to pass its capacity and reallocate the underlying buffer.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_41.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9284" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_41-500x156.png" alt="gal_41" width="500" height="156" /></a></p>
<p>Execution of the <em>writeBytes</em> command will cause the freeing of the pointer (so as to allocate a larger array), without any notification to <em>domainMemory</em>. Before we examine the state of the byte array prior to executing the function, let’s remind ourselves of the values we saw in the primordial worker, after setting <em>domainMemory</em> to the byte array:</p>
<ul>
<li>The ByteArray object is at address 0x7A8F938.</li>
<li>The ByteArray::Buffer object is at address 0x79D7230.</li>
<li>The byte array is shareable.</li>
<li>The object describing the subscribers is at address 0x83050D0.</li>
<li>There is 1 subscriber (the current domain).</li>
</ul>
<p>We now return to the <em>writeBytes</em> call in the background worker that will cause the “free” part of the UAF vulnerability. ByteArrayObject::writeBytes calls DataOutput::WriteByteArray, which later calls ByteArray::Write. We break on DataOutput::WriteByteArray (offset 0x6A1F10), though any other function we’ve just mentioned will do:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_42.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9285" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_42-500x233.png" alt="gal_42" width="500" height="233" /></a></p>
<p>The <em>ecx</em> register holds the <em>this</em> pointer, which in this case points to a DataOutput object inside a ByteArray object (at offset 0x8). Comparing to the original values, we get:</p>
<ul>
<li>The ByteArray object is at address 0x8B0FF10 (0x8B0FF18 – 0x8).</li>
<li>The ByteArray::Buffer object is at address 0x79D7230 (see offset 0x20 from DataOutput).</li>
<li>The byte array is shareable (offset 0x24).</li>
<li>The object describing the subscribers is at address 0x8BE2280 (offset 0x10).</li>
</ul>
<p>So we get that this is a new ByteArray object, pointing to a new subscribers list, but sharing the same Buffer as the original ByteArray object in the primordial worker. This is what we anticipated during the analysis of Step 3.</p>
<p>Let’s see how many subscribers we have:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_43.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9286" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_43.png" alt="gal_43" width="455" height="202" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_43.png 455w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_43-300x133.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_43-370x164.png 370w" sizes="(max-width: 455px) 100vw, 455px" /></a></p>
<p>So there are no subscribers (offset 0x4) for the new ByteArray object, although <em>domainMemory</em> has raw access to the actual byte array pointed at by this object (through the Buffer object). This means that when we use the <em>writeBytes</em> method to write beyond the capacity of the buffer, forcing a reallocation and changing of position in memory, <em>domainMemory</em> will not be notified about that, and will keep on holding a pointer to an already-freed byte array.</p>
<p>Here is the code that actually gets called, but does not notify the relevant domain’s <em>domainMemory</em> due to the empty subscribers list (<em>length</em> returns 0):</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/gal_44.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9287" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/gal_44-500x122.png" alt="gal_44" width="500" height="122" /></a></p>
<h3>Summary</h3>
<p>The above is a detailed analysis of the root cause of the CVE-2015-X vulnerability, as well as a step-by-step explanation of how to trigger it. More importantly, we shared insights on workers, and suggested that there might be other paths leading to vulnerabilities of similar nature.</p>
<p>We note that the patches and code changes that prevented CVE-2015-0313 from being exploited did not actually address the root cause itself, which is exactly the same as in CVE-2015-X: deleting the subscribers’ information from the worker’s view of the byte array. This left the path open for exploitation of CVE-2015-X, a vulnerability based on the exact same bug. This exploitation indeed soon revealed itself.</p>
<p>Likewise, there may be similar vulnerabilities still lurking out there, perhaps even having to do with the exact same root cause. Deploying <a href="https://www.paloaltonetworks.com/products/endpoint-security.html" target="_blank">Palo Alto Networks Traps</a> in your organization protects you from existing and future exploitation of applications, including in Flash.</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
