
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)" />
<meta property="og:description" content="Unit 42 shares their analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)" />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="CVE-2018-1111" />
<meta property="article:tag" content="exploit" />
<meta property="article:tag" content="vulnerability" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2018-07-16T12:00:49+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:width" content="600" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 shares their analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)" />
<meta name="twitter:title" content="Analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111) Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="6"/>
<meta property="og:views" content="18,774"/>
<meta property="og:date_created" content="July 16, 2018 at 5:00 AM"/>
<meta property="og:post_length" content="1392"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Jin Chen"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jin-chen/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)","name":"Analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)","description":"Unit 42 shares their analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111\/","datePublished":"July 16, 2018","articleBody":"In May 2018, a command injection flaw was found in the NetworkManager integration script included in the DHCP client packages in multiple versions of Red Hat Enterprise Linux (CVE-2018-1111), which has since been patched. An attacker could attack this vulnerability either through the use of a malicious DHCP server, or malicious, spoofed DHCP responses on the local network. A successful attack could execute arbitrary commands with root privileges on systems using NetworkManager with DHCP configured.\nThis vulnerability poses a serious threat to individuals or organizations running vulnerable instance of Red Hat Enterprise Linux versions 6 or 7 and patches should be applied immediately.\nThis blog post serves to help with your risk assessment and understanding of the vulnerability by providing an overview of this particular vulnerability and provides details on how readers may protect themselves.\n&nbsp;\nThe Vulnerability\nNetworkManager is a Linux program that is used to manage system networking when DHCP networking mode is configured. In such an event, NetworkManager will launch dhclient to send DHCP requests as seen in Figure 1.\n\nFigure 1. The dhclient process running via NetworkManager\n&nbsp;\nIn the above example, you might notice that an additional configuration file\u00a0 (\/var\/lib\/NetworkManager\/dhclient-eth0.conf) was passed to dhclient from NetworkManager. As we can see in the following example, by default dhclient is configured to request multiple DHCP packet options, including WPAD.\n\nFigure 2. Configuration file passed to dhclient\nWhen dhclient sends an initial request for a DHCP server, it is configured to include this WPAD (Code 252) option within the request, as we can see in the following example:\n\nFigure 3. DHCP requesting WPAD option in initial packet\nDue to the CVE-2018-1111 vulnerability, an attacker can craft a response to this DHCP request with a malformed response. For example, an attacker may respond with the following data, as seen in Figure 4:\nxxx'&amp;touch \/tmp\/test #\n\nFigure 4. Attacker responding with a malformed WPAD option in the DHCP response\nUpon receiving this response, the default 11-dhclient script will ultimately pass this data into an eval() statement, which will in turn result in the \/tmp\/test being created via the touch command.\n&nbsp;\nTechnical Analysis\nThere are a number of other things that happen after the victim system receives a malformed DHCP response and before \/tmp\/test is created. First, dhclient will call the client_option_envadd() function to save the value into a variable, which may be observed in the source code below. It is specifically performed on line 3154 via the client_envadd() function.\n\nFigure 5. dhclient source code demonstrating how it handles DHCP packet options\nIn the above source code, the pretty_print_option() function is called prior to setting the variable, which will sanitize the value by adding a blackslash(\u2018\\\u2019) before the special characters. As an example:\n\n \tThe ' character will be converted to \\'\n \tThe &amp; character will converted to \\&amp;\n\nIn our example case, the initial data sent was as follows:\n\n \txxx'&amp;touch \/tmp\/test #\n\nThis will then be converted to the following:\n\n \txxx\\'\\&amp;touch \/tmp\/test #\n\nThis can be seen in the following figure where this function converts the data that was received:\n\n&nbsp;\nFigure 6. Example WPAD option provided being modified by the pretty_print function\n&nbsp;\nAfter this conversion is made, it proceeds to call the check_option_values() function before storing the value into a variable, where it will check to determine if it contains special characters in the event certain options were given. Example of such options include when a HOST_NAME or DOMAIN_NAME is provided, as seen in Figures 8 and 9.\n&nbsp;\n\nFigure 8. Source code checking if specific options were provided\n\nFigure 9. Code being executed in the event the NETBIOS_SCOPE option was provided\n&nbsp;\nAs you can see from the code, the WPAD option is not checked. As such, it undergoes no additional scrutiny, which enables us to provide any data via this option in the DHCP response.\nNext, dhclient will launch \/usr\/libexec\/nm-dhcp-helper process by setting a parameter passed via an argument. These variables are then saved to the dbus service.\nAnother sibling process named nm-dispatcher, which is launched by NetworkManager, will then read variables from the dbus service. It will save the value of the WPAD DHCP option to an environment variable name DHCP4_WPAD, and proceeds to launch the 11-dhclient script located in \/etc\/NetworkManager\/dispatcher.d\/.\nTaking a look at this 11-dhclient script, we see it contains the following:\n\nFigure 10. Contents of the 11-dhclient script\nLet\u2019s dive into what is exactly happening within this script.\nWithin the eval() statement, it begins with a \u201cdeclare\u201d command. This \u201cdeclare\u201d command will output all of the environment variables on the system. Readers may be familiar with the \u201cenv\u201d command, which operates in a similar way. However, while the output is similar, there are some key differences, as shown inFigure 11, below.\n&nbsp;\n\nFigure 11. Differences between the declare and env commands\nAs you can see above, the \"declare\" command will do 2 additional things:\n\n \tIf the variables include special characters such as spaces or single quotes for example, it will add a \u2018 on both sides.\n \tIt will escape inner ' to '\\'' (converting one character to four characters).\n\nSince the variable value is xxx\\'\\&amp;touch \/tmp\/test #, the output from \"declare\" will become 'xxx\\'\\''\\&amp;touch \/tmp\/test #'.\nAfter the \u201ddeclare\u201d command is run, the script will search for only environment variables that begin with \u201cDHCP4_\u201d. This is followed by the \u201cread\u201d command. With no arguments provided, this command will read escaped characters. In other words, \\' will become '.\nGoing back to the data we provided via the WPAD option in the DHCP response,\u00a0 'xxx\\'\\''\\&amp;touch \/tmp\/test #' will become 'xxx'''&amp;touch \/tmp\/test #'. In other words, the previously escaped characters are unescaped as a result of using the \u201cread\u201d command without any arguments.\nThe remaining commands set the parsed environment variable data to a series of variables. The last command, however, contains code that may be exploited. The line in question is as follows:\necho \"export $optname=$optvalue\"\nUsing our example response, the following code will be executed on the system:\neval \"$(echo \"export new_wpad='xxx'''&amp;touch \/tmp\/test #' \")\"\nThis is demonstrated on the command-line in Figure 12:\n\nFigure 12. Example execution of evaluating the code provided based on the WPAD DHCP option\n&nbsp;\nBecause the quotations are not escaped, and because it is followed by an ampersand, it allows us to append an additional command to this eval() statement. In our example, we supply a secondary command of \u2018touch \/tmp\/test\u2019, which results in us creating an empty file named \u2018test\u2019 in the \/tmp\/ directory.\nIn the event the quotation characters and the ampersand characters were escaped, our attack would be unsuccessful, as shown in the following example:\n&nbsp;\n\nFigure 13. Attempt at executing the same code with escaped cahracters\n&nbsp;\nIt is important to note that other characters may be used to perform this attack, such as | or ;.\n&nbsp;\nUnderstanding the Vulnerability Fix\nIn this particular instance, the fix is very simple. Simply adding the\u00a0 \u2018-r\u2019 option to the \u201cread\u201d command prevents the various characters from being unescaped, as shown in the fix pushed out to patch this vulnerability:\n\nFigure 14. Patch for CVE-2018-1111\nAccording to the documentation of the \"read\" command, the \u201c-r\u201d option prevents the command from reading backslashes as escape characters. In other words, it will keep all backslashes in the data provided to it. In doing so, it can defend against command injection attacks.\n&nbsp;\nStatus of this Vulnerability\nShortly after the vulnerability was discovered, proof-of-concept (POC) code was released into the wild on May 16, 2018 via Twitter:\n\nFigure 15. Twitter announcement of CVE-2018-111 PoC\nAdditionally, in GitHub, there is code that may be configured to easily test for the presence of this vulnerability:\nhttps:\/\/github.com\/knqyf263\/CVE-2018-1111\n&nbsp;\nConclusion\nConsidering that NetworkManager is so widely used and this vulnerability is so easy to be leveraged by attackers, it should be considered a critical vulnerability. The current threat environment around this is that there is increased risk that it will be used by malicious attackers.\nReaders are encouraged to patch their systems if they have not already done so. In the event a patch has not yet been deployed, Palo Alto Networks customers are protected from this vulnerability via signature 40739.\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2018\/04\/unit42-blog-600x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Jin Chen"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"81776","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=81776' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-81776 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Analysis of the DHCP Client Script Code Execution Vulnerability (CVE-2018-1111)</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-81776 entry-meta">
			
			
			<span class="post-views-count">18,774</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'81776','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 6</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111%2F+-+Analysis+of+the+DHCP+Client+Script+Code+Execution+Vulnerability+%28CVE-2018-1111%29" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111%2F&title=Analysis+of+the+DHCP+Client+Script+Code+Execution+Vulnerability+%28CVE-2018-1111%29&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-analysis-dhcp-client-script-code-execution-vulnerability-cve-2018-1111/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/jin-chen/" title="Posts by Jin Chen" class="author url fn" rel="author">Jin Chen</a>        </p>
        <p><time datetime="2018-07-16T12:00:49+00:00">July 16, 2018 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/cve-2018-1111/" rel="tag">CVE-2018-1111</a>, <a href="https://unit42.paloaltonetworks.com/tag/exploit/" rel="tag">exploit</a>, <a href="https://unit42.paloaltonetworks.com/tag/vulnerability/" rel="tag">vulnerability</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="600" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg 600w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-300x150.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-370x185.jpg 370w" sizes="(max-width: 600px) 100vw, 600px" />            </figure>
                    <p>In May 2018, a command injection flaw was found in the NetworkManager integration script included in the DHCP client packages in multiple versions of Red Hat Enterprise Linux (<a href="https://access.redhat.com/security/cve/cve-2018-1111">CVE-2018-1111</a>), which has since been patched. An attacker could attack this vulnerability either through the use of a malicious DHCP server, or malicious, spoofed DHCP responses on the local network. A successful attack could execute arbitrary commands with root privileges on systems using NetworkManager with DHCP configured.<br />
This vulnerability poses a serious threat to individuals or organizations running vulnerable instance of Red Hat Enterprise Linux versions 6 or 7 and patches should be applied immediately.<br />
This blog post serves to help with your risk assessment and understanding of the vulnerability by providing an overview of this particular vulnerability and provides details on how readers may protect themselves.<br />
&nbsp;<br />
<span style="font-size: 18pt;">The Vulnerability</span><br />
NetworkManager is a Linux program that is used to manage system networking when DHCP networking mode is configured. In such an event, NetworkManager will launch dhclient to send DHCP requests as seen in Figure 1.<br />
<img class="aligncenter wp-image-81779" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_1.png" alt="CVE_1" width="600" height="39" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_1.png 962w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_1-900x58.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_1-300x19.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_1-768x49.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_1-370x24.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 1. The dhclient process running via NetworkManager</em></p>
<p>&nbsp;<br />
In the above example, you might notice that an additional configuration file  (/var/lib/NetworkManager/dhclient-eth0.conf) was passed to dhclient from NetworkManager. As we can see in the following example, by default dhclient is configured to request multiple DHCP packet options, including WPAD.<br />
<img class="aligncenter wp-image-81818" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_2.png" alt="CVE_2" width="600" height="188" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_2.png 1050w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_2-900x282.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_2-300x94.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_2-768x241.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_2-1024x321.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_2-370x116.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 2. Configuration file passed to dhclient</em></p>
<p>When dhclient sends an initial request for a DHCP server, it is configured to include this WPAD (Code 252) option within the request, as we can see in the following example:<br />
<img class="aligncenter wp-image-81857" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_3.png" alt="CVE_3" width="600" height="261" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_3.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_3-900x392.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_3-300x131.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_3-768x334.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_3-370x161.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 3. DHCP requesting WPAD option in initial packet</em></p>
<p>Due to the CVE-2018-1111 vulnerability, an attacker can craft a response to this DHCP request with a malformed response. For example, an attacker may respond with the following data, as seen in Figure 4:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692889c5fe4491619463" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
xxx'&amp;touch /tmp/test #</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692889c5fe4491619463-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692889c5fe4491619463-1"><span class="crayon-i">xxx</span>'<span class="crayon-o">&amp;</span><span class="crayon-v">touch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-p">#</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><img class="aligncenter wp-image-81896" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_4.png" alt="CVE_4" width="600" height="268" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_4.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_4-900x402.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_4-300x134.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_4-768x343.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_4-370x165.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 4. Attacker responding with a malformed WPAD option in the DHCP response</em></p>
<p>Upon receiving this response, the default 11-dhclient script will ultimately pass this data into an eval() statement, which will in turn result in the /tmp/test being created via the touch command.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Technical Analysis</span><br />
There are a number of other things that happen after the victim system receives a malformed DHCP response and before /tmp/test is created. First, dhclient will call the client_option_envadd() function to save the value into a variable, which may be observed in the source code below. It is specifically performed on line 3154 via the client_envadd() function.<br />
<img class="aligncenter wp-image-81935" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_5.png" alt="CVE_5" width="600" height="479" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_5.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_5-900x718.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_5-300x239.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_5-768x613.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_5-370x295.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 5. dhclient source code demonstrating how it handles DHCP packet options</em></p>
<p>In the above source code, the pretty_print_option() function is called prior to setting the variable, which will sanitize the value by adding a blackslash(‘\’) before the special characters. As an example:</p>
<ul>
<li>The &#8216; character will be converted to \&#8217;</li>
<li>The &amp; character will converted to \&amp;</li>
</ul>
<p>In our example case, the initial data sent was as follows:</p>
<ul>
<li>xxx&#8217;&amp;touch /tmp/test #</li>
</ul>
<p>This will then be converted to the following:</p>
<ul>
<li>xxx\&#8217;\&amp;touch /tmp/test #</li>
</ul>
<p>This can be seen in the following figure where this function converts the data that was received:<br />
<img class="aligncenter wp-image-81974" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_6.png" alt="CVE_6" width="600" height="280" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_6.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_6-900x420.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_6-300x140.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_6-768x358.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_6-370x172.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;</p>
<p style="text-align: center;"><em>Figure 6. Example WPAD option provided being modified by the pretty_print function</em></p>
<p>&nbsp;<br />
After this conversion is made, it proceeds to call the check_option_values() function before storing the value into a variable, where it will check to determine if it contains special characters in the event certain options were given. Example of such options include when a HOST_NAME or DOMAIN_NAME is provided, as seen in Figures 8 and 9.<br />
&nbsp;<br />
<img class="aligncenter wp-image-82013" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_7.png" alt="CVE_7" width="600" height="495" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_7.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_7-900x743.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_7-300x248.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_7-768x634.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_7-370x305.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 8. Source code checking if specific options were provided</em></p>
<p style="text-align: left;"><img class="aligncenter wp-image-82052" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_9.png" alt="CVE_9" width="600" height="397" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_9.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_9-900x596.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_9-300x199.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_9-768x509.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_9-370x245.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 9. Code being executed in the event the NETBIOS_SCOPE option was provided</em></p>
<p>&nbsp;<br />
As you can see from the code, the WPAD option is not checked. As such, it undergoes no additional scrutiny, which enables us to provide any data via this option in the DHCP response.<br />
Next, dhclient will launch /usr/libexec/nm-dhcp-helper process by setting a parameter passed via an argument. These variables are then saved to the dbus service.<br />
Another sibling process named nm-dispatcher, which is launched by NetworkManager, will then read variables from the dbus service. It will save the value of the WPAD DHCP option to an environment variable name DHCP4_WPAD, and proceeds to launch the 11-dhclient script located in /etc/NetworkManager/dispatcher.d/.<br />
Taking a look at this 11-dhclient script, we see it contains the following:<br />
<img class="aligncenter wp-image-82091" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_10.png" alt="CVE_10" width="600" height="277" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_10.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_10-900x415.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_10-300x138.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_10-768x354.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_10-370x171.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 10. Contents of the 11-dhclient script</em></p>
<p>Let’s dive into what is exactly happening within this script.<br />
Within the eval() statement, it begins with a “declare” command. This “declare” command will output all of the environment variables on the system. Readers may be familiar with the “env” command, which operates in a similar way. However, while the output is similar, there are some key differences, as shown inFigure 11, below.<br />
&nbsp;<br />
<img class="aligncenter wp-image-82130" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_11.png" alt="CVE_11" width="600" height="158" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_11.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_11-900x237.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_11-300x79.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_11-768x202.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_11-370x97.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 11. Differences between the declare and env commands</em></p>
<p>As you can see above, the &#8220;declare&#8221; command will do 2 additional things:</p>
<ol>
<li>If the variables include special characters such as spaces or single quotes for example, it will add a ‘ on both sides.</li>
<li>It will escape inner<strong> &#8216; </strong>to<strong> &#8216;\&#8221;</strong> (converting one character to four characters).</li>
</ol>
<p>Since the variable value is xxx\&#8217;\&amp;touch /tmp/test #, the output from &#8220;declare&#8221; will become &#8216;xxx\&#8217;\&#8221;\&amp;touch /tmp/test #&#8217;.<br />
After the ”declare” command is run, the script will search for only environment variables that begin with “DHCP4_”. This is followed by the “read” command. With no arguments provided, this command will read escaped characters. In other words, \&#8217; will become &#8216;<strong>.</strong><br />
Going back to the data we provided via the WPAD option in the DHCP response,  &#8216;xxx\&#8217;\&#8221;\&amp;touch /tmp/test #&#8217; will become &#8216;xxx&#8221;&#8217;&amp;touch /tmp/test #&#8217;. In other words, the previously escaped characters are unescaped as a result of using the “read” command without any arguments.<br />
The remaining commands set the parsed environment variable data to a series of variables. The last command, however, contains code that may be exploited. The line in question is as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692889c5ff1816318204" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
echo "export $optname=$optvalue"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692889c5ff1816318204-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692889c5ff1816318204-1"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"export $optname=$optvalue"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Using our example response, the following code will be executed on the system:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692889c5ff5225639200" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
eval "$(echo "export new_wpad='xxx'''&amp;touch /tmp/test #' ")"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692889c5ff5225639200-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692889c5ff5225639200-1"><span class="crayon-i">eval</span><span class="crayon-h"> </span><span class="crayon-s">"$(echo "</span><span class="crayon-e">export </span><span class="crayon-v">new_wpad</span><span class="crayon-o">=</span><span class="crayon-s">'xxx'</span><span class="crayon-s">''</span><span class="crayon-o">&amp;</span><span class="crayon-v">touch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-p">#' ")"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This is demonstrated on the command-line in Figure 12:<br />
<img class="aligncenter wp-image-82169" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_12.png" alt="CVE_12" width="600" height="59" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_12.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_12-900x88.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_12-300x29.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_12-768x75.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_12-370x36.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 12. Example execution of evaluating the code provided based on the WPAD DHCP option</em></p>
<p>&nbsp;<br />
Because the quotations are not escaped, and because it is followed by an ampersand, it allows us to append an additional command to this eval() statement. In our example, we supply a secondary command of ‘touch /tmp/test’, which results in us creating an empty file named ‘test’ in the /tmp/ directory.<br />
In the event the quotation characters and the ampersand characters were escaped, our attack would be unsuccessful, as shown in the following example:<br />
&nbsp;<br />
<img class="aligncenter wp-image-82208" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_13.png" alt="CVE_13" width="600" height="39" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_13.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_13-900x59.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_13-300x20.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_13-768x50.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_13-370x24.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 13. Attempt at executing the same code with escaped cahracters</em></p>
<p>&nbsp;<br />
It is important to note that other characters may be used to perform this attack, such as | or ;.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Understanding the Vulnerability Fix</span><br />
In this particular instance, the fix is very simple. Simply adding the  ‘-r’ option to the “read” command prevents the various characters from being unescaped, as shown in the fix pushed out to patch this vulnerability:<br />
<img class="aligncenter wp-image-82247" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_14.png" alt="CVE_14" width="600" height="176" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_14.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_14-900x263.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_14-300x88.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_14-768x225.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_14-370x108.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 14. Patch for CVE-2018-1111</em></p>
<p>According to the documentation of the &#8220;read&#8221; command, the “-r” option prevents the command from reading backslashes as escape characters. In other words, it will keep all backslashes in the data provided to it. In doing so, it can defend against command injection attacks.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Status of this Vulnerability</span><br />
Shortly after the vulnerability was discovered, proof-of-concept (POC) code was released into the wild on May 16, 2018 via Twitter:<br />
<img class="aligncenter wp-image-82286" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_15.png" alt="CVE_15" width="600" height="778" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_15.png 610w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_15-231x300.png 231w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/CVE_15-370x480.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 15. Twitter announcement of CVE-2018-111 PoC</em></p>
<p>Additionally, in GitHub, there is code that may be configured to easily test for the presence of this vulnerability:<br />
<a href="https://github.com/knqyf263/CVE-2018-1111">https://github.com/knqyf263/CVE-2018-1111</a><br />
&nbsp;<br />
<span style="font-size: 18pt;">Conclusion</span><br />
Considering that NetworkManager is so widely used and this vulnerability is so easy to be leveraged by attackers, it should be considered a critical vulnerability. The current threat environment around this is that there is increased risk that it will be used by malicious attackers.<br />
Readers are encouraged to patch their systems if they have not already done so. In the event a patch has not yet been deployed, Palo Alto Networks customers are protected from this vulnerability via signature 40739.<br />
&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
