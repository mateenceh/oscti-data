
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 discovers TeleRAT, an Android Trojan abusing Telegram’s Bot API for command and control and data exfiltration."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users" />
<meta property="og:description" content="Unit 42 discovers TeleRAT, an Android Trojan abusing Telegram’s Bot API for command and control and data exfiltration." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Android" />
<meta property="article:tag" content="Iran" />
<meta property="article:tag" content="IRRAT" />
<meta property="article:tag" content="Telegram’s Bot API" />
<meta property="article:tag" content="TeleRAT" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2018-03-20T20:00:38+00:00" />
<meta property="article:modified_time" content="2018-09-06T08:45:01+00:00" />
<meta property="og:updated_time" content="2018-09-06T08:45:01+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 discovers TeleRAT, an Android Trojan abusing Telegram’s Bot API for command and control and data exfiltration." />
<meta name="twitter:title" content="TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/feed/" />
<meta property="og:likes" content="4"/>
<meta property="og:readtime" content="9"/>
<meta property="og:views" content="46,609"/>
<meta property="og:date_created" content="March 20, 2018 at 1:00 PM"/>
<meta property="og:post_length" content="2262"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Ruchna Nigam"/>
<meta property="og:author" content="Kyle Wilhoit"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/ruchna-nigam/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/kyle-wilhoit/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"TeleRAT: Another Android Trojan Leveraging Telegram\u2019s Bot API to Target Iranian Users","name":"TeleRAT: Another Android Trojan Leveraging Telegram\u2019s Bot API to Target Iranian Users","description":"Unit 42 discovers TeleRAT, an Android Trojan abusing Telegram\u2019s Bot API for command and control and data exfiltration. ","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users\/","datePublished":"March 20, 2018","articleBody":"Summary\r\nTelegram Bots are special accounts that do not require an additional phone number to setup and are generally used to enrich Telegram chats with content from external services or to get customized notifications and news. And while Android malware abusing Telegram's Bot API\u00a0to\u00a0target Iranian users is not fresh news (the emergence of a Trojan using this method called IRRAT was discussed in June and July 2017), we set out to investigate how these Telegram Bots were being abused to command and control malicious Android applications.\r\n\r\nThis blog details our findings navigating through some Operational Security (OPSEC) fails while sifting through multiple malicious APK variants abusing Telegram's Bot API; including the discovery of a new Trojan we've named \u201cTeleRAT\u201d. TeleRAT not only abuses Telegram's Bot API for Command and Control (C2), it also abuses it for data exfiltration, unlike IRRAT.\r\n\r\n\r\nWhat We Already Know- IRRAT\r\nBased on previous reports, we know Telegram's Bot API was already being employed by attackers to steal information ranging from SMS and call history to file listings from infected Android devices. The majority of the apps we saw disguise themselves as an app that tells you how many views your Telegram profile received \u2013 needless to say, the information provided is inaccurate as Telegram doesn\u2019t allow for populating any such information.\r\nWe continue to see IRRAT active in the wild to this date.\r\nWe used the below sample for this analysis.\r\n\r\n\r\n\r\nSHA256\r\n1d0770ac48f8661a5d1595538c60710f886c254205b8cf517e118c94b256137d\r\n\r\n\r\n\r\nTeleRAT works by creating and then populating the following files on the phone\u2019s SD Card and sending them to the upload server, after the app\u2019s first launch:\r\n\r\n \t\u201c[IMEI] numbers.txt\u201d: Contact information\r\n \t\u201c[IMEI]acc.txt\u201d: List of Google accounts registered on the phone\r\n \t\u201c[IMEI]sms.txt\u201d: SMS history\r\n \t1.jpg: Picture taken with the front-facing camera\r\n \tImage.jpg: Picture taken with back-facing camera\r\n\r\nFinally, it reports back to a Telegram bot (identified by a bot ID hardcoded in each RAT\u2019s source code) with the below beacon, and the application icon is then hidden from the phone's app menu:\r\nhxxp:\/\/api.telegram.org\/bot[APIKey]\/sendmessage?chat_id=[ChatID]?text=\u0646\u0635\u0628 \u062c\u062f\u06cc\u062f\\n [IMEI] \\nIMEI : :[IMEI]\\nAndroid ID : [AndroidID]\\nModel : [PhoneModel]\\n[IP] \\n\\nIMEI \u062f\u0633\u062a\u06af\u0627\u0647: [IMEI]\r\nIn the background, the app continues to beacon to the Telegram bot at regular intervals and listens for certain commands, as detailed below.\r\n\r\n\r\n\r\nCommand\r\nAction\r\nCommunication to Telegram bot \r\n\r\n\r\ncall@[IMEI]@[Number]\r\nPlaces a call to [Number]\r\nhxxps:\/\/api.telegram.org\/bot[APIKey]\/sendmessage?chat_id=[ChatID]&amp;text=call with [Number]\r\n\r\n\r\nsms@[IMEI]@[Number]@[Text]\r\nSMS [Text] to [Number]\r\nhxxps:\/\/api.telegram.org\/bot[APIKey] \/sendmessage?chat_id=[ChatID]&amp;text=sent\r\n\r\n\r\ngetapps@[IMEI]\r\nSaves a list of installed apps to SD Card to file named\u00a0 \u201c[IMEI] apps.txt\", uploads to upload server\r\nNone\r\n\r\n\r\ngetfiles@[IMEI]@[DirPath]\r\nRetrieves file listing from [DirPath], saves to SD Card as \u201c[IMEI]files.txt\u201d, uploads to server\r\nNone\r\n\r\n\r\ngetloc@[IMEI]\r\nStarts a GPS listener that monitors location changes\r\nNone\r\n\r\n\r\nupload@[IMEI]@[FilePath]\r\nUploads file at [FilePath]\r\nNone\r\n\r\n\r\nremoveA@[IMEI]@[FilePath on SDCard]\r\nDeletes file at [FilePath on SDCard]\r\nhttps:\/\/api.telegram.org\/bot[APIKey]\/sendmessage?chat_id=[ChatID]&amp;text= ______________[FilePath on SDCard]\r\n\r\n\r\nremoveB@[IMEI]@[DirPath on SDCard]\r\nDeletes [DirPath on SDCard]\r\nNone\r\n\r\n\r\nlstmsg@[IMEI]\r\nSaves SMS history to SD Card as \u201d[IMEI]lstmsg.txt\u201d, uploads to server\r\nNone\r\n\r\n\r\nyehoo@[IMEI]\r\nTakes a picture with Front Camera, saves to SD Card as \u201cyahoo.jpg\u201d, uploads to server\r\nNone\r\n\r\n\r\n\r\n\r\nTable 1: List of IRRAT bot commands\r\n\r\nAs the table above shows, this IRRAT sample makes use of Telegram's bot API solely to communicate commands to infected devices. The stolen data is uploaded to third party servers, several of which employ a webhosting service. Fortunately for us, these servers had several OPSEC fails. More on that further below.\r\n\r\nA New Family- TeleRAT\r\nWhile sifting through IRRAT samples, using AutoFocus, we came across another family of Android RATs seemingly originating from and\/or targeting individuals in Iran that not only makes use of the Telegram API for C2 but also for exfiltrating stolen information.\r\n\r\nFigure 1: pivoting in autofocus for applications using the Telegram bot API\r\n\r\nWe named this new family \u201cTeleRAT\u201d after one of the files it creates on infected devices.\r\nWe used the below sample for this analysis.\r\n\r\n\r\n\r\nSHA256\r\n01fef43c059d6b37be7faf47a08eccbf76cf7f050a7340ac2cae11942f27eb1d\r\n\r\n\r\n\r\nPost-installation TeleRAT creates two files in the app\u2019s internal directory:\r\n\r\n \ttelerat2.txt containing a slew of information about the device - including the System Bootloader version number, total and available Internal and External memory size, and number of cores.\r\n \tthisapk_slm.txt mentioning a Telegram channel and a list of commands. We investigate this Telegram channel is greater detail further below.\r\n\r\nThe RAT announces its successful installation to the attackers by sending a message to a Telegram bot via the Telegram Bot API with the current date and time.\r\nMore interestingly, it starts a service that listens for changes made to the Clipboard in the background.\r\n\r\n\r\nFigure 2: Code snippet that listens for clipboard changes\r\n\r\nFinally, the app fetches updates from the Telegram bot API every 4.6 second, listening for the following commands (we used Google Translate for the below Farsi (Persian) translations):\r\n\u00a0\r\n\r\n\r\n\r\nCommand\r\nTranslation\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u0645\u062e\u0627\u0637\u0628\u06cc\u0646\r\nGet contacts\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u06a9\u0644\u06cc\u067e \u0628\u0648\u0631\u062f\r\nGet the clipboard\r\n\r\n\r\nClipboard set:[text]\r\n\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u0645\u06a9\u0627\u0646\r\nGet location\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0634\u0627\u0631\u0698\r\nReceive charging information\r\n\r\n\r\nAll file list:\/[path]\r\n\r\n\r\n\r\nRoot file list:\/[path]\r\n\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u0628\u0631\u0646\u0627\u0645\u0647 \u0647\u0627\r\nGet apps\r\n\r\n\r\n1Downloadfile\/[filename]\r\n\r\n\r\n\r\n2Downloadfile\/[filename]\r\n\r\n\r\n\r\nCreateContact\/[name]\/[number]\r\n\r\n\r\n\r\nSetWallpaper http[URL]\r\n\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u067e\u06cc\u0627\u0645 \u0647\u0627\r\nReceive (SMS) messages\r\n\r\n\r\nSendsmsfor\/[destination]\/[text]\r\n\r\n\r\n\r\nMessageShow[text]\r\n\r\n\r\n\r\n\u06af\u0631\u0641\u062a\u0646 \u0639\u06a9\u06331\r\nTake photo 1 (front camera)\r\n\r\n\r\n\u06af\u0631\u0641\u062a\u0646 \u0639\u06a9\u06332\r\nTake photo 2 (back camera)\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u0648\u0636\u0639\u06cc\u062a\r\nGet status\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u062a\u0645\u0627\u0633 \u0647\u0627\r\nReceive calls\r\n\r\n\r\nDeleteDir[dirname]\r\n\r\n\r\n\r\n\u0633\u0627\u06cc\u0644\u0646\u062a\r\nSilent (set to Vibrate mode)\r\n\r\n\r\n\u0635\u062f\u0627\u062f\u0627\u0631\r\nLoud (set to normal Ringer mode)\r\n\r\n\r\n\u0628\u06cc\u0635\u062f\u0627\r\nSilent (set to Silent mode)\r\n\r\n\r\nBlacksc\r\nBlacks out phone screen\r\n\r\n\r\nBlackscf\r\nClears black screen\r\n\r\n\r\n\u0636\u0628\u0637 \u0641\u06cc\u0644\u0645\r\nAudio recording (saves recorded audio to AUDIO123\/MUSIC\/rec123.m4a on SD Card)\r\n\r\n\r\n\u062a\u0648\u0642\u0641 \u0636\u0628\u0637 \u0641\u06cc\u0644\u0645\r\nStop audio recording\r\n\r\n\r\n\u0631\u0627\u0647\u0646\u0645\u0627\u06cc \u062f\u0633\u062a\u0648\u0631\u0627\u062a\r\nInstruction manual (Help Menu)\r\n\r\n\r\ncall to [number]\r\n\r\n\r\n\r\nRESET\r\n(deletes thisapk_slm.txt and sends a new registration message to Telegram bot)\r\n\r\n\r\n\u062f\u0631\u06cc\u0627\u0641\u062a \u06af\u0627\u0644\u0631\u06cc\r\nGet gallery (sends files from the \/Dcim folder on the SD Card to Telegram bot)\r\n\r\n\r\nDelete app files or \u062f\u0631\u06cc\u0627\u0641\u062a \u06af\u0627\u0644\u0631\u06cc\r\n\r\n\r\n\r\nVibrate [x]\r\n(Causes phone to vibrate for x seconds, with a maximum value of 600 secs)\r\n\r\n\r\n\u0644\u0631\u0632\u0634 \u06a9\u0645\r\nLow vibration (for a duration of 150 secs)\r\n\r\n\r\n\u0644\u0631\u0632\u0634 \u0645\u062a\u0648\u0633\u0637\r\nMedium vibration (350 secs)\r\n\r\n\r\n\u0644\u0631\u0632\u0634 \u0632\u06cc\u0627\u062f\r\nShake too much (600 secs)\r\n\r\n\r\n\r\n\r\nTable 2: List of TeleRAT bot commands\r\n\r\nAside from additional commands, this new family\u2019s main differentiator to IRRAT is that it also uploads exfiltrated data using Telegram's sendDocument API method.\r\n\r\n\r\nFigure 3: Code snippet showing the use of the SendDocument Telegram bot API method\r\n\r\nTeleRAT is an upgrade from IRRAT in that it eliminates the possibility of network-based detection that is based on traffic to known upload servers, as all communication (including uploads) is done via the Telegram bot API. However, it still leaves other doors open via Telegram's bot API, since the API Keys are hardcoded in the APKs.\r\nThe API allows fetching updates by two means:\r\n1.The getUpdates method: Using this exposes a history of all the commands that were sent to the bot, including usernames from which the commands originated. From the bots that were still responding and had an update history (incoming updates are only kept for 24 hours as per Telegram's policy), we were able to find bot commands originating from four Telegram accounts, shown below.\r\n\r\nFigure 4: Telegram usernames revealed from bot command histories\r\n2.\u00a0Using a Webhook: Telegram allows redirecting all bot updates to a URL specified by means of a Webhook. Their policy limits these Webhooks to HTTPS URLs only. While most of the Webhooks we found used certificates issued by Let\u2019s Encrypt with no specific registrar information, some of them led us back to the world of third party webhosting and open directories. Let\u2019s Encrypt has been notified about this activity.\r\nA sample of only a few Webhooks we found are shown below. hxxps:\/\/mr-mehran[.]tk\/pot\/Bot\/ in particular appears to be hosting close to 6500 bots, however, we can\u2019t confirm whether they\u2019re all used for malicious purposes.\r\n\r\nFigure 5: Webhooks found associated with some TeleRAT bots\r\n\r\nOPSEC Fails, Distribution Channels &amp; Attribution\r\nIn our research we were able find what was clearly an image of the botmaster testing out the RAT, based on the Telegram bot interface that can be seen on the monitor pictured in the lower half of Figure 6.\r\n\r\nFigure 6: Image of botmaster testing out the RAT\r\n\r\nWe were also able to find exfiltrated messages that confirmed our theory about the test run and reveals a thread in Persian Farsi seemingly discussing bot setup.\r\n\u201c\u0635\u0628\u062d \u0633\u0627\u0639\u062a \u06f6 \u0627\u0646\u0644\u0627\u06cc\u0646 \u0634\u0648 \u062a\u0627 \u0631\u0648\u0628\u0627\u062a\u0647 \u0631\u0648 \u0627\u0645\u062a\u062d\u0627\u0646 \u06a9\u0646\u06cc\u0645\u201d\r\nGoogle Translation: \u201cMorning 6 hours online to try the robotage\u201d\r\nWhile investigating attribution for TeleRAT, we noticed the developers made no effort to hide their identities in the code. One username is seen in the screenshot below.\r\n\r\n\r\nFigure 7: Telegram channel advertised in source code\r\n\r\nLooking further into the \u2018vahidmail67\u2019 Telegram channel, we found advertisements for applications and builders that ran the entire gamut - from applications that get you likes and followers on Instagram, to ransomware, and even the source code for an unnamed RAT (complete with a video tutorial, shown below).\r\n\r\nFigure 8: Screenshot from a Telegram channel advertising &amp; sharing a RAT source code\r\n\r\nAside from the Telegram channel, while looking for references to certain TeleRAT components we stumbled upon some threads on an Iranian programmers\u2019 forum advertising the sale of a Telegram bot control library. The forum is frequented by some of the developers whose code is heavily reused in a big portion of the TeleRAT samples we came across.\r\n\r\n\r\nFigure 9: Advertisement for sale of a Telegram bot control library\r\n\r\nThe forum goes the extra mile to mention all content is in accordance with Iran's laws. However, it's hard to see any non-malicious use for some of the code advertised there or written by developers that frequent it \u2013 for instance, a service that runs in the background listening for changes to the Clipboard (pictured in the code snippet in Figure 3 further above).\r\n\r\n\r\nFigure 10: Forum Disclaimer\r\n\r\nOverall, TeleRAT pieces together code written by several developers, however, due to freely available source code via Telegram channels and being sold on forums, we can\u2019t point to one single actor commanding either IRRAT or TeleRAT and it appears to be the work of several actors possibly operating inside of Iran.\r\n\r\nVictimology\r\nAs we investigated these RATs, we also started looking at how victims were getting infected. Further investigating, we witnessed several third-party Android application stores distributing seemingly legitimate applications like \"Telegram Finder\", which supposedly helps users locate and communicate with other uses with specific interests, like knitting. Also, we've witnessed several samples distributed and shared via both legitimate and nefarious Iranian Telegram channels.\r\n\r\n\r\nFigure 11: leIranian third-party application store\r\n\r\nLooking closer at the malicious APKs we were able to get an understanding of common application naming conventions and functionality across the board.\r\n\r\n\r\nFigure 12: 'Telegram finder' application\r\n\r\nBased on the samples we analysed, the three most common application names for both IRRATand TeleRAT are:\r\n\r\n\r\n\r\nNative App Name\r\nTranslated App Name\r\n\r\n\r\n\u067e\u0631\u0648\u0641\u0627\u06cc\u0644 \u0686\u06a9\u0631\r\nProfile Cheer\r\n\r\n\r\n\u0628\u0627\u0632\u062f\u06cc\u062f \u06cc\u0627\u0628 \u062a\u0644\u06af\u0631\u0627\u0645\r\nTelegram Finder\r\n\r\n\r\ntelegram hacker\r\nN\/A\r\n\r\n\r\n\r\nAdditionally, there were several malicious APKs disguised as fake VPN software and\/or configuration files, such as \"atom vpn\" and \"vpn for telegram.\r\nThere appears to be a total identified victim count of 2,293 at the time of writing, based on the infrastructure we analysed. There appears to be a rather small range of geographically dispersed victims, with 82% of having Iranian phone numbers.\r\n\r\n\r\n\r\nIran\r\n1894\r\n\r\n\r\nPakistan\r\n10\r\n\r\n\r\nIndia\r\n227\r\n\r\n\r\nAfghanistan\r\n109\r\n\r\n\r\nUnited Kingdom\r\n53\r\n\r\n\r\n\r\nThere may also be additional infrastructure or variants we were unaware of at the time of writing. That said, the number of victims likely residing within Iran far exceeds the victim count for any other country.\r\n\r\nConclusion\r\nPart of dissecting and understanding new threats involve looking closer at already established campaigns and malware variants. This is a perfect example of just that; looking closer at a previously established malware family to better understand it's current and possibly changed capabilities.\r\nWhile malware leveraging the Telegram bot API is not necessarily new, we were able to identify a new family, TeleRAT, hiding entirely behind Telegram's API to evade network-based detection and exfiltrate data. Leveraging intelligence from AutoFocus, accessible attacker infrastructure, and other open source intelligence we were able to paint an accurate picture of an ongoing operation leveraging Telegram's API and targeting users via third party application sites and social media channels.\r\nTaking some basic precautions can help users protect themselves from malicious applications like TeleRAT, such as:\r\n\r\n \tAvoid third-party application stores or sources.\r\n \tDon't allow application sideloading on your device.\r\n \tEnsure the application you are installing is official, regardless of source.\r\n \tClosely review and scrutinize application permission requests prior to installation.\r\n\r\nPalo Alto Networks customers are protected from this threat by:\r\n\r\n \tWildFire detects all TeleRAT and IRRAT files with malicious verdicts.\r\n \tAutoFocus customers can track these samples with the IRRAT and TeleRAT\r\n \tTraps blocks all of the APK files associated with TeleRAT and IRRAT.\r\n\r\nAPPENDIX\r\n\r\n\r\n\r\n\r\nTelegram usernames found commanding IRRAT or TeleRAT\r\n\r\n\r\n\r\nAhmad_ghob\r\n\r\n\r\nMy_LiFe_M_a_H_s_A\r\n\r\n\r\nmmm1230a\r\n\r\n\r\n\r\n&nbsp;\r\n\r\n\r\n\r\n\r\nWebooks\r\n\r\n\r\n\r\nhxxps:\/\/mr-mehran.tk\/pot\/Bot\/robotcreat2_bot\/Bot\/Ejsahahbot\/\r\n\r\n\r\nhxxps:\/\/ib3.ibot24.com\/394083\/\r\n\r\n\r\nhxxps:\/\/rr5.000webhostapp.com\/upload_file.php\r\n\r\n\r\nhxxps:\/\/gold.teleagent.ir\/bnrdehisaz\/index.php\r\n\r\n\r\nhxxps:\/\/shahin-soori.ir\/bots\/rat\/upload_file.php\r\n\r\n\r\nhxxps:\/\/mbosoba.000webhostapp.com\/upload_file.php\r\n\r\n\r\nhxxps:\/\/abolking.000webhostapp.com\/upload_file.php\r\n\r\n\r\nhxxps:\/\/botmohsan-apk.000webhostapp.com\/Bot\/bot.php\r\n\r\n\r\nhxxps:\/\/androydiha.ir\/bot\/Bot\/hackelmi_bot\/index.php\r\n\r\n\r\nhxxps:\/\/hamidhamid954321.000webhostapp.com\/Bot\/bot.php\r\n\r\n\r\nhxxps:\/\/mohsan024024.000webhostapp.com\/upload_file.php\r\n\r\n\r\nhxxps:\/\/09152104574nazimilad.000webhostapp.com\/\u0631\u0628\u0627\u062a \u0633\u0627\u0632\/CreateBotAll.php\r\n\r\n\r\nhxxps:\/\/darkforceteam.000webhostapp.com\/SmartAccounts_Bot\/bots\/Ratjadidebot\/index.php\r\n\r\n\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Ruchna Nigam"},{"@type":"Person","name":"Kyle Wilhoit"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"68486","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=68486' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-68486 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-68486 entry-meta">
			
			
			<span class="post-views-count">46,609</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'68486','like')"><i class="ui ui-2"></i><span class="ml-5">4</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 9</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users%2F+-+TeleRAT%3A+Another+Android+Trojan+Leveraging+Telegram%E2%80%99s+Bot+API+to+Target+Iranian+Users" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users%2F&title=TeleRAT%3A+Another+Android+Trojan+Leveraging+Telegram%E2%80%99s+Bot+API+to+Target+Iranian+Users&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/ruchna-nigam/" title="Posts by Ruchna Nigam" class="author url fn" rel="author">Ruchna Nigam</a> and <a href="https://unit42.paloaltonetworks.com/author/kyle-wilhoit/" title="Posts by Kyle Wilhoit" class="author url fn" rel="author">Kyle Wilhoit</a>        </p>
        <p><time datetime="2018-03-20T20:00:38+00:00">March 20, 2018 at 1:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/android/" rel="tag">Android</a>, <a href="https://unit42.paloaltonetworks.com/tag/iran/" rel="tag">Iran</a>, <a href="https://unit42.paloaltonetworks.com/tag/irrat/" rel="tag">IRRAT</a>, <a href="https://unit42.paloaltonetworks.com/tag/telegrams-bot-api/" rel="tag">Telegram’s Bot API</a>, <a href="https://unit42.paloaltonetworks.com/tag/telerat/" rel="tag">TeleRAT</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><span style="font-size: 18pt;">Summary</span><br />
Telegram Bots are special accounts that do not require an additional phone number to setup and are generally used to enrich Telegram chats with content from external services or to get customized notifications and news. And while Android malware abusing <a href="https://core.telegram.org/bots/api">Telegram&#8217;s Bot API</a> to target Iranian users is not fresh news (the emergence of a Trojan using this method called IRRAT was discussed in<a href="https://news.drweb.com/show/?i=11331&amp;lng=en"> June</a> and <a href="https://blog.avast.com/spyware-targets-iranian-android-users-by-abusing-messaging-app-telegram-bot-api">July</a> 2017), we set out to investigate how these Telegram Bots were being abused to command and control malicious Android applications.</p>
<p>This blog details our findings navigating through some Operational Security (OPSEC) fails while sifting through multiple malicious APK variants abusing Telegram&#8217;s Bot API; including the discovery of a new Trojan we&#8217;ve named “TeleRAT”. TeleRAT not only abuses Telegram&#8217;s Bot API for Command and Control (C2), it also abuses it for data exfiltration, unlike IRRAT.</p>
<p><span style="font-size: 18pt;">What We Already Know- IRRAT</span><br />
Based on previous reports, we know Telegram&#8217;s Bot API was already being employed by attackers to steal information ranging from SMS and call history to file listings from infected Android devices. The majority of the apps we saw disguise themselves as an app that tells you how many views your Telegram profile received – needless to say, the information provided is inaccurate as Telegram doesn’t allow for populating any such information.<br />
We continue to see IRRAT active in the wild to this date.<br />
We used the below sample for this analysis.</p>
<table align="center">
<tbody>
<tr>
<td width="49"><strong>SHA256</strong></td>
<td width="402">1d0770ac48f8661a5d1595538c60710f886c254205b8cf517e118c94b256137d</td>
</tr>
</tbody>
</table>
<p>TeleRAT works by creating and then populating the following files on the phone’s SD Card and sending them to the upload server, after the app’s first launch:</p>
<ul>
<li>“[IMEI] numbers.txt”: Contact information</li>
<li>“[IMEI]acc.txt”: List of Google accounts registered on the phone</li>
<li>“[IMEI]sms.txt”: SMS history</li>
<li>1.jpg: Picture taken with the front-facing camera</li>
<li>Image.jpg: Picture taken with back-facing camera</li>
</ul>
<p>Finally, it reports back to a Telegram bot (identified by a bot ID hardcoded in each RAT’s source code) with the below beacon, and the application icon is then hidden from the phone&#8217;s app menu:</p>
<p style="text-align: left;">hxxp://api.telegram.org/bot[APIKey]/sendmessage?chat_id=[ChatID]?text=نصب جدید\n [IMEI] \nIMEI : :[IMEI]\nAndroid ID : [AndroidID]\nModel : [PhoneModel]\n[IP] \n\nIMEI دستگاه: [IMEI]</p>
<p>In the background, the app continues to beacon to the Telegram bot at regular intervals and listens for certain commands, as detailed below.</p>
<table align="center">
<tbody>
<tr>
<td width="154"><strong>Command</strong></td>
<td width="154"><strong>Action</strong></td>
<td width="154"><strong>Communication to Telegram bot </strong></td>
</tr>
<tr>
<td width="154">call@[IMEI]@[Number]</td>
<td width="154">Places a call to [Number]</td>
<td width="154">hxxps://api.telegram.org/bot[APIKey]/sendmessage?chat_id=[ChatID]&amp;text=call with <em>[Number]</em></td>
</tr>
<tr>
<td width="154">sms@[IMEI]@[Number]@[Text]</td>
<td width="154">SMS [Text] to [Number]</td>
<td width="154">hxxps://api.telegram.org/bot[APIKey] /sendmessage?chat_id=[ChatID]&amp;text=sent</td>
</tr>
<tr>
<td width="154">getapps@[IMEI]</td>
<td width="154">Saves a list of installed apps to SD Card to file named  “[IMEI] apps.txt&#8221;, uploads to upload server</td>
<td width="154">None</td>
</tr>
<tr>
<td width="154">getfiles@[IMEI]@[DirPath]</td>
<td width="154">Retrieves file listing from [DirPath], saves to SD Card as “[IMEI]files.txt”, uploads to server</td>
<td width="154">None</td>
</tr>
<tr>
<td width="154">getloc@[IMEI]</td>
<td width="154">Starts a GPS listener that monitors location changes</td>
<td width="154">None</td>
</tr>
<tr>
<td width="154">upload@[IMEI]@[FilePath]</td>
<td width="154">Uploads file at [FilePath]</td>
<td width="154">None</td>
</tr>
<tr>
<td width="154">removeA@[IMEI]@[FilePath on SDCard]</td>
<td width="154">Deletes file at [FilePath on SDCard]</td>
<td width="154">https://api.telegram.org/bot[APIKey]/sendmessage?chat_id=[ChatID]&amp;text= ______________[FilePath on SDCard]</td>
</tr>
<tr>
<td width="154">removeB@[IMEI]@[DirPath on SDCard]</td>
<td width="154">Deletes [DirPath on SDCard]</td>
<td width="154">None</td>
</tr>
<tr>
<td width="154">lstmsg@[IMEI]</td>
<td width="154">Saves SMS history to SD Card as ”[IMEI]lstmsg.txt”, uploads to server</td>
<td width="154">None</td>
</tr>
<tr>
<td width="154">yehoo@[IMEI]</td>
<td width="154">Takes a picture with Front Camera, saves to SD Card as “yahoo.jpg”, uploads to server</td>
<td width="154">None</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em><br />
Table </em><em>1</em><em>: List of IRRAT bot commands</em></p>
<p>As the table above shows, this IRRAT sample makes use of Telegram&#8217;s bot API solely to communicate commands to infected devices. The stolen data is uploaded to third party servers, several of which employ a webhosting service. Fortunately for us, these servers had several OPSEC fails. More on that further below.</p>
<p><span style="font-size: 18pt;">A New Family- TeleRAT</span><br />
While sifting through IRRAT samples, using AutoFocus, we came across another family of Android RATs seemingly originating from and/or targeting individuals in Iran that not only makes use of the Telegram API for C2 but also for exfiltrating stolen information.<br />
<a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_1.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-68957" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_1.png" alt="Telerat_1" width="600" height="221" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_1.png 940w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_1-900x332.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_1-300x111.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_1-768x284.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_1-370x137.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>
<p style="text-align: center;"><em>Figure </em><em>1</em><em>: pivoting in autofocus for applications using the Telegram bot API</em></p>
<p>We named this new family “TeleRAT” after one of the files it creates on infected devices.<br />
We used the below sample for this analysis.</p>
<table align="center">
<tbody>
<tr>
<td width="49"><strong>SHA256</strong></td>
<td width="402">01fef43c059d6b37be7faf47a08eccbf76cf7f050a7340ac2cae11942f27eb1d</td>
</tr>
</tbody>
</table>
<p>Post-installation TeleRAT creates two files in the app’s internal directory:</p>
<ul>
<li>telerat2.txt containing a slew of information about the device &#8211; including the System Bootloader version number, total and available Internal and External memory size, and number of cores.</li>
<li>thisapk_slm.txt mentioning a Telegram channel and a list of commands. We investigate this Telegram channel is greater detail further below.</li>
</ul>
<p>The RAT announces its successful installation to the attackers by sending a message to a Telegram bot via the Telegram Bot API with the current date and time.<br />
More interestingly, it starts a service that listens for changes made to the Clipboard in the background.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_2.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-68996" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_2.png" alt="Telerat_2" width="600" height="164" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_2.png 1002w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_2-900x246.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_2-300x82.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_2-768x210.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_2-370x101.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>
<p style="text-align: center;"><em>Figure </em><em>2</em><em>: Code snippet that listens for clipboard changes</em></p>
<p>Finally, the app fetches updates from the Telegram bot API every 4.6 second, listening for the following commands (we used Google Translate for the below Farsi (Persian) translations):<br />
<strong> </strong></p>
<table align="center">
<tbody>
<tr>
<td width="0"><strong>Command</strong></td>
<td width="0"><strong>Translation</strong></td>
</tr>
<tr>
<td width="0">دریافت مخاطبین</td>
<td width="0">Get contacts</td>
</tr>
<tr>
<td width="0">دریافت کلیپ بورد</td>
<td width="0">Get the clipboard</td>
</tr>
<tr>
<td width="0">Clipboard set:[text]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">دریافت مکان</td>
<td width="0">Get location</td>
</tr>
<tr>
<td width="0">دریافت اطلاعات شارژ</td>
<td width="0">Receive charging information</td>
</tr>
<tr>
<td width="0">All file list:/[path]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">Root file list:/[path]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">دریافت برنامه ها</td>
<td width="0">Get apps</td>
</tr>
<tr>
<td width="0">1Downloadfile/[filename]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">2Downloadfile/[filename]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">CreateContact/[name]/[number]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">SetWallpaper http[URL]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">دریافت پیام ها</td>
<td width="0">Receive (SMS) messages</td>
</tr>
<tr>
<td width="0">Sendsmsfor/[destination]/[text]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">MessageShow[text]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">گرفتن عکس<strong>1</strong></td>
<td width="0">Take photo 1 (front camera)</td>
</tr>
<tr>
<td width="0">گرفتن عکس<strong>2</strong></td>
<td width="0">Take photo 2 (back camera)</td>
</tr>
<tr>
<td width="0">دریافت وضعیت</td>
<td width="0">Get status</td>
</tr>
<tr>
<td width="0">دریافت تماس ها</td>
<td width="0">Receive calls</td>
</tr>
<tr>
<td width="0">DeleteDir[dirname]</td>
<td width="0"></td>
</tr>
<tr>
<td width="0">سایلنت</td>
<td width="0">Silent (set to Vibrate mode)</td>
</tr>
<tr>
<td width="0">صدادار</td>
<td width="0">Loud (set to normal Ringer mode)</td>
</tr>
<tr>
<td width="0">بیصدا</td>
<td width="0">Silent (set to Silent mode)</td>
</tr>
<tr>
<td width="0">Blacksc</td>
<td width="0">Blacks out phone screen</td>
</tr>
<tr>
<td width="0">Blackscf</td>
<td width="0">Clears black screen</td>
</tr>
<tr>
<td width="0">ضبط فیلم</td>
<td width="0">Audio recording (saves recorded audio to AUDIO123/MUSIC/rec123.m4a on SD Card)</td>
</tr>
<tr>
<td width="0">توقف ضبط فیلم</td>
<td width="0">Stop audio recording</td>
</tr>
<tr>
<td width="0">راهنمای دستورات</td>
<td width="0">Instruction manual (Help Menu)</td>
</tr>
<tr>
<td width="0"><strong>call to [number]</strong></td>
<td width="0"></td>
</tr>
<tr>
<td width="0"><strong>RESET</strong></td>
<td width="0">(deletes thisapk_slm.txt and sends a new registration message to Telegram bot)</td>
</tr>
<tr>
<td width="0">دریافت گالری</td>
<td width="0">Get gallery (sends files from the /Dcim folder on the SD Card to Telegram bot)</td>
</tr>
<tr>
<td width="0"><strong>Delete app files or </strong>دریافت گالری</td>
<td width="0"></td>
</tr>
<tr>
<td width="0"><strong>Vibrate [x]</strong></td>
<td width="0">(Causes phone to vibrate for x seconds, with a maximum value of 600 secs)</td>
</tr>
<tr>
<td width="0">لرزش کم</td>
<td width="0">Low vibration (for a duration of 150 secs)</td>
</tr>
<tr>
<td width="0">لرزش متوسط</td>
<td width="0">Medium vibration (350 secs)</td>
</tr>
<tr>
<td width="0">لرزش زیاد</td>
<td width="0">Shake too much (600 secs)</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em><br />
Table </em><em>2</em><em>: List of TeleRAT bot commands</em></p>
<p>Aside from additional commands, this new family’s main differentiator to IRRAT is that it also uploads exfiltrated data using Telegram&#8217;s <a href="https://core.telegram.org/bots/api#senddocument">sendDocument</a> API method.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-69035" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3.png" alt="Telerat_3" width="600" height="155" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3.png 1038w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3-900x233.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3-300x78.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3-768x199.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3-1024x265.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_3-370x96.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>
<p style="text-align: center;"><em>Figure </em><em>3</em><em>: Code snippet showing the use of the SendDocument Telegram bot API method</em></p>
<p>TeleRAT is an upgrade from IRRAT in that it eliminates the possibility of network-based detection that is based on traffic to known upload servers, as all communication (including uploads) is done via the Telegram bot API. However, it still leaves other doors open via Telegram&#8217;s bot API, since the API Keys are hardcoded in the APKs.<br />
The API allows fetching updates by two means:<br />
1.The <a href="https://core.telegram.org/bots/api#getupdates">getUpdates</a> method: Using this exposes a history of all the commands that were sent to the bot, including usernames from which the commands originated. From the bots that were still responding and had an update history (incoming updates are only kept for 24 hours as per Telegram&#8217;s policy), we were able to find bot commands originating from four Telegram accounts, shown below.<br />
<a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_5.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-69074 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_5.png" alt="Telerat_5" width="750" height="88" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_5.png 750w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_5-300x35.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_5-370x43.png 370w" sizes="(max-width: 750px) 100vw, 750px" /></a></p>
<p style="text-align: center;"><em>Figure </em><em>4</em><em>: Telegram usernames revealed from bot command histories</em></p>
<p style="text-align: left;">2. Using a <a href="https://core.telegram.org/bots/api#setwebhook">Webhook</a>: Telegram allows redirecting all bot updates to a URL specified by means of a Webhook. Their policy limits these Webhooks to HTTPS URLs only. While most of the Webhooks we found used certificates issued by Let’s Encrypt with no specific registrar information, some of them led us back to the world of third party webhosting and open directories. Let’s Encrypt has been notified about this activity.</p>
<p>A sample of only a few Webhooks we found are shown below. hxxps://mr-mehran[.]tk/pot/Bot/ in particular appears to be hosting close to 6500 bots, however, we can’t confirm whether they’re all used for malicious purposes.<br />
<a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_6.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-69113" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_6.png" alt="Telerat_6" width="600" height="189" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_6.png 783w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_6-300x95.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_6-768x242.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_6-370x117.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>
<p style="text-align: center;"><em>Figure 5: Webhooks found associated with some TeleRAT bots</em></p>
<p><span style="font-size: 18pt;">OPSEC Fails, Distribution Channels &amp; Attribution</span><br />
In our research we were able find what was clearly an image of the botmaster testing out the RAT, based on the Telegram bot interface that can be seen on the monitor pictured in the lower half of Figure 6.<br />
<img class="size-full wp-image-69152 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7.png" alt="Telerat_7" width="348" height="622" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7.png 348w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7-168x300.png 168w" sizes="(max-width: 348px) 100vw, 348px" /></p>
<p style="text-align: center;"><em>Figure</em> <em>6: Image of botmaster testing out the RAT</em></p>
<p>We were also able to find exfiltrated messages that confirmed our theory about the test run and reveals a thread in Persian Farsi seemingly discussing bot setup.<br />
“صبح ساعت ۶ انلاین شو تا روباته رو امتحان کنیم”<br />
Google Translation: “<em>Morning 6 hours online to try the robotage</em>”<br />
While investigating attribution for TeleRAT, we noticed the developers made no effort to hide their identities in the code. One username is seen in the screenshot below.</p>
<p><img class="aligncenter wp-image-69386" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7_real.png" alt="Telerat_7_real" width="600" height="28" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7_real.png 1047w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7_real-900x42.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7_real-300x14.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7_real-768x36.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7_real-1024x48.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_7_real-370x17.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 7: Telegram channel advertised in source code</em></p>
<p>Looking further into the ‘vahidmail67’ Telegram channel, we found advertisements for applications and builders that ran the entire gamut &#8211; from applications that get you likes and followers on Instagram, to ransomware, and even the source code for an unnamed RAT (complete with a video tutorial, shown below).<br />
<img class="aligncenter wp-image-69191" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_8.png" alt="Telerat_8" width="600" height="578" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_8.png 750w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_8-300x289.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_8-370x356.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 8: Screenshot from a Telegram channel advertising &amp; sharing a RAT source code</em></p>
<p>Aside from the Telegram channel, while looking for references to certain TeleRAT components we stumbled upon <a href="https://learn-net.ir/forums/topic/5901-استفاده-از-کتابخانه-tp_getupdate-در-سرویس/">some</a> <a href="https://learn-net.ir/forums/topic/5360-سورس-همگام-سازی-دیتابیس-آفلاین-با-پست-های-کانال-تلگرام/">threads</a> on an Iranian programmers’ forum advertising the <a href="https://learn-net.ir/store/product/9-کتابخانه-کنترل-ربات-تلگرام-برای-بیسیک-فور-اندروید/">sale</a> of a Telegram bot control library. The forum is frequented by some of the developers whose code is heavily reused in a big portion of the TeleRAT samples we came across.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_9.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-69230" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_9.png" alt="Telerat_9" width="600" height="350" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_9.png 947w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_9-900x525.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_9-300x175.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_9-768x448.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_9-370x216.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>
<p style="text-align: center;"><em>Figure 9: Advertisement for sale of a Telegram bot control library</em></p>
<p>The forum goes the extra mile to mention all content is in accordance with Iran&#8217;s laws. However, it&#8217;s hard to see any non-malicious use for some of the code advertised there or written by developers that frequent it – for instance, a service that runs in the background listening for changes to the Clipboard (pictured in the code snippet in Figure 3 further above).</p>
<p><img class="aligncenter wp-image-69269" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_10.png" alt="Telerat_10" width="600" height="94" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_10.png 750w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_10-300x47.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_10-370x58.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 10: Forum Disclaimer</em></p>
<p>Overall, TeleRAT pieces together code written by several developers, however, due to freely available source code via Telegram channels and being sold on forums, we can’t point to one single actor commanding either IRRAT or TeleRAT and it appears to be the work of several actors possibly operating inside of Iran.</p>
<p><span style="font-size: 18pt;">Victimology</span><br />
As we investigated these RATs, we also started looking at how victims were getting infected. Further investigating, we witnessed several third-party Android application stores distributing seemingly legitimate applications like &#8220;Telegram Finder&#8221;, which supposedly helps users locate and communicate with other uses with specific interests, like knitting. Also, we&#8217;ve witnessed several samples distributed and shared via both legitimate and nefarious Iranian Telegram channels.</p>
<p><img class="aligncenter wp-image-69308" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_11.png" alt="Telerat_11" width="600" height="316" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_11.png 854w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_11-300x158.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_11-768x405.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_11-370x195.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 11: leIranian third-party application store</em></p>
<p>Looking closer at the malicious APKs we were able to get an understanding of common application naming conventions and functionality across the board.</p>
<p><img class="aligncenter wp-image-69347" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_12.png" alt="Telerat_12" width="300" height="477" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_12.png 472w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_12-189x300.png 189w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/03/Telerat_12-370x588.png 370w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p style="text-align: center;"><em>Figure 12: &#8216;Telegram finder&#8217; application</em></p>
<p>Based on the samples we analysed, the three most common application names for both IRRATand TeleRAT are:</p>
<table align="center">
<tbody>
<tr>
<td width="118"><strong>Native App Name</strong></td>
<td width="0"><strong>Translated App Name</strong></td>
</tr>
<tr>
<td width="118"><strong>پروفا</strong><strong>یل</strong><strong> چکر</strong></td>
<td width="0">Profile Cheer</td>
</tr>
<tr>
<td width="118"><strong>بازد</strong><strong>ید</strong> <strong>یاب</strong><strong> تلگرام</strong></td>
<td width="0">Telegram Finder</td>
</tr>
<tr>
<td width="118">telegram hacker</td>
<td width="0">N/A</td>
</tr>
</tbody>
</table>
<p>Additionally, there were several malicious APKs disguised as fake VPN software and/or configuration files, such as &#8220;atom vpn&#8221; and &#8220;vpn for telegram.<br />
There appears to be a total identified victim count of 2,293 at the time of writing, based on the infrastructure we analysed. There appears to be a rather small range of geographically dispersed victims, with 82% of having Iranian phone numbers.</p>
<table align="center">
<tbody>
<tr>
<td width="117">Iran</td>
<td width="64">1894</td>
</tr>
<tr>
<td width="117">Pakistan</td>
<td width="64">10</td>
</tr>
<tr>
<td width="117">India</td>
<td width="64">227</td>
</tr>
<tr>
<td width="117">Afghanistan</td>
<td width="64">109</td>
</tr>
<tr>
<td width="117">United Kingdom</td>
<td width="64">53</td>
</tr>
</tbody>
</table>
<p>There may also be additional infrastructure or variants we were unaware of at the time of writing. That said, the number of victims likely residing within Iran far exceeds the victim count for any other country.</p>
<p><span style="font-size: 18pt;">Conclusion</span><br />
Part of dissecting and understanding new threats involve looking closer at already established campaigns and malware variants. This is a perfect example of just that; looking closer at a previously established malware family to better understand it&#8217;s current and possibly changed capabilities.<br />
While malware leveraging the Telegram bot API is not necessarily new, we were able to identify a new family, TeleRAT, hiding entirely behind Telegram&#8217;s API to evade network-based detection and exfiltrate data. Leveraging intelligence from AutoFocus, accessible attacker infrastructure, and other open source intelligence we were able to paint an accurate picture of an ongoing operation leveraging Telegram&#8217;s API and targeting users via third party application sites and social media channels.<br />
Taking some basic precautions can help users protect themselves from malicious applications like TeleRAT, such as:</p>
<ul>
<li>Avoid third-party application stores or sources.</li>
<li>Don&#8217;t allow application sideloading on your device.</li>
<li>Ensure the application you are installing is official, regardless of source.</li>
<li>Closely review and scrutinize application permission requests prior to installation.</li>
</ul>
<p>Palo Alto Networks customers are protected from this threat by:</p>
<ol>
<li>WildFire detects all TeleRAT and IRRAT files with malicious verdicts.</li>
<li>AutoFocus customers can track these samples with the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.IRRAT">IRRAT</a> and <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.TeleRAT">TeleRAT</a></li>
<li>Traps blocks all of the APK files associated with TeleRAT and IRRAT.</li>
</ol>
<p><span style="font-size: 18pt;">APPENDIX</span></p>
<table>
<tbody>
<tr>
<td width="451">
<h4>Telegram usernames found commanding IRRAT or TeleRAT</h4>
</td>
</tr>
<tr>
<td width="451">Ahmad_ghob</td>
</tr>
<tr>
<td width="451">My_LiFe_M_a_H_s_A</td>
</tr>
<tr>
<td width="451">mmm1230a</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<td width="451">
<h4>Webooks</h4>
</td>
</tr>
<tr>
<td width="451">hxxps://mr-mehran.tk/pot/Bot/robotcreat2_bot/Bot/Ejsahahbot/</td>
</tr>
<tr>
<td width="451">hxxps://ib3.ibot24.com/394083/</td>
</tr>
<tr>
<td width="451">hxxps://rr5.000webhostapp.com/upload_file.php</td>
</tr>
<tr>
<td width="451">hxxps://gold.teleagent.ir/bnrdehisaz/index.php</td>
</tr>
<tr>
<td width="451">hxxps://shahin-soori.ir/bots/rat/upload_file.php</td>
</tr>
<tr>
<td width="451">hxxps://mbosoba.000webhostapp.com/upload_file.php</td>
</tr>
<tr>
<td width="451">hxxps://abolking.000webhostapp.com/upload_file.php</td>
</tr>
<tr>
<td width="451">hxxps://botmohsan-apk.000webhostapp.com/Bot/bot.php</td>
</tr>
<tr>
<td width="451">hxxps://androydiha.ir/bot/Bot/hackelmi_bot/index.php</td>
</tr>
<tr>
<td width="451">hxxps://hamidhamid954321.000webhostapp.com/Bot/bot.php</td>
</tr>
<tr>
<td width="451">hxxps://mohsan024024.000webhostapp.com/upload_file.php</td>
</tr>
<tr>
<td width="451">hxxps://09152104574nazimilad.000webhostapp.com/ربات ساز/CreateBotAll.php</td>
</tr>
<tr>
<td width="451">hxxps://darkforceteam.000webhostapp.com/SmartAccounts_Bot/bots/Ratjadidebot/index.php</td>
</tr>
</tbody>
</table>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
