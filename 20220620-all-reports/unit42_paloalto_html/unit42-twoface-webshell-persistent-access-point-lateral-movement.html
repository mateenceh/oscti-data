
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>TwoFace Webshell: Persistent Access Point for Lateral Movement</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-twoface-webshell-persistent-access-point-lateral-movement/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 uncovers TwoFace: a two-layered webshell used to remotely access the network of a targetd organization in the Middle East."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-twoface-webshell-persistent-access-point-lateral-movement/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="TwoFace Webshell: Persistent Access Point for Lateral Movement" />
<meta property="og:description" content="Unit 42 uncovers TwoFace: a two-layered webshell used to remotely access the network of a targetd organization in the Middle East." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-twoface-webshell-persistent-access-point-lateral-movement/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Mimikatz" />
<meta property="article:tag" content="TwoFace" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-07-31T02:00:12+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:54:33+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:54:33+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 uncovers TwoFace: a two-layered webshell used to remotely access the network of a targetd organization in the Middle East." />
<meta name="twitter:title" content="TwoFace Webshell: Persistent Access Point for Lateral Movement" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; TwoFace Webshell: Persistent Access Point for Lateral Movement Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-twoface-webshell-persistent-access-point-lateral-movement/feed/" />
<meta property="og:likes" content="2"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="29,755"/>
<meta property="og:date_created" content="July 31, 2017 at 5:00 AM"/>
<meta property="og:post_length" content="3863"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:author" content="Bryan Lee"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bryanlee/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"TwoFace Webshell: Persistent Access Point for Lateral Movement","name":"TwoFace Webshell: Persistent Access Point for Lateral Movement","description":"Unit 42 uncovers TwoFace: a two-layered webshell used to remotely access the network of a targetd organization in the Middle East. ","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-twoface-webshell-persistent-access-point-lateral-movement\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-twoface-webshell-persistent-access-point-lateral-movement\/","datePublished":"July 31, 2017","articleBody":"While investigating a recent security incident, Unit 42 found a webshell that we believe was used by the threat actor to remotely access the network of a targeted Middle Eastern organization. The construction of the webshell was interesting by itself, as it was actually two separate webshells: an initial webshell that was responsible for saving and loading the second fully functional webshell. It is this second webshell that enabled the threat actor to run a variety of commands on the compromised server. Due to these two layers, we use the name TwoFace to track this webshell.\n\nDuring our analysis, we extracted the commands executed by the TwoFace webshell from the server logs on the compromised server. Our analysis shows that the commands issued by the threat actor date back to June 2016; this suggests that the actor had access to this shell for almost an entire year. The commands issued show the actor was interested in gathering credentials from the compromised server using the Mimikatz tool. We also saw the attacker using the TwoFace webshell to move laterally through the network by copying itself and other webshells to other servers.\nActor Activities using TwoFace\nThe web server logs on the system we examined that was compromised with the TwoFace shell gave us a glimpse into the commands the actor executed through their malware. These commands also enabled us to create a profile of the actor, specifically their intentions and the tools and techniques used to carry out their operation.\n\nOur analysis determined that five different IP addresses from four countries issued commands on the TwoFace shell, as seen in Table 1. As it is possible these originating IP address may themselves have been targeted and compromised, we have redacted the full IP addresses to hide the identities. The first command in the logs was issued on June 18, 2016, which was a simple \u201cwhoami\u201d command to get the username on the server. This single command was the only one by this specific IP address which appears to be in Iran, and suggests that the actor may have initially compromised the server around this time and performed a quick check to see if the shell was loaded successfully.\n\n\n\nIP address\nCountry\nNumber of Commands\nDate of Activity\nDays Since Initial Command\n\n\n46.38.x.x\nIran\n1\n2016-06-18\n0\n\n\n178.32.x.x\nFrance\n6\n2016-09-28\n103\n\n\n137.74.x.x\nFrance\n16\n2017-03-03\n259\n\n\n192.155.x.x\nUSA\n61\n2017-04-24\n311\n\n\n46.4.x.x\nGermany\n10\n2017-05-03\n320\n\n\n\nTable 1 IP Addresses seen issuing TwoFace Commands\n\nThree months after this single, initial command the next set of commands were sent. This time on September 28, 2016 a series of twelve commands were sent from an IP address apparently in France. These commands provide additional insight into the actor\u2019s intentions. It is not certain why a time gap exists in issuing commands to the TwoFace webshell, although it is highly plausible this may simply be a visibility gap or even anti-detection measure taken by the actor. Rather than speculating on this gap and subsequent time gaps between interactions, we will focus on the commands actor issued that provide insight into this actor\u2019s tactics, techniques, and procedures (TTPs).\n\nThe first command issued from this second IP address attempts to run a variant of the Mimikatz post-exploitation tool (m64.exe), specifically the Sekurlsa module that gathers the passwords of accounts currently logged into the system and saves the results locally to a text file. The actor then issues a command that uses the \u201ctype\u201d command to read the contents of the text file containing the passwords, followed by a command that uses \u201cdel\u201d to delete the text file.\n\nc:\\windows\\temp\\m64.exe privilege::debug sekurlsa::logonpasswords exit &gt; c:\\windows\\temp\\01.txt\n\nJust over five months later on March 3, 2017, a third IP address, a different one apparently in France, issued a series of 16 commands to the TwoFace webshell. The first command of interest is as follows:\n\nnet group \"Exchange Trusted Subsystem\" \/domain\n\nAccording to MSDN, the \u201cExchange Trusted Subsystem\u201d group is defined as follows:\nThe \u201cExchange Trusted Subsystem\u201d is a highly privileged universal security group (USG) that has read\/write access to every Exchange-related object in the Exchange organization. It\u2019s also a member of the Administrators local security group and the Exchange Windows Permissions USG, which enables Exchange to create and manage Active Directory objects.\nUsing hostnames obtained from the previous command, the actor issues several commands to determine if they have access to Microsoft Exchange related folders. The actor then issued several commands that attempt to copy a different webshell onto these additional systems, which resembles the following:\n\ncopy c:\\windows\\temp\\Exchange.aspx \"\\\\[hostname]\\d$\\Program Files\\Microsoft\\Exchange Server\\V14\\ClientAccess\\exchweb\\ews\\\"\n\nThis clearly shows the threat actor attempting to use the TwoFace webshell to pivot to other servers on the network. The \u201cExchange.aspx\u201d file copied over to the other systems appears to be a different webshell from TwoFace. We analyzed this additional webshell and have named it IntrudingDivisor, which we will describe in detail later in this blog.\n\nOn April 24, 2017, a fourth IP address, this one apparently in the United States, issued 61 commands to the TwoFace webshell. Like the previous set of commands issued in March 2017 from France, this IP address issued the command to obtain objects in the Exchange Trusted Subsystem group, and it appears the actor copied over yet another webshell named \u201cglobal.aspx\u201d and set the file\u2019s attributes to be hidden using the following command:\n\nattrib h \"\\\\[hostname]\\d$\\Program Files\\Microsoft\\Exchange Server\\V14\\ClientAccess\\exchweb\\ews\\global.aspx\"\n\nThe actor then issued commands that suggests the use of the Mimikatz tool, but this time Mimikatz was named \u201cmom64.exe\u201d instead of \u201cm64.exe\u201d. The following two commands show the actor killing the process and using the \u201ctype\u201d command to read the contents of a text file \u201c01.txt,\u201d which was also used in the password gathering activity observed on the day of the initial compromise on Jun 2016, ten months earlier:\n\ntaskkill \/f \/im mom64.exe\ntype c:\\windows\\temp\\01.txt\n\nNine days later on May 3, 2017 the next commands came from a fifth IP address apparently in Germany. This time the threat actors issued 10 commands to the TwoFace webshell: fewer than nine days before but still more than during the other sessions.\n\nThe actor first issues a command to ping the IP address \u201c4.2.2.4\u201d, which is the legitimate DNS resolver operated by Level 3. The actor then checks the \u201cDomain Admins\u201d group to determine the accounts with domain administrator privileges using the following command:\n\nnet group \"Domain admins\" \/domain\n\nAfter this command, the actor runs a variant of the Mimikatz tool to gather locally logged in passwords, this time using a filename of \u201cMicrosoftUpdate.exe\u201d for the executable and \u201cmic.txt\u201d to store the results, as seen in the following command:\n\nc:\\windows\\temp\\MicrosoftUpdate.exe p::d s::l q &gt; c:\\windows\\temp\\mic.txt\n\nThese commands show the threat actors rely heavily on the TwoFace webshell to interact with compromised servers, but it also appears that other webshells are used in addition to TwoFace, such as IntrudingDivisor. The commands also show the threat actor\u2019s reliance on the Mimikatz tool to steal passwords from systems, which they will then use to attempt to move laterally amongst other servers by copying over webshells. Lastly, the timestamps of the commands suggest that the threat actor had maintained persistent access that they used intermittently to the compromised network using the TwoFace shell since at least June 2016.\nTwoFace Loader Shell\nBoth components of the TwoFace shell, which we will refer to as the loader and payload components were written in C# and meant to run on a webserver that supports ASP.NET. The author of the initial loader webshell included legitimate and expected content that will be displayed if a visitor accesses the shell in a browser. The inclusion of expected content suggests that the actors wished to use the TwoFace webshell for extended periods while remaining hidden.\n\nThe code in the loader webshell includes obfuscated variable names and the embedded payload is encoded and encrypted. To interact with the loader webshell, the threat actor uses HTTP POST requests to the compromised server. As its name suggests, the loader component is mainly responsible for saving and loading the payload component on the same server, allowing the actor to interact with the payload component that has far more functionality than the loader. However, the loader is also capable of the following functionality:\n\n \tSave the TwoFace payload to a specified file on the server\n \tDelete the TwoFace payload saved on the server\n \tWrite data to a specified file on the server\n \tDelete the entire folder on the server used to store the TwoFace payload\n\nThe TwoFace loader parses the HTTP POST requests issued by the actor and references data at specific locations, more specifically at certain indexes within the posted data (C# \u201cRequest.Forms\u201d) that the shell will use to determine the functionality the actor wishes to execute. While we did not have logs of HTTP requests for the loader shell, we were able to determine some of the indexes that the webshell will specifically access within the data. Table 2 shows the known indexes within the HTTP POST data that TwoFace references.\n\n\n\nRequest.Forms Index\nDescription\n\n\n0\nIf set to a specific value (for example, \"931201\"), it creates a set of \"pre\" html tags with a string of numbers for reasons unknown.\n\n\n5\nData to write to a file on the server\n\n\n8\nString name for the TwoFace webshell filename\n\n\n9\nContains base64 data provided by the actor to specify the command to run, as well as the decryption key in the event the actor wishes to load the webshell\n\n\n\nTable 2 Indexes within Request.Forms that the TwoFace loader relies on\n\nAs you can see in the descriptions in Table 2, none of these locations contain the command that the actor wishes to execute. Instead, the actor must provide data in index 9 that was constructed to not only contain the command the actor wants to execute, but also contains the key to decrypt the TwoFace payload component that is embedded within the loader. The data in index 9 will contain data at specific offsets, seen in Table 3 that the loader component will use to determine the command and the location of command specific data within the posted data (C# \u201cRequest.Forms\u201d).\n\n\n\nOffset\nValue\nDescription\n\n\n0\nVaried\nThe entirety of the data is used as a key to decrypt the TwoFace payload component\n\n\n25\n8\nSpecifies the argument in the HTTP POST request that contains the string of the filename for the TwoFace webshell file\n\n\n26\n1000\nMinimum length required to write data to a specified file\n\n\n44\n31\nContains the number of arguments needed to perform a file deletion operation?\n\n\n45\n5\nSpecifies the argument within the POST request that contains the data to write to a file on the server\n\n\n57\n36\nContains the number of arguments within the POST request to run a command to write data to a file on the server\n\n\n61\n13\nContains the number of arguments within the POST request to run a command to install the TwoFace payload webshell\n\n\n63\n14\nContains the number of arguments needed to perform a folder deletion operation?\n\n\n\nTable 3 Offets of actor provided data used by the TwoFace loader\nSaving the TwoFace Payload\nThe main purpose of the loader shell is to install a secondary webshell on demand. The secondary webshell, which we call the payload, is embedded within the loader in encrypted form and contains additional functionality that we will discuss in further detail. When the threat actor wants to interact with the remote server, they provide data that the loader will use to modify a decryption key embedded within the loader that will be in turn used to decrypt the embedded TwoFace payload. The decryption algorithm (below) is very simple, as it relies on basic arithmetic operations, specifically addition and subtraction to decrypt the embedded payload.\nfor(int i = 0; i &lt; key.Length; i++)\n    key[i] += actorProvidedData[i % actorProvidedData.Length];\nfor(int j=0;j&lt;ciphertext.Length;j++)\n    ciphertext[j] -= key[j % key.Length];\n\nThe pseudocode above provides the logic used by the TwoFace loader to decrypt the ciphertext of the payload, which is\n\n \tIterate through the key, modifying each byte by adding a value from the actor\u2019s provided data\n \tIterate through TwoFace payload ciphertext and subtracting each byte using a value from the modified key\n\nWe were able to determine the data that the threat actor would have to provide to successfully decrypt the embedded TwoFace payload, which is as follows:\n\n\\x15@^\\xbbs\\xfa\\xae\\x876\\x03`\\xffs\\x89\\xb9 \\x9a\\xcb\\x02\\xec\\x8e\\xc3\\x92\\x7f\\xd6b\\xa8\\x1ag\\xb8\\xff\\x82\\x08\\xd0ALB\\xd8\\x0c)\\x91\\x82\\xc4\\x85\\xb2\\xa7\\xe6\\xea\\x8e\\x92\\xf9u\\x96\\xc1\\xef\\xfd\\xe9.!\\x047\\xc8#y\n\nAs you can surmise from the above characters, this does not appear to be a human generated string. We believe this is a machine generated string used for this input data, which gives a bit of insight into the actors behind this webshell, as they would have to use a tool to interact with to automate the use of these webshells, or at a minimum they would need to keep track of these machine generated user input strings to be able to interact with their webshells manually.\nTwoFace Payload Shell\nThe TwoFace payload shell requires a password that is sent within HTTP POST data or within the HTTP Cookie, specifically with a field with a name \u201cpwd\u201d. The \u201cpwd\u201d field is used for authentication as a password, which the payload will generate the SHA1 hash and compare it with a hash that is hardcoded within the payload. We extracted the SHA1 hashes used for authentication from the known TwoFace shells, as seen in Table 4 and were able to find the associated password string for three of them. One of the passwords, \u201cRamdanAlKarim12\u201d contains a phrase that means \u201cRamadan the generous\u201d in Arabic (\u0631\u0645\u0636\u0627\u0646 \u0627\u0644\u0643\u0631\u064a\u0645). Another known password is \u201cFreeMe!\u201d, while the last known password contains what may be an acronym of a middle eastern energy organization followed by \u201cpass\u201d. It is possible that the actor chose this acronym based on the targeted organization, but we cannot confirm this.\n\n\n\nSample SHA256\nEmbedded SHA1 Password\n\n\n8f0419493d\u2026\na2c9afd6adac242827adb00d76c20c491b2d2247\n\n\n0a77e28e6d\u2026\n6a0e681586988388d4a0690b6fb686715d92d069\n\n\n54c8bfa0be\u2026\n5e1c37bf3bd8a7567d46db63ed9b0aeed53e57fe\n\n\n818ac924fd\u2026\n37ada887553cf48715cc19131b8e661ac43718e9\n\n\nfd47825d75\u2026\n9789b5c0c13fb58c423bce5577873d413d9494be\n\n\n79c9a2a2b5\u2026\nc56bc0d331a825fdea01c5437877d5e9e1cda2c4\n\n\ne33096ab3\u2026\n9f4e10484f4ceac34878d4f621a1ad8e580fd02a\n\n\nc116f078a0\u2026\n57dd9721f9837ebd24dea55a90a2a9e3e6ad6f1e\n\n\n\nTable 4 Authentication hashes and matching password strings used for TwoFace webshells\n\nMuch like the authentication password, a threat actor can issue commands to the TwoFace payload using either data sent within the HTTP Cookie or HTTP POST data itself. If using an HTTP Cookie to issue commands, the payload will split the cookie data using the delimiter \u201c#=#\u201d and will treat the first value as the command and the second value the data to pass to the command. We enumerated the command handler, which can be seen in Table 5 that accepts a variety of commands to interact with the compromised server.\n\n\n\nCommand\nArg Field\nDescription\n\n\nExecute application or command\npro\nExecutable to run command line commands\n\n\ncmd\nRuns a supplied command using \u201ccmd.exe\u201d or another executable supplied by the user via the \u201cpro\u201d field within the HTTP POST data.\n\n\nUpload a file to the server\nupl\nField name within the HTTP POST files that contains the file contents to save to the server\n\n\nsav\nPath to save file to\n\n\nvir\nBoolean to save a file to a virtual path rather than a physical path\n\n\nnen\nSpecified name of file to upload, otherwise the script uses the filename of the uploaded file from the HTTP POST request\n\n\nUpload data to a file in the %TEMP% folder\nupb\nBase64 encoded data that is decoded and saved to a file\n\n\nupd\nFilename in the %TEMP% folder to save \u2018upb\u2019 data to\n\n\nDelete a file in %TEMP% folder\ndel\nFilename in the %TEMP% folder to delete\n\n\nDownload a file from the server\ndon\nPath to file to download from the server\n\n\nView or set MAC timestamps of a file\nhid\n1 = View the \u2018tfil\u2019 MAC times\n\n2 = Set \u2018tfil\u2019 file MAC times to match the file specified in the \u2018ttar\u2019 field\n\n3 = Set \u2018tfil\u2019 file MAC times to times specified in the \u2018ttim\u2019 field\n\n\ntfil\nFilename to get or set MAC times\n\n\nttar\nFilename to get MAC times, most likely a legitimate filename used to make uploaded files look as if they are legitimate\n\n\nttim\nSpecific timestamp to set file MAC times to\n\n\n\nTable 5 Commands available within the TwoFace payload webshell\n\nWhile the commands within Table 5 are available within TwoFace, the threat actor does not have to manually issue these requests within HTTP POST data, as the actor can interact with the webshell using a web form within the browser. We set up an IIS server to test the TwoFace webshell, which displays the user-interface seen in Figure 1.\n\n\n\nFigure 1 TwoFace payload webshell before authentication\n\nAt first, the text box in the row labeled \u201cLogin\u201d has a red background, which means the user has not successfully provided the password required to issue commands to the webshell. After entering the correct password in the login box, the box changes from a red to green background, as seen in Figure 2. The actor can now interact with the compromised server using the webshell, which runs the commands described in Table 5. In most cases, the output or results of commands are displayed immediately below the webshell. For instance, in Figure 2 we issued the \u201cwhoami\u201d command that used the Windows command-prompt to display the name of the current user account below the webshell.\n\n\n\nFigure 2 Issuing a command on TwoFace webshell after successfully authenticating\nTwoFace++ Loader\nWe discovered another version of the TwoFace loader shell that was structurally similar to the TwoFace loader shell discussed in this blog, as this version of TwoFace also contains an embedded payload shell in encrypted form. To use the embedded payload shell, the actor must provide a password that the loader shell will not only use for authentication, but also as a key to decrypt the payload.\n\nThe actor will provide the password in the HTTP POST data, specifically as a base64 encoded string within a field labeled \u201cp\u201d. The TwoFace++ loader will decode this password and concatenate a static salt value and compute the SHA1 hash of this string. The loader then base64 encodes the SHA1 hash and compares it with a hardcoded base64 encoded string of a SHA1 hash needed for successful authentication. We know of the SHA1 hashes 19be2493b7cc2d43e8bf245b6faf2c747be6bae5 and 26749c6b5308bb668eb954f4120607c2a9d620be used for authentication, however, we have been unable to determine the passwords that would result in these hashes.\n\nThe TwoFace++ loader will use the actor provided password as a decryption key to decrypt the embedded payload shell. The loader will use the first 24 bytes of the actor\u2019s password as a key, which it will use the 3DES symmetric cipher to decrypt the payload shell. The embedded payload is 8624 bytes, which we believe is another webshell based on the previous version of the TwoFace loader, however, we have been unable to decrypt the payload to confirm.\nIntrudingDivisor Webshell\nOur analysis of the commands issued to the TwoFace webshell resulted in the discovery of another webshell that we call IntrudingDivisor. Like TwoFace, the IntrudingDivisor webshell requires the threat actor to authenticate before issuing commands. To authenticate, the actor must provide two pieces of information, first an integer that is divisible by 5473 and a string whose MD5 hash is \u201c9A26A0E7B88940DAA84FC4D5E6C61AD0\u201d. Upon successful authentication, the webshell has a command handler that uses integers within the request to determine the command to execute, specifically integers divisible by the following:\n\n\n\nDivisor\nCommand\n\n\n6571\nWrite provided data to a specified file\n\n\n9273\nExecute a command or change the modified and access times of a file\n\n\n3471\nRead a specified file\n\n\n\nTable 6 Commands available within the IntrudingDivisor webshell\n\nThe webshell logs the IP, user-agent, and timestamp of all requests to a file named \"KB45253-ENU.exe\u201d, but we have seen another IntrudingDivisor sample logging requests to \u201cKB76862-ENU.exe\u201d as well. We believe the threat actor will use the IntrudingDivisor in a similar manner to TwoFace, specifically to gain access to additional servers during lateral movement and to gather user credentials.\nConclusion\nThe TwoFace webshell has an effective two-layer approach that makes it difficult to detect. Coupled with the multiple layers and inclusion of legitimate website content that displays correctly in the browser, the threat actors are able to enjoy long periods of persistent access to a network without detection as evidenced by their demonstrated ability to access and manipulate a compromised system for nearly a year. Based on the commands issued to TwoFace, the threat actors used this webshell to deliver variants of the Mimikatz tool to gather the passwords of logged on accounts. The actor also used TwoFace to move laterally by copying webshells to other remote systems on the network.\n\nTwoFace Loader SHA256\n\ned684062f43d34834c4a87fdb68f4536568caf16c34a0ea451e6f25cf1532d51\nf4da5cb72246434decb8cf676758da410f6ddc20196dfd484f513aa3b6bc4ac5\n9a361019f6fbd4a246b96545868dcb7908c611934c41166b9aa93519504ac813\nd0ffd613b1b285b15e2d6c038b0bd4951eb40eb802617cf6eb4f56cda4b023e3\n\nTwoFace++ Loader SHA256\n\nbca01f14fb3cb4cfbe7f240156feebc55abac73a6c96b9f75da2f9df580101ef\n8d178b9730e09e35c071526bfb91ce72f876797ebc4e81f0bc05e7bb8ad1734e\n\nTwoFace Payload SHA256\n\n8f0419493da5ba201429503e53c9ccb8f8170ab73141bdc6ae6b9771512ad84b\n0a77e28e6d0d7bd057167ca8a63da867397f1619a38d5c713027ebb22b784d4f\n54c8bfa0be1d1419bf0770d49e937b284b52df212df19551576f73653a7d061f\n818ac924fd8f7bc1b6062a8ef456226a47c4c59d2f9e38eda89fff463253942f\nfd47825d75e3da3e43dc84f425178d6e834a900d6b2fd850ee1083dbb1e5b113\n79c9a2a2b596f8270b32f30f3e03882b00b87102e65de00a325b64d30051da4e\ne33096ab328949af19c290809819034d196445b8ed0406206e7418ec96f66b68\nc116f078a0b9ea25c5fdb2e72914c3446c46f22d9f2b37c582600162ed711b69\n\nIntrudingDivisor Shell SHA256\n\ne342d6bf07de1257e82f4ea19e9f08c9e11a43d9ad576cd799782f6e968914b8\n49f43f2caaea89bd3bb137f4228e543783ef265abbdc84e3743d93a7d30b0a7e\n\nMimikatz SHA256\n\nf17272d146f4d46dda5dc2791836bfa783bdc09ca062f33447e4f3a26f26f4e0","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Robert Falcone"},{"@type":"Person","name":"Bryan Lee"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"39352","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=39352' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-twoface-webshell-persistent-access-point-lateral-movement%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-twoface-webshell-persistent-access-point-lateral-movement%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-39352 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">TwoFace Webshell: Persistent Access Point for Lateral Movement</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-39352 entry-meta">
			
			
			<span class="post-views-count">29,755</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'39352','like')"><i class="ui ui-2"></i><span class="ml-5">2</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-twoface-webshell-persistent-access-point-lateral-movement%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-twoface-webshell-persistent-access-point-lateral-movement%2F+-+TwoFace+Webshell%3A+Persistent+Access+Point+for+Lateral+Movement" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-twoface-webshell-persistent-access-point-lateral-movement%2F&title=TwoFace+Webshell%3A+Persistent+Access+Point+for+Lateral+Movement&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-twoface-webshell-persistent-access-point-lateral-movement/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a> and <a href="https://unit42.paloaltonetworks.com/author/bryanlee/" title="Posts by Bryan Lee" class="author url fn" rel="author">Bryan Lee</a>        </p>
        <p><time datetime="2017-07-31T02:00:12+00:00">July 31, 2017 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/mimikatz/" rel="tag">Mimikatz</a>, <a href="https://unit42.paloaltonetworks.com/tag/twoface/" rel="tag">TwoFace</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p>While investigating a recent security incident, Unit 42 found a webshell that we believe was used by the threat actor to remotely access the network of a targeted Middle Eastern organization. The construction of the webshell was interesting by itself, as it was actually two separate webshells: an initial webshell that was responsible for saving and loading the second fully functional webshell. It is this second webshell that enabled the threat actor to run a variety of commands on the compromised server. Due to these two layers, we use the name TwoFace to track this webshell.</p>
<p>During our analysis, we extracted the commands executed by the TwoFace webshell from the server logs on the compromised server. Our analysis shows that the commands issued by the threat actor date back to June 2016; this suggests that the actor had access to this shell for almost an entire year. The commands issued show the actor was interested in gathering credentials from the compromised server using the Mimikatz tool. We also saw the attacker using the TwoFace webshell to move laterally through the network by copying itself and other webshells to other servers.</p>
<h3>Actor Activities using TwoFace</h3>
<p>The web server logs on the system we examined that was compromised with the TwoFace shell gave us a glimpse into the commands the actor executed through their malware. These commands also enabled us to create a profile of the actor, specifically their intentions and the tools and techniques used to carry out their operation.</p>
<p>Our analysis determined that five different IP addresses from four countries issued commands on the TwoFace shell, as seen in Table 1. As it is possible these originating IP address may themselves have been targeted and compromised, we have redacted the full IP addresses to hide the identities. The first command in the logs was issued on June 18, 2016, which was a simple “whoami” command to get the username on the server. This single command was the only one by this specific IP address which appears to be in Iran, and suggests that the actor may have initially compromised the server around this time and performed a quick check to see if the shell was loaded successfully.</p>
<table width="448">
<tbody>
<tr>
<td width="110"><strong>IP address</strong></td>
<td width="59"><strong>Country</strong></td>
<td width="80"><strong>Number of Commands</strong></td>
<td width="99"><strong>Date of Activity</strong></td>
<td width="99"><strong>Days Since Initial Command</strong></td>
</tr>
<tr>
<td width="110">46.38.x.x</td>
<td width="59">Iran</td>
<td width="80">1</td>
<td width="99">2016-06-18</td>
<td width="99">0</td>
</tr>
<tr>
<td width="110">178.32.x.x</td>
<td width="59">France</td>
<td width="80">6</td>
<td width="99">2016-09-28</td>
<td width="99">103</td>
</tr>
<tr>
<td width="110">137.74.x.x</td>
<td width="59">France</td>
<td width="80">16</td>
<td width="99">2017-03-03</td>
<td width="99">259</td>
</tr>
<tr>
<td width="110">192.155.x.x</td>
<td width="59">USA</td>
<td width="80">61</td>
<td width="99">2017-04-24</td>
<td width="99">311</td>
</tr>
<tr>
<td width="110">46.4.x.x</td>
<td width="59">Germany</td>
<td width="80">10</td>
<td width="99">2017-05-03</td>
<td width="99">320</td>
</tr>
</tbody>
</table>
<p><em>Table 1 IP Addresses seen issuing TwoFace Commands</em></p>
<p>Three months after this single, initial command the next set of commands were sent. This time on September 28, 2016 a series of twelve commands were sent from an IP address apparently in France. These commands provide additional insight into the actor’s intentions. It is not certain why a time gap exists in issuing commands to the TwoFace webshell, although it is highly plausible this may simply be a visibility gap or even anti-detection measure taken by the actor. Rather than speculating on this gap and subsequent time gaps between interactions, we will focus on the commands actor issued that provide insight into this actor’s tactics, techniques, and procedures (TTPs).</p>
<p>The first command issued from this second IP address attempts to run a variant of the Mimikatz post-exploitation tool (m64.exe), specifically the Sekurlsa module that gathers the passwords of accounts currently logged into the system and saves the results locally to a text file. The actor then issues a command that uses the “type” command to read the contents of the text file containing the passwords, followed by a command that uses “del” to delete the text file.</p>
<p>c:\windows\temp\m64.exe privilege::debug sekurlsa::logonpasswords exit &gt; c:\windows\temp\01.txt</p>
<p>Just over five months later on March 3, 2017, a third IP address, a different one apparently in France, issued a series of 16 commands to the TwoFace webshell. The first command of interest is as follows:</p>
<p>net group &#8220;Exchange Trusted Subsystem&#8221; /domain</p>
<p>According to <a href="https://technet.microsoft.com/en-us/library/dd638106%28v=exchg.150%29.aspx?f=255&amp;MSPPError=-2147217396">MSDN</a>, the “Exchange Trusted Subsystem” group is defined as follows:</p>
<p style="padding-left: 30px;"><em>The “Exchange Trusted Subsystem” is a highly privileged universal security group (USG) that has read/write access to every Exchange-related object in the Exchange organization. It’s also a member of the Administrators local security group and the Exchange Windows Permissions USG, which enables Exchange to create and manage Active Directory objects.</em></p>
<p>Using hostnames obtained from the previous command, the actor issues several commands to determine if they have access to Microsoft Exchange related folders. The actor then issued several commands that attempt to copy a different webshell onto these additional systems, which resembles the following:</p>
<p>copy c:\windows\temp\Exchange.aspx &#8220;\\[hostname]\d$\Program Files\Microsoft\Exchange Server\V14\ClientAccess\exchweb\ews\&#8221;</p>
<p>This clearly shows the threat actor attempting to use the TwoFace webshell to pivot to other servers on the network. The “Exchange.aspx” file copied over to the other systems appears to be a different webshell from TwoFace. We analyzed this additional webshell and have named it IntrudingDivisor, which we will describe in detail later in this blog.</p>
<p>On April 24, 2017, a fourth IP address, this one apparently in the United States, issued 61 commands to the TwoFace webshell. Like the previous set of commands issued in March 2017 from France, this IP address issued the command to obtain objects in the Exchange Trusted Subsystem group, and it appears the actor copied over yet another webshell named “global.aspx” and set the file’s attributes to be hidden using the following command:</p>
<p>attrib h &#8220;\\[hostname]\d$\Program Files\Microsoft\Exchange Server\V14\ClientAccess\exchweb\ews\global.aspx&#8221;</p>
<p>The actor then issued commands that suggests the use of the Mimikatz tool, but this time Mimikatz was named “mom64.exe” instead of “m64.exe”. The following two commands show the actor killing the process and using the “type” command to read the contents of a text file “01.txt,” which was also used in the password gathering activity observed on the day of the initial compromise on Jun 2016, ten months earlier:</p>
<p>taskkill /f /im mom64.exe<br />
type c:\windows\temp\01.txt</p>
<p>Nine days later on May 3, 2017 the next commands came from a fifth IP address apparently in Germany. This time the threat actors issued 10 commands to the TwoFace webshell: fewer than nine days before but still more than during the other sessions.</p>
<p>The actor first issues a command to ping the IP address “4.2.2.4”, which is the legitimate DNS resolver operated by Level 3. The actor then checks the “Domain Admins” group to determine the accounts with domain administrator privileges using the following command:</p>
<p>net group &#8220;Domain admins&#8221; /domain</p>
<p>After this command, the actor runs a variant of the Mimikatz tool to gather locally logged in passwords, this time using a filename of “MicrosoftUpdate.exe” for the executable and “mic.txt” to store the results, as seen in the following command:</p>
<p>c:\windows\temp\MicrosoftUpdate.exe p::d s::l q &gt; c:\windows\temp\mic.txt</p>
<p>These commands show the threat actors rely heavily on the TwoFace webshell to interact with compromised servers, but it also appears that other webshells are used in addition to TwoFace, such as IntrudingDivisor. The commands also show the threat actor’s reliance on the Mimikatz tool to steal passwords from systems, which they will then use to attempt to move laterally amongst other servers by copying over webshells. Lastly, the timestamps of the commands suggest that the threat actor had maintained persistent access that they used intermittently to the compromised network using the TwoFace shell since at least June 2016.</p>
<h3>TwoFace Loader Shell</h3>
<p>Both components of the TwoFace shell, which we will refer to as the loader and payload components were written in C# and meant to run on a webserver that supports ASP.NET. The author of the initial loader webshell included legitimate and expected content that will be displayed if a visitor accesses the shell in a browser. The inclusion of expected content suggests that the actors wished to use the TwoFace webshell for extended periods while remaining hidden.</p>
<p>The code in the loader webshell includes obfuscated variable names and the embedded payload is encoded and encrypted. To interact with the loader webshell, the threat actor uses HTTP POST requests to the compromised server. As its name suggests, the loader component is mainly responsible for saving and loading the payload component on the same server, allowing the actor to interact with the payload component that has far more functionality than the loader. However, the loader is also capable of the following functionality:</p>
<ul>
<li>Save the TwoFace payload to a specified file on the server</li>
<li>Delete the TwoFace payload saved on the server</li>
<li>Write data to a specified file on the server</li>
<li>Delete the entire folder on the server used to store the TwoFace payload</li>
</ul>
<p>The TwoFace loader parses the HTTP POST requests issued by the actor and references data at specific locations, more specifically at certain indexes within the posted data (C# “Request.Forms”) that the shell will use to determine the functionality the actor wishes to execute. While we did not have logs of HTTP requests for the loader shell, we were able to determine some of the indexes that the webshell will specifically access within the data. Table 2 shows the known indexes within the HTTP POST data that TwoFace references.</p>
<table width="473">
<tbody>
<tr>
<td width="122"><strong>Request.Forms Index</strong></td>
<td width="351"><strong>Description</strong></td>
</tr>
<tr>
<td width="122">0</td>
<td width="351">If set to a specific value (for example, &#8220;931201&#8221;), it creates a set of &#8220;pre&#8221; html tags with a string of numbers for reasons unknown.</td>
</tr>
<tr>
<td width="122">5</td>
<td width="351">Data to write to a file on the server</td>
</tr>
<tr>
<td width="122">8</td>
<td width="351">String name for the TwoFace webshell filename</td>
</tr>
<tr>
<td width="122">9</td>
<td width="351">Contains base64 data provided by the actor to specify the command to run, as well as the decryption key in the event the actor wishes to load the webshell</td>
</tr>
</tbody>
</table>
<p><em>Table 2 Indexes within Request.Forms that the TwoFace loader relies on</em></p>
<p>As you can see in the descriptions in Table 2, none of these locations contain the command that the actor wishes to execute. Instead, the actor must provide data in index 9 that was constructed to not only contain the command the actor wants to execute, but also contains the key to decrypt the TwoFace payload component that is embedded within the loader. The data in index 9 will contain data at specific offsets, seen in Table 3 that the loader component will use to determine the command and the location of command specific data within the posted data (C# “Request.Forms”).</p>
<table width="473">
<tbody>
<tr>
<td width="48"><strong>Offset</strong></td>
<td width="45"><strong>Value</strong></td>
<td width="380"><strong>Description</strong></td>
</tr>
<tr>
<td width="48">0</td>
<td width="45">Varied</td>
<td width="380">The entirety of the data is used as a key to decrypt the TwoFace payload component</td>
</tr>
<tr>
<td width="48">25</td>
<td width="45">8</td>
<td width="380">Specifies the argument in the HTTP POST request that contains the string of the filename for the TwoFace webshell file</td>
</tr>
<tr>
<td width="48">26</td>
<td width="45">1000</td>
<td width="380">Minimum length required to write data to a specified file</td>
</tr>
<tr>
<td width="48">44</td>
<td width="45">31</td>
<td width="380">Contains the number of arguments needed to perform a file deletion operation?</td>
</tr>
<tr>
<td width="48">45</td>
<td width="45">5</td>
<td width="380">Specifies the argument within the POST request that contains the data to write to a file on the server</td>
</tr>
<tr>
<td width="48">57</td>
<td width="45">36</td>
<td width="380">Contains the number of arguments within the POST request to run a command to write data to a file on the server</td>
</tr>
<tr>
<td width="48">61</td>
<td width="45">13</td>
<td width="380">Contains the number of arguments within the POST request to run a command to install the TwoFace payload webshell</td>
</tr>
<tr>
<td width="48">63</td>
<td width="45">14</td>
<td width="380">Contains the number of arguments needed to perform a folder deletion operation?</td>
</tr>
</tbody>
</table>
<p><em>Table 3 Offets of actor provided data used by the TwoFace loader</em></p>
<h3>Saving the TwoFace Payload</h3>
<p>The main purpose of the loader shell is to install a secondary webshell on demand. The secondary webshell, which we call the payload, is embedded within the loader in encrypted form and contains additional functionality that we will discuss in further detail. When the threat actor wants to interact with the remote server, they provide data that the loader will use to modify a decryption key embedded within the loader that will be in turn used to decrypt the embedded TwoFace payload. The decryption algorithm (below) is very simple, as it relies on basic arithmetic operations, specifically addition and subtraction to decrypt the embedded payload.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69287d323e2830028255" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
for(int i = 0; i &amp;lt; key.Length; i++)
    key[i] += actorProvidedData[i % actorProvidedData.Length];
for(int j=0;j&amp;lt;ciphertext.Length;j++)
    ciphertext[j] -= key[j % key.Length];</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69287d323e2830028255-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287d323e2830028255-2">2</div><div class="crayon-num" data-line="crayon-5f69287d323e2830028255-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287d323e2830028255-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69287d323e2830028255-1"><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287d323e2830028255-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">actorProvidedData</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">actorProvidedData</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f69287d323e2830028255-3"><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-v">j</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">ciphertext</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287d323e2830028255-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ciphertext</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>The pseudocode above provides the logic used by the TwoFace loader to decrypt the ciphertext of the payload, which is</p>
<ol>
<li>Iterate through the key, modifying each byte by adding a value from the actor’s provided data</li>
<li>Iterate through TwoFace payload ciphertext and subtracting each byte using a value from the modified key</li>
</ol>
<p>We were able to determine the data that the threat actor would have to provide to successfully decrypt the embedded TwoFace payload, which is as follows:</p>
<p>\x15@^\xbbs\xfa\xae\x876\x03`\xffs\x89\xb9 \x9a\xcb\x02\xec\x8e\xc3\x92\x7f\xd6b\xa8\x1ag\xb8\xff\x82\x08\xd0ALB\xd8\x0c)\x91\x82\xc4\x85\xb2\xa7\xe6\xea\x8e\x92\xf9u\x96\xc1\xef\xfd\xe9.!\x047\xc8#y</p>
<p>As you can surmise from the above characters, this does not appear to be a human generated string. We believe this is a machine generated string used for this input data, which gives a bit of insight into the actors behind this webshell, as they would have to use a tool to interact with to automate the use of these webshells, or at a minimum they would need to keep track of these machine generated user input strings to be able to interact with their webshells manually.</p>
<h3>TwoFace Payload Shell</h3>
<p>The TwoFace payload shell requires a password that is sent within HTTP POST data or within the HTTP Cookie, specifically with a field with a name “pwd”. The “pwd” field is used for authentication as a password, which the payload will generate the SHA1 hash and compare it with a hash that is hardcoded within the payload. We extracted the SHA1 hashes used for authentication from the known TwoFace shells, as seen in Table 4 and were able to find the associated password string for three of them. One of the passwords, “RamdanAlKarim12” contains a phrase that means “Ramadan the generous” in Arabic (رمضان الكريم). Another known password is “FreeMe!”, while the last known password contains what may be an acronym of a middle eastern energy organization followed by “pass”. It is possible that the actor chose this acronym based on the targeted organization, but we cannot confirm this.</p>
<table width="358">
<tbody>
<tr>
<td width="94"><strong>Sample SHA256</strong></td>
<td width="264"><strong>Embedded SHA1 Password</strong></td>
</tr>
<tr>
<td width="94">8f0419493d…</td>
<td width="264">a2c9afd6adac242827adb00d76c20c491b2d2247</td>
</tr>
<tr>
<td width="94">0a77e28e6d…</td>
<td width="264">6a0e681586988388d4a0690b6fb686715d92d069</td>
</tr>
<tr>
<td width="94">54c8bfa0be…</td>
<td width="264">5e1c37bf3bd8a7567d46db63ed9b0aeed53e57fe</td>
</tr>
<tr>
<td width="94">818ac924fd…</td>
<td width="264">37ada887553cf48715cc19131b8e661ac43718e9</td>
</tr>
<tr>
<td width="94">fd47825d75…</td>
<td width="264">9789b5c0c13fb58c423bce5577873d413d9494be</td>
</tr>
<tr>
<td width="94">79c9a2a2b5…</td>
<td width="264">c56bc0d331a825fdea01c5437877d5e9e1cda2c4</td>
</tr>
<tr>
<td width="94">e33096ab3…</td>
<td width="264">9f4e10484f4ceac34878d4f621a1ad8e580fd02a</td>
</tr>
<tr>
<td width="94">c116f078a0…</td>
<td width="264">57dd9721f9837ebd24dea55a90a2a9e3e6ad6f1e</td>
</tr>
</tbody>
</table>
<p><em>Table 4 Authentication hashes and matching password strings used for TwoFace webshells</em></p>
<p>Much like the authentication password, a threat actor can issue commands to the TwoFace payload using either data sent within the HTTP Cookie or HTTP POST data itself. If using an HTTP Cookie to issue commands, the payload will split the cookie data using the delimiter “#=#” and will treat the first value as the command and the second value the data to pass to the command. We enumerated the command handler, which can be seen in Table 5 that accepts a variety of commands to interact with the compromised server.</p>
<table style="height: 872px;" width="600">
<tbody>
<tr>
<td width="75"><strong>Command</strong></td>
<td width="60"><strong>Arg Field</strong></td>
<td width="342"><strong>Description</strong></td>
</tr>
<tr>
<td rowspan="2" width="75">Execute application or command</td>
<td width="60">pro</td>
<td width="342">Executable to run command line commands</td>
</tr>
<tr>
<td width="60">cmd</td>
<td width="342">Runs a supplied command using “cmd.exe” or another executable supplied by the user via the “pro” field within the HTTP POST data.</td>
</tr>
<tr>
<td rowspan="4" width="75">Upload a file to the server</td>
<td width="60">upl</td>
<td width="342">Field name within the HTTP POST files that contains the file contents to save to the server</td>
</tr>
<tr>
<td width="60">sav</td>
<td width="342">Path to save file to</td>
</tr>
<tr>
<td width="60">vir</td>
<td width="342">Boolean to save a file to a virtual path rather than a physical path</td>
</tr>
<tr>
<td width="60">nen</td>
<td width="342">Specified name of file to upload, otherwise the script uses the filename of the uploaded file from the HTTP POST request</td>
</tr>
<tr>
<td rowspan="2" width="75">Upload data to a file in the %TEMP% folder</td>
<td width="60">upb</td>
<td width="342">Base64 encoded data that is decoded and saved to a file</td>
</tr>
<tr>
<td width="60">upd</td>
<td width="342">Filename in the %TEMP% folder to save ‘upb’ data to</td>
</tr>
<tr>
<td width="75">Delete a file in %TEMP% folder</td>
<td width="60">del</td>
<td width="342">Filename in the %TEMP% folder to delete</td>
</tr>
<tr>
<td width="75">Download a file from the server</td>
<td width="60">don</td>
<td width="342">Path to file to download from the server</td>
</tr>
<tr>
<td rowspan="4" width="75">View or set MAC timestamps of a file</td>
<td width="60">hid</td>
<td width="342">1 = View the ‘tfil’ MAC times</p>
<p>2 = Set ‘tfil’ file MAC times to match the file specified in the ‘ttar’ field</p>
<p>3 = Set ‘tfil’ file MAC times to times specified in the ‘ttim’ field</td>
</tr>
<tr>
<td width="60">tfil</td>
<td width="342">Filename to get or set MAC times</td>
</tr>
<tr>
<td width="60">ttar</td>
<td width="342">Filename to get MAC times, most likely a legitimate filename used to make uploaded files look as if they are legitimate</td>
</tr>
<tr>
<td width="60">ttim</td>
<td width="342">Specific timestamp to set file MAC times to</td>
</tr>
</tbody>
</table>
<p><em>Table 5 Commands available within the TwoFace payload webshell</em></p>
<p>While the commands within Table 5 are available within TwoFace, the threat actor does not have to manually issue these requests within HTTP POST data, as the actor can interact with the webshell using a web form within the browser. We set up an IIS server to test the TwoFace webshell, which displays the user-interface seen in Figure 1.</p>
<p><img class="alignnone size-full wp-image-39355" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_1.png" alt="twoface_1" width="975" height="572" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_1.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_1-900x528.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_1-300x176.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_1-768x451.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_1-370x217.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 1 TwoFace payload webshell before authentication</em></p>
<p>At first, the text box in the row labeled “Login” has a red background, which means the user has not successfully provided the password required to issue commands to the webshell. After entering the correct password in the login box, the box changes from a red to green background, as seen in Figure 2. The actor can now interact with the compromised server using the webshell, which runs the commands described in Table 5. In most cases, the output or results of commands are displayed immediately below the webshell. For instance, in Figure 2 we issued the “whoami” command that used the Windows command-prompt to display the name of the current user account below the webshell.</p>
<p><img class="alignnone size-full wp-image-39379" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_2.png" alt="twoface_2" width="975" height="567" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_2.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_2-900x523.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_2-300x174.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_2-768x447.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/07/twoface_2-370x215.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 2 Issuing a command on TwoFace webshell after successfully authenticating</em></p>
<h3>TwoFace++ Loader</h3>
<p>We discovered another version of the TwoFace loader shell that was structurally similar to the TwoFace loader shell discussed in this blog, as this version of TwoFace also contains an embedded payload shell in encrypted form. To use the embedded payload shell, the actor must provide a password that the loader shell will not only use for authentication, but also as a key to decrypt the payload.</p>
<p>The actor will provide the password in the HTTP POST data, specifically as a base64 encoded string within a field labeled “p”. The TwoFace++ loader will decode this password and concatenate a static salt value and compute the SHA1 hash of this string. The loader then base64 encodes the SHA1 hash and compares it with a hardcoded base64 encoded string of a SHA1 hash needed for successful authentication. We know of the SHA1 hashes 19be2493b7cc2d43e8bf245b6faf2c747be6bae5 and 26749c6b5308bb668eb954f4120607c2a9d620be used for authentication, however, we have been unable to determine the passwords that would result in these hashes.</p>
<p>The TwoFace++ loader will use the actor provided password as a decryption key to decrypt the embedded payload shell. The loader will use the first 24 bytes of the actor’s password as a key, which it will use the 3DES symmetric cipher to decrypt the payload shell. The embedded payload is 8624 bytes, which we believe is another webshell based on the previous version of the TwoFace loader, however, we have been unable to decrypt the payload to confirm.</p>
<h3>IntrudingDivisor Webshell</h3>
<p>Our analysis of the commands issued to the TwoFace webshell resulted in the discovery of another webshell that we call IntrudingDivisor. Like TwoFace, the IntrudingDivisor webshell requires the threat actor to authenticate before issuing commands. To authenticate, the actor must provide two pieces of information, first an integer that is divisible by 5473 and a string whose MD5 hash is “9A26A0E7B88940DAA84FC4D5E6C61AD0”. Upon successful authentication, the webshell has a command handler that uses integers within the request to determine the command to execute, specifically integers divisible by the following:</p>
<table>
<tbody>
<tr>
<td width="52"><strong>Divisor</strong></td>
<td width="356"><strong>Command</strong></td>
</tr>
<tr>
<td width="52">6571</td>
<td width="356">Write provided data to a specified file</td>
</tr>
<tr>
<td width="52">9273</td>
<td width="356">Execute a command or change the modified and access times of a file</td>
</tr>
<tr>
<td width="52">3471</td>
<td width="356">Read a specified file</td>
</tr>
</tbody>
</table>
<p><em>Table 6 Commands available within the IntrudingDivisor webshell</em></p>
<p>The webshell logs the IP, user-agent, and timestamp of all requests to a file named &#8220;KB45253-ENU.exe”, but we have seen another IntrudingDivisor sample logging requests to “KB76862-ENU.exe” as well. We believe the threat actor will use the IntrudingDivisor in a similar manner to TwoFace, specifically to gain access to additional servers during lateral movement and to gather user credentials.</p>
<h3>Conclusion</h3>
<p>The TwoFace webshell has an effective two-layer approach that makes it difficult to detect. Coupled with the multiple layers and inclusion of legitimate website content that displays correctly in the browser, the threat actors are able to enjoy long periods of persistent access to a network without detection as evidenced by their demonstrated ability to access and manipulate a compromised system for nearly a year. Based on the commands issued to TwoFace, the threat actors used this webshell to deliver variants of the Mimikatz tool to gather the passwords of logged on accounts. The actor also used TwoFace to move laterally by copying webshells to other remote systems on the network.</p>
<p><strong>TwoFace Loader SHA256</strong></p>
<p>ed684062f43d34834c4a87fdb68f4536568caf16c34a0ea451e6f25cf1532d51<br />
f4da5cb72246434decb8cf676758da410f6ddc20196dfd484f513aa3b6bc4ac5<br />
9a361019f6fbd4a246b96545868dcb7908c611934c41166b9aa93519504ac813<br />
d0ffd613b1b285b15e2d6c038b0bd4951eb40eb802617cf6eb4f56cda4b023e3</p>
<p><strong>TwoFace++ Loader SHA256</strong></p>
<p>bca01f14fb3cb4cfbe7f240156feebc55abac73a6c96b9f75da2f9df580101ef<br />
8d178b9730e09e35c071526bfb91ce72f876797ebc4e81f0bc05e7bb8ad1734e</p>
<p><strong>TwoFace Payload SHA256</strong></p>
<p>8f0419493da5ba201429503e53c9ccb8f8170ab73141bdc6ae6b9771512ad84b<br />
0a77e28e6d0d7bd057167ca8a63da867397f1619a38d5c713027ebb22b784d4f<br />
54c8bfa0be1d1419bf0770d49e937b284b52df212df19551576f73653a7d061f<br />
818ac924fd8f7bc1b6062a8ef456226a47c4c59d2f9e38eda89fff463253942f<br />
fd47825d75e3da3e43dc84f425178d6e834a900d6b2fd850ee1083dbb1e5b113<br />
79c9a2a2b596f8270b32f30f3e03882b00b87102e65de00a325b64d30051da4e<br />
e33096ab328949af19c290809819034d196445b8ed0406206e7418ec96f66b68<br />
c116f078a0b9ea25c5fdb2e72914c3446c46f22d9f2b37c582600162ed711b69</p>
<p><strong>IntrudingDivisor Shell SHA256</strong></p>
<p>e342d6bf07de1257e82f4ea19e9f08c9e11a43d9ad576cd799782f6e968914b8<br />
49f43f2caaea89bd3bb137f4228e543783ef265abbdc84e3743d93a7d30b0a7e</p>
<p><strong>Mimikatz SHA256</strong></p>
<p>f17272d146f4d46dda5dc2791836bfa783bdc09ca062f33447e4f3a26f26f4e0</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
