
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Upatre Continued to Evolve with new Anti-Analysis Techniques</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-upatre-continues-evolve-new-anti-analysis-techniques/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-upatre-continues-evolve-new-anti-analysis-techniques/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Upatre Continued to Evolve with new Anti-Analysis Techniques" />
<meta property="og:description" content="Unit 42 monitors the continued evolution Upatre and its anti-analysis Techniques." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-upatre-continues-evolve-new-anti-analysis-techniques/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="dot-bit" />
<meta property="article:tag" content="Downloader" />
<meta property="article:tag" content="Namecoin" />
<meta property="article:tag" content="Upatre" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2018-07-13T12:00:16+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:width" content="600" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 monitors the continued evolution Upatre and its anti-analysis Techniques." />
<meta name="twitter:title" content="Upatre Continued to Evolve with new Anti-Analysis Techniques" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Upatre Continued to Evolve with new Anti-Analysis Techniques Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-upatre-continues-evolve-new-anti-analysis-techniques/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="9"/>
<meta property="og:views" content="12,771"/>
<meta property="og:date_created" content="July 13, 2018 at 5:00 AM"/>
<meta property="og:post_length" content="2195"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Mike Harbison"/>
<meta property="og:author" content="Brittany Barbehenn"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/mike-harbison/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/brittany-ash/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Upatre Continued to Evolve with new Anti-Analysis Techniques","name":"Upatre Continued to Evolve with new Anti-Analysis Techniques","description":"Unit 42 monitors the continued evolution Upatre and its anti-analysis Techniques.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-upatre-continues-evolve-new-anti-analysis-techniques\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-upatre-continues-evolve-new-anti-analysis-techniques\/","datePublished":"July 13, 2018","articleBody":"First discovered in 2013, Upatre is primarily a downloader tool responsible for delivering additional trojans onto the victim host. It is most well-known for being tied with the Dyre banking trojan, with a peak of over 250,000 Upatre infections per month delivering Dyre back in July 2015. In November 2015 however, an organization thought to be associated with the Dyre operation was raided, and subsequently the usage of Upatre delivering Dyre dropped dramatically, to less than 600 per month by January 2016.\nToday, the Upatre downloader tool is effectively no longer in use by criminal organizations. However, one of the many interesting aspects of the Upatre tool had always been its constant adaptive nature where the developers continuously added features and capabilities to the tool to increase its efficacy.\nIn March 2018, Unit 42 researchers collected a sample of Upatre which was compiled in December 2016 but at the time was largely undetectable by most automated detection systems . Because of this, we analyzed the sample to afford awareness to those interested in this malware and its evolution. This previously undocumented variant features significant code flow obscuration, a pro re nata means of decryption for network communications, and of particular interest, the method in which this variant evades virtual machine detection.\nIn this post we highlight these techniques identified during our analysis.\n&nbsp;\nMalware Overview\nUpatre is a stage-0 malware, which basically means it\u2019s a downloader.\u00a0 \u00a0The malware is used to download and install a payload onto the affected system.\u00a0 The payload is retrieved from hardcoded domain(s) and is typically another piece of malware. Historically, Upatre has acted as a downloader for malware families such as Dyre, GameOver Zeus, Kegotip, Locky, and Dridex to name a few. However, in this case no payload was delivered. Additionally, variants such as this one collect information from the target and transmit the data via an HTTP POST request.\nThis newly observed variant comes packed with several characteristics and capabilities that stood out to us during analysis.\u00a0 Attributes in the PE header suggest that the malware is written in Visual C++ and several of the PE sections have high entropy classification, which indicates that the binary is packed.\u00a0 The PE resource section also contains images of Google Chrome, so when the binary is placed on the target machine, it appears to be that of the Google Chrome web browser.\nOne of the key features about this variant that stood out during our analysis is how it detects whether or not it is running within a virtual machine. Although virtual machine detection is anything but new, in this variant, it is handled a bit differently than other samples previously analyzed by Unit 42.\u00a0 To, evade detection, the newly observed variant enumerates the running processes on the host, generates a CRC32 hash of the process name, performs an XOR with a hard-coded key of 0x0F27DC411, and finally compares the newly computed value against a list of values stored in an array within the code.\u00a0 We observed the following values:\n\n\n\n0x6BA08023\n0xDFF859A5\n0x9649C9DF\n0x91B88065\n0xF663B61C\n\n\n0xC6E1589A\n0xC63B2FDF\n0xA9D475EF\n0xCE9F7AE2\n0xCF3B343A\n\n\n0x85D3D4E6\n0x1392D4C\n0xDFC3A97E\n0x51ACC655\n0xEF0F2980\n\n\n0x64EEAFAF\n0xD5F11B49\n0xC9823C94\n0x9F4EE7C8\n0x403C2A93\n\n\n0x6A50A975\n0xECCCD158\n0xED3CF80E\n0x209202D5\n0x2C6668C3\n\n\n\n&nbsp;\nThis version of Upatre will not transmit any data via HTTP POST to any of the target domains if one of these values is found.\nIn the event one of the values are found, the malware will sleep for six seconds and then will restart the entire check again.\nWe were unable to determine every corresponding process name from the CRC32 list above, however, we were able to decipher the following process names:\n\n\n\nProcess Name\nCRC32\n\n\nvmtoolsd.exe\n0xD5F11B49\n\n\nvmacthlp.exe\n0x403C2A93\n\n\nPython.exe\n0x209202D5\n\n\n\n&nbsp;\nOther notable functionality of this new version of the Upatre malware includes:\n\n \tIn-memory loading of code\n \tDisables the following Windows services:\n\n \tWindows Security Center\n \tInternet Connection Sharing\n \tWindows Firewall\n \tWindows Defender\n \tWindows Update\n \tWindows Defender Network Inspection Service\n\n\n \tDisables Windows security notification balloons on Windows 7 and up\n \tDisables Internet Explorer Phishing Filter\n \tDisables Windows User Access Control Notifications\n \tLaunches a trusted Windows application msiexec.exe and injects code into its memory space using an undocumented technique\n \tHeavy use of obfuscated and optimized code to thwart code analysis\n \tUse of non-essential Windows API's for stack pivoting to mask intended API\n \tMultiple layers of custom encoding used for individual strings decoding. Does not share encoding routine with other encoded values\n\n&nbsp;\nNetwork Communication\nAnother feature of this sample is the use of top level domains (TLD) of. bit. The intended domains are encrypted and only decrypted when the malware is ready to use them. This new sample attempts to resolve two domains, bookreader[.]bit and doghunter[.]bit via the following hardcoded DNS Servers:\n\n \t31.3.135[.]232\n \t193.183.98[.]154\n \t5.135.183[.]146\n \t84.201.32[.]108\n \t185.133.72[.]100\n \t96.90.175[.]167\n \t104.238.186[.]189\n\nDNS resolution for .bit domains use hardcoded DNS servers and is handled via TCP versus traditional UDP. This is because .bit domains are based on Namecoin and aren\u2019t regulated by ICANN. Additionally, the hardcoded DNS server IPs we identified in this sample are all associated with OpenNIC Public DNS servers.\nAccording to OpenNIC, when using OpenNIC DNS servers .bit domains are resolved through centralized servers that generate a DNS zone from the Namecoin blockchain; therefore, the secure nature of using Namecoin as a decentralized means of DNS is not actually being utilized here.\nIf domain resolution is successful, the malware will then perform an HTTP POST request similar to the following:\nPOST \/ HTTP\/1.0\nHost: bookreader[.]bit\nContent-Length: 1024\n\u00dem    \u00e19,9r.@\u00bf\u00e6[.\"    \u0160?.\u00e0\u00ec..Cl\u201e8f\u00b7\u00d6'Ls\u00c3\u00f8Pi;\u00b1\u203ah\u00cf\u00c0\u00a8*-2I\u00f3\u00d94\u00b2R\u2013k\"\u00e0{..r\u00e8!..~5\u00b9\u00adqr^.\u00a1h\u2022\u00e2\u00d4?\u00fd.\u02c6\u00ac\u2013\u00c0$.\u0178?\u00f3a..r(\u00ec \u00d1\u00d6\u00b9\u00db.\u00ce.\u00b7\u2039\u00c5E.\u00fb\u00c9n\u00af&amp;{q\u00fb\u00ff\u00b4\u00a9\u00d8.\u00f6\u00ee\",.Y\u00d2!p\u2020\u00b33j\u00d3_s\u00d0.P\u00e1u\u00bb..\u00adK\u0160\u2020\u00d0\u00efw\u00c2:\u0161.\u00a6\u00da\u00f7\u20ac\u00e2C\nnaH\u00be\u00db.\u00bd\u2020\u00b8q.TJ7.\u00be\u0161B' ?.\u00ae\u00ee\u00eeGHx\u00e3Gd\\\u00a6j\u00e6\u00b5.jG\u00e6\u00fbs\u00f0\u00e1].8\u00ae.\u00cf.X#8\u00e7.\u00d4&lt;\u00ad\u00b96\u00df\u017d\u00c4.\u00ad\u00ee\u00a5\u00b5.\u00f9..\u20ac\u00ac\u00ab\u02c6@\u00e6_t.,\u00e1.\u2021q.\u00d4\u00a4.'\u00b3\u00e5\u00ffW\u00b7\u00e4Z.\u00eca:\u00a9\"\u00efI\u00e3\u00cc.\u00a4\u00f4~\u0153    \u00ef\u00d2\u00a7vB\u00e5|\u00d9\u00ab\u00ccfa.\u201e{7\u0152\u00ect.\u02dcl_.\u0152KNE\u00cfg'\u00b8O\u2039\u00afIWy.\u00b2\u00ab\u2022    \u00da\u2026\u2022j'\u00db'\u0160.b.t\u2021|\u00c5..\u0152n\u2020\u00b4\u00d5K\u00a8\u2030\u00bb%\u00f0fh    E\u00baw*\u00a4\u0161f\u2030\u00d22\u0161'\u00a5V..qZ\u00d6(\u00ab86\u00e7 \u02dcW\u00a9g\u2020\u00d5\u00cb\u00d6&#x2122;.\"\u00cd.\u00d5\u00fc\u00fes8Ts\u00bd.=\u00d6\\\u00f3k\u00cc\u00e4E\u00a8\u00cb\u2020&gt;\u00a1\u00be\u00fc\\\u00b1\u02c6b\u00c2\u00ef&gt;;9.\u00c3'\u00d8\u0153Zu\u00e1\u00a9:=\u00c7Tx\u02dcuf\u00fd\u00c9g.\u00c3\u00b7.\u0160\u00e2\u00ad&gt;.\u00c8q.\u00d39wn\u00d6.\u00d6[a\u00f6\u00dd\u00c7\u00e91.\u0178\u2020H\u00c1\u00e8\u2013\u00a1&gt;Eh\u00c2\u00d9.9\u00a9!\u00a9t .\"`\u00e9h.&#x2122;^).\u017e\u00bdC.,\u00ba3\u00f5n\u00d8\u00d1\u00d9\u00e9\u00eeN0`-\u00b0[1\u00d7\u00df(J.\u00c3wX\u00f4`\u00a5\u00d8\u00f7\u00b2';B1\/\u00a4\u00a4+wTg\u203a\u00beQf-\u00df.\u00ff\"|f\u00dfX.,\u00e3A\u00dd\u00ea\u00e2\u00ba\u00f8b\u00cbe\u00be8X.0\u2021h\u2026i9\u00ca\u0178F\u00f7~G\u00de\u00ad=..\u0152\u00fej'&gt;\u017d.\u00b0\u00f8\u00f4.\"U\u201e \u00d6\u00f3\u00d9\u00e6\u00af's.O\/o\u0152\u00d8\u00e3\u2030s\u0153\u00e0\u00e1\u2021.\u00d82\u00fa{\u0152\u00bb\u00eat\u00bb\u00a7h\u00e9\u00b1.Z#r.\u00e9.&lt;\u00fdj\u00ae\u00bd\u00dc\u00a1\\(.\u2026.%\u00f1\u017d\u00cbj..\u0153.\u00b6\u00adD\u00ec\"\u00ae\u00d12xf4+\u00c0\u0152\u00d6f\u00f6Uv\u2022\u00ea\\.\u00e4\u00d3\u00f3\u00a2\u00cd\u00e9\u00f4\u00a5.    \u201e\u00a6\u00a9V\u2026\u20133\u00d7.Y.\u0152\u00d4m8\u00f2@\u2020.~b\u00ab\u00d1\u2014..JW\/\u00e9\u00e9.eE.\u00d3.\u00ac\u2020\n89.E(=\u00e1\u00f8\"\u00bf.&gt;\u00f8\u00bb\u00be\u00e5\u00ea\u0160.\u00ac2\u00a9\u00c1\u00e4\u00acx\u00fd\u00cb\u00f9&lt;\u0161.\u00d0.;\u00e9\u00e0E\u2030+&amp;xAE\u00e7&gt;\"@Lp\u00df\u00c7\u00a27\u00e3\u00d4\u00de@\u00ad~\u00c2f\u00df+Z\u00b1*\u00f2F=aW\u00c2\u00d6\u00b5\u00d0e_\u00eb\u00c6\u00a7\u00eb&amp;`|.&gt;V\u00f8\u00c2\u00e1.C7\u00f1\u201a\u00afi\u00da.\u00b5.\u00b4)!\u00cf\u00aa.\u00c7yO[\u2039\u00be?Js\u00a8e\njK\u00df\u00b1\u00afZ].613\u0152\u00d0.|X\u00dd\u00f5\u00ff\u00ca\u00fd;nU0Mw\u201aM\u00bb\u00ab\u00bd:\u00db?\/\u00e6.$)\u00b6\u00ec_X.p.q.8.\u0178j\u20ac\u00ac.\u0153\u00e0\u00ef..B\u00b7\u00e2o\u017dM.\u00ea\u00c5b\u00a58a\u00d5\u00f9\u00a9s$\u00cfmhT\u00a3\u00bb\u00a4\/ww\u00c66\ny=\u20ac\u0192\u00d6G&#x2122;\u00dau y\u00cd\u00c6\u00b2\".\u00ae !B\u00f9\u00ec\u00e2\u00c3.=\u00a66&lt;)\u00ba\n5M\u00b4y\u00f3tI\\\n\nNote, the HTTP POST does not contain any User-Agent strings.\nAt this time, we don\u2019t fully understand the encryption method; however, we know that the data sent in the POST request is encrypted using a custom encryption algorithm.\u00a0 Below is an example of data captured prior to encryption:\n00000000   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ................\n00000010   00 00 00 00 60 00 00 00  00 00 00 00 01 00 00 00   ....`...........\n00000020   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ................\n00000030   11 27 00 00 00 00 00 00  20 00 00 00 20 00 00 00   .'...... ... ...\n00000040   57 49 4E 2D 52 49 38 38  4C 38 56 4D 45 38 4D 5F   WIN-RI88L8VME8M_\n00000050   45 35 33 32 36 34 38 41  37 36 31 46 34 43 35 41   E532648A761F4C5A\n00000060   AB AB AB AB AB AB AB AB  00 00 00 00 00 00 00 00   \u00ab\u00ab\u00ab\u00ab\u00ab\u00ab\u00ab\u00ab........\n00000070   8B BB 9F 39 09 63 00 00  30 28 31 00 08 21 31 00   \u2039\u00bb\u01789.c..0(1..!1.\n00000080   EE FE EE FE EE FE EE FE  EE FE EE FE EE FE EE FE   \u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\n00000090   EE FE EE FE EE FE EE FE  EE FE EE FE EE FE EE FE   \u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\u00ee\u00fe\n000000A0   9F BB 9C 2E 00 63 00 18  70 1B 31 00 60 21 31 00   \u0178\u00bb\u0153..c..p.1.`!1.\n000000B0   78 1B 31 00 68 21 31 00  70 21 31 00 80 CF 2B 00   x.1.h!1.p!1.\u20ac\u00cf+.\n000000C0   00 00 1D 74 8D 12 1D 74  00 70 00 00 3C 00 3E 00   ...t...t.p..&lt;.&gt;.\n000000D0   38 20 31 00 14 00 16 00  60 20 31 00 04 40 0C 00   8 1.....` 1..@..\n000000E0   01 00 00 00 B0 A6 BA 77  BC 38 28 00 43 DB 5B 4A   ....\u00b0\u00a6\u00baw\u00bc8(.C\u00db[J\n000000F0   00 00 00 00 00 00 00 00  F8 1F 31 00 F8 1F 31 00   ........\u00f8.1.\u00f8.1.\n00000100   00 20 31 00 00 20 31 00  38 23 31 00 90 20 31 00   . 1.. 1.8#1.. 1.\n00000110   54 05 B4 77 00 00 D9 3F  D5 8A 48 B8 82 D1 D3 01   T.\u00b4w..\u00d9?\u00d5\u0160H\u00b8\u201a\u00d1\u00d3.\n00000120   AB AB AB AB AB AB AB AB  00 00 00 00 00 00 00 00   \u00ab\u00ab\u00ab\u00ab\u00ab\u00ab\u00ab\u00ab........\n00000130   86 BB 9C 37 14 63 00 1A  43 00 3A 00 5C 00 57 00   \u2020\u00bb\u01537.c..C.:.\\.W.\n00000140   69 00 6E 00 64 00 6F 00  77 00 73 00 5C 00 73 00   i.n.d.o.w.s.\\.s.\n00000150   79 00 73 00 74 00 65 00  6D 00 33 00 32 00 5C 00   y.s.t.e.m.3.2.\\.\n00000160   57 00 49 00 4E 00 4E 00  53 00 49 00 2E 00 44 00   W.I.N.N.S.I...D.\n\n&nbsp;\nObscuring Code Flow\nThis version of Upatre contains significantly obfuscated code to increase the difficulty of analysis. \u00a0Figure 1 below shows an example API call disassembled in IDA Pro.\n&nbsp;\n\n&nbsp;\nFigure 1-IDA Disassembly of API call\nFor conventional naming, the function at address 0x00137ED6 has been renamed to the Windows API\u00a0 RegQueryValueEx_0.\u00a0 According to MSDN this function takes six parameters, the frame pointer is ESP based and the stack frame would resemble the following:\n&nbsp;\n\nFigure 2-Inside Func_RegQueryvalueEx_0\n&nbsp;\nIn the above figure, Func_RegQueryValueEx_0 is EBP based and performs the following:\n\n \tSaves the current stack pointer in EBP\n \tThe stack pointer is adjusted 268 bytes (thwarting stack frame analysis)\n \tPushes a pointer, which points to the REGKEY string\n\nAfter the call into sub_140CBE the stack would resemble the following:\n\nFigure 3--Inside Sub_140CBE\n&nbsp;\nFunction Sub_140CBE does the following:\n\n \tPushes 0x13 on the stack\n \tCalls another function, which ends up jumping into the Windows API GetSystemMetrics\n\n0x13 is the SM_CSURSOR index used by GetSystemMetrics, which returns the width of a cursor in pixels.\u00a0 Retrieving this value has no bearing on the program as the return value is not used.\nHow the stack looks after the call to func_GetSytemMetrics\n&nbsp;\n\nFigure 4--Inside Func_GetSystemMetrics\n&nbsp;\nSome interesting observations about this function:\n\n \tThe JMP instruction is used versus the CALL instruction as JMP doesn\u2019t affect the stack.\n \tThe two PUSH instructions are junk values and only used to pivot the stack, so the correct return address is on the stack during the return.\n\nHere is how the stack looks prior to the jump:\n&nbsp;\n\nReturn address 0x001414FD is the address that is used to open and query the hosts registry, and this is the target address after executing the above instructions.\u00a0 The return code flow is as follows:\n\n \tThe two junk data values pushed on the stack are cleared during the executing of the GetSystemMetrics API.\n \tThe stack pointer is incremented past 0x13\n \tAddress 0x00140CC5 has a retn instruction\n \tAddress 0x001414FD is now on the top of the stack and the section within the malware that handles Windows registry enumeration is called (RegQueryValueEx).\n\nThis stack pivot is performed entirely to make static analysis of the file more difficult, but the end result is still that the API function executes, and the malware accomplishes its task.\n&nbsp;\nPersistence Technique\nTo establish persistence, this new version of Upatre creates the following registry key:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\\\n\n \tString value--&gt;x$msbuild where x$ is a random alpha character. Note: the name of the binary depends on the executable that is running.\u00a0 The stub program grabs the Windows name of the EXE and prepends it with a random value.\u00a0 \n \tData --&gt;C:\\ProgramData\\MSBuild\\x$exe\n\nFile x$MSBuild.exe is then copied to the host's C:\\ProgramData\\MSBuild folder.\n&nbsp;\nConclusion\nIn our data, we have observed over 119,000 unique malware samples that use dot-bit (.bit) domains for C2 infrastructure as early as 2014.\u00a0 Malware families observed include Necurs, GandCrab, Vobfus, Tofsee, Floxif, Ramnit, and several others.\nDue to the C2 domains being down at the time of our analysis, which was unsurprising given the potential age of the sample, we were never able to capture the ultimate payload for this new Upatre variant.\u00a0 However, open source analysis on this variant identified another sample configured with the same dot-bit domains.\u00a0 The sample, 94a8b4b22dab4171edde5b1bafbf2f17dbe3c3c4c01335c36ba3b6e5d3635b83, was compiled six days after our Upatre sample and delivered the Chthonic banking trojan via RIG exploit kit.\nAlthough the delivery mechanism was not observed during our analysis, Upatre typically arrives via an email link\/attachment or through a compromised website.\n&nbsp;\nDefending Against this Threat\nThe Upatre malware is constantly changing and is capable of downloading many different malware families, some, destructive.\u00a0 Using threat detection and prevention solutions such as the Palo Alto Networks next-generation security platform are highly recommended as part of a proactive cyber security strategy. WildFire and Traps both detect the samples described in this report as malicious.\nNot all dot-bit domains are malicious, but organizations should take steps to ensure they can control access to all potentially malicious domains. Blocking outbound access to DNS servers and re-routing DNS requests to internally controlled DNS servers can help protect a network from malware using dot-bit domains provided by the Namecoin network.\nPalo Alto Networks customers remain protected from Upatre and can identify this threat using the Upatre tag in AutoFocus.\n\nIndicators of compromise associated with this analysis include:\n\nUpatre\nSHA256: \u00a0\u00a08ac7909730269d62efaf898d1a5e87251aadccf4349cd95564ad6a3634ba4ef4\nCthonic\nSHA256: \u00a0\u00a094a8b4b22dab4171edde5b1bafbf2f17dbe3c3c4c01335c36ba3b6e5d3635b83\nC2s\nDomain: \u00a0\u00a0doghunter[.]bit\nDomain: \u00a0\u00a0bookreader[.]bit\nIP Address: \u00a031.3.135[.]232\nIP Address: \u00a0193.183.98[.]154\nIP Address: \u00a05.135.183[.]146\nIP Address: \u00a084.201.32[.]108\nIP Address: \u00a0185.133.72[.]100\nIP Address: \u00a096.90.175[.]167\nIP Address: \u00a0104.238.186[.]189\n&nbsp;\nUpdated on 7\/13\/2018 to clarify that the Upatre sample discussed was compiled in 2016 but is newly discovered in 2018 and to more clearly identify samples with their hashes.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2018\/04\/unit42-blog-600x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Mike Harbison"},{"@type":"Person","name":"Brittany Barbehenn"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"81293","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=81293' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-upatre-continues-evolve-new-anti-analysis-techniques%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-upatre-continues-evolve-new-anti-analysis-techniques%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-81293 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Upatre Continued to Evolve with new Anti-Analysis Techniques</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-81293 entry-meta">
			
			
			<span class="post-views-count">12,771</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'81293','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 9</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-upatre-continues-evolve-new-anti-analysis-techniques%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-upatre-continues-evolve-new-anti-analysis-techniques%2F+-+Upatre+Continued+to+Evolve+with+new+Anti-Analysis+Techniques" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-upatre-continues-evolve-new-anti-analysis-techniques%2F&title=Upatre+Continued+to+Evolve+with+new+Anti-Analysis+Techniques&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-upatre-continues-evolve-new-anti-analysis-techniques/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/mike-harbison/" title="Posts by Mike Harbison" class="author url fn" rel="author">Mike Harbison</a> and <a href="https://unit42.paloaltonetworks.com/author/brittany-ash/" title="Posts by Brittany Barbehenn" class="author url fn" rel="author">Brittany Barbehenn</a>        </p>
        <p><time datetime="2018-07-13T12:00:16+00:00">July 13, 2018 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/dot-bit/" rel="tag">dot-bit</a>, <a href="https://unit42.paloaltonetworks.com/tag/downloader/" rel="tag">Downloader</a>, <a href="https://unit42.paloaltonetworks.com/tag/namecoin/" rel="tag">Namecoin</a>, <a href="https://unit42.paloaltonetworks.com/tag/upatre/" rel="tag">Upatre</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="600" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg 600w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-300x150.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-370x185.jpg 370w" sizes="(max-width: 600px) 100vw, 600px" />            </figure>
                    <p>First discovered in 2013, Upatre is primarily a downloader tool responsible for delivering additional trojans onto the victim host. It is most well-known for being tied with the Dyre banking trojan, with a peak of over 250,000 Upatre infections per month delivering Dyre back in July 2015. In November 2015 however, an organization thought to be associated with the Dyre operation was raided, and subsequently the usage of Upatre delivering Dyre dropped dramatically, to less than 600 per month by January 2016.<br />
Today, the Upatre downloader tool is effectively no longer in use by criminal organizations. However, one of the many interesting aspects of the Upatre tool had always been its constant adaptive nature where the developers continuously added features and capabilities to the tool to increase its efficacy.<br />
In March 2018, Unit 42 researchers collected a sample of Upatre which was compiled in December 2016 but at the time was largely undetectable by most automated detection systems . Because of this, we analyzed the sample to afford awareness to those interested in this malware and its evolution. This previously undocumented variant features significant code flow obscuration, a pro re nata means of decryption for network communications, and of particular interest, the method in which this variant evades virtual machine detection.<br />
In this post we highlight these techniques identified during our analysis.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Malware Overview</span><br />
Upatre is a stage-0 malware, which basically means it’s a downloader.   The malware is used to download and install a payload onto the affected system.  The payload is retrieved from hardcoded domain(s) and is typically another piece of malware. Historically, Upatre has acted as a downloader for malware families such as <a href="https://www.symantec.com/security-center/writeup/2014-061713-0826-99">Dyre</a>, <a href="https://www.us-cert.gov/ncas/alerts/TA16-091A">GameOver Zeus</a>, <a href="https://securityintelligence.com/the-necurs-botnet-a-pandoras-box-of-malicious-spam/">Kegotip, Locky, and Dridex</a> to name a few. However, in this case no payload was delivered. Additionally, variants such as this one collect information from the target and transmit the data via an HTTP POST request.<br />
This newly observed variant comes packed with several characteristics and capabilities that stood out to us during analysis.  Attributes in the PE header suggest that the malware is written in Visual C++ and several of the PE sections have high entropy classification, which indicates that the binary is packed.  The PE resource section also contains images of Google Chrome, so when the binary is placed on the target machine, it appears to be that of the Google Chrome web browser.<br />
One of the key features about this variant that stood out during our analysis is how it detects whether or not it is running within a virtual machine. Although virtual machine detection is anything but new, in this variant, it is handled a bit differently than <a href="https://researchcenter.paloaltonetworks.com/2015/10/ticked-off-upatre-malwares-simple-anti-analysis-trick-to-defeat-sandboxes/">other samples</a> previously analyzed by Unit 42.  To, evade detection, the newly observed variant enumerates the running processes on the host, generates a CRC32 hash of the process name, performs an XOR with a hard-coded key of 0x0F27DC411, and finally compares the newly computed value against a list of values stored in an array within the code.  We observed the following values:</p>
<table align="center">
<tbody>
<tr>
<td width="125">0x6BA08023</td>
<td width="125">0xDFF859A5</td>
<td width="125">0x9649C9DF</td>
<td width="125">0x91B88065</td>
<td width="125">0xF663B61C</td>
</tr>
<tr>
<td width="125">0xC6E1589A</td>
<td width="125">0xC63B2FDF</td>
<td width="125">0xA9D475EF</td>
<td width="125">0xCE9F7AE2</td>
<td width="125">0xCF3B343A</td>
</tr>
<tr>
<td width="125">0x85D3D4E6</td>
<td width="125">0x1392D4C</td>
<td width="125">0xDFC3A97E</td>
<td width="125">0x51ACC655</td>
<td width="125">0xEF0F2980</td>
</tr>
<tr>
<td width="125">0x64EEAFAF</td>
<td width="125">0xD5F11B49</td>
<td width="125">0xC9823C94</td>
<td width="125">0x9F4EE7C8</td>
<td width="125">0x403C2A93</td>
</tr>
<tr>
<td width="125">0x6A50A975</td>
<td width="125">0xECCCD158</td>
<td width="125">0xED3CF80E</td>
<td width="125">0x209202D5</td>
<td width="125">0x2C6668C3</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
This version of Upatre will <strong><u>not</u></strong> transmit any data via HTTP POST to any of the target domains if one of these values is found.<br />
In the event one of the values are found, the malware will sleep for six seconds and then will restart the entire check again.<br />
We were unable to determine every corresponding process name from the CRC32 list above, however, we were able to decipher the following process names:</p>
<table align="center">
<tbody>
<tr>
<td width="312">Process Name</td>
<td width="312">CRC32</td>
</tr>
<tr>
<td width="312">vmtoolsd.exe</td>
<td width="312">0xD5F11B49</td>
</tr>
<tr>
<td width="312">vmacthlp.exe</td>
<td width="312">0x403C2A93</td>
</tr>
<tr>
<td width="312">Python.exe</td>
<td width="312">0x209202D5</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
Other notable functionality of this new version of the Upatre malware includes:</p>
<ul>
<li>In-memory loading of code</li>
<li>Disables the following Windows services:
<ul>
<li>Windows Security Center</li>
<li>Internet Connection Sharing</li>
<li>Windows Firewall</li>
<li>Windows Defender</li>
<li>Windows Update</li>
<li>Windows Defender Network Inspection Service</li>
</ul>
</li>
<li>Disables Windows security notification balloons on Windows 7 and up</li>
<li>Disables Internet Explorer Phishing Filter</li>
<li>Disables Windows User Access Control Notifications</li>
<li>Launches a trusted Windows application msiexec.exe and injects code into its memory space using an undocumented technique</li>
<li>Heavy use of obfuscated and optimized code to thwart code analysis</li>
<li>Use of non-essential Windows API&#8217;s for stack pivoting to mask intended API</li>
<li>Multiple layers of custom encoding used for individual strings decoding. Does not share encoding routine with other encoded values</li>
</ul>
<p>&nbsp;<br />
<span style="font-size: 18pt;">Network Communication</span><br />
Another feature of this sample is the use of top level domains (TLD) of. bit. The intended domains are encrypted and only decrypted when the malware is ready to use them. This new sample attempts to resolve two domains, bookreader[.]bit and doghunter[.]bit via the following hardcoded DNS Servers:</p>
<ul>
<li>31.3.135[.]232</li>
<li>193.183.98[.]154</li>
<li>5.135.183[.]146</li>
<li>84.201.32[.]108</li>
<li>185.133.72[.]100</li>
<li>96.90.175[.]167</li>
<li>104.238.186[.]189</li>
</ul>
<p>DNS resolution for .bit domains use hardcoded DNS servers and is handled via TCP versus traditional UDP. This is because .bit domains are based on Namecoin and aren’t regulated by ICANN. Additionally, the hardcoded DNS server IPs we identified in this sample are all associated with OpenNIC Public DNS servers.<br />
According to <a href="https://wiki.opennic.org/opennic/dot/bit">OpenNIC</a>, when using OpenNIC DNS servers .bit domains are resolved through centralized servers that generate a DNS zone from the Namecoin blockchain; therefore, the secure nature of using Namecoin as a decentralized means of DNS is not actually being utilized here.<br />
If domain resolution is successful, the malware will then perform an HTTP POST request similar to the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928893d24f575471798" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST / HTTP/1.0
Host: bookreader[.]bit
Content-Length: 1024
Þm    á9,9r.@¿æ[."    Š?.àì..Cl„8f·Ö'LsÃøPi;±›hÏÀ¨*-2IóÙ4²R–k"à{..rè!..~5¹­qr^.¡h•âÔ?ý.ˆ¬–À$.Ÿ?óa..r(ì ÑÖ¹Û.Î.·‹ÅE.ûÉn¯&amp;{qûÿ´©Ø.öî",.YÒ!p†³3jÓ_sÐ.Páu»..­KŠ†ÐïwÂ:š.¦Ú÷€âC
naH¾Û.½†¸q.TJ7.¾šB' ?.®îîGHxãGd\¦jæµ.jGæûsðá].8®.Ï.X#8ç.Ô&lt;­¹6ßŽÄ.­î¥µ.ù..€¬«ˆ@æ_t.,á.‡q.Ô¤.'³åÿW·äZ.ìa:©"ïIãÌ.¤ô~œ    ïÒ§vBå|Ù«Ìfa.„{7Œìt.˜l_.ŒKNEÏg'¸O‹¯IWy.²«•    Ú…•j'Û'Š.b.t‡|Å..Œn†´ÕK¨‰»%ðfh    Eºw*¤šf‰Ò2š'¥V..qZÖ(«86ç ˜W©g†ÕËÖ™."Í.Õüþs8Ts½.=Ö\ókÌäE¨Ë†&gt;¡¾ü\±ˆbÂï&gt;;9.Ã'ØœZuá©:=ÇTx˜ufýÉg.Ã·.Šâ­&gt;.Èq.Ó9wnÖ.Ö[aöÝÇé1.Ÿ†HÁè–¡&gt;EhÂÙ.9©!©t ."`éh.™^).ž½C.,º3õnØÑÙéîN0`-°[1×ß(J.ÃwXô`¥Ø÷²';B1/¤¤+wTg›¾Qf-ß.ÿ"|fßX.,ãAÝêâºøbËe¾8X.0‡h…i9ÊŸF÷~GÞ­=..Œþj'&gt;Ž.°øô."U„ ÖóÙæ¯'s.O/oŒØã‰sœàá‡.Ø2ú{Œ»êt»§hé±.Z#r.é.&lt;ýj®½Ü¡\(.….%ñŽËj..œ.¶­Dì"®Ñ2xf4+ÀŒÖföUv•ê\.äÓó¢Íéô¥.    „¦©V…–3×.Y.ŒÔm8ò@†.~b«Ñ—..JW/éé.eE.Ó.¬†
89.E(=áø"¿.&gt;ø»¾åêŠ.¬2©Áä¬xýËù&lt;š.Ð.;éàE‰+&amp;xAEç&gt;"@LpßÇ¢7ãÔÞ@­~Âfß+Z±*òF=aWÂÖµÐe_ëÆ§ë&amp;`|.&gt;VøÂá.C7ñ‚¯iÚ.µ.´)!Ïª.ÇyO[‹¾?Js¨e
jKß±¯Z].613ŒÐ.|XÝõÿÊý;nU0Mw‚M»«½:Û?/æ.$)¶ì_X.p.q.8.Ÿj€¬.œàï..B·âoŽM.êÅb¥8aÕù©s$ÏmhT£»¤/wwÆ6
y=€ƒÖG™Úu yÍÆ²".® !BùìâÃ.=¦6&lt;)º
5M´yótI\</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928893d24f575471798-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d24f575471798-2">2</div><div class="crayon-num" data-line="crayon-5f6928893d24f575471798-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d24f575471798-4">4</div><div class="crayon-num" data-line="crayon-5f6928893d24f575471798-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d24f575471798-6">6</div><div class="crayon-num" data-line="crayon-5f6928893d24f575471798-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d24f575471798-8">8</div><div class="crayon-num" data-line="crayon-5f6928893d24f575471798-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928893d24f575471798-1"><span class="crayon-v">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d24f575471798-2"><span class="crayon-v">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">bookreader</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">bit</span></div><div class="crayon-line" id="crayon-5f6928893d24f575471798-3"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1024</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d24f575471798-4">Þ<span class="crayon-i">m</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>á<span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-cn">9r.</span><span class="crayon-sy">@</span>¿æ<span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;Š?.àì..Cl„8f·Ö'LsÃøPi;±›hÏÀ¨*-2IóÙ4²R–k"</span>à<span class="crayon-sy">{</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-i">r</span>è<span class="crayon-o">!</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-o">~</span><span class="crayon-cn">5</span>¹­<span class="crayon-v">qr</span><span class="crayon-o">^</span><span class="crayon-sy">.</span>¡<span class="crayon-i">h</span>•âÔ<span class="crayon-sy">?</span>ý<span class="crayon-sy">.</span>ˆ¬–À<span class="crayon-sy">$</span><span class="crayon-sy">.</span>Ÿ<span class="crayon-sy">?</span>ó<span class="crayon-v">a</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-e">r</span><span class="crayon-sy">(</span>ì<span class="crayon-h"> </span>ÑÖ¹Û<span class="crayon-sy">.</span>Î<span class="crayon-sy">.</span>·‹Å<span class="crayon-v">E</span><span class="crayon-sy">.</span>ûÉ<span class="crayon-e">n</span>¯<span class="crayon-o">&amp;</span><span class="crayon-sy">{</span><span class="crayon-i">q</span>ûÿ´©Ø<span class="crayon-sy">.</span>öî<span class="crayon-s">",.YÒ!p†³3jÓ_sÐ.Páu»..­KŠ†ÐïwÂ:š.¦Ú÷€âC</span></div><div class="crayon-line" id="crayon-5f6928893d24f575471798-5"><span class="crayon-s">naH¾Û.½†¸q.TJ7.¾šB' ?.®îîGHxãGd\¦jæµ.jGæûsðá].8®.Ï.X#8ç.Ô&lt;­¹6ßŽÄ.­î¥µ.ù..€¬«ˆ@æ_t.,á.‡q.Ô¤.'³åÿW·äZ.ìa:©"</span>ï<span class="crayon-i">I</span>ãÌ<span class="crayon-sy">.</span>¤ô<span class="crayon-o">~</span>œ<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>ïÒ§<span class="crayon-i">vB</span>å<span class="crayon-o">|</span>Ù«Ì<span class="crayon-v">fa</span><span class="crayon-sy">.</span>„<span class="crayon-sy">{</span><span class="crayon-cn">7</span>Œì<span class="crayon-v">t</span><span class="crayon-sy">.</span>˜<span class="crayon-v">l_</span><span class="crayon-sy">.</span>Œ<span class="crayon-i">KNE</span>Ï<span class="crayon-i">g</span><span class="crayon-s">'¸O‹¯IWy.²«•&nbsp;&nbsp;&nbsp;&nbsp;Ú…•j'</span>Û<span class="crayon-s">'Š.b.t‡|Å..Œn†´ÕK¨‰»%ðfh&nbsp;&nbsp;&nbsp;&nbsp;Eºw*¤šf‰Ò2š'</span>¥<span class="crayon-v">V</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-i">qZ</span>Ö<span class="crayon-sy">(</span>«<span class="crayon-cn">86</span>ç<span class="crayon-h"> </span>˜<span class="crayon-i">W</span>©<span class="crayon-i">g</span>†ÕËÖ™<span class="crayon-sy">.</span><span class="crayon-s">"Í.Õüþs8Ts½.=Ö\ókÌäE¨Ë†&gt;¡¾ü\±ˆbÂï&gt;;9.Ã'ØœZuá©:=ÇTx˜ufýÉg.Ã·.Šâ­&gt;.Èq.Ó9wnÖ.Ö[aöÝÇé1.Ÿ†HÁè–¡&gt;EhÂÙ.9©!©t ."</span><span class="crayon-sy">`</span>é<span class="crayon-v">h</span><span class="crayon-sy">.</span>™<span class="crayon-o">^</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span>ž½<span class="crayon-v">C</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span>º<span class="crayon-cn">3</span>õ<span class="crayon-i">n</span>ØÑÙéî<span class="crayon-v">N0</span><span class="crayon-sy">`</span><span class="crayon-o">-</span>°<span class="crayon-sy">[</span><span class="crayon-cn">1</span>×ß<span class="crayon-sy">(</span><span class="crayon-v">J</span><span class="crayon-sy">.</span>Ã<span class="crayon-i">wX</span>ô<span class="crayon-sy">`</span>¥Ø÷²<span class="crayon-s">';B1/¤¤+wTg›¾Qf-ß.ÿ"|fßX.,ãAÝêâºøbËe¾8X.0‡h…i9ÊŸF÷~GÞ­=..Œþj'</span><span class="crayon-o">&gt;</span>Ž<span class="crayon-sy">.</span>°øô<span class="crayon-sy">.</span><span class="crayon-s">"U„ ÖóÙæ¯'s.O/oŒØã‰sœàá‡.Ø2ú{Œ»êt»§hé±.Z#r.é.&lt;ýj®½Ü¡<span class="crayon-sy">\</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span>…<span class="crayon-sy">.</span><span class="crayon-o">%</span>ñŽË<span class="crayon-v">j</span><span class="crayon-o">..</span>œ<span class="crayon-sy">.</span>¶­<span class="crayon-i">D</span>ì<span class="crayon-s">"®Ñ2xf4+ÀŒÖföUv•ê\.äÓó¢Íéô¥.&nbsp;&nbsp;&nbsp;&nbsp;„¦©V…–3×.Y.ŒÔm8ò@†.~b«Ñ—..JW/éé.eE.Ó.¬†</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d24f575471798-6"><span class="crayon-s">89.E(=áø"</span>¿<span class="crayon-sy">.</span><span class="crayon-o">&gt;</span>ø»¾åêŠ<span class="crayon-sy">.</span>¬<span class="crayon-cn">2</span>©Áä¬<span class="crayon-i">x</span>ýËù<span class="crayon-o">&lt;</span>š<span class="crayon-sy">.</span>Ð<span class="crayon-sy">.</span><span class="crayon-sy">;</span>éà<span class="crayon-i">E</span>‰<span class="crayon-o">+</span><span class="crayon-o">&amp;</span><span class="crayon-i">xAE</span>ç<span class="crayon-o">&gt;</span>"<span class="crayon-sy">@</span><span class="crayon-i">Lp</span>ßÇ¢<span class="crayon-cn">7</span>ãÔÞ<span class="crayon-sy">@</span>­<span class="crayon-o">~</span>Â<span class="crayon-i">f</span>ß<span class="crayon-o">+</span><span class="crayon-i">Z</span>±<span class="crayon-o">*</span>ò<span class="crayon-v">F</span><span class="crayon-o">=</span><span class="crayon-i">aW</span>ÂÖµÐ<span class="crayon-v">e</span><span class="crayon-sy">_</span>ëÆ§ë<span class="crayon-o">&amp;</span><span class="crayon-sy">`</span><span class="crayon-o">|</span><span class="crayon-sy">.</span><span class="crayon-o">&gt;</span><span class="crayon-i">V</span>øÂá<span class="crayon-sy">.</span><span class="crayon-v ">C7</span>ñ‚¯<span class="crayon-i">i</span>Ú<span class="crayon-sy">.</span>µ<span class="crayon-sy">.</span>´<span class="crayon-sy">)</span>!Ïª.ÇyO[‹¾?Js¨e</span></div><div class="crayon-line" id="crayon-5f6928893d24f575471798-7"><span class="crayon-s">jKß±¯Z].613ŒÐ.|XÝõÿÊý;nU0Mw‚M»«½:Û?/æ.$)¶ì_X.p.q.8.Ÿj€¬.œàï..B·âoŽM.êÅb¥8aÕù©s$ÏmhT£»¤/wwÆ6</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d24f575471798-8"><span class="crayon-s">y=€ƒÖG™Úu yÍÆ²"</span><span class="crayon-sy">.</span>®<span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-i">B</span>ùìâÃ<span class="crayon-sy">.</span><span class="crayon-o">=</span>¦<span class="crayon-cn">6</span><span class="crayon-o">&lt;</span><span class="crayon-sy">)</span>º</div><div class="crayon-line" id="crayon-5f6928893d24f575471798-9"><span class="crayon-cn">5M</span>´<span class="crayon-i">y</span>ó<span class="crayon-v">tI</span><span class="crayon-sy">\</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>Note, the HTTP POST does not contain any User-Agent strings.<br />
At this time, we don’t fully understand the encryption method; however, we know that the data sent in the POST request is encrypted using a custom encryption algorithm.  Below is an example of data captured prior to encryption:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928893d25b906750639" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
00000000   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ................
00000010   00 00 00 00 60 00 00 00  00 00 00 00 01 00 00 00   ....`...........
00000020   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ................
00000030   11 27 00 00 00 00 00 00  20 00 00 00 20 00 00 00   .'...... ... ...
00000040   57 49 4E 2D 52 49 38 38  4C 38 56 4D 45 38 4D 5F   WIN-RI88L8VME8M_
00000050   45 35 33 32 36 34 38 41  37 36 31 46 34 43 35 41   E532648A761F4C5A
00000060   AB AB AB AB AB AB AB AB  00 00 00 00 00 00 00 00   ««««««««........
00000070   8B BB 9F 39 09 63 00 00  30 28 31 00 08 21 31 00   ‹»Ÿ9.c..0(1..!1.
00000080   EE FE EE FE EE FE EE FE  EE FE EE FE EE FE EE FE   îþîþîþîþîþîþîþîþ
00000090   EE FE EE FE EE FE EE FE  EE FE EE FE EE FE EE FE   îþîþîþîþîþîþîþîþ
000000A0   9F BB 9C 2E 00 63 00 18  70 1B 31 00 60 21 31 00   Ÿ»œ..c..p.1.`!1.
000000B0   78 1B 31 00 68 21 31 00  70 21 31 00 80 CF 2B 00   x.1.h!1.p!1.€Ï+.
000000C0   00 00 1D 74 8D 12 1D 74  00 70 00 00 3C 00 3E 00   ...t...t.p..&lt;.&gt;.
000000D0   38 20 31 00 14 00 16 00  60 20 31 00 04 40 0C 00   8 1.....` 1..@..
000000E0   01 00 00 00 B0 A6 BA 77  BC 38 28 00 43 DB 5B 4A   ....°¦ºw¼8(.CÛ[J
000000F0   00 00 00 00 00 00 00 00  F8 1F 31 00 F8 1F 31 00   ........ø.1.ø.1.
00000100   00 20 31 00 00 20 31 00  38 23 31 00 90 20 31 00   . 1.. 1.8#1.. 1.
00000110   54 05 B4 77 00 00 D9 3F  D5 8A 48 B8 82 D1 D3 01   T.´w..Ù?ÕŠH¸‚ÑÓ.
00000120   AB AB AB AB AB AB AB AB  00 00 00 00 00 00 00 00   ««««««««........
00000130   86 BB 9C 37 14 63 00 1A  43 00 3A 00 5C 00 57 00   †»œ7.c..C.:.\.W.
00000140   69 00 6E 00 64 00 6F 00  77 00 73 00 5C 00 73 00   i.n.d.o.w.s.\.s.
00000150   79 00 73 00 74 00 65 00  6D 00 33 00 32 00 5C 00   y.s.t.e.m.3.2.\.
00000160   57 00 49 00 4E 00 4E 00  53 00 49 00 2E 00 44 00   W.I.N.N.S.I...D.</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-2">2</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-4">4</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-6">6</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-8">8</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-10">10</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-12">12</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-14">14</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-16">16</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-18">18</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-20">20</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928893d25b906750639-22">22</div><div class="crayon-num" data-line="crayon-5f6928893d25b906750639-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928893d25b906750639-1"><span class="crayon-cn">00000000</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-2"><span class="crayon-cn">00000010</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">01</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">`</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-3"><span class="crayon-cn">00000020</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-4"><span class="crayon-cn">00000030</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span>'<span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-5"><span class="crayon-cn">00000040</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">57</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-h"> </span><span class="crayon-cn">4E</span><span class="crayon-h"> </span><span class="crayon-cn">2D</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">4C</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">56</span><span class="crayon-h"> </span><span class="crayon-cn">4D</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">4D</span><span class="crayon-h"> </span><span class="crayon-cn">5F</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">WIN</span><span class="crayon-o">-</span><span class="crayon-v">RI88L8VME8M</span><span class="crayon-sy">_</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-6"><span class="crayon-cn">00000050</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">37</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">E532648A761F4C5A</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-7"><span class="crayon-cn">00000060</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-i">AB</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span>««««««««<span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-8"><span class="crayon-cn">00000070</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">8B</span><span class="crayon-h"> </span><span class="crayon-i">BB</span><span class="crayon-h"> </span><span class="crayon-cn">9F</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-h"> </span><span class="crayon-cn">09</span><span class="crayon-h"> </span><span class="crayon-cn">63</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">08</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span>‹»Ÿ<span class="crayon-cn">9.c..0</span><span class="crayon-sy">(</span><span class="crayon-cn">1..</span><span class="crayon-o">!</span><span class="crayon-cn">1.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-9"><span class="crayon-cn">00000080</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE&nbsp;&nbsp;</span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-i">FE</span><span class="crayon-h">&nbsp;&nbsp; </span>îþîþîþîþîþîþîþîþ</div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-10"><span class="crayon-cn">00000090</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE&nbsp;&nbsp;</span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-e">FE </span><span class="crayon-e">EE </span><span class="crayon-i">FE</span><span class="crayon-h">&nbsp;&nbsp; </span>îþîþîþîþîþîþîþîþ</div><div class="crayon-line" id="crayon-5f6928893d25b906750639-11"><span class="crayon-cn">000000A0</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">9F</span><span class="crayon-h"> </span><span class="crayon-i">BB</span><span class="crayon-h"> </span><span class="crayon-cn">9C</span><span class="crayon-h"> </span><span class="crayon-cn">2E</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">63</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-cn">1B</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span>Ÿ»œ<span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-cn">1.</span><span class="crayon-sy">`</span><span class="crayon-o">!</span><span class="crayon-cn">1.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-12"><span class="crayon-cn">000000B0</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">78</span><span class="crayon-h"> </span><span class="crayon-cn">1B</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">68</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-h"> </span><span class="crayon-i">CF</span><span class="crayon-h"> </span><span class="crayon-cn">2B</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-cn">1.h</span><span class="crayon-o">!</span><span class="crayon-cn">1.p</span><span class="crayon-o">!</span><span class="crayon-cn">1.</span>€Ï<span class="crayon-o">+</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-13"><span class="crayon-cn">000000C0</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">1D</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">8D</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-h"> </span><span class="crayon-cn">1D</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">3C</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">3E</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-o">&lt;</span><span class="crayon-sy">.</span><span class="crayon-o">&gt;</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-14"><span class="crayon-cn">000000D0</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">60</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">04</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-cn">0C</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">8</span><span class="crayon-h"> </span><span class="crayon-cn">1.....</span><span class="crayon-sy">`</span><span class="crayon-h"> </span><span class="crayon-cn">1..</span><span class="crayon-sy">@</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-15"><span class="crayon-cn">000000E0</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">01</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-e">B0 </span><span class="crayon-e">A6 </span><span class="crayon-i">BA</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">BC</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">5B</span><span class="crayon-h"> </span><span class="crayon-cn">4A</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span>°¦º<span class="crayon-i">w</span>¼<span class="crayon-cn">8</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-i">C</span>Û<span class="crayon-sy">[</span><span class="crayon-i">J</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-16"><span class="crayon-cn">000000F0</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">F8</span><span class="crayon-h"> </span><span class="crayon-cn">1F</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-i">F8</span><span class="crayon-h"> </span><span class="crayon-cn">1F</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span>ø<span class="crayon-sy">.</span><span class="crayon-cn">1.</span>ø<span class="crayon-sy">.</span><span class="crayon-cn">1.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-17"><span class="crayon-cn">00000100</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">23</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-cn">1..</span><span class="crayon-h"> </span><span class="crayon-cn">1.8</span><span class="crayon-p">#1.. 1.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-18"><span class="crayon-cn">00000110</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">54</span><span class="crayon-h"> </span><span class="crayon-cn">05</span><span class="crayon-h"> </span><span class="crayon-i">B4</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-i">D9</span><span class="crayon-h"> </span><span class="crayon-cn">3F</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">D5</span><span class="crayon-h"> </span><span class="crayon-cn">8A</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-i">B8</span><span class="crayon-h"> </span><span class="crayon-cn">82</span><span class="crayon-h"> </span><span class="crayon-e">D1 </span><span class="crayon-i">D3</span><span class="crayon-h"> </span><span class="crayon-cn">01</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">T</span><span class="crayon-sy">.</span>´<span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span>Ù<span class="crayon-sy">?</span>ÕŠ<span class="crayon-i">H</span>¸‚ÑÓ<span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-19"><span class="crayon-cn">00000120</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-e">AB </span><span class="crayon-i">AB</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span>««««««««<span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-20"><span class="crayon-cn">00000130</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">86</span><span class="crayon-h"> </span><span class="crayon-i">BB</span><span class="crayon-h"> </span><span class="crayon-cn">9C</span><span class="crayon-h"> </span><span class="crayon-cn">37</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-h"> </span><span class="crayon-cn">63</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">1A</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">3A</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">5C</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">57</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span>†»œ<span class="crayon-cn">7.c..C.</span><span class="crayon-o">:</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-v">W</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-21"><span class="crayon-cn">00000140</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">69</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">6E</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">6F</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">77</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">73</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">5C</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">73</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">i</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">.</span><span class="crayon-v">d</span><span class="crayon-sy">.</span><span class="crayon-v">o</span><span class="crayon-sy">.</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928893d25b906750639-22"><span class="crayon-cn">00000150</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">79</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">73</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">6D</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">5C</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-cn">3.2.</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f6928893d25b906750639-23"><span class="crayon-cn">00000160</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">57</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">4E</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">4E</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">53</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">2E</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">W</span><span class="crayon-sy">.</span><span class="crayon-v">I</span><span class="crayon-sy">.</span><span class="crayon-v">N</span><span class="crayon-sy">.</span><span class="crayon-v">N</span><span class="crayon-sy">.</span><span class="crayon-v">S</span><span class="crayon-sy">.</span><span class="crayon-v">I</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">D</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0058 seconds] -->
<p>&nbsp;<br />
<span style="font-size: 18pt;">Obscuring Code Flow</span><br />
This version of Upatre contains significantly obfuscated code to increase the difficulty of analysis.  Figure 1 below shows an example API call disassembled in IDA Pro.<br />
&nbsp;<br />
<img class="aligncenter wp-image-81620" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_1-1.png" alt="Upatre_1" width="600" height="116" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_1-1.png 1979w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_1-1-900x173.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_1-1-300x58.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_1-1-768x148.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_1-1-1024x197.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_1-1-370x71.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;</p>
<p style="text-align: center;"><em>Figure 1-IDA Disassembly of API call</em></p>
<p>For conventional naming, the function at address 0x00137ED6 has been renamed to the Windows API  <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724911%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396">RegQueryValueEx</a>_0.  According to MSDN this function takes six parameters, the frame pointer is ESP based and the stack frame would resemble the following:<br />
&nbsp;<br />
<img class="aligncenter wp-image-81581" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_2-1.png" alt="Upatre_2" width="600" height="390" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_2-1.png 1620w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_2-1-900x585.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_2-1-300x195.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_2-1-768x499.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_2-1-1024x666.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_2-1-370x241.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 2-Inside Func_RegQueryvalueEx_0</em></p>
<p>&nbsp;<br />
In the above figure, Func_RegQueryValueEx_0 is EBP based and performs the following:</p>
<ul>
<li>Saves the current stack pointer in EBP</li>
<li>The stack pointer is adjusted 268 bytes (thwarting stack frame analysis)</li>
<li>Pushes a pointer, which points to the REGKEY string</li>
</ul>
<p>After the call into sub_140CBE the stack would resemble the following:<br />
<img class="aligncenter wp-image-81542" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_3-1.png" alt="Upatre_3" width="600" height="329" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_3-1.png 1877w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_3-1-900x493.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_3-1-300x164.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_3-1-768x421.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_3-1-1024x561.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_3-1-370x203.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 3&#8211;Inside Sub_140CBE</em></p>
<p>&nbsp;<br />
Function Sub_140CBE does the following:</p>
<ul>
<li>Pushes 0x13 on the stack</li>
<li>Calls another function, which ends up jumping into the Windows API GetSystemMetrics</li>
</ul>
<p>0x13 is the SM_CSURSOR index used by GetSystemMetrics, which returns the width of a cursor in pixels.  Retrieving this value has <strong>no</strong> bearing on the program as the return value is not used.<br />
How the stack looks after the call to func_GetSytemMetrics<br />
&nbsp;<br />
<img class="aligncenter wp-image-81503" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_4-1.png" alt="Upatre_4" width="600" height="301" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_4-1.png 1999w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_4-1-900x451.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_4-1-300x150.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_4-1-768x385.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_4-1-1024x513.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_4-1-370x185.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 4&#8211;Inside Func_GetSystemMetrics</em></p>
<p>&nbsp;<br />
Some interesting observations about this function:</p>
<ul>
<li>The JMP instruction is used versus the CALL instruction as JMP doesn’t affect the stack.</li>
<li>The two PUSH instructions are junk values and only used to pivot the stack, so the correct return address is on the stack during the return.</li>
</ul>
<p>Here is how the stack looks prior to the jump:<br />
&nbsp;<br />
<img class="aligncenter wp-image-81659" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_5-1.png" alt="Upatre_5" width="600" height="256" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_5-1.png 1999w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_5-1-900x384.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_5-1-300x128.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_5-1-768x327.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_5-1-1024x436.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/07/Upatre_5-1-370x158.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
Return address <strong>0x001414FD</strong> is the address that is used to open and query the hosts registry, and this is the target address after executing the above instructions.  The return code flow is as follows:</p>
<ol>
<li>The two junk data values pushed on the stack are cleared during the executing of the GetSystemMetrics API.</li>
<li>The stack pointer is incremented past 0x13</li>
<li>Address 0x00140CC5 has a retn instruction</li>
<li>Address 0x001414FD is now on the top of the stack and the section within the malware that handles Windows registry enumeration is called (RegQueryValueEx).</li>
</ol>
<p>This stack pivot is performed entirely to make static analysis of the file more difficult, but the end result is still that the API function executes, and the malware accomplishes its task.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Persistence Technique</span><br />
To establish persistence, this new version of Upatre creates the following registry key:<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run\</p>
<ul>
<li>String value&#8211;&gt;x$msbuild where x$ is a random alpha character. <em>Note: the name of the binary depends on the executable that is running.  The stub program grabs the Windows name of the EXE and prepends it with a random value.  </em></li>
<li>Data &#8211;&gt;C:\ProgramData\MSBuild\x$exe</li>
</ul>
<p>File x$MSBuild.exe is then copied to the host&#8217;s C:\ProgramData\MSBuild folder.<br />
&nbsp;</p>
<p style="margin: 0in 0in 8.0pt 0in;"><span style="font-size: 18pt;">Conclusion</span></p>
<p>In our data, we have observed over 119,000 unique malware samples that use dot-bit (.bit) domains for C2 infrastructure as early as 2014.  Malware families observed include Necurs, GandCrab, Vobfus, Tofsee, Floxif, Ramnit, and several others.<br />
Due to the C2 domains being down at the time of our analysis, which was unsurprising given the potential age of the sample, we were never able to capture the ultimate payload for this new Upatre variant.  However, open source analysis on this variant identified another sample configured with the same dot-bit domains.  The sample, 94a8b4b22dab4171edde5b1bafbf2f17dbe3c3c4c01335c36ba3b6e5d3635b83, was compiled six days after our Upatre sample and delivered the Chthonic banking trojan via RIG exploit kit.<br />
Although the delivery mechanism was not observed during our analysis, Upatre typically arrives via an email link/attachment or through a compromised website.<br />
&nbsp;<br />
<strong>Defending Against this Threat</strong><br />
The Upatre malware is constantly changing and is capable of downloading many different malware families, some, destructive.  Using threat detection and prevention solutions such as the Palo Alto Networks next-generation security platform are highly recommended as part of a proactive cyber security strategy. WildFire and Traps both detect the samples described in this report as malicious.<br />
Not all dot-bit domains are malicious, but organizations should take steps to ensure they can control access to all potentially malicious domains. Blocking outbound access to DNS servers and re-routing DNS requests to internally controlled DNS servers can help protect a network from malware using dot-bit domains provided by the Namecoin network.<br />
Palo Alto Networks customers remain protected from Upatre and can identify this threat using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Upatre">Upatre</a> tag in AutoFocus.<br />
<strong><br />
Indicators of compromise associated with this analysis include:</strong><br />
<strong><br />
</strong><strong>Upatre</strong><br />
SHA256:   8ac7909730269d62efaf898d1a5e87251aadccf4349cd95564ad6a3634ba4ef4<br />
<strong>Cthonic</strong><br />
SHA256:   94a8b4b22dab4171edde5b1bafbf2f17dbe3c3c4c01335c36ba3b6e5d3635b83<br />
<strong>C2s</strong><br />
Domain:   doghunter[.]bit<br />
Domain:   bookreader[.]bit<br />
IP Address:  31.3.135[.]232<br />
IP Address:  193.183.98[.]154<br />
IP Address:  5.135.183[.]146<br />
IP Address:  84.201.32[.]108<br />
IP Address:  185.133.72[.]100<br />
IP Address:  96.90.175[.]167<br />
IP Address:  104.238.186[.]189<br />
&nbsp;<br />
Updated on 7/13/2018 to clarify that the Upatre sample discussed was compiled in 2016 but is newly discovered in 2018 and to more clearly identify samples with their hashes.</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
