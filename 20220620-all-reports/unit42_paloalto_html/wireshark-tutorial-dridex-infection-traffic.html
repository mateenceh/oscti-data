
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Wireshark Tutorial: Examining Dridex Infection Traffic</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/wireshark-tutorial-dridex-infection-traffic/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="This Wireshark tutorial reviews Dridex activity and provides some helpful tips on identifying this family and examining Dridex infection traffic."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Wireshark Tutorial: Examining Dridex Infection Traffic" />
<meta property="og:description" content="This Wireshark tutorial reviews Dridex activity and provides some helpful tips on identifying this family and examining Dridex infection traffic." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Dridex" />
<meta property="article:tag" content="pcap" />
<meta property="article:tag" content="tutorial" />
<meta property="article:tag" content="Wireshark" />
<meta property="article:tag" content="Wireshark Tutorial" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2020-10-23T16:00:54+00:00" />
<meta property="article:modified_time" content="2020-10-23T15:19:31+00:00" />
<meta property="og:updated_time" content="2020-10-23T15:19:31+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512.png" />
<meta property="og:image:width" content="900" />
<meta property="og:image:height" content="512" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="This Wireshark tutorial reviews Dridex activity and provides some helpful tips on identifying this family and examining Dridex infection traffic." />
<meta name="twitter:title" content="Wireshark Tutorial: Examining Dridex Infection Traffic" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Wireshark Tutorial: Examining Dridex Infection Traffic Comments Feed" href="https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/feed/" />
<meta property="og:likes" content="6"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="2,252"/>
<meta property="og:date_created" content="October 23, 2020 at 9:00 AM"/>
<meta property="og:post_length" content="3120"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Brad Duncan"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bduncan/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Duncan-bio-picture-1-copy-150x150.jpg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512-380x184.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Wireshark Tutorial: Examining Dridex Infection Traffic","name":"Wireshark Tutorial: Examining Dridex Infection Traffic","description":"This Wireshark tutorial reviews Dridex activity and provides some helpful tips on identifying this family and examining Dridex infection traffic. ","url":"https:\/\/unit42.paloaltonetworks.com\/wireshark-tutorial-dridex-infection-traffic\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/wireshark-tutorial-dridex-infection-traffic\/","datePublished":"October 23, 2020","articleBody":"Executive Summary\r\nThis tutorial is designed for security professionals who investigate suspicious network activity and review network packet captures (pcaps). Familiarity with Wireshark is necessary to understand this tutorial, which focuses on Wireshark version 3.x.\r\n\r\nDridex is the name for a family of information-stealing malware that has also been described as a banking Trojan. This malware first appeared in 2014 and has been active ever since.\r\n\r\nToday\u2019s Wireshark tutorial reviews Dridex activity and provides some helpful tips on identifying this family based on traffic analysis.\r\n\r\nNote: Our instructions assume you have customized Wireshark as described in our previous Wireshark tutorial about customizing the column display.\r\n\r\nYou will need to access a GitHub repository with ZIP archives containing pcaps used for this tutorial.\r\n\r\nWarning: Some of the pcaps used for this tutorial contain Windows-based malware. There is a risk of infection if using a Windows computer. We recommend you review this pcap in a non-Windows environment like BSD, Linux or macOS if at all possible.\r\nDridex Distribution\r\nTo understand Dridex network traffic, you should understand the chain of events leading to an infection. Dridex is commonly distributed through malicious spam (malspam). Waves of this malspam usually occur at least two or three times a week. Some emails delivering Dridex contain Microsoft Office documents attached, while other emails contain links to download a malicious file. Figures 1 through 4 show some recent examples.\r\n\r\n[caption id=\"attachment_109180\" align=\"aligncenter\" width=\"900\"] Figure 1. From September 2020, DHL-themed malspam pushing Dridex using an attachment.[\/caption]\r\n\r\n[caption id=\"attachment_109182\" align=\"aligncenter\" width=\"900\"] Figure 2. From October 2020, UPS-themed malspam pushing Dridex using an attachment.[\/caption]\r\n\r\n[caption id=\"attachment_109184\" align=\"aligncenter\" width=\"900\"] Figure 3. From September 2020, FedEx-themed malspam pushing Dridex using a link.[\/caption]\r\n\r\n[caption id=\"attachment_109186\" align=\"aligncenter\" width=\"900\"] Figure 4. From October 2020, QuickBooks-themed malspam pushing Dridex using a link.[\/caption]\r\n\r\nThe initial malicious file can be a Microsoft Office document with a malicious macro, or it could be a Windows executable (EXE) disguised as some sort of document. Either way, potential victims need to click their way to an infection from this initial file. The initial file retrieves a Dridex installer, although sometimes the initial file is itself a Dridex installer. The Dridex installer retrieves 64-bit Dridex DLL files over encrypted command and control (C2) network traffic. Figures 5 and 6 show what we commonly see for infection chains of recent Dridex activity.\r\n\r\n[caption id=\"attachment_109188\" align=\"aligncenter\" width=\"900\"] Figure 5. Chain of events commonly seen when Dridex is distributed as malspam attachments.[\/caption]\r\n\r\n[caption id=\"attachment_109190\" align=\"aligncenter\" width=\"900\"] Figure 6. Chain of events commonly seen when Dridex is distributed using links in malspam.[\/caption]\r\n\r\nFigure 7 shows another type of Dridex infection chain from malspam, which is not as common as the Office documents used in Figures 5 and 6. On Sept. 24, 2020, links from malspam pushing Dridex didn\u2019t return an Office document. Instead, they returned a Windows executable file. See Figure 7 for details.\r\n\r\n[caption id=\"attachment_109192\" align=\"aligncenter\" width=\"900\"] Figure 7: Chain of events seen in September 2020 where the link led to a Dridex installer EXE.[\/caption]\r\n\r\nAs noted in Figures 5 through 7, distribution traffic is most often HTTPS, which makes the initial file or Dridex installer hard to detect because it is encrypted. Fortunately, post-infection traffic caused by Dridex C2 activity is distinctive enough to identify.\r\nCertificates and HTTPS Traffic\r\nTo understand Dridex infection activity, we should also understand digital certificates used for HTTPS traffic.\r\n\r\nA digital certificate is used for SSL\/TLS encryption of HTTPS traffic. When viewing a website using HTTPS, a certificate is sent by the web server to a client's web browser. Data from this digital certificate is used to establish an HTTPS connection. Certificates contain a website's public key and confirm the website's identity.\r\n\r\nDifferent certificate authorities (CAs) can issue digital certificates for various websites. Certificates are sold to businesses for commercial websites, while some certificate authorities like Let\u2019s Encrypt offer certificates for free.\r\n\r\nCertificate information can be viewed from HTTPS traffic in Wireshark. We\u2019ll focus on the following two sections:\r\n\r\n \tIssuer data about the CA.\r\n \tSubject data about the website.\r\n\r\nIssuer data reveals the CA that issued the digital certificate. Subject data verifies the identity of the website. Figure 8 shows how to find certificate issuer and subject data for HTTPS traffic from www.paloaltonetworks.com.\r\n\r\n[caption id=\"attachment_109194\" align=\"aligncenter\" width=\"900\"] Figure 8. Certificate data from HTTPS traffic to www.paloaltonetworks.com.[\/caption]\r\n\r\nHowever, when setting up a web server, administrators can generate self-signed certificates. Self-signed certificates are locally generated and not issued by any certificate authority. HTTPS traffic from such servers often generates error messages when viewed in modern browsers, such as Firefox, as shown in Figure 9.\r\n\r\n[caption id=\"attachment_109196\" align=\"aligncenter\" width=\"900\"] Figure 9. Error from Firefox when trying to view a page from a website that uses a self-signed certificate.[\/caption]\r\n\r\nMalware developers often use self-signed certificates for their C2 servers. Why? Because self-signed certificates are quick, easy and free to create. Furthermore, HTTPS C2 traffic for malware does not involve a web browser, so the encrypted traffic works without any errors or warnings.\r\n\r\nGenerating self-signed certificate involves entering values for the following fields (some of these are often left blank):\r\n\r\n \tCountry name (2 letter code).\r\n \tState or province name.\r\n \tLocality name (usually a city name).\r\n \tOrganization name.\r\n \tOrganizational unit name.\r\n \tCommon name (for example, fully qualified host name).\r\n \tEmail address.\r\n\r\nThese fields are used for subject data that identifies the website, but the same fields and values are also used for the issuer, since the certificate was generated locally on the web server itself.\r\n\r\nMalware authors often use random, default or fake values in these fields for self-signed certificates. For example, Trickbot\u2019s HTTPS C2 traffic often uses example.com for the Common Name field. HTTPS C2 traffic from recent IcedID malware infections has used the following values in its certificate issuer fields:\r\n\r\n \tCountry name: AU\r\n \tState or province name: Some-State\r\n \tOrganization name: Internet Widgits Pty Ltd\r\n \tCommon name: localhost\r\n\r\nPatterns in certificate issuer data for Dridex HTTPS C2 traffic are somewhat unique when compared to other malware families. They can be key to identifying Dridex infections.\r\nPcaps of Dridex Infection Activity\r\nFive password-protected ZIP archives containing pcaps of recent Dridex network traffic are available at this GitHub repository. Once on the GitHub page, click on each of the ZIP archive entries, and download them as shown in Figures 10 and 11.\r\n\r\n[caption id=\"attachment_109198\" align=\"aligncenter\" width=\"900\"] Figure 10. GitHub repository with links to ZIP archive used for this tutorial.[\/caption]\r\n\r\n[caption id=\"attachment_109200\" align=\"aligncenter\" width=\"900\"] Figure 11. Downloading one of the ZIP archives for this tutorial.[\/caption]\r\n\r\nUse infected as the password to extract pcaps from these ZIP archives. This will result in five pcap files:\r\n\r\n \t2020-06-03-Dridex-infection-traffic.pcap\r\n \t2020-09-24-Dridex-infection-traffic.pcap\r\n \t2020-09-29-Dridex-infection-traffic.pcap\r\n \t2020-10-05-Dridex-infection-traffic.pcap\r\n \t2020-10-07-Dridex-infection-traffic.pcap\r\n\r\nExample One: 2020-06-03-Dridex-infection-traffic.pcap\r\nOpen 2020-06-03-Dridex-infection-traffic.pcap in Wireshark, and use a basic web filter as described in this previous tutorial about Wireshark filters. Our basic filter for Wireshark 3.x is:\r\n(http.request or tls.handshake.type eq 1) and !(ssdp)\r\nDridex infection traffic consists of two parts:\r\n\r\n \tInitial infection activity.\r\n \tPost-infection C2 traffic.\r\n\r\nInitial infection activity occurs when a victim downloads a malicious file from an email link. Initial infection activity also includes the malicious file loading an installer for Dridex. In some cases, you may not have an initial download because the malicious file is an attachment from an email. In other cases, you might not see a Dridex installer loaded because the initial file itself is an installer. In many cases, this activity happens over HTTPS, so we will not see any URLs, just a domain name.\r\n\r\nPost-infection activity is HTTPS C2 traffic that occurs after the victim is infected. This will always occur during a successful Dridex infection. This C2 traffic communicates directly with an IP address, so there are no domain names associated with it. It also has unusual certificate issuer data as detailed below.\r\n\r\nFigure 12 shows the first example opened in Wireshark using our basic web filter. The lines without a domain name are Dridex HTTPS C2 traffic.\r\n\r\n[caption id=\"attachment_109202\" align=\"aligncenter\" width=\"900\"] Figure 12. Traffic from the first pcap filtered in Wireshark using our basic web filter.[\/caption]\r\n\r\nThe first pcap shown in Figure 12 shows the following traffic directly to IP addresses instead of domain names. This is most likely Dridex HTTPS C2 traffic:\r\n\r\n \t185.86.148[.]68 over TCP port 443\r\n \t212.95.153[.]36 over TCP port 453\r\n\r\nOther domains seen using our basic web filter are system traffic using domains that end with well-known names like microsoft.com, office.net or windows.com. The only exception is HTTPS traffic to truepenesonga[.]com, which is near the beginning of the pcap at 19:38:18 UTC. This is likely the Dridex installer. A quick Google search indicates truepenesonga[.]com is associated with malware.\r\n\r\nFocus on the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over these two IP addresses:\r\ntls.handshake.type eq 11 and (ip.addr eq 185.86.148.68 or ip.addr eq 212.95.153.36)\r\nAfter the filter has been applied, select the first frame in your Wireshark column display, then go to the frame details panel and expand the values as shown in Figure 13 until you work your way to a list of lines that start with the term RDNSequence item.\r\n\r\n[caption id=\"attachment_109204\" align=\"aligncenter\" width=\"900\"] Figure 13. Finding certificate issuer data for Dridex HTTPS C2 traffic.[\/caption]\r\n\r\nNote the RDNSequence items for HTTPS traffic to 185.86.148[.]68 and their values:\r\n\r\n \tid-at-countryName=Vu\r\n \tid-at-stateOrProvinceName=Uererarnk4\r\n \tid-at-localityName=Port Vila\r\n \tid-at-organizationName=Whensean Imegdtc SICAV\r\n \tid-at-organizationUnitName=6Tbuthinalq\r\n \tid-at-commonName=1andfhtittbly.fan\r\n\r\nDridex certificate issuer fields frequently has random strings with a number or two sometimes thrown in. However, values for the country name and city or locality often match. In the above example, Vu is the 2-letter country code for Vanuatu, and Port Vila is the capital city of Vanuatu.\r\n\r\nDo the same thing for HTTPS traffic to 212.95.153[.]36 and you should find:\r\n\r\n \tid-at-countryName=AO\r\n \tid-at-localityName=Luanda\r\n \tid-at-organizationName=Msorest KGaA\r\n \tid-at-organizationUnitName=aghat@yongd\r\n \tid-at-commonName=arashrinwearc.Ourontizes.ly\r\n\r\nWe find the locality Luanda is the capital of Angola, which is country code AO. But the other fields appear to have random values. This type of certificate issuer data is a strong indicator of Dridex C2 traffic.\r\nExample Two: 2020-09-24-Dridex-infection-traffic.pcap\r\nOpen 2020-09-24-Dridex-infection-traffic.pcap in Wireshark and use a basic web filter, as shown in Figure 14.\r\n\r\n[caption id=\"attachment_109206\" align=\"aligncenter\" width=\"900\"] Figure 14. Traffic from the second pcap filtered in Wireshark using our basic web filter.[\/caption]\r\n\r\nNote how the first three lines are unencrypted HTTP GET requests. This is a link from an email shown earlier in Figure 3. It returned a ZIP archive for the infection chain shown in Figure 7.\r\n\r\nThe HTTP stream (not the TCP stream) can be followed. Scroll down to see some script returned, as shown in Figures 15 and 16.\r\n\r\n[caption id=\"attachment_109208\" align=\"aligncenter\" width=\"900\"] Figure 15. Following the HTTP stream for the first HTTP GET request.[\/caption]\r\n\r\n[caption id=\"attachment_109210\" align=\"aligncenter\" width=\"900\"] Figure 16. Scroll down to view the script returned from that HTTP GET request.[\/caption]\r\n\r\nAll three HTTP GET requests to adv.epostoday[.]uk are in the same TCP stream. Scroll down near the end before the last HTTP GET request for favicon.ico. You will find the end of a long string of ASCII characters that is converted to a blob and sent to the victim as Ref_Sep24-2020.zip, as shown in Figure 17.\r\n\r\n[caption id=\"attachment_109212\" align=\"aligncenter\" width=\"900\"] Figure 17. Script is designed to present a ZIP archive to the victim to save from the browser.[\/caption]\r\n\r\nThese scripts can be exported by using the \u201dexport HTTP objects\u201d function, as shown in Figure 18.\r\n\r\n[caption id=\"attachment_109214\" align=\"aligncenter\" width=\"900\"] Figure 18. Saving the scripts returned from URLs ending in app.php.[\/caption]\r\n\r\nOnce again, focus on the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:\r\ntls.handshake.type eq 11 and (ip.addr eq 151.236.219.181 or ip.addr eq 62.98.109.30)\r\nAfter applying the filter, select the first frame and go to the frame details section. Look for a list of lines that start with the term RDNSequence item as done in our first pcap. Figure 19 shows how to get there in our second pcap for 151.236.219[.]181.\r\n\r\n[caption id=\"attachment_109216\" align=\"aligncenter\" width=\"900\"] Figure 19. Finding certificate issuer data for Dridex HTTPS C2 traffic in our second pcap.[\/caption]\r\n\r\nThe certificate issuer data is similar to that of the first example. Check the certificate issuer data for both IP addresses and find the data listed below.\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 151.236.219[.]181:\r\n\r\n \tid-at-countryName=IL\r\n \tid-at-stateOrProvinceName=Anourd Thiolaved Thersile5 Fteda8\r\n \tid-at-LocalityName=Tel Aviv\r\n \tid-at-organizationName=Wemadd Hixchac GmBH\r\n \tid-at-organizationUnitName=moasn@emanc\r\n \tid-at-commonName=heardbellith.Icanwepeh.nagoya\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 62.98.109[.]30:\r\n\r\n \tid-at-countryName=SS\r\n \tid-at-LocalityName=Khartoum\r\n \tid-at-organizationName=Hedanpr S.p.a.\r\n \tid-at-commonName=psprponounst.aquarelle\r\n\r\nThe locality matches the country name in both cases, but the other fields appear to be random strings. This matches the same pattern as Dridex HTTPS C2 traffic from our first pcap.\r\nExample Three: 2020-09-29-Dridex-infection-traffic.pcap\r\nOpen 2020-09-29-Dridex-infection-traffic.pcap in Wireshark and use a basic web filter, as shown in Figure 20.\r\n\r\n[caption id=\"attachment_109218\" align=\"aligncenter\" width=\"900\"] Figure 20. Traffic from the third pcap filtered in Wireshark using our basic web filter.[\/caption]\r\n\r\nChecking through the domains, there are three non-Microsoft domains using HTTPS traffic that might be tied to the initial infection activity:\r\n\r\n \tdsimportaciones[.]com\r\n \tmurfreesboro.fairwayconcierge[.]com\r\n \tryner.net[.]au\r\n\r\nSince those are URL-specific and the contents are not shown, focus on the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:\r\ntls.handshake.type eq 11 and (ip.addr eq 67.79.105.174 or ip.addr eq 144.202.31.138)\r\nAfter applying the filter, select the first frame, go to the frame details section and look for a list of lines that start with the term RDNSequence item as done in our first two examples. Figure 21 shows how to get there in our third pcap for 67.79.105[.]174.\r\n\r\n[caption id=\"attachment_109220\" align=\"aligncenter\" width=\"900\"] Figure 21. Finding certificate issuer data for Dridex HTTPS C2 traffic in our third pcap.[\/caption]\r\n\r\nThe certificate issuer data follows the same pattern as our first two examples. Check the issuer data for both IP addresses to find the data listed below.\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 67.79.105[.]174:\r\n\r\n \tid-at-countryName=MN\r\n \tid-at-stateOrProvinceName=Listth Thearere8 berponedt tithsalet\r\n \tid-at-LocalityName=Ulaanbaatar\r\n \tid-at-organizationName=Massol SE\r\n \tid-at-commonName=Atid7brere.Speso_misetr.stada\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 144.202.31[.]138:\r\n\r\n \tid-at-countryName=SS\r\n \tid-at-LocalityName=Khartoum\r\n \tid-at-organizationName=Hedanpr S.p.a.\r\n \tid-at-commonName=psprponounst.aquarelle\r\n\r\nOf note, certificate issuer data for 144.202.31[.]138 in the third example from 2020-09-29 is the same as for 62.98.109[.]30 in the second example from 2020-09-24.\r\nExample Four: 2020-10-05-Dridex-infection-traffic.pcap\r\nOpen 2020-10-05-Dridex-infection-traffic.pcap in Wireshark and use a basic web filter, as shown in Figure 22.\r\n\r\n[caption id=\"attachment_109222\" align=\"aligncenter\" width=\"900\"] Figure 22. Traffic from the fourth pcap filtered in Wireshark using our basic web filter.[\/caption]\r\n\r\nChecking through the domains, there is one non-Microsoft domain using HTTPS traffic that might be tied to the initial infection activity:\r\n\r\n \tvardhmanproducts[.]com\r\n\r\nOnce again, the focus will be on post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:\r\ntls.handshake.type eq 11 and (ip.addr eq 85.114.134.25 or ip.addr eq 85.211.162.44)\r\nAfter applying the filter, select the first frame, go to the frame details section and work your way to a list of lines that start with the term RDNSequence item as done in the first three examples.\r\n\r\nThe certificate issuer data follows the same pattern as the first three examples. Check the issuer data for both IP addresses, and you should find the data listed below.\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 85.114.134[.]25:\r\n\r\n \tid-at-countryName=NZ\r\n \tid-at-stateOrProvinceName=Cepli thade0 ithentha temsorer\r\n \tid-at-LocalityName=Wellington\r\n \tid-at-organizationName=Lling Lovisq NL\r\n \tid-at-organizationalUnitName=Punddtln\r\n \tid-at-commonName=Onshthonese.vyrda-npeces.post\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 85.211.162[.]44:\r\n\r\n \tid-at-countryName=MY\r\n \tid-at-LocalityName=Kuala Lumpur\r\n \tid-at-organizationName=Ointavi Tagate Unltd.\r\n \tid-at-commonName=Ateei7thapom.statonrc.loan\r\n\r\nExample Five: 2020-10-07-Dridex-infection-traffic.pcap\r\nOpen 2020-10-07-Dridex-infection-traffic.pcap in Wireshark and use a basic web filter, as shown in Figure 23.\r\n\r\n[caption id=\"attachment_109224\" align=\"aligncenter\" width=\"900\"] Figure 23. Traffic from the fifth pcap filtered in Wireshark using our basic web filter.[\/caption]\r\n\r\n&nbsp;\r\n\r\nChecking through the domains, there is one non-Microsoft domain using HTTPS traffic that might be tied to the initial infection activity:\r\n\r\n \tnewmg532.wordswideweb[.]com\r\n\r\nExamine the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:\r\ntls.handshake.type eq 11 and (ip.addr eq 177.87.70.3 or ip.addr eq 188.250.8.142)\r\nAfter applying the filter, select the first frame, go to the frame details section and work your way to a list of lines that start with the term RDNSequence item as done in our first four examples.\r\n\r\nThe certificate issuer data follows the same pattern as our first four examples. Check the issuer data for both IP addresses and find the data listed below.\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 177.87.70[.]3:\r\n\r\n \tid-at-countryName=BS\r\n \tid-at-stateOrProvinceName=Sshopedts Inccofrew\r\n \tid-at-LocalityName=Nassau\r\n \tid-at-organizationName=Mesureder S.p.a.\r\n \tid-at-commonName=avothelyop.thedai9neasysb.author\r\n\r\nCertificate issuer data for Dridex HTTPS C2 traffic on 188.250.8[.]142:\r\n\r\n \tid-at-countryName=UA\r\n \tid-at-stateOrProvinceName=avandi0\r\n \tid-at-LocalityName=Kiev\r\n \tid-at-organizationName=Icccodiso Icloneedb Oyj\r\n \tid-at-organizationalUnitName=4Zenyfea\r\n \tid-at-commonName=rebydustat.tci\r\n\r\nThese five examples should give a good idea of what certificate issuer data for Dridex HTTPS C2 traffic looks like. These patterns differ from many other malware families, but they are somewhat similar to certificate issuer data from HTTPS C2 Qakbot network traffic.\r\n\r\nHowever, with Qakbot, the stateOrProvinceName is always a two-letter value, and the LocalityName consists of random characters.\r\n\r\nWith Dridex, the stateOrProvinceName consists of random characters, and the LocalityName is the capital city of whatever country is used for the countryName.\r\nConclusion\r\nThis tutorial reviewed how to identify Dridex activity from a pcap with Dridex network traffic. We reviewed five recent pcaps of Dridex infections and found similarities in certificate issuer data from the post-infection C2 traffic. The certificate issuer data is key to identifying a Dridex infection, since these patterns appear unique to Dridex.\r\n\r\nFor more help with Wireshark, see our previous tutorials:\r\n\r\n \tChanging Your Column Display\r\n \tDisplay Filter Expressions\r\n \tIdentifying Hosts and Users\r\n \tExporting Objects from a Pcap\r\n \tExamining Trickbot Infections\r\n \tExamining Ursnif Infections\r\n \tExamining Qakbot Infections\r\n \tDecrypting HTTPS Traffic\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2019\/11\/tutorial-900x512-150x150.png","width":150,"height":150},"author":[{"@type":"Person","name":"Brad Duncan"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"109179","token":"f7fb0cb1d5","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=109179' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fwireshark-tutorial-dridex-infection-traffic%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fwireshark-tutorial-dridex-infection-traffic%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-109179 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Wireshark Tutorial: Examining Dridex Infection Traffic</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-109179 entry-meta">
			
			
			<span class="post-views-count">2,252</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'109179','like')"><i class="ui ui-2"></i><span class="ml-5">6</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fwireshark-tutorial-dridex-infection-traffic%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fwireshark-tutorial-dridex-infection-traffic%2F+-+Wireshark+Tutorial%3A+Examining+Dridex+Infection+Traffic" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fwireshark-tutorial-dridex-infection-traffic%2F&title=Wireshark+Tutorial%3A+Examining+Dridex+Infection+Traffic&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/bduncan/" title="Posts by Brad Duncan" class="author url fn" rel="author">Brad Duncan</a>        </p>
        <p><time datetime="2020-10-23T16:00:54+00:00">October 23, 2020 at 9:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/dridex/" rel="tag">Dridex</a>, <a href="https://unit42.paloaltonetworks.com/tag/pcap/" rel="tag">pcap</a>, <a href="https://unit42.paloaltonetworks.com/tag/tutorial/" rel="tag">tutorial</a>, <a href="https://unit42.paloaltonetworks.com/tag/wireshark/" rel="tag">Wireshark</a>, <a href="https://unit42.paloaltonetworks.com/tag/wireshark-tutorial/" rel="tag">Wireshark Tutorial</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="512" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512-900x512.png" class="attachment-single size-single" alt="The word &quot;Tutorial,&quot; superimposed over an image used in the Wireshark Tutorial series." srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512-300x171.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512-768x437.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/tutorial-900x512-370x210.png 370w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/wireshark-tutorial-dridex-infection-traffic/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2><strong>Executive Summary</strong></h2>
<p>This tutorial is designed for security professionals who investigate suspicious network activity and review network packet captures (pcaps). Familiarity with <a href="https://www.wireshark.org/">Wireshark</a> is necessary to understand this tutorial, which focuses on Wireshark version 3.x.</p>
<p><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.dridex">Dridex</a> is the name for a family of information-stealing malware that has also been described as a banking Trojan. This malware <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.dridex">first appeared in 2014</a> and has been active ever since.</p>
<p>Today’s Wireshark tutorial reviews Dridex activity and provides some helpful tips on identifying this family based on traffic analysis.</p>
<p>Note: Our instructions assume you have customized Wireshark as described in <a href="https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/">our previous Wireshark tutorial about customizing the column display</a>.</p>
<p>You will need to access a GitHub repository with ZIP archives containing <a href="https://github.com/pan-unit42/wireshark-tutorial-Dridex-traffic">pcaps used for this tutorial</a>.</p>
<p><strong><span style="text-decoration: underline;">Warning</span>:</strong> Some of the pcaps used for this tutorial contain Windows-based malware. There is a risk of infection if using a Windows computer. We recommend you review this pcap in a non-Windows environment like BSD, Linux or macOS if at all possible.</p>
<h2><strong>Dridex Distribution</strong></h2>
<p>To understand Dridex network traffic, you should understand the chain of events leading to an infection. Dridex is commonly distributed through malicious spam (malspam). Waves of this malspam usually occur at least two or three times a week. Some emails delivering Dridex contain Microsoft Office documents attached, while other emails contain links to download a malicious file. Figures 1 through 4 show some recent examples.</p>
<figure id="attachment_109180" aria-describedby="caption-attachment-109180" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109180" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-2.jpeg" alt="An email carrying a malicious Excel file, pushing Dridex, with the subject line &quot;DHL Invoices for Aug 2020&quot;" width="900" height="694" /><figcaption id="caption-attachment-109180" class="wp-caption-text">Figure 1. From September 2020, DHL-themed malspam pushing Dridex using an attachment.</figcaption></figure>
<figure id="attachment_109182" aria-describedby="caption-attachment-109182" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109182" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-3.jpeg" alt="An email pushing Dridex using an attached malicious Excel file. The subject line is &quot;UPS Invoice Notification.&quot; " width="900" height="786" /><figcaption id="caption-attachment-109182" class="wp-caption-text">Figure 2. From October 2020, UPS-themed malspam pushing Dridex using an attachment.</figcaption></figure>
<figure id="attachment_109184" aria-describedby="caption-attachment-109184" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109184" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-4.jpeg" alt="An email pushing Dridex using a malicious link. The subject line is &quot;FedEx Shipment 747958837531 Delivered.&quot; " width="900" height="1034" /><figcaption id="caption-attachment-109184" class="wp-caption-text">Figure 3. From September 2020, FedEx-themed malspam pushing Dridex using a link.</figcaption></figure>
<figure id="attachment_109186" aria-describedby="caption-attachment-109186" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109186" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-5.jpeg" alt="An email pushing Dridex using a malicious link. The subject line is &quot;Notification : invoice 796636.&quot; " width="900" height="1067" /><figcaption id="caption-attachment-109186" class="wp-caption-text">Figure 4. From October 2020, QuickBooks-themed malspam pushing Dridex using a link.</figcaption></figure>
<p>The initial malicious file can be a Microsoft Office document with a malicious macro, or it could be a Windows executable (EXE) disguised as some sort of document. Either way, potential victims need to click their way to an infection from this initial file. The initial file retrieves a Dridex installer, although sometimes the initial file is itself a Dridex installer. The Dridex installer retrieves 64-bit Dridex DLL files over encrypted command and control (C2) network traffic. Figures 5 and 6 show what we commonly see for infection chains of recent Dridex activity.</p>
<figure id="attachment_109188" aria-describedby="caption-attachment-109188" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109188" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-6.jpeg" alt="Malspam with attached spreadsheets pushing Dridex. The chain of events is as follows: malspam with attachment, attached Excel spreadsheet, enable macros, HTTPS traffic for installer DLL, installer DLL for Dridex, HTTPS C2 traffic, 64-bit Dridex DLL files, HTTPS C2 traffic, updated 64-bit Dridex DLL files" width="900" height="553" /><figcaption id="caption-attachment-109188" class="wp-caption-text">Figure 5. Chain of events commonly seen when Dridex is distributed as malspam attachments.</figcaption></figure>
<figure id="attachment_109190" aria-describedby="caption-attachment-109190" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109190" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-7.jpeg" alt="Malspam with links pushing Dridex. Chain of events is commonly as follows: malspam with HTTPS link, HTTPS traffic for Word doc, downloaded Word doc, enable macros, HTTPS traffic for installer DLL, installer DLL for Dridex, HTTPS C2 traffic, 64-bit Dridex DLL files, HTTPS C2 traffic, updated 64-bit Dridex DLL files" width="900" height="530" /><figcaption id="caption-attachment-109190" class="wp-caption-text">Figure 6. Chain of events commonly seen when Dridex is distributed using links in malspam.</figcaption></figure>
<p>Figure 7 shows another type of Dridex infection chain from malspam, which is not as common as the Office documents used in Figures 5 and 6. On Sept. 24, 2020, links from malspam pushing Dridex didn’t return an Office document. Instead, they returned a Windows executable file. See Figure 7 for details.</p>
<figure id="attachment_109192" aria-describedby="caption-attachment-109192" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109192" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-8.jpeg" alt="Malspam pushing Dridex on Thursday 2020-09-24, Note: Occasionally, the same HTTPS link returned an EXE with an .scr file extension instead of a ZIP archive. The chain of events seen was as follows: malspam with HTTPS link, HTTPS traffic for ZIP archive, downloaded ZIP archive, Dridex installer EXE (.scr file extension), HTTPS C2 traffic, 64-bit Dridex DLL files, HTTPS C2 traffic, updated 64-bit Dridex DLL files" width="900" height="668" /><figcaption id="caption-attachment-109192" class="wp-caption-text">Figure 7: Chain of events seen in September 2020 where the link led to a Dridex installer EXE.</figcaption></figure>
<p>As noted in Figures 5 through 7, distribution traffic is most often HTTPS, which makes the initial file or Dridex installer hard to detect because it is encrypted. Fortunately, post-infection traffic caused by Dridex C2 activity is distinctive enough to identify.</p>
<h2><strong>Certificates and HTTPS Traffic</strong></h2>
<p>To understand Dridex infection activity, we should also understand digital certificates used for HTTPS traffic.</p>
<p>A digital certificate is used for SSL/TLS encryption of HTTPS traffic. When viewing a website using HTTPS, a certificate is sent by the web server to a client&#8217;s web browser. Data from this digital certificate is used to establish an HTTPS connection. Certificates contain a website&#8217;s public key and confirm the website&#8217;s identity.</p>
<p>Different <a href="https://en.wikipedia.org/wiki/Certificate_authority">certificate authorities</a> (CAs) can issue digital certificates for various websites. Certificates are sold to businesses for commercial websites, while some certificate authorities like <a href="https://letsencrypt.org/about/">Let’s Encrypt</a> offer certificates for free.</p>
<p>Certificate information can be viewed from HTTPS traffic in Wireshark. We’ll focus on the following two sections:</p>
<ul>
<li>Issuer data about the CA.</li>
<li>Subject data about the website.</li>
</ul>
<p>Issuer data reveals the CA that issued the digital certificate. Subject data verifies the identity of the website. Figure 8 shows how to find certificate issuer and subject data for HTTPS traffic from <span style="font-family: 'courier new', courier, monospace;">www.paloaltonetworks.com</span>.</p>
<figure id="attachment_109194" aria-describedby="caption-attachment-109194" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109194" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-9.jpeg" alt="The screenshot shows how to find certificate issuer and subject date for HTTPS traffic, using www.paloaltonetworks.com as an example. A red box highlights the subject data to identify the website. " width="900" height="713" /><figcaption id="caption-attachment-109194" class="wp-caption-text">Figure 8. Certificate data from HTTPS traffic to www.paloaltonetworks.com.</figcaption></figure>
<p>However, when setting up a web server, administrators can generate self-signed certificates. Self-signed certificates are locally generated and not issued by any certificate authority. HTTPS traffic from such servers often generates error messages when viewed in modern browsers, such as Firefox, as shown in Figure 9.</p>
<figure id="attachment_109196" aria-describedby="caption-attachment-109196" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109196" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-10.jpeg" alt="HTTPS traffic from self-signed certificates often generates error messages when viewed in modern browsers, such as this warning from Firefox, which states, &quot;Warning: Potential Security Risk Ahead.&quot; " width="900" height="500" /><figcaption id="caption-attachment-109196" class="wp-caption-text">Figure 9. Error from Firefox when trying to view a page from a website that uses a self-signed certificate.</figcaption></figure>
<p>Malware developers often use self-signed certificates for their C2 servers. Why? Because self-signed certificates are quick, easy and free to create. Furthermore, HTTPS C2 traffic for malware does not involve a web browser, so the encrypted traffic works without any errors or warnings.</p>
<p>Generating self-signed certificate involves entering values for the following fields (some of these are often left blank):</p>
<ul>
<li>Country name (2 letter code).</li>
<li>State or province name.</li>
<li>Locality name (usually a city name).</li>
<li>Organization name.</li>
<li>Organizational unit name.</li>
<li>Common name (for example, fully qualified host name).</li>
<li>Email address.</li>
</ul>
<p>These fields are used for subject data that identifies the website, but the same fields and values are also used for the issuer, since the certificate was generated locally on the web server itself.</p>
<p>Malware authors often use random, default or fake values in these fields for self-signed certificates. For example, Trickbot’s HTTPS C2 traffic often uses <span style="font-family: 'courier new', courier, monospace;">example.com</span> for the Common Name field. <a href="https://www.malware-traffic-analysis.net/2020/10/06/index.html">HTTPS C2 traffic from recent IcedID malware infections</a> has used the following values in its certificate issuer fields:</p>
<ul>
<li>Country name: <span style="font-family: 'courier new', courier, monospace;">AU</span></li>
<li>State or province name: <span style="font-family: 'courier new', courier, monospace;">Some-State</span></li>
<li>Organization name: <span style="font-family: 'courier new', courier, monospace;">Internet Widgits Pty Ltd</span></li>
<li>Common name: <span style="font-family: 'courier new', courier, monospace;">localhost</span></li>
</ul>
<p>Patterns in certificate issuer data for Dridex HTTPS C2 traffic are somewhat unique when compared to other malware families. They can be key to identifying Dridex infections.</p>
<h2><strong>Pcaps of Dridex Infection Activity</strong></h2>
<p>Five password-protected ZIP archives containing pcaps of recent Dridex network traffic are available at <a href="https://github.com/pan-unit42/wireshark-tutorial-Dridex-traffic">this GitHub repository</a>. Once on the GitHub page, click on each of the ZIP archive entries, and download them as shown in Figures 10 and 11.</p>
<figure id="attachment_109198" aria-describedby="caption-attachment-109198" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109198" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-11.jpeg" alt="This shows how to download the ZIP archive used for this tutorial from the GitHub repository, pan-unit42 / wireshark-tutorial-Dridex-traffic" width="900" height="577" /><figcaption id="caption-attachment-109198" class="wp-caption-text">Figure 10. GitHub repository with links to ZIP archive used for this tutorial.</figcaption></figure>
<figure id="attachment_109200" aria-describedby="caption-attachment-109200" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109200" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-12.jpeg" alt="The screenshot shows an example of downloading a ZIP archive, 2020-06-03-Dridex-infection-traffic-pcap.zip, from the GitHub repository storing files for this Wireshark tutorial" width="900" height="473" /><figcaption id="caption-attachment-109200" class="wp-caption-text">Figure 11. Downloading one of the ZIP archives for this tutorial.</figcaption></figure>
<p>Use <strong><em>infected</em></strong> as the password to extract pcaps from these ZIP archives. This will result in five pcap files:</p>
<ul>
<li>2020-06-03-Dridex-infection-traffic.pcap</li>
<li>2020-09-24-Dridex-infection-traffic.pcap</li>
<li>2020-09-29-Dridex-infection-traffic.pcap</li>
<li>2020-10-05-Dridex-infection-traffic.pcap</li>
<li>2020-10-07-Dridex-infection-traffic.pcap</li>
</ul>
<h2><strong>Example One: 2020-06-03-Dridex-infection-traffic.pcap</strong></h2>
<p>Open <strong><em>2020-06-03-Dridex-infection-traffic.pcap</em></strong> in Wireshark, and use a basic web filter as described in this previous <a href="https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/">tutorial about Wireshark filters</a>. Our basic filter for Wireshark 3.x is:</p>
<p style="text-align: center;"><span style="font-family: 'courier new', courier, monospace;">(http.request or tls.handshake.type eq 1) and !(ssdp)</span></p>
<p>Dridex infection traffic consists of two parts:</p>
<ul>
<li>Initial infection activity.</li>
<li>Post-infection C2 traffic.</li>
</ul>
<p>Initial infection activity occurs when a victim downloads a malicious file from an email link. Initial infection activity also includes the malicious file loading an installer for Dridex. In some cases, you may not have an initial download because the malicious file is an attachment from an email. In other cases, you might not see a Dridex installer loaded because the initial file itself is an installer. In many cases, this activity happens over HTTPS, so we will not see any URLs, just a domain name.</p>
<p>Post-infection activity is HTTPS C2 traffic that occurs after the victim is infected. This will always occur during a successful Dridex infection. This C2 traffic communicates directly with an IP address, so there are no domain names associated with it. It also has unusual certificate issuer data as detailed below.</p>
<p>Figure 12 shows the first example opened in Wireshark using our basic web filter. The lines without a domain name are Dridex HTTPS C2 traffic.</p>
<figure id="attachment_109202" aria-describedby="caption-attachment-109202" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109202" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-13.jpeg" alt="This screenshot shows Dridex infection traffic, filtered in Wireshark. The screen is labeled 2020-06-03-Dridex-infection-traffic.pcap" width="900" height="628" /><figcaption id="caption-attachment-109202" class="wp-caption-text">Figure 12. Traffic from the first pcap filtered in Wireshark using our basic web filter.</figcaption></figure>
<p>The first pcap shown in Figure 12 shows the following traffic directly to IP addresses instead of domain names. This is most likely Dridex HTTPS C2 traffic:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">185.86.148[.]68</span> over TCP port <span style="font-family: 'courier new', courier, monospace;">443</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">212.95.153[.]36</span> over TCP port <span style="font-family: 'courier new', courier, monospace;">453</span></li>
</ul>
<p>Other domains seen using our basic web filter are system traffic using domains that end with well-known names like <span style="font-family: 'courier new', courier, monospace;">microsoft.com</span>, <span style="font-family: 'courier new', courier, monospace;">office.net</span> or <span style="font-family: 'courier new', courier, monospace;">windows.com</span>. The only exception is HTTPS traffic to <span style="font-family: 'courier new', courier, monospace;">truepenesonga[.]com</span>, which is near the beginning of the pcap at 19:38:18 UTC. This is likely the Dridex installer. A quick <a href="https://www.google.com/search?q=truepenesonga+com+malware">Google search</a> indicates <span style="font-family: 'courier new', courier, monospace;">truepenesonga[.]com</span> is associated with malware.</p>
<p>Focus on the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over these two IP addresses:</p>
<p style="text-align: center;"><span style="font-family: 'courier new', courier, monospace;">tls.handshake.type eq 11 and (ip.addr eq 185.86.148.68 or ip.addr eq 212.95.153.36)</span></p>
<p>After the filter has been applied, select the first frame in your Wireshark column display, then go to the frame details panel and expand the values as shown in Figure 13 until you work your way to a list of lines that start with the term <span style="font-family: 'courier new', courier, monospace;">RDNSequence item</span>.</p>
<figure id="attachment_109204" aria-describedby="caption-attachment-109204" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109204" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-14.jpeg" alt="The screenshot highlights key spots that can be used for finding certificate issuer data for Dridex HTTPS C2 traffic. Red arrows particularly point out Transport layer security, certificate, handshake protocol, signed certfiicate, issuer and rdnSequence. " width="900" height="746" /><figcaption id="caption-attachment-109204" class="wp-caption-text">Figure 13. Finding certificate issuer data for Dridex HTTPS C2 traffic.</figcaption></figure>
<p>Note the RDNSequence items for HTTPS traffic to <span style="font-family: 'courier new', courier, monospace;">185.86.148[.]68</span> and their values:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=Vu</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-stateOrProvinceName=Uererarnk4</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-localityName=Port Vila</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Whensean Imegdtc SICAV</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationUnitName=6Tbuthinalq</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=1andfhtittbly.fan</span></li>
</ul>
<p>Dridex certificate issuer fields frequently has random strings with a number or two sometimes thrown in. However, values for the country name and city or locality often match. In the above example, <span style="font-family: 'courier new', courier, monospace;">Vu</span> is the 2-letter country code for Vanuatu, and <span style="font-family: 'courier new', courier, monospace;">Port Vila</span> is the capital city of Vanuatu.</p>
<p>Do the same thing for HTTPS traffic to <span style="font-family: 'courier new', courier, monospace;">212.95.153[.]36</span> and you should find:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=AO</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-localityName=Luanda</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Msorest KGaA</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationUnitName=aghat@yongd</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=arashrinwearc.Ourontizes.ly</span></li>
</ul>
<p>We find the locality <span style="font-family: 'courier new', courier, monospace;">Luanda</span> is the capital of Angola, which is country code <span style="font-family: 'courier new', courier, monospace;">AO</span>. But the other fields appear to have random values. This type of certificate issuer data is a strong indicator of Dridex C2 traffic.</p>
<h2><strong>Example Two: 2020-09-24-Dridex-infection-traffic.pcap</strong></h2>
<p>Open <strong><em>2020-09-24-Dridex-infection-traffic.pcap</em></strong> in Wireshark and use a basic web filter, as shown in Figure 14.</p>
<figure id="attachment_109206" aria-describedby="caption-attachment-109206" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109206" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-15.jpeg" alt="This screenshot shows Dridex infection traffic, filtered in Wireshark. The screen is labeled 2020-09-24-Dridex-infection-traffic.pcap" width="900" height="482" /><figcaption id="caption-attachment-109206" class="wp-caption-text">Figure 14. Traffic from the second pcap filtered in Wireshark using our basic web filter.</figcaption></figure>
<p>Note how the first three lines are unencrypted HTTP GET requests. This is a link from an email shown earlier in Figure 3. It returned a ZIP archive for the infection chain shown in Figure 7.</p>
<p>The HTTP stream (not the TCP stream) can be followed. Scroll down to see some script returned, as shown in Figures 15 and 16.</p>
<figure id="attachment_109208" aria-describedby="caption-attachment-109208" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109208" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-16.jpeg" alt="The HTTP stream (not the TCP stream) can be followed. The screenshot indicates how to find that option in Wireshark. " width="900" height="482" /><figcaption id="caption-attachment-109208" class="wp-caption-text">Figure 15. Following the HTTP stream for the first HTTP GET request.</figcaption></figure>
<figure id="attachment_109210" aria-describedby="caption-attachment-109210" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109210" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-17.jpeg" alt="When following the HTTP Stream for the Dridex infection traffic, scroll down to view the script returned from the first HTTP GET request. " width="900" height="705" /><figcaption id="caption-attachment-109210" class="wp-caption-text">Figure 16. Scroll down to view the script returned from that HTTP GET request.</figcaption></figure>
<p>All three HTTP GET requests to adv.epostoday[.]uk are in the same TCP stream. Scroll down near the end before the last HTTP GET request for favicon.ico. You will find the end of a long string of ASCII characters that is converted to a blob and sent to the victim as <span style="font-family: 'courier new', courier, monospace;">Ref_Sep24-2020.zip</span>, as shown in Figure 17.</p>
<figure id="attachment_109212" aria-describedby="caption-attachment-109212" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109212" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-18.jpeg" alt="A red arrow indicates Ref_Sept24-2020.zip, the ZIP archive that the victim will be encouraged to save from the browser. " width="900" height="705" /><figcaption id="caption-attachment-109212" class="wp-caption-text">Figure 17. Script is designed to present a ZIP archive to the victim to save from the browser.</figcaption></figure>
<p>These scripts can be exported by using the ”export HTTP objects” function, as shown in Figure 18.</p>
<figure id="attachment_109214" aria-describedby="caption-attachment-109214" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109214" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-19.jpeg" alt="Using the &quot;export HTTP objects&quot; function, it is possible to save the scripts returned from URLs ending in app.php. Red arrows indicate the options to select. " width="900" height="482" /><figcaption id="caption-attachment-109214" class="wp-caption-text">Figure 18. Saving the scripts returned from URLs ending in app.php.</figcaption></figure>
<p>Once again, focus on the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:</p>
<p style="text-align: center;"><span style="font-family: 'courier new', courier, monospace;">tls.handshake.type eq 11 and (ip.addr eq 151.236.219.181 or ip.addr eq 62.98.109.30)</span></p>
<p>After applying the filter, select the first frame and go to the frame details section. Look for a list of lines that start with the term <span style="font-family: 'courier new', courier, monospace;">RDNSequence</span> <span style="font-family: 'courier new', courier, monospace;">item</span> as done in our first pcap. Figure 19 shows how to get there in our second pcap for <span style="font-family: 'courier new', courier, monospace;">151.236.219[.]181</span>.</p>
<figure id="attachment_109216" aria-describedby="caption-attachment-109216" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109216" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-20.jpeg" alt="The screenshot highlights key spots that can be used for finding certificate issuer data for Dridex HTTPS C2 traffic. Red arrows particularly point out Transport layer security, certificate, handshake protocol, signed certfiicate, issuer and rdnSequence. " width="900" height="622" /><figcaption id="caption-attachment-109216" class="wp-caption-text">Figure 19. Finding certificate issuer data for Dridex HTTPS C2 traffic in our second pcap.</figcaption></figure>
<p>The certificate issuer data is similar to that of the first example. Check the certificate issuer data for both IP addresses and find the data listed below.</p>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">151.236.219[.]181</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=IL</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-stateOrProvinceName=Anourd Thiolaved Thersile5 Fteda8</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Tel Aviv</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Wemadd Hixchac GmBH</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationUnitName=moasn@emanc</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=heardbellith.Icanwepeh.nagoya</span></li>
</ul>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">62.98.109[.]30</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=SS</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Khartoum</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Hedanpr S.p.a.</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=psprponounst.aquarelle</span></li>
</ul>
<p>The locality matches the country name in both cases, but the other fields appear to be random strings. This matches the same pattern as Dridex HTTPS C2 traffic from our first pcap.</p>
<h2><strong>Example Three: 2020-09-29-Dridex-infection-traffic.pcap</strong></h2>
<p>Open <strong><em>2020-09-29-Dridex-infection-traffic.pcap</em></strong> in Wireshark and use a basic web filter, as shown in Figure 20.</p>
<figure id="attachment_109218" aria-describedby="caption-attachment-109218" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109218" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-21.jpeg" alt="This screenshot shows Dridex infection traffic, filtered in Wireshark. The screen is labeled 2020-09-29-Dridex-infection-traffic.pcap" width="900" height="540" /><figcaption id="caption-attachment-109218" class="wp-caption-text">Figure 20. Traffic from the third pcap filtered in Wireshark using our basic web filter.</figcaption></figure>
<p>Checking through the domains, there are three non-Microsoft domains using HTTPS traffic that might be tied to the initial infection activity:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">dsimportaciones[.]com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">murfreesboro.fairwayconcierge[.]com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">ryner.net[.]au</span></li>
</ul>
<p>Since those are URL-specific and the contents are not shown, focus on the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:</p>
<p style="text-align: center;"><span style="font-family: 'courier new', courier, monospace;">tls.handshake.type eq 11 and (ip.addr eq 67.79.105.174 or ip.addr eq 144.202.31.138)</span></p>
<p>After applying the filter, select the first frame, go to the frame details section and look for a list of lines that start with the term <span style="font-family: 'courier new', courier, monospace;">RDNSequence item</span> as done in our first two examples. Figure 21 shows how to get there in our third pcap for <span style="font-family: 'courier new', courier, monospace;">67.79.105[.]174</span>.</p>
<figure id="attachment_109220" aria-describedby="caption-attachment-109220" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109220" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-22.jpeg" alt="The screenshot highlights key spots that can be used for finding certificate issuer data for Dridex HTTPS C2 traffic. Red arrows particularly point out Transport layer security, certificate, handshake protocol, signed certfiicate, issuer and rdnSequence. " width="900" height="613" /><figcaption id="caption-attachment-109220" class="wp-caption-text">Figure 21. Finding certificate issuer data for Dridex HTTPS C2 traffic in our third pcap.</figcaption></figure>
<p>The certificate issuer data follows the same pattern as our first two examples. Check the issuer data for both IP addresses to find the data listed below.</p>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">67.79.105[.]174</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=MN</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-stateOrProvinceName=Listth Thearere8 berponedt tithsalet</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Ulaanbaatar</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Massol SE</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=Atid7brere.Speso_misetr.stada</span></li>
</ul>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">144.202.31[.]138</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=SS</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Khartoum</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Hedanpr S.p.a.</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=psprponounst.aquarelle</span></li>
</ul>
<p>Of note, certificate issuer data for <span style="font-family: 'courier new', courier, monospace;">144.202.31[.]138</span> in the third example from 2020-09-29 is the same as for <span style="font-family: 'courier new', courier, monospace;">62.98.109[.]30</span> in the second example from 2020-09-24.</p>
<h2><strong>Example Four: 2020-10-05-Dridex-infection-traffic.pcap</strong></h2>
<p>Open <strong><em>2020-10-05-Dridex-infection-traffic.pcap</em></strong> in Wireshark and use a basic web filter, as shown in Figure 22.</p>
<figure id="attachment_109222" aria-describedby="caption-attachment-109222" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109222" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-23.jpeg" alt="This screenshot shows Dridex infection traffic, filtered in Wireshark. The screen is labeled 2020-10-05-Dridex-infection-traffic.pcap" width="900" height="671" /><figcaption id="caption-attachment-109222" class="wp-caption-text">Figure 22. Traffic from the fourth pcap filtered in Wireshark using our basic web filter.</figcaption></figure>
<p>Checking through the domains, there is one non-Microsoft domain using HTTPS traffic that might be tied to the initial infection activity:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">vardhmanproducts[.]com</span></li>
</ul>
<p>Once again, the focus will be on post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:</p>
<p style="text-align: center;"><span style="font-family: 'courier new', courier, monospace;">tls.handshake.type eq 11 and (ip.addr eq 85.114.134.25 or ip.addr eq 85.211.162.44)</span></p>
<p>After applying the filter, select the first frame, go to the frame details section and work your way to a list of lines that start with the term RDNSequence item as done in the first three examples.</p>
<p>The certificate issuer data follows the same pattern as the first three examples. Check the issuer data for both IP addresses, and you should find the data listed below.</p>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">85.114.134[.]25</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=NZ</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-stateOrProvinceName=Cepli thade0 ithentha temsorer</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Wellington</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Lling Lovisq NL</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationalUnitName=Punddtln</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=Onshthonese.vyrda-npeces.post</span></li>
</ul>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">85.211.162[.]44</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=MY</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Kuala Lumpur</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Ointavi Tagate Unltd.</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=Ateei7thapom.statonrc.loan</span></li>
</ul>
<h2><strong>Example Five: 2020-10-07-Dridex-infection-traffic.pcap</strong></h2>
<p>Open <strong><em>2020-10-07-Dridex-infection-traffic.pcap</em></strong> in Wireshark and use a basic web filter, as shown in Figure 23.</p>
<figure id="attachment_109224" aria-describedby="caption-attachment-109224" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109224" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/word-image-24.jpeg" alt="This screenshot shows Dridex infection traffic, filtered in Wireshark. The screen is labeled 2020-10-07-Dridex-infection-traffic.pcap" width="900" height="575" /><figcaption id="caption-attachment-109224" class="wp-caption-text">Figure 23. Traffic from the fifth pcap filtered in Wireshark using our basic web filter.</figcaption></figure>
<p>&nbsp;</p>
<p>Checking through the domains, there is one non-Microsoft domain using HTTPS traffic that might be tied to the initial infection activity:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">newmg532.wordswideweb[.]com</span></li>
</ul>
<p>Examine the post-infection Dridex C2 traffic. Use the following filter in Wireshark to look at the certificate issuer data for HTTPS traffic over the two IP addresses without domain names in the HTTPS traffic:</p>
<p style="text-align: center;"><span style="font-family: 'courier new', courier, monospace;">tls.handshake.type eq 11 and (ip.addr eq 177.87.70.3 or ip.addr eq 188.250.8.142)</span></p>
<p>After applying the filter, select the first frame, go to the frame details section and work your way to a list of lines that start with the term RDNSequence item as done in our first four examples.</p>
<p>The certificate issuer data follows the same pattern as our first four examples. Check the issuer data for both IP addresses and find the data listed below.</p>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">177.87.70[.]3</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=BS</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-stateOrProvinceName=Sshopedts Inccofrew</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Nassau</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Mesureder S.p.a.</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=avothelyop.thedai9neasysb.author</span></li>
</ul>
<p>Certificate issuer data for Dridex HTTPS C2 traffic on <span style="font-family: 'courier new', courier, monospace;">188.250.8[.]142</span>:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-countryName=UA</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-stateOrProvinceName=avandi0</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-LocalityName=Kiev</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationName=Icccodiso Icloneedb Oyj</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-organizationalUnitName=4Zenyfea</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">id-at-commonName=rebydustat.tci</span></li>
</ul>
<p>These five examples should give a good idea of what certificate issuer data for Dridex HTTPS C2 traffic looks like. These patterns differ from many other malware families, but they are somewhat similar to certificate issuer data from HTTPS C2 <a href="https://unit42.paloaltonetworks.com/tutorial-qakbot-infection/">Qakbot</a> network traffic.</p>
<p>However, with Qakbot, the <span style="font-family: 'courier new', courier, monospace;">stateOrProvinceName</span> is always a two-letter value, and the <span style="font-family: 'courier new', courier, monospace;">LocalityName</span> consists of random characters.</p>
<p>With Dridex, the <span style="font-family: 'courier new', courier, monospace;">stateOrProvinceName</span> consists of random characters, and the <span style="font-family: 'courier new', courier, monospace;">LocalityName</span> is the capital city of whatever country is used for the <span style="font-family: 'courier new', courier, monospace;">countryName</span>.</p>
<h2><strong>Conclusion</strong></h2>
<p>This tutorial reviewed how to identify Dridex activity from a pcap with Dridex network traffic. We reviewed five recent pcaps of Dridex infections and found similarities in certificate issuer data from the post-infection C2 traffic. The certificate issuer data is key to identifying a Dridex infection, since these patterns appear unique to Dridex.</p>
<p>For more help with Wireshark, see our previous tutorials:</p>
<ul>
<li><a href="https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/">Changing Your Column Display</a></li>
<li><a href="https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/">Display Filter Expressions</a></li>
<li><a href="https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/">Identifying Hosts and Users</a></li>
<li><a href="https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/">Exporting Objects from a Pcap</a></li>
<li><a href="https://unit42.paloaltonetworks.com/wireshark-tutorial-examining-trickbot-infections/">Examining Trickbot Infections</a></li>
<li><a href="https://unit42.paloaltonetworks.com/wireshark-tutorial-examining-ursnif-infections/">Examining Ursnif Infections</a></li>
<li><a href="https://unit42.paloaltonetworks.com/tutorial-qakbot-infection/">Examining Qakbot Infections</a></li>
<li><a href="https://unit42.paloaltonetworks.com/wireshark-tutorial-decrypting-https-traffic/">Decrypting HTTPS Traffic</a></li>
</ul>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<div class="ignite20promo">
    <div class="container">
    <div class="ignite20text">
        <div>
            <div class="orange-bar-sm"></div><br/>
        <span class="promo-heading">Secure Today,<br/>for a Better<br/>Tomorrow</span>
        </div>
        <div class="promo-subtext"><span>Join us at IGNITE’20</span>
            <a href="https://ignitereg.paloaltonetworks.com/flow/paloaltonetworks/ignite20/regsc/login?source=unit42" onclick="return false;">
                <svg width="17" height="12" viewBox="0 0 17 12" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M1.41089 6L15.3143 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10.1006 1L15.3144 6L10.1006 11" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
        </div>
        </div>
    </div> 
</div>
<script type="text/javascript">
    $('.ignite20promo').click(function(){
        window.open("https://ignitereg.paloaltonetworks.com/flow/paloaltonetworks/ignite20/regsc/login?source=unit42", "_blank"); 
    });
</script>    
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
