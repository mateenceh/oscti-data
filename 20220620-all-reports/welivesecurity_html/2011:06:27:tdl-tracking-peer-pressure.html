<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'David Harley',
        'ArticleCategory': 'Botnet',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>TDL Tracking: Peer Pressure | WeLiveSecurity</title>
<meta name="description" content="Recently our TDL tracker picked up a new plugin for TDL4 which we havenâ€™t seen previously, implementing a very interesting network communication protocol."/>
<link rel="canonical" href="https://www.welivesecurity.com/2011/06/27/tdl-tracking-peer-pressure/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="TDL Tracking: Peer Pressure | WeLiveSecurity" />
<meta property="og:description" content="Recently our TDL tracker picked up a new plugin for TDL4 which we havenâ€™t seen previously, implementing a very interesting network communication protocol." />
<meta property="og:url" content="https://www.welivesecurity.com/2011/06/27/tdl-tracking-peer-pressure/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:author" content="https://www.facebook.com/DavidHarleyArticles" />
<meta property="article:tag" content="bot" />
<meta property="article:tag" content="Botnet" />
<meta property="article:tag" content="C&amp;C" />
<meta property="article:tag" content="client-server" />
<meta property="article:tag" content="cmd32.dll" />
<meta property="article:tag" content="cmd64.dll" />
<meta property="article:tag" content="DHT" />
<meta property="article:tag" content="digital signature" />
<meta property="article:tag" content="kad.dll" />
<meta property="article:tag" content="Kademilia" />
<meta property="article:tag" content="nodes.dat" />
<meta property="article:tag" content="P2P" />
<meta property="article:tag" content="RSA" />
<meta property="article:tag" content="svchost.exe" />
<meta property="article:tag" content="TCP" />
<meta property="article:tag" content="TDL tracker" />
<meta property="article:tag" content="TDL4" />
<meta property="article:tag" content="UDP" />
<meta property="article:tag" content="white papers" />
<meta property="article:tag" content="Win32/Olmarik" />
<meta property="article:section" content="Botnet" />
<meta property="article:published_time" content="2011-06-27T08:16:34+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/media_files/p2p-300x163.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/media_files/p2p-300x163.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Recently our TDL tracker picked up a new plugin for TDL4 which we havenâ€™t seen previously, implementing a very interesting network communication protocol." />
<meta name="twitter:title" content="TDL Tracking: Peer Pressure | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/media_files/p2p-300x163.png" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>TDL Tracking: Peer Pressure</h1>
<div class="excerpt">Recently ... our TDL tracker picked up a brand new plugin for TDL4 kad.dll (Win32/Olmarik.AVA) which we haven’t seen earlier ... we discovered that it implements a particularly interesting network communication protocol ...</div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2011-06-27 01:16:34">27 Jun 2011 - 01:16AM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2011%2F06%2F27%2Ftdl-tracking-peer-pressure%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2011%2F06%2F27%2Ftdl-tracking-peer-pressure%2F&text=TDL Tracking: Peer Pressure%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2011%2F06%2F27%2Ftdl-tracking-peer-pressure%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Recently &#8230; our TDL tracker picked up a brand new plugin for TDL4 kad.dll (Win32/Olmarik.AVA) which we haven’t seen earlier &#8230; we discovered that it implements a particularly interesting network communication protocol &#8230;</p>
                            </div>

                            <p>[News from my colleagues in Russia, Aleksandr Matrosov and Eugene Rodionov.]</p>
<p>Recently, we had a stroke of luck: our TDL tracker picked up a brand new plugin for TDL4 kad.dll (Win32/Olmarik.AVA) which we haven&rsquo;t seen previously. It took some time to find out what it is intended to do. After some preliminary analysis we discovered that it implements a particularly interesting network communication protocol which attracted our attention and made us dig deeper.</p>
<p><em>Kad.dll </em>is intended to be injected into the 32-bit svchost.exe process. The main purpose of the module is to download and execute other malicious software on the infected system. Although there is nothing new in its functionality it differs drastically from <em>cmd32.dll</em> and <em>cmd64.dll</em> in the way it receives commands and additional modules. In contrast to other known plugins obtaining bot instructions from C&amp;C servers listed in a configuration file, <em>kad.dll </em>relies on a P2P (Peer to Peer) network generated by other bots. It is the Kademilia Distributed Hash Table (DHT) P2P protocol which <em>kad.dll </em>implements in order to talk with peers over the network.</p>
<p>In contrast to a Client-Server architecture where there is a list of dedicated C&amp;C (Command and Control) servers that the bots should talk to, in a P2P network all the peers are equivalent: that is. each node is a C&amp;C server and a bot at the same time (this is explained in the following figure).</p>
<p><a href="/wp-content/media_files/p2p.png"><img alt="" class="alignleft size-medium wp-image-8340" height="163" src="/wp-content/media_files/p2p-300x163.png" title="p2p" width="300" /></a></p>
<p><em><span style="color: #0000ff">Figure 1</span></em></p>
<p>As there is no single point from which bots in a P2P bot network are coordinated , such botnets are much more resistant to takedowns than Client-Server botnets. Configuration information and payload are shared among all the nodes in the network, according to the specific implementation of the P2P protocol, and can be efficiently obtained by any peer node in the network. Individual bots join and leave the P2P network over time, but that doesn&rsquo;t significantly influence the availability of the information stored in the network. And that makes takedown of the P2P botnet a challenging task. As long as a sufficient number of bots remain alive it is possible to maintain coordination and control of the bot network.</p>
<p>The Kad-protocol is a kind of DHT protocol where the information is stored as a (<em>key, value</em>) pair. The key is an MD4 hash of <em>value </em>which could be a file or a keyword (part of the file name) or a node ID. The resulting hash table is distributed between the peers.</p>
<p>Communication between peers is performed over the TCP and UDP protocols. TCP is used to transmit a file from one node to another, while UDP is used to search files and other peers in the P2P network.</p>
<p>The plugin stores the list of neighboring nodes in the <em>nodes.dat</em> file in TDL4&rsquo;s hidden file system, which it also downloads from C&amp;C.</p>
<p>File nodes.dat has the layout described by the following structures:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a007e6c4272660521" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
typedef struct _NODES_DAT_LAYOUT
{
 // Set to zero
 DWORD Reserved0;
// Set to 0x000002
DWORD Reserved1;

// Number of entries in the file
 DWORD NumEntries;
// Array of size NumEntries of NODES_DAT_PEER_INFO structures describing peers
 NODES_DAT_PEER_INFO PeerInfo[1];
} NODES_DAT_LAYOUT, * NODES_DAT_LAYOUT;

typedef struct _NODES_DAT_PEER_INFO
{
 // 128-bit peer identifier (MD4 of node ID)
 BYTE PeerId[16];
// IP address of the peer
DWORD PeerIp;
// Peer UDP port number
 WORD UdpPort;
 // Peer TCP port number
 WORD TcpPort;
} NODES_DAT_PEER_INFO, * NODES_DAT_PEER_INFO;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-2">2</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-4">4</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-6">6</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-8">8</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-10">10</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-12">12</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-14">14</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-16">16</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-18">18</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-20">20</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-22">22</div><div class="crayon-num" data-line="crayon-60581a007e6c4272660521-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581a007e6c4272660521-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a007e6c4272660521-1"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">_NODES_DAT_LAYOUT</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-3"><span class="crayon-h"> </span><span class="crayon-c">// Set to zero</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-4"><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-v">Reserved0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-5"><span class="crayon-c">// Set to 0x000002</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-6"><span class="crayon-e">DWORD </span><span class="crayon-v">Reserved1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-8"><span class="crayon-c">// Number of entries in the file</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-9"><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-v">NumEntries</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-10"><span class="crayon-c">// Array of size NumEntries of NODES_DAT_PEER_INFO structures describing peers</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-11"><span class="crayon-h"> </span><span class="crayon-e">NODES_DAT_PEER_INFO </span><span class="crayon-v">PeerInfo</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-12"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-v">NODES_DAT_LAYOUT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">NODES_DAT_LAYOUT</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-14"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">_NODES_DAT_PEER_INFO</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-15"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-16"><span class="crayon-h"> </span><span class="crayon-c">// 128-bit peer identifier (MD4 of node ID)</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-17"><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-v">PeerId</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-18"><span class="crayon-c">// IP address of the peer</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-19"><span class="crayon-e">DWORD </span><span class="crayon-v">PeerIp</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-20"><span class="crayon-c">// Peer UDP port number</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-21"><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-v">UdpPort</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-22"><span class="crayon-h"> </span><span class="crayon-c">// Peer TCP port number</span></div><div class="crayon-line" id="crayon-60581a007e6c4272660521-23"><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-v">TcpPort</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581a007e6c4272660521-24"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-v">NODES_DAT_PEER_INFO</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">NODES_DAT_PEER_INFO</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>On the one hand, the file <em>nodes.dat </em>is used to maintain the bot&rsquo;s contacts&nbsp;during system reboot as it is populated with the information on neighboring nodes. On the other hand, when the number of the bot&rsquo;s contacts is very small (in this case, smaller than 10) then <em>kad.dll</em> downloads the file from C&amp;C and a sufficient number of peers to contact is therefore guaranteed.</p>
<p>To be sure that the files downloaded from the P2P network are issued by the owner of the botnet, <em>kad.dll </em>verifies the digital signature appended to the files. Each file downloaded by the peer has the following layout:</p>
<p><a href="/wp-content/media_files/data_struct.png"><img alt="" class="alignleft size-medium wp-image-8341" height="46" src="/wp-content/media_files/data_struct-300x46.png" title="data_struct" width="300" /></a></p>
<p><span style="color: #0000ff"><em>Figure 2</em></span></p>
<p>As we can see from Figure 2 the last 132 bytes (1056 bits) of the file contain the file&rsquo;s digital signature calculated with an RSA digital signature algorithm.</p>
<p><strong>Eugene Rodionov, Malware Researcher<br />
	Aleksandr Matrosov, Senior Malware Researcher</strong></p>
<p>There&#39;ll be more information in a revision of the authors&#39; paper <a href="http://www.eset.com/us/resources/white-papers/The_Evolution_of_TDL.pdf">The Evolution of TDL: Conquering x64</a>: I&#39;ll post another blog article when the revised version goes up on the <a href="http://www.eset.com/us/documentation/white-papers">ESET&nbsp;white papers page</a>.</p>
<p><strong>David Harley, Senior Research Fellow</strong></p>
<p>&nbsp;</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2011-06-27 01:16:34">27 Jun 2011 - 01:16AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2020/10/12/eset-takes-part-global-operation-disrupt-trickbot/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/10/eset-trickbot-botnet-global-disruption-operation-623x432.jpg"
                                                         alt="TDL Tracking: Peer Pressure">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2020/10/12/eset-takes-part-global-operation-disrupt-trickbot/">
                                                    ESET takes part in global operation to disrupt Trickbot                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2020/04/23/eset-discovery-monero-mining-botnet-disrupted/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/04/ESET-usb-drives-monero-mining-botnet-disrupted-623x432.jpg"
                                                         alt="TDL Tracking: Peer Pressure">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2020/04/23/eset-discovery-monero-mining-botnet-disrupted/">
                                                    Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2018/11/27/3ve-online-ad-fraud-disrupted/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/11/shutterstock_411660106-623x432.jpg"
                                                         alt="TDL Tracking: Peer Pressure">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/11/27/3ve-online-ad-fraud-disrupted/">
                                                    3ve – Major online ad fraud operation disrupted                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2018/08/21/smart-irrigation-systems-vulnerable-warn-researchers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/08/Irrigation_Systems-623x432.jpg"
                                                         alt="TDL Tracking: Peer Pressure">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/08/21/smart-irrigation-systems-vulnerable-warn-researchers/">
                                                    Smart irrigation systems vulnerable to attacks, warn researchers                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2011%2F06%2F27%2Ftdl-tracking-peer-pressure%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2011%2F06%2F27%2Ftdl-tracking-peer-pressure%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2011%2F06%2F27%2Ftdl-tracking-peer-pressure%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"8339 http:\/\/blog.eset.com\/?p=8339","disqusShortname":"welivesecurity","disqusTitle":"TDL Tracking: Peer Pressure","disqusUrl":"https:\/\/www.welivesecurity.com\/2011\/06\/27\/tdl-tracking-peer-pressure\/","postId":"8339"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>