<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Aleksandr Matrosov',
        'ArticleCategory': 'Bank fraud',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Smartcard vulnerabilities in modern banking malware | WeLiveSecurity</title>
<meta name="description" content="Aleksandr Matrosov and Eugene Rodionov presented their research into Ã¢â‚¬Å“Smartcard vulnerabilities in modern banking malwareÃ¢â‚¬Â at PHDays&#039;2012."/>
<link rel="canonical" href="https://www.welivesecurity.com/2012/06/05/smartcard-vulnerabilities-in-modern-banking-malware/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Smartcard vulnerabilities in modern banking malware | WeLiveSecurity" />
<meta property="og:description" content="Aleksandr Matrosov and Eugene Rodionov presented their research into Ã¢â‚¬Å“Smartcard vulnerabilities in modern banking malwareÃ¢â‚¬Â at PHDays&#039;2012." />
<meta property="og:url" content="https://www.welivesecurity.com/2012/06/05/smartcard-vulnerabilities-in-modern-banking-malware/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="Eurovision 2012" />
<meta property="article:tag" content="Hodprot" />
<meta property="article:tag" content="Nuclear Pack" />
<meta property="article:tag" content="PHDays&#039;2012" />
<meta property="article:tag" content="RDPdoor" />
<meta property="article:tag" content="smartcard" />
<meta property="article:tag" content="Win32/Georbot" />
<meta property="article:tag" content="Win32/Spy.Ranbyus" />
<meta property="article:section" content="Bank fraud" />
<meta property="article:published_time" content="2012-06-05T19:49:48+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/media_files/1.1.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/media_files/1.1.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Aleksandr Matrosov and Eugene Rodionov presented their research into Ã¢â‚¬Å“Smartcard vulnerabilities in modern banking malwareÃ¢â‚¬Â at PHDays&#039;2012." />
<meta name="twitter:title" content="Smartcard vulnerabilities in modern banking malware | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/media_files/1.1.png" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Smartcard vulnerabilities in modern banking malware</h1>
<div class="excerpt">Aleksandr Matrosov and Eugene Rodionov presented their research into â€œSmartcard vulnerabilities in modern banking malwareâ€ at PHDays'2012.</div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2012-06-05 12:49:48">5 Jun 2012 - 12:49PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2012%2F06%2F05%2Fsmartcard-vulnerabilities-in-modern-banking-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2012%2F06%2F05%2Fsmartcard-vulnerabilities-in-modern-banking-malware%2F&text=Smartcard vulnerabilities in modern banking malware%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2012%2F06%2F05%2Fsmartcard-vulnerabilities-in-modern-banking-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Aleksandr Matrosov and Eugene Rodionov presented their research into â€œSmartcard vulnerabilities in modern banking malwareâ€ at PHDays&#8217;2012.</p>
                            </div>

                            <p>Last week an epic security event took place in Russia &ndash; the <a href="http://phdays.com/">PHDays&rsquo;2012</a> conference. This event started last year as the first conference in Russia for security researchers focusing on deeply technical speakers &ndash; all the videos translated into English are already online <a href="http://digitaloctober.com/event/positive_hack_days">he</a><a href="http://digitaloctober.com/event/positive_hack_days">re</a>. This year, ESET Canada&#39;s Pierre-Marc Bureau presented a workshop on &ldquo;Win32/Georbot. Understanding a malware and automating its analysis&rdquo;, about reverse engineering the Georbot trojan. And I and my colleague Eugene Rodionov presented the results of our research into &ldquo;Smartcard vulnerabilities in modern banking malware&rdquo;.</p>
<p>Our presentation starts with a consideration of the evolution of the Carberp family of banking malware (we already discussed this in our <a href="http://blog.eset.com/2012/05/24/carberp-gang-evolution-at-caro-2012">CARO presentation in May</a>). &nbsp;</p>
<p>On the day before the conference I tracked blackhat SEO poisoning on the Russian Google search results page for requests relating to Eurovision 2012 in the Russian language.</p>
<p><a href="/wp-content/media_files/1.1.png"><img alt="" class="aligncenter size-full wp-image-13060" height="240" src="/wp-content/media_files/1.1.png" title="1.1" width="650" /></a></p>
<p>The first Google search item returned is a redirect to a malicious webpage passing itself off as a legitimate site about Eurovision 2012. If a malicious JavaScript detected real user activity, the next step would be a redirection to a <a href="http://blog.eset.com/2012/04/05/blackhole-exploit-kit-plays-with-smart-redirection">Nuclear Pack exploitation service</a>.</p>
<p><a href="/wp-content/media_files/2.2.png"><img alt="" class="aligncenter size-full wp-image-13062" height="160" src="/wp-content/media_files/2.2.png" title="2.2" width="650" /></a></p>
<p>Nuclear Pack uses some interesting techniques for generating unique file names with exploitation vectors to bypass crawlers &#8211; if you can&rsquo;t step all the way through the malicious redirection you can&rsquo;t track all the logic that governs name generation). All java exploits here used layered obfuscation, and used applet parameters to implement the deobfuscation flow.&nbsp;</p>
<p>The second part of our talk was about attack techniques against client-bank systems. The most interesting part of presentation was about vectors for attacks on smartcards. In 2010 we already published a blogpost &ndash; &ldquo;<a href="http://blog.eset.com/2010/11/05/dr-zeus-the-bot-in-the-hat">Dr. Zeus: the Bot in the Hat</a>&rdquo; &ndash; about the manipulation of APDU commands and hidden remote channels for controlling a smartcard device. This bot is still in the wild and ESET detects this family as Win32/Spy.Ranbyus (MD5: F2744552D24F7EA31E64228EB3022830). We have found functionality for covert smartcard manipulation in the code of the latest modifications too. The current C&#038;C (Command &#038; Control) has changed domain, to&nbsp; wh1tesun.info (80.79.117.171).</p>
<p><a href="/wp-content/media_files/net.1.png"><img alt="" class="aligncenter size-full wp-image-13064" height="57" src="/wp-content/media_files/net.1.png" title="net.1" width="700" /></a></p>
<p>If Win32/Spy.Ranbyus finds an active smartcard or smartcard reader device on the infected machine, the bot sends this information to the C&#038;C with a description of the type of smartcard it finds. All malicious smartcard manipulation works at the SmartCard API level.</p>
<p><a href="/wp-content/media_files/3.3.png"><img alt="" class="aligncenter size-full wp-image-13065" height="437" src="/wp-content/media_files/3.3.png" title="3.3" width="650" /></a></p>
<p>The user authenticates to the smartcard device, and the bot sends a signal to the C&#038;C. After that, the smartcard can be used remotely through the C&#038;C by means of APDU command manipulation, allowing all typical smartcard workflow using the victim&#39;s credentials.</p>
<p>The next interesting case involving smartcards was detected at the beginning of this year. Hodprot, the latest Carberp cybercrime group, switched to using RDPdoor v4.2.x (MD5: 0E9CCECABA272942F1A4297E42D3BA43). This modification collects information about an infected system and devices in use by means of SetupApi.</p>
<p><a href="/wp-content/media_files/4.4.png"><img alt="" class="aligncenter size-full wp-image-13066" height="561" src="/wp-content/media_files/4.4.png" title="4.4" width="700" /></a></p>
<p>&nbsp;Its activity is focused on smartcard devices used in Russian remote banking systems:</p>
<p><a href="/wp-content/media_files/5.5.png"><img alt="" class="aligncenter size-full wp-image-13067" height="614" src="/wp-content/media_files/5.5.png" title="5.5" width="700" /></a></p>
<p>&nbsp;If a smartcard device is detected, the bot prepares a special description to send to the C&#038;C:</p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p><vendorid> <productid><revision><inforetrievedfromdevice><devicenameordescription></devicenameordescription></inforetrievedfromdevice></revision></productid></vendorid></p>
<p>[VendorId]:[ProductId]:[Revision]:[InfoRetrievedFromDevice]:[DeviceNameOrDescription]</p>
<p>Examples of the filled-in structure look like this:</p>
<p style="margin-left: 35.4pt">0A89:0060:0102:06512119781D0E:Rutoken Magistra;</p>
<p style="margin-left: 35.4pt">096E:0005:0290:065C62807A1C0E:USB Token Device;</p>
<p style="margin-left: 35.4pt">0A89:0060:0102:06336059708D9E:Rutoken Magistra;</p>
<p style="margin-left: 35.4pt">0CA6:00A0:0010:06024350706F87:USB Smart Card reader;</p>
<p style="margin-left: 35.4pt">23A0:0002:0100:20BEA090712EC1:BIFIT ICCD Smart Card Reader;</p>
<p style="margin-left: 35.4pt">2022:0008:1001::USB Smart Card reader;</p>
<p style="margin-left: 35.4pt">A420:542A:0100::VPN Key;</p>
<p style="margin-left: 35.4pt">0A89:0020:0200::Rutoken S;</p>
<p>RDPdoor collects a great deal of information about the infected system to facilitate the following analysis by the botmaster.&nbsp;</p>
<p><a href="/wp-content/media_files/6.6.png"><img alt="" class="aligncenter size-full wp-image-13068" height="186" src="/wp-content/media_files/6.6.png" title="6.6" width="800" /></a></p>
<p>After analysis, the botmaster can send additional commands back to the bot for installing additional modules onto the infected system. If a smartcard device is detected, RDPdoor can install FabulaTech USB for Remote Desktop to implement remote control of smartcards on the infected machine.</p>
<p>The use of smart cards reduces the security risks of online transactions, but we see here some attacks that bypass smartcard security at the operating system API level in order to steal money.</p>
<p><strong>Aleksandr Matrosov, Security Intelligence Team Lead</strong></p>
<p>&nbsp;</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2012-06-05 12:49:48">5 Jun 2012 - 12:49PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/blackhole/" class="category-tag-btn">Blackhole</a>                                                <a href="https://www.welivesecurity.com/2013/03/20/win32crydex-java-pushes-cyprus-into-a-blackhole/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2013/03/cyprus-blackhole-623x400.jpg"
                                                         alt="Smartcard vulnerabilities in modern banking malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2013/03/20/win32crydex-java-pushes-cyprus-into-a-blackhole/">
                                                    Win32/Cridex: Java pushes Cyprus into a Blackhole                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/bank-fraud/" class="category-tag-btn">Bank fraud</a>                                                <a href="https://www.welivesecurity.com/2012/10/31/online-shopping-and-a-phishing-pheeding-phrenzy-2/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/image151x103.jpg"
                                                         alt="Smartcard vulnerabilities in modern banking malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2012/10/31/online-shopping-and-a-phishing-pheeding-phrenzy-2/">
                                                    Online Shopping and a Phishing Pheeding Phrenzy [2]                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/atm/" class="category-tag-btn">ATM</a>                                                <a href="https://www.welivesecurity.com/2012/09/07/security-dont-bank-on-it/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/image151x103.jpg"
                                                         alt="Smartcard vulnerabilities in modern banking malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2012/09/07/security-dont-bank-on-it/">
                                                    ATM Security? Don&#039;t bank on it.                                                 </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-russia/" class="category-tag-btn">ESET Russia</a>                                                <a href="https://www.welivesecurity.com/2012/07/20/flame-in-depth-code-analysis-of-mssecmgr-ocx/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/image151x103.jpg"
                                                         alt="Smartcard vulnerabilities in modern banking malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2012/07/20/flame-in-depth-code-analysis-of-mssecmgr-ocx/">
                                                    Flame, Duqu and Stuxnet: in-depth code analysis of mssecmgr.ocx                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2012%2F06%2F05%2Fsmartcard-vulnerabilities-in-modern-banking-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2012%2F06%2F05%2Fsmartcard-vulnerabilities-in-modern-banking-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2012%2F06%2F05%2Fsmartcard-vulnerabilities-in-modern-banking-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"13055 http:\/\/blog.eset.com\/?p=13055","disqusShortname":"welivesecurity","disqusTitle":"Smartcard vulnerabilities in modern banking malware","disqusUrl":"https:\/\/www.welivesecurity.com\/2012\/06\/05\/smartcard-vulnerabilities-in-modern-banking-malware\/","postId":"13055"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>