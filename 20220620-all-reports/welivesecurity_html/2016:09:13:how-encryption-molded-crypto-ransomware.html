<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Cassius Puodzius',
        'ArticleCategory': 'Ransomware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How encryption molded crypto&#8209;ransomware | WeLiveSecurity</title>
<meta name="description" content="Recently ESET has seen significantly increasing volumes of a particular type of ransomware known as crypto-ransomware, reports Cassius Puodzius."/>
<link rel="canonical" href="https://www.welivesecurity.com/2016/09/13/how-encryption-molded-crypto-ransomware/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How encryption molded crypto&#8209;ransomware | WeLiveSecurity" />
<meta property="og:description" content="Recently ESET has seen significantly increasing volumes of a particular type of ransomware known as crypto-ransomware, reports Cassius Puodzius." />
<meta property="og:url" content="https://www.welivesecurity.com/2016/09/13/how-encryption-molded-crypto-ransomware/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Ransomware" />
<meta property="article:published_time" content="2016-09-13T11:45:07+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2016/09/shutterstock_439008748_Martial-Red.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2016/09/shutterstock_439008748_Martial-Red.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="410" />
<meta property="og:image:alt" content="ransomware" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Recently ESET has seen significantly increasing volumes of a particular type of ransomware known as crypto-ransomware, reports Cassius Puodzius." />
<meta name="twitter:title" content="How encryption molded crypto&#8209;ransomware | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2016/09/shutterstock_439008748_Martial-Red.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>How encryption molded crypto&#8209;ransomware</h1>
<div class="excerpt">Recently ESET has seen significantly increasing volumes of a particular type of ransomware known as crypto-ransomware, reports Cassius Puodzius.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/cpuodzius/" title="Cassius Puodzius">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2016/05/cassius-puodzius-wls-e1466535453215.jpg" alt="Cassius Puodzius">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/cpuodzius/" title="Cassius Puodzius">
                    Cassius Puodzius                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2016-09-13 13:45:07">13 Sep 2016 - 01:45PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F09%2F13%2Fhow-encryption-molded-crypto-ransomware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F09%2F13%2Fhow-encryption-molded-crypto-ransomware%2F&text=How encryption molded crypto&#8209;ransomware%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F09%2F13%2Fhow-encryption-molded-crypto-ransomware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Recently ESET has seen significantly increasing volumes of a particular type of ransomware known as crypto-ransomware, reports Cassius Puodzius.</p>
                            </div>

                            <p><a href="/2014/06/09/ransomware-101-faq/" target="_blank">Ransomware</a> is a major threat that keeps <a href="/wp-content/uploads/2016/02/Rise_of_Android_Ransomware.pdf" target="_blank">growing over time</a>. According to <a href="https://www.cisco.com/c/m/en_us/offers/sc04/2016-midyear-cybersecurity-report/index.html" target="_blank">Cisco’s recent midyear report</a>, it dominates the malware market and is the <em>most profitable malware type in history</em>.</p>
<p>By now, it seems unlikely any regular reader of our blog does not already know something about ransomware. If you do not—or would like a great summary—you must listen to our <a href="/podcasts/ransomware-101/" target="_blank">podcast</a> by ESET&#8217;s distinguished researcher Aryeh Goretsky.</p>
<p>In short, ransomware uses an assortment of techniques to block access to the victim’s system or files, usually requiring <a href="/2015/04/23/ransomware-pay-cybercriminals/" target="_blank">payment of a ransom</a> to regain access. Recently we have seen significantly increasing volumes of a particular type of ransomware known as crypto-ransomware.</p>
<p>In this article, we look at how crypto-ransomware employs encryption and analyze some of the <a href="/2016/04/28/ransomware-is-everywhere-but-even-black-hats-make-mistakes/" target="_blank">mistakes made by cybercriminals</a> over time.</p>
<h1>Ransomware and encryption</h1>
<p>Encryption is a key element of crypto-ransomware, since its entire business plan depends on the successful use of encryption to lock the victims’ <a href="/2013/09/23/filecoder-holding-your-data-to-ransom/" target="_blank">files</a> or file systems, and victims lacking recovery plans such as <a href="http://www.eset.com/fileadmin/Images/US/Docs/Home/Staying_Secure/2205_19_0_EsetWP-OptionsBackingUpComputer.pdf" target="_blank">data backups</a>s.</p>
<p>This does not mean that encryption is intrinsically evil. Actually, it is a powerful and legitimate tool employed by individuals, businesses and governments to protect data from unauthorized access. Just like any other powerful tool encryption may be misused, which is exactly what crypto-ransomware does.</p>
<h2>Why does crypto-ransomware use encryption?</h2>
<p>Crypto-ransomware intends to “kidnap” data – hence the name. Encryption grants confidentiality to data, allowing only those who have the secret key to retrieve or access the original content, making it a perfect match to the criminal&#8217;s needs.</p>
<p>Once crypto-ransomware takes hold in a system, it starts changing files or critical file system structures in such a way that they can only be read or used by restoring them to their original state. This requires the use of a key known only by the cybercriminals operating the malware.</p>
<p>Misused in this way, data encryption and decryption is analogous to holding data hostage and then (maybe) setting them free. Thus, encryption is used as a means to capture the victims’ data and extort a ransom from the victims in order to release the seized data.</p>
<p>Encryption is also used to secure the communication between the malware and its <a href="http://www.virusradar.com/en/glossary/command-and-control-server" target="_blank">command and control server</a> (C&amp;C), which will ultimately hold a key necessary either to decrypt data or recover the decryption key necessary to recover the files or file system to their original unencrypted form.</p>
<p>The main reasons for dual encryption are performance and convenience. Symmetric and asymmetric encryption are combined in order to get the best of both methods, in a technique that resembles a <a href="https://www.techopedia.com/definition/18859/digital-envelope" target="_blank">digital envelope</a>.</p>
<p>In symmetric encryption, the same secret key is used in both encryption and decryption methods, whereas asymmetric encryption involves a private key, which is known only by its owner, and a public key, which may be known by anyone, where the encryption method uses the public key and the decryption method uses the private key.</p>
<p>Symmetric encryption is useful to crypto-ransomware because it is very efficient in terms of performance, allowing the malware to execute in reasonable time. On the other hand, asymmetric encryption is convenient because it enables the malware operator to (super-) protect only one private key regardless of the number of victims, otherwise the malware operator would have to keep a record of a (symmetric) secret key for each one of the victims.</p>
<p>Thus, to achieve high performance and keep the benefits of asymmetric encryption, crypto-ransomware usually uses symmetric encryption to encrypt the victims’ files and asymmetric encryption to protect the symmetric secret key.</p>
<div id="attachment_83793" style="width: 985px" class="wp-caption aligncenter"><img class=" wp-image-83793" src="/wp-content/uploads/2016/09/ransomware_english-1.jpg" alt="crypto-ransomware" width="975" height="700" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/09/ransomware_english-1.jpg 1292w, https://www.welivesecurity.com/wp-content/uploads/2016/09/ransomware_english-1-300x215.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2016/09/ransomware_english-1-768x552.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2016/09/ransomware_english-1-1024x736.jpg 1024w" sizes="(max-width: 975px) 100vw, 975px" /><p class="wp-caption-text">Figure 1: Schematic of dual encryption in crypto-ransomware</p></div>
<p>Protection of the symmetric key varies, but mostly frequently the crypto-ransomware’s public key is embedded into the malware or fetched from the C&amp;C server, then used to directly encrypt the symmetric key or to take part in its encryption process. After undergoing encryption, the symmetric key is often exfiltrated or stored on the affected system.</p>
<h3>Communication with command and control servers: evasion and confidentiality</h3>
<p>We can identify at least two main goals for deploying encryption in the communication between the compromised system and C&amp;C: evasion and confidentiality.</p>
<p>Early families and versions of crypto-ransomware prioritized confidentiality for C&amp;C communication. Newer families and variants have evolved and are adopting <em>de facto</em> encryption standards such as <a href="https://tools.ietf.org/html/rfc5246" target="_blank">TLS</a>.</p>
<p>This makes proactive network level detection much more difficult because it is harder to distinguish whether encryption is in place to secure legitimate communications, such as web-banking, or if it is used to disguise communication with the C&amp;Cs.</p>
<p>When encrypted C&amp;C communication is used, network-level detection requires the victim’s network to feature additional capabilities in order to inspect the traffic. As an example, TLS inspection can be provided by <a href="/2015/04/30/ids-firewall-antivirus-need-installed/" target="_blank">IDS/IPS</a> in the network that stands in the middle of communication between the internal hosts and the remote servers. TLS inspection is also possible at the host level, depending on the capabilities of the antimalware suite in use.</p>
<p>In cases where the network does not have such a capability, malware using encryption to establish a connection with its C&amp;C server will run undetected until the C&amp;Cs are discovered and added to blacklists of malicious IPs and domains. Consequently, this type of protection is mostly reactive.</p>
<h2>Encryption glitches in various ransomware families</h2>
<p>ESET has covered <a href="/2016/07/07/ransomware-first-files-now-complete-devices/" target="_blank">the evolution of crypto-ransomware</a> previously, showing its growing prominence. The number of families, variants and targeted platforms has increased significantly since 2011.</p>
<div id="attachment_83802" style="width: 855px" class="wp-caption aligncenter"><img class="size-full wp-image-83802" src="/wp-content/uploads/2016/09/2.png" alt="Figure 2: Number of Windows file encrypting ransomware programs in the period from 2011 to 2015" width="845" height="442" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/09/2.png 845w, https://www.welivesecurity.com/wp-content/uploads/2016/09/2-300x157.png 300w, https://www.welivesecurity.com/wp-content/uploads/2016/09/2-768x402.png 768w" sizes="(max-width: 845px) 100vw, 845px" /><p class="wp-caption-text">Figure 2: <a href="/2016/07/07/ransomware-first-files-now-complete-devices/" target="_blank">Number of Windows file encrypting ransomware programs</a> in the period from 2011 to 2015</p></div>
<p>The rest of this post takes a closer look at how encryption was used by four crypto-ransomware families at different stages of their evolution: CryptoDefense (2014), TorrentLocker (2014), the overwhelmingly successful TeslaCrypt (2015) and Petya (2016).</p>

<table id="tablepress-251" class="tablepress tablepress-id-251">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Crypto-ransomware</th><th class="column-2">Dual encryption</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">CryptoDefense</td><td class="column-2">X</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">TorrentLocker</td><td class="column-2">✓</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">TeslaCrypt</td><td class="column-2">✓</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Petya</td><td class="column-2">X</td>
</tr>
</tbody>
</table>

<p>CryptoDefenseThe goal is to show how crypto-ransomware has evolved over time and analyze the mistakes made by cybercriminals along the way – from the silliest to the most sophisticated.</p>
<p>When CryptoDefense first appeared it was <a href="http://www.symantec.com/connect/blogs/cryptodefense-cryptolocker-imitator-makes-over-34000-one-month" target="_blank">strikingly similar to CryptoLocker</a>, which was one of the first crypto-ransomware families to make an impact. Notably, <a href="https://www.botconf.eu/wp-content/uploads/2015/12/OK-P14-Yonathan-Klijnsma-The-Story-of-CryptoWall-a-historical-analysis-of-a-large-scale-cryptographic-ransomware-threat.pdf" target="_blank">CryptoDefense had major implementation flaws</a> in its C&amp;C communication as well as in its file encryption process.</p>
<p>CryptoDefense’s C&amp;C protocol is based on HTTP POSTs sent from the malware on the compromised host. In order to secure C&amp;C communication, CryptoDefense employs <a href="https://danielmiessler.com/study/encoding-encryption-hashing-obfuscation/" target="_blank">obfuscation</a> in the HTTP POST URL as a way to conceal the key used to encrypt the message body. The POST message carries the C&amp;C protocol message encrypted with <a href="https://en.wikipedia.org/wiki/RC4" target="_blank">RC4</a> using the concealed key from the POST URL.</p>
<div id="attachment_83801" style="width: 893px" class="wp-caption aligncenter"><img class="size-full wp-image-83801" src="/wp-content/uploads/2016/09/3.png" alt="Figure 3: Decryption of CryptoDefense C&amp;C protocol" width="883" height="404" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/09/3.png 883w, https://www.welivesecurity.com/wp-content/uploads/2016/09/3-300x137.png 300w, https://www.welivesecurity.com/wp-content/uploads/2016/09/3-768x351.png 768w" sizes="(max-width: 883px) 100vw, 883px" /><p class="wp-caption-text"><a href="https://www.botconf.eu/wp-content/uploads/2015/12/OK-P14-Yonathan-Klijnsma-The-Story-of-CryptoWall-a-historical-analysis-of-a-large-scale-cryptographic-ransomware-threat.pdf" target="_blank">Figure 3</a>: Decryption of CryptoDefense C&amp;C protocol</p></div>
<p>Once C&amp;C communication is intercepted, encryption notwithstanding, it can be easily deciphered. The request contains all the information required to recover the encryption key and unveil the underlying CryptoDefense C&amp;C protocol, allowing the creation of network signatures that can prevent CryptoDefense’s file-encrypting payload from succeeding.</p>
<p>For file encryption the error is astonishingly similar. As a means of highlighting CryptoDefense’s mistake, let’s recall the <a href="https://www.botconf.eu/wp-content/uploads/2015/12/OK-P14-Yonathan-Klijnsma-The-Story-of-CryptoWall-a-historical-analysis-of-a-large-scale-cryptographic-ransomware-threat.pdf">basic operation of CryptoLocker</a>:</p>
<ol>
<li>CryptoLocker (client) compromises the victim&#8217;s system and notifies its C&amp;C server with a campaign ID and a unique system ID</li>
<li>C&amp;C responds with an OK to acknowledge the client</li>
<li>Client sends another request with the campaign ID and its unique system ID</li>
<li>C&amp;C provides the ransom note and the public key of a <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank">RSA</a>-2048 pair uniquely-generated for that campaign ID/system ID combination. The private key never leaves the C&amp;C server.</li>
<li>Client acknowledges that it successfully received the ransom note and C&amp;C public key, and that the encryption process is complete</li>
</ol>
<p>In order to fix a deficiency found in CryptoLocker, in which encryption takes place only after successful communication with the C&amp;C, CryptoDefense decided to generate keys for file encryption on the compromised host – skipping steps 3 and 4.</p>
<p>Nonetheless, a <a href="http://www.symantec.com/connect/blogs/cryptodefense-cryptolocker-imitator-makes-over-34000-one-month" target="_blank">slight detail was overlooked</a> by CryptoDefense’s authors. The encryption key, generated on the compromised host and used for file encryption, was never deleted. Thus, decryption can be <a href="http://www.theregister.co.uk/2014/04/03/cryptodefense_rsa_private_key_on_disk/" target="_blank">easily accomplished</a> by finding the private RSA key on the victim’s system and feeding it into the Windows API to decrypt the affected files.</p>
<p>So, CryptoDefense suffered twice from the same basic mistake: using encryption but giving away the key.</p>
<h3>TorrentLocker</h3>
<p>Early and <a href="http://digital-forensics.sans.org/blog/2014/09/09/torrentlocker-unlocked" target="_blank">flawed</a> versions of <a href="/wp-content/uploads/2014/12/torrent_locker.pdf" target="_blank">TorrentLocker</a> chose a very secure algorithm to encrypt the victim’s files: <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank">AES</a> in <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#CTR" target="_blank">CTR mode</a>. Nevertheless, the manner in which the algorithm was used led to a remarkable weakness in the overall scheme.</p>
<p>AES is a <a href="https://en.wikipedia.org/wiki/Block_cipher" target="_blank">block cipher</a>, which means that it is able to encrypt blocks of a fixed size (16 bytes). However, messages can have lengths other than 16 bytes. This is where <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation" target="_blank">modes of operation</a> come into play.</p>
<p>AES in CTR mode takes an initial value as a parameter, known as the Initialization Vector (IV), and uses it to stretch the key (which can have 128, 192 or 256 bits) up to the length of the plaintext (unencrypted content), becoming what is known as a <a href="https://en.wikipedia.org/wiki/Keystream" target="_blank">keystream</a>. Then the keystream is <a href="https://blog.malwarebytes.com/threat-analysis/2013/05/nowhere-to-hide-three-methods-of-xor-obfuscation/" target="_blank">XOR</a>ed with the message, mimicking the concept of a <a href="https://en.wikipedia.org/wiki/Stream_cipher" target="_blank">stream cipher</a>.</p>
<p>The attack by early TorrentLocker versions was fairly simple: on the compromised system, TorrentLocker generated a 2MB keystream and proceeded with the encryption of the first 2MB segment of each file by XORing the segment with the keystream. In cases where files were smaller than 2MB, they were completely encrypted by the method.</p>
<p>However, this usage of AES-CTR mode was exactly analogous to the reuse of IV and key in stream ciphers, <a href="http://travisdazell.blogspot.com.br/2012/11/many-time-pad-attack-crib-drag.html" target="_blank">a rookie error in cryptography</a>. Given a single encrypted file and its original unencrypted content, it is easy to recover the keystream and decrypt all the other encrypted files. Later TorrentLocker versions corrected the error by replacing the mode of operation from CTR to CBC, which will be addressed subsequently in the TeslaCrypt section.</p>
<div id="attachment_83800" style="width: 899px" class="wp-caption aligncenter"><img class="size-full wp-image-83800" src="/wp-content/uploads/2016/09/4.png" alt="Figure 4: Scheme of CTR mode of operation" width="889" height="368" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/09/4.png 889w, https://www.welivesecurity.com/wp-content/uploads/2016/09/4-300x124.png 300w, https://www.welivesecurity.com/wp-content/uploads/2016/09/4-768x318.png 768w" sizes="(max-width: 889px) 100vw, 889px" /><p class="wp-caption-text">Figure 4: Scheme of CTR mode of operation</p></div>
<h3>Petya</h3>
<p><a href="/2016/04/28/ransomware-is-everywhere-but-even-black-hats-make-mistakes/">Petya</a> took an approach different from that of other crypto-ransomware. Instead of encrypting files individually, it aimed at the file system. The target is the victim’s <a href="https://en.wikipedia.org/wiki/Master_boot_record" target="_blank">master boot record</a> (MBR)which is responsible for loading the operating system right after system boot.</p>
<p>The cipher chosen by Petya’s developers was Salsa20, which belongs to the <a href="http://www.ecrypt.eu.org/stream/" target="_blank">eSTREAM portfolio</a>. The portfolio is the outcome of a project to promote the design of new stream ciphers to replace older ones like RC4. Petya’s adoption of Salsa20 denotes the evolution of crypto-ransomware into newer and more robust encryption algorithms.</p>
<p>When Petya is executed, it starts a <a href="https://blog.malwarebytes.com/threat-analysis/2016/04/petya-ransomware/" target="_blank">two-stage attack intended to encrypt the MBR</a>. The process of encrypting the MBR is well crafted; it starts by modifying the MBR and causing a <a href="https://en.wikipedia.org/wiki/Blue_Screen_of_Death" target="_blank">BSOD</a> to get the system rebooted, then it displays a fake <a href="https://en.wikipedia.org/wiki/CHKDSK" target="_blank">CHKDSK</a> screen while it performs the MBR encryption, and finally it reboots the system once more showing a blinking screen of a skull and the ransom message.</p>
<div id="attachment_83799" style="width: 1032px" class="wp-caption aligncenter"><img class="size-full wp-image-83799" src="/wp-content/uploads/2016/09/5.png" alt="Figure 5: Petya skull screen and the ransom screen shown after pressing a key" width="1022" height="311" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/09/5.png 1022w, https://www.welivesecurity.com/wp-content/uploads/2016/09/5-300x91.png 300w, https://www.welivesecurity.com/wp-content/uploads/2016/09/5-768x234.png 768w, https://www.welivesecurity.com/wp-content/uploads/2016/09/5-522x160.png 522w" sizes="(max-width: 1022px) 100vw, 1022px" /><p class="wp-caption-text">Figure 5: Petya skull screen and the ransom screen shown after pressing a key</p></div>
<p>Despite the scary ransom experience suggested by Petya’s skull and ransom message, it is still possible to undo the damage caused, due to several <a href="http://blog.checkpoint.com/2016/04/11/decrypting-the-petya-ransomware/" target="_blank">flaws in the way Petya handles encryption</a>.</p>
<p>The most critical flaw, which enables decryption of the MBR after the attack is concluded, comes from the way Petya derives its encryption key.</p>
<p>To understand the key derivation flaw, we work backwards. We start by investigating how the recovery key, provided to victims after paying the ransom, is used in the decryption process. Then we explain how an implementation bug can be exploited so as to forego the need of knowing the entire recovery key to decrypt the MBR.</p>
<p>The charset for entering the recovery key is limited to 54 symbols and its length is fixed at 16 characters. Once the recovery key is entered in the ransom message screen, verification is performed to check whether the key entered is correct or not.</p>
<p>In the verification process, the recovery key entered is expanded to a 32-byte encoded key using a custom algorithm and is compared with a verification buffer in the sequence. If the encoded key matches the verification buffer, it is fed into the Salsa20 (strictly speaking <a href="https://github.com/leo-stone/hack-petya" target="_blank">Salsa10</a>) cipher and the encrypted sectors are recovered.</p>
<p>Although the expansion method is executed on the recovery key, which doubles its size, the method does not add any extra <a href="https://en.wikipedia.org/wiki/Entropy_(computing)" target="_blank">entropy</a> to the key because the expansion algorithm is deterministic. Thus, the security is bounded by 54<sup>16</sup> different possible keys, which is equivalent to 92-bit security level (i.e. log<sub>2</sub>(54<sup>16</sup>) = 92.07) and far beyond, for instance, the <a href="https://www.schneier.com/blog/archives/2013/09/the_nsas_crypto_1.html" target="_blank">80-bit brute force capability estimated for the NSA</a>.</p>
<p>However, on top of the bounded entropy, Petya’s developers committed an <a href="http://www.tgsoft.it/english/news_archivio_eng.asp?id=718" target="_blank">implementation error in the Salsa20 core</a>, which builds an array of 16 words containing constants, <a href="https://en.wikipedia.org/wiki/Cryptographic_nonce" target="_blank">nonces</a>, and the key from a so-called master table to be used during the encryption process.</p>
<p>Petya developers tweaked an <a href="https://github.com/alexwebr/salsa20" target="_blank">existing Salsa20 implementation</a> to support 16-bit architecture, but they missed a critical part. The <a href="https://0xec.blogspot.com.br/2016/04/reversing-petya-ransomware-with.html" target="_blank">reason for fiddling around with the Salsa20 implementation</a> can be ascribed to the target execution mode. Petya is designed to run as a <a href="http://wiki.osdev.org/Bootloader" target="_blank">bootloader</a>, which executes in 16-bit <a href="http://wiki.osdev.org/Real_Mode" target="_blank">Real Mode</a> on all <a href="https://en.wikipedia.org/wiki/X86" target="_blank">x86 processors</a>.</p>
<p>In order to build the array, two copies of the master table are created in little-endian format. Petya’s developers changed uint32_t variables to uint16_t (Figure 6) to address 16-bit architecture word size. However, they neglected to adapt the new word size while looping over the master table in Salsa20 core, so that 2 bytes are read and the offset for the next read is incremented by 4 bytes.</p>
<div id="attachment_83798" style="width: 889px" class="wp-caption aligncenter"><img class="size-full wp-image-83798" src="/wp-content/uploads/2016/09/6.png" alt="Figure 6: Petya development error in tweaking Salsa20 for 16-bit architecture" width="879" height="399" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/09/6.png 879w, https://www.welivesecurity.com/wp-content/uploads/2016/09/6-300x136.png 300w, https://www.welivesecurity.com/wp-content/uploads/2016/09/6-768x349.png 768w" sizes="(max-width: 879px) 100vw, 879px" /><p class="wp-caption-text"><a href="http://blog.checkpoint.com/2016/04/11/decrypting-the-petya-ransomware/" target="_blank">Figure 6</a>: Petya development error in tweaking Salsa20 for 16-bit architecture</p></div>
<p>For this reason, only half of the key is actually applied for key derivation in Salsa20. This reduces the security level of the overall Petya encryption from 92-bit to 46-bit security (i.e. log<sub>2</sub>(54<sup>8</sup>) = 46.04), which it is feasible to break within seconds using brute force even for standard computers.</p>
<h3>TeslaCrypt</h3>
<p>It is not by chance that <a href="http://blog.talosintel.com/2016/03/teslacrypt-301-tales-from-crypto.html" target="_blank">TeslaCrypt</a> has been one of the most successful crypto-ransomware families so far. The use of encryption is carefully handled and the choice of algorithms indicates that TeslaCrypt’s developers have some crypto-savviness.</p>
<p>TeslaCrypt uses AES-256 for file encryption; however, unlike the flawed version in TorrentLocker, it uses <a href="http://blogs.cisco.com/security/talos/teslacrypt" target="_blank">CBC as its mode of operation</a>.</p>
<p>In CBC mode, each ciphertext block (fixed-size chunk of the encrypted message) is fed as the IV into the encryption of the next block and all the blocks are encrypted using the same key. Therefore there is no keystream or any analogy with stream ciphers, which renders the procedure used against the flawed TorrentLockers inapplicable here.</p>
<div id="attachment_83797" style="width: 985px" class="wp-caption aligncenter"><img class="size-full wp-image-83797" src="/wp-content/uploads/2016/09/7.png" alt="Figure 7: Scheme of CBC mode of operation" width="975" height="374" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/09/7.png 975w, https://www.welivesecurity.com/wp-content/uploads/2016/09/7-300x115.png 300w, https://www.welivesecurity.com/wp-content/uploads/2016/09/7-768x295.png 768w" sizes="(max-width: 975px) 100vw, 975px" /><p class="wp-caption-text">Figure 7: Scheme of CBC mode of operation</p></div>
<p>The AES key is encrypted using an <a href="https://en.wikipedia.org/wiki/ElGamal_encryption" target="_blank">EC-ElGamal</a>-like algorithm and sent back to the C&amp;C. The choice of Elliptic Curve Cryptography (ECC) over RSA is very convenient for evading detection, since <a href="http://www.ijser.org/researchpaper/Performance-Based-Comparison-Study-of-RSA-and-Elliptic-Curve-Cryptography.pdf" target="_blank">ECC results in shorter ciphertexts and takes less time to execute</a>.</p>
<p>Nonetheless, the TeslaCrypt v2.2.0 (a.k.a. TeslaCrypt v8) developers committed a less trivial mistake. As reported by <a href="http://www.bleepingcomputer.com/news/security/teslacrypt-decrypted-flaw-in-teslacrypt-allows-victims-to-recover-their-files/" target="_blank">BleepingComputer</a> and analyzed by <a href="http://blog.talosintel.com/2016/03/teslacrypt-301-tales-from-crypto.html" target="_blank">Talos</a>, the recovery key (RK), intended to protect the encryption key that is used for file encryption during the attack, is generated as the multiplication of the shared secret key (C2K), established with C&amp;C, and the private key used to encrypt the files (FK).</p>
<p>RK = C2K * FK</p>
<p>The recovery key is stored on the compromised system and allows the recovery of FK when C2K is known. However, the TeslaCrypt v2.2.0 developers incorrectly assumed that they could avail themselves of the hard problem underlying RSA: <a href="https://en.wikipedia.org/wiki/RSA_problem" target="_blank">factorization</a>.</p>
<p>After decades, researchers have not been able to discover an efficient algorithm to calculate the prime factors of a given number (as large as the ones used in RSA). Yet, this does not mean that factorization could not be taken forward at all.</p>
<p>The recovery key was not long enough to make a factorization attack unfeasible. Hence, brute-force attacks turned out to be a way to find the file encryption key and finally decrypt the files to restore their original form.</p>
<h1>Can encryption be used against crypto-ransomware?</h1>
<p>It has been asked whether it is true that crypto-ransomware does not encrypt encrypted files. The answer is “yes and no”.</p>
<p>It is obviously possible to encrypt any encrypted data. As a matter of fact, this is the core idea in <a href="https://www.torproject.org/about/overview.html.en#thesolution" target="_blank">onion routing</a>. In brief, onion routing is designed for privacy and conveys data through a circuit of routing nodes. Say that the circuit is composed of three nodes, so when the user wants to access some website the request will be encrypted with node key three (exit node), encrypted again (the already encrypted content) with node key two and again using node key one (entry node). As the request goes through each node, it gets decrypted using the key of the current node, in such a way that only the exit node will have the original request, prior encryptions brought off by the onion routing process. The exit node makes the request on behalf of the user and sends the response back using a similar encryption process as was applied to the request.</p>
<p>For the sake of efficiency and precision, crypto-ransomware usually decides whether to encrypt a file depending on its filename extension; for instance, the list for TorrentLocker by 2014 is available <a href="/wp-content/uploads/2014/12/torrent_locker.pdf#page=39" target="_blank">here</a>. If the extension matches a predefined set of extensions it is encrypted, otherwise it is not.</p>
<p>On the other hand, encryption tools often append some pre-determined new extension to the filename when the file is encrypted. It is an interesting fact that we have not seen any crypto-ransomware targeting encryption tools yet.</p>
<p>As a consequence, if the system is compromised by some crypto-ransomware that does not target the encryption tool in place, files encrypted by the tool will, just by good fortune, not be encrypted by the malware. Keeping this in mind, a useful feature to add into encryption tools is <em>extension randomization</em>, which could be as simple as allowing the user-to define a scheme during installation.</p>
<p>Extension randomization does not add any performance overhead nor require great design changes in encryption tools, but it could be to some extent effective against crypto-ransomware.</p>
<p>In order to target encrypted files, crypto-ransomware developers would have to select/find the encrypted files at the time of execution or abandon the idea of extension-based selection, evolving their attacks to avoid selecting critical application/OS files for encryption that could damage the system and make the attack fail before accomplishing its aims.</p>
<p>This is why the use of legitimate file encryption tools to encrypt your files might serendipitously lessen the impact of crypto-ransomware; nevertheless crypto-ransomware mitigation should not be totally reliant on encryption tools: backup and other proactive measures are even more important.</p>
<h2>Avoid and combat crypto-ransomware</h2>
<p>We published a <a href="/2013/12/12/11-things-you-can-do-to-protect-against-ransomware-including-cryptolocker/">post</a> providing many good tips that can help you avoid crypto-ransomware. Here are some of these tips:</p>
<ul>
<li>Use a reputable antimalware suite and enable proactive measures like HIPS and anti-phishing protection</li>
<li>Practice a safe behavior: show hidden file-extensions and do not <a href="/2015/05/22/5-security-questions-ask-clicking-link/" target="_blank">open links</a> and messages from unknown sources</li>
</ul>
<p>In the event, despite all the care taken, you cross paths with crypto-ransomware, you will want, in advance, to:</p>
<ul>
<li>Have a recent, validated, offline backup of your files, so schedule backups to frequently execute</li>
<li>Avoid mapping backup folders onto your computer. Crypto-ransomware may end up encrypting backups in folders on USB devices, cloud storage and any other place that is accessed as folders in the system</li>
</ul>
<p>As a last resort, you can try to decrypt your files with <a href="http://avien.net/blog/ransomware-resources/decryption-resources/" target="_blank">tools made available</a> by security researchers for some specific crypto-ransomware families. ESET includes <a href="http://support.eset.com/kb2372/" target="_blank">decryption tools for several crypto-ransomware families</a> and variants to retrieve encrypted data without having to pay the cybercriminals.</p>
<p>Additionally, a recent <a href="https://www.nomoreransom.org/about-the-project.html" target="_blank">initiative</a> by the National High Tech Crime Unit of the Netherlands’ police and Europol’s European Cybercrime Centre, in collaboration with IT security companies, also provides tools to help victims of crypto-ransomware.</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/cpuodzius/" title="Cassius Puodzius">
                    Cassius Puodzius                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2016-09-13 13:45:07">13 Sep 2016 - 01:45PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2020/10/06/us-government-warns-paying-off-ransomware-attackers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/10/wls_ransomware-treasury-warning-paying-up-fines_fb-623x432.jpg"
                                                         alt="How encryption molded crypto&#8209;ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2020/10/06/us-government-warns-paying-off-ransomware-attackers/">
                                                    US gov’t warns against paying off ransomware attackers                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2020/09/24/ray-ban-parent-company-reportedly-suffers-major-ransomware-attack/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/09/luxottica-ransomware-alleged-attack-623x426.jpg"
                                                         alt="How encryption molded crypto&#8209;ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2020/09/24/ray-ban-parent-company-reportedly-suffers-major-ransomware-attack/">
                                                    Ray-Ban parent company reportedly suffers major ransomware attack                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2020/08/07/small-medium-sized-businesses-big-targets-ransomware-attacks/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/08/SMBs-ransomware-attacks-623x427.jpg"
                                                         alt="How encryption molded crypto&#8209;ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2020/08/07/small-medium-sized-businesses-big-targets-ransomware-attacks/">
                                                    Small and medium-sized businesses: Big targets for ransomware attacks                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/ransomware-malware/" class="category-tag-btn">Ransomware</a>                                                <a href="https://www.welivesecurity.com/2020/07/21/telecom-argentina-hit-major-ransomware-attack/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/07/telecom-ataque-ransomware.jpg"
                                                         alt="How encryption molded crypto&#8209;ransomware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2020/07/21/telecom-argentina-hit-major-ransomware-attack/">
                                                    Argentine telecom company hit by major ransomware attack                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F09%2F13%2Fhow-encryption-molded-crypto-ransomware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F09%2F13%2Fhow-encryption-molded-crypto-ransomware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F09%2F13%2Fhow-encryption-molded-crypto-ransomware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"83792 \/?p=83792","disqusShortname":"welivesecurity","disqusTitle":"How encryption molded crypto\u2011ransomware","disqusUrl":"https:\/\/www.welivesecurity.com\/2016\/09\/13\/how-encryption-molded-crypto-ransomware\/","postId":"83792"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-251').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>