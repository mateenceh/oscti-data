<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Diego Perez',
        'ArticleCategory': 'cyberattack',
        'ArticleSection': '(not set)',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Everything you need to know about the latest variant of Petya | WeLiveSecurity</title>
<meta name="description" content="The latest global cyberattack, detected by ESET as Win32 / Diskcoder.C, considered a variant of Petya, once again highlights the reality outdated systems and insufficient security solutions are still widespread."/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/07/06/everything-need-know-latest-variant-petya/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Everything you need to know about the latest variant of Petya | WeLiveSecurity" />
<meta property="og:description" content="The latest global cyberattack, detected by ESET as Win32 / Diskcoder.C, considered a variant of Petya, once again highlights the reality outdated systems and insufficient security solutions are still widespread." />
<meta property="og:url" content="https://www.welivesecurity.com/2017/07/06/everything-need-know-latest-variant-petya/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="cyberattack" />
<meta property="article:published_time" content="2017-07-06T12:00:36+00:00" />
<meta property="article:modified_time" content="2017-07-10T19:34:39+00:00" />
<meta property="og:updated_time" content="2017-07-10T19:34:39+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="480" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="The latest global cyberattack, detected by ESET as Win32 / Diskcoder.C, considered a variant of Petya, once again highlights the reality outdated systems and insufficient security solutions are still widespread." />
<meta name="twitter:title" content="Everything you need to know about the latest variant of Petya | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2017/06/29/tudo-sobre-o-novo-ataque-de-ransomware/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2017/07/06/everything-need-know-latest-variant-petya/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/06/29/todo-sobre-nuevo-ataque-de-ransomware/" hreflang="es" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2017/06/29/tudo-sobre-o-novo-ataque-de-ransomware/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/06/29/todo-sobre-nuevo-ataque-de-ransomware/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2017/06/29/tudo-sobre-o-novo-ataque-de-ransomware/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/06/29/todo-sobre-nuevo-ataque-de-ransomware/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Everything you need to know about the latest variant of Petya</h1>
<div class="excerpt">The latest global cyberattack, detected by ESET as Win32 / Diskcoder.C, considered a variant of Petya, once again highlights the reality outdated systems and insufficient security solutions are still widespread.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/dperez/" title="Diego Perez">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2015/04/diego-perez-wls-222x179.jpg" alt="Diego Perez">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/dperez/" title="Diego Perez">
                    Diego Perez                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-07-06 14:00:36">6 Jul 2017 - 02:00PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F07%2F06%2Feverything-need-know-latest-variant-petya%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F07%2F06%2Feverything-need-know-latest-variant-petya%2F&text=Everything you need to know about the latest variant of Petya%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F07%2F06%2Feverything-need-know-latest-variant-petya%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>The latest global cyberattack, detected by ESET as Win32 / Diskcoder.C, considered a variant of Petya, once again highlights the reality outdated systems and insufficient security solutions are still widespread.</p>
                            </div>

                            <p><em>Update (July 9th): This article has been amended to include more information on the unique characteristics of Win32/Diskcoder.C.</em></p>
<p><span style="font-weight: 400;">The latest </span><a href="https://www.welivesecurity.com/2017/06/27/new-ransomware-attack-hits-ukraine/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">global cyberattack</span></a><span style="font-weight: 400;">, d</span><span style="font-weight: 400;">etected by ESET as </span><em><a href="http://support.eset.com/alert6488/?viewlocale=en_US" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">Win32/Diskcoder.C</span></a><span style="font-weight: 400;">,</span></em> <a href="https://www.welivesecurity.com/2016/05/24/critical-infrastructure-time-make-security-priority/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">once again</span></a><span style="font-weight: 400;"> highlights the reality that outdated systems and insufficient security solutions are still widespread.</span></p>
<p><span style="font-weight: 400;">The damage caused by this attack has raised a number of questions, which we’ll answer for you here.</span></p>
<h2><b>What are the characteristics of this threat?</b></h2>
<ul>
<li style="font-weight: 400;"><span style="font-weight: 400;">Encryption: It only encrypts files with a specific extension, but also attempts (usually successfully) to encrypt the MBR (</span><i><span style="font-weight: 400;">Master Boot Record</span></i><span style="font-weight: 400;">), which is the main boot record.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Propagation: Like a </span><a href="http://www.virusradar.com/en/glossary/worm"><span style="font-weight: 400;">worm</span></a><span style="font-weight: 400;">, it can spread through the network, infecting new equipment.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Exploits: It exploits vulnerabilities in both computers that have not been updated and/or in patches that have been installed. This is something that has been discussed a lot since the appearance of </span><a href="https://www.welivesecurity.com/2017/05/15/wannacryptor-key-questions-answered/"><span style="font-weight: 400;">WannaCryptor</span></a><i><span style="font-weight: 400;">.</span></i></li>
</ul>
<h2><b>Is it as powerful as WannaCryptor?</b></h2>
<p><span style="font-weight: 400;">Both have the same impact. They prevent access to information stored in a system. However,  Diskcoder.C not only encrypts the information that is on vulnerable computers, but, after the system is restarted, it leaves the operating system unusable, so victims are forced to perform a reinstallation.</span></p>
<h2><b>Does it propagate in the same way as WannaCryptor?</b></h2>
<p><span style="font-weight: 400;">Yes and no. Both use the NSA exploit called </span><a href="http://www.wired.co.uk/article/what-is-eternal-blue-exploit-vulnerability-patch" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">EternalBlue</span></a><span style="font-weight: 400;">. However, </span><i><span style="font-weight: 400;">Win32/Diskcoder.C</span></i><span style="font-weight: 400;"> implements other propagation techniques by abusing legitimate Microsoft Windows tools, such as PsExec, which is part of the <a href="https://technet.microsoft.com/en-us/sysinternals/">Sysinternals suite</a> of tools, and Windows Management Instrumentation Command-line (WMIC</span><i><span style="font-weight: 400;">), a</span></i><span style="font-weight: 400;"> source for managing data and functionality on local and remote computers running Windows operating systems.</span></p>
<h2><b>What similarities does it have with Mischa and Petya?</b></h2>
<p><span style="font-weight: 400;">The main reason they are often grouped together is that these three malicious families make the operating system unusable by encrypting the MBR, as well as the data that is in the operating system.Other than this, they do not have much else in common, given that they implement different processes and use different techniques.</span></p>
<p><img class="aligncenter size-full wp-image-96270" src="/wp-content/uploads/2017/06/mischa-y-petya.png" alt="" width="1074" height="796" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/mischa-y-petya.png 1074w, https://www.welivesecurity.com/wp-content/uploads/2017/06/mischa-y-petya-300x222.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/06/mischa-y-petya-768x569.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/06/mischa-y-petya-1024x759.png 1024w" sizes="(max-width: 1074px) 100vw, 1074px" /></p>
<h2><b>What exactly does this threat do?</b></h2>
<p><span style="font-weight: 400;">After the malicious software is run, it creates a scheduled task to restart the computer within a certain timeframe, which is usually no more than 60 minutes.</span></p>
<p><img class="aligncenter wp-image-96274" src="/wp-content/uploads/2017/06/diskcoder.png" alt="" width="778" height="450" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder.png 1162w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-300x173.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-768x444.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-1024x592.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-257x149.png 257w" sizes="(max-width: 778px) 100vw, 778px" /></p>
<p><span style="font-weight: 400;">In addition, it verifies whether or not there are shared folders or disks to which the malware can propagate. If there are, it uses WMIC to run the malicious software on the remote machine.</span></p>
<p><img class="aligncenter wp-image-96275" src="/wp-content/uploads/2017/06/diskcoder-procesos.png" alt="" width="608" height="452" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-procesos.png 757w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-procesos-300x223.png 300w" sizes="(max-width: 608px) 100vw, 608px" /></p>
<p><span style="font-weight: 400;">It then starts encrypting files that contain certain extensions. We should highlight that, unlike most ransomware, <em>Win32/Diskcoder.C</em> does not change or add a particular extension after encrypting each file, which is a technique widely used by attackers to distinguish infected files.</span></p>
<p><span style="font-weight: 400;">In the following screenshot you can see the file extensions that the malware will attempt to encrypt:</span></p>
<p><img class="aligncenter size-full wp-image-96276" src="/wp-content/uploads/2017/06/diskcoder-extensiones-cifrar.png" alt="" width="857" height="147" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-extensiones-cifrar.png 857w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-extensiones-cifrar-300x51.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-extensiones-cifrar-768x132.png 768w" sizes="(max-width: 857px) 100vw, 857px" /></p>
<p><span style="font-weight: 400;">In addition, the malware will try to delete event logs to leave no trace, as well as hide their actions. The next screenshot shows the command that is executed using  aforementioned technique:</span></p>
<p><img class="aligncenter wp-image-96277" src="/wp-content/uploads/2017/06/diskcoder-comando.png" alt="" width="597" height="467" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-comando.png 781w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-comando-300x235.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-comando-768x601.png 768w" sizes="(max-width: 597px) 100vw, 597px" /></p>
<h2><b>How does it spread from one country to another? </b></h2>
<p><span style="font-weight: 400;">As previously mentioned, propagation is a prominent characteristic of this threat. Once it manages to infect a computer, it attempts to extract the user&#8217;s credentials and then use them with PsExec and WMIC to search for shared folders and disks. It then spreads via the computer network. In this way, it manages to infect computers located in different countries and regions.</span></p>
<p><span style="font-weight: 400;">In most cases, it was detected within teams of multinational companies that were connected to the same network with those of other subsidiaries in Europe or Asia. It then spread in the same manner as a worm. </span></p>
<h2><b>What can I do to stay protected from this threat?</b></h2>
<p><span style="font-weight: 400;">We recommend reading the related article in our </span><a href="https://support.eset.com/alert6488/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">Knowledge Base</span></a><span style="font-weight: 400;"> and taking into account the following tips:</span></p>
<p><strong>Antivirus solution</strong></p>
<p><span style="font-weight: 400;">Install an antivirus solution on your home and work computers and ensure your system is regularly updated.</span></p>
<p><span style="font-weight: 400;">It has to be properly configured in order to identify which ports are open and why &#8211; especially ports 135, 139, 445 and 1025-1035 TCP, which use WMI and PsExec. </span></p>
<p><strong>Block EXE files</strong></p>
<p><span style="font-weight: 400;">You should also block the execution of EXE files within </span><i><span style="font-weight: 400;">% AppData%</span></i><span style="font-weight: 400;"> and </span>%Temp%;<i></i><span style="font-weight: 400;"> Disable the default ADMIN$ accounts and/or communicate with Admin$ shares. And, if possible, disable SMB version 1. </span></p>
<p><strong>Monitor your network</strong></p>
<p><span style="font-weight: 400;">Ensure your network is well-configured and segmented, and constantly monitor traffic for any abnormal behavior. </span></p>
<p><strong>Back up your data</strong></p>
<p><span style="font-weight: 400;">Identify crucial data and information on your computer and make a </span><a href="https://www.welivesecurity.com/2017/03/31/backup-digital-life/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">backup</span></a><span style="font-weight: 400;"> of it—and keep the backup offline. This way, if your computer is attacked successfully by ransomware, there will be a way to restore it to a recent state.</span></p>
<p><b>Password management</b></p>
<p><span style="font-weight: 400;">It is essential to manage </span><a href="https://www.welivesecurity.com/2016/10/06/handle-multiple-devices-passwords/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">passwords </span></a><span style="font-weight: 400;">carefully. If the same password is used across different management centers, even if only one of the infected machines possesses the credentials of administrator, this could infect the whole network.</span></p>
<p><span style="font-weight: 400;">To avoid this, it’s best to ensure that passwords should not be replicated across different teams and management centers.</span></p>
<p class="p1"><span class="s1">It is also important to use <a href="https://www.welivesecurity.com/2017/07/03/two-factor-authentication-underutilized-security-measure-businesses/" target="_blank" rel="noopener noreferrer"><span class="s2">two-factor authentication</span></a>, since it adds an additional layer of protection to the credentials normally used for validating users. In case of infection, this would prevent lateral movement across your network should the malware try to gain remote Admin access to those other computers.</span></p>
<h2><b>What do I do if I got infected and can’t access the system?</b></h2>
<p><span style="font-weight: 400;">It’s possible to use forensic techniques to try to run another operating system in memory and thus access the encrypted files. However, there is not much that can be done other than to apply the backup, which would be crucial to avoid reinstalling the operating system.</span></p>
<p><span style="font-weight: 400;">Ultimately, if there is no backup, it may be tempting to pay the cybercriminals their demanded ransom but ESET would not recommend this </span><a href="https://www.welivesecurity.com/2016/08/22/ransomware-pay-not-pay-2/"><span style="font-weight: 400;">for several reasons</span></a><span style="font-weight: 400;">.</span></p>
<p class="p1"><span class="s1">Ransom payment is particularly useless in this case. Recent <a href="https://www.welivesecurity.com/2017/07/04/analysis-of-telebots-cunning-backdoor/" target="_blank" rel="noopener noreferrer"><span class="s2">research from ESET on TeleBots</span></a>, the group that may have been behind this attack attack, suggests that <em>Win32/Diskcoder.C</em> is not typical ransomware.</span></p>
<p class="p1"><span class="s1">Although it encrypts the files and demands a ransom equivalent to 300 dollars, the attackers actually wanted – as their primary goal – to cause damage. Accordingly, they did all that they could to make data decryption very unlikely.</span></p>
<p class="p1"><span class="s1">Moreover, the malware has the ability to <a href="https://www.welivesecurity.com/2017/06/30/telebots-back-supply-chain-attacks-against-ukraine/" target="_blank" rel="noopener noreferrer"><span class="s2">replace the Master Boot Record (MBR)</span></a> with its own malicious code. However, this was implemented in such a way that recovery is not possible. The attackers cannot provide a decryption key and the decryption key cannot be typed in the ransom screen because the generated key contains non-acceptable characters.</span></p>
<h2><b>How are the attackers operating and do they expect to receive a payment? </b></h2>
<p><span style="font-weight: 400;">Once the encryption is completed, Win32/Diskcoder.C issues a set of instructions via which the attackers request a payment in bitcoins. The example below displays a ransom that is equivalent to 300 dollars.</span></p>
<p><img class="aligncenter size-full wp-image-96278" src="/wp-content/uploads/2017/06/diskcoder-rescate.png" alt="" width="767" height="451" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-rescate.png 767w, https://www.welivesecurity.com/wp-content/uploads/2017/06/diskcoder-rescate-300x176.png 300w" sizes="(max-width: 767px) 100vw, 767px" /></p>
<h2><b>Why has data hijacking become so common?</b></h2>
<p><span style="font-weight: 400;"> Lack of awareness, insufficient </span><span style="font-weight: 400;">training at companies and the</span> <a href="https://www.welivesecurity.com/2017/01/26/desperately-seeking-cybersecurity-skills/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">skills shortage</span></a> <span style="font-weight: 400;">a</span><span style="font-weight: 400;">r</span><span style="font-weight: 400;">e</span> <span style="font-weight: 400;">j</span><span style="font-weight: 400;">u</span><span style="font-weight: 400;">s</span><span style="font-weight: 400;">t</span> <span style="font-weight: 400;">s</span><span style="font-weight: 400;">o</span><span style="font-weight: 400;">m</span><span style="font-weight: 400;">e</span> <span style="font-weight: 400;">o</span><span style="font-weight: 400;">f</span> <span style="font-weight: 400;">t</span><span style="font-weight: 400;">h</span><span style="font-weight: 400;">e</span> <span style="font-weight: 400;">r</span><span style="font-weight: 400;">e</span><span style="font-weight: 400;">a</span><span style="font-weight: 400;">s</span><span style="font-weight: 400;">o</span><span style="font-weight: 400;">n</span><span style="font-weight: 400;">s</span> <span style="font-weight: 400;">h</span><span style="font-weight: 400;">i</span><span style="font-weight: 400;">j</span><span style="font-weight: 400;">a</span><span style="font-weight: 400;">c</span><span style="font-weight: 400;">k</span><span style="font-weight: 400;">i</span><span style="font-weight: 400;">n</span><span style="font-weight: 400;">g</span> <span style="font-weight: 400;">h</span><span style="font-weight: 400;">a</span><span style="font-weight: 400;">s</span> <span style="font-weight: 400;">b</span><span style="font-weight: 400;">e</span><span style="font-weight: 400;">c</span><span style="font-weight: 400;">o</span><span style="font-weight: 400;">m</span><span style="font-weight: 400;">e</span> <span style="font-weight: 400;">s</span><span style="font-weight: 400;">o</span> <span style="font-weight: 400;">c</span><span style="font-weight: 400;">o</span><span style="font-weight: 400;">m</span><span style="font-weight: 400;">m</span><span style="font-weight: 400;">o</span><span style="font-weight: 400;">n</span><span style="font-weight: 400;">. </span><a href="https://www.welivesecurity.com/2017/06/14/low-cyber-iq-corporate-confidence/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">Unfortunately, many employees are still unaware</span></a> <span style="font-weight: 400;">o</span><span style="font-weight: 400;">f</span> <span style="font-weight: 400;">t</span><span style="font-weight: 400;">h</span><span style="font-weight: 400;">e</span> <span style="font-weight: 400;">p</span><span style="font-weight: 400;">o</span><span style="font-weight: 400;">t</span><span style="font-weight: 400;">e</span><span style="font-weight: 400;">n</span><span style="font-weight: 400;">t</span><span style="font-weight: 400;">i</span><span style="font-weight: 400;">a</span><span style="font-weight: 400;">l impact a cyberattack can have on a business model until </span><span style="font-weight: 400;">they the</span><span style="font-weight: 400;">mselves become victims and are facing a ransomware demand.</span></p>
<p><span style="font-weight: 400;">Based on the low defense levels they encounter, cybercriminals are both motivated and able to continue exploiting weaknesses, developing new ransomware and successfully carry out damaging attacks.</span></p>
<h2><b>Was the attack carried out single-handedly? </b></h2>
<p><span style="font-weight: 400;">It is hard to believe that one person alone could be behind this attack, given the highly technical nature of <em>Win32/Diskcoder.C</em> in terms of exploits, propagation and encryption, as well as the way in which it evaded security measures.</span></p>
<p><span style="font-weight: 400;">However, at this stage, we can’t rule out the possibility that a group was behind the attack &#8211; let alone predict its size.</span></p>
<h2><b>Is it possible to locate the perpetrators of the attack?</b></h2>
<p><span style="font-weight: 400;">Not for now. Unlike a </span><a href="https://www.welivesecurity.com/2014/10/22/botnet-malware-fight/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">botnet</span></a><span style="font-weight: 400;">, for example, there is no C&amp;C connected to the threat in order to trace it and find the perpetrators. And If there were, the likelihood is that it would be a foreign server that was attacked to take control and access from </span><a href="https://www.welivesecurity.com/2013/07/24/the-rise-of-tor-based-botnets/" target="_blank" rel="noopener noreferrer"><span style="font-weight: 400;">TOR</span></a><span style="font-weight: 400;">, hence achieving anonymity.</span></p>
<p><span style="font-weight: 400;">In addition, the currency for the ransom payment is in bitcoins and, due to the characteristics of this cryptocurrency, it becomes practically impossible to trace its final destination.</span></p>
<p><i><span style="font-weight: 400;">Credits image: </span></i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;hl=en&amp;ie=UTF8&amp;prev=_t&amp;rurl=translate.google.de&amp;sl=es&amp;sp=nmt4&amp;tl=en&amp;u=https://www.flickr.com/photos/143601516%40N03/29972713206/in/photostream/lightbox/&amp;usg=ALkJrhiEOC4qC9KwQb5UJMwGsgbCI78qGg" target="_blank" rel="noopener noreferrer"><i><span style="font-weight: 400;">© Blogtrepreneur/Flickr</span></i></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/dperez/" title="Diego Perez">
                    Diego Perez                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-07-06 14:00:36">6 Jul 2017 - 02:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/social-media-2/" class="category-tag-btn">Social Media</a>                                                <a href="https://www.welivesecurity.com/2021/03/19/7-steps-staying-safe-secure-twitter/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/twitter-anniversary-privacy-protection-tips-623x432.jpg"
                                                         alt="Everything you need to know about the latest variant of Petya">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/19/7-steps-staying-safe-secure-twitter/">
                                                    7 steps to staying safe and secure on Twitter                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/privacy/" class="category-tag-btn">Privacy</a>                                                <a href="https://www.welivesecurity.com/2021/03/19/trust-your-surveillance-why-hacked-cameras-are-very-bad/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/surveillance-cameras-hacked-breach-privacy-623x432.jpg"
                                                         alt="Everything you need to know about the latest variant of Petya">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/19/trust-your-surveillance-why-hacked-cameras-are-very-bad/">
                                                    Trust your surveillance? Why hacked cameras are very bad                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Everything you need to know about the latest variant of Petya">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/mobile-security/" class="category-tag-btn">Mobile Security</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/beware-android-trojan-posing-clubhouse-app/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/clubhouse-trojan-app-android-623x432.jpg"
                                                         alt="Everything you need to know about the latest variant of Petya">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/beware-android-trojan-posing-clubhouse-app/">
                                                    Beware Android trojan posing as Clubhouse app                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F07%2F06%2Feverything-need-know-latest-variant-petya%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F07%2F06%2Feverything-need-know-latest-variant-petya%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F07%2F06%2Feverything-need-know-latest-variant-petya%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"96620 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=96620","disqusShortname":"welivesecurity","disqusTitle":"Everything you need to know about the latest variant of Petya","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/07\/06\/everything-need-know-latest-variant-petya\/","postId":"96620"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>