<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Cassius Puodzius',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>DownAndExec: Banking malware utilizes CDNs in Brazil | WeLiveSecurity</title>
<meta name="description" content="Services like Netflix use content delivery networks (CDNs) to maximize bandwidth usage. However, the CDNs might be finding a new way of spreading malware."/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/09/13/downandexec-banking-malware-cdns-brazil/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:type" content="article" />
<meta property="og:title" content="DownAndExec: Banking malware utilizes CDNs in Brazil | WeLiveSecurity" />
<meta property="og:description" content="Services like Netflix use content delivery networks (CDNs) to maximize bandwidth usage. However, the CDNs might be finding a new way of spreading malware." />
<meta property="og:url" content="https://www.welivesecurity.com/2017/09/13/downandexec-banking-malware-cdns-brazil/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2017-09-13T13:43:57+00:00" />
<meta property="article:modified_time" content="2017-09-15T17:41:15+00:00" />
<meta property="og:updated_time" content="2017-09-15T17:41:15+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/09/ransomware-2318381_1920-623x432.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/09/ransomware-2318381_1920-623x432.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="432" />
<meta property="og:image:alt" content="CDNs are starting to become a new way to spread malware" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Services like Netflix use content delivery networks (CDNs) to maximize bandwidth usage. However, the CDNs might be finding a new way of spreading malware." />
<meta name="twitter:title" content="DownAndExec: Banking malware utilizes CDNs in Brazil | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/09/ransomware-2318381_1920-623x432.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2017/07/06/downandexec-malwares-bancarios/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2017/09/13/downandexec-banking-malware-cdns-brazil/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/09/08/downandexec-malware-bancario-aprovecha-cdn/" hreflang="es" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2017/07/06/downandexec-malwares-bancarios/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/09/08/downandexec-malware-bancario-aprovecha-cdn/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2017/07/06/downandexec-malwares-bancarios/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/09/08/downandexec-malware-bancario-aprovecha-cdn/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>DownAndExec: Banking malware utilizes CDNs in Brazil</h1>
<div class="excerpt">Services like Netflix use content delivery networks (CDNs) to maximize bandwidth usage. However, the CDNs might be becoming a new way of spreading malware.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/cpuodzius/" title="Cassius Puodzius">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2016/05/cassius-puodzius-wls-e1466535453215.jpg" alt="Cassius Puodzius">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/cpuodzius/" title="Cassius Puodzius">
                    Cassius Puodzius                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-09-13 15:43:57">13 Sep 2017 - 03:43PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F13%2Fdownandexec-banking-malware-cdns-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F13%2Fdownandexec-banking-malware-cdns-brazil%2F&text=DownAndExec: Banking malware utilizes CDNs in Brazil%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F13%2Fdownandexec-banking-malware-cdns-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Services like Netflix use content delivery networks (CDNs) to maximize bandwidth usage. However, the CDNs might be becoming a new way of spreading malware.</p>
                            </div>

                            <p>Services like Netflix use content delivery networks (CDNs) to maximize bandwidth usage as it gives users greater speed when viewing the content, as the server is close to them and is part of the Netflix CDN. This results in faster loading times for series and movies, wherever you are in the world. But, apparently, the CDNs are starting to become a new way of spreading malware.</p>
<div id="attachment_96671" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_1.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96671" src="/wp-content/uploads/2017/07/NSIS_1.jpg" alt="" width="640" height="324" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_1.jpg 893w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_1-300x152.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_1-768x389.jpg 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure 1: NSIS/TrojanDropper.Agent.CL detection telemetry in June 2016.</p></div>
<p>The attack chain is very extensive, and incorporates the execution of remote scripts (similar in some respects to the recent “fileless” banking malware trend), plus the use of CDNs for command and control (C&amp;C), and other standard techniques for the execution and protection of malware.</p>
<p>The purpose of this article is to offer an analysis of the <em>downAndExec</em> standard that is making extensive use of JS scripts to download and execute — in this particular instance, banking malware on victims’ computers.</p>
<h2>Phase 1: Initial infection</h2>
<p>The attack chain begins with the sending of files detected by ESET as <em>NSIS/TrojanDropper.Agent.CL</em>. Through queries available on VirusTotal for filenames associated with analyzed samples, we can see the aim is to then convince victims to execute the malware by deploying Social Engineering techniques.</p>

<table id="tablepress-372" class="tablepress tablepress-id-372">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Hash (SHA1)</th><th class="column-2">File Names (VirusTotal)</th><th class="column-3">Timestamp (VirusTotal)</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><a href="https://www.virustotal.com/pt/file/ce300e38c0adbba46b1d46066cc3be3e5ce990c6406cb3e1713936acd124d174/analysis/" target="_blank">37648e4b95636e3ee5a6<br />
8e3fa8c0735125126c17</a></td><td class="column-2">AppAdobeFPlayer_1497851813.exe</td><td class="column-3">2017-06-19</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><a href="https://virustotal.com/en/file/6b08e5d92c7067eae 8e222f2d13ba2a59fe<br />
36421eb2ece5054b5d97c593a38e2/analysis/" target="_blank">38b7611bb20985512f86<br />
dc2c38247593e58a1df6</a></td><td class="column-2">Consulta_Resultado05062017.exe</td><td class="column-3">2017-06-09</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><a href="https://virustotal.com/en/file/d7b430e18426fad00576add9e88c6b0c78e<br />
b194376dfa416ab805f5757188990/analysis/" target="_blank">67458b503047852dd60<br />
3080946842472e575b856</a></td><td class="column-2">NotaFiscal.exe</td><td class="column-3">2017-06-19</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><a href="http://8ea2c548bcb974a380fece046a7e3f0218632ff2" target="_blank">8ea2c548bcb974a380<br />
fece046a7e3f0218632ff2</a></td><td class="column-2">não confirmado 923337.crdownload</td><td class="column-3">2017-06-09</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><a href="https://www.virustotal.com/pt/file/45211c815cac28a399e3ad01d742b5811dae54d93918e969c685d4e8356d7c28/analysis/" target="_blank">bffaabcce3f4cced896f7<br />
45a7ec4eba2070286b3</a></td><td class="column-2">5ae9e0f3867ae8a317031fc9a5ed886e.virus</td><td class="column-3">2017-07-04</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><a href="https://www.virustotal.com/pt/file/91301d3daab1a87dfc8b4e39f8a120ea552<br />
3e04ac86fee970cecc6760e05c8fe/analysis/" target="_blank">effb36259accdfff07c036<br />
c5a41b357692577265</a></td><td class="column-2">Consulta_Resultado05062017.exe</td><td class="column-3">2017-06-12</td>
</tr>
</tbody>
</table>

<p>One of the characteristics of NSIS is the fact that, since the release of <a href="http://nsis.sourceforge.net/Can_I_decompile_an_existing_installer" target="_blank" rel="noopener">version 9.43 (June/2014)</a>, it is possible to extract the script embedded in the executable file, which has all the functionalities of this initial trojan.</p>
<p>When loaded, the script makes extensive use of recursive calls to make it difficult to monitor the execution path.</p>
<p>With very few modifications made to the original script, and making use of resources such as <a href="https://en.wikipedia.org/wiki/ActiveX" target="_blank" rel="noopener">ActiveX</a>(only available for Internet Explorer), it is possible to debug the script using Google Chrome’s <a href="https://developer.chrome.com/devtools" target="_blank" rel="noopener">DevTools</a>.</p>
<h2></h2>
<div id="attachment_96670" style="width: 573px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_2.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96670" src="/wp-content/uploads/2017/07/NSIS_2.jpg" alt="" width="563" height="227" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_2.jpg 563w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_2-300x121.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_2-340x137.jpg 340w" sizes="(max-width: 563px) 100vw, 563px" /></a><p class="wp-caption-text">Figure 2: Recursive call c() and script patch for debugging through DevTools.</p></div>
<p>The script is characteristic of the malware classified as <em>downloader</em> malware, with the objective of downloading and then executing other types of malware on the victim’s computer. In this instance, the script performs the download of a single snippet of externally-hosted JS, which is necessary to supplement the execution process.</p>
<p>The infrastructure of a CDN provider is used intensively to host the aforementioned JS snippet. Due to the impracticability of blocking the entire CDN domain, the response to such a threat poses the following challenges:</p>
<ul>
<li>Blocking new C&amp;C malware: this is perhaps the reason why we saw (and can still see) new URLS frequently emerging on the same domain that hosts the C&amp;Cs.</li>
<li>Search for IoCs: in affected environments there are (potentially) a large number of access records made by non-malicious software.</li>
</ul>
<div id="attachment_96669" style="width: 648px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_3.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96669" src="/wp-content/uploads/2017/07/NSIS_3.jpg" alt="" width="638" height="130" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_3.jpg 893w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_3-300x61.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_3-768x157.jpg 768w" sizes="(max-width: 638px) 100vw, 638px" /></a><p class="wp-caption-text">Figure 3: CDN simulation hosting the malicious JS snippet.</p></div>
<p>To simulate the CDN hosting the malicious JS snippet and facilitate the debugging process, you can serve this content locally using a local HTTP service (only observing in order to enable resource sharing and thus execute the script at <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" target="_blank" rel="noopener">other origins</a>).</p>
<div id="attachment_96668" style="width: 651px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_4.jpg"><img class="wp-image-96668" src="/wp-content/uploads/2017/07/NSIS_4.jpg" alt="" width="641" height="125" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_4.jpg 898w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_4-300x58.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_4-768x150.jpg 768w" sizes="(max-width: 641px) 100vw, 641px" /></a><p class="wp-caption-text">Figure 4: Loading the externally-hosted JS snippet.</p></div>
<p>Note in Figure 4 how the script makes a request to the external domain (CDN) in order to obtain the contents of the snippet and, if the response status is “OK” (i.e. HTTP 200), the content is returned.</p>
<h2>Phase 2: Second download phase</h2>
<p>After the call f(), which returns the contents of the JS snippet (i.e. the script string), the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" target="_blank" rel="noopener">eval</a> function is then called, adding the<em> “downAndExec(\”&lt;parameter_1&gt;\”, \”&lt;parameter_2&gt;\”)”</em> string to the end of the JS snippet.</p>
<div id="attachment_96667" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_5.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96667" src="/wp-content/uploads/2017/07/NSIS_5.jpg" alt="" width="640" height="50" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_5.jpg 896w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_5-300x23.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_5-768x60.jpg 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure 5: <em>downAndExec</em> call with C&amp;C contention and x-id inserted into the JS snippet.</p></div>
<p>The first parameter (&lt;parameter_1&gt;) corresponds to the URL where the C&amp;C is hosted, and the second parameter (&lt;parameter_2&gt;) contains the “<em>x-id</em>” data that, as mentioned above, is necessary to download other payloads.</p>
<div id="attachment_96659" style="width: 538px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_6.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96659" src="/wp-content/uploads/2017/07/NSIS_6.jpg" alt="" width="528" height="428" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_6.jpg 528w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_6-300x243.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_6-222x179.jpg 222w" sizes="(max-width: 528px) 100vw, 528px" /></a><p class="wp-caption-text">Figure 6: Relationship of the files involved in <em>downAndExec</em>.</p></div>
<p>The JS snippet has several strings that are assigned to the code at the time of execution. This makes it difficult to understand the script when a static analysis is performed (even though the names of the functions have not been modified or obfuscated).</p>
<div id="attachment_96666" style="width: 584px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_7.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96666 size-full" src="/wp-content/uploads/2017/07/NSIS_7.jpg" alt="" width="574" height="130" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_7.jpg 574w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_7-300x68.jpg 300w" sizes="(max-width: 574px) 100vw, 574px" /></a><p class="wp-caption-text">Figure 7: Obfuscation used in the JS snippet.</p></div>
<p>The main section of this script refers specifically to the <em>downAndExec()</em> function, which is added by the first NSIS downloader. This means that if the JS snippet is analyzed separately, possibly using a sandbox solution, the malicious functions of the code will not be executed, and the final analysis will conclude that the snippet is not malicious.</p>
<div id="attachment_96665" style="width: 649px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_8.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96665" src="/wp-content/uploads/2017/07/NSIS_8.jpg" alt="" width="639" height="228" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_8.jpg 729w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_8-300x107.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_8-420x149.jpg 420w" sizes="(max-width: 639px) 100vw, 639px" /></a><p class="wp-caption-text">Figure 8: Definition of <em>downAndExec</em>() in the JS snippet.</p></div>
<p>In addition to protection against sandboxing, the script also performs a number of checks before executing the malicious section of code in order to identify computers that are of potential interest to cybercriminals.</p>
<p>The first check is <em>isOS()</em>, which simply returns a <strong>true</strong> statement, but which could also be a stub for a future version of this malware. The second check is <em>haveAnyPrograms()</em>, which checks to see if there are any files of interest installed on the victim’s computer.</p>
<div id="attachment_96664" style="width: 651px" class="wp-caption alignnone"><a href="/wp-content/uploads/2017/07/NSIS_9.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96664" src="/wp-content/uploads/2017/07/NSIS_9.jpg" alt="" width="641" height="321" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_9.jpg 898w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_9-300x150.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_9-768x385.jpg 768w" sizes="(max-width: 641px) 100vw, 641px" /></a><p class="wp-caption-text">Figure 9: Structure of the <em>haveAnyPrograms</em>() function that searches for banking software on the system.</p></div>
<p>The <em>getPathfromGuid()</em> and <em>getPathFromGuidWow()</em> functions perform searches for files by the existence of <a href="https://msdn.microsoft.com/en-us/library/aa908849.aspx" target="_blank" rel="noopener">CLSID keys</a> in the HKCR. The files searched for by CLSID are:</p>

<table id="tablepress-371" class="tablepress tablepress-id-371">
<thead>
<tr class="row-1 odd">
	<th class="column-1">GUID</th><th class="column-2">Filename</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><a href="http://www.systemlookup.com/SEH/337-ARQUIVOS_DE_PROGRAMAS_GBPLUGIN_gbieh_dll.html" target="_blank">{E37CB5F0-51F5-4395-A808-5FA49E399F83}</a></td><td class="column-2">%ProgramFiles%\GBPLUGIN\gbieh.dll</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><a href="http://www.systemlookup.com/SEH/1393-CommonAppData_GbPlugin_gbiehCef_dll.html" target="_blank">{E37CB5F0-51F5-4395-A808-5FA49E399003}</a><br />
<br />
</td><td class="column-2">%CommonAppData%\GbPlugin\gbiehCef.dll</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><a href="http://www.systemlookup.com/SEH/1723-ProgramFiles_GbPlugin_gbiehuni_dll.html" target="_blank">{E37CB5F0-51F5-4395-A808-5FA49E399008}</a><br />
<br />
</td><td class="column-2">%ProgramFiles%\GbPlugin\gbiehuni.dll</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><a href="http://www.systemlookup.com/SEH/338-ARQUIVOS_DE_PROGRAMAS_GbPlugin_gbiehabn_dll.html" target="_blank">{E37CB5F0-51F5-4395-A808-5FA49E399007}</a><br />
<br />
</td><td class="column-2">%ProgramFiles%\GbPlugin\gbiehabn.dll</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">{E37CB5F0-51F5-4395-A808-5FA49E399011}</td><td class="column-2">-</td>
</tr>
</tbody>
</table>

<p>In the event that none of these files are found, the script then searches for folders associated with banking programs such as those used by Bradesco, Itaú, Sicoob and Santander.</p>
<p>The search for these files is intended to prevent activation of malicious functions on computers that are probably not used for online banking purposes. This means that the number of detections is reduced (and beyond the range of many analysts), while effectiveness remains very high.</p>
<p>If any of these files are found via <em>haveAnyPrograms()</em>, a third check is undertaken in order to <strong>verify that the connection is from Brazil</strong>. Since the accounts of victims of potential interest are in Brazil, and in order to avoid analyses (mainly automatic) carried out by non-Brazilian countries, the following snippet verifies that the customer IP is from a Brazilian <a href="https://en.wikipedia.org/wiki/Autonomous_system_(Internet)" target="_blank" rel="noopener">AS</a> (autonomous system).</p>
<p>&nbsp;</p>
<div id="attachment_96663" style="width: 434px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_10.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96663 size-full" src="/wp-content/uploads/2017/07/NSIS_10.jpg" alt="" width="424" height="386" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_10.jpg 424w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_10-300x273.jpg 300w" sizes="(max-width: 424px) 100vw, 424px" /></a><p class="wp-caption-text">Figure 10: Function to verify that the customer IP address is in Brazil.</p></div>
<p>This check is carried out through the <a href="http://ip-api.com/json" target="_blank" rel="noopener">API</a> on ip-api.com, which returns data on the public IP supplied by the Internet Service Provider when the customer connects to the Internet. If the <em>countryCode</em> is verified as “BR”, the snippet successfully passes the third condition (<em>i.e. isBR()</em>) and then executes the malicious section of code.</p>
<h2>Phase 3: Communication with C&amp;C and execution of the payload.</h2>
<p>If the victim&#8217;s computer meets all of the conditions, the execution proceeds to the section that initiates communication with the C&amp;C, with the (final) compromise of the machine being the result.</p>
<div id="attachment_96662" style="width: 600px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_11.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96662 size-full" src="/wp-content/uploads/2017/07/NSIS_11.jpg" alt="" width="590" height="349" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_11.jpg 590w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_11-300x177.jpg 300w" sizes="(max-width: 590px) 100vw, 590px" /></a><p class="wp-caption-text">Figure 11: Main execution section of the JS snippet.</p></div>
<p>The <em>dlToText_s()</em> function being called on line 497 receives two parameters: the C&amp;C URL (parsed in <em>downAndExec as &lt;parameter_1&gt;</em>), concatenated with “<em>/?t</em>”, and a string (parsed in downAndExec as <em>&lt;parameter_2&gt;</em>).</p>
<p>The first parameter of <em>dlToText_s()</em> (i.e. <em>“&lt;parameter_1&gt;/?t”</em>) indicates which C&amp;C payload should be downloaded, whereas the second parameter only serves to protect the payload download via an “<em>x-id</em>” field (of value <em>&lt;parameter_2&gt;</em>) adding to the header of the GET requisition.</p>
<div id="attachment_96661" style="width: 650px" class="wp-caption alignnone"><a href="/wp-content/uploads/2017/07/NSIS_12.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96661" src="/wp-content/uploads/2017/07/NSIS_12.jpg" alt="" width="640" height="450" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_12.jpg 824w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_12-300x211.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_12-768x540.jpg 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure 12: Functions used for the download of C&amp;C payloads.</p></div>
<p>At the time of analysis, the <strong>t</strong> file contained only the value “3”. As we can see in <em>downAndExec()</em>, different types of behavior are possible based on the <strong>t</strong> value.</p>
<div id="attachment_96660" style="width: 514px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/07/NSIS_13.jpg" target="_blank" rel="noopener noreferrer"><img class="wp-image-96660 size-full" src="/wp-content/uploads/2017/07/NSIS_13.jpg" alt="" width="504" height="77" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_13.jpg 504w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_13-300x46.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2017/07/NSIS_13-500x77.jpg 500w" sizes="(max-width: 504px) 100vw, 504px" /></a><p class="wp-caption-text">Figure 13: Content of the <strong>t</strong> file.</p></div>
<p>This value is attributed to <em>K</em>, with the script proceeding with the following possibilities:</p>
<ul>
<li><em>K</em>= “1”: snippet exits the execution phase without performing a malicious action.</li>
<li><em>K</em>= “3”: snippet downloads three files, one of which is simply a string (with the name of a DLL), and two other PE files. The runAsUser() function is called during the sequence.</li>
<li><em>K</em>= “4”: A similar instance to <em>K</em> = “3”, but with only two PE files being downloaded, and with the <em>runAsRundll()</em> function being called instead of <em>runAsUser().</em></li>
</ul>
<p>The PE file (for <em>K</em> = “4”) was not available for download, and it is not yet known what will happen in this instance. For K = &#8220;3&#8221;, the downloaded files are:</p>

<table id="tablepress-373" class="tablepress tablepress-id-373">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Filename</th><th class="column-2">Observations</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">dllf</td><td class="column-2">String conteniendo nombres de DLLs (ej.: “cryptui.dll”, “mssign32.dll”)</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">bin</td><td class="column-2">PE correspondiente al <a href="https://virustotal.com/en/file/cf92ca16f1a432ef0a03f2c920738cd13d007b41433ac1688b1f892611b0e344/analysis/" target="_blank">CERTMGR.EXE</a> (legítimo)</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">dllb</td><td class="column-2">PE malicioso detectado por ESET como Win32/Spy.Banker.ADYV trojan</td>
</tr>
</tbody>
</table>

<p>Analysis of the payloads is still in progress; running CERTMGR.EXE, however, indicates that the malicious PE is injected into the memory through DLL pre-loading (<a href="https://support.microsoft.com/en-us/help/2389418/secure-loading-of-libraries-to-prevent-dll-preloading-attacks" target="_blank" rel="noopener">DLL preloading attack</a>).</p>
<p>As we have seen, the <em>downAndExec</em> technique involves two download stages and several protections, either to identify machines matching the desired profile, or to distribute malicious code in &#8220;sterile&#8221; sections, which on their own do not execute (in order to bypass online protections), but which, when joined with other pieces of malicious code, are capable of compromising a victim’s computers.</p>
<p>There are still a number of questions requiring further research in relation to <em>downAndExec</em>:</p>
<ul>
<li>Why use a Content Delivery Network to host the JS snippet?</li>
<li>There are functions such as <em>runAsAdmin()</em> that are not being used. Is the JS snippet being used as a shared module for other types of Brazilian cybercrime or malware?</li>
<li>How will the virus work when <em>K</em>= “4”?</li>
</ul>
<p>Once we have answers to these and the other questions, we will return to this topic, but in the meantime, please don&#8217;t forget to read our blog and to keep informed about other methods used by Brazilian cybercriminals.</p>
<h2>Indicators of Compromise (IoC)</h2>

<table id="tablepress-369" class="tablepress tablepress-id-369">
<thead>
<tr class="row-1 odd">
	<th class="column-1">ESET detection names</th><th class="column-2">Hashes (SHA1)</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">NSIS/TrojanDropper.Agent.CL</td><td class="column-2">30FC877887D6845007503F3ABD44EC261A0D40C7<br />
34F917AABA5684FBE56D3C57D48EF2A1AA7CF06D<br />
37648E4B95636E3EE5A68E3FA8C0735125126C17<br />
38B7611BB20985512F86DC2C38247593E58A1DF6<br />
67458B503047852DD603080946842472E575B856<br />
8EA2C548BCB974A380FECE046A7E3F0218632FF2<br />
BFFAABCCE3F4CCED896F745A7EC4EBA207028683<br />
EFFB36259ACCDFFF07C036C5A41B357692577265<br />
</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">JS/TrojanDownloader.Agent.QPA</td><td class="column-2">2AD3B1669E8302035E24C838B3C08F2C</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Win32/Spy.Banker.ADYV</td><td class="column-2">51AED47CC54E9671F3EA71F8EE584952</td>
</tr>
</tbody>
</table>


<table id="tablepress-370" class="tablepress tablepress-id-370">
<thead>
<tr class="row-1 odd">
	<th class="column-1">URLs contacted</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">hxxps://1402712571.rsc.cdn77.org</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">hxxps://1356485243.rsc.cdn77.org (inactive)</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/cpuodzius/" title="Cassius Puodzius">
                    Cassius Puodzius                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-09-13 15:43:57">13 Sep 2017 - 03:43PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="DownAndExec: Banking malware utilizes CDNs in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="DownAndExec: Banking malware utilizes CDNs in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="DownAndExec: Banking malware utilizes CDNs in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="DownAndExec: Banking malware utilizes CDNs in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F13%2Fdownandexec-banking-malware-cdns-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F13%2Fdownandexec-banking-malware-cdns-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F13%2Fdownandexec-banking-malware-cdns-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"100203 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=100203","disqusShortname":"welivesecurity","disqusTitle":"DownAndExec: Banking malware utilizes CDNs in Brazil","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/09\/13\/downandexec-banking-malware-cdns-brazil\/","postId":"100203"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>