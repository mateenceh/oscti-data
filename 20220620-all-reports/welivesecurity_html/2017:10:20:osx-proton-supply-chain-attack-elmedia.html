<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>OSX/Proton spreading again through supply&#8209;chain attack | WeLiveSecurity</title>
<meta name="description" content="ESET experts noticed that the makers of the Elmedia Player software have been distributing a version of their app trojanized with the OSX/Proton malware."/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/10/20/osx-proton-supply-chain-attack-elmedia/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="OSX/Proton spreading again through supply&#8209;chain attack | WeLiveSecurity" />
<meta property="og:description" content="ESET experts noticed that the makers of the Elmedia Player software have been distributing a version of their app trojanized with the OSX/Proton malware." />
<meta property="og:url" content="https://www.welivesecurity.com/2017/10/20/osx-proton-supply-chain-attack-elmedia/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2017-10-19T23:56:56+00:00" />
<meta property="article:modified_time" content="2017-11-09T04:58:01+00:00" />
<meta property="og:updated_time" content="2017-11-09T04:58:01+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/10/Another-supply-chain-attack-1024x721.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/10/Another-supply-chain-attack-1024x721.jpg" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="721" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET experts noticed that the makers of the Elmedia Player software have been distributing a version of their app trojanized with the OSX/Proton malware." />
<meta name="twitter:title" content="OSX/Proton spreading again through supply&#8209;chain attack | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/10/Another-supply-chain-attack.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2017/10/23/osxproton-aplicativo-trojanizado-macos/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2017/10/20/osx-proton-supply-chain-attack-elmedia/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/10/20/osxproton-aplicacion-troyanizada-macos/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2017/10/20/osx-proton-supply-chain-attacke-trifft-mac-os/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2017/10/23/osxproton-aplicativo-trojanizado-macos/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/10/20/osxproton-aplicacion-troyanizada-macos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/10/20/osx-proton-supply-chain-attacke-trifft-mac-os/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2017/10/23/osxproton-aplicativo-trojanizado-macos/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/10/20/osxproton-aplicacion-troyanizada-macos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/10/20/osx-proton-supply-chain-attacke-trifft-mac-os/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>OSX/Proton spreading again through supply&#8209;chain attack</h1>
<div class="excerpt">Our researchers noticed that the makers of the Elmedia Player software have been distributing a version of their app trojanized with the OSX/Proton malware.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-10-20 01:56:56">20 Oct 2017 - 01:56AM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F20%2Fosx-proton-supply-chain-attack-elmedia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F20%2Fosx-proton-supply-chain-attack-elmedia%2F&text=OSX/Proton spreading again through supply&#8209;chain attack%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F20%2Fosx-proton-supply-chain-attack-elmedia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Our researchers noticed that the makers of the Elmedia Player software have been distributing a version of their app trojanized with the OSX/Proton malware.</p>
                            </div>

                            <p>On 19 October 2017, ESET researchers noticed that <a href="https://www.eltima.com" target="_blank" rel="noopener">Eltima</a>, the makers of the Elmedia Player software, were distributing a version of their application trojanized with the <a href="http://www.virusradar.com/en/OSX_Proton" target="_blank" rel="noopener">OSX/Proton</a> malware on their official website. ESET contacted Eltima as soon as the situation was confirmed. Eltima was very responsive and maintained an excellent communication with us throughout the incident.</p>
<p>Timeline</p>
<ul>
<li>2017-10-19 : Trojanized package confirmed</li>
<li>2017-10-19 10:35am EDT: Eltima informed via email</li>
<li>2017-10-19 2:25pm EDT: Eltima acknowledged the issue and initiated remediation efforts</li>
<li>2017-10-19 3:10pm EDT: Eltima confirms their infrastructure is cleaned up and serving the legitimate applications again</li>
<li>2017-10-19 10:12am EDT: <a href="https://www.eltima.com/blog/2017/10/elmedia-player-and-folx-malware-threat-neutralized.html">Eltima publishes an announcement about the event</a></li>
<li>2017-10-20 12:15pm EDT: Added references to Folx that was also distributed with the Proton malware</li>
</ul>
<p><em>Note: This blog was initially</em> <em>posted despite our research being incomplete. Hence, this information is preliminary and the blogpost will be updated as new facts emerge. </em></p>
<h2>Am I compromised?</h2>
<p>ESET advises anyone who downloaded Elmedia Player or Folx software recently to verify if their system is compromised by testing the presence of any of the following files or directories:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">/tmp/Updater.app/</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">/Library/LaunchAgents/com.Eltima.UpdaterAgent.plist</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">/Library/.rand/</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">/Library/.rand/updateragent.app/</span></li>
</ul>
<p>If any of them exists, it means the trojanized Elmedia Player or Folx application was executed and that OSX/Proton is most likely running.</p>
<p>If you have downloaded that software on October 19th before 3:15pm EDT and run it, you are likely compromised.</p>
<p>As far as we know, the trojanized version of the application was only downloadable from the Eltima website, between 08:00 and 15:15 EDT on 19 October 2017. The built-in automatic update mechanism seems unaffected.</p>
<h2>What does the malicious payload do to a compromised system?</h2>
<p>OSX/Proton is a backdoor with extensive data-stealing capabilities. It gains persistence on the system and can steal the following:</p>
<ul>
<li>Operating system details: hardware serial number (IOPlatformSerialNumber), full name of the current user, hostname, System Integrity Protection status (<span style="font-family: 'courier new', courier, monospace;">csrutil status</span>), gateway information (<span style="font-family: 'courier new', courier, monospace;">route -n get default | awk &#8216;/gateway/ { print $2 }&#8217;</span>), current time &amp; timezone</li>
<li>Browser information from Chrome, Safari, Opera and Firefox: history, cookies, bookmarks, login data, etc.</li>
<li>Cryptocurrency wallets:
<ul>
<li>Electrum: ~/.electrum/wallets</li>
<li>Bitcoin Core: ~/Library/Application Support/Bitcoin/wallet.dat</li>
<li>Armory: ~/Library/Application Support/Armory</li>
</ul>
</li>
<li>SSH private data (entire .ssh content)</li>
<li>macOS keychain data using a modified version of <a href="https://github.com/n0fate/chainbreaker/" target="_blank" rel="noopener">chainbreaker</a></li>
<li>Tunnelblick VPN configuration (<span style="font-family: 'courier new', courier, monospace;">~/Library/Application Support/Tunnelblick/Configurations</span>)</li>
<li>GnuPG data (<span style="font-family: 'courier new', courier, monospace;">~/.gnupg</span>)</li>
<li>1Password data (<span style="font-family: 'courier new', courier, monospace;">~/Library/Application Support/1Password 4</span> and <span style="font-family: 'courier new', courier, monospace;">~/Library/Application Support/1Password 3.9</span>)</li>
<li>List of all installed applications.</li>
</ul>
<h3><strong>How do I clean my system?</strong></h3>
<p>As with any compromise of an administrator account, a full OS reinstall is the only sure way to get rid of the malware. Victims should also assume at least all the secrets outlined in the previous section are compromised and take appropriate measures to invalidate them.</p>
<h2>Supply-chain attack revisited on the Mac</h2>
<p>Last year, the Mac Bittorrent client Transmission was abused twice to spread malware, first the <a href="https://www.welivesecurity.com/2016/03/07/new-mac-ransomware-appears-keranger-spread-via-transmission-app/" target="_blank" rel="noopener">OSX/KeRanger ransomware</a> followed by <a href="https://www.welivesecurity.com/2016/08/30/osxkeydnap-spreads-via-signed-transmission-application/" target="_blank" rel="noopener">OSX/Keydnap password stealer</a>. Then this year, the Handbrake video-transcoder application was <a href="https://blog.malwarebytes.com/threat-analysis/mac-threat-analysis/2017/05/handbrake-hacked-to-drop-new-variant-of-proton-malware/" target="_blank" rel="noopener">found bundled with OSX/Proton</a>.</p>
<p>Today, ESET discovered another popular Mac software package being used to spread OSX/Proton: Elmedia Player, a media player that reached the 1,000,000 users milestone this summer:</p>
<p><a href="https://twitter.com/Elmedia_Player/status/895995031802261504"><img class="wp-image-102431" src="/wp-content/uploads/2017/10/twitter.com895995031802261504-266x300.png" alt=" https://twitter.com/Elmedia_Player/status/895995031802261504" width="640" height="722" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/10/twitter.com895995031802261504-266x300.png 266w, https://www.welivesecurity.com/wp-content/uploads/2017/10/twitter.com895995031802261504.png 613w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h2>Technical analysis</h2>
<p>OSX/Proton is a RAT (Remote Access Trojan) sold as a kit on underground forums. It was very briefly documented by Sixgill <a href="https://www.cybersixgill.com/proton-a-new-mac-os-rat/" target="_blank" rel="noopener">earlier this year</a> and then further analyzed by <a href="https://blog.malwarebytes.com/threat-analysis/mac-threat-analysis/2017/05/handbrake-hacked-to-drop-new-variant-of-proton-malware/" target="_blank" rel="noopener">Thomas Reed at MalwareBytes</a>, <a href="https://www.cybereason.com/labs-blog/labs-proton-b-what-this-mac-malware-actually-does" target="_blank" rel="noopener">Amit Serper at CyberReason</a> and <a href="https://objective-see.com/blog/blog_0x1F.html" target="_blank" rel="noopener">Patrick Wardle at Objective-See</a>.</p>
<p>In the current case of Eltima trojanized software, the attacker built a signed wrapper around the legitimate Elmedia Player and Proton. In fact, we observed what seems to be real-time repackaging and signing of the wrappers, all with the same valid Apple Developer ID. See the history of currently known samples below. Eltima and ESET confirmed they are working with Apple to invalidate the Developer ID used to sign the malicious application. (Apple revoked the certificate.)</p>
<p>(timestamps are all in EDT timezone)</p>
<p>Clean application:</p>

<table id="tablepress-391" class="tablepress tablepress-id-391">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Timestamp</th><th class="column-2">Developper ID</th><th class="column-3">SHA-1</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Timestamp=Jul 24, 2017, 4:56:24 AM </td><td class="column-2">Authority=Developer ID Application: ELTIMA LLC (N7U4HGP254)</td><td class="column-3"><code>0603353852e174fc0337642e3957c7423f182a8c</code></td>
</tr>
</tbody>
</table>

<p>Trojanized application:</p>

<table id="tablepress-392" class="tablepress tablepress-id-392">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Timestamp</th><th class="column-2">Developper ID</th><th class="column-3">SHA-1 (dmg file)</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Timestamp=Oct 19, 2017, 8:00:05 AM</td><td class="column-2">Authority=Developer ID Application: Clifton Grimm (9H35WM5TA5) </td><td class="column-3"><code>e9dcdae1406ab1132dc9d507fd63503e5c4d41d9</code></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Timestamp=Oct 19, 2017, 12:22:24 PM</td><td class="column-2">Authority=Developer ID Application: Clifton Grimm (9H35WM5TA5) </td><td class="column-3"><code>8cfa551d15320f0157ece3bdf30b1c62765a93a5</code></td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Timestamp=Oct 19, 2017, 2:00:38 PM</td><td class="column-2">Authority=Developer ID Application: Clifton Grimm (9H35WM5TA5) </td><td class="column-3"><code>0400b35d703d872adc64aa7ef914a260903998ca</code></td>
</tr>
</tbody>
</table>

<p>First, the wrapper launches the real Elmedia Player application stored in the Resources folder of the application:</p>
<p><a href="/wp-content/uploads/2017/10/Elmedia-Player-application.png"><img class="aligncenter wp-image-102432" src="/wp-content/uploads/2017/10/Elmedia-Player-application-300x215.png" alt="" width="640" height="459" /></a></p>
<p>And finally extracts &amp; launches OSX/Proton:<a href="/wp-content/uploads/2017/10/extracts-launches-OSXProton.png"><img class="aligncenter wp-image-102433" src="/wp-content/uploads/2017/10/extracts-launches-OSXProton-300x82.png" alt="" width="640" height="174" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/10/extracts-launches-OSXProton-300x82.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/10/extracts-launches-OSXProton-768x209.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/10/extracts-launches-OSXProton-1024x279.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/10/extracts-launches-OSXProton.png 1039w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>As seen in previous cases, OSX/Proton shows a fake Authorization window to gain root privileges:</p>
<p><a href="/wp-content/uploads/2017/10/fake-Authorization-window.png"><img class="aligncenter wp-image-102434" src="/wp-content/uploads/2017/10/fake-Authorization-window-300x187.png" alt="" width="640" height="399" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/10/fake-Authorization-window-300x187.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/10/fake-Authorization-window-768x479.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/10/fake-Authorization-window-1024x638.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/10/fake-Authorization-window-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2017/10/fake-Authorization-window-275x172.png 275w, https://www.welivesecurity.com/wp-content/uploads/2017/10/fake-Authorization-window.png 1104w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h3>Persistance</h3>
<p>OSX/Proton ensures persistence by adding a LaunchAgent for all users when the administrator types their password. It creates the following files on the system:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">/Library/LaunchAgents/com.Eltima.UpdaterAgent.plist</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">/Library/.rand/updateragent.app</span></li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057a1283daa7180436091" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ plutil -p /Library/LaunchAgents/com.Eltima.UpdaterAgent.plist
{
  "ProgramArguments" =&gt; [
    0 =&gt; "/Library/.rand/updateragent.app/Contents/MacOS/updateragent"
  ]
  "KeepAlive" =&gt; 1
  "RunAtLoad" =&gt; 1
  "Label" =&gt; "com.Eltima.UpdaterAgent"
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057a1283daa7180436091-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a1283daa7180436091-2">2</div><div class="crayon-num" data-line="crayon-6057a1283daa7180436091-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a1283daa7180436091-4">4</div><div class="crayon-num" data-line="crayon-6057a1283daa7180436091-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a1283daa7180436091-6">6</div><div class="crayon-num" data-line="crayon-6057a1283daa7180436091-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a1283daa7180436091-8">8</div><div class="crayon-num" data-line="crayon-6057a1283daa7180436091-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057a1283daa7180436091-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">plutil</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchAgents</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">Eltima</span><span class="crayon-sy">.</span><span class="crayon-v">UpdaterAgent</span><span class="crayon-sy">.</span><span class="crayon-i">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a1283daa7180436091-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-6057a1283daa7180436091-3"> <span class="crayon-h"> </span><span class="crayon-s">"ProgramArguments"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a1283daa7180436091-4">   <span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">"/Library/.rand/updateragent.app/Contents/MacOS/updateragent"</span></div><div class="crayon-line" id="crayon-6057a1283daa7180436091-5"> <span class="crayon-h"> </span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a1283daa7180436091-6"> <span class="crayon-h"> </span><span class="crayon-s">"KeepAlive"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-6057a1283daa7180436091-7"> <span class="crayon-h"> </span><span class="crayon-s">"RunAtLoad"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a1283daa7180436091-8"> <span class="crayon-h"> </span><span class="crayon-s">"Label"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">"com.Eltima.UpdaterAgent"</span></div><div class="crayon-line" id="crayon-6057a1283daa7180436091-9"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h3>Backdoor commands</h3>
<p>As mentioned at the beginning of the post, OSX/Proton is a backdoor with extensive information stealing capabilities. The backdoor component we observed supports the following commands:</p>

<table id="tablepress-393" class="tablepress tablepress-id-393">
<tbody class="row-hover">
<tr class="row-1 odd">
	<td class="column-1"><code>archive</code></td><td class="column-2">Archive files using zip</td>
</tr>
<tr class="row-2 even">
	<td class="column-1"><code>copy</code></td><td class="column-2">Copy file locally</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><code>create</code></td><td class="column-2">Create directory or file locally</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><code>delete</code></td><td class="column-2">Delete file locally</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><code>download</code></td><td class="column-2">Download file from a URL</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><code>file_search</code></td><td class="column-2">Search for files (executes find / -iname \"%@\" 2> /dev/null)</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><code>force_update</code></td><td class="column-2">Self-update with digital signature validation</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><code>phonehome</code></td><td class="column-2"></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><code>remote_execute</code></td><td class="column-2">Execute the binary file inside a .zip file or a given shell command</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><code>tunnel</code></td><td class="column-2">Create SSH tunnel using port 22 or 5900</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><code>upload</code></td><td class="column-2">Upload file to C&amp;C server</td>
</tr>
</tbody>
</table>

<h2>C&amp;C server</h2>
<p>Proton uses a C&amp;C domain that mimics the legitimate Eltima domain, which is consistent with the Handbrake case:</p>

<table id="tablepress-394" class="tablepress tablepress-id-394">
<thead>
<tr class="row-1 odd">
	<th class="column-1">&nbsp;</th><th class="column-2">Legitimate domain</th><th class="column-3">Proton C2 domain</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Eltima</td><td class="column-2">eltima.com</td><td class="column-3">eltima[.]in</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Handbrake</td><td class="column-2">handbrake.fr</td><td class="column-3">handbrakestore[.]com</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"></td><td class="column-2"></td><td class="column-3">handbrake[.]cc</td>
</tr>
</tbody>
</table>

<h2>IOCs</h2>
<p>URL distributing the trojanized application at the time of discovery:</p>
<ul>
<li>hxxps://mac[.]eltima[.]com/download/elmediaplayer.dmg</li>
<li>hxxp://www.elmedia-video-player.[.]com/download/elmediaplayer.dmg</li>
<li>hxxps://mac.eltima[.]com/download/downloader_mac.dmg</li>
</ul>
<h3>C&amp;C servers</h3>
<p>eltima[.]in / 5.196.42.123 (domain registered 2017-10-15)</p>
<h3>Hashes</h3>

<table id="tablepress-398" class="tablepress tablepress-id-398">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Path</th><th class="column-2">SHA-1</th><th class="column-3">ESET Detection name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Elmedia Player.app/Contents/Resources/.pl.zip</td><td class="column-2"><code>9E5378165BB20E9A7F74A7FCC73B528F7B231A75</code></td><td class="column-3">multiple threats</td><td class="column-4">ZIP archive with the Proton malware and Python scripts</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"></td><td class="column-2"><code>10A09C09FD5DD76202E308718A357ABC7DE291B5</code></td><td class="column-3">multiple threats</td><td class="column-4">ZIP archive with the Proton malware and Python scripts</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Elmedia Player.app/Contents/MacOS/Elmedia Player</td><td class="column-2"><code>C9472D791C076A10DCE5FF0D3AB6E7706524B741</code></td><td class="column-3">OSX/Proton.D</td><td class="column-4">Launcher (or wrapper)</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"></td><td class="column-2"><code>30D77908AC9D37C4C14D32EA3E0B8DF4C7E75464</code></td><td class="column-3">OSX/Proton.D</td><td class="column-4">Launcher (or wrapper)</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Updater.app/Contents/MacOS/Updater</td><td class="column-2"><code>3EF34E2581937BABD2B7CE63AB1D92CD9440181A</code></td><td class="column-3">OSX/Proton.C</td><td class="column-4">Proton malware, not signed</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"></td><td class="column-2"><code>EF5A11A1BB5B2423554309688AA7947F4AFA5388</code></td><td class="column-3">OSX/Proton.C</td><td class="column-4">Proton malware, not signed</td>
</tr>
</tbody>
</table>

<p>Hat tip to Michal Malik, Anton Cherepanov, Marc-Étienne M. Léveillé, Thomas Dupuy &amp; Alexis Dorais-Joncas for their work on this investigation.</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-10-20 01:56:56">20 Oct 2017 - 01:56AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="OSX/Proton spreading again through supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="OSX/Proton spreading again through supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="OSX/Proton spreading again through supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="OSX/Proton spreading again through supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F20%2Fosx-proton-supply-chain-attack-elmedia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F20%2Fosx-proton-supply-chain-attack-elmedia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F10%2F20%2Fosx-proton-supply-chain-attack-elmedia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"102429 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=102429","disqusShortname":"welivesecurity","disqusTitle":"OSX\/Proton spreading again through supply\u2011chain attack","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/10\/20\/osx-proton-supply-chain-attack-elmedia\/","postId":"102429"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>