<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Marc-Etienne M.Léveillé',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>VestaCP compromised in a new supply&#8209;chain attack | WeLiveSecurity</title>
<meta name="description" content="VestaCP compromised in a supply-chain attack as a result the compromise allowed attackers to obtain customer&#039;s admin credentials. Attackers used the credentials to infect VestaCP customers with ChaChaBot to launch DDoS attack."/>
<link rel="canonical" href="https://www.welivesecurity.com/2018/10/18/new-linux-chachaddos-malware-distributed-servers-vestacp-installed/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:type" content="article" />
<meta property="og:title" content="VestaCP compromised in a new supply&#8209;chain attack | WeLiveSecurity" />
<meta property="og:description" content="VestaCP compromised in a supply-chain attack as a result the compromise allowed attackers to obtain customer&#039;s admin credentials. Attackers used the credentials to infect VestaCP customers with ChaChaBot to launch DDoS attack." />
<meta property="og:url" content="https://www.welivesecurity.com/2018/10/18/new-linux-chachaddos-malware-distributed-servers-vestacp-installed/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2018-10-18T08:54:01+00:00" />
<meta property="article:modified_time" content="2018-10-19T07:23:42+00:00" />
<meta property="og:updated_time" content="2018-10-19T07:23:42+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/10/NewLinux_ChachaDDoSMalware-1024x683.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2018/10/NewLinux_ChachaDDoSMalware-1024x683.jpg" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="683" />
<meta property="og:image:alt" content="VestaCP" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="VestaCP compromised in a supply-chain attack as a result the compromise allowed attackers to obtain customer&#039;s admin credentials. Attackers used the credentials to infect VestaCP customers with ChaChaBot to launch DDoS attack." />
<meta name="twitter:title" content="VestaCP compromised in a new supply&#8209;chain attack | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/10/NewLinux_ChachaDDoSMalware-e1539852183462.jpg" />
<meta name="twitter:creator" content="@marc_etienne_" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2018/10/18/vespacp-compromis-chaine-de-commande/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2018/10/18/new-linux-chachaddos-malware-distributed-servers-vestacp-installed/" hreflang="en" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2018/10/18/vespacp-compromis-chaine-de-commande/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2018/10/18/vespacp-compromis-chaine-de-commande/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2018/10/NewLinux_ChachaDDoSMalware-1.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>VestaCP compromised in a new supply&#8209;chain attack</h1>
<div class="excerpt">Customers see their admin credentials stolen and their servers infected with Linux/ChachaDDoS   </div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/06/Marc-Etienne-M.Leveille.png" alt="Marc-Etienne M.Léveillé">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2018-10-18 10:54:01">18 Oct 2018 - 10:54AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F10%2F18%2Fnew-linux-chachaddos-malware-distributed-servers-vestacp-installed%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F10%2F18%2Fnew-linux-chachaddos-malware-distributed-servers-vestacp-installed%2F&text=VestaCP compromised in a new supply&#8209;chain attack%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F10%2F18%2Fnew-linux-chachaddos-malware-distributed-servers-vestacp-installed%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Customers see their admin credentials stolen and their servers infected with Linux/ChachaDDoS   </p>
                            </div>

                            <p><span style="font-weight: 400;">In recent months, </span><a href="https://forum.vestacp.com/viewtopic.php?f=10&amp;t=17641" target="_blank" rel="noopener"><span style="font-weight: 400;">numerous users of VestaCP</span></a>, a hosting control panel solution, <span style="font-weight: 400;">have received warnings from their service providers that their servers were using an abnormal amount of bandwidth. We know now that these servers were in fact used to launch DDoS attacks. Analysis of a compromised server has shown that malware we call Linux/ChachaDDoS was installed on the system. At the same time this week, we found out that the official VestaCP distribution was compromised, resulting in a supply-chain attack on new installations of VestaCP since at least May 2018. Linux/ChachaDDoS has some similarity to Linux/Xor.DDoS (aka Xor.DDOS), but unlike this older family, it has multiple stages and uses Lua for its second- and third-stage components.</span></p>
<h2><span style="font-weight: 400;">Infection vector</span></h2>
<p><span style="font-weight: 400;">According to user “Razza” on the VestaCP forum, </span><a href="https://forum.vestacp.com/viewtopic.php?f=10&amp;t=17641&amp;p=73282" target="_blank" rel="noopener"><span style="font-weight: 400;">the attacker tried launching Linux/ChachaDDoS</span></a><span style="font-weight: 400;"> via SSH. It is not clear how the payload was dropped in the </span><code>/var/tmp</code> dir<span style="font-weight: 400;">ectory, but assuming the attacker already has the admin password, it would have been a trivial task. During the installation, VestaCP creates a user named “admin” that has </span><a href="https://github.com/serghey-rodin/vesta/blob/0.9.8-19/install/debian/9/sudo/admin" target="_blank" rel="noopener"><span style="font-weight: 400;">sudo privileges</span></a><span style="font-weight: 400;">. How could the attacker have known the password for this admin user?</span></p>
<p><span style="font-weight: 400;">There are multiple hypotheses as to how the credentials were obtained in the first place. We first suspected a vulnerability in the web interface of VestaCP. While looking at the code, we found that the </span><a href="https://github.com/serghey-rodin/vesta/blob/0.9.8-19/install/vst-install-debian.sh#L989" target="_blank" rel="noopener"><span style="font-weight: 400;">unencrypted password is kept</span></a><span style="font-weight: 400;"> i</span>n <code>/root/.my.cnf</code>, <span style="font-weight: 400;">but accessing the content of this file would still require the attacker to exploit a </span><a href="https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Local_File_Inclusion" target="_blank" rel="noopener"><span style="font-weight: 400;">local file inclusion</span></a><span style="font-weight: 400;"> and privilege escalation vulnerability. User “Falzo” also dug in the code and found out </span><a href="https://forum.vestacp.com/viewtopic.php?f=10&amp;t=17641&amp;start=160#p73881" target="_blank" rel="noopener"><span style="font-weight: 400;">something even more interesting</span></a><span style="font-weight: 400;">: some versions of the installation script were leaking the admin password and server name to vestacp.com, the official website of VestaCP.</span></p>
<p><a href="/wp-content/uploads/2018/10/image8.png"><img class="aligncenter size-full wp-image-117783" src="/wp-content/uploads/2018/10/image8.png" alt="" width="500" height="447" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image8.png 500w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image8-300x268.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image8-87x77.png 87w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image8-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image8-85x75.png 85w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p><span style="font-weight: 400;">As “L4ky” </span><a href="https://forum.vestacp.com/viewtopic.php?f=10&amp;t=17641&amp;start=170#p73890" target="_blank" rel="noopener"><span style="font-weight: 400;">pointed out</span></a><span style="font-weight: 400;">, it is all in the Git hist</span>ory of the <code>vst-install-ubuntu.sh</code> file. From May 31 18:15:53 2018 (UTC+3) (<a href="https://github.com/serghey-rodin/vesta/commit/a3f0fa1501d424477786e3e7150bb05c0b99518f#diff-df8da0c91e9086454c60cd468849630dR1256" target="_blank" rel="noopener">a3f0fa1</a>) to Jun 13 17:08:36 2018 (<a href="https://github.com/serghey-rodin/vesta/commit/ee03eff016e03cb76fac7ae3a0f9d1ef0f8ee35b#diff-df8da0c91e9086454c60cd468849630dL1270" target="_blank" rel="noopener">ee03eff</a>) the <code>$codename</code> variable contained the base64-encoded password and server domain name <a href="https://github.com/serghey-rodin/vesta/blob/a7e115fbb3e7237684e720a8e9bc78d869a5d994/install/vst-install-ubuntu.sh#L1299" target="_blank" rel="noopener">sent to</a> <code>http://vestacp.com/notify/</code>. Falzo says he found the hack in line 809 of the Debian installer, but unlike for the Ubuntu installer, we couldn’t find a reference to it in the Git history. Perhaps the installer on VestaCP differed from what is visible on Github?<span style="font-weight: 400;"><br />
</span></p>
<p><span style="font-weight: 400;">Given this major password leak, we urge </span><b>all VestaCP administrators to change the admin password</b><span style="font-weight: 400;"> and harden access to their servers. Serious admins should consider an audit of the VestaCP code.</span></p>
<p><span style="font-weight: 400;">While this finding is shocking, there is no evidence that this password leakage is how Linux/ChachaDDoS was distributed in the first place. It could have been through another hole.</span></p>
<p><span style="font-weight: 400;">VestaCP maintainers <a href="https://forum.vestacp.com/viewtopic.php?f=10&amp;t=17641&amp;start=180#p73907" target="_blank" rel="noopener">stated they were compromised</a>. How the malicious code ended up in their Git tree is still unclear. Perhaps the perpetrator modified the installation scripts on the server and this version was used to create the next version of the file in Git, but only for the Ubuntu target. This would mean they have been compromised since at least May 2018.</span></p>
<h2><span style="font-weight: 400;">Linux/ChachaDDoS analysis</span></h2>
<p><span style="font-weight: 400;">The malware dropped on the compromised servers is a variant of a new strain of DDoS malware that we call ChachaDDoS. It seems like an evolution of multiple existing DDoS malware. The first and second stages set their process nam</span>es to <code>[kworker/1:1]</code>. That is what would appear in the output of <code>ps</code>.</p>
<h2><span style="font-weight: 400;">First stage</span></h2>
<h3><span style="font-weight: 400;">Persistence mechanism and link to Xor.DDoS</span></h3>
<p><span style="font-weight: 400;">The persistence mechanism used in Linux/ChachaDDoS is actually the same as in Linux/XorDDos except for the filename, </span><span style="font-family: courier new,courier,monospace; font-weight: 400;">dhcprenew</span><span style="font-weight: 400;">. It consists of the following steps:</span></p>
<ol>
<li><span style="font-weight: 400;"> It copies its</span>elf to <code>/usr/bin/dhcprenew</code></li>
<li><span style="font-weight: 400;"> If any persistence mechanism related to the malware is already set on the host, it is removed</span></li>
<li><span style="font-weight: 400;"> A new service is added t</span>o <code>/etc/init.d/dhcprenew</code></li>
</ol>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057a83abf265770447755" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/bin/sh
# chkconfig: 12345 90 90
# description: dhcprenew
### BEGIN INIT INFO
# Provides:     dhcprenew
# Required-Start:
# Required-Stop:
# Default-Start: 1 2 3 4 5
# Default-Stop:    
# Short-Description: dhcprenew
### END INIT INFO
case $1 in
start)
   /usr/bin/dhcprenew
   ;;
stop)
   ;;
*)
   /usr/bin/dhcprenew
   ;;
esac</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057a83abf265770447755-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-2">2</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-4">4</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-6">6</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-8">8</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-10">10</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-12">12</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-14">14</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-16">16</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-18">18</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a83abf265770447755-20">20</div><div class="crayon-num" data-line="crayon-6057a83abf265770447755-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057a83abf265770447755-1"><span class="crayon-p">#!/bin/sh</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-2"><span class="crayon-c"># chkconfig: 12345 90 90</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-3"><span class="crayon-c"># description: dhcprenew</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-4"><span class="crayon-c">### BEGIN INIT INFO</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-5"><span class="crayon-c"># Provides:     dhcprenew</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-6"><span class="crayon-c"># Required-Start:</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-7"><span class="crayon-c"># Required-Stop:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-8"><span class="crayon-c"># Default-Start: 1 2 3 4 5</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-9"><span class="crayon-c"># Default-Stop:    </span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-10"><span class="crayon-c"># Short-Description: dhcprenew</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-11"><span class="crayon-c">### END INIT INFO</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-12"><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">in</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-13"><span class="crayon-v">start</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-14">   <span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-i">dhcprenew</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-15">   <span class="crayon-sy">;</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-16"><span class="crayon-v">stop</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-17">   <span class="crayon-sy">;</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-18"><span class="crayon-o">*</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-19">   <span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-i">dhcprenew</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a83abf265770447755-20">   <span class="crayon-sy">;</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6057a83abf265770447755-21"><span class="crayon-st">esac</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<ol start="4">
<li><span style="font-weight: 400;"> A symlink to this service is create</span>d in <code>/etc/rc[1-5].d/S90dhcprenew</code> and <code>/etc/rc.d/rc[1-5].d/S90dhcprenew</code><span style="font-weight: 400;"><a href="/wp-content/uploads/2018/10/image4.png"><img class="aligncenter size-full wp-image-117787" src="/wp-content/uploads/2018/10/image4.png" alt="" width="659" height="305" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image4.png 659w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image4-300x139.png 300w" sizes="(max-width: 659px) 100vw, 659px" /></a></span></li>
<li><span style="font-weight: 400;"> It runs the command lin</span>es <code>chkconfig --add dhcprenew</code> and <code>update-rc.d dhcprenew defaults</code> to enable the service</li>
</ol>
<h2><span style="font-weight: 400;">Download and decryption of the second stage</span></h2>
<p><span style="font-weight: 400;">Once the persistence is set, the second stage is periodically downloaded from a hardcoded URL. Interestingly, from the different samples we analysed, we observed some similar characteristics concerning the structure of the URL:</span></p>
<ul>
<li style="font-weight: 400;"><span style="font-weight: 400;">The use of port 8852</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">All the IP addresses used belong to the 193.201.224.0/24 subnet (AS25092, OPATELECOM PE Tetyana Mysyk, Ukraine)</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">The resource name of the second stage looks pseudorandom but is always a 6-to-8 character uppercase string (such as JHKDSAG or ASDFRE)</span></li>
</ul>
<p><span style="font-weight: 400;">The URL follows the patter</span>n <code>http://{C&amp;C}:8852/{campaign}/{arch}</code>. We found that second stage<span style="font-weight: 400;"> binaries are available for multiple architectures including x86, ARM, MIPS, PowerPC and even <a href="https://en.wikipedia.org/wiki/Linux_on_z_Systems" target="_blank" rel="noopener">s390x</a>. After downloading the ELF file corresponding to the architecture of the victim host, it is decrypted with ChaCha encryption algorithm. ChaCha is the successor of the </span><a href="https://en.wikipedia.org/wiki/Salsa20" target="_blank" rel="noopener"><span style="font-weight: 400;">Salsa20</span></a><span style="font-weight: 400;"> stream cipher. Both ciphers use the same constant</span> <code>expand 32-byte k</code> to set the <span style="font-weight: 400;">initial state; the following image shows the beginning of the decryption function:</span></p>
<p><a href="/wp-content/uploads/2018/10/image3.png"><img class="aligncenter size-full wp-image-117786" src="/wp-content/uploads/2018/10/image3.png" alt="" width="539" height="122" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image3.png 539w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image3-300x68.png 300w" sizes="(max-width: 539px) 100vw, 539px" /></a></p>
<p><span style="font-weight: 400;">The differences between the two algorithms are a rearrangement of the initial state and a modification of the quarter-round, which is the core operation performed by the ciphers. Thanks to the specific rotations used in its quarter-round, we could identify the use of ChaCha as shown in the following snippet:</span></p>
<p><a href="/wp-content/uploads/2018/10/image2.png"><img class="aligncenter size-full wp-image-117785" src="/wp-content/uploads/2018/10/image2.png" alt="" width="243" height="377" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image2.png 243w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image2-193x300.png 193w" sizes="(max-width: 243px) 100vw, 243px" /></a></p>
<p><span style="font-weight: 400;">The key size used for ChaCha decryption is 256 bits and among all the samples we collected, we observed the use of the same key. In order to avoid the pain of reimplementing the decryption algorithm, we developed a </span><a href="https://github.com/eset/malware-research/blob/master/chachaddos/decrypt_second_stage.py" target="_blank" rel="noopener"><span style="font-weight: 400;">script</span></a><span style="font-weight: 400;"> based on </span><a href="https://github.com/cea-sec/miasm" target="_blank" rel="noopener"><span style="font-weight: 400;">Miasm</span></a><span style="font-weight: 400;"> to emulate the decryption function.</span></p>
<p><span style="font-weight: 400;">Once we decrypted the second stage, it appeared the output is LZMA compressed, so we just extracted the binary </span>using  <code>lzma -d &lt; output &gt; second_stage.elf</code>.</p>
<h2><span style="font-weight: 400;">Second stage</span></h2>
<p><span style="font-weight: 400;">The binary itself is much larger than the first stage and this is mainly because of the embedded Lua interpreter. Malware in Lua is something we have seen before with </span><a href="https://www.welivesecurity.com/2017/04/25/linux-shishiga-malware-using-lua-scripts/" target="_blank" rel="noopener"><span style="font-weight: 400;">Linux/Shishiga</span></a><span style="font-weight: 400;">. The purpose of the second stage is to execute a hardcoded Lua payload that downloads tasks periodically. We consider the task as a third stage because a task is basically Lua code to be interpreted. In all variants we observed, the second stage uses the same C&amp;C server as its first stage. This second stage embeds numerous Lua libraries (such as </span><a href="https://github.com/diegonehab/luasocket" target="_blank" rel="noopener"><span style="font-weight: 400;">LuaSocket)</span></a><span style="font-weight: 400;"> to communicate with the hardcoded C&amp;C server.</span></p>
<p><span style="font-weight: 400;">Some native functions of the binary are exposed so they can be called from Lua code; the following screenshot shows how they are exported, like the ChaCha encryption function, for example.</span></p>
<p><a href="/wp-content/uploads/2018/10/image1.png"><img class="aligncenter size-full wp-image-117784" src="/wp-content/uploads/2018/10/image1.png" alt="" width="356" height="271" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image1.png 356w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image1-300x228.png 300w" sizes="(max-width: 356px) 100vw, 356px" /></a></p>
<p><span style="font-weight: 400;">The task downloaded by the Lua payload is ChaCha decrypted (with a different encryption key) and executed by the Lua interpreter. As for the second stage, the URL used to download the task seems to follow a specific pattern, as one can observe from the following snippet of code:</span></p>
<p><a href="/wp-content/uploads/2018/10/image5.png"><img class="aligncenter size-full wp-image-117788" src="/wp-content/uploads/2018/10/image5.png" alt="" width="767" height="52" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image5.png 767w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image5-300x20.png 300w" sizes="(max-width: 767px) 100vw, 767px" /></a></p>
<p><span style="font-weight: 400;">Also, the payload should send some statistics using the URL specified in the screenshot above regarding the task usage; however, in practice, it sends only the MAC address and some other information:</span></p>
<p><a href="/wp-content/uploads/2018/10/image9.png"><img class="aligncenter size-large wp-image-117791" src="/wp-content/uploads/2018/10/image9-1024x855.png" alt="" width="1024" height="855" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image9-1024x855.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image9-300x250.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image9-768x641.png 768w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image9.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<h2><span style="font-weight: 400;">Third stage (tasks)</span></h2>
<p><span style="font-weight: 400;">From the tasks we were able to collect, we observed only the implementation of a DDoS function. The code is pretty explicit and consists mainly of a call to a function to perform a SYN DDoS attack against a given target:</span></p>
<p><a href="/wp-content/uploads/2018/10/image7.png"><img class="aligncenter size-full wp-image-117790" src="/wp-content/uploads/2018/10/image7.png" alt="" width="425" height="191" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image7.png 425w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image7-300x135.png 300w" sizes="(max-width: 425px) 100vw, 425px" /></a></p>
<p><a href="/wp-content/uploads/2018/10/image6.png"><img class="aligncenter size-full wp-image-117789" src="/wp-content/uploads/2018/10/image6.png" alt="" width="360" height="111" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/10/image6.png 360w, https://www.welivesecurity.com/wp-content/uploads/2018/10/image6-300x93.png 300w" sizes="(max-width: 360px) 100vw, 360px" /></a></p>
<p><span style="font-weight: 400;">The IP address of the DDoS target, <code>144.0.2.180</code>, belongs to a Chinese ISP. We couldn’t find any obvious reason for this IP address to be a target of the DDoS attack, as no services seem to be hosted on that IP address.</span></p>
<p>The <code>Last-Modified</code> HTTP response header of the task file response indicates that this target was the same since September 24th 2018. It should be reliable since the malware use the <code>If-Modified-Since</code> HTTP request  header to <span style="font-weight: 400;">avoid downloading payloads again.</span></p>
<p><span style="font-weight: 400;">The ASDFREM campaign is the only other one with an active task. It is similar but targets yet another IP address in China: <code>61.133.6.150</code>.</span></p>
<h2><span style="font-weight: 400;">Conclusion</span></h2>
<p><span style="font-weight: 400;">It’s obvious ChachaDDoS shares code with Xor.DDoS for its persistence mechanism. But is it from the same author or did the ChachaDDoS authors simply steal it? ChachaDDoS got our attention because it was caught on VestaCP instances, but the existence of binaries for multiple architectures suggests that other devices, including embedded devices, are targeted by this threat.</span></p>
<p><span style="font-weight: 400;">This incident is also a reminder that just because software is open source, it is not necessarily 100% safe. Malware can still make its way in. The malicious credential-stealing code was right there, for everyone to see on GitHub, for multiple months before it was spotted. We do agree it does help find vulnerabilities — post-mortem in this case — but it doesn’t mean we should blindly trust a product simply on the basis that it is open source.</span></p>
<p><span style="font-weight: 400;">ESET products detect this threat as Linux/Xorddos.Q, Linux/Xorddos.R and Linux/ChachaDDoS.</span></p>
<p>Thanks to Hugo Porcher for his help in this analysis and write-up.</p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3><span style="font-weight: 400;">First stage</span></h3>

<table id="tablepress-597" class="tablepress tablepress-id-597">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Hash (SHA-1)</th><th class="column-2">ESET detection name</th><th class="column-3">Arch</th><th class="column-4">Second stage URLs</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><code>bd5d0093bba318a77fd4e24b34ced85348e43960</code></td><td class="column-2">Linux/Xorddos.Q</td><td class="column-3">x86_64</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><code>0413f832d8161187172aef7a769586515f969479</code></td><td class="column-2">Linux/Xorddos.R</td><td class="column-3">x86_64</td><td class="column-4">hxxp://zxcvbmnnfjjfwq.com:8852/RTEGFN01<br />
hxxp://efbthmoiuykmkjkjgt.com:8852/RTEGFN01</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><code>0328fa49058e7c5a63b836026925385aac76b221</code></td><td class="column-2">Linux/ChachaDDoS.B</td><td class="column-3">mips</td><td class="column-4">hxxp://9fdmasaxsssaqrk.com:8852/YTRFDA<br />
hxxp://10afdmasaxsssaqrk.com:8852/YTRFDA<br />
</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><code>334ad99a11a0c9dd29171a81821be7e3f3848305</code></td><td class="column-2">Linux/ChachaDDoS.B</td><td class="column-3">mips</td><td class="column-4">hxxp://193.201.224.238:8852/DAAADF</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><code>4e46630b98f0a920cf983a3d3833f2ed44fa4751</code></td><td class="column-2">Linux/ChachaDDoS.B</td><td class="column-3">arm</td><td class="column-4">hxxp://193.201.224.233:8852/DAAADF</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><code>3caf7036aa2de31e296beae40f47e082a96254cc</code></td><td class="column-2">Linux/ChachaDDoS.B</td><td class="column-3">mips</td><td class="column-4">hxxp://8masaxsssaqrk.com:8852/JHKDSAG<br />
hxxp://7mfsdfasdmkgmrk.com:8852/JHKDSAG<br />
</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><code>0ab55b573703e20ac99492e5954c1db91b83aa55</code></td><td class="column-2">Linux/ChachaDDoS.B</td><td class="column-3">arm</td><td class="column-4">hxxp://193.201.224.202:8852/ASDFREM<br />
hxxp://193.201.224.202:8852/ASDFRE<br />
</td>
</tr>
</tbody>
</table>


<table id="tablepress-598" class="tablepress tablepress-id-598">
<thead>
<tr class="row-1 odd">
	<th class="column-1">ChaCha key</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">fa408855304ca199f680b494b69ef473dd9c5a5e0e78baa444048b82a8bd97a9</td>
</tr>
</tbody>
</table>

<h3><span style="font-weight: 400;">Second stage</span></h3>

<table id="tablepress-599" class="tablepress tablepress-id-599">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Hash (SHA-1)</th><th class="column-2">ESET detection name</th><th class="column-3">Arch</th><th class="column-4">Second stage URLs</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><code>1b6a8ab3337fc811e790593aa059bc41710f3651</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">powerpc64</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><code>4ca3b06c76f369565689e1d6bd2ffb3cc952925d</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">arm</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><code>6a536b3d58f16bbf4333da7af492289a30709e77</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">powerpc</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><code>72651454d59c2d9e0afdd927ab6eb5aea18879ce</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">i486</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><code>a42e131efc5697a7db70fc5f166bae8dfb3afde2</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">s390x</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><code>abea9166dad7febce8995215f09794f6b71da83b</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">arm64</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><code>bb999f0096ba495889171ad2d5388f36a18125f4</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">x86_64</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><code>d3af11dbfc5f03fd9c10ac73ec4a1cfb791e8225</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">mips64</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><code>d7109d4dfb862eb9f924d88a3af9727e4d21fd66</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">mips</td><td class="column-4">hxxp://193.201.224.238:8852/RTEGFN01/RTEGFN01.dat</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><code>56ac7c2c89350924e55ea89a1d9119a42902596e</code></td><td class="column-2">Linux/ChachaDDoS.A</td><td class="column-3">mips</td><td class="column-4">hxxp://193.201.224.238:8852/DAAADF/DAAADF.dat</td>
</tr>
</tbody>
</table>


<table id="tablepress-600" class="tablepress tablepress-id-600">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Chacha key</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f</td>
</tr>
</tbody>
</table>

<h2><span style="font-weight: 400;">References</span></h2>
<ol>
<li style="font-weight: 400;"><a href="http://blog.malwaremustdie.org/2014/09/mmd-0028-2014-fuzzy-reversing-new-china.html" target="_blank" rel="noopener"><span style="font-weight: 400;">http://blog.malwaremustdie.org/2014/09/mmd-0028-2014-fuzzy-reversing-new-china.html</span></a></li>
<li style="font-weight: 400;"><a href="https://www.fireeye.com/blog/threat-research/2015/02/anatomy_of_a_brutef.html" target="_blank" rel="noopener"><span style="font-weight: 400;">https://www.fireeye.com/blog/threat-research/2015/02/anatomy_of_a_brutef.html</span></a></li>
<li style="font-weight: 400;"><a href="https://otx.alienvault.com/indicator/file/0177aa7826f5239cb53613cc90e247b710800ddf" target="_blank" rel="noopener"><span style="font-weight: 400;">https://otx.alienvault.com/indicator/file/0177aa7826f5239cb53613cc90e247b710800ddf</span></a></li>
<li style="font-weight: 400;"><a href="https://forum.vestacp.com/viewtopic.php?f=10&amp;t=16556" target="_blank" rel="noopener"><span style="font-weight: 400;">https://forum.vestacp.com/viewtopic.php?f=10&amp;t=16556</span></a></li>
<li style="font-weight: 400;"><a href="https://carolinafernandez.github.io/security/2015/03/16/IptabLeX-XOR-DDoS" target="_blank" rel="noopener"><span style="font-weight: 400;">https://carolinafernandez.github.io/security/2015/03/16/IptabLeX-XOR-DDoS</span></a></li>
<li style="font-weight: 400;"><a href="https://blog.checkpoint.com/wp-content/uploads/2015/10/sb-report-threat-intelligence-groundhog.pdf" target="_blank" rel="noopener"><span style="font-weight: 400;">https://blog.checkpoint.com/wp-content/uploads/2015/10/sb-report-threat-intelligence-groundhog.pdf</span></a></li>
<li style="font-weight: 400;"><a href="https://grehack.fr/data/2017/slides/GreHack17_Down_The_Rabbit_Hole:_How_Hackers_Exploit_Weak_SSH_Credentials_To_Build_DDoS_Botnets.pdf" target="_blank" rel="noopener"><span style="font-weight: 400;">https://grehack.fr/data/2017/slides/GreHack17_Down_The_Rabbit_Hole:_How_Hackers_Exploit_Weak_SSH_Credentials_To_Build_DDoS_Botnets.pdf</span></a></li>
</ol>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2018-10-18 10:54:01">18 Oct 2018 - 10:54AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="VestaCP compromised in a new supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="VestaCP compromised in a new supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="VestaCP compromised in a new supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="VestaCP compromised in a new supply&#8209;chain attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F10%2F18%2Fnew-linux-chachaddos-malware-distributed-servers-vestacp-installed%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F10%2F18%2Fnew-linux-chachaddos-malware-distributed-servers-vestacp-installed%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F10%2F18%2Fnew-linux-chachaddos-malware-distributed-servers-vestacp-installed%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"117780 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=117780","disqusShortname":"welivesecurity","disqusTitle":"VestaCP compromised in a new supply\u2011chain attack","disqusUrl":"https:\/\/www.welivesecurity.com\/2018\/10\/18\/new-linux-chachaddos-malware-distributed-servers-vestacp-installed\/","postId":"117780"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>