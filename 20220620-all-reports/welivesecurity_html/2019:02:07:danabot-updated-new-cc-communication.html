<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>DanaBot updated with new C&#038;C communication | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have found new versions of the DanaBot Trojan, which now features a new C&amp;C protocol and modifications to architecture and campaign IDs."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/02/07/danabot-updated-new-cc-communication/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="DanaBot updated with new C&#038;C communication | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have found new versions of the DanaBot Trojan, which now features a new C&amp;C protocol and modifications to architecture and campaign IDs." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/02/07/danabot-updated-new-cc-communication/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-02-07T11:00:47+00:00" />
<meta property="article:modified_time" content="2019-02-08T04:45:04+00:00" />
<meta property="og:updated_time" content="2019-02-08T04:45:04+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/02/trojan-horse-707804_1920-e1549487637988.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/02/trojan-horse-707804_1920-e1549487637988.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta property="og:image:alt" content="DanaBot Trojan" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have found new versions of the DanaBot Trojan, which now features a new C&amp;C protocol and modifications to architecture and campaign IDs." />
<meta name="twitter:title" content="DanaBot updated with new C&#038;C communication | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/02/trojan-horse-707804_1920-e1549487637988.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2019/02/08/trojan-danabot-e-atualizado-com-nova-comunicacao-cc/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/02/07/danabot-mis-a-jour/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/02/07/danabot-updated-new-cc-communication/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/02/07/troyano-danabot-actualiza-nueva-comunicacion-cc/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/02/07/danabot-trojaner-aktualisiert-nun-mit-verschluesselter-cc-kommunikation/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2019/02/08/trojan-danabot-e-atualizado-com-nova-comunicacao-cc/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/02/07/danabot-mis-a-jour/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/02/07/troyano-danabot-actualiza-nueva-comunicacion-cc/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/02/07/danabot-trojaner-aktualisiert-nun-mit-verschluesselter-cc-kommunikation/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2019/02/08/trojan-danabot-e-atualizado-com-nova-comunicacao-cc/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/02/07/danabot-mis-a-jour/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/02/07/troyano-danabot-actualiza-nueva-comunicacion-cc/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/02/07/danabot-trojaner-aktualisiert-nun-mit-verschluesselter-cc-kommunikation/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/02/trojan-horse-707804_1920_.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>DanaBot updated with new C&#038;C communication</h1>
<div class="excerpt">ESET researchers have discovered new versions of the DanaBot Trojan, updated with a more complicated protocol for C&C communication and slight modifications to architecture and campaign IDs</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-02-07 12:00:47">7 Feb 2019 - 12:00PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F02%2F07%2Fdanabot-updated-new-cc-communication%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F02%2F07%2Fdanabot-updated-new-cc-communication%2F&text=DanaBot updated with new C&#038;C communication%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F02%2F07%2Fdanabot-updated-new-cc-communication%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers have discovered new versions of the DanaBot Trojan, updated with a more complicated protocol for C&#038;C communication and slight modifications to architecture and campaign IDs</p>
                            </div>

                            <p>The fast-evolving, modular Trojan <a href="https://www.welivesecurity.com/?s=danabot" target="_blank" rel="noopener">DanaBot</a> has undergone further changes, with the latest version featuring an entirely new communication protocol. The protocol, introduced to DanaBot at the end of January 2019, adds several layers of encryption to DanaBot’s <a href="https://www.virusradar.com/en/glossary/command-and-control-server" target="_blank" rel="noopener">C&amp;C</a> communication.</p>
<p>Besides the changes in communication, DanaBot’s architecture and campaign IDs have also been modified.</p>
<h2>The evolution of DanaBot</h2>
<p>After being <a href="https://www.proofpoint.com/us/threat-insight/post/danabot-new-banking-trojan-surfaces-down-under-0" target="_blank" rel="noopener">discovered</a> in May 2018 as part of Australia-targeted spam campaigns, DanaBot has had an eventful time since, appearing in malspam campaigns in Poland, <a href="https://www.welivesecurity.com/2018/09/21/danabot-targeting-europe-adds-new-features/" target="_blank" rel="noopener">Italy, Germany, Austria and Ukraine</a>, as well as in <a href="https://www.proofpoint.com/us/threat-insight/post/danabot-gains-popularity-and-targets-us-organizations-large-campaigns" target="_blank" rel="noopener">the United States</a>. The European campaigns have seen the Trojan expanding its capabilities with new plugins and <a href="https://www.welivesecurity.com/2018/12/06/DanaBot-evolves-beyond-banking-trojan-new-spam/" target="_blank" rel="noopener">spam-sending features.</a></p>
<p>In ESET telemetry on January 25, 2019, we noticed unusual DanaBot-related executables. Upon further inspection, these binaries were, indeed, revealed to be DanaBot variants, but using a different communication protocol to communicate with the C&amp;C server. Starting January 26, 2019, DanaBot operators stopped building binaries with the old protocol.</p>
<p>At the time of writing, the new version is being distributed under two scenarios:</p>
<ul>
<li>As “updates” delivered to existing DanaBot victims</li>
<li>Via malspam in Poland</li>
</ul>
<h2>The new communication protocol</h2>
<p>In the communication protocol used before January 25, packets were not encrypted in any way, as seen in Figure 1.</p>
<div id="attachment_121931" style="width: 665px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/02/Figure1a.png"><img class="wp-image-121931 size-full" src="/wp-content/uploads/2019/02/Figure1a.png" alt="" width="655" height="228" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure1a.png 655w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure1a-300x104.png 300w" sizes="(max-width: 655px) 100vw, 655px" /></a><p class="wp-caption-text">Figure 1 – Packet capture showing the old protocol with data in plaintext</p></div>
<p>Following the latest changes, DanaBot uses the AES and RSA encryption algorithms in its C&amp;C communication. The new communication protocol is complicated, with several encryption layers being used, as seen in Figure 2.</p>
<div id="attachment_121932" style="width: 665px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/02/Figure2a.png"><img class="wp-image-121932" src="/wp-content/uploads/2019/02/Figure2a-842x1024.png" alt="" width="655" height="797" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure2a-842x1024.png 842w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure2a-247x300.png 247w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure2a-768x934.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure2a.png 1500w" sizes="(max-width: 655px) 100vw, 655px" /></a><p class="wp-caption-text">Figure 2 – A diagram of DanaBot’s new communication protocol</p></div>
<p>These changes break existing network-based signatures and make it more difficult to write new rules for Intrusion Detection and Prevention Systems. Also, without access to the corresponding RSA keys, it is impossible to decode sent or received packets; thus PCAP files from cloud-based analysis systems (such as <a href="https://any.run/" target="_blank" rel="noopener">ANY.RUN</a>) become unusable for researchers.</p>
<div id="attachment_121928" style="width: 668px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/02/Figure3a.png"><img class="wp-image-121928 size-full" src="/wp-content/uploads/2019/02/Figure3a.png" alt="" width="658" height="475" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure3a.png 658w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure3a-300x217.png 300w" sizes="(max-width: 658px) 100vw, 658px" /></a><p class="wp-caption-text">Figure 3 – Packet capture with the new communication protocol in place</p></div>
<p>Each packet sent by the client has a 24 (0x18)-byte header:</p>

<table id="tablepress-642" class="tablepress tablepress-id-642">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Offset</th><th class="column-2">Size (bytes)</th><th class="column-3">Meaning</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">0x0</td><td class="column-2">0x8</td><td class="column-3">Size of the data after this header</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">0x8</td><td class="column-2">0x8</td><td class="column-3">Random value</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">0x10</td><td class="column-2">0x8</td><td class="column-3">Sum of first two fields</td>
</tr>
</tbody>
</table>

<p>For each packet, the header is followed by AES-encrypted packet data, then a 4-byte value indicating AES padding size, and finally the RSA-encrypted AES key. Each packet is encrypted with a different AES key.</p>
<p>Server responses use the same format. Unlike in previous versions, packet data in server responses does not follow any specific layout (with some exceptions).</p>
<h3>Packet data layout</h3>
<p>Former packet data layout was detailed by <a href="https://www.proofpoint.com/us/threat-insight/post/danabot-gains-popularity-and-targets-us-organizations-large-campaigns" target="_blank" rel="noopener">Proofpoint</a> in October 2018. In the latest version of DanaBot, the layout is slightly modified, as seen in Figure 4.</p>
<div id="attachment_121929" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/02/Figure4a.png"><img class="wp-image-121929 size-large" src="/wp-content/uploads/2019/02/Figure4a-1024x699.png" alt="" width="1024" height="699" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure4a-1024x699.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure4a-300x205.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure4a-768x524.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure4a-151x103.png 151w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure4a-97x65.png 97w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure4a.png 1169w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text">Figure 4 – Comparison of packet data layout in DanaBot’s previous and latest version</p></div>
<h2>Changes in DanaBot architecture</h2>
<p>Besides the changed communication protocol, DanaBot has also undergone some changes in architecture. The previous versions of DanaBot included a component that downloaded and executed the main module. The main module then downloaded and executed plugins and configurations.</p>
<p>The latest version shifts both these responsibilities to a new loader component, which is used to download all plugins along with the main module. Persistence is achieved by registering the loader component as a service.</p>
<div id="attachment_121930" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/02/Figure5a.png"><img class="wp-image-121930 size-large" src="/wp-content/uploads/2019/02/Figure5a-1024x455.png" alt="" width="1024" height="455" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure5a-1024x455.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure5a-300x133.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure5a-768x342.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/02/Figure5a.png 1500w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text">Figure 5 – Comparison of architecture in DanaBot’s previous and latest version</p></div>
<h2>Commands</h2>
<p>According to our analysis, the loader component uses the following commands:</p>
<ul>
<li>0x12C &#8211; Hello. First command sent by client to server</li>
<li>0x12D &#8211; Download 32/64-bit launcher component</li>
<li>0x12E &#8211; Request list of plugins and configuration files</li>
<li>0x12F &#8211; Download plugin/configuration files</li>
</ul>
<p>Downloaded plugins and configuration files are encrypted using an AES key derived from the Client ID. In addition to that, plugins are compressed in ZIP format using LZMA compression, whereas configuration files are compressed using zlib.</p>
<p>Commands with ID numbers 0x130 &#8211; 0x134 are sent by the main module:</p>
<ul>
<li>0x130 &#8211; Upload collected information to C&amp;C server (e.g., screenshot of a victim’s computer; system information)</li>
<li>0x131 &#8211; Upload collected information to C&amp;C server (e.g., list of files on the victim’s hard disk)</li>
<li>0x132 &#8211; Ask C&amp;C server for further commands; there are around 30 available commands typical of backdoors, including launching plugins, gathering detailed system information and modifying files on client system</li>
<li>0x133 – Update C&amp;C server list via Tor proxy</li>
<li>0x134 &#8211; Exact purpose unknown; most likely used for communication between plugins and C&amp;C</li>
</ul>
<h2>Changes in campaign IDs</h2>
<p>Previous research has suggested that DanaBot is distributed under various “affiliate” or “campaign” IDs.</p>
<p>In the previous version of DanaBot, almost <a href="https://asert.arbornetworks.com/danabots-travels-a-global-perspective/" target="_blank" rel="noopener">20 different campaign IDs</a> were used. In the latest version, campaign IDs have changed slightly. As of February 5, 2019, we are seeing the following IDs in the wild:</p>
<ul>
<li><strong>ID=2</strong> appears to be a test version, serving a limited number of configuration files and no webinjects</li>
<li><strong>ID=3</strong> is being actively spread, targeting users in both Poland and Italy, serving all configuration files and webinjects for both Polish and Italian targets</li>
<li><strong>ID=5</strong> serves configuration files for Australian targets</li>
<li><strong>ID=7 </strong>is being spread only in Poland, serving webinjects for Polish targets</li>
<li><strong>ID=9</strong> appears to be another test version, with limited spread and no specific targeting, serving a limited number of configuration files and no webinjects</li>
</ul>
<h2>Conclusion</h2>
<p>In 2018, we observed DanaBot expanding in both <a href="https://www.welivesecurity.com/2018/09/21/danabot-targeting-europe-adds-new-features/" target="_blank" rel="noopener">distribution</a> and <a href="https://www.welivesecurity.com/2018/12/06/danabot-evolves-beyond-banking-trojan-new-spam/" target="_blank" rel="noopener">functionality</a>. The beginning of 2019 has seen the Trojan undergo “internal” changes, indicating active development by its authors. The latest updates suggest the authors are making an effort to evade detection at the network level, and possibly paying attention to published research and making changes to stay ahead of defenders.</p>
<p>ESET systems detect and block all DanaBot components and plugins under detection names listed in the IoCs section.</p>
<p><em><strong>This research was carried out by Kaspars Osis, Tomáš Procházka and Michal Kolář.</strong></em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>C&amp;C servers used by the new version of DanaBot</h3>
<ul>
<li>84.54.37[.]102</li>
<li>89.144.25[.]243</li>
<li>89.144.25[.]104</li>
<li>178.209.51[.]211</li>
<li>185.92.222[.]238</li>
<li>192.71.249[.]51</li>
</ul>
<h3>Webinject and redirect servers</h3>
<ul>
<li>47.74.249[.]106</li>
<li>95.179.227[.]160</li>
<li>185.158.249[.]144</li>
</ul>
<h3>Example hashes</h3>
<p>Note that since new builds of DanaBot’s components are released regularly, we provide just a sampling of hashes.</p>

<table id="tablepress-643" class="tablepress tablepress-id-643">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Component</th><th class="column-2">SHA-1</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Dropper</td><td class="column-2">98C70361EA611BA33EE3A79816A88B2500ED7844</td><td class="column-3">Win32/TrojanDropper.Danabot.O</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Loader (x86), campaign ID=3</td><td class="column-2">0DF17562844B7A0A0170C9830921C3442D59C73C</td><td class="column-3">Win32/Spy.Danabot.L</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Loader (x64), campaign ID=3</td><td class="column-2">B816E90E9B71C85539EA3BB897E4F234A0422F85</td><td class="column-3">Win64/Spy.Danabot.G</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Loader (x86), campaign ID=9</td><td class="column-2">5F085B19657D2511A89F3172B7887CE29FC70792</td><td class="column-3">Win32/Spy.Danabot.I</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Loader (x64), campaign ID=9</td><td class="column-2">4075375A08273E65C223116ECD2CEF903BA97B1E</td><td class="column-3">Win64/Spy.Danabot.F</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Main module (x86)</td><td class="column-2">28139782562B0E4CAB7F7885ECA75DFCA5E1D570</td><td class="column-3">Win32/Spy.Danabot.K</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Main module (x64)</td><td class="column-2">B1FF7285B49F36FE8D65E7B896FCCDB1618EAA4B</td><td class="column-3">Win64/Spy.Danabot.C</td>
</tr>
</tbody>
</table>

<p><strong>Plugins</strong></p>

<table id="tablepress-644" class="tablepress tablepress-id-644">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Plugin</th><th class="column-2">SHA-1</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">RDPWrap</td><td class="column-2">890B5473B419057F89802E0B6DA011B315F3EF94</td><td class="column-3">Win32/Spy.Danabot.H </td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Stealer (x86)</td><td class="column-2">E50A03D12DDAC6EA626718286650B9BB858B2E69</td><td class="column-3">Win32/Spy.Danabot.C </td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Stealer (x64)</td><td class="column-2">9B0EC454401023DF6D3D4903735301BA669AADD1</td><td class="column-3">Win64/Spy.Danabot.E </td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Sniffer</td><td class="column-2">DBFD8553C66275694FC4B32F9DF16ADEA74145E6</td><td class="column-3">Win32/Spy.Danabot.B </td>
</tr>
<tr class="row-6 even">
	<td class="column-1">VNC</td><td class="column-2">E0880DCFCB1724790DFEB7DFE01A5D54B33D80B6</td><td class="column-3">Win32/Spy.Danabot.D </td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">TOR</td><td class="column-2">73A5B0BEE8C9FB4703A206608ED277A06AA1E384</td><td class="column-3">Win32/Spy.Danabot.G </td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-02-07 12:00:47">7 Feb 2019 - 12:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="DanaBot updated with new C&#038;C communication">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="DanaBot updated with new C&#038;C communication">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="DanaBot updated with new C&#038;C communication">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="DanaBot updated with new C&#038;C communication">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F02%2F07%2Fdanabot-updated-new-cc-communication%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F02%2F07%2Fdanabot-updated-new-cc-communication%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F02%2F07%2Fdanabot-updated-new-cc-communication%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"121916 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=121916","disqusShortname":"welivesecurity","disqusTitle":"DanaBot updated with new C&C communication","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/02\/07\/danabot-updated-new-cc-communication\/","postId":"121916"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>