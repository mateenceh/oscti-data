<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Matthieu Faou',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Turla LightNeuron: An email too far | WeLiveSecurity</title>
<meta name="description" content="ESET researchers detail the modus operandi of LightNeuron, a Microsoft Exchange backdoor that leverages a previously unseen persistence mechanism."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/05/07/turla-lightneuron-email-too-far/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Turla LightNeuron: An email too far | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers detail the modus operandi of LightNeuron, a Microsoft Exchange backdoor that leverages a previously unseen persistence mechanism." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/05/07/turla-lightneuron-email-too-far/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-05-07T12:00:21+00:00" />
<meta property="article:modified_time" content="2019-05-17T09:29:06+00:00" />
<meta property="og:updated_time" content="2019-05-17T09:29:06+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/05/shutterstock_1254740023-1000-resized.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/05/shutterstock_1254740023-1000-resized.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta property="og:image:alt" content="LightNeuron" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers detail the modus operandi of LightNeuron, a Microsoft Exchange backdoor that leverages a previously unseen persistence mechanism." />
<meta name="twitter:title" content="Turla LightNeuron: An email too far | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/05/shutterstock_1254740023-1000-resized.jpg" />
<meta name="twitter:creator" content="@matthieu_faou" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-github-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2019/05/08/lightneuron-backdoor-do-grupo-de-espionagem-turla-se-esconde-em-documentos-pdf-e-jpeg/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/05/08/turla-lightneuron/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/05/07/turla-lightneuron-email-too-far/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/05/06/lightneuron-backdoor-turla-esconde-pdf-jpeg/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/05/07/turla-lightneuron-exchange-server/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2019/05/08/lightneuron-backdoor-do-grupo-de-espionagem-turla-se-esconde-em-documentos-pdf-e-jpeg/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/05/08/turla-lightneuron/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/05/06/lightneuron-backdoor-turla-esconde-pdf-jpeg/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/05/07/turla-lightneuron-exchange-server/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2019/05/08/lightneuron-backdoor-do-grupo-de-espionagem-turla-se-esconde-em-documentos-pdf-e-jpeg/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/05/08/turla-lightneuron/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/05/06/lightneuron-backdoor-turla-esconde-pdf-jpeg/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/05/07/turla-lightneuron-exchange-server/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/05/shutterstock_1254740023-1920-resized.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Turla LightNeuron: An email too far</h1>
<div class="excerpt">ESET research uncovers Microsoft Exchange malware remotely controlled via steganographic PDF and JPG email attachments</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/02/Matthieu-Faou-222x179.jpg" alt="Matthieu Faou">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-05-07 14:00:21">7 May 2019 - 02:00PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F07%2Fturla-lightneuron-email-too-far%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F07%2Fturla-lightneuron-email-too-far%2F&text=Turla LightNeuron: An email too far%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F07%2Fturla-lightneuron-email-too-far%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET research uncovers Microsoft Exchange malware remotely controlled via steganographic PDF and JPG email attachments</p>
                            </div>

                            <p>Due to security improvements in operating systems, rootkit usage has been in constant decline for several years. As such, malware developers – especially those working in espionage groups – have been busy developing new stealthy userland malware.</p>
<p>Recently, ESET researchers have investigated a sophisticated backdoor used by the infamous espionage group Turla, also known as Snake. This backdoor, dubbed <a href="https://securelist.com/apt-trends-report-q2-2018/86487/" target="_blank" rel="noopener">LightNeuron</a>, has been specifically targeting Microsoft Exchange mail servers since at least 2014. Although no samples were available for analysis, code artefacts in the Windows version lead us to believe that a Linux variant exists.</p>
<div class="nwg-promo document clearfix">
            <div class="text">
                <p>
                     <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" target="_blank">Turla LightNeuron: One email away from remote code execution</a>
                </p>
                <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" class="my-btn document" target="_blank">
                    Download Research Paper
                </a>
            </div>
            <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" target="_blank" class="no-fancy download">
                <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/pdf-document-big.png" alt="" class="document">
            </a>
        </div>
<h1>Victimology</h1>
<p>During the course of our investigation, we were able to identify at least three different victim organizations, as shown in Figure 1.</p>
<div id="attachment_125169" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/figure1-wm.png"><img class="wp-image-125169 size-large" src="/wp-content/uploads/2019/05/figure1-wm-1024x605.png" alt="" width="1024" height="605" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/05/figure1-wm-1024x605.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure1-wm-300x177.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure1-wm-768x454.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure1-wm.png 1530w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text">Figure 1 – Map of known LightNeuron victims</p></div>
<p>Two of the victims – a ministry of foreign affairs and a regional diplomatic organization – are in line with <a href="https://www.welivesecurity.com/2018/08/22/turla-unique-outlook-backdoor/" target="_blank" rel="noopener">recent</a> Turla campaigns we have analyzed.</p>
<p>As we noticed the victim in Brazil thanks to a sample uploaded to the popular multi-scanner <em>VirusTotal</em>, we were not able to determine the nature of the victim organization.</p>
<h1>Attribution to Turla</h1>
<p>We believe with high confidence that Turla operates LightNeuron. The following artefacts, collected during our investigation, back this:</p>
<ul>
<li>On one compromised Exchange server:
<ul>
<li>a PowerShell script containing malware previously attributed to Turla was dropped 44 minutes before a PowerShell script used to install LightNeuron, and</li>
<li>both scripts were located in C:\windows\system32.</li>
</ul>
</li>
<li>The script used to install LightNeuron has a filename – <span style="font-family: courier new, courier, monospace;">msinp.ps1</span> – that looks like typical filenames used by Turla.</li>
<li>On another compromised server, IntelliAdmin – a remote administration tool, packed with a packer used only by Turla – was dropped by LightNeuron.</li>
<li>For each LightNeuron attack, there were several other instances of Turla malware on the same network.</li>
<li>The email address used by the attackers was registered at GMX and was impersonating an employee of the targeted organization. The same provider was used for the <a href="https://www.welivesecurity.com/wp-content/uploads/2018/08/Eset-Turla-Outlook-Backdoor.pdf" target="_blank" rel="noopener">Outlook backdoor</a> and for an undocumented PowerShell backdoor we named PowerStallion.</li>
</ul>
<p>Further, in an earlier <a href="https://securelist.com/apt-trends-report-q2-2018/86487/" target="_blank" rel="noopener">APT trends report</a>, Kaspersky Labs researchers attributed LightNeuron with medium confidence to Turla.</p>
<h1>Operator activity</h1>
<p>While analyzing a compromised asset, we were able to retrace part of the attackers’ activities. In particular, we were able to map the working hours of the operators, using the time at which the compromised Exchange server received emails containing commands for the backdoor.</p>
<p>Our first observation is that the activity aligns well with a typical 9-to-5 workday in the UTC+3 time zone, as shown in Figure 2.</p>
<div id="attachment_125170" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/figure2-wm.png"><img class="wp-image-125170 size-large" src="/wp-content/uploads/2019/05/figure2-wm-1024x500.png" alt="" width="1024" height="500" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/05/figure2-wm-1024x500.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure2-wm-300x147.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure2-wm-768x375.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure2-wm.png 1541w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text">Figure 2 – LightNeuron operators’ working hours</p></div>
<p>Our second observation is that no activity was observed between December 28, 2018 and January 14, 2019, while previously and afterwards, the attackers sent several emails per week. This break in activities corresponds to holidays around the Eastern Orthodox Christmas.</p>
<p>Even if it is not sufficient for a strong attribution, you can correlate these two observations with other elements you might have at your disposal.</p>
<h1>Main characteristics</h1>
<p>LightNeuron is, to our knowledge, the first malware specifically targeting Microsoft Exchange email servers. It uses a persistence technique never before seen: a <a href="https://docs.microsoft.com/en-us/exchange/transport-agents-exchange-2013-help" target="_blank" rel="noopener">Transport Agent</a>. In the mail server architecture, it operates at the same level of trust as security products such as spam filters. Figure 3 summarizes how LightNeuron operates.</p>
<div id="attachment_125171" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/figure3-wm.png"><img class="wp-image-125171 size-large" src="/wp-content/uploads/2019/05/figure3-wm-1024x618.png" alt="" width="1024" height="618" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/05/figure3-wm-1024x618.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure3-wm-300x181.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure3-wm-768x464.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure3-wm.png 1373w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text">Figure 3 – LightNeuron Transport Agent</p></div>
<p>By leveraging the Transport Agent accesses, LightNeuron is able to:</p>
<ul>
<li>Read and modify any email going through the mail server.</li>
<li>Compose and send new emails.</li>
<li>Block any email. The original recipient will not receive the email.</li>
</ul>
<p>A flexible set of XML rules drives these functions, as shown in Figure 4.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bcf2ece8866347891" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;class name="zip" metric="30" id="1" dllName="ZipMe" type="dll" include="1"&gt;
    &lt;rule metric="10" id="1" include="1"&gt;
        &lt;and&gt;
            &lt;or&gt;
                &lt;To condition="cnt" value="email1@[redacted]" /&gt;
                &lt;From condition="cnt" value="email1@[redacted]" /&gt;
                &lt;To condition="cnt" value="email2@[redacted]" /&gt;
                &lt;From condition="cnt" value="email2@[redacted]" /&gt;
                [...]
            &lt;/or&gt;
            &lt;and&gt;
                &lt;To condition="!cnt" value="email3@[redacted]" /&gt;
                &lt;From condition="!cnt" value="email3@[redacted]" /&gt;
               [...]
            &lt;/and&gt;
        &lt;/and&gt;
    &lt;/rule&gt;
&lt;/class&gt;
&lt;class name="command" metric="40" id="1" dllName="ZipMe" type="dll" include="1"&gt;
    &lt;rule metric="10" id="1" include="1"&gt;
        &lt;attachment_Content-Type condition="cnt" value="image/jpeg" /&gt;
    &lt;/rule&gt;
&lt;/class&gt;
 
log:logHandler
zip:zipHandler
changeSubject:changeSubjectHandler
changeBody:changeBodyHandler
create:createHandler
command:commandHandler
block:blockHandler
replace:replaceHandler
stat:statHandler</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-2">2</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-4">4</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-6">6</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-8">8</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-10">10</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-12">12</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-14">14</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-16">16</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-18">18</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-20">20</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-22">22</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-24">24</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-26">26</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-28">28</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-30">30</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bcf2ece8866347891-32">32</div><div class="crayon-num" data-line="crayon-60581bcf2ece8866347891-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bcf2ece8866347891-1"><span class="crayon-o">&lt;</span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-r">name</span><span class="crayon-o">=</span><span class="crayon-s">"zip"</span><span class="crayon-h"> </span><span class="crayon-e ">metric</span><span class="crayon-o">=</span><span class="crayon-s">"30"</span><span class="crayon-h"> </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-e ">dllName</span><span class="crayon-o">=</span><span class="crayon-s">"ZipMe"</span><span class="crayon-h"> </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"dll"</span><span class="crayon-h"> </span><span class="crayon-e ">include</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">rule </span><span class="crayon-e ">metric</span><span class="crayon-o">=</span><span class="crayon-s">"10"</span><span class="crayon-h"> </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-e ">include</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-st">and</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-st">or</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-st">To</span><span class="crayon-h"> </span><span class="crayon-e ">condition</span><span class="crayon-o">=</span><span class="crayon-s">"cnt"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s">"email1@[redacted]"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">From </span><span class="crayon-e ">condition</span><span class="crayon-o">=</span><span class="crayon-s">"cnt"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s">"email1@[redacted]"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-st">To</span><span class="crayon-h"> </span><span class="crayon-e ">condition</span><span class="crayon-o">=</span><span class="crayon-s">"cnt"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s">"email2@[redacted]"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">From </span><span class="crayon-e ">condition</span><span class="crayon-o">=</span><span class="crayon-s">"cnt"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s">"email2@[redacted]"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-st">or</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-st">and</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-st">To</span><span class="crayon-h"> </span><span class="crayon-e ">condition</span><span class="crayon-o">=</span><span class="crayon-s">"!cnt"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s">"email3@[redacted]"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">From </span><span class="crayon-e ">condition</span><span class="crayon-o">=</span><span class="crayon-s">"!cnt"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s">"email3@[redacted]"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-st">and</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-st">and</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">rule</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-18"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-t">class</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-19"><span class="crayon-o">&lt;</span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-r">name</span><span class="crayon-o">=</span><span class="crayon-s">"command"</span><span class="crayon-h"> </span><span class="crayon-e ">metric</span><span class="crayon-o">=</span><span class="crayon-s">"40"</span><span class="crayon-h"> </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-e ">dllName</span><span class="crayon-o">=</span><span class="crayon-s">"ZipMe"</span><span class="crayon-h"> </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"dll"</span><span class="crayon-h"> </span><span class="crayon-e ">include</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">rule </span><span class="crayon-e ">metric</span><span class="crayon-o">=</span><span class="crayon-s">"10"</span><span class="crayon-h"> </span><span class="crayon-e ">id</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-e ">include</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">attachment_Content</span><span class="crayon-o">-</span><span class="crayon-e">Type </span><span class="crayon-e ">condition</span><span class="crayon-o">=</span><span class="crayon-s">"cnt"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s">"image/jpeg"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">rule</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-23"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-t">class</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-24"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-25"><span class="crayon-v">log</span><span class="crayon-o">:</span><span class="crayon-e">logHandler</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-26"><span class="crayon-v">zip</span><span class="crayon-o">:</span><span class="crayon-e">zipHandler</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-27"><span class="crayon-v">changeSubject</span><span class="crayon-o">:</span><span class="crayon-e">changeSubjectHandler</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-28"><span class="crayon-v">changeBody</span><span class="crayon-o">:</span><span class="crayon-e">changeBodyHandler</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-29"><span class="crayon-v">create</span><span class="crayon-o">:</span><span class="crayon-e">createHandler</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-30"><span class="crayon-v">command</span><span class="crayon-o">:</span><span class="crayon-e">commandHandler</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-31"><span class="crayon-v">block</span><span class="crayon-o">:</span><span class="crayon-e">blockHandler</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bcf2ece8866347891-32"><span class="crayon-v">replace</span><span class="crayon-o">:</span><span class="crayon-e">replaceHandler</span></div><div class="crayon-line" id="crayon-60581bcf2ece8866347891-33"><span class="crayon-v">stat</span><span class="crayon-o">:</span><span class="crayon-v">statHandler</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p><em>Figure 4 – Redacted example of a rule file</em></p>
<p>The email addresses used in these rules are customized for each victim in order to target the most interesting people.</p>
<p>At the end of the rules, there is the list of the handlers implemented by LightNeuron. These functions are used in the rules to process the emails. Table 1 describes the eleven different handlers.</p>

<table id="tablepress-675" class="tablepress tablepress-id-675">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Handler name</th><th class="column-2">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>block</strong></td><td class="column-2">Block the email</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><strong>changeBody</strong></td><td class="column-2">Change the body of the email</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><strong>changeTo</strong></td><td class="column-2">Change the recipient of the email</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong>changeSubject</strong></td><td class="column-2">Change the subject of the email</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><strong>command</strong></td><td class="column-2">Parse the jpg/pdf attachment, decrypt and execute the commands.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><strong>create</strong></td><td class="column-2">Create a new email</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><strong>log</strong></td><td class="column-2">Log email attachment in LOG_OUTPUT</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><strong>replace</strong></td><td class="column-2">Replace the attachment</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><strong>spam</strong></td><td class="column-2">Re-create and re-send the email from the exchange server to bypass the spam filter</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><strong>stat</strong></td><td class="column-2">Log the From, Date, To, and Subject headers in CSV format in STAT_PATH</td>
</tr>
<tr class="row-12 even">
	<td class="column-1"><strong>zip</strong></td><td class="column-2">Encrypt the email with RSA and store it in the path specified by  ZIP_FILE_NAME.</td>
</tr>
</tbody>
</table>

<p><em>Table 1 – Description of the handlers implemented in the DLL</em></p>
<h2>Backdoor</h2>
<p>The <em>command</em> handler is different from the others that perform modifications on the emails. It is actually a backdoor controlled by emails. The commands are hidden in PDF or JPG attachments using steganography.</p>
<p>The attackers just have to send an email containing a specially crafted PDF document or JPG image to any email address of the compromised organization. It allows full control over the Exchange server by using the commands shown in Table 2.</p>

<table id="tablepress-676" class="tablepress tablepress-id-676">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Instruction Code</th><th class="column-2">Description</th><th class="column-3">Argument&nbsp;1</th><th class="column-4">Argument 2</th><th class="column-5">Argument&nbsp;3</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>0x01</strong></td><td class="column-2">Write an executable. Execute it if it is an executable.</td><td class="column-3">Exe path</td><td class="column-4">N/A</td><td class="column-5">File data</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><strong>0x02</strong></td><td class="column-2">Delete a file</td><td class="column-3">File path</td><td class="column-4">N/A</td><td class="column-5">N/A</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><strong>0x03</strong></td><td class="column-2">Exfiltrate a file</td><td class="column-3">File path</td><td class="column-4">Set to “1” to delete the file</td><td class="column-5">N/A</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong>0x04</strong></td><td class="column-2">Execute a process (CreateProcess)</td><td class="column-3">Command line</td><td class="column-4">N/A</td><td class="column-5">N/A</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><strong>0x05</strong></td><td class="column-2">Execute a command line (cmd.exe /c)</td><td class="column-3">Command line</td><td class="column-4">N/A</td><td class="column-5">N/A</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><strong>0x06</strong></td><td class="column-2">Return 0</td><td class="column-3">N/A</td><td class="column-4">N/A</td><td class="column-5">N/A</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><strong>0x07</strong></td><td class="column-2">Disable backdoor for x minutes.</td><td class="column-3">Minutes</td><td class="column-4">N/A</td><td class="column-5">N/A</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><strong>0x09</strong></td><td class="column-2">Exfiltrate a file</td><td class="column-3">File path</td><td class="column-4">Set to “1” to delete the file</td><td class="column-5">N/A</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><strong>0x65</strong></td><td class="column-2">Return 0</td><td class="column-3">N/A</td><td class="column-4">N/A</td><td class="column-5">N/A</td>
</tr>
</tbody>
</table>

<p><em>Table 2 – List of instruction codes</em></p>
<p>Once an email is recognized as a command email, the command is executed and the email is blocked directly on the Exchange server. Thus, it is very stealthy and the original recipient will not be able to view it.</p>
<h2>Steganography</h2>
<p>LightNeuron uses steganography to hide its commands inside a PDF document or a JPG image. Thus, even if the email is intercepted, it might look legitimate, as it contains a valid attachment.</p>
<p>In the case of a PDF, the command data can be anywhere in the document. LightNeuron operators just add a header at the beginning of the PDF to specify the offset at which the data is located, as shown in Figure 5.</p>
<div id="attachment_125172" style="width: 625px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/figure5-wm.png"><img class="wp-image-125172 size-full" src="/wp-content/uploads/2019/05/figure5-wm.png" alt="" width="615" height="153" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/05/figure5-wm.png 615w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure5-wm-300x75.png 300w" sizes="(max-width: 615px) 100vw, 615px" /></a><p class="wp-caption-text">Figure 5 – Representation in hexadecimal of a PDF containing a LightNeuron command container</p></div>
<p>Once this blob of data has been decrypted with AES-256, it reveals a custom structure shown in Figure 6.</p>
<div id="attachment_125175" style="width: 631px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/figure6-wm.png"><img class="wp-image-125175 size-full" src="/wp-content/uploads/2019/05/figure6-wm.png" alt="" width="621" height="67" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/05/figure6-wm.png 621w, https://www.welivesecurity.com/wp-content/uploads/2019/05/figure6-wm-300x32.png 300w" sizes="(max-width: 621px) 100vw, 621px" /></a><p class="wp-caption-text">Figure 6 – Hexadecimal dump of a decrypted command container</p></div>
<p>The most interesting fields are:</p>
<ul>
<li>Offset 0x08, the email address to which the result of the command is sent.</li>
<li>Offset 0x1D, the instruction code. It corresponds to one of the function described above.</li>
<li>Offset 0x25, the first argument. It will be passed to the function represented by the instruction code.</li>
</ul>
<p>If an email containing such a command container, embedded in a JPG or in a PDF, is sent to a server compromised by LightNeuron, a calculator will be executed on the Microsoft Exchange server.</p>
<h1>Cleaning</h1>
<p>The cleaning of LightNeuron is not an easy task. <strong>Simply removing the two malicious files will break Microsoft Exchange</strong>, preventing everybody in the organization from sending and receiving emails. Before actually removing the files, the malicious Transport Agent should be disabled. We encourage you to read the full <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" target="_blank" rel="noopener">white paper</a> before implementing a cleaning mechanism.</p>
<h1>In conclusion</h1>
<p>Over the past years, we have published numerous blogposts and white papers detailing the activities of the Turla group, including <a href="https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf" target="_blank" rel="noopener">man-in-the-middle attacks against</a> adobe.com or <a href="https://www.welivesecurity.com/wp-content/uploads/2018/08/Eset-Turla-Outlook-Backdoor.pdf" target="_blank" rel="noopener">sophisticated userland malware</a>. However, for now it seems that LightNeuron has taken up the mantle of the most advanced known malware in Turla’s arsenal.</p>
<p>By leveraging a previously unseen persistence mechanism, a Microsoft Exchange Transport Agent, LightNeuron allows its operators to stay under the radar for months or years. It allows them to exfiltrate sensitive documents and control other local machines via a C&amp;C mechanism that is very hard to detect and block.</p>
<p>We will continue to track Turla activities closely to help defenders protect their networks.</p>
<p>A full and comprehensive list of Indicators of Compromise (IoCs) and samples can be found in the full <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" target="_blank" rel="noopener">white paper</a> and on <a href="https://github.com/eset/malware-ioc/tree/master/turla#lightneuron-indicators-of-compromise" target="_blank" rel="noopener">GitHub</a>.</p>
<p>For a detailed analysis of the backdoor, refer to our white paper <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" target="_blank" rel="noopener"><em>Turla LightNeuron: One email away from remote code execution</em></a>. <em>For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com.</em></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-05-07 14:00:21">7 May 2019 - 02:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Turla LightNeuron: An email too far">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Turla LightNeuron: An email too far">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Turla LightNeuron: An email too far">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Turla LightNeuron: An email too far">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F07%2Fturla-lightneuron-email-too-far%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F07%2Fturla-lightneuron-email-too-far%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F07%2Fturla-lightneuron-email-too-far%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"125144 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=125144","disqusShortname":"welivesecurity","disqusTitle":"Turla LightNeuron: An email too far","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/05\/07\/turla-lightneuron-email-too-far\/","postId":"125144"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>