<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Cybersecurity',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Wajam: From start&#8209;up to massively&#8209;spread adware | WeLiveSecurity</title>
<meta name="description" content="ESET researchers show how a &quot;social search engine&quot; application has become an adware operation that keeps changing its tactics in a bid to avoid detection."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/06/05/wajam-startup-massively-spread-adware/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Wajam: From start&#8209;up to massively&#8209;spread adware | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers show how a &quot;social search engine&quot; application has become an adware operation that keeps changing its tactics in a bid to avoid detection." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/06/05/wajam-startup-massively-spread-adware/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Cybersecurity" />
<meta property="article:published_time" content="2019-06-05T09:30:41+00:00" />
<meta property="article:modified_time" content="2019-06-05T19:57:14+00:00" />
<meta property="og:updated_time" content="2019-06-05T19:57:14+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/06/Untitled-design-2-1-Copy-e1559574673929.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/06/Untitled-design-2-1-Copy-e1559574673929.jpg" />
<meta property="og:image:width" content="1001" />
<meta property="og:image:height" content="563" />
<meta property="og:image:alt" content="Wajam" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers show how a &quot;social search engine&quot; application has become an adware operation that keeps changing its tactics in a bid to avoid detection." />
<meta name="twitter:title" content="Wajam: From start&#8209;up to massively&#8209;spread adware | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/06/Untitled-design-2-1-Copy-e1559574673929.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/06/05/wajam-startup-logiciel-publicitaire/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/06/05/wajam-startup-massively-spread-adware/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/06/07/wajam-adware-distribuido-manera-masiva-comenzo-como-start-up/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/06/05/wajam-verbreitet-adware/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/06/05/wajam-startup-logiciel-publicitaire/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/06/07/wajam-adware-distribuido-manera-masiva-comenzo-como-start-up/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/06/05/wajam-verbreitet-adware/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/06/05/wajam-startup-logiciel-publicitaire/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/06/07/wajam-adware-distribuido-manera-masiva-comenzo-como-start-up/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/06/05/wajam-verbreitet-adware/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/06/Untitled-design-2-1.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Wajam: From start&#8209;up to massively&#8209;spread adware</h1>
<div class="excerpt">How a Montreal-made "social search engine" application has managed to become widely-spread adware, while escaping consequences</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-06-05 11:30:41">5 Jun 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F05%2Fwajam-startup-massively-spread-adware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F05%2Fwajam-startup-massively-spread-adware%2F&text=Wajam: From start&#8209;up to massively&#8209;spread adware%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F05%2Fwajam-startup-massively-spread-adware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>How a Montreal-made &#8220;social search engine&#8221; application has managed to become widely-spread adware, while escaping consequences</p>
                            </div>

                            <h1>Background</h1>
<p>Wajam Internet Technologies is a start-up founded in December 2008 by Martin-Luc Archambault (a famous entrepreneur in Quebec) and based in Montreal, Canada. The core product of the company is a social search engine application (i.e. it allows searching through the content shared by your contacts on social networks). Figure 1 illustrates an example of what Wajam displays when performing a Google search.</p>
<div id="attachment_126388" style="width: 761px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-1.png"><img class="wp-image-126388" src="/wp-content/uploads/2019/06/Figure-1.png" alt="" width="751" height="516" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-1.png 986w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-1-300x206.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-1-768x528.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-1-151x103.png 151w" sizes="(max-width: 751px) 100vw, 751px" /></a><p class="wp-caption-text"><i>Figure 1. Wajam search results from a Google search (official example from Wajam)</i></p></div>
<p>The software itself is free to install; however, it generates revenues through the display of contextual advertising. Regarding its distribution, a browser extension was initially available from the Wajam official website until 2014 (see Figure 2), but it is now primarily distributed using the <a href="https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/security-response-pay-per-install-10-en.pdf" target="_blank" rel="noopener">Pay-Per-Install</a> (PPI) distribution model. According to the <a href="https://www.priv.gc.ca/en/opc-actions-and-decisions/investigations/investigations-into-businesses/2017/pipeda-2017-002/" target="_blank" rel="noopener">Office of the Privacy Commissioner</a> (OPC) of Canada, Wajam has used more than 50 different PPI providers between 2011 and 2016. This model has been criticized several times for its usage of fake <a href="https://www.mcafee.com/enterprise/en-us/assets/reports/rp-wakenet-ab.pdf" target="_blank" rel="noopener">Adobe Flash Player</a>, <a href="https://www.a51.nl/storage/pdf/m86_web_exploits_report.pdf" target="_blank" rel="noopener">antivirus</a>, and many other popular software installers to deceive the user, and for the heavy presence of adware and malware in the installers provided.</p>
<div id="attachment_126389" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-2.png"><img class="wp-image-126389" src="/wp-content/uploads/2019/06/Figure-2-1024x457.png" alt="" width="750" height="335" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-2-1024x457.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-2-300x134.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-2-768x343.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-2.png 1308w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 2. Website wajam[.]com in April 2012 (with download link)</i></p></div>
<h1>History and user complaints</h1>
<p>The history of Wajam as a company is rather curious according to the 2017 report of the OPC and some press investigations (<a href="https://www.lapresse.ca/actualites/enquetes/201810/03/01-5199000-un-logiciel-du-dragon-martin-luc-archambault-bafouait-la-vie-privee.php" target="_blank" rel="noopener">here</a> and <a href="https://www.lesaffaires.com/blogues/julien-brault/wajam-va-t-elle-trop-loin-pour-acquerir-des-utilisateurs/569959" target="_blank" rel="noopener">here</a> in French):</p>
<ul>
<li>The company progressively and silently removed the ability to link Facebook, LinkedIn and Google+ accounts to their software between 2012 and 2014, although its main feature depends on it.</li>
<li>A lot of users started to complain as of 2012 about the heavy display of ads in the web browser and the difficulty to uninstall Wajam (see Figures 3, 4 and 5). According to <a href="http://www.hoovers.com/company-information/cs/company-profile.wajam_internet_technologies_inc.1cdcd2d0312e10f7.html?aka_re=1#financials-anchor" target="_blank" rel="noopener">D&amp;B Hoovers</a>, the company generated around USD 4.2M of net profits in 2013.</li>
</ul>
<div id="attachment_126390" style="width: 761px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-3.png"><img class="wp-image-126390" src="/wp-content/uploads/2019/06/Figure-3.png" alt="" width="751" height="621" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-3.png 882w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-3-300x248.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-3-768x635.png 768w" sizes="(max-width: 751px) 100vw, 751px" /></a><p class="wp-caption-text"><i>Figure 3. User complaint #1 about Wajam</i></p></div>
<div id="attachment_126391" style="width: 761px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-4.png"><img class="wp-image-126391" src="/wp-content/uploads/2019/06/Figure-4-1024x264.png" alt="" width="751" height="194" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-4-1024x264.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-4-300x77.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-4-768x198.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-4.png 1386w" sizes="(max-width: 751px) 100vw, 751px" /></a><p class="wp-caption-text"><i>Figure 4. User complaint #2 about Wajam</i></p></div>
<div id="attachment_126392" style="width: 761px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-5.png"><img class="wp-image-126392" src="/wp-content/uploads/2019/06/Figure-5-1024x143.png" alt="" width="751" height="105" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-5-1024x143.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-5-300x42.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-5-768x107.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-5.png 1430w" sizes="(max-width: 751px) 100vw, 751px" /></a><p class="wp-caption-text"><i>Figure 5. User complaint #3 about Wajam</i></p></div>
<ul>
<li>While the OPC was investigating the company for breaching the Personal Information Protection and Electronic Documents Act (PIPEDA) because of its usage of users&#8217; personal information, the company was sold to a newly-created company headquartered in Hong Kong, called Iron Mountain Technology Limited (IMTL).</li>
</ul>
<p>The timeline in Figure 6 sums up some remarkable events in the history of the company.</p>
<div id="attachment_126393" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-6.png"><img class="wp-image-126393" src="/wp-content/uploads/2019/06/Figure-6.png" alt="" width="750" height="268" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-6.png 955w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-6-300x107.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-6-768x274.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-6-420x149.png 420w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 6. History of Wajam Internet Technologies Incorporated</i></p></div>
<p>In parallel to the company history, Figure 7 exposes the timeline of the anti-detection and anti-analysis features added to the software.</p>
<div id="attachment_126394" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-7.png"><img class="wp-image-126394" src="/wp-content/uploads/2019/06/Figure-7.png" alt="" width="750" height="225" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-7.png 955w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-7-300x90.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-7-768x230.png 768w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 7. Timeline of the anti-detection and anti-analysis features added to Wajam</i></p></div>
<h1>Common observations on the different versions of Wajam</h1>
<p>Multiple versions of Wajam have been developed over the years. Since the developers used internal names and version numbering to distinguish the different variants and builds, it was possible to classify the collection of samples collected. The following table sums up the versions identified; note that the dates are based on the time the samples were observed in the wild and it is possible they were available earlier.</p>

<table id="tablepress-698" class="tablepress tablepress-id-698">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Internal name(s)</th><th class="column-2">Major version number</th><th class="column-3">Type</th><th class="column-4">Period of distribution</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Priam</td><td class="column-2">1</td><td class="column-3">Browser extension</td><td class="column-4">Late-2011 to 2014</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Wajam Internet Enhancer, Wajam Network Enhancer</td><td class="column-2">2</td><td class="column-3">Windows application</td><td class="column-4">2013 to 2016</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Wajam Web Enhancer, Social2Search</td><td class="column-2">1 and 9</td><td class="column-3">Windows application</td><td class="column-4">2014 to 2017</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Wajam Browser Enhancer, Social2Search, SearchAwesome</td><td class="column-2">3, 11 and 13</td><td class="column-3">Windows application</td><td class="column-4">2016 to present</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">SearchPage</td><td class="column-2">N/A</td><td class="column-3">macOS application</td><td class="column-4">2017 to present</td>
</tr>
</tbody>
</table>

<h2>Traffic injection</h2>
<p>Each version of Wajam injects the same payload into the user’s web traffic, so the difference resides in the technique used to make the interception and the injection. However, the techniques they used became more and more similar to techniques typically used by malware developers. Once Wajam is installed on a machine and the web traffic is ready to be intercepted, the software acts as follows:</p>
<ol>
<li>It downloads a list of supported websites (see Figure 8) from a remote server; this list maps a domain name to the path of the corresponding JavaScript file to be injected. There are also some site-specific settings.</li>
</ol>
<div id="attachment_126395" style="width: 549px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-8.png"><img class="wp-image-126395 size-full" src="/wp-content/uploads/2019/06/Figure-8.png" alt="" width="539" height="672" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-8.png 539w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-8-241x300.png 241w" sizes="(max-width: 539px) 100vw, 539px" /></a><p class="wp-caption-text"><i>Figure 8. Snippet of the supported websites list</i></p></div>
<ol start="2">
<li>If a URL requested by the user matches one of the patterns (103 in the latest version at the time of writing), it injects the corresponding JavaScript file (see Figure 9). This script performs the injection of contextual advertising and, if the webpage is a search engine, also displays tweets corresponding to the search keywords entered by the user.</li>
</ol>
<div id="attachment_126396" style="width: 549px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-9.png"><img class="wp-image-126396" src="/wp-content/uploads/2019/06/Figure-9.png" alt="" width="539" height="535" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-9.png 904w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-9-150x150.png 150w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-9-300x298.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-9-768x763.png 768w" sizes="(max-width: 539px) 100vw, 539px" /></a><p class="wp-caption-text"><i>Figure 9. Snippet of the injected script</i></p></div>
<ol start="3">
<li>Finally, it tries to update the list from the Wajam remote server.</li>
</ol>
<h2>Personal information leaks</h2>
<p>Wajam progressively collected more and more information about its users, either during installation or when the software runs:</p>
<ul>
<li>Some IDs are used to identify a particular user (see Figure 9);</li>
<li>A lot of logs are sent to Wajam servers during the installation process to ensure it is done properly (see the network capture in Figure 10);</li>
<li>Some information specific to the setup of the user – like the list of software installed and the model of the machine – are also sent to the Wajam servers.</li>
</ul>
<div id="attachment_126397" style="width: 610px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-10.png"><img class="wp-image-126397" src="/wp-content/uploads/2019/06/Figure-10-1024x977.png" alt="" width="600" height="572" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-10-1024x977.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-10-300x286.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-10-768x733.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-10.png 1394w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 10. HTTP queries made by Wajam during the installation process</i></p></div>
<h2>Distribution mechanism</h2>
<p>Except for the browser extension, all the versions were distributed as NSIS installers by Pay-Per-Install providers. Also, the PDB paths show how the developers gradually obfuscated their software over the years. One can see that the later versions mostly have much longer PDB paths that contain only random characters.</p>

<table id="tablepress-699" class="tablepress tablepress-id-699">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Version</th><th class="column-2">Year</th><th class="column-3">PDB Path</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">1.24</td><td class="column-2">2012</td><td class="column-3">C:\Users\guillaume\Desktop\branches\Wajam\guillaume-installer-ie11-fix\Clients\Extensions\IE_BHO\source\wajam\Release\priam_bho.pdb</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">1.0</td><td rowspan="2" class="column-2">2014</td><td class="column-3">D:\jenkins\workspace\dll_injection\src\Release\wajam.pdb</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">2.12</td><td class="column-3">d:\jenkins\workspace\wajam-proxy-2.12-special-build-for-avs\WJProxy\obj\x86\Release\WajamInternetEnhancer.pdb</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">1.71</td><td rowspan="3" class="column-2">2016</td><td class="column-3">D:\jenkins\workspace\stable-1.71-updates\src\Release\wajam.pdb</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">2.40</td><td class="column-3">D:\jenkins\workspace\stable-2.40-update\build-tools\brh\Release\brh.pdb</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">3.5</td><td class="column-3">D:\jenkins\workspace\stable-ndi-3.5\service\Win32\Release\service.pdb</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">1.75</td><td rowspan="2" class="column-2">2017</td><td class="column-3">JTBEFHYO.pdb</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">9.68</td><td class="column-3">213.pdb</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">13.14</td><td class="column-2">2018</td><td class="column-3">K:\ga3ENOmcbYZO\5KSW\LXp8N\8PAW5Gq\jilgGJGN\wpoaCyFg\PC\ryX9i9P5jRrW\yaG9wzTA\vev\v8Co9rukntHI\FkVb9h7W\LCJhFhGGbCeC\m1swYV.pdb</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">13.14</td><td class="column-2">2019</td><td class="column-3">C:\D6IMFxtAM\IrsnBhaB8\LpY2EgA6h6GILy\xnyDw\tB\6hQ5AYqFBonqUM\f6rO3gJCEu6c\AFDkjWdw\iWFUHutqE\ywARjkk\tLo4m0i4r6psP3EHIIy.pdb</td>
</tr>
</tbody>
</table>

<h1>Evolution of features</h1>
<h2>Priam: the browser extension</h2>
<p>Through 2011 to late 2013, Wajam was distributed as a browser extension. In a web browser extension, the <a href="https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts" target="_blank" rel="noopener">manifest file</a> describes the webpages to be injected, and how the JavaScript code is injected into those pages if they are visited by the user. As one can see in Figure 11, all webpages are matched here, so the scripts can be potentially injected in every webpage visited by the user.</p>
<div id="attachment_126398" style="width: 531px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-11.png"><img class="wp-image-126398" src="/wp-content/uploads/2019/06/Figure-11.png" alt="" width="521" height="138" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-11.png 404w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-11-300x79.png 300w" sizes="(max-width: 521px) 100vw, 521px" /></a><p class="wp-caption-text"><i>Figure 11. Snippet of configuration from<span style="font-family: courier new, courier, monospace;"><i> manifest.json</i> </span><i></i>file</i></p></div>
<p>The older versions of the browser extension contain traces of a screen capture plugin (see Figure 12) in a DLL accompanying the extension. The latter uses either the <a href="https://developer.chrome.com/apps/npapi" target="_blank" rel="noopener">Netscape Plugin API</a> (for Chrome and Firefox) or a <a href="https://en.wikipedia.org/wiki/Browser_Helper_Object" target="_blank" rel="noopener">Browser Helper Object</a> (for Internet Explorer).</p>
<div id="attachment_126399" style="width: 531px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-12.png"><img class="wp-image-126399 size-full" src="/wp-content/uploads/2019/06/Figure-12.png" alt="" width="521" height="46" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-12.png 521w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-12-300x26.png 300w" sizes="(max-width: 521px) 100vw, 521px" /></a><p class="wp-caption-text"><i>Figure 12. Snippet of assembly code in a plugin of the Wajam browser extension</i></p></div>
<p>In the same versions, JavaScript code is used to send the browser’s bookmarks to Wajam servers. Whether it is screenshots or bookmarks, both can contain sensitive personal information about a user and one may wonder what Wajam does with this kind of information. Neither function is present in the current version of the extension.</p>
<p>As their software was detected as adware by various security products, Wajam first tried to have the detections removed by asking the security vendors directly (see Figures 13 and 14).</p>
<div id="attachment_126400" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-13.png"><img class="wp-image-126400" src="/wp-content/uploads/2019/06/Figure-13.png" alt="" width="750" height="319" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-13.png 882w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-13-300x128.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-13-768x327.png 768w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 13. Attempt of Wajam to remove a McAfee detection of the browser extension</i></p></div>
<div id="attachment_126401" style="width: 761px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-14.png"><img class="wp-image-126401" src="/wp-content/uploads/2019/06/Figure-14-1024x292.png" alt="" width="751" height="214" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-14-1024x292.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-14-300x86.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-14-768x219.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-14.png 1077w" sizes="(max-width: 751px) 100vw, 751px" /></a><p class="wp-caption-text"><i>Figure 14. Another attempt by Wajam to remove detection of their browser extension</i></p></div>
<h2>WJProxy</h2>
<p>In 2014, we observed a change in Wajam&#8217;s strategy. Their software was no longer available as a browser extension; its download links were removed from their official website (wajam[.]com) and a new version for Windows, using the <a href="https://www.telerik.com/fiddler" target="_blank" rel="noopener">Fiddler</a> web proxy, was distributed by PPI providers.</p>
<p>Among the features of this new version, the most remarkable ones are:</p>
<ul>
<li>It uses the SeDebugPrivilege to start the main executable with administrator access rights.</li>
<li>It generates a certificate and adds it to the root certificate list to intercept SSL/TLS traffic and hence avoids security warnings when injecting JavaScript code into webpages.</li>
<li>It sets up a proxy to intercept all web traffic and the preferences of installed web browsers and the Windows registry is tampered with to use the proxy.</li>
</ul>
<h2>Wajam in the Warhammer fantasy</h2>
<p>At the same time WJProxy was observed, another version with DLL injection capabilities was found in the wild. Instead of using a third-party proxy, it injects a DLL into web browsers in order to hook the functions that manipulate non-encrypted traffic. Figure 15 depicts the functional architecture of this version.</p>
<div id="attachment_126402" style="width: 676px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-15.png"><img class="wp-image-126402 size-full" src="/wp-content/uploads/2019/06/Figure-15.png" alt="" width="666" height="651" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-15.png 666w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-15-300x293.png 300w" sizes="(max-width: 666px) 100vw, 666px" /></a><p class="wp-caption-text"><i>Figure 15. Architecture of Warhammer Wajam</i></p></div>
<p>Interestingly, this version uses some obfuscation techniques like string encryption (see Figures 16 and 17).</p>
<div id="attachment_126403" style="width: 506px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-16.png"><img class="wp-image-126403" src="/wp-content/uploads/2019/06/Figure-16.png" alt="" width="496" height="183" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-16.png 543w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-16-300x110.png 300w" sizes="(max-width: 496px) 100vw, 496px" /></a><p class="wp-caption-text"><i>Figure 16. Decryption of NtLoadDriver string (Hex-Rays output)</i></p></div>
<div id="attachment_126404" style="width: 506px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-17.png"><img class="wp-image-126404 size-full" src="/wp-content/uploads/2019/06/Figure-17.png" alt="" width="496" height="134" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-17.png 496w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-17-300x81.png 300w" sizes="(max-width: 496px) 100vw, 496px" /></a><p class="wp-caption-text"><i>Figure 17. String decryption routine (Hex-Rays output)</i></p></div>
<p>Also, the files containing the list of supported websites and the addresses of the functions to hook (see Figure 18) are both encrypted (AES-256 CFB). One might note that the names of these files (respectively <span style="font-family: courier new, courier, monospace;">waaaghs</span> and <span style="font-family: courier new, courier, monospace;">snotlings</span>) might be a reference to the <a href="https://en.wikipedia.org/wiki/Warhammer_(game)" target="_blank" rel="noopener">Warhammer</a> fantasy universe. There are also other (sub)strings, such as in the name of the injected DLL, <span style="font-family: courier new, courier, monospace;">wajam_goblin.dll</span>, and others inside the binaries, suggesting Wajam’s authors were interested in fantasy games or fiction.</p>
<div id="attachment_126405" style="width: 453px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-18.png"><img class="wp-image-126405 size-full" src="/wp-content/uploads/2019/06/Figure-18.png" alt="" width="443" height="626" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-18.png 443w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-18-212x300.png 212w" sizes="(max-width: 443px) 100vw, 443px" /></a><p class="wp-caption-text"><i>Figure 18. File containing the hooks of the web browsers’ functions</i></p></div>
<p>Regarding the DLL injection process itself, it can be achieved in different ways depending on the parameter given to the injector. The following table sums up the different options.</p>

<table id="tablepress-703" class="tablepress tablepress-id-703">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Option flag</th><th class="column-2">Technique used to inject the DLL</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">--set-windows-hook</td><td class="column-2"><a href="https://resources.infosecinstitute.com/using-setwindowshookex-for-dll-injection-on-windows/" rel="noopener" target="_blank">SetWindowsHookEx</a> technique</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">--inject</td><td class="column-2"><a href="https://resources.infosecinstitute.com/using-createremotethread-for-dll-injection-on-windows/" rel="noopener" target="_blank">CreateRemoteThread</a> technique<br />
</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">--manual_mapping_inject</td><td class="column-2"><a href="https://github.com/DarthTon/Blackbone" rel="noopener" target="_blank">Blackbone </a>memory hacking library</td>
</tr>
</tbody>
</table>

<p>Once the DLL is injected, the injector checks if the targeted process is a web browser and if so uses <a href="https://www.codeproject.com/Articles/44326/MinHook-The-Minimalistic-x86-x64-API-Hooking-Libra" target="_blank" rel="noopener">MinHook</a> and the decrypted <span style="font-family: courier new, courier, monospace;">snotlings</span> file to hook the functions manipulating non-encrypted web traffic such as Firefox’s <span style="font-family: courier new, courier, monospace;">PR_Write</span>, <span style="font-family: courier new, courier, monospace;">PR_Read</span>, Win32 APIs <span style="font-family: courier new, courier, monospace;">send</span>, <span style="font-family: courier new, courier, monospace;">recv</span>, and so on.</p>
<p>As the techniques described above are usually employed by malicious software, Wajam uses several techniques to protect itself from detection by security products:</p>
<ul>
<li>It checks the Windows registry for antivirus keys (see an example listing in Figure 19) and sends any it finds to Wajam servers.</li>
</ul>
<div id="attachment_126406" style="width: 757px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-19.png"><img class="wp-image-126406" src="/wp-content/uploads/2019/06/Figure-19-1024x697.png" alt="" width="747" height="508" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-19-1024x697.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-19-300x204.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-19-768x523.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-19-151x103.png 151w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-19-97x65.png 97w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-19.png 1305w" sizes="(max-width: 747px) 100vw, 747px" /></a><p class="wp-caption-text"><i>Figure 19. Antivirus Windows registry keys checked by Wajam</i></p></div>
<ul>
<li>Depending on the sample, the name of the executable is slightly modified, such as <span style="font-family: courier new, courier, monospace;">WajWEnhance.exe</span>, <span style="font-family: courier new, courier, monospace;">WaWEn.exe</span>, <span style="font-family: courier new, courier, monospace;">WebEnhancer.exe</span>, etc.</li>
<li>From late 2015, a <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/file-system-minifilter-drivers" target="_blank" rel="noopener">minifilter</a> driver is included to hide the software’s files on the disk from all processes except whitelisted ones (see Figure 20).</li>
</ul>
<div id="attachment_126436" style="width: 757px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-20-1.png"><img class="wp-image-126436 size-full" src="/wp-content/uploads/2019/06/Figure-20-1.png" alt="" width="747" height="594" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-20-1.png 747w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-20-1-300x239.png 300w" sizes="(max-width: 747px) 100vw, 747px" /></a><p class="wp-caption-text"><i>Figure 20. List of whitelisted processes for Wajam minifilter driver</i></p></div>
<ul>
<li>It regularly modifies itself with patches downloaded from Wajam servers (these are variously RC4- or XOR- encrypted).</li>
</ul>
<p><a href="https://blog.chromium.org/2017/11/reducing-chrome-crashes-caused-by-third.html" target="_blank" rel="noopener">Chrome</a> and <a href="https://www.ghacks.net/2019/01/21/firefox-will-block-dll-injections/" target="_blank" rel="noopener">Firefox</a> have recently blocked third-party code injections in their respective web browsers, so this version of Wajam won’t work anymore if a victim uses the current version of either of these browsers.</p>
<h2>Wajam goes deeper in the kernel</h2>
<p>To face new security mechanisms, another version of Wajam was released in mid 2016 that added considerable new features, including a <a href="https://netfiltersdk.com/" target="_blank" rel="noopener">NetFilter</a> driver to intercept and inject traffic directly into kernel space.</p>
<div id="attachment_126408" style="width: 783px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-21.png"><img class="wp-image-126408 size-full" src="/wp-content/uploads/2019/06/Figure-21.png" alt="" width="773" height="352" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-21.png 773w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-21-300x137.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-21-768x350.png 768w" sizes="(max-width: 773px) 100vw, 773px" /></a><p class="wp-caption-text"><i>Figure 21. Architecture of Wajam NetFilter version</i></p></div>
<p>One of the many other changes with this version is the protection against detection:</p>
<ul>
<li>It uses heavy code and data obfuscation (see Figures 22 and 23); some techniques look like the <a href="http://stunnix.com/prod/cxxo/" target="_blank" rel="noopener">Stunnix</a> C/C++ obfuscator.</li>
</ul>
<div id="attachment_126409" style="width: 757px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-22.png"><img class="wp-image-126409" src="/wp-content/uploads/2019/06/Figure-22.png" alt="" width="747" height="570" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-22.png 896w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-22-300x229.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-22-768x586.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-22-417x317.png 417w" sizes="(max-width: 747px) 100vw, 747px" /></a><p class="wp-caption-text"><i>Figure 22. Decoding of a Windows API name (Hex-Rays output)</i></p></div>
<div id="attachment_126410" style="width: 757px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-23.png"><img class="wp-image-126410" src="/wp-content/uploads/2019/06/Figure-23.png" alt="" width="747" height="215" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-23.png 896w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-23-300x86.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-23-768x221.png 768w" sizes="(max-width: 747px) 100vw, 747px" /></a><p class="wp-caption-text"><i>Figure 23. String decoding routine (Hex-Rays output)</i></p></div>
<ul>
<li>Adds exclusions to Windows Defender (<span style="font-family: courier new, courier, monospace;">-command Add-MpPreference -ExclusionPath</span> in the command line);</li>
<li>Sets registry entries <span style="font-family: courier new, courier, monospace;">DontReportInfectionInformation</span> and <span style="font-family: courier new, courier, monospace;">DontOfferThroughWUAU</span> to 1 that disable the infection report to Microsoft and MSRT (Malicious Software Removal Tool) updates, respectively.</li>
<li>The executables are signed by certificates whose names are domain names belonging to Wajam and change very regularly (see Figures 24 and 25).</li>
</ul>
<div id="attachment_126411" style="width: 246px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-24.png"><img class="wp-image-126411 size-full" src="/wp-content/uploads/2019/06/Figure-24.png" alt="" width="236" height="256" /></a><p class="wp-caption-text"><i>Figure 24. Digital certificate of a Wajam executable found on VirusTotal</i></p></div>
<div id="attachment_126412" style="width: 255px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-25.png"><img class="wp-image-126412 size-full" src="/wp-content/uploads/2019/06/Figure-25.png" alt="" width="245" height="271" /></a><p class="wp-caption-text"><i>Figure 25. Digital certificate of another Wajam executable found on VirusTotal</i></p></div>
<p>Those domain names are trademarks of Wajam according to the Quebec Enterprise Register (see Figure 26). Also, some of the domain names (more examples in the IoCs section) are related to Montreal street names (like “Adrien Provencher”, “Bernard”, “Mont-Royal”, etc.).</p>
<div id="attachment_126413" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-26.png"><img class="wp-image-126413" src="/wp-content/uploads/2019/06/Figure-26-1024x1006.png" alt="" width="750" height="737" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-26-1024x1006.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-26-300x295.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-26-768x755.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-26.png 1311w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 26. Quebec Enterprise Register with some Wajam domain names</i></p></div>
<h2>SearchPage: Apple-flavored Wajam</h2>
<p>Starting in 2017, new Wajam-authored adware called SearchPage and targeting macOS systems was detected. Analysis shows that it used some domain names also used in the latest Windows versions (see Figure 24).</p>
<div id="attachment_126414" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-27.png"><img class="wp-image-126414" src="/wp-content/uploads/2019/06/Figure-27-1024x568.png" alt="" width="750" height="416" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-27-1024x568.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-27-300x166.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-27-768x426.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-27-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-27-298x165.png 298w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-27.png 1053w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 27. Snippet of the Info.plist showing the Wajam-registered domain name</i></p></div>
<p>It is distributed as a macOS application bundle called <span style="font-family: courier new, courier, monospace;">spiinstall.app</span>, which installs a Safari plugin and a certificate in the keychain (the root certificate placeholder on macOS). This plugin injects traffic in a similar way to the Windows versions.</p>
<p>Another version found in mid 2018 uses <a href="https://www.mitmproxy.org/" target="_blank" rel="noopener">mitmproxy</a> (a web proxy written in Python) instead of the Safari extension to intercept web traffic. Figure 28 shows how the proxy is used as well as the presence of the Wajam-registered URL hardcoded in the script.</p>
<div id="attachment_126415" style="width: 761px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-28.png"><img class="wp-image-126415" src="/wp-content/uploads/2019/06/Figure-28-1024x266.png" alt="" width="751" height="195" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-28-1024x266.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-28-300x78.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-28-768x199.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-28.png 1510w" sizes="(max-width: 751px) 100vw, 751px" /></a><p class="wp-caption-text"><i>Figure 28. Usage of mitmproxy to inject JavaScript</i></p></div>
<p>As this malware has already been documented by MalwareBytes, further details can be found in their <a href="https://blog.malwarebytes.com/threat-analysis/2018/10/mac-malware-intercepts-encrypted-web-traffic-for-ad-injection/" target="_blank" rel="noopener">analysis</a>.</p>
<h1>Implications and takeaways</h1>
<p>This research reveals that despite the transfer of ownership to a Hong Kong company, Wajam is still very active and under multiple names, such as SearchAwesome, Social2Search, SearchPage, etc. We suppose this is used to cover their tracks and expand their presence with the help of PPI distribution.</p>
<p>Our analysis shows that the techniques used by Wajam to inject traffic became more and more devious and persistent as newer versions were released. They started with a simple browser extension (2011), switched to a proxy method in late-2013, then from 2014 they directly injected code into the web browsers to hook network communications functions, and are now using a driver to intercept traffic directly in kernel space. These multiple changes have largely been in response to enhancements in the security protections built into browsers or the OS through the years.</p>
<p>Using these kinds of techniques implies there are chances to be detected by security products, and this has happened to Wajam. Even if the history of the company shows they first tried to ask for detection removal (2012-2013), they quickly changed their strategy (2014) to preferring the use of obfuscation, code protection and anti-detection techniques that hide the true behavior of their software.</p>
<p>The Wajam case reminds us there is still a grey area when speaking about adware and <a href="https://support.eset.com/kb2629/?locale=en_US&amp;viewlocale=en_US" target="_blank" rel="noopener">PUAs</a> (Potentially Unwanted Applications). Indeed, even if they use techniques to hide their behavior from users and security products, displaying advertisements is still more annoying than harmful to the user. However, one should be aware of the persistence level used by some of this software.</p>
<h1>Indicators of Compromise (IoCs)</h1>
<h2>Hashes</h2>

<table id="tablepress-700" class="tablepress tablepress-id-700">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">6a393ecb2861a27240d322dd407f6adb7218b0a5</td><td class="column-2">Win32/Adware.Wajam.A</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">4793f3bdab6df0ac6481b3780a10bec0ac10dce1</td><td class="column-2">Win32/Adware.Wajam.BH</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">7a45f4c7a7eeaa6ef97c036a7bfc992d405cd270</td><td class="column-2">Win32/Adware.Wajam.G</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">89d03d810345f491e7999af04873932ce77f7cd1</td><td class="column-2">MSIL/Wajam.F</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">f0c78bece6e447333bcb21972dc440aee723f12d</td><td class="column-2">Win32/Adware.Wajam.AC</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">b6733a21f5fbf34286374ed5cd02e86b6c369db1</td><td class="column-2">Win32/Adware.Wajam.BH</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">3d29d74b68d749d45596eb04063c4640a523c0ba</td><td class="column-2">Win32/Adware.Wajam.BH</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">f216d986f3fdc838aaca05fafb8e5b728e36513b</td><td class="column-2">Win32/Adware.Wajam.AN</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">34ce5529ad0f9d0101f2ca635876082830b48b83</td><td class="column-2">Win32/Adware.Wajam.AL</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">f5f71c6f6924fa94eb1f5a8c4a4b1775d64e9e87</td><td class="column-2">Win32/NetFilter.A</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">336efd61ab265977144ca308e635cfbee29b86a8</td><td class="column-2">Win32/NetFilter.N</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">a61a9262bc13c023750af89a483cb571663c8a0e</td><td class="column-2">Win32/Adware.Zdengo.CA</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">83e05c610d0fe6488183b7db812c69962180aabb</td><td class="column-2">Win32/Adware.Zdengo.CPZ</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">ae97c477f803121185f3c9f44c22934941df7e94</td><td class="column-2">Win64/Riskware.NetFilter.AA</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">6da090ad4a324e12b03a492b62cb47d274b3cd6e</td><td class="column-2">Win32/Adware.Zdengo.DED</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">35530aa44220ae7e96de05fd90dd1e64bb6cd199</td><td class="column-2">Win32/Adware.Zdengo.COT</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">6b626695d5d1c64376af81cef441e17cdc92f006</td><td class="column-2">Win32/Adware.Zdengo.CXG</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">6725a7c721bea20494e2e6036b11bb6d0531f829</td><td class="column-2">Win32/Adware.Zdengo.CRR</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">fb26f538384cd50988a2a5f27b6443f16a92cee1</td><td class="column-2">Win32/RiskWare.NetFilter.AY</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">ecd1e57c1fdc32052f0be1241691e91f869ef026</td><td class="column-2">OSX/Adware.SearchPage.B</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">ff6c756fc3cfa06c53fe9458d7608c7c350c83bb</td><td class="column-2">OSX/Adware.SearchPage.B</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">fea551bcfbdbaba20b0b6556649029928888faf2</td><td class="column-2">OSX/Adware.SearchPage.A</td>
</tr>
</tbody>
</table>

<h2>IP addresses ranges</h2>

<table id="tablepress-701" class="tablepress tablepress-id-701">
<tbody class="row-hover">
<tr class="row-1 odd">
	<td class="column-1">217.182.14.0/24</td>
</tr>
<tr class="row-2 even">
	<td class="column-1">131.153.5.192/29</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">198.24.161.72/29</td>
</tr>
</tbody>
</table>

<h2>Domain names (partial list)</h2>
<p>adrienprovenchertechnology[.]com<br />
armandlamoureuxtechnology[.]com<br />
bernardtechnology[.]com<br />
carmenbienvenuetechnology[.]com<br />
cartiertechnology[.]com<br />
chabaneltechnology[.]com<br />
chaumonttechnology[.]com<br />
colonialetechnology[.]com<br />
cormacktechnology[.]com<br />
customsearches[.]net<br />
despinstechnology[.]com<br />
hutchisontechnology[.]com<br />
imt-dashboard[.]tech<br />
jeanlesagetechnology[.]com<br />
kingwintechnology[.]com<br />
laubeyrietechnology[.]com<br />
lauriertechnology[.]com<br />
mansactechnology[.]com<br />
mounactechnology[.]com<br />
notification-results[.]com<br />
notifications-page[.]com<br />
notifications-service[.]info<br />
notifications-service[.]io<br />
papineautechnology[.]com<br />
premiumsearchhub[.]com<br />
premiumsearchresults[.]com<br />
premiumsearchtech[.]com<br />
preverttechnology[.]com<br />
search-awesome[.]net<br />
search-ology[.]com<br />
search-technology[.]net<br />
searchawesome-apps[.]com<br />
searchawesome[.]net<br />
searchawesome2[.]com<br />
searchawesome3[.]com<br />
searchesandfind[.]com<br />
searchfeedtech[.]com<br />
searchforall[.]net<br />
searchforfree[.]net<br />
searchnewsroom[.]com<br />
searchnotifications[.]com<br />
searchpage-results[.]com<br />
searchpage-results[.]net<br />
searchpage[.]com<br />
searchpageresults[.]com<br />
searchsymphony[.]com<br />
searchtech[.]net<br />
securesearch[.]xyz<br />
seekoutresultz[.]com<br />
sirwilfridlauriertechnology[.]com<br />
social2search[.]com<br />
tazotechnology[.]com<br />
technologieadrienprovencher[.]com<br />
technologieairflow[.]com<br />
technologiearmandlamoureux[.]com<br />
technologiebeaumont[.]com<br />
technologiebernard[.]com<br />
technologiecarmenbienvenue[.]com<br />
technologiecartier[.]com<br />
technologiechabanel[.]com<br />
technologiechaumont[.]com<br />
technologiecoloniale[.]com<br />
technologiecormack[.]com<br />
technologiedollard[.]com<br />
technologieduluth[.]com<br />
technologiehutchison[.]com<br />
technologiejeanlesage[.]com<br />
technologiekingwin[.]com<br />
technologielaubeyrie[.]com<br />
technologielaurier[.]com<br />
technologiemansac[.]com<br />
technologiemontroyal[.]com<br />
technologiemounac[.]com<br />
technologieoutremont[.]com<br />
technologieprevert[.]com<br />
technologierachel[.]com<br />
technologieruso[.]com<br />
technologiesaintdenis[.]com<br />
technologiesaintdominique[.]com<br />
technologiesaintjoseph[.]com<br />
technologiesaintlaurent[.]com<br />
technologiesainturbain[.]com<br />
technologiesearchawesome[.]com<br />
technologiesirwilfridlaurier[.]com<br />
technologiestdenis[.]com<br />
technologiestlaurent[.]com<br />
technologiestuart[.]com<br />
technologietazo[.]com<br />
technologietravassac[.]com<br />
technologietrudeau[.]com<br />
technologievanhorne[.]com<br />
technologiewiseman[.]com<br />
technologieyvonlheureux[.]com<br />
travassactechnology[.]com<br />
trudeautechnology[.]com<br />
wajam-download[.]com<br />
yvonlheureuxtechnology[.]com</p>
<h1>MITRE ATT&amp;CK techniques</h1>

<table id="tablepress-702" class="tablepress tablepress-id-702">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1179/" rel="noopener" target="_blank">T1179</a></td><td class="column-3">Hooking</td><td class="column-4">Use MinHook to hook web browser functions and intercept web traffic.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1134/" rel="noopener" target="_blank">T1134</a></td><td class="column-3">Access Token Manipulation</td><td class="column-4">Obtain user token to execute itself with API call CreateProcessAsUserA under user’s context.</td>
</tr>
<tr class="row-4 even">
	<td rowspan="6" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1014/" rel="noopener" target="_blank">T1014</a></td><td class="column-3">Rootkit</td><td class="column-4">Use minifilter and NetFilter drivers to respectively hide its files and intercept web traffic.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1116/" rel="noopener" target="_blank">T1116</a></td><td class="column-3">Code Signing</td><td class="column-4">Some samples are signed with different digital certificates.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1089/" rel="noopener" target="_blank">T1089</a></td><td class="column-3">Disabling Security Tools</td><td class="column-4">Add exclusions in Windows Defender and disable MRT updates.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1130/" rel="noopener" target="_blank">T1130</a></td><td class="column-3">Install Root Certificate</td><td class="column-4">Install a root certificate to aid in man-in-the-middle actions.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">Most of the strings are encrypted with an XOR-based algorithm and some payloads are encrypted with AES-256 or RC4.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td><td class="column-3">Process Injection</td><td class="column-4">Inject a DLL in web browsers (CreateRemoteThread, SetWindowsHookEx or BlackBone library) to intercept web traffic.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1063/" rel="noopener" target="_blank">T1063</a></td><td class="column-3">Security Software Discovery</td><td class="column-4">Attempt to detect several antivirus products.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-06-05 11:30:41">5 Jun 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Wajam: From start&#8209;up to massively&#8209;spread adware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Wajam: From start&#8209;up to massively&#8209;spread adware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2021/03/08/women-cybersecurity-gender-gap-narrows-but-not-enough/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/international-women-day-cybersecurity-gap-gender-623x432.jpg"
                                                         alt="Wajam: From start&#8209;up to massively&#8209;spread adware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/08/women-cybersecurity-gender-gap-narrows-but-not-enough/">
                                                    Women in cybersecurity: Gender gap narrows but not enough                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2021/02/26/championing-worthy-causes-how-eset-gives-helping-hand/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/championing-worthy-causes-eset-giving-helping-hand-623x432.jpg"
                                                         alt="Wajam: From start&#8209;up to massively&#8209;spread adware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/26/championing-worthy-causes-how-eset-gives-helping-hand/">
                                                    Championing worthy causes: How ESET gives a helping hand                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F05%2Fwajam-startup-massively-spread-adware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F05%2Fwajam-startup-massively-spread-adware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F05%2Fwajam-startup-massively-spread-adware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"126373 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=126373","disqusShortname":"welivesecurity","disqusTitle":"Wajam: From start\u2011up to massively\u2011spread adware","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/06\/05\/wajam-startup-massively-spread-adware\/","postId":"126373"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>