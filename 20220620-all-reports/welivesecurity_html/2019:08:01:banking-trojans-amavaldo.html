<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': '',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>From Carnaval to Cinco de Mayo – The journey of Amavaldo | WeLiveSecurity</title>
<meta name="description" content="ESET researchers publish the first instalment in a series of articles on Latin American banking trojans, focusing on a malware family they dubbed Amavaldo."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="From Carnaval to Cinco de Mayo – The journey of Amavaldo | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers publish the first instalment in a series of articles on Latin American banking trojans, focusing on a malware family they dubbed Amavaldo." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:published_time" content="2019-08-01T15:00:26+00:00" />
<meta property="article:modified_time" content="2019-08-31T03:17:25+00:00" />
<meta property="og:updated_time" content="2019-08-31T03:17:25+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure01_FakeWindow.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure01_FakeWindow.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers publish the first instalment in a series of articles on Latin American banking trojans, focusing on a malware family they dubbed Amavaldo." />
<meta name="twitter:title" content="From Carnaval to Cinco de Mayo – The journey of Amavaldo | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure01_FakeWindow.png" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2019/08/01/amavaldo-um-trojan-bancario-que-tenta-fazer-vitimas-no-brasil/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/08/02/carnaval-cinco-mayo-amavaldo/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/08/01/amavaldo-troyano-bancario-dirigido-brasil-mexico/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/08/01/amavaldo-banking-trojaner/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2019/08/01/amavaldo-um-trojan-bancario-que-tenta-fazer-vitimas-no-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/08/02/carnaval-cinco-mayo-amavaldo/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/08/01/amavaldo-troyano-bancario-dirigido-brasil-mexico/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/08/01/amavaldo-banking-trojaner/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2019/08/01/amavaldo-um-trojan-bancario-que-tenta-fazer-vitimas-no-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/08/02/carnaval-cinco-mayo-amavaldo/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/08/01/amavaldo-troyano-bancario-dirigido-brasil-mexico/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/08/01/amavaldo-banking-trojaner/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/08/trojan2.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>From Carnaval to Cinco de Mayo – The journey of Amavaldo</h1>
<div class="excerpt">The first in an occasional series demystifying Latin American banking trojans</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-08-01 17:00:26">1 Aug 2019 - 05:00PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F01%2Fbanking-trojans-amavaldo%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F01%2Fbanking-trojans-amavaldo%2F&text=From Carnaval to Cinco de Mayo – The journey of Amavaldo%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F01%2Fbanking-trojans-amavaldo%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>The first in an occasional series demystifying Latin American banking trojans</p>
                            </div>

                            <p>At the end of 2017, a group of malware researchers from ESET’s Prague lab decided to take a deeper look at the infamous Delphi-written banking trojans that are known to target Brazil. We extended our focus to other parts of Latin America (such as Mexico and Chile) soon after as we noticed many of these banking trojans target those countries as well. Our main goal was to discover whether there is a way to classify these banking trojans and to learn more about their behavior in general.</p>
<p>We have learned a lot – we have identified more than 10 new malware families, studied the distribution chains and linked them to the new families accordingly, and dissected the internal behavior of the banking trojans. In this initial blog post, we will start by describing this type of banking trojan in general and then move to the first newly identified malware family we’ll discuss – Amavaldo.</p>
<h1>What sets Latin American banking trojans apart?</h1>
<p>Before moving further, let’s define the characteristics of this type of banking trojan:</p>
<ul>
<li>It is written in the Delphi programming language</li>
<li>It contains backdoor functionality</li>
<li>It uses long distribution chains</li>
<li>It may divide its functionality into multiple components</li>
<li>It usually abuses legitimate tools and software</li>
<li>It targets Spanish- or Portuguese-speaking countries</li>
</ul>
<p>We have encountered other common characteristics during our research. Most Latin American banking trojans we have analyzed connect to the C&amp;C server and stay connected, waiting for whatever commands the server sends. After receiving a command, they execute it and wait for the next one. The commands are probably pushed manually by the attacker. You can think of this approach as a chat room where all the members react to what the admin writes.</p>
<p>The C&amp;C server address seems to be the resource these malware authors protect the most. We have encountered many different approaches to hiding the actual address, which we will discuss in this series of blog posts. Besides the C&amp;C server, a unique URL is used by the malware to submit victim identification information. This helps the attackers to keep track of their victims.</p>
<p>Banking trojans from Latin America usually use little-known cryptographic algorithms and it is common that different families use the same ones. We have identified a <a href="https://books.google.com/books?id=0PdDnywBKl0C&amp;printsec=frontcover" target="_blank" rel="noopener">book</a> and a <a href="http://delphi.icm.edu.pl/ftp/d20free/tomencry.zip" target="_blank" rel="noopener">Delphi freeware library</a> the authors were apparently inspired by.</p>
<p>The fact that this malware is written in Delphi indicates the executable files are at least a few megabytes in size because the Delphi core is present in every binary. Additionally, most Latin American banking trojans contain a large number of resources, which further increases the file size. We have even encountered samples with file sizes reaching several hundred megabytes. In those cases, the file size has been deliberately increased in order to avoid detection.</p>
<h1>Discovering malware families</h1>
<p>When analyzing such an executable, it is usually not very hard to decide quickly that it is a malicious banking trojan. Besides the aforementioned characteristics, the authors tend to copy each other’s work or to derive their malware from a common source. As a result of that, most of the Latin American banking trojans look alike. This is the main reason why we mostly see only generic detections.</p>
<p>Our research started with identifying strong characteristics that would allow us to establish malware families. Over time, we were able to do so and identified more than 10 new ones. The characteristics we used were mainly how strings are stored, how the C&amp;C server address is obtained and other code similarities.</p>
<h1>Following the distribution chains</h1>
<p>The simplest way that these malware families are delivered is by utilizing a single downloader (a Windows executable file) specific to that family. This downloader sometimes masquerades as a legitimate software installer. This method is simple, but also the less common one.</p>
<p>Much more common is to use a multistage distribution chain that typically employs several layers of downloaders written in scripting languages such as JavaScript, PowerShell and Visual Basic Script (VBS). Such a chain typically consists of at least three stages. The final payload is typically delivered in a zip archive that contains either only the banking trojan or additional components along with it. The main advantage, to the malware authors, of this method is that it is quite complicated for malware researchers to reach the very end of the chain and thereby analyze the final payload. However, it is also much easier for a security product to stop the threat because it only needs to break one link in the chain.</p>
<h1>Money-stealing strategy</h1>
<p>Unlike most banking trojans, those from Latin America do not utilize web-injection – instead they use a form of social engineering. They continuously detect active windows on the victim’s computer and if they find one related to a bank, they launch their attack.</p>
<p>The purpose of the attack is almost always to persuade the user that some special, urgent and necessary action is required. This can be an update of the banking application used by the victim, or verification of credit card information or bank account credentials. A fake popup window then steals the data after the victim enters it (an example is seen in Figure 1) or a virtual keyboard acts as a keylogger as seen in Figure 2. The sensitive information is then sent to the attackers who can abuse it in any way they see fit.</p>
<div id="attachment_128435" style="width: 683px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure01_FakeWindow.png"><img class="wp-image-128435" src="/wp-content/uploads/2019/07/Figure01_FakeWindow.png" alt="" width="673" height="359" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure01_FakeWindow.png 961w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure01_FakeWindow-300x160.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure01_FakeWindow-768x409.png 768w" sizes="(max-width: 673px) 100vw, 673px" /></a><p class="wp-caption-text"><i>Figure 1. Fake popup window that tries to steal an authorization code (Translation: Anti-intrusion tool. Your security is the first priority. Enter your signature)</i></p></div>
<div id="attachment_128436" style="width: 683px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure02_VirtualKeyboard.png"><img class="wp-image-128436 size-full" src="/wp-content/uploads/2019/07/Figure02_VirtualKeyboard.png" alt="" width="673" height="301" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure02_VirtualKeyboard.png 673w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure02_VirtualKeyboard-300x134.png 300w" sizes="(max-width: 673px) 100vw, 673px" /></a><p class="wp-caption-text"><i>Figure 2. Virtual keyboard with a keylogger (Translation: Card Password. Enter your card password by clicking on the buttons)</i></p></div>
<h1>Amavaldo</h1>
<p>We named the malware family described in the rest of this blog post Amavaldo. This family is still in active development – the latest version we have observed (10.7) has a compilation timestamp of June 10<sup>th</sup>, 2019.</p>
<p>This is an example of modular malware whose final payload ZIP archive contains three components:</p>
<ol>
<li>A copy of a legitimate application (EXE)</li>
<li>An injector (DLL)</li>
<li>An encrypted banking trojan (decrypts to DLL)</li>
</ol>
<p>Figure 3 displays the contents of an example Amavaldo final payload ZIP archive.</p>
<div id="attachment_128437" style="width: 493px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure03_AmavaldoComponents.png"><img class="wp-image-128437 size-full" src="/wp-content/uploads/2019/07/Figure03_AmavaldoComponents.png" alt="" width="483" height="134" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure03_AmavaldoComponents.png 483w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure03_AmavaldoComponents-300x83.png 300w" sizes="(max-width: 483px) 100vw, 483px" /></a><p class="wp-caption-text"><i>Figure 3. Amavaldo components extracted in a folder. The components are: ctfmon.exe (legitimate application), MsCtfMonitor (encrypted banking trojan), MsCtfMonitor.dll (injector).</i></p></div>
<p>The downloader stores all the ZIP archive contents to the hard drive in the same folder. The injector has a name chosen to match that of a DLL used by the bundled, legitimate application. Before the downloader exits, it executes the legitimate application. Then:</p>
<ul>
<li>The injector is executed via DLL Side-Loading</li>
<li>The injector injects itself into <span style="font-family: courier new, courier, monospace;">wmplayer.exe</span> or <span style="font-family: courier new, courier, monospace;">iexplore.exe</span></li>
<li>The injector searches for the encrypted banking trojan (an extensionless file whose name matches that of the injector DLL)</li>
<li>If such a file is found, the injector decrypts and executes the banking trojan</li>
</ul>
<h2>Characteristics</h2>
<p>Besides the modular structure, the strongest identifying characteristic is the custom encryption scheme used for string obfuscation (Figure 4). As you can see, aside from the key (green) and encrypted data (blue), the code is also filled with garbage strings (red) that are never used. We provide simplified pseudocode in Figure 5 to emphasize the algorithm’s logic. This string handling routine is used by the banking trojan itself, the injector and even the downloader that we will describe later. Unlike many other Latin American banking trojans, this routine does not appear to be inspired by the book mentioned earlier.</p>
<div id="attachment_128438" style="width: 678px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure04_AmavaldoStrings.png"><img class="wp-image-128438" src="/wp-content/uploads/2019/07/Figure04_AmavaldoStrings.png" alt="" width="668" height="196" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure04_AmavaldoStrings.png 682w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure04_AmavaldoStrings-300x88.png 300w" sizes="(max-width: 668px) 100vw, 668px" /></a><p class="wp-caption-text"><i>Figure 4. String obfuscation in Amavaldo</i></p></div>
<div id="attachment_128439" style="width: 680px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure05_StringDecryptionCode.png"><img class="wp-image-128439 size-full" src="/wp-content/uploads/2019/07/Figure05_StringDecryptionCode.png" alt="" width="670" height="313" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure05_StringDecryptionCode.png 670w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure05_StringDecryptionCode-300x140.png 300w" sizes="(max-width: 670px) 100vw, 670px" /></a><p class="wp-caption-text"><i>Figure 5. Amavaldo string decryption pseudocode. This algorithm does not seem to be inspired by the book mentioned earlier.</i></p></div>
<p>Additionally, the latest versions of this family can be identified by a mutex that seems to have the constant name <span style="font-family: courier new, courier, monospace;">{D7F8FEDF-D9A0-4335-A619-D3BB3EEAEDDB}</span>.</p>
<p>Amavaldo first collects information about the victim that consists of:</p>
<ul>
<li>Computer and OS identification</li>
<li>What kind of banking protection the victim has installed. The information is gathered from searching the following filesystem paths:
<ul>
<li><span style="font-family: courier new, courier, monospace;">%ProgramFiles%\Diebold\Warsaw</span></li>
<li><span style="font-family: courier new, courier, monospace;">%ProgramFiles%\GbPlugin\</span></li>
<li><span style="font-family: courier new, courier, monospace;">%ProgramFiles%\scpbrad\</span></li>
<li><span style="font-family: courier new, courier, monospace;">%ProgramFiles%\Trusteer</span></li>
<li><span style="font-family: courier new, courier, monospace;">%ProgramFiles%\AppBrad\</span></li>
<li><span style="font-family: courier new, courier, monospace;">%LocalAppData%\Aplicativo Itau</span></li>
</ul>
</li>
</ul>
<p>The newer versions communicate via <a href="https://www.devart.com/sbridge/" target="_blank" rel="noopener">SecureBridge</a>, a Delphi library that provides SSH/SSL connections.</p>
<p>As with many other such banking trojans, Amavaldo supports several backdoor commands. The capabilities of these commands include:</p>
<ul>
<li>Obtaining screenshots</li>
<li>Capturing photos of the victim via webcam</li>
<li>Logging keystrokes</li>
<li>Downloading and executing further programs</li>
<li>Restricting access to various banking websites</li>
<li>Mouse and keyboard simulation</li>
<li>Self-updating</li>
</ul>
<p>Amavaldo uses a clever technique when launching the attack on its victim that is similar to what Windows UAC does. After detecting a bank-related window, it takes a screenshot of the desktop and makes it look like the new wallpaper. Then it displays a fake popup window chosen based on the active window’s text while disabling multiple hotkeys and preventing the victim from interacting with anything else but the popup window.</p>
<p>Only Brazilian banks had been targeted when we have first encountered this malware family, but it has extended its range since April 2019 to Mexican banks as well. Even though the previously used Brazilian targets are still present in the malware, based on our analysis the authors focus only on Mexico now.</p>
<h2>Distribution</h2>
<p>We were able to observe two distribution chains – one early this year and a second one since April.</p>
<h3>Distribution chain 1: Targeting Brazil</h3>
<p>We first observed this chain in January 2019 targeting victims in Brazil. The authors decided to use an MSI installer, VBS, XSL (Extensible Stylesheet Language) and PowerShell for distribution.</p>
<p>The whole chain starts with an MSI installer that the victim expects will install Adobe Acrobat Reader DC. It utilizes two legitimate executables: <span style="font-family: courier new, courier, monospace;">AICustAct.dll</span> (to check for an available internet connection) and <span style="font-family: courier new, courier, monospace;">VmDetect.exe</span> (to detect virtual environments).</p>
<div id="attachment_128440" style="width: 840px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure06_ErrorMessages.png"><img class="wp-image-128440 size-full" src="/wp-content/uploads/2019/07/Figure06_ErrorMessages.png" alt="" width="830" height="183" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure06_ErrorMessages.png 830w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure06_ErrorMessages-300x66.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure06_ErrorMessages-768x169.png 768w" sizes="(max-width: 830px) 100vw, 830px" /></a><p class="wp-caption-text"><i>Figure 6. Error message when the downloader runs inside a virtual machine (left) or without an internet connection (right)</i></p></div>
<p>Once the fake installer is executed, it makes use of an embedded file that, besides strings, contains a packed VBS downloader (Figure 7). After unpacking (Figure 8), it downloads yet another VBS downloader (Figure 9). Notice that the second VBS downloader abuses the Microsoft Windows <span style="font-family: courier new, courier, monospace;">WMIC.exe</span> to download the next stage &#8211; an XSL script (Figure 10) with embedded, encoded PowerShell. Finally, the PowerShell script (Figure 11) is responsible for downloading the final payload – a zip archive with multiple files, as listed in Table 1. It also ensures persistence by creating a scheduled task named GoogleBol.</p>
<div id="attachment_128441" style="width: 833px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure07_Stage01.png"><img class="wp-image-128441" src="/wp-content/uploads/2019/07/Figure07_Stage01-1024x210.png" alt="" width="823" height="168" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure07_Stage01-1024x210.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure07_Stage01-300x61.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure07_Stage01-768x157.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure07_Stage01.png 1393w" sizes="(max-width: 823px) 100vw, 823px" /></a><p class="wp-caption-text"><i>Figure 7. The first stage. A packed VBS downloader (highlighted in red) embedded inside the MSI installer.</i></p></div>
<div id="attachment_128442" style="width: 833px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure08_Stage01_unpacked.png"><img class="wp-image-128442 size-full" src="/wp-content/uploads/2019/07/Figure08_Stage01_unpacked.png" alt="" width="823" height="124" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure08_Stage01_unpacked.png 823w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure08_Stage01_unpacked-300x45.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure08_Stage01_unpacked-768x116.png 768w" sizes="(max-width: 823px) 100vw, 823px" /></a><p class="wp-caption-text"><i>Figure 8. The unpacked first stage</i></p></div>
<div id="attachment_128478" style="width: 832px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure09_Stage02_unpacked.png"><img class="wp-image-128478" src="/wp-content/uploads/2019/08/Figure09_Stage02_unpacked-1024x138.png" alt="" width="822" height="111" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure09_Stage02_unpacked-1024x138.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure09_Stage02_unpacked-300x41.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure09_Stage02_unpacked-768x104.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure09_Stage02_unpacked.png 1125w" sizes="(max-width: 822px) 100vw, 822px" /></a><p class="wp-caption-text"><i>Figure 9. The unpacked second stage. </i><span style="font-family: courier new, courier, monospace;">WMIC.exe</span> <i>is abused to execute the next stage.</i></p></div>
<div id="attachment_128479" style="width: 833px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure10_Stage03.png"><img class="wp-image-128479" src="/wp-content/uploads/2019/08/Figure10_Stage03.png" alt="" width="823" height="450" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure10_Stage03.png 859w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure10_Stage03-300x164.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure10_Stage03-768x420.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure10_Stage03-143x79.png 143w" sizes="(max-width: 823px) 100vw, 823px" /></a><p class="wp-caption-text"><i>Figure 10. The third stage. A large XSL script that contains embedded, encoded PowerShell script (highlighted in red).</i></p></div>
<div id="attachment_128483" style="width: 833px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure11_Stage04.png"><img class="wp-image-128483" src="/wp-content/uploads/2019/08/Figure11_Stage04-1024x579.png" alt="" width="823" height="465" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure11_Stage04-1024x579.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure11_Stage04-300x170.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure11_Stage04-768x434.png 768w" sizes="(max-width: 823px) 100vw, 823px" /></a><p class="wp-caption-text"><i>Figure 11. The fourth (final) stage. An obfuscated PowerShell script that downloads the final payload and executes it.</i></p></div>
<p>In Table 1 you can see two sets of payloads and injectors, both using the execution method described earlier. The NvSmartMax[.dll] has been used to execute Amavaldo. The libcurl[.dll] is not directly related to Amavaldo, since it executes a tool that is used to automatically register a large number of new email accounts using the Brasil Online (BOL) email platform. These created email logins and passwords are sent back to the attacker. We believe it to be a setup for a new spam campaign.</p>
<p><em>Table 1. Contents of the final payload archive and their descriptions</em></p>

<table id="tablepress-724" class="tablepress tablepress-id-724">
<tbody class="row-hover">
<tr class="row-1 odd">
	<td class="column-1">nvsmartmaxapp.exe</td><td class="column-2">Legitimate application 1</td>
</tr>
<tr class="row-2 even">
	<td class="column-1">NvSmartMax.dll</td><td class="column-2">Injector 1</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">NvSmartMax</td><td class="column-2">Payload 1</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Gup.exe</td><td class="column-2">Legitimate application 2</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">libcurl.dll</td><td class="column-2">Injector 2</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Libcurl</td><td class="column-2">Payload 2</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">gup.xml</td><td class="column-2">Configuration file for gup.exe</td>
</tr>
</tbody>
</table>

<p>&nbsp;</p>
<h3>Distribution chain 2: Targeting Mexico</h3>
<p>The most recent distribution chain we have observed starts with a very similar MSI installer. The difference is that this time, it contains an embedded Windows executable file that serves as the downloader. The installer ends with a fake error message (Figure 12). Right after, the downloader is executed. Persistence is ensured the by creating a scheduled task (as in the first chain), this time named <span style="font-family: courier new, courier, monospace;">Adobe Acrobat TaskB</span> (Figure 13). Then it downloads all the Amavaldo components (no email tool has been observed this time) and executes the banking trojan.</p>
<div id="attachment_128446" style="width: 470px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure12_FakeErrorMsg.png"><img class="wp-image-128446 size-full" src="/wp-content/uploads/2019/07/Figure12_FakeErrorMsg.png" alt="" width="460" height="179" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure12_FakeErrorMsg.png 460w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure12_FakeErrorMsg-300x117.png 300w" sizes="(max-width: 460px) 100vw, 460px" /></a><p class="wp-caption-text"><i>Figure 12. The fake error message displayed by the installer</i></p></div>
<div id="attachment_128447" style="width: 833px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure13_ScheduledTask.png"><img class="wp-image-128447" src="/wp-content/uploads/2019/07/Figure13_ScheduledTask-1024x205.png" alt="" width="823" height="165" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure13_ScheduledTask-1024x205.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure13_ScheduledTask-300x60.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure13_ScheduledTask-768x154.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure13_ScheduledTask.png 1138w" sizes="(max-width: 823px) 100vw, 823px" /></a><p class="wp-caption-text"><i>Figure 13. The scheduled task created by the downloader</i></p></div>
<p>We believe that companies are being targeted via a spam campaign by this method. The initial files are named <span style="font-family: courier new, courier, monospace;">CurriculumVitae[…].msi</span> or <span style="font-family: courier new, courier, monospace;">FotosPost[…].msi</span>. We think that the victims are deceived into clicking on a link in an email message that leads them to downloading what they believe is a CV. Since it should be a PDF, running an apparent installation of Adobe Acrobat Reader DC may seem legitimate as well.</p>
<p>Since the authors decided to use the bit.ly URL shortener, we can observe additional information about their campaigns (Figures 14 and 15). As we can see, the vast majority of the clicks on those URLs were geolocated in Mexico. The fact that email is the most frequent referrer supports our assumption about spam being the distribution vector.</p>
<div id="attachment_128448" style="width: 833px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure14_CampaignStats01.png"><img class="wp-image-128448" src="/wp-content/uploads/2019/07/Figure14_CampaignStats01-1024x597.png" alt="" width="823" height="480" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure14_CampaignStats01-1024x597.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure14_CampaignStats01-300x175.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure14_CampaignStats01-768x447.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure14_CampaignStats01-257x149.png 257w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure14_CampaignStats01.png 1373w" sizes="(max-width: 823px) 100vw, 823px" /></a><p class="wp-caption-text"><i>Figure 14. Statistics for a recent Amavaldo campaign targeting Mexico (1)</i></p></div>
<div id="attachment_128449" style="width: 833px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/07/Figure15_CampaignStats02.png"><img class="wp-image-128449" src="/wp-content/uploads/2019/07/Figure15_CampaignStats02-1024x609.png" alt="" width="823" height="489" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure15_CampaignStats02-1024x609.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure15_CampaignStats02-300x178.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure15_CampaignStats02-768x456.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/07/Figure15_CampaignStats02.png 1373w" sizes="(max-width: 823px) 100vw, 823px" /></a><p class="wp-caption-text"><i>Figure 15. Statistics for a recent Amavaldo campaign targeting Mexico (2)</i></p></div>
<h1>Conclusion</h1>
<p>In this blog post, we have introduced our research into the banking trojans of Latin America. We have described what is typical for such malware and how it operates. We have also presented what key features we have used to establish malware families.</p>
<p>We have described the first malware family – Amavaldo – its most typical features and targets, and analyzed recent distribution chains in detail. Amavaldo shares many typical characteristics of Latin America banking trojans. It splits its functionality into several components, so that having only one component is not enough for analysis. It abuses legitimate applications to execute itself and to detect virtual environments. It tries to steal banking information from Brazilian and Mexican banks and contains backdoor functionality as well.</p>
<p><em>For any inquiries, contact us as threatintel@eset.com. Indicators of Compromise can also be found on <a href="https://github.com/eset/malware-ioc/tree/master/amavaldo" target="_blank" rel="noopener">our GitHub</a>.</em></p>
<h1><big>Indicators of Compromise (IoCs)</big></h1>
<h2>Hashes</h2>
<h3>First distribution chain (Brazil) hashes</h3>

<table id="tablepress-725" class="tablepress tablepress-id-725">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">E0C8E11F8B271C1E40F5C184AFA427FFE99444F8</td><td class="column-2">Downloader (MSI installer)</td><td class="column-3">Trojan.VBS/TrojanDownloader.Agent.QSL</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">12C93BB262696314123562F8A4B158074C9F6B95</td><td class="column-2">Abuse legitimate application (NvSmartMaxApp.exe)</td><td class="column-3">Clean file</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">6D80A959E7F52150FDA2241A4073A29085C9386B</td><td class="column-2">Injector for Amavaldo (NvSmartMax.dll)</td><td class="column-3">Win32/Spy.Amavaldo.P trojan</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">B855D8B1BAD07D578013BDB472122E405D49ACC1</td><td class="column-2">Amavaldo (decrypted NvSmartMax)</td><td class="column-3">Win32/Spy.Amavaldo.N trojan</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">FC37AC7523CF3B4020EC46D6A47BC26957E3C054</td><td class="column-2">Abused legitimate application (gup.exe)</td><td class="column-3">Clean file</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">4DBA5FE842B01B641A7228A4C8F805E4627C0012</td><td class="column-2">Injector for email tool (libcurl.dll)</td><td class="column-3">Win32/Spy.Amavaldo.P trojan</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">9A968341C65AB47BF5C7290F3B36FCF70E9C574B</td><td class="column-2">Email tool (decrypted libcurl)</td><td class="column-3">Win32/Spy.Banker.AEGH trojan</td>
</tr>
</tbody>
</table>

<h3>Second distribution chain (Mexico) hashes</h3>

<table id="tablepress-726" class="tablepress tablepress-id-726">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">AD1FCE0C62B532D097DACFCE149C452154D51EB0</td><td class="column-2">Downloader (MSI installer)</td><td class="column-3">Win32/TrojanDownloader.Delf.CSG trojan</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">6C04499F7406E270B590374EF813C4012530273E</td><td class="column-2">Abused legitimate application (ctfmon.exe)</td><td class="column-3">Clean file</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">1D56BAB28793E3AB96E390F09F02425E52E28FFC</td><td class="column-2">Injector for Amavaldo (MsCtfMonitor.dll)</td><td class="column-3">Win32/Spy.Amavaldo.U trojan</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">B761D9216C00F5E2871DE16AE157DE13C6283B5D</td><td class="column-2">Amavaldo (decrypted MsCtfMonitor)</td><td class="column-3">Win32/Spy.Amavaldo.N trojan</td>
</tr>
</tbody>
</table>

<h3>Other</h3>

<table id="tablepress-727" class="tablepress tablepress-id-727">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">B191810094DD2EE6B13C0D33458FAFCD459681AE</td><td class="column-2">VmDetect.exe – a tool for detecting virtual environment</td><td class="column-3">Clean file</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">B80294261C8A1635E16E14F55A3D76889FF2C857</td><td class="column-2">AICustAct.dll – a tool for checking internet connectivity</td><td class="column-3">Clean file</td>
</tr>
</tbody>
</table>

<h2>Mutex</h2>
<ul>
<li>{D7F8FEDF-D9A0-4335-A619-D3BB3EEAEDDB}</li>
</ul>
<h2>Filenames</h2>
<ul>
<li>%LocalAppData%\%RAND%\NvSmartMax[.dll]</li>
<li>%LocalAppData%\%RAND%\MsCtfMonitor[.dll]</li>
<li>%LocalAppData%\%RAND%\libcurl[.dll]</li>
</ul>
<h2>Scheduled task</h2>
<ul>
<li>GoogleBol</li>
<li>Adobe Acrobat TaskB</li>
</ul>
<h2>C&amp;C servers</h2>
<ul>
<li>clausdomain.homeunix[.]com:3928</li>
<li>balacimed.mine[.]nu:3579</li>
<li>fbclinica.game-server[.]cc:3351</li>
<li>newcharlesxl.scrapping[.]cc:3844</li>
</ul>
<h1>MITRE ATT&amp;CK techniques</h1>

<table id="tablepress-728" class="tablepress tablepress-id-728">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1192/" rel="noopener" target="_blank">T1192</a></td><td class="column-3">Spearphishing Link</td><td class="column-4">The initial attack vector is a malicious link in an email that leads the victim to a web page the downloader is obtained from.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="3" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1073/" rel="noopener" target="_blank">T1073</a></td><td class="column-3">DLL Side-Loading</td><td class="column-4">The injector component is executed by abusing a legitimate application with this technique.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1086/" rel="noopener" target="_blank">T1086</a></td><td class="column-3">PowerShell</td><td class="column-4">The first distribution chain uses PowerShell in its last stage.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1047/" rel="noopener" target="_blank">T1047</a></td><td class="column-3">Windows Management Instrumentation</td><td class="column-4">The first distribution chain abuses <span style="font-family: courier new, courier, monospace;">WMIC.exe</span> to execute the third stage.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Persistence is ensured by a scheduled task.</td>
</tr>
<tr class="row-7 odd">
	<td rowspan="6" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">The actual banking trojan needs to be decrypted by the injector component.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">The injector masks itself as a DLL imported by the abused legitimate application. The downloader masks itself as an installer for Adobe Acrobat Reader DC.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td><td class="column-3">Process Injection</td><td class="column-4">The injector injects itself into <span style="font-family: courier new, courier, monospace;">wmplayer.exe</span> or <span style="font-family: courier new, courier, monospace;">iexplore.exe</span>.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">VBS, PowerShell and XSL are used in the first distribution chain.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1220/" rel="noopener" target="_blank">T1220</a></td><td class="column-3">XSL Script Processing</td><td class="column-4">The first distribution chain uses XSL processing in its third stage.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td><td class="column-3">Virtualization/Sandbox Evasion</td><td class="column-4">Downloader of Amavaldo uses third-party tools to detect virtual environment.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">Amavaldo contains a command to execute a keylogger. It also steals contents from fake windows it displays.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="2" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Amavaldo searches for various filesystem paths in order to determine what banking protection applications are installed on the victim machine.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Amavaldo extracts information about the operating system.</td>
</tr>
<tr class="row-16 even">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Amavaldo contains a command to take screenshots.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1125/" rel="noopener" target="_blank">T1125</a></td><td class="column-3">Video Capture</td><td class="column-4">Amavaldo contains a command to capture photos of the victim via webcam.</td>
</tr>
<tr class="row-18 even">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1024/" rel="noopener" target="_blank">T1024</a></td><td class="column-3">Custom Cryptographic Protocol</td><td class="column-4">Amavaldo uses a unique cryptographic protocol.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">Amavaldo uses the SecureBridge Delphi library to perform SSH connections.</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Amavaldo sends the data it collects to its C&amp;C server.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-08-01 17:00:26">1 Aug 2019 - 05:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/social-media-2/" class="category-tag-btn">Social Media</a>                                                <a href="https://www.welivesecurity.com/2021/03/19/7-steps-staying-safe-secure-twitter/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/twitter-anniversary-privacy-protection-tips-623x432.jpg"
                                                         alt="From Carnaval to Cinco de Mayo – The journey of Amavaldo">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/19/7-steps-staying-safe-secure-twitter/">
                                                    7 steps to staying safe and secure on Twitter                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/privacy/" class="category-tag-btn">Privacy</a>                                                <a href="https://www.welivesecurity.com/2021/03/19/trust-your-surveillance-why-hacked-cameras-are-very-bad/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/surveillance-cameras-hacked-breach-privacy-623x432.jpg"
                                                         alt="From Carnaval to Cinco de Mayo – The journey of Amavaldo">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/19/trust-your-surveillance-why-hacked-cameras-are-very-bad/">
                                                    Trust your surveillance? Why hacked cameras are very bad                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="From Carnaval to Cinco de Mayo – The journey of Amavaldo">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/mobile-security/" class="category-tag-btn">Mobile Security</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/beware-android-trojan-posing-clubhouse-app/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/clubhouse-trojan-app-android-623x432.jpg"
                                                         alt="From Carnaval to Cinco de Mayo – The journey of Amavaldo">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/beware-android-trojan-posing-clubhouse-app/">
                                                    Beware Android trojan posing as Clubhouse app                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F01%2Fbanking-trojans-amavaldo%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F01%2Fbanking-trojans-amavaldo%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F01%2Fbanking-trojans-amavaldo%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"128431 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=128431","disqusShortname":"welivesecurity","disqusTitle":"From Carnaval to Cinco de Mayo \u2013 The journey of Amavaldo","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/08\/01\/banking-trojans-amavaldo\/","postId":"128431"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>