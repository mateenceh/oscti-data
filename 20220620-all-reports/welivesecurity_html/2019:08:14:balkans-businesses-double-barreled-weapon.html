<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Zuzana Hromcová',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>In the Balkans, businesses are under fire from a double&#8209;barreled weapon | WeLiveSecurity</title>
<meta name="description" content="ESET research uncovers a campaign that uses two malicious tools with similar capabilities to ensure both resilience and broader potential for the attackers."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="In the Balkans, businesses are under fire from a double&#8209;barreled weapon | WeLiveSecurity" />
<meta property="og:description" content="ESET research uncovers a campaign that uses two malicious tools with similar capabilities to ensure both resilience and broader potential for the attackers." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-08-14T09:30:02+00:00" />
<meta property="article:modified_time" content="2019-08-26T04:00:45+00:00" />
<meta property="og:updated_time" content="2019-08-26T04:00:45+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/08/balkans-2.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/08/balkans-2.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET research uncovers a campaign that uses two malicious tools with similar capabilities to ensure both resilience and broader potential for the attackers." />
<meta name="twitter:title" content="In the Balkans, businesses are under fire from a double&#8209;barreled weapon | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/08/balkans-2.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/08/15/balkans-entreprises-double-menace/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/08/23/ataque-departamentos-financieros-balcanes-utiliza-backdoor-rat/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/08/14/backdoor-rat-malware-balkan/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/08/15/balkans-entreprises-double-menace/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/08/23/ataque-departamentos-financieros-balcanes-utiliza-backdoor-rat/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/08/14/backdoor-rat-malware-balkan/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/08/15/balkans-entreprises-double-menace/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/08/23/ataque-departamentos-financieros-balcanes-utiliza-backdoor-rat/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/08/14/backdoor-rat-malware-balkan/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/08/balkans.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>In the Balkans, businesses are under fire from a double&#8209;barreled weapon</h1>
<div class="excerpt">ESET researchers discovered a campaign that uses two malicious tools with similar capabilities to ensure both resilience and broader potential for the attackers</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2018/06/zuzana.hromcova@eset.sk_-222x179.jpg" alt="Zuzana Hromcová">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-08-14 11:30:02">14 Aug 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F14%2Fbalkans-businesses-double-barreled-weapon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F14%2Fbalkans-businesses-double-barreled-weapon%2F&text=In the Balkans, businesses are under fire from a double&#8209;barreled weapon%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F14%2Fbalkans-businesses-double-barreled-weapon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers discovered a campaign that uses two malicious tools with similar capabilities to ensure both resilience and broader potential for the attackers</p>
                            </div>

                            <p>We’ve discovered an ongoing campaign in the Balkans spreading two tools having a similar purpose: a backdoor and a remote access trojan we named, respectively, BalkanDoor and BalkanRAT.</p>
<p>BalkanRAT enables the attacker to control the compromised computer remotely via a graphical interface, i.e., manually; BalkanDoor enables them to control the compromised computer remotely via a command line, i.e., possibly <em>en masse</em>. ESET security products detect these threats as Win{32,64}/BalkanRAT and Win32/BalkanDoor.</p>
<p>A typical victim of this campaign, which uses malicious emails as its spreading mechanism, ends up having both these tools deployed on the computer, each of them capable of fully controlling the affected machine. This rather uncommon setup makes it possible for attackers to choose the most suitable method to instruct the computer to perform operations of their choice.</p>
<p>The campaign’s overarching theme is taxes. With the contents of the emails, included links and decoy PDFs all involving taxes, the attackers are apparently targeting the financial departments of organizations in the Balkans region. Thus, although backdoors and other tools for remote access are often used for espionage, we believe that this particular campaign is financially motivated.</p>
<p>The campaign has been active at least from January 2016 to the time of writing (the most recent detections in our telemetry are from July 2019). Some parts of the campaign were briefly described by a <a href="https://www.it-klinika.rs/blog/prvi-phishing-na-srpskom" target="_blank" rel="noopener">Serbian security provider</a> in 2016 and the <a href="https://www.cert.hr/32640/" target="_blank" rel="noopener">Croatian CERT</a> in 2017. Each of these sources focused only on one of the two tools and only on a single country. However, our research shows that there is a significant overlap in targets and also in the attackers’ tactics, techniques and procedures.</p>
<p>Our findings show that the mentioned attacks have been orchestrated and we consider them a single long-term campaign that spans Croatia, Serbia, Montenegro, and Bosnia and Herzegovina.</p>
<p>Our research has also shed more light at the malware used in this campaign and provided some context. We’ve discovered a new version of BalkanDoor with a new method for execution/installation: an exploit of the WinRAR ACE vulnerability (<a href="https://nvd.nist.gov/vuln/detail/CVE-2018-20250" target="_blank" rel="noopener">CVE-2018-20250</a>). Furthermore, we’ve seen both malicious tools digitally signed with various certificates the developers paid for to add perceived legitimacy. One of them, issued to SLOW BEER LTD, was even valid at the time of writing; we’ve notified the issuer about the misuse and they revoked the certificate.</p>
<p>In this article, we will describe some notable features of both BalkanDoor and BalkanRAT. Our analysis shows that the former runs as a Windows service, which allows it to unlock the Windows logon screen remotely and without the password or start a process with the highest possible privileges. The latter misuses a legitimate remote desktop software (RDS) product and uses extra tools and scripts to hide its presence from the victim, such as hiding the window, tray icon, process and so on.</p>
<h1>Targets and distribution</h1>
<p>Both BalkanRAT and BalkanDoor have been spread in Croatia, Serbia, Montenegro, and Bosnia and Herzegovina. (These countries, along with Slovenia and former Macedonia, formed the country of Yugoslavia until 1992.)</p>
<div id="attachment_128993" style="width: 778px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-1-2.png"><img class="wp-image-128993" src="/wp-content/uploads/2019/08/Figure-1-2-1024x541.png" alt="" width="768" height="406" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-1-2-1024x541.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-1-2-300x159.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-1-2-768x406.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-1-2.png 1429w" sizes="(max-width: 768px) 100vw, 768px" /></a><p class="wp-caption-text"><i>Figure 1. Malware distribution by country</i></p></div>
<p>According to our telemetry: the campaign spreading these tools has been live since 2016, with the most recent detections as late as in July 2019.</p>
<p>The attackers have been distributing their tools via malicious emails (“malspam”) with links leading to a malicious file.</p>
<p>The links included in the malspam emails used for distribution of both BalkanRAT and BalkanDoor mimic legitimate websites of official institutions.</p>

<table id="tablepress-733" class="tablepress tablepress-id-733">
<thead>
<tr class="row-1 odd">
	<th colspan="3" class="column-1"><center>Table 1. Domains misused in the campaign</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Malicious domain</strong></td><td class="column-2"><strong>Real domain</strong></td><td class="column-3"><strong>Institution</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">pksrs[.]com</td><td class="column-2"><a href="http://www.pks.rs/" rel="noopener" target="_blank">pks.rs</a></td><td class="column-3">Chamber of Commerce and Industry of Serbia</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">porezna-uprava[.]com</td><td rowspan="2" class="column-2"><a href="http://www.porezna-uprava.hr/" rel="noopener" target="_blank">porezna-uprava.hr</a></td><td rowspan="2" class="column-3">Ministry of Finance of Croatia, Tax Administration</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">porezna-uprava[.]net</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">pufbih[.]com</td><td class="column-2"><a href="http://www.pufbih.ba/" rel="noopener" target="_blank">pufbih.ba</a></td><td class="column-3">Tax Administration of the Federation of Bosnia and Herzegovina</td>
</tr>
</tbody>
</table>

<p>The decoy PDFs revolve around the tax theme.</p>

<table id="tablepress-734" class="tablepress tablepress-id-734">
<thead>
<tr class="row-1 odd">
	<th colspan="3" class="column-1"><center>Table 2. Decoy PDFs used in the campaign</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>PDF name</strong></td><td class="column-2"><strong>Language<strong></td><td class="column-3"><strong>Content</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">MIP1023.pdf</td><td class="column-2">Bosnian</td><td class="column-3">Tax form</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Ponovljeni-Stav.pdf</td><td class="column-2">Bosnian</td><td class="column-3">Tax law</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">AUG_1031.pdf</td><td class="column-2">Bosnian</td><td class="column-3">Instructions for using tax filing application</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Zakon.pdf</td><td class="column-2">Croatian</td><td class="column-3">Tax law</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">ZPDG.pdf</td><td class="column-2">Serbian</td><td class="column-3">Tax law</td>
</tr>
</tbody>
</table>

<div id="attachment_128994" style="width: 778px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-2-3.png"><img class="wp-image-128994 size-large" src="/wp-content/uploads/2019/08/Figure-2-3-768x1024.png" alt="" width="768" height="1024" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-2-3-768x1024.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-2-3-225x300.png 225w" sizes="(max-width: 768px) 100vw, 768px" /></a><p class="wp-caption-text"><i>Figure 2. Decoy PDF documents</i></p></div>
<p>Most often, the links leading to an executable file are disguised as links to a PDF. The executable file is a WinRAR self-extractor with its name and icon changed to resemble a PDF to fool the user. When executed, it is configured to unpack its content, open the decoy PDF to prevent any suspicion &#8211; and silently execute either BalkanRAT or BalkanDoor.</p>
<p>In some of the latest samples of BalkanDoor detected in 2019, the malware is distributed as an ACE archive, disguised as a RAR archive (i.e., not an executable file), specially crafted to exploit the WinRAR ACE vulnerability (CVE-2018-20250). This vulnerability, which has been <a href="https://www.win-rar.com/singlenewsview.html?&amp;L=0&amp;tx_ttnews%5Btt_news%5D=116&amp;cHash=2b3cf0017a6df3b5a4a66288a60a1eae" target="_blank" rel="noopener">remediated</a> in version 5.70 released on February 28<sup>th</sup>, 2019, is known to <a href="https://www.fireeye.com/blog/threat-research/2019/03/winrar-zero-day-abused-in-multiple-campaigns.html" target="_blank" rel="noopener">have been exploited</a> quite often to distribute malware.</p>
<p>The exploit-based deployment of BalkanDoor is stealthier than in previous versions of the malware because it does not require executing the downloaded file – an operation that might raise the intended victim&#8217;s suspicions.</p>
<h1>The campaign</h1>
<p>According to our telemetry, most of the time, both tools have been deployed on the same machine. The combination of the tools gives the attacker both a command-line interface and a graphical interface to the compromised computer.</p>
<p>In the case of the whole toolset being deployed on the machine, here is an example scenario for the attack:</p>
<p>The attacker detects that the victim has the screen locked and thus, most probably, is not using the computer (either via BalkanDoor sending a screenshot showing that computer is locked, or via the <a href="https://www.remoteutilities.com/support/docs/full-control-and-view/" target="_blank" rel="noopener">View Only mode</a> of BalkanRAT). Via the BalkanDoor backdoor, the attacker sends a backdoor command to unlock the screen… and using BalkanRAT, they can do whatever they want on the computer.</p>
<p>However, even if the victim does not use the computer, the chance of spotting the actions performed by the attackers is still there. Even with this disadvantage, using the RDS tool may be useful. The attackers are not limited by the commands shipped in the backdoor, or by their programming skills: manually, they can perform actions that would require writing a lot of code if a backdoor were the only tool available.</p>
<p>In principle, the Balkan- toolset could be used for espionage, among other possible goals. However, not only the campaign’s targets and distribution, but also our analysis of the Balkan-toolset tools show that the attackers are going after money instead of espionage.</p>
<p>The BalkanDoor backdoor does not implement any exfiltration channel. Presumably, if the campaign were intended for espionage, the attackers would need an exfiltration channel for uploading the collected data – at least as a backup to manual exfiltration, which might not be always an option.</p>
<p>On the contrary – and supporting the notion that the attackers’ goal has been to commit some financial crime – we’ve seen BalkanRAT dropping a tool that can list available smart cards, via the <span style="font-family: courier new, courier, monospace;">SCardListReadersA/ SCardConnectA</span> API functions. Smart cards are usually issued by banks or governments for confirmation of the holder’s identity. If misused, smart cards can facilitate illegal/fraudulent activities, e.g. digitally signing a contract, validating a money transaction etc.</p>
<p>In the past, we’ve seen this feature in <a href="https://www.welivesecurity.com/2015/04/09/operation-buhtrap/" target="_blank" rel="noopener">Operation Buhtrap</a>, a campaign targeting Russian banks.</p>
<h1>Analysis &#8211; BalkanDoor</h1>
<p>BalkanDoor is a simple backdoor with a small number of commands (download and execute a file, create a remote shell, take a screenshot). It can be used to automate tasks on the compromised computer or to automatically control several affected computers at once. We have seen six versions of the backdoor, with a range of supported commands, evolve since 2016.</p>
<p>The initial dropper unpacks all its components, opens a decoy PDF (in some cases) and executes a batch installation script that ensures persistence of the backdoor.</p>
<p>The backdoor registers itself as a service, under a legitimately-looking service name (e.g. <span style="font-family: courier new, courier, monospace;">WindowsSvc</span>, <span style="font-family: courier new, courier, monospace;">WindowsPrnt</span>, <span style="font-family: courier new, courier, monospace;">WindowsConn</span> or <span style="font-family: courier new, courier, monospace;">WindowsErr</span>); the accompanying batch scripts can further ensure persistence by using Registry Run Keys or Startup folder.</p>
<p>After the backdoor is installed, the computer connects to a C&amp;C server, identifying itself by the computer name and requesting commands. The backdoor can connect to any of the C&amp;Cs from a hardcoded list – a measure to increase resilience. It connects via the HTTP or HTTPS protocol; if HTTPS is used, then the server certificates are ignored.</p>
<p>If the connection is not successful, the backdoor is capable of using the user-configured proxy on the victim’s computer and repeating the connection attempt.</p>
<p>The backdoor commands come in a format of an INI file, with properties determining the commands, command arguments and intended recipients. Specifying the list of recipients allows the attacker to send their commands to several compromised computers at once, e.g. to take screenshots of all compromised computers automatically.</p>

<table id="tablepress-735" class="tablepress tablepress-id-735">
<thead>
<tr class="row-1 odd">
	<th colspan="2" class="column-1"><center>Table 3. BalkanDoor’s commands</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Commands</strong></td><td class="column-2"><strong>Functionality</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">cn</td><td class="column-2">Specifies computer name(s) of the intended recipients of the commands</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">du, int</td><td class="column-2">Download and execute a file</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">du, ra, de, rpo</td><td class="column-2">Download and execute a file, in the specified context and on a specified desktop</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">rip</td><td class="column-2">Create a remote shell accessible from the specified IP address</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">scr_int, scr_dur</td><td class="column-2">Capture a series of screenshots of the specified duration</td>
</tr>
</tbody>
</table>

<p>Furthermore, the backdoor itself can be executed in several modes, determined by the command line arguments with which it is executed. These modes themselves can serve as backdoor commands (when executed from the remote shell):</p>

<table id="tablepress-736" class="tablepress tablepress-id-736">
<thead>
<tr class="row-1 odd">
	<th colspan="2" class="column-1"><center>Table 4. BalkanDoor’s modes</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Argument</strong></td><td class="column-2"><strong>Functionality</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">/unlock</td><td class="column-2">Unlocks the screen</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">/rcmd</td><td class="column-2">Creates a remote shell and redirects its input/output to the specified IP address</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">/takescr</td><td class="column-2">Captures a series of screenshots, duration determined by other arguments</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">/run</td><td class="column-2">Executes the specified command using cmd.exe</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">/runx</td><td class="column-2">Executes the specified command using cmd.exe, on the active (input) desktop</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">/inst</td><td class="column-2">Installs itself as a service and starts the main procedure (see /nosvc)</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">/start</td><td class="column-2">Starts the associated service, which starts the main procedure (see /nosvc)</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">/nosvc</td><td class="column-2">Main payload, communicates with C&amp;C and interprets backdoor commands</td>
</tr>
</tbody>
</table>

<p>Among the BalkanDoor capabilities, the most notable is passwordless screen-unlocking.</p>
<p>This feature comes in handy to the attackers in cases when a logged-in user locks the computer. The “Lock screen” is just another Desktop for the system, so any malware with the necessary privileges can switch to a real desktop by command. No password is required to perform this operation.</p>
<div id="attachment_128995" style="width: 629px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-3-2.png"><img class="wp-image-128995 size-full" src="/wp-content/uploads/2019/08/Figure-3-2.png" alt="" width="619" height="480" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-3-2.png 619w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-3-2-300x233.png 300w" sizes="(max-width: 619px) 100vw, 619px" /></a><p class="wp-caption-text"><i>Figure 3. Code responsible for unlocking the computer when the backdoor is executed remotely with a “/unlock” argument</i></p></div>
<h1>Analysis &#8211; BalkanRAT</h1>
<p>The BalkanRAT part of the malicious Balkan- toolset is more complex compared to its backdoor accomplice. Its goal is to deploy a copy of the Remote Utilities software, which is commercial software by a Russian vendor, Remote Utilities, LLC, used for remote access to a computer or for remote administration. BalkanRAT also provides the attacker with the credentials needed for this remote access.</p>
<p>BalkanRAT has several additional components to help load, install and conceal the existence of the RDS. They can add exceptions to the firewall, hide the RDS’s window and its tray icon, and hide the presence of related processes in the task manager.</p>
<div id="attachment_128996" style="width: 629px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-4-3.png"><img class="wp-image-128996" src="/wp-content/uploads/2019/08/Figure-4-3.png" alt="" width="619" height="424" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-4-3.png 886w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-4-3-300x206.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-4-3-768x526.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-4-3-151x103.png 151w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-4-3-97x65.png 97w" sizes="(max-width: 619px) 100vw, 619px" /></a><p class="wp-caption-text"><i>Figure 4. Components used in the campaign to deploy and hide the presence of the RDS</i></p></div>
<ol>
<li>The dropper first unpacks all components; a configuration file, the remote desktop software and a core component installing it, a userland rootkit, a GUI hider and a decoy PDF file.</li>
<li>The dropper opens the PDF file so as not to arouse suspicion of the user.</li>
<li>Covertly, the dropper executes the core component (32-bit) in the installation mode.</li>
<li>The core component (32-bit) installs itself to be executed with each start, and adds an exception to the firewall for the RDS. It executes commands <span style="font-family: courier new, courier, monospace;">inst1</span> and <span style="font-family: courier new, courier, monospace;">inst2</span> specified in the configuration file, and executes itself again, now in stealth mode.</li>
<li>In this mode, the core component acts like a keylogger.</li>
<li>The core component (32-bit) executes the 64-bit version of itself, in injection mode (if applicable).</li>
<li>The core component (64-bit) injects the userland rootkit (64-bit) into task manager processes. The userland rootkit then hides the presence of the malicious processes in the task manager.</li>
<li>The core component (32-bit) executes the RDS. It repeatedly monitors and hides the RDS window (because it is a GUI application).</li>
<li>The core component (32-bit) injects the userland rootkit (32-bit) into task manager processes. The userland rootkit then hides the presence of the malicious processes in the task manager.</li>
<li>The core component (32-bit) executes commands <span style="font-family: courier new, courier, monospace;">cmd1</span> and <span style="font-family: courier new, courier, monospace;">cmd2</span>, as specified in the configuration file. One such command was seen executing a GUI hider, which is an AutoHotKey script hiding the tray icon of the RDS.</li>
</ol>
<p><em>Note: Some components are optional. Also, sometimes they are deployed as a set comprising an encrypted payload and the corresponding loader. We are omitting these details.</em></p>
<p>The configuration file of BalkanRAT is in INI file format (similarly to BalkanDoor, which uses this format for backdoor commands), with one section named [<span style="font-family: courier new, courier, monospace;">CFG</span>]. The INI file is used by the malware’ core component and the userland rootkit.</p>

<table id="tablepress-737" class="tablepress tablepress-id-737">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Property</th><th class="column-2">Functionality</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">inst1, inst2</td><td class="column-2">Commands executed by the core component during installation</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">cmd1, cmd2</td><td class="column-2">Command executed by the core component main payload</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">hproc</td><td class="column-2">List of processes that should be hidden by userland rootkit</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">mproc</td><td class="column-2">List of processes where userland rootkit is injected</td>
</tr>
</tbody>
</table>

<div id="attachment_128997" style="width: 1225px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-5-2.png"><img class="wp-image-128997 size-full" src="/wp-content/uploads/2019/08/Figure-5-2.png" alt="" width="1215" height="238" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-5-2.png 1215w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-5-2-300x59.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-5-2-768x150.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-5-2-1024x201.png 1024w" sizes="(max-width: 1215px) 100vw, 1215px" /></a><p class="wp-caption-text"><i>Figure 5. BalkanRAT’s configuration file – properties (top) and example (below)</i></p></div>
<p>BalkanRAT’s core is a multipurpose component (there are both 32-bit and 64-bit versions); it can be executed in various modes, determined by the command-line argument. Most significantly, it is used for installation of BalkanRAT, launching a userland rootkit and adding exceptions for the RDS component in the firewall.</p>

<table id="tablepress-739" class="tablepress tablepress-id-739">
<thead>
<tr class="row-1 odd">
	<th colspan="2" class="column-1"><center>Table 5. BalkanRAT’s core component – supported functionality</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Argument</strong></td><td class="column-2"><strong>Functionality</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">/rhc</td><td class="column-2">Executes a batch file</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">/fwl</td><td class="column-2">Adds exception to the firewall for the specified program</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">/sreg</td><td class="column-2">Sets configuration data for the RDS in the registry (especially email address where the credentials should be sent)</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">/inst</td><td class="column-2">Ensures persistence by adding itself to the [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows] registry key under the “load” entry. Adds exception for the RDS to the local firewall. Executes itself again in the main mode (no arguments).</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">/inj</td><td class="column-2">Injects the userland rootkit library into processes, as specified in the configuration file</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">(none)</td><td class="column-2">Main mode. Executes the 64-bit version of itself (if applicable), injects the userland rootkit, executes the RDS and hides the window by changing its coordinates to values outside the screen.<br />
Another thread captures pressed keystrokes.</td>
</tr>
</tbody>
</table>

<p>The main part of the BalkanRAT malware is a copy of the Remote Utilities software for remote access. Instead of using the official version, BalkanRAT deploys a copy signed by a certificate of the attacker.</p>
<p>The client side of the RDS running on the victim’s computer must know the unique ID and the password, both generated on the server side, to connect to the server. The RDS deployed by BalkanRAT is configured in such a way that the password is the same for all victims, and the generated unique ID is sent to the attacker’s email address by the tool itself.</p>
<p>Since the tool BalkanRAT misuses is legitimate, it leverages the genuine Remote Utilities’ infrastructure for this communication (rutils.com, server.rutils.com); due to this, the communication may seem legitimate to the user &#8211; and to security products.</p>
<p>As a result, the attacker has obtained credentials to access the compromised computer via the Remote Utilities software. Using this tool, they can broadcast the screen to monitor the activity of the user and manually take over the compromised computer.</p>
<div id="attachment_129022" style="width: 442px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-6_1.png"><img class="wp-image-129022 size-full" src="/wp-content/uploads/2019/08/Figure-6_1.png" alt="" width="432" height="344" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-6_1.png 432w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-6_1-300x239.png 300w" sizes="(max-width: 432px) 100vw, 432px" /></a><p class="wp-caption-text"><i>Figure 6. A window the victim never sees. With a legitimate copy of Remote Utilities, this window is visible; however, BalkanRAT will hide it using the GUI hider feature.</i></p></div>
<p>To remain stealthy, BalkanRAT uses the GUI hider feature. In most samples (some older ones are exceptions), it is implemented as an AutoHotKey script, compiled into an executable file so that it can be run on a computer even if AutoHotKey is not installed there. The purpose of this script is to hide the tray icon of the RDS client.</p>
<div id="attachment_129023" style="width: 944px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-7a.png"><img class="wp-image-129023 size-full" src="/wp-content/uploads/2019/08/Figure-7a.png" alt="" width="934" height="477" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-7a.png 934w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-7a-300x153.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-7a-768x392.png 768w" sizes="(max-width: 934px) 100vw, 934px" /></a><p class="wp-caption-text"><i>Figure 7. AutoHotKey script embedded in the resource section of the executable</i></p></div>
<p>Another notable feature used by BalkanRAT to stay hidden is the ability to hide processes from the user.</p>
<p>To achieve this, userland rootkit libraries are injected in processes hardcoded in the configuration file. The userland rootkit hooks the <span style="font-family: courier new, courier, monospace;">NtQuerySystemInformation</span> function for the process in which it is injected. In case <span style="font-family: courier new, courier, monospace;">SystemProcessInformation</span> is queried, it filters out all entries for processes with the names specified in the configuration file. As a result, conventional task manager utilities will not display the processes the attackers want to keep hidden from the user.</p>
<div id="attachment_128992" style="width: 944px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/08/Figure-8-1.png"><img class="wp-image-128992" src="/wp-content/uploads/2019/08/Figure-8-1.png" alt="" width="934" height="430" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-8-1.png 1008w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-8-1-300x138.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/08/Figure-8-1-768x354.png 768w" sizes="(max-width: 934px) 100vw, 934px" /></a><p class="wp-caption-text"><i>Figure 8. With the userland rootkit injected, some processes are missing in the list (left). Without the rootkit, the processes are visible (right).</i></p></div>
<p>Naturally, the list of processes that will be hidden contain mostly ones belonging to BalkanRAT. However, we have also seen names like “weather.exe” or “preserve.exe” in the list &#8211; which belong to the BalkanDoor backdoor. This finding supports the belief these two tools are indeed used together.</p>
<h1>Conclusion</h1>
<p>Both BalkanRAT and BalkanDoor have some interesting tricks up their sleeves and each of them separately pose a significant risk to the victims. If used together as a toolset, they make an even more powerful weapon – the campaign we have discovered targets accounting, a function that is critical for organizations.</p>
<p>The campaign targeting accountants in the Balkans shows some similarities (in terms of modus operandi) with a campaign aimed at Ukrainian notaries reported in 2016. (The only <a href="https://cys-centrum.com/ru/news/black_notaries_case" target="_blank" rel="noopener">source</a> we have been able to find describing it is in Russian.) In that case, the attackers’ goal was to take control over a notary&#8217;s computer and issue some illegal operation on behalf of the notary.</p>
<p>Just as attackers may confirm a fraudulent transaction on behalf of a notary, they may perform a fraudulent transaction while impersonating a manager in a company’s financial department.</p>
<p>To stay safe, business users – and their employers – should follow basic cybersecurity rules: be cautious about emails and scrutinize their attachments and links, keep their software updated and use a reputable security solution.</p>
<h1><big>Indicators of Compromise (IoCs)</big></h1>
<h2>ESET detection names</h2>
<p>Win32/BalkanDoor.A<br />
Win32/BalkanDoor.B<br />
Win32/BalkanRAT.A<br />
Win32/BalkanRAT.B<br />
Win64/BalkanRAT.A<br />
Win64/BalkanRAT.B</p>
<h2>SHA-1</h2>
<h3>BalkanDoor – executable files</h3>
<p><span style="font-family: courier new, courier, monospace;">02225C58A0800A8FFFE82F7614695FDEEB75C8B3</span><br />
<span style="font-family: courier new, courier, monospace;">3E8AF08F2C64D9D305A129FDEA6B24ED3D8D9484</span><br />
<span style="font-family: courier new, courier, monospace;">400FF3FD5BEF94DCBEAE24B5B8A6632DCD1D22A6</span><br />
<span style="font-family: courier new, courier, monospace;">576EF0057982DE87CA029C736706E840031A27F4</span><br />
<span style="font-family: courier new, courier, monospace;">5CC4F248595268A0C9988DAEE3F0F8F9F5AC0A7F</span><br />
<span style="font-family: courier new, courier, monospace;">60EB2A19EC63FF36D13F472EC0E6A594C2778CE6</span><br />
<span style="font-family: courier new, courier, monospace;">7AA3D6EA4736C3BF627DB1837B9C8D2B29D7AB8D</span><br />
<span style="font-family: courier new, courier, monospace;">AC5383306459CE8CD19BFF412875F093B40427C6</span></p>
<h3>BalkanRAT – executable and auxiliary files</h3>
<p><span style="font-family: courier new, courier, monospace;">006B8EF615550BA731A30FA83B0E03CD16D2A92D</span><br />
<span style="font-family: courier new, courier, monospace;">030DC8C3832F664FA10EFA3105DFF0A9B6D48911</span><br />
<span style="font-family: courier new, courier, monospace;">032884A46430039ED4E38518AA20742B79AB2678</span><br />
<span style="font-family: courier new, courier, monospace;">09D18CD045285A753BCF4F42C6F10AF76913546A</span><br />
<span style="font-family: courier new, courier, monospace;">0F7A95C89911E3DE9205FF6AA03E1A4FCE6BC551</span><br />
<span style="font-family: courier new, courier, monospace;">13D8664B438DA278CEB9C8593AE85023432054CD</span><br />
<span style="font-family: courier new, courier, monospace;">17EA62EBC5F86997FD7E303FBBFF3E343DA38FCC</span><br />
<span style="font-family: courier new, courier, monospace;">1C03ED1ADF4B4E786EFC00F3D892217FAAAFB268</span><br />
<span style="font-family: courier new, courier, monospace;">15EC88015FB554302DB131258C8C11C9E46209D4</span><br />
<span style="font-family: courier new, courier, monospace;">21DE3EB6F39DF4DBBF2D1FE4B6467AAE3D9FBEBD</span><br />
<span style="font-family: courier new, courier, monospace;">21EE61874F299661AECC5453F4D6D0EC5380DAD0</span><br />
<span style="font-family: courier new, courier, monospace;">270F1FA36365273F14D89EE852D8A438A594CD05</span><br />
<span style="font-family: courier new, courier, monospace;">30BA2213BE4355D619E20DA733F27F59DA7B937E</span><br />
<span style="font-family: courier new, courier, monospace;">3170B45FB642301687A3A320282099B9D7B7F0F2</span><br />
<span style="font-family: courier new, courier, monospace;">38E7FCD6038E688DEC9F1AF9D2D222B9BBC03A8C</span><br />
<span style="font-family: courier new, courier, monospace;">3927B48D315F6712D33166A3B278B7835E76A6A9</span><br />
<span style="font-family: courier new, courier, monospace;">3C1FF7BBE8BC2BE9E5531FFAD25B18F03C51CF6B</span><br />
<span style="font-family: courier new, courier, monospace;">421F52733D334BE32C899670426C06CB72D92CDE</span><br />
<span style="font-family: courier new, courier, monospace;">46E4B456729CF659527D2697BD8518E67B5A0056</span><br />
<span style="font-family: courier new, courier, monospace;">4F8BA64DA7EA16A7CE5AA2C83BBFCE1C8646E424</span><br />
<span style="font-family: courier new, courier, monospace;">500A447A187240706C059C16366FEDF1AA13EA77</span><br />
<span style="font-family: courier new, courier, monospace;">555844CA5CD40DFC27778C2D3B6AFA43D1B76685</span><br />
<span style="font-family: courier new, courier, monospace;">5A3201048D8D9D696102A3C3B98DA99C2CC4FF1F</span><br />
<span style="font-family: courier new, courier, monospace;">64E3A46BF393936A79478C891654C1070CEC42D1</span><br />
<span style="font-family: courier new, courier, monospace;">685314454A7D7987B38ADD2EDDBAC3DB9E78464F</span><br />
<span style="font-family: courier new, courier, monospace;">6C83ABE56219CA656B71AA8C109E0955061DA536</span><br />
<span style="font-family: courier new, courier, monospace;">6E27F7C61230452555B52B39AB9F51D42C725BED</span><br />
<span style="font-family: courier new, courier, monospace;">6EF16FAA19FC4CEF66C4C1B66E58FB9CFFD8098E</span><br />
<span style="font-family: courier new, courier, monospace;">72DB8CCC962E2D2C15AC30E98F7382E3ACDEDDA8</span><br />
<span style="font-family: courier new, courier, monospace;">730E20EE7228080A7F90A238D9E65D55EDD84301</span><br />
<span style="font-family: courier new, courier, monospace;">73E0A62F1AAAB3457D895B4B1E6E2119B8B8D167</span><br />
<span style="font-family: courier new, courier, monospace;">7BA4D127C6CD6B5392870F0272C7045C9932DB17</span><br />
<span style="font-family: courier new, courier, monospace;">7BF564891089377809D3F0C2C9E25FD087F5F42B</span><br />
<span style="font-family: courier new, courier, monospace;">8852647B1C1A2EFA4F25FEA393D773F9FF94D6FA</span><br />
<span style="font-family: courier new, courier, monospace;">8D9A804B1433A05216CFE1D4E61CE5EB092A3505</span><br />
<span style="font-family: courier new, courier, monospace;">8F85738534158DB9C600A29B9DED8AC85C3DE8C1</span><br />
<span style="font-family: courier new, courier, monospace;">963CF321740C4EF606FEC65FCE85FB3A9A6223AC</span><br />
<span style="font-family: courier new, courier, monospace;">97926E2A7514D4078CF51EAC069A014309E607F1</span><br />
<span style="font-family: courier new, courier, monospace;">9EA0C6A17EE4EB23371688972B7F4E6D4D53F3C8</span><br />
<span style="font-family: courier new, courier, monospace;">9F2C6A44453E882098B17B66DE70C430C64C3B26</span><br />
<span style="font-family: courier new, courier, monospace;">A1DEA762DD4329E77FE59526D4ABC0E15DE2BBBC</span><br />
<span style="font-family: courier new, courier, monospace;">A56A299A8EEF9F4FF082184F66FAD1B76C7CACB8</span><br />
<span style="font-family: courier new, courier, monospace;">A5ACE8F90C33CBDB12D398C0F227EC48F99551BF</span><br />
<span style="font-family: courier new, courier, monospace;">AA4AD783DFE3CC6B0B9612814ED9418253203C50</span><br />
<span style="font-family: courier new, courier, monospace;">AB311B53591C6625335B9B791676A44538B48821</span><br />
<span style="font-family: courier new, courier, monospace;">AEDF43347AF24D266EC5D471723F4B30B4ACC0D0</span><br />
<span style="font-family: courier new, courier, monospace;">B18222E93D25649BC1B67FAB4F9BF2B4C59D9A1A</span><br />
<span style="font-family: courier new, courier, monospace;">B8F67BB5682B26ACD5969D9C6AC7B45FE07E79E1</span><br />
<span style="font-family: courier new, courier, monospace;">BAD38D474D5CAAAC27082E6F727CAE269F64CF3C</span><br />
<span style="font-family: courier new, courier, monospace;">BEEF0EE9397B01855C6DAA2BFF8002DB4899B121</span><br />
<span style="font-family: courier new, courier, monospace;">BFE3F5CEC25181F1B6852E145013E548B920651E</span><br />
<span style="font-family: courier new, courier, monospace;">C268CAB6D8EC267EEE463672809FAAEE99C2F446</span><br />
<span style="font-family: courier new, courier, monospace;">C2F9FFDF518DA9E037F76902746DE89C2E2821E8</span><br />
<span style="font-family: courier new, courier, monospace;">C3813734D3BFC07E339C05417055A1A106E2FBBD</span><br />
<span style="font-family: courier new, courier, monospace;">C8CBBC175451A097E605E448F94C89D3E050ACD5</span><br />
<span style="font-family: courier new, courier, monospace;">C90756A3C6F6DC34E12BABF5F26543510AACE704</span><br />
<span style="font-family: courier new, courier, monospace;">C90B5471BBA3293C0A0E6829A81FBE2EB10B42B2</span><br />
<span style="font-family: courier new, courier, monospace;">CD1BC431F53E9CFF8204279CDF274838DE8EBB61</span><br />
<span style="font-family: courier new, courier, monospace;">CD82D898A3CEA623179456D9AE5FAD1FB5DA01A0</span><br />
<span style="font-family: courier new, courier, monospace;">CDBB74CA0960F2E8631D49ACABF2CEA878AE35B8</span><br />
<span style="font-family: courier new, courier, monospace;">CE7092FF909E9380CC647C3350AA3067E40C36A9</span><br />
<span style="font-family: courier new, courier, monospace;">CEA70DB7FB8E851EF0D6A257A41C9CEE904345B5</span><br />
<span style="font-family: courier new, courier, monospace;">CF7A8AFAC141E162A0204A49BAD0A49C259B5A45</span><br />
<span style="font-family: courier new, courier, monospace;">DEEA26F5AF918CEC406B4F12184F0CAB2755B602</span><br />
<span style="font-family: courier new, courier, monospace;">DFDFCC61770425A8D1520550C028D1DF2861E53F</span><br />
<span style="font-family: courier new, courier, monospace;">E0007A2E0E9AE47DD028029C402D7D0A08EBBC25</span><br />
<span style="font-family: courier new, courier, monospace;">E00C309E3FE09248B8AFCFF29FC1A79445C913DA</span><br />
<span style="font-family: courier new, courier, monospace;">E95C651C539EAF73E142D1867A1A96098A5E219F</span><br />
<span style="font-family: courier new, courier, monospace;">ECEEE01F4E8051F544062AE37D76A3DF2921DF82</span><br />
<span style="font-family: courier new, courier, monospace;">F06CB000F9A25DDE791C7E5BC30917C74A8F2876</span><br />
<span style="font-family: courier new, courier, monospace;">F26C663D5F6F534543A7C42B02254C98BB4EC0D5</span><br />
<span style="font-family: courier new, courier, monospace;">F3BC2F436693B61FED7FA7DDF8BC7F27618F24F3</span><br />
<span style="font-family: courier new, courier, monospace;">F6030AE46DC2CEF9C68DA1844F7DCEA4F25A90A3</span><br />
<span style="font-family: courier new, courier, monospace;">FA19E71F9A836EA832B5D738D833C721D776781A</span><br />
<span style="font-family: courier new, courier, monospace;">FFE23D510A24DB27C1C171D2BAF1FBEB18899039</span></p>
<h3>Remote Utilities (otherwise legitimate releases signed by attackers’ certificates)</h3>
<p><span style="font-family: courier new, courier, monospace;">038ECEB80597DE438D8194F8F57245EB0239FF4B</span><br />
<span style="font-family: courier new, courier, monospace;">2A1BB4BB455D3238A01E121165603A9B58B4D09D</span><br />
<span style="font-family: courier new, courier, monospace;">34CE3FBEE3C487F4F467B9E8EB36844BB5ACB465</span><br />
<span style="font-family: courier new, courier, monospace;">3B88D4047FA2B8F8FA6241320D81508EB676EA7A</span><br />
<span style="font-family: courier new, courier, monospace;">400438EB302886FD064274188647E6653E455EED</span><br />
<span style="font-family: courier new, courier, monospace;">42F70DAA8C75E97551935D2370142C8904F5A20D</span><br />
<span style="font-family: courier new, courier, monospace;">446D3FBAE9889FE59AFAD02C6FB71D8838C3FC67</span><br />
<span style="font-family: courier new, courier, monospace;">4D46FB773C02A9FF98E998DA4F0777FB5D9F796B</span><br />
<span style="font-family: courier new, courier, monospace;">510C93D3DC620B17500C10369585F4AF7CF3CE0D</span><br />
<span style="font-family: courier new, courier, monospace;">6A5CA3B9EE0A048F0AEE1E99CBF3943D84F597FF</span><br />
<span style="font-family: courier new, courier, monospace;">6D53E7B5099CE11ACA176519620E8064D4FF9AD0</span><br />
<span style="font-family: courier new, courier, monospace;">7CEC39AC6A436577E02E7E8FE8226A00E58564CB</span><br />
<span style="font-family: courier new, courier, monospace;">8888014C16732CD5136A8315127BA50BB8BB94ED</span><br />
<span style="font-family: courier new, courier, monospace;">A5A05BA6E24226F1BC575CBC12B9FC59F6039312</span><br />
<span style="font-family: courier new, courier, monospace;">B77CFFF0E359946029120DD642505BC0A9713ECC</span><br />
<span style="font-family: courier new, courier, monospace;">BC6F31D5EBC71FF83BACC0B4471FDEFC206B28D0</span><br />
<span style="font-family: courier new, courier, monospace;">BE8A582360FB16A4B515CD633227D6A002D142FA</span><br />
<span style="font-family: courier new, courier, monospace;">C6E62A113E95705F9B612CDBF49DAC6BAD2073BD</span><br />
<span style="font-family: courier new, courier, monospace;">D8D27C742DA87292EF19A197594193C2C5E5F845</span><br />
<span style="font-family: courier new, courier, monospace;">DBE0E084B2A8CE4711C3DF4E62E8062234BF6D3B</span><br />
<span style="font-family: courier new, courier, monospace;">E56189FE86C9537C28099518D4F4EA2E42EF9EEE</span><br />
<span style="font-family: courier new, courier, monospace;">E918192D2B5C565A9B2756A1D01070C6608F361C</span></p>
<h3>Scripts</h3>
<p><span style="font-family: courier new, courier, monospace;">0BD6C70B7E2320F42F0CFC2A79E161614C7C4F66</span><br />
<span style="font-family: courier new, courier, monospace;">7A41B912A3F99370DF4CD3791C91467E23B2AA82</span><br />
<span style="font-family: courier new, courier, monospace;">A15AB505B79B88A9E868C95CE544942403C58CB6</span><br />
<span style="font-family: courier new, courier, monospace;">A8A5980DE35FBF580497B43EF7E8499E004F9F38</span><br />
<span style="font-family: courier new, courier, monospace;">B248E43BAB127D8E1E466821B96B7B7ECF37CB78</span></p>
<h3>Configuration files</h3>
<p><span style="font-family: courier new, courier, monospace;">28F152154F6E6074EA0DE34214102119C8589583</span><br />
<span style="font-family: courier new, courier, monospace;">37A2A15C52CAA7D63AF86778C2DD1D2D81D4A270</span><br />
<span style="font-family: courier new, courier, monospace;">B4A847D7AAC4164CF90EA585E4842CBF938B26CF</span></p>
<h3>Decoy PDF files</h3>
<p><span style="font-family: courier new, courier, monospace;">1E0C4A5F0FF2E835D12C3B6571AE6000E81A014B</span><br />
<span style="font-family: courier new, courier, monospace;">8722441FF3678D154C89E312DB1A54951DD21C3F</span><br />
<span style="font-family: courier new, courier, monospace;">88C3FDA42768C5B465FD680591639F2CDC933283</span><br />
<span style="font-family: courier new, courier, monospace;">9F48E109675CDB0A53400358C27853DB48FCD156</span><br />
<span style="font-family: courier new, courier, monospace;">C9B592BD7B69995C75CD5B1E4261B229C27FB479</span></p>
<h2>Misused certificates</h2>

<table id="tablepress-741" class="tablepress tablepress-id-741">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Name</strong></th><th class="column-2"><strong>Email</strong></th><th class="column-3"><strong>Valid from</strong></th><th class="column-4"><strong>Valid to</strong></th><th class="column-5"><strong>SHA1 Thumbprint</strong></th><th class="column-6"><strong>Status at the time of writing</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">AMO-K&nbsp;Limited Liability Company</td><td class="column-2">llc.amo-k@list.ru</td><td class="column-3">2015/07/30</td><td class="column-4">2016/07/28</td><td class="column-5"><span style="font-family: courier new, courier, monospace;">4E36C4D10F1E3D820058E4D451C4A7B77856BDB3</span></td><td class="column-6">Expired</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Valmpak, TOV</td><td class="column-2">tov-valpak@mail.ru</td><td class="column-3">2016/04/10</td><td class="column-4">2017/04/01</td><td class="column-5"><span style="font-family: courier new, courier, monospace;">17D50E2DBBAF5F8F60BFFE1B90F4DD52FDB44A09</span></td><td class="column-6">Revoked</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Valmpak, TOV</td><td class="column-2">-</td><td class="column-3">2016/08/22</td><td class="column-4">2017/11/04</td><td class="column-5"><span style="font-family: courier new, courier, monospace;">4A362020F1AFD3BD0C67F12F55A5754D2E70338C</span></td><td class="column-6">Revoked</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">3D PEOPLE LIMITED</td><td class="column-2">-</td><td class="column-3">2017/11/05</td><td class="column-4">2018/11/06</td><td class="column-5"><span style="font-family: courier new, courier, monospace;">936EDFB338D458FBACB25FE557F26AA3E101506E</span></td><td class="column-6">Expired</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">ADUNIK LTD</td><td class="column-2">-</td><td class="column-3">2017/10/11</td><td class="column-4">2018/10/12</td><td class="column-5"><span style="font-family: courier new, courier, monospace;">E7DF448539D1E2671DCF787CF368AAC2ED8F5698</span></td><td class="column-6">Expired</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">SLOW BEER LTD</td><td class="column-2">administrator@<br/>slowbeerltd.info</td><td class="column-3">2019/01/25</td><td class="column-4">2019/12/18</td><td class="column-5"><span style="font-family: courier new, courier, monospace;">2359D644E48759F43993D34885167FECAFD40022</span></td><td class="column-6">Revoked</td>
</tr>
</tbody>
</table>

<h2></h2>
<h2>File names</h2>
<h3>BalkanDoor</h3>
<p><strong>Dropper:</strong> Zakon.exe<br />
<strong>Backdoors:</strong> weather.exe, winmihc.exe, Preserve.exe, PreservS.exe, WindowsConnect.exe<br />
<strong>Scripts:</strong> weather.cmd, winmihc4.cmd, mihcupdate.cmd<br />
<strong>Decoy PDF file:</strong> Zakon.pdf</p>
<h3>BalkanRAT</h3>
<p><strong>Droppers:</strong> ZPDGI.exe, ZPDGV.exe, ZPDGE.exe, ZPDGO.exe, ZPDGU.exe, ZPDGA.exe, Ponovljeni-Stav.exe, AUG_1031.exe, MIP1023.exe<br />
<strong>Configuration file:</strong> stg.cfg<br />
<strong>Decoy PDF files:</strong> ZPDG.pdf, Ponovljeni-Stav.pdf, AUG_1031.pdf, MIP1023.pdf<br />
<strong>Core component:</strong> winchk32.exe, wininit.exe, hide.exe, winchk64.exe<br />
<strong>RDS:</strong> rutserv.exe, rfusclient.exe<br />
<strong>Userland rootkit:</strong> winmmon.dll, winmmon64.dll<br />
<strong>GUI hider components:</strong> serk.bat, serk.exe</p>
<h2>Folder names</h2>
<p>%WINDIR%\1B20F6AA-6CAD-45A7-81CB-120FB86FECD8<br />
%WINDIR%\29D451CF-3548-4486-8465-A23029B8F6FA<br />
%WINDIR%\B1EDD68E-6AD8-4A7E-91A1-3C30903B8DD4<br />
%APPDATA%\1B20F6AA-6CAD-45A7-81CB-120FB86FECD8<br />
%APPDATA%\29D451CF-3548-4486-8465-A23029B8F6FA<br />
%APPDATA%\B1EDD68E-6AD8-4A7E-91A1-3C30903B8DD4</p>
<h2>C&amp;C servers</h2>
<p>http://bestfriendsroot[.]com/smart.php<br />
http://bestfriendsroot[.]com/weather.php<br />
http://bestfriendsroot[.]com/zagreb.php<br />
http://consaltingsolutionshere[.]com/smart.php<br />
http://consaltingsolutionshere[.]com/weather.php<br />
http://consaltingsolutionshere[.]com/zagreb.php<br />
http://dogvipcare[.]net/kversion.php<br />
http://hvar.dogvipcare[.]net/dekol.php<br />
http://kimdotcomfriends[.]com/smart.php<br />
http://kimdotcomfriends[.]com/weather.php<br />
http://kimdotcomfriends[.]com/zagreb.php<br />
http://limosinevipsalon[.]com/kversion.php<br />
http://luxembourgprotections[.]com/kversion.php<br />
http://malmevipbikes[.]se/kversion.php<br />
http://split.malmevipbikes[.]se/dekol.php<br />
http://zagreb.porezna-uprava[.]com/dekol.php</p>
<h2>Email addresses used to exfiltrate Remote Utilities credentials</h2>
<p>b.klokov@inbox.ru<br />
galkin.valentin.83@bk.ru<br />
gligorijmaskov@mail.ru<br />
ivan.aslanov@newmail.ru<br />
ivan.tatarov@qip.ru<br />
melikov.viktor@yandex.ru<br />
mr.aleksandrandreev@mail.ru<br />
test@bbportal.info<br />
tgerik@list.ru<br />
vladzlobin@list.ru</p>
<h1><big>MITRE ATT&amp;CK techniques</big></h1>
<h2>BalkanRAT</h2>

<table id="tablepress-742" class="tablepress tablepress-id-742">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1192/" rel="noopener" target="_blank">T1192</a></td><td class="column-3">Spearphishing Link</td><td class="column-4">BalkanRAT is distributed via emails that contain links to malware.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="4" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1059/" rel="noopener" target="_blank">T1059</a></td><td class="column-3">Command-Line Interface</td><td class="column-4">BalkanRAT uses <span style="font-family: courier new, courier, monospace;">cmd.exe</span> to execute files.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Execution through API</td><td class="column-4">BalkanRAT uses <span style="font-family: courier new, courier, monospace;">ShellExecuteExW</span> and <span style="font-family: courier new, courier, monospace;">LoadLibrary</span> APIs to execute other malware components.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">BalkanRAT uses batch scripts for malware installation and execution.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">BalkanRAT relies on the victim to execute the initial infiltration. The malware is disguised as PDF documents with misleading names, in order to entice the intended victim to click on it.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">BalkanRAT uses the following Registry Run key to establish persistence: [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows], “load”.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1134/" rel="noopener" target="_blank">T1134</a></td><td class="column-3">Access Token Manipulation</td><td class="column-4">BalkanRAT is able to impersonate the logged-on user using <span style="font-family: courier new, courier, monospace;">DuplicateTokenEx</span> or <span style="font-family: courier new, courier, monospace;">ImpersonateLoggedOnUser</span> APIs.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="9" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1116/" rel="noopener" target="_blank">T1116</a></td><td class="column-3">Code Signing</td><td class="column-4">BalkanRAT is digitally signed with code-signing certificates.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">BalkanRAT decrypts and decompresses some of its components.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1089/" rel="noopener" target="_blank">T1089</a></td><td class="column-3">Disabling Security Tools</td><td class="column-4">BalkanRAT is capable of adding exceptions to the local firewall, using its COM interface.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">BalkanRAT modifies the [HKEY_CURRENT_USER\Software\Usoris\Remote Utilities\Server\Parameters] registry key to store configuration of the RDS</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">Some components of BalkanRAT are compressed and then encrypted by a XOR cipher.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td><td class="column-3">Process Injection</td><td class="column-4">BalkanRAT injects a userland rootkit library into processes of task manager utilities.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1108/" rel="noopener" target="_blank">T1108</a></td><td class="column-3">Redundant Access</td><td class="column-4">Operators of BalkanRAT have been seen deploying a second malicious tool (BalkanDoor) to preserve remote access in case BalkanRAT is removed.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1014/" rel="noopener" target="_blank">T1014</a></td><td class="column-3">Rootkit</td><td class="column-4">BalkanRAT uses a userland rootkit that hooks the <span style="font-family: courier new, courier, monospace;">NtQuerySystemInformation</span> function to hide the presence of malicious processes.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1143/" rel="noopener" target="_blank">T1143</a></td><td class="column-3">Hidden Window</td><td class="column-4">BalkanRAT uses 3rd  party remote desktop software and hides its window and tray icon in order to hide it from the user.</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">BalkanRAT collects the computer name and the language settings from the compromised machine.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">BalkanRAT is capable of logging pressed keystrokes.</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1219/" rel="noopener" target="_blank">T1219</a></td><td class="column-3">Remote Access Tools</td><td class="column-4">BalkanRAT has misused legitimate remote desktop software for remote access.</td>
</tr>
</tbody>
</table>

<h2>BalkanDoor</h2>

<table id="tablepress-743" class="tablepress tablepress-id-743">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1192/" rel="noopener" target="_blank">T1192</a></td><td class="column-3">Spearphishing Link</td><td class="column-4">BalkanDoor is distributed via emails that contain links to download malware.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="6" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1059/" rel="noopener" target="_blank">T1059</a></td><td class="column-3">Command-Line Interface</td><td class="column-4">BalkanRAT uses <span style="font-family: courier new, courier, monospace;">cmd.exe</span> to create a remote shell.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Execution through API</td><td class="column-4">BalkanRAT uses <span style="font-family: courier new, courier, monospace;">ShellExecuteExW</span> and <span style="font-family: courier new, courier, monospace;">LoadLibrary</span> APIs to execute files.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1203/" rel="noopener" target="_blank">T1203</a></td><td class="column-3">Exploitation for Client Execution</td><td class="column-4">BalkanDoor can be distributed as an ACE archive disguised as a RAR archive, exploiting CVE-2018-20250 vulnerability in WinRAR to execute malicious code.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">BalkanDoor uses batch scripts for malware installation and execution.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1035/" rel="noopener" target="_blank">T1035</a></td><td class="column-3">Service Execution</td><td class="column-4">BalkanDoor’s backdoor can be executed as a service.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">BalkanDoor relies on the victim to execute the initial infiltration. The malware is disguised as PDF documents or RAR archives with misleading names, in order to entice the intended victim to click on it.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="2" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1050/" rel="noopener" target="_blank">T1050</a></td><td class="column-3">New Service</td><td class="column-4">BalkanDoor can be installed as a new service, mimicking legitimate Windows services.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">BalkanDoor can be installed in the Registry Run key, or dropped in the Startup folder.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1134/" rel="noopener" target="_blank">T1134</a></td><td class="column-3">Access Token Manipulation</td><td class="column-4">BalkanDoor is able to create a process under the security context of a different user, using <span style="font-family: courier new, courier, monospace;">DuplicateTokenEx</span>, <span style="font-family: courier new, courier, monospace;">SetTokenInformation</span> or <span style="font-family: courier new, courier, monospace;">CreateProcessAsUserW</span> APIs.</td>
</tr>
<tr class="row-12 even">
	<td rowspan="5" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1116/" rel="noopener" target="_blank">T1116</a></td><td class="column-3">Code Signing</td><td class="column-4">BalkanDoor is digitally signed with code-signing certificates.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">BalkanDoor deletes files with backdoor commands after the commands have been executed.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1158/" rel="noopener" target="_blank">T1158</a></td><td class="column-3">Hidden Files and Directories</td><td class="column-4">BalkanDoor sets attributes of its files to HIDDEN, SYSTEM and READONLY.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">BalkanDoor can be installed as a service with names mimicking legitimate Windows services.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1108/" rel="noopener" target="_blank">T1108</a></td><td class="column-3">Redundant Access</td><td class="column-4">Operators of BalkanDoor have been seen deploying a second malicious tool (BalkanRAT) to preserve remote access in case BalkanDoor is removed.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">BalkanDoor collects the computer name from the compromised machine.</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">BalkanDoor can capture screenshots of the compromised machine.</td>
</tr>
<tr class="row-19 odd">
	<td rowspan="4" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">BalkanDoor uses ports 80 and 443 for C&amp;C communication.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1090/" rel="noopener" target="_blank">T1090</a></td><td class="column-3">Connection Proxy</td><td class="column-4">BalkanDoor is capable of identifying a configured proxy server if one exists and then using it to make HTTP requests.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1008/" rel="noopener" target="_blank">T1008</a></td><td class="column-3">Fallback Channels</td><td class="column-4">BalkanDoor can communicate over multiple C&amp;C hosts.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">BalkanDoor uses HTTP or HTTPS for network communication.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-08-14 11:30:02">14 Aug 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="In the Balkans, businesses are under fire from a double&#8209;barreled weapon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="In the Balkans, businesses are under fire from a double&#8209;barreled weapon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="In the Balkans, businesses are under fire from a double&#8209;barreled weapon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="In the Balkans, businesses are under fire from a double&#8209;barreled weapon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F14%2Fbalkans-businesses-double-barreled-weapon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F14%2Fbalkans-businesses-double-barreled-weapon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F08%2F14%2Fbalkans-businesses-double-barreled-weapon%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"128972 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=128972","disqusShortname":"welivesecurity","disqusTitle":"In the Balkans, businesses are under fire from a double\u2011barreled weapon","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/08\/14\/balkans-businesses-double-barreled-weapon\/","postId":"128972"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>