<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group | WeLiveSecurity</title>
<meta name="description" content="Analysis of a backdoor linked to Stealth Falcon, an operator of targeted spyware attacks against journalists, activists and dissidents in the Middle East"/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/09/09/backdoor-stealth-falcon-group/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group | WeLiveSecurity" />
<meta property="og:description" content="Analysis of a backdoor linked to Stealth Falcon, an operator of targeted spyware attacks against journalists, activists and dissidents in the Middle East" />
<meta property="og:url" content="https://www.welivesecurity.com/2019/09/09/backdoor-stealth-falcon-group/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-09-09T09:30:34+00:00" />
<meta property="article:modified_time" content="2019-10-11T14:56:45+00:00" />
<meta property="og:updated_time" content="2019-10-11T14:56:45+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/09/stealth-falcon-backdoor.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/09/stealth-falcon-backdoor.jpg" />
<meta property="og:image:width" content="1600" />
<meta property="og:image:height" content="1100" />
<meta property="og:image:alt" content="stealth falcon backdoor" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Analysis of a backdoor linked to Stealth Falcon, an operator of targeted spyware attacks against journalists, activists and dissidents in the Middle East" />
<meta name="twitter:title" content="ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/09/stealth-falcon-backdoor.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2019/09/11/eset-descobre-backdoor-usado-por-grupo-que-realiza-operacoes-de-ciberespionagem/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/09/17/eset-a-decouvert-une-backdoor-non-documentee-utilisee-par-stealth-falcon/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/09/09/backdoor-stealth-falcon-group/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/09/10/descubren-backdoor-grupo-ciberespionaje/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/09/09/stealth-falcon-backdoor/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2019/09/11/eset-descobre-backdoor-usado-por-grupo-que-realiza-operacoes-de-ciberespionagem/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/09/17/eset-a-decouvert-une-backdoor-non-documentee-utilisee-par-stealth-falcon/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/09/10/descubren-backdoor-grupo-ciberespionaje/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/09/09/stealth-falcon-backdoor/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2019/09/11/eset-descobre-backdoor-usado-por-grupo-que-realiza-operacoes-de-ciberespionagem/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/09/17/eset-a-decouvert-une-backdoor-non-documentee-utilisee-par-stealth-falcon/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/09/10/descubren-backdoor-grupo-ciberespionaje/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/09/09/stealth-falcon-backdoor/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/09/stealth-falcon.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group</h1>
<div class="excerpt">ESET researchers discovered a backdoor linked to malware used by the Stealth Falcon group, an operator of targeted spyware attacks against journalists, activists and dissidents in the Middle East </div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-09-09 11:30:34">9 Sep 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F09%2Fbackdoor-stealth-falcon-group%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F09%2Fbackdoor-stealth-falcon-group%2F&text=ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F09%2Fbackdoor-stealth-falcon-group%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers discovered a backdoor linked to malware used by the Stealth Falcon group, an operator of targeted spyware attacks against journalists, activists and dissidents in the Middle East </p>
                            </div>

                            <p>Stealth Falcon is a threat group, active since 2012, that targets political activists and journalists in the Middle East. It has been tracked by the <a href="https://citizenlab.ca/about/" target="_blank" rel="noopener">Citizen Lab</a>, a non-profit organization focusing on security and human rights, which published an <a href="https://citizenlab.ca/2016/05/stealth-falcon/" target="_blank" rel="noopener">analysis</a> of a particular cyberattack in 2016. In January of 2019, Reuters published an <a href="https://www.reuters.com/investigates/special-report/usa-spying-raven/" target="_blank" rel="noopener">investigative report</a> into Project Raven, an initiative allegedly employing former NSA operatives and aiming at the same types of targets as Stealth Falcon.</p>
<p>Based on these two reports referring to the same targets and attacks, Amnesty International’s Senior Technologist, Claudio Guarnieri, has concluded that Stealth Falcon and Project Raven actually are the same group.</p>
<div id="attachment_129824" style="width: 610px" class="wp-caption aligncenter"><img class="wp-image-129824" src="/wp-content/uploads/2019/09/Figure.png" alt="" width="600" height="401" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure.png 900w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-300x200.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-768x513.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-97x65.png 97w" sizes="(max-width: 600px) 100vw, 600px" /><p class="wp-caption-text"><i>Figure 1.  Claudio Guarnieri has connected Stealth Falcon with Project Raven</i></p></div>
<p>Some technical information about Stealth Falcon has already been made public – notably, in the already mentioned analysis by the Citizen Lab.</p>
<p>The key component in the attack documented in the Citizen Lab report was a PowerShell-based backdoor, delivered via a weaponized document that was included in a malicious email.</p>
<p>Now, we have found a previously unreported binary backdoor we have named Win32/StealthFalcon. In this article, we disclose similarities between this binary backdoor and the PowerShell script with backdoor capabilities attributed to the Stealth Falcon group. We consider the similarities to be strong evidence that Win32/StealthFalcon was created by this group.</p>
<p>The Win32/StealthFalcon backdoor, which appears to have been created in 2015, allows the attacker to control the compromised computer remotely. We have seen a small number of targets in UAE, Saudi Arabia, Thailand, and the Netherlands; in the latter case, the target was a diplomatic mission of a Middle Eastern country. How the backdoor was distributed and executed on the target systems is beyond the scope of this investigation; our analysis focuses on its capabilities and its C&amp;C communication.</p>
<h1>C&amp;C communication</h1>
<p>In its communication with the C&amp;C server, Win32/StealthFalcon uses the standard Windows component <a href="https://docs.microsoft.com/en-us/windows/win32/bits/background-intelligent-transfer-service-portal" target="_blank" rel="noopener">Background Intelligent Transfer Service</a> (BITS), a rather unusual technique. BITS was designed to transfer large amounts of data without consuming a lot of network bandwidth, which it achieves by sending the data with throttled throughput so as not to affect the bandwidth needs of other applications. It is commonly used by updaters, messengers, and other applications designed to operate in the background. This means that BITS tasks are more likely to be <a href="https://www.secureworks.com/blog/malware-lingers-with-bits" target="_blank" rel="noopener">permitted by host-based firewalls</a>.</p>
<p>Compared with traditional communication via API functions, the BITS mechanism is exposed through a COM interface and thus harder for a security product to detect. Moreover, this design is reliable and stealthy. The transfer resumes automatically after being interrupted for reasons like a network outage, the user logging out, or a system reboot. Moreover, because BITS adjusts the rate at which files are transferred based on the bandwidth available, the user has no reason for suspicion.</p>
<p>Win32/StealthFalcon can switch the communication between two C&amp;C servers whose addresses are stored in a registry key, along with other configuration values, and can be updated by one of the backdoor commands. In case the backdoor fails to reach out to its C&amp;C servers, the backdoor removes itself from the compromised system after a preconfigured number of failed attempts.</p>
<h1>Capabilities</h1>
<p>Win32/StealthFalcon is a DLL file that, after execution, schedules itself as a task running on each user login. It only supports basic commands but displays a systematic approach to data collection, data exfiltration, employing further malicious tools, and updating its configuration.</p>

<table id="tablepress-750" class="tablepress tablepress-id-750">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Command name</th><th class="column-2">Functionality</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">K</td><td class="column-2">Uninstall itself</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">CFG</td><td class="column-2">Update configuration data</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">RC</td><td class="column-2">Execute the specified application</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">DL</td><td class="column-2">Write downloaded data to file</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">CF</td><td class="column-2">Prepare a file for exfiltration</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">CFW</td><td class="column-2">Exfiltrate and delete files</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">CFWD</td><td class="column-2">Not implemented/no operation</td>
</tr>
</tbody>
</table>

<p><em>Table 1. Backdoor commands</em></p>
<p>For example, the backdoor’s key capability, downloading and executing files, is achieved via regular checks for libraries named “win*.dll” or “std*.dll” in the directory the malware is executed from, and loading these libraries.</p>
<p>Furthermore, Win32/StealthFalcon collects files and prepares them for exfiltration by storing an encrypted copy with a hardcoded prefix in a temporary folder. It then regularly checks for such files and exfiltrates them automatically. After the files have been successfully exfiltrated, the malware safe-deletes all log files and collected files &#8211; before deleting the files, it rewrites them with random data &#8211; to prevent forensic analysis and recovery of the deleted data.</p>
<p>The configuration values are stored in the <span style="font-family: 'courier new', courier, monospace;">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Shell Extensions</span> registry key. All values are prefixed by the malware’s filename (without extension).</p>

<table id="tablepress-751" class="tablepress tablepress-id-751">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Value name suffix</th><th class="column-2">Content</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">-FontDisposition</td><td class="column-2">Randomly generated, 4-byte victim ID</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">-MRUData</td><td class="column-2">RC4-encrypted C&amp;C domain</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">-MRUList</td><td class="column-2">RC4-encrypted C&amp;C domain</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">-IconPosition</td><td class="column-2">Flag determining which of the C&amp;C domains should be used</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">-IconDisposition</td><td class="column-2">Number of seconds to sleep after each iteration of contacting the C&amp;C server</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">-PopupPosition</td><td class="column-2">Counter of failed attempts to reach the C&amp;C servers</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"></td><td class="column-2"></td>
</tr>
</tbody>
</table>

<p><em>Table 2. Configuration data stored in registry</em></p>
<h1>Possible trick to evade detection</h1>
<p>Of interest is a function that is executed before any malicious payload is started, and which seems redundant. It references 300+ imports, but does not use them at all. Instead, it always returns and continues with the payload afterward, without condition checks that would suggest it is an anti-emulation trick.</p>
<p><img class="aligncenter size-full wp-image-129825" src="/wp-content/uploads/2019/09/Figure2.png" alt="" width="556" height="875" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure2.png 556w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure2-191x300.png 191w" sizes="(max-width: 556px) 100vw, 556px" /></p>
<p><img class="aligncenter wp-image-129826 size-large" src="/wp-content/uploads/2019/09/Figure2b-1024x127.png" alt="" width="1024" height="127" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure2b-1024x127.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure2b-300x37.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure2b-768x95.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p><em>Figure 2. A function referencing hundreds of unused imports, possibly added to avoid detection of the malware</em></p>
<p>We don’t know the precise intention of this function, but we suspect it is either some attempt to evade detection, or some leftover from a larger framework used by the malware authors.</p>
<h1>Links to Stealth Falcon</h1>
<p>Both Win32/StealthFalcon and the PowerShell-based backdoor described in the <a href="https://citizenlab.ca/2016/05/stealth-falcon-appendices" target="_blank" rel="noopener">Citizen Lab analysis</a> share the same C&amp;C server: the address windowsearchcache[.]com was used as a “Stage Two C2 Server Domain” in the backdoor analyzed by the Citizen Lab, and also in one of the versions of Win32/StealthFalcon.</p>
<p>Both backdoors display significant similarities in code – although they are written in different languages, the underlying logic is preserved. Both use hardcoded identifiers (most probably campaign ID/target ID). In both cases, all network communication from the compromised host is prefixed with these identifiers and encrypted with RC4 using a hardcoded key.</p>
<p>For their C&amp;C server communication, they both use HTTPS but set specific flags for the connection to ignore the server certificate.</p>
<h1>Conclusion</h1>
<p>We discovered and analyzed a backdoor with an uncommon technique for C&amp;C communication – using Windows BITS – and some advanced techniques to hinder detection and analysis, and to ensure persistence and complicate forensic analysis. Similarities in the code and infrastructure with a previously known malware by Stealth Falcon drive us to the conclusion that the Win32/StealthFalcon backdoor is also the work of this threat group.</p>
<h1><big>Indicators of Compromise (IoCs)</big></h1>
<h2>ESET detection name</h2>
<p>Win32/StealthFalcon</p>
<h2>SHA-1</h2>
<p><span style="font-family: courier new, courier, monospace;">31B54AEBDAF5FBC73A66AC41CCB35943CC9B7F72</span><br />
<span style="font-family: courier new, courier, monospace;">50973A3FC57D70C7911F7A952356188B9939E56B</span><br />
<span style="font-family: courier new, courier, monospace;">244EB62B9AC30934098CA4204447440D6FC4E259</span><br />
<span style="font-family: courier new, courier, monospace;">5C8F83CC4FF57E7C67925DF4D9DAABE5D0CC07E2</span></p>
<h2>RC4 keys</h2>
<p><span style="font-family: courier new, courier, monospace;">258A4A9D139823F55D7B9DA1825D101107FBF88634A870DE9800580DAD556BA3</span><br />
<span style="font-family: courier new, courier, monospace;">2519DB0FFEC604D6C9A655CF56B98EDCE10405DE36810BC3DCF125CDE30BA5A2</span><br />
<span style="font-family: courier new, courier, monospace;">3EDB6EA77CD0987668B360365D5F39FDCF6B366D0DEAC9ECE5ADC6FFD20227F6</span><br />
<span style="font-family: courier new, courier, monospace;">8DFFDE77A39F3AF46D0CE0B84A189DB25A2A0FEFD71A0CD0054D8E0D60AB08DE</span></p>
<p><em>Note: Malware derives a second RC4 key by XORing each byte of the hardcoded key with 0x3D.</em></p>
<h2>Host-based indicators</h2>
<h3>Malware file names</h3>
<p>ImageIndexer.dll<br />
WindowsBackup.dll<br />
WindowsSearchCache.dll<br />
JavaUserUpdater.dll</p>
<h3>Log file name patterns</h3>
<p>%TEMP%\dsc*<br />
%TEMP%\sld*<br />
%TEMP%\plx*</p>
<h3>Registry keys/values</h3>
<p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Shell Extensions<br />
<span style="font-family: courier new, courier, monospace;">X-MRUList</span><br />
<span style="font-family: courier new, courier, monospace;">X-MRUData</span><br />
<span style="font-family: courier new, courier, monospace;">X-FontDisposition</span><br />
<span style="font-family: courier new, courier, monospace;">X-IconDisposition</span><br />
<span style="font-family: courier new, courier, monospace;">X-IconPosition</span><br />
<span style="font-family: courier new, courier, monospace;">X-PopupPosition</span><br />
X is the malware’s filename (without extension).</p>
<h2>Network indicators</h2>
<h3>BITS job names</h3>
<p>WindowsImages-<br />
WindowsBackup-<br />
WindowsSearchCache-<br />
ElectricWeb</p>
<h2>C&amp;C servers</h2>
<p>footballtimes[.]info<br />
vegetableportfolio[.]com<br />
windowsearchcache[.]com<br />
electricalweb[.]org<br />
upnpdiscover[.]org</p>
<h1>MITRE ATT&amp;CK techniques</h1>

<table id="tablepress-754" class="tablepress tablepress-id-754">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="4" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1059/" rel="noopener" target="_blank">T1059</a></td><td class="column-3">Command-Line Interface</td><td class="column-4">Malware uses <span style="font-family: courier new, courier, monospace;">cmd.exe</span> to execute some commands.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Execution through API</td><td class="column-4">Malware uses <span style="font-family: courier new, courier, monospace;">CreateProcessW</span> API for execution.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1085/" rel="noopener" target="_blank">T1085</a></td><td class="column-3">Rundll32</td><td class="column-4">Malware uses <span style="font-family: courier new, courier, monospace;">rundll32.exe</span> to load the backdoor DLL.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Malware schedules <span style="font-family: courier new, courier, monospace;">rundll32.exe</span> to be executed on each login, and subsequently to load the backdoor DLL.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Malware establishes persistence by scheduling a task that loads the backdoor on each user login.</td>
</tr>
<tr class="row-7 odd">
	<td rowspan="8" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1197/" rel="noopener" target="_blank">T1197</a></td><td class="column-3">BITS Jobs</td><td class="column-4">Malware uses BITS file transfer mechanism for network communication, in an attempt to avoid detection.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="2" class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td rowspan="2" class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Strings are encrypted with a custom XOR cipher.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-4">Configuration data and log files are encrypted with RC4, using a hardcoded key.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">Malware overwrites files with random data, and deletes them after exfiltration.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">Malware attempts to disguise itself by using seemingly-legitimate file names.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">Malware stores its configuration in a registry key.</td>
</tr>
<tr class="row-13 odd">
	<td rowspan="2" class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td rowspan="2" class="column-3">Obfuscated Files or Information</td><td class="column-4">Strings are encrypted with a custom XOR cipher.</td>
</tr>
<tr class="row-14 even">
	<td class="column-4">Configuration data and log files are encrypted with RC4, using a hardcoded key.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1063/" rel="noopener" target="_blank">T1063</a></td><td class="column-3">Security Software Discovery</td><td class="column-4">Malware terminates itself if McAfee Agent binary (<span style="font-family: courier new, courier, monospace;">cmdagent.exe</span>) is detected.</td>
</tr>
<tr class="row-16 even">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1074/" rel="noopener" target="_blank">T1074</a></td><td class="column-3">Data Staged</td><td class="column-4">Malware stores collected data in a temporary folder in files named with a hardcoded prefix.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">Malware has a command to collect/steal a file from the compromised system.</td>
</tr>
<tr class="row-18 even">
	<td rowspan="3" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1008/" rel="noopener" target="_blank">T1008</a></td><td class="column-3">Fallback Channels</td><td class="column-4">Malware is able to communicate with two C&amp;C servers; it also supports switching to a different C&amp;C server using a backdoor command.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1105/" rel="noopener" target="_blank">T1105</a></td><td class="column-3">Remote File Copy</td><td class="column-4">Malware uses BITS Jobs for C&amp;C communication.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Standard Cryptographic Protocol</td><td class="column-4">Malware encrypts C&amp;C communication using RC4 with a hardcoded key.</td>
</tr>
<tr class="row-21 odd">
	<td rowspan="3" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1020/" rel="noopener" target="_blank">T1020</a></td><td class="column-3">Automated Exfiltration</td><td class="column-4">Malware automatically exfiltrates files in a temporary folder in files named with a hardcoded prefix.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank">T1022</a></td><td class="column-3">Data Encrypted</td><td class="column-4">Malware encrypts the collected data using RC4 with a hardcoded key, prior to exfiltration.</td>
</tr>
<tr class="row-23 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Malware exfiltrates data over the C&amp;C channel.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-09-09 11:30:34">9 Sep 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F09%2Fbackdoor-stealth-falcon-group%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F09%2Fbackdoor-stealth-falcon-group%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F09%2Fbackdoor-stealth-falcon-group%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"129733 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=129733","disqusShortname":"welivesecurity","disqusTitle":"ESET discovered an undocumented backdoor used by the infamous Stealth Falcon group","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/09\/09\/backdoor-stealth-falcon-group\/","postId":"129733"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>