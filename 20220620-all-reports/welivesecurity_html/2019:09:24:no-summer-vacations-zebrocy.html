<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>No summer vacations for Zebrocy | WeLiveSecurity</title>
<meta name="description" content="ESET researchers break down new components in the Zebrocy malware family that the Sednit group has deployed in a recent campaign."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/09/24/no-summer-vacations-zebrocy/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="No summer vacations for Zebrocy | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers break down new components in the Zebrocy malware family that the Sednit group has deployed in a recent campaign." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/09/24/no-summer-vacations-zebrocy/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-09-24T09:30:57+00:00" />
<meta property="article:modified_time" content="2019-09-27T04:41:22+00:00" />
<meta property="og:updated_time" content="2019-09-27T04:41:22+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/09/zebrocy-2-M.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/09/zebrocy-2-M.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="647" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers break down new components in the Zebrocy malware family that the Sednit group has deployed in a recent campaign." />
<meta name="twitter:title" content="No summer vacations for Zebrocy | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/09/zebrocy-2-M.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2019/09/30/mudancas-no-malware-zebrocy-detectadas-na-ultima-campanha-do-grupo-sednit/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/09/25/ete-vacances-zebrocy/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/09/24/no-summer-vacations-zebrocy/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/09/25/cambios-malware-zebrocy-detectados-ultima-campana-grupo-sednit/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/09/26/sednit-zebrocy-malware-update/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2019/09/30/mudancas-no-malware-zebrocy-detectadas-na-ultima-campanha-do-grupo-sednit/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/09/25/ete-vacances-zebrocy/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/09/25/cambios-malware-zebrocy-detectados-ultima-campana-grupo-sednit/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/09/26/sednit-zebrocy-malware-update/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2019/09/30/mudancas-no-malware-zebrocy-detectadas-na-ultima-campanha-do-grupo-sednit/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/09/25/ete-vacances-zebrocy/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/09/25/cambios-malware-zebrocy-detectados-ultima-campana-grupo-sednit/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/09/26/sednit-zebrocy-malware-update/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/09/zebrocy-2.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>No summer vacations for Zebrocy</h1>
<div class="excerpt">ESET researchers describe the latest components used in a recent Sednit campaign</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-09-24 11:30:57">24 Sep 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F24%2Fno-summer-vacations-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F24%2Fno-summer-vacations-zebrocy%2F&text=No summer vacations for Zebrocy%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F24%2Fno-summer-vacations-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers describe the latest components used in a recent Sednit campaign</p>
                            </div>

                            <p>While summer is usually synonymous with vacations, it seems that the Sednit group has been developing new components to add to the Zebrocy malware family.</p>
<p>The Sednit group – also known as APT28, Fancy Bear, Sofacy or STRONTIUM – has been operating since at least 2004 and has made headlines frequently in recent years.</p>
<p>On August 20<sup>th</sup>, 2019, a new campaign was launched by the group targeting their usual victims – embassies of, and Ministries of Foreign Affairs in, Eastern European and Central Asian countries.</p>
<p>This latest campaign started with a phishing email containing a malicious attachment that launches a long chain of downloaders, ending with a backdoor. An example of such an email was uploaded to VirusTotal on August 22<sup>nd</sup>, two days after the mail was delivered. An overview of the attack vector was recently published by <a href="https://blog.telsy.com/zebrocy-dropbox-remote-injection" target="_blank" rel="noopener">Telsy TRT</a>.</p>
<p>However, we have some further pieces of this puzzle that could help to draw a more complete picture of the campaign.</p>
<p>As predicted by other fellow <a href="https://securelist.com/zebrocys-multilanguage-malware-salad/90680/" target="_blank" rel="noopener">researchers</a>, the Sednit group added a new development language in their toolset — more precisely, for their downloader: the Nim language. However, their developers were also busy improving their Golang downloader, as well as rewriting their backdoor from Delphi into Golang.</p>
<h1>A complicated compromise</h1>
<p>Figure 1 depicts the different steps leading to a victim being compromised, from the malicious email initially received in the inbox to the backdoor deployed on targets deemed “interesting enough” by the operators.</p>
<div id="attachment_130199" style="width: 405px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure2.jpg"><img class="wp-image-130199 size-full" src="/wp-content/uploads/2019/09/Figure2.jpg" alt="" width="395" height="881" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure2.jpg 395w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure2-135x300.jpg 135w" sizes="(max-width: 395px) 100vw, 395px" /></a><p class="wp-caption-text"><i>Figure 1. Chain of compromise overview </i></p></div>
<p>When a victim is targeted by Zebrocy’s components, the chain is usually quite loud. Loud because, in this case, the victim has at least six malicious components dropped on the computer before the final payload is executed. Such activities can easily raise different types of flags for a security product.</p>
<p>The document attached to the phishing email is blank, but references a remote template, <span style="font-family: courier new, courier, monospace;">wordData.dotm</span>, hosted at Dropbox. Opening this document in Word causes it to download <span style="font-family: courier new, courier, monospace;">wordData.dotm</span>, as seen in Figure 2, and to incorporate it into the associated document’s working environment, including any active content the template may contain.</p>
<div id="attachment_130200" style="width: 517px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure3.png"><img class="wp-image-130200 size-full" src="/wp-content/uploads/2019/09/Figure3.png" alt="" width="507" height="288" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure3.png 507w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure3-300x170.png 300w" sizes="(max-width: 507px) 100vw, 507px" /></a><p class="wp-caption-text"><i>Figure 2. Empty word document downloading a remote template</i></p></div>
<p>The <span style="font-family: courier new, courier, monospace;">wordData.dotm</span> file contains malicious macros that then are executed. (Depending on the Microsoft Word version, the VBA macros may be disabled by default; if so, user action is required to enable them.) It also contains an embedded ZIP archive that the macros dropped and extracted.</p>
<p>As shown in Figure 1, the macros in <span style="font-family: courier new, courier, monospace;">wordData.dotm</span> open another document (<span style="font-family: courier new, courier, monospace;">lmss.doc</span> that was unpacked from the archive extracted from <span style="font-family: courier new, courier, monospace;">wordData.dotm</span>). Macros in <span style="font-family: courier new, courier, monospace;">lmss.doc</span> execute <span style="font-family: courier new, courier, monospace;">lmss.exe</span> (Zebrocy’s new Nim downloader, also extracted from the archive embedded in <span style="font-family: courier new, courier, monospace;">wordData.dotm</span>) instead of <span style="font-family: courier new, courier, monospace;">wordData.dotm</span> executing the downloader directly.</p>
<p>However, it’s important to notice that <span style="font-family: courier new, courier, monospace;">lmss.doc</span>, containing the VBA code that executes the new Nim downloader, also embeds a base64-encoded executable. According to its Document Properties, <span style="font-family: courier new, courier, monospace;">lmss.doc</span> was created in January 2019 and modified on August 20<sup>th</sup>, a few hours before the campaign started.</p>
<div id="attachment_130227" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure4-1.png"><img class="wp-image-130227 size-large" src="/wp-content/uploads/2019/09/Figure4-1-1024x63.png" alt="" width="1024" height="63" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure4-1-1024x63.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure4-1-300x19.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure4-1-768x48.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 3. Creation and last modification dates of </i><span style="font-family: courier new, courier, monospace;"> lmss.doc</span></p></div>
<p>The executable embedded in <span style="font-family: courier new, courier, monospace;">lmss.doc</span> is an AutoIt downloader (SHA-1: <span style="font-family: courier new, courier, monospace;">6b300486d17d07a02365d32b673cd6638bd384f3</span>) used in the past for a campaign performed around the creation time of <span style="font-family: courier new, courier, monospace;">lmss.doc</span>. Here, the AutoIt downloader is ignored and doesn’t have any purpose other than making the size of the document bigger. The operator probably forgot to remove the previous embedded downloader – it would not be the first time that Sednit operators have made mistakes.</p>
<h1>The downloaders</h1>
<p>Sednit operators have used several downloaders written in different languages. This campaign uses the most recent extension of that list – a downloader written in the relatively new language, <a href="https://nim-lang.org/" target="_blank" rel="noopener">Nim</a>. It’s a straightforward download-and-execute binary with two small details added. The first is probably used as an anti-sandbox trick and it checks that the first letter of the executed file (letter <span style="font-family: courier new, courier, monospace;">l</span> here or <span style="font-family: courier new, courier, monospace;">0x6C</span> in hex) has not changed.</p>
<div id="attachment_130202" style="width: 518px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure5.png"><img class="wp-image-130202" src="/wp-content/uploads/2019/09/Figure5.png" alt="" width="508" height="293" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure5.png 558w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure5-300x173.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure5-257x149.png 257w" sizes="(max-width: 508px) 100vw, 508px" /></a><p class="wp-caption-text"><i>Figure 4. Filename check</i></p></div>
<p>The second is a kind of obfuscation where the operator replaces placeholder letters in a string with the correct ones, at defined offsets. As seen in Figure 5, the downloader reconstructs the correct download URL string with this method to avoid basic static analysis tools that could otherwise locate the URL string.</p>
<div id="attachment_130260" style="width: 357px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure-5-new.png"><img class="wp-image-130260 size-full" src="/wp-content/uploads/2019/09/Figure-5-new.png" alt="" width="347" height="687" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-5-new.png 347w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-5-new-152x300.png 152w" sizes="(max-width: 347px) 100vw, 347px" /></a><p class="wp-caption-text"><i>Figure 5. Hex-Rays output of the strings deobfuscation</i></p></div>
<p>For example, the string <span style="font-family: courier new, courier, monospace;">o-ps-c..ll</span> is “patched” at three offsets by <span style="font-family: courier new, courier, monospace;">s</span>, <span style="font-family: courier new, courier, monospace;">v</span> and <span style="font-family: courier new, courier, monospace;">d</span>, respectively, to give <span style="font-family: courier new, courier, monospace;">ospsvc.dll</span>. In the case of the URL, since the beginning of the string in the downloader is <span style="font-family: courier new, courier, monospace;">h@@p://</span>, tools looking for <span style="font-family: courier new, courier, monospace;">http://</span> won’t catch it.</p>
<p>The Nim downloader fetches its dynamic-link library (DLL) payload, named <span style="font-family: courier new, courier, monospace;">ospsvc.dll</span>, to <span style="font-family: courier new, courier, monospace;">C:\ProgramData\Java\Oracle\</span>, and executes it as a service via <span style="font-family: courier new, courier, monospace;">regsvr32 /s</span>.</p>
<p><span style="font-family: courier new, courier, monospace;">ospsvc.dll</span> is a downloader written in <a href="https://golang.org/">Golang</a>, and different from other Sednit downloaders seen in the past.</p>
<p>Sednit’s previous Golang downloaders have been described in detail by other researchers [1][2][3] and it seems that Sednit’s developers have rewritten their previous Delphi downloader in Golang. Those earlier downloaders gather a lot of information about the victim computer and send it to their C&amp;C server. However, this new one is quite light in terms of its data-gathering capabilities, as described below.</p>
<p>Its function <span style="font-family: courier new, courier, monospace;">main_init()</span> contains libraries that are initialized and don’t need further explanations due to their names (see this <a href="https://www.vkremez.com/2018/12/lets-learn-dissecting-apt28sofacy.html" target="_blank" rel="noopener">article</a> for more information).</p>
<div id="attachment_130265" style="width: 208px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure-6-new.png"><img class="wp-image-130265 size-full" src="/wp-content/uploads/2019/09/Figure-6-new.png" alt="" width="198" height="326" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-6-new.png 198w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure-6-new-182x300.png 182w" sizes="(max-width: 198px) 100vw, 198px" /></a><p class="wp-caption-text"><i>Figure 6. Hex-Rays output of initialized functions in the </i><span style="font-family: courier new, courier, monospace;"> main_init() </span><i>using the IDAGolangHelper plugin</i></p></div>
<p>Since the DLL is run as a service, via the Nim downloader, we need to look at <span style="font-family: courier new, courier, monospace;">main_DllRegisterServer() </span>instead of <span style="font-family: courier new, courier, monospace;">main_main()</span>. The strings and the key are stacked and they can be decrypted using a simple XOR loop. This simple encryption is quite efficient against tools that extract strings stacked from binaries statically.</p>
<div id="attachment_130205" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure8.png"><img class="wp-image-130205 size-large" src="/wp-content/uploads/2019/09/Figure8-1024x518.png" alt="" width="1024" height="518" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure8-1024x518.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure8-300x152.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure8-768x389.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure8.png 1211w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 7. IDA Pro output of encrypted strings stacked</i></p></div>
<p>Aside from downloading the next stage of the malware, taking screenshots of the victim’s desktop and executing commands received from the C&amp;C server are the main functions of this malware.</p>
<p>Screenshots are taken every 35 seconds during the first few minutes of this downloader’s execution, and then they are sent to the C&amp;C server in base64-encoded form. The hostname and the <span style="font-family: courier new, courier, monospace;">%USERPROFILE%</span> values are also sent to the C&amp;C server encoded in base64. The reply from the C&amp;C server is also straightforward: it’s a concatenation of base64-encoded strings, separated by “|”.</p>
<p><span style="font-family: courier new, courier, monospace;">&lt;spaces&gt;|&lt;cmd to execute&gt;|&lt;name of the binary to drop&gt;|&lt;binary to drop&gt;</span></p>
<p>According to our telemetry, this downloader has been used to execute three different pieces of malware. The first one is the dumper that we described in our previous Zebrocy <a href="https://www.welivesecurity.com/2019/05/22/journey-zebrocy-land/">article</a>. The second one is the usual Delphi backdoor – also run as a service via the same command used by the Nim downloader. The third one we saw is a new backdoor downloaded and executed on the victim’s machine, as described in the next section.</p>
<h1><big>The new backdoor</big></h1>
<h2>Analysis</h2>
<p>The new Zebrocy backdoor is not written in Delphi as we are used to, but in Golang. To the best of our knowledge, this is the first time this backdoor has been seen, but it shares a lot of similarities with the Delphi one.</p>
<p>By looking again at the <span style="font-family: courier new, courier, monospace;">main_init()</span> function’s library initialization code (Figure 8) we can see new entries. An AES algorithm, hex encoding, and screenshot capabilities are the main entries that were added.</p>
<div id="attachment_130206" style="width: 461px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/09/Figure9.png"><img class="wp-image-130206 size-large" src="/wp-content/uploads/2019/09/Figure9-451x1024.png" alt="" width="451" height="1024" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure9-451x1024.png 451w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure9-132x300.png 132w, https://www.welivesecurity.com/wp-content/uploads/2019/09/Figure9.png 528w" sizes="(max-width: 451px) 100vw, 451px" /></a><p class="wp-caption-text"><i>Figure 8. Diff between the backdoor and the downloader functions initialized in the </i><span style="font-family: courier new, courier, monospace;">main_init()</span></p></div>
<p>Notice that <span style="font-family: courier new, courier, monospace;">image_png_init</span> replaces <span style="font-family: courier new, courier, monospace;">image_jpeg_init</span> for taking screenshots. Images in JPG format are usually smaller in size than the PNG format.</p>
<p>The backdoor is started with an argument that is a hex-encoded string. All but the last six-byte chunk of this string is XOR-encrypted with the key stored in the last six bytes of the string. The following python snippet describes the decryption logic.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bd76376f091758619" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
key = arg[-6:].decode('hex')
enc = arg[:-6].decode('hex')
''.join(chr(ord(i) ^ ord(j)) for i, j in zip(itertools.cycle(key), enc))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bd76376f091758619-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bd76376f091758619-2">2</div><div class="crayon-num" data-line="crayon-60581bd76376f091758619-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bd76376f091758619-1"><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">arg</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'hex'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bd76376f091758619-2"><span class="crayon-v">enc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">arg</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'hex'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581bd76376f091758619-3"><span class="crayon-s">''</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-k ">chr</span><span class="crayon-sy">(</span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-k ">itertools</span><span class="crayon-sy">.</span><span class="crayon-e">cycle</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">enc</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>It’s the address of the C&amp;C server, which is later encrypted and stored on disk. That encryption is done using the AES-128 ECB algorithm with a key generated from the hostname. Hence, there is no possibility to obtain this C&amp;C server just by looking at the binary. There is no persistence defined by the downloaders as we have seen in the past, nor does the backdoor have any persistence mechanism.</p>
<p>This new backdoor has various capabilities that were also previously seen in Zebrocy’s Delphi backdoor:</p>
<ul>
<li>file manipulation such as creation, modification, and deletion</li>
<li>screenshot capabilities</li>
<li>drive enumeration</li>
<li>command execution (via <span style="font-family: courier new, courier, monospace;">cmd.exe</span>)</li>
<li>schedule a task under the following name <span style="font-family: courier new, courier, monospace;">Windows\Software\OSDebug</span> (which the operators could use to set persistence manually)</li>
</ul>
<p>As in the Delphi backdoor, there is a very limited set of commands – but the ability to execute arbitrary commands via <span style="font-family: courier new, courier, monospace;">cmd.exe</span> extends possibilities like persistence or information gathering. Another similarity found is a three-digit version number (in the format <span style="font-family: courier new, courier, monospace;">x.y.z</span>); the current major version is 4.y.z.</p>
<h2>Network</h2>
<p>The network protocol shares some similarities with the Delphi version of the backdoor. The first interaction with the C&amp;C server retrieves an AES 32-bit key to encrypt future communications. The packet capture of that first request looks like this:<br />
<small><br />
<span style="font-family: courier new, courier, monospace;">POST [REDACTED URI] HTTP/1.1</span><br />
<span style="font-family: courier new, courier, monospace;">Host: [REDACTED IP]</span><br />
<span style="font-family: courier new, courier, monospace;">User-Agent: Go-http-client/1.1</span><br />
<span style="font-family: courier new, courier, monospace;">Content-Length: 297</span><br />
<span style="font-family: courier new, courier, monospace;">Content‑Type: multipart/form‑data; boundary=b116f1e0a94eff1bb406531e74bb0feba65687cf90ec8a64fc409f230fbd</span><br />
<span style="font-family: courier new, courier, monospace;">Accept-Encoding: gzip</span><br />
</small><small><br />
<span style="font-family: courier new, courier, monospace;">&#8211;b116f1e0a94eff1bb406531e74bb0feba65687cf90ec8a64fc409f230fbd</span><br />
<span style="font-family: courier new, courier, monospace;">Content-Disposition: form-data; name=&#8221;filename&#8221;; filename=&#8221;[REDACTED]&#8221;</span><br />
<span style="font-family: courier new, courier, monospace;">Content-Type: application/octet-stream</span><br />
</small><br />
<small><span style="font-family: courier new, courier, monospace;">1</span><br />
<span style="font-family: courier new, courier, monospace;">&#8211;b116f1e0a94eff1bb406531e74bb0feba65687cf90ec8a64fc409f230fbd&#8211;</span><br />
</small><br />
Those with experience with Sednit might think that the <span style="font-family: courier new, courier, monospace;">Content-Disposition</span> and <span style="font-family: courier new, courier, monospace;">boundary</span> keywords look familiar. They were previously used by the <a href="https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/" target="_blank" rel="noopener">Delphi backdoor</a> in its network protocol; it also uses the AES algorithm to encrypt the pseudo body (content after the <span style="font-family: courier new, courier, monospace;">Content-Type</span> data). Notice that even if <span style="font-family: courier new, courier, monospace;">Content-Disposition</span> and the second instance of <span style="font-family: courier new, courier, monospace;">Content-Type</span> are real HTTP headers, here they are used inside the HTTP message body. The <span style="font-family: courier new, courier, monospace;">boundary</span> field is randomized for every exchange and the <span style="font-family: courier new, courier, monospace;">filename</span> field inside the pseudo <span style="font-family: courier new, courier, monospace;">Content‑Disposition</span> header can be decrypted with the following snippet of Python:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bd76377a349709674" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
len_filename = len(filename)
len_key = 14
xor_key = filename[-len_key:].decode('hex')
filename = filename[:len_filename-len_key].decode('hex')
val_filename = ''.join(chr(ord(i)^ord(j)) for i,j in zip(itertools.cycle(xor_key),filename))
random_int = val_filename[-4:]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bd76377a349709674-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bd76377a349709674-2">2</div><div class="crayon-num" data-line="crayon-60581bd76377a349709674-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bd76377a349709674-4">4</div><div class="crayon-num" data-line="crayon-60581bd76377a349709674-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581bd76377a349709674-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bd76377a349709674-1"><span class="crayon-v">len_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bd76377a349709674-2"><span class="crayon-v">len_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span></div><div class="crayon-line" id="crayon-60581bd76377a349709674-3"><span class="crayon-v">xor_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">len_key</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'hex'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bd76377a349709674-4"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">len_filename</span><span class="crayon-o">-</span><span class="crayon-v">len_key</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'hex'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60581bd76377a349709674-5"><span class="crayon-v">val_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-k ">chr</span><span class="crayon-sy">(</span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-k ">itertools</span><span class="crayon-sy">.</span><span class="crayon-e">cycle</span><span class="crayon-sy">(</span><span class="crayon-v">xor_key</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581bd76377a349709674-6"><span class="crayon-v">random_int</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">val_filename</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>which results in the following string:</p>
<p><span style="font-family: courier new, courier, monospace;">757365722D504318162020190821151055207C.inc</span></p>
<p>That string can be further understood thus:</p>
<p><span style="font-family: courier new, courier, monospace;">Username: 757365722D5043</span><br />
<span style="font-family: courier new, courier, monospace;">SID*: 181620</span><br />
<span style="font-family: courier new, courier, monospace;">Date: 20190821151055</span><br />
<span style="font-family: courier new, courier, monospace;">Random: 207C.inc</span></p>
<p>* 6 bytes comes from the current user’s Security Identifiers (SID) <span style="font-family: courier new, courier, monospace;">S-1-5-21‑xxxxxxxxx‑yyyyyyyyyy‑<strong>zzzzzz</strong>zzzz‑1000</span></p>
<p>Further interactions with the C&amp;C server follow this pattern except that the pseudo body, which is 1 in the example above, is replaced by the output of the command requested by the C&amp;C server. The full message body is also encrypted, using the same AES algorithm used previously, with the key provided in the first exchange.</p>
<h1>Conclusion</h1>
<p>New downloaders, new backdoor – the Sednit group has been active and is not letting their components get too old. New? Not really. By looking at it, it seems that the Sednit group is porting the original code to, or reimplementing it in, other languages in the hope of evading detection. It&#8217;s probably easier that way and it means they do not need to change their entire TTPs. The initial compromise vector stays unchanged, but using a service like Dropbox to download a remote template is unusual for the group.</p>
<p>ESET recommends being attentive when users are opening attachments from suspicious emails.</p>
<p>We will continue to monitor new activities from the Sednit group and will publish relevant information on our blog. For any inquiries, contact us at threatintel@eset.com.</p>
<h1>Indicators of Compromise (IoCs)</h1>

<table id="tablepress-755" class="tablepress tablepress-id-755">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Hashes (SHA-1)</th><th class="column-2">Filenames</th><th class="column-3">ESET detection names</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">c613fcccb380f7e3ce157c4f620efca503c1bad3</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">- (eml file)</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">DOC/TrojanDownloader.Agent.AMY</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">6f281b30d8d6a9bc1dbe2fe73995aac382c4a543</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">612243236.docx</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">DOC/TrojanDownloader.Agent.AMY</span></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">f3f945fb22916f82cb7407cde2a80a68cd83b074</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">wordData.dotm</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">VBA/TrojanDropper.Agent.AIP</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">a56af5b44624e8ada60057fd7f39af5b3de10724</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">lmss.zip</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">Win32/TrojanDownloader.Sednit.BK</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">b8ac400e1deb6e90fa4e2adb150c511c98bafc6e</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">lmss.doc</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">VBA/TrojanDropper.Agent.AIQ</span></td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">f0793e02180f3ccf48e41bd67ec1161d93f07e01</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">lmss.exe</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">Win32/TrojanDownloader.Sednit.BK</span></td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">04303024ff453f918925d7160abbd199f137a442</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">ospsvc.dll</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">Win32/Sednit.DI</span></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">c96db85ece2b57a9e82ba36b5f31ca9d2051a6f0</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">osppsvc.exe</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">Win32/Sednit.DJ</span><br />
</td>
</tr>
</tbody>
</table>

<h2>Network</h2>
<p><span style="font-family: courier new, courier, monospace;">https://www.dropbox[.]com/s/foughx315flj51u/wordData.dotm?dl=1</span></p>
<p><span style="font-family: courier new, courier, monospace;">185.221.202[.]35</span></p>
<h1>MITRE ATT&amp;CK techniques</h1>

<table id="tablepress-756" class="tablepress tablepress-id-756">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1193/" rel="noopener" target="_blank">T1193</a></td><td class="column-3">Spearphishing Attachment</td><td class="column-4">Zebrocy is using spearphishing emails with an attachment as method of compromise.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="5" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1059/" rel="noopener" target="_blank">T1059</a></td><td class="column-3">Command-Line Interface</td><td class="column-4">The Golang backdoor uses cmd.exe to execute commands.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1117/" rel="noopener" target="_blank">T1117</a></td><td class="column-3">Regsvr32</td><td class="column-4">The Nim downloader uses <span style="font-family: courier new, courier, monospace;">regsvr32.exe</span> to launch the Golang downloader.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">The Golang backdoor can create a pre-defined scheduled task.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">The remote template contains VBA used to execute the next stage of the malware.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">Zebrocy attempts to get users to click on Microsoft Office attachments containing malicious macro scripts.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">The Golang backdoor can create a pre-defined scheduled task.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">The Golang backdoor can create a pre-defined scheduled task.</td>
</tr>
<tr class="row-10 even">
	<td rowspan="3" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">The Golang backdoor can delete files.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1117/" rel="noopener" target="_blank">T1117</a></td><td class="column-3">Regsvr32</td><td class="column-4">The Nim downloader uses <span style="font-family: courier new, courier, monospace;">regsvr32.exe</span> to launch the Golang downloader.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">The remote template contains VBA used to execute the next stage of the malware.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">The Golang backdoor can list drives.</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">HTTP is used for C&amp;C communications.</td>
</tr>
<tr class="row-15 odd">
	<td rowspan="5" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">All components are using port 80 to communicate with the C&amp;C server.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1024/" rel="noopener" target="_blank">T1024</a></td><td class="column-3">Custom Cryptographic Protocol</td><td class="column-4">The Golang backdoor is using an XOR loop for its communications.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1132/" rel="noopener" target="_blank">T1132</a></td><td class="column-3">Data Encoding</td><td class="column-4">The Golang backdoor base64- encodes the data before encrypting it.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">HTTP is used for C&amp;C communications.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1032/" rel="noopener" target="_blank">T1032</a></td><td class="column-3">Standard Cryptographic Protocol</td><td class="column-4">The Golang backdoor encrypts communications with the C&amp;C server with AES ECB.</td>
</tr>
<tr class="row-20 even">
	<td rowspan="2" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank">T1022</a></td><td class="column-3">Data Encrypted</td><td class="column-4">The Golang backdoor encrypts the data with AES ECB before sending it over the C&amp;C server.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">The Golang backdoor exfiltrates data to its C&amp;C server.</td>
</tr>
</tbody>
</table>

<h3>References:</h3>
<p>[1] <a href="https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/" target="_blank" rel="noopener">https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/</a><br />
[2] <a href="https://securelist.com/a-zebrocy-go-downloader/89419/" target="_blank" rel="noopener">https://securelist.com/a-zebrocy-go-downloader/89419/</a><br />
[3] <a href="https://www.vkremez.com/2018/12/lets-learn-dissecting-apt28sofacy.html" target="_blank" rel="noopener">https://www.vkremez.com/2018/12/lets-learn-dissecting-apt28sofacy.html</a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-09-24 11:30:57">24 Sep 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="No summer vacations for Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="No summer vacations for Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="No summer vacations for Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="No summer vacations for Zebrocy">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F24%2Fno-summer-vacations-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F24%2Fno-summer-vacations-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F09%2F24%2Fno-summer-vacations-zebrocy%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"130039 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=130039","disqusShortname":"welivesecurity","disqusTitle":"No summer vacations for Zebrocy","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/09\/24\/no-summer-vacations-zebrocy\/","postId":"130039"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>