<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Zuzana Hromcová',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>ESET discovers Attor, a spy platform with curious GSM fingerprinting | WeLiveSecurity</title>
<meta name="description" content="ESET experts discover a previously unreported cyberespionage platform used in targeted attacks against privacy-concerned users in diplomatic missions and governmental institutions."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ESET discovers Attor, a spy platform with curious GSM fingerprinting | WeLiveSecurity" />
<meta property="og:description" content="ESET experts discover a previously unreported cyberespionage platform used in targeted attacks against privacy-concerned users in diplomatic missions and governmental institutions." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-10-10T09:30:41+00:00" />
<meta property="article:modified_time" content="2019-10-22T13:44:24+00:00" />
<meta property="og:updated_time" content="2019-10-22T13:44:24+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/10/attor-2-e1570631579913.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/10/attor-2-e1570631579913.jpg" />
<meta property="og:image:width" content="1001" />
<meta property="og:image:height" content="598" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET experts discover a previously unreported cyberespionage platform used in targeted attacks against privacy-concerned users in diplomatic missions and governmental institutions." />
<meta name="twitter:title" content="ESET discovers Attor, a spy platform with curious GSM fingerprinting | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/10/attor-2-e1570631579913.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/10/11/attor-plataforma-espia-fingerprinting-dispositivos-gsm/" hreflang="es" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/10/11/attor-plataforma-espia-fingerprinting-dispositivos-gsm/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/10/11/attor-plataforma-espia-fingerprinting-dispositivos-gsm/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/10/attor.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>ESET discovers Attor, a spy platform with curious GSM fingerprinting</h1>
<div class="excerpt">ESET researchers discover a previously unreported cyberespionage platform used in targeted attacks against diplomatic missions and governmental institutions, and privacy-concerned users</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2018/06/zuzana.hromcova@eset.sk_-222x179.jpg" alt="Zuzana Hromcová">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-10-10 11:30:41">10 Oct 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F10%2Feset-discovers-attor-spy-platform%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F10%2Feset-discovers-attor-spy-platform%2F&text=ESET discovers Attor, a spy platform with curious GSM fingerprinting%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F10%2Feset-discovers-attor-spy-platform%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers discover a previously unreported cyberespionage platform used in targeted attacks against diplomatic missions and governmental institutions, and privacy-concerned users</p>
                            </div>

                            <p>ESET researchers have discovered a new espionage platform with a complex architecture, a host of measures to make detection and analysis more difficult and two notable features. First, its GSM plugin uses the AT command protocol, and second, it uses Tor for its network communications. ESET researchers thus named the cyberespionage platform Attor.</p>
<div class="nwg-promo document clearfix">
            <div class="text">
                <p>
                     <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Attor.pdf" target="_blank">AT commands, TOR-based communications: Meet Attor, a&nbsp;fantasy creature and also a spy platform</a>
                </p>
                <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Attor.pdf" class="my-btn document" target="_blank">
                    Download Research Paper
                </a>
            </div>
            <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Attor.pdf" target="_blank" class="no-fancy download">
                <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/pdf-document-big.png" alt="" class="document">
            </a>
        </div>
<h2>Targets</h2>
<p>Attor’s espionage operation is highly targeted – we were able to trace Attor’s operation back to at least 2013, yet we only identified a few dozen victims. Despite that, we were able to learn more about the intended victims by analyzing artifacts in the malware.</p>
<p>For example, in order to be able to report on the victim’s activities, Attor monitors active processes to take screenshots of selected applications. Only certain applications are targeted – those with specific substrings in the process name or window title.</p>
<p>Besides standard services such as popular web browsers, instant messaging applications and email services, the list of targeted applications contains several Russian services, as detailed in Table 1.</p>

<table id="tablepress-764" class="tablepress tablepress-id-764">
<thead>
<tr class="row-1 odd">
	<th colspan="2" class="column-1"><center>Table 1. Domains misused in the campaign</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Process name/window title substring</strong></td><td class="column-2"><strong>Context</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">ОДНОКЛАССНИКИ (transl. Classmates)</td><td class="column-2">Russian social network (<a href="https://ok.ru/" rel="noopener" target="_blank">Odnoklassniki</a>) </td>
</tr>
<tr class="row-4 even">
	<td class="column-1">AGENTVKONTAKTE</td><td class="column-2">Russian social network (<a href="https://vk.com/" rel="noopener" target="_blank">VKontakte</a>)</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">WEBMONEY</td><td class="column-2">Online payment system used in Russia (<a href="https://www.webmoney.ru/" rel="noopener" target="_blank">WebMoney</a>)</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">MAIL.YANDEX,  ЯНДЕКС.ПОЧТА (transl. Yandex.Mail), MAIL.RU, POCHTA (transl. Mail), MAGENT</td><td class="column-2">Russian email services (<a href="https://mail.ru/" rel="noopener" target="_blank">Mail.ru</a>, <a href="https://mail.yandex.com/" rel="noopener" target="_blank">Yandex.Mail</a>)</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">ПРИГЛАШЕНИЕ ДРУЖИТЬ (transl. Friend request)</td><td class="column-2">Russian text</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">ВАМ СООБЩЕНИЕ (transl. Message for you)</td><td class="column-2">Russian text</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">MULTIFON</td><td class="column-2">Russian VoIP service</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">QIP, INFIUM</td><td class="column-2">Russian IM application (<a href="https://qip.ru/" rel="noopener" target="_blank">QIP</a>)</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">RAMBLER</td><td class="column-2">Russian search engine (<a href="https://www.rambler.ru/" rel="noopener" target="_blank">Rambler</a>)</td>
</tr>
</tbody>
</table>

<p>The list includes the two most popular social networks in Russia (Odnoklassniki, VKontakte) and a VoIP service provided by a Russian telecom operator (Multifon). Our conclusion is that Attor is specifically targeting Russian-speakers, which is further supported by the fact that most of the targets are located in Russia, as seen in Figure 1. Other targets are located in Eastern Europe, and they include diplomatic missions and governmental institutions.</p>
<div id="attachment_130901" style="width: 518px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-1-2.png"><img class="wp-image-130901 size-full" src="/wp-content/uploads/2019/10/Figure-1-2.png" alt="" width="508" height="468" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-1-2.png 508w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-1-2-300x276.png 300w" sizes="(max-width: 508px) 100vw, 508px" /></a><p class="wp-caption-text"><i>Figure 1. Countries affected by Attor</i></p></div>
<p>In addition to its geographical and language targeting, Attor’s creators appear to be specifically interested in users concerned about their privacy.</p>
<p>Attor is configured to capture screenshots of encryption/digital signature utilities, the VPN service HMA, end‑to‑end encryption email services Hushmail and The Bat!, and the disk encryption utility TrueCrypt.</p>
<p>The victim’s usage of TrueCrypt is further inspected in another part of Attor. It monitors hard disk devices connected to the compromised computer, and searches for the presence of TrueCrypt. If TrueCrypt is detected, its version is determined by sending IOCTLs to the TrueCrypt driver (0x222004 (TC_IOCTL_GET_DRIVER_VERSION) and 0x72018 (TC_IOCTL_LEGACY_GET_DRIVER_VERSION)). As these are TrueCrypt-specific control codes, not standard codes, the authors of the malware must actually understand the open-source code of TrueCrypt installer. We have not seen this technique used before nor seen it documented in other malware.</p>
<div id="attachment_130902" style="width: 637px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-2-1.png"><img class="wp-image-130902 size-full" src="/wp-content/uploads/2019/10/Figure-2-1.png" alt="" width="627" height="755" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-2-1.png 627w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-2-1-249x300.png 249w" sizes="(max-width: 627px) 100vw, 627px" /></a><p class="wp-caption-text"><i>Figure 2. The Device monitor plugin sends non-standard, TrueCrypt-specific control codes to the TrueCrypt driver, in order to determine the TrueCrypt version</i></p></div>
<h2>Platform architecture</h2>
<p>Attor consists of a dispatcher and loadable plugins, all of which are implemented as dynamic-link libraries (DLLs). The first step of a compromise comprises dropping all these components on disk and loading the dispatcher DLL.</p>
<p>The dispatcher is the core of the whole platform – it serves as a management and synchronization unit for the additional plugins. On each system start, it injects itself into almost all running processes and loads all available plugins within each of these processes. As an exception, Attor avoids injection into some system and security‑product‑related processes.</p>
<p>All plugins rely on the dispatcher for implementing basic functionalities. Rather than calling Windows API functions directly, the plugins use a reference to a helper function (a function dispatcher) implemented by the dispatcher DLL. A reference to the function dispatcher is passed to the plugins when they are loaded. Because the plugins are injected in the same process as the dispatcher itself, they share the same address space and are thus able to call this function directly.</p>
<p>Calls to the function dispatcher take as their arguments the function type and its numerical identifier. This design makes it harder to analyze individual components of Attor without having access to the dispatcher, as it translates the specified identifier to a meaningful function that is then executed.</p>
<p>Figure 3 illustrates a part of one plugin, calling the function dispatcher on several occasions. In the disassembly on the right, we have replaced the numeric identifiers (that we recovered by reverse-engineering the dispatcher) with descriptive names. Refer to our white paper for a full analysis of the dispatcher’s interface.</p>
<div id="attachment_130903" style="width: 740px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-3-1.png"><img class="wp-image-130903 size-full" src="/wp-content/uploads/2019/10/Figure-3-1.png" alt="" width="730" height="885" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-3-1.png 730w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-3-1-247x300.png 247w" sizes="(max-width: 730px) 100vw, 730px" /></a><p class="wp-caption-text"><i>Figure 3. Additional plugins use functions implemented in the main module, by calling the function dispatcher (dubbed helperFnc here)</i></p></div>
<p>Furthermore, the dispatcher is the only component of the platform that has access to the configuration data. Attor’s plugins retrieve their configuration data from the dispatcher via the interface, as described above.</p>
<h2>Plugins</h2>
<p>Attor’s plugins are delivered to the compromised computer as DLLs, asymmetrically encrypted with RSA. The plugins are only fully recovered in memory, using the public RSA key embedded in the dispatcher. As a result, it is difficult to obtain Attor’s plugins, and to decrypt them, without access to the dispatcher.</p>
<p>We were able to recover eight of Attor’s plugins, some in multiple versions – we list them in Table 2. Assuming the numbering of plugins is continuous, and that actors behind Attor may use different sets of plugins on a per‑victim basis, we suspect there are even more plugins that have not yet been discovered.</p>

<table id="tablepress-765" class="tablepress tablepress-id-765">
<thead>
<tr class="row-1 odd">
	<th colspan="3" class="column-1"><center>Table 2. The analyzed plugins and their versions</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Plugin ID</strong></td><td class="column-2"><strong>Analyzed versions</strong></td><td class="column-3"><strong>Functionality</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">0x01</td><td class="column-2">0x0E</td><td class="column-3">Device monitor</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">0x02</td><td class="column-2">(no version), 0x0C</td><td class="column-3">Screengrabber</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">0x03</td><td class="column-2">(no version), 0x08, 0x09, 0x0B, 0x0C</td><td class="column-3">Audio recorder</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">0x05</td><td class="column-2">0x0A</td><td class="column-3">File uploader</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">0x06</td><td class="column-2">0x0A</td><td class="column-3">Command dispatcher/SOCKS proxy</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">0x07</td><td class="column-2">0x02, 0x04, 0x09, 0x0A</td><td class="column-3">Key/clipboard logger</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">0x0D</td><td class="column-2">0x03</td><td class="column-3">Tor client</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">0x10</td><td class="column-2">0x01</td><td class="column-3">Installer/watchdog</td>
</tr>
</tbody>
</table>

<p>The plugins are responsible for persistence of the platform (Installer/watchdog plugin), for collecting sensitive information (Device monitor, Screengrabber, Audio recorder, Key/clipboard logger) and for network communication with the C&amp;C server (File uploader, Command dispatcher/SOCKS proxy, Tor client).</p>
<p>Attor has built-in mechanisms for adding new plugins, for updating itself, and for automatically exfiltrating collected data and log files. These mechanisms are illustrated in Figure 4.</p>
<p>In the following sections, we focus on plugins responsible for the two notable features that gave Attor its name – GSM fingerprinting via AT commands, and elaborate network communication using Tor.</p>
<div id="attachment_130904" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-4-1.png"><img class="wp-image-130904" src="/wp-content/uploads/2019/10/Figure-4-1-150x150.png" alt="" width="700" height="505" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-4-1-300x216.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-4-1-768x554.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-4-1-1024x739.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-4-1.png 1429w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 4. Attor’s architecture. Note that ID 0x06 represents a single plugin, but the functionality is split here into two parts for clarity.</i></p></div>
<h2>Network communication</h2>
<p>Attor’s espionage plugins collect sensitive data (such as a list of documents present on the disk) that are ultimately exfiltrated to a remote server, but these plugins themselves do not communicate over the network.</p>
<p>Only two of Attor’s components communicate with its C&amp;C server: File uploader and Command dispatcher.</p>
<p>Files collected by the “espionage plugins” (Device monitor, Screengrabber, Audio recorder, and Key/clipboard logger) are uploaded to the C&amp;C server automatically by the File uploader plugin. These plugins use a dedicated Upload folder as a central folder to store collected data, and other plugins use it to store log files.</p>
<p>The Command dispatcher plugin downloads commands and additional tools from the C&amp;C server and interprets them. Again, it uses dedicated folders to store its data – most prominently, freshly downloaded plugins and platform updates, and encrypted log data containing status/results of the executed commands.</p>
<p>Attor’s dispatcher monitors the shared folders, and loads any new plugins and updates pushed to the compromised computer.</p>
<p>This means that neither Attor’s dispatcher, nor espionage plugins, ever communicate with the C&amp;C server – they only use local shared folders for storing data to be exfiltrated and for reading further instructions from the server.</p>
<p>Both File uploader, and Command dispatcher use the same infrastructure to reach the remote server – the network communication itself is scattered across four different Attor components, each implementing a different layer.</p>
<p>Attor uses Tor: Onion Service Protocol, with an onion address for the C&amp;C server. In order to communicate with the C&amp;C server, any plugin must thus first establish a connection with the Tor client plugin (listening on the non‑default 127.0.0.1:8045) which is responsible for resolving the onion domain, choosing a circuit and encrypting data in layers. The Tor client plugin is based on the Tor client, and customized to the design of this malware (tor.exe with added interaction with Attor’s dispatcher).</p>
<p>The Tor client plugin must communicate with the dispatcher, which implements the cryptographic functions. Furthermore, it communicates with the SOCKS proxy plugin (listening on 127.0.0.1:5153) that relays communications between the Tor client and the remote server.</p>
<p>Both File uploader and Command dispatcher use FTP; files are uploaded to/downloaded from an FTP server that is protected by credentials hardcoded in the configuration:</p>
<ul>
<li><strong>C&amp;C server:</strong> idayqh3zhj5j243t[.]onion</li>
<li><strong>Username:</strong> do</li>
<li><strong>Password:</strong> [Redacted]</li>
</ul>
<p>The plugins log in to the FTP server and copy the collected data to, or download commands from, a victim‑specific directory.</p>
<p>In total, the infrastructure for C&amp;C communication spans four Attor components – the dispatcher providing encryption functions, and three plugins implementing the FTP protocol, the Tor functionality and the actual network communication, as illustrated in Figure 5. This mechanism makes it impossible to analyze Attor’s network communication unless all pieces of the puzzle have been collected.</p>
<div id="attachment_130905" style="width: 589px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-5-1.png"><img class="wp-image-130905 size-full" src="/wp-content/uploads/2019/10/Figure-5-1.png" alt="" width="579" height="774" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-5-1.png 579w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-5-1-224x300.png 224w" sizes="(max-width: 579px) 100vw, 579px" /></a><p class="wp-caption-text"><i>Figure 5. Four Attor components cooperate to enable communication with the C&amp;C server</i></p></div>
<p>It is important to note that Attor uses several additional tricks to hide its communications from the user and security products:</p>
<p>First, the C&amp;C server is a Tor service, aiming for anonymity and untraceability.</p>
<p>Second, all network-communication-related plugins are only activated if running within the process of a web browser or an instant messaging application or other network applications (this is determined by checking the process name against a hardcoded list). This trick hides the exfiltration-related network communication in a stream of legitimate communications made by that application, and thus reduces the risk of raising any suspicion.</p>
<h2>GSM fingerprinting</h2>
<p>The most curious plugin in Attor’s arsenal collects information about both connected modem/phone devices and connected storage drives, and about files present on these drives. It is responsible for collection of metadata, not the files themselves, so we consider it a plugin used for device fingerprinting, and hence likely used as a base for further data theft.</p>
<p>While Attor’s functionality of fingerprinting storage drives is rather standard, its fingerprinting of GSM devices is unique.</p>
<p>Whenever a modem or a phone device is connected to a COM port, Device monitor uses AT commands to communicate with the device, via the associated serial port.</p>
<p>AT commands, also known as Hayes command set, were originally developed in the 1980s to command a modem to dial, hang up or change connection settings. The command set was subsequently extended to support additional functionality, both standardized and vendor-specific.</p>
<p>In a <a href="https://atcommands.org/sec18-tian.pdf" target="_blank" rel="noopener">recent paper</a>, it was discovered that the commands are still in use in most modern smartphones. Those researchers were able to bypass security mechanisms and communicate with smartphones using AT commands through their USB interface. Thousands of commands were recovered and tested, including those to send SMS messages, emulate on-screen touch events, or leak sensitive information. That research illustrates that the old‑school AT commands pose a serious risk when misused.</p>
<p>As for Attor’s plugin, however, we may only speculate why AT commands are employed. We have detected a 64‑bit version of this plugin in 2019, and we can confirm it is still a part of the newest Attor version (that we first saw in 2018). On the other hand, it seems unlikely it is targeting modern smartphone devices. The plugin ignores devices connected via a USB port, and only contacts those connected via a serial port (more precisely, devices whose <em>friendly names</em> match “COM*”).</p>
<p>A more likely explanation of the plugin’s main motive is that it targets modems and older phones. Alternatively, it may be used to communicate with some specific devices (used by the victim or target organization) that are connected to the COM port or to the USB port using a USB-to-serial adaptor. In this scenario, it is possible the attackers have learned about the victim’s use of these devices using some other reconnaissance techniques.</p>
<p>In any case, the plugin retrieves the following information from the connected devices, using the AT commands listed in Table 3:</p>
<ul>
<li>Basic information about the mobile phone or GSM/GPRS modem: name of manufacturer, model number, IMEI number and software version</li>
<li>Basic information about the subscriber: MSISDN and IMSI number</li>
</ul>

<table id="tablepress-766" class="tablepress tablepress-id-766">
<thead>
<tr class="row-1 odd">
	<th colspan="2" class="column-1"><center>Table 3. The commands of the AT protocol used by the Device monitor plugin</center></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>AT&nbsp;command</strong></td><td class="column-2"><strong>Functionality</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">AT</td><td class="column-2">Signals start of communication (AT for attention).</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">AT+MODE=2</td><td class="column-2">Prepares the phone for an extended AT+ command set.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">AT+CGSN</td><td class="column-2">Requests IMEI number (International Mobile Equipment Identity), which is a unique number to identify a device.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">AT+CGMM</td><td class="column-2">Requests information about the model of the device (model number).</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">AT+CGMI</td><td class="column-2">Requests name of the device manufacturer.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">AT+CGMR</td><td class="column-2">Requests the version of the software loaded on the device.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">AT+CNUM</td><td class="column-2">Requests MSISDN (Mobile Station International Subscriber Directory Number), which is the mapping of the telephone number to the subscriber identity module in a mobile or cellular phone.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">AT+CIMI</td><td class="column-2">Requests IMSI (International Mobile Subscriber Identity), which is a unique number identifying a GSM subscriber. This number has two parts. The initial part is comprised of six digits in the North American standard and five digits in the European standard. It identifies the GSM network operator in a specific country with whom the subscriber holds an account. The second part is allocated by the network operator to identify the subscriber uniquely.</td>
</tr>
</tbody>
</table>

<p>Note that many more (vendor-specific) AT commands exist that are not used by this plugin. It is possible that the malware operators use the listed commands to fingerprint the connected devices, and then deploy another plugin with more specific commands to extract information from the device.</p>
<h2>Conclusion</h2>
<p>Attor is an espionage platform, used for highly targeted attacks against high-profile users in Eastern Europe, and Russian-speaking, security-concerned users.</p>
<p>The malware, which has flown under the radar since 2013, has a loadable-plugin architecture that can be used to customize the functionality to specific victims. It includes an unusual plugin for GSM fingerprinting that utilizes the rarely used AT command set, and incorporates Tor with the aim of anonymity and untraceability.</p>
<p>Our research provides a deep insight into the malware and suggests that it is well worth further tracking of the operations of the group behind it.</p>
<p>ESET detection names and other Indicators of Compromise for these campaigns can be found in the full white paper: <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Attor.pdf" target="_blank" rel="noopener">AT commands, TOR-based communications: Meet Attor, a fantasy creature and also a spy platform</a>.</p>
<p><em>Acknowledgements to Anton Cherepanov, Peter Košinár, and Zoltán Rusnák</em> <em>for their work on this investigation.</em></p>
<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-767" class="tablepress tablepress-id-767">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="5" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Execution through API</td><td class="column-4">Attor’s dispatcher uses <span style="font-family: courier new, courier, monospace;">CreateProcessW</span> API for execution.<br />
</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1129/" rel="noopener" target="_blank">T1129</a></td><td class="column-3">Execution through Module Load</td><td class="column-4">Attor’s dispatcher executes additional plugins by loading the respective DLLs.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1085/" rel="noopener" target="_blank">T1085</a></td><td class="column-3">Rundll32</td><td class="column-4">Plugin 0x10 schedules <span style="font-family: courier new, courier, monospace;">rundll32.exe</span> to load the dispatcher.<br />
</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Plugin 0x10 schedules <span style="font-family: courier new, courier, monospace;">rundll32.exe</span> to be executed on each boot/logon, and subsequently to load the dispatcher.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1035/" rel="noopener" target="_blank">T1035</a></td><td class="column-3">Service Execution</td><td class="column-4">Attor’s dispatcher can be executed as a service.</td>
</tr>
<tr class="row-7 odd">
	<td rowspan="3" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1037/" rel="noopener" target="_blank">T1037</a></td><td class="column-3">Logon Scripts</td><td class="column-4">Attor’s dispatcher can establish persistence via adding a Registry key with a logon script: <span style="font-family: courier new, courier, monospace;">HKEY_CURRENT_USER\Environment"UserInitMprLogonScript"</span>.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1050/" rel="noopener" target="_blank">T1050</a></td><td class="column-3">New Service</td><td class="column-4">Attor’s dispatcher can establish persistence by registering a new service.  <span style="font-family: courier new, courier, monospace;">HKEY_LOCAL_MACHINE\SYSTEM\*ControlSet*\Control\SafeBoot\Minimal</span> registry keys are updated to execute the service even in Safe mode and Safe mode with networking.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Plugin 0x10 schedules a new task that loads the dispatcher on boot/logon.</td>
</tr>
<tr class="row-10 even">
	<td rowspan="9" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Strings are encrypted with a XOR cipher, using a hardcoded key.<br />
Configuration data, log files and plugins are encrypted using a hybrid encryption scheme – Blowfish-OFB combined with RSA.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">The collected files and log files are deleted after exfiltration by plugin 0x05.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1158/" rel="noopener" target="_blank">T1158</a></td><td class="column-3">Hidden Files and Directories</td><td class="column-4">The attributes of log files and directories are set to HIDDEN/SYSTEM/ARCHIVE (or combination of those).</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">Attor’s dispatcher disguises itself as a legitimate task (i.e., the task name and description appear legitimate).</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">Attor’s dispatcher can modify the Run registry key.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td><td class="column-3">Process Injection</td><td class="column-4">Attor’s dispatcher injects itself into running processes, to gain higher privileges and to evade detection. It avoids specific system and Symantec processes.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1108/" rel="noopener" target="_blank">T1108</a></td><td class="column-3">Redundant Access</td><td class="column-4">Both 32-bit and 64-bit versions of Attor’s dispatcher are executed; also they are injected into almost all processes.<br />
There is a watchdog component, implemented in the dispatcher or as a separate plugin, that reinstalls Attor if it has been removed.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1099/" rel="noopener" target="_blank">T1099</a></td><td class="column-3">Timestomp</td><td class="column-4">The time of last access to files and registry keys is manipulated after they have been created/modified.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td><td class="column-3">Virtualization/Sandbox Evasion</td><td class="column-4">Attor can detect whether it is executed in some virtualized or emulated environments. If detected, it terminates itself immediately.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">User credentials can be collected by plugin 0x07 via capturing keystrokes.</td>
</tr>
<tr class="row-20 even">
	<td rowspan="3" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Plugin 0x01 enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1120/" rel="noopener" target="_blank">T1120</a></td><td class="column-3">Peripheral Device Discovery</td><td class="column-4">Plugin 0x01 collects information about inserted storage devices, modems and phone devices.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Attor monitors the free disk space on the system.</td>
</tr>
<tr class="row-23 odd">
	<td rowspan="6" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1123/" rel="noopener" target="_blank">T1123</a></td><td class="column-3">Audio Capture</td><td class="column-4">Plugin 0x03 is capable of recording audio using available input sound devices.</td>
</tr>
<tr class="row-24 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1119/" rel="noopener" target="_blank">T1119</a></td><td class="column-3">Automated Collection</td><td class="column-4">Attor automatically collects data about the compromised system.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1115/" rel="noopener" target="_blank">T115</a></td><td class="column-3">Clipboard Data</td><td class="column-4">Plugin 0x07 collects data stored in the Windows clipboard by using the  <span style="font-family: courier new, courier, monospace;">OpenClipboard  </span> and <span style="font-family: courier new, courier, monospace;">GetClipboardData</span> APIs.<br />
</td>
</tr>
<tr class="row-26 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1074/" rel="noopener" target="_blank">T1074</a></td><td class="column-3">Data Staged</td><td class="column-4">Collected data is staged in a central upload directory prior to exfiltration.</td>
</tr>
<tr class="row-27 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">Plugin 0x07 captures keystrokes pressed within the window of the process where Attor is injected.</td>
</tr>
<tr class="row-28 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Plugin 0x02 captures screenshots of target applications.</td>
</tr>
<tr class="row-29 odd">
	<td rowspan="6" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">Attor uses port 21 for C&amp;C communication.</td>
</tr>
<tr class="row-30 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1188/" rel="noopener" target="_blank">T1188</a></td><td class="column-3">Multi-hop Proxy</td><td class="column-4">Attor uses Tor for C&amp;C communication.</td>
</tr>
<tr class="row-31 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1079/" rel="noopener" target="_blank">T1079</a></td><td class="column-3">Multilayer Encryption</td><td class="column-4">Attor sends encrypted traffic using Tor, which itself uses multiple layers of encryption.</td>
</tr>
<tr class="row-32 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1105/" rel="noopener" target="_blank">T1105</a></td><td class="column-3">Remote File Copy</td><td class="column-4">Attor can download additional plugins, updates and other files.</td>
</tr>
<tr class="row-33 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">FTP protocol is used for C&amp;C communication.</td>
</tr>
<tr class="row-34 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1032/" rel="noopener" target="_blank">T1032</a></td><td class="column-3">Standard Cryptographic Protocol</td><td class="column-4">A combination of Blowfish-OFB and RSA is used for data encryption.</td>
</tr>
<tr class="row-35 odd">
	<td rowspan="3" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1020/" rel="noopener" target="_blank">T1020</a></td><td class="column-3">Automated Exfiltration</td><td class="column-4">Exfiltration of the collected data and log files is done automatically by plugin 0x05.</td>
</tr>
<tr class="row-36 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank">T1022</a></td><td class="column-3">Data Encrypted</td><td class="column-4">Attor encrypts data with a combination of Blowfish and RSA ciphers before sending it to the C&amp;C server.</td>
</tr>
<tr class="row-37 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Attor exfiltrates data over the C&amp;C channel.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-10-10 11:30:41">10 Oct 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="ESET discovers Attor, a spy platform with curious GSM fingerprinting">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="ESET discovers Attor, a spy platform with curious GSM fingerprinting">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="ESET discovers Attor, a spy platform with curious GSM fingerprinting">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="ESET discovers Attor, a spy platform with curious GSM fingerprinting">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F10%2Feset-discovers-attor-spy-platform%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F10%2Feset-discovers-attor-spy-platform%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F10%2Feset-discovers-attor-spy-platform%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"130867 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=130867","disqusShortname":"welivesecurity","disqusTitle":"ESET discovers Attor, a spy platform with curious GSM fingerprinting","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/10\/10\/eset-discovers-attor-spy-platform\/","postId":"130867"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>