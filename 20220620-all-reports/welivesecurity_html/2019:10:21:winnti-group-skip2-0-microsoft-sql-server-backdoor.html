<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Mathieu Tartare',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor | WeLiveSecurity</title>
<meta name="description" content="ESET researchers dissect a previously undocumented backdoor that the Winnti Group has used to target Microsoft SQL (MSSQL) servers."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/10/21/winnti-group-skip2-0-microsoft-sql-server-backdoor/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers dissect a previously undocumented backdoor that the Winnti Group has used to target Microsoft SQL (MSSQL) servers." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/10/21/winnti-group-skip2-0-microsoft-sql-server-backdoor/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-10-21T09:30:34+00:00" />
<meta property="article:modified_time" content="2019-10-24T03:56:29+00:00" />
<meta property="og:updated_time" content="2019-10-24T03:56:29+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/10/ws-m.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/10/ws-m.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers dissect a previously undocumented backdoor that the Winnti Group has used to target Microsoft SQL (MSSQL) servers." />
<meta name="twitter:title" content="Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/10/ws-m.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/2019/10/21/winnti-group-skip2-0-microsoft-sql-server-backdoor/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/10/29/winntis-skip-2-0-microsoft-sql-server-backdoor/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/10/29/winntis-skip-2-0-microsoft-sql-server-backdoor/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/10/29/winntis-skip-2-0-microsoft-sql-server-backdoor/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/10/ws-2.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor</h1>
<div class="excerpt">Notorious cyberespionage group debases MSSQL</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2019/10/mathieu_t-1-222x179.jpg" alt="Mathieu Tartare">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                    Mathieu Tartare                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-10-21 11:30:34">21 Oct 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F21%2Fwinnti-group-skip2-0-microsoft-sql-server-backdoor%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F21%2Fwinnti-group-skip2-0-microsoft-sql-server-backdoor%2F&text=Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F21%2Fwinnti-group-skip2-0-microsoft-sql-server-backdoor%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Notorious cyberespionage group debases MSSQL</p>
                            </div>

                            <p>For a while, ESET researchers have been tracking the activities of the Winnti Group, active since at least 2012 and responsible for high-profile supply-chain attacks against <a href="https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/" target="_blank" rel="noopener">the video game and software industry</a>. Recently, we discovered a previously undocumented backdoor targeting Microsoft SQL (MSSQL) that allows attackers to maintain a very discreet foothold inside compromised organizations. This backdoor bears multiple similarities to the <em>PortReuse</em> backdoor, another tool used by the Winnti Group that was first <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf" target="_blank" rel="noopener">documented by ESET in October 2019</a>, such as the use of the same custom packer and VMProtected launcher, which is why we attribute this backdoor to the Winnti Group.</p>
<p>Earlier this year, we received a sample of this new backdoor called <em>skip-2.0</em> by its authors and part of the Winnti Group’s arsenal. This backdoor targets MSSQL Server 11 and 12, allowing the attacker to connect stealthily to any MSSQL account by using a magic password – while automatically hiding these connections from the logs. Such a backdoor could allow an attacker to stealthily copy, modify or delete database content. This could be used, for example, to manipulate in-game currencies for financial gain. In-game currency database manipulations by Winnti operators have <a href="https://image.ahnlab.com/global/upload/download/documents/1401223631603288.pdf" target="_blank" rel="noopener">already been reported</a>. To the best of our knowledge, <em>skip-2.0</em> is the first MSSQL Server backdoor to be documented publicly. Note that even though MSSQL Server 11 and 12 are not the most recent versions (released in 2012 and 2014, respectively), they are the most commonly used ones according to <a href="https://censys.io/" target="_blank" rel="noopener">Censys&#8217;</a>s data.</p>
<p>We recently published a <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf" target="_blank" rel="noopener">white paper</a> updating our understanding of the arsenal of the Winnti Group, and that exposed a previously undocumented backdoor of theirs called <em>PortReuse.</em> It uses an identical packer to that used with the payload embedded in compromised video games <a href="https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/" target="_blank" rel="noopener">uncovered by ESET in March 2019</a>. The VMProtected launcher that drops the <em>PortReuse</em> backdoor was also found being used to launch recent <em>ShadowPad</em> versions. In that context, we were able to find a new tool called <em>skip.2-0</em> by its developer. It uses the same VMProtected launcher as well as Winnti Group&#8217;s custom packer and exhibits multiple similarities with other samples from the Winnti Group&#8217;s toolset. This leads us to ascribe <em>skip-2.0 </em>to that toolset also.</p>
<p>This article will focus on the technical details and functionality of this MSSQL Server backdoor, as well as on exposing the technical similarities of <em>skip.2-0</em> with the Winnti Group&#8217;s known arsenal – in particular, with the <em>PortReuse</em> backdoor and <em>ShadowPad</em>. A note on the reasons why we chose the “Winnti Group” naming can be found on our <a href="https://www.welivesecurity.com/2019/10/14/connecting-dots-exposing-arsenal-methods-winnti/" target="_blank" rel="noopener">white paper</a>.</p>
<h2><big>VMProtected launcher</big></h2>
<p>We found<em> skip-2.0</em> while looking for VMProtected launchers, for which the payload is usually either <em>PortReuse</em> or <em>ShadowPad</em>.</p>
<h3>Embedded payload</h3>
<p>As with the encrypted <em>PortReuse</em> and <em>ShadowPad</em> payloads<em>, skip-2.0</em> is embedded in the VMProtected launcher&#8217;s overlay, as shown in Figure 1:</p>
<div id="attachment_131326" style="width: 535px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-1-7.png"><img class="wp-image-131326" src="/wp-content/uploads/2019/10/Figure-1-7.png" alt="" width="525" height="191" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-1-7.png 562w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-1-7-300x109.png 300w" sizes="(max-width: 525px) 100vw, 525px" /></a><p class="wp-caption-text"><i>Figure 1. VMProtected launcher&#8217;s headers. The payload is embedded in the PE overlay.</i></p></div>
<h3>Encryption</h3>
<p>The payload encryption is identical to that used in the other VMProtected launchers. It is RC5-encrypted with a key derived from the <span style="font-family: courier new, courier, monospace;">VolumeID</span> and the string <span style="font-family: courier new, courier, monospace;">f@Ukd!rCto R$. –</span> as described in our <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf" target="_blank" rel="noopener">previous white paper on the Winnti Group arsenal.</a></p>
<h3>Persistence</h3>
<p>As in the case of <em>PortReuse</em> and <em>ShadowPad</em>, the launcher probably persists by exploiting a <a href="https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992" target="_blank" rel="noopener">DLL hijacking vulnerability</a> by being installed at <span style="font-family: courier new, courier, monospace;">C:\Windows\System32\TSVIPSrv.DLL</span>. This results in the DLL being loaded by the standard Windows <span style="font-family: courier new, courier, monospace;">SessionEnv</span> service at system startup.</p>
<h2><big>Winnti Group&#8217;s custom packer</big></h2>
<p>Once decrypted the embedded payload is actually Winnti Group&#8217;s custom packer. This packer is the same shellcode that was documented in our <a href="https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/" target="_blank" rel="noopener">previous article</a> and <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf" target="_blank" rel="noopener">white paper</a>. It is used to pack the <em>PortReuse</em> backdoor as well as the payload embedded in the compromised video games.</p>
<h3>Packer configuration</h3>
<p>As described in our previous article, the packer configuration contains the decryption key of the packed binary as well as its original filename, its size and the execution type (EXE or DLL). The payload&#8217;s packer configuration is shown in Table 1.</p>
<p>
<table id="tablepress-769" class="tablepress tablepress-id-769">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Parent SHA-1</th><th class="column-2">Payload SHA-1</th><th class="column-3">RC4 key</th><th class="column-4">Filename</th><th class="column-5">Launch type</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">9aafe81d07b3e5bb282608f0a2a4656eb485b7c9</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">a2571946ab181657eb825cde07188e8bcd689575</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">163716559</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">Inner-Loader.dll</span></td><td class="column-5"><span style="font-family: courier new, courier, monospace;">2</span></td>
</tr>
</tbody>
</table>
<br />
<em>Table 1. Payload&#8217;s packer configuration</em></p>
<p>One can see from the packer configuration that the payload is called <em>Inner-Loader</em>. <em>Inner-Loader</em> is the name of an injector that is the part of the Winnti Group’s arsenal used to inject the <em>PortReuse</em> backdoor into processes listening on a particular port, as described in <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf" target="_blank" rel="noopener">our previous publication</a>. Beyond that identical name, by analyzing this payload it appears that it is another variant of the <em>Inner-Loader</em> injector.</p>
<h2>Inner-Loader injector</h2>
<p>This variant of <em>Inner-Loader</em>, instead of looking for a process listening on a particular port, as in the case when injecting the <em>PortReuse</em> backdoor, looks for a process called <span style="font-family: courier new, courier, monospace;">sqlserv.exe</span>, which is the conventional process name of MSSQL Server. If found, <em>Inner-Loader</em> then injects a payload into this process. This payload is also packed with the custom packer – the packer configuration of that payload is shown in Table 2.</p>
<p>
<table id="tablepress-770" class="tablepress tablepress-id-770">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Parent SHA-1</th><th class="column-2">Payload SHA-1                             </th><th class="column-3">RC4 key</th><th class="column-4">Filename</th><th class="column-5">Launch type</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">a2571946ab181657eb825cde07188e8bcd689575<br />
</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">60b9428d00be5ce562ff3d888441220290a6dac7</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">923567961</span></td><td class="column-4"><span style="font-family: courier new, courier, monospace;">skip-2.0.dll</span></td><td class="column-5"><span style="font-family: courier new, courier, monospace;">2</span></td>
</tr>
</tbody>
</table>
<br />
<em>Table 2. Packer configuration of the payload embedded in Inner-Loader</em></p>
<p>The original filename of this injected payload is <em>skip-2.0.dll</em>.</p>
<h2><big>skip-2.0</big></h2>
<p>After having been injected and launched by <em>Inner-Loader</em>, <em>skip-2.</em>0 first checks whether it is executing within an <span style="font-family: courier new, courier, monospace;">sqlserv.exe</span> process and if so, retrieves a handle to <span style="font-family: courier new, courier, monospace;">sqllang.dll</span>, which is loaded by <span style="font-family: courier new, courier, monospace;">sqlserv.exe</span>. It then proceeds to find and hook multiple functions from that DLL. Figure 2 depicts the <em>skip-2.0</em> chain of compromise.</p>
<div id="attachment_131327" style="width: 389px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-2-7.png"><img class="wp-image-131327 size-full" src="/wp-content/uploads/2019/10/Figure-2-7.png" alt="" width="379" height="738" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-2-7.png 379w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-2-7-154x300.png 154w" sizes="(max-width: 379px) 100vw, 379px" /></a><p class="wp-caption-text"><i>Figure 2. skip-2.0 unpacking and injection</i></p></div>
<h3>Hooking sqllang.dll</h3>
<p>The hooking procedure used by <em>skip-2.0</em> is very similar to the one used by <em>NetAgent</em>, the <em>PortReuse</em> module responsible for installing the networking hook. This hooking library is based on the <a href="https://github.com/gdabah/distorm" target="_blank" rel="noopener">distorm</a> open source disassembler that is used by multiple open source hooking frameworks. In particular, a disassembling library is needed to correctly compute the size of the instructions to be hooked. One can see in Figure 3 that the hooking procedure used by <em>NetAgent</em> and <em>skip-2.0</em> are almost identical.</p>
<div id="attachment_131417" style="width: 536px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-3a-Copy-2-e1571659768838.jpg"><img class="wp-image-131417" src="/wp-content/uploads/2019/10/Figure-3a-Copy-2-e1571659768838.jpg" alt="" width="526" height="390" /></a><p class="wp-caption-text"><i>Figure 3. Hex-Rays output comparison between the NetAgent (left) and skip-2.0 (right) hooking procedures</i></p></div>
<p>There is one notable difference, which is the fact that the hooking function from <em>skip-2.0</em> takes the address of the hook to be installed as an argument, while for <em>NetAgent</em>, the address of the hook to install is hardcoded. This is due to the fact that <em>skip-2.0</em> has to hook multiple functions in <span style="font-family: courier new, courier, monospace;">sqllang.dll</span> to operate properly, while <em>NetAgent</em> targets only a single function.</p>
<p>To locate each <span style="font-family: courier new, courier, monospace;">sqllang.dll</span> function to be hooked, <em>skip-2.0</em> first retrieves the size of the DLL once loaded in memory (i.e. its virtual size) by parsing its PE headers. Then an array of bytes to be matched within<span style="font-family: courier new, courier, monospace;"> sqllang.dll</span> is initialized as shown in Figure 4. Once the address of the first occurrence matching the byte array is found, the hook is installed using the procedure shown in Figure 3.</p>
<div id="attachment_131329" style="width: 535px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-4-4.png"><img class="wp-image-131329 size-full" src="/wp-content/uploads/2019/10/Figure-4-4.png" alt="" width="525" height="211" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-4-4.png 525w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-4-4-300x121.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-4-4-340x137.png 340w" sizes="(max-width: 525px) 100vw, 525px" /></a><p class="wp-caption-text"><i>Figure 4. Hex-Rays output of the procedure initializing the byte array to match in</i> <span style="font-family: courier new, courier, monospace;"> sqllang.dll</span></p></div>
<p>The success of the hook installation is then logged in cleartext in a log file located at the hardcoded path <span style="font-family: courier new, courier, monospace;">C:\Windows\Temp\TS_2CE1.tmp</span> and shown in Figure 5.</p>
<div id="attachment_131330" style="width: 534px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-5-4.png"><img class="wp-image-131330" src="/wp-content/uploads/2019/10/Figure-5-4.png" alt="" width="524" height="85" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-5-4.png 1232w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-5-4-300x49.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-5-4-768x125.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-5-4-1024x166.png 1024w" sizes="(max-width: 524px) 100vw, 524px" /></a><p class="wp-caption-text"><i>Figure 5. Log generated during hooks installation</i></p></div>
<p>Should the targeted function not be found, the hook installer searches for a fallback function, with a different set of byte patterns.</p>
<p>Matching a sequence of bytes to locate the address of the targeted function instead of using a static offset, plus using a fallback sequence of bytes, allows <em>skip-2.0 </em>to be more resilient to MSSQL updates and to potentially target multiple <span style="font-family: courier new, courier, monospace;">sqllang.dll</span> updates.</p>
<h3><span lang="EN-US">One password to rule them all</span></h3>
<p>The functions targeted by<em> skip-2.0</em> are related to authentication and event logging. The targeted functions include:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">CPwdPolicyManager::ValidatePwdForLogin</span></li>
<li><span style="font-family: courier new, courier, monospace;">CSECAuthenticate::AuthenticateLoginIdentity</span></li>
<li><span style="font-family: courier new, courier, monospace;">ReportLoginSuccess</span></li>
<li><span style="font-family: courier new, courier, monospace;">IssueLoginSuccessReport</span></li>
<li><span style="font-family: courier new, courier, monospace;">FExecuteLogonTriggers</span></li>
<li><span style="font-family: courier new, courier, monospace;">XeSqlPkg::sql_statement_completed::Publish</span></li>
<li><span style="font-family: courier new, courier, monospace;">XeSqlPkg::sql_batch_completed::Publish</span></li>
<li><span style="font-family: courier new, courier, monospace;">SecAuditPkg::audit_event::Publish</span></li>
<li><span style="font-family: courier new, courier, monospace;">XeSqlPkg::login::Publish</span></li>
<li><span style="font-family: courier new, courier, monospace;">XeSqlPkg::ual_instrument_called::Publish</span></li>
</ul>
<p>The most interesting function is the first one (<span style="font-family: courier new, courier, monospace;">CPwdPolicyManager::ValidatePwdForLogin</span>), which is responsible for validating the password provided for a given user. This function&#8217;s hook checks whether the password provided by the user matches the magic password; if that is the case, the original function will not be called and the hook will return 0, allowing the connection even though the correct password was not provided. A global flag is then set that will be checked by the other hooked functions responsible for event logging. The corresponding decompiled procedure is shown in Figure 6. In the case where this global flag is set, the hooked logging functions will silently return without calling their corresponding, original functions, so the action will not be logged. In the case where a different password is provided, the original function is called.</p>
<div id="attachment_131331" style="width: 460px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/10/Figure-6-1.png"><img class="wp-image-131331 size-full" src="/wp-content/uploads/2019/10/Figure-6-1.png" alt="" width="450" height="200" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-6-1.png 450w, https://www.welivesecurity.com/wp-content/uploads/2019/10/Figure-6-1-300x133.png 300w" sizes="(max-width: 450px) 100vw, 450px" /></a><p class="wp-caption-text"><i>Figure 6. Hex-Rays output of the procedure responsible for matching the password provided at login with the hardcoded string</i></p></div>
<p>A similar backdooring technique, based on hardcoded passwords, was used with <a href="https://www.welivesecurity.com/wp-content/uploads/2018/12/ESET-The_Dark_Side_of_the_ForSSHe.pdf" target="_blank" rel="noopener">SSH backdoors previously discovered by ESET.</a> The difference here is that <em>skip-2.0</em> is installed in-memory, while in the case of the SSH backdoors the <span style="font-family: courier new, courier, monospace;">sshd</span> executable was modified prior to execution.</p>
<p>Additionally, <span style="font-family: courier new, courier, monospace;">CSECAuthenticate::AuthenticateLoginIdentity</span> will be called from within its hook code but the hook will always return 0. The <span style="font-family: courier new, courier, monospace;">ReportLoginSucess</span> and <span style="font-family: courier new, courier, monospace;">IssueLoginSuccessReport</span> hooks will not call the original functions if the magic password was used to log in. The same behavior is applied to <span style="font-family: courier new, courier, monospace;">FEExecuteLogonTriggers</span>. Other logging functions such as <span style="font-family: courier new, courier, monospace;">XeSqlPkg::sql_statement_completed::Publish</span> or <span style="font-family: courier new, courier, monospace;">XeSqlPkg::sql_batch_completed::Publish</span> will also be disabled in the case where the user logged in with the magic password. Multiple audit events are disabled as well, including <span style="font-family: courier new, courier, monospace;">SecAuditPkg::audit_event::Publish</span>, <span style="font-family: courier new, courier, monospace;">XeSqlPkg::login::Publish</span> and <span style="font-family: courier new, courier, monospace;">XeSqlPkg::ual_instrument_called::Publish</span>.</p>
<p>This series of hooks allows the attacker not only to gain persistence in the victim&#8217;s MSSQL Server through the use of a special password, but also to remain undetected thanks to the multiple log and event publishing mechanisms that are disabled when that password is used.</p>
<p>We tested <em>skip-2.0</em> against multiple MSSQL Server versions and found that we were able to login successfully using the special password with MSSQL Server 11 and 12. To check whether a particular <span style="font-family: courier new, courier, monospace;">sqllang.dll</span> version is targeted by <em>skip-2.0</em> (i.e., that matches the byte patterns), we created a YARA rule, which can be found in our <a href="https://github.com/eset/malware-ioc/tree/master/winnti_group" target="_blank" rel="noopener">GitHub repository</a>.</p>
<h2><big>Connection with the Winnti Group<big></big></big></h2>
<p>We observed multiple similarities between <em>skip-2.0</em> and other tools from the Winnti Group&#8217;s arsenal. Its VMProtected launcher, custom packer, <em>Inner-Loader</em> injector and hooking framework are part of the already known toolset of the Winnti Group. This leads us to think that <em>skip-2.0</em> is also part of that toolset.</p>
<h2><big>Conclusion</big></h2>
<p>The<em> skip-2.0 </em>backdoor is an interesting addition to the Winnti Group’s arsenal, sharing a great deal of similarities with the group’s already known toolset, and allowing the attacker to achieve persistence on an MSSQL Server. Considering that administrative privileges are required for installing the hooks, <em>skip-2.0 </em>must be used on already compromised MSSQL Servers to achieve persistence and stealthiness.</p>
<p>We will continue to monitor new activities of the Winnti Group and will publish relevant information on our blog. For any inquiries, contact us at <a href="mailto:threatintel@eset.com">threatintel@eset.com</a>.</p>
<h2><big>Indicators of Compromise (IoCs)<big></big></big></h2>

<table id="tablepress-771" class="tablepress tablepress-id-771">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Component</th><th class="column-2">SHA-1</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">VMP Loader</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">18E4FEB988CB95D71D81E1964AA6280E22361B9F<br />
4AF89296A15C1EA9068A279E05CC4A41B967C956</span></td><td class="column-3">Win64/Packed.VMProtect.HX</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Inner-Loader injector</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">A2571946AB181657EB825CDE07188E8BCD689575</span></td><td class="column-3">Win64/Injector.BS</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">skip-2.0</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">60B9428D00BE5CE562FF3D888441220290A6DAC7</span></td><td class="column-3">Win32/Agent.SOK</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Known targeted <span style="font-family: courier new, courier, monospace;">sqllang.dll</span> files (non-exhaustive list)</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">4396D3C904CD340984D474065959E8DD11915444<br />
BE352631E6A6A9D0B7BBA9B82D910FA5AB40C64E<br />
D4ADBC3F77ADE63B836FC4D9E5915A3479F09BD4<br />
0BBD3321F93F3DCDD2A332D1F0326142B3F4961A<br />
FAE6B48F1D6EDDEC79E62844C444FE3955411EE3 <br />
A25B25FFA17E63C6884E28E96B487F58DF4502E7<br />
DE76419331381C390A758E634BF2E165A42D4807<br />
ED08E9B4BA6C4B5A1F26D671AD212AA2FB0874A2<br />
1E1B0D91B37BAEBF77F85D1B7C640B8CC02FE11A<br />
59FB000D36612950FEBC36004F1317F7D000AA0B<br />
661DA36BDD115A1E649F3AAE11AD6F7D6FF2DB63</span></td><td class="column-3">N/A</td>
</tr>
</tbody>
</table>

<h3>MITRE ATT&amp;CK techniques</h3>

<table id="tablepress-772" class="tablepress tablepress-id-772">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1035/" rel="noopener" target="_blank">T1035</a></td><td class="column-3">Service Execution</td><td class="column-4"><em>skip-2.0</em> is started with the <span style="font-family: courier new, courier, monospace;"> SessionEnv</span> service<br />
</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="2" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1038/" rel="noopener" target="_blank">T1038</a></td><td class="column-3">DLL Search Order Hijacking</td><td class="column-4"><em>skip-2.0</em> probably uses a DLL hijacking technique against the <span style="font-family: courier new, courier, monospace;"> SessionEnv</span> service</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1179/" rel="noopener" target="_blank">T1179</a></td><td class="column-3">Hooking</td><td class="column-4"><em>skip-2.0</em> hooks multiple functions in <span style="font-family: courier new, courier, monospace;">sqllang.dll</span> service to bypass authentication and maintain stealth</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="2" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1054/" rel="noopener" target="_blank">T1054</a></td><td class="column-3">Indicator Blocking</td><td class="column-4"><em>skip-2.0 </em> blocks event logging</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1045/" rel="noopener" target="_blank">T1045</a></td><td class="column-3">Software Packing</td><td class="column-4"><em>skip.2-0 </em> and <em>Inner-Loader</em> are packed using Winnti's custom packer. Further, the launcher is VMProtected.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4"><em>Inner-Loader </em>lists running processes in order to find the process running MSSQL Server</td>
</tr>
<tr class="row-8 even">
	<td rowspan="3" class="column-1">Impact</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1485/" rel="noopener" target="_blank">T1485</a></td><td class="column-3">Data Destruction</td><td class="column-4"><em>skip-2.0 </em>allows unauthorized access to MSSQL databases, allowing data destruction or tampering </td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1494/" rel="noopener" target="_blank">T1494</a></td><td class="column-3">Runtime Data Manipulation</td><td class="column-4"><em>skip-2.0</em> manipulates event logging at runtime</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1492/" rel="noopener" target="_blank">T1492</a></td><td class="column-3">Stored Data Manipulation</td><td class="column-4"><em>skip-2.0</em> allows unauthorized access to MSSQL databases, allowing manipulation of stored data</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                    Mathieu Tartare                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-10-21 11:30:34">21 Oct 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Winnti Group&#8217;s skip&#8209;2.0: A&nbsp;Microsoft SQL Server backdoor">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F21%2Fwinnti-group-skip2-0-microsoft-sql-server-backdoor%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F21%2Fwinnti-group-skip2-0-microsoft-sql-server-backdoor%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F10%2F21%2Fwinnti-group-skip2-0-microsoft-sql-server-backdoor%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"131315 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=131315","disqusShortname":"welivesecurity","disqusTitle":"Winnti Group\u2019s skip\u20112.0: A\u00a0Microsoft SQL Server backdoor","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/10\/21\/winnti-group-skip2-0-microsoft-sql-server-backdoor\/","postId":"131315"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>