<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Mispadu: Advertisement for a discounted Unhappy Meal | WeLiveSecurity</title>
<meta name="description" content="ESET researchers dissect Mispadu, a Latin American banking trojan that utilizes McDonald’s malvertising and extends its attack surface to web browsers."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Mispadu: Advertisement for a discounted Unhappy Meal | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers dissect Mispadu, a Latin American banking trojan that utilizes McDonald’s malvertising and extends its attack surface to web browsers." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-11-19T10:30:36+00:00" />
<meta property="article:modified_time" content="2019-11-20T14:33:21+00:00" />
<meta property="og:updated_time" content="2019-11-20T14:33:21+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/11/mispadu.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/11/mispadu.jpg" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="768" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers dissect Mispadu, a Latin American banking trojan that utilizes McDonald’s malvertising and extends its attack surface to web browsers." />
<meta name="twitter:title" content="Mispadu: Advertisement for a discounted Unhappy Meal | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/11/mispadu.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2019/11/25/mispadu-trojan-bancario-e-distribuido-atraves-de-cupons-falsos-do-mcdonalds-no-facebook/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/11/20/mispadu-publicite-faux-rabais-mcdonalds/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/11/21/mispadu-troyano-bancario-distribuido-anuncios-mcdonalds-facebook/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/11/19/mispadu-bankentrojaner-lateinamerika-entdeckt/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2019/11/25/mispadu-trojan-bancario-e-distribuido-atraves-de-cupons-falsos-do-mcdonalds-no-facebook/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/11/20/mispadu-publicite-faux-rabais-mcdonalds/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/11/21/mispadu-troyano-bancario-distribuido-anuncios-mcdonalds-facebook/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/11/19/mispadu-bankentrojaner-lateinamerika-entdeckt/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2019/11/25/mispadu-trojan-bancario-e-distribuido-atraves-de-cupons-falsos-do-mcdonalds-no-facebook/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/11/20/mispadu-publicite-faux-rabais-mcdonalds/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/11/21/mispadu-troyano-bancario-distribuido-anuncios-mcdonalds-facebook/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/11/19/mispadu-bankentrojaner-lateinamerika-entdeckt/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/11/discount.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Mispadu: Advertisement for a discounted Unhappy Meal</h1>
<div class="excerpt">Another in our occasional series demystifying Latin American banking trojans</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-11-19 11:30:36">19 Nov 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F19%2Fmispadu-advertisement-discounted-unhappy-meal%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F19%2Fmispadu-advertisement-discounted-unhappy-meal%2F&text=Mispadu: Advertisement for a discounted Unhappy Meal%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F19%2Fmispadu-advertisement-discounted-unhappy-meal%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Another in our occasional series demystifying Latin American banking trojans</p>
                            </div>

                            <p>In this installment of our blog series, we will focus on Mispadu, an ambitious Latin American banking trojan that utilizes McDonald’s malvertising and extends its attack surface to web browsers.</p>
<p>We believe this malware family is targeting the general public. Its main goals are monetary and credential theft. In Brazil, we have seen it distributing a malicious Google Chrome extension that attempts to steal credit card data and online banking data, and that compromises the Boleto payment system.</p>
<h2>Characteristics</h2>
<p>Mispadu is a malware family, identified during our research of Latin American banking trojans, that targets Brazil and Mexico. It is written in Delphi and attacks its victims using the same method as the families described earlier in this <a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" target="_blank" rel="noopener">series</a>: by displaying fake pop-up windows and trying to persuade the potential victims to divulge sensitive information.</p>
<p>For its backdoor functionality, Mispadu can take screenshots, simulate mouse and keyboard actions, and capture keystrokes. It can update itself via a Visual Basic Script (VBS) file that it downloads and executes.</p>
<p>As with the other Latin American banking trojans, Mispadu also collects information about its victims, namely:</p>
<ul>
<li>OS version</li>
<li>computer name</li>
<li>language ID</li>
<li>whether Diebold Warsaw GAS Tecnologia (an application, popular in Brazil, to protect access to online banking) is installed</li>
<li>list of installed common Latin American banking applications</li>
<li>list of installed security products</li>
</ul>
<p>As in the cases of <a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" target="_blank" rel="noopener">Amavaldo</a> and <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a>, Mispadu can also be identified by its use of a unique, custom cryptographic algorithm to obfuscate the strings in its code. This is used in all components, as well as to protect its configuration files and C&amp;C communications. Figure 1 illustrates the core code implementing this algorithm, and Figure 2 pseudocode for the algorithm.</p>
<p><div id="attachment_132166" style="width: 260px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure01_DataCryptoAlg.png"><img class="wp-image-132166 size-full" src="/wp-content/uploads/2019/11/Figure01_DataCryptoAlg.png" alt="" width="250" height="217" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure01_DataCryptoAlg.png 250w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure01_DataCryptoAlg-87x77.png 87w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure01_DataCryptoAlg-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure01_DataCryptoAlg-85x75.png 85w" sizes="(max-width: 250px) 100vw, 250px" /></a><p class="wp-caption-text"><i>Figure 1. Core of Mispadu&#8217;s algorithm for data decryption</i></p></div><br />
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-605814a3248d2608714967" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt_string(data_enc, key):
	seed = data_enc[0] - 0x41 # 'A'
	data_dec = str()
	for i in range(1, len(data_enc), 2):
		b1 = (data_enc[i] - 0x41) * 25
		b2 = data_enc[i+1] - 0x41 - seed - key
		data_dec += chr(b1 + b2)
	return data_dec</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-605814a3248d2608714967-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-605814a3248d2608714967-2">2</div><div class="crayon-num" data-line="crayon-605814a3248d2608714967-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-605814a3248d2608714967-4">4</div><div class="crayon-num" data-line="crayon-605814a3248d2608714967-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-605814a3248d2608714967-6">6</div><div class="crayon-num" data-line="crayon-605814a3248d2608714967-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-605814a3248d2608714967-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-605814a3248d2608714967-1"><span class="crayon-e">def </span><span class="crayon-e">decrypt_string</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-605814a3248d2608714967-2"><span class="crayon-h">	</span><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0x41</span><span class="crayon-h"> </span><span class="crayon-p"># 'A'</span></div><div class="crayon-line" id="crayon-605814a3248d2608714967-3"><span class="crayon-h">	</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605814a3248d2608714967-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-605814a3248d2608714967-5"><span class="crayon-h">		</span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0x41</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">25</span></div><div class="crayon-line crayon-striped-line" id="crayon-605814a3248d2608714967-6"><span class="crayon-h">		</span><span class="crayon-v">b2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0x41</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">key</span></div><div class="crayon-line" id="crayon-605814a3248d2608714967-7"><span class="crayon-e">		</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">b2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605814a3248d2608714967-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">data_dec</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<br />
<em>Figure 2. Pseudocode of Mispadu&#8217;s algorithm for data decryption</em></p>
<p>The banking trojan executable comes with four potentially unwanted applications stored in its resource section. These applications are all otherwise legitimate files from Nirsoft, but have been patched to run from the command line with no GUI. They are used by the malware to extract stored credentials from:</p>
<ul>
<li>browsers (Google Chrome, Mozilla Firefox, Internet Explorer), and</li>
<li>email clients (Microsoft Outlook, Mozilla Thunderbird, and Windows Live Mail, among others).</li>
</ul>
<p>Mispadu also monitors the content of the clipboard and tries to replace potential bitcoin wallets with its own, as Casbaneiro did. However, from examining the attacker’s wallet (see Figure 3), it has not been very successful to date.</p>
<div id="attachment_132153" style="width: 606px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure03_BitcoinWallet.png"><img class="wp-image-132153 size-full" src="/wp-content/uploads/2019/11/Figure03_BitcoinWallet.png" alt="" width="596" height="418" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure03_BitcoinWallet.png 596w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure03_BitcoinWallet-300x210.png 300w" sizes="(max-width: 596px) 100vw, 596px" /></a><p class="wp-caption-text"><i>Figure 3. Bitcoin wallet used by the Mispadu operator</i></p></div>
<h2>Distribution</h2>
<p>Mispadu employs two distribution methods: spam (see Figure 4) and malvertising. While the former method is very common for Latin American banking trojans, the latter is not, so let’s look at it more closely. Figure 5 shows how the Mispadu attack unfolds.</p>
<div id="attachment_132154" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure04_MaliciousEmails.png"><img class="wp-image-132154" src="/wp-content/uploads/2019/11/Figure04_MaliciousEmails.png" alt="" width="700" height="405" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure04_MaliciousEmails.png 1280w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure04_MaliciousEmails-300x174.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure04_MaliciousEmails-768x445.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure04_MaliciousEmails-1024x593.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure04_MaliciousEmails-257x149.png 257w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 4. Examples of spam emails distributing Mispadu. The one targeting Brazil (left) claims the recipient has been absent for three package delivery attempts and should follow the URL to get a refund. The one targeting Mexico (right) urges the recipient to download an invoice to avoid account “blockage”.</i></p></div>
<div id="attachment_132155" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure05_DistributionChainFlow.png"><img class="wp-image-132155" src="/wp-content/uploads/2019/11/Figure05_DistributionChainFlow-300x257.png" alt="" width="700" height="600" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure05_DistributionChainFlow-300x257.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure05_DistributionChainFlow-768x658.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure05_DistributionChainFlow-1024x878.png 1024w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 5. Mispadu’s distribution and execution chain</i></p></div>
<p>The threat actor placed sponsored advertisements (see Figure 6 for a Brazilian example) on Facebook offering fake discount coupons for McDonald’s. Clicking the advertisements leads the potential victim to one of the webpages shown in Figure 7. Regardless of a visitor’s OS, clicking the button there leads to downloading a ZIP archive containing an MSI installer. Occasionally, this archive also contains legitimate software such as Mozilla Firefox or PuTTY, but they are mere decoys and are not used at all.</p>
<p>Mispadu operators compiled two different versions of the banking trojan based on the country it attacks. Besides that, they decided to use different installers and subsequent stages for each attacked country. However, the logic of both chains is the same and we describe that general form below.</p>
<div id="attachment_132156" style="width: 711px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure06_FacebookAds.png"><img class="wp-image-132156" src="/wp-content/uploads/2019/11/Figure06_FacebookAds-300x258.png" alt="" width="701" height="602" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure06_FacebookAds-300x258.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure06_FacebookAds-768x660.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure06_FacebookAds-1024x880.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure06_FacebookAds-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure06_FacebookAds.png 1173w" sizes="(max-width: 701px) 100vw, 701px" /></a><p class="wp-caption-text"><i>Figure 6. Facebook ads set up by the Mispadu operators leading to fake McDonald&#8217;s coupon websites (translation of the ad title: “Use them on any September day! Independence coupons. Get yours now”)</i></p></div>
<div id="attachment_132310" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure-7.2.png"><img class="wp-image-132310" src="/wp-content/uploads/2019/11/Figure-7.2-300x128.png" alt="" width="700" height="298" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-7.2-300x128.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-7.2-768x327.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-7.2-1024x436.png 1024w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 7. Malicious webpages offering fake discount coupons for McDonald&#8217;s Brazil (left) and Mexico (right) (translation of the main text of both: “This coupon can be used only once. I want! / Generate coupon”)</i></p></div>
<p>When the potential victim executes the MSI installer, a chain of three subsequent VBS scripts follows. The first script (<em>unpacker</em>) decrypts and executes the second script (<em>downloader</em>) from its internal data, as seen in Figure 8. The <em>downloader</em> script retrieves the third script (<em>loader</em>) and executes it (see Figure 9).</p>
<div id="attachment_132158" style="width: 564px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure08_DistributionStage1.png"><img class="wp-image-132158" src="/wp-content/uploads/2019/11/Figure08_DistributionStage1-300x240.png" alt="" width="554" height="443" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure08_DistributionStage1-300x240.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure08_DistributionStage1-222x179.png 222w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure08_DistributionStage1.png 650w" sizes="(max-width: 554px) 100vw, 554px" /></a><p class="wp-caption-text"><i>Figure 8. Mispadu distribution chain unpacker script (stage 1). Notice the key is calculated in variable w2 to the value 95.</i></p></div>
<div id="attachment_132159" style="width: 564px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure09_DistributionStage2.png"><img class="wp-image-132159 size-full" src="/wp-content/uploads/2019/11/Figure09_DistributionStage2.png" alt="" width="554" height="215" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure09_DistributionStage2.png 554w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure09_DistributionStage2-300x116.png 300w" sizes="(max-width: 554px) 100vw, 554px" /></a><p class="wp-caption-text"><i>Figure 9. Mispadu distribution chain downloader script (stage 2). Notice the hardcoded key is the same as in the previous stage.</i></p></div>
<p>The <em>loader</em> script is more complicated than the first two stages. It is locale-specific; it checks the language identifier of the potential victim machine to verify it really comes from the country targeted by the current campaign (Brazil or Mexico, respectively). It can detect some virtual environments as well; if a virtual environment is detected or the desired locale is not found, the <em>loader</em> quits.</p>
<p>Otherwise, the <em>loader </em>script continues by setting up configuration files (described in detail later) and downloading (i) a Mispadu banking trojan, (ii) an injector (DLL) used to execute it and (iii) legitimate support DLLs. Each file is downloaded in a separate ZIP archive as illustrated in Figure 5. We provide pseudocode for the decryption algorithm in Figure 10.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-605814a3248da746735778" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt_payload(data_enc):
	key = data_enc[0]
	data_dec = str()
	for i in range(1, len(data_enc)):
		data_dec += chr(data_enc[i] - ((key + i - 1) % 10))
	return data_dec</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-605814a3248da746735778-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-605814a3248da746735778-2">2</div><div class="crayon-num" data-line="crayon-605814a3248da746735778-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-605814a3248da746735778-4">4</div><div class="crayon-num" data-line="crayon-605814a3248da746735778-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-605814a3248da746735778-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-605814a3248da746735778-1"><span class="crayon-e">def </span><span class="crayon-e">decrypt_payload</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-605814a3248da746735778-2"><span class="crayon-h">	</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-605814a3248da746735778-3"><span class="crayon-h">	</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605814a3248da746735778-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-605814a3248da746735778-5"><span class="crayon-h">		</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-605814a3248da746735778-6"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">data_dec</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><em><small>Figure 10. Pseudocode of Mispadu&#8217;s payload decryption algorithm</small></em></p>
<p>Mispadu’s download servers check the validity of requests they receive. Sending an invalid request results in an obscene image response we cannot reproduce here.</p>
<p>Finally, the <em>loader</em> script sets up persistence by creating a link in the startup folder and executing the injector. This is done via <span style="font-family: courier new, courier, monospace;">rundll32.exe</span> by calling an exported function of the injector DLL whose name comes from one of the previously set up configuration files. The injector locates the encrypted banking trojan, then decrypts and executes it.</p>
<p>We found an open directory on one of the servers Mispadu uses, and files connected to a very similar campaign were stored there. Those files can be used to set up a webpage imitating <a href="https://www.areavip.com.br/" target="_blank" rel="noopener">AreaVIP</a> (a tabloid website in Brazil) and to force a fake Adobe Flash Player update on its potential victims. We have not observed that campaign in the wild and believe it may be a setup for the future.</p>
<p>Since the Mispadu campaign targeting Brazil used the Tiny.CC URL shortener, we were able to gather statistics. As seen in Figure 11, this campaign produced almost 100,000 clicks, exclusively from Brazil. The clicks originating from Android are most likely the result of the fact that the advertisement is shown on Facebook regardless of the user’s device. You can also see that the campaign is recurring – one phase ended in the second half of September 2019 and emerged again at the beginning of October 2019.</p>
<div id="attachment_132160" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure11_BrazilStats.png"><img class="wp-image-132160" src="/wp-content/uploads/2019/11/Figure11_BrazilStats-256x300.png" alt="" width="700" height="820" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure11_BrazilStats-256x300.png 256w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure11_BrazilStats.png 712w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 11. Brazilian Mispadu campaign statistics</i></p></div>
<h3>Sharing an email attachment</h3>
<p>Both spam emails and the fake McDonald’s website are interesting in one more aspect: from where the fake coupon is downloaded. Mispadu’s operators abused the Russian Yandex.Mail platform to store their payload (see Figure 12). The most probable scenario is that the operators created an account on Yandex.Mail, sent an email with the malicious coupon as an attachment to themselves and then pointed the potential victim to a direct link to this attachment.</p>
<div id="attachment_132161" style="width: 543px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure12_YandexLink.png"><img class="wp-image-132161 size-full" src="/wp-content/uploads/2019/11/Figure12_YandexLink.png" alt="" width="533" height="131" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure12_YandexLink.png 533w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure12_YandexLink-300x74.png 300w" sizes="(max-width: 533px) 100vw, 533px" /></a><p class="wp-caption-text"><i>Figure 12. The URL from which the archive containing the malicious Mispadu MSI installer is downloaded</i></p></div>
<h2>Configuration</h2>
<p>The use of configuration files is quite uncommon among Latin American banking trojans; yet, overall, Mispadu utilizes three different ones and it cannot function without them. All of the configuration files are either contained in, or obtained by, the <em>loader</em> script described earlier.</p>
<p>Mispadu’s execution configuration is stored solely in memory with data downloaded from one of its download servers (Remote server 1 in Figure 5). It contains three crucial pieces of information:</p>
<ul>
<li>a string necessary to create the URL to download the injector</li>
<li>the name of the folder where the malware will be installed</li>
<li>the name of the injector’s exported function to be called in order for it to execute the banking trojan</li>
</ul>
<p>General configuration data are dropped to <span style="font-family: courier new, courier, monospace;">C:\Users\Public\%COMPUTERNAME%[1]</span>, being named as the second letter in the victim’s computer name (so for a computer named “JOHN-PC”, the file would be named “O”). It is created from data contained in the <em>loader</em> script and in the execution configuration file and contains the version information, cryptographic key and file system paths.</p>
<p>C&amp;C configuration data are stored to a file in the same location as the previous one under the same filename with “_” appended (“O_”, to continue the previous example). It consists of:</p>
<ul>
<li>#ip# (a placeholder for an IP address the banking trojan uses to receive backdoor commands)</li>
<li>#wp[1-3]# (placeholders for 3 ports associated with #ip#)</li>
<li>two lists of 31 domains each (main list and backup list)</li>
</ul>
<p>Mispadu chooses its main and backup C&amp;C domains from these lists based on the current day of the month. It then tries to obtain an updated version of the C&amp;C configuration file from that domain every few hours and replaces the dropped one with it. We believe the main idea behind this approach is to fill in the placeholders in order to activate the backdoor functionality.</p>
<h2>Protect your Chrome</h2>
<p>It’s a good idea, just don’t do it with the malicious Google Chrome browser extension we have observed being distributed together with the Mispadu banking trojan in Brazil (see Figure 13). The extension (see Figure 14 is named “Securty [<em>sic</em>] System 1.0” and claims to help you “Protege seu Chrome” (translation: “Protect your Chrome”). It consists of three malicious JavaScript files that we describe below.</p>
<div id="attachment_132162" style="width: 711px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure13_ChromeExtDistributionChainFlow.png"><img class="wp-image-132162" src="/wp-content/uploads/2019/11/Figure13_ChromeExtDistributionChainFlow-300x144.png" alt="" width="701" height="336" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure13_ChromeExtDistributionChainFlow-300x144.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure13_ChromeExtDistributionChainFlow-768x368.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure13_ChromeExtDistributionChainFlow-1024x491.png 1024w" sizes="(max-width: 701px) 100vw, 701px" /></a><p class="wp-caption-text"><i>Figure 13. Part of Mispadu’s distribution chain that changes when the malicious Google Chrome extension is distributed as well. The rest of the distribution chain remains the same.</i></p></div>
<p>&nbsp;</p>
<div id="attachment_132163" style="width: 427px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure14_ChromeExtensionInstaller.png"><img class="wp-image-132163 size-full" src="/wp-content/uploads/2019/11/Figure14_ChromeExtensionInstaller.png" alt="" width="417" height="222" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure14_ChromeExtensionInstaller.png 417w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure14_ChromeExtensionInstaller-300x160.png 300w" sizes="(max-width: 417px) 100vw, 417px" /></a><p class="wp-caption-text"><i>Figure 14. The malicious Google Chrome extension installed by Mispadu</i></p></div>
<h3>Component 1: Manipulating windows</h3>
<p>This simple component has only a single functionality: it creates a new Google Chrome window and closes all others. This component was not present in all samples we analyzed and we believe it is still in the testing phase.</p>
<h3>Component 2: Stealing credit card data</h3>
<p>The second component contains a hardcoded list of websites. In pages served from these sites, it looks for any input field containing “text”, “email”, “tel”, “number”, “password” or “radio”. If “CVV”, “CÓD SEG” or their variants are found anywhere on the website, the content of those input fields is sent to the attacker when the victim submits the information. This clearly reveals the intention of this part of the extension – theft of credit card data.</p>
<h3>Component 3: Stealing banking and Boleto data</h3>
<p>The third component is the most advanced one. First, using a DGS-like algorithm, it generates two strings based on current day of month and month number. Those strings are then used to form a GitHub URL in the form of <span style="font-family: courier new, courier, monospace;">https://raw.githubusercontent.com/%FIRST_STRING%/w/master/%SECOND_STRING%</span>,<br />
where <span style="font-family: courier new, courier, monospace;">%FIRST_STRING%</span> is a GitHub username. Data downloaded from the generated URL are decrypted into a different URL we will call <em>payload URL</em>.</p>
<p>This component also contains a hardcoded list of targeted websites, as the previous one did. If the victim visits one of these websites, a malicious JavaScript file specific to that website is obtained from the <em>payload URL</em> and dynamically loaded via JavaScript’s eval function.</p>
<p>Besides that, this component also attempts to compromise the use of <a href="https://thebrazilbusiness.com/article/boleto-bancario-for-beginners" target="_blank" rel="noopener">Boleto</a>, a popular payment system common in Brazil. The system has been an attractive target for attackers for a long time (you can read more in <a href="https://www.virusbulletin.com/uploads/pdf/conference/vb2014/VB2014-Assolini.pdf" target="_blank" rel="noopener">this paper</a> from 2014). To pay using this system, you have to print a ticket (boleto). That contains mainly an ID number specific to the bank account that should receive the payment, and a barcode (see Figure 15). Payment is then done by either scanning the barcode or typing the ID number manually.</p>
<div id="attachment_132164" style="width: 694px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure15_BoletoBancario.png"><img class="wp-image-132164 size-full" src="/wp-content/uploads/2019/11/Figure15_BoletoBancario.png" alt="" width="684" height="407" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure15_BoletoBancario.png 684w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure15_BoletoBancario-300x179.png 300w" sizes="(max-width: 684px) 100vw, 684px" /></a><p class="wp-caption-text"><i>Figure 15. An example of a boleto (source: Wikipedia)</i></p></div>
<p>Using a <a href="https://en.wikipedia.org/wiki/Regular_expression" target="_blank" rel="noopener">regular expression</a>, the malware component tries to find the ID number and replace it with the attacker’s (obtained dynamically). Additionally, it abuses a legitimate website to generate the payment barcode using the attacker’s account number and replaces the legitimate one with that. The part of the code responsible for compromising Boleto is shown in Figure 16.</p>
<div id="attachment_132165" style="width: 694px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure16_BoletoHijack.png"><img class="wp-image-132165" src="/wp-content/uploads/2019/11/Figure16_BoletoHijack-300x285.png" alt="" width="684" height="650" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure16_BoletoHijack-300x285.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure16_BoletoHijack-768x730.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure16_BoletoHijack.png 924w" sizes="(max-width: 684px) 100vw, 684px" /></a><p class="wp-caption-text"><i>Figure 16. Mispadu&#8217;s Google Chrome extension that compromises Boleto. Code obtaining the attacker&#8217;s account number is marked in red, malicious barcode generation in green.</i></p></div>
<h2>Differences between campaigns</h2>
<p>Besides the already mentioned differences and the obvious fact that each variant of the Mispadu banking trojan targets a different set of banks dependent on country of residence, the Brazilian campaign differs from the Mexican one in several other minor aspects.</p>
<p>It seems to randomize the file system paths and filenames where configuration files are stored and the banking trojan is installed for each victim. Additionally, the <em>loader</em> script contains a part that is not used at the time of writing but that is ready to <a href="https://attack.mitre.org/techniques/T1170/" target="_blank" rel="noopener">abuse Windows <span style="font-family: courier new, courier, monospace;">mshta.exe</span></a> to execute the actual banking trojan instead of <span style="font-family: courier new, courier, monospace;">rundll.exe</span>.</p>
<h2>Conclusion</h2>
<p>In this blog post, we have talked about Mispadu, another Latin American banking trojan family isolated during our research. We have shown its main characteristics including reasons why we consider it a Latin American banking trojan &#8211; it is written in Delphi, targets Brazil and Mexico, uses pop-up windows and contains backdoor functionality.</p>
<p>We have described its most recent distribution chain and focused on some interesting aspects like Yandex.Mail being abused to store the malicious payloads and the usage of malicious Facebook ads. We have analyzed the configuration files used by Mispadu as well.</p>
<p>Finally, we have talked about a malicious Google Chrome extension that we have seen Mispadu distributing in Brazil. This extension’s goal is to steal credit card information, sensitive banking information and attempt to steal money from its victims by compromising the Boleto payment system in Brazil.</p>
<p><em>For any inquiries, contact us at threatintel@eset.com. Indicators of Compromise can also be found in </em><a href="https://github.com/eset/malware-ioc/tree/master/mispadu" target="_blank" rel="noopener"><em>our GitHub repository</em></a><em>.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Hashes</h3>
<h4><strong>Brazilian campaign</strong></h4>

<table id="tablepress-775" class="tablepress tablepress-id-775">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">A4EDA0DD2C33A644FEEF170F5C24CF7595C19017</td><td class="column-2">MSI installer</td><td class="column-3">VBS/TrojanDownloader.Agent.RVY</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">A9BADCBF3BD5C22EEB6FAF7DB8FC0A24CF18D121</td><td class="column-2">Mispadu injector</td><td class="column-3">Win32/Injector.EHXF</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">337892E76F3B2DF0CA851CCF4479E56EAF2DB8FD</td><td class="column-2">Mispadu banking trojan (PE compilation timestamp 8 Sep, 2019)</td><td class="column-3">Win32/Spy.Mispadu.C</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">A8CD12CC0BBD06F14AA136EA5A9A2E299E450B18</td><td class="column-2">Mispadu banking trojan (PE compilation timestamp 2 Oct, 2019)</td><td class="column-3">Win32/Spy.Mispadu.C</td>
</tr>
</tbody>
</table>

<h4><strong>Mexican campaign</strong></h4>

<table id="tablepress-776" class="tablepress tablepress-id-776">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">CFE21DBFB97C2E93F099D351DE54099A3FC0C98B</td><td class="column-2">MSI installer</td><td class="column-3">VBS/TrojanDownloader.Agent.RVY</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">251AC7386D1B376FB1CB0E02BDFC45472387C7BC</td><td class="column-2">Mispadu injector</td><td class="column-3">Win32/Injector.EHXF</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">A4FC4162162A02CE6FEADFE07B22465686A0EC39</td><td class="column-2">Mispadu banking trojan (PE compilation timestamp 10 Sep, 2019)</td><td class="column-3">Win32/Spy.Mispadu.J</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">710A20230B9774B3D725539385D714B2F80A5599</td><td class="column-2">Mispadu banking trojan (PE compilation timestamp 11 Sep, 2019)</td><td class="column-3">Win32/Spy.Mispadu.J</td>
</tr>
</tbody>
</table>

<h4><strong>Google Chrome extension</strong></h4>

<table id="tablepress-777" class="tablepress tablepress-id-777">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">3486F6F21034A33C5425A398839DE80AC88FECA8</td><td class="column-2">Component 1 (manipulating windows)</td><td class="column-3">JS/Spy.Banker.DQ</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">1D19191FB2E9DED396B6352CBF5A6746193D05E8</td><td class="column-2">Component 2 (credit cards)</td><td class="column-3">JS/Spy.Banker.DQ</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">22E6EBDFAB7C2B07FF8748AFE264737C8260E81E</td><td class="column-2">Component 3 (banking and Boleto data)</td><td class="column-3">JS/Spy.Banker.DQ</td>
</tr>
</tbody>
</table>

<h4><strong>Potentially unwanted applications for credential theft</strong></h4>

<table id="tablepress-778" class="tablepress tablepress-id-778">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">63DCBE2DB9CC14564EB84D5E953F2F9F5C54ACD9</td><td class="column-2">Email client credential stealer</td><td class="column-3">Win32/PSWTool.MailPassView.E</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">8B950BF660AA7B5FB619E1F6E665D348BF56C86A</td><td class="column-2">Google Chrome credential stealer</td><td class="column-3">Win32/PSWTool.ChromePass.A</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">F6021380AD6E26038B5629189A7ADA5E0022C313</td><td class="column-2">Mozilla Firefox credential stealer</td><td class="column-3">Win32/PSWTool.PassFox.F</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">76F70276EB95FFEC876010211B7198BCBC460646</td><td class="column-2">Internet Explorer credential stealer</td><td class="column-3">Win32/PSWTool.IEPassView.NAH</td>
</tr>
</tbody>
</table>

<h3>Filenames</h3>
<ul>
<li>C:\Users\Public\%COMPUTERNAME%[1]</li>
<li>C:\Users\Public\%COMPUTERNAME%[1]_</li>
<li>C:\Users\Public\{winx86,libeay32,ssleay32}.dll (legitimate DLLs downloaded by the <em>loader</em> script; partial indicator)</li>
</ul>
<h3>Servers used</h3>
<ul>
<li>http://18.219.25[.]133/br/mp1a{1,sq,sl,ss}.aj5</li>
<li>http://3.19.223[.]147/br/mp1a{1,sq,sl,ss}.aj5</li>
<li>http://51.75.95[.]179/la8a{1,sq,sl,ss}.ay2</li>
</ul>
<h3>Discount coupon URLs</h3>
<ul>
<li>Brazil
<ul>
<li>http://promoscupom[.]cf/</li>
<li>http://mcdonalds.promoscupom[.]cf/index3.html</li>
</ul>
</li>
<li>Mexico
<ul>
<li>http://mcdonalds.promoscupom[.]cf/index2.html</li>
</ul>
</li>
</ul>
<h3>Bitcoin wallet</h3>
<ul>
<li>3QWffRcMw6mmwv4dCyYZsXYFq7Le9jpuWc</li>
</ul>
<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-779" class="tablepress tablepress-id-779">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1192/" rel="noopener" target="_blank">T1192</a></td><td class="column-3">Spearphishing Link</td><td class="column-4">In Mispadu spam campaigns, the victim is led to the payload by a malicious link.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1085/" rel="noopener" target="_blank">T1085</a></td><td class="column-3">Rundll32</td><td class="column-4">Mispadu banking trojan is executed by an injector that is run via <span style="font-family: courier new, courier, monospace;">rundll32.exe</span>.</td>
</tr>
<tr class="row-4 even">
	<td rowspan="2" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1176/" rel="noopener" target="_blank">T1176</a></td><td class="column-3">Browser Extensions</td><td class="column-4">Mispadu variant targeting Brazil utilizes a Google Chrome browser extension.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Mispadu ensures persistence by creating a link in the startup folder.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="3" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Mispadu uses encoded configuration files.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">Mispadu masquerades as a discount coupon.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">Mispadu utilizes VBS exclusively in its distribution chains.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="3" class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">Mispadu may execute a keylogger. Its Google Chrome extension tries to steal various sensitive information via input capturing.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1081/" rel="noopener" target="_blank">T1081</a></td><td class="column-3">Credentials in Files</td><td class="column-4">Mispadu uses other tools to extract credentials for email clients and web browsers from files.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1214/" rel="noopener" target="_blank">T1214</a></td><td class="column-3">Credentials in Registry</td><td class="column-4">Mispadu uses other tools to extract credentials for email clients and web browsers from the Windows Registry.</td>
</tr>
<tr class="row-12 even">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Mispadu searches for various filesystem paths in order to determine what applications are installed on the victim's machine.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">Mispadu searches for various process names in order to determine what applications are running on the victim's machine.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1063/" rel="noopener" target="_blank">T1063</a></td><td class="column-3">Security Software Discovery</td><td class="column-4">Mispadu scans the system for installed security software.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Mispadu extracts the version of the operating system, computer name and language ID.</td>
</tr>
<tr class="row-16 even">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1115/" rel="noopener" target="_blank">T1115</a></td><td class="column-3">Clipboard Data</td><td class="column-4">Mispadu captures and replaces bitcoin wallets in the clipboard.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Mispadu contains a command to take screenshots.</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1024/" rel="noopener" target="_blank">T1024</a></td><td class="column-3">Custom Cryptographic Protocol</td><td class="column-4">Mispadu uses a custom cryptographic protocol to protect its data.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Mispadu sends the data it collects to its C&amp;C server.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-11-19 11:30:36">19 Nov 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Mispadu: Advertisement for a discounted Unhappy Meal">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Mispadu: Advertisement for a discounted Unhappy Meal">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Mispadu: Advertisement for a discounted Unhappy Meal">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Mispadu: Advertisement for a discounted Unhappy Meal">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F19%2Fmispadu-advertisement-discounted-unhappy-meal%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F19%2Fmispadu-advertisement-discounted-unhappy-meal%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F19%2Fmispadu-advertisement-discounted-unhappy-meal%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"132120 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=132120","disqusShortname":"welivesecurity","disqusTitle":"Mispadu: Advertisement for a discounted Unhappy Meal","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/11\/19\/mispadu-advertisement-discounted-unhappy-meal\/","postId":"132120"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>