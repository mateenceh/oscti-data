<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have discovered DePriMon, a new downloader with a novel, not previously seen in the wild installation technique"/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/11/21/deprimon-default-print-monitor-malicious-downloader/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have discovered DePriMon, a new downloader with a novel, not previously seen in the wild installation technique" />
<meta property="og:url" content="https://www.welivesecurity.com/2019/11/21/deprimon-default-print-monitor-malicious-downloader/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-11-21T10:30:06+00:00" />
<meta property="article:modified_time" content="2019-11-22T17:44:07+00:00" />
<meta property="og:updated_time" content="2019-11-22T17:44:07+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/11/DePriMon-2-e1574328067390.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/11/DePriMon-2-e1574328067390.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have discovered DePriMon, a new downloader with a novel, not previously seen in the wild installation technique" />
<meta name="twitter:title" content="Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/11/DePriMon-2-e1574328067390.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/11/22/deprimon-telechargeur-malveillant/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/11/21/deprimon-default-print-monitor-malicious-downloader/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/11/22/deprimon-fake-local-port-monitor-framework/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/11/22/deprimon-telechargeur-malveillant/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/11/22/deprimon-fake-local-port-monitor-framework/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/11/22/deprimon-telechargeur-malveillant/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/11/22/deprimon-fake-local-port-monitor-framework/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/11/DePriMon-e1574327550871.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon</h1>
<div class="excerpt">ESET researchers have discovered a new downloader with a novel, not previously seen in the wild installation technique</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-11-21 11:30:06">21 Nov 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F21%2Fdeprimon-default-print-monitor-malicious-downloader%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F21%2Fdeprimon-default-print-monitor-malicious-downloader%2F&text=Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F21%2Fdeprimon-default-print-monitor-malicious-downloader%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers have discovered a new downloader with a novel, not previously seen in the wild installation technique</p>
                            </div>

                            <p>DePriMon is a malicious downloader, with several stages and using many non-traditional techniques. To achieve persistence, the malware registers a new local port monitor &#8211; a trick falling under the “<a href="https://attack.mitre.org/techniques/T1013/" target="_blank" rel="noopener">Port Monitors</a>” technique in the <a href="https://attack.mitre.org/" target="_blank" rel="noopener">MITRE ATT&amp;CK knowledgebase</a>. For that, the malware uses the “Windows Default Print Monitor” name; that’s why we have named it DePriMon. Due to its complexity and modular architecture, we consider it to be a framework.</p>
<p>According to our telemetry, DePriMon has been active since at least March 2017. DePriMon was detected in a private company, based in Central Europe, and at dozens of computers in the Middle East.</p>
<p>Some of the domain names used as C&amp;C servers contain Arabic words, which gives an indication of a region‑specific campaign. However, DePriMon deserves attention beyond its targets’ geographical distribution: it is carefully written malware, with lots of encryption that is used properly.</p>
<p>To help defenders stay safe from this threat, we’ve thoroughly analyzed this newly discovered malware, focusing on the downloader itself. Because we’re missing initial stage(s), which we will refer to here as &#8220;the first stage&#8221;, we don&#8217;t know the initial distribution and compromise vector. What kind of final payload is used in the attacks is another question that remains to be answered.</p>
<p>However, it should be noted that, in a few cases, DePriMon was detected with ColoredLambert malware on the same computers within a short time frame. ColoredLambert is used by the Lamberts (aka Longhorn) cyberespionage group and linked to the Vault 7 leak of CIA capabilities. Our colleagues from <a href="https://www.symantec.com/connect/blogs/longhorn-tools-used-cyberespionage-group-linked-vault-7" target="_blank" rel="noopener">Symantec</a> and <a href="https://securelist.com/unraveling-the-lamberts-toolkit/77990/" target="_blank" rel="noopener">Kaspersky</a> published their analyses in April 2017.</p>
<h2>Technical analysis</h2>
<h3>Stage two</h3>
<p>Both DePriMon’s second and third stages are delivered to the victim’s disk in the first stage. The second stage installs itself and loads the third stage using an encrypted, hardcoded path. One of the possible explanations is that it was configured after the first stage of the attack occurred.</p>
<p>The described installation technique is unique. In principle, it is described in the MITRE ATT&amp;CK taxonomy as “Port Monitors”, under both Persistence and Privilege Escalation tactics. We believe DePriMon is the first example of malware using this technique ever publicly described.</p>
<p>The second stage registers the third-stage DLL as a port monitor by creating the following registry key and value:</p>
<p><span style="font-family: courier new, courier, monospace;">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors\Windows Default Print Monitor</span><br />
<span style="font-family: courier new, courier, monospace;">Driver = %PathToThirdStageDLL%</span></p>
<p>Administrator rights are required for creating this registry key.</p>
<p>At system startup, the registered DLL will be loaded by<span style="font-family: courier new, courier, monospace;"> spoolsv.exe</span> with <span style="font-family: courier new, courier, monospace;">SYSTEM</span> privileges, which, combined with the uniqueness of this method, makes this technique very effective for attackers.</p>
<p>The second stage checks regularly whether there is a file in the <span style="font-family: courier new, courier, monospace;">%system32%</span> folder with the same name as the third stage DLL file but without the “.dll” extension. This file serves as an uninstallation trigger – should DePriMon find it, it removes both this file and its own components in a secure way by overwriting the binaries and then deleting them.</p>
<h3>Stage three</h3>
<p>The third stage, responsible for downloading the main payload(s) from DePriMon’s operators, also implements some interesting techniques.</p>
<p>For C&amp;C communication, it uses the Microsoft implementation of SSL/TLS, Secure Channel, instead of common APIs like <span style="font-family: courier new, courier, monospace;">WinHTTP</span> or <span style="font-family: courier new, courier, monospace;">WinInet</span>. Its configuration is very complex, as is the way the malware handles it. Finally, the authors have put significant effort into encryption, making the DePriMon malware more difficult to analyze.</p>
<h3>C&amp;C communication</h3>
<p>DePriMon communicates securely over TLS, however, not on a high level as is a typical scenario in malware. The connection is initialized with a Windows socket and can continue with initialization of an authenticated Security Support Provider Interface (SSPI) session with the Negotiate / NTLM SSP. After that, DePriMon uses Schannel.</p>
<p>SSPI is used/not used according to a particular flag in the configuration file and can utilize the local proxy settings of the machine. The implementation is similar to this <a href="https://docs.microsoft.com/en-us/windows/desktop/secauthn/using-sspi-with-a-windows-sockets-client" target="_blank" rel="noopener">example provided by Microsoft</a>.</p>
<p>The malware’s implementation of TLS via Schannel is similar to this <a href="http://www.coastrd.com/c-schannel-smtp" target="_blank" rel="noopener">example by Coast Research &amp; Development</a>. It includes creating credentials, performing the client handshake and verifying the server certificate.</p>
<div id="attachment_132322" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure-1.png"><img class="wp-image-132322" src="/wp-content/uploads/2019/11/Figure-1-300x195.png" alt="" width="700" height="455" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-1-300x195.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-1-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-1.png 742w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 1. Part of the SSPI implementation as output by the Hex-Rays decompiler</i></p></div>
<p>After the communication is established, the third stage encrypts and decrypts messages manually each time.</p>
<h3>Configuration</h3>
<p>The configuration data for DePriMon’s third stage has 27 members, which is an unusually large number for a downloader. It is encrypted with AES-256 and embedded in the binary.</p>
<p>During the first run, DePriMon’s third stage (the downloader itself) decrypts the configuration data with Key 2 (see the IoCs section), encrypts it with Key 3 and stores the encrypted configuration file in a temporary folder. The filename for the configuration file is created via the following process: Starting with the second byte, the value of Key 2 is transformed into a number in base 36 but encoded using custom alphabet “abc…xyz012…789”. The extension of the configuration file is “.tmp”.</p>
<p>An example of a configuration file path: <span style="font-family: courier new, courier, monospace;">%temp%\rb1us0wm99sslpa1vx.tmp</span>.</p>
<p>During the second run, the downloader reads the configuration data from the file, not from itself – this way, the attacker can easily update the configuration.</p>
<p>Thanks to its secure design, the configuration is not left in memory in unencrypted form. Every time the downloader needs to use some element of the configuration file, it decrypts the configuration file, retrieves the member and encrypts the file again.</p>
<p>This design protects the malware’s primary function – C&amp;C communication &#8211; against memory forensics.</p>
<div id="attachment_132323" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/11/Figure-2.png"><img class="wp-image-132323" src="/wp-content/uploads/2019/11/Figure-2-300x215.png" alt="" width="700" height="502" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-2-300x215.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-2-768x551.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/11/Figure-2.png 856w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 2. Part of the code as seen by the Hex-Rays decompiler, which illustrates how the DePriMon malware decrypts the configuration file, saves a few members to local variables and encrypts it again</i></p></div>
<p>Of interest in the configuration file are:</p>
<ul>
<li>Two entries for usernames and two members for passwords – for the proxy server if it is set on the machine. It means attackers are preparing to further their attack via a proxy with credentials. However, we haven’t seen functionality for stealing these details, so it appears that it is done in another phase of the attack.</li>
<li>Three entries for three C&amp;C servers – each of them used on a different occasion.</li>
<li>Three entries for three ports – each of them used on a different occasion.</li>
<li>Flags indicating whether the downloader initializes a connection through Security Support Provider Interface (SSPI) with a possible proxy or only with a socket (described later).</li>
</ul>
<p>It should be noted that besides C&amp;C servers extracted from malware samples, we identified additional domains and servers likely related to this malware.</p>
<h3>Encryption</h3>
<p>The malware uses the AES encryption algorithm with three different 256-bit keys for different purposes (these keys are listed in the IoCs section).</p>
<ul>
<li>Key 1: For decryption of various sensitive strings in the malware.</li>
<li>Key 2: For encryption and decryption of the configuration data in memory (as described earlier). This key is also used to generate the third key.</li>
<li>Key 3: For encryption and decryption of the configuration file on disk.</li>
</ul>
<p>This key is not hardcoded but derived using a 32-byte array which is then encrypted. The array is generated as follows: the first 4 bytes are the volume serial number of the system drive, and the remaining 28 bytes contain the values 5 – 32. This array is encrypted with Key 2, resulting in Key 3.</p>
<h2>Conclusion</h2>
<p>DePriMon is an unusually advanced downloader whose developers have put extra effort into setting up the architecture and crafting the critical components.</p>
<p>DePriMon is downloaded to memory and executed directly from there as a DLL using the reflective DLL loading technique. It is never stored on disk. It has a surprisingly extensive configuration file with several interesting elements, its encryption is properly implemented and protects the C&amp;C communication effectively.</p>
<p>As a result, DePriMon is a powerful, flexible and persistent tool designed to download a payload and execute it, and to collect some basic information about the system and its user along the way.</p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>ESET detection names</h3>
<p><span style="font-family: courier new, courier, monospace;">Win32/DePriMon</span><br />
<span style="font-family: courier new, courier, monospace;">Win64/DePriMon</span></p>
<h3>SHA-1 hashes</h3>
<p><span style="font-family: courier new, courier, monospace;">02B38F6E8B54885FA967851A5580F61C14A0AAB6</span><br />
<span style="font-family: courier new, courier, monospace;">03E047DD4CECB16F513C44599BF9B8BA82D0B7CB</span><br />
<span style="font-family: courier new, courier, monospace;">0996C280AB704E95C9043C5A250CCE077DF9C8B2</span><br />
<span style="font-family: courier new, courier, monospace;">15EBE328A501B1D603E66762FBB4583D73E109F7</span><br />
<span style="font-family: courier new, courier, monospace;">1911F6E8B05E38A3C994048C759C5EA2B95CE5F7</span><br />
<span style="font-family: courier new, courier, monospace;">2B30BE3F39DEF1F404264D8858B89769E6C032D9</span><br />
<span style="font-family: courier new, courier, monospace;">2D80B235CDF41E09D055DD1B01FD690E13BE0AC7</span><br />
<span style="font-family: courier new, courier, monospace;">6DB79671A3F31F7A9BB870151792A56276619DC1</span><br />
<span style="font-family: courier new, courier, monospace;">6FAB7AA0479D41700981983A39F962F28CCFBE29</span><br />
<span style="font-family: courier new, courier, monospace;">7D0B08654B47329AD6AE44B8FF158105EA736BC3</span><br />
<span style="font-family: courier new, courier, monospace;">7E8A7273C5A0D49DFE6DA04FEF963E30D5258814</span><br />
<span style="font-family: courier new, courier, monospace;">8B4F3A06BA41F859E4CC394985BB788D5F76C85C</span><br />
<span style="font-family: courier new, courier, monospace;">94C0BE25077D9A76F14A63CBF7A774A96E8006B8</span><br />
<span style="font-family: courier new, courier, monospace;">968B52550062848A717027C512AFEDED19254F58</span><br />
<span style="font-family: courier new, courier, monospace;">9C4BADE47865E8111DD3EEE6C5C4BC83F2489F5B</span><br />
<span style="font-family: courier new, courier, monospace;">AA59CB6715CFFF545579861E5E77308F6CAEAC36</span><br />
<span style="font-family: courier new, courier, monospace;">C2388C2B2ED6063EACBA8A4021CE32EB0929FAD2</span><br />
<span style="font-family: courier new, courier, monospace;">CA34050771678C65040065822729F44B35C87B0C</span><br />
<span style="font-family: courier new, courier, monospace;">D38045B42C7E87C199993AB929AD92ADE4F82398</span><br />
<span style="font-family: courier new, courier, monospace;">E272FDA0E9BA1A1B8EF444FF5F2E8EE419746384</span><br />
<span style="font-family: courier new, courier, monospace;">E2D39E290201010F49652EE6116FD9B35C9AD882</span><br />
<span style="font-family: courier new, courier, monospace;">F413EEE3CFD85A60D7AFC4D4ECC4445BB1F0B8BC</span></p>
<h3>Domains</h3>

<table id="tablepress-780" class="tablepress tablepress-id-780">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Domain</th><th class="column-2">IP address</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">img.dealscienters[.]net</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">138.59.32.72</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">teknikgorus[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">88.119.179.17</span></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">wnupdnew[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">190.0.226.147</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">babmaftuh[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">185.56.89.196</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">alwatantrade[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">188.241.60.109</span></td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">shayalyawm[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">5.226.168.124</span></td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">elehenishing[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">185.225.17.77</span></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">almawaddrial[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">46.151.212.202</span></td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">mdeastserv[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">46.151.212.201</span></td>
</tr>
</tbody>
</table>

<h3>Keys &#8211; example</h3>
<p>Key 1: <span style="font-family: courier new, courier, monospace;">C097CF17DC3303BC8155534350464E50176ACA63842B0973831D8C6C8F136817</span><br />
Key 2: <span style="font-family: courier new, courier, monospace;">8D35913F80A23E820C23B3125ABF57901BC9A7B83283FB2B240193ABDEDE52B9</span><br />
Key 3: Derived as described earlier.</p>
<h3>Filenames</h3>
<p><span style="font-family: courier new, courier, monospace;">dpnvmrs.dll</span><br />
<span style="font-family: courier new, courier, monospace;">hp3mlnv.dll</span><br />
<span style="font-family: courier new, courier, monospace;">hp4mlnv.dll</span><br />
<span style="font-family: courier new, courier, monospace;">hp5nhd.dll</span><br />
<span style="font-family: courier new, courier, monospace;">hp6nhd.dll</span><br />
<span style="font-family: courier new, courier, monospace;">hpjdnb64.dll</span><br />
<span style="font-family: courier new, courier, monospace;">hpmdnel3b.dll</span><br />
<span style="font-family: courier new, courier, monospace;">ifssvc.dll</span><br />
<span style="font-family: courier new, courier, monospace;">ifssvcmgr.dll</span><br />
<span style="font-family: courier new, courier, monospace;">msprtmon64.dll</span><br />
<span style="font-family: courier new, courier, monospace;">msptromn.dll</span><br />
<span style="font-family: courier new, courier, monospace;">plamgr.dll</span><br />
<span style="font-family: courier new, courier, monospace;">ppcrlchk.dll</span><br />
<span style="font-family: courier new, courier, monospace;">ppcrlupd.dll</span><br />
<span style="font-family: courier new, courier, monospace;">prntapt.dll</span><br />
<span style="font-family: courier new, courier, monospace;">prntqdl64.dll</span><br />
<span style="font-family: courier new, courier, monospace;">pscript6f.dll</span><br />
<span style="font-family: courier new, courier, monospace;">pscript6s.dll</span><br />
<span style="font-family: courier new, courier, monospace;">shprn64.dll</span><br />
<span style="font-family: courier new, courier, monospace;">stprn32.dll</span><br />
<span style="font-family: courier new, courier, monospace;">winmnprt.dll</span></p>
<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-781" class="tablepress tablepress-id-781">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1013/" rel="noopener" target="_blank">T1013</a></td><td class="column-3">Port Monitors</td><td class="column-4">DePriMon installs one of its components as a port monitor for achieving persistence.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="5" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">DePriMon places its components into the System32 folder with names mimicking common system DLLs.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">DePriMon can delete itself securely by overwriting its files with random data and then deleting them.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">DePriMon adds registry entry in <span style="font-family: courier new, courier, monospace;">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</span> to achieve persistence.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1134/" rel="noopener" target="_blank">T1134</a></td><td class="column-3">Access Token Manipulation</td><td class="column-4">DePriMon obtains a user token for obtaining information about the proxy settings on the machine.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">DePriMon encrypts some of its strings and its configuration file using AES-256.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1007/" rel="noopener" target="_blank">T1007</a></td><td class="column-3">System Service Discovery</td><td class="column-4">DePriMon can list registered services on the system.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">DePriMon can list running processes on the system.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">DePriMon collects various information about the system.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1124/" rel="noopener" target="_blank">T1124</a></td><td class="column-3">System Time Discovery</td><td class="column-4">DePriMon regularly checks system time and performs various actions based on it, such as uninstallation.</td>
</tr>
<tr class="row-12 even">
	<td rowspan="3" class="column-1">Command And Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">DePriMon uses ports 443 and 8080 for C&amp;C communication.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">DePriMon uses HTTP for C&amp;C communication.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1090/" rel="noopener" target="_blank">T1090</a></td><td class="column-3">Connection Proxy</td><td class="column-4">DePriMon uses local proxy settings to make its communication less suspicious.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-11-21 11:30:06">21 Nov 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Registers as &#8220;Default Print Monitor&#8221;, but is a malicious downloader. Meet DePriMon">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F21%2Fdeprimon-default-print-monitor-malicious-downloader%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F21%2Fdeprimon-default-print-monitor-malicious-downloader%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F11%2F21%2Fdeprimon-default-print-monitor-malicious-downloader%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"132242 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=132242","disqusShortname":"welivesecurity","disqusTitle":"Registers as \u201cDefault Print Monitor\u201d, but is a malicious downloader. Meet DePriMon","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/11\/21\/deprimon-default-print-monitor-malicious-downloader\/","postId":"132242"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>