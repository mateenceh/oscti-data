<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Mathieu Tartare',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Winnti Group targeting universities in Hong Kong | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have discovered a new campaign of the Winnti Group that deploys ShadowPad and Winnti malware to target universities in Hong Kong."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Winnti Group targeting universities in Hong Kong | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have discovered a new campaign of the Winnti Group that deploys ShadowPad and Winnti malware to target universities in Hong Kong." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-01-31T10:30:18+00:00" />
<meta property="article:modified_time" content="2020-02-13T18:59:37+00:00" />
<meta property="og:updated_time" content="2020-02-13T18:59:37+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/01/Winnti-Group-targeting-Hong-Kong-universities.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/01/Winnti-Group-targeting-Hong-Kong-universities.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="709" />
<meta property="og:image:alt" content="Winnti Group targeting Hong Kong universities" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have discovered a new campaign of the Winnti Group that deploys ShadowPad and Winnti malware to target universities in Hong Kong." />
<meta name="twitter:title" content="Winnti Group targeting universities in Hong Kong | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/01/Winnti-Group-targeting-Hong-Kong-universities.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2020/02/03/nova-campanha-do-grupo-winnti-e-direcionada-a-universidades-em-hong-kong/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2020/02/01/groupe-winnti-universites-hong-kong/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/01/31/campana-grupo-winnti-dirigida-universidades-hong-kong/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/01/31/winnti-group-attackiert-universitaeten-in-hongkong/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2020/02/03/nova-campanha-do-grupo-winnti-e-direcionada-a-universidades-em-hong-kong/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/02/01/groupe-winnti-universites-hong-kong/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/01/31/campana-grupo-winnti-dirigida-universidades-hong-kong/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/01/31/winnti-group-attackiert-universitaeten-in-hongkong/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2020/02/03/nova-campanha-do-grupo-winnti-e-direcionada-a-universidades-em-hong-kong/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/02/01/groupe-winnti-universites-hong-kong/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/01/31/campana-grupo-winnti-dirigida-universidades-hong-kong/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/01/31/winnti-group-attackiert-universitaeten-in-hongkong/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/01/Winnti-Group.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Winnti Group targeting universities in Hong Kong</h1>
<div class="excerpt">ESET researchers uncover a new campaign of the Winnti Group targeting universities and using ShadowPad and Winnti malware</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2019/10/mathieu_t-1-222x179.jpg" alt="Mathieu Tartare">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                    Mathieu Tartare                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-01-31 11:30:18">31 Jan 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F01%2F31%2Fwinnti-group-targeting-universities-hong-kong%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F01%2F31%2Fwinnti-group-targeting-universities-hong-kong%2F&text=Winnti Group targeting universities in Hong Kong%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F01%2F31%2Fwinnti-group-targeting-universities-hong-kong%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers uncover a new campaign of the Winnti Group targeting universities and using ShadowPad and Winnti malware</p>
                            </div>

                            <p>In November 2019, we discovered a new campaign run by the Winnti Group against two Hong Kong universities. We found a new variant of the ShadowPad backdoor, the group’s flagship backdoor, deployed using a new launcher and embedding numerous modules. The Winnti malware was also found at these universities a few weeks prior to ShadowPad.</p>
<p>The Winnti Group, active since at least 2012, is responsible for for high-profile supply-chain attacks against the video game and software industries leading to the distribution of trojanized software (such as <a href="https://www.welivesecurity.com/2017/09/21/cconsiderations-on-ccleaner-incident/" target="_blank" rel="noopener">CCleaner</a>, ASUS LiveUpdate and multiple video games) that is then used to compromise more victims. It is also known for having compromised various targets in the healthcare and education sectors.</p>
<p>ESET researchers recently <a href="https://www.welivesecurity.com/2019/10/14/connecting-dots-exposing-arsenal-methods-winnti/" target="_blank" rel="noopener">published a white paper</a> updating our understanding of the arsenal of the Winnti Group, following a blog post documenting a <a href="https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/" target="_blank" rel="noopener">supply-chain attack targeting the videogame industry</a> in Asia. Additionally, we published a blog post on a <a href="https://www.welivesecurity.com/2019/10/21/winnti-group-skip2-0-microsoft-sql-server-backdoor/" target="_blank" rel="noopener">new backdoor named skip-2.0</a> that targets Microsoft SQL Server.</p>
<p>This article focuses on the technical details of this new ShadowPad variant.</p>
<div class="update-block"></p>
<p><em>About the “Winnti Group” naming: </em></p>
<p><em>We have chosen to keep the name “Winnti Group” since it’s the name first used to identify it, in 2013, by Kaspersky. Since Winnti is also a malware family, we always write &#8220;Winnti Group&#8221; when we refer to the malefactors behind the attacks. Since 2013, it has been demonstrated that Winnti is only one of the many malware families used by the Winnti Group.</em></p>
<p></div>
<h2>ShadowPad found at several Hong Kong universities</h2>
<p>In November 2019, <a href="https://www.welivesecurity.com/2017/06/20/machine-learning-eset-road-augur/" target="_blank" rel="noopener">ESET&#8217;s machine-learning engine, Augur</a>, detected a malicious and unique sample present on multiple computers belonging to two Hong Kong universities where the Winnti malware had already been found at the end of October. The suspicious sample detected by Augur is actually a new 32-bit ShadowPad launcher. Samples from both ShadowPad and Winnti found at these universities contain campaign identifiers and C&amp;C URLs with the names of the universities, which indicates a targeted attack.</p>
<p>In addition to the two compromised universities, thanks to the C&amp;C URL format used by the attackers we have reasons to think that at least three additional Hong Kong universities may have been compromised using these same ShadowPad and Winnti variants.</p>
<p>This campaign of the Winnti Group against Hong Kong universities was taking place in the context of Hong Kong facing civic protests that started in June 2019 triggered by an extradition bill. Even though the bill was withdrawn in October 2019, protests continued, demanding full democracy and investigation of the Hong Kong police. These protests gathered hundreds of thousands of people in the streets with large support from students of Hong Kong universities, leading to multiple university campus occupations by the protesters.</p>
<p>We have contacted the compromised universities and provided the necessary information and assistance to remediate the compromise.</p>
<h3>Updated launcher</h3>
<p>Unlike previous ShadowPad variants documented in our white paper on the arsenal of the Winnti Group, this launcher is not obfuscated using VMProtect. Furthermore, the encrypted payload is neither embedded in the overlay nor located in a <span style="font-family: courier new, courier, monospace;">COM1:NULL.dat</span> alternate data stream. And the usual RC5 encryption with a key derived from the volume ID of the system drive of the victim machine (as seen in the PortReuse backdoor, skip-2.0 and some ShadowPad variants) is not present either. In this case, the launcher is much simpler.</p>
<h3>DLL side-loading</h3>
<p>The launcher is a 32-bit DLL named <span style="font-family: courier new, courier, monospace;">hpqhvsei.dll</span>, which is the name of a legitimate DLL loaded by<span style="font-family: courier new, courier, monospace;"> hpqhvind.exe</span>. This executable is from HP and is usually installed with their printing and scanning software called “HP Digital Imaging”. In this case the legitimate <span style="font-family: courier new, courier, monospace;">hpqhvind.exe</span> was dropped by the attackers, along with their malicious <span style="font-family: courier new, courier, monospace;">hpqhvsei.dll</span>, in <span style="font-family: courier new, courier, monospace;">C:\Windows\Temp<span style="font-family: georgia, palatino, serif;">.</span></span></p>
<p>Although we do not have the component that dropped and executed this launcher, the presence of these files leads us to think that the initial execution of this launcher is done through DLL side-loading.</p>
<p>When the malicious DLL is loaded at <span style="font-family: courier new, courier, monospace;">hpqhvind.exe</span> startup, its DLLMain function is called that will check its parent process for the following sequence of bytes at offset <span style="font-family: courier new, courier, monospace;">0x10BA</span>:</p>
<p><span style="font-family: courier new, courier, monospace;">85 C0 ; test eax, eax</span><br />
<span style="font-family: courier new, courier, monospace;">0F 84 ; jz</span></p>
<p>In the case where the parent process is <span style="font-family: courier new, courier, monospace;">hpqhvind.exe</span>, this sequence of bytes is present at this exact location and the malicious DLL will proceed to patch the parent process in memory. It replaces the original instructions at <span style="font-family: courier new, courier, monospace;">0x10BA</span> with an unconditional jump (<span style="font-family: courier new, courier, monospace;">jmp – 0xE9</span>) to the address of the function from <span style="font-family: courier new, courier, monospace;">hpqhvsei.dll</span> that decrypts and executes the encrypted payload embedded in the launcher.</p>
<p>The decompiled function responsible for patching the parent process is shown in Figure 1. In case <span style="font-family: courier new, courier, monospace;">hpqhvsei.dll</span> is loaded by a different process than <span style="font-family: courier new, courier, monospace;">hpqhvind.exe</span>, the malicious code will not be decrypted and executed.</p>
<div id="attachment_134562" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2020/01/Figure-1.png"><img class="wp-image-134562" src="/wp-content/uploads/2020/01/Figure-1-300x176.png" alt="" width="750" height="440" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-1-300x176.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-1-768x450.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-1-1024x600.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-1.png 1412w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 1. Decompiled function responsible for patching the parent process</i></p></div>
<p>The difference between the original and patched <span style="font-family: courier new, courier, monospace;">hpqhvind.exe</span> is shown in Figure 2.</p>
<div id="attachment_134563" style="width: 758px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2020/01/Figure-2.png"><img class="wp-image-134563" src="/wp-content/uploads/2020/01/Figure-2-300x44.png" alt="" width="748" height="109" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-2-300x44.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-2-768x112.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-2-1024x149.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-2.png 1373w" sizes="(max-width: 748px) 100vw, 748px" /></a><p class="wp-caption-text"><i>Figure 2. Difference between original (left) and patched (right)</i> <span style="font-family: courier new, courier, monospace;">hpqhvind.exe</span></p></div>
<p>The part of the code that is patched is located at the very beginning of the main function of <span style="font-family: courier new, courier, monospace;">hpqhvind.exe</span>. As we can see in Figure 2, the patched code is located right after the load of <span style="font-family: courier new, courier, monospace;">hpqhvsei.dll</span>. This means that the function responsible for decrypting and executing the payload is executed directly after the load of the malicious DLL.</p>
<h3>Payload decryption</h3>
<p>The encrypted payload is located in the <span style="font-family: courier new, courier, monospace;">.rdata</span> section of <span style="font-family: courier new, courier, monospace;">hpqhvsei.dll</span> and the decryption algorithm is an XOR loop where the XOR key is updated at each iteration, as shown in Figure 3.</p>
<div id="attachment_134564" style="width: 759px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2020/01/Figure-3.png"><img class="wp-image-134564" src="/wp-content/uploads/2020/01/Figure-3-300x70.png" alt="" width="749" height="175" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-3-300x70.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-3-768x180.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-3-1024x239.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-3.png 1232w" sizes="(max-width: 749px) 100vw, 749px" /></a><p class="wp-caption-text"><i>Figure 3. Pseudocode of the payload decryption loop</i></p></div>
<p>The decrypted payload is the usual shellcode responsible for ShadowPad initialization (obfuscated using fake conditional jumps to hinder disassembly).</p>
<h3>Persistence</h3>
<p>After having been decrypted, ShadowPad&#8217;s shellcode is executed. It will first achieve persistence on the system by writing the in-memory patched parent process to disk to a path specified in the configuration string pool. In the case we examined, the path was <span style="font-family: courier new, courier, monospace;">C:\ProgramData\DRM\CLR\CLR.exe</span>. It then creates a service named <span style="font-family: courier new, courier, monospace;">clr_optimization_v4.0.30229_32</span>, which is responsible for executing <span style="font-family: courier new, courier, monospace;">CLR.exe</span>. To avoid suspicion, this service name, as well as the executable name, were chosen to look similar to the name of a Microsoft .NET optimization Service.</p>
<p>The full staging process is summarized in Figure 4. The numbering on each arrow corresponds to the chronological sequence of events.</p>
<div id="attachment_134565" style="width: 759px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2020/01/Figure-4.png"><img class="wp-image-134565" src="/wp-content/uploads/2020/01/Figure-4-300x159.png" alt="" width="749" height="396" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-4-300x159.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-4-768x406.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-4-1024x541.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/01/Figure-4.png 1243w" sizes="(max-width: 749px) 100vw, 749px" /></a><p class="wp-caption-text"><i>Figure 4. ShadowPad staging process</i></p></div>
<h3>Modules</h3>
<p>ShadowPad is a multimodular backdoor where the modules are referenced from the Root module with a circular list from which one can extract the module address, a UNIX timestamp (probably embedded automatically during the module’s compilation process) and a module identifier. From the module itself we can also extract the name the developer gave to the module. This version embeds the 17 modules listed in the following table:</p>
<p><em>Table 1. Modules used with this ShadowPad version</em></p>

<table id="tablepress-798" class="tablepress tablepress-id-798">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>ID</strong></th><th class="column-2">Name</th><th class="column-3">Timestamp</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>100</strong></td><td class="column-2">Root</td><td class="column-3">Thu 24 Oct 2019 12:08:27 PM UTC</td><td class="column-4">Initial shellcode</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><strong>101</strong></td><td class="column-2">Plugins</td><td class="column-3">Thu 24 Oct 2019 12:07:02 PM UTC</td><td class="column-4">Provides API for the other modules; loads modules  </td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><strong>102</strong></td><td class="column-2">Config</td><td class="column-3">Thu 24 Oct 2019 12:07:09 PM UTC</td><td class="column-4">Handles encrypted configuration string pool</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong>103</strong></td><td class="column-2">Install</td><td class="column-3">Thu 24 Oct 2019 12:07:46 PM UTC</td><td class="column-4">Achieves persistence</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><strong>104</strong></td><td class="column-2">Online</td><td class="column-3">Thu 24 Oct 2019 12:07:17 PM UTC</td><td class="column-4">Overall communications with the C&amp;C server</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><strong>106</strong></td><td class="column-2">ImpUser</td><td class="column-3">Thu 24 Oct 2019 12:07:24 PM UTC</td><td class="column-4">User impersonation via token duplication</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><strong>200</strong></td><td class="column-2">TCP</td><td class="column-3">Thu 24 Oct 2019 12:01:01 PM UTC</td><td class="column-4">TCP communications</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><strong>202</strong></td><td class="column-2">HTTPS</td><td class="column-3">Thu 24 Oct 2019 12:01:15 PM UTC</td><td class="column-4">HTTPS communications</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><strong>207</strong></td><td class="column-2">Pipe</td><td class="column-3">Thu 24 Oct 2019 12:01:35 PM UTC</td><td class="column-4">Handles named pipes</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><strong>300</strong></td><td class="column-2">Disk</td><td class="column-3">Thu 24 Oct 2019 12:02:29 PM UTC</td><td class="column-4">File system operations</td>
</tr>
<tr class="row-12 even">
	<td class="column-1"><strong>301</strong></td><td class="column-2">Process</td><td class="column-3">Thu 24 Oct 2019 12:02:36 PM UTC</td><td class="column-4">Process handling</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1"><strong>302</strong></td><td class="column-2">Servcie</td><td class="column-3">Thu 24 Oct 2019 12:02:45 PM UTC</td><td class="column-4">Service handling</td>
</tr>
<tr class="row-14 even">
	<td class="column-1"><strong>303</strong></td><td class="column-2">Register</td><td class="column-3">Thu 24 Oct 2019 12:02:52 PM UTC</td><td class="column-4">Registry operations</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1"><strong>304</strong></td><td class="column-2">Shell</td><td class="column-3">Thu 24 Oct 2019 12:03:00 PM UTC</td><td class="column-4">Command line operations</td>
</tr>
<tr class="row-16 even">
	<td class="column-1"><strong>306</strong></td><td class="column-2">Keylogger</td><td class="column-3">Thu 24 Oct 2019 12:03:16 PM UTC</td><td class="column-4">Keylogging to file system</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1"><strong>307</strong></td><td class="column-2">Screen</td><td class="column-3">Thu 24 Oct 2019 12:03:25 PM UTC</td><td class="column-4">Screenshot capture</td>
</tr>
<tr class="row-18 even">
	<td class="column-1"><strong>317</strong></td><td class="column-2">RecentFiles</td><td class="column-3">Thu 24 Oct 2019 12:04:44 PM UTC</td><td class="column-4">Lists recently accessed files</td>
</tr>
</tbody>
</table>

<p>These modules, except for RecentFiles, have already been mentioned by <a href="https://2018.conference.auscert.org.au/contents/data/2018/06/18161612/Noushin_Shabab_Finding_A_Monster_By_Its_Shadow_AusCERT18.pdf" target="_blank" rel="noopener">Kaspersky </a>and <a href="https://published-prd.lanyonevents.com/published/rsaus18/sessionsFiles/8739/HTA-T10_CCleaner%20APT%20Attack-A%20Technical%20Look%20Inside.pdf" target="_blank" rel="noopener">Avast</a>. Notice the “Servcie” typo.</p>
<p>As usual, all the module timestamps are spread over a short time range, which could suggest the use of a build framework to compile these modules. This also suggests that these modules were built a few hours before the launcher itself, whose compilation timestamp is <span style="font-family: courier new, courier, monospace;">Thu Oct 24 14:10:32 2019</span>. Since this compilation timestamp dates back two weeks before this campaign, it’s likely that it hasn’t been tampered with by the attackers.</p>
<p>One might also note that the number of modules embedded in this variant is much higher (17) than the number of modules embedded in the variants previously documented in our white paper (8 to 10 modules).</p>
<p>By default, every keystroke is recorded using the Keylogger module (<span style="font-family: courier new, courier, monospace;">306</span>, previously documented by Avast) and saved to disk in the file <span style="font-family: courier new, courier, monospace;">%APPDATA%\PAGM\OEY\XWWEYG\WAOUE<span style="font-family: georgia, palatino, serif;">.</span></span></p>
<p>The log file is encrypted using the same algorithm as the one used to encrypt static strings from the module. Using this module by default indicates that the attackers are interested in stealing information from the victims’ machines. In contrast, the variants we described in our white paper didn’t even have that module embedded.</p>
<h3>Configuration</h3>
<p>As with previous ShadowPad variants, the Config module (<span style="font-family: courier new, courier, monospace;">102</span>) contains an encrypted string pool that can be accessed from any other module. The string pool is never stored entirely decrypted in memory; the field of interest is decrypted when needed and then immediately freed (thus quickly unavailable). The configuration size is <span style="font-family: courier new, courier, monospace;">2180</span> bytes and the encrypted strings are located at offset <span style="font-family: courier new, courier, monospace;">0x84</span>. The algorithm used to decrypt the strings is the same as the one used to decrypt the static strings of the module. The decrypted content of the string pool is the following:</p>
<p><span style="font-family: courier new, courier, monospace;">0x84: 2019/11/7 16:28:36</span><br />
<span style="font-family: courier new, courier, monospace;">0x99: <strong>CAMPAIGN_ID_REDACTED</strong></span><br />
<span style="font-family: courier new, courier, monospace;">0xa1: %ALLUSERSPROFILE%\DRM\CLR\CLR.exe</span><br />
<span style="font-family: courier new, courier, monospace;">0xc5: clr_optimization_v4.0.30229_32</span><br />
<span style="font-family: courier new, courier, monospace;">oxe6: clr_optimization_v4.0.30229_32</span><br />
<span style="font-family: courier new, courier, monospace;">0x107: clr_optimization_v4.0.30229_32</span><br />
<span style="font-family: courier new, courier, monospace;">0x128: SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span><br />
<span style="font-family: courier new, courier, monospace;">0x158: CLR</span><br />
<span style="font-family: courier new, courier, monospace;">0x15e: %ProgramFiles%\Windows Media Player\wmplayer.exe</span><br />
<span style="font-family: courier new, courier, monospace;">0x197: %windir%\system32\svchost.exe</span><br />
<span style="font-family: courier new, courier, monospace;">0x1b7: TCP://b<strong>[redacted]</strong>.dnslookup.services:443</span><br />
<span style="font-family: courier new, courier, monospace;">0x1db: UDP://b<strong>[redacted]</strong>.dnslookup.services:443</span><br />
<span style="font-family: courier new, courier, monospace;">0x202: SOCKS4</span><br />
<span style="font-family: courier new, courier, monospace;">0x21e: SOCKS5</span></p>
<p>The campaign ID is located at offset <span style="font-family: courier new, courier, monospace;">0x99</span> and is the name of the targeted university. Having a campaign ID related to the target is quite common in the case of ShadowPad and Winnti.</p>
<p>Interestingly, the timestamp present in this config at offset <span style="font-family: courier new, courier, monospace;">0x84</span> is later than the modules’ timestamps and the loader compilation timestamp. This suggests that this config is added manually to the sample after having been built. Even though it’s probably coincidental, the date within the config corresponds to the date of the first detection of this sample at the corresponding university.</p>
<h3>Network Communications</h3>
<p>Once installed on the system, ShadowPad starts a hidden and suspended Microsoft Windows Media Player <span style="font-family: courier new, courier, monospace;">wmplayer.exe</span> process and injects itself into that process. The path to <span style="font-family: courier new, courier, monospace;">wmplayer.exe</span> is provided by the Config module.</p>
<p>Once ShadowPad is injected into <span style="font-family: courier new, courier, monospace;">wmplayer.exe</span>, the Online module will contact the C&amp;C server using the URL specified in the configuration. It will then start listening for connections on port <span style="font-family: courier new, courier, monospace;">13567</span> after having updated firewall rules accordingly:</p>
<p>Registry key:<br />
<span style="font-family: courier new, courier, monospace;">HKLM\SYSTEM\ControlSet001\services\SharedAccess\Parameters\FirewallPolicy\FirewallRules\{816381AB-1400-45E5-B560-B8E11C5988CF}</span></p>
<p>Value:<br />
<span style="font-family: courier new, courier, monospace;">v2.10|Action=Allow|Active=TRUE|Dir=In|Protocol=6|Profile=Public|LPort=13567|Name=Network Discovery (TCP)|</span></p>
<p>The communication is then handled by the TCP module (<span style="font-family: courier new, courier, monospace;">200</span>), which was previously documented by <a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/08/07172148/ShadowPad_technical_description_PDF.pdf" target="_blank" rel="noopener">Kaspersky</a>.</p>
<h2>Winnti malware was there as well</h2>
<p>In addition to ShadowPad, the Winnti malware was found on some machines at these two universities at the end of October (i.e. two weeks before ShadowPad) in the file <span style="font-family: courier new, courier, monospace;">C:\Windows\System32\oci.dll</span> and is detected by ESET products as <span style="font-family: courier new, courier, monospace;">Win64/Winnti.CA</span>.</p>
<p>The Winnti malware usually contains a configuration specifying a campaign ID and a C&amp;C URL. On all machines the campaign ID matches the name of the targeted university and the C&amp;C URLs are:</p>
<ul>
<li>w<strong>[redacted]</strong>.livehost.live:443</li>
<li>w<strong>[redacted]</strong>.dnslookup.services:443</li>
</ul>
<p>where the redacted part corresponds to the name of the targeted university.</p>
<h2>C&amp;C URL format</h2>
<p>One can observe that the C&amp;C URL used by both Winnti and ShadowPad complies to the scheme <span style="font-family: courier new, courier, monospace;">[backdoor_type][target_name].domain.tld:443</span> where <span style="font-family: courier new, courier, monospace;">[backdoor_type]</span> is a single letter which is either “<span style="font-family: courier new, courier, monospace;">w</span>” in the case of the Winnti malware or “<span style="font-family: courier new, courier, monospace;">b</span>” in the case of ShadowPad.</p>
<p>From this format, we were able to find several C&amp;C URLs, including three additional Hong Kong universities’ names. The campaign identifiers found in the samples we’ve analyzed match the subdomain part of the C&amp;C server, showing that these samples were really targeted against these universities.</p>
<h2>Conclusion</h2>
<p>The Winnti Group is still actively using one of its flagship backdoors, ShadowPad, this time against Hong Kong universities. In this campaign, the VMProtected launcher used with ShadowPad, as well as with the PortReuse backdoor and skip-2.0, was replaced by a simpler one. That these samples, in addition to having been found at these universities, contain campaign IDs matching the universities’ names and use C&amp;C URLs containing the universities’ names are good indications that this campaign is highly targeted.</p>
<p>We will continue to monitor new activities of the Winnti Group and will publish relevant information on our blog. For any inquiries, contact us at <a href="mailto:threatintel@eset.com">threatintel@eset.com</a>. The IoCs are also available in <a href="https://github.com/eset/malware-ioc/tree/master/winnti_group" target="_blank" rel="noopener">our GitHub repository</a>.</p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>ESET detection names</h3>
<p><span style="font-family: courier new, courier, monospace;">Win32/Shadowpad.C trojan</span><br />
<span style="font-family: courier new, courier, monospace;">Win64/Winnti.CA trojan</span></p>
<h3>File names</h3>
<p><span style="font-family: courier new, courier, monospace;">%ALLUSERSPROFILE%\DRM\CLR\hpqhvsei.dll</span><br />
<span style="font-family: courier new, courier, monospace;">%ALLUSERSPROFILE%\DRM\CLR\CLR.exe</span><br />
<span style="font-family: courier new, courier, monospace;">C:\windows\temp\hpqhvsei.dll</span><br />
<span style="font-family: courier new, courier, monospace;">C:\windows\temp\hpqhvind.exe</span><br />
<span style="font-family: courier new, courier, monospace;">%ALLUSERSPROFILE%\DRM\CLR\hpqhvsei.dll</span><br />
<span style="font-family: courier new, courier, monospace;">%SYSTEM32%\oci.dll</span><br />
<span style="font-family: courier new, courier, monospace;">%APPDATA%\PAGM\OEY\XWWEYG\WAOUE</span></p>
<h3>Service display name</h3>
<p><span style="font-family: courier new, courier, monospace;">clr_optimization_v4.0.30229_32</span></p>
<h3>C&amp;C servers</h3>
<p><span style="font-family: courier new, courier, monospace;">b[org_name].dnslookup[.]services:443</span><br />
<span style="font-family: courier new, courier, monospace;">w[org_name].livehost[.]live:443</span><br />
<span style="font-family: courier new, courier, monospace;">w[org_name].dnslookup[.]services:443</span></p>
<h3>ShadowPad launcher</h3>
<p>Similar sample to avoid disclosing targeted universities.<br />
<span style="font-family: courier new, courier, monospace;">693f0bd265e7a68b5b98f411ecf1cd3fed3c84af</span></p>
<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-797" class="tablepress tablepress-id-797">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID   </th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1050/" rel="noopener" target="_blank">T1050</a></td><td class="column-3">New Service</td><td class="column-4">ShadowPad persists as a service called <span style="font-family: courier new, courier, monospace;"> clr_optimization_v4.0.30229_32</span>.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="5" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1073/" rel="noopener" target="_blank">T1073</a></td><td class="column-3">DLL Side-Loading</td><td class="column-4">ShadowPad’s launcher is loaded by a legitimate executable via DLL side-loading.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td><td class="column-3">Process Injection</td><td class="column-4">ShadowPad is injected into a <span style="font-family: courier new, courier, monospace;">wmplayer.exe</span> process.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">ShadowPad launcher uses XOR to decrypt the payload. ShadowPad uses a custom algorithm to decrypt strings and configuration.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">ShadowPad shellcode is XOR-encoded and uses fake conditional jumps to hinder disassembly. ShadowPad’s strings and configuration are encrypted. It also uses API hashing.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1143/" rel="noopener" target="_blank">T1143</a></td><td class="column-3">Hidden Window</td><td class="column-4">ShadowPad is injected into a  <span style="font-family: courier new, courier, monospace;">wmplayer.exe</span> process started in a hidden window.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="2" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1010/" rel="noopener" target="_blank">T1010</a></td><td class="column-3">Application Window Discovery</td><td class="column-4">ShadowPad’s keylogging module lists application windows.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">ShadowPad’s RecentFiles module lists files recently accessed.</td>
</tr>
<tr class="row-10 even">
	<td rowspan="5" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">ShadowPad can use HTTP and HTTPS for C&amp;C communications.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">ShadowPad uses TCP:443 and UDP:443.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1065/" rel="noopener" target="_blank">T1065</a></td><td class="column-3">Uncommonly Used Port</td><td class="column-4">ShadowPad listens on port 13567.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1095/" rel="noopener" target="_blank">T1095</a></td><td class="column-3">Standard Non-Application Layer Protocol</td><td class="column-4">ShadowPad can use UDP and TCP for C&amp;C communications.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1024/" rel="noopener" target="_blank">T1024</a></td><td class="column-3">Custom Cryptographic Protocol</td><td class="column-4">ShadowPad uses its own cryptographic protocol for C&amp;C communications.</td>
</tr>
<tr class="row-15 odd">
	<td rowspan="2" class="column-1">Collection </td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">ShadowPad has a keylogging module.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">ShadowPad has a screenshot module.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank">T1022</a></td><td class="column-3">Data Encrypted</td><td class="column-4">Keystrokes recorded by the keylogging module are stored encrypted on disk.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                    Mathieu Tartare                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-01-31 11:30:18">31 Jan 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Winnti Group targeting universities in Hong Kong">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Winnti Group targeting universities in Hong Kong">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Winnti Group targeting universities in Hong Kong">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Winnti Group targeting universities in Hong Kong">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F01%2F31%2Fwinnti-group-targeting-universities-hong-kong%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F01%2F31%2Fwinnti-group-targeting-universities-hong-kong%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F01%2F31%2Fwinnti-group-targeting-universities-hong-kong%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"134555 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=134555","disqusShortname":"welivesecurity","disqusTitle":"Winnti Group targeting universities in Hong Kong","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/01\/31\/winnti-group-targeting-universities-hong-kong\/","postId":"134555"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>