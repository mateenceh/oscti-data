<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Grandoreiro: How engorged can an EXE get? | WeLiveSecurity</title>
<meta name="description" content="ESET researchers detail their findings about Grandoreiro, a Latin American banking trojan that is distributed solely through spam and shows unusual effort by its authors to evade detection and emulation, and progress towards a modular architecture."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/04/28/grandoreiro-how-engorged-can-exe-get/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Grandoreiro: How engorged can an EXE get? | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers detail their findings about Grandoreiro, a Latin American banking trojan that is distributed solely through spam and shows unusual effort by its authors to evade detection and emulation, and progress towards a modular architecture." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/04/28/grandoreiro-how-engorged-can-exe-get/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-04-28T09:30:06+00:00" />
<meta property="article:modified_time" content="2020-05-05T01:03:30+00:00" />
<meta property="og:updated_time" content="2020-05-05T01:03:30+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/04/grandoreiro-featured-image-1024x683-e1588012017395.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/04/grandoreiro-featured-image-1024x683-e1588012017395.png" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="416" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers detail their findings about Grandoreiro, a Latin American banking trojan that is distributed solely through spam and shows unusual effort by its authors to evade detection and emulation, and progress towards a modular architecture." />
<meta name="twitter:title" content="Grandoreiro: How engorged can an EXE get? | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/04/grandoreiro-featured-image-1024x683-e1588012017395.png" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2020/04/28/grandoreiro-trojan-bancario-afeta-usuarios-no-brasil/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/04/28/grandoreiro-how-engorged-can-exe-get/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/04/28/grandoreiro-troyano-bancario-dirigido-brasil-espana-mexico-peru/" hreflang="es" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2020/04/28/grandoreiro-trojan-bancario-afeta-usuarios-no-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/04/28/grandoreiro-troyano-bancario-dirigido-brasil-espana-mexico-peru/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2020/04/28/grandoreiro-trojan-bancario-afeta-usuarios-no-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/04/28/grandoreiro-troyano-bancario-dirigido-brasil-espana-mexico-peru/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/04/grandoreiro.png'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Grandoreiro: How engorged can an EXE get?</h1>
<div class="excerpt">Another in our occasional series demystifying Latin American banking trojans</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-04-28 11:30:06">28 Apr 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F28%2Fgrandoreiro-how-engorged-can-exe-get%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F28%2Fgrandoreiro-how-engorged-can-exe-get%2F&text=Grandoreiro: How engorged can an EXE get?%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F28%2Fgrandoreiro-how-engorged-can-exe-get%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Another in our occasional series demystifying Latin American banking trojans</p>
                            </div>

                            <p>In this installment of our series, we introduce Grandoreiro, a Latin American banking trojan targeting Brazil, Mexico, Spain and Peru. As such, it shows unusual effort by its authors to evade detection and emulation, and progress towards a modular architecture.</p>
<p>We have seen Grandoreiro being distributed solely through spam. The authors usually utilize a fake Java or Flash update, but recently, perhaps unsurprisingly, we have observed their spam abusing the fear around COVID-19 as well.</p>
<p>We have named this malware family based on its most notable characteristic – its binaries being bloated to at least a few hundred megabytes. Its development is quite rapid and feature changes and additions are happening very often. In this blogpost, we will focus on the most noteworthy.</p>
<h2>Characteristics</h2>
<p>Grandoreiro is another Delphi-written Latin American banking trojan we have identified during our research. Grandoreiro has been active at least since 2017 targeting Brazil and Peru, expanding to Mexico and Spain in 2019 (see Figure 1 for a current detection heat map). The fact that it attacks its victims by displaying fake pop-up windows that try to persuade victims to divulge sensitive information should come as no surprise to anyone who has read the <a href="#further-reading">previous pieces in the series</a>.<br />
.</p>
<div id="attachment_137758" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-6.png"><img class="wp-image-137758" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-6-300x162.png" alt="" width="700" height="377" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-6-300x162.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-6-768x414.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-6-1024x552.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-1-6.png 1203w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 1. Heat map showing ESET&#8217;s detections of Grandoreiro.</i></p></div>
<p>Grandoreiro, as with any other Latin American banking trojan, employs backdoor functionality, being capable of:</p>
<ul>
<li>manipulating windows</li>
<li>updating itself</li>
<li>capturing keystrokes</li>
<li>simulating mouse and keyboard actions</li>
<li>navigating the victim’s browser to a chosen URL</li>
<li>logging the victim out or restarting the machine</li>
<li>blocking access to chosen websites</li>
</ul>
<p>Persistence is ensured by creating a <span style="font-family: courier new, courier, monospace;">.LNK</span> file in the Windows startup directory. Of importance is the fact that Grandoreiro uses the same algorithm for decrypting its internal strings as <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a>. We believe this is due to information sharing between authors of banking trojans in Latin America.</p>
<p>Grandoreiro collects the following information about its victims:</p>
<ul>
<li>computer name</li>
<li>username</li>
<li>operating system version and bitness</li>
<li>whether Diebold Warsaw GAS Tecnologia (an application, popular in Brazil, to protect access to online banking) is installed</li>
<li>list of installed security products</li>
</ul>
<p>In some versions, it also steals credentials stored in the Google Chrome web browser and data stored in Microsoft Outlook.</p>
<p>The authors of Grandoreiro seem to be developing the banking trojan very rapidly, as we observe at least several new versions each month. We also suspect they are developing at least two variants simultaneously.</p>
<p>The authors seem to focus mainly on two areas. The first is hiding the actual C&amp;C address using the Domain Generation Algorithm (DGA) described in next section. The second is making the banking trojan modular. This is an interesting approach as the authors first introduced separate Delphi forms for each bank targeted (which is quite common), but lately even created separate DLLs for each targeted bank. We have not seen this approach in any other Latin American banking trojan we have analyzed.</p>
<h3>DGA</h3>
<p>Grandoreiro’s DGA uses two strings (<em>prefix</em> and <em>suffix</em>) hardcoded in the binary and the local date as inputs. Those values are processed by a simple algorithm yielding a result in the form <span style="font-family: courier new, courier, monospace;">https://sites.google[.]com/view/%DATA%</span>, where <span style="font-family: courier new, courier, monospace;">%DATA%</span> is the generated string (we provide pseudocode in Figure 2). The C&amp;C domain and port are used as the site title, as you can see in Figure 3. Note that based on the DGA, a different website is required for each day. We have observed some variants also using a custom base64 alphabet.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057a8d749fae605390654" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def dga(prefix, suffix):
	ts = get_current_time()
	mid_data = "%02d/%02d/%04d" % (ts.day, ts.month, ts.year)
	mid_data = b64encode(mid_data)
	mid_data = mid_data.replace("==", "")
	return "https://sites.google.com/view/" + prefix + mid_data + suffix</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057a8d749fae605390654-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a8d749fae605390654-2">2</div><div class="crayon-num" data-line="crayon-6057a8d749fae605390654-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a8d749fae605390654-4">4</div><div class="crayon-num" data-line="crayon-6057a8d749fae605390654-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a8d749fae605390654-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057a8d749fae605390654-1"><span class="crayon-e">def </span><span class="crayon-e">dga</span><span class="crayon-sy">(</span><span class="crayon-v">prefix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a8d749fae605390654-2"><span class="crayon-h">	</span><span class="crayon-v">ts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_current_time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057a8d749fae605390654-3"><span class="crayon-h">	</span><span class="crayon-v">mid_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"%02d/%02d/%04d"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ts</span><span class="crayon-sy">.</span><span class="crayon-v">day</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ts</span><span class="crayon-sy">.</span><span class="crayon-v">month</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ts</span><span class="crayon-sy">.</span><span class="crayon-v">year</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a8d749fae605390654-4"><span class="crayon-h">	</span><span class="crayon-v">mid_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">b64encode</span><span class="crayon-sy">(</span><span class="crayon-v">mid_data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057a8d749fae605390654-5"><span class="crayon-h">	</span><span class="crayon-v">mid_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mid_data</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">"=="</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a8d749fae605390654-6"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"https://sites.google.com/view/"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">mid_data</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><em>Figure 2. Pseudocode of Grandoreiro’s DGA</em></p>
<div id="attachment_137759" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-8.png"><img class="wp-image-137759" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-8-300x181.png" alt="" width="700" height="421" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-8-300x181.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-8-768x462.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-3-8.png 975w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 3. Example of a Google site set up by authors of Grandoreiro (translation: “Title of your page”)</i></p></div>
<h3>Configuration data</h3>
<p>In older versions of Grandoreiro, there was a small <span style="font-family: courier new, courier, monospace;">.ini</span> file distributed alongside the banking trojan that served as a primitive configuration file, containing only a version identifier and an index into a table in the binary that decided which C&amp;C server should be used.</p>
<p>Lately, the configuration mechanism has been changed and is now stored in the Windows Registry at <span style="font-family: courier new, courier, monospace;">HKCU\Software\</span> under keys with names like <span style="font-family: courier new, courier, monospace;">%USERNAME%</span> and <span style="font-family: courier new, courier, monospace;">ToolTech-RM</span>. Those names, as well as the names of values they contain, change frequently, but the information contained consists of:</p>
<ul>
<li>an identifier unique for each victim (generated via <span style="font-family: courier new, courier, monospace;">CoCreateGuid API</span>)</li>
<li>executable name and path</li>
<li>geolocation of the victim (retrieved via <a href="http://ipinfo.io/json" target="_blank" rel="noopener">http://ipinfo.io/json</a>)</li>
<li>strings necessary for creating and deleting the startup <span style="font-family: courier new, courier, monospace;">.LNK</span> file</li>
<li>notes specific to the victim device (the C&amp;C operator supplies these, if any, via a backdoor command)</li>
<li>flags to indicate an action has already been performed, such as
<ul>
<li>stealing Google Chrome stored credentials</li>
<li>stealing Outlook data</li>
</ul>
</li>
</ul>
<h2>C&amp;C communication</h2>
<p>Grandoreiro implements communication with its C&amp;C server using the <a href="https://rtc.teppi.net/" target="_blank" rel="noopener">RealThinClient</a> SDK. This component uses a protocol that operates over HTTP. After connecting to the server, Grandoreiro performs a handshake and then periodically checks for commands every few seconds. If the trojan misses a check, the server drops the connection.</p>
<p>As we described in our <a href="https://www.botconf.eu/wp-content/uploads/2019/12/B2019-Soucek-Hornak-DemystifyingBankingTrojansFromLatinAmerica.pdf" target="_blank" rel="noopener">Botconf presentation</a> in December 2019, and as reported recently by <a href="https://securitynews.sonicwall.com/xmlpost/google-sites-are-being-abused-by-grandoreiro-banking-trojan-to-host-its-cc-server-address/" target="_blank" rel="noopener">SonicWall</a>, there is a very interesting thing about the first “command” received from the C&amp;C server. It is always a list of all currently connected victims, including all the collected information about their machines, as you can see in Figure 4. Note that not all the victims are identified by a string with the same format. Due to Grandoreiro’s rapid development, this string changes quite often, but victims compromised with different variants still connect to the same C&amp;C server.</p>
<div id="attachment_137760" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-5.png"><img class="wp-image-137760" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-5.png" alt="" width="700" height="323" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-5.png 719w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-4-5-300x139.png 300w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 4. C&amp;C server responding to initial Grandoreiro connection with a list of currently connected victims.</i></p></div>
<h2>Distribution</h2>
<p>Spam seems to be the sole distribution method for Grandoreiro. The spam emails appear to contain a link pointing to a website offering fake Flash or Java updates (see Figure 5). Notice the red arrow in lower left corner tailored for the Google Chrome web browser, but displayed in other browsers too. We have seen Grandoreiro abusing the fear around COVID-19 as well (see Figure 6), as we already announced on our <a href="https://twitter.com/ESETresearch/status/1227955729191129100" target="_blank" rel="noopener">@ESETresearch Twitter account</a>.</p>
<div id="attachment_137761" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-3.png"><img class="wp-image-137761" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-3-300x100.png" alt="" width="700" height="233" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-3-300x100.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-3-768x255.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-3-1024x341.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-5-3.png 1431w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 5. Fake Flash (left) and Java (right) update websites (the left checkbox states that the user agrees with terms and conditions; the text on the right urges the user to install the latest version of Java to avoid issues with security and vulnerabilities)</i></p></div>
<div id="attachment_137762" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-2.png"><img class="wp-image-137762" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-2-300x176.png" alt="" width="700" height="410" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-2-300x176.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-2-768x450.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-6-2.png 922w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 6. Fake COVID-19 website. Clicking the video leads to the ZIP archive being downloaded (translation: &#8220;Construction of 2 hospitals in 7 days: accelerated video shows construction of hospital in China in 7 days&#8221;)</i></p></div>
<p>Unlike the majority of Latin American banking trojans, Grandoreiro utilizes quite small distribution chains. For different campaigns, it may choose a different type of downloader, as we illustrate in Figure 7. These downloaders are often stored on well-known public online sharing services such as GitHub, Dropbox, Pastebin, 4shared and 4Sync.</p>
<div id="attachment_137763" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-4.png"><img class="wp-image-137763" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-4-255x300.png" alt="" width="700" height="823" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-4-255x300.png 255w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-4-768x903.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-4-870x1024.png 870w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-7-4.png 1049w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 7. Possible ways that Grandoreiro distribution chains may appear (different colors show different paths the chain may take). The final ZIP archive may be encrypted and in some cases also protected by a password.</i></p></div>
<p>The final payload is a ZIP archive that is usually encrypted by the algorithm shown in Figure 8 and, in a significant number of cases, we saw it being password-protected as well.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057a8d749fb8744594129" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt_archive(data_enc, key):
	data_dec = list()
	for (i, c) in enumerate(data_enc):
		d = c ^ (~(key &gt;&gt; (i % 32))) &amp; 0xFF
		data_dec.append(d)
	return data_dec</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057a8d749fb8744594129-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a8d749fb8744594129-2">2</div><div class="crayon-num" data-line="crayon-6057a8d749fb8744594129-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a8d749fb8744594129-4">4</div><div class="crayon-num" data-line="crayon-6057a8d749fb8744594129-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057a8d749fb8744594129-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057a8d749fb8744594129-1"><span class="crayon-e">def </span><span class="crayon-e">decrypt_archive</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a8d749fb8744594129-2"><span class="crayon-h">	</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057a8d749fb8744594129-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a8d749fb8744594129-4"><span class="crayon-h">		</span><span class="crayon-v">d</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">~</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></div><div class="crayon-line" id="crayon-6057a8d749fb8744594129-5"><span class="crayon-h">		</span><span class="crayon-v">data_dec</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057a8d749fb8744594129-6"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">data_dec</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><em>Figure 8. Pseudocode of the archive decryption algorithm used by Grandoreiro</em></p>
<p>Distributing the final payload in a ZIP archive is very common among these banking trojans, but in the case of Grandoreiro, it holds extra importance, as you will see in the next section.</p>
<h2>Binary padding</h2>
<p>The vast majority of Grandoreiro samples utilize a very interesting application of the <a href="https://attack.mitre.org/techniques/T1009/" target="_blank" rel="noopener">binary padding</a> technique. This technique is all about making the binaries large and we have seen it being used even by <a href="https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/" target="_blank" rel="noopener">more sophisticated malware</a>. We have also observed some other Latin American banking trojans employing it occasionally, but only in the simplest form of appending a large amount of junk at the end of the binary.</p>
<p>Grandoreiro chooses a different approach – a simple, yet very effective one. The resources section of the PE file is augmented by (usually 3) <em>grande</em> BMP images, making each binary at least 300 MB in size. Notice in Figure 9 that the size of the whole EXE is 425 MB, yet the size of the code is only 4 MB and the size of the <span style="font-family: courier new, courier, monospace;">.rsrc</span> section 419 MB (98.5% of the total size). After examining the contents of the <span style="font-family: courier new, courier, monospace;">.rsrc</span> section, we see three images with sizes of 112 MB, 112 MB and 105 MB respectively (taking up 78.5% of the section size). We provide examples of such images in Figure 10.</p>
<div id="attachment_137764" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-9-3.png"><img class="wp-image-137764" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-9-3-300x98.png" alt="" width="700" height="228" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-9-3-300x98.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-9-3-768x250.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-9-3-1024x333.png 1024w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 9. Details of a Grandoreiro binary. Several Grandoreiro binaries are shown in the image on the left. The rest show details of one such binary.</i></p></div>
<div id="attachment_137766" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-10-1.png"><img class="wp-image-137766" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-10-1-300x117.png" alt="" width="700" height="272" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-10-1-300x117.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-10-1-768x298.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-10-1-1024x398.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-10-1.png 1431w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 10. BMP images used by Grandoreiro for binary padding. Their artistic “style” suggests the malware’s authors create them manually.</i></p></div>
<p>Because of the structure of those BMP files, compressing the binary into a ZIP archive yields a file of only a few MB, making it much easier to distribute the payload. The BMP files seem to change frequently, most likely to avoid detection. The images shown in Figure 10 come from three different builds of Grandoreiro. The visible similarities lead us to believe the authors update the images manually.</p>
<p>Let us look at the possible outcomes of this technique because, even though it is very simple, it is surprisingly effective. The upload file size limit on VirusTotal was changed to 550 MB during 2019, but <a href="https://blog.virustotal.com/2017/08/virustotal-gets-new-hairdo.html" target="_blank" rel="noopener">used to be 256 MB</a>, so a victim was unable to scan the file using that platform. Working with such a huge file is harder in general, making any automated or manual analyses much slower. At the same time, it is very hard to get rid of these large images while keeping a valid PE file, and by discarding the whole <span style="font-family: courier new, courier, monospace;">.rsrc</span> section, interesting information such as the fake pop‑up windows is lost.</p>
<h2>Self-protection &amp; anti-emulation</h2>
<p>For a Latin American banking trojan, Grandoreiro utilizes a surprisingly large number of tricks to evade detection and emulation. In this section, we talk about the most notable ones that appeared in several recent versions we have analyzed.</p>
<p>Diebold Warsaw GAS Tecnologia and Trusteer are known banking access protection software popular in Latin America. Every banking trojan described so far in our series has implemented some sort of check for these programs. Grandoreiro is no exception, by</p>
<ul>
<li>hooking the <span style="font-family: courier new, courier, monospace;">LdrLoadDll</span> and <span style="font-family: courier new, courier, monospace;">LoadLibrary(Ex)</span> APIs to prevent loading DLLs belonging to those products</li>
<li>checking if any of those modules are already loaded</li>
<li>trying to kill their running processes (based on process names)</li>
<li>blocking Diebold Warsaw on the firewall level</li>
<li>trying to break Trusteer by changing its file system path (see Figure 11)</li>
<li>changing ACLs on main Trusteer binary by running this command twice:
<ul>
<li><span style="font-family: courier new, courier, monospace;">cacls %PROGRAM_DATA%; Trusteer\Rapport\store\exts\RapportCerberus\baseline\RapportGH.dll&#8221; /T /E /C /P <em>user:perm</em></span></li>
<li>with <em>user:perm</em> set to Todos:N and then Everyone:N</li>
</ul>
</li>
</ul>
<div id="attachment_137769" style="width: 209px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-11-1.png"><img class="wp-image-137769" src="https://www.welivesecurity.com/wp-content/uploads/2020/04/Figure-11-1.png" alt="" width="199" height="80" /></a><p class="wp-caption-text"><i>Figure 11. Simple BAT script used by Grandoreiro to change Trusteer file path in hopes of making it unable to execute</i></p></div>
<p>Besides that, it also monitors hooks on important functions. If such a function starts with <span style="font-family: courier new, courier, monospace;">0xE9</span> (assembly opcode for the <span style="font-family: courier new, courier, monospace;">jmp</span> instruction), the trojan reloads the function from the corresponding library. Based on window and process names, it also checks for tools like RegMon, RegShot, Wireshark and Process Explorer. It tries to avoid being debugged by calling the <span style="font-family: courier new, courier, monospace;">IsDebuggerPresent</span> API and setting up a hook via <span style="font-family: courier new, courier, monospace;">SetWindowsHookEx</span> that returns <span style="font-family: courier new, courier, monospace;">ERROR_ACCESS_DENIED</span> on the <span style="font-family: courier new, courier, monospace;">WH_DEBUG</span> event.</p>
<p>Grandoreiro also employs a technique for privilege escalation described in more detail <a href="https://www.fortinet.com/blog/threat-research/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware.html" target="_blank" rel="noopener">here</a>. The method relies on registering a binary as the default handler for .MSC files and then running such a file. By doing so, the binary will be executed with elevated privileges. This technique no longer works on patched systems due to a <a href="https://www.winhelponline.com/blog/microsoft-fixes-eventvwr-exe-uac-bypass-exploit-windows-10-creators-update/" target="_blank" rel="noopener">fix released in 2017</a>.</p>
<p>Finally, Grandoreiro detects two virtual environments – VMWare via its special I/O port and Virtual PC via the <span style="font-family: courier new, courier, monospace;">vpcext</span> instruction. Both methods are described in detail <a href="https://shasaurabh.blogspot.com/2017/07/virtual-machine-detection-techniques.html" target="_blank" rel="noopener">here</a> (techniques 1 and 2).</p>
<h2>Spam tool</h2>
<p>During our investigation, we discovered a tool used for Grandoreiro’s spam campaigns. It is not a tool that automatically registers large numbers of email accounts, as in the case of <a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" target="_blank" rel="noopener">Amavaldo</a> and <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a>; it is actually used to create and send the spam messages. It does so by utilizing the <a href="https://www.emailarchitect.net/easendmail" target="_blank" rel="noopener">EASendMail</a> SDK.</p>
<p>Besides its main purpose, the tool sets up persistence using the Windows Registry Run key and disables UAC. The most probable scenario is that the attackers distribute this tool to some victims via Grandoreiro.</p>
<p>A small backdoor component is included and used to receive configuration files. Those files dictate what the emails will look like, what they will point to or where to send them. We provide a complete list of the configuration files and their purpose in Table 1.</p>
<p><em>Table 1. List of configuration files used by Grandoreiro&#8217;s spam tool</em></p>

<table id="tablepress-816" class="tablepress tablepress-id-816">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Filename</th><th class="column-2">Purpose</th><th class="column-3">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">ID.txt</td><td class="column-2">None</td><td class="column-3">Seems not to be used for the spam emails</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">html.txt</td><td class="column-2">Email body template</td><td class="column-3">Template for the email body (including placeholders - those are replaced by values from other config files)</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">assunto.txt</td><td class="column-2">Subject template (assunto = subject)</td><td class="column-3">Template for subject (similar to html.txt for email body)</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">nomes.txt</td><td class="column-2">List of fake names</td><td class="column-3">Replaces [NOME] placeholder in the templates</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">link.txt</td><td class="column-2">List of malicious URLs</td><td class="column-3">The email will link to one of these</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">lista.txt</td><td class="column-2">List of recipients</td><td class="column-3">The email will be sent to all of these</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">login.txt</td><td class="column-2">List of usernames</td><td rowspan="3" class="column-3">Information required to log into the email account that will be used to send the emails</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">senha.txt</td><td class="column-2">List of passwords</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">smtp.txt</td><td class="column-2">SMTP server address </td>
</tr>
</tbody>
</table>

<p>As you can see, the tool is not fully automated, but relies completely on the configuration data. This shows a lower level of sophistication. Its implementation shows similarities with the Grandoreiro banking trojan, which is why we believe it was written by the same authors.</p>
<h2>Conclusion</h2>
<p>In this installment of our series, we have focused on Grandoreiro, a Latin American banking trojan known to target Brazil, Mexico, Spain and Peru. We have mentioned aspects that are typical for that type of banking trojan, such as being written in Delphi, containing backdoor functionality, targeting Latin America and using fake pop-up windows to attack its victims.</p>
<p>A novel feature of Grandoreiro is its great effort to evade detection. That includes many techniques to detect or even disable banking protection software. It also utilizes a very specific application of the binary padding technique we have not seen before that makes it hard to get rid of the padding while keeping a valid file.</p>
<p>Spam appears to be the exclusive distribution method for Grandoreiro. The emails contain a link that points victims to fake websites set up by the operators. While they usually use simple mechanisms such as fake Flash or Java updates, we have seen them exploiting the current fear of COVID-19 as well.</p>
<p>Grandoreiro shows similarities with other banking trojans previously described in this series, mainly Casbaneiro, with which it shares the string decryption algorithm.</p>
<p><em>For any inquiries, contact us at threatintel@eset.com. Indicators of Compromise can also be found in </em><a href="https://github.com/eset/malware-ioc/tree/master/grandoreiro" target="_blank" rel="noopener"><em>our GitHub repository</em></a><em>.</em></p>
<h1>Indicators of Compromise (IoCs)</h1>
<h2>Hashes</h2>
<h3>Grandoreiro banking trojan</h3>

<table id="tablepress-817" class="tablepress tablepress-id-817">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET Detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">40FBC932BD45FEB3D2409B3A4C7029DDDE881389</td><td class="column-2">Older version of Grandoreiro (2017)</td><td class="column-3">Win32/Spy.Grandoreiro.A</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">7905DB9BBE2CB29519A5371B175551C6612255EF</td><td class="column-2">Grandoreiro</td><td class="column-3">Win32/Spy.Grandoreiro.AE</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">BD88A809B05168D6EFDBA4DC149653B0E1E1E448</td><td class="column-2">Grandoreiro</td><td class="column-3">Win32/Spy.Grandoreiro.AJ</td>
</tr>
</tbody>
</table>

<h3>Grandoreiro Win32 downloaders</h3>

<table id="tablepress-818" class="tablepress tablepress-id-818">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">7C2ED8B4AA65BEFCC229A36CE50539E9D6A70EE3</td><td class="column-2">Grandoreiro downloader</td><td class="column-3">Win32/TrojanDownloader.Banload.YJR</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">27A434D2EF4D1D021F283BCB93C6C7E50ACB8EA6</td><td class="column-2">Grandoreiro downloader</td><td class="column-3">Win32/TrojanDownloader.Banload.YLZ</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">28D58402393B6BCA73FF0EAC319226233181EDC9</td><td class="column-2">Grandoreiro downloader</td><td class="column-3">Win32/TrojanDownloader.Banload.YJB</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">42892DF64F00F4C091E1C02F74C2BB8BAD131FC5</td><td class="column-2">Grandoreiro downloader</td><td class="column-3">Win32/TrojanDownloader.Banload.YMI</td>
</tr>
</tbody>
</table>

<h3>Grandoreiro spam tool</h3>

<table id="tablepress-819" class="tablepress tablepress-id-819">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">BCED5D138ACEADA1EF11BFD22C2D6359CDA183DB</td><td class="column-2">Grandoreiro spam tool</td><td class="column-3">Win32/Spy.Grandoreiro.AD</td>
</tr>
</tbody>
</table>

<h2>Windows Registry</h2>
<ul>
<li><span style="font-family: courier new, courier, monospace;">HKCU\Software\%USER_NAME%</span></li>
<li><span style="font-family: courier new, courier, monospace;">HKCU\Software\ToolTech-RM</span></li>
</ul>
<h2>User-Agent</h2>
<ul>
<li>h55u4u4u5uii5</li>
</ul>
<h2>Filenames</h2>
<ul>
<li>%INSTALL_DIR%\ *
<ul>
<li>MDL_YEL_01.dll</li>
<li>MDL_BLU_BR_02.dll</li>
<li>MDL_SIC_BR_03.dll</li>
<li>MDL_SANT_BR_04.dll</li>
<li>MDL_ITA_BR_05.dll</li>
<li>MDL_BRADA_BR_06.dll</li>
<li>MDL_SICCB_BR_07.dll</li>
<li>MDL_SAFRA_BR_08.dll</li>
<li>MDL_ORIGI_BR_09.dll</li>
<li>MDL_NORDES_BR_10.dll</li>
<li>MDL_BANEST_BR_11.dll</li>
<li>MDL_BANEZE_BR_12.dll</li>
<li>MDL_AMAZON_BR_13.dll</li>
<li>MDL_UNICRE_BR_14.dll</li>
<li>MDL_BRB_BR_15.dll</li>
<li>MDL_WUPDATE_BR_001.dll</li>
</ul>
</li>
</ul>
<p><sup>*</sup><small> %INSTALL_DIR% is the path where Grandoreiro is installed</small></p>
<h1>MITRE ATT&amp;CK techniques</h1>

<table id="tablepress-820" class="tablepress tablepress-id-820">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1192/" rel="noopener" target="_blank">T1192</a></td><td class="column-3">Spearphishing Link</td><td class="column-4">Grandoreiro distribution chains start with an email link pointing to a fake website.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Execution through API</td><td class="column-4">Grandoreiro is executed either by <span style="font-family: courier new, courier, monospace;">WinExec </span>or  <span style="font-family: courier new, courier, monospace;">WScript.Shell.Exec</span> API.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Grandoreiro ensures persistence by creating a  <span style="font-family: courier new, courier, monospace;">.LNK</span> file in the startup folder.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1088/" rel="noopener" target="_blank">T1088</a></td><td class="column-3">Bypass User Account Control</td><td class="column-4">Grandoreiro bypasses UAC by registering as the default handler for <span style="font-family: courier new, courier, monospace;">.MSC</span> files.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="8" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1009/" rel="noopener" target="_blank">T1009</a></td><td class="column-3">Binary Padding</td><td class="column-4">Grandoreiro inserts large BMP files into its <span style="font-family: courier new, courier, monospace;"> .rsrc</span> section to make the binaries much larger.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1089/" rel="noopener" target="_blank">T1089</a></td><td class="column-3">Disabling Security Tools</td><td class="column-4">Grandoreiro tries to disable Diebold Warsaw and Trusteer banking protection software.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Grandoreiro is distributed in a ZIP archive that usually needs to be decrypted.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1222/" rel="noopener" target="_blank">T1222</a></td><td class="column-3">File and Directory Permissions Modification</td><td class="column-4">Grandoreiro changes the ACL for Trusteer to disable it.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">Downloaders that distribute Grandoreiro masquerade as fake update installation files.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">Grandoreiro stores its configuration in the Windows Registry.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">Grandoreiro implements some of its distribution chain stages in VBScript.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td><td class="column-3">Virtualization/Sandbox Evasion</td><td class="column-4">Grandoreiro detects VMWare and Virtual PC.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="2" class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1503/" rel="noopener" target="_blank">T1503</a></td><td class="column-3">Credentials from Web Browsers</td><td class="column-4">Grandoreiro steals credentials from the Google Chrome browser.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1081/" rel="noopener" target="_blank">T1081</a></td><td class="column-3">Credentials in Files</td><td class="column-4">Grandoreiro parses Outlook <span style="font-family: courier new, courier, monospace;"> .pst</span> files to extract email addresses.</td>
</tr>
<tr class="row-16 even">
	<td rowspan="5" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1010/" rel="noopener" target="_blank">T1010</a></td><td class="column-3">Application Window Discovery</td><td class="column-4">Grandoreiro discovers various security tools based on window names.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Grandoreiro discovers protection software based on file system paths.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">Grandoreiro discovers security tools based on process names.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1063/" rel="noopener" target="_blank">T1063</a></td><td class="column-3">Security Software Discovery</td><td class="column-4">Grandoreiro detects the presence of banking protection products. </td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Grandoreiro collects information about the victim's machine, such as <span style="font-family: courier new, courier, monospace;">%USERNAME%</span>, <span style="font-family: courier new, courier, monospace;">%COMPUTERNAME%</span>, and product names.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">Grandoreiro is capable of capturing keystrokes.</td>
</tr>
<tr class="row-22 even">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1483/" rel="noopener" target="_blank">T1483</a></td><td class="column-3">Domain Generation Algorithms</td><td class="column-4">Grandoreiro generates its C&amp;C address using a DGA.</td>
</tr>
<tr class="row-23 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">Grandoreiro’s network protocol is implemented by RealThinClient, which is built over HTTP.</td>
</tr>
<tr class="row-24 even">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Grandoreiro sends the data it retrieves to its C&amp;C server.</td>
</tr>
</tbody>
</table>

<h2>Further reading<a id="further-reading"></a></h2>

<table id="tablepress-821" class="tablepress tablepress-id-821">
<thead>
<tr class="row-1 odd">
	<th class="column-1">The other parts of the series</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" rel="noopener" target="_blank">From Carnaval to Cinco de Mayo – The journey of Amavaldo</a></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" rel="noopener" target="_blank">Casbaneiro: Dangerous cooking with a secret ingredient</a></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><a href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/" rel="noopener" target="_blank">Mispadu: Advertisement for a discounted Unhappy Meal</a></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><a href="https://www.welivesecurity.com/2020/03/05/guildma-devil-drives-electric/" rel="noopener" target="_blank">Guildma: The Devil drives electric</a></td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-04-28 11:30:06">28 Apr 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Grandoreiro: How engorged can an EXE get?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Grandoreiro: How engorged can an EXE get?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Grandoreiro: How engorged can an EXE get?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Grandoreiro: How engorged can an EXE get?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F28%2Fgrandoreiro-how-engorged-can-exe-get%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F28%2Fgrandoreiro-how-engorged-can-exe-get%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F04%2F28%2Fgrandoreiro-how-engorged-can-exe-get%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"137481 https:\/\/backend.welivesecurity.com\/?p=137481","disqusShortname":"welivesecurity","disqusTitle":"Grandoreiro: How engorged can an EXE get?","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/04\/28\/grandoreiro-how-engorged-can-exe-get\/","postId":"137481"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-820').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>