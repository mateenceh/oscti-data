<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Lukas Stefanko',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Insidious Android malware gives up all malicious features but one to gain stealth | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have analyzed an extremely dangerous Android app that can wipe out the victim’s bank account or cryptocurrency wallet and take over their email or social media accounts. Called &quot;DEFENSOR ID&quot;, the banking trojan requires a single action from the victim – enable Android&#039;s Accessibility Service – to fully unleash its malicious functionality."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/05/22/insidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Insidious Android malware gives up all malicious features but one to gain stealth | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have analyzed an extremely dangerous Android app that can wipe out the victim’s bank account or cryptocurrency wallet and take over their email or social media accounts. Called &quot;DEFENSOR ID&quot;, the banking trojan requires a single action from the victim – enable Android&#039;s Accessibility Service – to fully unleash its malicious functionality." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/05/22/insidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:author" content="https://www.facebook.com/lukas.stefanko" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-05-22T13:00:42+00:00" />
<meta property="article:modified_time" content="2020-05-23T21:05:31+00:00" />
<meta property="og:updated_time" content="2020-05-23T21:05:31+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/05/Insidious-Android-malware-gives-up-all-malicious-features-but-one-to-gain-stealth-2-e1590145711786.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/05/Insidious-Android-malware-gives-up-all-malicious-features-but-one-to-gain-stealth-2-e1590145711786.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="425" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have analyzed an extremely dangerous Android app that can wipe out the victim’s bank account or cryptocurrency wallet and take over their email or social media accounts. Called &quot;DEFENSOR ID&quot;, the banking trojan requires a single action from the victim – enable Android&#039;s Accessibility Service – to fully unleash its malicious functionality." />
<meta name="twitter:title" content="Insidious Android malware gives up all malicious features but one to gain stealth | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/05/Insidious-Android-malware-gives-up-all-malicious-features-but-one-to-gain-stealth-2-e1590145711786.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/2020/05/22/insidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/05/28/android-malware-nutzt-bedienungshilfen/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/05/28/android-malware-nutzt-bedienungshilfen/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/05/28/android-malware-nutzt-bedienungshilfen/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/05/Insidious-Android-malware-gives-up-all-malicious-features-but-one-gain-stealth-1.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Insidious Android malware gives up all malicious features but one to gain stealth</h1>
<div class="excerpt">ESET researchers detect a new way of misusing Accessibility Service, the Achilles’ heel of Android security</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/lstefanko/" title="Lukas Stefanko">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2016/02/LukasStefanko_BW-222x179.jpg" alt="Lukas Stefanko">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/lstefanko/" title="Lukas Stefanko">
                    Lukas Stefanko                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-05-22 15:00:42">22 May 2020 - 03:00PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F05%2F22%2Finsidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F05%2F22%2Finsidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth%2F&text=Insidious Android malware gives up all malicious features but one to gain stealth%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F05%2F22%2Finsidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers detect a new way of misusing Accessibility Service, the Achilles’ heel of Android security</p>
                            </div>

                            <p>ESET researchers have analyzed an extremely dangerous Android app that can perform a host of nefarious actions, notably wiping out the victim’s bank account or cryptocurrency wallet and taking over their email or social media accounts. Called &#8220;DEFENSOR ID&#8221;, the banking trojan was available on Google Play at the time of the analysis. The app is fitted with standard information-stealing capabilities; however, this banker is exceptionally insidious in that after installation it requires a single action from the victim – enable Android&#8217;s Accessibility Service – to fully unleash the app&#8217;s malicious functionality.</p>
<p>The DEFENSOR ID app made it onto the heavily guarded Google Play store thanks to its extreme stealth. Its creators reduced the app’s malicious surface to the bare minimum by removing all potentially malicious functionalities but one: abusing Accessibility Service.</p>
<p>Accessibility Service is long known to be the Achilles’ heel of the Android operating system. Security solutions can detect it in countless combinations with other suspicious permissions and functions, or malicious functionalities – but when faced with no additional functionality nor permission, all failed to trigger any alarm on DEFENSOR ID.</p>
<p>By “all” we mean all security mechanisms guarding the official Android app store (including the detection engines of the members of the App Defense Alliance) and all security vendors participating in the VirusTotal program (see Figure 1).</p>
<div id="attachment_138882" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-1-6.png"><img class="wp-image-138882" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-1-6-150x150.png" alt="" width="750" height="567" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-1-6-300x227.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-1-6-768x580.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-1-6-1024x774.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-1-6.png 1276w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 1. According to the VirusTotal service, no security vendor detected the DEFENSOR ID app until it was pulled off the Play store</i></p></div>
<p>DEFENSOR ID was released on Feb 3, 2020 and last updated to v1.4 on May 6, 2020. The latest version is analyzed here; we weren’t able to determine if the earlier versions were also malicious. According to its profile at Google Play (see Figure 2) the app reached a mere 10+ downloads. We reported it to Google on May 16, 2020 and since May 19, 2020 the app has no longer been available on Google Play.</p>
<p>The developer name used, GAS Brazil, suggests the criminals behind the app targeted Brazilian users. Apart from including the country’s name, the app’s name is probably intended to imply a relationship with the antifraud solution named GAS Tecnologia. That security software is commonly installed on computers in Brazil as several banks require it to log into their online banking. However, there is also an English version of the DEFENSOR ID app (see Figure 3) besides the Portuguese one, and that app has neither geographical nor language restrictions.</p>
<p>Playing further off the suggested GAS Tecnologia link, the app promises better security for its users. The description in Portuguese promises more protection for the user’s applications, including end-to-end encryption. Deceptively, the app was listed in the Education section.</p>
<div id="attachment_138883" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-2-merged.png"><img class="wp-image-138883" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-2-merged-150x150.png" alt="" width="750" height="520" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-2-merged-300x208.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-2-merged-768x532.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-2-merged-1024x709.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-2-merged-623x432.png 623w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-2-merged.png 1094w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 2. The DEFENSOR ID app on Google Play – Portuguese version (translates roughly as: “Your new Defensor app available for: / Individuals / Legal entities / From now on you will have more protection when using your applications, encryption for end-to-end users”)</i></p></div>
<div id="attachment_138884" style="width: 410px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-3-2.png"><img class="wp-image-138884" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-3-2-150x150.png" alt="" width="400" height="701" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-3-2-171x300.png 171w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-3-2-768x1347.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-3-2-584x1024.png 584w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-3-2.png 1095w" sizes="(max-width: 400px) 100vw, 400px" /></a><p class="wp-caption-text"><i>Figure 3. The DEFENSOR ID app on Google Play – English version</i></p></div>
<h2>Functionality</h2>
<p>After starting, DEFENSOR ID requests the following permissions:</p>
<ul>
<li>allow modify system settings</li>
<li>permit drawing over other apps, and</li>
<li>activate accessibility services.</li>
</ul>
<p>If an unsuspecting user grants these permissions (see Figure 4), the trojan can read any text displayed in any app the user may launch – and send it to the attackers. This means the attackers can steal the victim’s credentials for logging into apps, SMS and email messages, displayed cryptocurrency private keys, and even software-generated 2FA codes.</p>
<p>The fact the trojan can steal both the victim’s credentials and also can control their SMS messages and generated 2FA codes means DEFENSOR ID’s operators can bypass two-factor authentication. This opens the door to, for example, fully controlling the victim’s bank account.</p>
<p>To make sure the trojan survives a device restart, it abuses already activated accessibility services that will launch the trojan right after start.</p>
<p><center><br />
<a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged.png"><img class="wp-image-138885" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged-150x150.png" alt="" width="750" height="663" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged-300x265.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged-768x679.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged-1024x906.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged-87x77.png 87w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged-85x75.png 85w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-4-merged.png 1383w" sizes="(max-width: 750px) 100vw, 750px" /></a></center>&nbsp;</p>
<div id="attachment_138886" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged.png"><img class="wp-image-138886" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged-150x150.png" alt="" width="750" height="663" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged-300x265.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged-768x679.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged-1024x905.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged-87x77.png 87w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged-85x75.png 85w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-5-merged.png 1383w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 4. The permission requests by DEFENSOR ID<br /></i></p></div>
<p>Our analysis shows the DEFENSOR ID trojan can execute 17 commands received from the attacker-controlled server such as uninstalling an app, launching an app and then performing any click/tap action controlled remotely by the attacker (see Figure 5).</p>
<div id="attachment_138887" style="width: 565px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-6-3.png"><img class="wp-image-138887 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-6-3.png" alt="" width="555" height="268" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-6-3.png 555w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-6-3-300x145.png 300w" sizes="(max-width: 555px) 100vw, 555px" /></a><p class="wp-caption-text"><i>Figure 5. The list of commands DEFENSOR ID may get from its C&amp;C server</i></p></div>
<p>In 2018, we saw <a href="https://www.welivesecurity.com/2018/12/11/android-trojan-steals-money-paypal-accounts-2fa/" target="_blank" rel="noopener">similar behavior</a>, but all the click actions were hardcoded and suited only for the app of the attacker’s choice. In this case, the attacker can get the list of all installed apps and then remotely launch the victim’s app of their choice to either steal credentials or perform malicious actions (e.g. send funds via a wire transfer).</p>
<p>We believe that this is the reason the DEFENSOR ID trojan requests the user to allow “Modify system settings”. Subsequently, the malware will change the <a href="https://developer.android.com/reference/android/provider/Settings.System#SCREEN_OFF_TIMEOUT" target="_blank" rel="noopener">screen off time-out</a> to 10 minutes. This means that, unless victims lock their devices via the hardware button, the timer provides plenty of time for the malware to remotely perform malicious, in-app operations.</p>
<p>If the device gets locked, the malware can’t unlock it.</p>
<h2>Malware data leak</h2>
<p>When we analyzed the sample, we realized that the malware operators left the remote database with some of the victims’ data freely accessible, without any authentication. The database contained the last activity performed on around 60 compromised devices. We found no other information stolen from the victims to be accessible.</p>
<p>Thanks to this data leak, we were able to confirm that the malware really worked as designed: the attacker had access to the victims’ entered credentials, displayed or written emails and messages, etc.</p>
<p>Once we reached the non-secured database, we were able to directly observe the app’s malicious behavior. To illustrate the level of threat the DEFENSOR ID app posed, we performed three tests.</p>
<p>First, we launched a banking app and entered the credentials there. The credentials were immediately available in the leaky database – see Figure 6.</p>
<div id="attachment_138888" style="width: 1034px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-7-merged.png"><img class="wp-image-138888 size-large" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-7-merged-1024x412.png" alt="" width="1024" height="412" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-7-merged-1024x412.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-7-merged-300x121.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-7-merged-768x309.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-7-merged-340x137.png 340w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 6. The banking app test: the credentials as entered (left) and as available in the database (right)</i></p></div>
<p>Second, we wrote a test message in an email client. We saw the message uploaded to the attackers’ server within a second – see Figure 7.</p>
<div id="attachment_138903" style="width: 1034px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-8-merged-1.png"><img class="wp-image-138903 size-large" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-8-merged-1-1024x313.png" alt="" width="1024" height="313" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-8-merged-1-1024x313.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-8-merged-1-300x92.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-8-merged-1-768x235.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-8-merged-1-522x160.png 522w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 7. The email message test: the message as written (left) and as available in the database (right)</i></p></div>
<p>Third, we documented the trojan retrieving the Google Authenticator 2FA code.</p>
<div id="attachment_138904" style="width: 1034px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-9-merged.png"><img class="wp-image-138904 size-large" src="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-9-merged-1024x220.png" alt="" width="1024" height="220" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-9-merged-1024x220.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-9-merged-300x64.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/05/Figure-9-merged-768x165.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 8. The software generated 2FA code as it appeared on the device’s display (left) and as available in the database (right) </i></p></div>
<p>Along with the malicious DEFENSOR ID app, another malicious app named Defensor Digital was discovered. Both apps shared the same C&amp;C server, but we couldn’t investigate the latter as it had already been removed from the Google Play store.</p>
<h2>Indicators of Compromise (IoCs)</h2>

<table id="tablepress-841" class="tablepress tablepress-id-841">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Package Name</th><th class="column-2">Hash</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">com.secure.protect.world</td><td class="column-2">F17AEBC741957AA21CFE7C7D7BAEC0900E863F61</td><td class="column-3">Android/Spy.BanBra.A</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">com.brazil.android.free</td><td class="column-2">EA069A5C96DC1DB0715923EB68192FD325F3D3CE</td><td class="column-3">Android/Spy.BanBra.A</td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-842" class="tablepress tablepress-id-842">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic </th><th class="column-2">ID </th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="2" class="column-1">Initial Access   </td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1475/" rel="noopener" target="_blank">T1475</a></td><td class="column-3">Deliver Malicious App via Authorized App Store</td><td class="column-4">Impersonates security app on Google Play.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1444/" rel="noopener" target="_blank">T1444</a></td><td class="column-3">Masquerade as Legitimate Application</td><td class="column-4">Impersonates legitimate GAS Tecnologia application.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1418/" rel="noopener" target="_blank">T1418</a></td><td class="column-3">Application Discovery</td><td class="column-4">Sends list of installed apps on device.  </td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Impact  </td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1516/" rel="noopener" target="_blank">T1516</a></td><td class="column-3">Input Injection</td><td class="column-4">Can enter text and perform clicks on behalf of user.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1417/" rel="noopener" target="_blank">T1417</a></td><td class="column-3">Input Capture</td><td class="column-4">Records user input data.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1437/" rel="noopener" target="_blank">T1437</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">Uses Firebase Cloud Messaging for C&amp;C.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/lstefanko/" title="Lukas Stefanko">
                    Lukas Stefanko                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-05-22 15:00:42">22 May 2020 - 03:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Insidious Android malware gives up all malicious features but one to gain stealth">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Insidious Android malware gives up all malicious features but one to gain stealth">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Insidious Android malware gives up all malicious features but one to gain stealth">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Insidious Android malware gives up all malicious features but one to gain stealth">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F05%2F22%2Finsidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F05%2F22%2Finsidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F05%2F22%2Finsidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"138868 https:\/\/backend.welivesecurity.com\/?p=138868","disqusShortname":"welivesecurity","disqusTitle":"Insidious Android malware gives up all malicious features but one to gain stealth","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/05\/22\/insidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth\/","postId":"138868"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>