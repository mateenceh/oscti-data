<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Matías Porolli',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>More evil: A deep look at Evilnum and its toolset | WeLiveSecurity</title>
<meta name="description" content="ESET research gives a detailed picture of the operations of Evilnum and its toolkit used in attacks against carefully chosen targets in the fintech sector."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="More evil: A deep look at Evilnum and its toolset | WeLiveSecurity" />
<meta property="og:description" content="ESET research gives a detailed picture of the operations of Evilnum and its toolkit used in attacks against carefully chosen targets in the fintech sector." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-07-09T09:30:00+00:00" />
<meta property="article:modified_time" content="2020-07-09T10:21:06+00:00" />
<meta property="og:updated_time" content="2020-07-09T10:21:06+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/07/Evilnum-malware-APT-group-analysis.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/07/Evilnum-malware-APT-group-analysis.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET research gives a detailed picture of the operations of Evilnum and its toolkit used in attacks against carefully chosen targets in the fintech sector." />
<meta name="twitter:title" content="More evil: A deep look at Evilnum and its toolset | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/07/Evilnum-malware-APT-group-analysis.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/07/13/evilnum-analisis-herramientas-utiliza-grupo-cibercriminales-apunta-fintech/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/07/08/fintechs-im-visier-analyse-der-evilnum-malware/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/07/13/evilnum-analisis-herramientas-utiliza-grupo-cibercriminales-apunta-fintech/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/07/08/fintechs-im-visier-analyse-der-evilnum-malware/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/07/13/evilnum-analisis-herramientas-utiliza-grupo-cibercriminales-apunta-fintech/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/07/08/fintechs-im-visier-analyse-der-evilnum-malware/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/07/Evilnum-APT-malware-analysis.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>More evil: A deep look at Evilnum and its toolset</h1>
<div class="excerpt">ESET research gives a detailed picture of the operations of the Evilnum group and its toolkit deployed in attacks against carefully chosen targets in the fintech sector</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2015/01/matias_porolli_eset-222x179.jpg" alt="Matías Porolli">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                    Matías Porolli                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-07-09 11:30:00">9 Jul 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F09%2Fmore-evil-deep-look-evilnum-toolset%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F09%2Fmore-evil-deep-look-evilnum-toolset%2F&text=More evil: A deep look at Evilnum and its toolset%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F09%2Fmore-evil-deep-look-evilnum-toolset%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET research gives a detailed picture of the operations of the Evilnum group and its toolkit deployed in attacks against carefully chosen targets in the fintech sector</p>
                            </div>

                            <p>ESET has analyzed the operations of Evilnum, the APT group behind the Evilnum malware previously seen in attacks against financial technology companies. While said malware has been seen in the wild since at least 2018 and documented previously, little has been published about the group behind it and how it operates.</p>
<p>In this article we connect the dots and disclose a detailed picture of Evilnum’s activities. The group&#8217;s targets remain fintech companies, but its toolset and infrastructure have evolved and now consist of a mix of custom, homemade malware combined with tools purchased from Golden Chickens, a Malware-as-a-Service (MaaS) provider whose infamous customers include FIN6 and Cobalt Group.</p>
<h2>Targets</h2>
<p>According to ESET’s telemetry, the targets are financial technology companies – for example, companies that offer platforms and tools for online trading. Although most of the targets are located in EU countries and the UK, we have also seen attacks in countries such as Australia and Canada. Typically, the targeted companies have offices in several locations, which probably explains the geographical diversity of the attacks.</p>
<p>The main goal of the Evilnum group is to spy on its targets and obtain financial information from both the targeted companies and their customers. Some examples of the information this group steals include:</p>
<ul>
<li>Spreadsheets and documents with customer lists, investments and trading operations</li>
<li>Internal presentations</li>
<li>Software licenses and credentials for trading software/platforms</li>
<li>Cookies and session information from browsers</li>
<li>Email credentials</li>
<li>Customer credit card information and proof of address/identity documents</li>
</ul>
<p>According to what we have seen during our investigation, the group has also gained access to IT-related information such as VPN configurations.</p>
<h2>Overview of the attack</h2>
<p>Targets are approached with spearphishing emails that contain a link to a ZIP file hosted on Google Drive. That archive contains several LNK (aka shortcut) files that extract and execute a malicious JavaScript component, while displaying a decoy document. These shortcut files have “double extensions” to try to trick the user into opening them, thinking they are benign documents or pictures (in Windows, file extensions for known file types are hidden by default). The contents of one of the ZIP files are shown in Figure 1.</p>
<div id="attachment_140498" style="width: 645px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/01_file_extension.png"><img class="wp-image-140498 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/01_file_extension.png" alt="" width="635" height="385" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/01_file_extension.png 635w, https://www.welivesecurity.com/wp-content/uploads/2020/07/01_file_extension-300x182.png 300w" sizes="(max-width: 635px) 100vw, 635px" /></a><p class="wp-caption-text"><i>Figure 1. Malicious LNK files</i></p></div>
<p>Once a shortcut file is opened (it doesn’t matter which one, as they all do the same thing), it looks in the contents of its own file for lines with a specific marker and writes them to a <span style="font-family: courier new, courier, monospace;">.js</span> file. Then this malicious JavaScript file is executed and it writes and opens a decoy file with the same name as the shortcut, but with the correct extension. It also deletes the shortcut file. The documents used as decoys are mostly photos of credit cards, identity documents, or bills with proof of address, as many financial institutions require these documents from their customers when they join, according to regulations (this is known as “Know Your Customer”). One such decoy is shown in Figure 2 (blurred for privacy).</p>
<div id="attachment_140499" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/02_decoy_photo.jpg"><img class="wp-image-140499" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/02_decoy_photo-150x150.jpg" alt="" width="700" height="394" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/02_decoy_photo-300x169.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/02_decoy_photo-768x432.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/02_decoy_photo-1024x577.jpg 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/07/02_decoy_photo-143x79.jpg 143w, https://www.welivesecurity.com/wp-content/uploads/2020/07/02_decoy_photo.jpg 1062w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 2. Photo of the back of an ID card, used as a decoy</i></p></div>
<p>These decoy documents seem genuine, and we assume that they have been collected by this group during years of operation. Documents are collected actively in the group’s current operations, as it targets technical support representatives and account managers, who regularly receive these kinds of documents from their customers. The group reuses the documents on different targets, unless the targets are from different regions.</p>
<p>The JavaScript component is the first stage of the attack and can deploy other malware such as a C# spy component, <a href="https://quointelligence.eu/2020/01/the-chicken-keeps-laying-new-eggs-uncovering-new-gc-maas-tools-used-by-top-tier-threat-actors/" target="_blank" rel="noopener">Golden Chickens</a> components or several Python-based tools. The name Evilnum was given to the C# component by other researchers in the past, but the JS component also has been referred to as Evilnum. We have named the group Evilnum as that is the name of their flagship malware, and we’ll refer to the various malware pieces as components. An overview of these is shown in Figure 3.</p>
<div id="attachment_140500" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/03_attack_overview.jpg"><img class="wp-image-140500" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/03_attack_overview-150x150.jpg" alt="" width="700" height="589" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/03_attack_overview-300x252.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/03_attack_overview-768x646.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/03_attack_overview-1024x862.jpg 1024w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 3. Evilnum components</i></p></div>
<p>Each of the various components has its own C&amp;C server, and each component operates independently. The operators of the malware manually send commands to install additional components and use post-compromise scripts and tools if they consider them necessary.</p>
<p>Most servers used by the malware are referenced by IP addresses; domain names have not been used. The only exceptions are the C&amp;C servers used by the Golden Chickens components; malware purchased from a MaaS provider, as we describe later.</p>
<p>Those referenced by an IP address can be split into two groups, based on the hosting provider. The majority of them are hosted with FreeHost, a Ukrainian provider. The rest are hosted in the Netherlands, with Dotsi.</p>
<h2>JS Component: First compromise</h2>
<p>This component communicates with a C&amp;C server and acts as a backdoor without the need for any additional program. However, in most attacks that we have seen, the attackers deployed additional components as they saw fit and used the JS malware only as a first stage.</p>
<p>The first known mention of this JavaScript malware was in May 2018 in <a href="http://www.pwncode.io/2018/05/javascript-based-bot-using-github-c.html" target="_blank" rel="noopener">this pwncode article</a>. The malware has changed since then and we illustrate these changes in Figure 4.</p>
<div id="attachment_140501" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/04_js_timeline.jpg"><img class="wp-image-140501" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/04_js_timeline-150x150.jpg" alt="" width="700" height="519" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/04_js_timeline-300x222.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/04_js_timeline-768x570.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/04_js_timeline-1024x759.jpg 1024w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 4. Timeline of changes in JS component</i></p></div>
<p>Differences between version 1.3 and the others are noteworthy, as the server-side code for the C&amp;C was changed and commands are different. In that early version it was not possible to upload files to the C&amp;C, only to download files to the victim’s computer. Also, as new versions appeared, the malware was extended with some Python scripts (see the <em>Post-compromise toolset </em>section) and external tools such as <a href="https://www.nirsoft.net/utils/chrome_cookies_view.html" target="_blank" rel="noopener">ChromeCookiesView</a>.</p>
<p>Despite the differences, the core functionalities remain the same in all versions, including the retrieval of the C&amp;C server’s address from GitHub, GitLab or Reddit pages created specifically for that purpose. Figure 5 shows an example of a Reddit page that is parsed by the malware to retrieve a C&amp;C address.</p>
<div id="attachment_140502" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/05_reddit_page.png"><img class="wp-image-140502" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/05_reddit_page-150x150.png" alt="" width="700" height="305" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/05_reddit_page-300x131.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/05_reddit_page-768x334.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/05_reddit_page-1024x446.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/07/05_reddit_page.png 1217w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 5. Reddit page with the C&amp;C server for the JS component</i></p></div>
<p>This component achieves persistence through the Run registry key and has full backdoor capabilities: it can download and execute binaries, run arbitrary commands or upload files from the victim computer to the C&amp;C server. We will not go into details about the technical aspects of this component, as a good analysis of the latest version was <a href="https://blog.prevailion.com/2020/05/phantom-in-command-shell5.html" target="_blank" rel="noopener">published recently by Prevailion</a>.</p>
<h2>C# Component: Evil, not so evil</h2>
<p>In March 2019, <a href="https://unit42.paloaltonetworks.com/cardinal-rat-sins-again-targets-israeli-fin-tech-firms/" target="_blank" rel="noopener">Palo Alto Networks described malware</a> with very similar functionality to the JS component, but coded in C#. That version (2.5) obtained the address of its C&amp;C by dividing a number by 666, and was therefore named Evilnum by Palo Alto Networks researchers. Since then there have been new versions of the C# malware, the latest of them being version 4.0, which we first saw in April 2020. The number 666 is not used anymore and the PDB paths of the executables show that the developers call their malware “Marvel”. However, we will continue to name the malware Evilnum to avoid creating confusion.</p>
<p>The latest version comes bundled in an MSI file (Windows Installer) and runs independent of the JS component. Furthermore, it has different C&amp;Cs than the JS component. However, in all cases that we have seen, the C# component was downloaded and executed after the JavaScript malware gained initial access. The structure of this component is shown in Figure 6.</p>
<p>&nbsp;</p>
<div id="attachment_140503" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/06_c_sharp_components.jpg"><img class="wp-image-140503" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/06_c_sharp_components-150x150.jpg" alt="" width="700" height="435" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/06_c_sharp_components-300x187.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/06_c_sharp_components-768x478.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/06_c_sharp_components-1024x637.jpg 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/07/06_c_sharp_components-275x172.jpg 275w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 6. Parts of the C# component</i></p></div>
<p>When the MSI file is executed, three malicious components, along with some .NET Framework library files, are written to disk in <span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Microsoft\Mediia</span>. The file copier is the first to be executed and its only purpose is to move the files to another location in <span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%</span> (see the <em>Indicators of Compromise</em> section for the folder names). The loader is then executed and it loads and decrypts the contents of the file <span style="font-family: courier new, courier, monospace;">System.Memmory.dll</span>, which is the actual malicious payload (DLL Agent) for the C# component. AES encryption is used for the DLL and for obfuscation of the strings in the payload. The same key and initialization vector are used to encrypt the strings in all of the different versions.</p>
<p>The IP address of the C&amp;C server is hardcoded and in plain text. A GET request is sent for <span style="font-family: courier new, courier, monospace;">/Validate/valsrv</span> and if the response body contains the text <span style="font-family: courier new, courier, monospace;">youwillnotfindthisanywhare</span>, then the server is accepted. Otherwise, a GitLab page is parsed to get the IP address of a second server.</p>
<p>The following capabilities are present in version 4.0:</p>
<ul>
<li>Take screenshots if the mouse has been moved in a period of time, and send them to the C&amp;C, base64 encoded. The image is stored in a file called <span style="font-family: courier new, courier, monospace;">SC4.P7D</span></li>
<li>Run commands</li>
<li>Run other binaries via <span style="font-family: courier new, courier, monospace;">cmd.exe</span></li>
<li>Send information such as computer name, username and antivirus installed</li>
<li>Persist in a compromised system by creating registry keys</li>
</ul>
<h3>Commands</h3>
<p>The commands that can be sent to the malware are:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">killme</span>: stops the malware and removes persistence</li>
<li><span style="font-family: courier new, courier, monospace;">mouse</span>: moves the mouse. With this action a screenshot will be taken</li>
<li><span style="font-family: courier new, courier, monospace;">cookies</span>: sends Chrome cookies to the C&amp;C</li>
<li><span style="font-family: courier new, courier, monospace;">passwords</span>: sends Chrome saved passwords. We believe they focus on Chrome not based on market share (after all, these are targeted attacks), but because of the ease of processing cookies and retrieving stored passwords</li>
<li>Other commands to be run directly with <span style="font-family: courier new, courier, monospace;">cmd.exe</span></li>
</ul>
<p>Version 2.5 was the first documented version of the C# component (first seen by ESET in December 2018). Then we saw v2.7.1 (November 2019), v3 (December 2019) and v4.0 (April 2020). The most important differences between the latest version of the malware and previous ones are:</p>
<ul>
<li>The main payload is a 32-bit DLL. Previously, it was a 64-bit EXE file.</li>
<li>HTTPS communication in the latest version</li>
<li>There is no “reverse” command anymore. It was used in previous versions to open a reverse shell. This is now done with other scripts</li>
</ul>
<p>The JS and C# components are connected to each other: the latter takes screenshots whereas the former doesn’t, but it has code that looks for screenshot files and sends them to its C&amp;C server. The C# component also deletes all files with the <span style="font-family: courier new, courier, monospace;">.lnk</span> extension in the <span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Temp</span> folder, cleaning leftovers from the initial compromise by the JS component. So even if the C# component has limited functionalities (it can’t download or upload files), it provides redundancy with a different C&amp;C server and extra persistence in case the JS component is detected or removed from the victim’s computer.</p>
<h2>Golden Chickens components: TerraLoader family</h2>
<p>In a small number of cases, the Evilnum group has also deployed some tools purchased from a Malware‑as‑a‑Service provider. This term is used to describe malware authors who offer not only their malicious binaries, but also any necessary infrastructure (such as the C&amp;C servers) and even technical support to their criminal customers.</p>
<p>In this case the MaaS provider is known as Golden Chickens and has other customers (apart from this group), such as <a href="https://attack.mitre.org/groups/G0037/" target="_blank" rel="noopener">FIN6</a> and <a href="https://attack.mitre.org/groups/G0080/" target="_blank" rel="noopener">Cobalt Group</a>. Older versions of all the components that we describe in the following sections were seen previously, in an <a href="https://usa.visa.com/dam/VCOM/global/support-legal/documents/fin6-cybercrime-group-expands-threat-To-ecommerce-merchants.pdf" target="_blank" rel="noopener">attack against eCommerce merchants that Visa attributed to FIN6</a> in February 2019. We believe that FIN6, Cobalt Group and Evilnum group are not the same, despite the overlaps in their toolsets. They just happen to share the same MaaS provider.</p>
<p>The Golden Chickens tools come as ActiveX components (OCX files) and all of them contain TerraLoader code, which serves as a common loader for the various payloads available to Golden Chickens’ customers. These tools are used by Evilnum as follows:</p>
<ul>
<li>The attackers manually send a command to the JS or C# component to drop and execute a batch file from one of their servers.</li>
<li>That batch file writes a malicious INF file and supplies it as a parameter to the Microsoft utility <span style="font-family: courier new, courier, monospace;">cmstp.exe</span>, which executes a remote scriptlet specified in the INF file. This technique has been documented in the MITRE ATT&amp;CK knowledge base as <a href="https://attack.mitre.org/techniques/T1191/" target="_blank" rel="noopener">CMSTP</a>; an example of how this technique is used may be found <a href="https://pentestlab.blog/2018/05/10/applocker-bypass-cmstp/" target="_blank" rel="noopener">here</a>. This technique has been used in the past by <a href="https://attack.mitre.org/groups/G0080/" target="_blank" rel="noopener">Cobalt</a>, another financially motivated group.</li>
<li>The remote scriptlet contains obfuscated JS code that drops an OCX file and executes it via <span style="font-family: courier new, courier, monospace;">regsvr32.exe</span>.</li>
</ul>
<p>The TerraLoader code performs several integrity checks before dropping the payload. These checks implement anti-debugging techniques and try to identify anomalies to prevent execution in sandboxed environments. Some of these techniques range from detecting incorrect parameters, filenames and extensions, to detecting hardware breakpoints or identifying specific modules loaded into the subject process. Should these checks all pass, the actual payload is decrypted and executed.</p>
<p>We have seen Evilnum deploy the following Golden Chickens payloads in their attacks:</p>
<ul>
<li>More_eggs</li>
<li>A Meterpreter payload that we will call TerraPreter</li>
<li>TerraStealer</li>
<li>TerraTV</li>
</ul>
<p>Researchers from Positive Technologies recently analyzed some tools used by the Cobalt group, including More_eggs version 6.6, which is one of the versions used by Evilnum group. They have a very good analysis of TerraLoader, so we suggest checking <a href="https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/cobalt_upd_ttps/" target="_blank" rel="noopener">their report</a> (section 4).</p>
<h3>More_eggs</h3>
<p><a href="https://attack.mitre.org/software/S0284/" target="_blank" rel="noopener">More_eggs</a> is a JavaScript backdoor that communicates with a C&amp;C server and accepts commands. It has been used in the past by other groups targeting financial companies. Evilnum uses it in conjunction with its homemade backdoors in order to provide redundancy and additional persistence on victim networks.</p>
<p>We have seen Evilnum use 32-bit ActiveX components with TerraLoader code that runs More_eggs versions 6.5, 6.6 and 6.6b – the latest available versions. They do so by dropping <span style="font-family: courier new, courier, monospace;">msxsl.exe</span> (a command line transformation utility that is a legitimate Microsoft executable) and having it execute the JavaScript code, very similar to what was described in <a href="https://securityintelligence.com/posts/more_eggs-anyone-threat-actor-itg08-strikes-again/" target="_blank" rel="noopener">this article by IRIS</a>.</p>
<p>The dropped JavaScript code is generated on the fly by the ActiveX component, and there are some considerations during analysis:</p>
<ul>
<li>The initial JS code that executes exe has a hardcoded absolute path, so executing it from another location or with another user will fail.</li>
<li>The final More_eggs payload is encrypted with a key that has the hostname and processor family information appended at the end. An example key is:</li>
</ul>
<p style="padding-left: 30px;"><span style="font-family: courier new, courier, monospace;">cvyLMmtGSKmPMfzJjGyg552DESKTOP-FQAT01XIntel64 Family 6 Model 94 Stepping 3, GenuineIntel</span></p>
<p>The core functionalities are the same as described in the article linked above, although there is a new command, <span style="font-family: courier new, courier, monospace;">more_time</span>, not mentioned there. This command is similar to the documented command <span style="font-family: courier new, courier, monospace;">via_c</span>, which executes its parameter with <span style="font-family: courier new, courier, monospace;">cmd.exe /v /c &lt;parameter&gt;</span>. The difference is that it additionally sends the output back to the C&amp;C (<span style="font-family: courier new, courier, monospace;">via_c</span> only sends whether or not the command succeeded).</p>
<h3>TerraPreter</h3>
<p>Evilnum group also uses 64-bit executables that decrypt and run a Meterpreter instance in memory. The use of Meterpreter gives them flexibility and the ability to run various payloads in a stealthy and extensible way.</p>
<p>The structure of these components and the integrity checks implemented were identified as TerraLoader code. That’s why we refer to these components as TerraPreter. Decompiled code of the main malicious routine is shown in Figure 7.</p>
<div id="attachment_140504" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/07_code_activex.png"><img class="wp-image-140504" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/07_code_activex-150x150.png" alt="" width="700" height="773" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/07_code_activex-272x300.png 272w, https://www.welivesecurity.com/wp-content/uploads/2020/07/07_code_activex-768x848.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/07_code_activex.png 799w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 7. Decompiled code for Meterpreter Loader components</i></p></div>
<p>The routine labeled <span style="font-family: courier new, courier, monospace;">Dummy</span> calls a series of APIs that don’t do anything. The RC4 function initialization brute-forces the key to use by taking a base string and appending a number to it that is incremented in each iteration. It then decrypts a 16-byte buffer with the candidate key using RC4. If the decrypted buffer matches a hardcoded string, then that candidate key will be the chosen RC4 key for later use. We believe this may be a time-wasting countermeasure against emulators.</p>
<p>After the embedded buffer with the payload is decrypted, the malware will finally set a callback to the <span style="font-family: courier new, courier, monospace;">GrayStringW</span> API function, pointing to the decrypted buffer. After going through many layers of decoding, Meterpreter’s <span style="font-family: courier new, courier, monospace;">metsrv.dll</span> is loaded in memory. From this point on, what we see is regular Meterpreter behavior that has not been modified. However, we will continue to describe how communications are performed.</p>
<p>TerraPreter communicates with a C&amp;C server using HTTPS and retrieves a series of commands. C&amp;Cs we have seen contacted are <span style="font-family: courier new, courier, monospace;">cdn.lvsys[.]com</span> and <span style="font-family: courier new, courier, monospace;">faxing-mon[.]best</span>. The first one was redirected to <span style="font-family: courier new, courier, monospace;">d2nz6secq3489l.cloudfront[.]net</span>. Every time a C&amp;C receives a request, it sends different binary data XORed with a random 4-byte key. The malware reads the key to be used for decryption from the first 4 bytes of a 32-byte header that prefixes the encrypted data. Figure 8 shows an example.</p>
<div id="attachment_140505" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/08_xored_data_server.png"><img class="wp-image-140505" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/08_xored_data_server-150x150.png" alt="" width="700" height="293" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/08_xored_data_server-300x126.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/08_xored_data_server-768x321.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/08_xored_data_server.png 865w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 8. Data sent by the C&amp;C</i></p></div>
<p>The first command sent by the C&amp;C is <span style="font-family: courier new, courier, monospace;">core_patch_url</span>, which changes the last part of the URL for subsequent requests. Then <span style="font-family: courier new, courier, monospace;">core_negotiate_tlv_encryption</span> is sent by the C&amp;C, along with its public key. From this point on, messages will be encrypted before they are XORed.</p>
<h3>TerraStealer and TerraTV</h3>
<p>TerraStealer is also known as SONE or Stealer One. It scans for many browsers, email, FTP and file transfer applications, to steal cookies and credentials. One of the binaries we analyzed had logging activated. Part of one such log is shown in Figure 9.</p>
<div id="attachment_140506" style="width: 580px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/09_terrastealer_log.png"><img class="wp-image-140506 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/09_terrastealer_log.png" alt="" width="570" height="679" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/09_terrastealer_log.png 570w, https://www.welivesecurity.com/wp-content/uploads/2020/07/09_terrastealer_log-252x300.png 252w" sizes="(max-width: 570px) 100vw, 570px" /></a><p class="wp-caption-text"><i>Figure 9. TerraStealer log</i></p></div>
<p>Another component used by this group is a variant of TerraTV. It runs a legitimate TeamViewer application but hides its user interface elements, so that the operators of the malware can connect to the compromised computer undetected.</p>
<p>When executed, TerraTV drops several signed TeamViewer components into <span style="font-family: courier new, courier, monospace;">C:\Users\Public\Public Documents\57494E2D3850535046373333503532\</span>. The dropped files are shown in Figure 10.</p>
<div id="attachment_140507" style="width: 284px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/10_terratv_dropped_files.png"><img class="wp-image-140507 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/10_terratv_dropped_files.png" alt="" width="274" height="259" /></a><p class="wp-caption-text"><i>Figure 10. TeamViewer files dropped by TerraTV</i></p></div>
<p><span style="font-family: courier new, courier, monospace;">ACTIVEDS.dll</span> is not signed and it is where the malicious code resides. There is a Windows DLL with that same name in the system folder, but since the malicious DLL is in the same directory as the TeamViewer executable, it is found first, and therefore is loaded instead of the Windows DLL. This is known as <a href="https://attack.mitre.org/techniques/T1038/" target="_blank" rel="noopener">DLL search order hijacking</a>. This <span style="font-family: courier new, courier, monospace;">ACTIVEDS.dll</span> hooks several API calls in the TeamViewer executable to hide the application’s tray icon and to capture login credentials. The part of the code where the hooks are set is shown in Figure 11.</p>
<div id="attachment_140508" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/11_terratv_hooks.png"><img class="wp-image-140508" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/11_terratv_hooks-150x150.png" alt="" width="700" height="854" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/11_terratv_hooks-246x300.png 246w, https://www.welivesecurity.com/wp-content/uploads/2020/07/11_terratv_hooks.png 717w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 11. Hooks set for TeamViewer</i></p></div>
<p>The Windows API call <span style="font-family: courier new, courier, monospace;">DefWindowProcW</span> (called several times by the TeamViewer executable to process messages directed to its main window) is hooked with a routine that writes TeamViewer’s ID and password to the file <span style="font-family: courier new, courier, monospace;">%APPDATA%\log_CZ72kGqTdU.txt</span>. With these credentials, and TeamViewer running with no visible tray icon or window, the operators of the malware can remotely control the computer, via its GUI, at any time.</p>
<h2>Post-compromise toolset</h2>
<p>The malicious components previously mentioned are frequently extended with several additional tools in the Evilnum group’s arsenal. In most of the compromises we have seen, the attackers utilized publicly available tools, but have also developed some custom scripts. Usually they keep their tools in password-protected archives on their servers and decompress them on a victim’s PC as needed.</p>
<h3>Python-based tools</h3>
<ul>
<li>Reverse shell over SSL script: A very short script that takes the server and port as command line arguments.</li>
<li>SSL proxy that uses <a href="https://code.google.com/archive/p/python-proxy/source/default/source" target="_blank" rel="noopener">PythonProxy</a>, <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/junction" target="_blank" rel="noopener">junction</a>, <a href="https://www.putty.org/" target="_blank" rel="noopener">plink</a> and <a href="https://www.stunnel.org/" target="_blank" rel="noopener">stunnel</a>. It can also connect to an FTP server or use <a href="https://github.com/MisterDaneel/pysoxy" target="_blank" rel="noopener">pysoxy</a>. We have seen the script being used with the “proxy” setting and 185.62.189[.]210 as the server.</li>
<li><a href="https://github.com/AlessandroZ/LaZagne/blob/master/Linux/laZagne.py" target="_blank" rel="noopener">LaZagne</a> to retrieve stored passwords</li>
<li><a href="https://github.com/IronLanguages/ironpython2" target="_blank" rel="noopener">IronPython</a> along with libraries for taking screenshots, keylogging and recording DirectSound audio</li>
</ul>
<h3>Other publicly available tools</h3>
<ul>
<li>PowerShell scripts: for example, <a href="https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Bypass-UAC/Bypass-UAC.ps1" target="_blank" rel="noopener">Bypass-UAC</a></li>
<li>Several NirSoft utilities; for example, <a href="https://www.nirsoft.net/utils/mailpv.html" target="_blank" rel="noopener">Mail PassView</a>, to retrieve passwords from email clients, and <a href="https://www.nirsoft.net/utils/product_cd_key_viewer.html" target="_blank" rel="noopener">ProduKey</a>, to get Microsoft Office and Windows Licenses</li>
</ul>
<h2>Conclusion</h2>
<p>The Evilnum group has been operating for at least two years and was active at the time of this writing. It has an infrastructure for its operations with several different servers: one for communications with the JS component, another for the C# component, a different one for storing its tools and exfiltrated data, proxy server, and so on. This group targets fintech companies that provide trading and investment platforms for their customers. The targets are very specific and not numerous. This, and the group’s use of legitimate tools in its attack chain, have kept its activities largely under the radar. Thanks to our telemetry data we were able to join the dots and discover how the group operates, uncovering some overlaps with other known APT groups. We think this and other groups share the same MaaS provider, and the Evilnum group cannot yet be associated with any previous attacks by any other APT group.</p>
<p>A comprehensive list of Indicators of Compromise (IoCs) and samples can be found in <a href="https://github.com/eset/malware-ioc/tree/master/evilnum" target="_blank" rel="noopener">our GitHub repository</a>.</p>
<p><em>For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com.</em></p>
<p><em>Special thanks to </em><a href="https://www.welivesecurity.com/author/isanmillan/" target="_blank" rel="noopener"><em>Ignacio Sanmillan</em></a><em> for his help with the analysis of the Golden Chickens components.</em></p>
<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-852" class="tablepress tablepress-id-852">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1192/" rel="noopener" target="_blank">T1192</a></td><td class="column-3">Spearphishing Link</td><td class="column-4">Emails contain a link to download a compressed file from an external server.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="11" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1191/" rel="noopener" target="_blank">T1191</a></td><td class="column-3">CMSTP</td><td class="column-4"><span style="font-family: courier new, courier, monospace;">cmstp.exe</span>  is used to execute a remotely hosted scriptlet that drops a malicious ActiveX file.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1059/" rel="noopener" target="_blank">T1059</a></td><td class="column-3">Command-Line Interface</td><td class="column-4"><span style="font-family: courier new, courier, monospace;">cmd.exe</span>  is used to execute commands and scripts.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1129/" rel="noopener" target="_blank">T1129</a></td><td class="column-3">Execution through Module Load</td><td class="column-4">The malicious payload for the version 4.0 C# component is loaded from a DLL. TerraTV loads a malicious DLL to enable silent use of TeamViewer.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1061/" rel="noopener" target="_blank">T1061</a></td><td class="column-3">Graphical User Interface</td><td class="column-4">TerraTV malware allows remote control using TeamViewer.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1086/" rel="noopener" target="_blank">T1086</a></td><td class="column-3">PowerShell</td><td class="column-4">Evilnum group executes LaZagne and other PowerShell scripts after their JS component has compromised a target.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1117/" rel="noopener" target="_blank">T1117</a></td><td class="column-3">Regsvr32</td><td class="column-4">Evilnum group uses <span style="font-family: courier new, courier, monospace;"> regsvr32.exe</span>  to execute their Golden Chickens tools.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">Initial compromise and post-compromise use several JavaScript, Python and PowerShell scripts.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1218/" rel="noopener" target="_blank">T1218</a></td><td class="column-3">Signed Binary Proxy Execution</td><td class="column-4"><span style="font-family: courier new, courier, monospace;">msiexec.exe</span>  is used to install the malicious C# component.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">Victims are lured to open LNK files that will install a malicious JS component.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1047/" rel="noopener" target="_blank">T1047</a></td><td class="column-3">Windows Management Instrumentation</td><td class="column-4">WMI is used by the JS component to obtain information such as which antivirus product is installed.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1220/" rel="noopener" target="_blank">T1220</a></td><td class="column-3">XSL Script Processing</td><td class="column-4">More_eggs malware uses <span style="font-family: courier new, courier, monospace;"> msxsl.exe</span>  to invoke JS code from an XSL file.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="3" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Registry Run keys are created in order to persist by the JS and C# components, as well as More_eggs</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1108/" rel="noopener" target="_blank">T1108</a></td><td class="column-3">Redundant Access</td><td class="column-4">Evilnum components are independent and provide redundancy in case one of them is detected and removed.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1179/" rel="noopener" target="_blank">T1179</a></td><td class="column-3">Hooking</td><td class="column-4">TerraTV malware hooks several API calls in TeamViewer.</td>
</tr>
<tr class="row-17 odd">
	<td rowspan="11" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1038/" rel="noopener" target="_blank">T1038</a></td><td class="column-3">DLL Search Order Hijacking</td><td class="column-4">TerraTV malware has TeamViewer load a malicious DLL placed in the TeamViewer directory, instead of the original Windows DLL located in a system folder.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1088/" rel="noopener" target="_blank">T1088</a></td><td class="column-3">Bypass User Access Control</td><td class="column-4">A PowerShell script is used to bypass UAC.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1116/" rel="noopener" target="_blank">T1116</a></td><td class="column-3">Code Signing</td><td class="column-4">Some of the Golden Chickens components are malicious signed executables. Also, Evilnum group uses legitimate (signed) applications such as <span style="font-family: courier new, courier, monospace;"> cmstp.exe</span>  or <span style="font-family: courier new, courier, monospace;"> msxsl.exe</span>  as a defense evasion mechanism.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1090/" rel="noopener" target="_blank">T1090</a></td><td class="column-3">Connection Proxy</td><td class="column-4">Connection to a proxy server is set up with post-compromise scripts.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Encryption, encoding and obfuscation are used in many Evilnum malware components.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">Both JS and C# components delete temporary files and folders created during the initial compromise.</td>
</tr>
<tr class="row-23 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1143/" rel="noopener" target="_blank">T1143</a></td><td class="column-3">Hidden Window</td><td class="column-4">TerraTV runs TeamViewer with its window and tray icon hidden.</td>
</tr>
<tr class="row-24 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">The C# component has its payload in <span style="font-family: courier new, courier, monospace;"> system.memmory.dll</span> , which masquerades as a benign .NET Framework DLL.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">Evilnum modifies the registry for different purposes, mainly to persist in a compromised system (for example, by using a registry's Run key).</td>
</tr>
<tr class="row-26 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">Encryption, encoding and obfuscation is used in many Evilnum malware components.</td>
</tr>
<tr class="row-27 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td><td class="column-3">Virtualization/Sandbox Evasion</td><td class="column-4">The Golden Chickens components implement several integrity checks and evasion techniques.</td>
</tr>
<tr class="row-28 even">
	<td rowspan="4" class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1003/" rel="noopener" target="_blank">T1003</a></td><td class="column-3">Credential Dumping</td><td class="column-4">Scripts and tools such as LaZagne are used to retrieve stored credentials.</td>
</tr>
<tr class="row-29 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1503/" rel="noopener" target="_blank">T1503</a></td><td class="column-3">Credentials from Web Browsers</td><td class="column-4">The C# component retrieves stored passwords from Chrome.</td>
</tr>
<tr class="row-30 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">Custom Python scripts have been used for keylogging.</td>
</tr>
<tr class="row-31 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1539/" rel="noopener" target="_blank">T1539</a></td><td class="column-3">Steal Web Session Cookie</td><td class="column-4">Evilnum malware steals cookies from Chrome.</td>
</tr>
<tr class="row-32 even">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1012/" rel="noopener" target="_blank">T1012</a></td><td class="column-3">Query Registry</td><td class="column-4">More_eggs queries the registry to know if the user has admin privileges.</td>
</tr>
<tr class="row-33 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1063/" rel="noopener" target="_blank">T1063</a></td><td class="column-3">Security Software Discovery</td><td class="column-4">Both the JS and C# components search for installed antivirus software.</td>
</tr>
<tr class="row-34 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1518/" rel="noopener" target="_blank">T1518</a></td><td class="column-3">Software Discovery</td><td class="column-4">TerraStealer malware looks for specific applications.</td>
</tr>
<tr class="row-35 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Information about the system is sent to the C&amp;C servers.</td>
</tr>
<tr class="row-36 even">
	<td rowspan="5" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1074/" rel="noopener" target="_blank">T1074</a></td><td class="column-3">Data Staged</td><td class="column-4">Data is stored in a temporary location before it is sent to the C&amp;C.</td>
</tr>
<tr class="row-37 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">The JS component (v2.1) has code to exfiltrate Excel files from the local system.</td>
</tr>
<tr class="row-38 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1114/" rel="noopener" target="_blank">T1114</a></td><td class="column-3">Email Collection</td><td class="column-4">TerraStealer malware targets email applications.</td>
</tr>
<tr class="row-39 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">Keystrokes are logged with a Python script.</td>
</tr>
<tr class="row-40 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Screenshots are taken by some Evilnum malware components.</td>
</tr>
<tr class="row-41 odd">
	<td rowspan="9" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">HTTP and HTTPS are used for C&amp;C communication.</td>
</tr>
<tr class="row-42 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1132/" rel="noopener" target="_blank">T1132</a></td><td class="column-3">Data Encoding</td><td class="column-4">Some of the data sent to the C&amp;C is base64-encoded.</td>
</tr>
<tr class="row-43 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1008/" rel="noopener" target="_blank">T1008</a></td><td class="column-3">Fallback Channels</td><td class="column-4">The JS and C# components can obtain a new C&amp;C by parsing third-party webpages if the original C&amp;C is down.</td>
</tr>
<tr class="row-44 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1104/" rel="noopener" target="_blank">T1104</a></td><td class="column-3">Multi-Stage Channels</td><td class="column-4">Evilnum malware uses independent C&amp;C servers for its various components.</td>
</tr>
<tr class="row-45 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1219/" rel="noopener" target="_blank">T1219</a></td><td class="column-3">Remote Access Tools</td><td class="column-4">TerraTV malware uses TeamViewer to give control of the compromised computer to the attackers.</td>
</tr>
<tr class="row-46 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1105/" rel="noopener" target="_blank">T1105</a></td><td class="column-3">Remote File Copy</td><td class="column-4">Files are uploaded to/downloaded from a C&amp;C server.</td>
</tr>
<tr class="row-47 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">HTTP and HTTPS are used for C&amp;C.</td>
</tr>
<tr class="row-48 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1032/" rel="noopener" target="_blank">T1032</a></td><td class="column-3">Standard Cryptographic Protocol</td><td class="column-4">More_eggs malware uses RC4 to encrypt data to be sent to the C&amp;C.</td>
</tr>
<tr class="row-49 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1102" rel="noopener" target="_blank">T1102</a></td><td class="column-3">Web Service</td><td class="column-4">GitHub, GitLab, Reddit and other websites are used to store C&amp;C server information.</td>
</tr>
<tr class="row-50 even">
	<td rowspan="3" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank">T1022</a></td><td class="column-3">Data Encrypted</td><td class="column-4">Some Evilnum components encrypt data before sending it to the C&amp;C.</td>
</tr>
<tr class="row-51 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1048/" rel="noopener" target="_blank">T1048</a></td><td class="column-3">Exfiltration Over Alternative Protocol</td><td class="column-4">Scripts are manually deployed by the malware operators to send data to an FTP server.</td>
</tr>
<tr class="row-52 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Data is exfiltrated over the same channel used for C&amp;C.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                    Matías Porolli                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-07-09 11:30:00">9 Jul 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="More evil: A deep look at Evilnum and its toolset">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="More evil: A deep look at Evilnum and its toolset">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="More evil: A deep look at Evilnum and its toolset">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="More evil: A deep look at Evilnum and its toolset">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F09%2Fmore-evil-deep-look-evilnum-toolset%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F09%2Fmore-evil-deep-look-evilnum-toolset%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F09%2Fmore-evil-deep-look-evilnum-toolset%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"140345 https:\/\/backend.welivesecurity.com\/?p=140345","disqusShortname":"welivesecurity","disqusTitle":"More evil: A deep look at Evilnum and its toolset","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/07\/09\/more-evil-deep-look-evilnum-toolset\/","postId":"140345"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>